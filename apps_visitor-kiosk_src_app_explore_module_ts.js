"use strict";(self.webpackChunkvisitor_kiosk=self.webpackChunkvisitor_kiosk||[]).push([["apps_visitor-kiosk_src_app_explore_module_ts"],{126:(gs,fe,c)=>{c.r(fe),c.d(fe,{AppExploreModule:()=>fs});var b=c(316),S=c(9805),g=c(4456),L=c(8030),ae=c(8827),Ge=c(1570),ze=c(9168),Ve=c(9714),Be=c(7651),C=c(9204),u=c(7375),U=c(7871),Y=c(5762),V=c(2455),e=c(7404),P=c(5060),re=c(4950);c(5175);var I=c(118),Z=c(3602),q=c(8390),ee=(c(7401),c(1865),c(5384),c(2011)),B=c(5897),j=c(8627),x=c(5443),G=c(9803),K=c(9434),te=c(2238);function We(i,h){if(1&i&&(e.j41(0,"div",5)(1,"app-icon"),e.EFF(2,"thermostat"),e.k0s(),e.j41(3,"div",6),e.EFF(4),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(4),e.SpI("",t.temp,"\u02daF")}}function He(i,h){if(1&i&&(e.j41(0,"div",5)(1,"app-icon"),e.EFF(2,"opacity"),e.k0s(),e.j41(3,"div",6),e.EFF(4),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(4),e.SpI("",t.humidity,"%")}}function Qe(i,h){1&i&&(e.j41(0,"div",7)(1,"app-icon",8),e.EFF(2,"error"),e.k0s()())}function qe(i,h){if(1&i&&(e.j41(0,"div",2),e.DNE(1,We,5,1,"div",3)(2,He,5,1,"div",3)(3,Qe,3,0,"div",4),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.temp),e.R7$(),e.Y8G("ngIf",t.humidity),e.R7$(),e.Y8G("ngIf",t.temp>82)}}let be="",ve=(()=>{class i extends u.Tv{get show(){return be===this._details.id}set show(t){this.timeout("show",()=>be=t?this._details.id:"")}constructor(t){super(),this._details=t,this.temp=this._details.temp||0,this.humidity=this._details.humidity||0}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(L.Nw))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["explore-sensor-info"]],features:[e.Vt3],decls:5,vars:1,consts:[["stats",""],["icon","","matRipple","","customTooltip","","yPosition","center","xPosition","center",1,"absolute","top-1/2","left-1/2","w-7","h-7","min-w-0","-translate-x-1/2","-translate-y-1/2","bg-base-100","shadow","pointer-events-auto",3,"content"],[1,"absolute","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2","bg-base-100","rounded-lg","border","border-base-200","p-2","text-xl"],["class","flex items-center space-x-2 whitespace-nowrap pr-2",4,"ngIf"],["class","absolute top-0 right-0 rounded-full translate-x-1/2 -translate-y-1/2 bg-base-100 border border-base-200",4,"ngIf"],[1,"flex","items-center","space-x-2","whitespace-nowrap","pr-2"],[1,""],[1,"absolute","top-0","right-0","rounded-full","translate-x-1/2","-translate-y-1/2","bg-base-100","border","border-base-200"],[1,"text-error","text-xl"]],template:function(n,s){if(1&n&&(e.j41(0,"button",1)(1,"app-icon"),e.EFF(2," visibility "),e.k0s()(),e.DNE(3,qe,4,3,"ng-template",null,0,e.C5r)),2&n){const o=e.sdS(4);e.Y8G("content",o)}},dependencies:[b.bT,K.R,te.I,P.r6]})}return i})();var M=c(521),T=c(2175),et=c(7558),Ee=c(3207);let se=(()=>{class i extends u.Tv{constructor(t,n,s){super(),this._state=t,this._org=n,this._settings=s,this._area_list=[],this._statuses={},this._count_key={},this._location={},this._label_location={},this._capacity={},this._draw={},this._points={},this._features=[],this._polygons$=new M.t([]),this._bind=(0,T.zV)([this._org.active_building,this._state.level,this._state.options]).pipe((0,j.p)(([o,a,{is_public:r}])=>!!o&&!!a&&!r),(0,x.T)(([o,a])=>{this._statuses={};let r=this._org.binding("area_management");if(!r)return;const l=(0,I.f_4)(r,"AreaManagement").binding(`${a.id}:areas`),p=(0,I.f_4)(r,"AreaManagement").binding(`${a.id}`),_=(0,T.zV)([l.listen(),p.listen()]).pipe((0,G.B)(100),(0,x.T)(([f,v])=>[...f?.value||[],...(v?.value||[]).filter(m=>"area"===m.location)]));this.subscription("zones-status",_.subscribe(f=>this.parseData(f))),this.subscription("binding",l.bind()),this.subscription("zone-binding",p.bind())})),this.init()}init(){var t=this;return(0,C.A)(function*(){yield t._org.initialised.pipe((0,U.$)(s=>s)).toPromise();const n=yield Promise.all(t._org.levels.map(s=>(0,I.bpY)(s.id,"map_regions").toPromise()));t._area_list=[];for(const s of n){const o=s?.details?.areas;if(o)for(const a of o){const{capacity:r,hide_label:l,label_location:p,draw_polygon:_,area_count_key:f}=a.properties||{},{coordinates:v}=a.geometry||{};t._capacity[a.id]=r||100,t._count_key[a.id]=f||"",t._location[a.id]=v?.length?tt(v):null,t._label_location[a.id]=!1===l?p||t._location[a.id]:null,t._draw[a.id]=!!_||t._settings.get("app.explore.use_zone_polygons"),t._points[a.id]=v||[],t._area_list.push(a.map_id||a.id)}}t._state.setFeatures("zones-canvas",[{track_id:"zones-canvas",location:{x:.5,y:.5},content:et.I,data:{polygons$:t._polygons$,draw_points:!1,draw_labels:!1}}]),t.updateStatus(),t.subscription("bind",t._bind.subscribe())})()}parseData(t=[]){const n=[],s=[];for(const o of t){const a=o.map_id||o.area_id,r=o.capacity||this._capacity[a]||100,p=(o[this._count_key[a]||this._settings.get("app.explore.area_count_key")||"count"]||0)/r;if(this._statuses[a]=o.at_location?"busy":p<.4?"free":p<.75?"pending":"busy",!this._location[a])continue;let _="";o.count&&(_+=`${o.count||0} User Device${1===o.count?"":"s"}\n`),o.temperature&&(_+=`Temperature: ${o.temperature} \u02daC\n`),o.people_count>0&&(_+=`${o.people_count_sum} ${1===o.people_count_sum?"Person":"People"}\n`),o.humidity&&(_+=`Humidity: ${o.humidity}%\n`),o.queue_size&&(_+=`Queue Size: ${o.queue_size}%\n`),o.counter&&(_+=`Count: ${o.counter}\n`),this._label_location[a]&&!this._settings.get("app.explore.show_zone_labels")&&n.push({location:this._label_location[a],content:_,z_index:100}),this._settings.get("app.explore.show_zone_sensor_info")&&(o.temperature||o.humidity)&&s.push({track_id:`sensors:${a}`,location:this._location[a],content:ve,data:{id:a,temp:o.temperature||10,humidity:o.humidity||10},z_index:98})}this._features=s,this._state.setLabels("zones",n),this.updateStatus()}updateStatus(){const t={},n=[],s=this._settings.get("app.explore.colors")||{},o=[];for(const a in this._statuses){const r=s[`zone-${this._statuses[a]}`]||s[`${this._statuses[a]}`]||B.U[`${this._statuses[a]}`];this._draw[a]?o.push({name:a,points:this._points[a],color:r}):this._state.has("style",a,["zones","zones-styles"])?n.push({location:a,content:Ee.q,data:{icon:{content:"pin_drop"}},full_size:!0,z_index:98}):t[`#${a}`]={fill:r,opacity:.6}}this._polygons$.next(o),this._state.setFeatures("zones",[...n,...this._features]),this._state.setStyles("zones-styles",t)}static#e=this.\u0275fac=function(n){return new(n||i)(e.KVO(V.O),e.KVO(Y.y),e.KVO(u.h$))};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac})}return i})();function tt(i){const h=(i||[]).reduce((t,[n,s])=>({x_min:n<t.x_min?n:t.x_min,x_max:n>t.x_max?n:t.x_max,y_min:s<t.y_min?s:t.y_min,y_max:s>t.y_max?s:t.y_max}),{x_min:100,x_max:-100,y_min:100,y_max:-100});return{x:h.x_min+(h.x_max-h.x_min)/2,y:h.y_min+(h.y_max-h.y_min)/2}}var J=c(6441),W=c(9908),ye=c(3240),xe=c(8797),F=c(1536),R=c(1963),D=c(9314),O=c(7841),ne=c(6e3),Ce=c(8379),st=c(7451),H=c(2587),nt=c(9608),Ie=c(3476),ot=c(1413),ke=c(8e3);const it=()=>({standalone:!0});function at(i,h){if(1&i&&(e.j41(0,"div",7)(1,"div",13)(2,"label"),e.EFF(3,"Resource:"),e.k0s(),e.j41(4,"div",14),e.EFF(5),e.k0s()()()),2&i){const t=e.XpG(2);e.R7$(5),e.SpI(" ",t.resource.name||t.resource.map_id||"Unknown Resource"," ")}}function rt(i,h){1&i&&(e.j41(0,"div",7)(1,"div",8)(2,"label"),e.EFF(3,"Host"),e.k0s(),e.nrm(4,"a-user-search-field",15),e.k0s()())}function lt(i,h){if(1&i){const t=e.RV6();e.j41(0,"main",5),e.DNE(1,at,6,1,"div",6)(2,rt,5,0,"div",6),e.j41(3,"div",7)(4,"div",8)(5,"label"),e.EFF(6,"Date"),e.k0s(),e.j41(7,"a-date-field",9),e.EFF(8," Date and time must be in the future "),e.k0s()()(),e.j41(9,"div",7)(10,"div",10)(11,"label"),e.EFF(12,"Start Time"),e.k0s(),e.j41(13,"a-time-field",11),e.bIt("ngModelChange",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.form.patchValue({date:s}))}),e.k0s()(),e.j41(14,"div",10)(15,"label"),e.EFF(16,"End Time"),e.k0s(),e.nrm(17,"a-duration-field",12),e.k0s()()()}if(2&i){let t;const n=e.XpG();e.Y8G("formGroup",n.form),e.R7$(),e.Y8G("ngIf",n.resource),e.R7$(),e.Y8G("ngIf",n.host),e.R7$(5),e.Y8G("to",n.book_until),e.R7$(6),e.Y8G("ngModel",n.form.value.date)("ngModelOptions",e.lJ4(12,it))("use_24hr",n.use_24hr_time),e.R7$(4),e.Y8G("time",null==(t=n.form.get("date"))?null:t.value)("max",600)("min",60)("step",60)("use_24hr",n.use_24hr_time)}}let ce=(()=>{class i{get use_24hr_time(){return this._settings.get("app.use_24_hour_time")}constructor(t,n){this._data=t,this._settings=n,this.host=this._data.host,this.form=new g.gE({user:new g.MJ(this._data.user),date:new g.MJ(this._data.date),duration:new g.MJ(this._data.duration)}),this.book_until=this._data.until,this.resource=this._data.resource}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(H.Vh),e.rXU(u.h$))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["set-datetime-modal"]],decls:10,vars:2,consts:[["classs","flex items-center justify-between"],["icon","","mat-dialog-close",""],["class","w-[24rem] max-w-[85vw] pt-4",3,"formGroup",4,"ngIf"],[1,"w-full","p-2","border-t","border-base-200","flex","items-center","justify-center"],["btn","","matRipple","",1,"w-32",3,"mat-dialog-close"],[1,"w-[24rem]","max-w-[85vw]","pt-4",3,"formGroup"],["class","flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/4"],["formControlName","date",3,"to"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],[3,"ngModelChange","ngModel","ngModelOptions","use_24hr"],["formControlName","duration",3,"time","max","min","step","use_24hr"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/4","mb-2"],[1,"px-4","py-3","border","border-base-200","rounded","w-full","mb-4"],["formControlName","user",1,"mb-4"]],template:function(n,s){1&n&&(e.j41(0,"header",0)(1,"h2"),e.EFF(2,"Set date and time"),e.k0s(),e.j41(3,"button",1)(4,"app-icon"),e.EFF(5,"close"),e.k0s()()(),e.DNE(6,lt,18,13,"main",2),e.j41(7,"footer",3)(8,"button",4),e.EFF(9," Continue "),e.k0s()()),2&n&&(e.R7$(6),e.Y8G("ngIf",s.form),e.R7$(2),e.Y8G("mat-dialog-close",s.form.value))},dependencies:[b.bT,K.R,P.r6,H.tx,g.BC,g.cb,g.vS,g.j4,g.JD,nt.G,Ie.y,ot.t,ke.$]})}return i})();var Te=c(2882),ct=c(2439),_t=c(1874),_e=c(4918);const pt=["explore-device-info",""];function dt(i,h){if(1&i&&(e.j41(0,"p",23)(1,"label"),e.pXf(2,4),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.mac," ")}}function ut(i,h){if(1&i&&(e.j41(0,"p",24)(1,"label"),e.pXf(2,5),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.manufacturer," ")}}function mt(i,h){if(1&i&&(e.j41(0,"p",25)(1,"label"),e.pXf(2,6),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.os," ")}}function ht(i,h){if(1&i&&(e.j41(0,"p",26)(1,"label"),e.pXf(2,7),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.ssid," ")}}function ft(i,h){if(1&i&&(e.j41(0,"p",27)(1,"label"),e.pXf(2,8),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(2);e.R7$(3),e.SpI(" ",(null==t.user?null:t.user.name)||(null==t.user?null:t.user.username)||t.username," ")}}function gt(i,h){if(1&i&&(e.j41(0,"p",28)(1,"label"),e.pXf(2,9),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.user.type," ")}}function bt(i,h){if(1&i){const t=e.RV6();e.j41(0,"div",14),e.bIt("mouseleave",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.close())}),e.nrm(1,"div",15),e.j41(2,"div",16),e.DNE(3,dt,4,1,"p",17),e.j41(4,"p")(5,"label"),e.pXf(6,2),e.k0s(),e.EFF(7),e.k0s(),e.j41(8,"p")(9,"label"),e.pXf(10,3),e.k0s(),e.EFF(11),e.k0s(),e.DNE(12,ut,4,1,"p",18)(13,mt,4,1,"p",19)(14,ht,4,1,"p",20)(15,ft,4,1,"p",21)(16,gt,4,1,"p",22),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(3),e.Y8G("ngIf",t.mac&&!t.hide_fields.includes("mac")),e.R7$(4),e.SpI(" ",t.variance,"m"),e.R7$(4),e.SpI(" ",t.last_seen,""),e.R7$(),e.Y8G("ngIf",t.manufacturer&&!t.hide_fields.includes("manufacturer")),e.R7$(),e.Y8G("ngIf",t.os&&!t.hide_fields.includes("os")),e.R7$(),e.Y8G("ngIf",t.ssid&&!t.hide_fields.includes("ssid")),e.R7$(),e.Y8G("ngIf",t.username&&!t.hide_fields.includes("username")),e.R7$(),e.Y8G("ngIf",t.user&&!t.hide_fields.includes("user"))}}const vt=[];let Me=(()=>{class i extends u.Tv{get hide_fields(){return this._settings.get("app.explore.hide_device_fields")||vt}get last_seen(){return(0,ct.m)(1e3*(this._details.last_seen||0),{addSuffix:!0})}get diameter(){return 100*this._details.variance*this.zoom}get distance(){return Math.abs((0,_t.o)(1e3*(this._details.last_seen||0),new Date))}get distance_color(){return this.distance<10?"#43a047":this.distance<20?"#ffb300":"#e53935"}constructor(t,n,s){super(),this._details=t,this._settings=n,this._element=s,this.username="",this.user=this._details.user,this.mac=this._details.mac,this.manufacturer=this._details.manufacturer,this.os=this._details.os,this.ssid=this._details.ssid,this.variance=this._details.variance?.toFixed(2),this.bg_color=this._details.bg_color||this.distance_color,this.zoom=1}ngOnInit(t=0){t>10||setTimeout(()=>{const n=this._element.nativeElement.parentElement?.parentElement;if(!n)return this.ngOnInit(++t);const s_y=parseInt(n.style.top,10)/100,s_x=parseInt(n.style.left,10)/100;this.y_pos=s_y>=.5?"bottom":"top",this.x_pos=s_x>=.5?"end":"start",this.subscription("zoom",this._details.zoom$.subscribe(o=>this.zoom=o))},200)}loadUser(){var t=this;return(0,C.A)(function*(){if(t.username)return;const n=(0,I.f_4)(t._details.system,"LocationServices");if(!n)return;t.username="Loading...";const s=yield n.execute("check_ownership_of",[t.mac]).catch(o=>null);t.username=s&&s.assigned_to?s.assigned_to:""})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(_e.N),e.rXU(u.h$),e.rXU(e.aKT))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["","explore-device-info",""]],features:[e.Vt3],attrs:pt,decls:7,vars:9,consts:()=>{let t,n,s,o,a,r,l,p;return t=$localize`:␟4e79bc7b2a23c2e4e80d256c8167411cf124bd20␟1921442792032576180:Accuracy:`,n=$localize`:␟1c564bebf178f9c70f2c66a80393137bfa0d2ea8␟5291488112436395082:Last Seen:`,s=$localize`:␟14802d5580219b4522c9c50e1a9f401aee191e1e␟5080596488336446120:MAC:`,o=$localize`:␟a082daef9c0b66268ce56dfa8d96d47a04d2c4b1␟6296767522110275448:Manufacturer:`,a=$localize`:␟5544405b325c518c94412239610d44250d5a223a␟2346706060395913038:OS:`,r=$localize`:␟afd0fc7b37f54299537ba2abc9babf749adf383e␟4345272263810420547:SSID:`,l=$localize`:␟67fc3fe0566f8700b84a908c35497759db78addc␟140822705245800362:Username:`,p=$localize`:␟e78c0d60ac39787f62c9159646fe0b3c1ed55a1d␟2736556170366900089:Type:`,[["dot",""],["device_tooltip",""],t,n,s,o,a,r,l,p,["name","radius",1,"radius","absolute","center","bg-info","bg-opacity-25","border-8","border-dashed","border-blue-600","rounded-full"],["shadow","",1,"absolute","center","bg-neutral","h-8","w-8","rounded-full"],["name","dot",1,"h-3","w-3","absolute","center","rounded-full","shadow","border-2","border-white"],["customTooltip","",1,"absolute","inset-0","pointer-events-auto",3,"mouseenter","content","backdrop","xPosition","yPosition","hover"],["name","device-info",1,"w-64","rounded","bg-base-100","p-4","top-0","left-0","shadow","pointer-events-none","mx-2",3,"mouseleave"],[1,"arrow"],[1,"details"],["class","break-words",4,"ngIf"],["type","",4,"ngIf"],["os","",4,"ngIf"],["ssid","",4,"ngIf"],["username","",4,"ngIf"],["user","",4,"ngIf"],[1,"break-words"],["type",""],["os",""],["ssid",""],["username",""],["user",""]]},template:function(n,s){if(1&n){const o=e.RV6();e.nrm(0,"div",10)(1,"div",11)(2,"div",12,0),e.j41(4,"div",13),e.bIt("mouseenter",function(){return e.eBV(o),e.Njj(s.loadUser())}),e.k0s(),e.DNE(5,bt,17,8,"ng-template",null,1,e.C5r)}if(2&n){const o=e.sdS(6);e.Aen("height: "+s.diameter+"%; width: "+s.diameter+"%;"),e.R7$(2),e.xc7("background-color",s.bg_color),e.R7$(2),e.Y8G("content",o)("backdrop",!1)("xPosition",s.x_pos)("yPosition",s.y_pos)("hover",!0)}},dependencies:[b.bT,te.I],styles:["[_nghost-%COMP%]{pointer-events:auto}[_nghost-%COMP%] > [name=dot][_ngcontent-%COMP%]{background-color:#616161}[_nghost-%COMP%]:hover > [name=radius][_ngcontent-%COMP%]{opacity:1}[name=radius][_ngcontent-%COMP%]{opacity:0;transition:opacity .2s;pointer-events:none}\n\n/*# sourceMappingURL=explore-device-info.component.ts-angular-inline--77.css.map*/"]})}return i})();var pe=c(8026);let oe=(()=>{class i extends u.Tv{constructor(t,n,s,o,a){var r;super(),r=this,this._state=t,this._org=n,this._settings=s,this._bookings=o,this._dialog=a,this._in_use=new M.t([]),this._options=new M.t({}),this._presence=new M.t([]),this._signs_of_life=new M.t([]),this._statuses={},this._users={},this._departments={},this._checked_in=new M.t([]),this.booking_rules=this._org.active_building.pipe((0,j.p)(l=>!!l),(0,R.n)(l=>(0,I.bpY)(l.id,"desk_booking_rules").pipe((0,D.W)(()=>(0,F.of)({details:[]})))),(0,x.T)(l=>l?.details instanceof Array?l.details:[]),(0,O.t)(1)),this.desk_list=this._state.level.pipe((0,G.B)(50),(0,R.n)(l=>(0,I.bpY)(l.id,"desks").pipe((0,D.W)(()=>(0,F.of)({details:[]})),(0,x.T)(p=>(p?.details instanceof Array?p.details:[]).map(_=>new st.g({..._,zone:l}))))),(0,D.W)(l=>[]),(0,O.t)(1)),this._bind=(0,T.zV)([this._state.level,this._state.options]).pipe((0,G.B)(300),(0,j.p)(([l,{is_public:p}])=>!!l&&!p),(0,x.T)(([l])=>{this._statuses={};const p=this._org.binding("area_management");if(!p)return;let _=(0,I.f_4)(p,"AreaManagement")?.binding(l.id);_&&(this.subscription("lvl-in_use",_.listen().subscribe(f=>this.processBindingChange(f||{},p))),this.subscription("lvl-in_use_bind",_.bind()))})),this._booking_list=(0,T.zV)([this._options,this._state.level]).pipe((0,j.p)(([l,p])=>(l.use_api||l.date>(0,J.D)(Date.now()).valueOf())&&!!p),(0,R.n)(([l,p])=>(0,pe.tj)({type:"desk",period_start:(0,W._)((0,ye.o)(l.date||Date.now())),period_end:(0,W._)((0,J.D)(l.date||Date.now())),zones:p.id})),(0,G.B)(200),(0,ne.M)(l=>{this._in_use.next(l.map(p=>p.asset_id)),this._checked_in.next(l.filter(p=>p.checked_in).map(p=>p.asset_id))}),(0,O.t)(1)),this._state_change=(0,T.zV)([this.desk_list,this._in_use,this._presence,this._checked_in,this._signs_of_life,this.booking_rules,this._options]).pipe((0,G.B)(50),(0,x.T)(function(){var l=(0,C.A)(function*([p,_,f,v,m,y]){r._statuses={};const d=yield r._state.level.pipe((0,Z.s)(1)).toPromise();for(const{id:E,bookable:k}of p){const N=_.some(z=>E===z),w=f.some(z=>E===z),$=m.some(z=>E===z),Q=v.some(z=>E===z)||N&&r._settings.get("app.desk.auto_checkin"),A=(0,u.RH)({date:Date.now(),duration:60,host:(0,u.Ny)(),resource:{id:E,zones:[d.parent_id,d.id]}},y)?.hidden;r._statuses[E]=k&&!A?N||w||Q?w||Q?"busy":"pending":$?"signs-of-life":"free":"not-bookable"}r.processDesks(p)});return function(p){return l.apply(this,arguments)}}())),this.init()}init(){var t=this;return(0,C.A)(function*(){yield t._org.initialised.pipe((0,U.$)(n=>n)).toPromise(),t.setOptions({enable_booking:!1!==t._settings.get("app.desks.enable_maps")}),t.subscription("bookings",t._booking_list.subscribe()),t.subscription("bind",t._bind.subscribe()),t.subscription("booking_rules",t.booking_rules.subscribe()),t.subscription("changes",t._state_change.subscribe()),t.subscription("desks",t.desk_list.subscribe(n=>t.processDesks(n)))})()}setOptions(t){this._options.next({...this._options.getValue(),...t})}processBindingChange({value:t},n){const s=(t||[]).filter(l=>!["desk","booking"].includes(l.location)),o=(t||[]).filter(l=>"desk"===l.location||"booking"===l.location&&"desk"===l.type);(this._options.getValue().date||Date.now())<=(0,J.D)(Date.now()).valueOf()&&!this._options.getValue().use_api&&(this._in_use.next(o.filter(l=>"booking"===l.location).map(l=>l.map_id||l.asset_id)),this._checked_in.next(o.filter(l=>"booking"===l.location&&l.checked_in).map(l=>l.map_id||l.asset_id)),this._presence.next(o.filter(l=>l.at_location).map(l=>l.map_id||l.asset_id)),this._signs_of_life.next(o.filter(l=>l.signs_of_life).map(l=>l.map_id||l.asset_id)));const r=this._settings.get("app.department_map")||{};for(const l of o)this._users[l.map_id||l.asset_id]=l.staff_name,this._departments[l.map_id||l.asset_id]=r[l.department]||"";this.processDevices(s,n),this.timeout("update",()=>this.updateStatus(),100)}updateStatus(){const t={},n=this._settings.get("app.explore.colors")||{};for(const s in this._statuses)this._statuses[s]&&(t[`#${s}`]={fill:n[`desk-${this._statuses[s]}`]||n[`${this._statuses[s]}`]||B.U[`${this._statuses[s]}`]});this._state.setStyles("desks",t)}processDevices(t,n){const s=[];for(const o of t){const a=o.x/o.map_width,r=o.y/o.map_height;s.push({track_id:`device:hover:${a},${r}`,location:{x:o.coordinates_from?.includes("right")?1-a:a,y:o.coordinates_from?.includes("bottom")?1-r:r},content:Me,z_index:20,data:{...o,system:n}})}this._state.setFeatures("devices",s)}processDesks(t){var n=this;const s=[],o=[],a=this._options.getValue();for(const r of t){if(s.push({track_id:`desk:hover:${r.map_id||r.id}`,location:r.id,content:Te.Y,full_size:!0,no_scale:!0,data:{id:r.map_id||r.id,map_id:r.name,name:r.name||r.map_id,user:this._users[r.map_id]||r.staff_name,status:this._statuses[r.map_id],department:this._departments[r.map_id]||""},z_index:20}),!r.bookable)continue;let l=!0;const p=function(){var _=(0,C.A)(function*(){if(!l)return;if("free"!==n._statuses[r.id])return(0,u.UG)(`${r.name||"Desk"} is unavailable at this time.`);if(r.groups?.length&&!r.groups.find(d=>(0,u.Ny)().groups.includes(d)))return(0,u.UG)(`You are not allowed to book ${r.name}.`);n._bookings.newForm(),n._bookings.setOptions({type:"desk"}),a.date&&(n._bookings.form.patchValue({date:a.date}),n._bookings.form.patchValue({all_day:!!a.all_day}));let{date:f,duration:v,user:m}=yield n._setBookingTime(n._bookings.form.value.date,n._bookings.form.value.duration,n._options.getValue()?.custom??!1,r);m=m||a.host||(0,u.Ny)();const y=m?.email;n._bookings.form.patchValue({resources:[r],asset_id:r.id,asset_name:r.name,date:f,duration:a.all_day?720:v,map_id:r?.map_id||r?.id,description:r.name,user:m,user_email:y,booking_type:"desk",zones:r.zone?[r.zone?.parent_id,r.zone?.id]:[]}),yield n._bookings.confirmPost().catch(d=>{throw console.log(d),(0,u.UG)(`Failed to book desk ${r.name||r.id}. ${d.message||d.error||d}`),d}),n._users[r.map_id]=(a.host||(0,u.Ny)())?.name,(0,u.VX)(`Successfully booked desk ${r.name||r.id}`)});return function(){return _.apply(this,arguments)}}();["mousedown","touchstart"].forEach(_=>o.push({id:r.id,action:_,priority:10,callback:()=>{l=!0,this.timeout("booking",()=>l=!1)}})),["mouseup","touchend"].forEach(_=>o.push({id:r.id,action:_,priority:10,callback:p}))}this._state.setActions("desks",this._options.getValue().enable_booking?o:[]),this._state.setFeatures("desks",s),this.timeout("update",()=>this.updateStatus(),100)}_setBookingTime(t,n,s=!1,o=null){var a=this;return(0,C.A)(function*(){let r=null;if(a._settings.get("app.desks.allow_time_changes")){const l=(0,J.D)((0,xe.f)(Date.now(),a._settings.get("app.desks.available_period")||90)),_=yield a._dialog.open(ce,{data:{date:t,duration:n,until:l,host:s,resource:o}}).afterClosed().toPromise();if(!_)throw"User cancelled";t=_.date,n=_.duration,r=_.user}return{date:t,duration:n,user:r}})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.KVO(V.O),e.KVO(Y.y),e.KVO(u.h$),e.KVO(Ce.n),e.KVO(H.bZ))};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac})}return i})();var de=c(3206),Et=c(5469),yt=c(1257),xt=c(3330),Ct=c(8757);function It(i,h){if(1&i&&(e.j41(0,"div",7)(1,"div",8),e.EFF(2," Plate Number "),e.k0s(),e.j41(3,"div",9),e.EFF(4),e.k0s()()),2&i){const t=e.XpG();e.R7$(4),e.SpI(" ",t.plate_number||"ABC3"," ")}}let Re=(()=>{class i{get is_concierge(){return this._settings.app_name.toLowerCase().includes("concierge")}constructor(t,n,s){this._data=t,this._element=n,this._settings=s,this.status=this._data.assigned_to===this._data.user&&this._data.user?"reserved":this._data.status,this.user=this._data.user,this.name=this._data.name,this.map_id=this._data.map_id,this.plate_number=this._data.plate_number}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(L.Nw),e.rXU(e.aKT),e.rXU(u.h$))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["explore-parking-info"]],decls:9,vars:15,consts:[[1,"absolute","bg-base-300","p-2","rounded-lg","!rounded-tl-none","shadow","top-1/2","left-1/2","text-left"],[1,"absolute","top-0.5","left-0.5","triangle"],[1,"flex","space-x-2"],[1,"flex","flex-col","leading-tight","min-w-24","pl-1"],[1,"whitespace-nowrap"],[1,"capitalize","text-sm","font-medium"],["class","flex flex-col relative h-full px-2 rounded bg-base-100 text-base-content shadow leading-tight",4,"ngIf"],[1,"flex","flex-col","relative","h-full","px-2","rounded","bg-base-100","text-base-content","shadow","leading-tight"],[1,"text-[0.625rem]","w-full","text-center","pt-1","whitespace-nowrap","font-medium"],[1,"font-mono","pb-1","w-full","text-center","uppercase"]],template:function(n,s){1&n&&(e.j41(0,"div",0),e.nrm(1,"div",1),e.j41(2,"div",2)(3,"div",3)(4,"div",4),e.EFF(5),e.k0s(),e.j41(6,"div",5),e.EFF(7),e.k0s()(),e.DNE(8,It,5,1,"div",6),e.k0s()()),2&n&&(e.AVh("!bg-error","busy"===s.status)("!text-error-content","busy"===s.status)("!bg-warning","reserved"===s.status)("!text-warning-content","reserved"===s.status)("!bg-success","free"===s.status)("!text-success-content","free"===s.status),e.R7$(5),e.JRh(s.name),e.R7$(2),e.SpI(" ",s.status," "),e.R7$(),e.Y8G("ngIf",s.is_concierge&&s.plate_number))},dependencies:[b.bT],styles:[".triangle[_ngcontent-%COMP%]{width:0px;height:0px;border-style:solid;border-width:.5rem .5rem 0 0;border-color:currentColor transparent transparent transparent;transform:rotate(0)}\n\n/*# sourceMappingURL=explore-parking-info.component.ts-angular-inline--78.css.map*/"]})}return i})();var kt=c(1593);let ie=(()=>{class i extends u.Tv{constructor(t,n,s,o,a,r){super(),this._org=t,this._state=n,this._settings=s,this._bookings=o,this._parking=a,this._dialog=r,this._options=new M.t({}),this._poll=new M.t(0),this.options=this._options.asObservable(),this.on_book=null,this.levels=this._org.active_levels.pipe((0,x.T)(l=>l.filter(p=>p.tags.includes("parking")))),this.events=(0,T.zV)([this._org.active_building,this._options,this._poll,this._state.options]).pipe((0,G.B)(300),(0,R.n)(([l,p,_,{is_public:f}])=>f?(0,F.of)([]):(0,pe.tj)({period_start:(0,W._)((0,de.c)(p.date||Date.now())),period_end:(0,W._)((0,Et.V)(p.date||Date.now())),type:"parking",zones:this._settings.get("app.use_region")?l?.parent_id:l?.id,rejected:!1})),(0,O.t)(1)),this.user_events=(0,T.zV)([this._options]).pipe((0,R.n)(([l])=>(0,pe.tj)({period_start:(0,W._)((0,ye.o)(l.date||Date.now())),period_end:(0,W._)((0,J.D)(l.date||Date.now())),type:"parking",email:l?.user||(0,u.Ny)()?.email})),(0,O.t)(1)),this.spaces=this.levels.pipe((0,R.n)(l=>(0,Ct.p)(l.map(p=>(0,I.bpY)(p.id,"parking-spaces").pipe((0,x.T)(_=>(_.details instanceof Array?_.details:[]).map(f=>({...f,zone_id:p.id}))))))),(0,x.T)(l=>(0,u.Bq)(l)),(0,O.t)(1)),this.active_spaces=(0,T.zV)([this.spaces,this._state.level]).pipe((0,x.T)(([l,p])=>l.filter(_=>_.zone_id===p.id))),this._users={},this._plate_numbers={},this.available_spaces=(0,T.zV)([this.events,this.active_spaces,this._parking.users]).pipe((0,x.T)(([l,p,_])=>{const f=p.filter(v=>{const m=l.find(E=>E.asset_id===v.id),y=`${m?.user_email||v.assigned_to||""}`.toLowerCase(),d=_.find(E=>E.email.toLowerCase()===y.toLowerCase());return this._users[v.id]=y,this._plate_numbers[v.id]=m?.extension_data?.plate_number||d?.plate_number||void 0,!y});return this._updateParkingSpaces(p,f),f})),this.subscription("spaces",this.available_spaces.subscribe()),this.setOptions({enable_booking:!1!==this._settings.get("app.parking.enable_maps")})}startPolling(){return this.interval("poll",()=>this._poll.next(Date.now()),1e4),this._poll.next(Date.now()),()=>this.stopPolling()}stopPolling(){this.clearInterval("poll")}setOptions(t){this._options.next({...this._options.getValue(),...t})}_updateParkingSpaces(t,n){var s=this;return(0,C.A)(function*(){const o={},a=[],r=[],l=s._settings.get("app.explore.colors")||{};let p=s._options.getValue();const _=yield s._parking.assigned_space.pipe((0,Z.s)(1)).toPromise(),f=yield s._parking.deny_parking_access.pipe((0,Z.s)(1)).toPromise(),v=yield s._parking.booked_space.pipe((0,Z.s)(1)).toPromise();for(const m of t){const y=!!n.find(w=>w.id===m.id),E=m.map_id||m.id,k=y?"free":_?"pending":"busy";if(o[`#${E}`]={fill:l[`parking-${k}`]||l[`${k}`]||B.U[`${k}`],opacity:.6},a.push({location:`${E}`,content:Re,z_index:20,hover:!0,data:{...m,user:s._users[m.id],plate_number:s._plate_numbers[m.id],status:"pending"===k&&_?"reserved":k}}),!y)continue;const N=function(){var w=(0,C.A)(function*(){if(s.on_book)return yield s.on_book(m),void s._poll.next(Date.now());if(f)return(0,u.UG)(`Your user account has been denied parking access to ${m.zone?.display_name||m.zone?.name}.`);if(_)return(0,u.UG)(`You are already assigned to parking space "${m.name||m.id}".`);if(v?.find(X=>X.id===m.id))return(0,u.UG)("You already have a parking space booked for the selected time.");if("free"!==k)return(0,u.UG)(`${m.name||"Parking Space"} is unavailable at this time.`);if(m.groups?.length&&!m.groups.find(X=>(0,u.Ny)().groups.includes(X)))return(0,u.UG)(`You are not allowed to book ${m.name}.`);s._bookings.newForm(),s._bookings.setOptions({type:"parking"}),p=s._options.getValue();let $=p.host||(0,u.Ny)();const Q=$?.email,A=s._org.levelWithID([m.zone_id||m.zone])||s._state.active_level,z=!p.date||(0,yt.r)(p.date,Date.now())?(0,de.c)(Date.now()).valueOf():(0,xt.a)(p.date,8).valueOf();s._bookings.form.patchValue({resources:[m],asset_id:m.id,asset_name:m.name,date:z,duration:660,all_day:!0,map_id:m?.map_id||m?.id,description:m.name,user:$,user_email:Q,booking_type:"parking",zones:[s._org.organisation.id,s._org.region?.id,A.parent_id,A.id]}),yield s._bookings.confirmPost().catch(X=>{throw"User cancelled"===X||(0,u.UG)(`Failed to book parking space ${m.name||m.id}. ${X.message||X.error||X}`),X}),(0,u.VX)(`Successfully booked parking space ${m.name||m.id}`),s.timeout("poll",()=>s._poll.next(Date.now()),1e3)});return function(){return w.apply(this,arguments)}}();r.push({id:E,action:"click",priority:10,callback:N})}s._state.setActions("parking",p.enable_booking?r:[]),s._state.setStyles("parking",o),s._state.setFeatures("parking",a)})()}_setBookingTime(t,n,s=!1,o=null){var a=this;return(0,C.A)(function*(){let r=null;if(a._settings.get("app.parking.allow_time_changes")){const l=(0,J.D)((0,xe.f)(Date.now(),a._settings.get("app.parking.available_period")||90)),_=yield a._dialog.open(ce,{data:{date:t,duration:n,until:l,host:s,resource:o}}).afterClosed().toPromise();if(!_)throw"User cancelled";t=_.date,n=_.duration,r=_.user}return{date:t,duration:n,user:r}})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.KVO(Y.y),e.KVO(V.O),e.KVO(u.h$),e.KVO(Ce.n),e.KVO(kt.w),e.KVO(H.bZ))};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac})}return i})();c(8796);var ue=c(2185);c(4810),c(9420);var wt=c(735),Xt=c(2372);const Pt=["space","contact","feature","user"];function Se(i){return Pt.indexOf(i.is_role?"contact":i.type)}let jt=(()=>{class i{constructor(t,n,s){this._org=t,this._settings=n,this._maps_people=s,this._emergency_contacts=new M.t([]),this._filter=new M.t(""),this._loading=new M.t(!1),this.emergency_contacts=this._emergency_contacts.asObservable(),this._role_assigned_contacts=this._org.active_building.pipe((0,j.p)(o=>!!o),(0,R.n)(o=>(0,I.bpY)(o.id,"emergency_contacts")),(0,x.T)(({details:o})=>o?.contacts||[]),(0,O.t)(1)),this._user_search=this._filter.pipe((0,G.B)(400),(0,ne.M)(()=>this._loading.next(!0)),(0,R.n)(o=>o?.length>2?this.search_fn(o).pipe((0,D.W)(()=>(0,F.of)([]))):(0,F.of)([])),(0,O.t)(1)),this._space_search=this._filter.pipe((0,G.B)(400),(0,ne.M)(()=>this._loading.next(!0)),(0,R.n)(o=>o?.length>2?(0,I.BbB)({q:o,zone_id:this._org.organisation.id}).pipe((0,x.T)(({data:a})=>a.filter(r=>r.map_id).map(r=>new wt.$({...r,level:this._org.levelWithID(r.zones)})))):(0,F.of)([])),(0,D.W)(()=>[])),this._maps_people_search=(0,T.zV)([this._maps_people.available$,this._filter,this._org.active_building]).pipe((0,G.B)(1e3),(0,R.n)(([o,a])=>o&&a.length>2?mapsindoors?.services.LocationsService.getLocations({q:a}):(0,F.of)([])),(0,x.T)(o=>o.map(a=>({id:a.properties?.externalId||a.properties?.roomId||a.roomId||a.id,map_id:a.properties?.externalId||a.properties?.roomId||a.roomId||"",type:"feature",name:a.properties?.name||"",description:`${a.properties?.roomId} , Level ${a.properties?.floorName}`}))),(0,O.t)(1)),this._map_features=this._org.active_building.pipe((0,j.p)(o=>!!o),(0,R.n)(()=>(0,I.WsZ)(this._org.building.id,{name:"map_features"}).pipe((0,D.W)(()=>(0,F.of)({details:[]})))),(0,x.T)(o=>{const a=[];for(const r of o){const l=r.metadata.map_features;if(!l)continue;const p=l.details instanceof Array?l.details:[];for(const _ of p)a.push({id:_.id,type:"feature",name:_.name,description:"",zone:r.zone})}return a})),this._poi_metadata=this._org.initialised.pipe((0,j.p)(o=>o),(0,R.n)(()=>(0,I.bpY)(this._org.organisation.id,"points-of-interest").pipe((0,D.W)(o=>(0,F.of)({details:{}})))),(0,O.t)(1)),this._poi_list=(0,T.zV)([this._org.active_building,this._poi_metadata]).pipe((0,j.p)(([o])=>!!o.id),(0,x.T)(([o,a])=>{const r=a.details||{},l=this._org.levelsForBuilding(o);return(0,u.Bq)(l.map(_=>r[_.id]||[])).filter(_=>_.can_search)})),this._points_of_interest=this._poi_list.pipe((0,x.T)(o=>o.map(a=>({id:a.id||a.location,type:"feature",name:a.name,description:"",zone:a.level_id})))),this.search_results=(0,T.zV)([this._filter,this._space_search,this._user_search,this._emergency_contacts,this._role_assigned_contacts,this._map_features,this._maps_people_search,this._points_of_interest]).pipe((0,x.T)(([o,a,r,l,p,_,f,v])=>{const m=o.toLowerCase(),y=[...f,...a.filter(d=>d.email.toLowerCase().includes(m)||d.name.toLowerCase().includes(m)||d.display_name.toLowerCase().includes(m)).map(d=>({id:d.id,type:"space",name:d.display_name||d.name,description:`Capacity: ${d.capacity} `})),...(0,u.Bq)(p.map(d=>d.roles.map(E=>({id:d.email,type:E||"contact",is_role:!0,name:d.name,description:d.email})))).filter(d=>d.name.toLowerCase().includes(m)||d.description.toLowerCase().includes(m)||d.type.toLowerCase().includes(m)),..._.filter(d=>d.name.toLowerCase().includes(m)).map(d=>({id:d.id,type:"feature",name:d.name,description:"",zone:d.zone?.id})),...v.filter(d=>d.name.toLowerCase().includes(m)),...l.map(d=>({id:d.email,type:d.type||"contact",is_role:!0,name:d.name,description:d.email})).filter(d=>d.name.toLowerCase().includes(m)||d.description.toLowerCase().includes(m)||d.type.toLowerCase().includes(m)),...r.map(d=>({id:d.email,type:"user",name:d.name,description:d.email}))];return y.sort((d,E)=>Se(d)-Se(E)||d.name.localeCompare(E.name)),y}),(0,ne.M)(()=>this._loading.next(!1)),(0,O.t)(1)),this.loading=this._loading.asObservable(),this.search_fn=o=>this._settings.get("app.basic_user_search")?(0,I.n1$)({q:o,authority_id:(0,I.kup)()?.id}).pipe((0,x.T)(a=>a.data)):(0,Xt.N8)(o),this.search_results.subscribe(),this.init()}init(){var t=this;return(0,C.A)(function*(){yield t._org.initialised.pipe((0,U.$)(s=>s)).toPromise();const n=(0,ue.WS)(t._org.binding("location_services"),"LocationServices");if(n){const s=n.binding("emergency_contacts");s.listen().subscribe(o=>{const a=[];for(const r in o)for(const l of o[r])a.push({...l,type:r});t._emergency_contacts.next(a)}),s.bind()}})()}setFilter(t){this._filter.next(t)}static#e=this.\u0275fac=function(n){return new(n||i)(e.KVO(Y.y),e.KVO(u.h$),e.KVO(u._e))};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Gt=c(5080),me=c(9771),Le=c(1134);const zt=["input"],Vt=["button"];function Bt(i,h){1&i&&e.nrm(0,"mat-spinner",10),2&i&&e.Y8G("diameter",32)}function Dt(i,h){1&i&&(e.j41(0,"mat-option",13),e.pXf(1,4),e.k0s())}function At(i,h){if(1&i){const t=e.RV6();e.j41(0,"mat-option",14),e.bIt("click",function(){const s=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.select(s))}),e.j41(1,"div",15)(2,"div",16)(3,"div",17),e.EFF(4),e.k0s(),e.j41(5,"div",18),e.EFF(6),e.k0s()(),e.j41(7,"div",19),e.EFF(8),e.k0s()()()}if(2&i){const t=h.$implicit;e.Y8G("value",t.name),e.R7$(4),e.JRh(t.name),e.R7$(2),e.JRh(t.description),e.R7$(2),e.SpI(" ",t.type," ")}}function Ut(i,h){if(1&i&&(e.qex(0),e.DNE(1,Dt,2,0,"mat-option",11),e.nI1(2,"async"),e.DNE(3,At,9,4,"mat-option",12),e.nI1(4,"async"),e.nI1(5,"slice"),e.bVm()),2&i){let t;const n=e.XpG();e.R7$(),e.Y8G("ngIf",!(null!=(t=e.bMT(2,2,n.results))&&t.length)),e.R7$(2),e.Y8G("ngForOf",e.brH(5,6,e.bMT(4,4,n.results),0,5))}}let Fe=(()=>{class i extends u.Tv{constructor(t,n,s,o){super(),this._el=t,this._search=n,this._router=s,this._route=o,this.show=!1,this.search_str="",this.right_size=!1,this.results=this._search.search_results,this.loading=this._search.loading,this.setFilter=a=>this._search.setFilter(a)}ngOnInit(){this.checkButtonPosition()}clear(){this.timeout("clear",()=>{this.show=!1,this.search_str="",this.setFilter("")})}cancelClear(){this.clearTimeout("clear")}focusInput(){this._input_el?.nativeElement&&this.timeout("focus",()=>this._input_el.nativeElement.focus(),300)}showSearch(){this.show=!0,this.focusInput()}closeSearch(t){this.show=!1,this.search_str="",this.setFilter(""),this._input_el?.nativeElement&&(this._input_el.nativeElement.focus(),this._input_el.nativeElement.blur())}select(t){this.search_str=t.name;const n={},s="space"===t.type?"space":"feature"===t.type?"locate":"user";n[s]=t.id,"locate"===s&&(n.name=t.name,n.zone=t.zone),this._router.navigate([],{relativeTo:this._route,queryParams:n}),this.focusInput()}checkButtonPosition(){const t=window.innerWidth,n=this._button_el.nativeElement.getBoundingClientRect();this.right_size=n.left+n.width/2>t/2}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.aKT),e.rXU(jt),e.rXU(S.Ix),e.rXU(S.nX))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["explore-search"]],viewQuery:function(n,s){if(1&n&&(e.GBs(zt,5),e.GBs(Vt,7)),2&n){let o;e.mGM(o=e.lsd())&&(s._input_el=o.first),e.mGM(o=e.lsd())&&(s._button_el=o.first)}},features:[e.Vt3],decls:14,vars:20,consts:()=>{let t,n;return t=$localize`:␟7a428104a6c33787961fda306f9c518f89fb0261␟6939663044582448373:Search for...`,n=$localize`:␟0c720c4e60410fcfcd8582a32297bdd397620830␟3411517965707112535: No matches found `,[["button",""],["origin","matAutocompleteOrigin"],["input",""],["auto","matAutocomplete"],n,["icon","","matRipple","",1,"bg-base-200","m-2",3,"resize","click"],["role","search","tabindex","0","matRipple","","matAutocompleteOrigin","",1,"absolute","top-1/2","-translate-y-1/2","bg-base-100","flex","items-center","z-10","overflow-hidden","outline-none","px-4","max-w-[calc(100vw-7rem)]",3,"click"],["keyboard","","placeholder",t,1,"flex-1","text-base","border-none","outline-none",3,"ngModelChange","focus","blur","ngModel","matAutocomplete","matAutocompleteConnectedTo"],["class","mr-2",3,"diameter",4,"ngIf"],[4,"ngIf"],[1,"mr-2",3,"diameter"],["class","pointer-events-none",4,"ngIf"],[3,"value","click",4,"ngFor","ngForOf"],[1,"pointer-events-none"],[3,"click","value"],[1,"flex","items-center","leading-tight","w-[22rem]","max-w-[calc(100vw-2rem)]"],[1,"flex-1","w-1/2","overflow-hidden"],[1,"truncate","w-full"],[1,"text-xs"],[1,"text-xs","font-bold","p-2","capitalize","text-white","bg-base-300","rounded"]]},template:function(n,s){if(1&n){const o=e.RV6();e.j41(0,"button",5,0),e.bIt("resize",function(){return e.eBV(o),e.Njj(s.checkButtonPosition())},!1,e.tSv)("click",function(r){return e.eBV(o),e.Njj(s.show?s.closeSearch(r):s.showSearch())}),e.j41(2,"app-icon"),e.EFF(3),e.k0s()(),e.j41(4,"div",6,1),e.bIt("click",function(){return e.eBV(o),e.Njj(s.focusInput())}),e.j41(6,"input",7,2),e.mxI("ngModelChange",function(r){return e.eBV(o),e.DH7(s.search_str,r)||(s.search_str=r),e.Njj(r)}),e.bIt("ngModelChange",function(r){return e.eBV(o),e.Njj(s.setFilter(r))})("focus",function(){return e.eBV(o),e.Njj(s.cancelClear())})("blur",function(){return e.eBV(o),e.Njj(s.clear())}),e.k0s(),e.DNE(8,Bt,1,1,"mat-spinner",8),e.nI1(9,"async"),e.k0s(),e.j41(10,"mat-autocomplete",null,3),e.DNE(12,Ut,6,10,"ng-container",9),e.nI1(13,"async"),e.k0s()}if(2&n){const o=e.sdS(5),a=e.sdS(11);e.R7$(3),e.JRh(s.show||s.search_str?"close":"search"),e.R7$(),e.AVh("right-0",s.right_size)("-translate-x-14",s.right_size)("left-0",!s.right_size)("translate-x-14",!s.right_size)("show",s.show||s.search_str),e.R7$(2),e.R50("ngModel",s.search_str),e.Y8G("matAutocomplete",a)("matAutocompleteConnectedTo",o),e.R7$(2),e.Y8G("ngIf",e.bMT(9,16,s.loading)),e.R7$(4),e.Y8G("ngIf",!0!==e.bMT(13,18,s.loading)&&(s.show||s.search_str))}},dependencies:[b.Sq,b.bT,K.R,Gt.e,me.$3,P.wT,me.pN,me.Vn,P.r6,Le.LG,g.me,g.BC,g.vS,b.Jj,b.P9],styles:["[_nghost-%COMP%]{z-index:99;position:relative}[role=search][_ngcontent-%COMP%]{height:3rem;width:0;border-radius:1.5rem;border:1px solid var(--b3);transition:width .2s opacity .2s;opacity:0;pointer-events:none}[role=search].show[_ngcontent-%COMP%]{width:24rem;opacity:1;pointer-events:auto}\n\n/*# sourceMappingURL=explore-search.component.ts-angular-inline--80.css.map*/"]})}return i})();var Ne=c(8303);c(640);var we=c(6301),Wt=(c(2035),c(795),c(3208)),Ht=c(7984);let Qt=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.$C({type:i});static#s=this.\u0275inj=e.G2t({imports:[b.MD,L.hI,g.YN,g.X1,ae.mV,Ge.z_,ze.jc,Ve.c,Be.S]})}return i})();e.wjB(Ne.x,[b.Sq,b.bT,te.I,Wt.U],[]),e.wjB(we.t,[b.bT,K.R,re.rl,re.TL,P.r6,H.tx,Ht.fg,Le.LG,g.me,g.BC,g.cb,g.j4,g.JD,Ie.y,ke.$],[b.Jj,b.vh]);var Xe=c(2168),qt=c(4658),he=c(1034),Pe=c(4992);function es(i,h){if(1&i){const t=e.RV6();e.j41(0,"div",3)(1,"div",4),e.EFF(2,"A"),e.k0s(),e.j41(3,"mat-slider",5)(4,"input",6),e.bIt("ngModelChange",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.applySetting("font_size",s))}),e.k0s()(),e.j41(5,"div",7),e.EFF(6,"A"),e.k0s(),e.j41(7,"div",8),e.EFF(8),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(3),e.Y8G("min",10)("max",24)("step",2),e.R7$(),e.Y8G("ngModel",t.font_size),e.R7$(4),e.SpI(" ",t.font_size,"px ")}}let ts=(()=>{class i extends u.Tv{constructor(t){super(),this._settings=t,this.applySetting=(n,s)=>this.timeout("apply_setting",()=>this._settings.saveUserSetting(n,s),1e3)}get dark_mode(){return"dark"===this._settings.get("theme")}get can_change_dark_mode(){return!!this._settings.get("app.general.dark_mode")}get accessible(){return!!this._settings.get("accessible")}get font_size(){return this._settings.get("font_size")||16}setDarkMode(t){this.timeout("dark_mode",()=>{const n=this._settings.get("theme");t&&"dark"!==n?this._settings.setTheme("dark"):!t&&"dark"===n&&this._settings.setTheme("light")},100)}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(u.h$))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["accessibility-controls"]],features:[e.Vt3],decls:9,vars:3,consts:[["matRipple","",1,"flex","items-center","justify-between","hover:bg-base-200","w-full","p-2","rounded",3,"click"],[3,"ngModelChange","ngModel"],["class","flex items-center pl-2 space-x-4",4,"ngIf"],[1,"flex","items-center","pl-2","space-x-4"],[1,"text-sm"],[1,"flex-1","w-px","min-w-0","text-[16px]",3,"min","max","step"],["matSliderThumb","",1,"text-[16px]",3,"ngModelChange","ngModel"],[1,"text-2xl"],[1,"text-base","py-1","px-2","rounded","bg-base-300","text-base-content","my-2"]],template:function(n,s){1&n&&(e.j41(0,"button",0),e.bIt("click",function(){return s.setDarkMode(!s.dark_mode)}),e.j41(1,"div"),e.EFF(2,"Dark Mode"),e.k0s(),e.j41(3,"mat-slide-toggle",1),e.bIt("ngModelChange",function(a){return s.setDarkMode(a)}),e.k0s()(),e.j41(4,"button",0),e.bIt("click",function(){return s.applySetting("accessible",!s.accessible)}),e.j41(5,"div"),e.EFF(6,"Text Size"),e.k0s(),e.j41(7,"mat-slide-toggle",1),e.bIt("ngModelChange",function(a){return s.applySetting("accessible",a)}),e.k0s()(),e.DNE(8,es,9,5,"div",2)),2&n&&(e.R7$(3),e.Y8G("ngModel",s.dark_mode),e.R7$(4),e.Y8G("ngModel",s.accessible),e.R7$(),e.Y8G("ngIf",s.accessible))},dependencies:[b.bT,P.r6,Pe.IV,Pe.OU,ae.sG,g.me,g.BC,g.vS]})}return i})();const ss=["app-explore",""],ns=()=>({controls:!0});function os(i,h){1&i&&e.nrm(0,"explore-search")}function is(i,h){1&i&&(e.j41(0,"div",19),e.nrm(1,"accessibility-controls"),e.k0s())}function as(i,h){if(1&i){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){const s=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.setLevel(s))}),e.EFF(1),e.k0s()}if(2&i){const t=h.$implicit;e.R7$(),e.SpI(" ",t.display_name||t.name," ")}}function rs(i,h){if(1&i&&(e.qex(0),e.j41(1,"button",21)(2,"div",13),e.EFF(3,"Level"),e.k0s(),e.j41(4,"app-icon",12),e.EFF(5,"keyboard_arrow_down"),e.k0s()(),e.j41(6,"mat-menu",null,1),e.DNE(8,as,2,1,"button",22),e.nI1(9,"async"),e.k0s(),e.bVm()),2&i){const t=e.sdS(7),n=e.XpG(2);e.R7$(),e.Y8G("matMenuTriggerFor",t),e.R7$(7),e.Y8G("ngForOf",e.bMT(9,2,n.levels))}}function ls(i,h){if(1&i&&(e.j41(0,"div",25),e.nrm(1,"div",26),e.j41(2,"div",27),e.EFF(3),e.k0s()()),2&i){const t=h.$implicit;e.R7$(),e.xc7("background-color",t.color),e.R7$(2),e.SpI(" ",t.name," ")}}function cs(i,h){if(1&i&&(e.qex(0),e.j41(1,"button",21)(2,"div",13),e.EFF(3,"Legend"),e.k0s(),e.j41(4,"app-icon",12),e.EFF(5,"keyboard_arrow_down"),e.k0s()(),e.j41(6,"mat-menu",null,2),e.DNE(8,ls,4,3,"div",24),e.k0s(),e.bVm()),2&i){const t=e.sdS(7),n=e.XpG(2);e.R7$(),e.Y8G("matMenuTriggerFor",t),e.R7$(7),e.Y8G("ngForOf",n.legend)}}function _s(i,h){if(1&i&&(e.qex(0),e.j41(1,"div",20),e.DNE(2,rs,10,4,"ng-container",7),e.nI1(3,"async"),e.DNE(4,cs,9,2,"ng-container",7),e.k0s(),e.bVm()),2&i){let t;const n=e.XpG();e.R7$(2),e.Y8G("ngIf",null==(t=e.bMT(3,2,n.levels))?null:t.length),e.R7$(2),e.Y8G("ngIf",n.legend.length)}}function ps(i,h){if(1&i){const t=e.RV6();e.j41(0,"button",29),e.nI1(1,"async"),e.bIt("click",function(){const s=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.setLevel(s))}),e.j41(2,"div",30),e.EFF(3),e.k0s()()}if(2&i){let t;const n=h.$implicit,s=e.XpG(2);e.AVh("opacity-30",n.id!==(null==(t=e.bMT(1,3,s.level))?null:t.id)),e.R7$(3),e.SpI(" ",n.display_name||n.name," ")}}function ds(i,h){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"button",11),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.show_levels=!s.show_levels)}),e.j41(2,"app-icon",12),e.EFF(3,"corporate_fare"),e.k0s(),e.j41(4,"div",13),e.EFF(5,"Level"),e.k0s(),e.j41(6,"app-icon",12),e.EFF(7),e.k0s()(),e.j41(8,"div",14)(9,"div",15),e.DNE(10,ps,4,5,"button",28),e.nI1(11,"async"),e.k0s()(),e.nrm(12,"hr",16),e.bVm()}if(2&i){const t=e.XpG();e.R7$(7),e.JRh(t.show_levels?"keyboard_arrow_up":"keyboard_arrow_down"),e.R7$(),e.Y8G("@show",t.show_levels?"show":"hide"),e.R7$(2),e.Y8G("ngForOf",e.bMT(11,3,t.levels))}}function us(i,h){if(1&i&&(e.j41(0,"div",25),e.nrm(1,"div",26),e.j41(2,"div",27),e.EFF(3),e.k0s()()),2&i){const t=h.$implicit;e.R7$(),e.xc7("background-color",t.color),e.R7$(2),e.SpI(" ",t.name," ")}}function ms(i,h){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"button",11),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.show_legend=!s.show_legend)}),e.j41(2,"app-icon",12),e.EFF(3,"place"),e.k0s(),e.j41(4,"div",13),e.EFF(5,"Legend"),e.k0s(),e.j41(6,"app-icon",12),e.EFF(7),e.k0s()(),e.j41(8,"div",14)(9,"div",15),e.DNE(10,us,4,3,"div",24),e.k0s()(),e.nrm(11,"hr",16),e.bVm()}if(2&i){const t=e.XpG();e.R7$(7),e.JRh(t.show_legend?"keyboard_arrow_up":"keyboard_arrow_down"),e.R7$(),e.Y8G("@show",t.show_legend?"show":"hide"),e.R7$(2),e.Y8G("ngForOf",t.legend)}}let je=(()=>{class i extends u.Tv{get logo(){return"dark"===this._settings.get("theme")?this._settings.get("app.logo_dark"):this._settings.get("app.logo_light")}get time(){return(0,de.c)(Date.now())}get hide_zones(){return this._settings.get("app.hide_zones")}updateZoom(t){this._state.setPositions(t,this._state.positions.center)}updateCenter(t){this._state.setPositions(this._state.positions.zoom,t)}toggleZones(t){var n=this;return(0,C.A)(function*(){const s=yield n.options.pipe((0,Z.s)(1)).toPromise(),o=t?s.disable.filter(a=>"zones"!==a&&"devices"!==a)||[]:(0,u.Am)([...s.disable||[],"zones","devices"]);n.setOptions({disable:o})})()}get can_search(){return!!this._settings.get("app.explore.search_enabled")}constructor(t,n,s,o,a,r,l,p,_,f,v,m,y){super(),this._state=t,this._s=n,this._desks=s,this._zones=o,this._parking=a,this._settings=r,this._org=l,this._spaces=p,this._dialog=_,this._route=f,this._router=v,this._space_pipe=m,this._maps=y,this.reset_delay=180,this.show_levels=!0,this.show_legend=!1,this.show_accessibility=!1,this.legend=[{id:"free",name:"Space Available",color:"#43a047"},{id:"busy",name:"Space In Use",color:"#e53935"},{id:"pending",name:"Space Pending",color:"#ffb300"},{id:"not-bookable",name:"Space Not-bookable",color:"#ccc"}],this.levels=(0,T.zV)([this._org.active_region,this._org.active_building]).pipe((0,x.T)(([d,E])=>(this._settings.get("app.use_region")?(0,u.Bq)(this._org.buildings.filter(k=>d.id===k.parent_id).map(k=>this._org.levelsForBuilding(k).map(N=>({...N,display_name:`${k.display_name} - ${N.display_name}`})))):this._org.levelsForBuilding(E))||[])),this.level=this._state.level,this.url=this._state.map_url,this.styles=this._state.map_styles,this.positions=this._state.map_positions,this.features=this._state.map_features,this.actions=this._state.map_actions,this.labels=this._state.map_labels,this.options=this._state.options,this.locate="",this.onMouse=()=>this.timeout("reset",()=>this.resetKiosk(),1e3*this.reset_delay),this.onTouch=()=>this.timeout("reset",()=>this.resetKiosk(),1e3*this.reset_delay),this.setOptions=d=>this._state.setOptions(d),this.setLevel=d=>this._state.setLevel(d.id),this.use_mapsindoors$=this._maps.available$}ngOnInit(){var t=this;return(0,C.A)(function*(){(location.hash.includes("public=true")||location.search.includes("public=true"))&&t._state.setOptions({is_public:!0}),yield t._spaces.initialised.pipe((0,U.$)(n=>n)).toPromise(),t._desks.setOptions({custom:!0}),t.reset_delay=t._settings.get("app.inactivity_timeout_secs")||180,t.resetKiosk(!1),L.eW.enabled="true"===localStorage.getItem("OSK.enabled"),t.subscription("level",t._state.level.subscribe(()=>t.timeout("update_location",()=>{t._state.setFeatures("_located",[])}))),t.subscription("route.query",t._route.queryParamMap.subscribe(function(){var n=(0,C.A)(function*(s){if(s.has("level")){(0,u.Rm)("Explore","Level changed to:",s.get("level")),t._state.setLevel(s.get("level"));const o=t._org.levelWithID([s.get("level")]);if(!o)return;const a=t._org.buildings.find(r=>o.parent_id===r.id);if(!a)return;t._org.building=a}if(t._state.setFeatures("_located",[]),s.has("space"))(0,u.Rm)("Explore","Focusing on space:",s.get("space")),t.locateSpace(s.get("space"));else if(s.has("user")){(0,u.Rm)("Explore","Focusing on user:",s.get("user"));let o=t._settings.value("last_search");if((!o||s.get("user")!==o.email)&&(o=null,o=yield(0,q.SZ)(s.get("user")).toPromise()),!o)return(0,u.UG)(`Unable to user details for ${s.get("user")}`);t.locateUser(o instanceof Array?o[0]:o).catch(a=>{(0,u.UG)(`Unable to locate ${s.get("user")}`),t._router.navigate([],{relativeTo:t._route,queryParams:{}})})}else s.has("feature")?((0,u.Rm)("Explore","Focusing on feature:",s.get("feature")),t.timeout("update_location",()=>{t._state.setFeatures("_located",[{location:s.get("feature"),content:L.VT,data:{}}])})):s.has("locate")?((0,u.Rm)("Explore","Focusing on location:",s.get("locate")),t.locate=s.get("locate"),t.timeout("update_location",()=>{t._state.setFeatures("_located",[{location:s.get("locate"),content:L.VT,data:{}}])})):t.timeout("update_location",()=>{t._state.setFeatures("_located",[])})});return function(s){return n.apply(this,arguments)}}()))})()}locateSpace(t){var n=this;return(0,C.A)(function*(){const s=yield n._space_pipe.transform(t);if(!s)return;n._state.setLevel(n._org.levelWithID(s.zones)?.id);const o={location:s.map_id,content:L.VT,data:{message:`${s.display_name||s.name} is here`}};n.timeout("update_location",()=>n._state.setFeatures("_located",[o]))})()}locateUser(t){var n=this;return(0,C.A)(function*(){let s=n._org.binding("location_services");if(!s)return;"string"==typeof s&&(s={system_id:s,module:"LocationServices"});const a=(yield(0,I.f_4)(s.system_id,s.module).execute("locate_user",[t.email,t.username||t.id])).map(_=>new q.g8(_));if(a.sort((_,f)=>s.priority.indexOf(_.type)-s.priority.indexOf(f.type)),!a?.length)throw"No locations for the given user";n._state.setLevel(n._org.levelWithID([a[0]?.level])?.id);const r=a[0].position,{coordinates_from:l}=a[0],p={location:"wireless"===a[0].type?{x:l?.includes("right")?1-r.x:r.x,y:l?.includes("bottom")?1-r.y:r.y}:r,content:"wireless"===a[0].type?L.o:L.VT,z_index:99,data:{message:`${t.name} is here`,radius:a[0].variance,last_seen:a[0].last_seen}};n.timeout("update_location",()=>{n._state.setFeatures("_located",[p])})})()}resetKiosk(t=!0){document.activeElement?.blur&&document.activeElement?.blur();const n=localStorage.getItem("KIOSK.level");this._state.setPositions(1,{x:.5,y:.5}),n&&this._state.setLevel(n),this._dialog.closeAll(),t&&this._router.navigate(["/"])}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(V.O),e.rXU(B.s),e.rXU(oe),e.rXU(se),e.rXU(ie),e.rXU(u.h$),e.rXU(ue.yb),e.rXU(Xe.bh),e.rXU(H.bZ),e.rXU(S.nX),e.rXU(S.Ix),e.rXU(ee.J),e.rXU(u._e))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["","app-explore",""]],hostBindings:function(n,s){1&n&&e.bIt("mousedown",function(){return s.onMouse()},!1,e.tSv)("touchstart",function(){return s.onTouch()},!1,e.tSv)},features:[e.Jv_([B.s,oe,se,ie,ee.J]),e.Vt3],attrs:ss,decls:39,vars:35,consts:[["accessibility_controls",""],["levelMenu","matMenu"],["legendMenu","matMenu"],["topbar","",1,"relative","flex","items-center","justify-between","px-4","py-2","border-b","border-base-300","bg-base-100","text-base-content"],["matRipple","","routerLink","/",1,"text-2xl","rounded","p-2"],[1,"text-primary"],[1,"absolute","top-1/2","-translate-y-1/2","right-2","flex","items-center"],[4,"ngIf"],["icon","","matRipple","","customTooltip","",1,"bg-base-200","flex","sm:hidden",3,"content"],[1,"flex","flex-1","h-1/2"],["sidebar","",1,"w-[20rem]","hidden","sm:block","bg-base-100","text-base-content","border-r","border-base-300","px-2","py-4"],["btn","","matRipple","",1,"flex","items","clear","w-full","space-x-4","hover:bg-base-200",3,"click"],[1,"text-2xl"],[1,"flex-1","text-left","font-medium"],[1,"px-8"],[1,"py-4","space-y-2"],[1,"w-[calc(100%-4rem)]","mx-auto"],[1,"relative","flex-1","h-full"],[3,"zoomChange","centerChange","src","zoom","center","styles","features","actions","labels","options","focus"],[1,"bg-base-100","rounded","p-2","w-[18rem]"],["options","",1,"flex","sm:hidden","items-center","bg-base-content","text-base-100","p-2","space-x-2"],["btn","","matRipple","",1,"clear","text-base-100",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],["class","flex items-center py-2 px-4 rounded hover:bg-base-200 w-full space-x-4",4,"ngFor","ngForOf"],[1,"flex","items-center","py-2","px-4","rounded","hover:bg-base-200","w-full","space-x-4"],[1,"h-3","w-3","rounded-full"],[1,"text-left","opacity-60"],["btn","","matRipple","","class","clear hover:bg-base-200 hover:opacity-100 w-full",3,"opacity-30","click",4,"ngFor","ngForOf"],["btn","","matRipple","",1,"clear","hover:bg-base-200","hover:opacity-100","w-full",3,"click"],[1,"text-left","w-full"]],template:function(n,s){if(1&n){const o=e.RV6();e.j41(0,"div",3)(1,"a",4),e.EFF(2," Place"),e.j41(3,"span",5),e.EFF(4,"OS"),e.k0s()(),e.j41(5,"div",6),e.DNE(6,os,1,0,"explore-search",7),e.j41(7,"button",8)(8,"app-icon"),e.EFF(9,"accessible"),e.k0s()(),e.DNE(10,is,2,0,"ng-template",null,0,e.C5r),e.k0s()(),e.DNE(12,_s,5,4,"ng-container",7),e.nI1(13,"async"),e.j41(14,"div",9)(15,"div",10),e.DNE(16,ds,13,5,"ng-container",7),e.nI1(17,"async"),e.DNE(18,ms,12,3,"ng-container",7),e.j41(19,"button",11),e.bIt("click",function(){return e.eBV(o),e.Njj(s.show_accessibility=!s.show_accessibility)}),e.j41(20,"app-icon",12),e.EFF(21,"accessible"),e.k0s(),e.j41(22,"div",13),e.EFF(23," Accessibility "),e.k0s(),e.j41(24,"app-icon",12),e.EFF(25),e.k0s()(),e.j41(26,"div",14)(27,"div",15),e.nrm(28,"accessibility-controls"),e.k0s()(),e.nrm(29,"hr",16),e.k0s(),e.j41(30,"div",17)(31,"interactive-map",18),e.nI1(32,"async"),e.nI1(33,"async"),e.nI1(34,"async"),e.nI1(35,"async"),e.nI1(36,"async"),e.nI1(37,"async"),e.nI1(38,"async"),e.bIt("zoomChange",function(r){return e.eBV(o),e.Njj(s.updateZoom(r))})("centerChange",function(r){return e.eBV(o),e.Njj(s.updateCenter(r))}),e.k0s()()()}if(2&n){let o,a,r,l;const p=e.sdS(11);e.R7$(6),e.Y8G("ngIf",s.can_search),e.R7$(),e.Y8G("content",p),e.R7$(5),e.Y8G("ngIf",(null==(o=e.bMT(13,16,s.levels))?null:o.length)||s.legend.length),e.R7$(4),e.Y8G("ngIf",null==(a=e.bMT(17,18,s.levels))?null:a.length),e.R7$(2),e.Y8G("ngIf",s.legend.length),e.R7$(7),e.JRh(s.show_accessibility?"keyboard_arrow_up":"keyboard_arrow_down"),e.R7$(),e.Y8G("@show",s.show_accessibility?"show":"hide"),e.R7$(5),e.Y8G("src",e.bMT(32,20,s.url))("zoom",null==(r=e.bMT(33,22,s.positions))?null:r.zoom)("center",null==(l=e.bMT(34,24,s.positions))?null:l.center)("styles",e.bMT(35,26,s.styles))("features",e.bMT(36,28,s.features))("actions",e.bMT(37,30,s.actions))("labels",e.bMT(38,32,s.labels))("options",e.lJ4(34,ns))("focus",s.locate)}},dependencies:[b.Sq,b.bT,S.Wk,K.R,_e.S,te.I,he.kk,he.fb,he.Cp,P.r6,Fe,ts,b.Jj],styles:["[_nghost-%COMP%]{position:absolute;display:flex;flex-direction:column;inset:0;background-color:var(--b2)}hr[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}\n\n/*# sourceMappingURL=explore.component.ts-angular-inline--84.css.map*/"],data:{animation:[u.Ft]}})}return i})();const hs=[{path:"",component:je},{path:":search_type",component:je}];let fs=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.$C({type:i});static#s=this.\u0275inj=e.G2t({imports:[b.MD,S.iI.forChild(hs),L.hI,Xe.lx,qt.u,g.YN,Qt]})}return i})()}}]);
//# sourceMappingURL=apps_visitor-kiosk_src_app_explore_module_ts.js.map