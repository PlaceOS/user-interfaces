(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{cKIz:function(e,t,n){"use strict";n.r(t),n.d(t,"DayViewModule",(function(){return H}));var i=n("2kYt"),s=n("nIj0"),o=n("sEIs"),c=n("oRDy"),a=n("6CBO"),l=n("mjT4"),r=n("EM62"),d=n("UfDH"),b=n("D57K"),u=n("jOdJ"),h=n("20lr"),f=n("HWRp"),g=n("dJst"),p=n("PBFl"),v=n("0/Ep"),m=n("29Wa"),w=n("R7+U"),_=n("k8N0"),k=n("wrRZ"),y=n("mFH5");function O(e,t){if(1&e&&(r.Vb(0,"mat-option",11),r.Lc(1),r.Ub()),2&e){const e=t.$implicit;r.qc("value",e.id),r.Db(1),r.Nc(" ",e.display_name||e.name," ")}}const x=function(){return{class:"material-icons",content:"add"}};let M=(()=>{class e extends h.b{constructor(e,t,n,i){super(),this._state=e,this._org=t,this._route=n,this._router=i,this.zones=[],this.levels=this._org.active_levels,this.options=this._state.options,this.setDate=e=>this._state.setDate(e),this.setWeekends=e=>this._state.setUIOptions({show_weekends:e}),this.newBooking=e=>this._state.newBooking(e),this.updateZones=e=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:e.join(",")}}),this._state.setZones(e)}}ngOnInit(){return Object(b.a)(this,void 0,void 0,(function*(){yield this._org.initialised.pipe(Object(u.a)(e=>e)).toPromise(),this.subscription("route.query",this._route.queryParamMap.subscribe(e=>{if(e.has("zone_ids")){const t=e.get("zone_ids").split(",");if(t.length){const e=this._org.levelWithID(t);if(!e)return;this._org.building=this._org.buildings.find(t=>t.id===e.parent_id),this.zones=t}}})),this.subscription("levels",this._org.active_levels.subscribe(e=>{this.zones=this.zones.filter(t=>e.find(e=>e.id===t)),!this.zones.length&&e.length&&this.zones.push(e[0].id),this.updateZones(this.zones)}))}))}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(f.a),r.Pb(g.c),r.Pb(o.a),r.Pb(o.d))},e.\u0275cmp=r.Jb({type:e,selectors:[["week-view-topbar"]],features:[r.Ab],decls:15,vars:9,consts:[["mat-button","",1,"w-12","xl:w-auto",3,"click"],[1,"flex","items-center"],[1,"mr-2",3,"icon"],[1,"hidden","xl:block"],["appearance","outline"],["multiple","","placeholder","All Levels",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"m-2",3,"ngModel","ngModelChange"],[1,"text-xs"],[1,"flex-1","w-0"],[3,"dateChange"],[3,"value"]],template:function(e,t){if(1&e&&(r.Vb(0,"button",0),r.fc("click",(function(){return t.newBooking()})),r.Vb(1,"div",1),r.Qb(2,"app-icon",2),r.Vb(3,"div",3),r.Lc(4,"New Booking"),r.Ub(),r.Ub(),r.Ub(),r.Vb(5,"mat-form-field",4),r.Vb(6,"mat-select",5),r.fc("ngModelChange",(function(e){return t.zones=e}))("ngModelChange",(function(e){return t.updateZones(e)})),r.Jc(7,O,2,2,"mat-option",6),r.kc(8,"async"),r.Ub(),r.Ub(),r.Vb(9,"mat-slide-toggle",7),r.fc("ngModelChange",(function(e){return t.setWeekends(e)})),r.kc(10,"async"),r.Vb(11,"div",8),r.Lc(12,"Show weekends"),r.Ub(),r.Ub(),r.Qb(13,"div",9),r.Vb(14,"date-options",10),r.fc("dateChange",(function(e){return t.setDate(e)})),r.Ub()),2&e){let e=null;r.Db(2),r.qc("icon",r.rc(8,x)),r.Db(4),r.qc("ngModel",t.zones),r.Db(1),r.qc("ngForOf",r.lc(8,4,t.levels)),r.Db(2),r.qc("ngModel",null==(e=r.lc(10,6,t.options))?null:e.show_weekends)}},directives:[p.b,v.a,m.c,w.a,s.l,s.o,i.m,_.a,k.a,y.j],pipes:[i.b],styles:["[_nghost-%COMP%] {\n                display: flex;\n                align-items: center;\n                background-color: #fff;\n                height: 5em;\n                padding: 0 1em;\n            }\n\n            button[_ngcontent-%COMP%] {\n                min-width: 0;\n                padding: 0 .85rem;\n            }\n\n            mat-form-field[_ngcontent-%COMP%] {\n                height: 3.25em;\n                width: 8em;\n                margin-left: 1em;\n            }"]}),e})();var P=n("XyEp"),C=n("zYp8"),D=n("KuCG"),j=n("C05f"),U=n("HM3f"),q=n("YtkY");let V=(()=>{class e{constructor(e){this._state=e,this.view=e=>this._state.setEvent(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(f.a))},e.\u0275cmp=r.Jb({type:e,selectors:[["week-view-event"]],inputs:{event:"event"},decls:8,vars:9,consts:[["content","","matRipple","",3,"click"],[1,"text-base"],[1,"text-sm"]],template:function(e,t){1&e&&(r.Vb(0,"div",0),r.fc("click",(function(){return t.view(t.event)})),r.Vb(1,"div",1),r.Lc(2),r.Ub(),r.Vb(3,"div",2),r.Lc(4),r.kc(5,"date"),r.Ub(),r.Vb(6,"div",2),r.Lc(7),r.Ub(),r.Ub()),2&e&&(r.Fb("m-2 p-2 bg-white shadow rounded border-2 text-black text-left font-normal "+("done"===t.event.state?"done":null==t.event?null:t.event.type)),r.Db(2),r.Mc(null==t.event?null:t.event.title),r.Db(2),r.Mc(r.mc(5,6,null==t.event?null:t.event.date,"shortTime")),r.Db(3),r.Oc(" ",null==t.event?null:t.event.attendees.length," Attendee",1===(null==t.event?null:t.event.attendees.length)?"":"s"," "))},directives:[y.m],pipes:[i.f],styles:["button[_ngcontent-%COMP%] {\n                background: none !important;\n                border: none !important;\n            }\n\n            [content][_ngcontent-%COMP%] {\n                width: calc(100% - 1rem);\n            }\n\n            .done[_ngcontent-%COMP%] {\n                opacity: 0.5;\n            }\n\n            .done[_ngcontent-%COMP%]:hover {\n                opacity: 1;\n            }\n\n            .cancelled[_ngcontent-%COMP%] {\n                border-color: #626262;\n            }\n\n            .external[_ngcontent-%COMP%] {\n                border-color: #d85be0;\n            }\n\n            .internal[_ngcontent-%COMP%] {\n                border-color: #00a4c7;\n            }"]}),e})();function I(e,t){1&e&&r.Qb(0,"week-view-event",5),2&e&&r.qc("event",t.$implicit)}function J(e,t){if(1&e&&(r.Tb(0),r.Jc(1,I,1,1,"week-view-event",4),r.kc(2,"async"),r.Sb()),2&e){const e=r.jc();r.Db(1),r.qc("ngForOf",r.lc(2,1,e.events))}}function z(e,t){1&e&&(r.Vb(0,"p",6),r.Lc(1,"No events"),r.Ub())}let F=(()=>{class e{constructor(e){this._state=e,this._index=new j.a(0),this.date=this._state.date.pipe(Object(q.a)(e=>Object(P.a)(Object(C.a)(e),this.index).valueOf())),this.events=Object(U.b)([this._state.filtered_week,this._state.date,this._index]).pipe(Object(q.a)(e=>{const[t,n,i]=e,s=Object(P.a)(Object(C.a)(n),i).valueOf(),o=Object(D.a)(s).valueOf();return t.filter(e=>Object(h.w)(s,o,e.date,e.date+60*e.duration*1e3))}))}ngOnChanges(e){e.index&&this._index.next(this.index)}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(f.a))},e.\u0275cmp=r.Jb({type:e,selectors:[["week-view-day"]],inputs:{index:"index"},features:[r.Bb],decls:9,vars:10,consts:[[1,"flex","items-center","justify-center","border-b","border-gray-200","bg-gray-500","w-full","py-3","text-white"],[1,"flex-1","h-1/2","overflow-auto","w-full"],[4,"ngIf","ngIfElse"],["empty_state",""],[3,"event",4,"ngFor","ngForOf"],[3,"event"],[1,"text-center","p-2"]],template:function(e,t){if(1&e&&(r.Vb(0,"header",0),r.Lc(1),r.kc(2,"date"),r.kc(3,"async"),r.Ub(),r.Vb(4,"div",1),r.Jc(5,J,3,3,"ng-container",2),r.kc(6,"async"),r.Ub(),r.Jc(7,z,2,0,"ng-template",null,3,r.Kc)),2&e){const e=r.vc(8);let n=null;r.Db(1),r.Nc(" ",r.mc(2,3,r.lc(3,6,t.date),"EEE, MMM d, y")," "),r.Db(4),r.qc("ngIf",null==(n=r.lc(6,8,t.events))?null:n.length)("ngIfElse",e)}},directives:[i.n,i.m,V],pipes:[i.f,i.b],styles:["[_nghost-%COMP%] {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                height: 100%;\n            }"]}),e})();var E=n("66mq"),L=n("aFyq");function Q(e,t){if(1&e&&(r.Tb(0),r.Qb(1,"week-view-day",5),r.Sb()),2&e){const e=r.jc().$implicit;r.Db(1),r.qc("index",e)}}function B(e,t){if(1&e&&(r.Tb(0),r.Jc(1,Q,2,1,"ng-container",4),r.kc(2,"async"),r.Sb()),2&e){const e=t.$implicit,n=r.jc();r.Db(1),r.qc("ngIf",0!==e&&6!==e||r.lc(2,1,n.options).show_weekends)}}function N(e,t){1&e&&r.Qb(0,"mat-progress-bar",6)}function T(e,t){if(1&e&&(r.Qb(0,"view-event-details",7),r.kc(1,"async")),2&e){const e=r.jc();r.qc("event",r.lc(1,1,e.event))}}let W=(()=>{class e{constructor(e){this._state=e,this.weekdays=[0,1,2,3,4,5,6],this.options=this._state.options,this.event=this._state.event,this.loading=this._state.loading}ngOnInit(){this._state.startPollingWeek()}ngOnDestroy(){this._state.stopPolling()}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(f.a))},e.\u0275cmp=r.Jb({type:e,selectors:[["week-view-timeline"]],decls:6,vars:7,consts:[[1,"flex","divide-x","border-gray-400","h-full"],[4,"ngFor","ngForOf"],["mode","indeterminate",4,"ngIf"],[3,"event",4,"ngIf"],[4,"ngIf"],[1,"h-full","flex-1",3,"index"],["mode","indeterminate"],[3,"event"]],template:function(e,t){1&e&&(r.Vb(0,"div",0),r.Jc(1,B,3,3,"ng-container",1),r.Ub(),r.Jc(2,N,1,0,"mat-progress-bar",2),r.kc(3,"async"),r.Jc(4,T,2,3,"view-event-details",3),r.kc(5,"async")),2&e&&(r.Db(1),r.qc("ngForOf",t.weekdays),r.Db(1),r.qc("ngIf",r.lc(3,3,t.loading)),r.Db(2),r.qc("ngIf",r.lc(5,5,t.event)))},directives:[i.m,i.n,F,E.a,L.a],pipes:[i.b],styles:["[_nghost-%COMP%] {\n                position: relative;\n                height: 100%;\n                width: 100%;\n                overflow: hidden;\n            }"]}),e})();const R=["app-weekview",""],Z=[{path:"",component:(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Jb({type:e,selectors:[["","app-weekview",""]],attrs:R,decls:4,vars:0,consts:[[1,"relative","overflow-hidden"]],template:function(e,t){1&e&&(r.Qb(0,"sidebar"),r.Vb(1,"main",0),r.Qb(2,"week-view-topbar"),r.Qb(3,"week-view-timeline"),r.Ub())},directives:[d.a,M,W],styles:["[_nghost-%COMP%] {\n                display: flex;\n                height: 100%;\n                width: 100%;\n                background: var(--bg);\n            }\n\n            sidebar[_ngcontent-%COMP%] {\n                height: 100%;\n            }\n\n            main[_ngcontent-%COMP%] {\n                display: flex;\n                flex-direction: column;\n                flex: 1;\n                min-width: 50%;\n                height: 100%;\n            }"]}),e})()}];let H=(()=>{class e{}return e.\u0275mod=r.Nb({type:e}),e.\u0275inj=r.Mb({factory:function(t){return new(t||e)},imports:[[i.c,s.h,c.a,a.a,l.c,o.g.forChild(Z)]]}),e})()}}]);
//# sourceMappingURL=week-view-week-view-module.ec25684b7f58e89dc9c5.js.map