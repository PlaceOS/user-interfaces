(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([["main"],{7004:fe=>{function re(m){return Promise.resolve().then(()=>{var le=new Error("Cannot find module '"+m+"'");throw le.code="MODULE_NOT_FOUND",le})}re.keys=()=>[],re.resolve=re,re.id=7004,fe.exports=re},9548:(fe,re,m)=>{"use strict";var le={};m.r(le),m.d(le,{default:()=>Ul});var Ne=m(4919),e=m(8946),Gn=m(9613),Xn=m(4301),_=m(9298),J=m(1560),Dt=m(7127),Bt=m(5579),W=m(9034),F=m(3176),ee=m(4813),A=m(3786),H=m(88),E=m(6491),Kn=m(1318);let O=(()=>{class n{constructor(){this._timers={},this._intervals={},this._subscriptions={},this._initialised=new E.X(!1),this.initialised=this._initialised.asObservable()}get is_initialised(){return this._initialised.getValue()}ngOnDestroy(){this.destroy()}destroy(){for(const t in this._timers)t in this._timers&&this.clearTimeout(t);for(const t in this._intervals)t in this._intervals&&this.clearInterval(t);for(const t in this._subscriptions)t in this._subscriptions&&this.unsub(t)}timeout(t,i,s=300){if(!(t&&i&&i instanceof Function))throw new Error(t?"Cannot create named timeout without a name":"Cannot create a timeout without a callback");this.clearTimeout(t),this._timers[t]=setTimeout(()=>{i(),this._timers[t]=null},s)}clearTimeout(t){this._timers[t]&&(clearTimeout(this._timers[t]),this._timers[t]=null)}interval(t,i,s=300){if(!(t&&i&&i instanceof Function))throw new Error(t?"Cannot create named interval without a name":"Cannot create a interval without a callback");this.clearInterval(t),this._intervals[t]=setInterval(()=>i(),s)}clearInterval(t){this._intervals[t]&&(clearInterval(this._intervals[t]),this._intervals[t]=null)}subscription(t,i){this.unsub(t),this._subscriptions[t]=i}unsub(t){this._subscriptions&&this._subscriptions[t]&&(this._subscriptions[t]instanceof Kn.w?this._subscriptions[t].unsubscribe():this._subscriptions[t](),this._subscriptions[t]=null)}unsubWith(t){const i=Object.keys(this._subscriptions).filter(s=>s.includes(t));for(const s of i)this.unsub(s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var q=m(8931);function Wn(n,o){if(1&n&&(e.TgZ(0,"main",4),e._UZ(1,"app-icon",5),e._UZ(2,"p",6),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("icon",t.icon),e.xp6(1),e.Q6J("innerHTML",t.content,e.oJD)}}function ei(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"footer",7),e.TgZ(1,"button",8),e._uU(2),e.qZA(),e.TgZ(3,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().onConfirm()}),e._uU(4),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.hij(" ",t.cancel_text," "),e.xp6(2),e.hij(" ",t.confirm_text," ")}}function ti(n,o){if(1&n&&(e.TgZ(0,"main",10),e.TgZ(1,"div",11),e._UZ(2,"mat-spinner",12),e.TgZ(3,"p"),e._uU(4),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(t.loading)}}const ni={height:"auto",width:"24em",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)"};let dt=(()=>{class n{constructor(t,i){this._dialog_ref=t,this._data=i,this.event=new e.vpe,this.title=this._data.title||"Confirm",this.content=this._data.content||"Are you sure?",this.confirm_text=this._data.confirm_text||"Accept",this.cancel_text=this._data.cancel_text||"Cancel",this.icon=this._data.icon||{class:"material-icons",content:"done"},this.disableClose=()=>this._dialog_ref.disableClose=!0,this.enableClose=()=>this._dialog_ref.disableClose=!1}onConfirm(){this.event.emit({reason:"done"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(q.so),e.Y36(q.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["confirm-modal"]],outputs:{event:"event"},decls:7,vars:4,consts:[["mat-dialog-title",""],["class","flex flex-col items-center space-y-2 p-4",4,"ngIf","ngIfElse"],["class","flex items-center justify-center p-2 space-x-2",4,"ngIf"],["load_state",""],[1,"flex","flex-col","items-center","space-y-2","p-4"],[1,"text-5xl",3,"icon"],["content","",1,"text-center","text-sm","w-[22rem]",3,"innerHTML"],[1,"flex","items-center","justify-center","p-2","space-x-2"],["mat-button","","mat-dialog-close","",1,"inverse","w-32"],["mat-button","","name","accept",1,"w-32",3,"click"],["loading",""],[1,"w-full","h-48","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"]],template:function(t,i){if(1&t&&(e.TgZ(0,"header"),e.TgZ(1,"h3",0),e._uU(2),e.qZA(),e.qZA(),e.YNc(3,Wn,3,2,"main",1),e.YNc(4,ei,5,2,"footer",2),e.YNc(5,ti,5,1,"ng-template",null,3,e.W1O)),2&t){const s=e.MAs(6);e.xp6(2),e.Oqu(i.title),e.xp6(1),e.Q6J("ngIf",!i.loading)("ngIfElse",s),e.xp6(1),e.Q6J("ngIf",!i.loading)}},styles:[""]}),n})(),Yt="APP";function Vt(n){Yt=n}function ie(n,o,t,i="debug",s=!1,a=Yt){if(window.debug||s){const r=["color: #E91E63","color: #3F51B5","color: default"];t?console[i](`%c[${a}]%c[${n}] %c${o}`,...r,t):console[i](`%c[${a}]%c[${n}] %c${o}`,...r)}}function ge(n,o){const t=n[0];return o&&t in o?n.length>1?ge(n.slice(1),o[t]||{}):o[t]:null}function ve(n=[],o=""){return n.filter((t,i,s)=>s.indexOf(s.find(o?a=>a[o]===t[o]:a=>a===t))===i)}function Ge(n,o=0){return Math.floor(Math.random()*(n-o))+o}function mt(n,o){return(0,A.mG)(this,void 0,void 0,function*(){const t=o.open(dt,Object.assign(Object.assign({},ni),{data:n}));return Object.assign(Object.assign({},yield Promise.race([t.componentInstance.event.pipe((0,H.P)(i=>"done"===i.reason)).toPromise(),t.afterClosed().toPromise()])),{loading:i=>t.componentInstance.loading=i,close:()=>t.close()})})}function Te(n,o,t,i){return n>=t&&n<i||o>t&&o<i||t>=n&&t<o||i>n&&i<=o}const ai=function(n){let o=1779033703^n.length;for(let t=0;t<n.length;t++)o=Math.imul(o^n.charCodeAt(t),3432918353),o=o<<13|o>>>19;return function(){return o=Math.imul(o^o>>>16,2246822507),o=Math.imul(o^o>>>13,3266489909),(o^=o>>>16)>>>0}}("PlaceOS"),ri=(n=2654435769,o=608135816,t=3084996962,i=ai(),function(){let s=(n>>>=0)+(o>>>=0)|0;return n=o^o>>>9,o=(t>>>=0)+(t<<3)|0,s=s+(i=1+(i>>>=0)|0)|0,t=(t=t<<21|t>>>11)+s|0,(s>>>0)/4294967296});var n,o,t,i;function v(n=100,o=0){return Math.floor(ri()*(n-o))+o}function Qt(){return function(){const o=(new Date).toLocaleTimeString(document.querySelector("html").getAttribute("lang")||navigator.language).toLowerCase();return o.indexOf("am")<0&&o.indexOf("pm")<0}()?"HH:mm":"h:mm a"}const di=["control","shift","alt","meta","os"];let mi=(()=>{class n{constructor(){this.keydown_states={},this.keydown_observers={},this.combo_end=[],this.registered_combos=[],this.counter=0,window.addEventListener("keydown",t=>{const i=this.mapKey((t.code||"").toLowerCase());this.last_down!==i&&(this.keydown_states[i]||(this.keydown_states[i]=new E.X(null),this.keydown_observers[i]=this.keydown_states[i].asObservable()),this.keydown_states[i].next(++this.counter),this.combo_end.indexOf(i)>=0&&t.preventDefault(),this.last_down=i)}),window.addEventListener("keyup",t=>{const i=this.mapKey((t.code||"").toLowerCase());this.keydown_states[i].next(null),this.last_down===i&&(this.last_down=null)})}listen(t,i){const s=(t=t instanceof Array?t:t.split("+")).map(a=>this.mapKey(a.toLowerCase()));if(s.length>0&&this.validCombination(s)){this.registered_combos.push(s);const a=s[s.length-1];return this.keydown_states[a]||(this.keydown_states[a]=new E.X(null),this.keydown_observers[a]=this.keydown_states[a].asObservable()),this.updateCombinationEndList(),this.keydown_observers[a].subscribe(r=>{if(r){const c=[];if(s.length>0){for(const d of s){const k=this.keydown_states[d];c.push(k&&k.getValue()||-1)}for(let d=0;d<s.length-1;d++)if(c[d]>c[d+1])return}c.reduce((d,k)=>d+(k>0?1:-1),0)>=s.length&&i()}})}return null}mapKey(t){return t.indexOf("alt")>=0||t.indexOf("shift")>=0||t.indexOf("control")>=0?t.replace("left","").replace("right",""):t}updateCombinationEndList(){for(const i of this.registered_combos)this.combo_end.push(i[i.length-1]);this.combo_end=ve([])}validCombination(t){let i=0;for(const s of t)di.indexOf(s)<0&&i++;return i>0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Xe=m(7326),j=m(7487);const zt={debug:!0,composer:{domain:"",route:"/bookings",protocol:"",port:"",use_domain:!1,local_login:!1},app:{name:"Bookings",title:"PlaceOS",description:"Bookings UI",short_name:"PlaceOS",logo:{type:"img",src:"assets/logo-light.svg"},logo_dark:{type:"img",src:"assets/logo-dark.svg"},general:{}}};var b=m(8566),_i=m(5318),hi=m(7859),Z=m(3927);let Ze="@place.tech";class te{constructor(o={}){var t,i,s,a;this.id=o.id||"",this.name=o.name||"",this.email=o.email||"",this.first_name=o.first_name||o.name||"",this.last_name=o.last_name||"",this.phone=o.phone||"",this.organisation=o.organisation||"",this.notes=o.notes||"",this.photo=o.photo||"",this.username=o.username||"",this.organizer=!!o.organizer,this.groups=o.groups||[],this.checked_in=!!o.checked_in,this.required=null===(t=o.required)||void 0===t||t,this.response_status=o.response_status||"";const r=o.groups||[];o.sys_admin&&r.push("placeos_admin"),o.support&&r.push("placeos_support"),this.groups=r,this.extension_data=o.extension_data||{},this.extension_data.assistance_required=o.assistance_required||this.extension_data.assistance_required,this.is_external=!(null===(i=this.email)||void 0===i?void 0:i.endsWith(`${Ze}`)),this.visit_expected=null===(s=o.visit_expected)||void 0===s||s,this.assistance_required=!!(null===(a=this.extension_data)||void 0===a?void 0:a.assistance_required)}}class vi extends te{constructor(o={}){super(o),this.preferred_beverage=o.preferred_beverage||"",this.accepted_terms_conditions=o.accepted_terms_conditions||!1}}class Ht extends te{constructor(o={}){super(o),this.card_number=o.card_number||"",this.staff_id=o.staff_id||"",this.location=o.location||{},this.is_logged_in=!!o.is_logged_in}}const ht=new E.X(null),Gt=ht.asObservable();function ke(){return ht.getValue()}setTimeout(()=>{try{if(jest)return}catch(n){}(0,b.q$s)("current").pipe((0,_i.g)(1e3),(0,hi.X)(10),(0,Z.U)(n=>new Ht(n))).subscribe(n=>ht.next(n))},300);let Ae=(()=>{class n extends O{constructor(t){super(),this._title=t,this._app_name="PlaceOS",this._overrides=new E.X([]),this._user_settings=new E.X({}),this._subjects={},this._observables={},this._pending_settings={};const i=new Date,s=new Date(1636614075404),a=(0,Xe.Z)(i,s)?`Today at ${(0,j.Z)(s,"h:mma")}`:(0,j.Z)(s,"do MMM yyyy, h:mma");ie("CORE","null",null,"debug",!0),ie("APP",`6a0d6c4 | Built: ${a}`,null,"debug",!0),this.init()}set overrides(t){this._overrides.next(t),this._applyCssVariables()}listen(t){return this._observables[t]||(this._subjects[t]=new E.X(null),this._observables[t]=this._subjects[t].asObservable()),this._observables[t]}post(t,i){this._observables[t]||(this._subjects[t]=new E.X(null),this._observables[t]=this._subjects[t].asObservable()),this._subjects[t].next(i)}value(t){return this._observables[t]?this._subjects[t].getValue():null}get title(){return this._title.getTitle()}set title(t){this._title.setTitle(`${t} | ${this.get("app.name")||this._app_name}`)}init(){var t;return(0,A.mG)(this,void 0,void 0,function*(){this.get("debug")&&(window.debug=!0),(null===(t=this.get("app"))||void 0===t?void 0:t.name)&&(this._app_name=this.get("app").name),this._app_name=location.pathname.replace(/[\\\/]/g,"").trim()||this._app_name,Vt(this._app_name.split("-").join("_").toUpperCase()),ie("Settings","Successfully loaded settings"),this._initialised.next(!0),window.debug&&(window.application||(window.application={}),window.application.settings=this),this.subscription("user_settings",this._user_settings.subscribe(a=>this._applyUserSettings(a)));const i=yield Gt.pipe((0,H.P)(a=>!!a)).toPromise();console.log("User:",i);const s=yield(0,b.rlq)(i.id,"settings").toPromise();console.log("Data:",s),this._user_settings.next(s.details||{})})}get app_name(){return this._app_name}get(t){var i,s;const a=t.split(".");if("app"!==a[0])return null!==(s=null!==(i=ge(a,this._pending_settings))&&void 0!==i?i:ge(a,this._user_settings.getValue()))&&void 0!==s?s:ge(a,zt);const r=[...this._overrides.getValue()];for(const c of r){const h=ge(a.slice(1),c);if(null!=h)return h}return ge(a,zt)}saveUserSetting(t,i){this._pending_settings[t]=i,this.timeout("save_settings",()=>this._savePendingChanges(),5e3)}_applyCssVariables(){const t=this.get("app.css_variables")||{};let i="body { ";for(const a in t)i+=`--${a}: ${t[a]}; `;i+="}";let s=document.getElementById("css-var-overrides");s||(s=document.createElement("style"),s.id="css-var-overrides",document.head.appendChild(s)),s.innerText=i}_savePendingChanges(){return(0,A.mG)(this,void 0,void 0,function*(){const t=ke();!t||!Object.keys(this._pending_settings).length||(yield(0,b.Ymr)(t.id,{name:"settings",description:"",details:Object.assign(Object.assign({},this._user_settings.getValue()),this._pending_settings)}))})}_applyUserSettings(t){return(0,A.mG)(this,void 0,void 0,function*(){t.dark_mode?document.body.classList.add("dark"):document.body.classList.remove("dark"),t.font_size&&(document.body.style.fontSize=`${t.font_size}px`)})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Ne.Dx))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var S=m(2458);function We(n){let o="";if(n)for(const t in n)n.hasOwnProperty(t)&&null!=n[t]&&(o+=`${o?"&":""}${t}=${n[t]}`);return o}let ft,gt,vt,bt;function et(n,o,t="OK",i,s={}){if(!ft)throw new Error("Snackbar service hasn't been initialised");const a=ft.open(o,t,Object.assign({panelClass:[n],duration:5e3},s));t&&(i=i||(()=>a.dismiss()),a.onAction().subscribe(()=>i()))}function Xt(n,o,t,i={}){console.debug(n),et("success",n,o,t,i)}function Oe(n,o,t,i={}){console.error(n),et("error",n,o,t,i)}function Kt(n,o,t,i={}){console.info(n),et("info",n,o,t,i)}(0,S.X$)("show",[(0,S.eR)(":enter",[(0,S.oB)({opacity:0,height:0}),(0,S.jt)(300,(0,S.oB)({opacity:1,height:"*"}))]),(0,S.eR)(":leave",[(0,S.oB)({opacity:1,height:"*"}),(0,S.jt)(300,(0,S.oB)({opacity:0,height:0}))])]),(0,S.X$)("show",[(0,S.SB)("show",(0,S.oB)({opacity:1,height:"*"})),(0,S.SB)("hide",(0,S.oB)({opacity:0,height:0,"pointer-events":"none"})),(0,S.eR)("show <=> hide",(0,S.jt)("200ms ease-in"))]);class Ct{constructor(o={}){var t;this.settings={},this.id=o.id||"",this.parent_id=o.parent_id||"",this.name=o.name||"",this.display_name=o.display_name||"",this.map_id=o.map_id||"",this.capacity=o.capacity||0,this.locations=o.locations||[];const i=this.display_name.split(" ");this.number=(null===(t=i.length>=2?i[i.length-1]:this.display_name[0])||void 0===t?void 0:t.toUpperCase())||""}}class wi{constructor(o={}){this.id=o.id||"",this.name=o.name||"",this.description=o.description||"",this.tags=o.tags||[],this.count=o.count||0,this.capacity=o.capacity||0,this.bindings=o.bindings||{},this._settings=o.settings||{}}setting(o){return ge(o.split("."),this._settings)}}var oe=m(9097);class Ti{constructor(o={}){this.id=o.id||"",this.name=o.name||"";const t=o.settings||{};this.display_name=o.display_name;const i=t.discovery_info||t;this.zone_id=o.zone_id||o.zone,this.extras=(o.extras||i.extras||[]).map(a=>({id:a.extra_id||a.id,name:a.extra_name||a.name})),this.loan_items=(o.loan_items||i.loan_items||[]).map(a=>({id:a.extra_id||a.id,name:a.extra_name||a.name})),this.levels=(o.levels||i.levels||[]).map(a=>new Ct(Object.assign(Object.assign({},a),{building_id:this.id}))),this._roles=o.roles||i.roles||{},this._lockers=o.lockers||o.locker_structure||i.locker_structure||{},this._systems=o.systems||i.systems||{},this._phone_numbers=o.phone_numbers||i.phone_numbers||{},this._location=o.location||i.location||{longitude:null,latitude:null},this.room_configurations=o.room_configurations||i.room_configurations||[],this.attributes=o.attributes||i.attributes||[];const s=[];if(o.neighbourhoods)for(const a in o.neighbourhoods)if(a in o.neighbourhoods){const r=o.neighbourhoods[a]||{};for(const c in r)c in r&&s.push({id:r[c],name:c,level_id:a})}this.bindings=o.bindings||{},this.searchables=s,this.timezone=o.timezone||i.timezone||t.timezone||"",this.catering_hours=o.catering_hours||i.catering_hours||t.catering_hours||{start:7,end:20},this.visitor_space=o.visitor_space||i.visitor_space||t.visitor_space||"",this.holding_bay=o.holding_bay||i.holding_bay||t.holding_bay||"",this.code=o.code||i.code||t.code||"",this.address=o.address||i.address||t.address||"",this.orientations=o.orientations||i.orientations||t.orientations||{},this.booking_details=o.booking_details||i.booking_details||t.booking_details||null,this.booking_rules=o.booking_rules||i.booking_rules||t.booking_rules||{},this.catering_restricted_from=o.catering_restricted_from||i.catering_restricted_from||t.catering_restricted_from||-1440,this.currency=o.currency||i.currency||t.currency||"USD"}role(o){return[...this._roles[o]||[]]}get role_names(){return Object.keys(this._roles).filter(o=>o in this._roles)}get lockers(){return Object.assign({},this._lockers||{})}get systems(){return Object.assign({},this._systems||{})}get phone_numbers(){return Object.assign({},this._phone_numbers||{})}featuresForLevel(o){return(this.searchables||[]).filter(t=>t.level_id===o)}}let Le=(()=>{class n{constructor(t,i){this._service=t,this._router=i,this._initialised=new E.X(!1),this.initialised=this._initialised.asObservable(),this._buildings=new E.X([]),this._active_building=new E.X(null),this._levels=new E.X([]),this.building_list=this._buildings.asObservable(),this.level_list=this._levels.asObservable(),this.active_building=this._active_building.asObservable(),this.active_levels=(0,oe.aj)([this._levels,this._active_building]).pipe((0,Z.U)(([s,a])=>a?this.levelsForBuilding(a):[])),this._settings=[],this._building_settings={},(0,b.ttN)().pipe((0,H.P)(s=>s)).subscribe(()=>setTimeout(()=>this.init(),1e3)),this.active_building.subscribe(s=>{s&&(this._service.overrides=[...this._settings,this.buildingSettings(s.id)])})}get settings(){return this._settings}get building_settings(){return this._building_settings}buildingSettings(t=""){return!t&&this.building&&(t=this.building.id),this._building_settings&&this._building_settings[t]||{}}get organisation(){return this._organisation}get buildings(){return this._buildings.getValue()}get building(){return this._active_building.getValue()}set building(t){this._active_building.next(t),this._service.overrides=[...this._settings,this.buildingSettings(t.id).details]}find(t){return this.buildings.find(i=>i.id===t)}get levels(){return this._levels.getValue()}levelWithID(t){return this.levels.find(i=>null==t?void 0:t.includes(i.id))}levelsForBuilding(t){return this.levels.filter(i=>i.parent_id===t.id)}init(t=0){return(0,A.mG)(this,void 0,void 0,function*(){this._initialised.next(!1),yield this.load().catch(i=>{throw Oe("Error loading organisation data. Retrying..."),setTimeout(()=>this.init(t),Math.min(1e4,300*++t)),i}),this._initialised.next(!0),window.debug&&(window.application||(window.application={}),window.application.orgs=this)})}load(){return(0,A.mG)(this,void 0,void 0,function*(){yield this.loadOrganisation(),yield this.loadBuildings(),yield this.loadLevels(),yield this.loadSettings()})}loadOrganisation(){var t;return(0,A.mG)(this,void 0,void 0,function*(){const i=yield(0,b.I0G)({tags:"org"}).pipe((0,Z.U)(s=>s.data)).toPromise();if(i.length){const s=(0,b.N9E)(),a=i.find(c=>{var h;return(0,b.y7C)()||c.id===(null===(h=null==s?void 0:s.config)||void 0===h?void 0:h.org_zone)})||i[0],r=null===(t=yield(0,b.rlq)(a.id,"bindings").toPromise())||void 0===t?void 0:t.details;this._organisation=new wi(Object.assign(Object.assign({},a),{bindings:r}))}else this._router.navigate(["/misconfigured"])})}loadBuildings(){var t,i;return(0,A.mG)(this,void 0,void 0,function*(){const s=yield(0,b.I0G)({tags:"building",limit:500}).pipe((0,Z.U)(c=>c.data.filter(h=>{var d;return h.parent_id===(null===(d=this._organisation)||void 0===d?void 0:d.id)}))).toPromise();(null==s?void 0:s.length)||this._router.navigate(["/misconfigured"]);const a=[];for(const c of s){const h=null===(t=yield(0,b.rlq)(c.id,"bindings").toPromise())||void 0===t?void 0:t.details;a.push(new Ti(Object.assign(Object.assign({},c),{bindings:h})))}this._buildings.next(a);const r=localStorage.getItem("PLACEOS.building");r&&this.buildings.find(c=>c.id===r)&&this._active_building.next(this.buildings.find(c=>c.id===r)),!(null===(i=this.building)||void 0===i?void 0:i.id)&&(null==a?void 0:a.length)>0&&(this.building=a[0])})}loadLevels(){return(0,A.mG)(this,void 0,void 0,function*(){const t=yield(0,b.I0G)({tags:"level",limit:2500}).pipe((0,Z.U)(s=>s.data)).toPromise();(null==t?void 0:t.length)||this._router.navigate(["/misconfigured"]);const i=t.map(s=>new Ct(s));i.sort((s,a)=>(s.name||"").localeCompare(a.name||"")),this._levels.next(i)})}get available_room_configs(){return this.buildings.map(t=>[...t.room_configurations]).reduce((t,i)=>t.concat(i),[]).sort((t,i)=>t.name.localeCompare(i.name))}loadSettings(){return(0,A.mG)(this,void 0,void 0,function*(){if(!this._organisation)return;const t=`${(this._service.app_name||"workplace").toLowerCase()}_app`,i=yield(0,b.rlq)(this._organisation.id,t).toPromise(),s=yield(0,b.rlq)(this._organisation.id,"settings").toPromise();this._settings=[s.details,i.details];const a=this.buildings;for(const r of a)this._building_settings[r.id]=yield(0,b.rlq)(r.id,t).toPromise();this._service.overrides=[...this._settings,this.buildingSettings(this.building.id).details]})}saveBuilding(t){localStorage.setItem("PLACEOS.building",t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Ae),e.LFG(J.F0))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var g=m(93),L=m(5159),Wt=m(7227),ce=m(7820),qe=m(5877),Se=m(5346),V=m(1039),yt=m(969),Q=m(6360),tt=m(9636),G=m(4613),Me=m(6529);let en=(()=>{class n extends O{constructor(t,i){super(),this._element=t,this._renderer=i,this.index=1,this.params=[],this.modelChange=new e.vpe}ngOnInit(){var t;null===(t=(0,b.ttN)())||void 0===t||t.pipe((0,H.P)(i=>i)).subscribe(i=>this.bindVariable())}ngOnChanges(t){(t.sys||t.mod||t.bind)&&this.bindVariable(),t.model&&t.model.previousValue!==this.model&&null!=this.model&&this.execute(),t.on_event&&this.on_event&&this.subscription("on_event",this._renderer.listen(this._element.nativeElement,this.on_event,()=>this.execute()))}bindVariable(){if((0,b.N9E)()&&this.bind&&this.sys&&this.mod){const i=(0,b.rTZ)(this.sys,this.mod,this.index).binding(this.bind);this.subscription("binding",i.bind()),this.subscription("on_changes",i.listen().subscribe(s=>setTimeout(()=>{this.model=s,this.modelChange.emit(this.model)},10)))}}execute(){if((0,b.N9E)()&&this.exec&&this.sys&&this.mod){const t=(0,b.rTZ)(this.sys,this.mod,this.index);this.bind&&(this.params=[this.model]),t.execute(this.exec,this.params).then(i=>{this.bind||(this.model=i,this.modelChange.emit(this.model))})}}writeValue(t){this.model=t,this.modelChange.emit(this.model),this.execute()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(e.Qsj))},n.\u0275dir=e.lG2({type:n,selectors:[["i","bind",""],["","binding",""],["co-bind"]],inputs:{sys:"sys",mod:"mod",index:"index",bind:"bind",exec:"exec",on_event:["onEvent","on_event"],params:"params",model:"model"},outputs:{modelChange:"modelChange"},features:[e.qOj,e.TTD]}),n})();function Zi(n,o){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"app-icon"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.Tol("state center "+t.state),e.xp6(2),e.hij(" ","success"===t.state?"done":"close"," ")}}function ki(n,o){1&n&&(e.TgZ(0,"div",4),e._UZ(1,"mat-spinner",5),e.qZA()),2&n&&(e.xp6(1),e.Q6J("diameter",16))}const Ai=["*"];let tn=(()=>{class n{constructor(){this.className="material-icons",this.state=""}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["action-icon"]],inputs:{icon:"icon",className:"className",content:"content",loading:"loading",disabled:"disabled",state:"state"},ngContentSelectors:Ai,decls:6,vars:8,consts:[["mat-icon-button","",1,"relative","flex","items-center","justify-center","h-8","w-8",3,"disabled"],["root","",3,"className","icon"],[3,"class",4,"ngIf"],["class","loader center",4,"ngIf"],[1,"loader","center"],[3,"diameter"]],template:function(t,i){1&t&&(e.F$t(),e.TgZ(0,"button",0),e.TgZ(1,"app-icon",1),e._uU(2),e.Hsn(3),e.qZA(),e.YNc(4,Zi,3,3,"div",2),e.YNc(5,ki,2,1,"div",3),e.qZA()),2&t&&(e.ekj("success","success"===i.state),e.Q6J("disabled",i.loading||i.disabled),e.xp6(1),e.Q6J("className",i.className)("icon",i.icon),e.xp6(1),e.hij(" ",i.content," "),e.xp6(2),e.Q6J("ngIf",!i.loading&&i.state),e.xp6(1),e.Q6J("ngIf",i.loading))},styles:[".action-icon.fade[_ngcontent-%COMP%] > app-icon[_ngcontent-%COMP%]{opacity:.35}[center][_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.success[_ngcontent-%COMP%]{pointer-events:none}.success[_ngcontent-%COMP%]   app-icon[root][_ngcontent-%COMP%]{opacity:.2}.state.success[_ngcontent-%COMP%]{color:#388e3c}.state.error[_ngcontent-%COMP%]{color:#e53935}"]}),n})(),$e=(()=>{class n{constructor(t){this.sanitizer=t}transform(t,i="html"){switch(i){case"resource":return this.sanitizer.bypassSecurityTrustResourceUrl(t);case"url":return this.sanitizer.bypassSecurityTrustUrl(t);case"script":return this.sanitizer.bypassSecurityTrustScript(t);case"style":return this.sanitizer.bypassSecurityTrustStyle(t);default:return this.sanitizer.bypassSecurityTrustHtml(t)}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ne.H7,16))},n.\u0275pipe=e.Yjl({name:"safe",type:n,pure:!0}),n})();function Oi(n,o){if(1&n&&(e.TgZ(0,"i"),e._uU(1),e.Hsn(2),e.qZA()),2&n){const t=e.oxw();e.Tol((null==t.icon?null:t.icon.class)||t.className),e.xp6(1),e.hij(" ",null==t.icon?null:t.icon.content," ")}}function Si(n,o){if(1&n&&(e._UZ(0,"img",3),e.ALo(1,"safe")),2&n){const t=e.oxw();e.Q6J("src",e.xi3(1,1,t.icon.src,"resource"),e.LSH)}}const Mi=["*"];let N=(()=>{class n{constructor(){this.className="material-icons"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-icon"]],inputs:{className:"className",icon:"icon"},ngContentSelectors:Mi,decls:3,vars:2,consts:[[1,"app-icon"],[3,"class",4,"ngIf"],[3,"src",4,"ngIf"],[3,"src"]],template:function(t,i){1&t&&(e.F$t(),e.TgZ(0,"div",0),e.YNc(1,Oi,3,3,"i",1),e.YNc(2,Si,2,4,"img",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!i.icon||"img"!==i.icon.type),e.xp6(1),e.Q6J("ngIf",i.icon&&"img"===i.icon.type))},directives:[g.O5],pipes:[$e],styles:[".app-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:1.25em;width:1.25em}i[_ngcontent-%COMP%]{font-size:1em}img[_ngcontent-%COMP%]{height:1em;width:1em}"]}),n})();function Ii(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",2),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return r.action.emit(a.id),r.show=!1}),e._UZ(1,"app-icon",3),e.qZA()}if(2&n){const t=o.$implicit,i=o.index,s=e.oxw();e.Udp("top",s.show?-110*i-60+"%":""),e.xp6(1),e.Q6J("icon",t)}}let nn=(()=>{class n extends O{constructor(){super(...arguments),this.actions=[],this.action=new e.vpe}close(){this.timeout("close",()=>this.show=!1)}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=e.n5z(n)))(i||n)}}(),n.\u0275cmp=e.Xpm({type:n,selectors:[["a-popout-menu"]],inputs:{actions:"actions"},outputs:{action:"action"},features:[e.qOj],decls:4,vars:4,consts:[["mat-icon-button","","class","small absolute text-base center shadow",3,"top","click",4,"ngFor","ngForOf"],["name","root","mat-icon-button","",3,"click"],["mat-icon-button","",1,"small","absolute","text-base","center","shadow",3,"click"],[3,"icon"]],template:function(t,i){1&t&&(e.YNc(0,Ii,2,3,"button",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return i.show=!i.show})("click",function(){return i.show?i.close():""},!1,e.Jf7),e.TgZ(2,"app-icon"),e._uU(3),e.qZA(),e.qZA()),2&t&&(e.Q6J("ngForOf",i.actions),e.xp6(1),e.ekj("show",i.show),e.xp6(2),e.Oqu(i.show?"add":"more_vert"))},styles:["[_nghost-%COMP%]{position:relative}app-icon[_ngcontent-%COMP%]{transition:transform .2s}button[_ngcontent-%COMP%]{background-color:#fff;color:rgba(#000,.85);font-size:1.25rem;height:2.5em;width:2.5em}button.show[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{transform:rotate(45deg)}button.small[_ngcontent-%COMP%]{transition:top .2s,left .2s}"]}),n})();m(3696);const je=new e.OlP("Data for Map Features");function io(n,o){1&n&&(e.ynx(0),e.Hsn(1),e.BQk())}m(4880);const oo=function(n){return[n]};function so(n,o){if(1&n&&(e.TgZ(0,"a",8),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("routerLink",e.VKq(2,oo,t.route)),e.xp6(1),e.hij(" ",t.name," ")}}function ao(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",4),e.TgZ(2,"app-icon"),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",5),e.YNc(5,io,2,0,"ng-container",1),e.qZA(),e.TgZ(6,"div",6),e.YNc(7,so,2,4,"a",7),e.qZA(),e.BQk()),2&n){const t=e.oxw(),i=e.MAs(3);e.xp6(1),e.ekj("text-success",!t.error)("text-error",t.error),e.xp6(2),e.Oqu(t.error?"close":"done"),e.xp6(2),e.Q6J("ngIf",!t.error)("ngIfElse",i),e.xp6(2),e.Q6J("ngForOf",t.links)}}function ro(n,o){if(1&n&&(e.TgZ(0,"p",9),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.error)}}function lo(n,o){if(1&n&&(e._UZ(0,"mat-spinner",10),e.TgZ(1,"p",11),e._uU(2),e.qZA()),2&n){const t=e.oxw();e.Q6J("diameter",32),e.xp6(2),e.Oqu(t.loading)}}const co=["*"];let sn=(()=>{class n{constructor(){this.loading="",this.error="",this.links=[]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["status-overlay"]],inputs:{loading:"loading",error:"error",links:"links"},ngContentSelectors:co,decls:6,vars:2,consts:[["status-overlay","",1,"fixed","inset-0","flex","flex-col","bg-secondary","items-center","justify-center","z-50","text-white"],[4,"ngIf","ngIfElse"],["error_msg",""],["load_state",""],[1,"text-4xl","rounded-full","bg-white","mb-4"],[1,"text-center","text-lg","mb-4"],[1,"flex","items-center","space-x-2"],["button","","mat-button","","class","w-32",3,"routerLink",4,"ngFor","ngForOf"],["button","","mat-button","",1,"w-32",3,"routerLink"],["error",""],[1,"mb-4",3,"diameter"],["loading","",1,"text-center","text-lg"]],template:function(t,i){if(1&t&&(e.F$t(),e.TgZ(0,"div",0),e.YNc(1,ao,8,8,"ng-container",1),e.qZA(),e.YNc(2,ro,2,1,"ng-template",null,2,e.W1O),e.YNc(4,lo,3,2,"ng-template",null,3,e.W1O)),2&t){const s=e.MAs(5);e.xp6(1),e.Q6J("ngIf",!i.loading)("ngIfElse",s)}},styles:[""]}),n})();var Je=m(62);m(3579),m(9544);var an=m(2297);const Po=["keyboard",""];function No(n,o){if(1&n&&e._UZ(0,"div",7),2&n){const t=e.oxw(4);e.ekj("bg-success","shift"===t.state)}}function Lo(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",5),e.NdJ("focus",function(){return e.CHM(t),e.oxw(3).focusInput()})("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).handleKeyPress(a)}),e._uU(2),e.YNc(3,No,1,2,"div",6),e.qZA(),e.BQk()}if(2&n){const t=o.$implicit;e.xp6(1),e.ekj("special","{"===t[0]&&t.length>1)("space","{space}"===t),e.uIk("key",t),e.xp6(1),e.hij(" ","{space}"===t?"Space":"{caps}"===t?"Caps Lock":"{backspace}"===t?"Backspace":t," "),e.xp6(1),e.Q6J("ngIf","{caps}"===t)}}function qo(n,o){if(1&n&&(e.TgZ(0,"div",3),e.YNc(1,Lo,4,7,"ng-container",4),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function $o(n,o){if(1&n&&(e.TgZ(0,"div",1),e.YNc(1,qo,2,1,"div",2),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.keyset)}}const jo=["*"],Jo=["0123456789".split(""),"qwertyuiop".split(""),"asdfghjkl".split(""),"zxcvbnm".split(""),["{caps}","{space}","{backspace}"]];let rn=(()=>{class n extends O{constructor(t,i){super(),this._element=t,this._overlay=i,this.keyset=Jo,this.state="normal",this._overlay_ref=null,this.onFocus=()=>{!n.enabled||(this.open(),this.clearTimeout("blur"))},this.onBlur=()=>this.timeout("blur",()=>this.close())}ngOnDestroy(){super.ngOnDestroy(),this.close()}focusInput(){var t,i,s,a;null===(i=null===(t=this._element)||void 0===t?void 0:t.nativeElement)||void 0===i||i.blur(),null===(a=null===(s=this._element)||void 0===s?void 0:s.nativeElement)||void 0===a||a.focus()}open(){this._overlay_ref||!this._portal||(this._overlay_ref=this._overlay.create({positionStrategy:this._overlay.position().global().bottom().centerHorizontally()}),this._overlay_ref.attach(this._portal))}close(){this._overlay_ref&&(this._overlay_ref.dispose(),this._overlay_ref=null)}handleKeyPress(t){let i=this._element.nativeElement.selectionStart;const s=this._element.nativeElement.value||"";switch(t.toLowerCase()){case"{caps}":case"{shift}":this.state="shift";break;case"{backspace}":this._element.nativeElement.value=`${s.substr(0,i-1)}${s.substr(i,s.length)}`,i=Math.max(0,i-1);break;case"{space}":this._element.nativeElement.value=`${s.substr(0,i)} ${s.substr(i,s.length)}`,i+=1;break;default:"shift"===this.state&&(this.state="normal"),this._element.nativeElement.value=`${s.substr(0,i)}${t}${s.substr(i,s.length)}`,i+=1}this._element.nativeElement.dispatchEvent(new InputEvent("input")),this.updateKeyState(),this.timeout("focus",()=>{this.focusInput(),this._element.nativeElement.selectionStart=i,this._element.nativeElement.selectionEnd=i},50)}updateKeyState(){this.keyset=this.keyset.map(t=>t.map(i=>i.length>1?i:i["normal"!==this.state?"toUpperCase":"toLowerCase"]()))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(an.aV))},n.\u0275cmp=e.Xpm({type:n,selectors:[["input","keyboard",""],["textarea","keyboard",""]],viewQuery:function(t,i){if(1&t&&e.Gf(Me.ig,5),2&t){let s;e.iGM(s=e.CRH())&&(i._portal=s.first)}},hostBindings:function(t,i){1&t&&e.NdJ("focus",function(){return i.onFocus()})("blur",function(){return i.onBlur()})},inputs:{keyset:"keyset"},features:[e.qOj],attrs:Po,ngContentSelectors:jo,decls:2,vars:0,consts:[["cdk-portal",""],["keyboard","",1,"w-screen","flex","flex-col","space-y-4","bg-gray-200","p-2","border-t","border-gray-400"],["row","","class","flex items-center justify-center space-x-2",4,"ngFor","ngForOf"],["row","",1,"flex","items-center","justify-center","space-x-2"],[4,"ngFor","ngForOf"],["tabindex","0",1,"rounded-xl","p-2","border","border-gray-300","relative","cursor-pointer","bg-white",3,"focus","click"],["dot","","class","absolute top-2 right-2 h-2 w-2 rounded-full bg-gray-300",3,"bg-success",4,"ngIf"],["dot","",1,"absolute","top-2","right-2","h-2","w-2","rounded-full","bg-gray-300"]],template:function(t,i){1&t&&(e.F$t(),e.Hsn(0),e.YNc(1,$o,2,1,"ng-template",0))},directives:[Me.bH,g.sg,g.O5],styles:["[key][_ngcontent-%COMP%]{height:3.5rem;width:4rem;transition:box-shadow .2s,top .2s;box-shadow:0 4px 0 .04px #0000001a}[key].special[_ngcontent-%COMP%]{width:10rem}[key].space[_ngcontent-%COMP%]{flex:1;min-width:10rem;max-width:25rem}[key][_ngcontent-%COMP%]:hover{top:2px;box-shadow:0 2px 0 .04px #0000001a}[key][_ngcontent-%COMP%]:active{top:4px;box-shadow:0 0 0 .04px #0000001a}"]}),n})();class De{constructor(o={}){this.id=o.id||"",this.name=o.name||"",this.display_name=o.display_name||"",this.email=(o.email||"").toLowerCase(),this.capacity=o.capacity||-1,this.feature_list=o.feature_list||o.features||[],this.bookable=!!o.bookable,this.zones=o.zones||[],this.support_url=o.support_url||"",this.map_id=o.map_id||"",this.image=o.image||"",this.configurations=o.configurations||[],this.features=o.features||[],this.response_status=o.response_status,this.level=o.level||new Ct,this.availability=o.availability||[]}}let nt=(()=>{class n{constructor(t){this._org=t,this._list=new E.X([]),this._initialised=new E.X(!1),this.initialised=this._initialised.asObservable(),this.list=this._list.asObservable(),this._compare=i=>i.zones.includes(this._org.building.id),this._org.initialised.pipe((0,H.P)(i=>i)).subscribe(()=>this.loadSpaces())}get space_list(){return this._list.getValue()}filter(t=this._compare){return this._list.getValue().filter(i=>t(i))}find(t){return this._list.getValue().find(i=>i.id===t||i.email===t)}loadSpaces(){return(0,A.mG)(this,void 0,void 0,function*(){const s=(yield(0,b.vIL)({zone_id:this._org.organisation.id,limit:5e3}).pipe((0,Z.U)(a=>a.data)).toPromise()).map(a=>new De(Object.assign(Object.assign({},a),{level:this._org.levelWithID([...a.zones])}))).filter(a=>a.map_id);this._list.next(s),this._initialised.next(!0)})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Le))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Do(n,o){1&n&&(e.TgZ(0,"div",2),e._uU(1," Unable to reach server... Some features may not work. "),e.qZA())}function Bo(n,o){1&n&&(e.TgZ(0,"div",3),e._UZ(1,"mat-spinner",4),e.qZA()),2&n&&(e.xp6(1),e.Q6J("diameter",64))}let ln=(()=>{class n{constructor(t,i){this._org=t,this._spaces=i}get online(){return(0,b.Ggh)()}ngOnInit(){return(0,A.mG)(this,void 0,void 0,function*(){this.loading=!0,yield this._org.initialised.pipe((0,H.P)(t=>t)).toPromise(),yield this._spaces.initialised.pipe((0,H.P)(t=>t)).toPromise(),setTimeout(()=>this.loading=!1,300)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Le),e.Y36(nt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["global-loading"]],decls:2,vars:2,consts:[["class","fixed bottom-2 left-1/2 -translate-x-1/2 shadow rounded-3xl px-4 py-2 bg-error text-white text-xs",4,"ngIf"],["loader","","class","fixed inset-0 flex items-center justify-center pointer-events-auto bg-white",4,"ngIf"],[1,"fixed","bottom-2","left-1/2","-translate-x-1/2","shadow","rounded-3xl","px-4","py-2","bg-error","text-white","text-xs"],["loader","",1,"fixed","inset-0","flex","items-center","justify-center","pointer-events-auto","bg-white"],[3,"diameter"]],template:function(t,i){1&t&&(e.YNc(0,Do,2,0,"div",0),e.YNc(1,Bo,2,1,"div",1)),2&t&&(e.Q6J("ngIf",!i.online),e.xp6(1),e.Q6J("ngIf",i.loading))},directives:[g.O5,V.$g],styles:["[_nghost-%COMP%]{pointer-events:none}[_nghost-%COMP%] > [loader][_ngcontent-%COMP%]{z-index:9999;background-image:url(\"data:image/svg+xml,%3Csvg width='36' height='36' viewBox='0 0 36 36' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M36 0H0v36h36V0zM15.126 2H2v13.126c.367.094.714.24 1.032.428L15.554 3.032c-.188-.318-.334-.665-.428-1.032zM18 4.874V18H4.874c-.094-.367-.24-.714-.428-1.032L16.968 4.446c.318.188.665.334 1.032.428zM22.874 2h11.712L20 16.586V4.874c1.406-.362 2.512-1.468 2.874-2.874zm10.252 18H20v13.126c.367.094.714.24 1.032.428l12.522-12.522c-.188-.318-.334-.665-.428-1.032zM36 22.874V36H22.874c-.094-.367-.24-.714-.428-1.032l12.522-12.522c.318.188.665.334 1.032.428zm0-7.748V3.414L21.414 18h11.712c.362-1.406 1.468-2.512 2.874-2.874zm-18 18V21.414L3.414 36h11.712c.362-1.406 1.468-2.512 2.874-2.874zM4.874 20h11.712L2 34.586V22.874c1.406-.362 2.512-1.468 2.874-2.874z' fill='%23000000' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E\")}"]}),n})();function zo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"div",2),e._uU(2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e.TgZ(4,"app-icon"),e._uU(5,"close"),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.ekj("bg-blue-600","info"===t.banner.type||!t.banner.type)("bg-pending","warn"===t.banner.type)("bg-error","error"===t.banner.type),e.xp6(2),e.Oqu(null==t.banner?null:t.banner.content)}}let wt=(()=>{class n{constructor(t){this._settings=t,console.log("Banner:",this.banner)}get has_viewed(){var t;return!(null===(t=this.banner)||void 0===t?void 0:t.content)||localStorage.getItem("PLACE.last_banner")===this.banner.id}get banner(){return this._settings.get("app.general.banner")}close(){var t;localStorage.setItem("PLACE.last_banner",(null===(t=this.banner)||void 0===t?void 0:t.id)||"")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ae))},n.\u0275cmp=e.Xpm({type:n,selectors:[["global-banner"]],decls:1,vars:1,consts:[["class","flex items-center w-full text-white p-4 space-x-4",3,"bg-blue-600","bg-pending","bg-error",4,"ngIf"],[1,"flex","items-center","w-full","text-white","p-4","space-x-4"],[1,"flex-1"],["mat-icon-button","",3,"click"]],template:function(t,i){1&t&&e.YNc(0,zo,6,7,"div",0),2&t&&e.Q6J("ngIf",!i.has_viewed)},styles:["[_nghost-%COMP%]{display:block;width:100%}"]}),n})();const Ro=[W.Bb,Wt.Tx,F.lN,ce.LD,L.ot,W.Bb,ce.LD,q.Is,qe.FA,ee.c,yt.Iq,V.Cq,Se.Hi,tt.TU,G.HT,Me.eL,Je.JX];let Be=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[{provide:Q.Ad,useValue:"en-GB"},{provide:je,useValue:{}}],imports:[[g.ez,_.u5,_.UX,...Ro],W.Bb,Wt.Tx,F.lN,ce.LD,L.ot,W.Bb,ce.LD,q.Is,qe.FA,ee.c,yt.Iq,V.Cq,Se.Hi,tt.TU,G.HT,Me.eL,Je.JX]}),n})();function Ho(n,o){if(1&n&&(e.TgZ(0,"div",8),e.TgZ(1,"app-icon"),e._uU(2,"account_circle"),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.qZA(),e.qZA()),2&n){const t=e.oxw(2);e.xp6(4),e.Oqu(t.space.capacity)}}function Go(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).action.emit()}),e.TgZ(1,"app-icon"),e._uU(2),e.qZA(),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Oqu("available"===t.type?"add":"close")}}function Xo(n,o){if(1&n&&(e.TgZ(0,"div",2),e.TgZ(1,"div",3),e.TgZ(2,"div",4),e._uU(3),e.qZA(),e.TgZ(4,"div",5),e._uU(5),e.qZA(),e.qZA(),e.YNc(6,Ho,5,1,"div",6),e.YNc(7,Go,3,1,"button",7),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(2);e.xp6(3),e.Oqu(t.space.name),e.xp6(2),e.hij(" ",(null==t.space.level?null:t.space.level.display_name)||(null==t.space.level?null:t.space.level.name)," "),e.xp6(1),e.Q6J("ngIf",-1!==t.space.capacity),e.xp6(1),e.Q6J("ngIf",t.multiple)("ngIfElse",i)}}function Ko(n,o){if(1&n&&(e.TgZ(0,"button",10),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.ekj("request",t.space.by_request),e.xp6(1),e.hij(" ",t.space.by_request?"Request":"Book"," ")}}e.B6R(tn,[L.lW,N,g.O5,V.$g],[]),e.B6R(nn,[g.sg,L.lW,N],[]),e.B6R(dt,[q.uh,g.O5,N,L.lW,q.ZT,V.$g],[]),e.B6R(sn,[g.O5,N,g.sg,L.zs,V.$g],[]),e.B6R(wt,[g.O5,L.lW,N],[]);let Tt=(()=>{class n{constructor(){this.action=new e.vpe}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["a-space-select-item"]],inputs:{space:"space",type:"type",multiple:"multiple"},outputs:{action:"action"},decls:3,vars:1,consts:[["space","","class","w-full flex items-center p-2 space-x-2 border-b border-gray-100",4,"ngIf"],["single_button",""],["space","",1,"w-full","flex","items-center","p-2","space-x-2","border-b","border-gray-100"],[1,"flex-1","w-1/2"],[1,"text-base","truncate"],[1,"text-xs"],["class","flex items-center",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf","ngIfElse"],[1,"flex","items-center"],["mat-icon-button","",3,"click"],["mat-button","",1,"w-32"]],template:function(t,i){1&t&&(e.YNc(0,Xo,8,5,"div",0),e.YNc(1,Ko,2,3,"ng-template",null,1,e.W1O)),2&t&&e.Q6J("ngIf",i.space)},styles:[""]}),n})();var Ie=m(9902),pe=m(2597),cn=m(8636),D=m(1361),z=m(9756),Ue=m(6412),be=m(8292);const ts={month:43200,months:43200,week:10080,weeks:10080,day:1440,days:1440,hour:60,hours:60,minute:1,minutes:1},mn={auto_approve:!0,hidden:!1};function kt(n){const o=(n||"").split(" ");return o.length>1?+o[0]*ts[o[1]]:0}function _n(n,o=new Date){return(0,z.Z)(o,kt(n))}function os({date:n,duration:o,host:t},i){let s=0;const{conditions:a}=i;return!a||(a.groups instanceof Array&&a.groups.every(r=>{var c;return null===(c=null==t?void 0:t.groups)||void 0===c?void 0:c.includes(r)})&&(s+=1),a.is_before&&(0,Ue.Z)((0,z.Z)(n,o),_n(a.is_before))&&(s+=1),a.is_after&&(0,be.Z)(n,_n(a.is_after))&&(s+=1),a.min_length&&kt(a.min_length)<=o&&(s+=1),a.max_length&&kt(a.max_length)>=o&&(s+=1),s>=Object.keys(a).length)}var de=m(6800);class ss{constructor(o={}){this.id=o.id||"",this.name=o.name||"",this.primary=!!o.primary,this.summary=o.summary||"",this.can_edit=!!o.can_edit,this.resource=new De(o.resource||o.system),this.availability=(o.availability||[]).map(({starts_at:t,ends_at:i,date:s,duration:a,status:r})=>({date:new Date(s,t).valueOf(),duration:a||(0,de.Z)(i,t),status:r})),this.hidden=!!o.hidden}}function Ot(n,o){const t=We(n);return(0,b.U2M)("/api/staff/v1/calendars/free_busy"+(t?"?"+t:"")).pipe((0,Z.U)(i=>i.map(s=>new ss(s))),(n=>(0,Z.U)(o=>o.filter(t=>!!t.resource).map(t=>new De(Object.assign(Object.assign({},t.resource),{level:null==n?void 0:n.levelWithID(t.resource.zones),availability:t.availability}))).filter(t=>t.bookable)))(o))}function rs(n,o){if(1&n&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}function ls(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field",10),e.TgZ(1,"mat-select",11),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().building.next(s)}),e.YNc(2,rs,2,2,"mat-option",12),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.building.getValue()),e.xp6(1),e.Q6J("ngForOf",t.buildings)}}function cs(n,o){if(1&n&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function us(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field",10),e.TgZ(1,"mat-select",14),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().type=s}),e.YNc(2,cs,2,2,"mat-option",12),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.type),e.xp6(1),e.Q6J("ngForOf",t.space_types)}}function ps(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a-space-select-item",17),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw(3).spaceSelected(s)}),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("space",t)("multiple",i.multiple)}}function ds(n,o){if(1&n&&(e.ynx(0),e.YNc(1,ps,1,2,"a-space-select-item",16),e.BQk()),2&n){const t=o.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!i.space_map[t.id])}}function ms(n,o){if(1&n&&(e.ynx(0),e.YNc(1,ds,2,1,"ng-container",15),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.filtered_spaces))}}function _s(n,o){if(1&n&&(e.ynx(0),e.YNc(1,ms,3,3,"ng-container",5),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw(),i=e.MAs(16);let s;e.xp6(1),e.Q6J("ngIf",null==(s=e.lcZ(2,2,t.filtered_spaces))?null:s.length)("ngIfElse",i)}}function hs(n,o){if(1&n&&e._UZ(0,"a-space-select-item",20),2&n){const t=o.$implicit,i=e.oxw(3);e.Q6J("space",t)("multiple",i.multiple)}}function fs(n,o){if(1&n&&(e.ynx(0),e.YNc(1,hs,1,2,"a-space-select-item",19),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.spaces)}}function gs(n,o){if(1&n&&(e.TgZ(0,"div",18),e.YNc(1,fs,2,1,"ng-container",5),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(16);e.ekj("show",t.show_selected),e.xp6(1),e.Q6J("ngIf",t.spaces&&t.spaces.length)("ngIfElse",i)}}function vs(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"footer"),e.TgZ(1,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().save()}),e._uU(2),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.hij(" Save selected spaces(",t.spaces.length||"0",") ")}}function bs(n,o){1&n&&(e.TgZ(0,"div",22),e.TgZ(1,"app-icon",0),e._uU(2,"close"),e.qZA(),e.TgZ(3,"p"),e._uU(4,"No spaces"),e.qZA(),e.qZA())}function Cs(n,o){1&n&&(e.TgZ(0,"div",23),e._UZ(1,"mat-spinner",24),e.TgZ(2,"p"),e._uU(3,"Finding available spaces..."),e.qZA(),e.qZA())}let fn=(()=>{class n extends O{constructor(t,i,s){super(),this._org=t,this._settings=i,this._data=s,this.event=new e.vpe,this.spaces=[...this._data.spaces||[]],this.building=new E.X(null),this.space_types=[],this.available_spaces=(0,oe.aj)([this.building]).pipe((0,Ie.w)(([a])=>(this.loading=!0,Ot({zone_ids:null==a?void 0:a.id,period_start:(0,D.Z)(this._data.date),period_end:(0,D.Z)((0,z.Z)(this._data.date,this._data.duration))}))),(0,pe.d)(1)),this.filtered_spaces=this.available_spaces.pipe((0,Z.U)(a=>function(n,o,t){return n.filter(i=>{var s;return!(null===(s=function(n,o){var t;const{space:i}=n;for(const s of i.zones)if(null===(t=o[s])||void 0===t?void 0:t.length)for(const a of o[s])if(a&&os(n,a))return Object.assign(Object.assign({},mn),a.rules);return mn}(Object.assign(Object.assign({},o),{space:i}),t))||void 0===s?void 0:s.hidden)})}(a,Object.assign(Object.assign({},this._data),{host:ke()}),this._org.building.booking_rules)),(0,cn.b)(()=>this.loading=!1)),this.building.next(this._org.building||this.buildings[0]),this.subscription("spaces",this.filtered_spaces.subscribe(a=>a))}get buildings(){return this._org.buildings}get multiple(){return!!this._settings.get("app.booking.multiple_spaces")}get space_map(){const t={};return this.spaces.forEach(i=>t[i.id]=!0),t}spaceSelected(t){this.multiple?this.space_map[t.id]||this.spaces.push(t):(this.spaces=[t],this.save())}save(){this.event.emit({reason:"done",metadata:this.spaces})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Le),e.Y36(Ae),e.Y36(q.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["a-space-select-modal"]],outputs:{event:"event"},features:[e.qOj],decls:19,vars:7,consts:[[1,"text-3xl"],[1,"text-xl","font-semibold","flex-1"],["mat-icon-button","","mat-dialog-close",""],["appearance","outline",4,"ngIf"],[1,"body",2,"width","32rem"],[4,"ngIf","ngIfElse"],["class","space-list",3,"show",4,"ngIf"],[4,"ngIf"],["empty_state",""],["load_state",""],["appearance","outline"],["name","booking-type","placeholder","Select building",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","booking-type","placeholder","Any space type",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["type","available",3,"space","multiple","click",4,"ngIf"],["type","available",3,"space","multiple","click"],[1,"space-list"],["type","selected",3,"space","multiple",4,"ngFor","ngForOf"],["type","selected",3,"space","multiple"],["mat-button","",3,"click"],["empty","",1,"p-16","flex","flex-col","items-center","space-y-2"],["load","",1,"p-16","flex","flex-col","items-center","space-y-2"],["diameter","48"]],template:function(t,i){if(1&t&&(e.TgZ(0,"header"),e.TgZ(1,"app-icon",0),e._uU(2,"place"),e.qZA(),e.TgZ(3,"div",1),e._uU(4),e.qZA(),e.TgZ(5,"button",2),e.TgZ(6,"app-icon",0),e._uU(7,"close"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"main"),e.YNc(9,ls,3,2,"mat-form-field",3),e.YNc(10,us,3,2,"mat-form-field",3),e.TgZ(11,"div",4),e.YNc(12,_s,3,4,"ng-container",5),e.YNc(13,gs,2,4,"div",6),e.qZA(),e.YNc(14,vs,3,1,"footer",7),e.YNc(15,bs,5,0,"ng-template",null,8,e.W1O),e.YNc(17,Cs,4,0,"ng-template",null,9,e.W1O),e.qZA()),2&t){const s=e.MAs(18);e.xp6(4),e.hij(" Select space",i.multiple?"s":""," "),e.xp6(5),e.Q6J("ngIf",i.buildings&&i.buildings.length>1),e.xp6(1),e.Q6J("ngIf",i.space_types&&i.space_types.length>1),e.xp6(2),e.Q6J("ngIf",!i.loading)("ngIfElse",s),e.xp6(1),e.Q6J("ngIf",i.multiple),e.xp6(1),e.Q6J("ngIf",i.multiple)}},styles:["mat-form-field[_ngcontent-%COMP%]{height:3.5em;width:100%;padding:0 .25em}.body[_ngcontent-%COMP%]{min-width:20rem;max-width:calc(100vw - 2rem);max-height:65vh;overflow:auto}"]}),n})();e.B6R(fn,[N,L.lW,q.ZT,g.O5,F.KE,ce.gD,g.sg,Q.ey,Tt,V.$g],[g.Ov]),e.B6R(Tt,[g.O5,N,L.lW],[]);let Ye=0;const xs=["app-bootstrap",""];function ws(n,o){if(1&n&&(e.TgZ(0,"mat-option",10),e.TgZ(1,"div",11),e.TgZ(2,"div",12),e._uU(3),e.qZA(),e.TgZ(4,"div",13),e._uU(5),e.qZA(),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.hij(" ",t.id," ")}}function Ts(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"p",4),e._uU(2," Input the PlaceOS "),e.TgZ(3,"em"),e._uU(4,"System ID"),e.qZA(),e._uU(5," to bootstrap "),e.qZA(),e.TgZ(6,"mat-form-field",5),e.TgZ(7,"mat-label"),e._uU(8,"System ID"),e.qZA(),e.TgZ(9,"input",6),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().system_id=s})("ngModelChange",function(s){return e.CHM(t),e.oxw().filter(s)}),e.qZA(),e.qZA(),e.TgZ(10,"mat-autocomplete",null,7),e.YNc(12,ws,6,3,"mat-option",8),e.qZA(),e.TgZ(13,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().bootstrap()}),e._uU(14," Submit "),e.qZA(),e.BQk()}if(2&n){const t=e.MAs(11),i=e.oxw();e.xp6(9),e.Q6J("ngModel",i.system_id)("matAutocomplete",t),e.xp6(3),e.Q6J("ngForOf",i.filtered_list),e.xp6(1),e.Q6J("disabled",!i.system_id)}}function Zs(n,o){1&n&&(e.TgZ(0,"div",14),e._UZ(1,"mat-spinner",15),e.TgZ(2,"div",16),e._uU(3,"Loading system data..."),e.qZA(),e.qZA()),2&n&&(e.xp6(1),e.Q6J("diameter",32))}let ks=(()=>{class n extends O{constructor(t,i,s){super(),this._spaces=t,this.route=i,this._router=s,this.system_list=[],this.filtered_list=[],this.selected_system=null,this.bootstrap=()=>this.configure(this.system_id),this.clearBootstrap=()=>localStorage.removeItem("PLACEOS.BOOKINGS.system")}ngOnInit(){return(0,A.mG)(this,void 0,void 0,function*(){this.loading=!0,yield this._spaces.initialised.pipe((0,H.P)(t=>t)).toPromise(),this.system_list=this._spaces.space_list||[],this.filter(""),this.loading=!1,this.subscription("route.query",this.route.queryParamMap.subscribe(t=>{t.has("clear")&&!!t.get("clear")&&this.clearBootstrap(),(t.has("system_id")||t.has("sys_id"))&&(this.system_id=t.get("system_id")||t.get("sys_id"),this.bootstrap())})),this.checkBootstrapped()})}checkBootstrapped(){if(this.loading=!0,localStorage){const t=localStorage.getItem("PLACEOS.BOOKINGS.system");if(t)return void this._router.navigate(["panel",t])}this.loading=!1}configure(t){this.loading=!0,localStorage&&(localStorage.setItem("PLACEOS.BOOKINGS.system",t),localStorage.setItem("trust","true"),localStorage.setItem("fixed_device","true")),this._router.navigate(["panel",t]),this.loading=!1}filter(t){const i=t.toLowerCase();this.filtered_list=this.system_list.filter(s=>s.name.toLowerCase().includes(i)||s.id.includes(t)).slice(0,100)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(nt),e.Y36(J.gz),e.Y36(J.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["","app-bootstrap",""]],features:[e.qOj],attrs:xs,decls:6,vars:2,consts:[[1,"rounded","shadow","m-4","bg-white","overflow-hidden","mx-auto","text-center","flex","flex-col","items-center"],[1,"bg-primary","text-white","py-2","px-4","m-0","w-full","text-2xl"],[4,"ngIf","ngIfElse"],["load_state",""],[1,"description","py-4"],["appearance","outline"],["matInput","","placeholder","System ID",3,"ngModel","matAutocomplete","ngModelChange"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","click"],[3,"value"],[1,"leading-tight"],[1,"name"],[1,"text-xs","text-dark-fade"],["load","",1,"my-16","flex","flex-col","items-center"],[3,"diameter"],[1,"m-4"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h2",1),e._uU(2," Booking Panel Setup "),e.qZA(),e.YNc(3,Ts,15,4,"ng-container",2),e.qZA(),e.YNc(4,Zs,4,1,"ng-template",null,3,e.W1O)),2&t){const s=e.MAs(5);e.xp6(3),e.Q6J("ngIf",!i.loading)("ngIfElse",s)}},directives:[g.O5,F.KE,F.hX,ee.Nt,_.Fj,W.ZL,_.JJ,_.On,W.XC,g.sg,L.lW,Q.ey,V.$g],styles:["[_nghost-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-color:#f0f0f0;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%23ddd' fill-opacity='1' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem)}mat-form-field[_ngcontent-%COMP%]{width:calc(100% - 2rem)}button[_ngcontent-%COMP%]{width:8rem;margin:0 .5rem .5rem}"]}),n})();var ot=m(1618),St=m(9170),As=m(3466),gn=m(639),st=m(3483),Ve=m(8168),at=m(9189);class Os{constructor(o={}){var t;this.id=o.id||"",this.name=o.name||o.id||"",this.category=o.category||"",this.unit_price=o.unit_price||0,this.description=o.description||"",this.quantity=o.quantity||0,this.discount_cap=o.discount_cap||0,this.accept_points=!!o.accept_points,this.options=o.options||[],this.tags=o.tags||[],this.total_cost=(this.unit_price+this.options.map(i=>i.unit_price||0).reduce((i,s)=>i+s,0))*this.quantity,this.options_string=(null===(t=this.options)||void 0===t?void 0:t.map(i=>i.id||"").sort((i,s)=>i.localeCompare(s)).join(","))||""}}class vn{constructor(o={}){var t,i;this.id=o.id||`order-${Ge(9999999,1e6)}`,this.system_id=o.system_id||"",this.event_id=o.event_id||(null===(t=o.event)||void 0===t?void 0:t.id)||"",this.items=(o.items||[]).map(s=>new Os(s)),this.item_count=this.items.reduce((s,a)=>s+a.quantity,0),this.total_cost=this.items.reduce((s,a)=>s+(a.total_cost||0),0),this.charge_code=o.charge_code||"",this.status=o.status||"accepted",this.invoice_number=o.invoice_number||"",this.event=o.event||null,this.deliver_at=o.deliver_at||o.date||(null===(i=this.event)||void 0===i?void 0:i.date)||(new Date).getTime()}}let Mt={id:"default",name:"Default User"};class B{constructor(o={}){var t,i,s;this.id=o.id||"",this.event_start=o.event_start||(0,D.Z)(o.date||(0,st.Z)((0,z.Z)(new Date,3),{nearestTo:5})),this.event_end=o.event_end||(0,D.Z)((0,z.Z)(1e3*this.event_start,o.duration||30)),this.calendar=o.calendar||"",this.creator=(null===(t=o.creator||Mt.email)||void 0===t?void 0:t.toLowerCase())||"",this.host=(o.host||this.creator||Mt.email||"").toLowerCase();const a=o.attendees||[];this.attendees=a.filter(c=>!c.resource).map(c=>new te(c)),this.resources=ve(o.resources||a.filter(c=>c.resource).map(c=>new De(c)),"email")||[],this.title=o.title||"",this.body=o.body||"",this.private=!!o.private,this.all_day=!!o.all_day,this.date=1e3*this.event_start,this.duration=this.all_day?1440:o.duration||(0,de.Z)(1e3*o.event_end,this.date)||30,this.timezone=o.timezone||"",this.meeting_url=o.meeting_url||o.online_meeting_url||"",this.meeting_id=o.meeting_id||o.online_meeting_id||"",this.meeting_provider=o.meeting_provider||o.online_meeting_provider||"",this.recurring=!!o.recurring,this.recurring_master_id=o.recurring_master_id||"",this.organiser=this.attendees.find(c=>c.email===this.host),this.master=o.master?new B(o.master):null,this.recurrence=o.recurring?{start:1e3*this.event_start||new Date(1e3*o.recurrence.range_start).valueOf(),end:o.recurrence.end||new Date(1e3*o.recurrence.range_end).valueOf(),interval:o.recurrence.interval,pattern:o.recurrence.pattern,days_of_week:o.recurrence.days_of_week}:{};const r=o.system;(null==r?void 0:r.email)&&!this.resources.find(c=>c.email===r.email)&&this.resources.push(new De(r)),this.system=r||this.resources[0]||null,this.old_system=o.old_system||o.system,this.attachments=o.attachments||[],this.extension_data=o.extension_data||{},this.status=function(n){var o;return(null===(o=n.resources)||void 0===o?void 0:o.length)?n.resources.every(t=>"accepted"===t.response_status)?"approved":n.resources.some(t=>"tentative"===t.response_status||"needsAction"===t.response_status)?"tentative":"declined":"approved"}(this)||"none",this.location=o.location||(null===(i=this.space)||void 0===i?void 0:i.display_name)||(null===(s=this.space)||void 0===s?void 0:s.name)||"",this.type="declined"===this.status?"cancelled":this.attendees.find(c=>c.is_external)?"external":"internal";for(const c in o)c in this||(this.extension_data[c]=o[c]||this.extension_data[c]);this.extension_data.catering=(this.extension_data.catering||[]).map(c=>new vn(Object.assign(Object.assign({},c),{event:this})))}ext(o){return this.extension_data[o]}get guests(){return this.attendees.filter(o=>!!o.is_external)}get space(){return this.resources[0]||null}get is_today(){return(0,Xe.Z)(new Date(this.date),new Date)}toJSON(){var o;const t=Object.assign({},this),i=(0,D.Z)((0,z.Z)(this.date,this.duration)),s=this.all_day?(0,Ve.Z)(this.date,{hours:12}):this.date;t.event_start=(0,D.Z)(s),t.event_end=i;const a=this.attendees;return this.recurring&&(t.recurrence=Object.assign(Object.assign({},this.recurrence),{range_start:t.event_start,range_end:(0,D.Z)(this.recurrence.end)})),t.recurrence=t.recurrence&&Object.keys(t.recurrence).length?t.recurrence:null,t.attendees=ve(a,"email"),this.all_day||(t.extension_data.breakdown=15),t.extension_data.catering=t.extension_data.catering.map(r=>new vn(Object.assign(Object.assign({},r),{event:null}))),t.system_id=null===(o=this.system)||void 0===o?void 0:o.id,delete t.catering,delete t.date,delete t.duration,delete t.status,t}get state(){const o=new Date,t=this.date;return(0,Ue.Z)(o,(0,at.Z)(t,{minutes:-15}))?"future":(0,Ue.Z)(o,t)?"upcoming":(0,Ue.Z)(o,(0,at.Z)(t,{minutes:15}))?"started":(0,Ue.Z)(o,(0,at.Z)(t,{minutes:this.duration}))?"in_progress":"done"}get can_check_in(){const o=new Date;return this.is_today||(0,be.Z)(o,this.date)&&(0,Ue.Z)(o,(0,z.Z)(this.date,this.duration))}}const se="/api/staff/v1/events";var Fs=m(5939),Es=m(1112);const Ps=n=>{var o;return(null===(o=n.parent)||void 0===o?void 0:o.get("date"))&&(0,be.Z)(new Date,(0,z.Z)(n.parent.get("date").value,n.value))?{duration:!0}:null};(0,at.Z)((0,Fs.Z)((0,Es.Z)(new Date,6),0),{days:-1});const qs=["book/spaces","schedule/view"];let $s=(()=>{class n extends O{constructor(t,i){super(),this._org=t,this._router=i,this._view=new E.X("form"),this._options=new E.X({zone_ids:[]}),this._form=new E.X(null),this._event=new E.X(null),this._loading=new E.X(""),this.last_success=new B(JSON.parse(sessionStorage.getItem("PLACEOS.last_booked_event")||"{}")),this.loading=this._loading.asObservable(),this.options=this._options.pipe((0,pe.d)(1)),this.available_spaces=(0,oe.aj)([this._view,this._options,this._form,this._org.initialised.pipe((0,St.h)(s=>s))]).pipe((0,St.h)(([s,a,r])=>"find"===s&&!!r),(0,gn.b)(300),(0,Ie.w)(([s,a,r])=>{var c,h;this._loading.next("Retrieving available spaces...");const k=r.value.date+60*r.value.duration*1e3;return Ot({period_start:(0,D.Z)(r.value.date),period_end:(0,D.Z)(k),zone_ids:(null===(c=a.zone_ids)||void 0===c?void 0:c.join(","))||this._org.building.id,features:null===(h=a.features)||void 0===h?void 0:h.join(","),capacity:a.capacity},this._org)}),(0,Z.U)(s=>s.filter(a=>{var r;return!(null===(r=a.availability)||void 0===r?void 0:r.length)||a.availability.find(c=>"busy"!==c.status)})),(0,cn.b)(s=>{this._loading.next("")}),(0,pe.d)(1)),this.available_spaces.subscribe(),this.subscription("router.events",this._router.events.subscribe(s=>{s instanceof J.m2&&!qs.some(a=>s.url.includes(a))&&this.clearForm()}))}get view(){return this._view.getValue()}get form(){return this._form.getValue()}get event(){return this._event.getValue()}setView(t){this._view.next(t)}setOptions(t){this._options.next(Object.assign(Object.assign({},this._options.getValue()),t))}newForm(t=new B){this._form.next(function(n){var o,t,i;const s=new _.cw({id:new _.NI(n.id),host:new _.NI(n.host||"",[_.kI.required]),organiser:new _.NI(n.organiser||{},[_.kI.required]),creator:new _.NI(n.creator,[_.kI.required]),calendar:new _.NI(n.calendar),attendees:new _.NI(n.attendees||[]),resources:new _.NI(n.resources||[]),title:new _.NI(n.title,[_.kI.required]),body:new _.NI(n.body),private:new _.NI(n.private),date:new _.NI(n.date,[_.kI.required]),duration:new _.NI(n.duration,[Ps]),all_day:new _.NI(n.all_day),recurring:new _.NI(n.recurring),recurrence:new _.NI(n.recurrence),recurring_master_id:new _.NI(n.recurring_master_id),master:new _.NI(n.master),attachments:new _.NI(n.attachments),catering:new _.NI((null===(o=n.extension_data)||void 0===o?void 0:o.catering)||[]),visitor_type:new _.NI(null===(t=n.extension_data)||void 0===t?void 0:t.visitor_type),location:new _.NI(n.location),needs_space:new _.NI(!0),needs_parking:new _.NI((null===(i=n.extension_data)||void 0===i?void 0:i.needs_parking)||!1),system:new _.NI(n.system)});return s.get("organiser").valueChanges.subscribe(a=>s.controls.host.setValue(null==a?void 0:a.email)),s.get("resources").valueChanges.subscribe(a=>s.controls.system.setValue(a.length?a[0]:null)),n.id&&(s.get("host").disable(),s.get("organiser").disable()),"started"===n.state&&s.get("date").disable(),s}(t)),this.subscription("form_change",this._form.getValue().valueChanges.subscribe(()=>this.storeForm())),this._event.next(t),this._options.next({})}resetForm(){this._form.getValue()||this.newForm();const t=this._event.getValue();this._form.getValue().patchValue(Object.assign(Object.assign({},t||{}),(null==t?void 0:t.extension_data)||{})),this._options.next({})}clearForm(){sessionStorage.removeItem("PLACEOS.event_form"),this.newForm()}storeForm(){var t;sessionStorage.setItem("PLACEOS.event_form",JSON.stringify((null===(t=this._form.getValue())||void 0===t?void 0:t.value)||{}))}loadForm(){this._form.getValue()||this.newForm(),this._form.getValue().patchValue(Object.assign({},JSON.parse(sessionStorage.getItem("PLACEOS.event_form")||"{}")))}postForm(){var t;return(0,A.mG)(this,void 0,void 0,function*(){const i=this._form.getValue();if(!i)throw"No form for event";if(!i.valid)throw`Some form fields are invalid. [${function(n){const o=[];for(const t in n.controls)n.controls[t].valid||o.push(t);return o}(i).join(", ")}]`;const s=(null===(t=i.get("resources"))||void 0===t?void 0:t.value)||[],a=s.length?yield Ot({period_start:(0,D.Z)(i.get("date").value),period_end:(0,D.Z)(i.get("date").value+60*i.get("duration").value*1e3),system_ids:s.map(c=>c.id).join(",")}).toPromise():[];if(a.length!==s.length)throw s.length-a.length+" space(s) are not available at the selected time";const r=yield((n,o)=>{var t;return null===(t=n)||void 0===t||delete t.status,n.id?function(n,o,t={},i="patch"){const s=We(t);return("patch"===i?b.r$K:b.gzd)(`${se}/${encodeURIComponent(n)}${s?"?"+s:""}`,"patch"===i?o:new B(o).toJSON()).pipe((0,Z.U)(a=>new B(a)))}(n.id,n,o):function(n){return(0,b.v_Q)(`${se}`,new B(n).toJSON()).pipe((0,Z.U)(o=>new B(o)))}(n)})(new B(this._form.getValue().value)).toPromise();return this.clearForm(),this.last_success=r,sessionStorage.setItem("PLACEOS.last_booked_event",JSON.stringify(r)),this.setView("success"),r})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Le),e.LFG(J.F0))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var js=m(9441),It=m(1134),Js=m(2720),Ds=m(3720),Bs=m(8293);function Ys(n,o){if(1&n&&(e.TgZ(0,"main",6),e._UZ(1,"user-form",7),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("form",t.form)}}function Vs(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"footer",8),e.TgZ(1,"button",9),e._uU(2,"Cancel"),e.qZA(),e.TgZ(3,"button",10),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveChanges()}),e._uU(4,"Save"),e.qZA(),e.qZA()}}function Qs(n,o){1&n&&(e.TgZ(0,"main",11),e._UZ(1,"mat-spinner",12),e.TgZ(2,"p"),e._uU(3,"Saving attendee..."),e.qZA(),e.qZA())}let bn=(()=>{class n extends O{constructor(t){super(),this._data=t,this.event=new e.vpe,this.loading=!1}ngOnInit(){this.user=this._data.user||{},this.form=function(n){var o;if(!n)throw Error("No user passed");const t={name:new _.NI(n.name||""),email:new _.NI(n.email||"",[_.kI.email,_.kI.required]),organisation:new _.NI(n.organisation||"",_.kI.required),phone:new _.NI(n.phone||"",_.kI.pattern(/[+\-()0-9]{1,24}/g)),assistance_required:new _.NI(n.assistance_required||!1),visit_expected:new _.NI(null===(o=n.visit_expected)||void 0===o||o)};return new _.cw(t)}(this.user)}saveChanges(){if(this.form&&(this.form.markAllAsTouched(),this.form.valid)){const t=new te(Object.assign(Object.assign({},this.form.value),{type:"external"}));this.event.emit({reason:"done",metadata:t})}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(q.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["new-user-modal"]],outputs:{event:"event"},features:[e.qOj],decls:11,vars:4,consts:[["mat-dialog-title","",1,"heading"],[1,"flex-1"],["mat-icon-button","","mat-dialog-close",""],["class","flex flex-col items-center w-full p-2",4,"ngIf","ngIfElse"],["class","flex items-center justify-center w-full p-2 border-t border-gray-300 space-x-2",4,"ngIf"],["load_state",""],[1,"flex","flex-col","items-center","w-full","p-2"],[3,"form"],[1,"flex","items-center","justify-center","w-full","p-2","border-t","border-gray-300","space-x-2"],["mat-button","","mat-dialog-close","",1,"inverse"],["mat-button","",3,"click"],[1,"flex","flex-col","items-center","w-full","p-2","space-y-2"],["diameter","32"]],template:function(t,i){if(1&t&&(e.TgZ(0,"header"),e.TgZ(1,"div",0),e._uU(2),e.qZA(),e._UZ(3,"div",1),e.TgZ(4,"button",2),e.TgZ(5,"app-icon"),e._uU(6,"close"),e.qZA(),e.qZA(),e.qZA(),e.YNc(7,Ys,2,1,"main",3),e.YNc(8,Vs,5,0,"footer",4),e.YNc(9,Qs,4,0,"ng-template",null,5,e.W1O)),2&t){const s=e.MAs(10);e.xp6(2),e.hij(" ",null!=i.user&&i.user.id?"Edit":"Add"," External Attendee "),e.xp6(5),e.Q6J("ngIf",!i.loading)("ngIfElse",s),e.xp6(1),e.Q6J("ngIf",!i.loading)}},styles:["main[_ngcontent-%COMP%]{min-height:20em!important;width:100%}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em}"]}),n})();var Cn=m(3393);function zs(n,o){if(1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"label",4),e._uU(2," Name"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",5),e._UZ(7,"input",6),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.ekj("error",t.hasError("name"))}}function Rs(n,o){if(1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"label",7),e._uU(2," Email"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",5),e._UZ(7,"input",8),e.TgZ(8,"mat-error"),e._uU(9,"A valid email is required"),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.ekj("error",t.hasError("email"))}}function Hs(n,o){if(1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"label",9),e._uU(2," Organisation"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",5),e._UZ(7,"input",10),e.TgZ(8,"mat-error"),e._uU(9,"Organisation is required"),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.ekj("error",t.hasError("organisation"))}}function Gs(n,o){if(1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"label",11),e._uU(2," Phone: "),e.qZA(),e.TgZ(3,"mat-form-field",5),e._UZ(4,"input",12),e.TgZ(5,"mat-error"),e._uU(6,"Phone format is invalid"),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.ekj("error",t.hasError("phone"))}}function Xs(n,o){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"mat-checkbox",13),e._uU(2," Assistance required "),e.qZA(),e.qZA())}function Ks(n,o){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"mat-checkbox",14),e._uU(2," Visit expected "),e.qZA(),e.qZA())}function Ws(n,o){if(1&n&&(e.TgZ(0,"form",1),e.YNc(1,zs,10,2,"div",2),e.YNc(2,Rs,10,2,"div",2),e.YNc(3,Hs,10,2,"div",2),e.YNc(4,Gs,7,2,"div",2),e.YNc(5,Xs,3,0,"div",2),e.YNc(6,Ks,3,0,"div",2),e.qZA()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.form.controls.name),e.xp6(1),e.Q6J("ngIf",t.form.controls.email),e.xp6(1),e.Q6J("ngIf",t.form.controls.organisation),e.xp6(1),e.Q6J("ngIf",t.form.controls.phone),e.xp6(1),e.Q6J("ngIf",t.form.controls.assistance_required),e.xp6(1),e.Q6J("ngIf",t.form.controls.visit_expected)}}let ea=(()=>{class n{hasError(t){var i;const{invalid:s,touched:a}=(null===(i=this.form)||void 0===i?void 0:i.controls[t])||{};return s&&a}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["user-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[["user-form","",3,"formGroup",4,"ngIf"],["user-form","",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","name"],["appearance","outline"],["matInput","","name","name","placeholder","Name","formControlName","name"],["for","email"],["matInput","","name","email","placeholder","Email Address","formControlName","email"],["for","org"],["matInput","","name","org","placeholder","Organisation","formControlName","organisation"],["for","phone"],["matInput","","name","phone","type","tel","placeholder","Phone","formControlName","phone"],["name","assistance-required","color","primary","formControlName","assistance_required"],["name","visit-expected","color","primary","formControlName","visit_expected"]],template:function(t,i){1&t&&e.YNc(0,Ws,7,7,"form",0),2&t&&e.Q6J("ngIf",i.form)},directives:[g.O5,_._Y,_.JL,_.sg,F.KE,ee.Nt,_.Fj,_.JJ,_.u,F.TO,Cn.oG],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),n})();e.B6R(bn,[q.uh,L.lW,q.ZT,N,g.O5,ea,V.$g],[]);function ta(n){const o=We({q:n});return(0,b.U2M)("/api/staff/v1/guests"+(n?"?"+o:"")).pipe((0,Z.U)(t=>t.map(i=>new vi(i))))}function yn(n){const o=We({q:n});return(0,b.U2M)("/api/staff/v1/people"+(n?"?"+o:"")).pipe((0,Z.U)(t=>t.map(i=>new Ht(i))))}const na=["input"];function ia(n,o){1&n&&e._UZ(0,"mat-spinner",11)}function oa(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-option",12),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return r.setValue(a),r.blurInput()}),e.TgZ(1,"div",13),e._uU(2),e.qZA(),e.TgZ(3,"div",14),e._uU(4),e.qZA(),e.qZA()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.hij(" ",t.email," ")}}function sa(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-option",15),e.TgZ(1,"div",16),e.NdJ("mousedown",function(s){return s.stopPropagation(),s.preventDefault()})("touchstart",function(s){return s.stopPropagation(),s.preventDefault()})("click",function(s){e.CHM(t);const a=e.oxw();return a.setValue(a.search_str),s.stopPropagation(),s.preventDefault()}),e.TgZ(2,"div",17),e._uU(3),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(3),e.hij(' Add external attendee "',t.search_str,'" ')}}function aa(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-option",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().empty_fn()}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.empty_fn),e.xp6(1),e.AsE(" ",t.search_str?"No users found.":""," ",t.error," ")}}let Ft=(()=>{class n extends O{constructor(){super(...arguments),this.error="",this.query_fn=t=>yn(t),this.search$=new js.xQ,this.search_results$=this.search$.pipe((0,gn.b)(400),(0,Ds.x)(),(0,Ie.w)(t=>(this.loading=!0,this.options&&this.options.length>0?(0,It.of)(this.options):t.length>=3?this.guests?(0,Js.D)([yn(t),ta(t)]):this.query_fn(t):(0,It.of)([]))),(0,Bs.K)(t=>(0,It.of)([])),(0,Z.U)(t=>{this.loading=!1,t=function(n){const o=[...n],t=[];for(;o.length;){const i=o.pop();Array.isArray(i)?o.push(...i):t.push(i)}return t.reverse()}(t);const i=(this.search_str||"").toLowerCase();return t.filter(s=>!this.filter||this.filter(s,i))})),this.cancelReset=()=>this.clearTimeout("reset"),this.blurInput=()=>{this.timeout("blur",()=>{var t,i;return null===(i=null===(t=this._input_el)||void 0===t?void 0:t.nativeElement)||void 0===i?void 0:i.blur()})}}ngOnInit(){this.subscription("search_results",this.search_results$.subscribe(t=>this.user_list=t))}resetSearchString(){this.timeout("reset",()=>{var t;return this.search_str=(null===(t=this.active_user)||void 0===t?void 0:t.name)||""},100)}setValue(t,i){"string"==typeof t&&t===this.search_str&&(t=new te({name:(this.search_str||i||"").split("@")[0],email:this.search_str||i||""})),t instanceof te&&(this.active_user=t,this._onChange&&this._onChange(t),this.resetSearchString())}writeValue(t){this.active_user=t,this.resetSearchString()}setDisabledState(t){this.disabled=t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouch=t}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=e.n5z(n)))(i||n)}}(),n.\u0275cmp=e.Xpm({type:n,selectors:[["a-user-search-field"]],viewQuery:function(t,i){if(1&t&&e.Gf(na,5,e.SBq),2&t){let s;e.iGM(s=e.CRH())&&(i._input_el=s.first)}},inputs:{disabled:"disabled",placeholder:"placeholder",options:"options",guests:"guests",error:"error",validate:"validate",empty_fn:"empty_fn",filter:"filter",query_fn:"query_fn"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}]),e.qOj],decls:12,vars:8,consts:[["form-field","",1,"user-search-field","text-black"],["overlay","","appearance","outline"],["matInput","","keyboard","","name","user-search",3,"ngModel","disabled","placeholder","matAutocomplete","ngModelChange","keyup.enter","blur","focus"],["input",""],["matPrefix","",1,"text-2xl","relative"],["matSuffix","","diameter","16",4,"ngIf"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"click",4,"ngFor","ngForOf"],["class","relative pointer-events-none",4,"ngIf"],[3,"disabled","click",4,"ngIf"],["matSuffix","","diameter","16"],[3,"click"],[1,"leading-tight"],[1,"text-xs","text-black","opacity-60"],[1,"relative","pointer-events-none"],[1,"absolute","inset-0","px-4","pointer-events-auto",3,"mousedown","touchstart","click"],[1,"pointer-events-none"],[3,"disabled","click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"mat-form-field",1),e.TgZ(2,"input",2,3),e.NdJ("ngModelChange",function(a){return i.search_str=a})("ngModelChange",function(a){return i.search$.next(a||"")})("keyup.enter",function(){return i.validate&&i.validate(i.search_str)?i.setValue(i.search_str):""})("blur",function(){return i.resetSearchString()})("focus",function(){return i.cancelReset()}),e.qZA(),e.TgZ(4,"app-icon",4),e._uU(5,"search"),e.qZA(),e.YNc(6,ia,1,0,"mat-spinner",5),e.qZA(),e.TgZ(7,"mat-autocomplete",6,7),e.NdJ("optionSelected",function(a){return i.setValue(a.option.value)}),e.YNc(9,oa,5,2,"mat-option",8),e.YNc(10,sa,4,1,"mat-option",9),e.YNc(11,aa,2,3,"mat-option",10),e.qZA(),e.qZA()),2&t){const s=e.MAs(8);e.xp6(2),e.Q6J("ngModel",i.search_str)("disabled",i.disabled)("placeholder",i.placeholder||"Search for user...")("matAutocomplete",s),e.xp6(4),e.Q6J("ngIf",i.loading),e.xp6(3),e.Q6J("ngForOf",i.user_list),e.xp6(1),e.Q6J("ngIf",i.search_str&&i.validate&&i.validate(i.search_str)),e.xp6(1),e.Q6J("ngIf",!(null!=i.user_list&&i.user_list.length)&&(i.search_str||i.error))}},directives:[F.KE,ee.Nt,rn,_.Fj,W.ZL,_.JJ,_.On,N,F.qo,g.O5,W.XC,g.sg,V.$g,F.R9,Q.ey],styles:["[_nghost-%COMP%], mat-form-field[_ngcontent-%COMP%]{width:100%}app-icon[_ngcontent-%COMP%]{top:.15em;left:-.15em}"]}),n})();var rt=m(6737),xn=m(6186),wn=m(8703);const ra=["select"];function la(n,o){if(1&n&&(e.TgZ(0,"mat-option",9),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function ca(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field",5),e.TgZ(1,"mat-select",6,7),e.NdJ("valueChange",function(s){return e.CHM(t),e.oxw().setValue(s)}),e.YNc(3,la,2,2,"mat-option",8),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("value",t.time)("disabled",t.disabled),e.xp6(2),e.Q6J("ngForOf",t.time_options)}}const ua=["*"];let Tn=(()=>{class n extends O{constructor(){super(...arguments),this.step=15,this.no_past_times=!0,this.date=(new Date).valueOf(),this.time=(0,j.Z)(new Date,"HH:mm")}ngOnInit(){this.show_select=!0,this._time_options=this.generateAvailableTimes(this.date,!this.no_past_times,this.step),this.timeout("hide",()=>this.show_select=!1)}ngOnChanges(t){(t.no_past_times||t.step)&&(this._time_options=this.generateAvailableTimes(this.date,!this.no_past_times,this.step))}get time_options(){const t=(this.time||"00:00").split(":"),i=(0,Ve.Z)(this.date,{hours:+t[0],minutes:+t[1]});return i.getMinutes()%15!=0&&!this._time_options.find(s=>s.id===(0,j.Z)(i,"HH:mm"))&&(this._time_options.push({name:`${(0,j.Z)(i,Qt())}`,id:(0,j.Z)(i,"HH:mm")}),this._time_options.sort((s,a)=>`${s.id}`.localeCompare(`${a.id}`))),this._time_options}setValue(t){if(this.time=t,this._onChange){const i=(this.time||"00:00").split(":"),s=(0,rt.Z)((0,Ve.Z)(this.date,{hours:+i[0],minutes:+i[1]}));this._onChange(s.valueOf())}}writeValue(t){this.date=t||this.date;let i=(0,rt.Z)(this.date);i=(0,st.Z)(i,{nearestTo:5}),this.time=(0,j.Z)(i,"HH:mm"),this._time_options=this.generateAvailableTimes(this.date,!this.no_past_times,this.step)}setDisabledState(t){this.disabled=t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouch=t}showSelect(){this.show_select=!0,this.timeout("on_shown",()=>{this.select_field&&(this.select_field.focus(),this.select_field.open(),this.subscription("listen_close",this.select_field.openedChange.subscribe(t=>{t||(this.show_select=!1)})))})}generateAvailableTimes(t,i,s=15){const a=new Date;let r=new Date(t);const c=[];i||!(0,Xe.Z)(r,a)&&(0,be.Z)(r,a)?r=(0,xn.Z)(r):(0,be.Z)(r,a)&&(r=a),r=(0,st.Z)(r,{nearestTo:s});const h=(0,wn.Z)(r);for(;(0,be.Z)(h,r);)c.push({name:`${(0,j.Z)(r,Qt())}`,id:(0,j.Z)(r,"HH:mm")}),r=(0,z.Z)(r,s);return c}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=e.n5z(n)))(i||n)}}(),n.\u0275cmp=e.Xpm({type:n,selectors:[["a-time-field"]],viewQuery:function(t,i){if(1&t&&e.Gf(ra,5),2&t){let s;e.iGM(s=e.CRH())&&(i.select_field=s.first)}},inputs:{step:"step",disabled:"disabled",no_past_times:"no_past_times"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}]),e.qOj,e.TTD],ngContentSelectors:ua,decls:8,vars:5,consts:[["appearance","outline",3,"keydown.enter"],["matInput","","type","time",3,"disabled","ngModel","ngModelChange"],["mat-icon-button","","matSuffix","",1,"relative","top-1","-right-1",3,"click"],[1,"text-2xl","text-black","text-opacity-50"],["appearance","outline",4,"ngIf"],["appearance","outline"],[3,"value","disabled","valueChange"],["select",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){1&t&&(e.F$t(),e.TgZ(0,"mat-form-field",0),e.NdJ("keydown.enter",function(){return i.showSelect()}),e.TgZ(1,"input",1),e.NdJ("ngModelChange",function(a){return i.setValue(a)}),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return i.showSelect()}),e.TgZ(3,"app-icon",3),e._uU(4," arrow_drop_down "),e.qZA(),e.qZA(),e.TgZ(5,"mat-error"),e.Hsn(6),e.qZA(),e.qZA(),e.YNc(7,ca,4,3,"mat-form-field",4)),2&t&&(e.Udp("display",i.show_select?"none":""),e.xp6(1),e.Q6J("disabled",i.disabled)("ngModel",i.time),e.xp6(6),e.Q6J("ngIf",i.show_select))},directives:[F.KE,ee.Nt,_.Fj,_.JJ,_.On,L.lW,F.R9,N,F.TO,g.O5,ce.gD,g.sg,Q.ey],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),n})();var Ce=m(5320),Qe=m(160);function pa(n,o){if(1&n&&(e.TgZ(0,"mat-option",5),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}const da=["*"];let Zn=(()=>{class n{constructor(){this.max=240,this.min=30,this.step=15,this.specialPreprops=[],this.duration=60}ngOnInit(){this.duration_options=this.generateDurationOptions(this.max,this.min,this.step)}ngOnChanges(t){(t.max||t.min||t.step||t.time)&&(this.duration_options=this.generateDurationOptions(this.max,this.min,this.step))}setValue(t){this.duration=t,this._onChange&&this._onChange(+t)}writeValue(t){this.duration=t}setDisabledState(t){this.disabled=t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouch=t}generateDurationOptions(t,i,s){const a=[];let r=i;const c=this.time?Qe(this.time):null;for(const h of this.specialPreprops)a.push({id:h,name:c?`${c.add(h,"m").format("h:mm A")} (${(0,Ce.Z)({hours:Math.floor(h/60),minutes:h%60})})`:`${(0,Ce.Z)({hours:Math.floor(h/60),minutes:h%60})}`});for(;r<=t;)a.push({id:r,name:c?`${c.add(r,"m").format("h:mm A")} (${(0,Ce.Z)({hours:Math.floor(r/60),minutes:r%60})})`:`${(0,Ce.Z)({hours:Math.floor(r/60),minutes:r%60})}`}),r+=s;return a}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["a-duration-field"]],inputs:{max:"max",min:"min",step:"step",time:"time",disabled:"disabled",specialPreprops:"specialPreprops"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}]),e.TTD],ngContentSelectors:da,decls:7,vars:5,consts:[[1,"duration-field"],["appearance","outline"],[3,"value","disabled","placeholder","valueChange"],["select",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){1&t&&(e.F$t(),e.TgZ(0,"div",0),e.TgZ(1,"mat-form-field",1),e.TgZ(2,"mat-select",2,3),e.NdJ("valueChange",function(a){return i.setValue(a)}),e.YNc(4,pa,2,2,"mat-option",4),e.qZA(),e.TgZ(5,"mat-error"),e.Hsn(6),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.uIk("disabled",i.disabled),e.xp6(2),e.Q6J("value",i.duration)("disabled",i.disabled)("placeholder",i.duration+" minutes"),e.xp6(2),e.Q6J("ngForOf",i.duration_options))},directives:[F.KE,ce.gD,g.sg,F.TO,Q.ey],styles:["[_nghost-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),n})();function ma(n,o){1&n&&(e.TgZ(0,"div",9),e.TgZ(1,"label",10),e._uU(2,"Host"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,":"),e.qZA(),e._UZ(6,"a-user-search-field",11),e.qZA())}function _a(n,o){1&n&&(e.TgZ(0,"div",12),e.TgZ(1,"label",13),e._uU(2,"Start Time:"),e.qZA(),e._UZ(3,"a-time-field",14),e.qZA())}function ha(n,o){1&n&&(e.TgZ(0,"div",12),e.TgZ(1,"label",15),e._uU(2,"Duration:"),e.qZA(),e._UZ(3,"a-duration-field",16),e.qZA())}function fa(n,o){1&n&&(e.TgZ(0,"div",17),e.TgZ(1,"label",10),e._uU(2,"Title"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,":"),e.qZA(),e.TgZ(6,"mat-form-field",18),e._UZ(7,"input",19),e.TgZ(8,"mat-error"),e._uU(9,"Title is required"),e.qZA(),e.qZA(),e.qZA())}function ga(n,o){if(1&n&&(e.TgZ(0,"form",4),e.YNc(1,ma,7,0,"div",5),e.TgZ(2,"div",6),e.YNc(3,_a,4,0,"div",7),e.YNc(4,ha,4,0,"div",7),e.qZA(),e.YNc(5,fa,10,0,"div",8),e.qZA()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.form.controls.organiser),e.xp6(2),e.Q6J("ngIf",t.form.controls.date),e.xp6(1),e.Q6J("ngIf",t.form.controls.duration),e.xp6(1),e.Q6J("ngIf",t.form.controls.title)}}function va(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"footer",20),e.TgZ(1,"button",21),e._uU(2," Cancel "),e.qZA(),e.TgZ(3,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().save()}),e._uU(4," Save "),e.qZA(),e.qZA()}}function ba(n,o){1&n&&(e.TgZ(0,"div",23),e._UZ(1,"mat-spinner",24),e.TgZ(2,"p"),e._uU(3,"Processing request..."),e.qZA(),e.qZA()),2&n&&(e.xp6(1),e.Q6J("diameter",32))}let kn=(()=>{class n extends O{constructor(t){super(),this._data=t,this.event=new e.vpe}ngOnInit(){var t;this.form=new _.cw({room_ids:new _.NI([(null===(t=this._data.space)||void 0===t?void 0:t.email)||""]),date:new _.NI(this._data.date||(new Date).valueOf()),duration:new _.NI(30),title:new _.NI(this._data.title||"",[_.kI.required])})}save(){this.form.markAllAsTouched(),this.form.valid?(this.loading=!0,this.event.emit({reason:"done",metadata:new B(Object.assign({},this.form.value))})):console.log("Invalid form fields. Valid states:",this.form)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(q.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["booking-modal"]],outputs:{event:"event"},features:[e.qOj],decls:7,vars:3,consts:[[1,"bg-primary","p-4"],["class","p-2",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex items-center justify-center p-2 w-full border-t border-gray-200 space-x-2",4,"ngIf"],["load_state",""],[1,"p-2",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","space-x-2"],["class","flex-1",4,"ngIf"],["class","flex flex-col",4,"ngIf"],[1,"field"],["for","host"],["name","host","formControlName","organiser"],[1,"flex-1"],["for","start-time"],["name","start-time","formControlName","date"],["for","duration"],["name","duration","formControlName","duration"],[1,"flex","flex-col"],["appearance","outline",1,"w-full"],["matInput","","name","title","placeholder","Meeting Title","formControlName","title"],[1,"flex","items-center","justify-center","p-2","w-full","border-t","border-gray-200","space-x-2"],["mat-button","","name","close","mat-dialog-close","",1,"inverse","w-32"],["mat-button","","name","save",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","p-8"],[3,"diameter"]],template:function(t,i){if(1&t&&(e.TgZ(0,"header",0),e.TgZ(1,"h3"),e._uU(2,"New Booking"),e.qZA(),e.qZA(),e.YNc(3,ga,6,5,"form",1),e.YNc(4,va,5,0,"footer",2),e.YNc(5,ba,4,1,"ng-template",null,3,e.W1O)),2&t){const s=e.MAs(6);e.xp6(3),e.Q6J("ngIf",i.form&&!i.loading)("ngIfElse",s),e.xp6(1),e.Q6J("ngIf",!i.loading)}},directives:[g.O5,_._Y,_.JL,_.sg,Ft,_.JJ,_.u,Tn,Zn,F.KE,ee.Nt,_.Fj,F.TO,L.lW,q.ZT,V.$g],styles:["form[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem)}"],data:{animation:[]}}),n})(),An=(()=>{class n extends O{constructor(t,i){super(),this._dialog_ref=t,this._data=i,this.control_url=this._data.control_url,this.countdown=30}ngOnInit(){this.countdown=30,this.interval("countdown",()=>this.tick(),1e3)}close(){this._dialog_ref.close(),this.countdown=30}reset(){this.countdown=30,this.interval("countdown",()=>this.tick(),1e3)}tick(){this.countdown<=0&&this.close(),this.countdown--}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(q.so),e.Y36(q.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["embedded-control-modal"]],features:[e.qOj],decls:11,vars:6,consts:[[1,"absolute","inset-0","bg-white"],["modal","",1,"absolute","w-screen","overflow-hidden","bg-primary",3,"click"],[1,"h-full","w-full","border-none"],[1,"h-full","w-full","border-none",3,"src"],[1,"absolute","top-0","left-0","flex","items-center","h-12"],["countdown","",1,"text-2xl","mx-2"],["mat-icon-button","",1,"close",3,"click","contextmenu"],[1,"text-2xl","mx-2"]],template:function(t,i){1&t&&(e._UZ(0,"div",0),e.TgZ(1,"div",1),e.NdJ("click",function(){return i.reset()},!1,e.Jf7),e.TgZ(2,"div",2),e._UZ(3,"iframe",3),e.ALo(4,"safe"),e.qZA(),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e._uU(7),e.qZA(),e.TgZ(8,"button",6),e.NdJ("click",function(){return i.close()})("contextmenu",function(a){return a.preventDefault()}),e.TgZ(9,"app-icon",7),e._uU(10,"close"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("@show",void 0),e.xp6(2),e.Q6J("src",e.xi3(4,3,i.control_url,"resource"),e.uOi),e.xp6(4),e.Oqu(i.countdown))},directives:[L.lW,N],pipes:[$e],styles:["[modal][_ngcontent-%COMP%]{height:calc(100vh - 3em);box-sizing:content-box;border:2px solid #fff;border-top:1px solid #ccc;transform:translate(-50%,calc(-50% + 1.75em))}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex;align-items:center;height:3em}"],data:{animation:[(0,S.X$)("show",[(0,S.eR)(":enter",[(0,S.oB)({opacity:0}),(0,S.jt)(500,(0,S.oB)({opacity:1}))]),(0,S.eR)(":leave",[(0,S.oB)({opacity:1}),(0,S.jt)(1e3,(0,S.oB)({opacity:0}))])])]}}),n})(),X=(()=>{class n extends O{constructor(t,i,s){super(),this._spaces=t,this._dialog=i,this._events=s,this._poll=(0,ot.F)(1e3),this._settings=new E.X({}),this._system=new E.X(""),this.settings=this._settings.asObservable(),this.space=(0,oe.aj)([this._system,this._spaces.list]).pipe((0,Z.U)(([a,r])=>r.find(c=>c.id===a)),(0,pe.d)(1)),this.bookings=this._system.pipe((0,Ie.w)(a=>this._listenToModuleBinding(a,"bookings")),(0,Z.U)(a=>(null==a?void 0:a.length)?a.map(r=>new B(r)):[]),(0,pe.d)(1)),this.current=this._system.pipe((0,Ie.w)(a=>this._listenToModuleBinding(a,"current_booking")),(0,Z.U)(a=>a?new B(a):null),(0,pe.d)(1)),this.next=this._system.pipe((0,Ie.w)(a=>this._listenToModuleBinding(a,"next_booking")),(0,Z.U)(a=>a?new B(a):null),(0,pe.d)(1)),this.status=this._settings.pipe((0,Z.U)(a=>a.status||"free"),(0,pe.d)(1)),this._system.pipe((0,St.h)(a=>!!a)).subscribe(a=>{["disable_book_now","pending","status","control_ui","catering_ui","pending_period","pending_before","room_image","show_qr_code"].forEach(c=>this.bindTo(a,c))})}get system(){return this._system.getValue()}set system(t){this._system.next(t)}setting(t){return this._settings.getValue()[t]}newBooking(t=(new Date).valueOf()){return(0,A.mG)(this,void 0,void 0,function*(){const i=yield function(n,o){return(0,A.mG)(this,void 0,void 0,function*(){const t=o.open(kn,{data:n}),i=(yield Promise.race([t.componentInstance.event.pipe((0,H.P)(s=>"done"===s.reason)).toPromise(),t.afterClosed().toPromise()])).catch(s=>({}));return Object.assign(Object.assign({},i),{close:t.close})})}(Object.assign(Object.assign({},this._settings.getValue()),{space:this._spaces.find(this.system),date:t}),this._dialog);if("done"!==i.reason)return i.close();this._events.newForm(),this._events.form.patchValue(Object.assign({},i.metadata)),yield this._events.postForm(),i.close()})}makeBooking(t){return(0,A.mG)(this,void 0,void 0,function*(){const i=(0,b.rTZ)(this.system,"Bookings");t&&i&&(yield i.execute("book_now",[t.duration,(0,D.Z)(t.date)]).catch(s=>Oe(`Error creating meeting. ${s}`)))})}confirmStart(){return(0,A.mG)(this,void 0,void 0,function*(){"done"===(yield mt({title:"Do you wish to start your meeting?",content:`If you don't start your meeting it will be cancelled ${this._settings.getValue().pending_period/60} minutes after the start time.`,icon:{class:"material-icons",content:"play_arrow"}},this._dialog)).reason&&this.startMeeting()})}startMeeting(){return(0,A.mG)(this,void 0,void 0,function*(){if(this.space&&"pending"===(yield this.status.toPromise())){const t=(yield this.current.toPromise())||(yield this.next.toPromise()),i=(0,b.rTZ)(this.system,"Bookings");t&&i&&(yield i.execute("start_meeting",[t.date]).catch(s=>Oe(`Error starting meeting. ${s}`)))}})}confirmEnd(){return(0,A.mG)(this,void 0,void 0,function*(){"done"===(yield mt({title:"Are you sure want to end your meeting?",content:"Ending your meeting early will free up this room for others to use",icon:{class:"material-icons",content:"stop"}},this._dialog)).reason&&this.endCurrent()})}endCurrent(t="user_input"){return(0,A.mG)(this,void 0,void 0,function*(){const i=yield this.current.pipe((0,As.q)(1)).toPromise(),s=(0,b.rTZ)(this.system,"Bookings");i&&s&&(yield s.execute("cancel_meeting",[i.date,t]).catch(a=>Oe(`Error starting meeting. ${a}`)))})}viewControl(){return(0,A.mG)(this,void 0,void 0,function*(){const t=this._settings.getValue().control_ui;!t||this._dialog.open(An,{data:{control_url:t}})})}confirmWaiter(){return(0,A.mG)(this,void 0,void 0,function*(){"done"===(yield mt({title:"Do you wish to call a waiter?",content:"Note that it can take up to 15 minutes for them to turn up.",icon:{class:"material-icons",content:"room_service"}},this._dialog)).reason&&this.callWaiter()})}callWaiter(){return(0,A.mG)(this,void 0,void 0,function*(){const t=(0,b.rTZ)(this.system,"Bookings");t&&(yield t.execute("waiter_call",[Date.now()]).catch(i=>Oe(`Error calling waiter. ${i}`)))})}bindTo(t,i,s="Bookings",a=(r=>this.updateProperty(i,r))){const r=(0,b.rTZ)(t,s).binding(i);this.subscription(`listen:${i}`,r.listen().subscribe(a)),this.subscription(`bind:${i}`,r.bind())}updateProperty(t,i){const s=Object.assign({},this._settings.getValue());s[t]=i,this._settings.next(s)}_listenToModuleBinding(t,i,s="Bookings"){const r=(0,b.rTZ)(t,s).binding(i);return this.subscription(`binding:${s}:${i}`,r.bind()),r.listen()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(nt),e.LFG(q.uw),e.LFG($s))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();function xa(n,o){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw();let i;e.xp6(1),e.hij(" ",null==(i=e.lcZ(2,1,t.space))?null:i.description," ")}}function wa(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).newEvent()}),e.TgZ(1,"div",9),e.TgZ(2,"app-icon",10),e._uU(3,"add_circle_outline"),e.qZA(),e.TgZ(4,"span",11),e._uU(5,"New Event"),e.qZA(),e.qZA(),e.qZA()}}function Ta(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).viewControl()}),e.TgZ(1,"div",9),e.TgZ(2,"app-icon",10),e._uU(3,"settings_remote"),e.qZA(),e.TgZ(4,"span",11),e._uU(5,"View Control"),e.qZA(),e.qZA(),e.qZA()}}function Za(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).callWaiter()}),e.TgZ(1,"div",9),e.TgZ(2,"app-icon",10),e._uU(3,"room_service"),e.qZA(),e.TgZ(4,"span",11),e._uU(5,"Call Waiter"),e.qZA(),e.qZA(),e.qZA()}}function ka(n,o){if(1&n&&(e.TgZ(0,"div",4),e.YNc(1,wa,6,0,"button",5),e.ALo(2,"async"),e.YNc(3,Ta,6,0,"button",6),e.ALo(4,"async"),e.YNc(5,Za,6,0,"button",7),e.ALo(6,"async"),e.qZA()),2&n){const t=e.oxw();let i,s,a;e.xp6(1),e.Q6J("ngIf",!(null!=(i=e.lcZ(2,3,t.options))&&i.disable_book_now)),e.xp6(2),e.Q6J("ngIf",null==(s=e.lcZ(4,5,t.options))?null:s.control_ui),e.xp6(2),e.Q6J("ngIf",null==(a=e.lcZ(6,7,t.options))?null:a.catering_ui)}}function Aa(n,o){1&n&&(e.TgZ(0,"div",14),e.TgZ(1,"p"),e._uU(2,"No available actions for this space"),e.qZA(),e.qZA())}let Oa=(()=>{class n{constructor(t){this._state=t,this.space=this._state.space,this.options=this._state.settings,this.newEvent=()=>this._state.newBooking(),this.callWaiter=()=>this._state.confirmWaiter(),this.viewControl=()=>this._state.viewControl()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X))},n.\u0275cmp=e.Xpm({type:n,selectors:[["panel-details"]],decls:10,vars:12,consts:[[1,"text-4xl","font-medium","mb-8"],[4,"ngIf"],["class","flex flex-col items-center space-y-2",4,"ngIf","ngIfElse"],["empty_state",""],[1,"flex","flex-col","items-center","space-y-2"],["event","","mat-button","","class","w-48",3,"click",4,"ngIf"],["control","","mat-button","","class","w-48",3,"click",4,"ngIf"],["waiter","","mat-button","","class","w-48",3,"click",4,"ngIf"],["event","","mat-button","",1,"w-48",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"mx-2"],["control","","mat-button","",1,"w-48",3,"click"],["waiter","","mat-button","",1,"w-48",3,"click"],[1,"flex","flex-col","items-center"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"async"),e.ALo(3,"async"),e.qZA(),e.YNc(4,xa,3,3,"p",1),e.ALo(5,"async"),e.YNc(6,ka,7,9,"div",2),e.ALo(7,"async"),e.YNc(8,Aa,3,0,"ng-template",null,3,e.W1O)),2&t){const s=e.MAs(9);let a,r,c;e.xp6(1),e.hij(" ",(null==(a=e.lcZ(2,4,i.space))?null:a.display_name)||(null==(a=e.lcZ(3,6,i.space))?null:a.name)||"<Unknown Space>"," "),e.xp6(3),e.Q6J("ngIf",null==(r=e.lcZ(5,8,i.space))?null:r.description),e.xp6(2),e.Q6J("ngIf",!(null!=(c=e.lcZ(7,10,i.options))&&c.hide_actions))("ngIfElse",s)}},directives:[g.O5,L.lW,N],pipes:[g.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}"]}),n})();var Sa=m(4278);function Ma(n,o){if(1&n&&(e.TgZ(0,"span",8),e._uU(1),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" Starting in ",e.lcZ(2,1,t.starting_in)," ")}}function Ia(n,o){1&n&&(e.TgZ(0,"span",9),e._uU(1," In Progress "),e.qZA())}function Ua(n,o){1&n&&(e.TgZ(0,"span",10),e._uU(1," Waiting to start "),e.qZA())}function Fa(n,o){if(1&n&&(e.TgZ(0,"h2",4),e._uU(1," Current "),e.YNc(2,Ma,3,3,"span",5),e.ALo(3,"async"),e.ALo(4,"async"),e.YNc(5,Ia,2,0,"span",6),e.ALo(6,"async"),e.ALo(7,"async"),e.YNc(8,Ua,2,0,"span",7),e.ALo(9,"async"),e.ALo(10,"async"),e.ALo(11,"async"),e.qZA()),2&n){const t=e.oxw();let i;e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,3,t.started)&&e.lcZ(4,5,t.starting_in)),e.xp6(3),e.Q6J("ngIf",e.lcZ(6,7,t.started)&&!e.lcZ(7,9,t.pending)),e.xp6(3),e.Q6J("ngIf",("upcoming"===(null==(i=e.lcZ(9,11,t.current))?null:i.state)||"in_progress"===(null==(i=e.lcZ(10,13,t.current))?null:i.state))&&e.lcZ(11,15,t.pending))}}function Ea(n,o){if(1&n&&(e.TgZ(0,"div",17),e.TgZ(1,"span"),e.ALo(2,"async"),e._uU(3),e.ALo(4,"date"),e.ALo(5,"async"),e.qZA(),e._UZ(6,"br"),e.TgZ(7,"span"),e.ALo(8,"async"),e._uU(9),e.ALo(10,"date"),e.ALo(11,"async"),e.qZA(),e.qZA()),2&n){const t=e.oxw(2);let i,s;e.xp6(1),e.ekj("opacity-60",e.lcZ(2,6,t.started)),e.xp6(2),e.Oqu(e.xi3(4,8,1e3*(null==(i=e.lcZ(5,11,t.current))?null:i.event_start),"shortTime")),e.xp6(4),e.ekj("opacity-60",!e.lcZ(8,13,t.started)),e.xp6(2),e.Oqu(e.xi3(10,15,1e3*(null==(s=e.lcZ(11,18,t.current))?null:s.event_end),"shortTime"))}}function Pa(n,o){if(1&n&&(e.TgZ(0,"div",18),e.TgZ(1,"div",19),e._uU(2,"Ends at:"),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.ALo(5,"date"),e.ALo(6,"async"),e.ALo(7,"async"),e.qZA(),e.qZA()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.hij(" ",e.xi3(5,1,(null==(i=e.lcZ(6,4,t.current))?null:i.date)+60*(null==(i=e.lcZ(7,6,t.current))?null:i.duration)*1e3,"shortTime")," ")}}function Na(n,o){if(1&n&&(e.TgZ(0,"div",11),e.TgZ(1,"div",12),e.ALo(2,"async"),e.TgZ(3,"div",13),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA(),e.YNc(6,Ea,12,20,"div",14),e.ALo(7,"async"),e.YNc(8,Pa,8,8,"div",15),e.ALo(9,"async"),e.TgZ(10,"div",16),e._uU(11),e.ALo(12,"async"),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();let i;e.xp6(1),e.ekj("text-white",e.lcZ(2,9,t.started)),e.xp6(2),e.ekj("opacity-100",e.lcZ(4,11,t.started))("opacity-0",!e.lcZ(5,13,t.started)),e.xp6(3),e.Q6J("ngIf",!e.lcZ(7,15,t.started)),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,17,t.started)),e.xp6(3),e.hij(" ",(null==(i=e.lcZ(12,19,t.current))?null:i.title)||"<Private Event>"," ")}}function La(n,o){1&n&&(e.TgZ(0,"h2",4),e._uU(1," Upcoming "),e.qZA())}function qa(n,o){if(1&n&&(e.TgZ(0,"li",23),e.TgZ(1,"div",24),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"div",25),e._uU(5),e.qZA(),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",e.xi3(3,2,null==t?null:t.date,"shortTime")," "),e.xp6(3),e.hij(" ",(null==t?null:t.title)||"<Private Event>"," ")}}function $a(n,o){1&n&&e._UZ(0,"li",23)}function ja(n,o){if(1&n&&(e.TgZ(0,"ul",20),e.YNc(1,qa,6,5,"li",21),e.ALo(2,"slice"),e.ALo(3,"async"),e.YNc(4,$a,1,0,"li",22),e.ALo(5,"async"),e.qZA()),2&n){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,2,e.lcZ(3,6,t.upcoming),0,2)),e.xp6(3),e.Q6J("ngIf",(null==(i=e.lcZ(5,8,t.upcoming))?null:i.length)>2)}}function Ja(n,o){1&n&&(e.TgZ(0,"div",26),e.TgZ(1,"p",27),e._uU(2,"No upcoming events for today"),e.qZA(),e.qZA())}let Da=(()=>{class n{constructor(t){this._state=t,this.bookings=this._state.bookings.pipe((0,Z.U)(i=>i.filter(s=>"done"!==s.state&&(0,Xe.Z)(s.date,new Date)))),this.current=this.bookings.pipe((0,Z.U)(i=>i.sort((s,a)=>s.date-a.date)[0])),this.started=(0,oe.aj)([this.current,(0,ot.F)(600)]).pipe((0,Z.U)(([i])=>(0,be.Z)(Date.now(),i.date))),this.starting_in=(0,oe.aj)([this.current,(0,ot.F)(600)]).pipe((0,Z.U)(([i])=>{const s=i?(0,Sa.Z)(i.date,new Date):0;return s&&s<3600?`${(0,Ce.Z)({hours:Math.floor(s/60/60),minutes:Math.floor(s/60)%60,seconds:s<60?s:0})}`:""})),this.pending=(0,oe.aj)([this.current,this._state.settings,(0,ot.F)(600)]).pipe((0,Z.U)(([i,s])=>i&&s.pending_period&&s.pending)),this.upcoming=this.bookings.pipe((0,Z.U)(i=>i.sort((s,a)=>s.date-a.date).slice(1)))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X))},n.\u0275cmp=e.Xpm({type:n,selectors:[["panel-booking-list"]],decls:10,vars:13,consts:[["class","w-full px-4 py-2 mb-2 font-medium",4,"ngIf"],["class","mb-4 w-full",4,"ngIf","ngIfElse"],["class","list-style-none p-0 m-0 bg-white rounded text-base shadow divide-y divide-gray-100 w-full border border-gray-100 max-w-full",4,"ngIf"],["empty_state",""],[1,"w-full","px-4","py-2","mb-2","font-medium"],["class","text-xs shadow px-2 py-1 ml-8 rounded bg-gray-300",4,"ngIf"],["class","text-xs shadow px-2 py-1 ml-8 rounded bg-error text-white",4,"ngIf"],["class","text-xs shadow px-2 py-1 ml-8 rounded bg-pending text-white",4,"ngIf"],[1,"text-xs","shadow","px-2","py-1","ml-8","rounded","bg-gray-300"],[1,"text-xs","shadow","px-2","py-1","ml-8","rounded","bg-error","text-white"],[1,"text-xs","shadow","px-2","py-1","ml-8","rounded","bg-pending","text-white"],[1,"mb-4","w-full"],["current","",1,"flex","items-center","bg-white","rounded-lg","px-4","h-24","text-lg","shadow-md","w-full","border","border-gray-100","relative","max-w-full"],["color","",1,"absolute","-left-2","-right-2","top-2","bottom-2","bg-primary","rounded","z-0"],["class","relative opacity-80 w-24 text-base z-10",4,"ngIf"],["class","relative opacity-80 w-24 text-base z-10 flex flex-col",4,"ngIf"],[1,"relative","truncate","z-10"],[1,"relative","opacity-80","w-24","text-base","z-10"],[1,"relative","opacity-80","w-24","text-base","z-10","flex","flex-col"],[1,"text-xs"],[1,"list-style-none","p-0","m-0","bg-white","rounded","text-base","shadow","divide-y","divide-gray-100","w-full","border","border-gray-100","max-w-full"],["upcoming","","class","flex items-center w-full p-4",4,"ngFor","ngForOf"],["upcoming","","class","flex items-center w-full p-4",4,"ngIf"],["upcoming","",1,"flex","items-center","w-full","p-4"],[1,"opacity-60","w-24"],[1,"truncate"],[1,"flex","items-center","justify-center","bg-white","rounded","px-4","py-8","shadow-md","w-full","border","border-gray-100"],[1,"opacity-50"]],template:function(t,i){if(1&t&&(e.YNc(0,Fa,12,17,"h2",0),e.ALo(1,"async"),e.YNc(2,Na,13,21,"div",1),e.ALo(3,"async"),e.YNc(4,La,2,0,"h2",0),e.ALo(5,"async"),e.YNc(6,ja,6,10,"ul",2),e.ALo(7,"async"),e.YNc(8,Ja,3,0,"ng-template",null,3,e.W1O)),2&t){const s=e.MAs(9);let a,r;e.Q6J("ngIf",e.lcZ(1,5,i.current)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,7,i.current))("ngIfElse",s),e.xp6(2),e.Q6J("ngIf",null==(a=e.lcZ(5,9,i.upcoming))?null:a.length),e.xp6(2),e.Q6J("ngIf",null==(r=e.lcZ(7,11,i.upcoming))?null:r.length)}},directives:[g.O5,g.sg],pipes:[g.Ov,g.uU,g.OU],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;color:#000}[current][_ngcontent-%COMP%]{transition:color .2s}[current][_ngcontent-%COMP%]   [color][_ngcontent-%COMP%]{transition:opacity .2s}"]}),n})(),Ba=(()=>{class n{constructor(t){this._state=t,this.settings=this._state.settings}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X))},n.\u0275cmp=e.Xpm({type:n,selectors:[["panel-status"]],decls:5,vars:16,consts:[["status","",1,"h-12","w-[calc(100%","-","2rem)]","m-2","rounded","shadow"]],template:function(t,i){if(1&t&&(e._UZ(0,"div",0),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async")),2&t){let s,a,r,c;e.ekj("bg-gray-300","not-bookable"===(null==(s=e.lcZ(1,8,i.settings))?null:s.status))("bg-pending","pending"===(null==(a=e.lcZ(2,10,i.settings))?null:a.status))("bg-success","free"===(null==(r=e.lcZ(3,12,i.settings))?null:r.status))("bg-error","busy"===(null==(c=e.lcZ(4,14,i.settings))?null:c.status))}},pipes:[g.Ov],styles:[""]}),n})(),On=(()=>{class n{constructor(t){this._settings=t}get logo(){return this._settings.get("app.logo_dark")||{}}get time(){return 1e3*(0,D.Z)(new Date)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ae))},n.\u0275cmp=e.Xpm({type:n,selectors:[["panel-topbar"]],decls:11,vars:9,consts:[[1,"w-full","flex","items-center","justify-between","h-16","border-b","border-gray-200","bg-secondary","text-white"],["alt","Logo",1,"h-12","mx-2",3,"src"],["time","",1,"flex","items-center","space-x-2","mx-4","text-xl"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"img",1),e.TgZ(2,"div",2),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"span"),e._uU(7," \u2022 "),e.qZA(),e.TgZ(8,"span"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("src",i.logo.src,e.LSH),e.xp6(3),e.Oqu(e.xi3(5,3,i.time,"shortTime")),e.xp6(5),e.Oqu(e.xi3(10,6,i.time,"mediumDate")))},pipes:[g.uU],styles:[""]}),n})();function Ya(n,o){1&n&&e._UZ(0,"panel-topbar")}let Et=(()=>{class n extends O{constructor(t,i){super(),this._state=t,this._route=i,this.system_id=localStorage.getItem("PLACEOS.BOOKINGS.system"),this.topbar=!0}ngOnInit(){this._state.system=this.system_id||"",this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("system_id")&&(this._state.system=t.get("system_id"))}))}ngOnChanges(t){t.system_id&&(this._state.system=this.system_id)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X),e.Y36(J.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-booking-panel"]],inputs:{system_id:"system_id",topbar:"topbar"},features:[e._Bn([X]),e.qOj,e.TTD],decls:6,vars:13,consts:[[1,"flex","flex-col","absolute","inset-0","bg-gray-50"],[4,"ngIf"],["content","",1,"flex","flex-1","items-center","h-1/2","space-x-2"],[1,"flex-1","h-full","max-w-[50%]"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Ya,1,0,"panel-topbar",1),e.TgZ(2,"div",2),e._UZ(3,"panel-details",3),e._UZ(4,"panel-booking-list",3),e.qZA(),e._UZ(5,"panel-status"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.topbar),e.xp6(1),e.ekj("p-8",i.topbar)("p-4",!i.topbar),e.xp6(1),e.ekj("p-4",i.topbar)("p-2",!i.topbar),e.xp6(1),e.ekj("p-4",i.topbar)("p-2",!i.topbar))},directives:[g.O5,Oa,Da,Ba,On],styles:[""]}),n})();function Va(n,o){if(1&n&&e._UZ(0,"app-booking-panel",8),2&n){const t=e.oxw().$implicit;e.Q6J("system_id",t)("topbar",!1)}}function Qa(n,o){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,Va,1,2,"app-booking-panel",7),e.qZA()),2&n){const t=o.$implicit,i=e.oxw(2);e.Udp("height",i.systems.length>=2?"50%":"100%"),e.xp6(1),e.Q6J("ngIf",t)}}function za(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Qa,2,3,"div",5),e.ALo(2,"slice"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,1,t.systems,0,4))}}function Ra(n,o){1&n&&(e.TgZ(0,"div",9),e.TgZ(1,"p"),e._uU(2,"No systems are set for displaying on the panel array"),e.qZA(),e.qZA())}let Ha=(()=>{class n extends O{constructor(t){super(),this.route=t}ngOnInit(){return(0,A.mG)(this,void 0,void 0,function*(){this.subscription("route.query",this.route.queryParamMap.subscribe(t=>{t.has("system_ids")&&(this.systems=(t.get("system_ids")||"").split(",").filter(i=>!!i))}))})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(J.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-booking-panel-array"]],features:[e.qOj],decls:6,vars:2,consts:[[1,"absolute","inset-0","flex","flex-col"],[1,"w-full"],[1,"flex","items-center","justify-center","flex-wrap","w-full","flex-1","h-1/2"],[4,"ngIf","ngIfElse"],["none",""],["panel","","class","relative flex-1 border border-grey-300 overflow-hidden",3,"height",4,"ngFor","ngForOf"],["panel","",1,"relative","flex-1","border","border-grey-300","overflow-hidden"],["classs","transform scale-75",3,"system_id","topbar",4,"ngIf"],["classs","transform scale-75",3,"system_id","topbar"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"panel-topbar",1),e.TgZ(2,"div",2),e.YNc(3,za,3,5,"ng-container",3),e.qZA(),e.qZA(),e.YNc(4,Ra,3,0,"ng-template",null,4,e.W1O)),2&t){const s=e.MAs(5);e.xp6(3),e.Q6J("ngIf",(null==i.systems?null:i.systems.length)>0)("ngIfElse",s)}},directives:[On,g.O5,g.sg,Et],pipes:[g.OU],styles:["[panel][_ngcontent-%COMP%]{min-width:40%}.container[_ngcontent-%COMP%]{background-color:var(--bg-dark);background-image:url(\"data:image/svg+xml,%3Csvg width='24' height='20' viewBox='0 0 24 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 18c0-1.105.887-2 1.998-2 1.104 0 2-.895 2.002-1.994V14v6h-4v-2zM0 13.998C0 12.895.888 12 2 12c1.105 0 2 .888 2 2 0 1.105.888 2 2 2 1.105 0 2 .888 2 2v2H0v-6.002zm16 4.004A1.994 1.994 0 0 1 14 20c-1.105 0-2-.887-2-1.998v-4.004A1.994 1.994 0 0 0 10 12c-1.105 0-2-.888-2-2 0-1.105-.888-2-2-2-1.105 0-2-.887-2-1.998V1.998A1.994 1.994 0 0 0 2 0a2 2 0 0 0-2 2V0h8v2c0 1.105.888 2 2 2 1.105 0 2 .888 2 2 0 1.105.888 2 2 2 1.105 0 2-.888 2-2 0-1.105.888-2 2-2 1.105 0 2-.888 2-2V0h4v6.002A1.994 1.994 0 0 1 22 8c-1.105 0-2 .888-2 2 0 1.105-.888 2-2 2-1.105 0-2 .887-2 1.998v4.004z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E\");color:var(--font-light)}img[_ngcontent-%COMP%]{max-width:12em}"]}),n})();function Ga(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",12),e.TgZ(1,"i",13),e.NdJ("modelChange",function(s){e.CHM(t);const a=e.oxw().$implicit;return e.oxw(2).system_name[a]=s}),e.qZA(),e.TgZ(2,"i",14),e.NdJ("modelChange",function(s){e.CHM(t);const a=e.oxw().$implicit;return e.oxw(2).system_icon[a]=s}),e.qZA(),e.TgZ(3,"i",15),e.NdJ("modelChange",function(s){e.CHM(t);const a=e.oxw().$implicit;return e.oxw(2).system_status[a]=s}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("sys",t)("model",i.system_name[t]),e.xp6(1),e.Q6J("sys",t)("model",i.system_icon[t]),e.xp6(1),e.Q6J("sys",t)}}function Xa(n,o){if(1&n&&e._UZ(0,"img",16),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("src",i.system_icon[t],e.LSH)}}function Ka(n,o){1&n&&e._UZ(0,"mat-spinner",17),2&n&&e.Q6J("diameter",32)}function Wa(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).showPanel(a)}),e.YNc(1,Ga,4,5,"div",7),e.TgZ(2,"div",8),e.YNc(3,Xa,1,1,"img",9),e.YNc(4,Ka,1,1,"mat-spinner",10),e.qZA(),e.TgZ(5,"div",11),e._uU(6),e.qZA(),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t),e.xp6(1),e.Tol("h-36 w-36 flex items-center justify-center text-6xl bg-white bg-opacity-10 rounded"+(i.system_status[t]?" "+i.system_status[t]:"")),e.xp6(1),e.Q6J("ngIf",i.system_name[t]),e.xp6(1),e.Q6J("ngIf",!i.system_name[t]),e.xp6(2),e.hij(" ",i.system_name[t]||t+" connecting..."," ")}}function er(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Wa,7,6,"button",5),e.ALo(2,"slice"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,1,t.systems,0,8))}}function tr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",18),e._UZ(1,"app-booking-panel",19),e.TgZ(2,"div",20),e.TgZ(3,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()})("contextmenu",function(s){return s.preventDefault()}),e.TgZ(4,"app-icon"),e._uU(5,"close"),e.qZA(),e.qZA(),e.TgZ(6,"button",22),e.NdJ("contextmenu",function(s){return s.preventDefault()}),e._uU(7),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("system_id",t.active_system),e.xp6(6),e.hij(" ",t.countdown," ")}}function nr(n,o){1&n&&(e.TgZ(0,"div",23),e.TgZ(1,"p"),e._uU(2," No systems are set for displaying on the panel select list "),e.qZA(),e.qZA())}let ir=(()=>{class n extends O{constructor(t){super(),this.route=t,this.system_name={},this.system_icon={},this.system_status={}}ngOnInit(){this.subscription("route.query",this.route.queryParamMap.subscribe(t=>{t.has("system_ids")&&(this.systems=(t.get("system_ids")||"").split(","))}))}showPanel(t){this.active_system=t,this.reset()}updateStatus(t,i){const s=function(n,o=(new Date).valueOf()){return n.find(t=>Te(o,o,t.date,t.date+1e3*t.duration))}((i||[]).map(a=>new B(a)));this.system_status[t]=s?"unavailable":"available"}close(){this.active_system=null,this.clearInterval("countdown")}reset(){this.active_system&&(this.countdown=30,this.interval("countdown",()=>this.tick(),1e3))}tick(){this.countdown<=0&&this.close(),this.countdown--}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(J.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-booking-panel-select"]],features:[e.qOj],decls:6,vars:3,consts:[[1,"absolute","inset-0","flex","items-center","justify-center","flex-wrap","bg-gray-600",3,"mousedown","touchstart"],[1,"flex","items-center","justify-center","flex-wrap","w-full","h-full","p-8"],[4,"ngIf","ngIfElse"],["class","absolute inset-0 border border-white",4,"ngIf"],["none",""],["matRipple","","class","item text-white flex flex-col items-center justify-center rounded m-2 p-2",3,"click",4,"ngFor","ngForOf"],["matRipple","",1,"item","text-white","flex","flex-col","items-center","justify-center","rounded","m-2","p-2",3,"click"],["class","bindings",4,"ngIf"],["state",""],[3,"src",4,"ngIf"],[3,"diameter",4,"ngIf"],[1,"truncate","text-sm","p-3","text-white","w-full","text"],[1,"bindings"],["binding","","mod","Bookings","bind","room_name",3,"sys","model","modelChange"],["binding","","mod","Bookings","bind","icon",3,"sys","model","modelChange"],["binding","","mod","Bookings","bind","status",3,"sys","modelChange"],[3,"src"],[3,"diameter"],[1,"absolute","inset-0","border","border-white"],[3,"system_id"],[1,"absolute","top-0","left-1/2","transform","-translate-x-1/2","flex","items-center","bg-white","rounded-b","p-2"],["mat-icon-button","",1,"action","close",3,"click","contextmenu"],["widget","",1,"action","countdown","w-12","h-10",3,"contextmenu"],[1,"absolute","inset-0","flex","items-center","justify-center"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.NdJ("mousedown",function(){return i.reset()},!1,e.Jf7)("touchstart",function(){return i.reset()},!1,e.Jf7),e.TgZ(1,"div",1),e.YNc(2,er,3,5,"ng-container",2),e.qZA(),e.YNc(3,tr,8,2,"div",3),e.YNc(4,nr,3,0,"ng-template",null,4,e.W1O),e.qZA()),2&t){const s=e.MAs(5);e.xp6(2),e.Q6J("ngIf",i.systems&&i.systems.length>0)("ngIfElse",s),e.xp6(1),e.Q6J("ngIf",i.active_system)}},directives:[g.O5,g.sg,Q.wG,en,V.$g,Et,L.lW,N],pipes:[g.OU],styles:[".item[_ngcontent-%COMP%]{height:11.5em;width:10em;background-color:var(--bg-dark);box-shadow:0 1px 3px 0 rgba(#000,.2),0 1px 1px 0 rgba(#000,.14),0 2px 1px -1px rgba(#000,.12)}.free[_ngcontent-%COMP%]{background-color:rgba(var(--success),.6)}.busy[_ngcontent-%COMP%]{background-color:rgba(var(--error),.6)}img[_ngcontent-%COMP%]{max-width:1em;max-height:1em}"]}),n})();function I(n){var o=this;n="object"==typeof n?n:{},o.revision=3,o.imageTypes={bmp:"image/bmp",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpg",png:"image/png","svg+xml":"image/svg+xml",tiff:"image/tiff",webp:"image/webp","x-icon":"image/x-icon"},o.toTable=n.toTable,o.domElement=o.toTable?document.createElement("div"):document.createElement("canvas"),o.url=n.url||"",o.size=n.size||280,o.qrc=!1,o.colorLight=n.colorLight||"#fff",o.colorDark=n.colorDark||"#000",o.ecclevel=n.ecclevel||1,o.noBorder=n.noBorder,o.borderSize=n.borderSize||4;var t,i,s,a,r,c,h,d=[],k=[],x=[],Re=[],U=[],$=[],M=function(C,l){var u;C>l&&(u=C,C=l,l=u),u=l,u*=l,u+=l,u>>=1,Re[u+=C]=1},xe=function(C,l){var u;for(x[C+s*l]=1,u=-2;u<2;u++)x[C+u+s*(l-2)]=1,x[C-2+s*(l+u+1)]=1,x[C+2+s*(l+u)]=1,x[C+u+1+s*(l+2)]=1;for(u=0;u<2;u++)M(C-1,l+u),M(C+1,l-u),M(C-u,l-1),M(C+u,l+1)},ae=function(C){for(;C>=255;)C=((C-=255)>>8)+(255&C);return C},Pe=function(C,l,u,p){var f,w,y,T=I.gexp,we=I.glog;for(f=0;f<p;f++)d[u+f]=0;for(f=0;f<l;f++){if(255!=(y=we[d[C+f]^d[u]]))for(w=1;w<p;w++)d[u+w-1]=d[u+w]^T[ae(y+$[p-w])];else for(w=u;w<u+p;w++)d[w]=d[w+1];d[u+p-1]=255==y?0:T[ae(y+$[0])]}},K=function(C,l){var u;return C>l&&(u=C,C=l,l=u),u=l,u+=l*l,u>>=1,Re[u+=C]},ut=function(C){var l,u,p,f;switch(C){case 0:for(u=0;u<s;u++)for(l=0;l<s;l++)l+u&1||K(l,u)||(x[l+u*s]^=1);break;case 1:for(u=0;u<s;u++)for(l=0;l<s;l++)1&u||K(l,u)||(x[l+u*s]^=1);break;case 2:for(u=0;u<s;u++)for(p=0,l=0;l<s;l++,p++)3==p&&(p=0),p||K(l,u)||(x[l+u*s]^=1);break;case 3:for(f=0,u=0;u<s;u++,f++)for(3==f&&(f=0),p=f,l=0;l<s;l++,p++)3==p&&(p=0),p||K(l,u)||(x[l+u*s]^=1);break;case 4:for(u=0;u<s;u++)for(p=0,f=u>>1&1,l=0;l<s;l++,p++)3==p&&(p=0,f=!f),f||K(l,u)||(x[l+u*s]^=1);break;case 5:for(f=0,u=0;u<s;u++,f++)for(3==f&&(f=0),p=0,l=0;l<s;l++,p++)3==p&&(p=0),(l&u&1)+!(!p|!f)||K(l,u)||(x[l+u*s]^=1);break;case 6:for(f=0,u=0;u<s;u++,f++)for(3==f&&(f=0),p=0,l=0;l<s;l++,p++)3==p&&(p=0),(l&u&1)+(p&&p==f)&1||K(l,u)||(x[l+u*s]^=1);break;case 7:for(f=0,u=0;u<s;u++,f++)for(3==f&&(f=0),p=0,l=0;l<s;l++,p++)3==p&&(p=0),(p&&p==f)+(l+u&1)&1||K(l,u)||(x[l+u*s]^=1)}},R=function(C){var l,u=0;for(l=0;l<=C;l++)U[l]>=5&&(u+=I.N1+U[l]-5);for(l=3;l<C-1;l+=2)U[l-2]==U[l+2]&&U[l+2]==U[l-1]&&U[l-1]==U[l+1]&&3*U[l-1]==U[l]&&(0==U[l-3]||l+3>C||3*U[l-3]>=4*U[l]||3*U[l+3]>=4*U[l])&&(u+=I.N3);return u},He=function(){var C,l,u,p,f,w=0,y=0;for(l=0;l<s-1;l++)for(C=0;C<s-1;C++)(x[C+s*l]&&x[C+1+s*l]&&x[C+s*(l+1)]&&x[C+1+s*(l+1)]||!(x[C+s*l]||x[C+1+s*l]||x[C+s*(l+1)]||x[C+1+s*(l+1)]))&&(w+=I.N2);for(l=0;l<s;l++){for(U[0]=0,u=p=C=0;C<s;C++)(f=x[C+s*l])==p?U[u]++:U[++u]=1,y+=(p=f)?1:-1;w+=R(u)}y<0&&(y=-y);var T=y,we=0;for(T+=T<<2,T<<=1;T>s*s;)T-=s*s,we++;for(w+=we*I.N4,C=0;C<s;C++){for(U[0]=0,u=p=l=0;l<s;l++)(f=x[C+s*l])==p?U[u]++:U[++u]=1,p=f;w+=R(u)}return w};o.genframe=function(C){var l,u,p,f,w,y,T,we,pt=I.eccblocks,Hn=I.gexp,Jt=I.glog;f=C.length,i=0;do{if(i++,p=4*(t-1)+16*(i-1),a=pt[p++],r=pt[p++],c=pt[p++],h=pt[p],f<=(p=c*(a+r)+r-3+(i<=9)))break}while(i<40);for(s=17+4*i,w=c+(c+h)*(a+r)+r,f=0;f<w;f++)k[f]=0;for(d=C.slice(0),f=0;f<s*s;f++)x[f]=0;for(f=0;f<(s*(s+1)+1)/2;f++)Re[f]=0;for(f=0;f<3;f++){for(p=0,u=0,1==f&&(p=s-7),2==f&&(u=s-7),x[u+3+s*(p+3)]=1,l=0;l<6;l++)x[u+l+s*p]=1,x[u+s*(p+l+1)]=1,x[u+6+s*(p+l)]=1,x[u+l+1+s*(p+6)]=1;for(l=1;l<5;l++)M(u+l,p+1),M(u+1,p+l+1),M(u+5,p+l),M(u+l+1,p+5);for(l=2;l<4;l++)x[u+l+s*(p+2)]=1,x[u+2+s*(p+l+1)]=1,x[u+4+s*(p+l)]=1,x[u+l+1+s*(p+4)]=1}if(i>1)for(f=I.adelta[i],u=s-7;;){for(l=s-7;l>f-3&&(xe(l,u),!(l<f));)l-=f;if(u<=f+9)break;xe(6,u-=f),xe(u,6)}for(x[8+s*(s-8)]=1,u=0;u<7;u++)M(7,u),M(s-8,u),M(7,u+s-7);for(l=0;l<8;l++)M(l,7),M(l+s-8,7),M(l,s-8);for(l=0;l<9;l++)M(l,8);for(l=0;l<8;l++)M(l+s-8,8),M(8,l);for(u=0;u<7;u++)M(8,u+s-7);for(l=0;l<s-14;l++)1&l?(M(8+l,6),M(6,8+l)):(x[8+l+6*s]=1,x[6+s*(8+l)]=1);if(i>6)for(f=I.vpat[i-7],p=17,l=0;l<6;l++)for(u=0;u<3;u++,p--)1&(p>11?i>>p-12:f>>p)?(x[5-l+s*(2-u+s-11)]=1,x[2-u+s-11+s*(5-l)]=1):(M(5-l,2-u+s-11),M(2-u+s-11,5-l));for(u=0;u<s;u++)for(l=0;l<=u;l++)x[l+s*u]&&M(l,u);for(w=d.length,y=0;y<w;y++)k[y]=d.charCodeAt(y);if(d=k.slice(0),w>=(l=c*(a+r)+r)-2&&(w=l-2,i>9&&w--),y=w,i>9){for(d[y+2]=0,d[y+3]=0;y--;)d[y+3]|=255&(f=d[y])<<4,d[y+2]=f>>4;d[2]|=255&w<<4,d[1]=w>>4,d[0]=64|w>>12}else{for(d[y+1]=0,d[y+2]=0;y--;)d[y+2]|=255&(f=d[y])<<4,d[y+1]=f>>4;d[1]|=255&w<<4,d[0]=64|w>>4}for(y=w+3-(i<10);y<l;)d[y++]=236,d[y++]=17;for($[0]=1,y=0;y<h;y++){for($[y+1]=1,T=y;T>0;T--)$[T]=$[T]?$[T-1]^Hn[ae(Jt[$[T]]+y)]:$[T-1];$[0]=Hn[ae(Jt[$[0]]+y)]}for(y=0;y<=h;y++)$[y]=Jt[$[y]];for(p=l,u=0,y=0;y<a;y++)Pe(u,c,p,h),u+=c,p+=h;for(y=0;y<r;y++)Pe(u,c+1,p,h),u+=c+1,p+=h;for(u=0,y=0;y<c;y++){for(T=0;T<a;T++)k[u++]=d[y+T*c];for(T=0;T<r;T++)k[u++]=d[a*c+y+T*(c+1)]}for(T=0;T<r;T++)k[u++]=d[a*c+y+T*(c+1)];for(y=0;y<h;y++)for(T=0;T<a+r;T++)k[u++]=d[l+y+T*h];for(d=k,l=u=s-1,p=w=1,we=(c+h)*(a+r)+r,y=0;y<we;y++)for(f=d[y],T=0;T<8;T++,f<<=1){128&f&&(x[l+s*u]=1);do{w?l--:(l++,p?0!=u?u--:(p=!p,6==(l-=2)&&(l--,u=9)):u!=s-1?u++:(p=!p,6==(l-=2)&&(l--,u-=8))),w=!w}while(K(l,u))}for(d=x.slice(0),f=0,u=3e4,p=0;p<8&&(ut(p),(l=He())<u&&(u=l,f=p),7!=f);p++)x=d.slice(0);for(f!=p&&ut(f),u=I.fmtword[f+(t-1<<3)],p=0;p<8;p++,u>>=1)1&u&&(x[s-1-p+8*s]=1,p<6?x[8+s*p]=1:x[8+s*(p+1)]=1);for(p=0;p<7;p++,u>>=1)1&u&&(x[8+s*(s-7+p)]=1,p?x[6-p+8*s]=1:x[7+8*s]=1);return x},o.init=function(){t=o.ecclevel;var C=o.genframe(o.url);o.toTable?o.tableWrite(C,s):o.canvasWrite(C,s)},o.init()}function sr(n,o){if(1&n&&(e.TgZ(0,"div",6),e._UZ(1,"img",7),e.TgZ(2,"div",8),e._uU(3," Scan QR code to book this room or view details "),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("src",t.qr_code,e.LSH)}}I.prototype={canvasWrite:function(n,o){if(!this.qrc&&(this.qrc=this.getContext(this.domElement),!this.qrc))return this.toTable=!0,this.domElement=document.createElement("div"),void this.tableWrite(n,o);var t=this.size,i=this.qrc;i.lineWidth=1;var s=t;s/=o+10,s=Math.round(s-.5);var a=4;this.noBorder?(i.canvas.width=i.canvas.height=s*o,a=0):i.canvas.width=i.canvas.height=t,i.clearRect(0,0,t,t),i.fillStyle=this.colorLight,i.fillRect(0,0,s*(o+8),s*(o+8)),i.fillStyle=this.colorDark;for(var r=0;r<o;r++)for(var c=0;c<o;c++)n[c*o+r]&&i.fillRect(s*(a+r),s*(a+c),s,s)},tableWrite:function(n,o){var t=this,i=Math.round(this.size/o-3.5)+"px",s=o+(t.noBorder?0:2*t.borderSize),a=t.borderSize,r="width:"+i+";height:"+i+";",c=t.colorLight,h=t.colorDark,d=document.createElement("table");d.style.cssText="border:0;border-collapse:collapse;";for(var k,x=document.createElement("tr"),Re=document.createElement("td"),U=function(){return Re.cloneNode()},$=function(){var R=U();return R.style.cssText=r+"background:"+c,R},M=function(R){for(var He=R.firstChild,C=0;C<a;C++)R.insertBefore($(),He),R.appendChild($())},xe=0;xe<o;xe++){var ae=x.cloneNode();d.appendChild(ae);for(var Pe=0;Pe<o;Pe++)if(1===n[xe*o+Pe]){var K=(k=void 0,(k=U()).style.cssText=r+"background:"+h,k);ae.appendChild(K)}else{var ut=$();ae.appendChild(ut)}t.noBorder||M(ae)}t.noBorder||function(R){for(var He=R.firstChild,C=0;C<t.borderSize;C++){for(var l=x.cloneNode(),u=0;u<s;u++){var p=$();l.appendChild(p)}R.appendChild(l),R.insertBefore(l.cloneNode(!0),He)}}(d),t.domElement.innerHTML="",t.domElement.appendChild(d)},getContext:function(n){return n.getContext&&n.getContext("2d")?n.getContext("2d"):(console.log("Browser does not have 2d Canvas support"),!1)},toImage:function(n){if(this.qrc){var o=this.imageTypes[n];if(!o)throw new Error(n+" is not a valid image type ");var t=new Image;return t.src=this.domElement.toDataURL(o),t}}},I.adelta=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],I.vpat=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],I.fmtword=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],I.eccblocks=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],I.glog=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],I.gexp=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],I.N1=3,I.N2=3,I.N3=40,I.N4=10;let Sn=(()=>{class n{constructor(t){this._state=t,this.system=this._state.space}get time(){return(0,rt.Z)(Date.now())}get room_image(){return this._state.setting("image")}get checkin(){return!1!==this._state.setting("show_qr_code")}ngOnInit(){const t=`${location.origin}${location.pathname}#/checkin/${this._state.system}`;this.qr_code=function(n,o="#fff0",t="#000"){var i;const s=new I({url:n||"Hello",size:360,colorLight:o,colorDark:t,toTable:!1,ecclevel:1,noBorder:!0,borderSize:0});return null===(i=null==s?void 0:s.toImage("svg+xml"))||void 0===i?void 0:i.src}(t,"#fff0","#fff")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X))},n.\u0275cmp=e.Xpm({type:n,selectors:[["panel-view-details"]],decls:11,vars:12,consts:[[1,"h-full","w-full","bg-black","relative","text-white"],[1,"bg-cover","bg-center","absolute","inset-0"],[1,"absolute","inset-0","bg-black/60"],["name","",1,"absolute","top-4","left-4","text-3xl","font-medium"],["qr-checkin","","class","absolute top-4 right-4 text-xl w-40 space-y-4",4,"ngIf"],[1,"absolute","top-2/3","left-1/2","-translate-x-1/2","text-3xl","font-light"],["qr-checkin","",1,"absolute","top-4","right-4","text-xl","w-40","space-y-4"],[1,"w-full",3,"src"],[1,"w-full","text-lg"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e._UZ(2,"div",2),e.TgZ(3,"div",3),e._uU(4),e.ALo(5,"async"),e.ALo(6,"async"),e.qZA(),e.YNc(7,sr,4,1,"div",4),e.TgZ(8,"div",5),e._uU(9),e.ALo(10,"date"),e.qZA(),e.qZA()),2&t){let s;e.xp6(1),e.Udp("background-image","url("+i.room_image+")"),e.xp6(3),e.hij(" ",(null==(s=e.lcZ(5,5,i.system))?null:s.display_name)||(null==(s=e.lcZ(6,7,i.system))?null:s.name)||"<Unknown Space>"," "),e.xp6(3),e.Q6J("ngIf",i.checkin),e.xp6(2),e.hij(" ",e.xi3(10,9,i.time,"EEE, MMM d, y h:mm a")," ")}},directives:[g.O5],pipes:[g.Ov,g.uU],styles:["[_nghost-%COMP%]{display:block}"]}),n})();var ar=m(2702);function Mn(n){const o=(0,de.Z)(null==n?void 0:n.date,Date.now());return n&&o<1440?`${(0,j.Z)(n.date,"h:mm a")} - ${(0,j.Z)((0,z.Z)(n.date,n.duration),"h:mm a")}`:""}function In(n,o){const t=(0,de.Z)(null==o?void 0:o.date,Date.now());if(!n)return o&&t<1440?`Free for ${(0,Ce.Z)({hours:Math.floor(t/60),minutes:t%60})||"less than 1 minute"}`:"";const s=(0,de.Z)(1e3*n.event_end,Date.now()),a=(0,Ce.Z)({hours:Math.floor(s/60),minutes:s%60});return`Free in ${s<1?"less than 1 minute":a}`}function rr(n,o){1&n&&(e.TgZ(0,"div",9),e.TgZ(1,"p",10),e._uU(2,"Touch or scan to check-in"),e.qZA(),e.TgZ(3,"app-icon"),e._uU(4,"arrow_forward"),e.qZA(),e.qZA())}let Un=(()=>{class n{constructor(t){this._state=t,this.state=this._state.status,this.current=this._state.current,this.next=this._state.next,this.event_state=(0,oe.aj)([this.current,this.next,(0,ar.H)(5e3)]).pipe((0,Z.U)(([i,s])=>({current:In(i,s),next:Mn(s)}))),this.free_svg='\n    <svg width="129" height="117" viewBox="0 0 129 117" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0)">\n    <path d="M32.9422 90.8456H10.1503L6.37414 54.8238C6.34123 54.4031 6.22286 53.9934 6.02626 53.62C5.82966 53.2465 5.55897 52.9171 5.23075 52.6519C4.90253 52.3867 4.52368 52.1913 4.11737 52.0776C3.71106 51.9639 3.28583 51.9343 2.8677 51.9907C2.44708 52.0236 2.03759 52.142 1.66428 52.3387C1.29098 52.5353 0.961708 52.8061 0.696607 53.1345C0.431506 53.4628 0.236151 53.8418 0.12249 54.2483C0.00882954 54.6547 -0.0207468 55.0801 0.0355704 55.4984L4.21633 94.3534C4.312 95.1416 4.69529 95.8668 5.29265 96.3896C5.89001 96.9125 6.65936 97.1963 7.45305 97.1865H17.4329V109.059L10.0155 111.892C9.68401 112.004 9.37812 112.181 9.1155 112.412C8.85287 112.644 8.63873 112.925 8.48549 113.239C8.33225 113.554 8.24295 113.896 8.22276 114.246C8.20257 114.595 8.2519 114.945 8.36788 115.275C8.48387 115.605 8.6642 115.909 8.89844 116.169C9.13268 116.429 9.41617 116.64 9.73249 116.79C10.0488 116.94 10.3916 117.025 10.7412 117.041C11.0907 117.057 11.4399 117.004 11.7687 116.884L19.8605 113.916L27.9523 116.884H28.8963C29.4326 116.879 29.9541 116.707 30.3889 116.393C30.8236 116.079 31.1503 115.638 31.3238 115.13C31.5533 114.468 31.512 113.742 31.2089 113.11C30.9058 112.478 30.3654 111.992 29.7055 111.757L22.4229 109.194V97.3214H32.9422C33.7971 97.3099 34.6137 96.9651 35.2182 96.3603C35.8227 95.7556 36.1674 94.9387 36.1789 94.0835C36.1845 93.6568 36.1047 93.2332 35.944 92.8378C35.7833 92.4424 35.5451 92.0833 35.2434 91.7815C34.9417 91.4797 34.5827 91.2414 34.1875 91.0806C33.7922 90.9199 33.3688 90.84 32.9422 90.8456Z" fill="currentColor"/>\n    <path d="M125.189 51.9907C124.348 51.9019 123.507 52.1503 122.85 52.6816C122.192 53.2128 121.772 53.9833 121.682 54.8239L117.906 90.7107H94.9794C94.121 90.7107 93.2977 91.0519 92.6907 91.6591C92.0837 92.2663 91.7427 93.0899 91.7427 93.9487C91.7427 94.8074 92.0837 95.631 92.6907 96.2382C93.2977 96.8454 94.121 97.1866 94.9794 97.1866H105.499V109.059L98.2161 111.622C97.5749 111.882 97.0536 112.371 96.7542 112.995C96.4549 113.619 96.3991 114.332 96.5978 114.995C96.7713 115.503 97.098 115.944 97.5327 116.258C97.9675 116.572 98.489 116.744 99.0253 116.749C99.302 116.77 99.5797 116.724 99.8345 116.614L107.926 113.646L116.018 116.614C116.347 116.734 116.696 116.787 117.046 116.771C117.395 116.755 117.738 116.67 118.054 116.52C118.371 116.37 118.654 116.16 118.888 115.9C119.123 115.64 119.303 115.336 119.419 115.005C119.535 114.675 119.584 114.325 119.564 113.976C119.544 113.626 119.455 113.284 119.301 112.97C119.148 112.655 118.934 112.374 118.671 112.143C118.409 111.911 118.103 111.734 117.771 111.622L110.489 109.059V97.1866H120.603C121.397 97.1963 122.166 96.9126 122.764 96.3897C123.361 95.8668 123.744 95.1416 123.84 94.3534L128.021 55.4984C128.11 54.6577 127.861 53.8161 127.33 53.1584C126.799 52.5007 126.029 52.0807 125.189 51.9907Z" fill="currentColor"/>\n    <path d="M95.5186 74.1164V69.7992C95.5241 69.7091 95.5104 69.619 95.4785 69.5346C95.4465 69.4503 95.3971 69.3737 95.3333 69.3099C95.2696 69.2462 95.193 69.1967 95.1087 69.1647C95.0244 69.1328 94.9342 69.1191 94.8443 69.1246H33.0769C32.9869 69.1191 32.8968 69.1328 32.8124 69.1647C32.7281 69.1967 32.6516 69.2462 32.5878 69.3099C32.5241 69.3737 32.4746 69.4503 32.4426 69.5346C32.4107 69.619 32.397 69.7091 32.4026 69.7992V74.1164C32.397 74.2064 32.4107 74.2966 32.4426 74.3809C32.4746 74.4653 32.5241 74.5419 32.5878 74.6056C32.6516 74.6694 32.7281 74.7189 32.8124 74.7509C32.8968 74.7828 32.9869 74.7965 33.0769 74.791H55.1945V115.67C55.1889 115.76 55.2026 115.85 55.2345 115.934C55.2665 116.018 55.3159 116.095 55.3797 116.159C55.4435 116.223 55.52 116.272 55.6043 116.304C55.6886 116.336 55.7788 116.35 55.8688 116.344H72.0524C72.1423 116.35 72.2325 116.336 72.3168 116.304C72.4011 116.272 72.4777 116.223 72.5414 116.159C72.6052 116.095 72.6547 116.018 72.6866 115.934C72.7185 115.85 72.7322 115.76 72.7267 115.67V74.9259H94.8443C95.0399 74.9054 95.2198 74.8093 95.3458 74.6581C95.4717 74.507 95.5337 74.3126 95.5186 74.1164Z" fill="currentColor"/>\n    </g>\n    <defs>\n    <clipPath id="clip0">\n    <rect width="128.03" height="116.141" fill="currentColor" transform="translate(0.000488281 0.858643)"/>\n    </clipPath>\n    </defs>\n    </svg>\n    ',this.in_use_svg='\n    <svg width="129" height="117" viewBox="0 0 129 117" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0)">\n    <path d="M29.7316 77.5781C29.1922 71.6419 28.6527 64.7613 28.2481 60.8489C28.6527 61.2536 29.1922 61.6583 29.5968 62.0631C32.9684 65.0312 38.9023 65.5708 42.9482 65.5708C44.8363 65.5708 46.3198 65.4359 46.9941 65.4359C48.0088 65.3405 48.9445 64.8473 49.597 64.0641C50.2494 63.2809 50.5656 62.2713 50.4766 61.2557C50.3875 60.2401 49.9004 59.301 49.1216 58.6434C48.3428 57.9858 47.3356 57.6631 46.3198 57.7459C42.6785 58.1506 36.6097 57.7459 34.8564 56.2618C30.5021 52.1921 24.7668 49.926 18.8077 49.9209C12.4691 49.9209 11.2554 52.7541 11.2554 56.1269C11.2554 60.7139 12.7389 80.5462 13.6829 84.8634C14.627 88.641 24.0674 87.9664 28.6527 87.8315C32.711 87.6529 36.7769 87.8789 40.7904 88.506C40.9217 96.0702 40.6516 103.636 39.9812 111.171C39.8928 112.491 40.3224 113.793 41.1786 114.801C42.0349 115.809 43.2504 116.443 44.5666 116.568H44.9712C46.2268 116.57 47.4371 116.099 48.3616 115.249C49.2862 114.399 49.8572 113.233 49.9611 111.981C51.1749 95.9263 51.1749 86.2125 49.8263 83.2444C47.8033 79.0621 42.5437 77.8479 29.7316 77.5781Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M18.6731 47.8973C24.1104 47.8973 28.5182 43.4879 28.5182 38.0486C28.5182 32.6093 24.1104 28.2 18.6731 28.2C13.2359 28.2 8.82812 32.6093 8.82812 38.0486C8.82812 43.4879 13.2359 47.8973 18.6731 47.8973Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M33.9124 90.5297H11.1205L7.34436 54.5079C7.31145 54.0871 7.19307 53.6775 6.99647 53.3041C6.79987 52.9306 6.52919 52.6012 6.20097 52.336C5.87275 52.0708 5.49389 51.8754 5.08758 51.7617C4.68127 51.648 4.25605 51.6184 3.83791 51.6747C3.41729 51.7077 3.0078 51.8261 2.6345 52.0228C2.2612 52.2194 1.93192 52.4902 1.66682 52.8186C1.40172 53.1469 1.20637 53.5259 1.0927 53.9323C0.979044 54.3388 0.949468 54.7642 1.00579 55.1825L5.18655 94.0374C5.28222 94.8257 5.66551 95.5508 6.26287 96.0737C6.86023 96.5966 7.62957 96.8804 8.42327 96.8706H18.4031V108.743L10.9857 111.576C10.6542 111.688 10.3483 111.865 10.0857 112.096C9.82309 112.328 9.60895 112.609 9.45571 112.924C9.30246 113.238 9.21316 113.58 9.19297 113.93C9.17278 114.279 9.22211 114.629 9.3381 114.959C9.45408 115.289 9.63442 115.593 9.86866 115.853C10.1029 116.113 10.3864 116.324 10.7027 116.474C11.019 116.624 11.3619 116.709 11.7114 116.725C12.0609 116.741 12.4102 116.688 12.7389 116.568L20.8307 113.6L28.9225 116.568H29.8665C30.4028 116.563 30.9243 116.391 31.3591 116.077C31.7938 115.763 32.1205 115.322 32.2941 114.814C32.5235 114.152 32.4822 113.426 32.1791 112.794C31.876 112.163 31.3356 111.676 30.6757 111.441L23.3931 108.878V97.0055H33.9124C34.7673 96.994 35.5839 96.6492 36.1884 96.0444C36.7929 95.4397 37.1376 94.6228 37.1491 93.7676C37.1548 93.3408 37.0749 92.9173 36.9142 92.5219C36.7535 92.1265 36.5153 91.7673 36.2136 91.4655C35.912 91.1637 35.5529 90.9254 35.1577 90.7647C34.7624 90.604 34.339 90.5241 33.9124 90.5297Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M89.206 88.5061C93.2205 87.8881 97.2855 87.6622 101.344 87.8315C105.929 87.9664 115.37 88.641 116.314 84.8634C117.392 80.5462 118.741 60.714 118.741 56.1269C118.741 52.7541 117.662 49.9209 111.189 49.9209C105.213 49.8372 99.4458 52.1159 95.14 56.2618C93.3868 57.7459 87.4528 58.0157 83.6766 57.7459C83.1702 57.6982 82.6592 57.7513 82.1733 57.9019C81.6874 58.0526 81.236 58.2978 80.8452 58.6237C80.4544 58.9495 80.1319 59.3494 79.8961 59.8004C79.6604 60.2514 79.5162 60.7445 79.4717 61.2515C79.4273 61.7585 79.4835 62.2692 79.6371 62.7544C79.7907 63.2396 80.0388 63.6895 80.3669 64.0784C80.695 64.4673 81.0968 64.7875 81.5491 65.0205C82.0014 65.2534 82.4953 65.3946 83.0023 65.4359C83.6766 65.4359 85.1601 65.5709 87.0482 65.5709C91.0941 65.5709 97.0281 65.0312 100.4 62.0631C100.879 61.6925 101.33 61.2867 101.748 60.8489C101.344 64.7614 100.804 71.507 100.265 77.5781C87.4528 77.8479 82.1932 79.0622 80.3051 83.2445C78.9564 86.2126 78.8216 95.9263 80.1702 111.981C80.2956 113.224 80.8731 114.378 81.793 115.224C82.7128 116.07 83.911 116.548 85.1601 116.568H85.5647C86.8809 116.443 88.0964 115.809 88.9527 114.801C89.809 113.793 90.2385 112.491 90.1501 111.171C89.3797 103.642 89.0644 96.0733 89.206 88.5061Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M111.216 47.9107C116.653 47.9107 121.061 43.5013 121.061 38.062C121.061 32.6228 116.653 28.2134 111.216 28.2134C105.779 28.2134 101.371 32.6228 101.371 38.062C101.371 43.5013 105.779 47.9107 111.216 47.9107Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M126.159 51.6748C125.319 51.586 124.477 51.8344 123.82 52.3656C123.162 52.8968 122.743 53.6673 122.653 54.5079L118.876 90.3948H95.9496C95.0912 90.3948 94.2679 90.736 93.6609 91.3432C93.0539 91.9504 92.7129 92.774 92.7129 93.6327C92.7129 94.4915 93.0539 95.3151 93.6609 95.9223C94.2679 96.5295 95.0912 96.8706 95.9496 96.8706H106.469V108.743L99.1863 111.306C98.5451 111.566 98.0238 112.056 97.7245 112.679C97.4251 113.303 97.3693 114.016 97.568 114.679C97.7415 115.187 98.0682 115.628 98.503 115.942C98.9377 116.256 99.4592 116.428 99.9955 116.433C100.272 116.454 100.55 116.408 100.805 116.298L108.896 113.33L116.988 116.298C117.317 116.418 117.666 116.471 118.016 116.455C118.365 116.439 118.708 116.354 119.024 116.204C119.341 116.055 119.624 115.844 119.859 115.584C120.093 115.324 120.273 115.02 120.389 114.689C120.505 114.359 120.554 114.009 120.534 113.66C120.514 113.31 120.425 112.968 120.271 112.654C120.118 112.339 119.904 112.058 119.641 111.827C119.379 111.595 119.073 111.419 118.742 111.306L111.459 108.743V96.8706H121.574C122.367 96.8804 123.137 96.5966 123.734 96.0738C124.331 95.5509 124.715 94.8257 124.81 94.0375L128.991 55.1825C129.08 54.3418 128.832 53.5002 128.301 52.8425C127.77 52.1848 126.999 51.7648 126.159 51.6748Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M96.4888 73.8005V69.4833C96.4943 69.3932 96.4806 69.3031 96.4487 69.2187C96.4168 69.1344 96.3673 69.0578 96.3035 68.994C96.2398 68.9302 96.1632 68.8807 96.0789 68.8488C95.9946 68.8168 95.9045 68.8032 95.8145 68.8087H34.0471C33.9571 68.8032 33.867 68.8168 33.7827 68.8488C33.6983 68.8807 33.6218 68.9302 33.558 68.994C33.4943 69.0578 33.4448 69.1344 33.4129 69.2187C33.3809 69.3031 33.3673 69.3932 33.3728 69.4833V73.8005C33.3673 73.8905 33.3809 73.9807 33.4129 74.065C33.4448 74.1494 33.4943 74.2259 33.558 74.2897C33.6218 74.3535 33.6983 74.403 33.7827 74.4349C33.867 74.4669 33.9571 74.4806 34.0471 74.475H56.1647V115.354C56.1592 115.444 56.1728 115.534 56.2048 115.618C56.2367 115.703 56.2862 115.779 56.3499 115.843C56.4137 115.907 56.4902 115.956 56.5745 115.988C56.6589 116.02 56.749 116.034 56.839 116.028H73.0226C73.1126 116.034 73.2027 116.02 73.287 115.988C73.3713 115.956 73.4479 115.907 73.5116 115.843C73.5754 115.779 73.6249 115.703 73.6568 115.618C73.6887 115.534 73.7024 115.444 73.6969 115.354V74.61H95.8145C96.0101 74.5895 96.19 74.4934 96.316 74.3422C96.4419 74.191 96.5039 73.9967 96.4888 73.8005Z" fill="currentColor" fill-opacity="0.61"/>\n    </g>\n    <defs>\n    <clipPath id="clip0">\n    <rect width="128.03" height="116.141" fill="currentColor" transform="translate(0.970703 0.542725)"/>\n    </clipPath>\n    </defs>\n    </svg>\n    ',this.pending_svg='\n    <svg width="129" height="117" viewBox="0 0 129 117" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0)">\n    <path d="M32.9412 90.8456H10.1493L6.37317 54.8238C6.34026 54.4031 6.22188 53.9934 6.02528 53.62C5.82868 53.2465 5.558 52.9171 5.22978 52.6519C4.90156 52.3867 4.5227 52.1913 4.11639 52.0776C3.71008 51.9639 3.28486 51.9343 2.86672 51.9907C2.4461 52.0236 2.03661 52.142 1.66331 52.3387C1.29 52.5353 0.960731 52.8061 0.695631 53.1345C0.43053 53.4628 0.235174 53.8418 0.121514 54.2483C0.00785298 54.6547 -0.0217234 55.0801 0.0345939 55.4984L4.21535 94.3534C4.31102 95.1416 4.69432 95.8668 5.29168 96.3896C5.88904 96.9125 6.65838 97.1963 7.45207 97.1865H17.432V109.059L10.0145 111.892C9.68304 112.004 9.37714 112.181 9.11452 112.412C8.8519 112.644 8.63776 112.925 8.48452 113.239C8.33127 113.554 8.24197 113.896 8.22178 114.246C8.20159 114.595 8.25092 114.945 8.3669 115.275C8.48289 115.605 8.66323 115.909 8.89747 116.169C9.13171 116.429 9.4152 116.64 9.73151 116.79C10.0478 116.94 10.3907 117.025 10.7402 117.041C11.0897 117.057 11.439 117.004 11.7677 116.884L19.8595 113.916L27.9513 116.884H28.8953C29.4316 116.879 29.9531 116.707 30.3879 116.393C30.8227 116.079 31.1493 115.638 31.3229 115.13C31.5523 114.468 31.511 113.742 31.2079 113.11C30.9048 112.478 30.3644 111.992 29.7045 111.757L22.4219 109.194V97.3214H32.9412C33.7961 97.3099 34.6127 96.9651 35.2172 96.3603C35.8217 95.7556 36.1664 94.9387 36.1779 94.0835C36.1836 93.6568 36.1037 93.2332 35.943 92.8378C35.7823 92.4424 35.5441 92.0833 35.2425 91.7815C34.9408 91.4797 34.5817 91.2414 34.1865 91.0806C33.7913 90.9199 33.3678 90.84 32.9412 90.8456Z" fill="currentColor"/>\n    <path d="M125.188 51.9907C124.348 51.9019 123.507 52.1503 122.849 52.6816C122.192 53.2128 121.772 53.9833 121.682 54.8239L117.906 90.7107H94.9789C94.1205 90.7107 93.2972 91.0519 92.6902 91.6591C92.0832 92.2663 91.7422 93.0899 91.7422 93.9487C91.7422 94.8074 92.0832 95.631 92.6902 96.2382C93.2972 96.8454 94.1205 97.1866 94.9789 97.1866H105.498V109.059L98.2156 111.622C97.5744 111.882 97.0531 112.371 96.7538 112.995C96.4544 113.619 96.3986 114.332 96.5973 114.995C96.7708 115.503 97.0975 115.944 97.5323 116.258C97.967 116.572 98.4885 116.744 99.0248 116.749C99.3015 116.77 99.5792 116.724 99.834 116.614L107.926 113.646L116.018 116.614C116.346 116.734 116.696 116.787 117.045 116.771C117.395 116.755 117.737 116.67 118.054 116.52C118.37 116.37 118.654 116.16 118.888 115.9C119.122 115.64 119.302 115.336 119.418 115.005C119.534 114.675 119.584 114.325 119.564 113.976C119.543 113.626 119.454 113.284 119.301 112.97C119.148 112.655 118.933 112.374 118.671 112.143C118.408 111.911 118.102 111.734 117.771 111.622L110.488 109.059V97.1866H120.603C121.397 97.1963 122.166 96.9126 122.763 96.3897C123.361 95.8668 123.744 95.1416 123.84 94.3534L128.02 55.4984C128.109 54.6577 127.861 53.8161 127.33 53.1584C126.799 52.5007 126.029 52.0807 125.188 51.9907Z" fill="currentColor"/>\n    <path d="M95.5186 74.1164V69.7992C95.5241 69.7091 95.5104 69.619 95.4785 69.5346C95.4465 69.4503 95.3971 69.3737 95.3333 69.3099C95.2696 69.2462 95.193 69.1967 95.1087 69.1647C95.0244 69.1328 94.9342 69.1191 94.8443 69.1246H33.0769C32.9869 69.1191 32.8968 69.1328 32.8124 69.1647C32.7281 69.1967 32.6516 69.2462 32.5878 69.3099C32.5241 69.3737 32.4746 69.4503 32.4426 69.5346C32.4107 69.619 32.397 69.7091 32.4026 69.7992V74.1164C32.397 74.2064 32.4107 74.2966 32.4426 74.3809C32.4746 74.4653 32.5241 74.5419 32.5878 74.6056C32.6516 74.6694 32.7281 74.7189 32.8124 74.7509C32.8968 74.7828 32.9869 74.7965 33.0769 74.791H55.1945V115.67C55.1889 115.76 55.2026 115.85 55.2345 115.934C55.2665 116.018 55.3159 116.095 55.3797 116.159C55.4435 116.223 55.52 116.272 55.6043 116.304C55.6886 116.336 55.7788 116.35 55.8688 116.344H72.0524C72.1423 116.35 72.2325 116.336 72.3168 116.304C72.4011 116.272 72.4777 116.223 72.5414 116.159C72.6052 116.095 72.6547 116.018 72.6866 115.934C72.7185 115.85 72.7322 115.76 72.7267 115.67V74.9259H94.8443C95.0399 74.9054 95.2198 74.8093 95.3458 74.6581C95.4717 74.507 95.5337 74.3126 95.5186 74.1164Z" fill="currentColor"/>\n    <path d="M41.042 58.875H85.9587L63.5003 20.0834L41.042 58.875ZM65.542 52.75H61.4587V48.6667H65.542V52.75ZM65.542 44.5834H61.4587V36.4167H65.542V44.5834Z" fill="currentColor"/>\n    </g>\n    <defs>\n    <clipPath id="clip0">\n    <rect width="128.03" height="116.141" fill="currentColor" transform="translate(0 0.858643)"/>\n    </clipPath>\n    </defs>\n    </svg>\n    '}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X))},n.\u0275cmp=e.Xpm({type:n,selectors:[["panel-view-status"]],decls:25,vars:33,consts:[[1,"flex","items-center","justify-center","h-full","w-full"],[1,"flex-1","h-full","text-white","flex","flex-col","items-center","justify-center","relative"],[3,"innerHTML"],[1,"text-4xl","uppercase","font-medium","mt-4"],[1,"text-2xl","font-light","mt-4"],["class","absolute top-0 inset-x-0 flex items-center justify-center text-2xl bg-black/40 p-4 space-x-4",4,"ngIf"],[1,"flex-1","h-full","bg-white","text-black","flex","flex-col","items-center","justify-center","space-y-4"],[1,"text-4xl","uppercase","font-medium"],[1,"text-2xl","font-light"],[1,"absolute","top-0","inset-x-0","flex","items-center","justify-center","text-2xl","bg-black/40","p-4","space-x-4"],[1,"uppercase"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e._UZ(5,"div",2),e.ALo(6,"safe"),e.ALo(7,"async"),e.ALo(8,"async"),e.TgZ(9,"h3",3),e._uU(10,"Now"),e.qZA(),e.TgZ(11,"p",4),e._uU(12),e.ALo(13,"async"),e.qZA(),e.YNc(14,rr,5,0,"div",5),e.ALo(15,"async"),e.qZA(),e.TgZ(16,"div",6),e._UZ(17,"div",2),e.ALo(18,"safe"),e.ALo(19,"async"),e.TgZ(20,"h3",7),e._uU(21,"Next"),e.qZA(),e.TgZ(22,"p",8),e._uU(23),e.ALo(24,"async"),e.qZA(),e.qZA(),e.qZA()),2&t){let s,a,r;e.xp6(1),e.ekj("bg-error","busy"===e.lcZ(2,11,i.state))("bg-success","free"===e.lcZ(3,13,i.state))("bg-pending","pending"===e.lcZ(4,15,i.state)),e.xp6(4),e.Q6J("innerHTML",e.lcZ(6,17,"busy"===e.lcZ(7,19,i.state)?i.in_use_svg:"pending"===e.lcZ(8,21,i.state)?i.pending_svg:i.free_svg),e.oJD),e.xp6(7),e.hij(" ",(null==(s=e.lcZ(13,23,i.event_state))?null:s.current)||"No current event"," "),e.xp6(2),e.Q6J("ngIf","pending"===e.lcZ(15,25,i.state)),e.xp6(3),e.Q6J("innerHTML",e.lcZ(18,27,null!=(a=e.lcZ(19,29,i.event_state))&&a.next?i.in_use_svg:i.free_svg),e.oJD),e.xp6(6),e.hij(" ",(null==(r=e.lcZ(24,31,i.event_state))?null:r.next)||"No upcoming events"," ")}},directives:[g.O5,N],pipes:[g.Ov,$e],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#424242}"]}),n})(),Fn=(()=>{class n extends O{constructor(t,i){super(),this._state=t,this._route=i}ngOnInit(){this._state.system="",this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("system_id")&&(this._state.system=t.get("system_id"))}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X),e.Y36(J.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["panel-view"]],features:[e._Bn([X]),e.qOj],decls:3,vars:0,consts:[[1,"flex","flex-col","items-center","h-full","w-full","overflow-hidden"],[1,"flex-1","w-full"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"panel-view-details",1),e._UZ(2,"panel-view-status",1),e.qZA())},directives:[Sn,Un],styles:[""]}),n})();var lr=m(6231),cr=m(3942),En=m(4480);function ur(n,o){if(1&n&&(e.TgZ(0,"div",8),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.hour," ")}}function pr(n,o){if(1&n&&e._UZ(0,"div",9),2&n){const t=e.oxw().$implicit,i=e.oxw();e.Udp("height",i.height(t.minutes))}}function dr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",5),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().event.emit(a.id)}),e.YNc(1,ur,2,1,"div",6),e.YNc(2,pr,1,2,"div",7),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw();e.Udp("min-width",1*i.step+"px"),e.xp6(1),e.Q6J("ngIf",t.minutes%60==0),e.xp6(1),e.Q6J("ngIf",t.minutes%15==0)}}function mr(n,o){if(1&n&&e._UZ(0,"div",11),2&n){const t=e.oxw().$implicit;e.Udp("left",8+t.start+"px")("width",t.length+"px")}}function _r(n,o){if(1&n&&(e.ynx(0),e.YNc(1,mr,1,4,"div",10),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",t.start+t.length>=0&&t.start<1440)}}let Pn=(()=>{class n extends O{constructor(){super(...arguments),this.events=[],this.step=15,this.event=new e.vpe,this.current_time=0,this.blocks=[],this.event_blocks=[]}ngOnInit(){this._generateTimeBlocks(),this._updateCurrentTime(),this.interval("gen-blocks",()=>this._generateTimeBlocks(),6e4),this.interval("update-current",()=>this._updateCurrentTime(),3e4)}ngOnChanges(t){t.events&&this._processEvents()}height(t){switch(t){case 0:return"3.5rem";case 15:case 45:return"1rem";case 30:return"2rem"}return""}_generateTimeBlocks(){const t=[],i=(0,st.Z)((0,lr.Z)((0,cr.Z)(Date.now(),1),this.step/2),{nearestTo:this.step});let s=i;const a=(0,En.Z)(i,24);for(;s<a;)t.push({id:s.valueOf(),minutes:s.getMinutes(),hour:(0,j.Z)(s,"h a")}),s=(0,z.Z)(s,this.step);this.blocks=t}_processEvents(){!this.blocks.length||(this.event_blocks=(this.events||[]).map(t=>({start:(0,de.Z)(t.date,this.blocks[0].id),length:t.duration})))}_updateCurrentTime(){if(!this.blocks.length)return;const t=(0,de.Z)(Date.now(),this.blocks[0].id);this.current_time=t}}return n.\u0275fac=function(){let o;return function(i){return(o||(o=e.n5z(n)))(i||n)}}(),n.\u0275cmp=e.Xpm({type:n,selectors:[["checkin-timetable"]],inputs:{events:"events",step:"step"},outputs:{event:"event"},features:[e.qOj,e.TTD],decls:5,vars:4,consts:[[1,"flex","items-center","relative","h-20","px-2"],["class","h-full relative",3,"min-width","click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["current","",1,"absolute","bottom-0","h-[3.5rem]","w-0.5","bg-primary","pointer-events-none"],[1,"h-2","w-2","rounded-full","bg-primary","absolute","top-1/2","-translate-y-1/2","left-1/2","-translate-x-1/2"],[1,"h-full","relative",3,"click"],["class","absolute top-1 left-0 text-xs whitespace-nowrap",4,"ngIf"],["class","absolute w-px bottom-0 left-0 bg-black",3,"height",4,"ngIf"],[1,"absolute","top-1","left-0","text-xs","whitespace-nowrap"],[1,"absolute","w-px","bottom-0","left-0","bg-black"],["event","","class","absolute bottom-0 h-[3.5rem] bg-gray-300 opacity-40",3,"left","width",4,"ngIf"],["event","",1,"absolute","bottom-0","h-[3.5rem]","bg-gray-300","opacity-40"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,dr,3,4,"button",1),e.YNc(2,_r,2,1,"ng-container",2),e.TgZ(3,"div",3),e._UZ(4,"div",4),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",i.blocks),e.xp6(1),e.Q6J("ngForOf",i.event_blocks),e.xp6(1),e.Udp("left",8+i.current_time+"px"))},directives:[g.sg,g.O5],styles:["[event][_ngcontent-%COMP%]{--color1: #969696;--color2: #424242;background:repeating-linear-gradient(-45deg,var(--color1),var(--color1) 6px,var(--color2) 6px,var(--color2) 8px)}"]}),n})();function hr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().checkInCurrent()}),e._uU(1," Check-in "),e.qZA()}}function fr(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().newBooking()}),e._uU(1," Book "),e.qZA()}}function gr(n,o){1&n&&(e.TgZ(0,"button",22),e._uU(1," Book "),e.qZA())}const vr=[{path:"bootstrap",component:ks},{path:"panel/:system_id",component:Fn},{path:"checkin/:system_id",component:(()=>{class n extends O{constructor(t,i){super(),this._state=t,this._route=i,this.state=this._state.status,this.system=this._state.space,this.bookings=this._state.bookings,this.checkInCurrent=()=>this._state.startMeeting(),this.newBooking=()=>this._state.newBooking(),this.event_state=(0,oe.aj)([this._state.current,this._state.next]).pipe((0,Z.U)(([s,a])=>({current:In(s,a),next:Mn(a)})))}get time(){return(0,rt.Z)(Date.now())}get room_image(){return this._state.setting("image")}ngOnInit(){this._state.system="",this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("system_id")&&(this._state.system=t.get("system_id"))}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X),e.Y36(J.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["checkin-view"]],features:[e._Bn([X]),e.qOj],decls:77,vars:45,consts:[[1,"bg-black","relative","text-white","p-4","h-32"],[1,"bg-cover","bg-center","absolute","inset-0"],[1,"absolute","inset-0","bg-black/60"],["name","",1,"absolute","bottom-4","left-4","text-3xl","font-medium","z-10"],[1,"p-4","text-xl","font-medium"],[1,"bg-white","divide-y","divide-gray-200"],[1,"flex","items-center","p-2"],[1,"w-2","h-full","min-h-[3rem]","rounded"],[1,"text-sm","flex-1","px-2"],[1,"font-medium","uppercase"],[1,""],["mat-button","","class","w-24",3,"click",4,"ngIf"],[1,"w-2","h-full","min-h-[3rem]","rounded","bg-error"],["mat-button","","class","w-24",4,"ngIf"],[1,"bg-white","overflow-auto"],[3,"events"],[1,"bg-white","overflow-auto","flex-1","h-px","divide-y","divide-gray-200"],["matRipple","",1,"flex","items-center","p-4","w-full"],[1,"text-black/40","bg-black/20","rounded-full","p-2","text-2xl"],[1,"flex-1","px-4","font-medium","text-left"],[1,"text-2xl","opacity-40"],["mat-button","",1,"w-24",3,"click"],["mat-button","",1,"w-24"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e._UZ(2,"div",2),e.TgZ(3,"div",3),e._uU(4),e.ALo(5,"async"),e.ALo(6,"async"),e.qZA(),e.qZA(),e.TgZ(7,"h3",4),e._uU(8,"Upcoming"),e.qZA(),e.TgZ(9,"div",5),e.TgZ(10,"div",6),e._UZ(11,"div",7),e.ALo(12,"async"),e.ALo(13,"async"),e.ALo(14,"async"),e.TgZ(15,"div",8),e.TgZ(16,"div",9),e._uU(17,"Now"),e.qZA(),e.TgZ(18,"div",10),e._uU(19),e.ALo(20,"async"),e.qZA(),e.qZA(),e.YNc(21,hr,2,0,"button",11),e.ALo(22,"async"),e.YNc(23,fr,2,0,"button",11),e.ALo(24,"async"),e.qZA(),e.TgZ(25,"div",6),e._UZ(26,"div",12),e.ALo(27,"async"),e.ALo(28,"async"),e.TgZ(29,"div",8),e.TgZ(30,"div",9),e._uU(31,"Next"),e.qZA(),e.TgZ(32,"div",10),e._uU(33),e.ALo(34,"async"),e.qZA(),e.qZA(),e.YNc(35,gr,2,0,"button",13),e.ALo(36,"async"),e.qZA(),e.qZA(),e.TgZ(37,"h3",4),e._uU(38,"Schedule"),e.qZA(),e.TgZ(39,"div",14),e._UZ(40,"checkin-timetable",15),e.ALo(41,"async"),e.qZA(),e.TgZ(42,"h3",4),e._uU(43,"Features"),e.qZA(),e.TgZ(44,"div",16),e.TgZ(45,"button",17),e.TgZ(46,"div",18),e.TgZ(47,"app-icon"),e._uU(48,"lightbulb"),e.qZA(),e.qZA(),e.TgZ(49,"div",19),e._uU(50," Lights & Blinds "),e.qZA(),e.TgZ(51,"app-icon",20),e._uU(52,"chevron_right"),e.qZA(),e.qZA(),e.TgZ(53,"button",17),e.TgZ(54,"div",18),e.TgZ(55,"app-icon"),e._uU(56,"add_to_queue"),e.qZA(),e.qZA(),e.TgZ(57,"div",19),e._uU(58,"TV"),e.qZA(),e.TgZ(59,"app-icon",20),e._uU(60,"chevron_right"),e.qZA(),e.qZA(),e.TgZ(61,"button",17),e.TgZ(62,"div",18),e.TgZ(63,"app-icon"),e._uU(64,"restaurant"),e.qZA(),e.qZA(),e.TgZ(65,"div",19),e._uU(66,"Catering"),e.qZA(),e.TgZ(67,"app-icon",20),e._uU(68,"chevron_right"),e.qZA(),e.qZA(),e.TgZ(69,"button",17),e.TgZ(70,"div",18),e.TgZ(71,"app-icon"),e._uU(72,"help"),e.qZA(),e.qZA(),e.TgZ(73,"div",19),e._uU(74,"Help"),e.qZA(),e.TgZ(75,"app-icon",20),e._uU(76,"chevron_right"),e.qZA(),e.qZA(),e.qZA()),2&t){let s,a,r,c,h,d;e.xp6(1),e.Udp("background-image","url("+i.room_image+")"),e.xp6(3),e.hij(" ",(null==(s=e.lcZ(5,19,i.system))?null:s.display_name)||(null==(s=e.lcZ(6,21,i.system))?null:s.name)||"<Unknown Space>"," "),e.xp6(7),e.ekj("bg-error","busy"===e.lcZ(12,23,i.state))("bg-success","free"===e.lcZ(13,25,i.state))("bg-pending","pending"===e.lcZ(14,27,i.state)),e.xp6(8),e.hij(" ",(null==(a=e.lcZ(20,29,i.event_state))?null:a.current)||"No current event"," "),e.xp6(2),e.Q6J("ngIf","pending"===e.lcZ(22,31,i.state)),e.xp6(2),e.Q6J("ngIf","free"===e.lcZ(24,33,i.state)),e.xp6(3),e.ekj("bg-error",null==(r=e.lcZ(27,35,i.event_state))?null:r.next)("bg-success",!(null!=(c=e.lcZ(28,37,i.event_state))&&c.next)),e.xp6(7),e.hij(" ",(null==(h=e.lcZ(34,39,i.event_state))?null:h.next)||"No upcoming event"," "),e.xp6(2),e.Q6J("ngIf",!(null!=(d=e.lcZ(36,41,i.event_state))&&d.next)),e.xp6(5),e.Q6J("events",e.lcZ(41,43,i.bookings))}},directives:[g.O5,Pn,Q.wG,N,L.lW],pipes:[g.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;background-color:#f8f8fa;height:100%;width:100%;overflow:hidden}"]}),n})()},{path:"panel-old/:system_id",component:Et},{path:"panel-array",component:Ha},{path:"panel-select",component:ir},{path:"**",redirectTo:"bootstrap"}];let br=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[J.Bz.forRoot(vr,{useHash:!0})],J.Bz]}),n})();m(3128),m(5338);var qn=m(620);m(7193);let qr=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[g.ez,_.u5,_.UX,F.lN,ee.c,ce.LD,W.Bb,qn.AV,Cn.p9,Be]]}),n})(),$r=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[g.ez,_.u5,_.UX,Be,qr,q.Is]]}),n})();var jr=m(4270),Jr=m(875),Lt=m(476);const lt=[{id:"item-1",name:"Coffee",unit_price:200,category:"Drinks",tags:["drink"],options:[{id:"opt-1",name:"Cappacino",group:"type"},{id:"opt-2",name:"Latte",group:"type"},{id:"opt-3",name:"1 Sugar",group:"sugars",unit_price:20},{id:"opt-4",name:"2 Sugar",group:"sugars",unit_price:20},{id:"opt-5",name:"3 Sugar",group:"sugars",unit_price:20},{id:"opt-6",name:"4 Sugar",group:"sugars",unit_price:20}]},{id:"item-2",name:"Soda",unit_price:160,category:"Drinks",tags:["drink"],options:[{id:"opt-1",name:"Pepsi",group:"type"},{id:"opt-2",name:"Sunkist",group:"type"},{id:"opt-3",name:"Solo",group:"type"},{id:"opt-4",name:"Dr Pepper",group:"type"}]},{id:"item-3",name:"Water",unit_price:100,category:"Drinks"},{id:"item-4",name:"Muffin",unit_price:160,category:"Snacks",options:[{id:"opt-1",name:"Choc Chip",group:"type"},{id:"opt-2",name:"Banana",group:"type"},{id:"opt-3",name:"Blueberry",group:"type"}]},{id:"item-5",name:"Cookies",unit_price:400,category:"Snacks",options:[{id:"opt-1",name:"Choc Chip",group:"type"},{id:"opt-2",name:"Macadamia",group:"type"},{id:"opt-3",name:"Dark Choc",group:"type"}]},{id:"item-6",name:"Fish & Chips",unit_price:250,category:"Simple Meals",options:[{id:"opt-1",name:"Tomato Sauce",group:"sauce",unit_price:30},{id:"opt-2",name:"BBQ Sauce",group:"sauce",unit_price:35},{id:"opt-3",name:"Tartare Sause",group:"sauce",unit_price:40},{id:"opt-4",name:"Garlic Aoili Sauce",group:"sauce",unit_price:50}]},{id:"item-7",name:"Sandwich",unit_price:300,category:"Simple Meals",options:[{id:"opt-1",name:"Ham & Cheese",group:"type"},{id:"opt-2",name:"Chicken",group:"type"},{id:"opt-3",name:"Fairy Bread",group:"type"}]}];function Dr(n){const o=(0,de.Z)(n.event_start,n.event_end),t=v(lt.length);return{id:`order-${v(999999)}`,event_id:n.id,invoice_number:`I${v(999999)}`,charge_code:`C${v(9999)}`,deliver_at:(0,z.Z)(1e3*n.event_start,5*v(Math.floor(o/5))),items:new Array(3).fill(0).map((i,s)=>Object.assign(Object.assign({},lt[t*s%lt.length]),{options:[],quantity:v(10,1)}))}}const Br=[{created_at:1587057070,updated_at:1587692680,name:"PlaceOS",description:"",tags:"org",count:0,capacity:0,parent_id:"",triggers:[],id:"zone-EmWFTjuYExK"}],ze=[{name:"Sydney",description:"",tags:"building",count:0,capacity:0,parent_id:"zone-EmWFTjuYExK",triggers:[],id:"bld-01",levels:["lvl-10","lvl-11"]},{name:"Brisbane",description:"",tags:"building",count:0,capacity:0,parent_id:"zone-EmWFTjuYExK",triggers:[],id:"bld-02",levels:["lvl-2","lvl-3"]}],me=ze.map(n=>n.levels.map((o,t)=>((n,o,t,i=10)=>{let s=n.substr(4);return s=`assets/maps/level_${i}.svg`,{id:`${t.id}_${n}`,name:`Level ${n.endsWith("00")?"G":n.split("-")[1]}`,parent_id:t.id,description:"",tags:"level",map_id:s,code:"level code 12",type:"staff floor",count:5,capacity:30,location:"optional lat,long",display_name:""}})(o,0,n,+o.split("-")[1]))).reduce((n,o)=>n.concat(o),[{id:"test",parent_id:"bld-01",name:"Test",map_id:"assets/maps/l19.svg"}]),_e={current:{contacts:{name:"contacts",description:"",details:[{id:"user-1",name:"Jonathan McFarlane (PlaceOS)",email:"jon@place.tech",first_name:"Jonathan",last_name:"McFarlane"},{id:"user-1",name:"Alex Sorafumo (PlaceOS)",email:"alex@place.tech",first_name:"Alex",last_name:"Sorafumo"}]}}},Vr=function(){function n(i,s=5){for(i=`${i}`;i.length<s;)i=`0${i}`;return i}(0,b.pRY)({path:"/api/engine/v2/zones",metadata:{},method:"GET",callback:i=>{if("org"===i.query_params.tags)return Br;if("building"===i.query_params.tags)return ze;if("level"===i.query_params.tags)return me;throw{status:404,message:"Zones not found"}}}),(0,b.pRY)({path:"/api/engine/v2/metadata/:id",metadata:{},method:"GET",callback:i=>{if("bindings"===i.query_params.name)return{bindings:{details:{area_management:"space-0",location_services:"space-0"}}};if("catering"===i.query_params.name)return{catering:{details:lt}};if("desks"===i.query_params.name){const s=i.route_params.id.split("-");return t(s[s.length-1])}return"map_regions"===i.query_params.name?{map_regions:{details:{areas:[{id:"zone-10.A",properties:{capacity:100,label_location:{x:.36,y:.33}}},{id:"zone-10.B",properties:{capacity:100,label_location:{x:.76,y:.33}}},{id:"zone-10.C",properties:{capacity:100,label_location:{x:.63,y:.77}}}]}}}:_e[i.route_params.id]&&_e[i.route_params.id][i.query_params.name]?_e[i.route_params.id]:_e[i.route_params.id]&&!i.query_params.name&&_e[i.route_params.id]||{}}}),(0,b.pRY)({path:"/api/engine/v2/metadata/:id",metadata:{},method:"PATCH",callback:i=>{_e[i.route_params.id]||(_e[i.route_params.id]={}),_e[i.route_params.id][i.body.name]=i.body}});const o=["sit_to_stand","single_monitor","dual_monitor"];function t(i){return{desks:{details:new Array(30).fill(0).map((s,a)=>({id:`table-${n(i,2)}.${n(a+1,3)}`,name:`Desk ${i}.${n(a+1,3)}`,bookable:v(9999)%4!=0,group:"",features:o.filter(r=>v(99999)%3==0)}))}}}(0,b.pRY)({path:"/api/engine/v2/metadata/:id/children",metadata:{},method:"GET",callback:i=>{const s=ze.find(a=>a.id===i.route_params.id);if(!s)throw{status:404,message:`Unable to find zone with id "${i.route_params.id}"`};return me.filter(a=>a.parent_id===s.id).map(a=>{const r=a.id.split("-");return{zone:a,metadata:t(r[r.length-1])}})}})}(),$n="place.tech",jn=["Jonathan McFarlane","Alex Sorafumo","Jim Doe","Cristina Boston","Jeremy West","Viv Briffa","Candy Russo","Jeff Wiz","Sravani Kotha","Kim Burgess","Caspian Baska","Stephen Von Takach","Cameron Reeves","Shane Boseley"],he={id:"current",name:"PlaceOS - Mock User",email:"dev@place.tech",groups:["deals",""]},P=jn.map((n,o)=>({id:`user-${o+1}`,name:`${n} (PlaceOS)`,email:`${n.split(" ").join(".").toLowerCase()}@${$n}`})).concat([he]),qt=jn.map((n,o)=>({id:`guest-${o+1}`,name:`${n} (External)`,email:`${n.split(" ").join(".").toLowerCase()}@guest.${$n}`,visit_expected:v(99999)%2==0})),zr=()=>{const n=["Whiteboard","VidConf","Projector","Views"],o=v(n.length+1),t=[];for(let i=0;i<o;i++)t.push(n[v(n.length)]);return t.filter((i,s,a)=>a.indexOf(i)===s)},Ee=[{name:"Conference Room 10.01",map_id:"area-10.01-status",zones:["bld-01","bld-01_lvl-10"]},{name:"Conference Room 10.02",map_id:"area-10.02-status",zones:["bld-01","bld-01_lvl-10"]},{name:"Conference Room 10.03",map_id:"area-10.03-status",zones:["bld-01","bld-01_lvl-10"]},{name:"Conference Room 11.01",map_id:"area-11.01-status",zones:["bld-01","bld-01_lvl-11"]},{name:"Conference Room 11.02",map_id:"area-11.02-status",zones:["bld-01","bld-01_lvl-11"]},{name:"Conference Room 11.03",map_id:"area-11.03-status",zones:["bld-01","bld-01_lvl-11"]},{name:"Conference Room 2.01",map_id:"area-2.01-status",zones:["bld-02","bld-02_lvl-2"]},{name:"Conference Room 2.02",map_id:"area-2.02-status",zones:["bld-02","bld-02_lvl-2"]},{name:"Conference Room 3.01",map_id:"area-3.01-status",zones:["bld-02","bld-02_lvl-3"]},{name:"Conference Room 3.02",map_id:"area-3.02-status",zones:["bld-02","bld-02_lvl-3"]},{name:"Conference Room 3.03",map_id:"area-3.03-status",zones:["bld-02","bld-02_lvl-3"]}].map(n=>function(n={}){const o="space-"+Ye++,t=`Test Space ${Ye}`,i=v(99999)%2==0&&Ye>1,s=Object.assign({id:o,name:t,long_name:`${t} with an long name`,map_id:`${Ye}`,capacity:2*v(21,1),email:`${t.toLowerCase().split(" ").join(".")}@${Ze}`,type:"",searchable:v(99999)%2==0,controlable:v(99999)%2==0,bookable:v(99999)%2==0,cost_hour:100*v(300),setup:5*v(6),breakdown:5*v(6),zones:["zone_lvl-0"],support_url:`/control/#/panel/${o}`,bookings:[],linked_rooms:i?[`space-${v(Ye-1)}`]:[],image:""},n);return s.configurations&&s.configurations.length>0&&(s.configurations.forEach(a=>a.capacity=v(s.capacity)+1),s.configurations[0].capacity=s.capacity),s}(Object.assign(Object.assign({},n),{features:zr()})));let Jn=Qe().startOf("d").hour(7);const Dn=(n=!1)=>{const o=Jn.add(15*(v(8)+1),"m");return n&&(Jn=o),o.unix()},$t=["tentative","confirmed","cancelled"],Rr=()=>{const n=v(10);return n<2?$t[2]:n<5?$t[0]:$t[1]},Y=new Array(200).fill(0).map((n,o)=>{const t=P.concat(qt);let i=new Array(v(8,1)).fill(0).map(()=>t[v(t.length)]);i.sort((h,d)=>(h.visit_expected?0:-1)-(d.visit_expected?0:-1));const s=Ee[v(Ee.length)];i=i.concat(Object.assign(Object.assign({},s),{resource:!0})),v(9999)%2==0?i.unshift(he):i.unshift(P[v(P.length)]),i=ve(i,"email")||[{}];const a=Dn(!0),r=Dn(),c=v(9999)%3==0?"https://meet.place.tech":"";return{id:`cal-event-${o}`,status:Rr(),host:i[0].email,calendar:"calendar_id",creator:"optional@fake.com",attendees:ve(i,"email").map((h,d)=>Object.assign(Object.assign({},h),{organizer:0===d,checked_in:v(99999)%2==0,response_status:v(99999)%2==0?"accepted":v(99999)%6==0?"declined":"tentative"})),title:`Some Meeting ${o}`,body:"A Description",private:!1,event_start:a,event_end:r,timezone:"Australia/Sydney",all_day:!1,location:`${s.name}`,recurring:!1,recurrence:{},attachments:{},system:s,meeting_url:c,meeting_id:c?`m${v(9999)}`:"",meeting_provider:c?"PlaceOS":"",extension_data:{catering:v(99999)%4==0?[Dr({id:`cal-event-${o}`,event_start:a,event_end:r})]:[],setup:5*v(4),breakdown:5*v(4)}}}),jt={};Y.forEach(n=>{jt[n.system.id]||(jt[n.system.id]=[]),jt[n.system.id].push(n)});const Hr=function(){(0,b.pRY)({path:"/api/engine/v2/users/:id",metadata:{},method:"GET",callback:t=>{if("current"===t.route_params.id)return he;const i=P.find(s=>s.email===t.route_params.id);if(i)return i;throw{status:404,message:"User not found"}}}),(0,b.pRY)({path:"/api/staff/v1/people",metadata:{},method:"GET",callback:t=>{if(t.query_params.q){const i=t.query_params.q.toLowerCase();return P.filter(s=>s.name.toLowerCase().includes(i)||s.email.toLowerCase().includes(i))}return P}}),(0,b.pRY)({path:"/api/staff/v1/people/:id",metadata:{},method:"GET",callback:t=>{const i=decodeURIComponent(t.route_params.id),s=P.find(a=>a.email===i);if(s)return Object.assign(Object.assign({},s),{location:o()});throw{status:404,message:"User not found"}}}),(0,b.pRY)({path:"/api/staff/v1/guests",metadata:{},method:"GET",callback:t=>{if(t.query_params.q){const i=t.query_params.q.toLowerCase();return qt.filter(s=>s.name.toLowerCase().includes(i)||s.email.toLowerCase().includes(i))}return P}}),(0,b.pRY)({path:"/api/staff/v1/guests/:email",metadata:{},method:"GET",callback:t=>{const i=decodeURIComponent(t.route_params.email),s=qt.find(a=>a.email===i);if(s)return s;throw{status:404,message:"Guest not found"}}}),(0,b.pRY)({path:"/api/staff/v1/guests/:email/meetings",metadata:{},method:"GET",callback:t=>{if(t.route_params.email){const i=t.route_params.email.toLowerCase();return Y.filter(a=>a.attendees.find(r=>r.email.toLowerCase()===i))}throw{status:404,message:`Unable to find meetings with guest with email ${t.route_params.email}`}}});const n=["meeting","desk_id","laptop","mobile","geo","none"];function o(){const t=n[v(n.length)],i=me[v(me.length)],s=Ee.filter(c=>c.zones.includes(i.id)),a=s[v(s.length)]||{},r={};switch(t){case"meeting":r.meeting={building:i.parent_id,level:i.id,system:a.id,map_id:a.map_id,event_id:""};break;case"desk_id":r.meeting={building:i.parent_id,level:i.id,map_id:a.map_id,checked_in:Qe().unix()};break;case"laptop":case"mobile":r[t]={building:i.parent_id,level:i.id,x:+v(1e4),y:+v(5e3),last_seen:Qe().subtract(v(60),"m").unix()};break;case"geo":r.geo={lat:v(180)-90,lon:v(360)-180,last_seen:Qe().subtract(v(60),"m").unix()}}return r}}();class Xr{constructor(o){var t;this.help={help:{title:"Help",content:"\n# Using the asset browser\n\n## Activating the menu\nThe 5 finger touch can be actvated by placing 4 fingers and your thumb on the screen, or quickly double-tapping the screen. Activation through double tap will leave the menu on-screen. To close tap the \u2018X\u2019.\n\n## Selecting a menu item\nLeaving at least one finger on the screen, drag your finger to the icon to select.\n\n## Home Menu\nThe home menu allows you to access files and navigate to content and presentations via the Launcher.\n\n## Connect and stream your laptop or access the CMS to add files\nPlug your laptop into the HDMI to stream it to the screen, or access the CMS to add your own content and create custom presentations.\n\n<video></video>\n\n1. Test1\n2. Test2\n3. Test3\n            "},"laptop-help":{icon:"web_asset",title:"Asset Browser",content:"# Test 2"}},this.tabs=[{icon:"laptop",name:"Laptop",type:"Display",inputs:["Display_1"],help:"laptop-help"},{icon:"call",name:"VC",inputs:["VidConf_1"],help:"vidconf-help",controls:"vidconf-controls"}],this.volume=0,this.name=o.name||"Test Module",this.connected=null===(t=o.connected)||void 0===t||t,this.active=o.active||!1,this.input_list=o.input_list,this.output_list=o.output_list,this.env_sources=o.env_sources||[],this.inputs=Object.keys(this.input_list||{})||[],this.outputs=Object.keys(this.output_list||{})||[],ve(this.env_sources.map(s=>s.type)).forEach(s=>this[`${s}`]=this.env_sources.filter(a=>a.type===s).map(a=>a.id)),this.env_sources.forEach(s=>this[`${s.type}/${s.id}`]=s),this.inputs.forEach(s=>this[`input/${s}`]=this.input_list[s]),this.outputs.forEach(s=>this[`output/${s}`]=this.output_list[s])}$power(o=!0){console.log("Power:",o),this.active=o}$share(){}$route(o,t){this.inputs.includes(o)&&this.outputs.includes(t)&&(this.$updateState(o,{routes:ve([...this.input_list[o].routes||[],t])}),this.$updateState(t,{source:o,following:o}))}$unroute(){}$connect(){}$disconnect(){}$link(){}$merge(){}$split(){}$notify(){}$preset(){}$volume(o,t="all"){"all"===t&&(this.volume=o)}$mute(o=!0,t="all"){this.$updateState(t,{mute:o})}$unmute(o="all"){this.$mute(!1,o)}$environment(o,t){const i=this.env_sources.find(s=>s.id===o);i&&(this[`${i.type}/${i.id}`]=Object.assign(Object.assign({},i),{state:t}))}$lock(o){this.$updateState(o,{locked:!0})}$unlock(o){this.$updateState(o,{locked:!1})}$updateState(o,t){this[`input/${o}`]?(this[`input/${o}`]=Object.assign(Object.assign({},this[`input/${o}`]),t),this.input_list[o]=Object.assign(Object.assign({},this[`input/${o}`]),t)):this[`output/${o}`]&&(this[`output/${o}`]=Object.assign(Object.assign({},this[`output/${o}`]),t),this.output_list[o]=Object.assign(Object.assign({},this[`output/${o}`]),t))}}const Kr={Mic1:{name:"Lectern Mic",type:"Microphone",mod:"Microphone_1"},Mic2:{name:"Lapel Mic",type:"Microphone",mod:"Microphone_2"},Mic3:{name:"Handheld Mic",type:"Microphone",mod:"Microphone_3"},PC1:{name:"PC-1",type:"PC"},PC2:{name:"PC-2",type:"PC"},PC3:{name:"PC-3",type:"PC"},PC4:{name:"PC-4",type:"PC"},HDMI:{name:"Laptop HDMI",type:"Laptop"},VGA:{name:"Laptop VGA",type:"Laptop"},Camera1:{name:"Camera Rear",type:"Camera",mod:"Camera_1"},Camera2:{name:"Camera Front",type:"Camera",mod:"Camera_2"},Camera3:{name:"Camera Rear 2",type:"Camera",mod:"Camera_3"},Camera4:{name:"Camera Front 2",type:"Camera",mod:"Camera_4"},TV1:{name:"IPTV 1",type:"TV",mod:"IPTV_1"},VC1:{name:"Video Conference 1",type:"VC",mod:"VidConf_1"}},Wr={Display1:{name:"Display 1",type:"Display",source:"PC1",mod:"Display_1"},Display2:{name:"Display 2",type:"Display",mod:"Display_2"},Display3:{name:"Display 3",type:"Display",source:"PC2",mod:"Display_3"},Display4:{name:"Display 4",type:"Display",mod:"Display_4"},Display5:{name:"Display 5",type:"Display",mod:"Display_5",source:"TV1"}},el=[{id:"light1",name:"Lighting",type:"lights",states:["Off","Presentation","Meeting","Full"],state:"Off"},{id:"blind1",name:"Blinds",type:"blinds",states:["Off","Presentation","Meeting"],state:"Off"},{id:"screen1",name:"Screen",type:"screen",states:["Up","Down"],state:"Down"}],tl=(n,o={})=>new Xr(Object.assign(Object.assign(Object.assign({},n),{input_list:Kr,output_list:Wr,env_sources:el}),o));var nl=m(7887),il=m(6074);class ol{constructor(o,t){this._space=o,this.time_zone="Australia/Sydney",this.disable_book_now=!1,this.disable_end_meeting=!1,this.bookings=[],this.pending_period=0,this.pending_before=0,this.control_ui="",this.catering_ui="",this.last_booking_started=0,Bn(o,this),setInterval(()=>Bn(o,this),15e3)}get current_booking(){return this.bookings.find(o=>Te(Date.now(),Date.now(),1e3*o.event_start,1e3*o.event_end))}get next_booking(){return this.bookings.find(o=>1e3*o.event_start>Date.now())}get status(){var o,t;const i=new Date,{current_booking:s,next_booking:a}=this,r=new Date(null===(o=s||a)||void 0===o?void 0:o.event_start),c=Te(i,i,(0,nl.Z)(r,this.pending_before),(0,il.Z)(r,this.pending_period));return(null===(t=this._space)||void 0===t?void 0:t.bookable)?s?"busy":c?"pending":"free":"not-bookable"}$start_meeting(o){this.last_booking_started=o}$end_meeting(o){}$book_now(o,t,i){}}function sl(n,o={}){return new ol(n,o)}function Bn(n,o){const t=Y.filter(i=>{var s;return null===(s=i.attendees)||void 0===s?void 0:s.find(a=>a.email===n.email)})||[];t.sort((i,s)=>i.event_start-s.event_start),o.bookings=t}var Yn=m(999);class al{constructor(){this.overview={},this.emergency_contacts={"First Aid":P.filter(o=>v(9999)%5==0),"Fire Warden":P.filter(o=>v(9999)%5==0)}}$locate_user(o,t){}}function rl(n,o=3){let t=`${n}`;for(;t.length<o;)t="0"+t;return t}function ll(n,o={}){const t=new al;for(const i of me)t.overview[i.id]={desk_count:100,desk_usage:0,device_capacity:100,device_count:0,estimated_people:0,percentage_use:0,recommendation:1e4},t[`${i.id}:desk_ids`]=new Array(t.overview[i.id].desk_count).fill(0).map((s,a)=>`table-${i.number}.${rl(a)}`),t[`${i.id}`]={value:[]},t[`${i.id}:areas`]={value:[{area_id:"zone-10.B",count:v(100),name:".L1 IFS IT"},{area_id:"zone-10.A",count:v(100),name:".L1 IFS IT"},{area_id:"zone-10.C",count:v(50),name:".L1 IFS IT"}]};return Vn(t,me),setInterval(()=>Vn(t,me),6e4),t}function Vn(n,o){for(const t of o)n[t.id]={value:new Array(v(20)).fill(0).map(()=>cl(t,n[`${t.id}:desk_ids`]))}}function cl(n,o,t=P){return v(9999)%3==0?{location:"desk",at_location:v(9999)%5!=0,map_id:o[v(o.length)],mac:Yn.V.hashStr(t[v(t.length)].email),level:n.id,building:n.parent_id}:{location:"wireless",coordinates_from:"bottom-left",x:v(1e3)/10,y:v(1e3)/10,lon:55.27476066828535,lat:25.20106100633537,s2_cell_id:"3e5f4281459c",mac:Yn.V.hashStr(t[v(t.length)].email),variance:9.62534032222287,last_seen:Math.floor((new Date).valueOf()/1e3),map_width:100,map_height:100}}class ul{constructor(o){this.presets=["Preset One","Preset 2","Preset Three"]}$pan(o){}$tilt(o){}$recall(o){}$save_preset(o){}}class dl{constructor(o){this.volume=Ge(100)}$mute(o=!0){this.mute=o}$volume(o){this.volume=o}}class _l{constructor(o){this.volume=Ge(100)}$mute(o=!0){this.mute=o}$volume(o){this.volume=o}}let ct;class fl{constructor(o){this.status="stopped",this.live=!1,this.remaining=Ge(86400)}$start(){this.status="playing",ct=setInterval(()=>{this.remaining<1&&clearInterval(ct),this.remaining=this.remaining-1,this.current=this.current+1},3e3)}$pause(){this.status="paused",clearInterval(ct)}$resume(){this.$start()}$stop(){this.status="stopped",this.current=0,clearInterval(ct)}}const gl=(n,o={})=>new fl(Object.assign(Object.assign({},n),o));class vl{constructor(o){this.supported_meeting_url="https://meet."}$econtrol(...o){}}const bl=(n,o={})=>new vl(Object.assign(Object.assign({},n),o));class Cl{constructor(o){this.mic_mute=!1,this.selfview=!1,this.video_layout="Auto",this.presentation_mode="None",this.calls={test:{Status:"Connected"}}}$show_camera_pip(o){this.selfview=o}$mic_mute(o){this.mic_mute=o}$presentation_mode(o){this.presentation_mode=o}$hangup(){}$call_place_on_hold(){for(const o in this.calls)if(this.calls[o].Status)return this.calls[o].Status="OnHold",void(this.calls=Object.assign({},this.calls))}$call_resume(){for(const o in this.calls)if(this.calls[o].Status)return this.calls[o].Status="Idle",void(this.calls=Object.assign({},this.calls))}$video_layout(o){this.video_layout=o}$dtmf_send(o){}$dial(o){return new Promise(t=>setTimeout(()=>t(),1e3))}}const yl=(n={},o={})=>new Cl(Object.assign(Object.assign({},n),o));const wl=(Ee.forEach((n,o)=>function(n){(0,b.$6F)(n.id,{System:[tl(n)],Bookings:[sl(n)],AreaManagement:[ll()],Camera:new Array(10).fill(0).map(o=>((n,o={})=>new ul(Object.assign(Object.assign({},n),o)))(n)),Display:new Array(10).fill(0).map(o=>((n,o={})=>new dl(Object.assign(Object.assign({},n),o)))(n)),Microphone:new Array(10).fill(0).map(o=>((n,o={})=>new _l(Object.assign(Object.assign({},n),o)))(n)),Capture:[gl(n)],MeetingPush:[bl()],VidConf:[yl()]})}(n)),void(0,b.pRY)({path:"/api/engine/v2/systems",metadata:{},method:"GET",callback:n=>Ee})),Zl=((0,b.pRY)({path:"/api/staff/v1/events",metadata:{},method:"GET",callback:n=>{let o=Y;return n.query_params.zone_ids||(o=o.filter(t=>!!t.attendees.find(i=>i.email===he.email))),n.query_params.period_start&&(o=o.filter(t=>Te(n.query_params.period_start,n.query_params.period_end,t.event_start,t.event_end))),o}}),(0,b.pRY)({path:"/api/staff/v1/events",metadata:{},method:"POST",callback:n=>{const o=Object.assign(Object.assign({},n.body),{id:`-cal-event-${v(999)}`});return o.attendees=[P.find(t=>t.email===o.host),...o.attendees||[]],o.attendees.forEach(t=>{t.zones&&(t.resource=!0)}),o.system&&(o.attendees=[...o.attendees||[],Object.assign(Object.assign({},o.system),{resource:!0})]),Y.push(o),o}}),(0,b.pRY)({path:"/api/staff/v1/events/:id",metadata:{},method:"GET",callback:n=>{const o=Y.find(t=>t.id===n.route_params.id);if(o)return o;throw{status:404,message:"Event not found"}}}),(0,b.pRY)({path:"/api/staff/v1/events/:id",metadata:{},method:"DELETE",callback:n=>{const o=Y.findIndex(t=>t.id===n.route_params.id);if(!(o>0))throw{status:404,message:"Event not found"};Y[o].host===he.email?Y.splice(o,1):Y[o].attendees.find(i=>i.email===he.email).response_status="declined"}}),(0,b.pRY)({path:"/api/staff/v1/events/:id",metadata:{},method:"PATCH",callback:n=>{const o=Y.findIndex(t=>t.id===n.route_params.id);if(o>=0)return Y.splice(o,1,n.body);throw{status:404,message:"Event not found"}}}),void(0,b.pRY)({path:"/api/staff/v1/events/:id/guests/:email/checkin",metadata:{},method:"POST",callback:n=>{const o=Y.find(t=>t.id===n.route_params.id);if(o)return o.extension_data.checked_in=(o.extension_data.checked_in||[]).concat([n.route_params.email]),o;throw{status:404,message:"Guest not found"}}})),Al=function(){(0,b.pRY)({path:"/api/staff/v1/calendars",metadata:{},method:"GET",callback:o=>{const t=P[v(P.length)],i=P[v(P.length)],s=P[v(P.length)];return[{id:he.email,summary:he.name,primary:!0,can_edit:!0,hidden:!1},{id:t.email,summary:t.name,primary:!1,can_edit:!0,hidden:!1},{id:i.email,summary:i.name,primary:!1,can_edit:!1,hidden:!1},{id:s.email,summary:s.name,primary:!1,can_edit:!1,hidden:!0}]}});const n=o=>{const t=+o.query_params.period_start,i=+o.query_params.period_end,s=(o.query_params.zone_ids||"").split(",").filter(c=>!!c),a=(o.query_params.system_ids||"").split(",").filter(c=>!!c);return Ee.filter(c=>s.length?s.reduce((h,d)=>h&&c.zones.includes(d),!0):!a.length||a.includes(c.id)).filter(c=>{const h=Y.filter(d=>d.attendees.find(k=>k.id===c.id));for(const d of h)if(Te(t,i,d.event_start,d.event_end))return!1;return!0})};(0,b.pRY)({path:"/api/staff/v1/calendars/availability",metadata:{},method:"GET",callback:o=>n(o).map(t=>({resource:t}))}),(0,b.pRY)({path:"/api/staff/v1/calendars/free_busy",metadata:{},method:"GET",callback:o=>n(o).map(t=>({resource:t}))})}();var Sl=m(2260);let Qn=(0,Ve.Z)((0,Sl.Z)(Date.now(),3),{hours:7,minutes:0,seconds:0,milliseconds:0});const zn=(n=!1)=>{const o=(0,z.Z)(Qn,15*(v(8)+1));return n&&(Qn=o),(0,D.Z)(o)},Rn=["desk","parking"],ye=new Array(200).fill(0).map((n,o)=>{const t=P[v(P.length)],i=Rn[v(Rn.length)],s=ze[v(ze.length)],a=me.filter(d=>d.parent_id===s.id),r=a[v(a.length)],c=v(999999)%4,h=P[v(P.length)];return{id:`booking-${o}`,booking_start:zn(!0),booking_end:zn(),user_id:t.id,user_name:t.name,user_email:t.email,asset_id:`desk-${null==r?void 0:r.id}-${o}`,description:`Desk ${o}`,title:`${i} Booking ${o}`,type:i,checked_in:v(999999)%3==0,access:v(999999)%3==0,approved:0===c,rejected:1===c,approver_id:0===c?h.id:"",approver_name:0===c?h.name:"",approver_email:0===c?h.email:"",zones:[s.id,null==r?void 0:r.id],extension_data:{map_id:`table-10.00${o}`}}}),Ul={ZONE_MOCKS:Vr,USER_MOCKS:Hr,SYSTEM_MOCKS:wl,EVENT_MOCKS:Zl,CALENDAR_MOCKS:Al,BOOKING_MOCKS:function(){(0,b.pRY)({path:"/api/staff/v1/bookings",metadata:{},method:"GET",callback:o=>ye.filter(i=>Te(o.query_params.period_start,o.query_params.period_end,i.booking_start,i.booking_end)&&i.type===o.query_params.type)}),(0,b.pRY)({path:"/api/staff/v1/bookings/:id",metadata:{},method:"GET",callback:o=>{const t=ye.find(i=>i.id===o.route_params.id);if(!t)throw{status:404,message:`Unable to find booking with ID ${o.route_params.id}`};return t}}),(0,b.pRY)({path:"/api/staff/v1/bookings",metadata:{},method:"POST",callback:o=>{const t=Object.assign(Object.assign({},o.body),{id:`-booking-${v(999)}`});return ye.push(t),t}});const n=(o,t)=>{const i=ye.findIndex(a=>a.id===o);if(i<0)throw{status:404,message:`Unable to find booking with ID ${o}`};const s=Object.assign({},t);return ye.splice(i,1,s),s};(0,b.pRY)({path:"/api/staff/v1/bookings/:id",metadata:{},method:"PUT",callback:o=>n(o.route_params.id,Object.assign({},o.body))}),(0,b.pRY)({path:"/api/staff/v1/bookings/:id/approve",metadata:{},method:"POST",callback:o=>n(o.route_params.id,Object.assign(Object.assign({},o.body),{approved:!0,rejected:!1}))}),(0,b.pRY)({path:"/api/staff/v1/bookings/:id/reject",metadata:{},method:"POST",callback:o=>n(o.route_params.id,Object.assign(Object.assign({},o.body),{approved:!1,rejected:!0}))}),(0,b.pRY)({path:"/api/staff/v1/bookings/:id/check_in",metadata:{},method:"POST",callback:o=>n(o.route_params.id,Object.assign(Object.assign({},o.body),{checked_in:"true"===o.query_params.state}))}),(0,b.pRY)({path:"/api/staff/v1/bookings/:id",metadata:{},method:"DELETE",callback:o=>{const t=ye.findIndex(i=>i.id===o.route_params.id);if(t<0)throw{status:404,message:`Unable to find booking with ID ${o.route_params.id}`};ye.splice(t,1)}})}()};ie("MOCKS","Mocks included with application.");let El=(()=>{class n extends O{constructor(t,i,s,a,r,c,h,d){super(),this._tracing=t,this._settings=i,this._org=s,this._spaces=a,this._cache=r,this._snackbar=c,this._hotkey=h,this._clipboard=d}ngOnInit(){var t,i;return(0,A.mG)(this,void 0,void 0,function*(){ie("APP","MOCKS:",le),this._hotkey.listen(["Control","Alt","Shift","KeyM"],()=>{localStorage.setItem("mock",`${"true"!==localStorage.getItem("mock")}`),location.reload()}),this._hotkey.listen(["Control","Alt","Shift","KeyC"],()=>{this._clipboard.copy(`${(0,b.rao)()}|${(0,b.g$u)()}`),Xt("Successfully copied token.")}),this._hotkey.listen(["Control","Alt","Shift","KeyV"],()=>{var a;null===(a=navigator.clipboard)||void 0===a||a.readText().then(r=>{const c=r.split("|"),h=(0,b.I4i)();localStorage.setItem(`${h}_access_token`,`${c[0]}`),localStorage.setItem(`${h}_refresh_token`,`${c[1]}`),localStorage.setItem(`${h}_expires_at`,`${(0,En.Z)(new Date,6).valueOf()}`),Xt("Successfully pasted token."),setTimeout(()=>location.reload(),2e3)})}),function(n){ft=n}(this._snackbar),yield this._settings.initialised.pipe((0,H.P)(a=>a)).toPromise(),Vt(this._settings.get("app.short_name"));const s=this._settings.get("composer")||{};s.mock=!!this._settings.get("mock")||location.origin.includes("demo.place.tech"),yield function(n){return(0,A.mG)(this,void 0,void 0,function*(){const o=n.protocol||location.protocol,t=n.domain||location.hostname,i=n.port||location.port,s=n.use_domain?`${o}//${t}:${i}`:location.origin,a=(location.pathname+"/").replace("//","/");console.log("Mock:",n.mock,location.href.includes("mock=true"),"true"===localStorage.getItem("mock"));const r=n.mock||location.href.includes("mock=true")||"true"===localStorage.getItem("mock"),c={auth_type:"auth_code",scope:"public",host:`${t}${i?":"+i:""}`,auth_uri:`${s}/auth/oauth/authorize`,token_uri:`${s}/auth/oauth/token`,redirect_uri:`${location.origin}${a}oauth-resp.html`,handle_login:!n.local_login,use_iframe:!0,mock:r};return localStorage&&localStorage.setItem("mock",`${!!r&&!location.href.includes("mock=false")}`),r&&Kt("Application in mock mode."),(0,b.cYp)(c)})}(s).catch(()=>this.onInitError()),function(n,o=(()=>null),t=3e5){n.isEnabled&&(gt&&gt.unsubscribe(),vt&&vt.unsubscribe(),bt&&clearInterval(bt),gt=n.available.subscribe(i=>{ie("CACHE",`Update available: current version is ${i.current.hash} available version is ${i.available.hash}`),function(n){n.isEnabled&&(ie("CACHE","Activating changes to the cache..."),n.activateUpdate().then(()=>{Kt("Newer version of the application is available","Refresh",()=>location.reload(!0))}))}(n)}),vt=n.activated.subscribe(()=>{ie("CACHE","Updates activated. Reloading..."),o("Newer version of the application is available",()=>location.reload(!0))}),bt=setInterval(()=>{ie("CACHE","Checking for updates..."),n.checkForUpdate()},t))}(this._cache),s.local_login||this.timeout("wait_for_user",()=>this.onInitError(),3e4),yield Gt.pipe((0,H.P)(a=>!!a)).toPromise(),this.clearTimeout("wait_for_user"),function(n){n&&(Mt=n)}(ke()),function(n){Ze=n}(this._settings.get("app.general.internal_user_domain")||`@${null===(i=null===(t=ke())||void 0===t?void 0:t.email)||void 0===i?void 0:i.split("@")[1]}`),function(n,o=.2){!n||Jr.S({dsn:n,integrations:[new jr.jK.BrowserTracing({tracingOrigins:["localhost",location.origin],routingInstrumentation:Lt.$q})],tracesSampleRate:o})}(this._settings.get("app.sentry_dsn"))})}onInitError(){var t;(0,b.y7C)()||(null===(t=ke())||void 0===t?void 0:t.is_logged_in)||(console.error("Error initialising user."),(0,b.Ogr)(),location.reload())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Lt.aN),e.Y36(Ae),e.Y36(Le),e.Y36(nt),e.Y36(Dt.yO),e.Y36(Bt.ux),e.Y36(mi),e.Y36(yt.TU))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-root"]],features:[e.qOj],decls:4,vars:0,consts:[[1,"flex-1","w-full","relative","h-1/2"]],template:function(t,i){1&t&&(e._UZ(0,"global-banner"),e.TgZ(1,"div",0),e._UZ(2,"router-outlet"),e.qZA(),e._UZ(3,"global-loading"))},directives:[wt,J.lC,ln],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}"]}),n})();var Pl=m(5379);let Nl=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[g.ez,Be]]}),n})(),Ll=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[g.ez,Be,Q.si]]}),n})();const ql=[F.lN,ee.c,W.Bb];let $l=(()=>{class n{constructor(){console.log("Production:",!0)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n,bootstrap:[El]}),n.\u0275inj=e.cJS({providers:[{provide:e.qLn,useValue:Pl.v({showDialog:!1})},{provide:Lt.aN,deps:[J.F0]}],imports:[[Ne.b2,Gn.PW,br,Xn.JF,_.u5,Bt.ZX,Q.si,$r,Nl,Ll,Be,...ql,Dt.Wr.register("ngsw-worker.js",{enabled:true})]]}),n})();(0,e.G48)(),Ne.q6().bootstrapModule($l).catch(n=>console.error(n))}},fe=>{fe.O(0,["vendor"],()=>fe(fe.s=9548)),fe.O()}]);
//# sourceMappingURL=main.js.map