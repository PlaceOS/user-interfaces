(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([["main"],{7004:e=>{function t(e){return Promise.resolve().then(()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=()=>[],t.resolve=t,t.id=7004,e.exports=t},5849:(e,t,i)=>{"use strict";var n={};i.r(n),i.d(n,{default:()=>No});var s=i(269),o=i(2619),a=i(3490),r=i(9063),l=i(6073),c=i(6898),u=i(8067),d=i(1403),p=i(84),h=i(6283),m=i(6756),g=i(4762),f=i(3530),_=i(8512),v=i(7570);let b=(()=>{class e{constructor(){this._timers={},this._intervals={},this._subscriptions={},this._initialised=new _.X(!1),this.initialised=this._initialised.asObservable()}get is_initialised(){return this._initialised.getValue()}ngOnDestroy(){this.destroy()}destroy(){for(const e in this._timers)e in this._timers&&this.clearTimeout(e);for(const e in this._intervals)e in this._intervals&&this.clearInterval(e);for(const e in this._subscriptions)e in this._subscriptions&&this.unsub(e)}timeout(e,t,i=300){if(!(e&&t&&t instanceof Function))throw new Error(e?"Cannot create named timeout without a name":"Cannot create a timeout without a callback");this.clearTimeout(e),this._timers[e]=setTimeout(()=>{t(),this._timers[e]=null},i)}clearTimeout(e){this._timers[e]&&(clearTimeout(this._timers[e]),this._timers[e]=null)}interval(e,t,i=300){if(!(e&&t&&t instanceof Function))throw new Error(e?"Cannot create named interval without a name":"Cannot create a interval without a callback");this.clearInterval(e),this._intervals[e]=setInterval(()=>t(),i)}clearInterval(e){this._intervals[e]&&(clearInterval(this._intervals[e]),this._intervals[e]=null)}subscription(e,t){this.unsub(e),this._subscriptions[e]=t}unsub(e){this._subscriptions&&this._subscriptions[e]&&(this._subscriptions[e]instanceof v.w?this._subscriptions[e].unsubscribe():this._subscriptions[e](),this._subscriptions[e]=null)}unsubWith(e){const t=Object.keys(this._subscriptions).filter(t=>t.includes(e));for(const i of t)this.unsub(i)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var y=i(4608);function x(e,t){if(1&e&&(o.TgZ(0,"main",4),o._UZ(1,"app-icon",5),o._UZ(2,"p",6),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("icon",e.icon),o.xp6(1),o.Q6J("innerHTML",e.content,o.oJD)}}function w(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"footer",7),o.TgZ(1,"button",8),o._uU(2),o.qZA(),o.TgZ(3,"button",9),o.NdJ("click",function(){return o.CHM(e),o.oxw().onConfirm()}),o._uU(4),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(2),o.hij(" ",e.cancel_text," "),o.xp6(2),o.hij(" ",e.confirm_text," ")}}function Z(e,t){if(1&e&&(o.TgZ(0,"main",10),o.TgZ(1,"div",11),o._UZ(2,"mat-spinner",12),o.TgZ(3,"p"),o._uU(4),o.qZA(),o.qZA(),o.qZA()),2&e){const e=o.oxw();o.xp6(4),o.Oqu(e.loading)}}const C={height:"auto",width:"24em",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)"};let k=(()=>{class e{constructor(e,t){this._dialog_ref=e,this._data=t,this.event=new o.vpe,this.title=this._data.title||"Confirm",this.content=this._data.content||"Are you sure?",this.confirm_text=this._data.confirm_text||"Accept",this.cancel_text=this._data.cancel_text||"Cancel",this.icon=this._data.icon||{class:"material-icons",content:"done"},this.disableClose=()=>this._dialog_ref.disableClose=!0,this.enableClose=()=>this._dialog_ref.disableClose=!1}onConfirm(){this.event.emit({reason:"done"})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(y.so),o.Y36(y.WI))},e.\u0275cmp=o.Xpm({type:e,selectors:[["confirm-modal"]],outputs:{event:"event"},decls:7,vars:4,consts:[["mat-dialog-title",""],["class","flex flex-col items-center space-y-2 p-4",4,"ngIf","ngIfElse"],["class","flex items-center justify-center p-2 space-x-2",4,"ngIf"],["load_state",""],[1,"flex","flex-col","items-center","space-y-2","p-4"],[1,"text-5xl",3,"icon"],["content","",1,"text-center","text-sm","w-[22rem]",3,"innerHTML"],[1,"flex","items-center","justify-center","p-2","space-x-2"],["mat-button","","mat-dialog-close","",1,"inverse","w-32"],["mat-button","","name","accept",1,"w-32",3,"click"],["loading",""],[1,"w-full","h-48","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"]],template:function(e,t){if(1&e&&(o.TgZ(0,"header"),o.TgZ(1,"h3",0),o._uU(2),o.qZA(),o.qZA(),o.YNc(3,x,3,2,"main",1),o.YNc(4,w,5,2,"footer",2),o.YNc(5,Z,5,1,"ng-template",null,3,o.W1O)),2&e){const e=o.MAs(6);o.xp6(2),o.Oqu(t.title),o.xp6(1),o.Q6J("ngIf",!t.loading)("ngIfElse",e),o.xp6(1),o.Q6J("ngIf",!t.loading)}},styles:[""]}),e})(),A="APP";function T(e){A=e}function q(e,t,i,n="debug",s=!1,o=A){if(window.debug||s){const s=["color: #E91E63","color: #3F51B5","color: default"];i?console[n](`%c[${o}]%c[${e}] %c${t}`,...s,i):console[n](`%c[${o}]%c[${e}] %c${t}`,...s)}}function O(e,t){const i=e[0];return t&&i in t?e.length>1?O(e.slice(1),t[i]||{}):t[i]:null}function I(e=[],t=""){return e.filter((e,i,n)=>n.indexOf(n.find(t?i=>i[t]===e[t]:t=>t===e))===i)}function U(e,t=0){return Math.floor(Math.random()*(e-t))+t}function j(e,t){return(0,g.mG)(this,void 0,void 0,function*(){const i=t.open(k,Object.assign(Object.assign({},C),{data:e}));return Object.assign(Object.assign({},yield Promise.race([i.componentInstance.event.pipe((0,f.P)(e=>"done"===e.reason)).toPromise(),i.afterClosed().toPromise()])),{loading:e=>i.componentInstance.loading=e,close:()=>i.close()})})}function N(e,t,i,n){return e>=i&&e<n||t>i&&t<n||i>=e&&i<t||n>e&&n<=t}const M=function(e){let t=1779033703^e.length;for(let i=0;i<e.length;i++)t=Math.imul(t^e.charCodeAt(i),3432918353),t=t<<13|t>>>19;return function(){return t=Math.imul(t^t>>>16,2246822507),t=Math.imul(t^t>>>13,3266489909),(t^=t>>>16)>>>0}}("PlaceOS"),$=(L=2654435769,S=608135816,J=3084996962,E=M(),function(){let e=(L>>>=0)+(S>>>=0)|0;return L=S^S>>>9,S=(J>>>=0)+(J<<3)|0,e=e+(E=1+(E>>>=0)|0)|0,J=(J=J<<21|J>>>11)+e|0,(e>>>0)/4294967296});var L,S,J,E;function P(e=100,t=0){return Math.floor($()*(e-t))+t}function Y(){return function(){const e=(new Date).toLocaleTimeString(document.querySelector("html").getAttribute("lang")||navigator.language).toLowerCase();return e.indexOf("am")<0&&e.indexOf("pm")<0}()?"HH:mm":"h:mm a"}const Q=["control","shift","alt","meta","os"];let F=(()=>{class e{constructor(){this.keydown_states={},this.keydown_observers={},this.combo_end=[],this.registered_combos=[],this.counter=0,window.addEventListener("keydown",e=>{const t=this.mapKey((e.code||"").toLowerCase());this.last_down!==t&&(this.keydown_states[t]||(this.keydown_states[t]=new _.X(null),this.keydown_observers[t]=this.keydown_states[t].asObservable()),this.keydown_states[t].next(++this.counter),this.combo_end.indexOf(t)>=0&&e.preventDefault(),this.last_down=t)}),window.addEventListener("keyup",e=>{const t=this.mapKey((e.code||"").toLowerCase());this.keydown_states[t].next(null),this.last_down===t&&(this.last_down=null)})}listen(e,t){const i=(e=e instanceof Array?e:e.split("+")).map(e=>this.mapKey(e.toLowerCase()));if(i.length>0&&this.validCombination(i)){this.registered_combos.push(i);const e=i[i.length-1];return this.keydown_states[e]||(this.keydown_states[e]=new _.X(null),this.keydown_observers[e]=this.keydown_states[e].asObservable()),this.updateCombinationEndList(),this.keydown_observers[e].subscribe(e=>{if(e){const e=[];if(i.length>0){for(const t of i){const i=this.keydown_states[t];e.push(i&&i.getValue()||-1)}for(let t=0;t<i.length-1;t++)if(e[t]>e[t+1])return}e.reduce((e,t)=>e+(t>0?1:-1),0)>=i.length&&t()}})}return null}mapKey(e){return e.indexOf("alt")>=0||e.indexOf("shift")>=0||e.indexOf("control")>=0?e.replace("left","").replace("right",""):e}updateCombinationEndList(){for(const e of this.registered_combos)this.combo_end.push(e[e.length-1]);this.combo_end=I([])}validCombination(e){let t=0;for(const i of e)Q.indexOf(i)<0&&t++;return t>0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var D=i(4941),B=i(4441);const z={debug:!0,composer:{domain:"",route:"/bookings",protocol:"",port:"",use_domain:!1,local_login:!1},app:{name:"Bookings",title:"PlaceOS",description:"Bookings UI",short_name:"PlaceOS",logo:{type:"img",src:"assets/logo-light.svg"},logo_dark:{type:"img",src:"assets/logo-dark.svg"},general:{}}};var H=i(6817),V=i(2628),G=i(6998),R=i(9996);let X="@place.tech";class W{constructor(e={}){var t,i,n,s;this.id=e.id||"",this.name=e.name||"",this.email=e.email||"",this.first_name=e.first_name||e.name||"",this.last_name=e.last_name||"",this.phone=e.phone||"",this.organisation=e.organisation||"",this.notes=e.notes||"",this.photo=e.photo||"",this.username=e.username||"",this.organizer=!!e.organizer,this.groups=e.groups||[],this.checked_in=!!e.checked_in,this.required=null===(t=e.required)||void 0===t||t,this.response_status=e.response_status||"";const o=e.groups||[];e.sys_admin&&o.push("placeos_admin"),e.support&&o.push("placeos_support"),this.groups=o,this.extension_data=e.extension_data||{},this.extension_data.assistance_required=e.assistance_required||this.extension_data.assistance_required,this.is_external=!(null===(i=this.email)||void 0===i?void 0:i.endsWith(`${X}`)),this.visit_expected=null===(n=e.visit_expected)||void 0===n||n,this.assistance_required=!!(null===(s=this.extension_data)||void 0===s?void 0:s.assistance_required)}}class K extends W{constructor(e={}){super(e),this.preferred_beverage=e.preferred_beverage||"",this.accepted_terms_conditions=e.accepted_terms_conditions||!1}}class ee extends W{constructor(e={}){super(e),this.card_number=e.card_number||"",this.staff_id=e.staff_id||"",this.location=e.location||{},this.is_logged_in=!!e.is_logged_in}}const te=new _.X(null),ie=te.asObservable();function ne(){return te.getValue()}setTimeout(()=>{try{if(jest)return}catch(e){}(0,H.q$s)("current").pipe((0,V.g)(1e3),(0,G.X)(10),(0,R.U)(e=>new ee(e))).subscribe(e=>te.next(e))},300);let se=(()=>{class e extends b{constructor(e){super(),this._title=e,this._app_name="PlaceOS",this._overrides=new _.X([]),this._user_settings=new _.X({}),this._subjects={},this._observables={},this._pending_settings={};const t=new Date,i=new Date(1635132196646),n=(0,D.Z)(t,i)?`Today at ${(0,B.Z)(i,"h:mma")}`:(0,B.Z)(i,"do MMM yyyy, h:mma");q("CORE","null",null,"debug",!0),q("APP",`a285ed6 | Built: ${n}`,null,"debug",!0),this.init()}set overrides(e){this._overrides.next(e),this._applyCssVariables()}listen(e){return this._observables[e]||(this._subjects[e]=new _.X(null),this._observables[e]=this._subjects[e].asObservable()),this._observables[e]}post(e,t){this._observables[e]||(this._subjects[e]=new _.X(null),this._observables[e]=this._subjects[e].asObservable()),this._subjects[e].next(t)}value(e){return this._observables[e]?this._subjects[e].getValue():null}get title(){return this._title.getTitle()}set title(e){this._title.setTitle(`${e} | ${this.get("app.name")||this._app_name}`)}init(){var e;return(0,g.mG)(this,void 0,void 0,function*(){this.get("debug")&&(window.debug=!0),(null===(e=this.get("app"))||void 0===e?void 0:e.name)&&(this._app_name=this.get("app").name),this._app_name=location.pathname.slice(1).split("/").join("-")||this._app_name,T(this._app_name.split("-").join("_").toUpperCase()),q("Settings","Successfully loaded settings"),this._initialised.next(!0),window.debug&&(window.application||(window.application={}),window.application.settings=this),this.subscription("user_settings",this._user_settings.subscribe(e=>this._applyUserSettings(e)));const t=yield ie.pipe((0,f.P)(e=>!!e)).toPromise();console.log("User:",t);const i=yield(0,H.rlq)(t.id,"settings").toPromise();console.log("Data:",i),this._user_settings.next(i.details||{})})}get app_name(){return this._app_name}get(e){var t,i;const n=e.split(".");if("app"!==n[0])return null!==(i=null!==(t=O(n,this._pending_settings))&&void 0!==t?t:O(n,this._user_settings.getValue()))&&void 0!==i?i:O(n,z);const s=[...this._overrides.getValue()];for(const o of s){const e=O(n.slice(1),o);if(null!=e)return e}return O(n,z)}saveUserSetting(e,t){this._pending_settings[e]=t,this.timeout("save_settings",()=>this._savePendingChanges(),5e3)}_applyCssVariables(){const e=this.get("app.css_variables")||{};let t="body { ";for(const n in e)t+=`--${n}: ${e[n]}; `;t+="}";let i=document.getElementById("css-var-overrides");i||(i=document.createElement("style"),i.id="css-var-overrides",document.head.appendChild(i)),i.innerText=t}_savePendingChanges(){return(0,g.mG)(this,void 0,void 0,function*(){const e=ne();e&&Object.keys(this._pending_settings).length&&(yield(0,H.Ymr)(e.id,{name:"settings",description:"",details:Object.assign(Object.assign({},this._user_settings.getValue()),this._pending_settings)}))})}_applyUserSettings(e){return(0,g.mG)(this,void 0,void 0,function*(){e.dark_mode?document.body.classList.add("dark"):document.body.classList.remove("dark"),e.font_size&&(document.body.style.fontSize=`${e.font_size}px`)})}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(s.Dx))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var oe=i(709);function ae(e){let t="";if(e)for(const i in e)e.hasOwnProperty(i)&&null!=e[i]&&(t+=`${t?"&":""}${i}=${e[i]}`);return t}let re,le,ce,ue;function de(e,t,i="OK",n,s={}){if(!re)throw new Error("Snackbar service hasn't been initialised");const o=re.open(t,i,Object.assign({panelClass:[e],duration:5e3},s));i&&(n=n||(()=>o.dismiss()),o.onAction().subscribe(()=>n()))}function pe(e,t,i,n={}){console.debug(e),de("success",e,t,i,n)}function he(e,t,i,n={}){console.error(e),de("error",e,t,i,n)}function me(e,t,i,n={}){console.info(e),de("info",e,t,i,n)}(0,oe.X$)("show",[(0,oe.eR)(":enter",[(0,oe.oB)({opacity:0,height:0}),(0,oe.jt)(300,(0,oe.oB)({opacity:1,height:"*"}))]),(0,oe.eR)(":leave",[(0,oe.oB)({opacity:1,height:"*"}),(0,oe.jt)(300,(0,oe.oB)({opacity:0,height:0}))])]),(0,oe.X$)("show",[(0,oe.SB)("show",(0,oe.oB)({opacity:1,height:"*"})),(0,oe.SB)("hide",(0,oe.oB)({opacity:0,height:0,"pointer-events":"none"})),(0,oe.eR)("show <=> hide",(0,oe.jt)("200ms ease-in"))]);class ge{constructor(e={}){var t;this.settings={},this.id=e.id||"",this.parent_id=e.parent_id||"",this.name=e.name||"",this.display_name=e.display_name||"",this.map_id=e.map_id||"",this.capacity=e.capacity||0,this.locations=e.locations||[];const i=this.display_name.split(" ");this.number=(null===(t=i.length>=2?i[i.length-1]:this.display_name[0])||void 0===t?void 0:t.toUpperCase())||""}}class fe{constructor(e={}){this.id=e.id||"",this.name=e.name||"",this.description=e.description||"",this.tags=e.tags||[],this.count=e.count||0,this.capacity=e.capacity||0,this.bindings=e.bindings||{},this._settings=e.settings||{}}setting(e){return O(e.split("."),this._settings)}}var _e=i(3080);class ve{constructor(e={}){this.id=e.id||"",this.name=e.name||"";const t=e.settings||{};this.display_name=e.display_name;const i=t.discovery_info||t;this.zone_id=e.zone_id||e.zone,this.extras=(e.extras||i.extras||[]).map(e=>({id:e.extra_id||e.id,name:e.extra_name||e.name})),this.loan_items=(e.loan_items||i.loan_items||[]).map(e=>({id:e.extra_id||e.id,name:e.extra_name||e.name})),this.levels=(e.levels||i.levels||[]).map(e=>new ge(Object.assign(Object.assign({},e),{building_id:this.id}))),this._roles=e.roles||i.roles||{},this._lockers=e.lockers||e.locker_structure||i.locker_structure||{},this._systems=e.systems||i.systems||{},this._phone_numbers=e.phone_numbers||i.phone_numbers||{},this._location=e.location||i.location||{longitude:null,latitude:null},this.room_configurations=e.room_configurations||i.room_configurations||[],this.attributes=e.attributes||i.attributes||[];const n=[];if(e.neighbourhoods)for(const s in e.neighbourhoods)if(s in e.neighbourhoods){const t=e.neighbourhoods[s]||{};for(const e in t)e in t&&n.push({id:t[e],name:e,level_id:s})}this.bindings=e.bindings||{},this.searchables=n,this.timezone=e.timezone||i.timezone||t.timezone||"",this.catering_hours=e.catering_hours||i.catering_hours||t.catering_hours||{start:7,end:20},this.visitor_space=e.visitor_space||i.visitor_space||t.visitor_space||"",this.holding_bay=e.holding_bay||i.holding_bay||t.holding_bay||"",this.code=e.code||i.code||t.code||"",this.address=e.address||i.address||t.address||"",this.orientations=e.orientations||i.orientations||t.orientations||{},this.booking_details=e.booking_details||i.booking_details||t.booking_details||null,this.booking_rules=e.booking_rules||i.booking_rules||t.booking_rules||{},this.catering_restricted_from=e.catering_restricted_from||i.catering_restricted_from||t.catering_restricted_from||-1440,this.currency=e.currency||i.currency||t.currency||"USD"}role(e){return[...this._roles[e]||[]]}get role_names(){return Object.keys(this._roles).filter(e=>e in this._roles)}get lockers(){return Object.assign({},this._lockers||{})}get systems(){return Object.assign({},this._systems||{})}get phone_numbers(){return Object.assign({},this._phone_numbers||{})}featuresForLevel(e){return(this.searchables||[]).filter(t=>t.level_id===e)}}let be=(()=>{class e{constructor(e,t){this._service=e,this._router=t,this._initialised=new _.X(!1),this.initialised=this._initialised.asObservable(),this._buildings=new _.X([]),this._active_building=new _.X(null),this._levels=new _.X([]),this.building_list=this._buildings.asObservable(),this.level_list=this._levels.asObservable(),this.active_building=this._active_building.asObservable(),this.active_levels=(0,_e.aj)([this._levels,this._active_building]).pipe((0,R.U)(([e,t])=>t?this.levelsForBuilding(t):[])),this._settings=[],this._building_settings={},(0,H.ttN)().pipe((0,f.P)(e=>e)).subscribe(()=>setTimeout(()=>this.init(),1e3)),this.active_building.subscribe(e=>{e&&(this._service.overrides=[...this._settings,this.buildingSettings(e.id)])})}get settings(){return this._settings}get building_settings(){return this._building_settings}buildingSettings(e=""){return!e&&this.building&&(e=this.building.id),this._building_settings&&this._building_settings[e]||{}}get organisation(){return this._organisation}get buildings(){return this._buildings.getValue()}get building(){return this._active_building.getValue()}set building(e){this._active_building.next(e),this._service.overrides=[...this._settings,this.buildingSettings(e.id).details]}find(e){return this.buildings.find(t=>t.id===e)}get levels(){return this._levels.getValue()}levelWithID(e){return this.levels.find(t=>null==e?void 0:e.includes(t.id))}levelsForBuilding(e){return this.levels.filter(t=>t.parent_id===e.id)}init(e=0){return(0,g.mG)(this,void 0,void 0,function*(){this._initialised.next(!1),yield this.load().catch(t=>{throw he("Error loading organisation data. Retrying..."),setTimeout(()=>this.init(e),Math.min(1e4,300*++e)),t}),this._initialised.next(!0),window.debug&&(window.application||(window.application={}),window.application.orgs=this)})}load(){return(0,g.mG)(this,void 0,void 0,function*(){yield this.loadOrganisation(),yield this.loadBuildings(),yield this.loadLevels(),yield this.loadSettings()})}loadOrganisation(){var e;return(0,g.mG)(this,void 0,void 0,function*(){const t=yield(0,H.I0G)({tags:"org"}).pipe((0,R.U)(e=>e.data)).toPromise();if(t.length){const i=(0,H.N9E)(),n=t.find(e=>{var t;return(0,H.y7C)()||e.id===(null===(t=null==i?void 0:i.config)||void 0===t?void 0:t.org_zone)})||t[0],s=null===(e=yield(0,H.rlq)(n.id,"bindings").toPromise())||void 0===e?void 0:e.details;this._organisation=new fe(Object.assign(Object.assign({},n),{bindings:s}))}else this._router.navigate(["/misconfigured"])})}loadBuildings(){var e,t;return(0,g.mG)(this,void 0,void 0,function*(){const i=yield(0,H.I0G)({tags:"building",limit:500}).pipe((0,R.U)(e=>e.data.filter(e=>{var t;return e.parent_id===(null===(t=this._organisation)||void 0===t?void 0:t.id)}))).toPromise();(null==i?void 0:i.length)||this._router.navigate(["/misconfigured"]);const n=[];for(const t of i){const i=null===(e=yield(0,H.rlq)(t.id,"bindings").toPromise())||void 0===e?void 0:e.details;n.push(new ve(Object.assign(Object.assign({},t),{bindings:i})))}this._buildings.next(n);const s=localStorage.getItem("PLACEOS.building");s&&this.buildings.find(e=>e.id===s)&&this._active_building.next(this.buildings.find(e=>e.id===s)),!(null===(t=this.building)||void 0===t?void 0:t.id)&&(null==n?void 0:n.length)>0&&(this.building=n[0])})}loadLevels(){return(0,g.mG)(this,void 0,void 0,function*(){const e=yield(0,H.I0G)({tags:"level",limit:2500}).pipe((0,R.U)(e=>e.data)).toPromise();(null==e?void 0:e.length)||this._router.navigate(["/misconfigured"]);const t=e.map(e=>new ge(e));t.sort((e,t)=>(e.name||"").localeCompare(t.name||"")),this._levels.next(t)})}get available_room_configs(){return this.buildings.map(e=>[...e.room_configurations]).reduce((e,t)=>e.concat(t),[]).sort((e,t)=>e.name.localeCompare(t.name))}loadSettings(){return(0,g.mG)(this,void 0,void 0,function*(){if(!this._organisation)return;const e=`${(this._service.get("app.name")||"workplace").toLowerCase()}_app`,t=yield(0,H.rlq)(this._organisation.id,e).toPromise(),i=yield(0,H.rlq)(this._organisation.id,"settings").toPromise();this._settings=[i.details,t.details];const n=this.buildings;for(const s of n)this._building_settings[s.id]=yield(0,H.rlq)(s.id,e).toPromise();this._service.overrides=[...this._settings,this.buildingSettings(this.building.id).details]})}saveBuilding(e){localStorage.setItem("PLACEOS.building",e)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(se),o.LFG(c.F0))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ye=i(1511),xe=i(5980),we=i(8055),Ze=i(4786),Ce=i(5812),ke=i(33),Ae=i(7806),Te=i(1391),qe=i(1522),Oe=i(3005),Ie=i(531),Ue=i(6899);let je=(()=>{class e extends b{constructor(e,t){super(),this._element=e,this._renderer=t,this.index=1,this.params=[],this.modelChange=new o.vpe}ngOnInit(){var e;null===(e=(0,H.ttN)())||void 0===e||e.pipe((0,f.P)(e=>e)).subscribe(e=>this.bindVariable())}ngOnChanges(e){(e.sys||e.mod||e.bind)&&this.bindVariable(),e.model&&e.model.previousValue!==this.model&&null!=this.model&&this.execute(),e.on_event&&this.on_event&&this.subscription("on_event",this._renderer.listen(this._element.nativeElement,this.on_event,()=>this.execute()))}bindVariable(){if((0,H.N9E)()&&this.bind&&this.sys&&this.mod){const e=(0,H.rTZ)(this.sys,this.mod,this.index).binding(this.bind);this.subscription("binding",e.bind()),this.subscription("on_changes",e.listen().subscribe(e=>setTimeout(()=>{this.model=e,this.modelChange.emit(this.model)},10)))}}execute(){if((0,H.N9E)()&&this.exec&&this.sys&&this.mod){const e=(0,H.rTZ)(this.sys,this.mod,this.index);this.bind&&(this.params=[this.model]),e.execute(this.exec,this.params).then(e=>{this.bind||(this.model=e,this.modelChange.emit(this.model))})}}writeValue(e){this.model=e,this.modelChange.emit(this.model),this.execute()}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(o.SBq),o.Y36(o.Qsj))},e.\u0275dir=o.lG2({type:e,selectors:[["i","bind",""],["","binding",""],["co-bind"]],inputs:{sys:"sys",mod:"mod",index:"index",bind:"bind",exec:"exec",on_event:["onEvent","on_event"],params:"params",model:"model"},outputs:{modelChange:"modelChange"},features:[o.qOj,o.TTD]}),e})();function Ne(e,t){if(1&e&&(o.TgZ(0,"div"),o.TgZ(1,"app-icon"),o._uU(2),o.qZA(),o.qZA()),2&e){const e=o.oxw();o.Tol("state center "+e.state),o.xp6(2),o.hij(" ","success"===e.state?"done":"close"," ")}}function Me(e,t){1&e&&(o.TgZ(0,"div",4),o._UZ(1,"mat-spinner",5),o.qZA()),2&e&&(o.xp6(1),o.Q6J("diameter",16))}const $e=["*"];let Le=(()=>{class e{constructor(){this.className="material-icons",this.state=""}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["action-icon"]],inputs:{icon:"icon",className:"className",content:"content",loading:"loading",disabled:"disabled",state:"state"},ngContentSelectors:$e,decls:6,vars:8,consts:[["mat-icon-button","",1,"relative","flex","items-center","justify-center","h-8","w-8",3,"disabled"],["root","",3,"className","icon"],[3,"class",4,"ngIf"],["class","loader center",4,"ngIf"],[1,"loader","center"],[3,"diameter"]],template:function(e,t){1&e&&(o.F$t(),o.TgZ(0,"button",0),o.TgZ(1,"app-icon",1),o._uU(2),o.Hsn(3),o.qZA(),o.YNc(4,Ne,3,3,"div",2),o.YNc(5,Me,2,1,"div",3),o.qZA()),2&e&&(o.ekj("success","success"===t.state),o.Q6J("disabled",t.loading||t.disabled),o.xp6(1),o.Q6J("className",t.className)("icon",t.icon),o.xp6(1),o.hij(" ",t.content," "),o.xp6(2),o.Q6J("ngIf",!t.loading&&t.state),o.xp6(1),o.Q6J("ngIf",t.loading))},styles:[".action-icon.fade[_ngcontent-%COMP%] > app-icon[_ngcontent-%COMP%]{opacity:.35}[center][_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.success[_ngcontent-%COMP%]{pointer-events:none}.success[_ngcontent-%COMP%]   app-icon[root][_ngcontent-%COMP%]{opacity:.2}.state.success[_ngcontent-%COMP%]{color:#388e3c}.state.error[_ngcontent-%COMP%]{color:#e53935}"]}),e})(),Se=(()=>{class e{constructor(e){this.sanitizer=e}transform(e,t="html"){switch(t){case"resource":return this.sanitizer.bypassSecurityTrustResourceUrl(e);case"url":return this.sanitizer.bypassSecurityTrustUrl(e);case"script":return this.sanitizer.bypassSecurityTrustScript(e);case"style":return this.sanitizer.bypassSecurityTrustStyle(e);default:return this.sanitizer.bypassSecurityTrustHtml(e)}}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(s.H7,16))},e.\u0275pipe=o.Yjl({name:"safe",type:e,pure:!0}),e})();function Je(e,t){if(1&e&&(o.TgZ(0,"i"),o._uU(1),o.Hsn(2),o.qZA()),2&e){const e=o.oxw();o.Tol((null==e.icon?null:e.icon.class)||e.className),o.xp6(1),o.hij(" ",null==e.icon?null:e.icon.content," ")}}function Ee(e,t){if(1&e&&(o._UZ(0,"img",3),o.ALo(1,"safe")),2&e){const e=o.oxw();o.Q6J("src",o.xi3(1,1,e.icon.src,"resource"),o.LSH)}}const Pe=["*"];let Ye=(()=>{class e{constructor(){this.className="material-icons"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-icon"]],inputs:{className:"className",icon:"icon"},ngContentSelectors:Pe,decls:3,vars:2,consts:[[1,"app-icon"],[3,"class",4,"ngIf"],[3,"src",4,"ngIf"],[3,"src"]],template:function(e,t){1&e&&(o.F$t(),o.TgZ(0,"div",0),o.YNc(1,Je,3,3,"i",1),o.YNc(2,Ee,2,4,"img",2),o.qZA()),2&e&&(o.xp6(1),o.Q6J("ngIf",!t.icon||"img"!==t.icon.type),o.xp6(1),o.Q6J("ngIf",t.icon&&"img"===t.icon.type))},directives:[ye.O5],pipes:[Se],styles:[".app-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:1.25em;width:1.25em}i[_ngcontent-%COMP%]{font-size:1em}img[_ngcontent-%COMP%]{height:1em;width:1em}"]}),e})();function Qe(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",2),o.NdJ("click",function(){const t=o.CHM(e).$implicit,i=o.oxw();return i.action.emit(t.id),i.show=!1}),o._UZ(1,"app-icon",3),o.qZA()}if(2&e){const e=t.$implicit,i=t.index,n=o.oxw();o.Udp("top",n.show?-110*i-60+"%":""),o.xp6(1),o.Q6J("icon",e)}}let Fe=(()=>{class e extends b{constructor(){super(...arguments),this.actions=[],this.action=new o.vpe}close(){this.timeout("close",()=>this.show=!1)}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=o.n5z(e)))(i||e)}}(),e.\u0275cmp=o.Xpm({type:e,selectors:[["a-popout-menu"]],inputs:{actions:"actions"},outputs:{action:"action"},features:[o.qOj],decls:4,vars:4,consts:[["mat-icon-button","","class","small absolute text-base center shadow",3,"top","click",4,"ngFor","ngForOf"],["name","root","mat-icon-button","",3,"click"],["mat-icon-button","",1,"small","absolute","text-base","center","shadow",3,"click"],[3,"icon"]],template:function(e,t){1&e&&(o.YNc(0,Qe,2,3,"button",0),o.TgZ(1,"button",1),o.NdJ("click",function(){return t.show=!t.show})("click",function(){return t.show?t.close():""},!1,o.Jf7),o.TgZ(2,"app-icon"),o._uU(3),o.qZA(),o.qZA()),2&e&&(o.Q6J("ngForOf",t.actions),o.xp6(1),o.ekj("show",t.show),o.xp6(2),o.Oqu(t.show?"add":"more_vert"))},styles:["[_nghost-%COMP%]{position:relative}app-icon[_ngcontent-%COMP%]{transition:transform .2s}button[_ngcontent-%COMP%]{background-color:#fff;color:rgba(#000,.85);font-size:1.25rem;height:2.5em;width:2.5em}button.show[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{transform:rotate(45deg)}button.small[_ngcontent-%COMP%]{transition:top .2s,left .2s}"]}),e})();i(5768);const De=new o.OlP("Data for Map Features");function Be(e,t){1&e&&(o.ynx(0),o.Hsn(1),o.BQk())}i(4245);const ze=function(e){return[e]};function He(e,t){if(1&e&&(o.TgZ(0,"a",8),o._uU(1),o.qZA()),2&e){const e=t.$implicit;o.Q6J("routerLink",o.VKq(2,ze,e.route)),o.xp6(1),o.hij(" ",e.name," ")}}function Ve(e,t){if(1&e&&(o.ynx(0),o.TgZ(1,"div",4),o.TgZ(2,"app-icon"),o._uU(3),o.qZA(),o.qZA(),o.TgZ(4,"div",5),o.YNc(5,Be,2,0,"ng-container",1),o.qZA(),o.TgZ(6,"div",6),o.YNc(7,He,2,4,"a",7),o.qZA(),o.BQk()),2&e){const e=o.oxw(),t=o.MAs(3);o.xp6(1),o.ekj("text-success",!e.error)("text-error",e.error),o.xp6(2),o.Oqu(e.error?"close":"done"),o.xp6(2),o.Q6J("ngIf",!e.error)("ngIfElse",t),o.xp6(2),o.Q6J("ngForOf",e.links)}}function Ge(e,t){if(1&e&&(o.TgZ(0,"p",9),o._uU(1),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Oqu(e.error)}}function Re(e,t){if(1&e&&(o._UZ(0,"mat-spinner",10),o.TgZ(1,"p",11),o._uU(2),o.qZA()),2&e){const e=o.oxw();o.Q6J("diameter",32),o.xp6(2),o.Oqu(e.loading)}}const Xe=["*"];let We=(()=>{class e{constructor(){this.loading="",this.error="",this.links=[]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["status-overlay"]],inputs:{loading:"loading",error:"error",links:"links"},ngContentSelectors:Xe,decls:6,vars:2,consts:[["status-overlay","",1,"fixed","inset-0","flex","flex-col","bg-secondary","items-center","justify-center","z-50","text-white"],[4,"ngIf","ngIfElse"],["error_msg",""],["load_state",""],[1,"text-4xl","rounded-full","bg-white","mb-4"],[1,"text-center","text-lg","mb-4"],[1,"flex","items-center","space-x-2"],["button","","mat-button","","class","w-32",3,"routerLink",4,"ngFor","ngForOf"],["button","","mat-button","",1,"w-32",3,"routerLink"],["error",""],[1,"mb-4",3,"diameter"],["loading","",1,"text-center","text-lg"]],template:function(e,t){if(1&e&&(o.F$t(),o.TgZ(0,"div",0),o.YNc(1,Ve,8,8,"ng-container",1),o.qZA(),o.YNc(2,Ge,2,1,"ng-template",null,2,o.W1O),o.YNc(4,Re,3,2,"ng-template",null,3,o.W1O)),2&e){const e=o.MAs(5);o.xp6(1),o.Q6J("ngIf",!t.loading)("ngIfElse",e)}},styles:[""]}),e})();var Ke=i(8623);i(3241),i(8318);var et=i(2522);const tt=["keyboard",""];function it(e,t){if(1&e&&o._UZ(0,"div",7),2&e){const e=o.oxw(4);o.ekj("bg-success","shift"===e.state)}}function nt(e,t){if(1&e){const e=o.EpF();o.ynx(0),o.TgZ(1,"div",5),o.NdJ("focus",function(){return o.CHM(e),o.oxw(3).focusInput()})("click",function(){const t=o.CHM(e).$implicit;return o.oxw(3).handleKeyPress(t)}),o._uU(2),o.YNc(3,it,1,2,"div",6),o.qZA(),o.BQk()}if(2&e){const e=t.$implicit;o.xp6(1),o.ekj("special","{"===e[0]&&e.length>1)("space","{space}"===e),o.uIk("key",e),o.xp6(1),o.hij(" ","{space}"===e?"Space":"{caps}"===e?"Caps Lock":"{backspace}"===e?"Backspace":e," "),o.xp6(1),o.Q6J("ngIf","{caps}"===e)}}function st(e,t){if(1&e&&(o.TgZ(0,"div",3),o.YNc(1,nt,4,7,"ng-container",4),o.qZA()),2&e){const e=t.$implicit;o.xp6(1),o.Q6J("ngForOf",e)}}function ot(e,t){if(1&e&&(o.TgZ(0,"div",1),o.YNc(1,st,2,1,"div",2),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("ngForOf",e.keyset)}}const at=["*"],rt=["0123456789".split(""),"qwertyuiop".split(""),"asdfghjkl".split(""),"zxcvbnm".split(""),["{caps}","{space}","{backspace}"]];let lt=(()=>{class e extends b{constructor(t,i){super(),this._element=t,this._overlay=i,this.keyset=rt,this.state="normal",this._overlay_ref=null,this.onFocus=()=>{e.enabled&&(this.open(),this.clearTimeout("blur"))},this.onBlur=()=>this.timeout("blur",()=>this.close())}ngOnDestroy(){super.ngOnDestroy(),this.close()}focusInput(){var e,t,i,n;null===(t=null===(e=this._element)||void 0===e?void 0:e.nativeElement)||void 0===t||t.blur(),null===(n=null===(i=this._element)||void 0===i?void 0:i.nativeElement)||void 0===n||n.focus()}open(){this._overlay_ref||this._portal&&(this._overlay_ref=this._overlay.create({positionStrategy:this._overlay.position().global().bottom().centerHorizontally()}),this._overlay_ref.attach(this._portal))}close(){this._overlay_ref&&(this._overlay_ref.dispose(),this._overlay_ref=null)}handleKeyPress(e){let t=this._element.nativeElement.selectionStart;const i=this._element.nativeElement.value||"";switch(e.toLowerCase()){case"{caps}":case"{shift}":this.state="shift";break;case"{backspace}":this._element.nativeElement.value=`${i.substr(0,t-1)}${i.substr(t,i.length)}`,t=Math.max(0,t-1);break;case"{space}":this._element.nativeElement.value=`${i.substr(0,t)} ${i.substr(t,i.length)}`,t+=1;break;default:"shift"===this.state&&(this.state="normal"),this._element.nativeElement.value=`${i.substr(0,t)}${e}${i.substr(t,i.length)}`,t+=1}this._element.nativeElement.dispatchEvent(new InputEvent("input")),this.updateKeyState(),this.timeout("focus",()=>{this.focusInput(),this._element.nativeElement.selectionStart=t,this._element.nativeElement.selectionEnd=t},50)}updateKeyState(){this.keyset=this.keyset.map(e=>e.map(e=>e.length>1?e:e["normal"!==this.state?"toUpperCase":"toLowerCase"]()))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(o.SBq),o.Y36(et.aV))},e.\u0275cmp=o.Xpm({type:e,selectors:[["input","keyboard",""],["textarea","keyboard",""]],viewQuery:function(e,t){if(1&e&&o.Gf(Ue.ig,5),2&e){let e;o.iGM(e=o.CRH())&&(t._portal=e.first)}},hostBindings:function(e,t){1&e&&o.NdJ("focus",function(){return t.onFocus()})("blur",function(){return t.onBlur()})},inputs:{keyset:"keyset"},features:[o.qOj],attrs:tt,ngContentSelectors:at,decls:2,vars:0,consts:[["cdk-portal",""],["keyboard","",1,"w-screen","flex","flex-col","space-y-4","bg-gray-200","p-2","border-t","border-gray-400"],["row","","class","flex items-center justify-center space-x-2",4,"ngFor","ngForOf"],["row","",1,"flex","items-center","justify-center","space-x-2"],[4,"ngFor","ngForOf"],["tabindex","0",1,"rounded-xl","p-2","border","border-gray-300","relative","cursor-pointer","bg-white",3,"focus","click"],["dot","","class","absolute top-2 right-2 h-2 w-2 rounded-full bg-gray-300",3,"bg-success",4,"ngIf"],["dot","",1,"absolute","top-2","right-2","h-2","w-2","rounded-full","bg-gray-300"]],template:function(e,t){1&e&&(o.F$t(),o.Hsn(0),o.YNc(1,ot,2,1,"ng-template",0))},directives:[Ue.bH,ye.sg,ye.O5],styles:["[key][_ngcontent-%COMP%]{height:3.5rem;width:4rem;transition:box-shadow .2s,top .2s;box-shadow:0 4px 0 .04px rgba(0,0,0,.1)}[key].special[_ngcontent-%COMP%]{width:10rem}[key].space[_ngcontent-%COMP%]{flex:1;min-width:10rem;max-width:25rem}[key][_ngcontent-%COMP%]:hover{top:2px;box-shadow:0 2px 0 .04px rgba(0,0,0,.1)}[key][_ngcontent-%COMP%]:active{top:4px;box-shadow:0 0 0 .04px rgba(0,0,0,.1)}"]}),e})();class ct{constructor(e={}){this.id=e.id||"",this.name=e.name||"",this.display_name=e.display_name||"",this.email=(e.email||"").toLowerCase(),this.capacity=e.capacity||-1,this.feature_list=e.feature_list||e.features||[],this.bookable=!!e.bookable,this.zones=e.zones||[],this.support_url=e.support_url||"",this.map_id=e.map_id||"",this.image=e.image||"",this.configurations=e.configurations||[],this.features=e.features||[],this.response_status=e.response_status,this.level=e.level||new ge,this.availability=e.availability||[]}}let ut=(()=>{class e{constructor(e){this._org=e,this._list=new _.X([]),this._initialised=new _.X(!1),this.initialised=this._initialised.asObservable(),this.list=this._list.asObservable(),this._compare=e=>e.zones.includes(this._org.building.id),this._org.initialised.pipe((0,f.P)(e=>e)).subscribe(()=>this.loadSpaces())}get space_list(){return this._list.getValue()}filter(e=this._compare){return this._list.getValue().filter(t=>e(t))}find(e){return this._list.getValue().find(t=>t.id===e||t.email===e)}loadSpaces(){return(0,g.mG)(this,void 0,void 0,function*(){const e=(yield(0,H.vIL)({zone_id:this._org.organisation.id,limit:5e3}).pipe((0,R.U)(e=>e.data)).toPromise()).map(e=>new ct(Object.assign(Object.assign({},e),{level:this._org.levelWithID([...e.zones])}))).filter(e=>e.map_id);this._list.next(e),this._initialised.next(!0)})}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(be))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function dt(e,t){1&e&&(o.TgZ(0,"div",2),o._uU(1," Unable to reach server... Some features may not work. "),o.qZA())}function pt(e,t){1&e&&(o.TgZ(0,"div",3),o._UZ(1,"mat-spinner",4),o.qZA()),2&e&&(o.xp6(1),o.Q6J("diameter",64))}let ht=(()=>{class e{constructor(e,t){this._org=e,this._spaces=t}get online(){return(0,H.Ggh)()}ngOnInit(){return(0,g.mG)(this,void 0,void 0,function*(){this.loading=!0,yield this._org.initialised.pipe((0,f.P)(e=>e)).toPromise(),yield this._spaces.initialised.pipe((0,f.P)(e=>e)).toPromise(),setTimeout(()=>this.loading=!1,300)})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(be),o.Y36(ut))},e.\u0275cmp=o.Xpm({type:e,selectors:[["global-loading"]],decls:2,vars:2,consts:[["class","fixed bottom-2 left-1/2 -translate-x-1/2 shadow rounded-3xl px-4 py-2 bg-error text-white text-xs",4,"ngIf"],["loader","","class","fixed inset-0 flex items-center justify-center pointer-events-auto bg-white",4,"ngIf"],[1,"fixed","bottom-2","left-1/2","-translate-x-1/2","shadow","rounded-3xl","px-4","py-2","bg-error","text-white","text-xs"],["loader","",1,"fixed","inset-0","flex","items-center","justify-center","pointer-events-auto","bg-white"],[3,"diameter"]],template:function(e,t){1&e&&(o.YNc(0,dt,2,0,"div",0),o.YNc(1,pt,2,1,"div",1)),2&e&&(o.Q6J("ngIf",!t.online),o.xp6(1),o.Q6J("ngIf",t.loading))},directives:[ye.O5,Ae.$g],styles:["[_nghost-%COMP%]{pointer-events:none}[_nghost-%COMP%] > [loader][_ngcontent-%COMP%]{z-index:9999;background-image:url(\"data:image/svg+xml,%3Csvg width='36' height='36' viewBox='0 0 36 36' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M36 0H0v36h36V0zM15.126 2H2v13.126c.367.094.714.24 1.032.428L15.554 3.032c-.188-.318-.334-.665-.428-1.032zM18 4.874V18H4.874c-.094-.367-.24-.714-.428-1.032L16.968 4.446c.318.188.665.334 1.032.428zM22.874 2h11.712L20 16.586V4.874c1.406-.362 2.512-1.468 2.874-2.874zm10.252 18H20v13.126c.367.094.714.24 1.032.428l12.522-12.522c-.188-.318-.334-.665-.428-1.032zM36 22.874V36H22.874c-.094-.367-.24-.714-.428-1.032l12.522-12.522c.318.188.665.334 1.032.428zm0-7.748V3.414L21.414 18h11.712c.362-1.406 1.468-2.512 2.874-2.874zm-18 18V21.414L3.414 36h11.712c.362-1.406 1.468-2.512 2.874-2.874zM4.874 20h11.712L2 34.586V22.874c1.406-.362 2.512-1.468 2.874-2.874z' fill='%23000000' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E\")}"]}),e})();function mt(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",1),o.TgZ(1,"div",2),o._uU(2),o.qZA(),o.TgZ(3,"button",3),o.NdJ("click",function(){return o.CHM(e),o.oxw().close()}),o.TgZ(4,"app-icon"),o._uU(5,"close"),o.qZA(),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.ekj("bg-blue-600","info"===e.banner.type||!e.banner.type)("bg-pending","warn"===e.banner.type)("bg-error","error"===e.banner.type),o.xp6(2),o.Oqu(null==e.banner?null:e.banner.content)}}let gt=(()=>{class e{constructor(e){this._settings=e,console.log("Banner:",this.banner)}get has_viewed(){var e;return!(null===(e=this.banner)||void 0===e?void 0:e.content)||localStorage.getItem("PLACE.last_banner")===this.banner.id}get banner(){return this._settings.get("app.general.banner")}close(){var e;localStorage.setItem("PLACE.last_banner",(null===(e=this.banner)||void 0===e?void 0:e.id)||"")}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(se))},e.\u0275cmp=o.Xpm({type:e,selectors:[["global-banner"]],decls:1,vars:1,consts:[["class","flex items-center w-full text-white p-4 space-x-4",3,"bg-blue-600","bg-pending","bg-error",4,"ngIf"],[1,"flex","items-center","w-full","text-white","p-4","space-x-4"],[1,"flex-1"],["mat-icon-button","",3,"click"]],template:function(e,t){1&e&&o.YNc(0,mt,6,7,"div",0),2&e&&o.Q6J("ngIf",!t.has_viewed)},styles:["[_nghost-%COMP%]{display:block;width:100%}"]}),e})();const ft=[p.Bb,we.Tx,h.lN,Ze.LD,xe.ot,p.Bb,Ze.LD,y.Is,Ce.FA,m.c,Te.Iq,Ae.Cq,ke.Hi,Oe.TU,Ie.HT,Ue.eL,Ke.JX];let _t=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({providers:[{provide:qe.Ad,useValue:"en-GB"},{provide:De,useValue:{}}],imports:[[ye.ez,l.u5,l.UX,...ft],p.Bb,we.Tx,h.lN,Ze.LD,xe.ot,p.Bb,Ze.LD,y.Is,Ce.FA,m.c,Te.Iq,Ae.Cq,ke.Hi,Oe.TU,Ie.HT,Ue.eL,Ke.JX]}),e})();function vt(e,t){if(1&e&&(o.TgZ(0,"div",8),o.TgZ(1,"app-icon"),o._uU(2,"account_circle"),o.qZA(),o.TgZ(3,"div"),o._uU(4),o.qZA(),o.qZA()),2&e){const e=o.oxw(2);o.xp6(4),o.Oqu(e.space.capacity)}}function bt(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",9),o.NdJ("click",function(){return o.CHM(e),o.oxw(2).action.emit()}),o.TgZ(1,"app-icon"),o._uU(2),o.qZA(),o.qZA()}if(2&e){const e=o.oxw(2);o.xp6(2),o.Oqu("available"===e.type?"add":"close")}}function yt(e,t){if(1&e&&(o.TgZ(0,"div",2),o.TgZ(1,"div",3),o.TgZ(2,"div",4),o._uU(3),o.qZA(),o.TgZ(4,"div",5),o._uU(5),o.qZA(),o.qZA(),o.YNc(6,vt,5,1,"div",6),o.YNc(7,bt,3,1,"button",7),o.qZA()),2&e){const e=o.oxw(),t=o.MAs(2);o.xp6(3),o.Oqu(e.space.name),o.xp6(2),o.hij(" ",(null==e.space.level?null:e.space.level.display_name)||(null==e.space.level?null:e.space.level.name)," "),o.xp6(1),o.Q6J("ngIf",-1!==e.space.capacity),o.xp6(1),o.Q6J("ngIf",e.multiple)("ngIfElse",t)}}function xt(e,t){if(1&e&&(o.TgZ(0,"button",10),o._uU(1),o.qZA()),2&e){const e=o.oxw();o.ekj("request",e.space.by_request),o.xp6(1),o.hij(" ",e.space.by_request?"Request":"Book"," ")}}o.B6R(Le,[xe.lW,Ye,ye.O5,Ae.$g],[]),o.B6R(Fe,[ye.sg,xe.lW,Ye],[]),o.B6R(k,[y.uh,ye.O5,Ye,xe.lW,y.ZT,Ae.$g],[]),o.B6R(We,[ye.O5,Ye,ye.sg,xe.zs,Ae.$g],[]),o.B6R(gt,[ye.O5,xe.lW,Ye],[]);let wt=(()=>{class e{constructor(){this.action=new o.vpe}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["a-space-select-item"]],inputs:{space:"space",type:"type",multiple:"multiple"},outputs:{action:"action"},decls:3,vars:1,consts:[["space","","class","w-full flex items-center p-2 space-x-2 border-b border-gray-100",4,"ngIf"],["single_button",""],["space","",1,"w-full","flex","items-center","p-2","space-x-2","border-b","border-gray-100"],[1,"flex-1","w-1/2"],[1,"text-base","truncate"],[1,"text-xs"],["class","flex items-center",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf","ngIfElse"],[1,"flex","items-center"],["mat-icon-button","",3,"click"],["mat-button","",1,"w-32"]],template:function(e,t){1&e&&(o.YNc(0,yt,8,5,"div",0),o.YNc(1,xt,2,3,"ng-template",null,1,o.W1O)),2&e&&o.Q6J("ngIf",t.space)},styles:[""]}),e})();var Zt=i(4689),Ct=i(8303),kt=i(4019),At=i(4914),Tt=i(804),qt=i(9310),Ot=i(8774);const It={month:43200,months:43200,week:10080,weeks:10080,day:1440,days:1440,hour:60,hours:60,minute:1,minutes:1},Ut={auto_approve:!0,hidden:!1};function jt(e){const t=(e||"").split(" ");return t.length>1?+t[0]*It[t[1]]:0}function Nt(e,t=new Date){return(0,Tt.Z)(t,jt(e))}function Mt({date:e,duration:t,host:i},n){let s=0;const{conditions:o}=n;return!o||(o.groups instanceof Array&&o.groups.every(e=>{var t;return null===(t=null==i?void 0:i.groups)||void 0===t?void 0:t.includes(e)})&&(s+=1),o.is_before&&(0,qt.Z)((0,Tt.Z)(e,t),Nt(o.is_before))&&(s+=1),o.is_after&&(0,Ot.Z)(e,Nt(o.is_after))&&(s+=1),o.min_length&&jt(o.min_length)<=t&&(s+=1),o.max_length&&jt(o.max_length)>=t&&(s+=1),s>=Object.keys(o).length)}var $t=i(1842);class Lt{constructor(e={}){this.id=e.id||"",this.name=e.name||"",this.primary=!!e.primary,this.summary=e.summary||"",this.can_edit=!!e.can_edit,this.resource=new ct(e.resource||e.system),this.availability=(e.availability||[]).map(({starts_at:e,ends_at:t,date:i,duration:n,status:s})=>({date:new Date(i,e).valueOf(),duration:n||(0,$t.Z)(t,e),status:s})),this.hidden=!!e.hidden}}function St(e,t){const i=ae(e);return(0,H.U2M)("/api/staff/v1/calendars/free_busy"+(i?"?"+i:"")).pipe((0,R.U)(e=>e.map(e=>new Lt(e))),(e=>(0,R.U)(t=>t.filter(e=>!!e.resource).map(t=>new ct(Object.assign(Object.assign({},t.resource),{level:null==e?void 0:e.levelWithID(t.resource.zones),availability:t.availability}))).filter(e=>e.bookable)))(t))}function Jt(e,t){if(1&e&&(o.TgZ(0,"mat-option",13),o._uU(1),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e),o.xp6(1),o.hij(" ",e.display_name||e.name," ")}}function Et(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"mat-form-field",10),o.TgZ(1,"mat-select",11),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().building.next(t)}),o.YNc(2,Jt,2,2,"mat-option",12),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(1),o.Q6J("ngModel",e.building.getValue()),o.xp6(1),o.Q6J("ngForOf",e.buildings)}}function Pt(e,t){if(1&e&&(o.TgZ(0,"mat-option",13),o._uU(1),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e.id),o.xp6(1),o.hij(" ",e.name," ")}}function Yt(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"mat-form-field",10),o.TgZ(1,"mat-select",14),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().type=t}),o.YNc(2,Pt,2,2,"mat-option",12),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(1),o.Q6J("ngModel",e.type),o.xp6(1),o.Q6J("ngForOf",e.space_types)}}function Qt(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"a-space-select-item",17),o.NdJ("click",function(){o.CHM(e);const t=o.oxw().$implicit;return o.oxw(3).spaceSelected(t)}),o.qZA()}if(2&e){const e=o.oxw().$implicit,t=o.oxw(3);o.Q6J("space",e)("multiple",t.multiple)}}function Ft(e,t){if(1&e&&(o.ynx(0),o.YNc(1,Qt,1,2,"a-space-select-item",16),o.BQk()),2&e){const e=t.$implicit,i=o.oxw(3);o.xp6(1),o.Q6J("ngIf",!i.space_map[e.id])}}function Dt(e,t){if(1&e&&(o.ynx(0),o.YNc(1,Ft,2,1,"ng-container",15),o.ALo(2,"async"),o.BQk()),2&e){const e=o.oxw(2);o.xp6(1),o.Q6J("ngForOf",o.lcZ(2,1,e.filtered_spaces))}}function Bt(e,t){if(1&e&&(o.ynx(0),o.YNc(1,Dt,3,3,"ng-container",5),o.ALo(2,"async"),o.BQk()),2&e){const e=o.oxw(),t=o.MAs(16);let i;o.xp6(1),o.Q6J("ngIf",null==(i=o.lcZ(2,2,e.filtered_spaces))?null:i.length)("ngIfElse",t)}}function zt(e,t){if(1&e&&o._UZ(0,"a-space-select-item",20),2&e){const e=t.$implicit,i=o.oxw(3);o.Q6J("space",e)("multiple",i.multiple)}}function Ht(e,t){if(1&e&&(o.ynx(0),o.YNc(1,zt,1,2,"a-space-select-item",19),o.BQk()),2&e){const e=o.oxw(2);o.xp6(1),o.Q6J("ngForOf",e.spaces)}}function Vt(e,t){if(1&e&&(o.TgZ(0,"div",18),o.YNc(1,Ht,2,1,"ng-container",5),o.qZA()),2&e){const e=o.oxw(),t=o.MAs(16);o.ekj("show",e.show_selected),o.xp6(1),o.Q6J("ngIf",e.spaces&&e.spaces.length)("ngIfElse",t)}}function Gt(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"footer"),o.TgZ(1,"button",21),o.NdJ("click",function(){return o.CHM(e),o.oxw().save()}),o._uU(2),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(2),o.hij(" Save selected spaces(",e.spaces.length||"0",") ")}}function Rt(e,t){1&e&&(o.TgZ(0,"div",22),o.TgZ(1,"app-icon",0),o._uU(2,"close"),o.qZA(),o.TgZ(3,"p"),o._uU(4,"No spaces"),o.qZA(),o.qZA())}function Xt(e,t){1&e&&(o.TgZ(0,"div",23),o._UZ(1,"mat-spinner",24),o.TgZ(2,"p"),o._uU(3,"Finding available spaces..."),o.qZA(),o.qZA())}let Wt=(()=>{class e extends b{constructor(e,t,i){super(),this._org=e,this._settings=t,this._data=i,this.event=new o.vpe,this.spaces=[...this._data.spaces||[]],this.building=new _.X(null),this.space_types=[],this.available_spaces=(0,_e.aj)([this.building]).pipe((0,Zt.w)(([e])=>(this.loading=!0,St({zone_ids:null==e?void 0:e.id,period_start:(0,At.Z)(this._data.date),period_end:(0,At.Z)((0,Tt.Z)(this._data.date,this._data.duration))}))),(0,Ct.d)(1)),this.filtered_spaces=this.available_spaces.pipe((0,R.U)(e=>{return t=e,i=Object.assign(Object.assign({},this._data),{host:ne()}),n=this._org.building.booking_rules,t.filter(e=>{var t;return!(null===(t=function(e,t){var i;const{space:n}=e;for(const s of n.zones)if(null===(i=t[s])||void 0===i?void 0:i.length)for(const i of t[s])if(i&&Mt(e,i))return Object.assign(Object.assign({},Ut),i.rules);return Ut}(Object.assign(Object.assign({},i),{space:e}),n))||void 0===t?void 0:t.hidden)});var t,i,n}),(0,kt.b)(()=>this.loading=!1)),this.building.next(this._org.building||this.buildings[0]),this.subscription("spaces",this.filtered_spaces.subscribe(e=>e))}get buildings(){return this._org.buildings}get multiple(){return!!this._settings.get("app.booking.multiple_spaces")}get space_map(){const e={};return this.spaces.forEach(t=>e[t.id]=!0),e}spaceSelected(e){this.multiple?this.space_map[e.id]||this.spaces.push(e):(this.spaces=[e],this.save())}save(){this.event.emit({reason:"done",metadata:this.spaces})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(be),o.Y36(se),o.Y36(y.WI))},e.\u0275cmp=o.Xpm({type:e,selectors:[["a-space-select-modal"]],outputs:{event:"event"},features:[o.qOj],decls:19,vars:7,consts:[[1,"text-3xl"],[1,"text-xl","font-semibold","flex-1"],["mat-icon-button","","mat-dialog-close",""],["appearance","outline",4,"ngIf"],[1,"body",2,"width","32rem"],[4,"ngIf","ngIfElse"],["class","space-list",3,"show",4,"ngIf"],[4,"ngIf"],["empty_state",""],["load_state",""],["appearance","outline"],["name","booking-type","placeholder","Select building",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","booking-type","placeholder","Any space type",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["type","available",3,"space","multiple","click",4,"ngIf"],["type","available",3,"space","multiple","click"],[1,"space-list"],["type","selected",3,"space","multiple",4,"ngFor","ngForOf"],["type","selected",3,"space","multiple"],["mat-button","",3,"click"],["empty","",1,"p-16","flex","flex-col","items-center","space-y-2"],["load","",1,"p-16","flex","flex-col","items-center","space-y-2"],["diameter","48"]],template:function(e,t){if(1&e&&(o.TgZ(0,"header"),o.TgZ(1,"app-icon",0),o._uU(2,"place"),o.qZA(),o.TgZ(3,"div",1),o._uU(4),o.qZA(),o.TgZ(5,"button",2),o.TgZ(6,"app-icon",0),o._uU(7,"close"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(8,"main"),o.YNc(9,Et,3,2,"mat-form-field",3),o.YNc(10,Yt,3,2,"mat-form-field",3),o.TgZ(11,"div",4),o.YNc(12,Bt,3,4,"ng-container",5),o.YNc(13,Vt,2,4,"div",6),o.qZA(),o.YNc(14,Gt,3,1,"footer",7),o.YNc(15,Rt,5,0,"ng-template",null,8,o.W1O),o.YNc(17,Xt,4,0,"ng-template",null,9,o.W1O),o.qZA()),2&e){const e=o.MAs(18);o.xp6(4),o.hij(" Select space",t.multiple?"s":""," "),o.xp6(5),o.Q6J("ngIf",t.buildings&&t.buildings.length>1),o.xp6(1),o.Q6J("ngIf",t.space_types&&t.space_types.length>1),o.xp6(2),o.Q6J("ngIf",!t.loading)("ngIfElse",e),o.xp6(1),o.Q6J("ngIf",t.multiple),o.xp6(1),o.Q6J("ngIf",t.multiple)}},styles:["mat-form-field[_ngcontent-%COMP%]{height:3.5em;width:100%;padding:0 .25em}.body[_ngcontent-%COMP%]{min-width:20rem;max-width:calc(100vw - 2rem);max-height:65vh;overflow:auto}"]}),e})();o.B6R(Wt,[Ye,xe.lW,y.ZT,ye.O5,h.KE,Ze.gD,ye.sg,qe.ey,wt,Ae.$g],[ye.Ov]),o.B6R(wt,[ye.O5,Ye,xe.lW],[]);let Kt=0;const ei=["app-bootstrap",""];function ti(e,t){if(1&e&&(o.TgZ(0,"mat-option",10),o.TgZ(1,"div",11),o.TgZ(2,"div",12),o._uU(3),o.qZA(),o.TgZ(4,"div",13),o._uU(5),o.qZA(),o.qZA(),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e.id),o.xp6(3),o.Oqu(e.name),o.xp6(2),o.hij(" ",e.id," ")}}function ii(e,t){if(1&e){const e=o.EpF();o.ynx(0),o.TgZ(1,"p",4),o._uU(2," Input the PlaceOS "),o.TgZ(3,"em"),o._uU(4,"System ID"),o.qZA(),o._uU(5," to bootstrap "),o.qZA(),o.TgZ(6,"mat-form-field",5),o.TgZ(7,"mat-label"),o._uU(8,"System ID"),o.qZA(),o.TgZ(9,"input",6),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().system_id=t})("ngModelChange",function(t){return o.CHM(e),o.oxw().filter(t)}),o.qZA(),o.qZA(),o.TgZ(10,"mat-autocomplete",null,7),o.YNc(12,ti,6,3,"mat-option",8),o.qZA(),o.TgZ(13,"button",9),o.NdJ("click",function(){return o.CHM(e),o.oxw().bootstrap()}),o._uU(14," Submit "),o.qZA(),o.BQk()}if(2&e){const e=o.MAs(11),t=o.oxw();o.xp6(9),o.Q6J("ngModel",t.system_id)("matAutocomplete",e),o.xp6(3),o.Q6J("ngForOf",t.filtered_list),o.xp6(1),o.Q6J("disabled",!t.system_id)}}function ni(e,t){1&e&&(o.TgZ(0,"div",14),o._UZ(1,"mat-spinner",15),o.TgZ(2,"div",16),o._uU(3,"Loading system data..."),o.qZA(),o.qZA()),2&e&&(o.xp6(1),o.Q6J("diameter",32))}let si=(()=>{class e extends b{constructor(e,t,i){super(),this._spaces=e,this.route=t,this._router=i,this.system_list=[],this.filtered_list=[],this.selected_system=null,this.bootstrap=()=>this.configure(this.system_id),this.clearBootstrap=()=>localStorage.removeItem("PLACEOS.BOOKINGS.system")}ngOnInit(){return(0,g.mG)(this,void 0,void 0,function*(){this.loading=!0,yield this._spaces.initialised.pipe((0,f.P)(e=>e)).toPromise(),this.system_list=this._spaces.space_list||[],this.filter(""),this.loading=!1,this.subscription("route.query",this.route.queryParamMap.subscribe(e=>{e.has("clear")&&e.get("clear")&&this.clearBootstrap(),(e.has("system_id")||e.has("sys_id"))&&(this.system_id=e.get("system_id")||e.get("sys_id"),this.bootstrap())})),this.checkBootstrapped()})}checkBootstrapped(){if(this.loading=!0,localStorage){const e=localStorage.getItem("PLACEOS.BOOKINGS.system");if(e)return void this._router.navigate(["panel",e])}this.loading=!1}configure(e){this.loading=!0,localStorage&&(localStorage.setItem("PLACEOS.BOOKINGS.system",e),localStorage.setItem("trust","true"),localStorage.setItem("fixed_device","true")),this._router.navigate(["panel",e]),this.loading=!1}filter(e){const t=e.toLowerCase();this.filtered_list=this.system_list.filter(i=>i.name.toLowerCase().includes(t)||i.id.includes(e)).slice(0,100)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(ut),o.Y36(c.gz),o.Y36(c.F0))},e.\u0275cmp=o.Xpm({type:e,selectors:[["","app-bootstrap",""]],features:[o.qOj],attrs:ei,decls:6,vars:2,consts:[[1,"rounded","shadow","m-4","bg-white","overflow-hidden","mx-auto","text-center","flex","flex-col","items-center"],[1,"bg-primary","text-white","py-2","px-4","m-0","w-full","text-2xl"],[4,"ngIf","ngIfElse"],["load_state",""],[1,"description","py-4"],["appearance","outline"],["matInput","","placeholder","System ID",3,"ngModel","matAutocomplete","ngModelChange"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","click"],[3,"value"],[1,"leading-tight"],[1,"name"],[1,"text-xs","text-dark-fade"],["load","",1,"my-16","flex","flex-col","items-center"],[3,"diameter"],[1,"m-4"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"h2",1),o._uU(2," Booking Panel Setup "),o.qZA(),o.YNc(3,ii,15,4,"ng-container",2),o.qZA(),o.YNc(4,ni,4,1,"ng-template",null,3,o.W1O)),2&e){const e=o.MAs(5);o.xp6(3),o.Q6J("ngIf",!t.loading)("ngIfElse",e)}},directives:[ye.O5,h.KE,h.hX,m.Nt,l.Fj,p.ZL,l.JJ,l.On,p.XC,ye.sg,xe.lW,qe.ey,Ae.$g],styles:["[_nghost-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-color:#f0f0f0;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%23ddd' fill-opacity='1' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem)}mat-form-field[_ngcontent-%COMP%]{width:calc(100% - 2rem)}button[_ngcontent-%COMP%]{width:8rem;margin:0 .5rem .5rem}"]}),e})();var oi=i(8289),ai=i(3835),ri=i(611),li=i(7701),ci=i(999),ui=i(5884),di=i(9899);class pi{constructor(e={}){var t;this.id=e.id||"",this.name=e.name||e.id||"",this.category=e.category||"",this.unit_price=e.unit_price||0,this.description=e.description||"",this.quantity=e.quantity||0,this.discount_cap=e.discount_cap||0,this.accept_points=!!e.accept_points,this.options=e.options||[],this.tags=e.tags||[],this.total_cost=(this.unit_price+this.options.map(e=>e.unit_price||0).reduce((e,t)=>e+t,0))*this.quantity,this.options_string=(null===(t=this.options)||void 0===t?void 0:t.map(e=>e.id||"").sort((e,t)=>e.localeCompare(t)).join(","))||""}}class hi{constructor(e={}){var t,i;this.id=e.id||`order-${U(9999999,1e6)}`,this.system_id=e.system_id||"",this.event_id=e.event_id||(null===(t=e.event)||void 0===t?void 0:t.id)||"",this.items=(e.items||[]).map(e=>new pi(e)),this.item_count=this.items.reduce((e,t)=>e+t.quantity,0),this.total_cost=this.items.reduce((e,t)=>e+(t.total_cost||0),0),this.charge_code=e.charge_code||"",this.status=e.status||"accepted",this.invoice_number=e.invoice_number||"",this.event=e.event||null,this.deliver_at=e.deliver_at||e.date||(null===(i=this.event)||void 0===i?void 0:i.date)||(new Date).getTime()}}let mi={id:"default",name:"Default User"};class gi{constructor(e={}){var t,i,n;this.id=e.id||"",this.event_start=e.event_start||(0,At.Z)(e.date||(0,ci.Z)((0,Tt.Z)(new Date,3),{nearestTo:5})),this.event_end=e.event_end||(0,At.Z)((0,Tt.Z)(1e3*this.event_start,e.duration||30)),this.calendar=e.calendar||"",this.creator=(null===(t=e.creator||mi.email)||void 0===t?void 0:t.toLowerCase())||"",this.host=(e.host||this.creator||mi.email||"").toLowerCase();const s=e.attendees||[];this.attendees=s.filter(e=>!e.resource).map(e=>new W(e)),this.resources=I(e.resources||s.filter(e=>e.resource).map(e=>new ct(e)),"email")||[],this.title=e.title||"",this.body=e.body||"",this.private=!!e.private,this.all_day=!!e.all_day,this.date=1e3*this.event_start,this.duration=this.all_day?1440:e.duration||(0,$t.Z)(1e3*e.event_end,this.date)||30,this.timezone=e.timezone||"",this.meeting_url=e.meeting_url||e.online_meeting_url||"",this.meeting_id=e.meeting_id||e.online_meeting_id||"",this.meeting_provider=e.meeting_provider||e.online_meeting_provider||"",this.recurring=!!e.recurring,this.recurring_master_id=e.recurring_master_id||"",this.organiser=this.attendees.find(e=>e.email===this.host),this.master=e.master?new gi(e.master):null,this.recurrence=e.recurring?{start:1e3*this.event_start||new Date(1e3*e.recurrence.range_start).valueOf(),end:e.recurrence.end||new Date(1e3*e.recurrence.range_end).valueOf(),interval:e.recurrence.interval,pattern:e.recurrence.pattern,days_of_week:e.recurrence.days_of_week}:{};const o=e.system;(null==o?void 0:o.email)&&!this.resources.find(e=>e.email===o.email)&&this.resources.push(new ct(o)),this.system=o||this.resources[0]||null,this.old_system=e.old_system||e.system,this.attachments=e.attachments||[],this.extension_data=e.extension_data||{},this.status=function(e){var t;return(null===(t=e.resources)||void 0===t?void 0:t.length)?e.resources.every(e=>"accepted"===e.response_status)?"approved":e.resources.some(e=>"tentative"===e.response_status||"needsAction"===e.response_status)?"tentative":"declined":"approved"}(this)||"none",this.location=e.location||(null===(i=this.space)||void 0===i?void 0:i.display_name)||(null===(n=this.space)||void 0===n?void 0:n.name)||"",this.type="declined"===this.status?"cancelled":this.attendees.find(e=>e.is_external)?"external":"internal";for(const a in e)a in this||(this.extension_data[a]=e[a]||this.extension_data[a]);this.extension_data.catering=(this.extension_data.catering||[]).map(e=>new hi(Object.assign(Object.assign({},e),{event:this})))}ext(e){return this.extension_data[e]}get guests(){return this.attendees.filter(e=>!!e.is_external)}get space(){return this.resources[0]||null}get is_today(){return(0,D.Z)(new Date(this.date),new Date)}toJSON(){var e;const t=Object.assign({},this),i=(0,At.Z)((0,Tt.Z)(this.date,this.duration)),n=this.all_day?(0,ui.Z)(this.date,{hours:12}):this.date;t.event_start=(0,At.Z)(n),t.event_end=i;const s=this.attendees;return this.recurring&&(t.recurrence=Object.assign(Object.assign({},this.recurrence),{range_start:t.event_start,range_end:(0,At.Z)(this.recurrence.end)})),t.recurrence=t.recurrence&&Object.keys(t.recurrence).length?t.recurrence:null,t.attendees=I(s,"email"),this.all_day||(t.extension_data.breakdown=15),t.extension_data.catering=t.extension_data.catering.map(e=>new hi(Object.assign(Object.assign({},e),{event:null}))),t.system_id=null===(e=this.system)||void 0===e?void 0:e.id,delete t.catering,delete t.date,delete t.duration,delete t.status,t}get state(){const e=new Date,t=this.date;return(0,qt.Z)(e,(0,di.Z)(t,{minutes:-15}))?"future":(0,qt.Z)(e,t)?"upcoming":(0,qt.Z)(e,(0,di.Z)(t,{minutes:15}))?"started":(0,qt.Z)(e,(0,di.Z)(t,{minutes:this.duration}))?"in_progress":"done"}get can_check_in(){const e=new Date;return this.is_today||(0,Ot.Z)(e,this.date)&&(0,qt.Z)(e,(0,Tt.Z)(this.date,this.duration))}}const fi="/api/staff/v1/events";var _i=i(949),vi=i(847);const bi=e=>{var t;return(null===(t=e.parent)||void 0===t?void 0:t.get("date"))&&(0,Ot.Z)(new Date,(0,Tt.Z)(e.parent.get("date").value,e.value))?{duration:!0}:null};(0,di.Z)((0,_i.Z)((0,vi.Z)(new Date,6),0),{days:-1});const yi=["book/spaces","schedule/view"];let xi=(()=>{class e extends b{constructor(e,t){super(),this._org=e,this._router=t,this._view=new _.X("form"),this._options=new _.X({zone_ids:[]}),this._form=new _.X(null),this._event=new _.X(null),this._loading=new _.X(""),this.last_success=new gi(JSON.parse(sessionStorage.getItem("PLACEOS.last_booked_event")||"{}")),this.loading=this._loading.asObservable(),this.options=this._options.pipe((0,Ct.d)(1)),this.available_spaces=(0,_e.aj)([this._view,this._options,this._form,this._org.initialised.pipe((0,ai.h)(e=>e))]).pipe((0,ai.h)(([e,t,i])=>"find"===e&&!!i),(0,li.b)(300),(0,Zt.w)(([e,t,i])=>{var n,s;this._loading.next("Retrieving available spaces...");const o=i.value.date+60*i.value.duration*1e3;return St({period_start:(0,At.Z)(i.value.date),period_end:(0,At.Z)(o),zone_ids:(null===(n=t.zone_ids)||void 0===n?void 0:n.join(","))||this._org.building.id,features:null===(s=t.features)||void 0===s?void 0:s.join(","),capacity:t.capacity},this._org)}),(0,R.U)(e=>e.filter(e=>{var t;return!(null===(t=e.availability)||void 0===t?void 0:t.length)||e.availability.find(e=>"busy"!==e.status)})),(0,kt.b)(e=>{this._loading.next("")}),(0,Ct.d)(1)),this.available_spaces.subscribe(),this.subscription("router.events",this._router.events.subscribe(e=>{e instanceof c.m2&&!yi.some(t=>e.url.includes(t))&&this.clearForm()}))}get view(){return this._view.getValue()}get form(){return this._form.getValue()}get event(){return this._event.getValue()}setView(e){this._view.next(e)}setOptions(e){this._options.next(Object.assign(Object.assign({},this._options.getValue()),e))}newForm(e=new gi){this._form.next(function(e){var t,i,n;const s=new l.cw({id:new l.NI(e.id),host:new l.NI(e.host||"",[l.kI.required]),organiser:new l.NI(e.organiser||{},[l.kI.required]),creator:new l.NI(e.creator,[l.kI.required]),calendar:new l.NI(e.calendar),attendees:new l.NI(e.attendees||[]),resources:new l.NI(e.resources||[]),title:new l.NI(e.title,[l.kI.required]),body:new l.NI(e.body),private:new l.NI(e.private),date:new l.NI(e.date,[l.kI.required]),duration:new l.NI(e.duration,[bi]),all_day:new l.NI(e.all_day),recurring:new l.NI(e.recurring),recurrence:new l.NI(e.recurrence),recurring_master_id:new l.NI(e.recurring_master_id),master:new l.NI(e.master),attachments:new l.NI(e.attachments),catering:new l.NI((null===(t=e.extension_data)||void 0===t?void 0:t.catering)||[]),visitor_type:new l.NI(null===(i=e.extension_data)||void 0===i?void 0:i.visitor_type),location:new l.NI(e.location),needs_space:new l.NI(!0),needs_parking:new l.NI((null===(n=e.extension_data)||void 0===n?void 0:n.needs_parking)||!1),system:new l.NI(e.system)});return s.get("organiser").valueChanges.subscribe(e=>s.controls.host.setValue(null==e?void 0:e.email)),s.get("resources").valueChanges.subscribe(e=>s.controls.system.setValue(e.length?e[0]:null)),e.id&&(s.get("host").disable(),s.get("organiser").disable()),"started"===e.state&&s.get("date").disable(),s}(e)),this.subscription("form_change",this._form.getValue().valueChanges.subscribe(()=>this.storeForm())),this._event.next(e),this._options.next({})}resetForm(){this._form.getValue()||this.newForm();const e=this._event.getValue();this._form.getValue().patchValue(Object.assign(Object.assign({},e||{}),(null==e?void 0:e.extension_data)||{})),this._options.next({})}clearForm(){sessionStorage.removeItem("PLACEOS.event_form"),this.newForm()}storeForm(){var e;sessionStorage.setItem("PLACEOS.event_form",JSON.stringify((null===(e=this._form.getValue())||void 0===e?void 0:e.value)||{}))}loadForm(){this._form.getValue()||this.newForm(),this._form.getValue().patchValue(Object.assign({},JSON.parse(sessionStorage.getItem("PLACEOS.event_form")||"{}")))}postForm(){var e;return(0,g.mG)(this,void 0,void 0,function*(){const t=this._form.getValue();if(!t)throw"No form for event";if(!t.valid)throw`Some form fields are invalid. [${function(e){const t=[];for(const i in e.controls)e.controls[i].valid||t.push(i);return t}(t).join(", ")}]`;const i=(null===(e=t.get("resources"))||void 0===e?void 0:e.value)||[],n=i.length?yield St({period_start:(0,At.Z)(t.get("date").value),period_end:(0,At.Z)(t.get("date").value+60*t.get("duration").value*1e3),system_ids:i.map(e=>e.id).join(",")}).toPromise():[];if(n.length!==i.length)throw i.length-n.length+" space(s) are not available at the selected time";const s=yield((e,t)=>{var i;return null===(i=e)||void 0===i||delete i.status,e.id?function(e,t,i={},n="patch"){const s=ae(i);return("patch"===n?H.r$K:H.gzd)(`${fi}/${encodeURIComponent(e)}${s?"?"+s:""}`,"patch"===n?t:new gi(t).toJSON()).pipe((0,R.U)(e=>new gi(e)))}(e.id,e,void 0):function(e){return(0,H.v_Q)(`${fi}`,new gi(e).toJSON()).pipe((0,R.U)(e=>new gi(e)))}(e)})(new gi(this._form.getValue().value)).toPromise();return this.clearForm(),this.last_success=s,sessionStorage.setItem("PLACEOS.last_booked_event",JSON.stringify(s)),this.setView("success"),s})}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(be),o.LFG(c.F0))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var wi=i(5959),Zi=i(878),Ci=i(3148),ki=i(8720),Ai=i(7727);function Ti(e,t){if(1&e&&(o.TgZ(0,"main",6),o._UZ(1,"user-form",7),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("form",e.form)}}function qi(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"footer",8),o.TgZ(1,"button",9),o._uU(2,"Cancel"),o.qZA(),o.TgZ(3,"button",10),o.NdJ("click",function(){return o.CHM(e),o.oxw().saveChanges()}),o._uU(4,"Save"),o.qZA(),o.qZA()}}function Oi(e,t){1&e&&(o.TgZ(0,"main",11),o._UZ(1,"mat-spinner",12),o.TgZ(2,"p"),o._uU(3,"Saving attendee..."),o.qZA(),o.qZA())}let Ii=(()=>{class e extends b{constructor(e){super(),this._data=e,this.event=new o.vpe}ngOnInit(){this.user=this._data.user||{},this.form=function(e){var t;if(!e)throw Error("No user passed");const i={name:new l.NI(e.name||""),email:new l.NI(e.email||"",[l.kI.email,l.kI.required]),organisation:new l.NI(e.organisation||"",l.kI.required),phone:new l.NI(e.phone||"",l.kI.pattern(/[+\-()0-9]{1,24}/g)),assistance_required:new l.NI(e.assistance_required||!1),visit_expected:new l.NI(null===(t=e.visit_expected)||void 0===t||t)};return new l.cw(i)}(this.user)}saveChanges(){if(this.form.markAllAsTouched(),this.form.valid){const e=new W(Object.assign(Object.assign({},this.form.value),{type:"external"}));this.event.emit({reason:"done",metadata:e})}}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(y.WI))},e.\u0275cmp=o.Xpm({type:e,selectors:[["new-user-modal"]],outputs:{event:"event"},features:[o.qOj],decls:11,vars:4,consts:[["mat-dialog-title","",1,"heading"],[1,"flex-1"],["mat-icon-button","","mat-dialog-close",""],["class","flex flex-col items-center w-full p-2",4,"ngIf","ngIfElse"],["class","flex items-center justify-center w-full p-2 border-t border-gray-300 space-x-2",4,"ngIf"],["load_state",""],[1,"flex","flex-col","items-center","w-full","p-2"],[3,"form"],[1,"flex","items-center","justify-center","w-full","p-2","border-t","border-gray-300","space-x-2"],["mat-button","","mat-dialog-close","",1,"inverse"],["mat-button","",3,"click"],[1,"flex","flex-col","items-center","w-full","p-2","space-y-2"],["diameter","32"]],template:function(e,t){if(1&e&&(o.TgZ(0,"header"),o.TgZ(1,"div",0),o._uU(2),o.qZA(),o._UZ(3,"div",1),o.TgZ(4,"button",2),o.TgZ(5,"app-icon"),o._uU(6,"close"),o.qZA(),o.qZA(),o.qZA(),o.YNc(7,Ti,2,1,"main",3),o.YNc(8,qi,5,0,"footer",4),o.YNc(9,Oi,4,0,"ng-template",null,5,o.W1O)),2&e){const e=o.MAs(10);o.xp6(2),o.hij(" ",null!=t.user&&t.user.id?"Edit":"Add"," External Attendee "),o.xp6(5),o.Q6J("ngIf",!t.loading)("ngIfElse",e),o.xp6(1),o.Q6J("ngIf",!t.loading)}},styles:["main[_ngcontent-%COMP%]{min-height:20em!important;width:100%}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em}"]}),e})();var Ui=i(9236);function ji(e,t){if(1&e&&(o.TgZ(0,"div",3),o.TgZ(1,"label",4),o._uU(2," Name"),o.TgZ(3,"span"),o._uU(4,"*"),o.qZA(),o._uU(5,": "),o.qZA(),o.TgZ(6,"mat-form-field",5),o._UZ(7,"input",6),o.TgZ(8,"mat-error"),o._uU(9,"Name is required"),o.qZA(),o.qZA(),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.ekj("error",e.hasError("name"))}}function Ni(e,t){if(1&e&&(o.TgZ(0,"div",3),o.TgZ(1,"label",7),o._uU(2," Email"),o.TgZ(3,"span"),o._uU(4,"*"),o.qZA(),o._uU(5,": "),o.qZA(),o.TgZ(6,"mat-form-field",5),o._UZ(7,"input",8),o.TgZ(8,"mat-error"),o._uU(9,"A valid email is required"),o.qZA(),o.qZA(),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.ekj("error",e.hasError("email"))}}function Mi(e,t){if(1&e&&(o.TgZ(0,"div",3),o.TgZ(1,"label",9),o._uU(2," Organisation"),o.TgZ(3,"span"),o._uU(4,"*"),o.qZA(),o._uU(5,": "),o.qZA(),o.TgZ(6,"mat-form-field",5),o._UZ(7,"input",10),o.TgZ(8,"mat-error"),o._uU(9,"Organisation is required"),o.qZA(),o.qZA(),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.ekj("error",e.hasError("organisation"))}}function $i(e,t){if(1&e&&(o.TgZ(0,"div",3),o.TgZ(1,"label",11),o._uU(2," Phone: "),o.qZA(),o.TgZ(3,"mat-form-field",5),o._UZ(4,"input",12),o.TgZ(5,"mat-error"),o._uU(6,"Phone format is invalid"),o.qZA(),o.qZA(),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.ekj("error",e.hasError("phone"))}}function Li(e,t){1&e&&(o.TgZ(0,"div",3),o.TgZ(1,"mat-checkbox",13),o._uU(2," Assistance required "),o.qZA(),o.qZA())}function Si(e,t){1&e&&(o.TgZ(0,"div",3),o.TgZ(1,"mat-checkbox",14),o._uU(2," Visit expected "),o.qZA(),o.qZA())}function Ji(e,t){if(1&e&&(o.TgZ(0,"form",1),o.YNc(1,ji,10,2,"div",2),o.YNc(2,Ni,10,2,"div",2),o.YNc(3,Mi,10,2,"div",2),o.YNc(4,$i,7,2,"div",2),o.YNc(5,Li,3,0,"div",2),o.YNc(6,Si,3,0,"div",2),o.qZA()),2&e){const e=o.oxw();o.Q6J("formGroup",e.form),o.xp6(1),o.Q6J("ngIf",e.form.controls.name),o.xp6(1),o.Q6J("ngIf",e.form.controls.email),o.xp6(1),o.Q6J("ngIf",e.form.controls.organisation),o.xp6(1),o.Q6J("ngIf",e.form.controls.phone),o.xp6(1),o.Q6J("ngIf",e.form.controls.assistance_required),o.xp6(1),o.Q6J("ngIf",e.form.controls.visit_expected)}}let Ei=(()=>{class e{hasError(e){return this.form.controls[e].invalid&&this.form.controls[e].touched}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["user-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[["user-form","",3,"formGroup",4,"ngIf"],["user-form","",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","name"],["appearance","outline"],["matInput","","name","name","placeholder","Name","formControlName","name"],["for","email"],["matInput","","name","email","placeholder","Email Address","formControlName","email"],["for","org"],["matInput","","name","org","placeholder","Organisation","formControlName","organisation"],["for","phone"],["matInput","","name","phone","type","tel","placeholder","Phone","formControlName","phone"],["name","assistance-required","color","primary","formControlName","assistance_required"],["name","visit-expected","color","primary","formControlName","visit_expected"]],template:function(e,t){1&e&&o.YNc(0,Ji,7,7,"form",0),2&e&&o.Q6J("ngIf",t.form)},directives:[ye.O5,l._Y,l.JL,l.sg,h.KE,m.Nt,l.Fj,l.JJ,l.u,h.TO,Ui.oG],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),e})();function Pi(e){const t=ae({q:e});return(0,H.U2M)("/api/staff/v1/guests"+(e?"?"+t:"")).pipe((0,R.U)(e=>e.map(e=>new K(e))))}function Yi(e){const t=ae({q:e});return(0,H.U2M)("/api/staff/v1/people"+(e?"?"+t:"")).pipe((0,R.U)(e=>e.map(e=>new ee(e))))}o.B6R(Ii,[y.uh,xe.lW,y.ZT,Ye,ye.O5,Ei,Ae.$g],[]);const Qi=["input"];function Fi(e,t){1&e&&o._UZ(0,"mat-spinner",11)}function Di(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"mat-option",12),o.NdJ("click",function(){const t=o.CHM(e).$implicit,i=o.oxw();return i.setValue(t),i.blurInput()}),o.TgZ(1,"div",13),o._uU(2),o.qZA(),o.TgZ(3,"div",14),o._uU(4),o.qZA(),o.qZA()}if(2&e){const e=t.$implicit;o.xp6(2),o.Oqu(e.name),o.xp6(2),o.hij(" ",e.email," ")}}function Bi(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"mat-option",15),o.TgZ(1,"div",16),o.NdJ("mousedown",function(e){return e.stopPropagation(),e.preventDefault()})("touchstart",function(e){return e.stopPropagation(),e.preventDefault()})("click",function(t){o.CHM(e);const i=o.oxw();return i.setValue(i.search_str),t.stopPropagation(),t.preventDefault()}),o.TgZ(2,"div",17),o._uU(3),o.qZA(),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(3),o.hij(' Add external attendee "',e.search_str,'" ')}}function zi(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"mat-option",18),o.NdJ("click",function(){return o.CHM(e),o.oxw().empty_fn()}),o._uU(1),o.qZA()}if(2&e){const e=o.oxw();o.Q6J("disabled",!e.empty_fn),o.xp6(1),o.AsE(" ",e.search_str?"No users found.":""," ",e.error," ")}}let Hi=(()=>{class e extends b{constructor(){super(...arguments),this.error="",this.query_fn=e=>Yi(e),this.search$=new wi.xQ,this.search_results$=this.search$.pipe((0,li.b)(400),(0,ki.x)(),(0,Zt.w)(e=>(this.loading=!0,this.options&&this.options.length>0?(0,Zi.of)(this.options):e.length>=3?this.guests?(0,Ci.D)([Yi(e),Pi(e)]):this.query_fn(e):(0,Zi.of)([]))),(0,Ai.K)(e=>(0,Zi.of)([])),(0,R.U)(e=>{this.loading=!1,e=function(e){const t=[...e],i=[];for(;t.length;){const e=t.pop();Array.isArray(e)?t.push(...e):i.push(e)}return i.reverse()}(e);const t=(this.search_str||"").toLowerCase();return e.filter(e=>!this.filter||this.filter(e,t))})),this.cancelReset=()=>this.clearTimeout("reset"),this.blurInput=()=>{this.timeout("blur",()=>{var e,t;return null===(t=null===(e=this._input_el)||void 0===e?void 0:e.nativeElement)||void 0===t?void 0:t.blur()})}}ngOnInit(){this.subscription("search_results",this.search_results$.subscribe(e=>this.user_list=e))}resetSearchString(){this.timeout("reset",()=>{var e;return this.search_str=(null===(e=this.active_user)||void 0===e?void 0:e.name)||""},100)}setValue(e,t){"string"==typeof e&&e===this.search_str&&(e=new W({name:(this.search_str||t||"").split("@")[0],email:this.search_str||t||""})),e instanceof W&&(this.active_user=e,this._onChange&&this._onChange(e),this.resetSearchString())}writeValue(e){this.active_user=e,this.resetSearchString()}setDisabledState(e){this.disabled=e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouch=e}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=o.n5z(e)))(i||e)}}(),e.\u0275cmp=o.Xpm({type:e,selectors:[["a-user-search-field"]],viewQuery:function(e,t){if(1&e&&o.Gf(Qi,5,o.SBq),2&e){let e;o.iGM(e=o.CRH())&&(t._input_el=e.first)}},inputs:{disabled:"disabled",placeholder:"placeholder",options:"options",guests:"guests",error:"error",validate:"validate",empty_fn:"empty_fn",filter:"filter",query_fn:"query_fn"},features:[o._Bn([{provide:l.JU,useExisting:(0,o.Gpc)(()=>e),multi:!0}]),o.qOj],decls:12,vars:8,consts:[["form-field","",1,"user-search-field","text-black"],["overlay","","appearance","outline"],["matInput","","keyboard","","name","user-search",3,"ngModel","disabled","placeholder","matAutocomplete","ngModelChange","keyup.enter","blur","focus"],["input",""],["matPrefix","",1,"text-2xl","relative"],["matSuffix","","diameter","16",4,"ngIf"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"click",4,"ngFor","ngForOf"],["class","relative pointer-events-none",4,"ngIf"],[3,"disabled","click",4,"ngIf"],["matSuffix","","diameter","16"],[3,"click"],[1,"leading-tight"],[1,"text-xs","text-black","opacity-60"],[1,"relative","pointer-events-none"],[1,"absolute","inset-0","px-4","pointer-events-auto",3,"mousedown","touchstart","click"],[1,"pointer-events-none"],[3,"disabled","click"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"mat-form-field",1),o.TgZ(2,"input",2,3),o.NdJ("ngModelChange",function(e){return t.search_str=e})("ngModelChange",function(e){return t.search$.next(e||"")})("keyup.enter",function(){return t.validate&&t.validate(t.search_str)?t.setValue(t.search_str):""})("blur",function(){return t.resetSearchString()})("focus",function(){return t.cancelReset()}),o.qZA(),o.TgZ(4,"app-icon",4),o._uU(5,"search"),o.qZA(),o.YNc(6,Fi,1,0,"mat-spinner",5),o.qZA(),o.TgZ(7,"mat-autocomplete",6,7),o.NdJ("optionSelected",function(e){return t.setValue(e.option.value)}),o.YNc(9,Di,5,2,"mat-option",8),o.YNc(10,Bi,4,1,"mat-option",9),o.YNc(11,zi,2,3,"mat-option",10),o.qZA(),o.qZA()),2&e){const e=o.MAs(8);o.xp6(2),o.Q6J("ngModel",t.search_str)("disabled",t.disabled)("placeholder",t.placeholder||"Search for user...")("matAutocomplete",e),o.xp6(4),o.Q6J("ngIf",t.loading),o.xp6(3),o.Q6J("ngForOf",t.user_list),o.xp6(1),o.Q6J("ngIf",t.search_str&&t.validate&&t.validate(t.search_str)),o.xp6(1),o.Q6J("ngIf",!(null!=t.user_list&&t.user_list.length)&&(t.search_str||t.error))}},directives:[h.KE,m.Nt,lt,l.Fj,p.ZL,l.JJ,l.On,Ye,h.qo,ye.O5,p.XC,ye.sg,Ae.$g,h.R9,qe.ey],styles:["[_nghost-%COMP%], mat-form-field[_ngcontent-%COMP%]{width:100%}app-icon[_ngcontent-%COMP%]{top:.15em;left:-.15em}"]}),e})();var Vi=i(778),Gi=i(205),Ri=i(8125);const Xi=["select"];function Wi(e,t){if(1&e&&(o.TgZ(0,"mat-option",9),o._uU(1),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e.id),o.xp6(1),o.hij(" ",e.name," ")}}function Ki(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"mat-form-field",5),o.TgZ(1,"mat-select",6,7),o.NdJ("valueChange",function(t){return o.CHM(e),o.oxw().setValue(t)}),o.YNc(3,Wi,2,2,"mat-option",8),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(1),o.Q6J("value",e.time)("disabled",e.disabled),o.xp6(2),o.Q6J("ngForOf",e.time_options)}}const en=["*"];let tn=(()=>{class e extends b{constructor(){super(...arguments),this.step=15,this.no_past_times=!0,this.date=(new Date).valueOf(),this.time=(0,B.Z)(new Date,"HH:mm")}ngOnInit(){this.show_select=!0,this._time_options=this.generateAvailableTimes(this.date,!this.no_past_times,this.step),this.timeout("hide",()=>this.show_select=!1)}ngOnChanges(e){(e.no_past_times||e.step)&&(this._time_options=this.generateAvailableTimes(this.date,!this.no_past_times,this.step))}get time_options(){const e=(this.time||"00:00").split(":"),t=(0,ui.Z)(this.date,{hours:+e[0],minutes:+e[1]});return t.getMinutes()%15==0||this._time_options.find(e=>e.id===(0,B.Z)(t,"HH:mm"))||(this._time_options.push({name:`${(0,B.Z)(t,Y())}`,id:(0,B.Z)(t,"HH:mm")}),this._time_options.sort((e,t)=>`${e.id}`.localeCompare(`${t.id}`))),this._time_options}setValue(e){if(this.time=e,this._onChange){const e=(this.time||"00:00").split(":"),t=(0,Vi.Z)((0,ui.Z)(this.date,{hours:+e[0],minutes:+e[1]}));this._onChange(t.valueOf())}}writeValue(e){this.date=e||this.date;let t=(0,Vi.Z)(this.date);t=(0,ci.Z)(t,{nearestTo:5}),this.time=(0,B.Z)(t,"HH:mm"),this._time_options=this.generateAvailableTimes(this.date,!this.no_past_times,this.step)}setDisabledState(e){this.disabled=e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouch=e}showSelect(){this.show_select=!0,this.timeout("on_shown",()=>{this.select_field&&(this.select_field.focus(),this.select_field.open(),this.subscription("listen_close",this.select_field.openedChange.subscribe(e=>{e||(this.show_select=!1)})))})}generateAvailableTimes(e,t,i=15){const n=new Date;let s=new Date(e);const o=[];t||!(0,D.Z)(s,n)&&(0,Ot.Z)(s,n)?s=(0,Gi.Z)(s):(0,Ot.Z)(s,n)&&(s=n),s=(0,ci.Z)(s,{nearestTo:i});const a=(0,Ri.Z)(s);for(;(0,Ot.Z)(a,s);)o.push({name:`${(0,B.Z)(s,Y())}`,id:(0,B.Z)(s,"HH:mm")}),s=(0,Tt.Z)(s,i);return o}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=o.n5z(e)))(i||e)}}(),e.\u0275cmp=o.Xpm({type:e,selectors:[["a-time-field"]],viewQuery:function(e,t){if(1&e&&o.Gf(Xi,5),2&e){let e;o.iGM(e=o.CRH())&&(t.select_field=e.first)}},inputs:{step:"step",disabled:"disabled",no_past_times:"no_past_times"},features:[o._Bn([{provide:l.JU,useExisting:(0,o.Gpc)(()=>e),multi:!0}]),o.qOj,o.TTD],ngContentSelectors:en,decls:8,vars:5,consts:[["appearance","outline",3,"keydown.enter"],["matInput","","type","time",3,"disabled","ngModel","ngModelChange"],["mat-icon-button","","matSuffix","",1,"relative","top-1","-right-1",3,"click"],[1,"text-2xl","text-black","text-opacity-50"],["appearance","outline",4,"ngIf"],["appearance","outline"],[3,"value","disabled","valueChange"],["select",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(o.F$t(),o.TgZ(0,"mat-form-field",0),o.NdJ("keydown.enter",function(){return t.showSelect()}),o.TgZ(1,"input",1),o.NdJ("ngModelChange",function(e){return t.setValue(e)}),o.qZA(),o.TgZ(2,"button",2),o.NdJ("click",function(){return t.showSelect()}),o.TgZ(3,"app-icon",3),o._uU(4," arrow_drop_down "),o.qZA(),o.qZA(),o.TgZ(5,"mat-error"),o.Hsn(6),o.qZA(),o.qZA(),o.YNc(7,Ki,4,3,"mat-form-field",4)),2&e&&(o.Udp("display",t.show_select?"none":""),o.xp6(1),o.Q6J("disabled",t.disabled)("ngModel",t.time),o.xp6(6),o.Q6J("ngIf",t.show_select))},directives:[h.KE,m.Nt,l.Fj,l.JJ,l.On,xe.lW,h.R9,Ye,h.TO,ye.O5,Ze.gD,ye.sg,qe.ey],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),e})();var nn=i(8276),sn=i(4312);function on(e,t){if(1&e&&(o.TgZ(0,"mat-option",5),o._uU(1),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e.id),o.xp6(1),o.hij(" ",e.name," ")}}const an=["*"];let rn=(()=>{class e{constructor(){this.max=240,this.min=30,this.step=15,this.specialPreprops=[],this.duration=60}ngOnInit(){this.duration_options=this.generateDurationOptions(this.max,this.min,this.step)}ngOnChanges(e){(e.max||e.min||e.step||e.time)&&(this.duration_options=this.generateDurationOptions(this.max,this.min,this.step))}setValue(e){this.duration=e,this._onChange&&this._onChange(+e)}writeValue(e){this.duration=e}setDisabledState(e){this.disabled=e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouch=e}generateDurationOptions(e,t,i){const n=[];let s=t;const o=this.time?sn(this.time):null;for(const a of this.specialPreprops)n.push({id:a,name:o?`${o.add(a,"m").format("h:mm A")} (${(0,nn.Z)({hours:Math.floor(a/60),minutes:a%60})})`:`${(0,nn.Z)({hours:Math.floor(a/60),minutes:a%60})}`});for(;s<=e;)n.push({id:s,name:o?`${o.add(s,"m").format("h:mm A")} (${(0,nn.Z)({hours:Math.floor(s/60),minutes:s%60})})`:`${(0,nn.Z)({hours:Math.floor(s/60),minutes:s%60})}`}),s+=i;return n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["a-duration-field"]],inputs:{max:"max",min:"min",step:"step",time:"time",disabled:"disabled",specialPreprops:"specialPreprops"},features:[o._Bn([{provide:l.JU,useExisting:(0,o.Gpc)(()=>e),multi:!0}]),o.TTD],ngContentSelectors:an,decls:7,vars:5,consts:[[1,"duration-field"],["appearance","outline"],[3,"value","disabled","placeholder","valueChange"],["select",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(o.F$t(),o.TgZ(0,"div",0),o.TgZ(1,"mat-form-field",1),o.TgZ(2,"mat-select",2,3),o.NdJ("valueChange",function(e){return t.setValue(e)}),o.YNc(4,on,2,2,"mat-option",4),o.qZA(),o.TgZ(5,"mat-error"),o.Hsn(6),o.qZA(),o.qZA(),o.qZA()),2&e&&(o.uIk("disabled",t.disabled),o.xp6(2),o.Q6J("value",t.duration)("disabled",t.disabled)("placeholder",t.duration+" minutes"),o.xp6(2),o.Q6J("ngForOf",t.duration_options))},directives:[h.KE,Ze.gD,ye.sg,h.TO,qe.ey],styles:["[_nghost-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),e})();function ln(e,t){1&e&&(o.TgZ(0,"div",9),o.TgZ(1,"label",10),o._uU(2,"Host"),o.TgZ(3,"span"),o._uU(4,"*"),o.qZA(),o._uU(5,":"),o.qZA(),o._UZ(6,"a-user-search-field",11),o.qZA())}function cn(e,t){1&e&&(o.TgZ(0,"div",12),o.TgZ(1,"label",13),o._uU(2,"Start Time:"),o.qZA(),o._UZ(3,"a-time-field",14),o.qZA())}function un(e,t){1&e&&(o.TgZ(0,"div",12),o.TgZ(1,"label",15),o._uU(2,"Duration:"),o.qZA(),o._UZ(3,"a-duration-field",16),o.qZA())}function dn(e,t){1&e&&(o.TgZ(0,"div",17),o.TgZ(1,"label",10),o._uU(2,"Title"),o.TgZ(3,"span"),o._uU(4,"*"),o.qZA(),o._uU(5,":"),o.qZA(),o.TgZ(6,"mat-form-field",18),o._UZ(7,"input",19),o.TgZ(8,"mat-error"),o._uU(9,"Title is required"),o.qZA(),o.qZA(),o.qZA())}function pn(e,t){if(1&e&&(o.TgZ(0,"form",4),o.YNc(1,ln,7,0,"div",5),o.TgZ(2,"div",6),o.YNc(3,cn,4,0,"div",7),o.YNc(4,un,4,0,"div",7),o.qZA(),o.YNc(5,dn,10,0,"div",8),o.qZA()),2&e){const e=o.oxw();o.Q6J("formGroup",e.form),o.xp6(1),o.Q6J("ngIf",e.form.controls.organiser),o.xp6(2),o.Q6J("ngIf",e.form.controls.date),o.xp6(1),o.Q6J("ngIf",e.form.controls.duration),o.xp6(1),o.Q6J("ngIf",e.form.controls.title)}}function hn(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"footer",20),o.TgZ(1,"button",21),o._uU(2," Cancel "),o.qZA(),o.TgZ(3,"button",22),o.NdJ("click",function(){return o.CHM(e),o.oxw().save()}),o._uU(4," Save "),o.qZA(),o.qZA()}}function mn(e,t){1&e&&(o.TgZ(0,"div",23),o._UZ(1,"mat-spinner",24),o.TgZ(2,"p"),o._uU(3,"Processing request..."),o.qZA(),o.qZA()),2&e&&(o.xp6(1),o.Q6J("diameter",32))}let gn=(()=>{class e extends b{constructor(e){super(),this._data=e,this.event=new o.vpe}ngOnInit(){var e;this.form=new l.cw({room_ids:new l.NI([(null===(e=this._data.space)||void 0===e?void 0:e.email)||""]),date:new l.NI(this._data.date||(new Date).valueOf()),duration:new l.NI(30),title:new l.NI(this._data.title||"",[l.kI.required])})}save(){this.form.markAllAsTouched(),this.form.valid?(this.loading=!0,this.event.emit({reason:"done",metadata:new gi(Object.assign({},this.form.value))})):console.log("Invalid form fields. Valid states:",this.form)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(y.WI))},e.\u0275cmp=o.Xpm({type:e,selectors:[["booking-modal"]],outputs:{event:"event"},features:[o.qOj],decls:7,vars:3,consts:[[1,"bg-primary","p-4"],["class","p-2",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex items-center justify-center p-2 w-full border-t border-gray-200 space-x-2",4,"ngIf"],["load_state",""],[1,"p-2",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","space-x-2"],["class","flex-1",4,"ngIf"],["class","flex flex-col",4,"ngIf"],[1,"field"],["for","host"],["name","host","formControlName","organiser"],[1,"flex-1"],["for","start-time"],["name","start-time","formControlName","date"],["for","duration"],["name","duration","formControlName","duration"],[1,"flex","flex-col"],["appearance","outline",1,"w-full"],["matInput","","name","title","placeholder","Meeting Title","formControlName","title"],[1,"flex","items-center","justify-center","p-2","w-full","border-t","border-gray-200","space-x-2"],["mat-button","","name","close","mat-dialog-close","",1,"inverse","w-32"],["mat-button","","name","save",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","p-8"],[3,"diameter"]],template:function(e,t){if(1&e&&(o.TgZ(0,"header",0),o.TgZ(1,"h3"),o._uU(2,"New Booking"),o.qZA(),o.qZA(),o.YNc(3,pn,6,5,"form",1),o.YNc(4,hn,5,0,"footer",2),o.YNc(5,mn,4,1,"ng-template",null,3,o.W1O)),2&e){const e=o.MAs(6);o.xp6(3),o.Q6J("ngIf",t.form&&!t.loading)("ngIfElse",e),o.xp6(1),o.Q6J("ngIf",!t.loading)}},directives:[ye.O5,l._Y,l.JL,l.sg,Hi,l.JJ,l.u,tn,rn,h.KE,m.Nt,l.Fj,h.TO,xe.lW,y.ZT,Ae.$g],styles:["form[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem)}"],data:{animation:[]}}),e})(),fn=(()=>{class e extends b{constructor(e,t){super(),this._dialog_ref=e,this._data=t,this.control_url=this._data.control_url,this.countdown=30}ngOnInit(){this.countdown=30,this.interval("countdown",()=>this.tick(),1e3)}close(){this._dialog_ref.close(),this.countdown=30}reset(){this.countdown=30,this.interval("countdown",()=>this.tick(),1e3)}tick(){this.countdown<=0&&this.close(),this.countdown--}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(y.so),o.Y36(y.WI))},e.\u0275cmp=o.Xpm({type:e,selectors:[["embedded-control-modal"]],features:[o.qOj],decls:11,vars:6,consts:[[1,"absolute","inset-0","bg-white"],["modal","",1,"absolute","w-screen","overflow-hidden","bg-primary",3,"click"],[1,"h-full","w-full","border-none"],[1,"h-full","w-full","border-none",3,"src"],[1,"absolute","top-0","left-0","flex","items-center","h-12"],["countdown","",1,"text-2xl","mx-2"],["mat-icon-button","",1,"close",3,"click","contextmenu"],[1,"text-2xl","mx-2"]],template:function(e,t){1&e&&(o._UZ(0,"div",0),o.TgZ(1,"div",1),o.NdJ("click",function(){return t.reset()},!1,o.Jf7),o.TgZ(2,"div",2),o._UZ(3,"iframe",3),o.ALo(4,"safe"),o.qZA(),o.qZA(),o.TgZ(5,"div",4),o.TgZ(6,"div",5),o._uU(7),o.qZA(),o.TgZ(8,"button",6),o.NdJ("click",function(){return t.close()})("contextmenu",function(e){return e.preventDefault()}),o.TgZ(9,"app-icon",7),o._uU(10,"close"),o.qZA(),o.qZA(),o.qZA()),2&e&&(o.xp6(1),o.Q6J("@show",void 0),o.xp6(2),o.Q6J("src",o.xi3(4,3,t.control_url,"resource"),o.uOi),o.xp6(4),o.Oqu(t.countdown))},directives:[xe.lW,Ye],pipes:[Se],styles:["[modal][_ngcontent-%COMP%]{height:calc(100vh - 3em);box-sizing:content-box;border:2px solid #fff;border-top:1px solid #ccc;transform:translate(-50%,calc(-50% + 1.75em))}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex;align-items:center;height:3em}"],data:{animation:[(0,oe.X$)("show",[(0,oe.eR)(":enter",[(0,oe.oB)({opacity:0}),(0,oe.jt)(500,(0,oe.oB)({opacity:1}))]),(0,oe.eR)(":leave",[(0,oe.oB)({opacity:1}),(0,oe.jt)(1e3,(0,oe.oB)({opacity:0}))])])]}}),e})(),_n=(()=>{class e extends b{constructor(e,t,i){super(),this._spaces=e,this._dialog=t,this._events=i,this._poll=(0,oi.F)(1e3),this._settings=new _.X({}),this._system=new _.X(""),this.settings=this._settings.asObservable(),this.space=(0,_e.aj)([this._system,this._spaces.list]).pipe((0,R.U)(([e,t])=>t.find(t=>t.id===e)),(0,Ct.d)(1)),this.bookings=this._system.pipe((0,Zt.w)(e=>this._listenToModuleBinding(e,"bookings")),(0,R.U)(e=>(null==e?void 0:e.length)?e.map(e=>new gi(e)):[]),(0,Ct.d)(1)),this.current=this._system.pipe((0,Zt.w)(e=>this._listenToModuleBinding(e,"current_booking")),(0,R.U)(e=>e?new gi(e):null),(0,Ct.d)(1)),this.next=this._system.pipe((0,Zt.w)(e=>this._listenToModuleBinding(e,"next_booking")),(0,R.U)(e=>e?new gi(e):null),(0,Ct.d)(1)),this.status=this._settings.pipe((0,R.U)(e=>e.status||"free"),(0,Ct.d)(1)),this._system.pipe((0,ai.h)(e=>!!e)).subscribe(e=>{["disable_book_now","pending","status","control_ui","catering_ui","pending_period","pending_before","room_image","show_qr_code"].forEach(t=>this.bindTo(e,t))})}get system(){return this._system.getValue()}set system(e){this._system.next(e)}setting(e){return this._settings.getValue()[e]}newBooking(e=(new Date).valueOf()){return(0,g.mG)(this,void 0,void 0,function*(){const t=yield function(e,t){return(0,g.mG)(this,void 0,void 0,function*(){const i=t.open(gn,{data:e}),n=(yield Promise.race([i.componentInstance.event.pipe((0,f.P)(e=>"done"===e.reason)).toPromise(),i.afterClosed().toPromise()])).catch(e=>({}));return Object.assign(Object.assign({},n),{close:i.close})})}(Object.assign(Object.assign({},this._settings.getValue()),{space:this._spaces.find(this.system),date:e}),this._dialog);if("done"!==t.reason)return t.close();this._events.newForm(),this._events.form.patchValue(Object.assign({},t.metadata)),yield this._events.postForm(),t.close()})}makeBooking(e){return(0,g.mG)(this,void 0,void 0,function*(){const t=(0,H.rTZ)(this.system,"Bookings");e&&t&&(yield t.execute("book_now",[e.duration,(0,At.Z)(e.date)]).catch(e=>he(`Error creating meeting. ${e}`)))})}confirmStart(){return(0,g.mG)(this,void 0,void 0,function*(){"done"===(yield j({title:"Do you wish to start your meeting?",content:`If you don't start your meeting it will be cancelled ${this._settings.getValue().pending_period/60} minutes after the start time.`,icon:{class:"material-icons",content:"play_arrow"}},this._dialog)).reason&&this.startMeeting()})}startMeeting(){return(0,g.mG)(this,void 0,void 0,function*(){if(this.space&&"pending"===(yield this.status.toPromise())){const e=(yield this.current.toPromise())||(yield this.next.toPromise()),t=(0,H.rTZ)(this.system,"Bookings");e&&t&&(yield t.execute("start_meeting",[e.date]).catch(e=>he(`Error starting meeting. ${e}`)))}})}confirmEnd(){return(0,g.mG)(this,void 0,void 0,function*(){"done"===(yield j({title:"Are you sure want to end your meeting?",content:"Ending your meeting early will free up this room for others to use",icon:{class:"material-icons",content:"stop"}},this._dialog)).reason&&this.endCurrent()})}endCurrent(e="user_input"){return(0,g.mG)(this,void 0,void 0,function*(){const t=yield this.current.pipe((0,ri.q)(1)).toPromise(),i=(0,H.rTZ)(this.system,"Bookings");t&&i&&(yield i.execute("cancel_meeting",[t.date,e]).catch(e=>he(`Error starting meeting. ${e}`)))})}viewControl(){return(0,g.mG)(this,void 0,void 0,function*(){const e=this._settings.getValue().control_ui;e&&this._dialog.open(fn,{data:{control_url:e}})})}confirmWaiter(){return(0,g.mG)(this,void 0,void 0,function*(){"done"===(yield j({title:"Do you wish to call a waiter?",content:"Note that it can take up to 15 minutes for them to turn up.",icon:{class:"material-icons",content:"room_service"}},this._dialog)).reason&&this.callWaiter()})}callWaiter(){return(0,g.mG)(this,void 0,void 0,function*(){const e=(0,H.rTZ)(this.system,"Bookings");e&&(yield e.execute("waiter_call",[Date.now()]).catch(e=>he(`Error calling waiter. ${e}`)))})}bindTo(e,t,i="Bookings",n=(e=>this.updateProperty(t,e))){const s=(0,H.rTZ)(e,i).binding(t);this.subscription(`listen:${t}`,s.listen().subscribe(n)),this.subscription(`bind:${t}`,s.bind())}updateProperty(e,t){const i=Object.assign({},this._settings.getValue());i[e]=t,this._settings.next(i)}_listenToModuleBinding(e,t,i="Bookings"){const n=(0,H.rTZ)(e,i).binding(t);return this.subscription(`binding:${i}:${t}`,n.bind()),n.listen()}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(ut),o.LFG(y.uw),o.LFG(xi))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac}),e})();function vn(e,t){if(1&e&&(o.TgZ(0,"p"),o._uU(1),o.ALo(2,"async"),o.qZA()),2&e){const e=o.oxw();let t;o.xp6(1),o.hij(" ",null==(t=o.lcZ(2,1,e.space))?null:t.description," ")}}function bn(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",8),o.NdJ("click",function(){return o.CHM(e),o.oxw(2).newEvent()}),o.TgZ(1,"div",9),o.TgZ(2,"app-icon",10),o._uU(3,"add_circle_outline"),o.qZA(),o.TgZ(4,"span",11),o._uU(5,"New Event"),o.qZA(),o.qZA(),o.qZA()}}function yn(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",12),o.NdJ("click",function(){return o.CHM(e),o.oxw(2).viewControl()}),o.TgZ(1,"div",9),o.TgZ(2,"app-icon",10),o._uU(3,"settings_remote"),o.qZA(),o.TgZ(4,"span",11),o._uU(5,"View Control"),o.qZA(),o.qZA(),o.qZA()}}function xn(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",13),o.NdJ("click",function(){return o.CHM(e),o.oxw(2).callWaiter()}),o.TgZ(1,"div",9),o.TgZ(2,"app-icon",10),o._uU(3,"room_service"),o.qZA(),o.TgZ(4,"span",11),o._uU(5,"Call Waiter"),o.qZA(),o.qZA(),o.qZA()}}function wn(e,t){if(1&e&&(o.TgZ(0,"div",4),o.YNc(1,bn,6,0,"button",5),o.ALo(2,"async"),o.YNc(3,yn,6,0,"button",6),o.ALo(4,"async"),o.YNc(5,xn,6,0,"button",7),o.ALo(6,"async"),o.qZA()),2&e){const e=o.oxw();let t,i,n;o.xp6(1),o.Q6J("ngIf",!(null!=(t=o.lcZ(2,3,e.options))&&t.disable_book_now)),o.xp6(2),o.Q6J("ngIf",null==(i=o.lcZ(4,5,e.options))?null:i.control_ui),o.xp6(2),o.Q6J("ngIf",null==(n=o.lcZ(6,7,e.options))?null:n.catering_ui)}}function Zn(e,t){1&e&&(o.TgZ(0,"div",14),o.TgZ(1,"p"),o._uU(2,"No available actions for this space"),o.qZA(),o.qZA())}let Cn=(()=>{class e{constructor(e){this._state=e,this.space=this._state.space,this.options=this._state.settings,this.newEvent=()=>this._state.newBooking(),this.callWaiter=()=>this._state.confirmWaiter(),this.viewControl=()=>this._state.viewControl()}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(_n))},e.\u0275cmp=o.Xpm({type:e,selectors:[["panel-details"]],decls:10,vars:12,consts:[[1,"text-4xl","font-medium","mb-8"],[4,"ngIf"],["class","flex flex-col items-center space-y-2",4,"ngIf","ngIfElse"],["empty_state",""],[1,"flex","flex-col","items-center","space-y-2"],["event","","mat-button","","class","w-48",3,"click",4,"ngIf"],["control","","mat-button","","class","w-48",3,"click",4,"ngIf"],["waiter","","mat-button","","class","w-48",3,"click",4,"ngIf"],["event","","mat-button","",1,"w-48",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"mx-2"],["control","","mat-button","",1,"w-48",3,"click"],["waiter","","mat-button","",1,"w-48",3,"click"],[1,"flex","flex-col","items-center"]],template:function(e,t){if(1&e&&(o.TgZ(0,"h1",0),o._uU(1),o.ALo(2,"async"),o.ALo(3,"async"),o.qZA(),o.YNc(4,vn,3,3,"p",1),o.ALo(5,"async"),o.YNc(6,wn,7,9,"div",2),o.ALo(7,"async"),o.YNc(8,Zn,3,0,"ng-template",null,3,o.W1O)),2&e){const e=o.MAs(9);let i,n,s;o.xp6(1),o.hij(" ",(null==(i=o.lcZ(2,4,t.space))?null:i.display_name)||(null==(i=o.lcZ(3,6,t.space))?null:i.name)||"<Unknown Space>"," "),o.xp6(3),o.Q6J("ngIf",null==(n=o.lcZ(5,8,t.space))?null:n.description),o.xp6(2),o.Q6J("ngIf",!(null!=(s=o.lcZ(7,10,t.options))&&s.hide_actions))("ngIfElse",e)}},directives:[ye.O5,xe.lW,Ye],pipes:[ye.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}"]}),e})();var kn=i(9574);function An(e,t){if(1&e&&(o.TgZ(0,"span",8),o._uU(1),o.ALo(2,"async"),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.hij(" Starting in ",o.lcZ(2,1,e.starting_in)," ")}}function Tn(e,t){1&e&&(o.TgZ(0,"span",9),o._uU(1," In Progress "),o.qZA())}function qn(e,t){1&e&&(o.TgZ(0,"span",10),o._uU(1," Waiting to start "),o.qZA())}function On(e,t){if(1&e&&(o.TgZ(0,"h2",4),o._uU(1," Current "),o.YNc(2,An,3,3,"span",5),o.ALo(3,"async"),o.ALo(4,"async"),o.YNc(5,Tn,2,0,"span",6),o.ALo(6,"async"),o.ALo(7,"async"),o.YNc(8,qn,2,0,"span",7),o.ALo(9,"async"),o.ALo(10,"async"),o.ALo(11,"async"),o.qZA()),2&e){const e=o.oxw();let t;o.xp6(2),o.Q6J("ngIf",!o.lcZ(3,3,e.started)&&o.lcZ(4,5,e.starting_in)),o.xp6(3),o.Q6J("ngIf",o.lcZ(6,7,e.started)&&!o.lcZ(7,9,e.pending)),o.xp6(3),o.Q6J("ngIf",("upcoming"===(null==(t=o.lcZ(9,11,e.current))?null:t.state)||"in_progress"===(null==(t=o.lcZ(10,13,e.current))?null:t.state))&&o.lcZ(11,15,e.pending))}}function In(e,t){if(1&e&&(o.TgZ(0,"div",17),o.TgZ(1,"span"),o.ALo(2,"async"),o._uU(3),o.ALo(4,"date"),o.ALo(5,"async"),o.qZA(),o._UZ(6,"br"),o.TgZ(7,"span"),o.ALo(8,"async"),o._uU(9),o.ALo(10,"date"),o.ALo(11,"async"),o.qZA(),o.qZA()),2&e){const e=o.oxw(2);let t,i;o.xp6(1),o.ekj("opacity-60",o.lcZ(2,6,e.started)),o.xp6(2),o.Oqu(o.xi3(4,8,1e3*(null==(t=o.lcZ(5,11,e.current))?null:t.event_start),"shortTime")),o.xp6(4),o.ekj("opacity-60",!o.lcZ(8,13,e.started)),o.xp6(2),o.Oqu(o.xi3(10,15,1e3*(null==(i=o.lcZ(11,18,e.current))?null:i.event_end),"shortTime"))}}function Un(e,t){if(1&e&&(o.TgZ(0,"div",18),o.TgZ(1,"div",19),o._uU(2,"Ends at:"),o.qZA(),o.TgZ(3,"div"),o._uU(4),o.ALo(5,"date"),o.ALo(6,"async"),o.ALo(7,"async"),o.qZA(),o.qZA()),2&e){const e=o.oxw(2);let t;o.xp6(4),o.hij(" ",o.xi3(5,1,(null==(t=o.lcZ(6,4,e.current))?null:t.date)+60*(null==(t=o.lcZ(7,6,e.current))?null:t.duration)*1e3,"shortTime")," ")}}function jn(e,t){if(1&e&&(o.TgZ(0,"div",11),o.TgZ(1,"div",12),o.ALo(2,"async"),o.TgZ(3,"div",13),o.ALo(4,"async"),o.ALo(5,"async"),o.qZA(),o.YNc(6,In,12,20,"div",14),o.ALo(7,"async"),o.YNc(8,Un,8,8,"div",15),o.ALo(9,"async"),o.TgZ(10,"div",16),o._uU(11),o.ALo(12,"async"),o.qZA(),o.qZA(),o.qZA()),2&e){const e=o.oxw();let t;o.xp6(1),o.ekj("text-white",o.lcZ(2,9,e.started)),o.xp6(2),o.ekj("opacity-100",o.lcZ(4,11,e.started))("opacity-0",!o.lcZ(5,13,e.started)),o.xp6(3),o.Q6J("ngIf",!o.lcZ(7,15,e.started)),o.xp6(2),o.Q6J("ngIf",o.lcZ(9,17,e.started)),o.xp6(3),o.hij(" ",(null==(t=o.lcZ(12,19,e.current))?null:t.title)||"<Private Event>"," ")}}function Nn(e,t){1&e&&(o.TgZ(0,"h2",4),o._uU(1," Upcoming "),o.qZA())}function Mn(e,t){if(1&e&&(o.TgZ(0,"li",23),o.TgZ(1,"div",24),o._uU(2),o.ALo(3,"date"),o.qZA(),o.TgZ(4,"div",25),o._uU(5),o.qZA(),o.qZA()),2&e){const e=t.$implicit;o.xp6(2),o.hij(" ",o.xi3(3,2,null==e?null:e.date,"shortTime")," "),o.xp6(3),o.hij(" ",(null==e?null:e.title)||"<Private Event>"," ")}}function $n(e,t){1&e&&o._UZ(0,"li",23)}function Ln(e,t){if(1&e&&(o.TgZ(0,"ul",20),o.YNc(1,Mn,6,5,"li",21),o.ALo(2,"slice"),o.ALo(3,"async"),o.YNc(4,$n,1,0,"li",22),o.ALo(5,"async"),o.qZA()),2&e){const e=o.oxw();let t;o.xp6(1),o.Q6J("ngForOf",o.Dn7(2,2,o.lcZ(3,6,e.upcoming),0,2)),o.xp6(3),o.Q6J("ngIf",(null==(t=o.lcZ(5,8,e.upcoming))?null:t.length)>2)}}function Sn(e,t){1&e&&(o.TgZ(0,"div",26),o.TgZ(1,"p",27),o._uU(2,"No upcoming events for today"),o.qZA(),o.qZA())}let Jn=(()=>{class e{constructor(e){this._state=e,this.bookings=this._state.bookings.pipe((0,R.U)(e=>e.filter(e=>"done"!==e.state&&(0,D.Z)(e.date,new Date)))),this.current=this.bookings.pipe((0,R.U)(e=>e.sort((e,t)=>e.date-t.date)[0])),this.started=(0,_e.aj)([this.current,(0,oi.F)(600)]).pipe((0,R.U)(([e])=>(0,Ot.Z)(Date.now(),e.date))),this.starting_in=(0,_e.aj)([this.current,(0,oi.F)(600)]).pipe((0,R.U)(([e])=>{const t=e?(0,kn.Z)(e.date,new Date):0;return t&&t<3600?`${(0,nn.Z)({hours:Math.floor(t/60/60),minutes:Math.floor(t/60)%60,seconds:t<60?t:0})}`:""})),this.pending=(0,_e.aj)([this.current,this._state.settings,(0,oi.F)(600)]).pipe((0,R.U)(([e,t])=>e&&t.pending_period&&t.pending)),this.upcoming=this.bookings.pipe((0,R.U)(e=>e.sort((e,t)=>e.date-t.date).slice(1)))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(_n))},e.\u0275cmp=o.Xpm({type:e,selectors:[["panel-booking-list"]],decls:10,vars:13,consts:[["class","w-full px-4 py-2 mb-2 font-medium",4,"ngIf"],["class","mb-4 w-full",4,"ngIf","ngIfElse"],["class","list-style-none p-0 m-0 bg-white rounded text-base shadow divide-y divide-gray-100 w-full border border-gray-100 max-w-full",4,"ngIf"],["empty_state",""],[1,"w-full","px-4","py-2","mb-2","font-medium"],["class","text-xs shadow px-2 py-1 ml-8 rounded bg-gray-300",4,"ngIf"],["class","text-xs shadow px-2 py-1 ml-8 rounded bg-error text-white",4,"ngIf"],["class","text-xs shadow px-2 py-1 ml-8 rounded bg-pending text-white",4,"ngIf"],[1,"text-xs","shadow","px-2","py-1","ml-8","rounded","bg-gray-300"],[1,"text-xs","shadow","px-2","py-1","ml-8","rounded","bg-error","text-white"],[1,"text-xs","shadow","px-2","py-1","ml-8","rounded","bg-pending","text-white"],[1,"mb-4","w-full"],["current","",1,"flex","items-center","bg-white","rounded-lg","px-4","h-24","text-lg","shadow-md","w-full","border","border-gray-100","relative","max-w-full"],["color","",1,"absolute","-left-2","-right-2","top-2","bottom-2","bg-primary","rounded","z-0"],["class","relative opacity-80 w-24 text-base z-10",4,"ngIf"],["class","relative opacity-80 w-24 text-base z-10 flex flex-col",4,"ngIf"],[1,"relative","truncate","z-10"],[1,"relative","opacity-80","w-24","text-base","z-10"],[1,"relative","opacity-80","w-24","text-base","z-10","flex","flex-col"],[1,"text-xs"],[1,"list-style-none","p-0","m-0","bg-white","rounded","text-base","shadow","divide-y","divide-gray-100","w-full","border","border-gray-100","max-w-full"],["upcoming","","class","flex items-center w-full p-4",4,"ngFor","ngForOf"],["upcoming","","class","flex items-center w-full p-4",4,"ngIf"],["upcoming","",1,"flex","items-center","w-full","p-4"],[1,"opacity-60","w-24"],[1,"truncate"],[1,"flex","items-center","justify-center","bg-white","rounded","px-4","py-8","shadow-md","w-full","border","border-gray-100"],[1,"opacity-50"]],template:function(e,t){if(1&e&&(o.YNc(0,On,12,17,"h2",0),o.ALo(1,"async"),o.YNc(2,jn,13,21,"div",1),o.ALo(3,"async"),o.YNc(4,Nn,2,0,"h2",0),o.ALo(5,"async"),o.YNc(6,Ln,6,10,"ul",2),o.ALo(7,"async"),o.YNc(8,Sn,3,0,"ng-template",null,3,o.W1O)),2&e){const e=o.MAs(9);let i,n;o.Q6J("ngIf",o.lcZ(1,5,t.current)),o.xp6(2),o.Q6J("ngIf",o.lcZ(3,7,t.current))("ngIfElse",e),o.xp6(2),o.Q6J("ngIf",null==(i=o.lcZ(5,9,t.upcoming))?null:i.length),o.xp6(2),o.Q6J("ngIf",null==(n=o.lcZ(7,11,t.upcoming))?null:n.length)}},directives:[ye.O5,ye.sg],pipes:[ye.Ov,ye.uU,ye.OU],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;color:#000}[current][_ngcontent-%COMP%]{transition:color .2s}[current][_ngcontent-%COMP%]   [color][_ngcontent-%COMP%]{transition:opacity .2s}"]}),e})(),En=(()=>{class e{constructor(e){this._state=e,this.settings=this._state.settings}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(_n))},e.\u0275cmp=o.Xpm({type:e,selectors:[["panel-status"]],decls:5,vars:16,consts:[["status","",1,"h-12","w-[calc(100%","-","2rem)]","m-2","rounded","shadow"]],template:function(e,t){if(1&e&&(o._UZ(0,"div",0),o.ALo(1,"async"),o.ALo(2,"async"),o.ALo(3,"async"),o.ALo(4,"async")),2&e){let e,i,n,s;o.ekj("bg-gray-300","not-bookable"===(null==(e=o.lcZ(1,8,t.settings))?null:e.status))("bg-pending","pending"===(null==(i=o.lcZ(2,10,t.settings))?null:i.status))("bg-success","free"===(null==(n=o.lcZ(3,12,t.settings))?null:n.status))("bg-error","busy"===(null==(s=o.lcZ(4,14,t.settings))?null:s.status))}},pipes:[ye.Ov],styles:[""]}),e})(),Pn=(()=>{class e{constructor(e){this._settings=e}get logo(){return this._settings.get("app.logo_dark")||{}}get time(){return 1e3*(0,At.Z)(new Date)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(se))},e.\u0275cmp=o.Xpm({type:e,selectors:[["panel-topbar"]],decls:11,vars:9,consts:[[1,"w-full","flex","items-center","justify-between","h-16","border-b","border-gray-200","bg-secondary","text-white"],["alt","Logo",1,"h-12","mx-2",3,"src"],["time","",1,"flex","items-center","space-x-2","mx-4","text-xl"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o._UZ(1,"img",1),o.TgZ(2,"div",2),o.TgZ(3,"span"),o._uU(4),o.ALo(5,"date"),o.qZA(),o.TgZ(6,"span"),o._uU(7," \u2022 "),o.qZA(),o.TgZ(8,"span"),o._uU(9),o.ALo(10,"date"),o.qZA(),o.qZA(),o.qZA()),2&e&&(o.xp6(1),o.Q6J("src",t.logo.src,o.LSH),o.xp6(3),o.Oqu(o.xi3(5,3,t.time,"shortTime")),o.xp6(5),o.Oqu(o.xi3(10,6,t.time,"mediumDate")))},pipes:[ye.uU],styles:[""]}),e})();function Yn(e,t){1&e&&o._UZ(0,"panel-topbar")}let Qn=(()=>{class e extends b{constructor(e,t){super(),this._state=e,this._route=t,this.system_id=localStorage.getItem("PLACEOS.BOOKINGS.system"),this.topbar=!0}ngOnInit(){this._state.system=this.system_id||"",this.subscription("route.params",this._route.paramMap.subscribe(e=>{e.has("system_id")&&(this._state.system=e.get("system_id"))}))}ngOnChanges(e){e.system_id&&(this._state.system=this.system_id)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(_n),o.Y36(c.gz))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-booking-panel"]],inputs:{system_id:"system_id",topbar:"topbar"},features:[o._Bn([_n]),o.qOj,o.TTD],decls:6,vars:13,consts:[[1,"flex","flex-col","absolute","inset-0","bg-gray-50"],[4,"ngIf"],["content","",1,"flex","flex-1","items-center","h-1/2","space-x-2"],[1,"flex-1","h-full","max-w-[50%]"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o.YNc(1,Yn,1,0,"panel-topbar",1),o.TgZ(2,"div",2),o._UZ(3,"panel-details",3),o._UZ(4,"panel-booking-list",3),o.qZA(),o._UZ(5,"panel-status"),o.qZA()),2&e&&(o.xp6(1),o.Q6J("ngIf",t.topbar),o.xp6(1),o.ekj("p-8",t.topbar)("p-4",!t.topbar),o.xp6(1),o.ekj("p-4",t.topbar)("p-2",!t.topbar),o.xp6(1),o.ekj("p-4",t.topbar)("p-2",!t.topbar))},directives:[ye.O5,Cn,Jn,En,Pn],styles:[""]}),e})();function Fn(e,t){if(1&e&&o._UZ(0,"app-booking-panel",8),2&e){const e=o.oxw().$implicit;o.Q6J("system_id",e)("topbar",!1)}}function Dn(e,t){if(1&e&&(o.TgZ(0,"div",6),o.YNc(1,Fn,1,2,"app-booking-panel",7),o.qZA()),2&e){const e=t.$implicit,i=o.oxw(2);o.Udp("height",i.systems.length>=2?"50%":"100%"),o.xp6(1),o.Q6J("ngIf",e)}}function Bn(e,t){if(1&e&&(o.ynx(0),o.YNc(1,Dn,2,3,"div",5),o.ALo(2,"slice"),o.BQk()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("ngForOf",o.Dn7(2,1,e.systems,0,4))}}function zn(e,t){1&e&&(o.TgZ(0,"div",9),o.TgZ(1,"p"),o._uU(2,"No systems are set for displaying on the panel array"),o.qZA(),o.qZA())}let Hn=(()=>{class e extends b{constructor(e){super(),this.route=e}ngOnInit(){return(0,g.mG)(this,void 0,void 0,function*(){this.subscription("route.query",this.route.queryParamMap.subscribe(e=>{e.has("system_ids")&&(this.systems=(e.get("system_ids")||"").split(",").filter(e=>!!e))}))})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(c.gz))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-booking-panel-array"]],features:[o.qOj],decls:6,vars:2,consts:[[1,"absolute","inset-0","flex","flex-col"],[1,"w-full"],[1,"flex","items-center","justify-center","flex-wrap","w-full","flex-1","h-1/2"],[4,"ngIf","ngIfElse"],["none",""],["panel","","class","relative flex-1 border border-grey-300 overflow-hidden",3,"height",4,"ngFor","ngForOf"],["panel","",1,"relative","flex-1","border","border-grey-300","overflow-hidden"],["classs","transform scale-75",3,"system_id","topbar",4,"ngIf"],["classs","transform scale-75",3,"system_id","topbar"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0),o._UZ(1,"panel-topbar",1),o.TgZ(2,"div",2),o.YNc(3,Bn,3,5,"ng-container",3),o.qZA(),o.qZA(),o.YNc(4,zn,3,0,"ng-template",null,4,o.W1O)),2&e){const e=o.MAs(5);o.xp6(3),o.Q6J("ngIf",(null==t.systems?null:t.systems.length)>0)("ngIfElse",e)}},directives:[Pn,ye.O5,ye.sg,Qn],pipes:[ye.OU],styles:["[panel][_ngcontent-%COMP%]{min-width:40%}.container[_ngcontent-%COMP%]{background-color:var(--bg-dark);background-image:url(\"data:image/svg+xml,%3Csvg width='24' height='20' viewBox='0 0 24 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 18c0-1.105.887-2 1.998-2 1.104 0 2-.895 2.002-1.994V14v6h-4v-2zM0 13.998C0 12.895.888 12 2 12c1.105 0 2 .888 2 2 0 1.105.888 2 2 2 1.105 0 2 .888 2 2v2H0v-6.002zm16 4.004A1.994 1.994 0 0 1 14 20c-1.105 0-2-.887-2-1.998v-4.004A1.994 1.994 0 0 0 10 12c-1.105 0-2-.888-2-2 0-1.105-.888-2-2-2-1.105 0-2-.887-2-1.998V1.998A1.994 1.994 0 0 0 2 0a2 2 0 0 0-2 2V0h8v2c0 1.105.888 2 2 2 1.105 0 2 .888 2 2 0 1.105.888 2 2 2 1.105 0 2-.888 2-2 0-1.105.888-2 2-2 1.105 0 2-.888 2-2V0h4v6.002A1.994 1.994 0 0 1 22 8c-1.105 0-2 .888-2 2 0 1.105-.888 2-2 2-1.105 0-2 .887-2 1.998v4.004z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E\");color:var(--font-light)}img[_ngcontent-%COMP%]{max-width:12em}"]}),e})();function Vn(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",12),o.TgZ(1,"i",13),o.NdJ("modelChange",function(t){o.CHM(e);const i=o.oxw().$implicit;return o.oxw(2).system_name[i]=t}),o.qZA(),o.TgZ(2,"i",14),o.NdJ("modelChange",function(t){o.CHM(e);const i=o.oxw().$implicit;return o.oxw(2).system_icon[i]=t}),o.qZA(),o.TgZ(3,"i",15),o.NdJ("modelChange",function(t){o.CHM(e);const i=o.oxw().$implicit;return o.oxw(2).system_status[i]=t}),o.qZA(),o.qZA()}if(2&e){const e=o.oxw().$implicit,t=o.oxw(2);o.xp6(1),o.Q6J("sys",e)("model",t.system_name[e]),o.xp6(1),o.Q6J("sys",e)("model",t.system_icon[e]),o.xp6(1),o.Q6J("sys",e)}}function Gn(e,t){if(1&e&&o._UZ(0,"img",16),2&e){const e=o.oxw().$implicit,t=o.oxw(2);o.Q6J("src",t.system_icon[e],o.LSH)}}function Rn(e,t){1&e&&o._UZ(0,"mat-spinner",17),2&e&&o.Q6J("diameter",32)}function Xn(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",6),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw(2).showPanel(t)}),o.YNc(1,Vn,4,5,"div",7),o.TgZ(2,"div",8),o.YNc(3,Gn,1,1,"img",9),o.YNc(4,Rn,1,1,"mat-spinner",10),o.qZA(),o.TgZ(5,"div",11),o._uU(6),o.qZA(),o.qZA()}if(2&e){const e=t.$implicit,i=o.oxw(2);o.xp6(1),o.Q6J("ngIf",e),o.xp6(1),o.Tol("h-36 w-36 flex items-center justify-center text-6xl bg-white bg-opacity-10 rounded"+(i.system_status[e]?" "+i.system_status[e]:"")),o.xp6(1),o.Q6J("ngIf",i.system_name[e]),o.xp6(1),o.Q6J("ngIf",!i.system_name[e]),o.xp6(2),o.hij(" ",i.system_name[e]||e+" connecting..."," ")}}function Wn(e,t){if(1&e&&(o.ynx(0),o.YNc(1,Xn,7,6,"button",5),o.ALo(2,"slice"),o.BQk()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("ngForOf",o.Dn7(2,1,e.systems,0,8))}}function Kn(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",18),o._UZ(1,"app-booking-panel",19),o.TgZ(2,"div",20),o.TgZ(3,"button",21),o.NdJ("click",function(){return o.CHM(e),o.oxw().close()})("contextmenu",function(e){return e.preventDefault()}),o.TgZ(4,"app-icon"),o._uU(5,"close"),o.qZA(),o.qZA(),o.TgZ(6,"button",22),o.NdJ("contextmenu",function(e){return e.preventDefault()}),o._uU(7),o.qZA(),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(1),o.Q6J("system_id",e.active_system),o.xp6(6),o.hij(" ",e.countdown," ")}}function es(e,t){1&e&&(o.TgZ(0,"div",23),o.TgZ(1,"p"),o._uU(2," No systems are set for displaying on the panel select list "),o.qZA(),o.qZA())}let ts=(()=>{class e extends b{constructor(e){super(),this.route=e,this.system_name={},this.system_icon={},this.system_status={}}ngOnInit(){this.subscription("route.query",this.route.queryParamMap.subscribe(e=>{e.has("system_ids")&&(this.systems=(e.get("system_ids")||"").split(","))}))}showPanel(e){this.active_system=e,this.reset()}updateStatus(e,t){const i=function(e,t=(new Date).valueOf()){return e.find(e=>N(t,t,e.date,e.date+1e3*e.duration))}((t||[]).map(e=>new gi(e)));this.system_status[e]=i?"unavailable":"available"}close(){this.active_system=null,this.clearInterval("countdown")}reset(){this.active_system&&(this.countdown=30,this.interval("countdown",()=>this.tick(),1e3))}tick(){this.countdown<=0&&this.close(),this.countdown--}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(c.gz))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-booking-panel-select"]],features:[o.qOj],decls:6,vars:3,consts:[[1,"absolute","inset-0","flex","items-center","justify-center","flex-wrap","bg-gray-600",3,"mousedown","touchstart"],[1,"flex","items-center","justify-center","flex-wrap","w-full","h-full","p-8"],[4,"ngIf","ngIfElse"],["class","absolute inset-0 border border-white",4,"ngIf"],["none",""],["matRipple","","class","item text-white flex flex-col items-center justify-center rounded m-2 p-2",3,"click",4,"ngFor","ngForOf"],["matRipple","",1,"item","text-white","flex","flex-col","items-center","justify-center","rounded","m-2","p-2",3,"click"],["class","bindings",4,"ngIf"],["state",""],[3,"src",4,"ngIf"],[3,"diameter",4,"ngIf"],[1,"truncate","text-sm","p-3","text-white","w-full","text"],[1,"bindings"],["binding","","mod","Bookings","bind","room_name",3,"sys","model","modelChange"],["binding","","mod","Bookings","bind","icon",3,"sys","model","modelChange"],["binding","","mod","Bookings","bind","status",3,"sys","modelChange"],[3,"src"],[3,"diameter"],[1,"absolute","inset-0","border","border-white"],[3,"system_id"],[1,"absolute","top-0","left-1/2","transform","-translate-x-1/2","flex","items-center","bg-white","rounded-b","p-2"],["mat-icon-button","",1,"action","close",3,"click","contextmenu"],["widget","",1,"action","countdown","w-12","h-10",3,"contextmenu"],[1,"absolute","inset-0","flex","items-center","justify-center"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0),o.NdJ("mousedown",function(){return t.reset()},!1,o.Jf7)("touchstart",function(){return t.reset()},!1,o.Jf7),o.TgZ(1,"div",1),o.YNc(2,Wn,3,5,"ng-container",2),o.qZA(),o.YNc(3,Kn,8,2,"div",3),o.YNc(4,es,3,0,"ng-template",null,4,o.W1O),o.qZA()),2&e){const e=o.MAs(5);o.xp6(2),o.Q6J("ngIf",t.systems&&t.systems.length>0)("ngIfElse",e),o.xp6(1),o.Q6J("ngIf",t.active_system)}},directives:[ye.O5,ye.sg,qe.wG,je,Ae.$g,Qn,xe.lW,Ye],pipes:[ye.OU],styles:[".item[_ngcontent-%COMP%]{height:11.5em;width:10em;background-color:var(--bg-dark);box-shadow:0 1px 3px 0 rgba(#000,.2),0 1px 1px 0 rgba(#000,.14),0 2px 1px -1px rgba(#000,.12)}.free[_ngcontent-%COMP%]{background-color:rgba(var(--success),.6)}.busy[_ngcontent-%COMP%]{background-color:rgba(var(--error),.6)}img[_ngcontent-%COMP%]{max-width:1em;max-height:1em}"]}),e})();function is(e){var t=this;e="object"==typeof e?e:{},t.revision=3,t.imageTypes={bmp:"image/bmp",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpg",png:"image/png","svg+xml":"image/svg+xml",tiff:"image/tiff",webp:"image/webp","x-icon":"image/x-icon"},t.toTable=e.toTable,t.domElement=t.toTable?document.createElement("div"):document.createElement("canvas"),t.url=e.url||"",t.size=e.size||280,t.qrc=!1,t.colorLight=e.colorLight||"#fff",t.colorDark=e.colorDark||"#000",t.ecclevel=e.ecclevel||1,t.noBorder=e.noBorder,t.borderSize=e.borderSize||4;var i,n,s,o,a,r,l,c=[],u=[],d=[],p=[],h=[],m=[],g=function(e,t){var i;e>t&&(i=e,e=t,t=i),i=t,i*=t,i+=t,i>>=1,p[i+=e]=1},f=function(e,t){var i;for(d[e+s*t]=1,i=-2;i<2;i++)d[e+i+s*(t-2)]=1,d[e-2+s*(t+i+1)]=1,d[e+2+s*(t+i)]=1,d[e+i+1+s*(t+2)]=1;for(i=0;i<2;i++)g(e-1,t+i),g(e+1,t-i),g(e-i,t-1),g(e+i,t+1)},_=function(e){for(;e>=255;)e=((e-=255)>>8)+(255&e);return e},v=function(e,t,i,n){var s,o,a,r=is.gexp,l=is.glog;for(s=0;s<n;s++)c[i+s]=0;for(s=0;s<t;s++){if(255!=(a=l[c[e+s]^c[i]]))for(o=1;o<n;o++)c[i+o-1]=c[i+o]^r[_(a+m[n-o])];else for(o=i;o<i+n;o++)c[o]=c[o+1];c[i+n-1]=255==a?0:r[_(a+m[0])]}},b=function(e,t){var i;return e>t&&(i=e,e=t,t=i),i=t,i+=t*t,i>>=1,p[i+=e]},y=function(e){var t,i,n,o;switch(e){case 0:for(i=0;i<s;i++)for(t=0;t<s;t++)t+i&1||b(t,i)||(d[t+i*s]^=1);break;case 1:for(i=0;i<s;i++)for(t=0;t<s;t++)1&i||b(t,i)||(d[t+i*s]^=1);break;case 2:for(i=0;i<s;i++)for(n=0,t=0;t<s;t++,n++)3==n&&(n=0),n||b(t,i)||(d[t+i*s]^=1);break;case 3:for(o=0,i=0;i<s;i++,o++)for(3==o&&(o=0),n=o,t=0;t<s;t++,n++)3==n&&(n=0),n||b(t,i)||(d[t+i*s]^=1);break;case 4:for(i=0;i<s;i++)for(n=0,o=i>>1&1,t=0;t<s;t++,n++)3==n&&(n=0,o=!o),o||b(t,i)||(d[t+i*s]^=1);break;case 5:for(o=0,i=0;i<s;i++,o++)for(3==o&&(o=0),n=0,t=0;t<s;t++,n++)3==n&&(n=0),(t&i&1)+!(!n|!o)||b(t,i)||(d[t+i*s]^=1);break;case 6:for(o=0,i=0;i<s;i++,o++)for(3==o&&(o=0),n=0,t=0;t<s;t++,n++)3==n&&(n=0),(t&i&1)+(n&&n==o)&1||b(t,i)||(d[t+i*s]^=1);break;case 7:for(o=0,i=0;i<s;i++,o++)for(3==o&&(o=0),n=0,t=0;t<s;t++,n++)3==n&&(n=0),(n&&n==o)+(t+i&1)&1||b(t,i)||(d[t+i*s]^=1)}},x=function(e){var t,i=0;for(t=0;t<=e;t++)h[t]>=5&&(i+=is.N1+h[t]-5);for(t=3;t<e-1;t+=2)h[t-2]==h[t+2]&&h[t+2]==h[t-1]&&h[t-1]==h[t+1]&&3*h[t-1]==h[t]&&(0==h[t-3]||t+3>e||3*h[t-3]>=4*h[t]||3*h[t+3]>=4*h[t])&&(i+=is.N3);return i},w=function(){var e,t,i,n,o,a=0,r=0;for(t=0;t<s-1;t++)for(e=0;e<s-1;e++)(d[e+s*t]&&d[e+1+s*t]&&d[e+s*(t+1)]&&d[e+1+s*(t+1)]||!(d[e+s*t]||d[e+1+s*t]||d[e+s*(t+1)]||d[e+1+s*(t+1)]))&&(a+=is.N2);for(t=0;t<s;t++){for(h[0]=0,i=n=e=0;e<s;e++)(o=d[e+s*t])==n?h[i]++:h[++i]=1,r+=(n=o)?1:-1;a+=x(i)}r<0&&(r=-r);var l=r,c=0;for(l+=l<<2,l<<=1;l>s*s;)l-=s*s,c++;for(a+=c*is.N4,e=0;e<s;e++){for(h[0]=0,i=n=t=0;t<s;t++)(o=d[e+s*t])==n?h[i]++:h[++i]=1,n=o;a+=x(i)}return a};t.genframe=function(e){var t,h,x,Z,C,k,A,T,q=is.eccblocks,O=is.gexp,I=is.glog;Z=e.length,n=0;do{if(n++,x=4*(i-1)+16*(n-1),o=q[x++],a=q[x++],r=q[x++],l=q[x],Z<=(x=r*(o+a)+a-3+(n<=9)))break}while(n<40);for(s=17+4*n,C=r+(r+l)*(o+a)+a,Z=0;Z<C;Z++)u[Z]=0;for(c=e.slice(0),Z=0;Z<s*s;Z++)d[Z]=0;for(Z=0;Z<(s*(s+1)+1)/2;Z++)p[Z]=0;for(Z=0;Z<3;Z++){for(x=0,h=0,1==Z&&(x=s-7),2==Z&&(h=s-7),d[h+3+s*(x+3)]=1,t=0;t<6;t++)d[h+t+s*x]=1,d[h+s*(x+t+1)]=1,d[h+6+s*(x+t)]=1,d[h+t+1+s*(x+6)]=1;for(t=1;t<5;t++)g(h+t,x+1),g(h+1,x+t+1),g(h+5,x+t),g(h+t+1,x+5);for(t=2;t<4;t++)d[h+t+s*(x+2)]=1,d[h+2+s*(x+t+1)]=1,d[h+4+s*(x+t)]=1,d[h+t+1+s*(x+4)]=1}if(n>1)for(Z=is.adelta[n],h=s-7;;){for(t=s-7;t>Z-3&&(f(t,h),!(t<Z));)t-=Z;if(h<=Z+9)break;f(6,h-=Z),f(h,6)}for(d[8+s*(s-8)]=1,h=0;h<7;h++)g(7,h),g(s-8,h),g(7,h+s-7);for(t=0;t<8;t++)g(t,7),g(t+s-8,7),g(t,s-8);for(t=0;t<9;t++)g(t,8);for(t=0;t<8;t++)g(t+s-8,8),g(8,t);for(h=0;h<7;h++)g(8,h+s-7);for(t=0;t<s-14;t++)1&t?(g(8+t,6),g(6,8+t)):(d[8+t+6*s]=1,d[6+s*(8+t)]=1);if(n>6)for(Z=is.vpat[n-7],x=17,t=0;t<6;t++)for(h=0;h<3;h++,x--)1&(x>11?n>>x-12:Z>>x)?(d[5-t+s*(2-h+s-11)]=1,d[2-h+s-11+s*(5-t)]=1):(g(5-t,2-h+s-11),g(2-h+s-11,5-t));for(h=0;h<s;h++)for(t=0;t<=h;t++)d[t+s*h]&&g(t,h);for(C=c.length,k=0;k<C;k++)u[k]=c.charCodeAt(k);if(c=u.slice(0),C>=(t=r*(o+a)+a)-2&&(C=t-2,n>9&&C--),k=C,n>9){for(c[k+2]=0,c[k+3]=0;k--;)c[k+3]|=255&(Z=c[k])<<4,c[k+2]=Z>>4;c[2]|=255&C<<4,c[1]=C>>4,c[0]=64|C>>12}else{for(c[k+1]=0,c[k+2]=0;k--;)c[k+2]|=255&(Z=c[k])<<4,c[k+1]=Z>>4;c[1]|=255&C<<4,c[0]=64|C>>4}for(k=C+3-(n<10);k<t;)c[k++]=236,c[k++]=17;for(m[0]=1,k=0;k<l;k++){for(m[k+1]=1,A=k;A>0;A--)m[A]=m[A]?m[A-1]^O[_(I[m[A]]+k)]:m[A-1];m[0]=O[_(I[m[0]]+k)]}for(k=0;k<=l;k++)m[k]=I[m[k]];for(x=t,h=0,k=0;k<o;k++)v(h,r,x,l),h+=r,x+=l;for(k=0;k<a;k++)v(h,r+1,x,l),h+=r+1,x+=l;for(h=0,k=0;k<r;k++){for(A=0;A<o;A++)u[h++]=c[k+A*r];for(A=0;A<a;A++)u[h++]=c[o*r+k+A*(r+1)]}for(A=0;A<a;A++)u[h++]=c[o*r+k+A*(r+1)];for(k=0;k<l;k++)for(A=0;A<o+a;A++)u[h++]=c[t+k+A*l];for(c=u,t=h=s-1,x=C=1,T=(r+l)*(o+a)+a,k=0;k<T;k++)for(Z=c[k],A=0;A<8;A++,Z<<=1){128&Z&&(d[t+s*h]=1);do{C?t--:(t++,x?0!=h?h--:(x=!x,6==(t-=2)&&(t--,h=9)):h!=s-1?h++:(x=!x,6==(t-=2)&&(t--,h-=8))),C=!C}while(b(t,h))}for(c=d.slice(0),Z=0,h=3e4,x=0;x<8&&(y(x),(t=w())<h&&(h=t,Z=x),7!=Z);x++)d=c.slice(0);for(Z!=x&&y(Z),h=is.fmtword[Z+(i-1<<3)],x=0;x<8;x++,h>>=1)1&h&&(d[s-1-x+8*s]=1,x<6?d[8+s*x]=1:d[8+s*(x+1)]=1);for(x=0;x<7;x++,h>>=1)1&h&&(d[8+s*(s-7+x)]=1,x?d[6-x+8*s]=1:d[7+8*s]=1);return d},t.init=function(){i=t.ecclevel;var e=t.genframe(t.url);t.toTable?t.tableWrite(e,s):t.canvasWrite(e,s)},t.init()}function ns(e,t){if(1&e&&(o.TgZ(0,"div",6),o._UZ(1,"img",7),o.TgZ(2,"div",8),o._uU(3," Scan QR code to book this room or view details "),o.qZA(),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("src",e.qr_code,o.LSH)}}is.prototype={canvasWrite:function(e,t){if(!this.qrc&&(this.qrc=this.getContext(this.domElement),!this.qrc))return this.toTable=!0,this.domElement=document.createElement("div"),void this.tableWrite(e,t);var i=this.size,n=this.qrc;n.lineWidth=1;var s=i;s/=t+10,s=Math.round(s-.5);var o=4;this.noBorder?(n.canvas.width=n.canvas.height=s*t,o=0):n.canvas.width=n.canvas.height=i,n.clearRect(0,0,i,i),n.fillStyle=this.colorLight,n.fillRect(0,0,s*(t+8),s*(t+8)),n.fillStyle=this.colorDark;for(var a=0;a<t;a++)for(var r=0;r<t;r++)e[r*t+a]&&n.fillRect(s*(o+a),s*(o+r),s,s)},tableWrite:function(e,t){var i=this,n=Math.round(this.size/t-3.5)+"px",s=t+(i.noBorder?0:2*i.borderSize),o=i.borderSize,a="width:"+n+";height:"+n+";",r=i.colorLight,l=i.colorDark,c=document.createElement("table");c.style.cssText="border:0;border-collapse:collapse;";for(var u,d=document.createElement("tr"),p=document.createElement("td"),h=function(){return p.cloneNode()},m=function(){var e=h();return e.style.cssText=a+"background:"+r,e},g=function(e){for(var t=e.firstChild,i=0;i<o;i++)e.insertBefore(m(),t),e.appendChild(m())},f=0;f<t;f++){var _=d.cloneNode();c.appendChild(_);for(var v=0;v<t;v++)if(1===e[f*t+v]){var b=(u=void 0,(u=h()).style.cssText=a+"background:"+l,u);_.appendChild(b)}else{var y=m();_.appendChild(y)}i.noBorder||g(_)}i.noBorder||function(e){for(var t=e.firstChild,n=0;n<i.borderSize;n++){for(var o=d.cloneNode(),a=0;a<s;a++){var r=m();o.appendChild(r)}e.appendChild(o),e.insertBefore(o.cloneNode(!0),t)}}(c),i.domElement.innerHTML="",i.domElement.appendChild(c)},getContext:function(e){return e.getContext&&e.getContext("2d")?e.getContext("2d"):(console.log("Browser does not have 2d Canvas support"),!1)},toImage:function(e){if(this.qrc){var t=this.imageTypes[e];if(!t)throw new Error(e+" is not a valid image type ");var i=new Image;return i.src=this.domElement.toDataURL(t),i}}},is.adelta=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],is.vpat=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],is.fmtword=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],is.eccblocks=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],is.glog=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],is.gexp=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],is.N1=3,is.N2=3,is.N3=40,is.N4=10;let ss=(()=>{class e{constructor(e){this._state=e,this.system=this._state.space}get time(){return(0,Vi.Z)(Date.now())}get room_image(){return this._state.setting("image")}get checkin(){return!1!==this._state.setting("show_qr_code")}ngOnInit(){const e=`${location.origin}${location.pathname}#/checkin/${this._state.system}`;this.qr_code=function(e,t="#fff0",i="#000"){var n;const s=new is({url:e||"Hello",size:360,colorLight:t,colorDark:i,toTable:!1,ecclevel:1,noBorder:!0,borderSize:0});return null===(n=null==s?void 0:s.toImage("svg+xml"))||void 0===n?void 0:n.src}(e,"#fff0","#fff")}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(_n))},e.\u0275cmp=o.Xpm({type:e,selectors:[["panel-view-details"]],decls:11,vars:12,consts:[[1,"h-full","w-full","bg-black","relative","text-white"],[1,"bg-cover","bg-center","absolute","inset-0"],[1,"absolute","inset-0","bg-black/60"],["name","",1,"absolute","top-4","left-4","text-3xl","font-medium"],["qr-checkin","","class","absolute top-4 right-4 text-xl w-40 space-y-4",4,"ngIf"],[1,"absolute","top-2/3","left-1/2","-translate-x-1/2","text-3xl","font-light"],["qr-checkin","",1,"absolute","top-4","right-4","text-xl","w-40","space-y-4"],[1,"w-full",3,"src"],[1,"w-full","text-lg"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0),o._UZ(1,"div",1),o._UZ(2,"div",2),o.TgZ(3,"div",3),o._uU(4),o.ALo(5,"async"),o.ALo(6,"async"),o.qZA(),o.YNc(7,ns,4,1,"div",4),o.TgZ(8,"div",5),o._uU(9),o.ALo(10,"date"),o.qZA(),o.qZA()),2&e){let e;o.xp6(1),o.Udp("background-image","url("+t.room_image+")"),o.xp6(3),o.hij(" ",(null==(e=o.lcZ(5,5,t.system))?null:e.display_name)||(null==(e=o.lcZ(6,7,t.system))?null:e.name)||"<Unknown Space>"," "),o.xp6(3),o.Q6J("ngIf",t.checkin),o.xp6(2),o.hij(" ",o.xi3(10,9,t.time,"EEE, MMM d, y h:mm a")," ")}},directives:[ye.O5],pipes:[ye.Ov,ye.uU],styles:["[_nghost-%COMP%]{display:block}"]}),e})();var os=i(1110);function as(e){const t=(0,$t.Z)(null==e?void 0:e.date,Date.now());return e&&t<1440?`${(0,B.Z)(e.date,"h:mm a")} - ${(0,B.Z)((0,Tt.Z)(e.date,e.duration),"h:mm a")}`:""}function rs(e,t){const i=(0,$t.Z)(null==t?void 0:t.date,Date.now());if(!e)return t&&i<1440?`Free for ${(0,nn.Z)({hours:Math.floor(i/60),minutes:i%60})||"less than 1 minute"}`:"";const n=(0,$t.Z)(1e3*e.event_end,Date.now()),s=(0,nn.Z)({hours:Math.floor(n/60),minutes:n%60});return`Free in ${n<1?"less than 1 minute":s}`}function ls(e,t){1&e&&(o.TgZ(0,"div",9),o.TgZ(1,"p",10),o._uU(2,"Touch or scan to check-in"),o.qZA(),o.TgZ(3,"app-icon"),o._uU(4,"arrow_forward"),o.qZA(),o.qZA())}let cs=(()=>{class e{constructor(e){this._state=e,this.state=this._state.status,this.current=this._state.current,this.next=this._state.next,this.event_state=(0,_e.aj)([this.current,this.next,(0,os.H)(5e3)]).pipe((0,R.U)(([e,t])=>({current:rs(e,t),next:as(t)}))),this.free_svg='\n    <svg width="129" height="117" viewBox="0 0 129 117" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0)">\n    <path d="M32.9422 90.8456H10.1503L6.37414 54.8238C6.34123 54.4031 6.22286 53.9934 6.02626 53.62C5.82966 53.2465 5.55897 52.9171 5.23075 52.6519C4.90253 52.3867 4.52368 52.1913 4.11737 52.0776C3.71106 51.9639 3.28583 51.9343 2.8677 51.9907C2.44708 52.0236 2.03759 52.142 1.66428 52.3387C1.29098 52.5353 0.961708 52.8061 0.696607 53.1345C0.431506 53.4628 0.236151 53.8418 0.12249 54.2483C0.00882954 54.6547 -0.0207468 55.0801 0.0355704 55.4984L4.21633 94.3534C4.312 95.1416 4.69529 95.8668 5.29265 96.3896C5.89001 96.9125 6.65936 97.1963 7.45305 97.1865H17.4329V109.059L10.0155 111.892C9.68401 112.004 9.37812 112.181 9.1155 112.412C8.85287 112.644 8.63873 112.925 8.48549 113.239C8.33225 113.554 8.24295 113.896 8.22276 114.246C8.20257 114.595 8.2519 114.945 8.36788 115.275C8.48387 115.605 8.6642 115.909 8.89844 116.169C9.13268 116.429 9.41617 116.64 9.73249 116.79C10.0488 116.94 10.3916 117.025 10.7412 117.041C11.0907 117.057 11.4399 117.004 11.7687 116.884L19.8605 113.916L27.9523 116.884H28.8963C29.4326 116.879 29.9541 116.707 30.3889 116.393C30.8236 116.079 31.1503 115.638 31.3238 115.13C31.5533 114.468 31.512 113.742 31.2089 113.11C30.9058 112.478 30.3654 111.992 29.7055 111.757L22.4229 109.194V97.3214H32.9422C33.7971 97.3099 34.6137 96.9651 35.2182 96.3603C35.8227 95.7556 36.1674 94.9387 36.1789 94.0835C36.1845 93.6568 36.1047 93.2332 35.944 92.8378C35.7833 92.4424 35.5451 92.0833 35.2434 91.7815C34.9417 91.4797 34.5827 91.2414 34.1875 91.0806C33.7922 90.9199 33.3688 90.84 32.9422 90.8456Z" fill="currentColor"/>\n    <path d="M125.189 51.9907C124.348 51.9019 123.507 52.1503 122.85 52.6816C122.192 53.2128 121.772 53.9833 121.682 54.8239L117.906 90.7107H94.9794C94.121 90.7107 93.2977 91.0519 92.6907 91.6591C92.0837 92.2663 91.7427 93.0899 91.7427 93.9487C91.7427 94.8074 92.0837 95.631 92.6907 96.2382C93.2977 96.8454 94.121 97.1866 94.9794 97.1866H105.499V109.059L98.2161 111.622C97.5749 111.882 97.0536 112.371 96.7542 112.995C96.4549 113.619 96.3991 114.332 96.5978 114.995C96.7713 115.503 97.098 115.944 97.5327 116.258C97.9675 116.572 98.489 116.744 99.0253 116.749C99.302 116.77 99.5797 116.724 99.8345 116.614L107.926 113.646L116.018 116.614C116.347 116.734 116.696 116.787 117.046 116.771C117.395 116.755 117.738 116.67 118.054 116.52C118.371 116.37 118.654 116.16 118.888 115.9C119.123 115.64 119.303 115.336 119.419 115.005C119.535 114.675 119.584 114.325 119.564 113.976C119.544 113.626 119.455 113.284 119.301 112.97C119.148 112.655 118.934 112.374 118.671 112.143C118.409 111.911 118.103 111.734 117.771 111.622L110.489 109.059V97.1866H120.603C121.397 97.1963 122.166 96.9126 122.764 96.3897C123.361 95.8668 123.744 95.1416 123.84 94.3534L128.021 55.4984C128.11 54.6577 127.861 53.8161 127.33 53.1584C126.799 52.5007 126.029 52.0807 125.189 51.9907Z" fill="currentColor"/>\n    <path d="M95.5186 74.1164V69.7992C95.5241 69.7091 95.5104 69.619 95.4785 69.5346C95.4465 69.4503 95.3971 69.3737 95.3333 69.3099C95.2696 69.2462 95.193 69.1967 95.1087 69.1647C95.0244 69.1328 94.9342 69.1191 94.8443 69.1246H33.0769C32.9869 69.1191 32.8968 69.1328 32.8124 69.1647C32.7281 69.1967 32.6516 69.2462 32.5878 69.3099C32.5241 69.3737 32.4746 69.4503 32.4426 69.5346C32.4107 69.619 32.397 69.7091 32.4026 69.7992V74.1164C32.397 74.2064 32.4107 74.2966 32.4426 74.3809C32.4746 74.4653 32.5241 74.5419 32.5878 74.6056C32.6516 74.6694 32.7281 74.7189 32.8124 74.7509C32.8968 74.7828 32.9869 74.7965 33.0769 74.791H55.1945V115.67C55.1889 115.76 55.2026 115.85 55.2345 115.934C55.2665 116.018 55.3159 116.095 55.3797 116.159C55.4435 116.223 55.52 116.272 55.6043 116.304C55.6886 116.336 55.7788 116.35 55.8688 116.344H72.0524C72.1423 116.35 72.2325 116.336 72.3168 116.304C72.4011 116.272 72.4777 116.223 72.5414 116.159C72.6052 116.095 72.6547 116.018 72.6866 115.934C72.7185 115.85 72.7322 115.76 72.7267 115.67V74.9259H94.8443C95.0399 74.9054 95.2198 74.8093 95.3458 74.6581C95.4717 74.507 95.5337 74.3126 95.5186 74.1164Z" fill="currentColor"/>\n    </g>\n    <defs>\n    <clipPath id="clip0">\n    <rect width="128.03" height="116.141" fill="currentColor" transform="translate(0.000488281 0.858643)"/>\n    </clipPath>\n    </defs>\n    </svg>\n    ',this.in_use_svg='\n    <svg width="129" height="117" viewBox="0 0 129 117" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0)">\n    <path d="M29.7316 77.5781C29.1922 71.6419 28.6527 64.7613 28.2481 60.8489C28.6527 61.2536 29.1922 61.6583 29.5968 62.0631C32.9684 65.0312 38.9023 65.5708 42.9482 65.5708C44.8363 65.5708 46.3198 65.4359 46.9941 65.4359C48.0088 65.3405 48.9445 64.8473 49.597 64.0641C50.2494 63.2809 50.5656 62.2713 50.4766 61.2557C50.3875 60.2401 49.9004 59.301 49.1216 58.6434C48.3428 57.9858 47.3356 57.6631 46.3198 57.7459C42.6785 58.1506 36.6097 57.7459 34.8564 56.2618C30.5021 52.1921 24.7668 49.926 18.8077 49.9209C12.4691 49.9209 11.2554 52.7541 11.2554 56.1269C11.2554 60.7139 12.7389 80.5462 13.6829 84.8634C14.627 88.641 24.0674 87.9664 28.6527 87.8315C32.711 87.6529 36.7769 87.8789 40.7904 88.506C40.9217 96.0702 40.6516 103.636 39.9812 111.171C39.8928 112.491 40.3224 113.793 41.1786 114.801C42.0349 115.809 43.2504 116.443 44.5666 116.568H44.9712C46.2268 116.57 47.4371 116.099 48.3616 115.249C49.2862 114.399 49.8572 113.233 49.9611 111.981C51.1749 95.9263 51.1749 86.2125 49.8263 83.2444C47.8033 79.0621 42.5437 77.8479 29.7316 77.5781Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M18.6731 47.8973C24.1104 47.8973 28.5182 43.4879 28.5182 38.0486C28.5182 32.6093 24.1104 28.2 18.6731 28.2C13.2359 28.2 8.82812 32.6093 8.82812 38.0486C8.82812 43.4879 13.2359 47.8973 18.6731 47.8973Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M33.9124 90.5297H11.1205L7.34436 54.5079C7.31145 54.0871 7.19307 53.6775 6.99647 53.3041C6.79987 52.9306 6.52919 52.6012 6.20097 52.336C5.87275 52.0708 5.49389 51.8754 5.08758 51.7617C4.68127 51.648 4.25605 51.6184 3.83791 51.6747C3.41729 51.7077 3.0078 51.8261 2.6345 52.0228C2.2612 52.2194 1.93192 52.4902 1.66682 52.8186C1.40172 53.1469 1.20637 53.5259 1.0927 53.9323C0.979044 54.3388 0.949468 54.7642 1.00579 55.1825L5.18655 94.0374C5.28222 94.8257 5.66551 95.5508 6.26287 96.0737C6.86023 96.5966 7.62957 96.8804 8.42327 96.8706H18.4031V108.743L10.9857 111.576C10.6542 111.688 10.3483 111.865 10.0857 112.096C9.82309 112.328 9.60895 112.609 9.45571 112.924C9.30246 113.238 9.21316 113.58 9.19297 113.93C9.17278 114.279 9.22211 114.629 9.3381 114.959C9.45408 115.289 9.63442 115.593 9.86866 115.853C10.1029 116.113 10.3864 116.324 10.7027 116.474C11.019 116.624 11.3619 116.709 11.7114 116.725C12.0609 116.741 12.4102 116.688 12.7389 116.568L20.8307 113.6L28.9225 116.568H29.8665C30.4028 116.563 30.9243 116.391 31.3591 116.077C31.7938 115.763 32.1205 115.322 32.2941 114.814C32.5235 114.152 32.4822 113.426 32.1791 112.794C31.876 112.163 31.3356 111.676 30.6757 111.441L23.3931 108.878V97.0055H33.9124C34.7673 96.994 35.5839 96.6492 36.1884 96.0444C36.7929 95.4397 37.1376 94.6228 37.1491 93.7676C37.1548 93.3408 37.0749 92.9173 36.9142 92.5219C36.7535 92.1265 36.5153 91.7673 36.2136 91.4655C35.912 91.1637 35.5529 90.9254 35.1577 90.7647C34.7624 90.604 34.339 90.5241 33.9124 90.5297Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M89.206 88.5061C93.2205 87.8881 97.2855 87.6622 101.344 87.8315C105.929 87.9664 115.37 88.641 116.314 84.8634C117.392 80.5462 118.741 60.714 118.741 56.1269C118.741 52.7541 117.662 49.9209 111.189 49.9209C105.213 49.8372 99.4458 52.1159 95.14 56.2618C93.3868 57.7459 87.4528 58.0157 83.6766 57.7459C83.1702 57.6982 82.6592 57.7513 82.1733 57.9019C81.6874 58.0526 81.236 58.2978 80.8452 58.6237C80.4544 58.9495 80.1319 59.3494 79.8961 59.8004C79.6604 60.2514 79.5162 60.7445 79.4717 61.2515C79.4273 61.7585 79.4835 62.2692 79.6371 62.7544C79.7907 63.2396 80.0388 63.6895 80.3669 64.0784C80.695 64.4673 81.0968 64.7875 81.5491 65.0205C82.0014 65.2534 82.4953 65.3946 83.0023 65.4359C83.6766 65.4359 85.1601 65.5709 87.0482 65.5709C91.0941 65.5709 97.0281 65.0312 100.4 62.0631C100.879 61.6925 101.33 61.2867 101.748 60.8489C101.344 64.7614 100.804 71.507 100.265 77.5781C87.4528 77.8479 82.1932 79.0622 80.3051 83.2445C78.9564 86.2126 78.8216 95.9263 80.1702 111.981C80.2956 113.224 80.8731 114.378 81.793 115.224C82.7128 116.07 83.911 116.548 85.1601 116.568H85.5647C86.8809 116.443 88.0964 115.809 88.9527 114.801C89.809 113.793 90.2385 112.491 90.1501 111.171C89.3797 103.642 89.0644 96.0733 89.206 88.5061Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M111.216 47.9107C116.653 47.9107 121.061 43.5013 121.061 38.062C121.061 32.6228 116.653 28.2134 111.216 28.2134C105.779 28.2134 101.371 32.6228 101.371 38.062C101.371 43.5013 105.779 47.9107 111.216 47.9107Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M126.159 51.6748C125.319 51.586 124.477 51.8344 123.82 52.3656C123.162 52.8968 122.743 53.6673 122.653 54.5079L118.876 90.3948H95.9496C95.0912 90.3948 94.2679 90.736 93.6609 91.3432C93.0539 91.9504 92.7129 92.774 92.7129 93.6327C92.7129 94.4915 93.0539 95.3151 93.6609 95.9223C94.2679 96.5295 95.0912 96.8706 95.9496 96.8706H106.469V108.743L99.1863 111.306C98.5451 111.566 98.0238 112.056 97.7245 112.679C97.4251 113.303 97.3693 114.016 97.568 114.679C97.7415 115.187 98.0682 115.628 98.503 115.942C98.9377 116.256 99.4592 116.428 99.9955 116.433C100.272 116.454 100.55 116.408 100.805 116.298L108.896 113.33L116.988 116.298C117.317 116.418 117.666 116.471 118.016 116.455C118.365 116.439 118.708 116.354 119.024 116.204C119.341 116.055 119.624 115.844 119.859 115.584C120.093 115.324 120.273 115.02 120.389 114.689C120.505 114.359 120.554 114.009 120.534 113.66C120.514 113.31 120.425 112.968 120.271 112.654C120.118 112.339 119.904 112.058 119.641 111.827C119.379 111.595 119.073 111.419 118.742 111.306L111.459 108.743V96.8706H121.574C122.367 96.8804 123.137 96.5966 123.734 96.0738C124.331 95.5509 124.715 94.8257 124.81 94.0375L128.991 55.1825C129.08 54.3418 128.832 53.5002 128.301 52.8425C127.77 52.1848 126.999 51.7648 126.159 51.6748Z" fill="currentColor" fill-opacity="0.61"/>\n    <path d="M96.4888 73.8005V69.4833C96.4943 69.3932 96.4806 69.3031 96.4487 69.2187C96.4168 69.1344 96.3673 69.0578 96.3035 68.994C96.2398 68.9302 96.1632 68.8807 96.0789 68.8488C95.9946 68.8168 95.9045 68.8032 95.8145 68.8087H34.0471C33.9571 68.8032 33.867 68.8168 33.7827 68.8488C33.6983 68.8807 33.6218 68.9302 33.558 68.994C33.4943 69.0578 33.4448 69.1344 33.4129 69.2187C33.3809 69.3031 33.3673 69.3932 33.3728 69.4833V73.8005C33.3673 73.8905 33.3809 73.9807 33.4129 74.065C33.4448 74.1494 33.4943 74.2259 33.558 74.2897C33.6218 74.3535 33.6983 74.403 33.7827 74.4349C33.867 74.4669 33.9571 74.4806 34.0471 74.475H56.1647V115.354C56.1592 115.444 56.1728 115.534 56.2048 115.618C56.2367 115.703 56.2862 115.779 56.3499 115.843C56.4137 115.907 56.4902 115.956 56.5745 115.988C56.6589 116.02 56.749 116.034 56.839 116.028H73.0226C73.1126 116.034 73.2027 116.02 73.287 115.988C73.3713 115.956 73.4479 115.907 73.5116 115.843C73.5754 115.779 73.6249 115.703 73.6568 115.618C73.6887 115.534 73.7024 115.444 73.6969 115.354V74.61H95.8145C96.0101 74.5895 96.19 74.4934 96.316 74.3422C96.4419 74.191 96.5039 73.9967 96.4888 73.8005Z" fill="currentColor" fill-opacity="0.61"/>\n    </g>\n    <defs>\n    <clipPath id="clip0">\n    <rect width="128.03" height="116.141" fill="currentColor" transform="translate(0.970703 0.542725)"/>\n    </clipPath>\n    </defs>\n    </svg>\n    ',this.pending_svg='\n    <svg width="129" height="117" viewBox="0 0 129 117" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0)">\n    <path d="M32.9412 90.8456H10.1493L6.37317 54.8238C6.34026 54.4031 6.22188 53.9934 6.02528 53.62C5.82868 53.2465 5.558 52.9171 5.22978 52.6519C4.90156 52.3867 4.5227 52.1913 4.11639 52.0776C3.71008 51.9639 3.28486 51.9343 2.86672 51.9907C2.4461 52.0236 2.03661 52.142 1.66331 52.3387C1.29 52.5353 0.960731 52.8061 0.695631 53.1345C0.43053 53.4628 0.235174 53.8418 0.121514 54.2483C0.00785298 54.6547 -0.0217234 55.0801 0.0345939 55.4984L4.21535 94.3534C4.31102 95.1416 4.69432 95.8668 5.29168 96.3896C5.88904 96.9125 6.65838 97.1963 7.45207 97.1865H17.432V109.059L10.0145 111.892C9.68304 112.004 9.37714 112.181 9.11452 112.412C8.8519 112.644 8.63776 112.925 8.48452 113.239C8.33127 113.554 8.24197 113.896 8.22178 114.246C8.20159 114.595 8.25092 114.945 8.3669 115.275C8.48289 115.605 8.66323 115.909 8.89747 116.169C9.13171 116.429 9.4152 116.64 9.73151 116.79C10.0478 116.94 10.3907 117.025 10.7402 117.041C11.0897 117.057 11.439 117.004 11.7677 116.884L19.8595 113.916L27.9513 116.884H28.8953C29.4316 116.879 29.9531 116.707 30.3879 116.393C30.8227 116.079 31.1493 115.638 31.3229 115.13C31.5523 114.468 31.511 113.742 31.2079 113.11C30.9048 112.478 30.3644 111.992 29.7045 111.757L22.4219 109.194V97.3214H32.9412C33.7961 97.3099 34.6127 96.9651 35.2172 96.3603C35.8217 95.7556 36.1664 94.9387 36.1779 94.0835C36.1836 93.6568 36.1037 93.2332 35.943 92.8378C35.7823 92.4424 35.5441 92.0833 35.2425 91.7815C34.9408 91.4797 34.5817 91.2414 34.1865 91.0806C33.7913 90.9199 33.3678 90.84 32.9412 90.8456Z" fill="currentColor"/>\n    <path d="M125.188 51.9907C124.348 51.9019 123.507 52.1503 122.849 52.6816C122.192 53.2128 121.772 53.9833 121.682 54.8239L117.906 90.7107H94.9789C94.1205 90.7107 93.2972 91.0519 92.6902 91.6591C92.0832 92.2663 91.7422 93.0899 91.7422 93.9487C91.7422 94.8074 92.0832 95.631 92.6902 96.2382C93.2972 96.8454 94.1205 97.1866 94.9789 97.1866H105.498V109.059L98.2156 111.622C97.5744 111.882 97.0531 112.371 96.7538 112.995C96.4544 113.619 96.3986 114.332 96.5973 114.995C96.7708 115.503 97.0975 115.944 97.5323 116.258C97.967 116.572 98.4885 116.744 99.0248 116.749C99.3015 116.77 99.5792 116.724 99.834 116.614L107.926 113.646L116.018 116.614C116.346 116.734 116.696 116.787 117.045 116.771C117.395 116.755 117.737 116.67 118.054 116.52C118.37 116.37 118.654 116.16 118.888 115.9C119.122 115.64 119.302 115.336 119.418 115.005C119.534 114.675 119.584 114.325 119.564 113.976C119.543 113.626 119.454 113.284 119.301 112.97C119.148 112.655 118.933 112.374 118.671 112.143C118.408 111.911 118.102 111.734 117.771 111.622L110.488 109.059V97.1866H120.603C121.397 97.1963 122.166 96.9126 122.763 96.3897C123.361 95.8668 123.744 95.1416 123.84 94.3534L128.02 55.4984C128.109 54.6577 127.861 53.8161 127.33 53.1584C126.799 52.5007 126.029 52.0807 125.188 51.9907Z" fill="currentColor"/>\n    <path d="M95.5186 74.1164V69.7992C95.5241 69.7091 95.5104 69.619 95.4785 69.5346C95.4465 69.4503 95.3971 69.3737 95.3333 69.3099C95.2696 69.2462 95.193 69.1967 95.1087 69.1647C95.0244 69.1328 94.9342 69.1191 94.8443 69.1246H33.0769C32.9869 69.1191 32.8968 69.1328 32.8124 69.1647C32.7281 69.1967 32.6516 69.2462 32.5878 69.3099C32.5241 69.3737 32.4746 69.4503 32.4426 69.5346C32.4107 69.619 32.397 69.7091 32.4026 69.7992V74.1164C32.397 74.2064 32.4107 74.2966 32.4426 74.3809C32.4746 74.4653 32.5241 74.5419 32.5878 74.6056C32.6516 74.6694 32.7281 74.7189 32.8124 74.7509C32.8968 74.7828 32.9869 74.7965 33.0769 74.791H55.1945V115.67C55.1889 115.76 55.2026 115.85 55.2345 115.934C55.2665 116.018 55.3159 116.095 55.3797 116.159C55.4435 116.223 55.52 116.272 55.6043 116.304C55.6886 116.336 55.7788 116.35 55.8688 116.344H72.0524C72.1423 116.35 72.2325 116.336 72.3168 116.304C72.4011 116.272 72.4777 116.223 72.5414 116.159C72.6052 116.095 72.6547 116.018 72.6866 115.934C72.7185 115.85 72.7322 115.76 72.7267 115.67V74.9259H94.8443C95.0399 74.9054 95.2198 74.8093 95.3458 74.6581C95.4717 74.507 95.5337 74.3126 95.5186 74.1164Z" fill="currentColor"/>\n    <path d="M41.042 58.875H85.9587L63.5003 20.0834L41.042 58.875ZM65.542 52.75H61.4587V48.6667H65.542V52.75ZM65.542 44.5834H61.4587V36.4167H65.542V44.5834Z" fill="currentColor"/>\n    </g>\n    <defs>\n    <clipPath id="clip0">\n    <rect width="128.03" height="116.141" fill="currentColor" transform="translate(0 0.858643)"/>\n    </clipPath>\n    </defs>\n    </svg>\n    '}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(_n))},e.\u0275cmp=o.Xpm({type:e,selectors:[["panel-view-status"]],decls:25,vars:33,consts:[[1,"flex","items-center","justify-center","h-full","w-full"],[1,"flex-1","h-full","text-white","flex","flex-col","items-center","justify-center","relative"],[3,"innerHTML"],[1,"text-4xl","uppercase","font-medium","mt-4"],[1,"text-2xl","font-light","mt-4"],["class","absolute top-0 inset-x-0 flex items-center justify-center text-2xl bg-black/40 p-4 space-x-4",4,"ngIf"],[1,"flex-1","h-full","bg-white","text-black","flex","flex-col","items-center","justify-center","space-y-4"],[1,"text-4xl","uppercase","font-medium"],[1,"text-2xl","font-light"],[1,"absolute","top-0","inset-x-0","flex","items-center","justify-center","text-2xl","bg-black/40","p-4","space-x-4"],[1,"uppercase"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.ALo(2,"async"),o.ALo(3,"async"),o.ALo(4,"async"),o._UZ(5,"div",2),o.ALo(6,"safe"),o.ALo(7,"async"),o.ALo(8,"async"),o.TgZ(9,"h3",3),o._uU(10,"Now"),o.qZA(),o.TgZ(11,"p",4),o._uU(12),o.ALo(13,"async"),o.qZA(),o.YNc(14,ls,5,0,"div",5),o.ALo(15,"async"),o.qZA(),o.TgZ(16,"div",6),o._UZ(17,"div",2),o.ALo(18,"safe"),o.ALo(19,"async"),o.TgZ(20,"h3",7),o._uU(21,"Next"),o.qZA(),o.TgZ(22,"p",8),o._uU(23),o.ALo(24,"async"),o.qZA(),o.qZA(),o.qZA()),2&e){let e,i,n;o.xp6(1),o.ekj("bg-error","busy"===o.lcZ(2,11,t.state))("bg-success","free"===o.lcZ(3,13,t.state))("bg-pending","pending"===o.lcZ(4,15,t.state)),o.xp6(4),o.Q6J("innerHTML",o.lcZ(6,17,"busy"===o.lcZ(7,19,t.state)?t.in_use_svg:"pending"===o.lcZ(8,21,t.state)?t.pending_svg:t.free_svg),o.oJD),o.xp6(7),o.hij(" ",(null==(e=o.lcZ(13,23,t.event_state))?null:e.current)||"No current event"," "),o.xp6(2),o.Q6J("ngIf","pending"===o.lcZ(15,25,t.state)),o.xp6(3),o.Q6J("innerHTML",o.lcZ(18,27,null!=(i=o.lcZ(19,29,t.event_state))&&i.next?t.in_use_svg:t.free_svg),o.oJD),o.xp6(6),o.hij(" ",(null==(n=o.lcZ(24,31,t.event_state))?null:n.next)||"No upcoming events"," ")}},directives:[ye.O5,Ye],pipes:[ye.Ov,Se],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#424242}"]}),e})(),us=(()=>{class e extends b{constructor(e,t){super(),this._state=e,this._route=t}ngOnInit(){this._state.system="",this.subscription("route.params",this._route.paramMap.subscribe(e=>{e.has("system_id")&&(this._state.system=e.get("system_id"))}))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(_n),o.Y36(c.gz))},e.\u0275cmp=o.Xpm({type:e,selectors:[["panel-view"]],features:[o._Bn([_n]),o.qOj],decls:3,vars:0,consts:[[1,"flex","flex-col","items-center","h-full","w-full","overflow-hidden"],[1,"flex-1","w-full"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o._UZ(1,"panel-view-details",1),o._UZ(2,"panel-view-status",1),o.qZA())},directives:[ss,cs],styles:[""]}),e})();var ds=i(4179),ps=i(9542),hs=i(6547);function ms(e,t){if(1&e&&(o.TgZ(0,"div",8),o._uU(1),o.qZA()),2&e){const e=o.oxw().$implicit;o.xp6(1),o.hij(" ",e.hour," ")}}function gs(e,t){if(1&e&&o._UZ(0,"div",9),2&e){const e=o.oxw().$implicit,t=o.oxw();o.Udp("height",t.height(e.minutes))}}function fs(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",5),o.NdJ("click",function(){const t=o.CHM(e).$implicit;return o.oxw().event.emit(t.id)}),o.YNc(1,ms,2,1,"div",6),o.YNc(2,gs,1,2,"div",7),o.qZA()}if(2&e){const e=t.$implicit,i=o.oxw();o.Udp("min-width",1*i.step+"px"),o.xp6(1),o.Q6J("ngIf",e.minutes%60==0),o.xp6(1),o.Q6J("ngIf",e.minutes%15==0)}}function _s(e,t){if(1&e&&o._UZ(0,"div",11),2&e){const e=o.oxw().$implicit;o.Udp("left",8+e.start+"px")("width",e.length+"px")}}function vs(e,t){if(1&e&&(o.ynx(0),o.YNc(1,_s,1,4,"div",10),o.BQk()),2&e){const e=t.$implicit;o.xp6(1),o.Q6J("ngIf",e.start+e.length>=0&&e.start<1440)}}let bs=(()=>{class e extends b{constructor(){super(...arguments),this.events=[],this.step=15,this.event=new o.vpe,this.current_time=0,this.blocks=[],this.event_blocks=[]}ngOnInit(){this._generateTimeBlocks(),this._updateCurrentTime(),this.interval("gen-blocks",()=>this._generateTimeBlocks(),6e4),this.interval("update-current",()=>this._updateCurrentTime(),3e4)}ngOnChanges(e){e.events&&this._processEvents()}height(e){switch(e){case 0:return"3.5rem";case 15:case 45:return"1rem";case 30:return"2rem"}return""}_generateTimeBlocks(){const e=[],t=(0,ci.Z)((0,ds.Z)((0,ps.Z)(Date.now(),1),this.step/2),{nearestTo:this.step});let i=t;const n=(0,hs.Z)(t,24);for(;i<n;)e.push({id:i.valueOf(),minutes:i.getMinutes(),hour:(0,B.Z)(i,"h a")}),i=(0,Tt.Z)(i,this.step);this.blocks=e}_processEvents(){this.blocks.length&&(this.event_blocks=(this.events||[]).map(e=>({start:(0,$t.Z)(e.date,this.blocks[0].id),length:e.duration})))}_updateCurrentTime(){if(!this.blocks.length)return;const e=(0,$t.Z)(Date.now(),this.blocks[0].id);this.current_time=e}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=o.n5z(e)))(i||e)}}(),e.\u0275cmp=o.Xpm({type:e,selectors:[["checkin-timetable"]],inputs:{events:"events",step:"step"},outputs:{event:"event"},features:[o.qOj,o.TTD],decls:5,vars:4,consts:[[1,"flex","items-center","relative","h-20","px-2"],["class","h-full relative",3,"min-width","click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["current","",1,"absolute","bottom-0","h-[3.5rem]","w-0.5","bg-primary","pointer-events-none"],[1,"h-2","w-2","rounded-full","bg-primary","absolute","top-1/2","-translate-y-1/2","left-1/2","-translate-x-1/2"],[1,"h-full","relative",3,"click"],["class","absolute top-1 left-0 text-xs whitespace-nowrap",4,"ngIf"],["class","absolute w-px bottom-0 left-0 bg-black",3,"height",4,"ngIf"],[1,"absolute","top-1","left-0","text-xs","whitespace-nowrap"],[1,"absolute","w-px","bottom-0","left-0","bg-black"],["event","","class","absolute bottom-0 h-[3.5rem] bg-gray-300 opacity-40",3,"left","width",4,"ngIf"],["event","",1,"absolute","bottom-0","h-[3.5rem]","bg-gray-300","opacity-40"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o.YNc(1,fs,3,4,"button",1),o.YNc(2,vs,2,1,"ng-container",2),o.TgZ(3,"div",3),o._UZ(4,"div",4),o.qZA(),o.qZA()),2&e&&(o.xp6(1),o.Q6J("ngForOf",t.blocks),o.xp6(1),o.Q6J("ngForOf",t.event_blocks),o.xp6(1),o.Udp("left",8+t.current_time+"px"))},directives:[ye.sg,ye.O5],styles:["[event][_ngcontent-%COMP%]{--color1:#969696;--color2:#424242;background:repeating-linear-gradient(-45deg,var(--color1),var(--color1) 6px,var(--color2) 6px,var(--color2) 8px)}"]}),e})();function ys(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",21),o.NdJ("click",function(){return o.CHM(e),o.oxw().checkInCurrent()}),o._uU(1," Check-in "),o.qZA()}}function xs(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"button",21),o.NdJ("click",function(){return o.CHM(e),o.oxw().newBooking()}),o._uU(1," Book "),o.qZA()}}function ws(e,t){1&e&&(o.TgZ(0,"button",22),o._uU(1," Book "),o.qZA())}const Zs=[{path:"bootstrap",component:si},{path:"panel/:system_id",component:us},{path:"checkin/:system_id",component:(()=>{class e extends b{constructor(e,t){super(),this._state=e,this._route=t,this.state=this._state.status,this.system=this._state.space,this.bookings=this._state.bookings,this.checkInCurrent=()=>this._state.startMeeting(),this.newBooking=()=>this._state.newBooking(),this.event_state=(0,_e.aj)([this._state.current,this._state.next]).pipe((0,R.U)(([e,t])=>({current:rs(e,t),next:as(t)})))}get time(){return(0,Vi.Z)(Date.now())}get room_image(){return this._state.setting("image")}ngOnInit(){this._state.system="",this.subscription("route.params",this._route.paramMap.subscribe(e=>{e.has("system_id")&&(this._state.system=e.get("system_id"))}))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(_n),o.Y36(c.gz))},e.\u0275cmp=o.Xpm({type:e,selectors:[["checkin-view"]],features:[o._Bn([_n]),o.qOj],decls:77,vars:45,consts:[[1,"bg-black","relative","text-white","p-4","h-32"],[1,"bg-cover","bg-center","absolute","inset-0"],[1,"absolute","inset-0","bg-black/60"],["name","",1,"absolute","bottom-4","left-4","text-3xl","font-medium","z-10"],[1,"p-4","text-xl","font-medium"],[1,"bg-white","divide-y","divide-gray-200"],[1,"flex","items-center","p-2"],[1,"w-2","h-full","min-h-[3rem]","rounded"],[1,"text-sm","flex-1","px-2"],[1,"font-medium","uppercase"],[1,""],["mat-button","","class","w-24",3,"click",4,"ngIf"],[1,"w-2","h-full","min-h-[3rem]","rounded","bg-error"],["mat-button","","class","w-24",4,"ngIf"],[1,"bg-white","overflow-auto"],[3,"events"],[1,"bg-white","overflow-auto","flex-1","h-px","divide-y","divide-gray-200"],["matRipple","",1,"flex","items-center","p-4","w-full"],[1,"text-black/40","bg-black/20","rounded-full","p-2","text-2xl"],[1,"flex-1","px-4","font-medium","text-left"],[1,"text-2xl","opacity-40"],["mat-button","",1,"w-24",3,"click"],["mat-button","",1,"w-24"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0),o._UZ(1,"div",1),o._UZ(2,"div",2),o.TgZ(3,"div",3),o._uU(4),o.ALo(5,"async"),o.ALo(6,"async"),o.qZA(),o.qZA(),o.TgZ(7,"h3",4),o._uU(8,"Upcoming"),o.qZA(),o.TgZ(9,"div",5),o.TgZ(10,"div",6),o._UZ(11,"div",7),o.ALo(12,"async"),o.ALo(13,"async"),o.ALo(14,"async"),o.TgZ(15,"div",8),o.TgZ(16,"div",9),o._uU(17,"Now"),o.qZA(),o.TgZ(18,"div",10),o._uU(19),o.ALo(20,"async"),o.qZA(),o.qZA(),o.YNc(21,ys,2,0,"button",11),o.ALo(22,"async"),o.YNc(23,xs,2,0,"button",11),o.ALo(24,"async"),o.qZA(),o.TgZ(25,"div",6),o._UZ(26,"div",12),o.ALo(27,"async"),o.ALo(28,"async"),o.TgZ(29,"div",8),o.TgZ(30,"div",9),o._uU(31,"Next"),o.qZA(),o.TgZ(32,"div",10),o._uU(33),o.ALo(34,"async"),o.qZA(),o.qZA(),o.YNc(35,ws,2,0,"button",13),o.ALo(36,"async"),o.qZA(),o.qZA(),o.TgZ(37,"h3",4),o._uU(38,"Schedule"),o.qZA(),o.TgZ(39,"div",14),o._UZ(40,"checkin-timetable",15),o.ALo(41,"async"),o.qZA(),o.TgZ(42,"h3",4),o._uU(43,"Features"),o.qZA(),o.TgZ(44,"div",16),o.TgZ(45,"button",17),o.TgZ(46,"div",18),o.TgZ(47,"app-icon"),o._uU(48,"lightbulb"),o.qZA(),o.qZA(),o.TgZ(49,"div",19),o._uU(50," Lights & Blinds "),o.qZA(),o.TgZ(51,"app-icon",20),o._uU(52,"chevron_right"),o.qZA(),o.qZA(),o.TgZ(53,"button",17),o.TgZ(54,"div",18),o.TgZ(55,"app-icon"),o._uU(56,"add_to_queue"),o.qZA(),o.qZA(),o.TgZ(57,"div",19),o._uU(58,"TV"),o.qZA(),o.TgZ(59,"app-icon",20),o._uU(60,"chevron_right"),o.qZA(),o.qZA(),o.TgZ(61,"button",17),o.TgZ(62,"div",18),o.TgZ(63,"app-icon"),o._uU(64,"restaurant"),o.qZA(),o.qZA(),o.TgZ(65,"div",19),o._uU(66,"Catering"),o.qZA(),o.TgZ(67,"app-icon",20),o._uU(68,"chevron_right"),o.qZA(),o.qZA(),o.TgZ(69,"button",17),o.TgZ(70,"div",18),o.TgZ(71,"app-icon"),o._uU(72,"help"),o.qZA(),o.qZA(),o.TgZ(73,"div",19),o._uU(74,"Help"),o.qZA(),o.TgZ(75,"app-icon",20),o._uU(76,"chevron_right"),o.qZA(),o.qZA(),o.qZA()),2&e){let e,i,n,s,a,r;o.xp6(1),o.Udp("background-image","url("+t.room_image+")"),o.xp6(3),o.hij(" ",(null==(e=o.lcZ(5,19,t.system))?null:e.display_name)||(null==(e=o.lcZ(6,21,t.system))?null:e.name)||"<Unknown Space>"," "),o.xp6(7),o.ekj("bg-error","busy"===o.lcZ(12,23,t.state))("bg-success","free"===o.lcZ(13,25,t.state))("bg-pending","pending"===o.lcZ(14,27,t.state)),o.xp6(8),o.hij(" ",(null==(i=o.lcZ(20,29,t.event_state))?null:i.current)||"No current event"," "),o.xp6(2),o.Q6J("ngIf","pending"===o.lcZ(22,31,t.state)),o.xp6(2),o.Q6J("ngIf","free"===o.lcZ(24,33,t.state)),o.xp6(3),o.ekj("bg-error",null==(n=o.lcZ(27,35,t.event_state))?null:n.next)("bg-success",!(null!=(s=o.lcZ(28,37,t.event_state))&&s.next)),o.xp6(7),o.hij(" ",(null==(a=o.lcZ(34,39,t.event_state))?null:a.next)||"No upcoming event"," "),o.xp6(2),o.Q6J("ngIf",!(null!=(r=o.lcZ(36,41,t.event_state))&&r.next)),o.xp6(5),o.Q6J("events",o.lcZ(41,43,t.bookings))}},directives:[ye.O5,bs,qe.wG,Ye,xe.lW],pipes:[ye.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;background-color:#f8f8fa;height:100%;width:100%;overflow:hidden}"]}),e})()},{path:"panel-old/:system_id",component:Qn},{path:"panel-array",component:Hn},{path:"panel-select",component:ts},{path:"**",redirectTo:"bootstrap"}];let Cs=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[c.Bz.forRoot(Zs,{useHash:!0})],c.Bz]}),e})();i(4327),i(3658);var ks=i(6828);i(5842);let As=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[ye.ez,l.u5,l.UX,h.lN,m.c,Ze.LD,p.Bb,ks.AV,Ui.p9,_t]]}),e})(),Ts=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[ye.ez,l.u5,l.UX,_t,As,y.Is]]}),e})();var qs=i(2434),Os=i(8241),Is=i(2403);const Us=[{id:"item-1",name:"Coffee",unit_price:200,category:"Drinks",tags:["drink"],options:[{id:"opt-1",name:"Cappacino",group:"type"},{id:"opt-2",name:"Latte",group:"type"},{id:"opt-3",name:"1 Sugar",group:"sugars",unit_price:20},{id:"opt-4",name:"2 Sugar",group:"sugars",unit_price:20},{id:"opt-5",name:"3 Sugar",group:"sugars",unit_price:20},{id:"opt-6",name:"4 Sugar",group:"sugars",unit_price:20}]},{id:"item-2",name:"Soda",unit_price:160,category:"Drinks",tags:["drink"],options:[{id:"opt-1",name:"Pepsi",group:"type"},{id:"opt-2",name:"Sunkist",group:"type"},{id:"opt-3",name:"Solo",group:"type"},{id:"opt-4",name:"Dr Pepper",group:"type"}]},{id:"item-3",name:"Water",unit_price:100,category:"Drinks"},{id:"item-4",name:"Muffin",unit_price:160,category:"Snacks",options:[{id:"opt-1",name:"Choc Chip",group:"type"},{id:"opt-2",name:"Banana",group:"type"},{id:"opt-3",name:"Blueberry",group:"type"}]},{id:"item-5",name:"Cookies",unit_price:400,category:"Snacks",options:[{id:"opt-1",name:"Choc Chip",group:"type"},{id:"opt-2",name:"Macadamia",group:"type"},{id:"opt-3",name:"Dark Choc",group:"type"}]},{id:"item-6",name:"Fish & Chips",unit_price:250,category:"Simple Meals",options:[{id:"opt-1",name:"Tomato Sauce",group:"sauce",unit_price:30},{id:"opt-2",name:"BBQ Sauce",group:"sauce",unit_price:35},{id:"opt-3",name:"Tartare Sause",group:"sauce",unit_price:40},{id:"opt-4",name:"Garlic Aoili Sauce",group:"sauce",unit_price:50}]},{id:"item-7",name:"Sandwich",unit_price:300,category:"Simple Meals",options:[{id:"opt-1",name:"Ham & Cheese",group:"type"},{id:"opt-2",name:"Chicken",group:"type"},{id:"opt-3",name:"Fairy Bread",group:"type"}]}];function js(e){const t=(0,$t.Z)(e.event_start,e.event_end),i=P(Us.length);return{id:`order-${P(999999)}`,event_id:e.id,invoice_number:`I${P(999999)}`,charge_code:`C${P(9999)}`,deliver_at:(0,Tt.Z)(1e3*e.event_start,5*P(Math.floor(t/5))),items:new Array(3).fill(0).map((e,t)=>Object.assign(Object.assign({},Us[i*t%Us.length]),{options:[],quantity:P(10,1)}))}}const Ns=[{created_at:1587057070,updated_at:1587692680,name:"PlaceOS",description:"",tags:"org",count:0,capacity:0,parent_id:"",triggers:[],id:"zone-EmWFTjuYExK"}],Ms=[{name:"Sydney",description:"",tags:"building",count:0,capacity:0,parent_id:"zone-EmWFTjuYExK",triggers:[],id:"bld-01",levels:["lvl-10","lvl-11"]},{name:"Brisbane",description:"",tags:"building",count:0,capacity:0,parent_id:"zone-EmWFTjuYExK",triggers:[],id:"bld-02",levels:["lvl-2","lvl-3"]}],$s=Ms.map(e=>e.levels.map((t,i)=>((e,t,i,n=10)=>{let s=e.substr(4);return s=`assets/maps/level_${n}.svg`,{id:`${i.id}_${e}`,name:`Level ${e.endsWith("00")?"G":e.split("-")[1]}`,parent_id:i.id,description:"",tags:"level",map_id:s,code:"level code 12",type:"staff floor",count:5,capacity:30,location:"optional lat,long",display_name:""}})(t,0,e,+t.split("-")[1]))).reduce((e,t)=>e.concat(t),[{id:"test",parent_id:"bld-01",name:"Test",map_id:"assets/maps/l19.svg"}]),Ls={current:{contacts:{name:"contacts",description:"",details:[{id:"user-1",name:"Jonathan McFarlane (PlaceOS)",email:"jon@place.tech",first_name:"Jonathan",last_name:"McFarlane"},{id:"user-1",name:"Alex Sorafumo (PlaceOS)",email:"alex@place.tech",first_name:"Alex",last_name:"Sorafumo"}]}}},Ss=function(){function e(e,t=5){for(e=`${e}`;e.length<t;)e=`0${e}`;return e}(0,H.pRY)({path:"/api/engine/v2/zones",metadata:{},method:"GET",callback:e=>{if("org"===e.query_params.tags)return Ns;if("building"===e.query_params.tags)return Ms;if("level"===e.query_params.tags)return $s;throw{status:404,message:"Zones not found"}}}),(0,H.pRY)({path:"/api/engine/v2/metadata/:id",metadata:{},method:"GET",callback:e=>{if("bindings"===e.query_params.name)return{bindings:{details:{area_management:"space-0",location_services:"space-0"}}};if("catering"===e.query_params.name)return{catering:{details:Us}};if("desks"===e.query_params.name){const t=e.route_params.id.split("-");return i(t[t.length-1])}return"map_regions"===e.query_params.name?{map_regions:{details:{areas:[{id:"zone-10.A",properties:{capacity:100,label_location:{x:.36,y:.33}}},{id:"zone-10.B",properties:{capacity:100,label_location:{x:.76,y:.33}}},{id:"zone-10.C",properties:{capacity:100,label_location:{x:.63,y:.77}}}]}}}:Ls[e.route_params.id]&&Ls[e.route_params.id][e.query_params.name]?Ls[e.route_params.id]:Ls[e.route_params.id]&&!e.query_params.name&&Ls[e.route_params.id]||{}}}),(0,H.pRY)({path:"/api/engine/v2/metadata/:id",metadata:{},method:"PATCH",callback:e=>{Ls[e.route_params.id]||(Ls[e.route_params.id]={}),Ls[e.route_params.id][e.body.name]=e.body}});const t=["sit_to_stand","single_monitor","dual_monitor"];function i(i){return{desks:{details:new Array(30).fill(0).map((n,s)=>({id:`table-${e(i,2)}.${e(s+1,3)}`,name:`Desk ${i}.${e(s+1,3)}`,bookable:P(9999)%4!=0,group:"",features:t.filter(e=>P(99999)%3==0)}))}}}(0,H.pRY)({path:"/api/engine/v2/metadata/:id/children",metadata:{},method:"GET",callback:e=>{const t=Ms.find(t=>t.id===e.route_params.id);if(!t)throw{status:404,message:`Unable to find zone with id "${e.route_params.id}"`};return $s.filter(e=>e.parent_id===t.id).map(e=>{const t=e.id.split("-");return{zone:e,metadata:i(t[t.length-1])}})}})}(),Js="place.tech",Es=["Jonathan McFarlane","Alex Sorafumo","Jim Doe","Cristina Boston","Jeremy West","Viv Briffa","Candy Russo","Jeff Wiz","Sravani Kotha","Kim Burgess","Caspian Baska","Stephen Von Takach","Cameron Reeves","Shane Boseley"],Ps={id:"current",name:"PlaceOS - Mock User",email:"dev@place.tech",groups:["deals",""]},Ys=Es.map((e,t)=>({id:`user-${t+1}`,name:`${e} (PlaceOS)`,email:`${e.split(" ").join(".").toLowerCase()}@${Js}`})).concat([Ps]),Qs=Es.map((e,t)=>({id:`guest-${t+1}`,name:`${e} (External)`,email:`${e.split(" ").join(".").toLowerCase()}@guest.${Js}`,visit_expected:P(99999)%2==0})),Fs=()=>{const e=["Whiteboard","VidConf","Projector","Views"],t=P(e.length+1),i=[];for(let n=0;n<t;n++)i.push(e[P(e.length)]);return i.filter((e,t,i)=>i.indexOf(e)===t)},Ds=[{name:"Conference Room 10.01",map_id:"area-10.01-status",zones:["bld-01","bld-01_lvl-10"]},{name:"Conference Room 10.02",map_id:"area-10.02-status",zones:["bld-01","bld-01_lvl-10"]},{name:"Conference Room 10.03",map_id:"area-10.03-status",zones:["bld-01","bld-01_lvl-10"]},{name:"Conference Room 11.01",map_id:"area-11.01-status",zones:["bld-01","bld-01_lvl-11"]},{name:"Conference Room 11.02",map_id:"area-11.02-status",zones:["bld-01","bld-01_lvl-11"]},{name:"Conference Room 11.03",map_id:"area-11.03-status",zones:["bld-01","bld-01_lvl-11"]},{name:"Conference Room 2.01",map_id:"area-2.01-status",zones:["bld-02","bld-02_lvl-2"]},{name:"Conference Room 2.02",map_id:"area-2.02-status",zones:["bld-02","bld-02_lvl-2"]},{name:"Conference Room 3.01",map_id:"area-3.01-status",zones:["bld-02","bld-02_lvl-3"]},{name:"Conference Room 3.02",map_id:"area-3.02-status",zones:["bld-02","bld-02_lvl-3"]},{name:"Conference Room 3.03",map_id:"area-3.03-status",zones:["bld-02","bld-02_lvl-3"]}].map(e=>function(e={}){const t="space-"+Kt++,i=`Test Space ${Kt}`,n=P(99999)%2==0&&Kt>1,s=Object.assign({id:t,name:i,long_name:`${i} with an long name`,map_id:`${Kt}`,capacity:2*P(21,1),email:`${i.toLowerCase().split(" ").join(".")}@${X}`,type:"",searchable:P(99999)%2==0,controlable:P(99999)%2==0,bookable:P(99999)%2==0,cost_hour:100*P(300),setup:5*P(6),breakdown:5*P(6),zones:["zone_lvl-0"],support_url:`/control/#/panel/${t}`,bookings:[],linked_rooms:n?[`space-${P(Kt-1)}`]:[],image:""},e);return s.configurations&&s.configurations.length>0&&(s.configurations.forEach(e=>e.capacity=P(s.capacity)+1),s.configurations[0].capacity=s.capacity),s}(Object.assign(Object.assign({},e),{features:Fs()})));let Bs=sn().startOf("d").hour(7);const zs=(e=!1)=>{const t=Bs.add(15*(P(8)+1),"m");return e&&(Bs=t),t.unix()},Hs=["tentative","confirmed","cancelled"],Vs=()=>{const e=P(10);return e<2?Hs[2]:e<5?Hs[0]:Hs[1]},Gs=new Array(200).fill(0).map((e,t)=>{const i=Ys.concat(Qs);let n=new Array(P(8,1)).fill(0).map(()=>i[P(i.length)]);n.sort((e,t)=>(e.visit_expected?0:-1)-(t.visit_expected?0:-1));const s=Ds[P(Ds.length)];n=n.concat(Object.assign(Object.assign({},s),{resource:!0})),P(9999)%2==0?n.unshift(Ps):n.unshift(Ys[P(Ys.length)]),n=I(n,"email")||[{}];const o=zs(!0),a=zs(),r=P(9999)%3==0?"https://meet.place.tech":"";return{id:`cal-event-${t}`,status:Vs(),host:n[0].email,calendar:"calendar_id",creator:"optional@fake.com",attendees:I(n,"email").map((e,t)=>Object.assign(Object.assign({},e),{organizer:0===t,checked_in:P(99999)%2==0,response_status:P(99999)%2==0?"accepted":P(99999)%6==0?"declined":"tentative"})),title:`Some Meeting ${t}`,body:"A Description",private:!1,event_start:o,event_end:a,timezone:"Australia/Sydney",all_day:!1,location:`${s.name}`,recurring:!1,recurrence:{},attachments:{},system:s,meeting_url:r,meeting_id:r?`m${P(9999)}`:"",meeting_provider:r?"PlaceOS":"",extension_data:{catering:P(99999)%4==0?[js({id:`cal-event-${t}`,event_start:o,event_end:a})]:[],setup:5*P(4),breakdown:5*P(4)}}}),Rs={};Gs.forEach(e=>{Rs[e.system.id]||(Rs[e.system.id]=[]),Rs[e.system.id].push(e)});const Xs=function(){(0,H.pRY)({path:"/api/engine/v2/users/:id",metadata:{},method:"GET",callback:e=>{if("current"===e.route_params.id)return Ps;const t=Ys.find(t=>t.email===e.route_params.id);if(t)return t;throw{status:404,message:"User not found"}}}),(0,H.pRY)({path:"/api/staff/v1/people",metadata:{},method:"GET",callback:e=>{if(e.query_params.q){const t=e.query_params.q.toLowerCase();return Ys.filter(e=>e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t))}return Ys}}),(0,H.pRY)({path:"/api/staff/v1/people/:id",metadata:{},method:"GET",callback:e=>{const i=decodeURIComponent(e.route_params.id),n=Ys.find(e=>e.email===i);if(n)return Object.assign(Object.assign({},n),{location:t()});throw{status:404,message:"User not found"}}}),(0,H.pRY)({path:"/api/staff/v1/guests",metadata:{},method:"GET",callback:e=>{if(e.query_params.q){const t=e.query_params.q.toLowerCase();return Qs.filter(e=>e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t))}return Ys}}),(0,H.pRY)({path:"/api/staff/v1/guests/:email",metadata:{},method:"GET",callback:e=>{const t=decodeURIComponent(e.route_params.email),i=Qs.find(e=>e.email===t);if(i)return i;throw{status:404,message:"Guest not found"}}}),(0,H.pRY)({path:"/api/staff/v1/guests/:email/meetings",metadata:{},method:"GET",callback:e=>{if(e.route_params.email){const t=e.route_params.email.toLowerCase();return Gs.filter(e=>e.attendees.find(e=>e.email.toLowerCase()===t))}throw{status:404,message:`Unable to find meetings with guest with email ${e.route_params.email}`}}});const e=["meeting","desk_id","laptop","mobile","geo","none"];function t(){const t=e[P(e.length)],i=$s[P($s.length)],n=Ds.filter(e=>e.zones.includes(i.id)),s=n[P(n.length)]||{},o={};switch(t){case"meeting":o.meeting={building:i.parent_id,level:i.id,system:s.id,map_id:s.map_id,event_id:""};break;case"desk_id":o.meeting={building:i.parent_id,level:i.id,map_id:s.map_id,checked_in:sn().unix()};break;case"laptop":case"mobile":o[t]={building:i.parent_id,level:i.id,x:+P(1e4),y:+P(5e3),last_seen:sn().subtract(P(60),"m").unix()};break;case"geo":o.geo={lat:P(180)-90,lon:P(360)-180,last_seen:sn().subtract(P(60),"m").unix()}}return o}}();class Ws{constructor(e){var t;this.help={help:{title:"Help",content:"\n# Using the asset browser\n\n## Activating the menu\nThe 5 finger touch can be actvated by placing 4 fingers and your thumb on the screen, or quickly double-tapping the screen. Activation through double tap will leave the menu on-screen. To close tap the \u2018X\u2019.\n\n## Selecting a menu item\nLeaving at least one finger on the screen, drag your finger to the icon to select.\n\n## Home Menu\nThe home menu allows you to access files and navigate to content and presentations via the Launcher.\n\n## Connect and stream your laptop or access the CMS to add files\nPlug your laptop into the HDMI to stream it to the screen, or access the CMS to add your own content and create custom presentations.\n\n<video></video>\n\n1. Test1\n2. Test2\n3. Test3\n            "},"laptop-help":{icon:"web_asset",title:"Asset Browser",content:"# Test 2"}},this.tabs=[{icon:"laptop",name:"Laptop",type:"Display",inputs:["Display_1"],help:"laptop-help"},{icon:"call",name:"VC",inputs:["VidConf_1"],help:"vidconf-help",controls:"vidconf-controls"}],this.volume=0,this.name=e.name||"Test Module",this.connected=null===(t=e.connected)||void 0===t||t,this.active=e.active||!1,this.input_list=e.input_list,this.output_list=e.output_list,this.env_sources=e.env_sources||[],this.inputs=Object.keys(this.input_list||{})||[],this.outputs=Object.keys(this.output_list||{})||[],I(this.env_sources.map(e=>e.type)).forEach(e=>this[`${e}`]=this.env_sources.filter(t=>t.type===e).map(e=>e.id)),this.env_sources.forEach(e=>this[`${e.type}/${e.id}`]=e),this.inputs.forEach(e=>this[`input/${e}`]=this.input_list[e]),this.outputs.forEach(e=>this[`output/${e}`]=this.output_list[e])}$power(e=!0){console.log("Power:",e),this.active=e}$share(){}$route(e,t){this.inputs.includes(e)&&this.outputs.includes(t)&&(this.$updateState(e,{routes:I([...this.input_list[e].routes||[],t])}),this.$updateState(t,{source:e,following:e}))}$unroute(){}$connect(){}$disconnect(){}$link(){}$merge(){}$split(){}$notify(){}$preset(){}$volume(e,t="all"){"all"===t&&(this.volume=e)}$mute(e=!0,t="all"){this.$updateState(t,{mute:e})}$unmute(e="all"){this.$mute(!1,e)}$environment(e,t){const i=this.env_sources.find(t=>t.id===e);i&&(this[`${i.type}/${i.id}`]=Object.assign(Object.assign({},i),{state:t}))}$lock(e){this.$updateState(e,{locked:!0})}$unlock(e){this.$updateState(e,{locked:!1})}$updateState(e,t){this[`input/${e}`]?(this[`input/${e}`]=Object.assign(Object.assign({},this[`input/${e}`]),t),this.input_list[e]=Object.assign(Object.assign({},this[`input/${e}`]),t)):this[`output/${e}`]&&(this[`output/${e}`]=Object.assign(Object.assign({},this[`output/${e}`]),t),this.output_list[e]=Object.assign(Object.assign({},this[`output/${e}`]),t))}}const Ks={Mic1:{name:"Lectern Mic",type:"Microphone",mod:"Microphone_1"},Mic2:{name:"Lapel Mic",type:"Microphone",mod:"Microphone_2"},Mic3:{name:"Handheld Mic",type:"Microphone",mod:"Microphone_3"},PC1:{name:"PC-1",type:"PC"},PC2:{name:"PC-2",type:"PC"},PC3:{name:"PC-3",type:"PC"},PC4:{name:"PC-4",type:"PC"},HDMI:{name:"Laptop HDMI",type:"Laptop"},VGA:{name:"Laptop VGA",type:"Laptop"},Camera1:{name:"Camera Rear",type:"Camera",mod:"Camera_1"},Camera2:{name:"Camera Front",type:"Camera",mod:"Camera_2"},Camera3:{name:"Camera Rear 2",type:"Camera",mod:"Camera_3"},Camera4:{name:"Camera Front 2",type:"Camera",mod:"Camera_4"},TV1:{name:"IPTV 1",type:"TV",mod:"IPTV_1"},VC1:{name:"Video Conference 1",type:"VC",mod:"VidConf_1"}},eo={Display1:{name:"Display 1",type:"Display",source:"PC1",mod:"Display_1"},Display2:{name:"Display 2",type:"Display",mod:"Display_2"},Display3:{name:"Display 3",type:"Display",source:"PC2",mod:"Display_3"},Display4:{name:"Display 4",type:"Display",mod:"Display_4"},Display5:{name:"Display 5",type:"Display",mod:"Display_5",source:"TV1"}},to=[{id:"light1",name:"Lighting",type:"lights",states:["Off","Presentation","Meeting","Full"],state:"Off"},{id:"blind1",name:"Blinds",type:"blinds",states:["Off","Presentation","Meeting"],state:"Off"},{id:"screen1",name:"Screen",type:"screen",states:["Up","Down"],state:"Down"}],io=(e,t={})=>new Ws(Object.assign(Object.assign(Object.assign({},e),{input_list:Ks,output_list:eo,env_sources:to}),t));var no=i(8620),so=i(7361);class oo{constructor(e,t){this._space=e,this.time_zone="Australia/Sydney",this.disable_book_now=!1,this.disable_end_meeting=!1,this.bookings=[],this.pending_period=0,this.pending_before=0,this.control_ui="",this.catering_ui="",this.last_booking_started=0,ro(e,this),setInterval(()=>ro(e,this),15e3)}get current_booking(){return this.bookings.find(e=>N(Date.now(),Date.now(),1e3*e.event_start,1e3*e.event_end))}get next_booking(){return this.bookings.find(e=>1e3*e.event_start>Date.now())}get status(){var e,t;const i=new Date,{current_booking:n,next_booking:s}=this,o=new Date(null===(e=n||s)||void 0===e?void 0:e.event_start),a=N(i,i,(0,no.Z)(o,this.pending_before),(0,so.Z)(o,this.pending_period));return(null===(t=this._space)||void 0===t?void 0:t.bookable)?n?"busy":a?"pending":"free":"not-bookable"}$start_meeting(e){this.last_booking_started=e}$end_meeting(e){}$book_now(e,t,i){}}function ao(e,t={}){return new oo(e,t)}function ro(e,t){const i=Gs.filter(t=>{var i;return null===(i=t.attendees)||void 0===i?void 0:i.find(t=>t.email===e.email)})||[];i.sort((e,t)=>e.event_start-t.event_start),t.bookings=i}var lo=i(8934);class co{constructor(){this.overview={},this.emergency_contacts={"First Aid":Ys.filter(e=>P(9999)%5==0),"Fire Warden":Ys.filter(e=>P(9999)%5==0)}}$locate_user(e,t){}}function uo(e,t=3){let i=`${e}`;for(;i.length<t;)i="0"+i;return i}function po(e,t={}){const i=new co;for(const n of $s)i.overview[n.id]={desk_count:100,desk_usage:0,device_capacity:100,device_count:0,estimated_people:0,percentage_use:0,recommendation:1e4},i[`${n.id}:desk_ids`]=new Array(i.overview[n.id].desk_count).fill(0).map((e,t)=>`table-${n.number}.${uo(t)}`),i[`${n.id}`]={value:[]},i[`${n.id}:areas`]={value:[{area_id:"zone-10.B",count:P(100),name:".L1 IFS IT"},{area_id:"zone-10.A",count:P(100),name:".L1 IFS IT"},{area_id:"zone-10.C",count:P(50),name:".L1 IFS IT"}]};return ho(i,$s),setInterval(()=>ho(i,$s),6e4),i}function ho(e,t){for(const i of t)e[i.id]={value:new Array(P(20)).fill(0).map(()=>mo(i,e[`${i.id}:desk_ids`]))}}function mo(e,t,i=Ys){return P(9999)%3==0?{location:"desk",at_location:P(9999)%5!=0,map_id:t[P(t.length)],mac:lo.V.hashStr(i[P(i.length)].email),level:e.id,building:e.parent_id}:{location:"wireless",coordinates_from:"bottom-left",x:P(1e3)/10,y:P(1e3)/10,lon:55.27476066828535,lat:25.20106100633537,s2_cell_id:"3e5f4281459c",mac:lo.V.hashStr(i[P(i.length)].email),variance:9.62534032222287,last_seen:Math.floor((new Date).valueOf()/1e3),map_width:100,map_height:100}}class go{constructor(e){this.presets=["Preset One","Preset 2","Preset Three"]}$pan(e){}$tilt(e){}$recall(e){}$save_preset(e){}}class fo{constructor(e){this.volume=U(100)}$mute(e=!0){this.mute=e}$volume(e){this.volume=e}}class _o{constructor(e){this.volume=U(100)}$mute(e=!0){this.mute=e}$volume(e){this.volume=e}}let vo;class bo{constructor(e){this.status="stopped",this.live=!1,this.remaining=U(86400)}$start(){this.status="playing",vo=setInterval(()=>{this.remaining<1&&clearInterval(vo),this.remaining=this.remaining-1,this.current=this.current+1},3e3)}$pause(){this.status="paused",clearInterval(vo)}$resume(){this.$start()}$stop(){this.status="stopped",this.current=0,clearInterval(vo)}}const yo=(e,t={})=>new bo(Object.assign(Object.assign({},e),t));class xo{constructor(e){this.supported_meeting_url="https://meet."}$econtrol(...e){}}const wo=(e,t={})=>new xo(Object.assign(Object.assign({},e),t));class Zo{constructor(e){this.mic_mute=!1,this.selfview=!1,this.video_layout="Auto",this.presentation_mode="None",this.calls={test:{Status:"Connected"}}}$show_camera_pip(e){this.selfview=e}$mic_mute(e){this.mic_mute=e}$presentation_mode(e){this.presentation_mode=e}$hangup(){}$call_place_on_hold(){for(const e in this.calls)if(this.calls[e].Status)return this.calls[e].Status="OnHold",void(this.calls=Object.assign({},this.calls))}$call_resume(){for(const e in this.calls)if(this.calls[e].Status)return this.calls[e].Status="Idle",void(this.calls=Object.assign({},this.calls))}$video_layout(e){this.video_layout=e}$dtmf_send(e){}$dial(e){return new Promise(e=>setTimeout(()=>e(),1e3))}}const Co=(e={},t={})=>new Zo(Object.assign(Object.assign({},e),t)),ko=(Ds.forEach((e,t)=>function(e){(0,H.$6F)(e.id,{System:[io(e)],Bookings:[ao(e)],AreaManagement:[po()],Camera:new Array(10).fill(0).map(t=>((e,t={})=>new go(Object.assign(Object.assign({},e),t)))(e)),Display:new Array(10).fill(0).map(t=>((e,t={})=>new fo(Object.assign(Object.assign({},e),t)))(e)),Microphone:new Array(10).fill(0).map(t=>((e,t={})=>new _o(Object.assign(Object.assign({},e),t)))(e)),Capture:[yo(e)],MeetingPush:[wo()],VidConf:[Co()]})}(e)),void(0,H.pRY)({path:"/api/engine/v2/systems",metadata:{},method:"GET",callback:e=>Ds})),Ao=((0,H.pRY)({path:"/api/staff/v1/events",metadata:{},method:"GET",callback:e=>{let t=Gs;return e.query_params.zone_ids||(t=t.filter(e=>!!e.attendees.find(e=>e.email===Ps.email))),e.query_params.period_start&&(t=t.filter(t=>N(e.query_params.period_start,e.query_params.period_end,t.event_start,t.event_end))),t}}),(0,H.pRY)({path:"/api/staff/v1/events",metadata:{},method:"POST",callback:e=>{const t=Object.assign(Object.assign({},e.body),{id:`-cal-event-${P(999)}`});return t.attendees=[Ys.find(e=>e.email===t.host),...t.attendees||[]],t.attendees.forEach(e=>{e.zones&&(e.resource=!0)}),t.system&&(t.attendees=[...t.attendees||[],Object.assign(Object.assign({},t.system),{resource:!0})]),Gs.push(t),t}}),(0,H.pRY)({path:"/api/staff/v1/events/:id",metadata:{},method:"GET",callback:e=>{const t=Gs.find(t=>t.id===e.route_params.id);if(t)return t;throw{status:404,message:"Event not found"}}}),(0,H.pRY)({path:"/api/staff/v1/events/:id",metadata:{},method:"DELETE",callback:e=>{const t=Gs.findIndex(t=>t.id===e.route_params.id);if(!(t>0))throw{status:404,message:"Event not found"};Gs[t].host===Ps.email?Gs.splice(t,1):Gs[t].attendees.find(e=>e.email===Ps.email).response_status="declined"}}),(0,H.pRY)({path:"/api/staff/v1/events/:id",metadata:{},method:"PATCH",callback:e=>{const t=Gs.findIndex(t=>t.id===e.route_params.id);if(t>=0)return Gs.splice(t,1,e.body);throw{status:404,message:"Event not found"}}}),void(0,H.pRY)({path:"/api/staff/v1/events/:id/guests/:email/checkin",metadata:{},method:"POST",callback:e=>{const t=Gs.find(t=>t.id===e.route_params.id);if(t)return t.extension_data.checked_in=(t.extension_data.checked_in||[]).concat([e.route_params.email]),t;throw{status:404,message:"Guest not found"}}})),To=function(){(0,H.pRY)({path:"/api/staff/v1/calendars",metadata:{},method:"GET",callback:e=>{const t=Ys[P(Ys.length)],i=Ys[P(Ys.length)],n=Ys[P(Ys.length)];return[{id:Ps.email,summary:Ps.name,primary:!0,can_edit:!0,hidden:!1},{id:t.email,summary:t.name,primary:!1,can_edit:!0,hidden:!1},{id:i.email,summary:i.name,primary:!1,can_edit:!1,hidden:!1},{id:n.email,summary:n.name,primary:!1,can_edit:!1,hidden:!0}]}});const e=e=>{const t=+e.query_params.period_start,i=+e.query_params.period_end,n=(e.query_params.zone_ids||"").split(",").filter(e=>!!e),s=(e.query_params.system_ids||"").split(",").filter(e=>!!e);return Ds.filter(e=>n.length?n.reduce((t,i)=>t&&e.zones.includes(i),!0):!s.length||s.includes(e.id)).filter(e=>{const n=Gs.filter(t=>t.attendees.find(t=>t.id===e.id));for(const s of n)if(N(t,i,s.event_start,s.event_end))return!1;return!0})};(0,H.pRY)({path:"/api/staff/v1/calendars/availability",metadata:{},method:"GET",callback:t=>e(t).map(e=>({resource:e}))}),(0,H.pRY)({path:"/api/staff/v1/calendars/free_busy",metadata:{},method:"GET",callback:t=>e(t).map(e=>({resource:e}))})}();var qo=i(543);let Oo=(0,ui.Z)((0,qo.Z)(Date.now(),3),{hours:7,minutes:0,seconds:0,milliseconds:0});const Io=(e=!1)=>{const t=(0,Tt.Z)(Oo,15*(P(8)+1));return e&&(Oo=t),(0,At.Z)(t)},Uo=["desk","parking"],jo=new Array(200).fill(0).map((e,t)=>{const i=Ys[P(Ys.length)],n=Uo[P(Uo.length)],s=Ms[P(Ms.length)],o=$s.filter(e=>e.parent_id===s.id),a=o[P(o.length)],r=P(999999)%4,l=Ys[P(Ys.length)];return{id:`booking-${t}`,booking_start:Io(!0),booking_end:Io(),user_id:i.id,user_name:i.name,user_email:i.email,asset_id:`desk-${null==a?void 0:a.id}-${t}`,description:`Desk ${t}`,title:`${n} Booking ${t}`,type:n,checked_in:P(999999)%3==0,access:P(999999)%3==0,approved:0===r,rejected:1===r,approver_id:0===r?l.id:"",approver_name:0===r?l.name:"",approver_email:0===r?l.email:"",zones:[s.id,null==a?void 0:a.id],extension_data:{map_id:`table-10.00${t}`}}}),No={ZONE_MOCKS:Ss,USER_MOCKS:Xs,SYSTEM_MOCKS:ko,EVENT_MOCKS:Ao,CALENDAR_MOCKS:To,BOOKING_MOCKS:function(){(0,H.pRY)({path:"/api/staff/v1/bookings",metadata:{},method:"GET",callback:e=>jo.filter(t=>N(e.query_params.period_start,e.query_params.period_end,t.booking_start,t.booking_end)&&t.type===e.query_params.type)}),(0,H.pRY)({path:"/api/staff/v1/bookings/:id",metadata:{},method:"GET",callback:e=>{const t=jo.find(t=>t.id===e.route_params.id);if(!t)throw{status:404,message:`Unable to find booking with ID ${e.route_params.id}`};return t}}),(0,H.pRY)({path:"/api/staff/v1/bookings",metadata:{},method:"POST",callback:e=>{const t=Object.assign(Object.assign({},e.body),{id:`-booking-${P(999)}`});return jo.push(t),t}});const e=(e,t)=>{const i=jo.findIndex(t=>t.id===e);if(i<0)throw{status:404,message:`Unable to find booking with ID ${e}`};const n=Object.assign({},t);return jo.splice(i,1,n),n};(0,H.pRY)({path:"/api/staff/v1/bookings/:id",metadata:{},method:"PUT",callback:t=>e(t.route_params.id,Object.assign({},t.body))}),(0,H.pRY)({path:"/api/staff/v1/bookings/:id/approve",metadata:{},method:"POST",callback:t=>e(t.route_params.id,Object.assign(Object.assign({},t.body),{approved:!0,rejected:!1}))}),(0,H.pRY)({path:"/api/staff/v1/bookings/:id/reject",metadata:{},method:"POST",callback:t=>e(t.route_params.id,Object.assign(Object.assign({},t.body),{approved:!1,rejected:!0}))}),(0,H.pRY)({path:"/api/staff/v1/bookings/:id/check_in",metadata:{},method:"POST",callback:t=>e(t.route_params.id,Object.assign(Object.assign({},t.body),{checked_in:"true"===t.query_params.state}))}),(0,H.pRY)({path:"/api/staff/v1/bookings/:id",metadata:{},method:"DELETE",callback:e=>{const t=jo.findIndex(t=>t.id===e.route_params.id);if(t<0)throw{status:404,message:`Unable to find booking with ID ${e.route_params.id}`};jo.splice(t,1)}})}()};q("MOCKS","Mocks included with application.");let Mo=(()=>{class e extends b{constructor(e,t,i,n,s,o,a,r){super(),this._tracing=e,this._settings=t,this._org=i,this._spaces=n,this._cache=s,this._snackbar=o,this._hotkey=a,this._clipboard=r}ngOnInit(){var e,t;return(0,g.mG)(this,void 0,void 0,function*(){q("APP","MOCKS:",n),this._hotkey.listen(["Control","Alt","Shift","KeyM"],()=>{localStorage.setItem("mock",`${"true"!==localStorage.getItem("mock")}`),location.reload()}),this._hotkey.listen(["Control","Alt","Shift","KeyC"],()=>{this._clipboard.copy(`${(0,H.rao)()}|${(0,H.g$u)()}`),pe("Successfully copied token.")}),this._hotkey.listen(["Control","Alt","Shift","KeyV"],()=>{var e;null===(e=navigator.clipboard)||void 0===e||e.readText().then(e=>{const t=e.split("|"),i=(0,H.I4i)();localStorage.setItem(`${i}_access_token`,`${t[0]}`),localStorage.setItem(`${i}_refresh_token`,`${t[1]}`),localStorage.setItem(`${i}_expires_at`,`${(0,hs.Z)(new Date,6).valueOf()}`),pe("Successfully pasted token."),setTimeout(()=>location.reload(),2e3)})}),re=this._snackbar,yield this._settings.initialised.pipe((0,f.P)(e=>e)).toPromise(),T(this._settings.get("app.short_name"));const i=this._settings.get("composer")||{};var s,o;i.mock=!!this._settings.get("mock")||location.origin.includes("demo.place.tech"),yield function(e){return(0,g.mG)(this,void 0,void 0,function*(){const t=e.protocol||location.protocol,i=e.domain||location.hostname,n=e.port||location.port,s=e.use_domain?`${t}//${i}:${n}`:location.origin,o=(location.pathname+"/").replace("//","/");console.log("Mock:",e.mock,location.href.includes("mock=true"),"true"===localStorage.getItem("mock"));const a=e.mock||location.href.includes("mock=true")||"true"===localStorage.getItem("mock"),r={auth_type:"auth_code",scope:"public",host:`${i}${n?":"+n:""}`,auth_uri:`${s}/auth/oauth/authorize`,token_uri:`${s}/auth/oauth/token`,redirect_uri:`${location.origin}${o}oauth-resp.html`,handle_login:!e.local_login,use_iframe:!0,mock:a};return localStorage&&localStorage.setItem("mock",`${!!a&&!location.href.includes("mock=false")}`),a&&me("Application in mock mode."),(0,H.cYp)(r)})}(i).catch(()=>this.onInitError()),function(e,t=(()=>null),i=3e5){e.isEnabled&&(le&&le.unsubscribe(),ce&&ce.unsubscribe(),ue&&clearInterval(ue),le=e.available.subscribe(t=>{q("CACHE",`Update available: current version is ${t.current.hash} available version is ${t.available.hash}`),function(e){e.isEnabled&&(q("CACHE","Activating changes to the cache..."),e.activateUpdate().then(()=>{me("Newer version of the application is available","Refresh",()=>location.reload(!0))}))}(e)}),ce=e.activated.subscribe(()=>{q("CACHE","Updates activated. Reloading..."),t("Newer version of the application is available",()=>location.reload(!0))}),ue=setInterval(()=>{q("CACHE","Checking for updates..."),e.checkForUpdate()},i))}(this._cache),this.timeout("wait_for_user",()=>this.onInitError(),3e4),yield ie.pipe((0,f.P)(e=>!!e)).toPromise(),this.clearTimeout("wait_for_user"),(s=ne())&&(mi=s),o=this._settings.get("app.general.internal_user_domain")||`@${null===(t=null===(e=ne())||void 0===e?void 0:e.email)||void 0===t?void 0:t.split("@")[1]}`,X=o,function(e,t=.2){e&&Os.S({dsn:e,integrations:[new qs.jK.BrowserTracing({tracingOrigins:["localhost",location.origin],routingInstrumentation:Is.$q})],tracesSampleRate:t})}(this._settings.get("app.sentry_dsn"))})}onInitError(){var e;(0,H.y7C)()||(null===(e=ne())||void 0===e?void 0:e.is_logged_in)||(console.error("Error initialising user."),(0,H.Ogr)(),location.reload())}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(Is.aN),o.Y36(se),o.Y36(be),o.Y36(ut),o.Y36(u.yO),o.Y36(d.ux),o.Y36(F),o.Y36(Te.TU))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-root"]],features:[o.qOj],decls:4,vars:0,consts:[[1,"flex-1","w-full","relative","h-1/2"]],template:function(e,t){1&e&&(o._UZ(0,"global-banner"),o.TgZ(1,"div",0),o._UZ(2,"router-outlet"),o.qZA(),o._UZ(3,"global-loading"))},directives:[gt,c.lC,ht],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}"]}),e})();var $o=i(9624);let Lo=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[ye.ez,_t]]}),e})(),So=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[ye.ez,_t,qe.si]]}),e})();const Jo=[h.lN,m.c,p.Bb];let Eo=(()=>{class e{constructor(){console.log("Production:",!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e,bootstrap:[Mo]}),e.\u0275inj=o.cJS({providers:[{provide:o.qLn,useValue:$o.v({showDialog:!1})},{provide:Is.aN,deps:[c.F0]}],imports:[[s.b2,a.PW,Cs,r.JF,l.u5,d.ZX,qe.si,Ts,Lo,So,_t,...Jo,u.Wr.register("ngsw-worker.js",{enabled:true})]]}),e})();(0,o.G48)(),s.q6().bootstrapModule(Eo).catch(e=>console.error(e))}},e=>{"use strict";e.O(0,["vendor"],()=>e(e.s=5849)),e.O()}]);
//# sourceMappingURL=main.js.map