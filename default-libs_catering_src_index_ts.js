"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{5185:(S,w,n)=>{n.d(w,{Ud:()=>tt.U,GX:()=>et.G,Ii:()=>nt.I,jW:()=>T.j,F7:()=>$,uy:()=>k});var e=n(6477),t=n(9542),O=n(2556),o=n(7672),b=n(7486),a=n(9314),N=n(2128),B=n(8046),I=n(2423),R=n(8750),E=n(9816),Z=n(3723),j=(n(6336),n(8644),n(8501),n(7413),n(4204),n(2189),n(9504),n(3129),n(961),n(5730),n(3893),n(1655),n(1581),n(5486),n(6037),n(1670)),u=n(9743),g=n(3910),T=n(729),i=n(6839),f=n(5306),r=n(7728),d=n(380),_=n(5312);function p(Q,H){if(1&Q){const L=i.EpF();i.TgZ(0,"div",6)(1,"mat-form-field",7)(2,"input",8),i.NdJ("ngModelChange",function(Y){const X=i.CHM(L).index,z=i.oxw(2);return i.KtG(z.charge_codes[X]=Y)}),i.qZA()(),i.TgZ(3,"button",9),i.NdJ("click",function(){const V=i.CHM(L).index,X=i.oxw(2);return i.KtG(X.removeCode(V))}),i.TgZ(4,"app-icon"),i._uU(5,"delete"),i.qZA()()()}if(2&Q){const L=H.index,G=i.oxw(2);i.xp6(2),i.Q6J("ngModel",G.charge_codes[L])}}function K(Q,H){if(1&Q&&(i.TgZ(0,"main",4),i.YNc(1,p,6,1,"div",5),i.qZA()),2&Q){const L=i.oxw();i.xp6(1),i.Q6J("ngForOf",L.charge_codes)("ngForTrackBy",L.trackByFn)}}function J(Q,H){if(1&Q){const L=i.EpF();i.TgZ(0,"footer",10)(1,"button",11),i._uU(2," Import Codes "),i.TgZ(3,"input",12),i.NdJ("change",function(Y){i.CHM(L);const V=i.oxw();return i.KtG(V.addCodesFromFile(Y))}),i.qZA()(),i.TgZ(4,"button",13),i.NdJ("click",function(){i.CHM(L);const Y=i.oxw();return i.KtG(Y.newCode())}),i._uU(5," Add Code "),i.qZA(),i.TgZ(6,"button",13),i.NdJ("click",function(){i.CHM(L);const Y=i.oxw();return i.KtG(Y.saveChargeCodes())}),i._uU(7," Save Changes "),i.qZA()()}}function F(Q,H){1&Q&&(i.TgZ(0,"main",14),i._UZ(1,"mat-spinner",15),i.TgZ(2,"p"),i._uU(3,"Saving changes to charge codes..."),i.qZA()())}let $=(()=>{class Q{constructor(L,G){this._state=L,this._dialog_ref=G,this.charge_codes=[],this.loading=!1}ngOnInit(){var L=this;return(0,j.Z)(function*(){L.charge_codes=(yield L._state.charge_codes.pipe((0,g.q)(1)).toPromise())||[]})()}newCode(){this.charge_codes.push("")}removeCode(L){this.charge_codes.splice(L,1)}addCodesFromFile(L){if(L.target){const G=L.target.files[0];if(G){const Y=new FileReader;Y.readAsText(G,"UTF-8"),Y.addEventListener("load",V=>{const X=(0,u.n5)(V.srcElement.result)||[];for(const{code:z}of X)this.charge_codes.push(z);this.charge_codes=(0,u.Tw)(this.charge_codes),L.target.value=""}),Y.addEventListener("error",V=>(0,u.cB)("Error reading file."))}}}saveChargeCodes(){var L=this;return(0,j.Z)(function*(){L.loading=!0;const G=L.charge_codes.filter(Y=>Y&&Y.trim());yield L._state.saveSettings({charge_codes:G}),L._dialog_ref.close()})()}trackByFn(L,G){return L}}return Q.\u0275fac=function(L){return new(L||Q)(i.Y36(T.j),i.Y36(b.so))},Q.\u0275cmp=i.Xpm({type:Q,selectors:[["charge-code-list-modal"]],decls:10,vars:3,consts:[["icon","","mat-dialog-close",""],["class","overflow-auto max-h-[65vh] min-h-[20rem] flex flex-col",4,"ngIf","ngIfElse"],["class","flex items-center p-2 space-x-2 border-t border-base-200",4,"ngIf"],["load_state",""],[1,"overflow-auto","max-h-[65vh]","min-h-[20rem]","flex","flex-col"],["class","flex items-center space-x-2 w-full hover:bg-neutral px-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","space-x-2","w-full","hover:bg-neutral","px-2"],["appearance","outline",1,"h-14","flex-1"],["matInput","","placeholder","Charge Code",3,"ngModel","ngModelChange"],["icon","",3,"click"],[1,"flex","items-center","p-2","space-x-2","border-t","border-base-200"],["btn","","matRipple","",1,"w-48","inverse","relative"],["type","file",1,"opacity-0","absolute","inset-0",3,"change"],["btn","","matRipple","",1,"w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-20","space-y-2"],["diameter","32"]],template:function(L,G){if(1&L&&(i.TgZ(0,"header")(1,"h2"),i._uU(2,"Edit Charge Codes"),i.qZA(),i.TgZ(3,"button",0)(4,"app-icon"),i._uU(5,"close"),i.qZA()()(),i.YNc(6,K,2,2,"main",1),i.YNc(7,J,8,0,"footer",2),i.YNc(8,F,4,0,"ng-template",null,3,i.W1O)),2&L){const Y=i.MAs(9);i.xp6(6),i.Q6J("ngIf",!G.loading)("ngIfElse",Y),i.xp6(1),i.Q6J("ngIf",!G.loading)}},dependencies:[e.sg,e.O5,b.ZT,t.Fj,t.JJ,t.On,f.o,R.KE,r.wG,d.Nt,_.Ou]}),Q})();n(9471);let k=(()=>{class Q{}return Q.\u0275fac=function(L){return new(L||Q)},Q.\u0275mod=i.oAB({type:Q}),Q.\u0275inj=i.cJS({imports:[e.ez,a.Tx,N.Nh,O.Bb,b.Is,o.p9,B.Fk,I.AV,t.u5,t.UX,Z.K,R.lN,E.W9]}),Q})();var tt=n(2962),et=n(5163),nt=n(2851);n(2460)},5730:(S,w,n)=>{n.d(w,{m:()=>Z});var e=n(6839),t=n(9743),O=n(2962),o=n(6477),b=n(7486),a=n(5306),N=n(7728),B=n(5312);function I(M,D){1&M&&(e.TgZ(0,"button",4)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function R(M,D){if(1&M){const h=e.EpF();e.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),e._uU(3,"upload"),e.qZA(),e.TgZ(4,"p"),e._uU(5,"Click to select file or Drag and drop files"),e.qZA(),e.TgZ(6,"input",7),e.NdJ("change",function(A){e.CHM(h);const x=e.oxw();return e.KtG(x.handleFileEvent(A))}),e.qZA()(),e.TgZ(7,"div",8)(8,"button",9),e.NdJ("click",function(){e.CHM(h);const A=e.oxw();return e.KtG(A.downloadTemplate())}),e._uU(9," Download Template "),e.qZA()()()}}function E(M,D){if(1&M&&(e.TgZ(0,"main",10),e._UZ(1,"mat-spinner",11),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&M){const h=e.oxw();e.xp6(3),e.Oqu(h.loading)}}let Z=(()=>{class M{constructor(){this.event=new e.vpe}handleFileEvent(h){this.loading="Processing menu data...";const y=h.target;if(!y?.files)return this.loading="";const A=y.files;if(!A.length)return this.loading="";const x=A[0],C=new FileReader;C.addEventListener("loadend",l=>{const c=(0,t.n5)(l.target.result);this.loading="",this.event.emit({reason:"done",metadata:c.filter(v=>"item"===(v.type||"").toLowerCase()).map(v=>new O.U({...v,options:c.filter(m=>"option"===(m.type||"").toLowerCase()&&m.tags===v.id).map(m=>({id:m.id,name:m.name,group:m.category,multiple:m.multiple,unit_price:m.unit_price}))}))})}),C.readAsText(x)}downloadTemplate(){(0,t.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return M.\u0275fac=function(h){return new(h||M)},M.\u0275cmp=e.Xpm({type:M,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["icon","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["icon","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-base-200","border-dashed","rounded-xl","hover:bg-base-200","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["matRipple","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(h,y){if(1&h&&(e.TgZ(0,"header",0)(1,"h2"),e._uU(2,"Import Catering Menu"),e.qZA(),e.YNc(3,I,3,0,"button",1),e.qZA(),e.YNc(4,R,10,0,"main",2),e.YNc(5,E,4,1,"ng-template",null,3,e.W1O)),2&h){const A=e.MAs(6);e.xp6(3),e.Q6J("ngIf",!y.loading),e.xp6(1),e.Q6J("ngIf",!y.loading)("ngIfElse",A)}},dependencies:[o.O5,b.ZT,a.o,N.wG,B.Ou]}),M})()},6336:(S,w,n)=>{n.d(w,{w:()=>T});var e=n(4387),t=n(6839),O=n(9542),o=n(7486),b=n(9743),a=n(2962),N=n(6477),B=n(2556),I=n(7728),R=n(7672),E=n(5306),Z=n(8750),M=n(380),D=n(5312),h=n(1031),y=n(2793),A=n(3670);function x(i,f){1&i&&(t.TgZ(0,"button",6)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function C(i,f){if(1&i&&(t.TgZ(0,"div",17)(1,"label",18),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",19),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA()()()),2&i){const r=t.oxw(2);t.xp6(1),t.ekj("error",r.form.controls.name.invalid&&r.form.controls.name.touched)}}function l(i,f){if(1&i&&(t.TgZ(0,"div",17)(1,"label",21),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",19),t._UZ(7,"input",22),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA()()()),2&i){const r=t.oxw(2),d=t.MAs(9);t.xp6(1),t.ekj("error",r.form.controls.category.invalid&&r.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",d)}}function s(i,f){if(1&i){const r=t.EpF();t.TgZ(0,"mat-chip-row",29),t.NdJ("removed",function(){const p=t.CHM(r).$implicit,K=t.oxw(3);return t.KtG(K.removeTag(p))}),t._uU(1),t.TgZ(2,"button",30)(3,"app-icon"),t._uU(4,"cancel"),t.qZA()()()}if(2&i){const r=f.$implicit;t.xp6(1),t.hij(" ",r," "),t.xp6(1),t.uIk("aria-label","Remove "+r)}}function c(i,f){if(1&i){const r=t.EpF();t.TgZ(0,"div",17)(1,"label",23),t.SDv(2,24),t.qZA(),t.TgZ(3,"mat-form-field",19)(4,"mat-chip-grid",25,26),t.YNc(6,s,5,2,"mat-chip-row",27),t.qZA(),t.TgZ(7,"input",28),t.NdJ("matChipInputTokenEnd",function(_){t.CHM(r);const p=t.oxw(2);return t.KtG(p.addTag(_))}),t.qZA()()()}if(2&i){const r=t.MAs(5),d=t.oxw(2);t.xp6(1),t.ekj("error",d.form.controls.tags.invalid&&d.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",d.tag_list),t.xp6(1),t.Q6J("matChipInputFor",r)("matChipInputSeparatorKeyCodes",d.separators)("matChipInputAddOnBlur",!0)}}function v(i,f){1&i&&(t.TgZ(0,"div",17)(1,"label",31),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",19),t._UZ(4,"textarea",32),t.qZA()())}function m(i,f){if(1&i&&(t.TgZ(0,"div",17)(1,"label",18),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",19),t._UZ(7,"input",33),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA()()()),2&i){const r=t.oxw(2);t.xp6(1),t.ekj("error",r.form.controls.unit_price.invalid&&r.form.controls.unit_price.touched)}}function U(i,f){1&i&&(t.TgZ(0,"div",17)(1,"label",34),t.SDv(2,35),t.qZA(),t._UZ(3,"image-list-field",36),t.qZA())}const P=function(){return{standalone:!0}};function W(i,f){if(1&i){const r=t.EpF();t.TgZ(0,"form",7)(1,"div",8),t.YNc(2,C,10,2,"div",9),t.YNc(3,l,10,3,"div",9),t.qZA(),t.YNc(4,c,8,6,"div",9),t.YNc(5,v,5,0,"div",9),t.YNc(6,m,10,2,"div",9),t.TgZ(7,"div",10)(8,"label",11),t._uU(9,"Accept Points?"),t.qZA(),t.TgZ(10,"mat-checkbox",12),t._uU(11),t.qZA()(),t.TgZ(12,"div",13)(13,"mat-checkbox",14),t.NdJ("ngModelChange",function(_){t.CHM(r);const p=t.oxw();return t.KtG(_?p.addTag({value:"Gluten Free"}):p.removeTag("Gluten Free"))}),t._uU(14," Gluten Free (GF) "),t.qZA(),t.TgZ(15,"mat-checkbox",14),t.NdJ("ngModelChange",function(_){t.CHM(r);const p=t.oxw();return t.KtG(_?p.addTag({value:"Vegan"}):p.removeTag("Vegan"))}),t._uU(16," Vegan (VG) "),t.qZA(),t.TgZ(17,"mat-checkbox",14),t.NdJ("ngModelChange",function(_){t.CHM(r);const p=t.oxw();return t.KtG(_?p.addTag({value:"Vegetarian"}):p.removeTag("Vegetarian"))}),t._uU(18," Vegetarian (V) "),t.qZA(),t.TgZ(19,"mat-checkbox",14),t.NdJ("ngModelChange",function(_){t.CHM(r);const p=t.oxw();return t.KtG(_?p.addTag({value:"Contains Dairy"}):p.removeTag("Contains Dairy"))}),t._uU(20," Contains Dairy (D) "),t.qZA(),t.TgZ(21,"mat-checkbox",14),t.NdJ("ngModelChange",function(_){t.CHM(r);const p=t.oxw();return t.KtG(_?p.addTag({value:"Contains Nuts"}):p.removeTag("Contains Nuts"))}),t._uU(22," Contains Nuts (N) "),t.qZA()(),t.TgZ(23,"div",10)(24,"label",15),t._uU(25,"Discount Cap"),t.qZA(),t._UZ(26,"a-counter",16),t.qZA(),t.YNc(27,U,4,0,"div",9),t.qZA()}if(2&i){const r=t.oxw();let d;t.Q6J("formGroup",r.form),t.xp6(2),t.Q6J("ngIf",r.form.controls.name),t.xp6(1),t.Q6J("ngIf",r.form.controls.category),t.xp6(1),t.Q6J("ngIf",r.form.controls.tags),t.xp6(1),t.Q6J("ngIf",r.form.controls.description),t.xp6(1),t.Q6J("ngIf",r.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(d=r.form.get("accept_points"))&&d.value?"No":"Yes"),t.xp6(2),t.Q6J("ngModel",r.hasTag("Gluten Free"))("ngModelOptions",t.DdM(22,P)),t.xp6(2),t.Q6J("ngModel",r.hasTag("Vegan"))("ngModelOptions",t.DdM(23,P)),t.xp6(2),t.Q6J("ngModel",r.hasTag("Vegetarian"))("ngModelOptions",t.DdM(24,P)),t.xp6(2),t.Q6J("ngModel",r.hasTag("Contains Dairy"))("ngModelOptions",t.DdM(25,P)),t.xp6(2),t.Q6J("ngModel",r.hasTag("Contains Nuts"))("ngModelOptions",t.DdM(26,P)),t.xp6(5),t.Q6J("min",0)("max",100)("step",5)("render_fn",r.renderPercent),t.xp6(1),t.Q6J("ngIf",r.form.controls.images)}}function j(i,f){if(1&i){const r=t.EpF();t.TgZ(0,"footer",37)(1,"button",38),t.NdJ("click",function(){t.CHM(r);const _=t.oxw();return t.KtG(_.saveChanges())}),t._uU(2," Save "),t.qZA()()}if(2&i){const r=t.oxw();t.xp6(1),t.Q6J("disabled",!r.form.dirty)}}function u(i,f){1&i&&(t.TgZ(0,"div",39),t._UZ(1,"mat-spinner",40),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA()())}function g(i,f){if(1&i&&(t.TgZ(0,"mat-option",41),t._uU(1),t.qZA()),2&i){const r=f.$implicit;t.Q6J("value",r),t.xp6(1),t.hij(" ",r," ")}}let T=(()=>{class i{get item(){return this._data.item||new a.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(r=0){return`${r}%`}hasTag(r){return this.tag_list.includes(r)}constructor(r){this._data=r,this.event=new t.vpe,this.form=new O.cw({name:new O.NI(this.item.name||"",[O.kI.required]),description:new O.NI(this.item.description||""),category:new O.NI(this.item.category||"",[O.kI.required]),unit_price:new O.NI(this.item.unit_price,[O.kI.required]),tags:new O.NI(this.item.tags||[]),accept_points:new O.NI(this.item.accept_points||!1),discount_cap:new O.NI(this.item.discount_cap||0),images:new O.NI(this.item.images||[])}),this.loading=!1,this.separators=[e.K5,e.OC,e.L_]}addTag(r){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const d=r.input,_=r.value,p=this.tag_list;(_||"").trim()&&(p.push(_),this.form.controls.tags.setValue(p)),d&&(d.value="")}removeTag(r){if(!this.form||!this.form.controls.tags)return;const d=this.tag_list;this.form.controls.tags.markAsDirty();const _=d.indexOf(r);_>=0&&(d.splice(_,1),this.form.controls.tags.setValue(d))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new a.U({...this.item,id:this.item.id||`item-${(0,b.Iy)(99999999)}`,...this.form.value})}})}}return i.\u0275fac=function(r){return new(r||i)(t.Y36(o.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let f,r,d;return f=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,r=$localize`:@@zoneTagsPlaceholder␟c133beffffe3288bbdbf8572a32910c33ce14991␟2194594490376201833:Item tags e.g. Gluten Free, Vegan etc.`,d=$localize`:@@imagesLabel␟e5d9e00faa06714d7671b164cad364b26f4c585b␟5137125764814732349:Images:`,[["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-base-200",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],[1,"flex","items-center","space-x-2"],["class","flex flex-col",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],["list","",1,"flex","items-center","flex-wrap","max-w-lg"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-base-200","rounded",3,"min","max","step","render_fn"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],f,["aria-label","Item Tags"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],["name","tags","placeholder",r,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"removed"],["matChipRemove",""],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["for","images"],d,["name","images","formControlName","images"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-base-200"],["btn","","matRipple","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(r,d){if(1&r&&(t.TgZ(0,"header")(1,"h3"),t._uU(2),t.qZA(),t.YNc(3,x,3,0,"button",0),t.qZA(),t.YNc(4,W,28,27,"form",1),t.YNc(5,j,3,1,"footer",2),t.YNc(6,u,4,0,"ng-template",null,3,t.W1O),t.TgZ(8,"mat-autocomplete",null,4),t.YNc(10,g,2,2,"mat-option",5),t.qZA()),2&r){const _=t.MAs(7);t.xp6(2),t.hij("",d.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!d.loading),t.xp6(1),t.Q6J("ngIf",d.form&&!d.loading)("ngIfElse",_),t.xp6(1),t.Q6J("ngIf",!d.loading),t.xp6(5),t.Q6J("ngForOf",d.categories)}},dependencies:[N.sg,N.O5,B.XC,I.ey,B.ZL,o.ZT,R.oG,O._Y,O.Fj,O.wV,O.JJ,O.JL,O.On,O.sg,O.u,E.o,Z.KE,Z.TO,I.wG,M.Nt,D.Ou,h.RA,h.oH,h.qH,h.z3,y.R,A.h],styles:["[list][_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin:.5rem}\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--60.css.map*/"]}),i})()},8644:(S,w,n)=>{n.d(w,{V:()=>C});var e=n(9743),t=n(2962),O=n(729),o=n(6839),b=n(6477),a=n(9314),N=n(7672),B=n(2423),I=n(9542),R=n(5306),E=n(7728);const Z=["catering-menu-item",""];function M(l,s){if(1&l&&(o.TgZ(0,"button",14)(1,"app-icon"),o._uU(2,"more_vert"),o.qZA()()),2&l){o.oxw(2);const c=o.MAs(4);o.Q6J("matMenuTriggerFor",c)}}function D(l,s){if(1&l){const c=o.EpF();o.TgZ(0,"div",6)(1,"mat-checkbox",7),o.NdJ("ngModelChange",function(m){o.CHM(c);const U=o.oxw();return o.KtG(U.is_enabled=m)}),o.qZA(),o.TgZ(2,"div",8)(3,"div",9)(4,"div"),o._uU(5),o.qZA(),o.TgZ(6,"div",10),o._uU(7),o.qZA()(),o.TgZ(8,"div",11),o._uU(9),o.ALo(10,"currency"),o.ALo(11,"async"),o.qZA()(),o.YNc(12,M,3,1,"button",12),o.TgZ(13,"button",13),o.NdJ("click",function(){o.CHM(c);const m=o.oxw();return o.KtG(m.show_options=!m.show_options)}),o.TgZ(14,"app-icon"),o._uU(15,"expand_more"),o.qZA()()()}if(2&l){const c=o.oxw();o.xp6(1),o.Q6J("ngModel",c.is_enabled),o.xp6(4),o.Oqu(c.item.name),o.xp6(2),o.hij(" ",c.item.category," "),o.xp6(2),o.hij(" ",o.xi3(10,6,c.item.unit_price/100,o.lcZ(11,9,c.symbol))," "),o.xp6(3),o.Q6J("ngIf",c.can_edit),o.xp6(1),o.Q6J("disabled",!c.item.options.length)}}function h(l,s){if(1&l){const c=o.EpF();o.TgZ(0,"button",23),o.NdJ("click",function(){o.CHM(c);const m=o.oxw().$implicit,U=o.oxw(2);return o.KtG(U.editOption(m))}),o.TgZ(1,"app-icon"),o._uU(2,"edit"),o.qZA()()}}function y(l,s){if(1&l){const c=o.EpF();o.TgZ(0,"button",24),o.NdJ("click",function(){o.CHM(c);const m=o.oxw().$implicit,U=o.oxw(2);return o.KtG(U.removeOption(m))}),o.TgZ(1,"app-icon"),o._uU(2,"delete"),o.qZA()()}}function A(l,s){if(1&l&&(o.TgZ(0,"div",17),o._UZ(1,"div",18),o.TgZ(2,"div",19)(3,"div",20),o._uU(4),o.qZA(),o.TgZ(5,"div",10),o._uU(6),o.qZA()(),o.YNc(7,h,3,0,"button",21),o.YNc(8,y,3,0,"button",22),o.qZA()),2&l){const c=s.$implicit,v=o.oxw(2);o.xp6(4),o.Oqu(c.name),o.xp6(2),o.hij(" ",c.group," "),o.xp6(1),o.Q6J("ngIf",v.can_edit),o.xp6(1),o.Q6J("ngIf",v.can_edit)}}function x(l,s){if(1&l&&(o.TgZ(0,"div",15),o.YNc(1,A,9,4,"div",16),o.qZA()),2&l){const c=o.oxw();o.Udp("height",c.show_options?3.5*c.item.options.length+"rem":"0"),o.xp6(1),o.Q6J("ngForOf",c.item.options)}}let C=(()=>{class l{get can_edit(){return this._catering.is_editable}get is_enabled(){return!this.item.hide_for_zones.includes(this._catering.zone)}set is_enabled(c){let v=this.item.hide_for_zones;v=c?v.filter(m=>m!==this._catering.zone):(0,e.Tw)([...v,this._catering.zone]),this._catering.updateItem(new t.U({...this.item,hide_for_zones:v}))}get symbol(){return this._catering.currency}constructor(c){this._catering=c,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=v=>this._catering.addOption(this.item,v),this.removeOption=v=>this._catering.deleteOption(this.item,v),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}}return l.\u0275fac=function(c){return new(c||l)(o.Y36(O.j))},l.\u0275cmp=o.Xpm({type:l,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:Z,decls:20,vars:2,consts:[[1,"w-full","h-full","bg-base-100","border","border-base-200","overflow-hidden","rounded"],["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-base-200 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],["matTooltip","Allow Ordering Item",1,"mr-2",3,"ngModel","ngModelChange"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","opacity-60"],[1,"p-2","m-2","text-xs","font-bold","text-secondary-content","rounded","bg-secondary"],["icon","","matRipple","",3,"matMenuTriggerFor",4,"ngIf"],["icon","","matRipple","",3,"disabled","click"],["icon","","matRipple","",3,"matMenuTriggerFor"],["options","",1,"bg-base-200","overflow-hidden"],["class","flex p-2 items-center border-t border-solid border-base-200 relative",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-t","border-solid","border-base-200","relative"],[1,"absolute","inset-y-0","left-0","w-2","bg-black","opacity-10"],[1,"flex-1","pl-4","pr-2"],[1,"text"],["edit","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["remove","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["edit","","icon","","matRipple","",1,"mx-2",3,"click"],["remove","","icon","","matRipple","",1,"mx-2",3,"click"]],template:function(c,v){1&c&&(o.TgZ(0,"div",0),o.YNc(1,D,16,11,"div",1),o.YNc(2,x,2,3,"div",2),o.TgZ(3,"mat-menu",null,3)(5,"button",4),o.NdJ("click",function(){return v.addOption()}),o.TgZ(6,"app-icon"),o._uU(7,"add"),o.qZA(),o.TgZ(8,"div",5),o._uU(9,"Add Option"),o.qZA()(),o.TgZ(10,"button",4),o.NdJ("click",function(){return v.editItem()}),o.TgZ(11,"app-icon"),o._uU(12,"edit"),o.qZA(),o.TgZ(13,"div",5),o._uU(14,"Edit Item"),o.qZA()(),o.TgZ(15,"button",4),o.NdJ("click",function(){return v.removeItem()}),o.TgZ(16,"app-icon"),o._uU(17,"delete"),o.qZA(),o.TgZ(18,"div",5),o._uU(19,"Remove Item"),o.qZA()()()()),2&c&&(o.xp6(1),o.Q6J("ngIf",v.item),o.xp6(1),o.Q6J("ngIf",v.item))},dependencies:[b.sg,b.O5,a.VK,a.OP,a.p6,N.oG,B.gM,I.JJ,I.On,R.o,E.wG,b.Ov,b.H9],styles:["[_nghost-%COMP%]{overflow:hidden;width:48rem;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=catering-menu-item.component.ts-angular-inline--63.css.map*/"]}),l})()},8501:(S,w,n)=>{n.d(w,{B:()=>D});var e=n(4505),t=n(6942),O=n(729),o=n(6839),b=n(6477),a=n(2128),N=n(5306),B=n(8644);function I(h,y){if(1&h&&(o.ynx(0),o._UZ(1,"div",6),o.BQk()),2&h){const A=y.$implicit;o.xp6(1),o.Q6J("item",A)}}function R(h,y){if(1&h&&(o.ynx(0),o.YNc(1,I,2,1,"ng-container",5),o.ALo(2,"async"),o.BQk()),2&h){const A=o.oxw();o.xp6(1),o.Q6J("ngForOf",o.lcZ(2,1,A.menu))}}function E(h,y){if(1&h&&(o.ynx(0),o._UZ(1,"div",6),o.BQk()),2&h){const A=y.$implicit;o.xp6(1),o.Q6J("item",A)}}function Z(h,y){if(1&h&&(o.TgZ(0,"mat-tab",7),o.YNc(1,E,2,1,"ng-container",5),o.ALo(2,"async"),o.qZA()),2&h){const A=y.$implicit,x=o.oxw();o.Q6J("label",A),o.uIk("label",A),o.xp6(1),o.Q6J("ngForOf",o.lcZ(2,3,x.tab_menu)[A])}}function M(h,y){1&h&&(o.TgZ(0,"div",8)(1,"app-icon"),o._uU(2,"close"),o.qZA(),o.TgZ(3,"p"),o._uU(4,"No items in menu"),o.qZA()())}let D=(()=>{class h{get categories(){return this._catering.categories}constructor(A){this._catering=A,this.menu=this._catering.menu,this.shown_tab=new e.X(""),this.tab_menu=this.menu.pipe((0,t.U)(x=>{const C={};for(const l of this.categories)C[l]=x.filter(s=>s.category===l);return C}))}}return h.\u0275fac=function(A){return new(A||h)(o.Y36(O.j))},h.\u0275cmp=o.Xpm({type:h,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(A,x){if(1&A&&(o.TgZ(0,"mat-tab-group",0),o.NdJ("selectedIndexChange",function(l){return x.shown_tab.next(0===l?"":x.categories[l-1])}),o.TgZ(1,"mat-tab",1),o.YNc(2,R,3,3,"ng-container",2),o.ALo(3,"async"),o.qZA(),o.YNc(4,Z,3,5,"mat-tab",3),o.qZA(),o.YNc(5,M,5,0,"ng-template",null,4,o.W1O)),2&A){const C=o.MAs(6);let l;o.xp6(2),o.Q6J("ngIf",null==(l=o.lcZ(3,3,x.menu))?null:l.length)("ngIfElse",C),o.xp6(2),o.Q6J("ngForOf",x.categories)}},dependencies:[b.sg,b.O5,a.uX,a.SP,N.o,B.V,b.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--64.css.map*/"]}),h})()},7413:(S,w,n)=>{n.d(w,{M:()=>v});var e=n(6839),t=n(9542),O=n(7486),o=n(3245),b=n(2962),a=n(6477),N=n(2556),B=n(7728),I=n(7672),R=n(5306),E=n(8750),Z=n(380),M=n(5312);function D(m,U){1&m&&(e.TgZ(0,"button",6)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function h(m,U){if(1&m&&(e.TgZ(0,"div",9)(1,"label",10),e._uU(2," Name"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",11),e._UZ(7,"input",12),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()()),2&m){const P=e.oxw(2);e.xp6(1),e.ekj("error",P.form.controls.name.invalid&&P.form.controls.name.touched)}}function y(m,U){if(1&m&&(e.TgZ(0,"div",9)(1,"label",13),e._uU(2," Type"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",11),e._UZ(7,"input",14),e.TgZ(8,"mat-error"),e._uU(9,"Type is required"),e.qZA()()()),2&m){const P=e.oxw(2),W=e.MAs(9);e.xp6(1),e.ekj("error",P.form.controls.group.invalid&&P.form.controls.group.touched),e.xp6(6),e.Q6J("matAutocomplete",W)}}function A(m,U){1&m&&(e.TgZ(0,"div",9)(1,"label",10),e._uU(2,"Unit Price:"),e.qZA(),e.TgZ(3,"mat-form-field",11),e._UZ(4,"input",15),e.qZA()())}function x(m,U){1&m&&(e.TgZ(0,"div",9)(1,"mat-checkbox",16),e._uU(2," Can select multiple of type "),e.qZA()())}function C(m,U){if(1&m&&(e.TgZ(0,"form",7),e.YNc(1,h,10,2,"div",8),e.YNc(2,y,10,3,"div",8),e.YNc(3,A,5,0,"div",8),e.YNc(4,x,3,0,"div",8),e.qZA()),2&m){const P=e.oxw();e.Q6J("formGroup",P.form),e.xp6(1),e.Q6J("ngIf",P.form.controls.name),e.xp6(1),e.Q6J("ngIf",P.form.controls.group),e.xp6(1),e.Q6J("ngIf",P.form.controls.unit_price),e.xp6(1),e.Q6J("ngIf",P.form.controls.multiple)}}function l(m,U){if(1&m){const P=e.EpF();e.TgZ(0,"footer",17)(1,"button",18),e.NdJ("click",function(){e.CHM(P);const j=e.oxw();return e.KtG(j.saveChanges())}),e._uU(2," Save "),e.qZA()()}if(2&m){const P=e.oxw();e.xp6(1),e.Q6J("disabled",!P.form.dirty)}}function s(m,U){1&m&&(e.TgZ(0,"div",19),e._UZ(1,"mat-spinner",20),e.TgZ(2,"p"),e._uU(3,"Saving catering item option..."),e.qZA()())}function c(m,U){if(1&m&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&m){const P=U.$implicit;e.Q6J("value",P),e.xp6(1),e.hij(" ",P," ")}}let v=(()=>{class m{get option(){return this._data.option}get types(){return this._data.types||[]}constructor(P){this._data=P,this.event=new e.vpe,this.form=new t.cw({name:new t.NI(this.option.name||"",[t.kI.required]),group:new t.NI(this.option.group||"",[t.kI.required]),unit_price:new t.NI(this.option.unit_price),multiple:new t.NI(!!this.option.multiple,[])}),this.loading=!1}saveChanges(){this.loading=!0;const P={...this.option,id:this.option.id||`option-${(0,o.Iy)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new b.U({...this._data.parent,options:this._data.parent.options.filter(W=>W.id!==P.id).concat([P])})}})}}return m.\u0275fac=function(P){return new(P||m)(e.Y36(O.WI))},m.\u0275cmp=e.Xpm({type:m,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["icon","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-base-200",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["icon","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-base-200"],["btn","","matRipple","",3,"disabled","click"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(P,W){if(1&P&&(e.TgZ(0,"header")(1,"h3"),e._uU(2),e.qZA(),e.YNc(3,D,3,0,"button",0),e.qZA(),e.YNc(4,C,5,5,"form",1),e.YNc(5,l,3,1,"footer",2),e.YNc(6,s,4,0,"ng-template",null,3,e.W1O),e.TgZ(8,"mat-autocomplete",null,4),e.YNc(10,c,2,2,"mat-option",5),e.qZA()),2&P){const j=e.MAs(7);e.xp6(2),e.hij("",W.option.id?"Edit":"Add"," Item Option"),e.xp6(1),e.Q6J("ngIf",!W.loading),e.xp6(1),e.Q6J("ngIf",W.form&&!W.loading)("ngIfElse",j),e.xp6(1),e.Q6J("ngIf",!W.loading),e.xp6(5),e.Q6J("ngForOf",W.types)}},dependencies:[a.sg,a.O5,N.XC,B.ey,N.ZL,O.ZT,I.oG,t._Y,t.Fj,t.wV,t.JJ,t.JL,t.sg,t.u,R.o,E.KE,E.TO,B.wG,Z.Nt,M.Ou]}),m})()},4204:(S,w,n)=>{n.d(w,{m:()=>R});var e=n(6839),t=n(6477),O=n(5306),o=n(7728);const b=["catering-order-item",""];function a(E,Z){if(1&E&&(e.TgZ(0,"div",12),e._uU(1),e.qZA()),2&E){const M=e.oxw().$implicit;e.xp6(1),e.hij(" ",M.name," ")}}function N(E,Z){if(1&E&&(e.ynx(0),e.YNc(1,a,2,1,"div",11),e.BQk()),2&E){const M=Z.$implicit;e.xp6(1),e.Q6J("ngIf",M)}}function B(E,Z){if(1&E){const M=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e._UZ(2,"div",2),e.qZA(),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){e.CHM(M);const h=e.oxw();return e.KtG(h.toggle())}),e.TgZ(5,"app-icon"),e._uU(6),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6),e._uU(9),e.qZA(),e.TgZ(10,"div",7)(11,"div",8),e._uU(12),e.qZA()(),e.TgZ(13,"div",9),e.YNc(14,N,2,1,"ng-container",10),e.qZA()(),e.BQk()}if(2&E){const M=e.oxw();e.xp6(4),e.ekj("bg-success",M.active)("text-white",M.active)("border-solid",M.active),e.xp6(2),e.Oqu(M.active?"done":"local_pizza"),e.xp6(3),e.Oqu(null==M.item?null:M.item.name),e.xp6(3),e.hij(" \u2a2f",(null==M.item?null:M.item.amount)||(null==M.item?null:M.item.quantity)||1," "),e.xp6(2),e.Q6J("ngForOf",M.item.option_list)}}const I=new Set;let R=(()=>{class E{constructor(){this.active=!1}get item_key(){return`${this.order_id}|${this.item?.id}`}ngOnInit(){this.active=I.has(this.item_key)}toggle(){I.has(this.item_key)?(I.delete(this.item_key),this.active=!1):(I.add(this.item_key),this.active=!0)}}return E.\u0275fac=function(M){return new(M||E)},E.\u0275cmp=e.Xpm({type:E,selectors:[["","catering-order-item",""]],inputs:{order_id:"order_id",item:"item"},attrs:b,decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-20","text-right","h-14","relative"],[1,"border-b-2","border-l-2","border-base-200","w-4","h-16","absolute","top-1/2","left-1/2","-translate-y-full"],[1,"w-12","mr-4"],["action","","icon","","matRipple","",1,"border","border-base-200","border-dashed","text-xl","text-dark-fade","p-2",3,"click"],[1,"flex","flex-1","border-b","border-base-200","border-solid","py-4","space-x-2"],[1,""],[1,"flex-1"],[1,"p-1","rounded-full","bg-neutral","w-8","h-8","flex","items-center","justify-center"],[1,"flex","space-x-2","mr-2"],[4,"ngFor","ngForOf"],["class","text-xs py-1 px-2 bg-warning text-black rounded-2xl shadow",4,"ngIf"],[1,"text-xs","py-1","px-2","bg-warning","text-black","rounded-2xl","shadow"]],template:function(M,D){1&M&&e.YNc(0,B,15,10,"ng-container",0),2&M&&e.Q6J("ngIf",D.item)},dependencies:[t.sg,t.O5,O.o,o.wG],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--65.css.map*/"]}),E})()},2189:(S,w,n)=>{n.d(w,{I:()=>B});var e=n(2851),t=n(6839),O=n(6477),o=n(961);function b(I,R){if(1&I&&(t.TgZ(0,"li",12),t._UZ(1,"catering-order",13),t.qZA()),2&I){const E=R.$implicit;t.xp6(1),t.Q6J("order",E)}}function a(I,R){1&I&&(t.TgZ(0,"div",14)(1,"p",15),t._uU(2,"No Catering Orders"),t.qZA()())}function N(I,R){1&I&&t._UZ(0,"mat-progress-bar",16)}let B=(()=>{class I{constructor(E){this._orders=E,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(E,Z){return Z?Z.id:void 0}}return I.\u0275fac=function(E){return new(E||I)(t.Y36(e.I))},I.\u0275cmp=t.Xpm({type:I,selectors:[["catering-order-list"]],decls:24,vars:10,consts:[[1,"sticky","top-0","w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-base-200","bg-base-100"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-base-200",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block opacity-60",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-base-200"],[3,"order"],["empty","",1,"info-block","opacity-60"],[1,"p-4","text-center"],["mode","indeterminate",1,"w-full"]],template:function(E,Z){if(1&E&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Time"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Location"),t.qZA(),t.TgZ(6,"div",4),t._uU(7,"Host"),t.qZA(),t.TgZ(8,"div",5),t._uU(9,"Charge Code"),t.qZA(),t.TgZ(10,"div",2),t._uU(11,"Notes"),t.qZA(),t.TgZ(12,"div",5),t._uU(13,"Invoice No."),t.qZA(),t.TgZ(14,"div",6),t._uU(15,"Status"),t.qZA(),t._UZ(16,"div",7),t.qZA(),t.TgZ(17,"ul",8),t.YNc(18,b,2,1,"li",9),t.ALo(19,"async"),t.YNc(20,a,3,0,"div",10),t.ALo(21,"async"),t.qZA(),t.YNc(22,N,1,0,"mat-progress-bar",11),t.ALo(23,"async")),2&E){let M;t.xp6(18),t.Q6J("ngForOf",t.lcZ(19,4,Z.order_list))("ngForTrackBy",Z.trackByFn),t.xp6(2),t.Q6J("ngIf",!(null!=(M=t.lcZ(21,6,Z.order_list))&&M.length)),t.xp6(2),t.Q6J("ngIf",t.lcZ(23,8,Z.loading))}},dependencies:[O.sg,O.O5,o.p,O.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--66.css.map*/"]}),I})()},9504:(S,w,n)=>{n.d(w,{W:()=>f});var e=n(1670),t=n(6839),O=n(7486),o=n(9743),b=n(2962),a=n(5163),N=n(5912),B=n(5572),I=n(6477),R=n(2128),E=n(2423),Z=n(9542),M=n(5306),D=n(7728),h=n(5312),y=n(2793);function A(r,d){1&r&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function x(r,d){if(1&r){const _=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(K){t.CHM(_);const J=t.oxw().$implicit,F=t.oxw(5);return t.KtG(F.updateItemQuantity(J,K))}),t.qZA()}if(2&r){const _=t.oxw().$implicit;t.Q6J("ngModel",_.quantity)}}function C(r,d){if(1&r){const _=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),t._uU(4,"remove"),t.qZA()()(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(_);const K=t.oxw().$implicit,J=t.oxw(5);return t.KtG(J.addItem(K))}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA()()()}if(2&r){const _=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",_.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",_.quantity," ")}}function l(r,d){if(1&r&&(t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,A,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,x,1,1,"a-counter",15),t.YNc(9,C,10,3,"div",16),t.qZA()),2&r){const _=d.$implicit,p=t.oxw(5);t.xp6(3),t.hij(" ",_.name," "),t.xp6(1),t.Q6J("ngIf",_.options.length),t.xp6(2),t.hij(" ",t.xi3(7,5,_.unit_price/100,p.code)," "),t.xp6(2),t.Q6J("ngIf",!_.options.length),t.xp6(1),t.Q6J("ngIf",_.options.length)}}const s=function(){return{}};function c(r,d){if(1&r&&(t.TgZ(0,"mat-tab",8)(1,"div",9),t.YNc(2,l,10,8,"div",10),t.qZA()()),2&r){const _=t.oxw().$implicit,p=t.oxw(3);t.Q6J("label",_),t.xp6(2),t.Q6J("ngForOf",(p.menu_items||t.DdM(2,s))[_])}}function v(r,d){if(1&r&&(t.ynx(0),t.YNc(1,c,3,3,"mat-tab",7),t.BQk()),2&r){const _=d.$implicit,p=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(p.menu_items||t.DdM(1,s))[_].length)}}function m(r,d){if(1&r&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,v,2,2,"ng-container",6),t.qZA(),t.BQk()),2&r){const _=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",_.categories)}}function U(r,d){if(1&r&&(t.TgZ(0,"div",4),t.YNc(1,m,3,1,"ng-container",5),t.qZA()),2&r){const _=t.oxw(),p=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!_.show_order_details)("ngIfElse",p)}}function P(r,d){if(1&r){const _=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){t.CHM(_);const K=t.oxw(2);return t.KtG(K.show_order_details=!0)}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&r){const _=t.oxw(2);t.xp6(3),t.Q6J("disabled",!_.order.item_count)("matBadge",_.order.item_count)("matBadgeHidden",!_.order.item_count)}}function W(r,d){if(1&r){const _=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(_);const K=t.oxw(2);return t.KtG(K.show_order_details=!1)}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){t.CHM(_);const K=t.oxw(2);return t.KtG(K.saveOrder())}),t._uU(3," Save Order "),t.qZA()}}function j(r,d){if(1&r&&(t.TgZ(0,"footer",24),t.YNc(1,P,5,3,"ng-container",5),t.YNc(2,W,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&r){const _=t.MAs(3),p=t.oxw();t.xp6(1),t.Q6J("ngIf",!p.show_order_details)("ngIfElse",_)}}function u(r,d){if(1&r&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&r){const _=t.oxw();t.xp6(3),t.Oqu(_.loading)}}function g(r,d){if(1&r&&(t.TgZ(0,"div",35),t._uU(1),t.qZA()),2&r){const _=t.oxw().$implicit,p=t.oxw(2);t.Q6J("matTooltip",p.optionsFor(_)),t.xp6(1),t.AsE(" ",_.options.length," option",1===_.options.length?"":"s"," selected ")}}function T(r,d){if(1&r){const _=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,g,2,3,"div",33),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",34),t.NdJ("ngModelChange",function(K){const F=t.CHM(_).$implicit,$=t.oxw(2);return t.KtG($.updateItemQuantity(F,K))}),t.qZA()()}if(2&r){const _=d.$implicit,p=t.oxw(2);t.xp6(3),t.Oqu(_.name),t.xp6(1),t.Q6J("ngIf",_.options.length),t.xp6(2),t.hij(" ",t.xi3(7,4,_.total_cost/100,p.code)," "),t.xp6(2),t.Q6J("ngModel",_.quantity)}}function i(r,d){if(1&r&&(t.TgZ(0,"header",32)(1,"h3"),t._uU(2,"Confirm Order"),t.qZA()(),t.TgZ(3,"div",9),t.YNc(4,T,9,7,"div",10),t.qZA()),2&r){const _=t.oxw();t.xp6(4),t.Q6J("ngForOf",_.order.items)}}let f=(()=>{class r extends o.cx{get code(){return this._org.currency_code}constructor(_,p){super(),this._org=_,this._data=p,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var _=this;return(0,e.Z)(function*(){_.loading="Loading menu...",_.order=new a.G(_._data.order),_.rules=yield _._data.getCateringConfig(_.order.event?.space?.level?.parent_id),_._data.menu.subscribe(p=>{_.loading="Loading menu...";const K=(0,o.Tw)(p.map(F=>F.category)),J={};for(const F of K)J[F]=p.filter($=>$.category===F&&(0,B.R)($,_.rules,_.order.event));_.categories=K,_.menu_items=J,_.updateMenuQuantities(),_.timeout("clear_loading",()=>_.loading="",1e3)})})()}addItem(_,p=!0){const K=this.order.items.find(J=>J.id===_.id&&J.options.length===J.options.reduce((F,$)=>F+(_.options.find(q=>$.id===q.id)?1:0),0));p&&_.options?.length?this._data.selectOptions(_.options).then(J=>{const F=new b.U({..._,options:J});this.addItem(F,!1)}):this.order=new a.G(K?{...this.order,items:this.order.items.filter(J=>!(J.id===_.id&&J.options_string===_.options_string)).concat([new b.U({..._,quantity:K.quantity+1})])}:{...this.order,items:this.order.items.concat([new b.U({..._,quantity:1})])}),this.updateMenuQuantities()}removeItem(_){this.order=new a.G({...this.order,items:this.order.items.filter(p=>p.id!==_.id&&p.options_string===_.options_string)}),this.updateMenuQuantities()}updateItemQuantity(_,p){const K=this.order.items.find(F=>F.id===_.id&&F.options_string===_.options_string);let J=[...this.order.items];J=K?this.order.items.filter(F=>!(F.id===_.id&&F.options_string===_.options_string)).concat([new b.U({..._,quantity:p})]):this.order.items.concat([new b.U({..._,quantity:p})]),J.sort((F,$)=>F.name.localeCompare($.name)),this.order=new a.G({...this.order,items:J}),this.updateMenuQuantities()}updateMenuQuantities(){for(const _ in this.menu_items)for(const p of this.menu_items[_])p.quantity=this.order.items.reduce((K,J)=>J.id===p.id?K+J.quantity:K,0)}optionsFor(_){return _.options.map(p=>p.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return r.\u0275fac=function(_){return new(_||r)(t.Y36(N.w7),t.Y36(O.WI))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-base-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-base-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-base-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["icon","","matRipple","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["icon","","matRipple","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-base-200"],["order_actions",""],["btn","","matRipple","","mat-dialog-close","",1,"inverse"],["confirm","","btn","","matRipple","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["matRipple","",1,"inverse",3,"click"],["save","","btn","","matRipple","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(_,p){if(1&_&&(t.YNc(0,U,2,2,"div",0),t.YNc(1,j,4,2,"footer",1),t.YNc(2,u,4,1,"ng-template",null,2,t.W1O),t.YNc(4,i,5,1,"ng-template",null,3,t.W1O)),2&_){const K=t.MAs(3);t.Q6J("ngIf",!p.loading)("ngIfElse",K),t.xp6(1),t.Q6J("ngIf",!p.loading)}},dependencies:[I.sg,I.O5,R.uX,R.SP,O.ZT,E.gM,Z.Fj,Z.JJ,Z.On,M.o,D.wG,h.Ou,y.R,I.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--s);border-bottom:2px solid var(--s);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--61.css.map*/"]}),r})()},3129:(S,w,n)=>{n.d(w,{R:()=>A});var e=n(6839),t=n(7486),O=n(3245),o=n(6477),b=n(7672),a=n(8046),N=n(9542),B=n(5306),I=n(7728);function R(x,C){if(1&x&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&x){const l=e.oxw().$implicit,s=e.oxw(3);e.xp6(1),e.hij(" +",e.xi3(2,1,l.unit_price/100,s.code)," ")}}function E(x,C){if(1&x&&(e.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,R,3,4,"div",17),e.qZA()()),2&x){const l=C.$implicit;e.Q6J("value",l.id),e.xp6(3),e.hij(" ",l.name," "),e.xp6(1),e.Q6J("ngIf",l.unit_price)}}function Z(x,C){if(1&x){const l=e.EpF();e.ynx(0),e.TgZ(1,"mat-radio-group",10),e.NdJ("ngModelChange",function(c){e.CHM(l);const v=e.oxw().$implicit,m=e.oxw();return e.KtG(m.updateGroupOption(v,c))}),e.TgZ(2,"mat-radio-button",11)(3,"span",12),e._uU(4,"None"),e.qZA()(),e.YNc(5,E,5,3,"mat-radio-button",13),e.qZA(),e.BQk()}if(2&x){const l=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",null==l?null:l.options)}}function M(x,C){if(1&x&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&x){const l=e.oxw().$implicit,s=e.oxw(3);e.xp6(1),e.hij(" +",e.xi3(2,1,l.unit_price/100,s.code)," ")}}function D(x,C){if(1&x){const l=e.EpF();e.TgZ(0,"mat-checkbox",20),e.NdJ("ngModelChange",function(c){const m=e.CHM(l).$implicit,U=e.oxw(3);return e.KtG(U.option_state[m.id]=c)}),e.TgZ(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,M,3,4,"div",17),e.qZA()()}if(2&x){const l=C.$implicit,s=e.oxw(3);e.Q6J("ngModel",s.option_state[l.id]),e.xp6(3),e.hij(" ",l.name," "),e.xp6(1),e.Q6J("ngIf",l.unit_price)}}function h(x,C){if(1&x&&e.YNc(0,D,5,3,"mat-checkbox",19),2&x){const l=e.oxw().$implicit;e.Q6J("ngForOf",null==l?null:l.options)}}function y(x,C){if(1&x&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.qZA(),e.TgZ(3,"div",7),e.YNc(4,Z,6,1,"ng-container",8),e.YNc(5,h,1,1,"ng-template",null,9,e.W1O),e.qZA()()),2&x){const l=C.$implicit,s=e.MAs(6);e.uIk("group",l.name),e.xp6(2),e.Oqu(l.name),e.xp6(2),e.Q6J("ngIf",!l.multiple)("ngIfElse",s)}}let A=(()=>{class x{constructor(l){this._data=l,this.event=new e.vpe,this.option_state={},this.code=this._data.code;const s=(0,O.Tw)(this._data.options.map(v=>v.group||"Other")),c=[];for(const v of s){const m=this._data.options.filter(U=>U.group===v);c.push({name:v,multiple:!!m.find(U=>U.multiple),options:m})}this.groups=c}updateGroupOption(l,s){for(const c of l.options)this.option_state[c.id]=c.id===s}saveOptions(){const l=this._data.options.filter(s=>this.option_state[s.id]);this.event.emit({reason:"done",metadata:{options:l}})}}return x.\u0275fac=function(l){return new(l||x)(e.Y36(t.WI))},x.\u0275cmp=e.Xpm({type:x,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["icon","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-base-200",4,"ngFor","ngForOf"],[1,"p-2"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-base-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(l,s){1&l&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Select options"),e.qZA(),e.TgZ(3,"button",0)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.TgZ(6,"main",1),e.YNc(7,y,7,4,"div",2),e.qZA(),e.TgZ(8,"footer",3)(9,"button",4),e.NdJ("click",function(){return s.saveOptions()}),e._uU(10," Save "),e.qZA()()),2&l&&(e.xp6(7),e.Q6J("ngForOf",s.groups))},dependencies:[o.sg,o.O5,t.ZT,b.oG,a.VQ,a.U0,N.JJ,N.On,B.o,I.wG,o.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--62.css.map*/"]}),x})()},961:(S,w,n)=>{n.d(w,{p:()=>x});var e=n(1670),t=n(9743),O=n(2851),b=(n(5163),n(2460)),a=n(6839),N=n(6477),B=n(9314),I=n(2423),R=n(5306),E=n(7728),Z=n(4204);function M(C,l){if(1&C&&(a.TgZ(0,"button",19),a._uU(1," View "),a.qZA()),2&C){const s=a.oxw(2);a.Q6J("matTooltip",s.order.notes)}}function D(C,l){if(1&C){const s=a.EpF();a.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),a._uU(4,"room_service"),a.qZA()()(),a.TgZ(5,"div",7),a._uU(6),a.ALo(7,"date"),a.qZA(),a.TgZ(8,"div",8),a._uU(9),a.qZA(),a.TgZ(10,"div",9),a._uU(11),a.qZA(),a.TgZ(12,"div",10),a._uU(13),a.qZA(),a.TgZ(14,"div",11),a.YNc(15,M,2,1,"button",12),a.qZA(),a.TgZ(16,"div",10),a._uU(17),a.qZA(),a.TgZ(18,"div",13)(19,"button",14)(20,"div",15),a._uU(21),a.qZA(),a.TgZ(22,"app-icon",16),a._uU(23,"arrow_drop_down"),a.qZA()()(),a.TgZ(24,"div",17)(25,"button",18),a.NdJ("click",function(){a.CHM(s);const v=a.oxw();return a.KtG(v.show_items=!v.show_items)}),a.TgZ(26,"app-icon"),a._uU(27),a.qZA()()()()}if(2&C){const s=a.oxw(),c=a.MAs(3);a.ekj("bg-base-200",!s.show_items)("bg-base-200",s.show_items),a.xp6(1),a.ekj("bg-base-200",s.show_items)("dark:bg-neutral-700",s.show_items),a.xp6(5),a.hij(" ",a.xi3(7,19,s.order.deliver_at,s.time_format)," "),a.xp6(3),a.hij(" ",(null==s.order.event?null:s.order.event.space.display_name)||(null==s.order.event?null:s.order.event.space.name)||"~ No Location ~"," "),a.xp6(2),a.hij(" ",(null==s.order.event||null==s.order.event.organiser?null:s.order.event.organiser.name)||(null==s.order.event?null:s.order.event.host)||"~ Unknown Host ~"," "),a.xp6(2),a.Oqu(s.order.charge_code||"~ No Code ~"),a.xp6(2),a.Q6J("ngIf",s.order.notes),a.xp6(2),a.hij(" ",s.order.invoice_number||"~ No Invoice ~"," "),a.xp6(2),a.Udp("background",null==s.status?null:s.status.colour),a.Q6J("matMenuTriggerFor",c),a.xp6(2),a.hij(" ",null==s.status?null:s.status.name," "),a.xp6(6),a.Oqu(s.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function h(C,l){if(1&C&&a._UZ(0,"li",22),2&C){const s=l.$implicit,c=a.oxw(2);a.Q6J("order_id",null==c.order?null:c.order.id)("item",s)}}function y(C,l){if(1&C&&(a.TgZ(0,"ul",20),a.YNc(1,h,1,2,"li",21),a.qZA()),2&C){const s=a.oxw();a.ekj("shown",s.show_items),a.Q6J("@show",s.show_items?"show":"hide"),a.xp6(1),a.Q6J("ngForOf",s.order.items)}}function A(C,l){if(1&C){const s=a.EpF();a.TgZ(0,"button",23),a.NdJ("click",function(){const m=a.CHM(s).$implicit,U=a.oxw();return a.KtG(U.updateStatus(m.id))}),a._UZ(1,"div",24),a.TgZ(2,"span",25),a._uU(3),a.qZA()()}if(2&C){const s=l.$implicit;a.xp6(1),a.Udp("background-color",s.colour),a.xp6(2),a.Oqu(s.name)}}let x=(()=>{class C extends t.cx{get status(){return this.statuses.find(s=>s.id===this.order.status)}get time_format(){return this._settings.time_format}constructor(s,c){var v;super(),v=this,this._orders=s,this._settings=c,this.show_items=!1,this.statuses=b.U,this.updateStatus=function(){var m=(0,e.Z)(function*(U){yield v._orders.updateStatus(v.order,U),v.timeout("status-change",()=>v.order.status=U)});return function(U){return m.apply(this,arguments)}}()}}return C.\u0275fac=function(s){return new(s||C)(a.Y36(O.I),a.Y36(t.gb))},C.\u0275cmp=a.Xpm({type:C,selectors:[["catering-order"]],inputs:{order:"order"},features:[a.qOj],decls:5,vars:3,consts:[["class","w-full flex items-center py-2",3,"bg-base-200",4,"ngIf"],["class","list-none p-0 m-0 w-full relative z-0",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2"],[1,"w-20","flex","items-center","justify-center","z-20","h-full"],[1,"rounded-full","bg-base-300","p-2","text-2xl","text-black","opacity-60","flex","items-center","justify-center"],["time","",1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-24"],["class","clear underline",3,"matTooltip",4,"ngIf"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["icon","",3,"click"],[1,"clear","underline",3,"matTooltip"],[1,"list-none","p-0","m-0","w-full","relative","z-0"],["catering-order-item","","class","flex items-center",3,"order_id","item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"order_id","item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(s,c){1&s&&(a.YNc(0,D,28,22,"div",0),a.YNc(1,y,2,4,"ul",1),a.TgZ(2,"mat-menu",null,2),a.YNc(4,A,4,3,"button",3),a.qZA()),2&s&&(a.Q6J("ngIf",c.order),a.xp6(1),a.Q6J("ngIf",null==c.order?null:c.order.items.length),a.xp6(3),a.Q6J("ngForOf",c.statuses))},dependencies:[N.sg,N.O5,B.VK,B.OP,B.p6,I.gM,R.o,E.wG,Z.m,N.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}\n/*# sourceMappingURL=catering-order.component.ts-angular-inline--67.css.map*/"],data:{animation:[t.X7]}}),C})()},2851:(S,w,n)=>{n.d(w,{I:()=>x});var e=n(1670),t=n(4505),O=n(7716),o=n(823),b=n(9095),a=n(6942),N=n(8759),B=n(9128),I=n(1810),R=n(9377),E=n(3200),Z=n(9743),M=n(4211),D=n(3902),h=n(5163),y=n(6839);let x=(()=>{class C extends Z.cx{get filters(){return this._filters.getValue()}set filters(s){this._filters.next(s)}constructor(){super(),this._poll=new t.X(0),this._loading=new t.X(!1),this._filters=new t.X({}),this.orders=(0,O.aj)([this._filters,this._poll]).pipe((0,o.b)(500),(0,b.w)(([{date:s,zones:c}])=>{this._loading.next(!0);const v=(0,I.Z)((0,R.Z)(s||Date.now())),m=(0,I.Z)((0,E.Z)(s||Date.now()));return(0,M.u$)({zone_ids:(c||[]).join(","),period_start:v,period_end:m})}),(0,a.U)(s=>(0,Z.xH)(s.map(c=>c.ext("catering")))),(0,N.b)(()=>this._loading.next(!1)),(0,B.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,a.U)(s=>s.filter(c=>function A(C,l){const s=(l.search||"").toLowerCase();return!!C.items.find(c=>c.name.toLowerCase().includes(s)||!!c.options.find(v=>v.name.toLowerCase().includes(s)))}(c,this._filters.getValue())).sort((c,v)=>c.deliver_at-v.deliver_at))),this.subscription("changes",this.orders.subscribe())}startPolling(s=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),s)}stopPolling(){this.clearInterval("polling")}updateStatus(s,c){var v=this;return(0,e.Z)(function*(){const m=new h.G({...s,status:c,event:null}),U=[...s.event.ext("catering").filter(j=>j.id!==s.id),m].map(j=>new h.G({...j})),P=new D.y({...s.event,catering:U}),W=yield(0,M.ry)(P.toJSON()).toPromise();return v._poll.next(Date.now()),s.status=c,W})()}}return C.\u0275fac=function(s){return new(s||C)},C.\u0275prov=y.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},729:(S,w,n)=>{n.d(w,{j:()=>P});var e=n(1670),t=n(2182),O=n(4505),o=n(7716),b=n(4139),a=n(9151),N=n(9095),B=n(7418),I=n(6942),R=n(8759),E=n(9128),Z=n(5670),M=n(3910),D=n(9743),h=n(5912),y=n(6336),A=n(7413),x=n(2921),C=n(2962),l=n(5163),s=n(9504),c=n(3129),v=n(5730),m=n(6839),U=n(7486);let P=(()=>{class W extends D.cx{get is_editable(){return!this.zone||this.zone===this._org.building?.id}get categories(){const u=this._menu.getValue();return(0,D.Tw)(u.map(g=>g.category))}constructor(u,g,T){var i;super(),i=this,this._org=u,this._dialog=g,this._settings=T,this._updated=new O.X(0),this._menu=new O.X([]),this._loading=new O.X(!1),this._currency=new O.X("USD"),this._change=new O.X(0),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.settings=(0,o.aj)([this._org.active_building,this._change]).pipe((0,a.h)(([f])=>!!f),(0,N.w)(([f])=>(0,t.rlq)(f.id,"catering-settings").pipe((0,B.K)(r=>(0,b.of)({})))),(0,I.U)(f=>f.details||{}),(0,R.b)(f=>this._settings.post("require_catering_notes",!!f?.require_notes)),(0,E.d)(1)),this.charge_codes=this.settings.pipe((0,I.U)(f=>f.charge_codes||[])),this.availability=this.settings.pipe((0,I.U)(f=>f.disabled_rooms||[])),this.zone="",this.subscription("building",this._org.active_building.subscribe(function(){var f=(0,e.Z)(function*(r){if(r){const d=(yield i.getCateringForZone(r.id)).map(_=>new C.U(_));i._currency.next(i._settings.get("app.currency")||r.currency||"USD"),i._menu.next(d)}});return function(r){return f.apply(this,arguments)}}()))}manageCateringOrder(u){var g=this;return(0,e.Z)(function*(){const T=g._dialog.open(s.W,{data:{code:g._currency.getValue(),order:u,menu:g.menu,loading:g.loading,getCateringConfig:f=>g.getCateringConfig(f),selectOptions:f=>g.selectOptions(f)}}),i=yield Promise.race([T.componentInstance.event.pipe((0,Z.P)(f=>"done"===f.reason)).toPromise(),T.afterClosed().toPromise()]);return T.close(),i?.metadata?.order||u})()}addItem(u=new C.U){var g=this;return(0,e.Z)(function*(){const T=g._dialog.open(y.w,{data:{item:u,categories:g.categories}}),i=yield Promise.race([T.componentInstance.event.pipe((0,Z.P)(d=>"done"===d.reason)).toPromise(),T.afterClosed().toPromise()]);if("done"!==i?.reason)return;const f=g._menu.getValue(),r=f.findIndex(d=>d.id===u.id);r>=0?f.splice(r,1,i.metadata.item):f.push(i.metadata.item),g.updateMenu(g._org.building.id,f).then(()=>{g._menu.next([...f]),T.close()},()=>T.componentInstance.loading=!1)})()}updateItem(u){const g=this._menu.getValue(),T=g.findIndex(i=>i.id===u.id);T>=0?g.splice(T,1,u):g.push(u),this.updateMenu(this._org.building.id,g).then(()=>this._menu.next([...g]))}addOption(u,g={}){var T=this;return(0,e.Z)(function*(){const i=(0,D.Tw)(u.options.map(p=>p.group)),f=T._dialog.open(A.M,{data:{parent:u,option:g,types:i}}),r=yield Promise.race([f.componentInstance.event.pipe((0,Z.P)(p=>"done"===p.reason)).toPromise(),f.afterClosed().toPromise()]);if("done"!==r?.reason)return;const d=T._menu.getValue(),_=d.findIndex(p=>p.id===u.id);_>=0?d.splice(_,1,r.metadata.item):d.push(r.metadata.item),T.updateMenu(T._org.building.id,d).then(()=>{T._menu.next([...d]),f.close()},()=>f.componentInstance.loading=!1)})()}selectOptions(u){var g=this;return(0,e.Z)(function*(){const T=g._dialog.open(c.R,{data:{code:g._currency.getValue(),options:u}}),i=yield Promise.race([T.componentInstance.event.pipe((0,Z.P)(f=>"done"===f.reason)).toPromise(),T.afterClosed().toPromise()]);return"done"!==i?.reason?[]:(T.close(),i.metadata.options)})()}deleteItem(u){var g=this;return(0,e.Z)(function*(){const T=yield(0,D._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${u.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},g._dialog);if("done"!==T.reason)return;T.loading("Removing catering item...");const i=g._menu.getValue().filter(f=>u.id!==f.id);g.updateMenu(g._org.building.id,i).then(()=>{g._menu.next([...i]),T.close()},()=>T.loading(""))})()}deleteOption(u,g){var T=this;return(0,e.Z)(function*(){const i=yield(0,D._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${g.name}" from "${u.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},T._dialog);if("done"!==i.reason)return;i.loading("Removing catering item option...");const f=T._menu.getValue();f.splice(f.findIndex(r=>r.id===u.id),1,new C.U({...u,options:u.options.filter(r=>r.id!==g.id)})),T.updateMenu(T._org.building.id,f).then(()=>{T._menu.next([...f]),i.close()},()=>i.loading(""))})()}editConfig(){var u=this;return(0,e.Z)(function*(){const g=yield u.getCateringConfig(u._org.building.id),{require_notes:T}=yield u.settings.pipe((0,M.q)(1)).toPromise(),i=u._menu.getValue(),f=(0,D.Tw)((0,D.xH)(i.map(_=>[_.category,..._.tags]))),r=u._dialog.open(x.uX,{data:{config:g,types:f,require_notes:T,saveNotes:_=>u.saveSettings({require_notes:_})}}),d=yield Promise.race([r.componentInstance.event.pipe((0,Z.P)(_=>"done"===_.reason)).toPromise(),r.afterClosed().toPromise()]);"done"===d?.reason&&u.updateConfig(u._org.building.id,d.metadata).then(()=>r.close(),()=>r.componentInstance.loading=!1)})()}importMenu(){var u=this;return(0,e.Z)(function*(){const g=u._dialog.open(v.m),T=yield Promise.race([g.componentInstance.event.pipe((0,Z.P)(d=>"done"===d.reason)).toPromise(),g.afterClosed().toPromise()]);if("done"!==T?.reason)return;g.componentInstance.loading="Updating menu...";const i=u._menu.getValue(),f=u._org.building,r=(0,D.Tw)(T.metadata.concat(i),"id");yield u.updateMenu(f.id,r).catch(d=>{throw(0,D.cB)("Error importing catering menu"),g.close(),d}),(0,D.t5)(`Successfully imported catering menu. ${T.metadata.length} item(s) added.`),g.close()})()}updateMenu(u,g){return(0,t.Ymr)(u,{id:u,name:"catering",details:g,description:`Catering menu for ${u}`}).toPromise()}saveSettings(u){var g=this;return(0,e.Z)(function*(){const T=yield g.settings.pipe((0,M.q)(1)).toPromise(),i=yield(0,t.Ymr)(g._org.building.id,{id:g._org.building.id,name:"catering-settings",details:{...T,...u},description:`Catering settings for ${g._org.building.id}`}).toPromise();return g._change.next(Date.now()),i})()}getCateringForZone(u){return(0,e.Z)(function*(){const g=(yield(0,t.rlq)(u,"catering").toPromise()).details;return g instanceof Array?g:[]})()}getCateringConfig(u=this._org.building.id){return(0,e.Z)(function*(){const g=(yield(0,t.rlq)(u,"catering_config").toPromise()).details;return g instanceof Array?g:[]})()}updateConfig(u,g){return(0,t.Ymr)(u,{id:u,name:"catering_config",details:g,description:`Catering menu config for ${u}`}).toPromise()}addItemToOrder(u,g){let T=u.items;const i=T.find(r=>r.id===g.id&&g.options?.length===r.options?.reduce((d,_)=>d+(g.options.find(p=>_.id===p.id)?1:0),0));return i?i.quantity+=1:T=T.concat([new C.U({...g,quantity:1})]),new l.G({...u,items:T,event:null})}}return W.\u0275fac=function(u){return new(u||W)(m.LFG(h.w7),m.LFG(U.uw),m.LFG(D.gb))},W.\u0275prov=m.Yz7({token:W,factory:W.\u0275fac,providedIn:"root"}),W})()},2460:(S,w,n)=>{n.d(w,{U:()=>e});const e=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map