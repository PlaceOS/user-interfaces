"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{1311:(S,J,n)=>{n.d(J,{Ud:()=>tt.U,Ii:()=>et.I,jW:()=>M.j,F7:()=>$,uy:()=>k});var e=n(6575),t=n(8849),O=n(9892),o=n(6658),y=n(7401),i=n(8128),B=n(989),R=n(2106),I=n(702),K=n(1268),Z=n(9304),P=n(7393),F=(n(8147),n(1512),n(6748),n(7341),n(1506),n(2467),n(593),n(8089),n(21),n(766),n(533),n(3099),n(774),n(156),n(3585),n(1670)),c=n(2798),m=n(6939),M=n(5618),a=n(9039),f=n(4888),_=n(257),p=n(9674),s=n(3910);function d(j,X){if(1&j){const L=a.EpF();a.TgZ(0,"div",6)(1,"mat-form-field",7)(2,"input",8),a.NdJ("ngModelChange",function(Y){const V=a.CHM(L).index,z=a.oxw(2);return a.KtG(z.charge_codes[V]=Y)}),a.qZA()(),a.TgZ(3,"button",9),a.NdJ("click",function(){const H=a.CHM(L).index,V=a.oxw(2);return a.KtG(V.removeCode(H))}),a.TgZ(4,"app-icon"),a._uU(5,"delete"),a.qZA()()()}if(2&j){const L=X.index,G=a.oxw(2);a.xp6(2),a.Q6J("ngModel",G.charge_codes[L])}}function W(j,X){if(1&j&&(a.TgZ(0,"main",4),a.YNc(1,d,6,1,"div",5),a.qZA()),2&j){const L=a.oxw();a.xp6(1),a.Q6J("ngForOf",L.charge_codes)("ngForTrackBy",L.trackByFn)}}function w(j,X){if(1&j){const L=a.EpF();a.TgZ(0,"footer",10)(1,"button",11),a._uU(2," Import Codes "),a.TgZ(3,"input",12),a.NdJ("change",function(Y){a.CHM(L);const H=a.oxw();return a.KtG(H.addCodesFromFile(Y))}),a.qZA()(),a.TgZ(4,"button",13),a.NdJ("click",function(){a.CHM(L);const Y=a.oxw();return a.KtG(Y.newCode())}),a._uU(5," Add Code "),a.qZA(),a.TgZ(6,"button",13),a.NdJ("click",function(){a.CHM(L);const Y=a.oxw();return a.KtG(Y.saveChargeCodes())}),a._uU(7," Save Changes "),a.qZA()()}}function Q(j,X){1&j&&(a.TgZ(0,"main",14),a._UZ(1,"mat-spinner",15),a.TgZ(2,"p"),a._uU(3,"Saving changes to charge codes..."),a.qZA()())}let $=(()=>{class j{constructor(L,G){this._state=L,this._dialog_ref=G,this.charge_codes=[],this.loading=!1}ngOnInit(){var L=this;return(0,F.Z)(function*(){L.charge_codes=(yield L._state.charge_codes.pipe((0,m.q)(1)).toPromise())||[]})()}newCode(){this.charge_codes.push("")}removeCode(L){this.charge_codes.splice(L,1)}addCodesFromFile(L){if(L.target){const G=L.target.files[0];if(G){const Y=new FileReader;Y.readAsText(G,"UTF-8"),Y.addEventListener("load",H=>{const V=(0,c.n5)(H.srcElement.result)||[];for(const{code:z}of V)this.charge_codes.push(z);this.charge_codes=(0,c.Tw)(this.charge_codes),L.target.value=""}),Y.addEventListener("error",H=>(0,c.cB)("Error reading file."))}}}saveChargeCodes(){var L=this;return(0,F.Z)(function*(){L.loading=!0;const G=L.charge_codes.filter(Y=>Y&&Y.trim());yield L._state.saveSettings({charge_codes:G}),L._dialog_ref.close()})()}trackByFn(L,G){return L}static#t=this.\u0275fac=function(G){return new(G||j)(a.Y36(M.j),a.Y36(y.so))};static#e=this.\u0275cmp=a.Xpm({type:j,selectors:[["charge-code-list-modal"]],decls:10,vars:3,consts:[["icon","","mat-dialog-close",""],["class","overflow-auto max-h-[65vh] min-h-[20rem] flex flex-col",4,"ngIf","ngIfElse"],["class","flex items-center p-2 space-x-2 border-t border-base-200",4,"ngIf"],["load_state",""],[1,"overflow-auto","max-h-[65vh]","min-h-[20rem]","flex","flex-col"],["class","flex items-center space-x-2 w-full hover:bg-neutral px-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","space-x-2","w-full","hover:bg-neutral","px-2"],["appearance","outline",1,"h-14","flex-1"],["matInput","","placeholder","Charge Code",3,"ngModel","ngModelChange"],["icon","",3,"click"],[1,"flex","items-center","p-2","space-x-2","border-t","border-base-200"],["btn","","matRipple","",1,"w-48","inverse","relative"],["type","file",1,"opacity-0","absolute","inset-0",3,"change"],["btn","","matRipple","",1,"w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-20","space-y-2"],["diameter","32"]],template:function(G,Y){if(1&G&&(a.TgZ(0,"header")(1,"h2"),a._uU(2,"Edit Charge Codes"),a.qZA(),a.TgZ(3,"button",0)(4,"app-icon"),a._uU(5,"close"),a.qZA()()(),a.YNc(6,W,2,2,"main",1)(7,w,8,0,"footer",2)(8,Q,4,0,"ng-template",null,3,a.W1O)),2&G){const H=a.MAs(9);a.xp6(6),a.Q6J("ngIf",!Y.loading)("ngIfElse",H),a.xp6(1),a.Q6J("ngIf",!Y.loading)}},dependencies:[e.sg,e.O5,y.ZT,t.Fj,t.JJ,t.On,f.o,K.KE,_.wG,p.Nt,s.Ou]})}return j})();n(136);let k=(()=>{class j{static#t=this.\u0275fac=function(G){return new(G||j)};static#e=this.\u0275mod=a.oAB({type:j});static#n=this.\u0275inj=a.cJS({imports:[e.ez,i.Tx,B.Nh,O.Bb,y.Is,o.p9,R.Fk,I.AV,t.u5,t.UX,P.K,K.lN,Z.W9]})}return j})();var tt=n(5784),et=(n(5688),n(6030));n(9815)},766:(S,J,n)=>{n.d(J,{m:()=>P});var e=n(9039),t=n(2798),O=n(5784),o=n(6575),y=n(7401),i=n(4888),B=n(257),R=n(3910);function I(h,A){1&h&&(e.TgZ(0,"button",4)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function K(h,A){if(1&h){const T=e.EpF();e.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),e._uU(3,"upload"),e.qZA(),e.TgZ(4,"p"),e._uU(5,"Click to select file or Drag and drop files"),e.qZA(),e.TgZ(6,"input",7),e.NdJ("change",function(U){e.CHM(T);const v=e.oxw();return e.KtG(v.handleFileEvent(U))}),e.qZA()(),e.TgZ(7,"div",8)(8,"button",9),e.NdJ("click",function(){e.CHM(T);const U=e.oxw();return e.KtG(U.downloadTemplate())}),e._uU(9," Download Template "),e.qZA()()()}}function Z(h,A){if(1&h&&(e.TgZ(0,"main",10),e._UZ(1,"mat-spinner",11),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&h){const T=e.oxw();e.xp6(3),e.Oqu(T.loading)}}let P=(()=>{class h{constructor(){this.event=new e.vpe}handleFileEvent(T){this.loading="Processing menu data...";const b=T.target;if(!b?.files)return this.loading="";const U=b.files;if(!U.length)return this.loading="";const v=U[0],D=new FileReader;D.addEventListener("loadend",g=>{const l=(0,t.n5)(g.target.result);this.loading="",this.event.emit({reason:"done",metadata:l.filter(x=>"item"===(x.type||"").toLowerCase()).map(x=>new O.U({...x,options:l.filter(r=>"option"===(r.type||"").toLowerCase()&&r.tags===x.id).map(r=>({id:r.id,name:r.name,group:r.category,multiple:r.multiple,unit_price:r.unit_price}))}))})}),D.readAsText(v)}downloadTemplate(){(0,t.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}static#t=this.\u0275fac=function(b){return new(b||h)};static#e=this.\u0275cmp=e.Xpm({type:h,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["icon","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["icon","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-base-200","border-dashed","rounded-xl","hover:bg-base-200","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["matRipple","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(b,U){if(1&b&&(e.TgZ(0,"header",0)(1,"h2"),e._uU(2,"Import Catering Menu"),e.qZA(),e.YNc(3,I,3,0,"button",1),e.qZA(),e.YNc(4,K,10,0,"main",2)(5,Z,4,1,"ng-template",null,3,e.W1O)),2&b){const v=e.MAs(6);e.xp6(3),e.Q6J("ngIf",!U.loading),e.xp6(1),e.Q6J("ngIf",!U.loading)("ngIfElse",v)}},dependencies:[o.O5,y.ZT,i.o,B.wG,R.Ou]})}return h})()},8147:(S,J,n)=>{n.d(J,{w:()=>M});var e=n(554),t=n(9039),O=n(8849),o=n(7401),y=n(2798),i=n(5784),B=n(6575),R=n(9892),I=n(257),K=n(6658),Z=n(4888),P=n(1268),h=n(9674),A=n(3910),T=n(1757),b=n(622),U=n(4035);function v(a,f){1&a&&(t.TgZ(0,"button",6)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function D(a,f){if(1&a&&(t.TgZ(0,"div",17)(1,"label",18),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",19),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA()()()),2&a){const _=t.oxw(2);t.xp6(1),t.ekj("error",_.form.controls.name.invalid&&_.form.controls.name.touched)}}function g(a,f){if(1&a&&(t.TgZ(0,"div",17)(1,"label",21),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",19),t._UZ(7,"input",22),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA()()()),2&a){const _=t.oxw(2),p=t.MAs(9);t.xp6(1),t.ekj("error",_.form.controls.category.invalid&&_.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",p)}}function E(a,f){if(1&a){const _=t.EpF();t.TgZ(0,"mat-chip-row",29),t.NdJ("removed",function(){const d=t.CHM(_).$implicit,W=t.oxw(3);return t.KtG(W.removeTag(d))}),t._uU(1),t.TgZ(2,"button",30)(3,"app-icon"),t._uU(4,"cancel"),t.qZA()()()}if(2&a){const _=f.$implicit;t.xp6(1),t.hij(" ",_," "),t.xp6(1),t.uIk("aria-label","Remove "+_)}}function l(a,f){if(1&a){const _=t.EpF();t.TgZ(0,"div",17)(1,"label",23),t.SDv(2,24),t.qZA(),t.TgZ(3,"mat-form-field",19)(4,"mat-chip-grid",25,26),t.YNc(6,E,5,2,"mat-chip-row",27),t.qZA(),t.TgZ(7,"input",28),t.NdJ("matChipInputTokenEnd",function(s){t.CHM(_);const d=t.oxw(2);return t.KtG(d.addTag(s))}),t.qZA()()()}if(2&a){const _=t.MAs(5),p=t.oxw(2);t.xp6(1),t.ekj("error",p.form.controls.tags.invalid&&p.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",p.tag_list),t.xp6(1),t.Q6J("matChipInputFor",_)("matChipInputSeparatorKeyCodes",p.separators)("matChipInputAddOnBlur",!0)}}function x(a,f){1&a&&(t.TgZ(0,"div",17)(1,"label",31),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",19),t._UZ(4,"textarea",32),t.qZA()())}function r(a,f){if(1&a&&(t.TgZ(0,"div",17)(1,"label",18),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",19),t._UZ(7,"input",33),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA()()()),2&a){const _=t.oxw(2);t.xp6(1),t.ekj("error",_.form.controls.unit_price.invalid&&_.form.controls.unit_price.touched)}}function C(a,f){1&a&&(t.TgZ(0,"div",17)(1,"label",34),t.SDv(2,35),t.qZA(),t._UZ(3,"image-list-field",36),t.qZA())}const u=()=>({standalone:!0});function N(a,f){if(1&a){const _=t.EpF();t.TgZ(0,"form",7)(1,"div",8),t.YNc(2,D,10,2,"div",9)(3,g,10,3,"div",9),t.qZA(),t.YNc(4,l,8,6,"div",9)(5,x,5,0,"div",9)(6,r,10,2,"div",9),t.TgZ(7,"div",10)(8,"label",11),t._uU(9,"Accept Points?"),t.qZA(),t.TgZ(10,"mat-checkbox",12),t._uU(11),t.qZA()(),t.TgZ(12,"div",13)(13,"mat-checkbox",14),t.NdJ("ngModelChange",function(s){t.CHM(_);const d=t.oxw();return t.KtG(s?d.addTag({value:"Gluten Free"}):d.removeTag("Gluten Free"))}),t._uU(14," Gluten Free (GF) "),t.qZA(),t.TgZ(15,"mat-checkbox",14),t.NdJ("ngModelChange",function(s){t.CHM(_);const d=t.oxw();return t.KtG(s?d.addTag({value:"Vegan"}):d.removeTag("Vegan"))}),t._uU(16," Vegan (VG) "),t.qZA(),t.TgZ(17,"mat-checkbox",14),t.NdJ("ngModelChange",function(s){t.CHM(_);const d=t.oxw();return t.KtG(s?d.addTag({value:"Vegetarian"}):d.removeTag("Vegetarian"))}),t._uU(18," Vegetarian (V) "),t.qZA(),t.TgZ(19,"mat-checkbox",14),t.NdJ("ngModelChange",function(s){t.CHM(_);const d=t.oxw();return t.KtG(s?d.addTag({value:"Contains Dairy"}):d.removeTag("Contains Dairy"))}),t._uU(20," Contains Dairy (D) "),t.qZA(),t.TgZ(21,"mat-checkbox",14),t.NdJ("ngModelChange",function(s){t.CHM(_);const d=t.oxw();return t.KtG(s?d.addTag({value:"Contains Nuts"}):d.removeTag("Contains Nuts"))}),t._uU(22," Contains Nuts (N) "),t.qZA()(),t.TgZ(23,"div",10)(24,"label",15),t._uU(25,"Discount Cap"),t.qZA(),t._UZ(26,"a-counter",16),t.qZA(),t.YNc(27,C,4,0,"div",9),t.qZA()}if(2&a){const _=t.oxw();let p;t.Q6J("formGroup",_.form),t.xp6(2),t.Q6J("ngIf",_.form.controls.name),t.xp6(1),t.Q6J("ngIf",_.form.controls.category),t.xp6(1),t.Q6J("ngIf",_.form.controls.tags),t.xp6(1),t.Q6J("ngIf",_.form.controls.description),t.xp6(1),t.Q6J("ngIf",_.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(p=_.form.get("accept_points"))&&p.value?"No":"Yes"),t.xp6(2),t.Q6J("ngModel",_.hasTag("Gluten Free"))("ngModelOptions",t.DdM(22,u)),t.xp6(2),t.Q6J("ngModel",_.hasTag("Vegan"))("ngModelOptions",t.DdM(23,u)),t.xp6(2),t.Q6J("ngModel",_.hasTag("Vegetarian"))("ngModelOptions",t.DdM(24,u)),t.xp6(2),t.Q6J("ngModel",_.hasTag("Contains Dairy"))("ngModelOptions",t.DdM(25,u)),t.xp6(2),t.Q6J("ngModel",_.hasTag("Contains Nuts"))("ngModelOptions",t.DdM(26,u)),t.xp6(5),t.Q6J("min",0)("max",100)("step",5)("render_fn",_.renderPercent),t.xp6(1),t.Q6J("ngIf",_.form.controls.images)}}function F(a,f){if(1&a){const _=t.EpF();t.TgZ(0,"footer",37)(1,"button",38),t.NdJ("click",function(){t.CHM(_);const s=t.oxw();return t.KtG(s.saveChanges())}),t._uU(2," Save "),t.qZA()()}if(2&a){const _=t.oxw();t.xp6(1),t.Q6J("disabled",!_.form.dirty)}}function c(a,f){1&a&&(t.TgZ(0,"div",39),t._UZ(1,"mat-spinner",40),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA()())}function m(a,f){if(1&a&&(t.TgZ(0,"mat-option",41),t._uU(1),t.qZA()),2&a){const _=f.$implicit;t.Q6J("value",_),t.xp6(1),t.hij(" ",_," ")}}let M=(()=>{class a{get item(){return this._data.item||new i.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(_=0){return`${_}%`}hasTag(_){return this.tag_list.includes(_)}constructor(_){this._data=_,this.event=new t.vpe,this.form=new O.cw({name:new O.NI(this.item.name||"",[O.kI.required]),description:new O.NI(this.item.description||""),category:new O.NI(this.item.category||"",[O.kI.required]),unit_price:new O.NI(this.item.unit_price,[O.kI.required]),tags:new O.NI(this.item.tags||[]),accept_points:new O.NI(this.item.accept_points||!1),discount_cap:new O.NI(this.item.discount_cap||0),images:new O.NI(this.item.images||[])}),this.loading=!1,this.separators=[e.K5,e.OC,e.L_]}addTag(_){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const p=_.input,s=_.value,d=this.tag_list;(s||"").trim()&&(d.push(s),this.form.controls.tags.setValue(d)),p&&(p.value="")}removeTag(_){if(!this.form||!this.form.controls.tags)return;const p=this.tag_list;this.form.controls.tags.markAsDirty();const s=p.indexOf(_);s>=0&&(p.splice(s,1),this.form.controls.tags.setValue(p))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new i.U({...this.item,id:this.item.id||`item-${(0,y.Iy)(99999999)}`,...this.form.value})}})}static#t=this.\u0275fac=function(p){return new(p||a)(t.Y36(o.WI))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:()=>{let _,p,s;return _=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,p=$localize`:@@zoneTagsPlaceholder␟c133beffffe3288bbdbf8572a32910c33ce14991␟2194594490376201833:Item tags e.g. Gluten Free, Vegan etc.`,s=$localize`:@@imagesLabel␟e5d9e00faa06714d7671b164cad364b26f4c585b␟5137125764814732349:Images:`,[["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-base-200",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],[1,"flex","items-center","space-x-2"],["class","flex flex-col",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],["list","",1,"flex","items-center","flex-wrap","max-w-lg"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-base-200","rounded",3,"min","max","step","render_fn"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],_,["aria-label","Item Tags"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],["name","tags","placeholder",p,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"removed"],["matChipRemove",""],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["for","images"],s,["name","images","formControlName","images"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-base-200"],["btn","","matRipple","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(p,s){if(1&p&&(t.TgZ(0,"header")(1,"h3"),t._uU(2),t.qZA(),t.YNc(3,v,3,0,"button",0),t.qZA(),t.YNc(4,N,28,27,"form",1)(5,F,3,1,"footer",2)(6,c,4,0,"ng-template",null,3,t.W1O),t.TgZ(8,"mat-autocomplete",null,4),t.YNc(10,m,2,2,"mat-option",5),t.qZA()),2&p){const d=t.MAs(7);t.xp6(2),t.hij("",s.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!s.loading),t.xp6(1),t.Q6J("ngIf",s.form&&!s.loading)("ngIfElse",d),t.xp6(1),t.Q6J("ngIf",!s.loading),t.xp6(5),t.Q6J("ngForOf",s.categories)}},dependencies:[B.sg,B.O5,R.XC,I.ey,R.ZL,o.ZT,K.oG,O._Y,O.Fj,O.wV,O.JJ,O.JL,O.On,O.sg,O.u,Z.o,P.KE,P.TO,I.wG,h.Nt,A.Ou,T.RA,T.oH,T.qH,T.z3,b.R,U.h],styles:["[list][_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin:.5rem}\n\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--51.css.map*/"]})}return a})()},1512:(S,J,n)=>{n.d(J,{V:()=>D});var e=n(2798),t=n(5784),O=n(5618),o=n(9039),y=n(6575),i=n(8128),B=n(6658),R=n(702),I=n(8849),K=n(4888),Z=n(257);const P=["catering-menu-item",""];function h(g,E){if(1&g&&(o.TgZ(0,"button",14)(1,"app-icon"),o._uU(2,"more_vert"),o.qZA()()),2&g){o.oxw(2);const l=o.MAs(4);o.Q6J("matMenuTriggerFor",l)}}function A(g,E){if(1&g){const l=o.EpF();o.TgZ(0,"div",6)(1,"mat-checkbox",7),o.NdJ("ngModelChange",function(r){o.CHM(l);const C=o.oxw();return o.KtG(C.is_enabled=r)}),o.qZA(),o.TgZ(2,"div",8)(3,"div",9)(4,"div"),o._uU(5),o.qZA(),o.TgZ(6,"div",10),o._uU(7),o.qZA()(),o.TgZ(8,"div",11),o._uU(9),o.ALo(10,"currency"),o.ALo(11,"async"),o.qZA()(),o.YNc(12,h,3,1,"button",12),o.TgZ(13,"button",13),o.NdJ("click",function(){o.CHM(l);const r=o.oxw();return o.KtG(r.show_options=!r.show_options)}),o.TgZ(14,"app-icon"),o._uU(15,"expand_more"),o.qZA()()()}if(2&g){const l=o.oxw();o.xp6(1),o.Q6J("ngModel",l.is_enabled),o.xp6(4),o.Oqu(l.item.name),o.xp6(2),o.hij(" ",l.item.category," "),o.xp6(2),o.hij(" ",o.xi3(10,6,l.item.unit_price/100,o.lcZ(11,9,l.symbol))," "),o.xp6(3),o.Q6J("ngIf",l.can_edit),o.xp6(1),o.Q6J("disabled",!l.item.options.length)}}function T(g,E){if(1&g){const l=o.EpF();o.TgZ(0,"button",23),o.NdJ("click",function(){o.CHM(l);const r=o.oxw().$implicit,C=o.oxw(2);return o.KtG(C.editOption(r))}),o.TgZ(1,"app-icon"),o._uU(2,"edit"),o.qZA()()}}function b(g,E){if(1&g){const l=o.EpF();o.TgZ(0,"button",24),o.NdJ("click",function(){o.CHM(l);const r=o.oxw().$implicit,C=o.oxw(2);return o.KtG(C.removeOption(r))}),o.TgZ(1,"app-icon"),o._uU(2,"delete"),o.qZA()()}}function U(g,E){if(1&g&&(o.TgZ(0,"div",17),o._UZ(1,"div",18),o.TgZ(2,"div",19)(3,"div",20),o._uU(4),o.qZA(),o.TgZ(5,"div",10),o._uU(6),o.qZA()(),o.YNc(7,T,3,0,"button",21)(8,b,3,0,"button",22),o.qZA()),2&g){const l=E.$implicit,x=o.oxw(2);o.xp6(4),o.Oqu(l.name),o.xp6(2),o.hij(" ",l.group," "),o.xp6(1),o.Q6J("ngIf",x.can_edit),o.xp6(1),o.Q6J("ngIf",x.can_edit)}}function v(g,E){if(1&g&&(o.TgZ(0,"div",15),o.YNc(1,U,9,4,"div",16),o.qZA()),2&g){const l=o.oxw();o.Udp("height",l.show_options?3.5*l.item.options.length+"rem":"0"),o.xp6(1),o.Q6J("ngForOf",l.item.options)}}let D=(()=>{class g{get can_edit(){return this._catering.is_editable}get is_enabled(){return!this.item.hide_for_zones.includes(this._catering.zone)}set is_enabled(l){let x=this.item.hide_for_zones;x=l?x.filter(r=>r!==this._catering.zone):(0,e.Tw)([...x,this._catering.zone]),this._catering.updateItem(new t.U({...this.item,hide_for_zones:x}))}get symbol(){return this._catering.currency}constructor(l){this._catering=l,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=x=>this._catering.addOption(this.item,x),this.removeOption=x=>this._catering.deleteOption(this.item,x),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}static#t=this.\u0275fac=function(x){return new(x||g)(o.Y36(O.j))};static#e=this.\u0275cmp=o.Xpm({type:g,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:P,decls:20,vars:2,consts:[[1,"w-full","h-full","bg-base-100","border","border-base-200","overflow-hidden","rounded"],["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-base-200 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],["matTooltip","Allow Ordering Item",1,"mr-2",3,"ngModel","ngModelChange"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","opacity-60"],[1,"p-2","m-2","text-xs","font-bold","text-secondary-content","rounded","bg-secondary"],["icon","","matRipple","",3,"matMenuTriggerFor",4,"ngIf"],["icon","","matRipple","",3,"disabled","click"],["icon","","matRipple","",3,"matMenuTriggerFor"],["options","",1,"bg-base-200","overflow-hidden"],["class","flex p-2 items-center border-t border-solid border-base-200 relative",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-t","border-solid","border-base-200","relative"],[1,"absolute","inset-y-0","left-0","w-2","bg-black","opacity-10"],[1,"flex-1","pl-4","pr-2"],[1,"text"],["edit","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["remove","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["edit","","icon","","matRipple","",1,"mx-2",3,"click"],["remove","","icon","","matRipple","",1,"mx-2",3,"click"]],template:function(x,r){1&x&&(o.TgZ(0,"div",0),o.YNc(1,A,16,11,"div",1)(2,v,2,3,"div",2),o.TgZ(3,"mat-menu",null,3)(5,"button",4),o.NdJ("click",function(){return r.addOption()}),o.TgZ(6,"app-icon"),o._uU(7,"add"),o.qZA(),o.TgZ(8,"div",5),o._uU(9,"Add Option"),o.qZA()(),o.TgZ(10,"button",4),o.NdJ("click",function(){return r.editItem()}),o.TgZ(11,"app-icon"),o._uU(12,"edit"),o.qZA(),o.TgZ(13,"div",5),o._uU(14,"Edit Item"),o.qZA()(),o.TgZ(15,"button",4),o.NdJ("click",function(){return r.removeItem()}),o.TgZ(16,"app-icon"),o._uU(17,"delete"),o.qZA(),o.TgZ(18,"div",5),o._uU(19,"Remove Item"),o.qZA()()()()),2&x&&(o.xp6(1),o.Q6J("ngIf",r.item),o.xp6(1),o.Q6J("ngIf",r.item))},dependencies:[y.sg,y.O5,i.VK,i.OP,i.p6,B.oG,R.gM,I.JJ,I.On,K.o,Z.wG,y.Ov,y.H9],styles:["[_nghost-%COMP%]{overflow:hidden;width:48rem;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}\n\n/*# sourceMappingURL=catering-menu-item.component.ts-angular-inline--65.css.map*/"]})}return g})()},6748:(S,J,n)=>{n.d(J,{B:()=>A});var e=n(462),t=n(7422),O=n(5618),o=n(9039),y=n(6575),i=n(989),B=n(4888),R=n(1512);function I(T,b){if(1&T&&(o.ynx(0),o._UZ(1,"div",6),o.BQk()),2&T){const U=b.$implicit;o.xp6(1),o.Q6J("item",U)}}function K(T,b){if(1&T&&(o.ynx(0),o.YNc(1,I,2,1,"ng-container",5),o.ALo(2,"async"),o.BQk()),2&T){const U=o.oxw();o.xp6(1),o.Q6J("ngForOf",o.lcZ(2,1,U.menu))}}function Z(T,b){if(1&T&&(o.ynx(0),o._UZ(1,"div",6),o.BQk()),2&T){const U=b.$implicit;o.xp6(1),o.Q6J("item",U)}}function P(T,b){if(1&T&&(o.TgZ(0,"mat-tab",7),o.YNc(1,Z,2,1,"ng-container",5),o.ALo(2,"async"),o.qZA()),2&T){const U=b.$implicit,v=o.oxw();o.Q6J("label",U),o.uIk("label",U),o.xp6(1),o.Q6J("ngForOf",o.lcZ(2,3,v.tab_menu)[U])}}function h(T,b){1&T&&(o.TgZ(0,"div",8)(1,"app-icon"),o._uU(2,"close"),o.qZA(),o.TgZ(3,"p"),o._uU(4,"No items in menu"),o.qZA()())}let A=(()=>{class T{get categories(){return this._catering.categories}constructor(U){this._catering=U,this.menu=this._catering.menu,this.shown_tab=new e.X(""),this.tab_menu=this.menu.pipe((0,t.U)(v=>{const D={};for(const g of this.categories)D[g]=v.filter(E=>E.category===g);return D}))}static#t=this.\u0275fac=function(v){return new(v||T)(o.Y36(O.j))};static#e=this.\u0275cmp=o.Xpm({type:T,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(v,D){if(1&v&&(o.TgZ(0,"mat-tab-group",0),o.NdJ("selectedIndexChange",function(E){return D.shown_tab.next(0===E?"":D.categories[E-1])}),o.TgZ(1,"mat-tab",1),o.YNc(2,K,3,3,"ng-container",2),o.ALo(3,"async"),o.qZA(),o.YNc(4,P,3,5,"mat-tab",3),o.qZA(),o.YNc(5,h,5,0,"ng-template",null,4,o.W1O)),2&v){const g=o.MAs(6);let E;o.xp6(2),o.Q6J("ngIf",null==(E=o.lcZ(3,3,D.menu))?null:E.length)("ngIfElse",g),o.xp6(2),o.Q6J("ngForOf",D.categories)}},dependencies:[y.sg,y.O5,i.uX,i.SP,B.o,R.V,y.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--66.css.map*/"]})}return T})()},7341:(S,J,n)=>{n.d(J,{M:()=>x});var e=n(9039),t=n(8849),O=n(7401),o=n(2338),y=n(5784),i=n(6575),B=n(9892),R=n(257),I=n(6658),K=n(4888),Z=n(1268),P=n(9674),h=n(3910);function A(r,C){1&r&&(e.TgZ(0,"button",6)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function T(r,C){if(1&r&&(e.TgZ(0,"div",9)(1,"label",10),e._uU(2," Name"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",11),e._UZ(7,"input",12),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()()),2&r){const u=e.oxw(2);e.xp6(1),e.ekj("error",u.form.controls.name.invalid&&u.form.controls.name.touched)}}function b(r,C){if(1&r&&(e.TgZ(0,"div",9)(1,"label",13),e._uU(2," Type"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",11),e._UZ(7,"input",14),e.TgZ(8,"mat-error"),e._uU(9,"Type is required"),e.qZA()()()),2&r){const u=e.oxw(2),N=e.MAs(9);e.xp6(1),e.ekj("error",u.form.controls.group.invalid&&u.form.controls.group.touched),e.xp6(6),e.Q6J("matAutocomplete",N)}}function U(r,C){1&r&&(e.TgZ(0,"div",9)(1,"label",10),e._uU(2,"Unit Price:"),e.qZA(),e.TgZ(3,"mat-form-field",11),e._UZ(4,"input",15),e.qZA()())}function v(r,C){1&r&&(e.TgZ(0,"div",9)(1,"mat-checkbox",16),e._uU(2," Can select multiple of type "),e.qZA()())}function D(r,C){if(1&r&&(e.TgZ(0,"form",7),e.YNc(1,T,10,2,"div",8)(2,b,10,3,"div",8)(3,U,5,0,"div",8)(4,v,3,0,"div",8),e.qZA()),2&r){const u=e.oxw();e.Q6J("formGroup",u.form),e.xp6(1),e.Q6J("ngIf",u.form.controls.name),e.xp6(1),e.Q6J("ngIf",u.form.controls.group),e.xp6(1),e.Q6J("ngIf",u.form.controls.unit_price),e.xp6(1),e.Q6J("ngIf",u.form.controls.multiple)}}function g(r,C){if(1&r){const u=e.EpF();e.TgZ(0,"footer",17)(1,"button",18),e.NdJ("click",function(){e.CHM(u);const F=e.oxw();return e.KtG(F.saveChanges())}),e._uU(2," Save "),e.qZA()()}if(2&r){const u=e.oxw();e.xp6(1),e.Q6J("disabled",!u.form.dirty)}}function E(r,C){1&r&&(e.TgZ(0,"div",19),e._UZ(1,"mat-spinner",20),e.TgZ(2,"p"),e._uU(3,"Saving catering item option..."),e.qZA()())}function l(r,C){if(1&r&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&r){const u=C.$implicit;e.Q6J("value",u),e.xp6(1),e.hij(" ",u," ")}}let x=(()=>{class r{get option(){return this._data.option}get types(){return this._data.types||[]}constructor(u){this._data=u,this.event=new e.vpe,this.form=new t.cw({name:new t.NI(this.option.name||"",[t.kI.required]),group:new t.NI(this.option.group||"",[t.kI.required]),unit_price:new t.NI(this.option.unit_price),multiple:new t.NI(!!this.option.multiple,[])}),this.loading=!1}saveChanges(){this.loading=!0;const u={...this.option,id:this.option.id||`option-${(0,o.Iy)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new y.U({...this._data.parent,options:this._data.parent.options.filter(N=>N.id!==u.id).concat([u])})}})}static#t=this.\u0275fac=function(N){return new(N||r)(e.Y36(O.WI))};static#e=this.\u0275cmp=e.Xpm({type:r,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["icon","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-base-200",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["icon","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-base-200"],["btn","","matRipple","",3,"disabled","click"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(N,F){if(1&N&&(e.TgZ(0,"header")(1,"h3"),e._uU(2),e.qZA(),e.YNc(3,A,3,0,"button",0),e.qZA(),e.YNc(4,D,5,5,"form",1)(5,g,3,1,"footer",2)(6,E,4,0,"ng-template",null,3,e.W1O),e.TgZ(8,"mat-autocomplete",null,4),e.YNc(10,l,2,2,"mat-option",5),e.qZA()),2&N){const c=e.MAs(7);e.xp6(2),e.hij("",F.option.id?"Edit":"Add"," Item Option"),e.xp6(1),e.Q6J("ngIf",!F.loading),e.xp6(1),e.Q6J("ngIf",F.form&&!F.loading)("ngIfElse",c),e.xp6(1),e.Q6J("ngIf",!F.loading),e.xp6(5),e.Q6J("ngForOf",F.types)}},dependencies:[i.sg,i.O5,B.XC,R.ey,B.ZL,O.ZT,I.oG,t._Y,t.Fj,t.wV,t.JJ,t.JL,t.sg,t.u,K.o,Z.KE,Z.TO,R.wG,P.Nt,h.Ou]})}return r})()},1506:(S,J,n)=>{n.d(J,{m:()=>K});var e=n(9039),t=n(6575),O=n(4888),o=n(257);const y=["catering-order-item",""];function i(Z,P){if(1&Z&&(e.TgZ(0,"div",12),e._uU(1),e.qZA()),2&Z){const h=e.oxw().$implicit;e.xp6(1),e.hij(" ",h.name," ")}}function B(Z,P){if(1&Z&&(e.ynx(0),e.YNc(1,i,2,1,"div",11),e.BQk()),2&Z){const h=P.$implicit;e.xp6(1),e.Q6J("ngIf",h)}}function R(Z,P){if(1&Z){const h=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e._UZ(2,"div",2),e.qZA(),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){e.CHM(h);const T=e.oxw();return e.KtG(T.toggle())}),e.TgZ(5,"app-icon"),e._uU(6),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6),e._uU(9),e.qZA(),e.TgZ(10,"div",7)(11,"div",8),e._uU(12),e.qZA()(),e.TgZ(13,"div",9),e.YNc(14,B,2,1,"ng-container",10),e.qZA()(),e.BQk()}if(2&Z){const h=e.oxw();e.xp6(4),e.ekj("bg-success",h.active)("text-white",h.active)("border-solid",h.active),e.xp6(2),e.Oqu(h.active?"done":"local_pizza"),e.xp6(3),e.Oqu(null==h.item?null:h.item.name),e.xp6(3),e.hij(" \u2a2f",(null==h.item?null:h.item.amount)||(null==h.item?null:h.item.quantity)||1," "),e.xp6(2),e.Q6J("ngForOf",h.item.option_list)}}const I=new Set;let K=(()=>{class Z{constructor(){this.active=!1}get item_key(){return`${this.order_id}|${this.item?.id}`}ngOnInit(){this.active=I.has(this.item_key)}toggle(){I.has(this.item_key)?(I.delete(this.item_key),this.active=!1):(I.add(this.item_key),this.active=!0)}static#t=this.\u0275fac=function(A){return new(A||Z)};static#e=this.\u0275cmp=e.Xpm({type:Z,selectors:[["","catering-order-item",""]],inputs:{order_id:"order_id",item:"item"},attrs:y,decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-20","text-right","h-14","relative"],[1,"border-b-2","border-l-2","border-base-200","w-4","h-16","absolute","top-1/2","left-1/2","-translate-y-full"],[1,"w-12","mr-4"],["action","","icon","","matRipple","",1,"border","border-base-200","border-dashed","text-xl","text-dark-fade","p-2",3,"click"],[1,"flex","flex-1","border-b","border-base-200","border-solid","py-4","space-x-2"],[1,""],[1,"flex-1"],[1,"p-1","rounded-full","bg-neutral","w-8","h-8","flex","items-center","justify-center"],[1,"flex","space-x-2","mr-2"],[4,"ngFor","ngForOf"],["class","text-xs py-1 px-2 bg-warning text-black rounded-2xl shadow",4,"ngIf"],[1,"text-xs","py-1","px-2","bg-warning","text-black","rounded-2xl","shadow"]],template:function(A,T){1&A&&e.YNc(0,R,15,10,"ng-container",0),2&A&&e.Q6J("ngIf",T.item)},dependencies:[t.sg,t.O5,O.o,o.wG],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}\n\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--67.css.map*/"]})}return Z})()},2467:(S,J,n)=>{n.d(J,{I:()=>R});var e=n(6030),t=n(9039),O=n(6575),o=n(21);function y(I,K){if(1&I&&(t.TgZ(0,"li",12),t._UZ(1,"catering-order",13),t.qZA()),2&I){const Z=K.$implicit;t.xp6(1),t.Q6J("order",Z)}}function i(I,K){1&I&&(t.TgZ(0,"div",14)(1,"p",15),t._uU(2,"No Catering Orders"),t.qZA()())}function B(I,K){1&I&&t._UZ(0,"mat-progress-bar",16)}let R=(()=>{class I{constructor(Z){this._orders=Z,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(Z,P){return P?P.id:void 0}static#t=this.\u0275fac=function(P){return new(P||I)(t.Y36(e.I))};static#e=this.\u0275cmp=t.Xpm({type:I,selectors:[["catering-order-list"]],decls:26,vars:10,consts:[[1,"sticky","top-0","w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-base-200","bg-base-100"],[1,"w-20"],[1,"w-24"],[1,"w-36"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-base-200",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block opacity-60",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-base-200"],[3,"order"],["empty","",1,"info-block","opacity-60"],[1,"p-4","text-center"],["mode","indeterminate",1,"w-full"]],template:function(P,h){if(1&P&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Time"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Meeting Time"),t.qZA(),t.TgZ(6,"div",4),t._uU(7,"Location"),t.qZA(),t.TgZ(8,"div",5),t._uU(9,"Host"),t.qZA(),t.TgZ(10,"div",6),t._uU(11,"Charge Code"),t.qZA(),t.TgZ(12,"div",2),t._uU(13,"Notes"),t.qZA(),t.TgZ(14,"div",6),t._uU(15,"Invoice No."),t.qZA(),t.TgZ(16,"div",3),t._uU(17,"Status"),t.qZA(),t._UZ(18,"div",7),t.qZA(),t.TgZ(19,"ul",8),t.YNc(20,y,2,1,"li",9),t.ALo(21,"async"),t.YNc(22,i,3,0,"div",10),t.ALo(23,"async"),t.qZA(),t.YNc(24,B,1,0,"mat-progress-bar",11),t.ALo(25,"async")),2&P){let A;t.xp6(20),t.Q6J("ngForOf",t.lcZ(21,4,h.order_list))("ngForTrackBy",h.trackByFn),t.xp6(2),t.Q6J("ngIf",!(null!=(A=t.lcZ(23,6,h.order_list))&&A.length)),t.xp6(2),t.Q6J("ngIf",t.lcZ(25,8,h.loading))}},dependencies:[O.sg,O.O5,o.p,O.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--68.css.map*/"]})}return I})()},593:(S,J,n)=>{n.d(J,{W:()=>f});var e=n(1670),t=n(9039),O=n(7401),o=n(2798),y=n(5784),i=n(5688),B=n(3121),R=n(6736),I=n(6575),K=n(989),Z=n(702),P=n(8849),h=n(4888),A=n(257),T=n(3910),b=n(622);function U(_,p){1&_&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function v(_,p){if(1&_){const s=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(W){t.CHM(s);const w=t.oxw().$implicit,Q=t.oxw(5);return t.KtG(Q.updateItemQuantity(w,W))}),t.qZA()}if(2&_){const s=t.oxw().$implicit;t.Q6J("ngModel",s.quantity)}}function D(_,p){if(1&_){const s=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),t._uU(4,"remove"),t.qZA()()(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(s);const W=t.oxw().$implicit,w=t.oxw(5);return t.KtG(w.addItem(W))}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA()()()}if(2&_){const s=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",s.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",s.quantity," ")}}function g(_,p){if(1&_&&(t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,U,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,v,1,1,"a-counter",15)(9,D,10,3,"div",16),t.qZA()),2&_){const s=p.$implicit,d=t.oxw(5);t.xp6(3),t.hij(" ",s.name," "),t.xp6(1),t.Q6J("ngIf",s.options.length),t.xp6(2),t.hij(" ",t.xi3(7,5,s.unit_price/100,d.code)," "),t.xp6(2),t.Q6J("ngIf",!s.options.length),t.xp6(1),t.Q6J("ngIf",s.options.length)}}const E=()=>({});function l(_,p){if(1&_&&(t.TgZ(0,"mat-tab",8)(1,"div",9),t.YNc(2,g,10,8,"div",10),t.qZA()()),2&_){const s=t.oxw().$implicit,d=t.oxw(3);t.Q6J("label",s),t.xp6(2),t.Q6J("ngForOf",(d.menu_items||t.DdM(2,E))[s])}}function x(_,p){if(1&_&&(t.ynx(0),t.YNc(1,l,3,3,"mat-tab",7),t.BQk()),2&_){const s=p.$implicit,d=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(d.menu_items||t.DdM(1,E))[s].length)}}function r(_,p){if(1&_&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,x,2,2,"ng-container",6),t.qZA(),t.BQk()),2&_){const s=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",s.categories)}}function C(_,p){if(1&_&&(t.TgZ(0,"div",4),t.YNc(1,r,3,1,"ng-container",5),t.qZA()),2&_){const s=t.oxw(),d=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!s.show_order_details)("ngIfElse",d)}}function u(_,p){if(1&_){const s=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){t.CHM(s);const W=t.oxw(2);return t.KtG(W.show_order_details=!0)}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&_){const s=t.oxw(2);t.xp6(3),t.Q6J("disabled",!s.order.item_count)("matBadge",s.order.item_count)("matBadgeHidden",!s.order.item_count)}}function N(_,p){if(1&_){const s=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(s);const W=t.oxw(2);return t.KtG(W.show_order_details=!1)}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){t.CHM(s);const W=t.oxw(2);return t.KtG(W.saveOrder())}),t._uU(3," Save Order "),t.qZA()}}function F(_,p){if(1&_&&(t.TgZ(0,"footer",24),t.YNc(1,u,5,3,"ng-container",5)(2,N,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&_){const s=t.MAs(3),d=t.oxw();t.xp6(1),t.Q6J("ngIf",!d.show_order_details)("ngIfElse",s)}}function c(_,p){if(1&_&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&_){const s=t.oxw();t.xp6(3),t.Oqu(s.loading)}}function m(_,p){if(1&_&&(t.TgZ(0,"div",35),t._uU(1),t.qZA()),2&_){const s=t.oxw().$implicit,d=t.oxw(2);t.Q6J("matTooltip",d.optionsFor(s)),t.xp6(1),t.AsE(" ",s.options.length," option",1===s.options.length?"":"s"," selected ")}}function M(_,p){if(1&_){const s=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,m,2,3,"div",33),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",34),t.NdJ("ngModelChange",function(W){const Q=t.CHM(s).$implicit,$=t.oxw(2);return t.KtG($.updateItemQuantity(Q,W))}),t.qZA()()}if(2&_){const s=p.$implicit,d=t.oxw(2);t.xp6(3),t.Oqu(s.name),t.xp6(1),t.Q6J("ngIf",s.options.length),t.xp6(2),t.hij(" ",t.xi3(7,4,s.total_cost/100,d.code)," "),t.xp6(2),t.Q6J("ngModel",s.quantity)}}function a(_,p){if(1&_&&(t.TgZ(0,"header",32)(1,"h3"),t._uU(2,"Confirm Order"),t.qZA()(),t.TgZ(3,"div",9),t.YNc(4,M,9,7,"div",10),t.qZA()),2&_){const s=t.oxw();t.xp6(4),t.Q6J("ngForOf",s.order.items)}}let f=(()=>{class _ extends o.cx{get code(){return this._org.currency_code}constructor(s,d){super(),this._org=s,this._data=d,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var s=this;return(0,e.Z)(function*(){s.loading="Loading menu...",s.order=new i.G(s._data.order),s.rules=yield s._data.getCateringConfig(s.order.event?.space?.level?.parent_id),s._data.menu.subscribe(d=>{s.loading="Loading menu...";const W=(0,o.Tw)(d.map(Q=>Q.category)),w={};for(const Q of W)w[Q]=d.filter($=>$.category===Q&&(0,R.R)($,s.rules,s.order.event));s.categories=W,s.menu_items=w,s.updateMenuQuantities(),s.timeout("clear_loading",()=>s.loading="",1e3)})})()}addItem(s,d=!0){const W=this.order.items.find(w=>w.id===s.id&&w.options.length===w.options.reduce((Q,$)=>Q+(s.options.find(q=>$.id===q.id)?1:0),0));d&&s.options?.length?this._data.selectOptions(s.options).then(w=>{const Q=new y.U({...s,options:w});this.addItem(Q,!1)}):this.order=new i.G(W?{...this.order,items:this.order.items.filter(w=>!(w.id===s.id&&w.options_string===s.options_string)).concat([new y.U({...s,quantity:W.quantity+1})])}:{...this.order,items:this.order.items.concat([new y.U({...s,quantity:1})])}),this.updateMenuQuantities()}removeItem(s){this.order=new i.G({...this.order,items:this.order.items.filter(d=>d.id!==s.id&&d.options_string===s.options_string)}),this.updateMenuQuantities()}updateItemQuantity(s,d){const W=this.order.items.find(Q=>Q.id===s.id&&Q.options_string===s.options_string);let w=[...this.order.items];w=W?this.order.items.filter(Q=>!(Q.id===s.id&&Q.options_string===s.options_string)).concat([new y.U({...s,quantity:d})]):this.order.items.concat([new y.U({...s,quantity:d})]),w.sort((Q,$)=>Q.name.localeCompare($.name)),this.order=new i.G({...this.order,items:w}),this.updateMenuQuantities()}updateMenuQuantities(){for(const s in this.menu_items)for(const d of this.menu_items[s])d.quantity=this.order.items.reduce((W,w)=>w.id===d.id?W+w.quantity:W,0)}optionsFor(s){return s.options.map(d=>d.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}static#t=this.\u0275fac=function(d){return new(d||_)(t.Y36(B.w7),t.Y36(O.WI))};static#e=this.\u0275cmp=t.Xpm({type:_,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-base-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-base-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-base-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["icon","","matRipple","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["icon","","matRipple","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-base-200"],["order_actions",""],["btn","","matRipple","","mat-dialog-close","",1,"inverse"],["confirm","","btn","","matRipple","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["matRipple","",1,"inverse",3,"click"],["save","","btn","","matRipple","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(d,W){if(1&d&&t.YNc(0,C,2,2,"div",0)(1,F,4,2,"footer",1)(2,c,4,1,"ng-template",null,2,t.W1O)(4,a,5,1,"ng-template",null,3,t.W1O),2&d){const w=t.MAs(3);t.Q6J("ngIf",!W.loading)("ngIfElse",w),t.xp6(1),t.Q6J("ngIf",!W.loading)}},dependencies:[I.sg,I.O5,K.uX,K.SP,O.ZT,Z.gM,P.Fj,P.JJ,P.On,h.o,A.wG,T.Ou,b.R,I.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--s);border-bottom:2px solid var(--s);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--52.css.map*/"]})}return _})()},8089:(S,J,n)=>{n.d(J,{R:()=>U});var e=n(9039),t=n(7401),O=n(2338),o=n(6575),y=n(6658),i=n(2106),B=n(8849),R=n(4888),I=n(257);function K(v,D){if(1&v&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&v){const g=e.oxw().$implicit,E=e.oxw(3);e.xp6(1),e.hij(" +",e.xi3(2,1,g.unit_price/100,E.code)," ")}}function Z(v,D){if(1&v&&(e.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,K,3,4,"div",17),e.qZA()()),2&v){const g=D.$implicit;e.Q6J("value",g.id),e.xp6(3),e.hij(" ",g.name," "),e.xp6(1),e.Q6J("ngIf",g.unit_price)}}function P(v,D){if(1&v){const g=e.EpF();e.ynx(0),e.TgZ(1,"mat-radio-group",10),e.NdJ("ngModelChange",function(l){e.CHM(g);const x=e.oxw().$implicit,r=e.oxw();return e.KtG(r.updateGroupOption(x,l))}),e.TgZ(2,"mat-radio-button",11)(3,"span",12),e._uU(4,"None"),e.qZA()(),e.YNc(5,Z,5,3,"mat-radio-button",13),e.qZA(),e.BQk()}if(2&v){const g=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",null==g?null:g.options)}}function h(v,D){if(1&v&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&v){const g=e.oxw().$implicit,E=e.oxw(3);e.xp6(1),e.hij(" +",e.xi3(2,1,g.unit_price/100,E.code)," ")}}function A(v,D){if(1&v){const g=e.EpF();e.TgZ(0,"mat-checkbox",20),e.NdJ("ngModelChange",function(l){const r=e.CHM(g).$implicit,C=e.oxw(3);return e.KtG(C.option_state[r.id]=l)}),e.TgZ(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,h,3,4,"div",17),e.qZA()()}if(2&v){const g=D.$implicit,E=e.oxw(3);e.Q6J("ngModel",E.option_state[g.id]),e.xp6(3),e.hij(" ",g.name," "),e.xp6(1),e.Q6J("ngIf",g.unit_price)}}function T(v,D){if(1&v&&e.YNc(0,A,5,3,"mat-checkbox",19),2&v){const g=e.oxw().$implicit;e.Q6J("ngForOf",null==g?null:g.options)}}function b(v,D){if(1&v&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.qZA(),e.TgZ(3,"div",7),e.YNc(4,P,6,1,"ng-container",8)(5,T,1,1,"ng-template",null,9,e.W1O),e.qZA()()),2&v){const g=D.$implicit,E=e.MAs(6);e.uIk("group",g.name),e.xp6(2),e.Oqu(g.name),e.xp6(2),e.Q6J("ngIf",!g.multiple)("ngIfElse",E)}}let U=(()=>{class v{constructor(g){this._data=g,this.event=new e.vpe,this.option_state={},this.code=this._data.code;const E=(0,O.Tw)(this._data.options.map(x=>x.group||"Other")),l=[];for(const x of E){const r=this._data.options.filter(C=>C.group===x);l.push({name:x,multiple:!!r.find(C=>C.multiple),options:r})}this.groups=l}updateGroupOption(g,E){for(const l of g.options)this.option_state[l.id]=l.id===E}saveOptions(){const g=this._data.options.filter(E=>this.option_state[E.id]);this.event.emit({reason:"done",metadata:{options:g}})}static#t=this.\u0275fac=function(E){return new(E||v)(e.Y36(t.WI))};static#e=this.\u0275cmp=e.Xpm({type:v,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["icon","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-base-200",4,"ngFor","ngForOf"],[1,"p-2"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-base-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(E,l){1&E&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Select options"),e.qZA(),e.TgZ(3,"button",0)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.TgZ(6,"main",1),e.YNc(7,b,7,4,"div",2),e.qZA(),e.TgZ(8,"footer",3)(9,"button",4),e.NdJ("click",function(){return l.saveOptions()}),e._uU(10," Save "),e.qZA()()),2&E&&(e.xp6(7),e.Q6J("ngForOf",l.groups))},dependencies:[o.sg,o.O5,t.ZT,y.oG,i.VQ,i.U0,B.JJ,B.On,R.o,I.wG,o.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--53.css.map*/"]})}return v})()},21:(S,J,n)=>{n.d(J,{p:()=>E});var e=n(1670),t=n(2798),O=n(6030),y=(n(5688),n(9815)),i=n(9039),B=n(6575),R=n(8128),I=n(702),K=n(4888),Z=n(257),P=n(1506);function h(l,x){1&l&&(i.TgZ(0,"span",21),i._uU(1," No Location "),i.qZA())}function A(l,x){1&l&&(i.TgZ(0,"span",21),i._uU(1," Unknown Host "),i.qZA())}function T(l,x){if(1&l&&(i.TgZ(0,"button",22),i._uU(1," View "),i.qZA()),2&l){const r=i.oxw(2);i.Q6J("matTooltip",r.order.notes)}}function b(l,x){1&l&&(i.TgZ(0,"span",21),i._uU(1," No Invoice "),i.qZA())}function U(l,x){if(1&l){const r=i.EpF();i.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),i._uU(4,"room_service"),i.qZA()()(),i.TgZ(5,"div",7),i._uU(6),i.ALo(7,"date"),i.qZA(),i.TgZ(8,"div",8),i._uU(9),i.ALo(10,"date"),i.ALo(11,"date"),i._UZ(12,"br"),i._uU(13),i.ALo(14,"date"),i.ALo(15,"date"),i.qZA(),i.TgZ(16,"div",9),i._uU(17),i.YNc(18,h,2,0,"span",10),i.qZA(),i.TgZ(19,"div",11),i._uU(20),i.YNc(21,A,2,0,"span",10),i.qZA(),i.TgZ(22,"div",12),i._uU(23),i.qZA(),i.TgZ(24,"div",13),i.YNc(25,T,2,1,"button",14),i.qZA(),i.TgZ(26,"div",12),i._uU(27),i.YNc(28,b,2,0,"span",10),i.qZA(),i.TgZ(29,"div",15)(30,"button",16)(31,"div",17),i._uU(32),i.qZA(),i.TgZ(33,"app-icon",18),i._uU(34,"arrow_drop_down"),i.qZA()()(),i.TgZ(35,"div",19)(36,"button",20),i.NdJ("click",function(){i.CHM(r);const u=i.oxw();return i.KtG(u.show_items=!u.show_items)}),i.TgZ(37,"app-icon"),i._uU(38),i.qZA()()()()}if(2&l){const r=i.oxw(),C=i.MAs(3);i.ekj("bg-base-200",!r.show_items)("bg-base-200",r.show_items),i.xp6(1),i.ekj("bg-base-200",r.show_items)("dark:bg-neutral-700",r.show_items),i.xp6(5),i.hij(" ",i.xi3(7,26,r.order.deliver_at,r.time_format)," "),i.xp6(3),i.AsE(" ",i.xi3(10,29,null==r.order.event?null:r.order.event.date,"MMM d"),", ",i.xi3(11,32,null==r.order.event?null:r.order.event.date,r.time_format)," "),i.xp6(4),i.AsE(" ",i.xi3(14,35,null==r.order.event?null:r.order.event.date_end,"MMM d"),", ",i.xi3(15,38,null==r.order.event?null:r.order.event.date_end,r.time_format)," "),i.xp6(4),i.hij(" ",(null==r.order.event||null==r.order.event.space?null:r.order.event.space.display_name)||(null==r.order.event||null==r.order.event.space?null:r.order.event.space.name)||""," "),i.xp6(1),i.Q6J("ngIf",!(null!=r.order.event&&null!=r.order.event.space&&r.order.event.space.display_name||null!=r.order.event&&null!=r.order.event.space&&r.order.event.space.name)),i.xp6(2),i.hij(" ",(null==r.order.event||null==r.order.event.organiser?null:r.order.event.organiser.name)||(null==r.order.event?null:r.order.event.host)||""," "),i.xp6(1),i.Q6J("ngIf",!(null!=r.order.event&&null!=r.order.event.organiser&&r.order.event.organiser.name||null!=r.order.event&&r.order.event.host)),i.xp6(2),i.Oqu(r.order.charge_code||"~ No Code ~"),i.xp6(2),i.Q6J("ngIf",r.order.notes),i.xp6(2),i.hij(" ",r.order.invoice_number||""," "),i.xp6(1),i.Q6J("ngIf",!r.order.invoice_number),i.xp6(2),i.Udp("background",null==r.status?null:r.status.colour),i.Q6J("matMenuTriggerFor",C),i.xp6(2),i.hij(" ",null==r.status?null:r.status.name," "),i.xp6(6),i.Oqu(r.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function v(l,x){if(1&l&&i._UZ(0,"li",25),2&l){const r=x.$implicit,C=i.oxw(2);i.Q6J("order_id",null==C.order?null:C.order.id)("item",r)}}function D(l,x){if(1&l&&(i.TgZ(0,"ul",23),i.YNc(1,v,1,2,"li",24),i.qZA()),2&l){const r=i.oxw();i.ekj("shown",r.show_items),i.Q6J("@show",r.show_items?"show":"hide"),i.xp6(1),i.Q6J("ngForOf",r.order.items)}}function g(l,x){if(1&l){const r=i.EpF();i.TgZ(0,"button",26),i.NdJ("click",function(){const N=i.CHM(r).$implicit,F=i.oxw();return i.KtG(F.updateStatus(N.id))}),i._UZ(1,"div",27),i.TgZ(2,"span",28),i._uU(3),i.qZA()()}if(2&l){const r=x.$implicit;i.xp6(1),i.Udp("background-color",r.colour),i.xp6(2),i.Oqu(r.name)}}let E=(()=>{class l extends t.cx{get status(){return this.statuses.find(r=>r.id===this.order.status)}get time_format(){return this._settings.time_format}constructor(r,C){var u;super(),u=this,this._orders=r,this._settings=C,this.show_items=!1,this.statuses=y.U,this.updateStatus=function(){var N=(0,e.Z)(function*(F){yield u._orders.updateStatus(u.order,F),u.timeout("status-change",()=>u.order.status=F)});return function(F){return N.apply(this,arguments)}}()}static#t=this.\u0275fac=function(C){return new(C||l)(i.Y36(O.I),i.Y36(t.gb))};static#e=this.\u0275cmp=i.Xpm({type:l,selectors:[["catering-order"]],inputs:{order:"order"},features:[i.qOj],decls:5,vars:3,consts:[["class","w-full flex items-center py-2",3,"bg-base-200",4,"ngIf"],["class","list-none p-0 m-0 w-full relative z-0",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2"],[1,"w-20","flex","items-center","justify-center","z-20","h-full"],[1,"rounded-full","bg-base-300","p-2","text-2xl","text-black","opacity-60","flex","items-center","justify-center"],["time","",1,"w-24"],["time","",1,"w-36","text-sm"],[1,"flex-1"],["class","opacity-30",4,"ngIf"],[1,"w-56"],[1,"w-28"],[1,"w-24"],["class","clear underline",3,"matTooltip",4,"ngIf"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["icon","",3,"click"],[1,"opacity-30"],[1,"clear","underline",3,"matTooltip"],[1,"list-none","p-0","m-0","w-full","relative","z-0"],["catering-order-item","","class","flex items-center",3,"order_id","item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"order_id","item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(C,u){1&C&&(i.YNc(0,U,39,41,"div",0)(1,D,2,4,"ul",1),i.TgZ(2,"mat-menu",null,2),i.YNc(4,g,4,3,"button",3),i.qZA()),2&C&&(i.Q6J("ngIf",u.order),i.xp6(1),i.Q6J("ngIf",null==u.order?null:u.order.items.length),i.xp6(3),i.Q6J("ngForOf",u.statuses))},dependencies:[B.sg,B.O5,R.VK,R.OP,R.p6,I.gM,K.o,Z.wG,P.m,B.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}\n\n/*# sourceMappingURL=catering-order.component.ts-angular-inline--69.css.map*/"],data:{animation:[t.X7]}})}return l})()},6030:(S,J,n)=>{n.d(J,{I:()=>E});var e=n(1670),t=n(462),O=n(8159),o=n(9681),y=n(5933),i=n(6520),B=n(8175),R=n(7422),I=n(5746),K=n(680),Z=n(7343),P=n(7016),h=n(4512),A=n(4884),T=n(2798),b=n(4386),U=n(8975),v=n(5688),D=n(9039);let E=(()=>{class l extends T.cx{get filters(){return this._filters.getValue()}set filters(r){this._filters.next(r)}constructor(){super(),this._poll=new t.X(0),this._loading=new t.X(!1),this._filters=new t.X({}),this.orders=(0,O.aj)([this._filters,this._poll]).pipe((0,y.b)(1e3),(0,i.w)(([{date:r,zones:C}])=>{this._loading.next(!0);const u=(0,Z.Z)((0,P.Z)(r||Date.now())),N=(0,Z.Z)((0,h.Z)(r||Date.now()));return(0,b.u$)({zone_ids:(C||[]).join(","),period_start:u,period_end:N}).pipe((0,B.K)(()=>(0,o.of)([])),(0,R.U)(F=>(0,T.xH)(F.map(c=>c.valid_catering.map(m=>new v.G({...m,event:c}))))),(0,R.U)(F=>F.filter(c=>(0,A.Z)(c.deliver_at,"yyyy-MM-dd")===(0,A.Z)(1e3*u,"yyyy-MM-dd"))))}),(0,I.b)(()=>this._loading.next(!1)),(0,K.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,R.U)(r=>r.filter(C=>function g(l,x){const r=(x.search||"").toLowerCase();return!!l.items.find(C=>C.name.toLowerCase().includes(r)||!!C.options.find(u=>u.name.toLowerCase().includes(r)))}(C,this._filters.getValue())).sort((C,u)=>C.deliver_at-u.deliver_at))),this.subscription("changes",this.orders.subscribe())}startPolling(r=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),r)}stopPolling(){this.clearInterval("polling")}updateStatus(r,C){var u=this;return(0,e.Z)(function*(){r.status=C;const N=new v.G({...r,status:C,event:null}),F=[...(r.event.extension_data.catering||[]).filter(a=>a.id!==r.id),N].map(a=>new v.G({...a})),c=new U.y({...r.event,catering:F}),m=c?.resources[0]?.id||c?.system?.id,M=yield(0,b.kh)(c.id,m,c.extension_data).toPromise();return u.timeout("refresh-list",()=>u._poll.next(Date.now()),1e3),r.status=C,M})()}static#t=this.\u0275fac=function(C){return new(C||l)};static#e=this.\u0275prov=D.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})()},5618:(S,J,n)=>{n.d(J,{j:()=>u});var e=n(1670),t=n(7298),O=n(462),o=n(8159),y=n(9681),i=n(5046),B=n(6520),R=n(8175),I=n(7422),K=n(5746),Z=n(680),P=n(7627),h=n(6939),A=n(2798),T=n(3121),b=n(8147),U=n(7341),v=n(1862),D=n(5784),g=n(5688),E=n(593),l=n(8089),x=n(766),r=n(9039),C=n(7401);let u=(()=>{class N extends A.cx{get is_editable(){return!this.zone||this.zone===this._org.building?.id}get categories(){const c=this._menu.getValue();return(0,A.Tw)(c.map(m=>m.category))}constructor(c,m,M){var a;super(),a=this,this._org=c,this._dialog=m,this._settings=M,this._updated=new O.X(0),this._menu=new O.X([]),this._loading=new O.X(!1),this._currency=new O.X("USD"),this._change=new O.X(0),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.settings=(0,o.aj)([this._org.active_building,this._change]).pipe((0,i.h)(([f])=>!!f),(0,B.w)(([f])=>(0,t.rlq)(f.id,"catering-settings").pipe((0,R.K)(_=>(0,y.of)({})))),(0,I.U)(f=>f.details||{}),(0,K.b)(f=>this._settings.post("require_catering_notes",!!f?.require_notes)),(0,Z.d)(1)),this.charge_codes=this.settings.pipe((0,I.U)(f=>f.charge_codes||[])),this.availability=this.settings.pipe((0,I.U)(f=>f.disabled_rooms||[])),this.zone="",this.subscription("building",this._org.active_building.subscribe(function(){var f=(0,e.Z)(function*(_){if(_){const p=(yield a.getCateringForZone(_.id)).map(s=>new D.U(s));a._currency.next(a._settings.get("app.currency")||_.currency||"USD"),a._menu.next(p)}});return function(_){return f.apply(this,arguments)}}()))}manageCateringOrder(c){var m=this;return(0,e.Z)(function*(){const M=m._dialog.open(E.W,{data:{code:m._currency.getValue(),order:c,menu:m.menu,loading:m.loading,getCateringConfig:f=>m.getCateringConfig(f),selectOptions:f=>m.selectOptions(f)}}),a=yield Promise.race([M.componentInstance.event.pipe((0,P.P)(f=>"done"===f.reason)).toPromise(),M.afterClosed().toPromise()]);return M.close(),a?.metadata?.order||c})()}addItem(c=new D.U){var m=this;return(0,e.Z)(function*(){const M=m._dialog.open(b.w,{data:{item:c,categories:m.categories}}),a=yield Promise.race([M.componentInstance.event.pipe((0,P.P)(p=>"done"===p.reason)).toPromise(),M.afterClosed().toPromise()]);if("done"!==a?.reason)return;const f=m._menu.getValue(),_=f.findIndex(p=>p.id===c.id);_>=0?f.splice(_,1,a.metadata.item):f.push(a.metadata.item),m.updateMenu(m._org.building.id,f).then(()=>{m._menu.next([...f]),M.close()},()=>M.componentInstance.loading=!1)})()}updateItem(c){const m=this._menu.getValue(),M=m.findIndex(a=>a.id===c.id);M>=0?m.splice(M,1,c):m.push(c),this.updateMenu(this._org.building.id,m).then(()=>this._menu.next([...m]))}addOption(c,m={}){var M=this;return(0,e.Z)(function*(){const a=(0,A.Tw)(c.options.map(d=>d.group)),f=M._dialog.open(U.M,{data:{parent:c,option:m,types:a}}),_=yield Promise.race([f.componentInstance.event.pipe((0,P.P)(d=>"done"===d.reason)).toPromise(),f.afterClosed().toPromise()]);if("done"!==_?.reason)return;const p=M._menu.getValue(),s=p.findIndex(d=>d.id===c.id);s>=0?p.splice(s,1,_.metadata.item):p.push(_.metadata.item),M.updateMenu(M._org.building.id,p).then(()=>{M._menu.next([...p]),f.close()},()=>f.componentInstance.loading=!1)})()}selectOptions(c){var m=this;return(0,e.Z)(function*(){const M=m._dialog.open(l.R,{data:{code:m._currency.getValue(),options:c}}),a=yield Promise.race([M.componentInstance.event.pipe((0,P.P)(f=>"done"===f.reason)).toPromise(),M.afterClosed().toPromise()]);return"done"!==a?.reason?[]:(M.close(),a.metadata.options)})()}deleteItem(c){var m=this;return(0,e.Z)(function*(){const M=yield(0,A._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${c.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},m._dialog);if("done"!==M.reason)return;M.loading("Removing catering item...");const a=m._menu.getValue().filter(f=>c.id!==f.id);m.updateMenu(m._org.building.id,a).then(()=>{m._menu.next([...a]),M.close()},()=>M.loading(""))})()}deleteOption(c,m){var M=this;return(0,e.Z)(function*(){const a=yield(0,A._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${m.name}" from "${c.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},M._dialog);if("done"!==a.reason)return;a.loading("Removing catering item option...");const f=M._menu.getValue();f.splice(f.findIndex(_=>_.id===c.id),1,new D.U({...c,options:c.options.filter(_=>_.id!==m.id)})),M.updateMenu(M._org.building.id,f).then(()=>{M._menu.next([...f]),a.close()},()=>a.loading(""))})()}editConfig(){var c=this;return(0,e.Z)(function*(){const m=yield c.getCateringConfig(c._org.building.id),{require_notes:M}=yield c.settings.pipe((0,h.q)(1)).toPromise(),a=c._menu.getValue(),f=(0,A.Tw)((0,A.xH)(a.map(s=>[s.category,...s.tags]))),_=c._dialog.open(v.uX,{data:{config:m,types:f,require_notes:M,saveNotes:s=>c.saveSettings({require_notes:s})}}),p=yield Promise.race([_.componentInstance.event.pipe((0,P.P)(s=>"done"===s.reason)).toPromise(),_.afterClosed().toPromise()]);"done"===p?.reason&&c.updateConfig(c._org.building.id,p.metadata).then(()=>_.close(),()=>_.componentInstance.loading=!1)})()}importMenu(){var c=this;return(0,e.Z)(function*(){const m=c._dialog.open(x.m),M=yield Promise.race([m.componentInstance.event.pipe((0,P.P)(p=>"done"===p.reason)).toPromise(),m.afterClosed().toPromise()]);if("done"!==M?.reason)return;m.componentInstance.loading="Updating menu...";const a=c._menu.getValue(),f=c._org.building,_=(0,A.Tw)(M.metadata.concat(a),"id");yield c.updateMenu(f.id,_).catch(p=>{throw(0,A.cB)("Error importing catering menu"),m.close(),p}),(0,A.t5)(`Successfully imported catering menu. ${M.metadata.length} item(s) added.`),m.close()})()}updateMenu(c,m){return(0,t.Ymr)(c,{id:c,name:"catering",details:m,description:`Catering menu for ${c}`}).toPromise()}saveSettings(c){var m=this;return(0,e.Z)(function*(){const M=yield m.settings.pipe((0,h.q)(1)).toPromise(),a=yield(0,t.Ymr)(m._org.building.id,{id:m._org.building.id,name:"catering-settings",details:{...M,...c},description:`Catering settings for ${m._org.building.id}`}).toPromise();return m._change.next(Date.now()),a})()}getCateringForZone(c){return(0,e.Z)(function*(){const m=(yield(0,t.rlq)(c,"catering").toPromise()).details;return m instanceof Array?m:[]})()}getCateringConfig(c=this._org.building.id){return(0,e.Z)(function*(){const m=(yield(0,t.rlq)(c,"catering_config").toPromise()).details;return m instanceof Array?m:[]})()}updateConfig(c,m){return(0,t.Ymr)(c,{id:c,name:"catering_config",details:m,description:`Catering menu config for ${c}`}).toPromise()}addItemToOrder(c,m){let M=c.items;const a=M.find(_=>_.id===m.id&&m.options?.length===_.options?.reduce((p,s)=>p+(m.options.find(d=>s.id===d.id)?1:0),0));return a?a.quantity+=1:M=M.concat([new D.U({...m,quantity:1})]),new g.G({...c,items:M,event:null})}static#t=this.\u0275fac=function(m){return new(m||N)(r.LFG(T.w7),r.LFG(C.uw),r.LFG(A.gb))};static#e=this.\u0275prov=r.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"})}return N})()},9815:(S,J,n)=>{n.d(J,{U:()=>e});const e=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map