(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([["default-libs_catering_src_index_ts"],{5510:(t,e,n)=>{"use strict";n.d(e,{Ud:()=>h.U,GX:()=>Z.G,Ii:()=>_.I,jW:()=>v.j,uy:()=>f});var i=n(1511),o=n(6073),r=n(84),s=n(9236),a=n(4608),c=n(8055),l=n(5109),d=n(4810),u=n(1950),g=n(9604),m=(n(3946),n(8270),n(3045),n(2552),n(2002),n(5478),n(4135),n(5513),n(5986),n(4894),n(6828)),p=n(2619);let f=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({providers:[],imports:[[i.ez,c.Tx,l.Nh,r.Bb,a.Is,s.p9,d.Fk,m.AV,o.u5,o.UX,u.Kk,g.W9]]}),t})();var h=n(3016),Z=n(7968),_=n(3025),v=n(8958);n(8362),n(3673)},3946:(t,e,n)=>{"use strict";n.d(e,{S:()=>_});var i=n(2619),o=n(4608),r=n(8362),s=n(1511),a=n(5980),c=n(1548),l=n(6283),d=n(6756),u=n(6073),g=n(4786),m=n(1522);function p(t,e){1&t&&(i.TgZ(0,"button",5),i.TgZ(1,"app-icon"),i._uU(2,"close"),i.qZA(),i.qZA())}function f(t,e){if(1&t&&(i.TgZ(0,"mat-option",18),i._uU(1),i.qZA()),2&t){const t=e.$implicit;i.Q6J("value",t.id),i.xp6(1),i.hij(" ",t.name," ")}}function h(t,e){if(1&t&&(i.TgZ(0,"div",14),i.TgZ(1,"mat-form-field",8),i.TgZ(2,"mat-select",15),i.NdJ("ngModelChange",function(t){return e.$implicit[0]=t}),i.YNc(3,f,2,2,"mat-option",16),i.qZA(),i.qZA(),i.TgZ(4,"mat-form-field",8),i.TgZ(5,"input",17),i.NdJ("ngModelChange",function(t){return e.$implicit[1]=t}),i.qZA(),i.TgZ(6,"mat-error"),i._uU(7,"Rule value is required"),i.qZA(),i.qZA(),i.qZA()),2&t){const t=e.$implicit,n=i.oxw(2);i.xp6(2),i.Q6J("ngModel",t[0]),i.xp6(1),i.Q6J("ngForOf",n.rule_types),i.xp6(2),i.Q6J("ngModel",t[1])}}function Z(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",6),i.TgZ(1,"div",7),i.TgZ(2,"mat-form-field",8),i.TgZ(3,"input",9),i.NdJ("ngModelChange",function(t){return e.$implicit.name=t}),i.qZA(),i.TgZ(4,"mat-error"),i._uU(5,"Ruleset name is required"),i.qZA(),i.qZA(),i.TgZ(6,"button",10),i.NdJ("click",function(){const e=i.CHM(t).$implicit,n=i.oxw();return e.rules.push(["",""]),n.show_rules=e.id}),i.TgZ(7,"app-icon"),i._uU(8,"add"),i.qZA(),i.qZA(),i.TgZ(9,"button",11),i.NdJ("click",function(){const e=i.CHM(t).$implicit,n=i.oxw();return n.show_rules=n.show_rules!==e.id?e.id:""}),i.TgZ(10,"app-icon"),i._uU(11),i.qZA(),i.qZA(),i.qZA(),i.TgZ(12,"div",12),i.YNc(13,h,8,3,"div",13),i.qZA(),i.qZA()}if(2&t){const t=e.$implicit,n=i.oxw();i.xp6(3),i.Q6J("ngModel",t.name),i.xp6(6),i.Q6J("disabled",!t.rules.length),i.xp6(2),i.Oqu(n.show_rules===t.id?"expand_less":"expand_more"),i.xp6(1),i.Udp("height",(n.show_rules===t.id?3.5*t.rules.length:0)+"em"),i.xp6(1),i.Q6J("ngForOf",t.rules)}}let _=(()=>{class t{constructor(t){this._data=t,this.event=new i.vpe,this.loading=!1,this.rule_types=r.g,this.rulesets=(t.config||[]).map(t=>(t.rules=t.rules.map(t=>[t[0],JSON.stringify(t[1])]),t))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const t=this.rulesets.map(t=>Object.assign(Object.assign({},t),{rules:t.rules.map(t=>{let e=t[1];try{e=JSON.parse(t[1])}catch(n){}return[t[0],e]})}));this.event.emit({reason:"done",metadata:t})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(o.WI))},t.\u0275cmp=i.Xpm({type:t,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex px-2 h-14 space-x-2",4,"ngFor","ngForOf"],[1,"flex","px-2","h-14","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(t,e){1&t&&(i.TgZ(0,"header"),i.TgZ(1,"h3"),i._uU(2,"Edit Catering Configuration"),i.qZA(),i.YNc(3,p,3,0,"button",0),i.qZA(),i.TgZ(4,"main",1),i.TgZ(5,"button",2),i.NdJ("click",function(){return e.rulesets.push({id:e.new_id,rules:[]})}),i._uU(6," New Ruleset "),i.qZA(),i.YNc(7,Z,14,6,"div",3),i.qZA(),i.TgZ(8,"footer",4),i.TgZ(9,"button",2),i.NdJ("click",function(){return e.saveChanges()}),i._uU(10,"Save Changes"),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.Q6J("ngIf",!e.loading),i.xp6(4),i.Q6J("ngForOf",e.rulesets))},directives:[s.O5,a.lW,s.sg,o.ZT,c.o,l.KE,d.Nt,u.Fj,u.Q7,u.JJ,u.On,l.TO,g.gD,m.ey],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}"]}),t})()},8270:(t,e,n)=>{"use strict";n.d(e,{w:()=>N});var i=n(5842),o=n(2619),r=n(6073),s=n(4608),a=n(8223),c=n(3016),l=n(1511),d=n(84),u=n(5980),g=n(1548),m=n(9236),p=n(5135),f=n(6283),h=n(6756),Z=n(33),_=n(7806),v=n(1522);function x(t,e){1&t&&(o.TgZ(0,"button",7),o.TgZ(1,"app-icon"),o._uU(2,"close"),o.qZA(),o.qZA())}function b(t,e){if(1&t&&(o.TgZ(0,"div",15),o.TgZ(1,"label",16),o._uU(2," Name"),o.TgZ(3,"span"),o._uU(4,"*"),o.qZA(),o._uU(5,": "),o.qZA(),o.TgZ(6,"mat-form-field",17),o._UZ(7,"input",18),o.TgZ(8,"mat-error"),o._uU(9,"Name is required"),o.qZA(),o.qZA(),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.ekj("error",t.form.controls.name.invalid&&t.form.controls.name.touched)}}function A(t,e){if(1&t&&(o.TgZ(0,"div",15),o.TgZ(1,"label",19),o._uU(2," Category"),o.TgZ(3,"span"),o._uU(4,"*"),o.qZA(),o._uU(5,": "),o.qZA(),o.TgZ(6,"mat-form-field",17),o._UZ(7,"input",20),o.TgZ(8,"mat-error"),o._uU(9,"Category is required"),o.qZA(),o.qZA(),o.qZA()),2&t){const t=o.oxw(2),e=o.MAs(9);o.xp6(1),o.ekj("error",t.form.controls.category.invalid&&t.form.controls.category.touched),o.xp6(6),o.Q6J("matAutocomplete",e)}}const q=function(){return{class:"material-icons",content:"close"}};function T(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"mat-chip",27),o.NdJ("removed",function(){const e=o.CHM(t).$implicit;return o.oxw(3).removeTag(e)}),o._uU(1),o._UZ(2,"app-icon",28),o.qZA()}if(2&t){const t=e.$implicit;o.Q6J("selectable",!0)("removable",!0),o.xp6(1),o.hij(" ",t," "),o.xp6(1),o.Q6J("icon",o.DdM(4,q))}}function w(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",15),o.TgZ(1,"label",21),o.SDv(2,22),o.qZA(),o.TgZ(3,"mat-form-field",17),o.TgZ(4,"mat-chip-list",23,24),o.YNc(6,T,3,5,"mat-chip",25),o.TgZ(7,"input",26),o.NdJ("matChipInputTokenEnd",function(e){return o.CHM(t),o.oxw(2).addTag(e)}),o.qZA(),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=o.MAs(5),e=o.oxw(2);o.xp6(1),o.ekj("error",e.form.controls.tags.invalid&&e.form.controls.tags.touched),o.xp6(5),o.Q6J("ngForOf",e.tag_list),o.xp6(1),o.Q6J("matChipInputFor",t)("matChipInputSeparatorKeyCodes",e.separators)("matChipInputAddOnBlur",!0)}}function y(t,e){1&t&&(o.TgZ(0,"div",15),o.TgZ(1,"label",29),o._uU(2,"Description:"),o.qZA(),o.TgZ(3,"mat-form-field",17),o._UZ(4,"textarea",30),o.qZA(),o.qZA())}function O(t,e){if(1&t&&(o.TgZ(0,"div",15),o.TgZ(1,"label",16),o._uU(2," Unit Price"),o.TgZ(3,"span"),o._uU(4,"*"),o.qZA(),o._uU(5,": "),o.qZA(),o.TgZ(6,"mat-form-field",17),o._UZ(7,"input",31),o.TgZ(8,"mat-error"),o._uU(9,"Unit Price is required"),o.qZA(),o.qZA(),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.ekj("error",t.form.controls.unit_price.invalid&&t.form.controls.unit_price.touched)}}function I(t,e){if(1&t&&(o.TgZ(0,"form",8),o.YNc(1,b,10,2,"div",9),o.YNc(2,A,10,3,"div",9),o.YNc(3,w,8,6,"div",9),o.YNc(4,y,5,0,"div",9),o.YNc(5,O,10,2,"div",9),o.TgZ(6,"div",10),o.TgZ(7,"label",11),o._uU(8,"Accept Points?"),o.qZA(),o.TgZ(9,"mat-checkbox",12),o._uU(10),o.qZA(),o.qZA(),o.TgZ(11,"div",10),o.TgZ(12,"label",13),o._uU(13,"Discount Cap"),o.qZA(),o._UZ(14,"a-counter",14),o.qZA(),o.qZA()),2&t){const t=o.oxw();let e;o.Q6J("formGroup",t.form),o.xp6(1),o.Q6J("ngIf",t.form.controls.name),o.xp6(1),o.Q6J("ngIf",t.form.controls.category),o.xp6(1),o.Q6J("ngIf",t.form.controls.tags),o.xp6(1),o.Q6J("ngIf",t.form.controls.description),o.xp6(1),o.Q6J("ngIf",t.form.controls.unit_price),o.xp6(5),o.Oqu(null!=(e=t.form.get("accept_points"))&&e.value?"No":"Yes"),o.xp6(4),o.Q6J("min",0)("max",100)("step",5)("render_fn",t.renderPercent)}}function U(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"footer",32),o.TgZ(1,"button",33),o.NdJ("click",function(){return o.CHM(t),o.oxw().saveChanges()}),o._uU(2," Save "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw();o.xp6(1),o.Q6J("disabled",!t.form.dirty)}}function C(t,e){1&t&&(o.TgZ(0,"div",34),o._UZ(1,"mat-spinner",35),o.TgZ(2,"p"),o._uU(3,"Saving catering item..."),o.qZA(),o.qZA())}function J(t,e){if(1&t&&(o.TgZ(0,"mat-option",36),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.Q6J("value",t),o.xp6(1),o.hij(" ",t," ")}}let N=(()=>{class t{constructor(t){this._data=t,this.event=new o.vpe,this.form=new r.cw({name:new r.NI(this.item.name||"",[r.kI.required]),description:new r.NI(this.item.description||""),category:new r.NI(this.item.category||"",[r.kI.required]),unit_price:new r.NI(this.item.unit_price,[r.kI.required]),tags:new r.NI(this.item.tags||[]),accept_points:new r.NI(this.item.accept_points||!1),discount_cap:new r.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[i.K5,i.OC,i.L_],console.log("Form:",this.form)}get item(){return this._data.item||new c.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(t=0){return`${t}%`}addTag(t){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const e=t.input,n=t.value,i=this.tag_list;(n||"").trim()&&(i.push(n),this.form.controls.tags.setValue(i)),e&&(e.value="")}removeTag(t){if(!this.form||!this.form.controls.tags)return;const e=this.tag_list;this.form.controls.tags.markAsDirty();const n=e.indexOf(t);n>=0&&(e.splice(n,1),this.form.controls.tags.setValue(e))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new c.U(Object.assign(Object.assign(Object.assign({},this.item),{id:this.item.id||`item-${(0,a.Iy)(99999999)}`}),this.form.value))}})}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(s.WI))},t.\u0275cmp=o.Xpm({type:t,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let t,e;return t=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,e=$localize`:@@zoneTagsPlaceholder␟8dc7c13b0c6b8ad9c770bce0ad72e14b4aef8456␟3986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],t,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",e,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(t,e){if(1&t&&(o.TgZ(0,"header"),o.TgZ(1,"h3",0),o._uU(2),o.qZA(),o.YNc(3,x,3,0,"button",1),o.qZA(),o.YNc(4,I,15,11,"form",2),o.YNc(5,U,3,1,"footer",3),o.YNc(6,C,4,0,"ng-template",null,4,o.W1O),o.TgZ(8,"mat-autocomplete",null,5),o.YNc(10,J,2,2,"mat-option",6),o.qZA()),2&t){const t=o.MAs(7);o.xp6(2),o.hij("",e.item.id?"Edit":"Add"," Item"),o.xp6(1),o.Q6J("ngIf",!e.loading),o.xp6(1),o.Q6J("ngIf",e.form&&!e.loading)("ngIfElse",t),o.xp6(1),o.Q6J("ngIf",!e.loading),o.xp6(5),o.Q6J("ngForOf",e.categories)}},directives:[s.uh,l.O5,d.XC,l.sg,u.lW,s.ZT,g.o,r._Y,r.JL,r.sg,m.oG,r.JJ,r.u,p.R,f.KE,h.Nt,r.Fj,f.TO,d.ZL,Z.qn,Z.oH,Z.HS,Z.qH,r.wV,_.$g,v.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"]}),t})()},3045:(t,e,n)=>{"use strict";n.d(e,{V:()=>m});var i=n(2619),o=n(8958),r=n(1511),s=n(8055),a=n(1548),c=n(5980);const l=["catering-menu-item",""];function d(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",5),i.TgZ(1,"div",6),i.TgZ(2,"div",7),i.TgZ(3,"div"),i._uU(4),i.qZA(),i.TgZ(5,"div",8),i._uU(6),i.qZA(),i.qZA(),i.TgZ(7,"div",9),i._uU(8),i.ALo(9,"currency"),i.ALo(10,"async"),i.qZA(),i.qZA(),i.TgZ(11,"button",10),i.TgZ(12,"app-icon"),i._uU(13,"more_vert"),i.qZA(),i.qZA(),i.TgZ(14,"button",11),i.NdJ("click",function(){i.CHM(t);const e=i.oxw();return e.show_options=!e.show_options}),i.TgZ(15,"app-icon"),i._uU(16,"expand_more"),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.oxw(),e=i.MAs(3);i.xp6(4),i.Oqu(t.item.name),i.xp6(2),i.hij(" ",t.item.category," "),i.xp6(2),i.hij(" ",i.xi3(9,5,t.item.unit_price/100,i.lcZ(10,8,t.symbol))," "),i.xp6(3),i.Q6J("matMenuTriggerFor",e),i.xp6(3),i.Q6J("disabled",!t.item.options.length)}}function u(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",14),i.TgZ(1,"div",15),i.TgZ(2,"div",16),i._uU(3),i.qZA(),i.TgZ(4,"div",8),i._uU(5),i.qZA(),i.qZA(),i.TgZ(6,"button",17),i.NdJ("click",function(){const e=i.CHM(t).$implicit;return i.oxw(2).editOption(e)}),i.TgZ(7,"app-icon"),i._uU(8,"edit"),i.qZA(),i.qZA(),i.TgZ(9,"button",18),i.NdJ("click",function(){const e=i.CHM(t).$implicit;return i.oxw(2).removeOption(e)}),i.TgZ(10,"app-icon"),i._uU(11,"delete"),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=e.$implicit;i.xp6(3),i.Oqu(t.name),i.xp6(2),i.Oqu(t.group)}}function g(t,e){if(1&t&&(i.TgZ(0,"div",12),i.YNc(1,u,12,2,"div",13),i.qZA()),2&t){const t=i.oxw();i.Udp("height",t.show_options?3.5*t.item.options.length+"rem":"0"),i.xp6(1),i.Q6J("ngForOf",t.item.options)}}let m=(()=>{class t{constructor(t){this._catering=t,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=t=>this._catering.addOption(this.item,t),this.removeOption=t=>this._catering.deleteOption(this.item,t),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}get symbol(){return this._catering.currency}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(o.j))},t.\u0275cmp=i.Xpm({type:t,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:l,decls:19,vars:2,consts:[["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-gray-100 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","text-dark-fade"],[1,"p-2","m-2","text-xs","font-bold","text-white","rounded","bg-primary"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-icon-button","",3,"disabled","click"],["options","",1,"bg-gray-100","overflow-hidden"],["class","flex p-2 items-center border-none border-t border-solid border-gray-300",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-none","border-t","border-solid","border-gray-300"],[1,"flex-1","px-2"],[1,"text"],["edit","","mat-icon-button","",1,"mx-2",3,"click"],["remove","","mat-icon-button","",1,"mx-2",3,"click"]],template:function(t,e){1&t&&(i.YNc(0,d,17,10,"div",0),i.YNc(1,g,2,3,"div",1),i.TgZ(2,"mat-menu",null,2),i.TgZ(4,"button",3),i.NdJ("click",function(){return e.addOption()}),i.TgZ(5,"app-icon"),i._uU(6,"add"),i.qZA(),i.TgZ(7,"div",4),i._uU(8,"Add Option"),i.qZA(),i.qZA(),i.TgZ(9,"button",3),i.NdJ("click",function(){return e.editItem()}),i.TgZ(10,"app-icon"),i._uU(11,"edit"),i.qZA(),i.TgZ(12,"div",4),i._uU(13,"Edit Item"),i.qZA(),i.qZA(),i.TgZ(14,"button",3),i.NdJ("click",function(){return e.removeItem()}),i.TgZ(15,"app-icon"),i._uU(16,"delete"),i.qZA(),i.TgZ(17,"div",4),i._uU(18,"Remove Item"),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.Q6J("ngIf",e.item),i.xp6(1),i.Q6J("ngIf",e.item))},directives:[r.O5,s.VK,s.OP,a.o,c.lW,s.p6,r.sg],pipes:[r.H9,r.Ov],styles:["[_nghost-%COMP%]{background-color:#fff;border:1px solid #ccc;border-radius:.25rem;overflow:hidden;width:768px;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}"]}),t})()},2552:(t,e,n)=>{"use strict";n.d(e,{B:()=>h});var i=n(8512),o=n(9996),r=n(2619),s=n(8958),a=n(5109),c=n(1511),l=n(3045),d=n(1548);function u(t,e){if(1&t&&(r.ynx(0),r._UZ(1,"div",6),r.BQk()),2&t){const t=e.$implicit;r.xp6(1),r.Q6J("item",t)}}function g(t,e){if(1&t&&(r.ynx(0),r.YNc(1,u,2,1,"ng-container",5),r.ALo(2,"async"),r.BQk()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,t.menu))}}function m(t,e){if(1&t&&(r.ynx(0),r._UZ(1,"div",6),r.BQk()),2&t){const t=e.$implicit;r.xp6(1),r.Q6J("item",t)}}function p(t,e){if(1&t&&(r.TgZ(0,"mat-tab",7),r.YNc(1,m,2,1,"ng-container",5),r.ALo(2,"async"),r.qZA()),2&t){const t=e.$implicit,n=r.oxw();r.Q6J("label",t),r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,2,n.tab_menu)[t])}}function f(t,e){1&t&&(r.TgZ(0,"div",8),r.TgZ(1,"app-icon"),r._uU(2,"close"),r.qZA(),r.TgZ(3,"p"),r._uU(4,"No items in menu"),r.qZA(),r.qZA())}let h=(()=>{class t{constructor(t){this._catering=t,this.menu=this._catering.menu,this.shown_tab=new i.X(""),this.tab_menu=this.menu.pipe((0,o.U)(t=>{const e={};for(const n of this.categories)e[n]=t.filter(t=>t.category===n);return e}))}get categories(){return this._catering.categories}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(s.j))},t.\u0275cmp=r.Xpm({type:t,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(t,e){if(1&t&&(r.TgZ(0,"mat-tab-group",0),r.NdJ("selectedIndexChange",function(t){return e.shown_tab.next(0===t?"":e.categories[t-1])}),r.TgZ(1,"mat-tab",1),r.YNc(2,g,3,3,"ng-container",2),r.ALo(3,"async"),r.qZA(),r.YNc(4,p,3,4,"mat-tab",3),r.qZA(),r.YNc(5,f,5,0,"ng-template",null,4,r.W1O)),2&t){const t=r.MAs(6);let n;r.xp6(2),r.Q6J("ngIf",null==(n=r.lcZ(3,3,e.menu))?null:n.length)("ngIfElse",t),r.xp6(2),r.Q6J("ngForOf",e.categories)}},directives:[a.SP,a.uX,c.O5,c.sg,l.V,d.o],pipes:[c.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}"]}),t})()},2002:(t,e,n)=>{"use strict";n.d(e,{M:()=>y});var i=n(2619),o=n(6073),r=n(4608),s=n(7276),a=n(3016),c=n(1511),l=n(84),d=n(5980),u=n(1548),g=n(6283),m=n(6756),p=n(9236),f=n(7806),h=n(1522);function Z(t,e){1&t&&(i.TgZ(0,"button",7),i.TgZ(1,"app-icon"),i._uU(2,"close"),i.qZA(),i.qZA())}function _(t,e){if(1&t&&(i.TgZ(0,"div",10),i.TgZ(1,"label",11),i._uU(2," Name"),i.TgZ(3,"span"),i._uU(4,"*"),i.qZA(),i._uU(5,": "),i.qZA(),i.TgZ(6,"mat-form-field",12),i._UZ(7,"input",13),i.TgZ(8,"mat-error"),i._uU(9,"Name is required"),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.xp6(1),i.ekj("error",t.form.controls.name.invalid&&t.form.controls.name.touched)}}function v(t,e){if(1&t&&(i.TgZ(0,"div",10),i.TgZ(1,"label",14),i._uU(2," Type"),i.TgZ(3,"span"),i._uU(4,"*"),i.qZA(),i._uU(5,": "),i.qZA(),i.TgZ(6,"mat-form-field",12),i._UZ(7,"input",15),i.TgZ(8,"mat-error"),i._uU(9,"Type is required"),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw(2),e=i.MAs(9);i.xp6(1),i.ekj("error",t.form.controls.group.invalid&&t.form.controls.group.touched),i.xp6(6),i.Q6J("matAutocomplete",e)}}function x(t,e){1&t&&(i.TgZ(0,"div",10),i.TgZ(1,"label",11),i._uU(2,"Unit Price:"),i.qZA(),i.TgZ(3,"mat-form-field",12),i._UZ(4,"input",16),i.qZA(),i.qZA())}function b(t,e){1&t&&(i.TgZ(0,"div",10),i.TgZ(1,"mat-checkbox",17),i._uU(2," Can select multiple of type "),i.qZA(),i.qZA())}function A(t,e){if(1&t&&(i.TgZ(0,"form",8),i.YNc(1,_,10,2,"div",9),i.YNc(2,v,10,3,"div",9),i.YNc(3,x,5,0,"div",9),i.YNc(4,b,3,0,"div",9),i.qZA()),2&t){const t=i.oxw();i.Q6J("formGroup",t.form),i.xp6(1),i.Q6J("ngIf",t.form.controls.name),i.xp6(1),i.Q6J("ngIf",t.form.controls.group),i.xp6(1),i.Q6J("ngIf",t.form.controls.unit_price),i.xp6(1),i.Q6J("ngIf",t.form.controls.multiple)}}function q(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"footer",18),i.TgZ(1,"button",19),i.NdJ("click",function(){return i.CHM(t),i.oxw().saveChanges()}),i._uU(2," Save "),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(1),i.Q6J("disabled",!t.form.dirty)}}function T(t,e){1&t&&(i.TgZ(0,"div",20),i._UZ(1,"mat-spinner",21),i.TgZ(2,"p"),i._uU(3,"Saving catering item option..."),i.qZA(),i.qZA())}function w(t,e){if(1&t&&(i.TgZ(0,"mat-option",22),i._uU(1),i.qZA()),2&t){const t=e.$implicit;i.Q6J("value",t),i.xp6(1),i.hij(" ",t," ")}}let y=(()=>{class t{constructor(t){this._data=t,this.event=new i.vpe,this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}ngOnInit(){this.form=new o.cw({name:new o.NI(this.option.name||"",[o.kI.required]),group:new o.NI(this.option.group||"",[o.kI.required]),unit_price:new o.NI(this.option.unit_price),multiple:new o.NI(!!this.option.multiple,[])})}saveChanges(){this.loading=!0;const t=Object.assign(Object.assign(Object.assign({},this.option),{id:this.option.id||`option-${(0,s.Iy)(99999999)}`}),this.form.value);this.event.emit({reason:"done",metadata:{item:new a.U(Object.assign(Object.assign({},this._data.parent),{options:this._data.parent.options.filter(e=>e.id!==t.id).concat([t])}))}})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(r.WI))},t.\u0275cmp=i.Xpm({type:t,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-none border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(t,e){if(1&t&&(i.TgZ(0,"header"),i.TgZ(1,"h3",0),i._uU(2),i.qZA(),i.YNc(3,Z,3,0,"button",1),i.qZA(),i.YNc(4,A,5,5,"form",2),i.YNc(5,q,3,1,"footer",3),i.YNc(6,T,4,0,"ng-template",null,4,i.W1O),i.TgZ(8,"mat-autocomplete",null,5),i.YNc(10,w,2,2,"mat-option",6),i.qZA()),2&t){const t=i.MAs(7);i.xp6(2),i.hij(" ",e.option.id?"Edit":"Add"," Item Option "),i.xp6(1),i.Q6J("ngIf",!e.loading),i.xp6(1),i.Q6J("ngIf",e.form&&!e.loading)("ngIfElse",t),i.xp6(1),i.Q6J("ngIf",!e.loading),i.xp6(5),i.Q6J("ngForOf",e.types)}},directives:[r.uh,c.O5,l.XC,c.sg,d.lW,r.ZT,u.o,o._Y,o.JL,o.sg,g.KE,m.Nt,o.Fj,o.JJ,o.u,g.TO,l.ZL,o.wV,p.oG,f.$g,h.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"]}),t})()},5478:(t,e,n)=>{"use strict";n.d(e,{m:()=>a});var i=n(2619),o=n(5980),r=n(1548);const s=["catering-order-item",""];let a=(()=>{class t{constructor(){this.active=!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["","catering-order-item",""]],inputs:{item:"item"},attrs:s,decls:8,vars:8,consts:[[1,"w-20","text-right"],["name","item-bar",1,"bg-gray-300"],[1,"w-12","mr-4"],["mat-icon-button","",1,"border","border-gray-300","border-dashed","text-2xl","text-dark-fade"],[1,"flex-1","border-b","border-gray-300","border-solid","py-4"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i._UZ(1,"div",1),i.qZA(),i.TgZ(2,"div",2),i.TgZ(3,"button",3),i.TgZ(4,"app-icon"),i._uU(5),i.qZA(),i.qZA(),i.qZA(),i.TgZ(6,"div",4),i._uU(7),i.qZA()),2&t&&(i.xp6(3),i.ekj("bg-success",e.active)("text-white",e.active)("border-solid",e.active),i.xp6(2),i.Oqu(e.active?"done":"local_pizza"),i.xp6(2),i.hij(" ",null==e.item?null:e.item.name," "))},directives:[o.lW,r.o],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}[name=item-bar][_ngcontent-%COMP%]{height:2px;margin-left:auto;margin-right:1rem;width:calc(50% - .9375rem)}"]}),t})()},4135:(t,e,n)=>{"use strict";n.d(e,{I:()=>d});var i=n(2619),o=n(3025),r=n(1511),s=n(4894);function a(t,e){if(1&t&&(i.TgZ(0,"li",12),i._UZ(1,"catering-order",13),i.qZA()),2&t){const t=e.$implicit;i.xp6(1),i.Q6J("order",t)}}function c(t,e){1&t&&(i.TgZ(0,"div",14),i.TgZ(1,"p"),i._uU(2,"No Catering Orders"),i.qZA(),i.qZA())}function l(t,e){1&t&&i._UZ(0,"mat-progress-bar",15)}let d=(()=>{class t{constructor(t){this._orders=t,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(t,e){return e?e.id:void 0}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(o.I))},t.\u0275cmp=i.Xpm({type:t,selectors:[["catering-order-list"]],decls:22,vars:10,consts:[[1,"w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-gray-300","bg-white"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-gray-300",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block text-dark-fade",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-gray-300"],[3,"order"],["empty","",1,"info-block","text-dark-fade"],["mode","indeterminate",1,"w-full"]],template:function(t,e){if(1&t&&(i.TgZ(0,"div",0),i._UZ(1,"div",1),i.TgZ(2,"div",2),i._uU(3,"Time"),i.qZA(),i.TgZ(4,"div",3),i._uU(5,"Location"),i.qZA(),i.TgZ(6,"div",4),i._uU(7,"Host"),i.qZA(),i.TgZ(8,"div",2),i._uU(9,"Charge Code"),i.qZA(),i.TgZ(10,"div",5),i._uU(11,"Invoice No."),i.qZA(),i.TgZ(12,"div",6),i._uU(13,"Status"),i.qZA(),i._UZ(14,"div",7),i.qZA(),i.TgZ(15,"ul",8),i.YNc(16,a,2,1,"li",9),i.ALo(17,"async"),i.YNc(18,c,3,0,"div",10),i.ALo(19,"async"),i.qZA(),i.YNc(20,l,1,0,"mat-progress-bar",11),i.ALo(21,"async")),2&t){let t;i.xp6(16),i.Q6J("ngForOf",i.lcZ(17,4,e.order_list))("ngForTrackBy",e.trackByFn),i.xp6(2),i.Q6J("ngIf",!(null!=(t=i.lcZ(19,6,e.order_list))&&t.length)),i.xp6(2),i.Q6J("ngIf",i.lcZ(21,8,e.loading))}},directives:[r.sg,r.O5,s.p],pipes:[r.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}"]}),t})()},5513:(t,e,n)=>{"use strict";n.d(e,{W:()=>Y});var i=n(4762),o=n(2619),r=n(4608),s=n(8774),a=n(847),c=n(9310),l=n(8223),d=n(391),u=n(3016),g=n(7968),m=n(1511),p=n(5109),f=n(5135),h=n(6073),Z=n(6828),_=n(5980),v=n(1548),x=n(7806);function b(t,e){1&t&&(o.TgZ(0,"div",17),o._uU(1," Options Available "),o.qZA())}function A(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"a-counter",18),o.NdJ("ngModelChange",function(e){o.CHM(t);const n=o.oxw().$implicit;return o.oxw(5).updateItemQuantity(n,e)}),o.qZA()}if(2&t){const t=o.oxw().$implicit;o.Q6J("ngModel",t.quantity)}}function q(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",19),o.TgZ(1,"div",20),o.TgZ(2,"button",21),o.TgZ(3,"app-icon"),o._uU(4,"remove"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(5,"div",22),o._uU(6),o.qZA(),o.TgZ(7,"button",23),o.NdJ("click",function(){o.CHM(t);const e=o.oxw().$implicit;return o.oxw(5).addItem(e)}),o.TgZ(8,"app-icon"),o._uU(9,"add"),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=o.oxw().$implicit;o.xp6(1),o.Q6J("matTooltip",t.quantity?"Items with options must be removed from order confirmation page":""),o.xp6(1),o.Q6J("disabled",!0),o.xp6(4),o.hij(" ",t.quantity," ")}}function T(t,e){if(1&t&&(o.TgZ(0,"div",11),o.TgZ(1,"div",12),o.TgZ(2,"div",12),o._uU(3),o.qZA(),o.YNc(4,b,2,0,"div",13),o.qZA(),o.TgZ(5,"div",14),o._uU(6),o.ALo(7,"currency"),o.qZA(),o.YNc(8,A,1,1,"a-counter",15),o.YNc(9,q,10,3,"div",16),o.qZA()),2&t){const t=e.$implicit;o.xp6(3),o.hij(" ",t.name," "),o.xp6(1),o.Q6J("ngIf",t.options.length),o.xp6(2),o.hij(" ",o.lcZ(7,5,t.unit_price/100)," "),o.xp6(2),o.Q6J("ngIf",!t.options.length),o.xp6(1),o.Q6J("ngIf",t.options.length)}}const w=function(){return{}};function y(t,e){if(1&t&&(o.TgZ(0,"mat-tab",8),o.TgZ(1,"div",9),o.YNc(2,T,10,7,"div",10),o.qZA(),o.qZA()),2&t){const t=o.oxw().$implicit,e=o.oxw(3);o.Q6J("label",t),o.xp6(2),o.Q6J("ngForOf",(e.menu_items||o.DdM(2,w))[t])}}function O(t,e){if(1&t&&(o.ynx(0),o.YNc(1,y,3,3,"mat-tab",7),o.BQk()),2&t){const t=e.$implicit,n=o.oxw(3);o.xp6(1),o.Q6J("ngIf",(n.menu_items||o.DdM(1,w))[t].length)}}function I(t,e){if(1&t&&(o.ynx(0),o.TgZ(1,"mat-tab-group"),o.YNc(2,O,2,2,"ng-container",6),o.qZA(),o.BQk()),2&t){const t=o.oxw(2);o.xp6(2),o.Q6J("ngForOf",t.categories)}}function U(t,e){if(1&t&&(o.TgZ(0,"div",4),o.YNc(1,I,3,1,"ng-container",5),o.qZA()),2&t){const t=o.oxw(),e=o.MAs(5);o.xp6(1),o.Q6J("ngIf",!t.show_order_details)("ngIfElse",e)}}function C(t,e){if(1&t){const t=o.EpF();o.ynx(0),o.TgZ(1,"button",26),o._uU(2," Cancel "),o.qZA(),o.TgZ(3,"button",27),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).show_order_details=!0}),o._uU(4," Confirm "),o.qZA(),o.BQk()}if(2&t){const t=o.oxw(2);o.xp6(3),o.Q6J("disabled",!t.order.item_count)("matBadge",t.order.item_count)("matBadgeHidden",!t.order.item_count)}}function J(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"button",28),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).show_order_details=!1}),o._uU(1," Back "),o.qZA(),o.TgZ(2,"button",29),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).saveOrder()}),o._uU(3," Save Order "),o.qZA()}}function N(t,e){if(1&t&&(o.TgZ(0,"footer",24),o.YNc(1,C,5,3,"ng-container",5),o.YNc(2,J,4,0,"ng-template",null,25,o.W1O),o.qZA()),2&t){const t=o.MAs(3),e=o.oxw();o.xp6(1),o.Q6J("ngIf",!e.show_order_details)("ngIfElse",t)}}function M(t,e){if(1&t&&(o.TgZ(0,"div",30),o._UZ(1,"mat-spinner",31),o.TgZ(2,"p"),o._uU(3),o.qZA(),o.qZA()),2&t){const t=o.oxw();o.xp6(3),o.Oqu(t.loading)}}function Q(t,e){if(1&t&&(o.TgZ(0,"div",37),o._uU(1),o.qZA()),2&t){const t=o.oxw().$implicit,e=o.oxw(2);o.Q6J("matTooltip",e.optionsFor(t)),o.xp6(1),o.AsE(" ",t.options.length," option",1===t.options.length?"":"s"," selected ")}}function k(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",34),o.TgZ(1,"div",12),o.TgZ(2,"div",12),o._uU(3),o.qZA(),o.YNc(4,Q,2,3,"div",35),o.qZA(),o.TgZ(5,"div",14),o._uU(6),o.ALo(7,"currency"),o.qZA(),o.TgZ(8,"a-counter",36),o.NdJ("ngModelChange",function(e){const n=o.CHM(t).$implicit;return o.oxw(2).updateItemQuantity(n,e)}),o.qZA(),o.qZA()}if(2&t){const t=e.$implicit;o.xp6(3),o.Oqu(t.name),o.xp6(1),o.Q6J("ngIf",t.options.length),o.xp6(2),o.hij(" ",o.lcZ(7,4,t.total_cost/100)," "),o.xp6(2),o.Q6J("ngModel",t.quantity)}}function F(t,e){if(1&t&&(o.TgZ(0,"header",32),o.TgZ(1,"h3"),o._uU(2,"Confirm Order"),o.qZA(),o.qZA(),o.TgZ(3,"div",9),o.YNc(4,k,9,6,"div",33),o.qZA()),2&t){const t=o.oxw();o.xp6(4),o.Q6J("ngForOf",t.order.items)}}function j(t,e,n){var i;let o=!0;for(const r of e)if(t.category===r.name||t.tags.includes(r.name)||(null===(i=n.space)||void 0===i?void 0:i.zones.includes(r.name))||"*"===r.name){let t=0;for(const e of r.rules){const i=new Date(n.date);switch(e[0]){case"after_hour":t+=(0,s.Z)(i,(0,a.Z)(i,e[1]))?1:0;break;case"before_hour":t+=(0,c.Z)(i,(0,a.Z)(i,e[1]))?1:0;break;case"min_length":t+=n.duration>=(0,d.H1)(e[1])?1:0;break;case"max_length":t+=n.duration<=(0,d.H1)(e[1])?1:0;break;case"visitor_type":t+=n.ext("visitor_type")===e[1]?1:0;break;default:t++}}o=t>=r.rules.length}return o}let Y=(()=>{class t extends l.KG{constructor(t){super(),this._data=t,this.event=new o.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var t,e,n;return(0,i.mG)(this,void 0,void 0,function*(){this.loading="Loading menu...",this.order=new g.G(this._data.order),this.rules=yield this._data.getCateringConfig(null===(n=null===(e=null===(t=this.order.event)||void 0===t?void 0:t.space)||void 0===e?void 0:e.level)||void 0===n?void 0:n.parent_id),this._data.menu.subscribe(t=>{this.loading="Loading menu...";const e=(0,l.Tw)(t.map(t=>t.category)),n={};for(const i of e)n[i]=t.filter(t=>t.category===i&&j(t,this.rules,this.order.event));this.categories=e,this.menu_items=n,this.updateMenuQuantities(),this.timeout("clear_loading",()=>this.loading="",1e3)})})}addItem(t,e=!0){var n;const i=this.order.items.find(e=>e.id===t.id&&e.options.length===e.options.reduce((e,n)=>e+(t.options.find(t=>n.id===t.id)?1:0),0));e&&(null===(n=t.options)||void 0===n?void 0:n.length)?this._data.selectOptions(t.options).then(e=>{const n=new u.U(Object.assign(Object.assign({},t),{options:e}));this.addItem(n,!1)}):this.order=new g.G(Object.assign(Object.assign({},this.order),i?{items:this.order.items.filter(e=>!(e.id===t.id&&e.options_string===t.options_string)).concat([new u.U(Object.assign(Object.assign({},t),{quantity:i.quantity+1}))])}:{items:this.order.items.concat([new u.U(Object.assign(Object.assign({},t),{quantity:1}))])})),this.updateMenuQuantities()}removeItem(t){this.order=new g.G(Object.assign(Object.assign({},this.order),{items:this.order.items.filter(e=>e.id!==t.id&&e.options_string===t.options_string)})),this.updateMenuQuantities()}updateItemQuantity(t,e){const n=this.order.items.find(e=>e.id===t.id&&e.options_string===t.options_string);let i=[...this.order.items];i=n?this.order.items.filter(e=>!(e.id===t.id&&e.options_string===t.options_string)).concat([new u.U(Object.assign(Object.assign({},t),{quantity:e}))]):this.order.items.concat([new u.U(Object.assign(Object.assign({},t),{quantity:e}))]),i.sort((t,e)=>t.name.localeCompare(e.name)),this.order=new g.G(Object.assign(Object.assign({},this.order),{items:i})),this.updateMenuQuantities()}updateMenuQuantities(){for(const t in this.menu_items)for(const e of this.menu_items[t])e.quantity=this.order.items.reduce((t,n)=>n.id===e.id?t+n.quantity:t,0)}optionsFor(t){return t.options.map(t=>t.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(r.WI))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[o.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(t,e){if(1&t&&(o.YNc(0,U,2,2,"div",0),o.YNc(1,N,4,2,"footer",1),o.YNc(2,M,4,1,"ng-template",null,2,o.W1O),o.YNc(4,F,5,1,"ng-template",null,3,o.W1O)),2&t){const t=o.MAs(3);o.Q6J("ngIf",!e.loading)("ngIfElse",t),o.xp6(1),o.Q6J("ngIf",!e.loading)}},directives:[m.O5,p.SP,m.sg,p.uX,f.R,h.Fj,h.JJ,h.On,Z.gM,_.lW,v.o,r.ZT,x.$g],pipes:[m.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border-radius:0!important;border:1px solid #ccc;border-right:none;border-left:none;outline:none;font-size:1em;&:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}&.error::placeholder{color:rgba(var(--error),.45)}}"]}),t})()},5986:(t,e,n)=>{"use strict";n.d(e,{R:()=>v});var i=n(2619),o=n(4608),r=n(7276),s=n(5980),a=n(1548),c=n(1511),l=n(4810),d=n(6073),u=n(9236);function g(t,e){if(1&t&&(i.TgZ(0,"div",18),i._uU(1),i.ALo(2,"currency"),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(1),i.hij(" +",i.lcZ(2,1,t.unit_price/100)," ")}}function m(t,e){if(1&t&&(i.TgZ(0,"mat-radio-button",14),i.TgZ(1,"div",15),i.TgZ(2,"div",16),i._uU(3),i.qZA(),i.YNc(4,g,3,3,"div",17),i.qZA(),i.qZA()),2&t){const t=e.$implicit;i.Q6J("value",t.id),i.xp6(3),i.hij(" ",t.name," "),i.xp6(1),i.Q6J("ngIf",t.unit_price)}}function p(t,e){if(1&t){const t=i.EpF();i.ynx(0),i.TgZ(1,"mat-radio-group",10),i.NdJ("ngModelChange",function(e){i.CHM(t);const n=i.oxw().$implicit;return i.oxw().updateGroupOption(n,e)}),i.TgZ(2,"mat-radio-button",11),i.TgZ(3,"span",12),i._uU(4,"None"),i.qZA(),i.qZA(),i.YNc(5,m,5,3,"mat-radio-button",13),i.qZA(),i.BQk()}if(2&t){const t=i.oxw().$implicit;i.xp6(5),i.Q6J("ngForOf",null==t?null:t.options)}}function f(t,e){if(1&t&&(i.TgZ(0,"div",18),i._uU(1),i.ALo(2,"currency"),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(1),i.hij(" +",i.lcZ(2,1,t.unit_price/100)," ")}}function h(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"mat-checkbox",20),i.NdJ("ngModelChange",function(e){const n=i.CHM(t).$implicit;return i.oxw(3).option_state[n.id]=e}),i.TgZ(1,"div",15),i.TgZ(2,"div",16),i._uU(3),i.qZA(),i.YNc(4,f,3,3,"div",17),i.qZA(),i.qZA()}if(2&t){const t=e.$implicit,n=i.oxw(3);i.Q6J("ngModel",n.option_state[t.id]),i.xp6(3),i.hij(" ",t.name," "),i.xp6(1),i.Q6J("ngIf",t.unit_price)}}function Z(t,e){if(1&t&&i.YNc(0,h,5,3,"mat-checkbox",19),2&t){const t=i.oxw().$implicit;i.Q6J("ngForOf",null==t?null:t.options)}}function _(t,e){if(1&t&&(i.TgZ(0,"div",5),i.TgZ(1,"div",6),i._uU(2),i.qZA(),i.TgZ(3,"div",7),i.YNc(4,p,6,1,"ng-container",8),i.YNc(5,Z,1,1,"ng-template",null,9,i.W1O),i.qZA(),i.qZA()),2&t){const t=e.$implicit,n=i.MAs(6);i.uIk("group",t.name),i.xp6(2),i.Oqu(t.name),i.xp6(2),i.Q6J("ngIf",!t.multiple)("ngIfElse",n)}}let v=(()=>{class t{constructor(t){this._data=t,this.event=new i.vpe,this.option_state={};const e=(0,r.Tw)(this._data.options.map(t=>t.group||"Other")),n=[];for(const i of e){const t=this._data.options.filter(t=>t.group===i);n.push({name:i,multiple:!!t.find(t=>t.multiple),options:t})}this.groups=n}updateGroupOption(t,e){for(const n of t.options)this.option_state[n.id]=n.id===e}saveOptions(){const t=this._data.options.filter(t=>this.option_state[t.id]);this.event.emit({reason:"done",metadata:{options:t}})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(o.WI))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(i.TgZ(0,"header"),i.TgZ(1,"h3"),i._uU(2,"Select options"),i.qZA(),i.TgZ(3,"button",0),i.TgZ(4,"app-icon"),i._uU(5,"close"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(6,"main",1),i.YNc(7,_,7,4,"div",2),i.qZA(),i.TgZ(8,"footer",3),i.TgZ(9,"button",4),i.NdJ("click",function(){return e.saveOptions()}),i._uU(10," Save "),i.qZA(),i.qZA()),2&t&&(i.xp6(7),i.Q6J("ngForOf",e.groups))},directives:[s.lW,o.ZT,a.o,c.sg,c.O5,l.VQ,d.JJ,d.On,l.U0,u.oG],pipes:[c.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}"]}),t})()},4894:(t,e,n)=>{"use strict";n.d(e,{p:()=>h});var i=n(8223),o=n(3673),r=n(2619),s=n(3025),a=n(1511),c=n(8055),l=n(1548),d=n(5980),u=n(5478);function g(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",4),r.TgZ(1,"div",5),r.TgZ(2,"div",6),r.TgZ(3,"app-icon"),r._uU(4,"room_service"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(5,"div",7),r._uU(6),r.ALo(7,"date"),r.qZA(),r.TgZ(8,"div",8),r._uU(9),r.qZA(),r.TgZ(10,"div",9),r._uU(11),r.qZA(),r.TgZ(12,"div",7),r._uU(13),r.qZA(),r.TgZ(14,"div",10),r._uU(15),r.qZA(),r.TgZ(16,"div",11),r.TgZ(17,"button",12),r.TgZ(18,"div",13),r._uU(19),r.qZA(),r.TgZ(20,"app-icon",14),r._uU(21,"arrow_drop_down"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(22,"div",15),r.TgZ(23,"button",16),r.NdJ("click",function(){r.CHM(t);const e=r.oxw();return e.show_items=!e.show_items}),r.TgZ(24,"app-icon"),r._uU(25),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&t){const t=r.oxw(),e=r.MAs(3);r.ekj("shown",t.show_items),r.xp6(6),r.Oqu(r.xi3(7,12,t.order.deliver_at,"shortTime")),r.xp6(3),r.hij(" ",(null==t.order.event?null:t.order.event.space.display_name)||(null==t.order.event?null:t.order.event.space.name)||"~ No Location ~"," "),r.xp6(2),r.hij(" ",(null==t.order.event||null==t.order.event.organiser?null:t.order.event.organiser.name)||(null==t.order.event?null:t.order.event.host)||"~ Unknown Host ~"," "),r.xp6(2),r.Oqu(t.order.charge_code||"~ No Code ~"),r.xp6(2),r.hij(" ",t.order.invoice_number||"~ No Invoice ~"," "),r.xp6(2),r.Udp("background",null==t.status?null:t.status.colour),r.Q6J("matMenuTriggerFor",e),r.xp6(2),r.hij(" ",null==t.status?null:t.status.name," "),r.xp6(6),r.Oqu(t.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function m(t,e){1&t&&r._UZ(0,"li",20),2&t&&r.Q6J("item",e.$implicit)}function p(t,e){if(1&t&&(r.TgZ(0,"ul",17),r._UZ(1,"div",18),r.YNc(2,m,1,1,"li",19),r.qZA()),2&t){const t=r.oxw();r.ekj("shown",t.show_items),r.Q6J("@show",t.show_items?"show":"hide"),r.xp6(1),r.Udp("height",3.125*t.order.items.length-1+"rem"),r.xp6(1),r.Q6J("ngForOf",t.order.items)}}function f(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",21),r.NdJ("click",function(){const e=r.CHM(t).$implicit;return r.oxw().updateStatus(e.id)}),r._UZ(1,"div",22),r.TgZ(2,"span",23),r._uU(3),r.qZA(),r.qZA()}if(2&t){const t=e.$implicit;r.xp6(1),r.Udp("background-color",t.colour),r.xp6(2),r.Oqu(t.name)}}let h=(()=>{class t{constructor(t){this._orders=t,this.show_items=!1,this.statuses=o.U,this.updateStatus=t=>this._orders.updateStatus(this.order,t)}get status(){return this.statuses.find(t=>t.id===this.order.status)}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(s.I))},t.\u0275cmp=r.Xpm({type:t,selectors:[["catering-order"]],inputs:{order:"order"},decls:5,vars:3,consts:[["class","w-full flex items-center py-2 bg-gray-100",3,"shown",4,"ngIf"],["class","list-none p-0 m-0 w-full relative",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2","bg-gray-100"],[1,"w-20","flex","items-center","justify-center"],[1,"rounded-full","bg-gray-300","p-2","text-2xl","text-dark-fade","flex","items-center","justify-center"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["mat-icon-button","",3,"click"],[1,"list-none","p-0","m-0","w-full","relative"],["name","bar",1,"absolute","top-0","bg-gray-300"],["catering-order-item","","class","flex items-center",3,"item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(t,e){1&t&&(r.YNc(0,g,26,15,"div",0),r.YNc(1,p,3,6,"ul",1),r.TgZ(2,"mat-menu",null,2),r.YNc(4,f,4,3,"button",3),r.qZA()),2&t&&(r.Q6J("ngIf",e.order),r.xp6(1),r.Q6J("ngIf",null==e.order?null:e.order.items.length),r.xp6(3),r.Q6J("ngForOf",e.statuses))},directives:[a.O5,c.VK,a.sg,l.o,c.p6,d.lW,u.m,c.OP],pipes:[a.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}.shown[_ngcontent-%COMP%]{background-color:#eee}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}"],data:{animation:[i.X7]}}),t})()},3025:(t,e,n)=>{"use strict";n.d(e,{I:()=>_});var i=n(8512),o=n(3080),r=n(7701),s=n(4689),a=n(9996),c=n(4019),l=n(8303),d=n(4914),u=n(205),g=n(8125),m=n(8223),p=n(3499),f=n(9005),h=n(7968),Z=n(2619);let _=(()=>{class t extends m.KG{constructor(){super(),this._poll=new i.X(0),this._loading=new i.X(!1),this._filters=new i.X({}),this.orders=(0,o.aj)([this._filters,this._poll]).pipe((0,r.b)(500),(0,s.w)(([t])=>{this._loading.next(!0);const e=(0,d.Z)((0,u.Z)(t.date||Date.now())),n=(0,d.Z)((0,g.Z)(t.date||Date.now()));return(0,p.u$)({zone_ids:(t.zones||[]).join(","),period_start:e,period_end:n})}),(0,a.U)(t=>(0,m.xH)(t.map(t=>t.ext("catering")))),(0,c.b)(()=>this._loading.next(!1)),(0,l.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,a.U)(t=>t.filter(t=>function(t,e){const n=(e.search||"").toLowerCase();return!!t.items.find(t=>t.name.toLowerCase().includes(n)||!!t.options.find(t=>t.name.toLowerCase().includes(n)))}(t,this._filters.getValue())))),this.subscription("changes",this.orders.subscribe())}get filters(){return this._filters.getValue()}set filters(t){this._filters.next(t)}startPolling(t=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),t)}stopPolling(){this.clearInterval("polling")}updateStatus(t,e){const n=new h.G(Object.assign(Object.assign({},t),{status:e})),i=new f.y(Object.assign(Object.assign({},t.event),{catering:[...t.event.ext("catering").filter(e=>e.id!==t.id),n].map(t=>new h.G(Object.assign({},t)))}));return(0,p.ry)(i)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Z.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},8958:(t,e,n)=>{"use strict";n.d(e,{j:()=>_});var i=n(4762),o=n(6817),r=n(8512),s=n(3530),a=n(8223),c=n(8270),l=n(2002),d=n(3946),u=n(3016),g=n(7968),m=n(5513),p=n(5986),f=n(2619),h=n(1496),Z=n(4608);let _=(()=>{class t extends a.KG{constructor(t,e){super(),this._org=t,this._dialog=e,this._menu=new r.X([]),this._loading=new r.X(!1),this._currency=new r.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(t=>(0,i.mG)(this,void 0,void 0,function*(){if(t){const e=(yield this.getCateringForZone(t.id)).map(t=>new u.U(t));this._currency.next(t.currency||"USD"),this._menu.next(e)}})))}get categories(){const t=this._menu.getValue();return(0,a.Tw)(t.map(t=>t.category))}manageCateringOrder(t){var e;return(0,i.mG)(this,void 0,void 0,function*(){const n=this._dialog.open(m.W,{data:{order:t,menu:this.menu,loading:this.loading,getCateringConfig:t=>this.getCateringConfig(t),selectOptions:t=>this.selectOptions(t)}}),i=yield Promise.race([n.componentInstance.event.pipe((0,s.P)(t=>"done"===t.reason)).toPromise(),n.afterClosed().toPromise()]);return n.close(),(null===(e=null==i?void 0:i.metadata)||void 0===e?void 0:e.order)||t})}addItem(t=new u.U){return(0,i.mG)(this,void 0,void 0,function*(){const e=this._dialog.open(c.w,{data:{item:t,categories:this.categories}}),n=yield Promise.race([e.componentInstance.event.pipe((0,s.P)(t=>"done"===t.reason)).toPromise(),e.afterClosed().toPromise()]);if("done"!==(null==n?void 0:n.reason))return;const i=this._menu.getValue(),o=i.findIndex(e=>e.id===t.id);o>=0?i.splice(o,1,n.metadata.item):i.push(n.metadata.item),this.updateMenu(this._org.building.id,i).then(()=>{this._menu.next([...i]),e.close()},()=>e.componentInstance.loading=!1)})}addOption(t,e={}){return(0,i.mG)(this,void 0,void 0,function*(){const n=(0,a.Tw)(t.options.map(t=>t.group)),i=this._dialog.open(l.M,{data:{parent:t,option:e,types:n}}),o=yield Promise.race([i.componentInstance.event.pipe((0,s.P)(t=>"done"===t.reason)).toPromise(),i.afterClosed().toPromise()]);if("done"!==(null==o?void 0:o.reason))return;const r=this._menu.getValue(),c=r.findIndex(e=>e.id===t.id);c>=0?r.splice(c,1,o.metadata.item):r.push(o.metadata.item),this.updateMenu(this._org.building.id,r).then(()=>{this._menu.next([...r]),i.close()},()=>i.componentInstance.loading=!1)})}selectOptions(t){return(0,i.mG)(this,void 0,void 0,function*(){const e=this._dialog.open(p.R,{data:{options:t}}),n=yield Promise.race([e.componentInstance.event.pipe((0,s.P)(t=>"done"===t.reason)).toPromise(),e.afterClosed().toPromise()]);return"done"!==(null==n?void 0:n.reason)?[]:(e.close(),n.metadata.options)})}deleteItem(t){return(0,i.mG)(this,void 0,void 0,function*(){const e=yield(0,a._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${t.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==e.reason)return;e.loading("Removing catering item...");const n=this._menu.getValue().filter(e=>t.id!==e.id);this.updateMenu(this._org.building.id,n).then(()=>{this._menu.next([...n]),e.close()},()=>e.loading(""))})}deleteOption(t,e){return(0,i.mG)(this,void 0,void 0,function*(){const n=yield(0,a._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${e.name}" from "${t.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==n.reason)return;n.loading("Removing catering item option...");const i=this._menu.getValue();i.splice(i.findIndex(e=>e.id===t.id),1,new u.U(Object.assign(Object.assign({},t),{options:t.options.filter(t=>t.id!==e.id)}))),this.updateMenu(this._org.building.id,i).then(()=>{this._menu.next([...i]),n.close()},()=>n.loading(""))})}editConfig(){return(0,i.mG)(this,void 0,void 0,function*(){const t=yield this.getCateringConfig(this._org.building.id),e=this._menu.getValue(),n=(0,a.Tw)((0,a.xH)(e.map(t=>[t.category,...t.tags]))),i=this._dialog.open(d.S,{data:{config:t,types:n}}),o=yield Promise.race([i.componentInstance.event.pipe((0,s.P)(t=>"done"===t.reason)).toPromise(),i.afterClosed().toPromise()]);"done"===(null==o?void 0:o.reason)&&this.updateConfig(this._org.building.id,o.metadata).then(()=>i.close(),()=>i.componentInstance.loading=!1)})}updateMenu(t,e){return(0,o.Ymr)(t,{id:t,name:"catering",details:e,description:`Catering menu for ${t}`}).toPromise()}getCateringForZone(t){return(0,i.mG)(this,void 0,void 0,function*(){const e=(yield(0,o.rlq)(t,{name:"catering"}).toPromise()).details;return e instanceof Array?e:[]})}getCateringConfig(t=this._org.building.id){return(0,i.mG)(this,void 0,void 0,function*(){const e=(yield(0,o.rlq)(t,{name:"catering_config"}).toPromise()).details;return e instanceof Array?e:[]})}updateConfig(t,e){return(0,o.Ymr)(t,{id:t,name:"catering_config",details:e,description:`Catering menu config for ${t}`}).toPromise()}addItemToOrder(t,e){let n=t.items;const i=n.find(t=>{var n,i;return t.id===e.id&&(null===(n=e.options)||void 0===n?void 0:n.length)===(null===(i=t.options)||void 0===i?void 0:i.reduce((t,n)=>t+(e.options.find(t=>n.id===t.id)?1:0),0))});return i?i.quantity+=1:n=n.concat([new u.U(Object.assign(Object.assign({},e),{quantity:1}))]),new g.G(Object.assign(Object.assign({},t),{items:n,event:null}))}}return t.\u0275fac=function(e){return new(e||t)(f.LFG(h.w7),f.LFG(Z.uw))},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},8362:(t,e,n)=>{"use strict";n.d(e,{g:()=>i});const i=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}]},3673:(t,e,n)=>{"use strict";n.d(e,{U:()=>i});const i=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map