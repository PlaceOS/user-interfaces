"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{1950:(F,W,n)=>{n.d(W,{F7:()=>v.F,GX:()=>t.GX,Ii:()=>t.Ii,Ud:()=>t.Ud,jW:()=>t.jW,uy:()=>e.u});var e=n(7543),t=n(3858),v=n(5362)},2090:(F,W,n)=>{n.d(W,{S:()=>T});var e=n(2560),t=n(1484),v=n(1426),o=n(7701),d=n(4666),r=n(207),l=n(4792),y=n(2508),L=n(5306),I=n(5074),A=n(7371),O=n(1267);function R(g,s){1&g&&(e.TgZ(0,"button",7)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function b(g,s){if(1&g&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&g){const i=s.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.name," ")}}function x(g,s){if(1&g){const i=e.EpF();e.TgZ(0,"div",16)(1,"mat-form-field",10)(2,"mat-select",17),e.NdJ("ngModelChange",function(c){const f=e.CHM(i).$implicit;return e.KtG(f[0]=c)}),e.YNc(3,b,2,2,"mat-option",18),e.qZA()(),e.TgZ(4,"mat-form-field",10)(5,"input",19),e.NdJ("ngModelChange",function(c){const f=e.CHM(i).$implicit;return e.KtG(f[1]=c)}),e.qZA(),e.TgZ(6,"mat-error"),e._uU(7,"Rule value is required"),e.qZA()(),e.TgZ(8,"button",12),e.NdJ("click",function(){const p=e.CHM(i).index,f=e.oxw().$implicit;return e.KtG(f.rules.splice(p,1))}),e.TgZ(9,"app-icon"),e._uU(10,"delete"),e.qZA()()()}if(2&g){const i=s.$implicit,a=e.oxw(2);e.xp6(2),e.Q6J("ngModel",i[0]),e.xp6(1),e.Q6J("ngForOf",a.rule_types),e.xp6(2),e.Q6J("ngModel",i[1])}}function K(g,s){if(1&g){const i=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"mat-form-field",10)(3,"input",11),e.NdJ("ngModelChange",function(c){const f=e.CHM(i).$implicit;return e.KtG(f.name=c)}),e.qZA(),e.TgZ(4,"mat-error"),e._uU(5,"Ruleset name is required"),e.qZA()(),e.TgZ(6,"button",12),e.NdJ("click",function(){const p=e.CHM(i).$implicit,f=e.oxw();return p.rules.push(["",""]),e.KtG(f.show_rules=p.id)}),e.TgZ(7,"app-icon"),e._uU(8,"add"),e.qZA()(),e.TgZ(9,"button",13),e.NdJ("click",function(){const p=e.CHM(i).$implicit,f=e.oxw();return e.KtG(f.show_rules=f.show_rules!==p.id?p.id:"")}),e.TgZ(10,"app-icon"),e._uU(11),e.qZA()(),e.TgZ(12,"button",12),e.NdJ("click",function(){const p=e.CHM(i).index,f=e.oxw();return e.KtG(f.rulesets.splice(p,1))}),e.TgZ(13,"app-icon"),e._uU(14,"delete"),e.qZA()()(),e.TgZ(15,"div",14),e.YNc(16,x,11,3,"div",15),e.qZA()()}if(2&g){const i=s.$implicit,a=e.oxw();e.xp6(3),e.Q6J("ngModel",i.name),e.xp6(6),e.Q6J("disabled",!i.rules.length),e.xp6(2),e.Oqu(a.show_rules===i.id?"expand_less":"expand_more"),e.xp6(4),e.Udp("height",(a.show_rules===i.id?5*i.rules.length:0)+"em"),e.xp6(1),e.Q6J("ngForOf",i.rules)}}class T extends v.cx{get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}constructor(s){super(),this._data=s,this.event=new e.vpe,this.loading=!1,this.require_notes=this._data.require_notes,this.rule_types=o.g,this.rulesets=(s.config||[]).map(i=>(i.rules=i.rules.map(a=>[a[0],JSON.stringify(a[1])]),i))}saveNotesSetting(s){this.timeout("save-notes",()=>this._data.saveNotes?this._data.saveNotes(s):"",1e3)}saveChanges(){this.loading=!0;const s=this.rulesets.map(i=>({...i,rules:i.rules.map(a=>{let c=a[1];try{c=JSON.parse(a[1])}catch{}return[a[0],c]})}));this.event.emit({reason:"done",metadata:s})}}T.\u0275fac=function(s){return new(s||T)(e.Y36(t.WI))},T.\u0275cmp=e.Xpm({type:T,selectors:[["catering-config-modal"]],outputs:{event:"event"},features:[e.qOj],decls:14,vars:3,consts:[["icon","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center","max-w-lg","px-4","pt-2","pb-4"],[1,"m-2",3,"ngModel","ngModelChange"],["matRipple","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["btn","","matRipple","",1,"mx-auto","w-32",3,"click"],["icon","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["icon","","matRipple","",1,"mb-6",3,"click"],["icon","","matRipple","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex items-center px-2 h-20 space-x-2",4,"ngFor","ngForOf"],[1,"flex","items-center","px-2","h-20","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(s,i){1&s&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Edit Catering Configuration"),e.qZA(),e.YNc(3,R,3,0,"button",0),e.qZA(),e.TgZ(4,"main",1)(5,"mat-checkbox",2),e.NdJ("ngModelChange",function(c){return i.saveNotesSetting(c)}),e._uU(6," Require notes for orders "),e.qZA(),e._UZ(7,"br"),e.TgZ(8,"button",3),e.NdJ("click",function(){return i.rulesets.push({id:i.new_id,rules:[]})}),e._uU(9," New Ruleset "),e.qZA(),e.YNc(10,K,17,6,"div",4),e.qZA(),e.TgZ(11,"footer",5)(12,"button",6),e.NdJ("click",function(){return i.saveChanges()}),e._uU(13," Save Changes "),e.qZA()()),2&s&&(e.xp6(3),e.Q6J("ngIf",!i.loading),e.xp6(2),e.Q6J("ngModel",i.require_notes),e.xp6(5),e.Q6J("ngForOf",i.rulesets))},dependencies:[d.sg,d.O5,r.ey,t.ZT,l.oG,y.Fj,y.JJ,y.Q7,y.On,L.o,I.KE,I.TO,A.gD,r.wG,O.Nt],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=catering-config-modal.component.ts-angular-inline--53.css.map*/"]})},5730:(F,W,n)=>{n.d(W,{m:()=>O});var e=n(2560),t=n(1426),v=n(2962),o=n(4666),d=n(1484),r=n(5306),l=n(207),y=n(1708);function L(R,b){1&R&&(e.TgZ(0,"button",4)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function I(R,b){if(1&R){const x=e.EpF();e.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),e._uU(3,"upload"),e.qZA(),e.TgZ(4,"p"),e._uU(5,"Click to select file or Drag and drop files"),e.qZA(),e.TgZ(6,"input",7),e.NdJ("change",function(T){e.CHM(x);const g=e.oxw();return e.KtG(g.handleFileEvent(T))}),e.qZA()(),e.TgZ(7,"div",8)(8,"button",9),e.NdJ("click",function(){e.CHM(x);const T=e.oxw();return e.KtG(T.downloadTemplate())}),e._uU(9," Download Template "),e.qZA()()()}}function A(R,b){if(1&R&&(e.TgZ(0,"main",10),e._UZ(1,"mat-spinner",11),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&R){const x=e.oxw();e.xp6(3),e.Oqu(x.loading)}}class O{constructor(){this.event=new e.vpe}handleFileEvent(b){this.loading="Processing menu data...";const x=b.target;if(!x?.files)return this.loading="";const K=x.files;if(!K.length)return this.loading="";const T=K[0],g=new FileReader;g.addEventListener("loadend",s=>{const a=(0,t.n5)(s.target.result);this.loading="",this.event.emit({reason:"done",metadata:a.filter(c=>"item"===(c.type||"").toLowerCase()).map(c=>new v.U({...c,options:a.filter(p=>"option"===(p.type||"").toLowerCase()&&p.tags===c.id).map(p=>({id:p.id,name:p.name,group:p.category,multiple:p.multiple,unit_price:p.unit_price}))}))})}),g.readAsText(T)}downloadTemplate(){(0,t.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}O.\u0275fac=function(b){return new(b||O)},O.\u0275cmp=e.Xpm({type:O,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["icon","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["icon","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["matRipple","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(b,x){if(1&b&&(e.TgZ(0,"header",0)(1,"h2"),e._uU(2,"Import Catering Menu"),e.qZA(),e.YNc(3,L,3,0,"button",1),e.qZA(),e.YNc(4,I,10,0,"main",2),e.YNc(5,A,4,1,"ng-template",null,3,e.W1O)),2&b){const K=e.MAs(6);e.xp6(3),e.Q6J("ngIf",!x.loading),e.xp6(1),e.Q6J("ngIf",!x.loading)("ngIfElse",K)}},dependencies:[o.O5,d.ZT,r.o,l.wG,y.Ou]})},6336:(F,W,n)=>{n.d(W,{w:()=>P});var e=n(8456),t=n(2560),v=n(2508),o=n(1484),d=n(1426),r=n(2962),l=n(4666),y=n(8550),L=n(207),I=n(4792),A=n(5306),O=n(5074),R=n(1267),b=n(1708),x=n(1169),K=n(2793),T=n(3670);function g(E,h){1&E&&(t.TgZ(0,"button",6)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function s(E,h){if(1&E&&(t.TgZ(0,"div",17)(1,"label",18),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",19),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA()()()),2&E){const _=t.oxw(2);t.xp6(1),t.ekj("error",_.form.controls.name.invalid&&_.form.controls.name.touched)}}function i(E,h){if(1&E&&(t.TgZ(0,"div",17)(1,"label",21),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",19),t._UZ(7,"input",22),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA()()()),2&E){const _=t.oxw(2),m=t.MAs(9);t.xp6(1),t.ekj("error",_.form.controls.category.invalid&&_.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",m)}}function a(E,h){if(1&E){const _=t.EpF();t.TgZ(0,"mat-chip-row",29),t.NdJ("removed",function(){const Z=t.CHM(_).$implicit,J=t.oxw(3);return t.KtG(J.removeTag(Z))}),t._uU(1),t.TgZ(2,"button",30)(3,"app-icon"),t._uU(4,"cancel"),t.qZA()()()}if(2&E){const _=h.$implicit;t.xp6(1),t.hij(" ",_," "),t.xp6(1),t.uIk("aria-label","Remove "+_)}}function c(E,h){if(1&E){const _=t.EpF();t.TgZ(0,"div",17)(1,"label",23),t.SDv(2,24),t.qZA(),t.TgZ(3,"mat-form-field",19)(4,"mat-chip-grid",25,26),t.YNc(6,a,5,2,"mat-chip-row",27),t.qZA(),t.TgZ(7,"input",28),t.NdJ("matChipInputTokenEnd",function(u){t.CHM(_);const Z=t.oxw(2);return t.KtG(Z.addTag(u))}),t.qZA()()()}if(2&E){const _=t.MAs(5),m=t.oxw(2);t.xp6(1),t.ekj("error",m.form.controls.tags.invalid&&m.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",m.tag_list),t.xp6(1),t.Q6J("matChipInputFor",_)("matChipInputSeparatorKeyCodes",m.separators)("matChipInputAddOnBlur",!0)}}function p(E,h){1&E&&(t.TgZ(0,"div",17)(1,"label",31),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",19),t._UZ(4,"textarea",32),t.qZA()())}function f(E,h){if(1&E&&(t.TgZ(0,"div",17)(1,"label",18),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",19),t._UZ(7,"input",33),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA()()()),2&E){const _=t.oxw(2);t.xp6(1),t.ekj("error",_.form.controls.unit_price.invalid&&_.form.controls.unit_price.touched)}}function U(E,h){1&E&&(t.TgZ(0,"div",17)(1,"label",34),t.SDv(2,35),t.qZA(),t._UZ(3,"image-list-field",36),t.qZA())}const B=function(){return{standalone:!0}};function C(E,h){if(1&E){const _=t.EpF();t.TgZ(0,"form",7)(1,"div",8),t.YNc(2,s,10,2,"div",9),t.YNc(3,i,10,3,"div",9),t.qZA(),t.YNc(4,c,8,6,"div",9),t.YNc(5,p,5,0,"div",9),t.YNc(6,f,10,2,"div",9),t.TgZ(7,"div",10)(8,"label",11),t._uU(9,"Accept Points?"),t.qZA(),t.TgZ(10,"mat-checkbox",12),t._uU(11),t.qZA()(),t.TgZ(12,"div",13)(13,"mat-checkbox",14),t.NdJ("ngModelChange",function(u){t.CHM(_);const Z=t.oxw();return t.KtG(u?Z.addTag({value:"Gluten Free"}):Z.removeTag("Gluten Free"))}),t._uU(14," Gluten Free (GF) "),t.qZA(),t.TgZ(15,"mat-checkbox",14),t.NdJ("ngModelChange",function(u){t.CHM(_);const Z=t.oxw();return t.KtG(u?Z.addTag({value:"Vegan"}):Z.removeTag("Vegan"))}),t._uU(16," Vegan (VG) "),t.qZA(),t.TgZ(17,"mat-checkbox",14),t.NdJ("ngModelChange",function(u){t.CHM(_);const Z=t.oxw();return t.KtG(u?Z.addTag({value:"Vegetarian"}):Z.removeTag("Vegetarian"))}),t._uU(18," Vegetarian (V) "),t.qZA(),t.TgZ(19,"mat-checkbox",14),t.NdJ("ngModelChange",function(u){t.CHM(_);const Z=t.oxw();return t.KtG(u?Z.addTag({value:"Contains Dairy"}):Z.removeTag("Contains Dairy"))}),t._uU(20," Contains Dairy (D) "),t.qZA(),t.TgZ(21,"mat-checkbox",14),t.NdJ("ngModelChange",function(u){t.CHM(_);const Z=t.oxw();return t.KtG(u?Z.addTag({value:"Contains Nuts"}):Z.removeTag("Contains Nuts"))}),t._uU(22," Contains Nuts (N) "),t.qZA()(),t.TgZ(23,"div",10)(24,"label",15),t._uU(25,"Discount Cap"),t.qZA(),t._UZ(26,"a-counter",16),t.qZA(),t.YNc(27,U,4,0,"div",9),t.qZA()}if(2&E){const _=t.oxw();let m;t.Q6J("formGroup",_.form),t.xp6(2),t.Q6J("ngIf",_.form.controls.name),t.xp6(1),t.Q6J("ngIf",_.form.controls.category),t.xp6(1),t.Q6J("ngIf",_.form.controls.tags),t.xp6(1),t.Q6J("ngIf",_.form.controls.description),t.xp6(1),t.Q6J("ngIf",_.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(m=_.form.get("accept_points"))&&m.value?"No":"Yes"),t.xp6(2),t.Q6J("ngModel",_.hasTag("Gluten Free"))("ngModelOptions",t.DdM(22,B)),t.xp6(2),t.Q6J("ngModel",_.hasTag("Vegan"))("ngModelOptions",t.DdM(23,B)),t.xp6(2),t.Q6J("ngModel",_.hasTag("Vegetarian"))("ngModelOptions",t.DdM(24,B)),t.xp6(2),t.Q6J("ngModel",_.hasTag("Contains Dairy"))("ngModelOptions",t.DdM(25,B)),t.xp6(2),t.Q6J("ngModel",_.hasTag("Contains Nuts"))("ngModelOptions",t.DdM(26,B)),t.xp6(5),t.Q6J("min",0)("max",100)("step",5)("render_fn",_.renderPercent),t.xp6(1),t.Q6J("ngIf",_.form.controls.images)}}function M(E,h){if(1&E){const _=t.EpF();t.TgZ(0,"footer",37)(1,"button",38),t.NdJ("click",function(){t.CHM(_);const u=t.oxw();return t.KtG(u.saveChanges())}),t._uU(2," Save "),t.qZA()()}if(2&E){const _=t.oxw();t.xp6(1),t.Q6J("disabled",!_.form.dirty)}}function D(E,h){1&E&&(t.TgZ(0,"div",39),t._UZ(1,"mat-spinner",40),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA()())}function N(E,h){if(1&E&&(t.TgZ(0,"mat-option",41),t._uU(1),t.qZA()),2&E){const _=h.$implicit;t.Q6J("value",_),t.xp6(1),t.hij(" ",_," ")}}class P{get item(){return this._data.item||new r.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(h=0){return`${h}%`}hasTag(h){return this.tag_list.includes(h)}constructor(h){this._data=h,this.event=new t.vpe,this.form=new v.cw({name:new v.NI(this.item.name||"",[v.kI.required]),description:new v.NI(this.item.description||""),category:new v.NI(this.item.category||"",[v.kI.required]),unit_price:new v.NI(this.item.unit_price,[v.kI.required]),tags:new v.NI(this.item.tags||[]),accept_points:new v.NI(this.item.accept_points||!1),discount_cap:new v.NI(this.item.discount_cap||0),images:new v.NI(this.item.images||[])}),this.loading=!1,this.separators=[e.K5,e.OC,e.L_]}addTag(h){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const _=h.input,m=h.value,u=this.tag_list;(m||"").trim()&&(u.push(m),this.form.controls.tags.setValue(u)),_&&(_.value="")}removeTag(h){if(!this.form||!this.form.controls.tags)return;const _=this.tag_list;this.form.controls.tags.markAsDirty();const m=_.indexOf(h);m>=0&&(_.splice(m,1),this.form.controls.tags.setValue(_))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new r.U({...this.item,id:this.item.id||`item-${(0,d.Iy)(99999999)}`,...this.form.value})}})}}P.\u0275fac=function(h){return new(h||P)(t.Y36(o.WI))},P.\u0275cmp=t.Xpm({type:P,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let E,h,_;return E=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,h=$localize`:@@zoneTagsPlaceholder␟c133beffffe3288bbdbf8572a32910c33ce14991␟2194594490376201833:Item tags e.g. Gluten Free, Vegan etc.`,_=$localize`:@@imagesLabel␟e5d9e00faa06714d7671b164cad364b26f4c585b␟5137125764814732349:Images:`,[["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],[1,"flex","items-center","space-x-2"],["class","flex flex-col",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],["list","",1,"flex","items-center","flex-wrap","max-w-lg"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],E,["aria-label","Item Tags"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],["name","tags","placeholder",h,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"removed"],["matChipRemove",""],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["for","images"],_,["name","images","formControlName","images"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["btn","","matRipple","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(h,_){if(1&h&&(t.TgZ(0,"header")(1,"h3"),t._uU(2),t.qZA(),t.YNc(3,g,3,0,"button",0),t.qZA(),t.YNc(4,C,28,27,"form",1),t.YNc(5,M,3,1,"footer",2),t.YNc(6,D,4,0,"ng-template",null,3,t.W1O),t.TgZ(8,"mat-autocomplete",null,4),t.YNc(10,N,2,2,"mat-option",5),t.qZA()),2&h){const m=t.MAs(7);t.xp6(2),t.hij("",_.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!_.loading),t.xp6(1),t.Q6J("ngIf",_.form&&!_.loading)("ngIfElse",m),t.xp6(1),t.Q6J("ngIf",!_.loading),t.xp6(5),t.Q6J("ngForOf",_.categories)}},dependencies:[l.sg,l.O5,y.XC,L.ey,y.ZL,o.ZT,I.oG,v._Y,v.Fj,v.wV,v.JJ,v.JL,v.On,v.sg,v.u,A.o,O.KE,O.TO,L.wG,R.Nt,b.Ou,x.RA,x.oH,x.qH,x.z3,K.R,T.h],styles:["[list][_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin:.5rem}\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--52.css.map*/"]})},8644:(F,W,n)=>{n.d(W,{V:()=>s});var e=n(1426),t=n(2962),v=n(729),o=n(2560),d=n(4666),r=n(8589),l=n(4792),y=n(6896),L=n(2508),I=n(5306),A=n(207);function R(i,a){if(1&i&&(o.TgZ(0,"button",14)(1,"app-icon"),o._uU(2,"more_vert"),o.qZA()()),2&i){o.oxw(2);const c=o.MAs(4);o.Q6J("matMenuTriggerFor",c)}}function b(i,a){if(1&i){const c=o.EpF();o.TgZ(0,"div",6)(1,"mat-checkbox",7),o.NdJ("ngModelChange",function(f){o.CHM(c);const U=o.oxw();return o.KtG(U.is_enabled=f)}),o.qZA(),o.TgZ(2,"div",8)(3,"div",9)(4,"div"),o._uU(5),o.qZA(),o.TgZ(6,"div",10),o._uU(7),o.qZA()(),o.TgZ(8,"div",11),o._uU(9),o.ALo(10,"currency"),o.ALo(11,"async"),o.qZA()(),o.YNc(12,R,3,1,"button",12),o.TgZ(13,"button",13),o.NdJ("click",function(){o.CHM(c);const f=o.oxw();return o.KtG(f.show_options=!f.show_options)}),o.TgZ(14,"app-icon"),o._uU(15,"expand_more"),o.qZA()()()}if(2&i){const c=o.oxw();o.xp6(1),o.Q6J("ngModel",c.is_enabled),o.xp6(4),o.Oqu(c.item.name),o.xp6(2),o.hij(" ",c.item.category," "),o.xp6(2),o.hij(" ",o.xi3(10,6,c.item.unit_price/100,o.lcZ(11,9,c.symbol))," "),o.xp6(3),o.Q6J("ngIf",c.can_edit),o.xp6(1),o.Q6J("disabled",!c.item.options.length)}}function x(i,a){if(1&i){const c=o.EpF();o.TgZ(0,"button",23),o.NdJ("click",function(){o.CHM(c);const f=o.oxw().$implicit,U=o.oxw(2);return o.KtG(U.editOption(f))}),o.TgZ(1,"app-icon"),o._uU(2,"edit"),o.qZA()()}}function K(i,a){if(1&i){const c=o.EpF();o.TgZ(0,"button",24),o.NdJ("click",function(){o.CHM(c);const f=o.oxw().$implicit,U=o.oxw(2);return o.KtG(U.removeOption(f))}),o.TgZ(1,"app-icon"),o._uU(2,"delete"),o.qZA()()}}function T(i,a){if(1&i&&(o.TgZ(0,"div",17),o._UZ(1,"div",18),o.TgZ(2,"div",19)(3,"div",20),o._uU(4),o.qZA(),o.TgZ(5,"div",10),o._uU(6),o.qZA()(),o.YNc(7,x,3,0,"button",21),o.YNc(8,K,3,0,"button",22),o.qZA()),2&i){const c=a.$implicit,p=o.oxw(2);o.xp6(4),o.Oqu(c.name),o.xp6(2),o.hij(" ",c.group," "),o.xp6(1),o.Q6J("ngIf",p.can_edit),o.xp6(1),o.Q6J("ngIf",p.can_edit)}}function g(i,a){if(1&i&&(o.TgZ(0,"div",15),o.YNc(1,T,9,4,"div",16),o.qZA()),2&i){const c=o.oxw();o.Udp("height",c.show_options?3.5*c.item.options.length+"rem":"0"),o.xp6(1),o.Q6J("ngForOf",c.item.options)}}class s{get can_edit(){return this._catering.is_editable}get is_enabled(){return!this.item.hide_for_zones.includes(this._catering.zone)}set is_enabled(a){let c=this.item.hide_for_zones;c=a?c.filter(p=>p!==this._catering.zone):(0,e.Tw)([...c,this._catering.zone]),this._catering.updateItem(new t.U({...this.item,hide_for_zones:c}))}get symbol(){return this._catering.currency}constructor(a){this._catering=a,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=c=>this._catering.addOption(this.item,c),this.removeOption=c=>this._catering.deleteOption(this.item,c),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}}s.\u0275fac=function(a){return new(a||s)(o.Y36(v.j))},s.\u0275cmp=o.Xpm({type:s,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:["catering-menu-item",""],decls:20,vars:2,consts:[[1,"w-full","h-full","bg-white","dark:bg-neutral-700","border","border-gray-300","dark:border-neutral-500","overflow-hidden","rounded"],["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-gray-100 dark:bg-neutral-700 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],["matTooltip","Allow Ordering Item",1,"mr-2",3,"ngModel","ngModelChange"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","opacity-60"],[1,"p-2","m-2","text-xs","font-bold","text-white","rounded","bg-primary"],["icon","","matRipple","",3,"matMenuTriggerFor",4,"ngIf"],["icon","","matRipple","",3,"disabled","click"],["icon","","matRipple","",3,"matMenuTriggerFor"],["options","",1,"bg-gray-100","dark:bg-neutral-700","overflow-hidden"],["class","flex p-2 items-center border-t border-solid border-gray-300 dark:border-neutral-500 relative",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-t","border-solid","border-gray-300","dark:border-neutral-500","relative"],[1,"absolute","inset-y-0","left-0","w-2","bg-gray-400","dark:bg-neutral-600"],[1,"flex-1","pl-4","pr-2"],[1,"text"],["edit","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["remove","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["edit","","icon","","matRipple","",1,"mx-2",3,"click"],["remove","","icon","","matRipple","",1,"mx-2",3,"click"]],template:function(a,c){1&a&&(o.TgZ(0,"div",0),o.YNc(1,b,16,11,"div",1),o.YNc(2,g,2,3,"div",2),o.TgZ(3,"mat-menu",null,3)(5,"button",4),o.NdJ("click",function(){return c.addOption()}),o.TgZ(6,"app-icon"),o._uU(7,"add"),o.qZA(),o.TgZ(8,"div",5),o._uU(9,"Add Option"),o.qZA()(),o.TgZ(10,"button",4),o.NdJ("click",function(){return c.editItem()}),o.TgZ(11,"app-icon"),o._uU(12,"edit"),o.qZA(),o.TgZ(13,"div",5),o._uU(14,"Edit Item"),o.qZA()(),o.TgZ(15,"button",4),o.NdJ("click",function(){return c.removeItem()}),o.TgZ(16,"app-icon"),o._uU(17,"delete"),o.qZA(),o.TgZ(18,"div",5),o._uU(19,"Remove Item"),o.qZA()()()()),2&a&&(o.xp6(1),o.Q6J("ngIf",c.item),o.xp6(1),o.Q6J("ngIf",c.item))},dependencies:[d.sg,d.O5,r.VK,r.OP,r.p6,l.oG,y.gM,L.JJ,L.On,I.o,A.wG,d.Ov,d.H9],styles:["[_nghost-%COMP%]{overflow:hidden;width:48rem;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=catering-menu-item.component.ts-angular-inline--56.css.map*/"]})},8501:(F,W,n)=>{n.d(W,{B:()=>b});var e=n(4505),t=n(6942),v=n(729),o=n(2560),d=n(4666),r=n(5892),l=n(5306),y=n(8644);function L(x,K){if(1&x&&(o.ynx(0),o._UZ(1,"div",6),o.BQk()),2&x){const T=K.$implicit;o.xp6(1),o.Q6J("item",T)}}function I(x,K){if(1&x&&(o.ynx(0),o.YNc(1,L,2,1,"ng-container",5),o.ALo(2,"async"),o.BQk()),2&x){const T=o.oxw();o.xp6(1),o.Q6J("ngForOf",o.lcZ(2,1,T.menu))}}function A(x,K){if(1&x&&(o.ynx(0),o._UZ(1,"div",6),o.BQk()),2&x){const T=K.$implicit;o.xp6(1),o.Q6J("item",T)}}function O(x,K){if(1&x&&(o.TgZ(0,"mat-tab",7),o.YNc(1,A,2,1,"ng-container",5),o.ALo(2,"async"),o.qZA()),2&x){const T=K.$implicit,g=o.oxw();o.Q6J("label",T),o.uIk("label",T),o.xp6(1),o.Q6J("ngForOf",o.lcZ(2,3,g.tab_menu)[T])}}function R(x,K){1&x&&(o.TgZ(0,"div",8)(1,"app-icon"),o._uU(2,"close"),o.qZA(),o.TgZ(3,"p"),o._uU(4,"No items in menu"),o.qZA()())}class b{get categories(){return this._catering.categories}constructor(K){this._catering=K,this.menu=this._catering.menu,this.shown_tab=new e.X(""),this.tab_menu=this.menu.pipe((0,t.U)(T=>{const g={};for(const s of this.categories)g[s]=T.filter(i=>i.category===s);return g}))}}b.\u0275fac=function(K){return new(K||b)(o.Y36(v.j))},b.\u0275cmp=o.Xpm({type:b,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(K,T){if(1&K&&(o.TgZ(0,"mat-tab-group",0),o.NdJ("selectedIndexChange",function(s){return T.shown_tab.next(0===s?"":T.categories[s-1])}),o.TgZ(1,"mat-tab",1),o.YNc(2,I,3,3,"ng-container",2),o.ALo(3,"async"),o.qZA(),o.YNc(4,O,3,5,"mat-tab",3),o.qZA(),o.YNc(5,R,5,0,"ng-template",null,4,o.W1O)),2&K){const g=o.MAs(6);let s;o.xp6(2),o.Q6J("ngIf",null==(s=o.lcZ(3,3,T.menu))?null:s.length)("ngIfElse",g),o.xp6(2),o.Q6J("ngForOf",T.categories)}},dependencies:[d.sg,d.O5,r.uX,r.SP,l.o,y.V,d.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--57.css.map*/"]})},7413:(F,W,n)=>{n.d(W,{M:()=>p});var e=n(2560),t=n(2508),v=n(1484),o=n(3245),d=n(2962),r=n(4666),l=n(8550),y=n(207),L=n(4792),I=n(5306),A=n(5074),O=n(1267),R=n(1708);function b(f,U){1&f&&(e.TgZ(0,"button",6)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function x(f,U){if(1&f&&(e.TgZ(0,"div",9)(1,"label",10),e._uU(2," Name"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",11),e._UZ(7,"input",12),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()()),2&f){const B=e.oxw(2);e.xp6(1),e.ekj("error",B.form.controls.name.invalid&&B.form.controls.name.touched)}}function K(f,U){if(1&f&&(e.TgZ(0,"div",9)(1,"label",13),e._uU(2," Type"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",11),e._UZ(7,"input",14),e.TgZ(8,"mat-error"),e._uU(9,"Type is required"),e.qZA()()()),2&f){const B=e.oxw(2),C=e.MAs(9);e.xp6(1),e.ekj("error",B.form.controls.group.invalid&&B.form.controls.group.touched),e.xp6(6),e.Q6J("matAutocomplete",C)}}function T(f,U){1&f&&(e.TgZ(0,"div",9)(1,"label",10),e._uU(2,"Unit Price:"),e.qZA(),e.TgZ(3,"mat-form-field",11),e._UZ(4,"input",15),e.qZA()())}function g(f,U){1&f&&(e.TgZ(0,"div",9)(1,"mat-checkbox",16),e._uU(2," Can select multiple of type "),e.qZA()())}function s(f,U){if(1&f&&(e.TgZ(0,"form",7),e.YNc(1,x,10,2,"div",8),e.YNc(2,K,10,3,"div",8),e.YNc(3,T,5,0,"div",8),e.YNc(4,g,3,0,"div",8),e.qZA()),2&f){const B=e.oxw();e.Q6J("formGroup",B.form),e.xp6(1),e.Q6J("ngIf",B.form.controls.name),e.xp6(1),e.Q6J("ngIf",B.form.controls.group),e.xp6(1),e.Q6J("ngIf",B.form.controls.unit_price),e.xp6(1),e.Q6J("ngIf",B.form.controls.multiple)}}function i(f,U){if(1&f){const B=e.EpF();e.TgZ(0,"footer",17)(1,"button",18),e.NdJ("click",function(){e.CHM(B);const M=e.oxw();return e.KtG(M.saveChanges())}),e._uU(2," Save "),e.qZA()()}if(2&f){const B=e.oxw();e.xp6(1),e.Q6J("disabled",!B.form.dirty)}}function a(f,U){1&f&&(e.TgZ(0,"div",19),e._UZ(1,"mat-spinner",20),e.TgZ(2,"p"),e._uU(3,"Saving catering item option..."),e.qZA()())}function c(f,U){if(1&f&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&f){const B=U.$implicit;e.Q6J("value",B),e.xp6(1),e.hij(" ",B," ")}}class p{get option(){return this._data.option}get types(){return this._data.types||[]}constructor(U){this._data=U,this.event=new e.vpe,this.form=new t.cw({name:new t.NI(this.option.name||"",[t.kI.required]),group:new t.NI(this.option.group||"",[t.kI.required]),unit_price:new t.NI(this.option.unit_price),multiple:new t.NI(!!this.option.multiple,[])}),this.loading=!1}saveChanges(){this.loading=!0;const U={...this.option,id:this.option.id||`option-${(0,o.Iy)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new d.U({...this._data.parent,options:this._data.parent.options.filter(B=>B.id!==U.id).concat([U])})}})}}p.\u0275fac=function(U){return new(U||p)(e.Y36(v.WI))},p.\u0275cmp=e.Xpm({type:p,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["icon","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["icon","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["btn","","matRipple","",3,"disabled","click"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(U,B){if(1&U&&(e.TgZ(0,"header")(1,"h3"),e._uU(2),e.qZA(),e.YNc(3,b,3,0,"button",0),e.qZA(),e.YNc(4,s,5,5,"form",1),e.YNc(5,i,3,1,"footer",2),e.YNc(6,a,4,0,"ng-template",null,3,e.W1O),e.TgZ(8,"mat-autocomplete",null,4),e.YNc(10,c,2,2,"mat-option",5),e.qZA()),2&U){const C=e.MAs(7);e.xp6(2),e.hij("",B.option.id?"Edit":"Add"," Item Option"),e.xp6(1),e.Q6J("ngIf",!B.loading),e.xp6(1),e.Q6J("ngIf",B.form&&!B.loading)("ngIfElse",C),e.xp6(1),e.Q6J("ngIf",!B.loading),e.xp6(5),e.Q6J("ngForOf",B.types)}},dependencies:[r.sg,r.O5,l.XC,y.ey,l.ZL,v.ZT,L.oG,t._Y,t.Fj,t.wV,t.JJ,t.JL,t.sg,t.u,I.o,A.KE,A.TO,y.wG,O.Nt,R.Ou]})},4204:(F,W,n)=>{n.d(W,{m:()=>L});var e=n(2560),t=n(4666),v=n(5306),o=n(207);function r(I,A){if(1&I&&(e.TgZ(0,"div",12),e._uU(1),e.qZA()),2&I){const O=e.oxw().$implicit;e.xp6(1),e.hij(" ",O.name," ")}}function l(I,A){if(1&I&&(e.ynx(0),e.YNc(1,r,2,1,"div",11),e.BQk()),2&I){const O=A.$implicit;e.xp6(1),e.Q6J("ngIf",O)}}function y(I,A){if(1&I){const O=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e._UZ(2,"div",2),e.qZA(),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){e.CHM(O);const b=e.oxw();return e.KtG(b.active=!b.active)}),e.TgZ(5,"app-icon"),e._uU(6),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6),e._uU(9),e.qZA(),e.TgZ(10,"div",7)(11,"div",8),e._uU(12),e.qZA()(),e.TgZ(13,"div",9),e.YNc(14,l,2,1,"ng-container",10),e.qZA()(),e.BQk()}if(2&I){const O=e.oxw();e.xp6(4),e.ekj("bg-success",O.active)("text-white",O.active)("border-solid",O.active),e.xp6(2),e.Oqu(O.active?"done":"local_pizza"),e.xp6(3),e.Oqu(null==O.item?null:O.item.name),e.xp6(3),e.hij(" \u2a2f",(null==O.item?null:O.item.amount)||(null==O.item?null:O.item.quantity)||1," "),e.xp6(2),e.Q6J("ngForOf",O.item.option_list)}}class L{constructor(){this.active=!1}}L.\u0275fac=function(A){return new(A||L)},L.\u0275cmp=e.Xpm({type:L,selectors:[["","catering-order-item",""]],inputs:{item:"item"},attrs:["catering-order-item",""],decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-20","text-right","h-14","relative"],[1,"border-b-2","border-l-2","border-gray-400","dark:border-neutral-500","w-4","h-16","absolute","top-1/2","left-1/2","-translate-y-full"],[1,"w-12","mr-4"],["action","","icon","","matRipple","",1,"border","border-gray-300","dark:border-neutral-500","border-dashed","text-xl","text-dark-fade","p-2",3,"click"],[1,"flex","flex-1","border-b","border-gray-300","dark:border-neutral-500","border-solid","py-4","space-x-2"],[1,""],[1,"flex-1"],[1,"p-1","rounded-full","bg-black/10","w-8","h-8","flex","items-center","justify-center"],[1,"flex","space-x-2","mr-2"],[4,"ngFor","ngForOf"],["class","text-xs py-1 px-2 bg-yellow-300 text-black rounded-2xl shadow",4,"ngIf"],[1,"text-xs","py-1","px-2","bg-yellow-300","text-black","rounded-2xl","shadow"]],template:function(A,O){1&A&&e.YNc(0,y,15,10,"ng-container",0),2&A&&e.Q6J("ngIf",O.item)},dependencies:[t.sg,t.O5,v.o,o.wG],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--58.css.map*/"]})},2189:(F,W,n)=>{n.d(W,{I:()=>y});var e=n(2851),t=n(2560),v=n(4666),o=n(961);function d(L,I){if(1&L&&(t.TgZ(0,"li",12),t._UZ(1,"catering-order",13),t.qZA()),2&L){const A=I.$implicit;t.xp6(1),t.Q6J("order",A)}}function r(L,I){1&L&&(t.TgZ(0,"div",14)(1,"p"),t._uU(2,"No Catering Orders"),t.qZA()())}function l(L,I){1&L&&t._UZ(0,"mat-progress-bar",15)}class y{constructor(I){this._orders=I,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(I,A){return A?A.id:void 0}}y.\u0275fac=function(I){return new(I||y)(t.Y36(e.I))},y.\u0275cmp=t.Xpm({type:y,selectors:[["catering-order-list"]],decls:24,vars:10,consts:[[1,"sticky","top-0","w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-gray-300","bg-white","dark:bg-neutral-800","dark:border-neutral-500"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-gray-300 dark:border-neutral-500",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block opacity-60",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-gray-300","dark:border-neutral-500"],[3,"order"],["empty","",1,"info-block","opacity-60"],["mode","indeterminate",1,"w-full"]],template:function(I,A){if(1&I&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Time"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Location"),t.qZA(),t.TgZ(6,"div",4),t._uU(7,"Host"),t.qZA(),t.TgZ(8,"div",5),t._uU(9,"Charge Code"),t.qZA(),t.TgZ(10,"div",2),t._uU(11,"Notes"),t.qZA(),t.TgZ(12,"div",5),t._uU(13,"Invoice No."),t.qZA(),t.TgZ(14,"div",6),t._uU(15,"Status"),t.qZA(),t._UZ(16,"div",7),t.qZA(),t.TgZ(17,"ul",8),t.YNc(18,d,2,1,"li",9),t.ALo(19,"async"),t.YNc(20,r,3,0,"div",10),t.ALo(21,"async"),t.qZA(),t.YNc(22,l,1,0,"mat-progress-bar",11),t.ALo(23,"async")),2&I){let O;t.xp6(18),t.Q6J("ngForOf",t.lcZ(19,4,A.order_list))("ngForTrackBy",A.trackByFn),t.xp6(2),t.Q6J("ngIf",!(null!=(O=t.lcZ(21,6,A.order_list))&&O.length)),t.xp6(2),t.Q6J("ngIf",t.lcZ(23,8,A.loading))}},dependencies:[v.sg,v.O5,o.p,v.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--59.css.map*/"]})},9504:(F,W,n)=>{n.d(W,{W:()=>h});var e=n(1670),t=n(2560),v=n(1484),o=n(1426),d=n(2962),r=n(5163),l=n(6221),y=n(5572),L=n(4666),I=n(5892),A=n(6896),O=n(2508),R=n(5306),b=n(207),x=n(1708),K=n(2793);function T(_,m){1&_&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function g(_,m){if(1&_){const u=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(J){t.CHM(u);const w=t.oxw().$implicit,Q=t.oxw(5);return t.KtG(Q.updateItemQuantity(w,J))}),t.qZA()}if(2&_){const u=t.oxw().$implicit;t.Q6J("ngModel",u.quantity)}}function s(_,m){if(1&_){const u=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),t._uU(4,"remove"),t.qZA()()(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(u);const J=t.oxw().$implicit,w=t.oxw(5);return t.KtG(w.addItem(J))}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA()()()}if(2&_){const u=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",u.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",u.quantity," ")}}function i(_,m){if(1&_&&(t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,T,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,g,1,1,"a-counter",15),t.YNc(9,s,10,3,"div",16),t.qZA()),2&_){const u=m.$implicit,Z=t.oxw(5);t.xp6(3),t.hij(" ",u.name," "),t.xp6(1),t.Q6J("ngIf",u.options.length),t.xp6(2),t.hij(" ",t.xi3(7,5,u.unit_price/100,Z.code)," "),t.xp6(2),t.Q6J("ngIf",!u.options.length),t.xp6(1),t.Q6J("ngIf",u.options.length)}}const a=function(){return{}};function c(_,m){if(1&_&&(t.TgZ(0,"mat-tab",8)(1,"div",9),t.YNc(2,i,10,8,"div",10),t.qZA()()),2&_){const u=t.oxw().$implicit,Z=t.oxw(3);t.Q6J("label",u),t.xp6(2),t.Q6J("ngForOf",(Z.menu_items||t.DdM(2,a))[u])}}function p(_,m){if(1&_&&(t.ynx(0),t.YNc(1,c,3,3,"mat-tab",7),t.BQk()),2&_){const u=m.$implicit,Z=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(Z.menu_items||t.DdM(1,a))[u].length)}}function f(_,m){if(1&_&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,p,2,2,"ng-container",6),t.qZA(),t.BQk()),2&_){const u=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",u.categories)}}function U(_,m){if(1&_&&(t.TgZ(0,"div",4),t.YNc(1,f,3,1,"ng-container",5),t.qZA()),2&_){const u=t.oxw(),Z=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!u.show_order_details)("ngIfElse",Z)}}function B(_,m){if(1&_){const u=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){t.CHM(u);const J=t.oxw(2);return t.KtG(J.show_order_details=!0)}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&_){const u=t.oxw(2);t.xp6(3),t.Q6J("disabled",!u.order.item_count)("matBadge",u.order.item_count)("matBadgeHidden",!u.order.item_count)}}function C(_,m){if(1&_){const u=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(u);const J=t.oxw(2);return t.KtG(J.show_order_details=!1)}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){t.CHM(u);const J=t.oxw(2);return t.KtG(J.saveOrder())}),t._uU(3," Save Order "),t.qZA()}}function M(_,m){if(1&_&&(t.TgZ(0,"footer",24),t.YNc(1,B,5,3,"ng-container",5),t.YNc(2,C,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&_){const u=t.MAs(3),Z=t.oxw();t.xp6(1),t.Q6J("ngIf",!Z.show_order_details)("ngIfElse",u)}}function D(_,m){if(1&_&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&_){const u=t.oxw();t.xp6(3),t.Oqu(u.loading)}}function N(_,m){if(1&_&&(t.TgZ(0,"div",37),t._uU(1),t.qZA()),2&_){const u=t.oxw().$implicit,Z=t.oxw(2);t.Q6J("matTooltip",Z.optionsFor(u)),t.xp6(1),t.AsE(" ",u.options.length," option",1===u.options.length?"":"s"," selected ")}}function P(_,m){if(1&_){const u=t.EpF();t.TgZ(0,"div",34)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,N,2,3,"div",35),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",36),t.NdJ("ngModelChange",function(J){const Q=t.CHM(u).$implicit,G=t.oxw(2);return t.KtG(G.updateItemQuantity(Q,J))}),t.qZA()()}if(2&_){const u=m.$implicit,Z=t.oxw(2);t.xp6(3),t.Oqu(u.name),t.xp6(1),t.Q6J("ngIf",u.options.length),t.xp6(2),t.hij(" ",t.xi3(7,4,u.total_cost/100,Z.code)," "),t.xp6(2),t.Q6J("ngModel",u.quantity)}}function E(_,m){if(1&_&&(t.TgZ(0,"header",32)(1,"h3"),t._uU(2,"Confirm Order"),t.qZA()(),t.TgZ(3,"div",9),t.YNc(4,P,9,7,"div",33),t.qZA()),2&_){const u=t.oxw();t.xp6(4),t.Q6J("ngForOf",u.order.items)}}class h extends o.cx{get code(){return this._org.currency_code}constructor(m,u){super(),this._org=m,this._data=u,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var m=this;return(0,e.Z)(function*(){m.loading="Loading menu...",m.order=new r.G(m._data.order),m.rules=yield m._data.getCateringConfig(m.order.event?.space?.level?.parent_id),m._data.menu.subscribe(u=>{m.loading="Loading menu...";const Z=(0,o.Tw)(u.map(w=>w.category)),J={};for(const w of Z)J[w]=u.filter(Q=>Q.category===w&&(0,y.R)(Q,m.rules,m.order.event));m.categories=Z,m.menu_items=J,m.updateMenuQuantities(),m.timeout("clear_loading",()=>m.loading="",1e3)})})()}addItem(m,u=!0){const Z=this.order.items.find(J=>J.id===m.id&&J.options.length===J.options.reduce((w,Q)=>w+(m.options.find(G=>Q.id===G.id)?1:0),0));u&&m.options?.length?this._data.selectOptions(m.options).then(J=>{const w=new d.U({...m,options:J});this.addItem(w,!1)}):this.order=new r.G(Z?{...this.order,items:this.order.items.filter(J=>!(J.id===m.id&&J.options_string===m.options_string)).concat([new d.U({...m,quantity:Z.quantity+1})])}:{...this.order,items:this.order.items.concat([new d.U({...m,quantity:1})])}),this.updateMenuQuantities()}removeItem(m){this.order=new r.G({...this.order,items:this.order.items.filter(u=>u.id!==m.id&&u.options_string===m.options_string)}),this.updateMenuQuantities()}updateItemQuantity(m,u){const Z=this.order.items.find(w=>w.id===m.id&&w.options_string===m.options_string);let J=[...this.order.items];J=Z?this.order.items.filter(w=>!(w.id===m.id&&w.options_string===m.options_string)).concat([new d.U({...m,quantity:u})]):this.order.items.concat([new d.U({...m,quantity:u})]),J.sort((w,Q)=>w.name.localeCompare(Q.name)),this.order=new r.G({...this.order,items:J}),this.updateMenuQuantities()}updateMenuQuantities(){for(const m in this.menu_items)for(const u of this.menu_items[m])u.quantity=this.order.items.reduce((Z,J)=>J.id===u.id?Z+J.quantity:Z,0)}optionsFor(m){return m.options.map(u=>u.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}h.\u0275fac=function(m){return new(m||h)(t.Y36(l.w7),t.Y36(v.WI))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["icon","","matRipple","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["icon","","matRipple","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["btn","","matRipple","","mat-dialog-close","",1,"inverse"],["confirm","","btn","","matRipple","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["matRipple","",1,"inverse",3,"click"],["save","","btn","","matRipple","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(m,u){if(1&m&&(t.YNc(0,U,2,2,"div",0),t.YNc(1,M,4,2,"footer",1),t.YNc(2,D,4,1,"ng-template",null,2,t.W1O),t.YNc(4,E,5,1,"ng-template",null,3,t.W1O)),2&m){const Z=t.MAs(3);t.Q6J("ngIf",!u.loading)("ngIfElse",Z),t.xp6(1),t.Q6J("ngIf",!u.loading)}},dependencies:[L.sg,L.O5,I.uX,I.SP,v.ZT,A.gM,O.Fj,O.JJ,O.On,R.o,b.wG,x.Ou,K.R,L.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--54.css.map*/"]})},3129:(F,W,n)=>{n.d(W,{R:()=>T});var e=n(2560),t=n(1484),v=n(3245),o=n(4666),d=n(4792),r=n(2922),l=n(2508),y=n(5306),L=n(207);function I(g,s){if(1&g&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&g){const i=e.oxw().$implicit,a=e.oxw(3);e.xp6(1),e.hij(" +",e.xi3(2,1,i.unit_price/100,a.code)," ")}}function A(g,s){if(1&g&&(e.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,I,3,4,"div",17),e.qZA()()),2&g){const i=s.$implicit;e.Q6J("value",i.id),e.xp6(3),e.hij(" ",i.name," "),e.xp6(1),e.Q6J("ngIf",i.unit_price)}}function O(g,s){if(1&g){const i=e.EpF();e.ynx(0),e.TgZ(1,"mat-radio-group",10),e.NdJ("ngModelChange",function(c){e.CHM(i);const p=e.oxw().$implicit,f=e.oxw();return e.KtG(f.updateGroupOption(p,c))}),e.TgZ(2,"mat-radio-button",11)(3,"span",12),e._uU(4,"None"),e.qZA()(),e.YNc(5,A,5,3,"mat-radio-button",13),e.qZA(),e.BQk()}if(2&g){const i=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",null==i?null:i.options)}}function R(g,s){if(1&g&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&g){const i=e.oxw().$implicit,a=e.oxw(3);e.xp6(1),e.hij(" +",e.xi3(2,1,i.unit_price/100,a.code)," ")}}function b(g,s){if(1&g){const i=e.EpF();e.TgZ(0,"mat-checkbox",20),e.NdJ("ngModelChange",function(c){const f=e.CHM(i).$implicit,U=e.oxw(3);return e.KtG(U.option_state[f.id]=c)}),e.TgZ(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,R,3,4,"div",17),e.qZA()()}if(2&g){const i=s.$implicit,a=e.oxw(3);e.Q6J("ngModel",a.option_state[i.id]),e.xp6(3),e.hij(" ",i.name," "),e.xp6(1),e.Q6J("ngIf",i.unit_price)}}function x(g,s){if(1&g&&e.YNc(0,b,5,3,"mat-checkbox",19),2&g){const i=e.oxw().$implicit;e.Q6J("ngForOf",null==i?null:i.options)}}function K(g,s){if(1&g&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.qZA(),e.TgZ(3,"div",7),e.YNc(4,O,6,1,"ng-container",8),e.YNc(5,x,1,1,"ng-template",null,9,e.W1O),e.qZA()()),2&g){const i=s.$implicit,a=e.MAs(6);e.uIk("group",i.name),e.xp6(2),e.Oqu(i.name),e.xp6(2),e.Q6J("ngIf",!i.multiple)("ngIfElse",a)}}class T{constructor(s){this._data=s,this.event=new e.vpe,this.option_state={},this.code=this._data.code;const i=(0,v.Tw)(this._data.options.map(c=>c.group||"Other")),a=[];for(const c of i){const p=this._data.options.filter(f=>f.group===c);a.push({name:c,multiple:!!p.find(f=>f.multiple),options:p})}this.groups=a}updateGroupOption(s,i){for(const a of s.options)this.option_state[a.id]=a.id===i}saveOptions(){const s=this._data.options.filter(i=>this.option_state[i.id]);this.event.emit({reason:"done",metadata:{options:s}})}}T.\u0275fac=function(s){return new(s||T)(e.Y36(t.WI))},T.\u0275cmp=e.Xpm({type:T,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["icon","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(s,i){1&s&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Select options"),e.qZA(),e.TgZ(3,"button",0)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.TgZ(6,"main",1),e.YNc(7,K,7,4,"div",2),e.qZA(),e.TgZ(8,"footer",3)(9,"button",4),e.NdJ("click",function(){return i.saveOptions()}),e._uU(10," Save "),e.qZA()()),2&s&&(e.xp6(7),e.Q6J("ngForOf",i.groups))},dependencies:[o.sg,o.O5,t.ZT,d.oG,r.VQ,r.U0,l.JJ,l.On,y.o,L.wG,o.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--55.css.map*/"]})},961:(F,W,n)=>{n.d(W,{p:()=>g});var e=n(1670),t=n(1426),v=n(2851),d=(n(5163),n(2460)),r=n(2560),l=n(4666),y=n(8589),L=n(6896),I=n(5306),A=n(207),O=n(4204);function R(s,i){if(1&s&&(r.TgZ(0,"button",19),r._uU(1," View "),r.qZA()),2&s){const a=r.oxw(2);r.Q6J("matTooltip",a.order.notes)}}function b(s,i){if(1&s){const a=r.EpF();r.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),r._uU(4,"room_service"),r.qZA()()(),r.TgZ(5,"div",7),r._uU(6),r.ALo(7,"date"),r.qZA(),r.TgZ(8,"div",8),r._uU(9),r.qZA(),r.TgZ(10,"div",9),r._uU(11),r.qZA(),r.TgZ(12,"div",10),r._uU(13),r.qZA(),r.TgZ(14,"div",11),r.YNc(15,R,2,1,"button",12),r.qZA(),r.TgZ(16,"div",10),r._uU(17),r.qZA(),r.TgZ(18,"div",13)(19,"button",14)(20,"div",15),r._uU(21),r.qZA(),r.TgZ(22,"app-icon",16),r._uU(23,"arrow_drop_down"),r.qZA()()(),r.TgZ(24,"div",17)(25,"button",18),r.NdJ("click",function(){r.CHM(a);const p=r.oxw();return r.KtG(p.show_items=!p.show_items)}),r.TgZ(26,"app-icon"),r._uU(27),r.qZA()()()()}if(2&s){const a=r.oxw(),c=r.MAs(3);r.ekj("bg-gray-100",!a.show_items)("bg-gray-200",a.show_items),r.xp6(1),r.ekj("bg-gray-200",a.show_items)("dark:bg-neutral-700",a.show_items),r.xp6(5),r.hij(" ",r.xi3(7,19,a.order.deliver_at,"shortTime")," "),r.xp6(3),r.hij(" ",(null==a.order.event?null:a.order.event.space.display_name)||(null==a.order.event?null:a.order.event.space.name)||"~ No Location ~"," "),r.xp6(2),r.hij(" ",(null==a.order.event||null==a.order.event.organiser?null:a.order.event.organiser.name)||(null==a.order.event?null:a.order.event.host)||"~ Unknown Host ~"," "),r.xp6(2),r.Oqu(a.order.charge_code||"~ No Code ~"),r.xp6(2),r.Q6J("ngIf",a.order.notes),r.xp6(2),r.hij(" ",a.order.invoice_number||"~ No Invoice ~"," "),r.xp6(2),r.Udp("background",null==a.status?null:a.status.colour),r.Q6J("matMenuTriggerFor",c),r.xp6(2),r.hij(" ",null==a.status?null:a.status.name," "),r.xp6(6),r.Oqu(a.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function x(s,i){1&s&&r._UZ(0,"li",22),2&s&&r.Q6J("item",i.$implicit)}function K(s,i){if(1&s&&(r.TgZ(0,"ul",20),r.YNc(1,x,1,1,"li",21),r.qZA()),2&s){const a=r.oxw();r.ekj("shown",a.show_items),r.Q6J("@show",a.show_items?"show":"hide"),r.xp6(1),r.Q6J("ngForOf",a.order.items)}}function T(s,i){if(1&s){const a=r.EpF();r.TgZ(0,"button",23),r.NdJ("click",function(){const f=r.CHM(a).$implicit,U=r.oxw();return r.KtG(U.updateStatus(f.id))}),r._UZ(1,"div",24),r.TgZ(2,"span",25),r._uU(3),r.qZA()()}if(2&s){const a=i.$implicit;r.xp6(1),r.Udp("background-color",a.colour),r.xp6(2),r.Oqu(a.name)}}class g extends t.cx{get status(){return this.statuses.find(i=>i.id===this.order.status)}constructor(i){var a;super(),a=this,this._orders=i,this.show_items=!1,this.statuses=d.U,this.updateStatus=function(){var c=(0,e.Z)(function*(p){yield a._orders.updateStatus(a.order,p),a.timeout("status-change",()=>a.order.status=p)});return function(p){return c.apply(this,arguments)}}()}}g.\u0275fac=function(i){return new(i||g)(r.Y36(v.I))},g.\u0275cmp=r.Xpm({type:g,selectors:[["catering-order"]],inputs:{order:"order"},features:[r.qOj],decls:5,vars:3,consts:[["class","w-full flex items-center py-2 dark:bg-neutral-700",3,"bg-gray-100","bg-gray-200",4,"ngIf"],["class","list-none p-0 m-0 w-full relative z-0",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2","dark:bg-neutral-700"],[1,"w-20","flex","items-center","justify-center","z-20","h-full"],[1,"rounded-full","bg-gray-400","dark:bg-neutral-800","p-2","text-2xl","text-black","dark:text-white","opacity-60","flex","items-center","justify-center"],["time","",1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-24"],["class","clear underline",3,"matTooltip",4,"ngIf"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["icon","",3,"click"],[1,"clear","underline",3,"matTooltip"],[1,"list-none","p-0","m-0","w-full","relative","z-0"],["catering-order-item","","class","flex items-center",3,"item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(i,a){1&i&&(r.YNc(0,b,28,22,"div",0),r.YNc(1,K,2,4,"ul",1),r.TgZ(2,"mat-menu",null,2),r.YNc(4,T,4,3,"button",3),r.qZA()),2&i&&(r.Q6J("ngIf",a.order),r.xp6(1),r.Q6J("ngIf",null==a.order?null:a.order.items.length),r.xp6(3),r.Q6J("ngForOf",a.statuses))},dependencies:[l.sg,l.O5,y.VK,y.OP,y.p6,L.gM,I.o,A.wG,O.m,l.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}\n/*# sourceMappingURL=catering-order.component.ts-angular-inline--60.css.map*/"],data:{animation:[t.X7]}})},2851:(F,W,n)=>{n.d(W,{I:()=>g});var e=n(1670),t=n(4505),v=n(7716),o=n(823),d=n(9095),r=n(6942),l=n(8759),y=n(9128),L=n(1810),I=n(9377),A=n(3200),O=n(1426),R=n(4211),b=n(3902),x=n(5163),K=n(2560);class g extends O.cx{get filters(){return this._filters.getValue()}set filters(i){this._filters.next(i)}constructor(){super(),this._poll=new t.X(0),this._loading=new t.X(!1),this._filters=new t.X({}),this.orders=(0,v.aj)([this._filters,this._poll]).pipe((0,o.b)(500),(0,d.w)(([{date:i,zones:a}])=>{this._loading.next(!0);const c=(0,L.Z)((0,I.Z)(i||Date.now())),p=(0,L.Z)((0,A.Z)(i||Date.now()));return(0,R.u$)({zone_ids:(a||[]).join(","),period_start:c,period_end:p})}),(0,r.U)(i=>(0,O.xH)(i.map(a=>a.ext("catering")))),(0,l.b)(()=>this._loading.next(!1)),(0,y.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,r.U)(i=>i.filter(a=>function T(s,i){const a=(i.search||"").toLowerCase();return!!s.items.find(c=>c.name.toLowerCase().includes(a)||!!c.options.find(p=>p.name.toLowerCase().includes(a)))}(a,this._filters.getValue())))),this.subscription("changes",this.orders.subscribe())}startPolling(i=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),i)}stopPolling(){this.clearInterval("polling")}updateStatus(i,a){var c=this;return(0,e.Z)(function*(){const p=new x.G({...i,status:a}),f=[...i.event.ext("catering").filter(C=>C.id!==i.id),p].map(C=>new x.G({...C})),U=new b.y({...i.event,catering:f}),B=yield(0,R.ry)(U).toPromise();return c._poll.next(Date.now()),B})()}}g.\u0275fac=function(i){return new(i||g)},g.\u0275prov=K.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})},2481:(F,W,n)=>{n.d(W,{C:()=>T});var e=n(1670),t=n(1426),v=n(6221),o=n(8840),d=n(3910),r=n(3858),l=n(2560),y=n(4666),L=n(1484),I=n(4792),A=n(5306),O=n(207),R=n(1708);function b(g,s){if(1&g){const i=l.EpF();l.TgZ(0,"tr",14),l.NdJ("click",function(){const p=l.CHM(i).$implicit,f=l.oxw(2);return l.KtG(f.toggleRoom(p.id))}),l.TgZ(1,"td"),l._UZ(2,"mat-checkbox",15),l.qZA(),l.TgZ(3,"td"),l._uU(4),l.qZA(),l.TgZ(5,"td",16)(6,"span",17),l.ALo(7,"async"),l.ALo(8,"async"),l._uU(9),l.ALo(10,"async"),l.qZA()()()}if(2&g){const i=s.$implicit,a=l.oxw(2);let c,p,f;l.xp6(2),l.Q6J("checked",a.selected.includes(i.id)),l.xp6(2),l.Oqu(i.display_name||i.name),l.xp6(2),l.ekj("bg-green-600",!(null!=(c=l.lcZ(7,7,a.availability))&&c.includes(i.id)))("bg-red-600",null==(p=l.lcZ(8,9,a.availability))?null:p.includes(i.id)),l.xp6(3),l.hij(" ",null!=(f=l.lcZ(10,11,a.availability))&&f.includes(i.id)?"Disabled":"Enabled"," ")}}function x(g,s){if(1&g){const i=l.EpF();l.TgZ(0,"main",7)(1,"table",8)(2,"thead",9)(3,"tr")(4,"td",10),l.NdJ("click",function(){l.CHM(i);const c=l.oxw();return l.KtG(c.toggleRoom("*"))}),l._UZ(5,"mat-checkbox",11),l.ALo(6,"async"),l.ALo(7,"async"),l.qZA(),l._UZ(8,"td"),l.TgZ(9,"td",12),l._uU(10),l.ALo(11,"async"),l.qZA()()(),l.TgZ(12,"tbody"),l.YNc(13,b,11,13,"tr",13),l.ALo(14,"async"),l.qZA()()()}if(2&g){const i=l.oxw();let a,c,p;l.xp6(5),l.Q6J("checked",(null==(a=l.lcZ(6,4,i.rooms))?null:a.length)===i.selected.length)("indeterminate",i.selected.length>0&&(null==(c=l.lcZ(7,6,i.rooms))?null:c.length)!==i.selected.length),l.xp6(5),l.hij(" ",null==(p=l.lcZ(11,8,i.rooms))?null:p.length," Room(s) "),l.xp6(3),l.Q6J("ngForOf",l.lcZ(14,10,i.rooms))}}function K(g,s){1&g&&(l.TgZ(0,"main",18),l._UZ(1,"mat-spinner",19),l.TgZ(2,"p"),l._uU(3,"Saving disabled room list..."),l.qZA()())}class T{constructor(s,i){this._catering=s,this._org=i,this.loading=!1,this.selected=[],this.rooms=(0,o.u2)(this._org.building.id),this.availability=this._catering.availability}toggleRoom(s){var i=this;return(0,e.Z)(function*(){if("*"===s){const a=yield i.rooms.pipe((0,d.q)(1)).toPromise();i.selected=i.selected.length!==a.length?a.map(c=>c.id):[]}else i.selected=i.selected.includes(s)?i.selected.filter(a=>a!==s):[...i.selected,s]})()}enableSelected(){var s=this;return(0,e.Z)(function*(){s.loading=!0;const a=(yield s.availability.pipe((0,d.q)(1)).toPromise()).filter(c=>!s.selected.includes(c));yield s._catering.saveSettings({disabled_rooms:a}).catch(()=>null),s.loading=!1})()}disableSelected(){var s=this;return(0,e.Z)(function*(){const i=yield s.availability.pipe((0,d.q)(1)).toPromise(),a=(0,t.Tw)(i.concat(s.selected));yield s._catering.saveSettings({disabled_rooms:a}).catch(()=>null),s.loading=!1})()}}T.\u0275fac=function(s){return new(s||T)(l.Y36(r.jW),l.Y36(v.w7))},T.\u0275cmp=l.Xpm({type:T,selectors:[["catering-rooms-state-modal"]],decls:15,vars:2,consts:[[1,"flex","items-center","justify-between","p-2"],[1,"p-2"],["icon","","mat-dialog-close",""],["class","max-h-[65vh] overflow-auto",4,"ngIf","ngIfElse"],[1,"flex","items-center","p-2","justify-end","space-x-2","border-t","border-gray-200","dark:border-neutral-500"],["btn","","matRipple","",3,"click"],["load_state",""],[1,"max-h-[65vh]","overflow-auto"],[1,"min-w-[32rem]"],[1,"border-b","border-gray-200","dark:border-neutral-500"],[1,"w-12",3,"click"],[1,"pointer-events-none",3,"checked","indeterminate"],[1,"text-right","text-xs"],["class","hover:bg-black/10 dark:hover:bg-white/5",3,"click",4,"ngFor","ngForOf"],[1,"hover:bg-black/10","dark:hover:bg-white/5",3,"click"],[1,"pointer-events-none",3,"checked"],[1,"text-right"],[1,"px-2","py-1","rounded-2xl"],[1,"w-64","h-48","p-8","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"]],template:function(s,i){if(1&s&&(l.TgZ(0,"div")(1,"header",0)(2,"h3",1),l._uU(3,"Set Catering Availability for Rooms"),l.qZA(),l.TgZ(4,"button",2)(5,"app-icon"),l._uU(6,"close"),l.qZA()()(),l.YNc(7,x,15,12,"main",3),l.TgZ(8,"footer",4)(9,"button",5),l.NdJ("click",function(){return i.enableSelected()}),l._uU(10," Enable Selected "),l.qZA(),l.TgZ(11,"button",5),l.NdJ("click",function(){return i.disableSelected()}),l._uU(12," Disable Selected "),l.qZA()()(),l.YNc(13,K,4,0,"ng-template",null,6,l.W1O)),2&s){const a=l.MAs(14);l.xp6(7),l.Q6J("ngIf",!i.loading)("ngIfElse",a)}},dependencies:[y.sg,y.O5,L.ZT,I.oG,A.o,O.wG,R.Ou,y.Ov],styles:["td[_ngcontent-%COMP%]{padding:.5rem}\n/*# sourceMappingURL=catering-rooms-state-modal.component.ts-angular-inline--63.css.map*/"]})},729:(F,W,n)=>{n.d(W,{j:()=>U});var e=n(1670),t=n(308),v=n(4505),o=n(4139),d=n(9151),r=n(9095),l=n(7418),y=n(6942),L=n(8759),I=n(9128),A=n(5670),O=n(3910),R=n(1426),b=n(6221),x=n(6336),K=n(7413),T=n(2090),g=n(2962),s=n(5163),i=n(9504),a=n(3129),c=n(5730),p=n(2560),f=n(1484);class U extends R.cx{get is_editable(){return!this.zone||this.zone===this._org.building?.id}get categories(){const C=this._menu.getValue();return(0,R.Tw)(C.map(M=>M.category))}constructor(C,M,D){var N;super(),N=this,this._org=C,this._dialog=M,this._settings=D,this._updated=new v.X(0),this._menu=new v.X([]),this._loading=new v.X(!1),this._currency=new v.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.settings=this._org.active_building.pipe((0,d.h)(P=>!!P),(0,r.w)(P=>(0,t.rlq)(P.id,"catering-settings").pipe((0,l.K)(E=>(0,o.of)({})))),(0,y.U)(P=>P.details||{}),(0,L.b)(P=>this._settings.post("require_catering_notes",!!P?.require_notes)),(0,I.d)(1)),this.charge_codes=this.settings.pipe((0,y.U)(P=>P.charge_codes||[])),this.availability=this.settings.pipe((0,y.U)(P=>P.disabled_rooms||[])),this.zone="",this.subscription("building",this._org.active_building.subscribe(function(){var P=(0,e.Z)(function*(E){if(E){const h=(yield N.getCateringForZone(E.id)).map(_=>new g.U(_));N._currency.next(N._settings.get("app.currency")||E.currency||"USD"),N._menu.next(h)}});return function(E){return P.apply(this,arguments)}}()))}manageCateringOrder(C){var M=this;return(0,e.Z)(function*(){const D=M._dialog.open(i.W,{data:{code:M._currency.getValue(),order:C,menu:M.menu,loading:M.loading,getCateringConfig:P=>M.getCateringConfig(P),selectOptions:P=>M.selectOptions(P)}}),N=yield Promise.race([D.componentInstance.event.pipe((0,A.P)(P=>"done"===P.reason)).toPromise(),D.afterClosed().toPromise()]);return D.close(),N?.metadata?.order||C})()}addItem(C=new g.U){var M=this;return(0,e.Z)(function*(){const D=M._dialog.open(x.w,{data:{item:C,categories:M.categories}}),N=yield Promise.race([D.componentInstance.event.pipe((0,A.P)(h=>"done"===h.reason)).toPromise(),D.afterClosed().toPromise()]);if("done"!==N?.reason)return;const P=M._menu.getValue(),E=P.findIndex(h=>h.id===C.id);E>=0?P.splice(E,1,N.metadata.item):P.push(N.metadata.item),M.updateMenu(M._org.building.id,P).then(()=>{M._menu.next([...P]),D.close()},()=>D.componentInstance.loading=!1)})()}updateItem(C){const M=this._menu.getValue(),D=M.findIndex(N=>N.id===C.id);D>=0?M.splice(D,1,C):M.push(C),this.updateMenu(this._org.building.id,M).then(()=>this._menu.next([...M]))}addOption(C,M={}){var D=this;return(0,e.Z)(function*(){const N=(0,R.Tw)(C.options.map(m=>m.group)),P=D._dialog.open(K.M,{data:{parent:C,option:M,types:N}}),E=yield Promise.race([P.componentInstance.event.pipe((0,A.P)(m=>"done"===m.reason)).toPromise(),P.afterClosed().toPromise()]);if("done"!==E?.reason)return;const h=D._menu.getValue(),_=h.findIndex(m=>m.id===C.id);_>=0?h.splice(_,1,E.metadata.item):h.push(E.metadata.item),D.updateMenu(D._org.building.id,h).then(()=>{D._menu.next([...h]),P.close()},()=>P.componentInstance.loading=!1)})()}selectOptions(C){var M=this;return(0,e.Z)(function*(){const D=M._dialog.open(a.R,{data:{code:M._currency.getValue(),options:C}}),N=yield Promise.race([D.componentInstance.event.pipe((0,A.P)(P=>"done"===P.reason)).toPromise(),D.afterClosed().toPromise()]);return"done"!==N?.reason?[]:(D.close(),N.metadata.options)})()}deleteItem(C){var M=this;return(0,e.Z)(function*(){const D=yield(0,R._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${C.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},M._dialog);if("done"!==D.reason)return;D.loading("Removing catering item...");const N=M._menu.getValue().filter(P=>C.id!==P.id);M.updateMenu(M._org.building.id,N).then(()=>{M._menu.next([...N]),D.close()},()=>D.loading(""))})()}deleteOption(C,M){var D=this;return(0,e.Z)(function*(){const N=yield(0,R._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${M.name}" from "${C.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},D._dialog);if("done"!==N.reason)return;N.loading("Removing catering item option...");const P=D._menu.getValue();P.splice(P.findIndex(E=>E.id===C.id),1,new g.U({...C,options:C.options.filter(E=>E.id!==M.id)})),D.updateMenu(D._org.building.id,P).then(()=>{D._menu.next([...P]),N.close()},()=>N.loading(""))})()}editConfig(){var C=this;return(0,e.Z)(function*(){const M=yield C.getCateringConfig(C._org.building.id),{require_notes:D}=yield C.settings.pipe((0,O.q)(1)).toPromise(),N=C._menu.getValue(),P=(0,R.Tw)((0,R.xH)(N.map(_=>[_.category,..._.tags]))),E=C._dialog.open(T.S,{data:{config:M,types:P,require_notes:D,saveNotes:_=>C.saveSettings({require_notes:_})}}),h=yield Promise.race([E.componentInstance.event.pipe((0,A.P)(_=>"done"===_.reason)).toPromise(),E.afterClosed().toPromise()]);"done"===h?.reason&&C.updateConfig(C._org.building.id,h.metadata).then(()=>E.close(),()=>E.componentInstance.loading=!1)})()}importMenu(){var C=this;return(0,e.Z)(function*(){const M=C._dialog.open(c.m),D=yield Promise.race([M.componentInstance.event.pipe((0,A.P)(h=>"done"===h.reason)).toPromise(),M.afterClosed().toPromise()]);if("done"!==D?.reason)return;M.componentInstance.loading="Updating menu...";const N=C._menu.getValue(),P=C._org.building,E=(0,R.Tw)(D.metadata.concat(N),"id");yield C.updateMenu(P.id,E).catch(h=>{throw(0,R.cB)("Error importing catering menu"),M.close(),h}),(0,R.t5)(`Successfully imported catering menu. ${D.metadata.length} item(s) added.`),M.close()})()}updateMenu(C,M){return(0,t.Ymr)(C,{id:C,name:"catering",details:M,description:`Catering menu for ${C}`}).toPromise()}saveSettings(C){var M=this;return(0,e.Z)(function*(){const D=yield M.settings.pipe((0,O.q)(1)).toPromise();return(0,t.Ymr)(M._org.building.id,{id:M._org.building.id,name:"catering-settings",details:{...D,...C},description:`Catering settings for ${M._org.building.id}`}).toPromise()})()}getCateringForZone(C){return(0,e.Z)(function*(){const M=(yield(0,t.rlq)(C,"catering").toPromise()).details;return M instanceof Array?M:[]})()}getCateringConfig(C=this._org.building.id){return(0,e.Z)(function*(){const M=(yield(0,t.rlq)(C,"catering_config").toPromise()).details;return M instanceof Array?M:[]})()}updateConfig(C,M){return(0,t.Ymr)(C,{id:C,name:"catering_config",details:M,description:`Catering menu config for ${C}`}).toPromise()}addItemToOrder(C,M){let D=C.items;const N=D.find(E=>E.id===M.id&&M.options?.length===E.options?.reduce((h,_)=>h+(M.options.find(m=>_.id===m.id)?1:0),0));return N?N.quantity+=1:D=D.concat([new g.U({...M,quantity:1})]),new s.G({...C,items:D,event:null})}}U.\u0275fac=function(C){return new(C||U)(p.LFG(b.w7),p.LFG(f.uw),p.LFG(R.gb))},U.\u0275prov=p.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"})},7701:(F,W,n)=>{n.d(W,{g:()=>e});const e=[{id:"after_hour",name:"After Hour of Day"},{id:"before_hour",name:"Before Hour of Day"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Hours before Meeting"},{id:"within_hours",name:"Within Hours before Meeting"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}]},7543:(F,W,n)=>{n.d(W,{u:()=>_});var e=n(4666),t=n(2508),v=n(8550),o=n(4792),d=n(1484),r=n(8589),l=n(5892),y=n(2922),L=n(6896),I=n(5074),A=n(9816),O=n(5812),E=(n(2090),n(6336),n(8644),n(8501),n(7413),n(4204),n(2189),n(9504),n(3129),n(961),n(5730),n(3893),n(1655),n(1581),n(5486),n(6037),n(2481),n(5362),n(9471),n(2560));class _{}_.\u0275fac=function(u){return new(u||_)},_.\u0275mod=E.oAB({type:_}),_.\u0275inj=E.cJS({imports:[e.ez,r.Tx,l.Nh,v.Bb,d.Is,o.p9,y.Fk,L.AV,t.u5,t.UX,O.K,I.lN,A.W9]})},3858:(F,W,n)=>{n.d(W,{GX:()=>O.G,Ii:()=>R.I,Ud:()=>d.U,jW:()=>b.j}),n(3129),n(9504),n(2090),n(6336);var d=n(2962),O=(n(8644),n(8501),n(7413),n(4204),n(961),n(2189),n(5163)),R=n(2851),b=n(729);n(7701),n(7543),n(2460),n(3893)},2460:(F,W,n)=>{n.d(W,{U:()=>e});const e=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]},5362:(F,W,n)=>{n.d(W,{F:()=>g});var e=n(1670),t=n(1426),v=n(3910),o=n(729),d=n(2560),r=n(1484),l=n(4666),y=n(2508),L=n(5306),I=n(5074),A=n(207),O=n(1267),R=n(1708);function b(s,i){if(1&s){const a=d.EpF();d.TgZ(0,"div",6)(1,"mat-form-field",7)(2,"input",8),d.NdJ("ngModelChange",function(p){const U=d.CHM(a).index,B=d.oxw(2);return d.KtG(B.charge_codes[U]=p)}),d.qZA()(),d.TgZ(3,"button",9),d.NdJ("click",function(){const f=d.CHM(a).index,U=d.oxw(2);return d.KtG(U.removeCode(f))}),d.TgZ(4,"app-icon"),d._uU(5,"delete"),d.qZA()()()}if(2&s){const a=i.index,c=d.oxw(2);d.xp6(2),d.Q6J("ngModel",c.charge_codes[a])}}function x(s,i){if(1&s&&(d.TgZ(0,"main",4),d.YNc(1,b,6,1,"div",5),d.qZA()),2&s){const a=d.oxw();d.xp6(1),d.Q6J("ngForOf",a.charge_codes)("ngForTrackBy",a.trackByFn)}}function K(s,i){if(1&s){const a=d.EpF();d.TgZ(0,"footer",10)(1,"button",11),d._uU(2," Import Codes "),d.TgZ(3,"input",12),d.NdJ("change",function(p){d.CHM(a);const f=d.oxw();return d.KtG(f.addCodesFromFile(p))}),d.qZA()(),d.TgZ(4,"button",13),d.NdJ("click",function(){d.CHM(a);const p=d.oxw();return d.KtG(p.newCode())}),d._uU(5," Add Code "),d.qZA(),d.TgZ(6,"button",13),d.NdJ("click",function(){d.CHM(a);const p=d.oxw();return d.KtG(p.saveChargeCodes())}),d._uU(7," Save Changes "),d.qZA()()}}function T(s,i){1&s&&(d.TgZ(0,"main",14),d._UZ(1,"mat-spinner",15),d.TgZ(2,"p"),d._uU(3,"Saving changes to charge codes..."),d.qZA()())}class g{constructor(i,a){this._state=i,this._dialog_ref=a,this.charge_codes=[],this.loading=!1}ngOnInit(){var i=this;return(0,e.Z)(function*(){i.charge_codes=(yield i._state.charge_codes.pipe((0,v.q)(1)).toPromise())||[]})()}newCode(){this.charge_codes.push("")}removeCode(i){this.charge_codes.splice(i,1)}addCodesFromFile(i){if(i.target){const a=i.target.files[0];if(a){const c=new FileReader;c.readAsText(a,"UTF-8"),c.addEventListener("load",p=>{const f=(0,t.n5)(p.srcElement.result)||[];for(const{code:U}of f)this.charge_codes.push(U);this.charge_codes=(0,t.Tw)(this.charge_codes),i.target.value=""}),c.addEventListener("error",p=>(0,t.cB)("Error reading file."))}}}saveChargeCodes(){var i=this;return(0,e.Z)(function*(){i.loading=!0;const a=i.charge_codes.filter(c=>c&&c.trim());yield i._state.saveSettings({charge_codes:a}),i._dialog_ref.close()})()}trackByFn(i,a){return i}}g.\u0275fac=function(i){return new(i||g)(d.Y36(o.j),d.Y36(r.so))},g.\u0275cmp=d.Xpm({type:g,selectors:[["charge-code-list-modal"]],decls:10,vars:3,consts:[["icon","","mat-dialog-close",""],["class","overflow-auto max-h-[65vh] min-h-[20rem] flex flex-col",4,"ngIf","ngIfElse"],["class","flex items-center p-2 space-x-2 border-t border-gray-200",4,"ngIf"],["load_state",""],[1,"overflow-auto","max-h-[65vh]","min-h-[20rem]","flex","flex-col"],["class","flex items-center space-x-2 w-full hover:bg-black/10 px-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","space-x-2","w-full","hover:bg-black/10","px-2"],["appearance","outline",1,"h-14","flex-1"],["matInput","","placeholder","Charge Code",3,"ngModel","ngModelChange"],["icon","",3,"click"],[1,"flex","items-center","p-2","space-x-2","border-t","border-gray-200"],["btn","","matRipple","",1,"w-48","inverse","relative"],["type","file",1,"opacity-0","absolute","inset-0",3,"change"],["btn","","matRipple","",1,"w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-20","space-y-2"],["diameter","32"]],template:function(i,a){if(1&i&&(d.TgZ(0,"header")(1,"h2"),d._uU(2,"Edit Charge Codes"),d.qZA(),d.TgZ(3,"button",0)(4,"app-icon"),d._uU(5,"close"),d.qZA()()(),d.YNc(6,x,2,2,"main",1),d.YNc(7,K,8,0,"footer",2),d.YNc(8,T,4,0,"ng-template",null,3,d.W1O)),2&i){const c=d.MAs(9);d.xp6(6),d.Q6J("ngIf",!a.loading)("ngIfElse",c),d.xp6(1),d.Q6J("ngIf",!a.loading)}},dependencies:[l.sg,l.O5,r.ZT,y.Fj,y.JJ,y.On,L.o,I.KE,A.wG,O.Nt,R.Ou]})}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map