"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{9364:(H,W,n)=>{n.d(W,{Ud:()=>X.U,GX:()=>tt.G,Ii:()=>et.I,jW:()=>nt.j,uy:()=>F});var e=n(4666),t=n(2508),O=n(8550),_=n(4792),r=n(1484),R=n(8589),w=n(5892),L=n(2922),Z=n(6896),x=n(5340),o=(n(2090),n(6336),n(8644),n(8501),n(7413),n(4204),n(2189),n(9504),n(3129),n(961),n(5730),n(3294),n(2560));n(5306),n(4522),n(4505),n(7716),n(6942),n(9128);var b=n(5074),B=n(3560);let F=(()=>{class E{}return E.\u0275fac=function(m){return new(m||E)},E.\u0275mod=o.oAB({type:E}),E.\u0275inj=o.cJS({imports:[e.ez,R.Tx,w.Nh,O.Bb,r.Is,_.p9,L.Fk,Z.AV,t.u5,t.UX,x.K,b.lN,B.W9]}),E})();var X=n(2962),tt=n(5163),et=n(2851),nt=n(729);n(7701),n(2460)},2090:(H,W,n)=>{n.d(W,{S:()=>f});var e=n(2560),t=n(1484),O=n(7701),_=n(4666),r=n(207),R=n(2508),w=n(5306),L=n(5074),Z=n(7371),x=n(4522),D=n(1267);function I(u,a){1&u&&(e.TgZ(0,"button",5)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function P(u,a){if(1&u&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&u){const d=a.$implicit;e.Q6J("value",d.id),e.xp6(1),e.hij(" ",d.name," ")}}function T(u,a){if(1&u){const d=e.EpF();e.TgZ(0,"div",14)(1,"mat-form-field",8)(2,"mat-select",15),e.NdJ("ngModelChange",function(s){const o=e.CHM(d).$implicit;return e.KtG(o[0]=s)}),e.YNc(3,P,2,2,"mat-option",16),e.qZA()(),e.TgZ(4,"mat-form-field",8)(5,"input",17),e.NdJ("ngModelChange",function(s){const o=e.CHM(d).$implicit;return e.KtG(o[1]=s)}),e.qZA(),e.TgZ(6,"mat-error"),e._uU(7,"Rule value is required"),e.qZA()()()}if(2&u){const d=a.$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("ngModel",d[0]),e.xp6(1),e.Q6J("ngForOf",i.rule_types),e.xp6(2),e.Q6J("ngModel",d[1])}}function g(u,a){if(1&u){const d=e.EpF();e.TgZ(0,"div",6)(1,"div",7)(2,"mat-form-field",8)(3,"input",9),e.NdJ("ngModelChange",function(s){const o=e.CHM(d).$implicit;return e.KtG(o.name=s)}),e.qZA(),e.TgZ(4,"mat-error"),e._uU(5,"Ruleset name is required"),e.qZA()(),e.TgZ(6,"button",10),e.NdJ("click",function(){const c=e.CHM(d).$implicit,o=e.oxw();return c.rules.push(["",""]),e.KtG(o.show_rules=c.id)}),e.TgZ(7,"app-icon"),e._uU(8,"add"),e.qZA()(),e.TgZ(9,"button",11),e.NdJ("click",function(){const c=e.CHM(d).$implicit,o=e.oxw();return e.KtG(o.show_rules=o.show_rules!==c.id?c.id:"")}),e.TgZ(10,"app-icon"),e._uU(11),e.qZA()()(),e.TgZ(12,"div",12),e.YNc(13,T,8,3,"div",13),e.qZA()()}if(2&u){const d=a.$implicit,i=e.oxw();e.xp6(3),e.Q6J("ngModel",d.name),e.xp6(6),e.Q6J("disabled",!d.rules.length),e.xp6(2),e.Oqu(i.show_rules===d.id?"expand_less":"expand_more"),e.xp6(1),e.Udp("height",(i.show_rules===d.id?3.5*d.rules.length:0)+"em"),e.xp6(1),e.Q6J("ngForOf",d.rules)}}let f=(()=>{class u{constructor(d){this._data=d,this.event=new e.vpe,this.loading=!1,this.rule_types=O.g,this.rulesets=(d.config||[]).map(i=>(i.rules=i.rules.map(s=>[s[0],JSON.stringify(s[1])]),i))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const d=this.rulesets.map(i=>({...i,rules:i.rules.map(s=>{let c=s[1];try{c=JSON.parse(s[1])}catch{}return[s[0],c]})}));this.event.emit({reason:"done",metadata:d})}}return u.\u0275fac=function(d){return new(d||u)(e.Y36(t.WI))},u.\u0275cmp=e.Xpm({type:u,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex px-2 h-14 space-x-2",4,"ngFor","ngForOf"],[1,"flex","px-2","h-14","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(d,i){1&d&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Edit Catering Configuration"),e.qZA(),e.YNc(3,I,3,0,"button",0),e.qZA(),e.TgZ(4,"main",1)(5,"button",2),e.NdJ("click",function(){return i.rulesets.push({id:i.new_id,rules:[]})}),e._uU(6," New Ruleset "),e.qZA(),e.YNc(7,g,14,6,"div",3),e.qZA(),e.TgZ(8,"footer",4)(9,"button",2),e.NdJ("click",function(){return i.saveChanges()}),e._uU(10,"Save Changes"),e.qZA()()),2&d&&(e.xp6(3),e.Q6J("ngIf",!i.loading),e.xp6(4),e.Q6J("ngForOf",i.rulesets))},dependencies:[_.sg,_.O5,r.ey,t.ZT,R.Fj,R.JJ,R.Q7,R.On,w.o,L.TO,L.KE,Z.gD,x.lW,D.Nt],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}\n/*# sourceMappingURL=catering-config-modal.component.ts-angular-inline--84.css.map*/"]}),u})()},5730:(H,W,n)=>{n.d(W,{m:()=>I});var e=n(2560),t=n(3294),O=n(2962),_=n(4666),r=n(1484),R=n(5306),w=n(4522),L=n(1708);function Z(P,T){1&P&&(e.TgZ(0,"button",4)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function x(P,T){if(1&P){const g=e.EpF();e.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),e._uU(3,"upload"),e.qZA(),e.TgZ(4,"p"),e._uU(5,"Click to select file or Drag and drop files"),e.qZA(),e.TgZ(6,"input",7),e.NdJ("change",function(u){e.CHM(g);const a=e.oxw();return e.KtG(a.handleFileEvent(u))}),e.qZA()(),e.TgZ(7,"div",8)(8,"button",9),e.NdJ("click",function(){e.CHM(g);const u=e.oxw();return e.KtG(u.downloadTemplate())}),e._uU(9," Download Template "),e.qZA()()()}}function D(P,T){if(1&P&&(e.TgZ(0,"main",10),e._UZ(1,"mat-spinner",11),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&P){const g=e.oxw();e.xp6(3),e.Oqu(g.loading)}}let I=(()=>{class P{constructor(){this.event=new e.vpe}handleFileEvent(g){this.loading="Processing menu data...";const f=g.target;if(!f?.files)return this.loading="";const u=f.files;if(!u.length)return this.loading="";const a=u[0],d=new FileReader;d.addEventListener("loadend",i=>{const c=(0,t.n5)(i.target.result);this.loading="",this.event.emit({reason:"done",metadata:c.filter(o=>"item"===(o.type||"").toLowerCase()).map(o=>new O.U({...o,options:c.filter(p=>"option"===(p.type||"").toLowerCase()&&p.tags===o.id).map(p=>({id:p.id,name:p.name,group:p.category,multiple:p.multiple,unit_price:p.unit_price}))}))})}),d.readAsText(a)}downloadTemplate(){(0,t.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return P.\u0275fac=function(g){return new(g||P)},P.\u0275cmp=e.Xpm({type:P,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["mat-button","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(g,f){if(1&g&&(e.TgZ(0,"header",0)(1,"h2"),e._uU(2,"Import Catering Menu"),e.qZA(),e.YNc(3,Z,3,0,"button",1),e.qZA(),e.YNc(4,x,10,0,"main",2),e.YNc(5,D,4,1,"ng-template",null,3,e.W1O)),2&g){const u=e.MAs(6);e.xp6(3),e.Q6J("ngIf",!f.loading),e.xp6(1),e.Q6J("ngIf",!f.loading)("ngIfElse",u)}},dependencies:[_.O5,r.ZT,R.o,w.lW,L.Ou]}),P})()},6336:(H,W,n)=>{n.d(W,{w:()=>k});var e=n(8456),t=n(2560),O=n(2508),_=n(1484),r=n(3294),R=n(2962),w=n(4666),L=n(8550),Z=n(207),x=n(4792),D=n(5306),I=n(5074),P=n(4522),T=n(1267),g=n(1708),f=n(1169),u=n(2793);function a(U,S){1&U&&(t.TgZ(0,"button",7)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function d(U,S){if(1&U&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",18),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA()()()),2&U){const h=t.oxw(2);t.xp6(1),t.ekj("error",h.form.controls.name.invalid&&h.form.controls.name.touched)}}function i(U,S){if(1&U&&(t.TgZ(0,"div",15)(1,"label",19),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA()()()),2&U){const h=t.oxw(2),K=t.MAs(9);t.xp6(1),t.ekj("error",h.form.controls.category.invalid&&h.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",K)}}const s=function(){return{class:"material-icons",content:"close"}};function c(U,S){if(1&U){const h=t.EpF();t.TgZ(0,"mat-chip",27),t.NdJ("removed",function(){const q=t.CHM(h).$implicit,v=t.oxw(3);return t.KtG(v.removeTag(q))}),t._uU(1),t._UZ(2,"app-icon",28),t.qZA()}if(2&U){const h=S.$implicit;t.Q6J("selectable",!0)("removable",!0),t.xp6(1),t.hij(" ",h," "),t.xp6(1),t.Q6J("icon",t.DdM(4,s))}}function o(U,S){if(1&U){const h=t.EpF();t.TgZ(0,"div",15)(1,"label",21),t.SDv(2,22),t.qZA(),t.TgZ(3,"mat-form-field",17)(4,"mat-chip-list",23,24),t.YNc(6,c,3,5,"mat-chip",25),t.TgZ(7,"input",26),t.NdJ("matChipInputTokenEnd",function($){t.CHM(h);const q=t.oxw(2);return t.KtG(q.addTag($))}),t.qZA()()()()}if(2&U){const h=t.MAs(5),K=t.oxw(2);t.xp6(1),t.ekj("error",K.form.controls.tags.invalid&&K.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",K.tag_list),t.xp6(1),t.Q6J("matChipInputFor",h)("matChipInputSeparatorKeyCodes",K.separators)("matChipInputAddOnBlur",!0)}}function p(U,S){1&U&&(t.TgZ(0,"div",15)(1,"label",29),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",17),t._UZ(4,"textarea",30),t.qZA()())}function C(U,S){if(1&U&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",31),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA()()()),2&U){const h=t.oxw(2);t.xp6(1),t.ekj("error",h.form.controls.unit_price.invalid&&h.form.controls.unit_price.touched)}}function A(U,S){if(1&U&&(t.TgZ(0,"form",8),t.YNc(1,d,10,2,"div",9),t.YNc(2,i,10,3,"div",9),t.YNc(3,o,8,6,"div",9),t.YNc(4,p,5,0,"div",9),t.YNc(5,C,10,2,"div",9),t.TgZ(6,"div",10)(7,"label",11),t._uU(8,"Accept Points?"),t.qZA(),t.TgZ(9,"mat-checkbox",12),t._uU(10),t.qZA()(),t.TgZ(11,"div",10)(12,"label",13),t._uU(13,"Discount Cap"),t.qZA(),t._UZ(14,"a-counter",14),t.qZA()()),2&U){const h=t.oxw();let K;t.Q6J("formGroup",h.form),t.xp6(1),t.Q6J("ngIf",h.form.controls.name),t.xp6(1),t.Q6J("ngIf",h.form.controls.category),t.xp6(1),t.Q6J("ngIf",h.form.controls.tags),t.xp6(1),t.Q6J("ngIf",h.form.controls.description),t.xp6(1),t.Q6J("ngIf",h.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(K=h.form.get("accept_points"))&&K.value?"No":"Yes"),t.xp6(4),t.Q6J("min",0)("max",100)("step",5)("render_fn",h.renderPercent)}}function y(U,S){if(1&U){const h=t.EpF();t.TgZ(0,"footer",32)(1,"button",33),t.NdJ("click",function(){t.CHM(h);const $=t.oxw();return t.KtG($.saveChanges())}),t._uU(2," Save "),t.qZA()()}if(2&U){const h=t.oxw();t.xp6(1),t.Q6J("disabled",!h.form.dirty)}}function Q(U,S){1&U&&(t.TgZ(0,"div",34),t._UZ(1,"mat-spinner",35),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA()())}function V(U,S){if(1&U&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&U){const h=S.$implicit;t.Q6J("value",h),t.xp6(1),t.hij(" ",h," ")}}let k=(()=>{class U{constructor(h){this._data=h,this.event=new t.vpe,this.form=new O.cw({name:new O.NI(this.item.name||"",[O.kI.required]),description:new O.NI(this.item.description||""),category:new O.NI(this.item.category||"",[O.kI.required]),unit_price:new O.NI(this.item.unit_price,[O.kI.required]),tags:new O.NI(this.item.tags||[]),accept_points:new O.NI(this.item.accept_points||!1),discount_cap:new O.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[e.K5,e.OC,e.L_]}get item(){return this._data.item||new R.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(h=0){return`${h}%`}addTag(h){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const K=h.input,$=h.value,q=this.tag_list;($||"").trim()&&(q.push($),this.form.controls.tags.setValue(q)),K&&(K.value="")}removeTag(h){if(!this.form||!this.form.controls.tags)return;const K=this.tag_list;this.form.controls.tags.markAsDirty();const $=K.indexOf(h);$>=0&&(K.splice($,1),this.form.controls.tags.setValue(K))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new R.U({...this.item,id:this.item.id||`item-${(0,r.Iy)(99999999)}`,...this.form.value})}})}}return U.\u0275fac=function(h){return new(h||U)(t.Y36(_.WI))},U.\u0275cmp=t.Xpm({type:U,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let S,h;return S=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,h=$localize`:@@zoneTagsPlaceholder␟8dc7c13b0c6b8ad9c770bce0ad72e14b4aef8456␟3986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],S,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",h,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(h,K){if(1&h&&(t.TgZ(0,"header")(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,a,3,0,"button",1),t.qZA(),t.YNc(4,A,15,11,"form",2),t.YNc(5,y,3,1,"footer",3),t.YNc(6,Q,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,V,2,2,"mat-option",6),t.qZA()),2&h){const $=t.MAs(7);t.xp6(2),t.hij("",K.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!K.loading),t.xp6(1),t.Q6J("ngIf",K.form&&!K.loading)("ngIfElse",$),t.xp6(1),t.Q6J("ngIf",!K.loading),t.xp6(5),t.Q6J("ngForOf",K.categories)}},dependencies:[w.sg,w.O5,L.XC,L.ZL,Z.ey,_.ZT,_.uh,x.oG,O._Y,O.Fj,O.wV,O.JJ,O.JL,O.sg,O.u,D.o,I.TO,I.KE,P.lW,T.Nt,g.Ou,f.qn,f.HS,f.oH,f.qH,u.R],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--85.css.map*/"]}),U})()},8644:(H,W,n)=>{n.d(W,{V:()=>D});var e=n(729),t=n(2560),O=n(4666),_=n(8589),r=n(5306),R=n(4522);const w=["catering-menu-item",""];function L(I,P){if(1&I){const T=t.EpF();t.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"div"),t._uU(4),t.qZA(),t.TgZ(5,"div",8),t._uU(6),t.qZA()(),t.TgZ(7,"div",9),t._uU(8),t.ALo(9,"currency"),t.ALo(10,"async"),t.qZA()(),t.TgZ(11,"button",10)(12,"app-icon"),t._uU(13,"more_vert"),t.qZA()(),t.TgZ(14,"button",11),t.NdJ("click",function(){t.CHM(T);const f=t.oxw();return t.KtG(f.show_options=!f.show_options)}),t.TgZ(15,"app-icon"),t._uU(16,"expand_more"),t.qZA()()()}if(2&I){const T=t.oxw(),g=t.MAs(3);t.xp6(4),t.Oqu(T.item.name),t.xp6(2),t.hij(" ",T.item.category," "),t.xp6(2),t.hij(" ",t.xi3(9,5,T.item.unit_price/100,t.lcZ(10,8,T.symbol))," "),t.xp6(3),t.Q6J("matMenuTriggerFor",g),t.xp6(3),t.Q6J("disabled",!T.item.options.length)}}function Z(I,P){if(1&I){const T=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"div",16),t._uU(3),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.qZA()(),t.TgZ(6,"button",17),t.NdJ("click",function(){const u=t.CHM(T).$implicit,a=t.oxw(2);return t.KtG(a.editOption(u))}),t.TgZ(7,"app-icon"),t._uU(8,"edit"),t.qZA()(),t.TgZ(9,"button",18),t.NdJ("click",function(){const u=t.CHM(T).$implicit,a=t.oxw(2);return t.KtG(a.removeOption(u))}),t.TgZ(10,"app-icon"),t._uU(11,"delete"),t.qZA()()()}if(2&I){const T=P.$implicit;t.xp6(3),t.Oqu(T.name),t.xp6(2),t.Oqu(T.group)}}function x(I,P){if(1&I&&(t.TgZ(0,"div",12),t.YNc(1,Z,12,2,"div",13),t.qZA()),2&I){const T=t.oxw();t.Udp("height",T.show_options?3.5*T.item.options.length+"rem":"0"),t.xp6(1),t.Q6J("ngForOf",T.item.options)}}let D=(()=>{class I{constructor(T){this._catering=T,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=g=>this._catering.addOption(this.item,g),this.removeOption=g=>this._catering.deleteOption(this.item,g),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}get symbol(){return this._catering.currency}}return I.\u0275fac=function(T){return new(T||I)(t.Y36(e.j))},I.\u0275cmp=t.Xpm({type:I,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:w,decls:19,vars:2,consts:[["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-gray-100 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","text-dark-fade"],[1,"p-2","m-2","text-xs","font-bold","text-white","rounded","bg-primary"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-icon-button","",3,"disabled","click"],["options","",1,"bg-gray-100","overflow-hidden"],["class","flex p-2 items-center border-none border-t border-solid border-gray-300",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-none","border-t","border-solid","border-gray-300"],[1,"flex-1","px-2"],[1,"text"],["edit","","mat-icon-button","",1,"mx-2",3,"click"],["remove","","mat-icon-button","",1,"mx-2",3,"click"]],template:function(T,g){1&T&&(t.YNc(0,L,17,10,"div",0),t.YNc(1,x,2,3,"div",1),t.TgZ(2,"mat-menu",null,2)(4,"button",3),t.NdJ("click",function(){return g.addOption()}),t.TgZ(5,"app-icon"),t._uU(6,"add"),t.qZA(),t.TgZ(7,"div",4),t._uU(8,"Add Option"),t.qZA()(),t.TgZ(9,"button",3),t.NdJ("click",function(){return g.editItem()}),t.TgZ(10,"app-icon"),t._uU(11,"edit"),t.qZA(),t.TgZ(12,"div",4),t._uU(13,"Edit Item"),t.qZA()(),t.TgZ(14,"button",3),t.NdJ("click",function(){return g.removeItem()}),t.TgZ(15,"app-icon"),t._uU(16,"delete"),t.qZA(),t.TgZ(17,"div",4),t._uU(18,"Remove Item"),t.qZA()()()),2&T&&(t.Q6J("ngIf",g.item),t.xp6(1),t.Q6J("ngIf",g.item))},dependencies:[O.sg,O.O5,_.VK,_.OP,_.p6,r.o,R.lW,O.Ov,O.H9],styles:["[_nghost-%COMP%]{background-color:#fff;border:1px solid #ccc;border-radius:.25rem;overflow:hidden;width:768px;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=catering-menu-item.component.ts-angular-inline--89.css.map*/"]}),I})()},8501:(H,W,n)=>{n.d(W,{B:()=>T});var e=n(4505),t=n(6942),O=n(729),_=n(2560),r=n(4666),R=n(5892),w=n(5306),L=n(8644);function Z(g,f){if(1&g&&(_.ynx(0),_._UZ(1,"div",6),_.BQk()),2&g){const u=f.$implicit;_.xp6(1),_.Q6J("item",u)}}function x(g,f){if(1&g&&(_.ynx(0),_.YNc(1,Z,2,1,"ng-container",5),_.ALo(2,"async"),_.BQk()),2&g){const u=_.oxw();_.xp6(1),_.Q6J("ngForOf",_.lcZ(2,1,u.menu))}}function D(g,f){if(1&g&&(_.ynx(0),_._UZ(1,"div",6),_.BQk()),2&g){const u=f.$implicit;_.xp6(1),_.Q6J("item",u)}}function I(g,f){if(1&g&&(_.TgZ(0,"mat-tab",7),_.YNc(1,D,2,1,"ng-container",5),_.ALo(2,"async"),_.qZA()),2&g){const u=f.$implicit,a=_.oxw();_.Q6J("label",u),_.xp6(1),_.Q6J("ngForOf",_.lcZ(2,2,a.tab_menu)[u])}}function P(g,f){1&g&&(_.TgZ(0,"div",8)(1,"app-icon"),_._uU(2,"close"),_.qZA(),_.TgZ(3,"p"),_._uU(4,"No items in menu"),_.qZA()())}let T=(()=>{class g{constructor(u){this._catering=u,this.menu=this._catering.menu,this.shown_tab=new e.X(""),this.tab_menu=this.menu.pipe((0,t.U)(a=>{const d={};for(const i of this.categories)d[i]=a.filter(s=>s.category===i);return d}))}get categories(){return this._catering.categories}}return g.\u0275fac=function(u){return new(u||g)(_.Y36(O.j))},g.\u0275cmp=_.Xpm({type:g,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(u,a){if(1&u&&(_.TgZ(0,"mat-tab-group",0),_.NdJ("selectedIndexChange",function(i){return a.shown_tab.next(0===i?"":a.categories[i-1])}),_.TgZ(1,"mat-tab",1),_.YNc(2,x,3,3,"ng-container",2),_.ALo(3,"async"),_.qZA(),_.YNc(4,I,3,4,"mat-tab",3),_.qZA(),_.YNc(5,P,5,0,"ng-template",null,4,_.W1O)),2&u){const d=_.MAs(6);let i;_.xp6(2),_.Q6J("ngIf",null==(i=_.lcZ(3,3,a.menu))?null:i.length)("ngIfElse",d),_.xp6(2),_.Q6J("ngForOf",a.categories)}},dependencies:[r.sg,r.O5,R.SP,R.uX,w.o,L.V,r.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--90.css.map*/"]}),g})()},7413:(H,W,n)=>{n.d(W,{M:()=>p});var e=n(2560),t=n(2508),O=n(1484),_=n(3245),r=n(2962),R=n(4666),w=n(8550),L=n(207),Z=n(4792),x=n(5306),D=n(5074),I=n(4522),P=n(1267),T=n(1708);function g(C,A){1&C&&(e.TgZ(0,"button",7)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function f(C,A){if(1&C&&(e.TgZ(0,"div",10)(1,"label",11),e._uU(2," Name"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",12),e._UZ(7,"input",13),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()()),2&C){const y=e.oxw(2);e.xp6(1),e.ekj("error",y.form.controls.name.invalid&&y.form.controls.name.touched)}}function u(C,A){if(1&C&&(e.TgZ(0,"div",10)(1,"label",14),e._uU(2," Type"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",12),e._UZ(7,"input",15),e.TgZ(8,"mat-error"),e._uU(9,"Type is required"),e.qZA()()()),2&C){const y=e.oxw(2),Q=e.MAs(9);e.xp6(1),e.ekj("error",y.form.controls.group.invalid&&y.form.controls.group.touched),e.xp6(6),e.Q6J("matAutocomplete",Q)}}function a(C,A){1&C&&(e.TgZ(0,"div",10)(1,"label",11),e._uU(2,"Unit Price:"),e.qZA(),e.TgZ(3,"mat-form-field",12),e._UZ(4,"input",16),e.qZA()())}function d(C,A){1&C&&(e.TgZ(0,"div",10)(1,"mat-checkbox",17),e._uU(2," Can select multiple of type "),e.qZA()())}function i(C,A){if(1&C&&(e.TgZ(0,"form",8),e.YNc(1,f,10,2,"div",9),e.YNc(2,u,10,3,"div",9),e.YNc(3,a,5,0,"div",9),e.YNc(4,d,3,0,"div",9),e.qZA()),2&C){const y=e.oxw();e.Q6J("formGroup",y.form),e.xp6(1),e.Q6J("ngIf",y.form.controls.name),e.xp6(1),e.Q6J("ngIf",y.form.controls.group),e.xp6(1),e.Q6J("ngIf",y.form.controls.unit_price),e.xp6(1),e.Q6J("ngIf",y.form.controls.multiple)}}function s(C,A){if(1&C){const y=e.EpF();e.TgZ(0,"footer",18)(1,"button",19),e.NdJ("click",function(){e.CHM(y);const V=e.oxw();return e.KtG(V.saveChanges())}),e._uU(2," Save "),e.qZA()()}if(2&C){const y=e.oxw();e.xp6(1),e.Q6J("disabled",!y.form.dirty)}}function c(C,A){1&C&&(e.TgZ(0,"div",20),e._UZ(1,"mat-spinner",21),e.TgZ(2,"p"),e._uU(3,"Saving catering item option..."),e.qZA()())}function o(C,A){if(1&C&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&C){const y=A.$implicit;e.Q6J("value",y),e.xp6(1),e.hij(" ",y," ")}}let p=(()=>{class C{constructor(y){this._data=y,this.event=new e.vpe,this.form=new t.cw({name:new t.NI(this.option.name||"",[t.kI.required]),group:new t.NI(this.option.group||"",[t.kI.required]),unit_price:new t.NI(this.option.unit_price),multiple:new t.NI(!!this.option.multiple,[])}),this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}saveChanges(){this.loading=!0;const y={...this.option,id:this.option.id||`option-${(0,_.Iy)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new r.U({...this._data.parent,options:this._data.parent.options.filter(Q=>Q.id!==y.id).concat([y])})}})}}return C.\u0275fac=function(y){return new(y||C)(e.Y36(O.WI))},C.\u0275cmp=e.Xpm({type:C,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(y,Q){if(1&y&&(e.TgZ(0,"header")(1,"h3",0),e._uU(2),e.qZA(),e.YNc(3,g,3,0,"button",1),e.qZA(),e.YNc(4,i,5,5,"form",2),e.YNc(5,s,3,1,"footer",3),e.YNc(6,c,4,0,"ng-template",null,4,e.W1O),e.TgZ(8,"mat-autocomplete",null,5),e.YNc(10,o,2,2,"mat-option",6),e.qZA()),2&y){const V=e.MAs(7);e.xp6(2),e.hij(" ",Q.option.id?"Edit":"Add"," Item Option "),e.xp6(1),e.Q6J("ngIf",!Q.loading),e.xp6(1),e.Q6J("ngIf",Q.form&&!Q.loading)("ngIfElse",V),e.xp6(1),e.Q6J("ngIf",!Q.loading),e.xp6(5),e.Q6J("ngForOf",Q.types)}},dependencies:[R.sg,R.O5,w.XC,w.ZL,L.ey,O.ZT,O.uh,Z.oG,t._Y,t.Fj,t.wV,t.JJ,t.JL,t.sg,t.u,x.o,D.TO,D.KE,I.lW,P.Nt,T.Ou],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-option-modal.component.ts-angular-inline--86.css.map*/"]}),C})()},4204:(H,W,n)=>{n.d(W,{m:()=>w});var e=n(2560),t=n(4666),O=n(5306),_=n(4522);const r=["catering-order-item",""];function R(L,Z){if(1&L&&(e.ynx(0),e.TgZ(1,"div",1),e._UZ(2,"div",2),e.qZA(),e.TgZ(3,"div",3)(4,"button",4)(5,"app-icon"),e._uU(6),e.qZA()()(),e.TgZ(7,"div",5),e._uU(8),e.qZA(),e.BQk()),2&L){const x=e.oxw();e.xp6(4),e.ekj("bg-success",x.active)("text-white",x.active)("border-solid",x.active),e.xp6(2),e.Oqu(x.active?"done":"local_pizza"),e.xp6(2),e.hij(" ",null==x.item?null:x.item.name," ")}}let w=(()=>{class L{constructor(){this.active=!1}}return L.\u0275fac=function(x){return new(x||L)},L.\u0275cmp=e.Xpm({type:L,selectors:[["","catering-order-item",""]],inputs:{item:"item"},attrs:r,decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-20","text-right"],["name","item-bar",1,"bg-gray-300"],[1,"w-12","mr-4"],["action","","mat-icon-button","",1,"border","border-gray-300","border-dashed","text-2xl","text-dark-fade"],[1,"flex-1","border-b","border-gray-300","border-solid","py-4"]],template:function(x,D){1&x&&e.YNc(0,R,9,8,"ng-container",0),2&x&&e.Q6J("ngIf",D.item)},dependencies:[t.O5,O.o,_.lW],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}[name=item-bar][_ngcontent-%COMP%]{height:2px;margin-left:auto;margin-right:1rem;width:calc(50% - .9375rem)}\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--91.css.map*/"]}),L})()},2189:(H,W,n)=>{n.d(W,{I:()=>L});var e=n(2851),t=n(2560),O=n(4666),_=n(961);function r(Z,x){if(1&Z&&(t.TgZ(0,"li",12),t._UZ(1,"catering-order",13),t.qZA()),2&Z){const D=x.$implicit;t.xp6(1),t.Q6J("order",D)}}function R(Z,x){1&Z&&(t.TgZ(0,"div",14)(1,"p"),t._uU(2,"No Catering Orders"),t.qZA()())}function w(Z,x){1&Z&&t._UZ(0,"mat-progress-bar",15)}let L=(()=>{class Z{constructor(D){this._orders=D,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(D,I){return I?I.id:void 0}}return Z.\u0275fac=function(D){return new(D||Z)(t.Y36(e.I))},Z.\u0275cmp=t.Xpm({type:Z,selectors:[["catering-order-list"]],decls:22,vars:10,consts:[[1,"w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-gray-300","bg-white"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-gray-300",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block text-dark-fade",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-gray-300"],[3,"order"],["empty","",1,"info-block","text-dark-fade"],["mode","indeterminate",1,"w-full"]],template:function(D,I){if(1&D&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Time"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Location"),t.qZA(),t.TgZ(6,"div",4),t._uU(7,"Host"),t.qZA(),t.TgZ(8,"div",2),t._uU(9,"Charge Code"),t.qZA(),t.TgZ(10,"div",5),t._uU(11,"Invoice No."),t.qZA(),t.TgZ(12,"div",6),t._uU(13,"Status"),t.qZA(),t._UZ(14,"div",7),t.qZA(),t.TgZ(15,"ul",8),t.YNc(16,r,2,1,"li",9),t.ALo(17,"async"),t.YNc(18,R,3,0,"div",10),t.ALo(19,"async"),t.qZA(),t.YNc(20,w,1,0,"mat-progress-bar",11),t.ALo(21,"async")),2&D){let P;t.xp6(16),t.Q6J("ngForOf",t.lcZ(17,4,I.order_list))("ngForTrackBy",I.trackByFn),t.xp6(2),t.Q6J("ngIf",!(null!=(P=t.lcZ(19,6,I.order_list))&&P.length)),t.xp6(2),t.Q6J("ngIf",t.lcZ(21,8,I.loading))}},dependencies:[O.sg,O.O5,_.p,O.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--92.css.map*/"]}),Z})()},9504:(H,W,n)=>{n.d(W,{W:()=>q});var e=n(1670),t=n(2560),O=n(1484),_=n(1233),r=n(6119),R=n(475),w=n(3294),L=n(8025),Z=n(2962),x=n(5163),D=n(4666),I=n(5892),P=n(6896),T=n(2508),g=n(5306),f=n(4522),u=n(1708),a=n(2793);function d(v,Y){1&v&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function i(v,Y){if(1&v){const l=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(B){t.CHM(l);const N=t.oxw().$implicit,F=t.oxw(5);return t.KtG(F.updateItemQuantity(N,B))}),t.qZA()}if(2&v){const l=t.oxw().$implicit;t.Q6J("ngModel",l.quantity)}}function s(v,Y){if(1&v){const l=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),t._uU(4,"remove"),t.qZA()()(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(l);const B=t.oxw().$implicit,N=t.oxw(5);return t.KtG(N.addItem(B))}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA()()()}if(2&v){const l=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",l.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",l.quantity," ")}}function c(v,Y){if(1&v&&(t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,d,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,i,1,1,"a-counter",15),t.YNc(9,s,10,3,"div",16),t.qZA()),2&v){const l=Y.$implicit;t.xp6(3),t.hij(" ",l.name," "),t.xp6(1),t.Q6J("ngIf",l.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,5,l.unit_price/100)," "),t.xp6(2),t.Q6J("ngIf",!l.options.length),t.xp6(1),t.Q6J("ngIf",l.options.length)}}const o=function(){return{}};function p(v,Y){if(1&v&&(t.TgZ(0,"mat-tab",8)(1,"div",9),t.YNc(2,c,10,7,"div",10),t.qZA()()),2&v){const l=t.oxw().$implicit,b=t.oxw(3);t.Q6J("label",l),t.xp6(2),t.Q6J("ngForOf",(b.menu_items||t.DdM(2,o))[l])}}function C(v,Y){if(1&v&&(t.ynx(0),t.YNc(1,p,3,3,"mat-tab",7),t.BQk()),2&v){const l=Y.$implicit,b=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(b.menu_items||t.DdM(1,o))[l].length)}}function A(v,Y){if(1&v&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,C,2,2,"ng-container",6),t.qZA(),t.BQk()),2&v){const l=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",l.categories)}}function y(v,Y){if(1&v&&(t.TgZ(0,"div",4),t.YNc(1,A,3,1,"ng-container",5),t.qZA()),2&v){const l=t.oxw(),b=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!l.show_order_details)("ngIfElse",b)}}function Q(v,Y){if(1&v){const l=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){t.CHM(l);const B=t.oxw(2);return t.KtG(B.show_order_details=!0)}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&v){const l=t.oxw(2);t.xp6(3),t.Q6J("disabled",!l.order.item_count)("matBadge",l.order.item_count)("matBadgeHidden",!l.order.item_count)}}function V(v,Y){if(1&v){const l=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(l);const B=t.oxw(2);return t.KtG(B.show_order_details=!1)}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){t.CHM(l);const B=t.oxw(2);return t.KtG(B.saveOrder())}),t._uU(3," Save Order "),t.qZA()}}function k(v,Y){if(1&v&&(t.TgZ(0,"footer",24),t.YNc(1,Q,5,3,"ng-container",5),t.YNc(2,V,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&v){const l=t.MAs(3),b=t.oxw();t.xp6(1),t.Q6J("ngIf",!b.show_order_details)("ngIfElse",l)}}function U(v,Y){if(1&v&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&v){const l=t.oxw();t.xp6(3),t.Oqu(l.loading)}}function S(v,Y){if(1&v&&(t.TgZ(0,"div",37),t._uU(1),t.qZA()),2&v){const l=t.oxw().$implicit,b=t.oxw(2);t.Q6J("matTooltip",b.optionsFor(l)),t.xp6(1),t.AsE(" ",l.options.length," option",1===l.options.length?"":"s"," selected ")}}function h(v,Y){if(1&v){const l=t.EpF();t.TgZ(0,"div",34)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,S,2,3,"div",35),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",36),t.NdJ("ngModelChange",function(B){const F=t.CHM(l).$implicit,X=t.oxw(2);return t.KtG(X.updateItemQuantity(F,B))}),t.qZA()()}if(2&v){const l=Y.$implicit;t.xp6(3),t.Oqu(l.name),t.xp6(1),t.Q6J("ngIf",l.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,4,l.total_cost/100)," "),t.xp6(2),t.Q6J("ngModel",l.quantity)}}function K(v,Y){if(1&v&&(t.TgZ(0,"header",32)(1,"h3"),t._uU(2,"Confirm Order"),t.qZA()(),t.TgZ(3,"div",9),t.YNc(4,h,9,6,"div",33),t.qZA()),2&v){const l=t.oxw();t.xp6(4),t.Q6J("ngForOf",l.order.items)}}function $(v,Y,l){let b=!0;for(const B of Y)if(v.category===B.name||v.tags.includes(B.name)||l.space?.zones.includes(B.name)||"*"===B.name){let N=0;for(const F of B.rules){const X=new Date(l.date);switch(F[0]){case"after_hour":N+=(0,_.Z)(X,(0,r.Z)(X,F[1]))?1:0;break;case"before_hour":N+=(0,R.Z)(X,(0,r.Z)(X,F[1]))?1:0;break;case"min_length":N+=l.duration>=(0,L.H1)(F[1])?1:0;break;case"max_length":N+=l.duration<=(0,L.H1)(F[1])?1:0;break;case"visitor_type":N+=l.ext("visitor_type")===F[1]?1:0;break;default:N++}}b=N>=B.rules.length}return b}let q=(()=>{class v extends w.KG{constructor(l){super(),this._data=l,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var l=this;return(0,e.Z)(function*(){l.loading="Loading menu...",l.order=new x.G(l._data.order),l.rules=yield l._data.getCateringConfig(l.order.event?.space?.level?.parent_id),l._data.menu.subscribe(b=>{l.loading="Loading menu...";const B=(0,w.Tw)(b.map(F=>F.category)),N={};for(const F of B)N[F]=b.filter(X=>X.category===F&&$(X,l.rules,l.order.event));l.categories=B,l.menu_items=N,l.updateMenuQuantities(),l.timeout("clear_loading",()=>l.loading="",1e3)})})()}addItem(l,b=!0){const B=this.order.items.find(N=>N.id===l.id&&N.options.length===N.options.reduce((F,X)=>F+(l.options.find(tt=>X.id===tt.id)?1:0),0));b&&l.options?.length?this._data.selectOptions(l.options).then(N=>{const F=new Z.U({...l,options:N});this.addItem(F,!1)}):this.order=new x.G(B?{...this.order,items:this.order.items.filter(N=>!(N.id===l.id&&N.options_string===l.options_string)).concat([new Z.U({...l,quantity:B.quantity+1})])}:{...this.order,items:this.order.items.concat([new Z.U({...l,quantity:1})])}),this.updateMenuQuantities()}removeItem(l){this.order=new x.G({...this.order,items:this.order.items.filter(b=>b.id!==l.id&&b.options_string===l.options_string)}),this.updateMenuQuantities()}updateItemQuantity(l,b){const B=this.order.items.find(F=>F.id===l.id&&F.options_string===l.options_string);let N=[...this.order.items];N=B?this.order.items.filter(F=>!(F.id===l.id&&F.options_string===l.options_string)).concat([new Z.U({...l,quantity:b})]):this.order.items.concat([new Z.U({...l,quantity:b})]),N.sort((F,X)=>F.name.localeCompare(X.name)),this.order=new x.G({...this.order,items:N}),this.updateMenuQuantities()}updateMenuQuantities(){for(const l in this.menu_items)for(const b of this.menu_items[l])b.quantity=this.order.items.reduce((B,N)=>N.id===b.id?B+N.quantity:B,0)}optionsFor(l){return l.options.map(b=>b.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return v.\u0275fac=function(l){return new(l||v)(t.Y36(O.WI))},v.\u0275cmp=t.Xpm({type:v,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(l,b){if(1&l&&(t.YNc(0,y,2,2,"div",0),t.YNc(1,k,4,2,"footer",1),t.YNc(2,U,4,1,"ng-template",null,2,t.W1O),t.YNc(4,K,5,1,"ng-template",null,3,t.W1O)),2&l){const B=t.MAs(3);t.Q6J("ngIf",!b.loading)("ngIfElse",B),t.xp6(1),t.Q6J("ngIf",!b.loading)}},dependencies:[D.sg,D.O5,I.SP,I.uX,O.ZT,P.gM,T.Fj,T.JJ,T.On,g.o,f.lW,u.Ou,a.R,D.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--87.css.map*/"]}),v})()},3129:(H,W,n)=>{n.d(W,{R:()=>u});var e=n(2560),t=n(1484),O=n(3245),_=n(4666),r=n(4792),R=n(2922),w=n(2508),L=n(5306),Z=n(4522);function x(a,d){if(1&a&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.hij(" +",e.lcZ(2,1,i.unit_price/100)," ")}}function D(a,d){if(1&a&&(e.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,x,3,3,"div",17),e.qZA()()),2&a){const i=d.$implicit;e.Q6J("value",i.id),e.xp6(3),e.hij(" ",i.name," "),e.xp6(1),e.Q6J("ngIf",i.unit_price)}}function I(a,d){if(1&a){const i=e.EpF();e.ynx(0),e.TgZ(1,"mat-radio-group",10),e.NdJ("ngModelChange",function(c){e.CHM(i);const o=e.oxw().$implicit,p=e.oxw();return e.KtG(p.updateGroupOption(o,c))}),e.TgZ(2,"mat-radio-button",11)(3,"span",12),e._uU(4,"None"),e.qZA()(),e.YNc(5,D,5,3,"mat-radio-button",13),e.qZA(),e.BQk()}if(2&a){const i=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",null==i?null:i.options)}}function P(a,d){if(1&a&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.hij(" +",e.lcZ(2,1,i.unit_price/100)," ")}}function T(a,d){if(1&a){const i=e.EpF();e.TgZ(0,"mat-checkbox",20),e.NdJ("ngModelChange",function(c){const p=e.CHM(i).$implicit,C=e.oxw(3);return e.KtG(C.option_state[p.id]=c)}),e.TgZ(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,P,3,3,"div",17),e.qZA()()}if(2&a){const i=d.$implicit,s=e.oxw(3);e.Q6J("ngModel",s.option_state[i.id]),e.xp6(3),e.hij(" ",i.name," "),e.xp6(1),e.Q6J("ngIf",i.unit_price)}}function g(a,d){if(1&a&&e.YNc(0,T,5,3,"mat-checkbox",19),2&a){const i=e.oxw().$implicit;e.Q6J("ngForOf",null==i?null:i.options)}}function f(a,d){if(1&a&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.qZA(),e.TgZ(3,"div",7),e.YNc(4,I,6,1,"ng-container",8),e.YNc(5,g,1,1,"ng-template",null,9,e.W1O),e.qZA()()),2&a){const i=d.$implicit,s=e.MAs(6);e.uIk("group",i.name),e.xp6(2),e.Oqu(i.name),e.xp6(2),e.Q6J("ngIf",!i.multiple)("ngIfElse",s)}}let u=(()=>{class a{constructor(i){this._data=i,this.event=new e.vpe,this.option_state={};const s=(0,O.Tw)(this._data.options.map(o=>o.group||"Other")),c=[];for(const o of s){const p=this._data.options.filter(C=>C.group===o);c.push({name:o,multiple:!!p.find(C=>C.multiple),options:p})}this.groups=c}updateGroupOption(i,s){for(const c of i.options)this.option_state[c.id]=c.id===s}saveOptions(){const i=this._data.options.filter(s=>this.option_state[s.id]);this.event.emit({reason:"done",metadata:{options:i}})}}return a.\u0275fac=function(i){return new(i||a)(e.Y36(t.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(i,s){1&i&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Select options"),e.qZA(),e.TgZ(3,"button",0)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.TgZ(6,"main",1),e.YNc(7,f,7,4,"div",2),e.qZA(),e.TgZ(8,"footer",3)(9,"button",4),e.NdJ("click",function(){return s.saveOptions()}),e._uU(10," Save "),e.qZA()()),2&i&&(e.xp6(7),e.Q6J("ngForOf",s.groups))},dependencies:[_.sg,_.O5,t.ZT,r.oG,R.VQ,R.U0,w.JJ,w.On,L.o,Z.lW,_.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--88.css.map*/"]}),a})()},961:(H,W,n)=>{n.d(W,{p:()=>g});var e=n(3294),t=n(2851),_=(n(5163),n(2460)),r=n(2560),R=n(4666),w=n(8589),L=n(5306),Z=n(4522),x=n(4204);function D(f,u){if(1&f){const a=r.EpF();r.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),r._uU(4,"room_service"),r.qZA()()(),r.TgZ(5,"div",7),r._uU(6),r.ALo(7,"date"),r.qZA(),r.TgZ(8,"div",8),r._uU(9),r.qZA(),r.TgZ(10,"div",9),r._uU(11),r.qZA(),r.TgZ(12,"div",10),r._uU(13),r.qZA(),r.TgZ(14,"div",11),r._uU(15),r.qZA(),r.TgZ(16,"div",12)(17,"button",13)(18,"div",14),r._uU(19),r.qZA(),r.TgZ(20,"app-icon",15),r._uU(21,"arrow_drop_down"),r.qZA()()(),r.TgZ(22,"div",16)(23,"button",17),r.NdJ("click",function(){r.CHM(a);const i=r.oxw();return r.KtG(i.show_items=!i.show_items)}),r.TgZ(24,"app-icon"),r._uU(25),r.qZA()()()()}if(2&f){const a=r.oxw(),d=r.MAs(3);r.ekj("shown",a.show_items),r.xp6(6),r.Oqu(r.xi3(7,12,a.order.deliver_at,"shortTime")),r.xp6(3),r.hij(" ",(null==a.order.event?null:a.order.event.space.display_name)||(null==a.order.event?null:a.order.event.space.name)||"~ No Location ~"," "),r.xp6(2),r.hij(" ",(null==a.order.event||null==a.order.event.organiser?null:a.order.event.organiser.name)||(null==a.order.event?null:a.order.event.host)||"~ Unknown Host ~"," "),r.xp6(2),r.Oqu(a.order.charge_code||"~ No Code ~"),r.xp6(2),r.hij(" ",a.order.invoice_number||"~ No Invoice ~"," "),r.xp6(2),r.Udp("background",null==a.status?null:a.status.colour),r.Q6J("matMenuTriggerFor",d),r.xp6(2),r.hij(" ",null==a.status?null:a.status.name," "),r.xp6(6),r.Oqu(a.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function I(f,u){1&f&&r._UZ(0,"li",21),2&f&&r.Q6J("item",u.$implicit)}function P(f,u){if(1&f&&(r.TgZ(0,"ul",18),r._UZ(1,"div",19),r.YNc(2,I,1,1,"li",20),r.qZA()),2&f){const a=r.oxw();r.ekj("shown",a.show_items),r.Q6J("@show",a.show_items?"show":"hide"),r.xp6(1),r.Udp("height",3.125*a.order.items.length-1+"rem"),r.xp6(1),r.Q6J("ngForOf",a.order.items)}}function T(f,u){if(1&f){const a=r.EpF();r.TgZ(0,"button",22),r.NdJ("click",function(){const s=r.CHM(a).$implicit,c=r.oxw();return r.KtG(c.updateStatus(s.id))}),r._UZ(1,"div",23),r.TgZ(2,"span",24),r._uU(3),r.qZA()()}if(2&f){const a=u.$implicit;r.xp6(1),r.Udp("background-color",a.colour),r.xp6(2),r.Oqu(a.name)}}let g=(()=>{class f{constructor(a){this._orders=a,this.show_items=!1,this.statuses=_.U,this.updateStatus=d=>this._orders.updateStatus(this.order,d)}get status(){return this.statuses.find(a=>a.id===this.order.status)}}return f.\u0275fac=function(a){return new(a||f)(r.Y36(t.I))},f.\u0275cmp=r.Xpm({type:f,selectors:[["catering-order"]],inputs:{order:"order"},decls:5,vars:3,consts:[["class","w-full flex items-center py-2 bg-gray-100",3,"shown",4,"ngIf"],["class","list-none p-0 m-0 w-full relative",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2","bg-gray-100"],[1,"w-20","flex","items-center","justify-center"],[1,"rounded-full","bg-gray-300","p-2","text-2xl","text-dark-fade","flex","items-center","justify-center"],["time","",1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-24"],[1,"w-28"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["mat-icon-button","",3,"click"],[1,"list-none","p-0","m-0","w-full","relative"],["name","bar",1,"absolute","top-0","bg-gray-300"],["catering-order-item","","class","flex items-center",3,"item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(a,d){1&a&&(r.YNc(0,D,26,15,"div",0),r.YNc(1,P,3,6,"ul",1),r.TgZ(2,"mat-menu",null,2),r.YNc(4,T,4,3,"button",3),r.qZA()),2&a&&(r.Q6J("ngIf",d.order),r.xp6(1),r.Q6J("ngIf",null==d.order?null:d.order.items.length),r.xp6(3),r.Q6J("ngForOf",d.statuses))},dependencies:[R.sg,R.O5,w.VK,w.OP,w.p6,L.o,Z.lW,x.m,R.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}.shown[_ngcontent-%COMP%]{background-color:#eee}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}\n/*# sourceMappingURL=catering-order.component.ts-angular-inline--93.css.map*/"],data:{animation:[e.X7]}}),f})()},2851:(H,W,n)=>{n.d(W,{I:()=>u});var e=n(4505),t=n(7716),O=n(823),_=n(9095),r=n(6942),R=n(8759),w=n(9128),L=n(1810),Z=n(9377),x=n(3200),D=n(3294),I=n(4211),P=n(3902),T=n(5163),g=n(2560);let u=(()=>{class a extends D.KG{constructor(){super(),this._poll=new e.X(0),this._loading=new e.X(!1),this._filters=new e.X({}),this.orders=(0,t.aj)([this._filters,this._poll]).pipe((0,O.b)(500),(0,_.w)(([i])=>{this._loading.next(!0);const s=(0,L.Z)((0,Z.Z)(i.date||Date.now())),c=(0,L.Z)((0,x.Z)(i.date||Date.now()));return(0,I.u$)({zone_ids:(i.zones||[]).join(","),period_start:s,period_end:c})}),(0,r.U)(i=>(0,D.xH)(i.map(s=>s.ext("catering")))),(0,R.b)(()=>this._loading.next(!1)),(0,w.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,r.U)(i=>i.filter(s=>function f(a,d){const i=(d.search||"").toLowerCase();return!!a.items.find(s=>s.name.toLowerCase().includes(i)||!!s.options.find(c=>c.name.toLowerCase().includes(i)))}(s,this._filters.getValue())))),this.subscription("changes",this.orders.subscribe())}get filters(){return this._filters.getValue()}set filters(i){this._filters.next(i)}startPolling(i=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),i)}stopPolling(){this.clearInterval("polling")}updateStatus(i,s){const c=new T.G({...i,status:s}),o=new P.y({...i.event,catering:[...i.event.ext("catering").filter(p=>p.id!==i.id),c].map(p=>new T.G({...p}))});return(0,I.ry)(o)}}return a.\u0275fac=function(i){return new(i||a)},a.\u0275prov=g.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},729:(H,W,n)=>{n.d(W,{j:()=>u});var e=n(1670),t=n(3690),O=n(4505),_=n(5670),r=n(3294),R=n(3619),w=n(6336),L=n(7413),Z=n(2090),x=n(2962),D=n(5163),I=n(9504),P=n(3129),T=n(5730),g=n(2560),f=n(1484);let u=(()=>{class a extends r.KG{constructor(i,s){var c;super(),c=this,this._org=i,this._dialog=s,this._menu=new O.X([]),this._loading=new O.X(!1),this._currency=new O.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(function(){var o=(0,e.Z)(function*(p){if(p){const C=(yield c.getCateringForZone(p.id)).map(A=>new x.U(A));c._currency.next(p.currency||"USD"),c._menu.next(C)}});return function(p){return o.apply(this,arguments)}}()))}get categories(){const i=this._menu.getValue();return(0,r.Tw)(i.map(s=>s.category))}manageCateringOrder(i){var s=this;return(0,e.Z)(function*(){const c=s._dialog.open(I.W,{data:{order:i,menu:s.menu,loading:s.loading,getCateringConfig:p=>s.getCateringConfig(p),selectOptions:p=>s.selectOptions(p)}}),o=yield Promise.race([c.componentInstance.event.pipe((0,_.P)(p=>"done"===p.reason)).toPromise(),c.afterClosed().toPromise()]);return c.close(),o?.metadata?.order||i})()}addItem(i=new x.U){var s=this;return(0,e.Z)(function*(){const c=s._dialog.open(w.w,{data:{item:i,categories:s.categories}}),o=yield Promise.race([c.componentInstance.event.pipe((0,_.P)(A=>"done"===A.reason)).toPromise(),c.afterClosed().toPromise()]);if("done"!==o?.reason)return;const p=s._menu.getValue(),C=p.findIndex(A=>A.id===i.id);C>=0?p.splice(C,1,o.metadata.item):p.push(o.metadata.item),s.updateMenu(s._org.building.id,p).then(()=>{s._menu.next([...p]),c.close()},()=>c.componentInstance.loading=!1)})()}addOption(i,s={}){var c=this;return(0,e.Z)(function*(){const o=(0,r.Tw)(i.options.map(Q=>Q.group)),p=c._dialog.open(L.M,{data:{parent:i,option:s,types:o}}),C=yield Promise.race([p.componentInstance.event.pipe((0,_.P)(Q=>"done"===Q.reason)).toPromise(),p.afterClosed().toPromise()]);if("done"!==C?.reason)return;const A=c._menu.getValue(),y=A.findIndex(Q=>Q.id===i.id);y>=0?A.splice(y,1,C.metadata.item):A.push(C.metadata.item),c.updateMenu(c._org.building.id,A).then(()=>{c._menu.next([...A]),p.close()},()=>p.componentInstance.loading=!1)})()}selectOptions(i){var s=this;return(0,e.Z)(function*(){const c=s._dialog.open(P.R,{data:{options:i}}),o=yield Promise.race([c.componentInstance.event.pipe((0,_.P)(p=>"done"===p.reason)).toPromise(),c.afterClosed().toPromise()]);return"done"!==o?.reason?[]:(c.close(),o.metadata.options)})()}deleteItem(i){var s=this;return(0,e.Z)(function*(){const c=yield(0,r._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${i.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},s._dialog);if("done"!==c.reason)return;c.loading("Removing catering item...");const o=s._menu.getValue().filter(p=>i.id!==p.id);s.updateMenu(s._org.building.id,o).then(()=>{s._menu.next([...o]),c.close()},()=>c.loading(""))})()}deleteOption(i,s){var c=this;return(0,e.Z)(function*(){const o=yield(0,r._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${s.name}" from "${i.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},c._dialog);if("done"!==o.reason)return;o.loading("Removing catering item option...");const p=c._menu.getValue();p.splice(p.findIndex(C=>C.id===i.id),1,new x.U({...i,options:i.options.filter(C=>C.id!==s.id)})),c.updateMenu(c._org.building.id,p).then(()=>{c._menu.next([...p]),o.close()},()=>o.loading(""))})()}editConfig(){var i=this;return(0,e.Z)(function*(){const s=yield i.getCateringConfig(i._org.building.id),c=i._menu.getValue(),o=(0,r.Tw)((0,r.xH)(c.map(A=>[A.category,...A.tags]))),p=i._dialog.open(Z.S,{data:{config:s,types:o}}),C=yield Promise.race([p.componentInstance.event.pipe((0,_.P)(A=>"done"===A.reason)).toPromise(),p.afterClosed().toPromise()]);"done"===C?.reason&&i.updateConfig(i._org.building.id,C.metadata).then(()=>p.close(),()=>p.componentInstance.loading=!1)})()}importMenu(){var i=this;return(0,e.Z)(function*(){const s=i._dialog.open(T.m),c=yield Promise.race([s.componentInstance.event.pipe((0,_.P)(A=>"done"===A.reason)).toPromise(),s.afterClosed().toPromise()]);if("done"!==c?.reason)return;s.componentInstance.loading="Updating menu...";const o=i._menu.getValue(),p=i._org.building,C=(0,r.Tw)(c.metadata.concat(o),"id");yield i.updateMenu(p.id,C).catch(A=>{throw(0,r.cB)("Error importing catering menu"),s.close(),A}),(0,r.t5)(`Successfully imported catering menu. ${c.metadata.length} item(s) added.`),s.close()})()}updateMenu(i,s){return(0,t.Ymr)(i,{id:i,name:"catering",details:s,description:`Catering menu for ${i}`}).toPromise()}getCateringForZone(i){return(0,e.Z)(function*(){const s=(yield(0,t.rlq)(i,"catering").toPromise()).details;return s instanceof Array?s:[]})()}getCateringConfig(i=this._org.building.id){return(0,e.Z)(function*(){const s=(yield(0,t.rlq)(i,"catering_config").toPromise()).details;return s instanceof Array?s:[]})()}updateConfig(i,s){return(0,t.Ymr)(i,{id:i,name:"catering_config",details:s,description:`Catering menu config for ${i}`}).toPromise()}addItemToOrder(i,s){let c=i.items;const o=c.find(C=>C.id===s.id&&s.options?.length===C.options?.reduce((A,y)=>A+(s.options.find(Q=>y.id===Q.id)?1:0),0));return o?o.quantity+=1:c=c.concat([new x.U({...s,quantity:1})]),new D.G({...i,items:c,event:null})}}return a.\u0275fac=function(i){return new(i||a)(g.LFG(R.w7),g.LFG(f.uw))},a.\u0275prov=g.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},7701:(H,W,n)=>{n.d(W,{g:()=>e});const e=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}]},2460:(H,W,n)=>{n.d(W,{U:()=>e});const e=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map