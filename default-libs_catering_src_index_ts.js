"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{9364:(G,Q,o)=>{o.d(Q,{Ud:()=>k.U,GX:()=>Jt.G,Ii:()=>Rt.I,jW:()=>Ft.j,uy:()=>Nt});var n=o(4666),t=o(2508),T=o(8550),m=o(4792),a=o(1484),R=o(8589),K=o(5892),L=o(2922),b=o(6896),E=o(5340),e=(o(2090),o(6336),o(8644),o(8501),o(7413),o(4204),o(2189),o(9504),o(3129),o(961),o(5730),o(1506),o(2560)),k=(o(5306),o(4522),o(3619),o(3690),o(4505),o(7716),o(9095),o(6942),o(7418),o(8759),o(9128),o(2962));o(1708),o(2581),o(2793),o(1670),o(3910);var it=o(5074);o(1267),o(158);var wt=o(6850);let Nt=(()=>{class d{}return d.\u0275fac=function(r){return new(r||d)},d.\u0275mod=e.oAB({type:d}),d.\u0275inj=e.cJS({imports:[n.ez,R.Tx,K.Nh,T.Bb,a.Is,m.p9,L.Fk,b.AV,t.u5,t.UX,E.K,it.lN,wt.W9]}),d})();var Jt=o(5163),Rt=o(2851),Ft=o(729);o(7701),o(2460)},2090:(G,Q,o)=>{o.d(Q,{S:()=>x});var n=o(2560),t=o(1484),T=o(7701),m=o(4666),a=o(207),R=o(2508),K=o(5306),L=o(5074),b=o(7371),E=o(4522),N=o(1267);function I(C,s){1&C&&(n.TgZ(0,"button",5)(1,"app-icon"),n._uU(2,"close"),n.qZA()())}function U(C,s){if(1&C&&(n.TgZ(0,"mat-option",18),n._uU(1),n.qZA()),2&C){const u=s.$implicit;n.Q6J("value",u.id),n.xp6(1),n.hij(" ",u.name," ")}}function O(C,s){if(1&C){const u=n.EpF();n.TgZ(0,"div",14)(1,"mat-form-field",8)(2,"mat-select",15),n.NdJ("ngModelChange",function(_){const e=n.CHM(u).$implicit;return n.KtG(e[0]=_)}),n.YNc(3,U,2,2,"mat-option",16),n.qZA()(),n.TgZ(4,"mat-form-field",8)(5,"input",17),n.NdJ("ngModelChange",function(_){const e=n.CHM(u).$implicit;return n.KtG(e[1]=_)}),n.qZA(),n.TgZ(6,"mat-error"),n._uU(7,"Rule value is required"),n.qZA()(),n.TgZ(8,"button",10),n.NdJ("click",function(){const g=n.CHM(u).index,e=n.oxw().$implicit;return n.KtG(e.rules.splice(g,1))}),n.TgZ(9,"app-icon"),n._uU(10,"delete"),n.qZA()()()}if(2&C){const u=s.$implicit,i=n.oxw(2);n.xp6(2),n.Q6J("ngModel",u[0]),n.xp6(1),n.Q6J("ngForOf",i.rule_types),n.xp6(2),n.Q6J("ngModel",u[1])}}function f(C,s){if(1&C){const u=n.EpF();n.TgZ(0,"div",6)(1,"div",7)(2,"mat-form-field",8)(3,"input",9),n.NdJ("ngModelChange",function(_){const e=n.CHM(u).$implicit;return n.KtG(e.name=_)}),n.qZA(),n.TgZ(4,"mat-error"),n._uU(5,"Ruleset name is required"),n.qZA()(),n.TgZ(6,"button",10),n.NdJ("click",function(){const g=n.CHM(u).$implicit,e=n.oxw();return g.rules.push(["",""]),n.KtG(e.show_rules=g.id)}),n.TgZ(7,"app-icon"),n._uU(8,"add"),n.qZA()(),n.TgZ(9,"button",11),n.NdJ("click",function(){const g=n.CHM(u).$implicit,e=n.oxw();return n.KtG(e.show_rules=e.show_rules!==g.id?g.id:"")}),n.TgZ(10,"app-icon"),n._uU(11),n.qZA()()(),n.TgZ(12,"div",12),n.YNc(13,O,11,3,"div",13),n.qZA()()}if(2&C){const u=s.$implicit,i=n.oxw();n.xp6(3),n.Q6J("ngModel",u.name),n.xp6(6),n.Q6J("disabled",!u.rules.length),n.xp6(2),n.Oqu(i.show_rules===u.id?"expand_less":"expand_more"),n.xp6(1),n.Udp("height",(i.show_rules===u.id?5*u.rules.length:0)+"em"),n.xp6(1),n.Q6J("ngForOf",u.rules)}}let x=(()=>{class C{constructor(u){this._data=u,this.event=new n.vpe,this.loading=!1,this.rule_types=T.g,this.rulesets=(u.config||[]).map(i=>(i.rules=i.rules.map(_=>[_[0],JSON.stringify(_[1])]),i))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const u=this.rulesets.map(i=>({...i,rules:i.rules.map(_=>{let g=_[1];try{g=JSON.parse(_[1])}catch{}return[_[0],g]})}));this.event.emit({reason:"done",metadata:u})}}return C.\u0275fac=function(u){return new(u||C)(n.Y36(t.WI))},C.\u0275cmp=n.Xpm({type:C,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex items-center px-2 h-20 space-x-2",4,"ngFor","ngForOf"],[1,"flex","items-center","px-2","h-20","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(u,i){1&u&&(n.TgZ(0,"header")(1,"h3"),n._uU(2,"Edit Catering Configuration"),n.qZA(),n.YNc(3,I,3,0,"button",0),n.qZA(),n.TgZ(4,"main",1)(5,"button",2),n.NdJ("click",function(){return i.rulesets.push({id:i.new_id,rules:[]})}),n._uU(6," New Ruleset "),n.qZA(),n.YNc(7,f,14,6,"div",3),n.qZA(),n.TgZ(8,"footer",4)(9,"button",2),n.NdJ("click",function(){return i.saveChanges()}),n._uU(10,"Save Changes"),n.qZA()()),2&u&&(n.xp6(3),n.Q6J("ngIf",!i.loading),n.xp6(4),n.Q6J("ngForOf",i.rulesets))},dependencies:[m.sg,m.O5,a.ey,t.ZT,R.Fj,R.JJ,R.Q7,R.On,K.o,L.TO,L.KE,b.gD,E.lW,N.Nt],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}\n/*# sourceMappingURL=catering-config-modal.component.ts-angular-inline--87.css.map*/"]}),C})()},5730:(G,Q,o)=>{o.d(Q,{m:()=>I});var n=o(2560),t=o(1506),T=o(2962),m=o(4666),a=o(1484),R=o(5306),K=o(4522),L=o(1708);function b(U,O){1&U&&(n.TgZ(0,"button",4)(1,"app-icon"),n._uU(2,"close"),n.qZA()())}function E(U,O){if(1&U){const f=n.EpF();n.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),n._uU(3,"upload"),n.qZA(),n.TgZ(4,"p"),n._uU(5,"Click to select file or Drag and drop files"),n.qZA(),n.TgZ(6,"input",7),n.NdJ("change",function(C){n.CHM(f);const s=n.oxw();return n.KtG(s.handleFileEvent(C))}),n.qZA()(),n.TgZ(7,"div",8)(8,"button",9),n.NdJ("click",function(){n.CHM(f);const C=n.oxw();return n.KtG(C.downloadTemplate())}),n._uU(9," Download Template "),n.qZA()()()}}function N(U,O){if(1&U&&(n.TgZ(0,"main",10),n._UZ(1,"mat-spinner",11),n.TgZ(2,"p"),n._uU(3),n.qZA()()),2&U){const f=n.oxw();n.xp6(3),n.Oqu(f.loading)}}let I=(()=>{class U{constructor(){this.event=new n.vpe}handleFileEvent(f){this.loading="Processing menu data...";const x=f.target;if(!x?.files)return this.loading="";const C=x.files;if(!C.length)return this.loading="";const s=C[0],u=new FileReader;u.addEventListener("loadend",i=>{const g=(0,t.n5)(i.target.result);this.loading="",this.event.emit({reason:"done",metadata:g.filter(e=>"item"===(e.type||"").toLowerCase()).map(e=>new T.U({...e,options:g.filter(v=>"option"===(v.type||"").toLowerCase()&&v.tags===e.id).map(v=>({id:v.id,name:v.name,group:v.category,multiple:v.multiple,unit_price:v.unit_price}))}))})}),u.readAsText(s)}downloadTemplate(){(0,t.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return U.\u0275fac=function(f){return new(f||U)},U.\u0275cmp=n.Xpm({type:U,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["mat-button","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(f,x){if(1&f&&(n.TgZ(0,"header",0)(1,"h2"),n._uU(2,"Import Catering Menu"),n.qZA(),n.YNc(3,b,3,0,"button",1),n.qZA(),n.YNc(4,E,10,0,"main",2),n.YNc(5,N,4,1,"ng-template",null,3,n.W1O)),2&f){const C=n.MAs(6);n.xp6(3),n.Q6J("ngIf",!x.loading),n.xp6(1),n.Q6J("ngIf",!x.loading)("ngIfElse",C)}},dependencies:[m.O5,a.ZT,R.o,K.lW,L.Ou]}),U})()},6336:(G,Q,o)=>{o.d(Q,{w:()=>et});var n=o(8456),t=o(2560),T=o(2508),m=o(1484),a=o(1506),R=o(2962),K=o(4666),L=o(8550),b=o(207),E=o(4792),N=o(5306),I=o(5074),U=o(4522),O=o(1267),f=o(1708),x=o(1169),C=o(2793);function s(w,H){1&w&&(t.TgZ(0,"button",7)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function u(w,H){if(1&w&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",18),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA()()()),2&w){const Z=t.oxw(2);t.xp6(1),t.ekj("error",Z.form.controls.name.invalid&&Z.form.controls.name.touched)}}function i(w,H){if(1&w&&(t.TgZ(0,"div",15)(1,"label",19),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA()()()),2&w){const Z=t.oxw(2),B=t.MAs(9);t.xp6(1),t.ekj("error",Z.form.controls.category.invalid&&Z.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",B)}}const _=function(){return{class:"material-icons",content:"close"}};function g(w,H){if(1&w){const Z=t.EpF();t.TgZ(0,"mat-chip",27),t.NdJ("removed",function(){const V=t.CHM(Z).$implicit,M=t.oxw(3);return t.KtG(M.removeTag(V))}),t._uU(1),t._UZ(2,"app-icon",28),t.qZA()}if(2&w){const Z=H.$implicit;t.Q6J("selectable",!0)("removable",!0),t.xp6(1),t.hij(" ",Z," "),t.xp6(1),t.Q6J("icon",t.DdM(4,_))}}function e(w,H){if(1&w){const Z=t.EpF();t.TgZ(0,"div",15)(1,"label",21),t.SDv(2,22),t.qZA(),t.TgZ(3,"mat-form-field",17)(4,"mat-chip-list",23,24),t.YNc(6,g,3,5,"mat-chip",25),t.TgZ(7,"input",26),t.NdJ("matChipInputTokenEnd",function(k){t.CHM(Z);const V=t.oxw(2);return t.KtG(V.addTag(k))}),t.qZA()()()()}if(2&w){const Z=t.MAs(5),B=t.oxw(2);t.xp6(1),t.ekj("error",B.form.controls.tags.invalid&&B.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",B.tag_list),t.xp6(1),t.Q6J("matChipInputFor",Z)("matChipInputSeparatorKeyCodes",B.separators)("matChipInputAddOnBlur",!0)}}function v(w,H){1&w&&(t.TgZ(0,"div",15)(1,"label",29),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",17),t._UZ(4,"textarea",30),t.qZA()())}function h(w,H){if(1&w&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",31),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA()()()),2&w){const Z=t.oxw(2);t.xp6(1),t.ekj("error",Z.form.controls.unit_price.invalid&&Z.form.controls.unit_price.touched)}}function P(w,H){if(1&w&&(t.TgZ(0,"form",8),t.YNc(1,u,10,2,"div",9),t.YNc(2,i,10,3,"div",9),t.YNc(3,e,8,6,"div",9),t.YNc(4,v,5,0,"div",9),t.YNc(5,h,10,2,"div",9),t.TgZ(6,"div",10)(7,"label",11),t._uU(8,"Accept Points?"),t.qZA(),t.TgZ(9,"mat-checkbox",12),t._uU(10),t.qZA()(),t.TgZ(11,"div",10)(12,"label",13),t._uU(13,"Discount Cap"),t.qZA(),t._UZ(14,"a-counter",14),t.qZA()()),2&w){const Z=t.oxw();let B;t.Q6J("formGroup",Z.form),t.xp6(1),t.Q6J("ngIf",Z.form.controls.name),t.xp6(1),t.Q6J("ngIf",Z.form.controls.category),t.xp6(1),t.Q6J("ngIf",Z.form.controls.tags),t.xp6(1),t.Q6J("ngIf",Z.form.controls.description),t.xp6(1),t.Q6J("ngIf",Z.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(B=Z.form.get("accept_points"))&&B.value?"No":"Yes"),t.xp6(4),t.Q6J("min",0)("max",100)("step",5)("render_fn",Z.renderPercent)}}function D(w,H){if(1&w){const Z=t.EpF();t.TgZ(0,"footer",32)(1,"button",33),t.NdJ("click",function(){t.CHM(Z);const k=t.oxw();return t.KtG(k.saveChanges())}),t._uU(2," Save "),t.qZA()()}if(2&w){const Z=t.oxw();t.xp6(1),t.Q6J("disabled",!Z.form.dirty)}}function Y(w,H){1&w&&(t.TgZ(0,"div",34),t._UZ(1,"mat-spinner",35),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA()())}function X(w,H){if(1&w&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&w){const Z=H.$implicit;t.Q6J("value",Z),t.xp6(1),t.hij(" ",Z," ")}}let et=(()=>{class w{constructor(Z){this._data=Z,this.event=new t.vpe,this.form=new T.cw({name:new T.NI(this.item.name||"",[T.kI.required]),description:new T.NI(this.item.description||""),category:new T.NI(this.item.category||"",[T.kI.required]),unit_price:new T.NI(this.item.unit_price,[T.kI.required]),tags:new T.NI(this.item.tags||[]),accept_points:new T.NI(this.item.accept_points||!1),discount_cap:new T.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[n.K5,n.OC,n.L_]}get item(){return this._data.item||new R.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(Z=0){return`${Z}%`}addTag(Z){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const B=Z.input,k=Z.value,V=this.tag_list;(k||"").trim()&&(V.push(k),this.form.controls.tags.setValue(V)),B&&(B.value="")}removeTag(Z){if(!this.form||!this.form.controls.tags)return;const B=this.tag_list;this.form.controls.tags.markAsDirty();const k=B.indexOf(Z);k>=0&&(B.splice(k,1),this.form.controls.tags.setValue(B))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new R.U({...this.item,id:this.item.id||`item-${(0,a.Iy)(99999999)}`,...this.form.value})}})}}return w.\u0275fac=function(Z){return new(Z||w)(t.Y36(m.WI))},w.\u0275cmp=t.Xpm({type:w,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let H,Z;return H=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,Z=$localize`:@@zoneTagsPlaceholder␟8dc7c13b0c6b8ad9c770bce0ad72e14b4aef8456␟3986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],H,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",Z,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(Z,B){if(1&Z&&(t.TgZ(0,"header")(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,s,3,0,"button",1),t.qZA(),t.YNc(4,P,15,11,"form",2),t.YNc(5,D,3,1,"footer",3),t.YNc(6,Y,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,X,2,2,"mat-option",6),t.qZA()),2&Z){const k=t.MAs(7);t.xp6(2),t.hij("",B.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!B.loading),t.xp6(1),t.Q6J("ngIf",B.form&&!B.loading)("ngIfElse",k),t.xp6(1),t.Q6J("ngIf",!B.loading),t.xp6(5),t.Q6J("ngForOf",B.categories)}},dependencies:[K.sg,K.O5,L.XC,L.ZL,b.ey,m.ZT,m.uh,E.oG,T._Y,T.Fj,T.wV,T.JJ,T.JL,T.sg,T.u,N.o,I.TO,I.KE,U.lW,O.Nt,f.Ou,x.qn,x.HS,x.oH,x.qH,C.R],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--88.css.map*/"]}),w})()},8644:(G,Q,o)=>{o.d(Q,{V:()=>N});var n=o(729),t=o(2560),T=o(4666),m=o(8589),a=o(5306),R=o(4522);const K=["catering-menu-item",""];function L(I,U){if(1&I){const O=t.EpF();t.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"div"),t._uU(4),t.qZA(),t.TgZ(5,"div",8),t._uU(6),t.qZA()(),t.TgZ(7,"div",9),t._uU(8),t.ALo(9,"currency"),t.ALo(10,"async"),t.qZA()(),t.TgZ(11,"button",10)(12,"app-icon"),t._uU(13,"more_vert"),t.qZA()(),t.TgZ(14,"button",11),t.NdJ("click",function(){t.CHM(O);const x=t.oxw();return t.KtG(x.show_options=!x.show_options)}),t.TgZ(15,"app-icon"),t._uU(16,"expand_more"),t.qZA()()()}if(2&I){const O=t.oxw(),f=t.MAs(3);t.xp6(4),t.Oqu(O.item.name),t.xp6(2),t.hij(" ",O.item.category," "),t.xp6(2),t.hij(" ",t.xi3(9,5,O.item.unit_price/100,t.lcZ(10,8,O.symbol))," "),t.xp6(3),t.Q6J("matMenuTriggerFor",f),t.xp6(3),t.Q6J("disabled",!O.item.options.length)}}function b(I,U){if(1&I){const O=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"div",16),t._uU(3),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.qZA()(),t.TgZ(6,"button",17),t.NdJ("click",function(){const C=t.CHM(O).$implicit,s=t.oxw(2);return t.KtG(s.editOption(C))}),t.TgZ(7,"app-icon"),t._uU(8,"edit"),t.qZA()(),t.TgZ(9,"button",18),t.NdJ("click",function(){const C=t.CHM(O).$implicit,s=t.oxw(2);return t.KtG(s.removeOption(C))}),t.TgZ(10,"app-icon"),t._uU(11,"delete"),t.qZA()()()}if(2&I){const O=U.$implicit;t.xp6(3),t.Oqu(O.name),t.xp6(2),t.Oqu(O.group)}}function E(I,U){if(1&I&&(t.TgZ(0,"div",12),t.YNc(1,b,12,2,"div",13),t.qZA()),2&I){const O=t.oxw();t.Udp("height",O.show_options?3.5*O.item.options.length+"rem":"0"),t.xp6(1),t.Q6J("ngForOf",O.item.options)}}let N=(()=>{class I{constructor(O){this._catering=O,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=f=>this._catering.addOption(this.item,f),this.removeOption=f=>this._catering.deleteOption(this.item,f),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}get symbol(){return this._catering.currency}}return I.\u0275fac=function(O){return new(O||I)(t.Y36(n.j))},I.\u0275cmp=t.Xpm({type:I,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:K,decls:19,vars:2,consts:[["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-gray-100 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","text-dark-fade"],[1,"p-2","m-2","text-xs","font-bold","text-white","rounded","bg-primary"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-icon-button","",3,"disabled","click"],["options","",1,"bg-gray-100","overflow-hidden"],["class","flex p-2 items-center border-none border-t border-solid border-gray-300",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-none","border-t","border-solid","border-gray-300"],[1,"flex-1","px-2"],[1,"text"],["edit","","mat-icon-button","",1,"mx-2",3,"click"],["remove","","mat-icon-button","",1,"mx-2",3,"click"]],template:function(O,f){1&O&&(t.YNc(0,L,17,10,"div",0),t.YNc(1,E,2,3,"div",1),t.TgZ(2,"mat-menu",null,2)(4,"button",3),t.NdJ("click",function(){return f.addOption()}),t.TgZ(5,"app-icon"),t._uU(6,"add"),t.qZA(),t.TgZ(7,"div",4),t._uU(8,"Add Option"),t.qZA()(),t.TgZ(9,"button",3),t.NdJ("click",function(){return f.editItem()}),t.TgZ(10,"app-icon"),t._uU(11,"edit"),t.qZA(),t.TgZ(12,"div",4),t._uU(13,"Edit Item"),t.qZA()(),t.TgZ(14,"button",3),t.NdJ("click",function(){return f.removeItem()}),t.TgZ(15,"app-icon"),t._uU(16,"delete"),t.qZA(),t.TgZ(17,"div",4),t._uU(18,"Remove Item"),t.qZA()()()),2&O&&(t.Q6J("ngIf",f.item),t.xp6(1),t.Q6J("ngIf",f.item))},dependencies:[T.sg,T.O5,m.VK,m.OP,m.p6,a.o,R.lW,T.Ov,T.H9],styles:["[_nghost-%COMP%]{background-color:#fff;border:1px solid #ccc;border-radius:.25rem;overflow:hidden;width:768px;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=catering-menu-item.component.ts-angular-inline--92.css.map*/"]}),I})()},8501:(G,Q,o)=>{o.d(Q,{B:()=>O});var n=o(4505),t=o(6942),T=o(729),m=o(2560),a=o(4666),R=o(5892),K=o(5306),L=o(8644);function b(f,x){if(1&f&&(m.ynx(0),m._UZ(1,"div",6),m.BQk()),2&f){const C=x.$implicit;m.xp6(1),m.Q6J("item",C)}}function E(f,x){if(1&f&&(m.ynx(0),m.YNc(1,b,2,1,"ng-container",5),m.ALo(2,"async"),m.BQk()),2&f){const C=m.oxw();m.xp6(1),m.Q6J("ngForOf",m.lcZ(2,1,C.menu))}}function N(f,x){if(1&f&&(m.ynx(0),m._UZ(1,"div",6),m.BQk()),2&f){const C=x.$implicit;m.xp6(1),m.Q6J("item",C)}}function I(f,x){if(1&f&&(m.TgZ(0,"mat-tab",7),m.YNc(1,N,2,1,"ng-container",5),m.ALo(2,"async"),m.qZA()),2&f){const C=x.$implicit,s=m.oxw();m.Q6J("label",C),m.xp6(1),m.Q6J("ngForOf",m.lcZ(2,2,s.tab_menu)[C])}}function U(f,x){1&f&&(m.TgZ(0,"div",8)(1,"app-icon"),m._uU(2,"close"),m.qZA(),m.TgZ(3,"p"),m._uU(4,"No items in menu"),m.qZA()())}let O=(()=>{class f{constructor(C){this._catering=C,this.menu=this._catering.menu,this.shown_tab=new n.X(""),this.tab_menu=this.menu.pipe((0,t.U)(s=>{const u={};for(const i of this.categories)u[i]=s.filter(_=>_.category===i);return u}))}get categories(){return this._catering.categories}}return f.\u0275fac=function(C){return new(C||f)(m.Y36(T.j))},f.\u0275cmp=m.Xpm({type:f,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(C,s){if(1&C&&(m.TgZ(0,"mat-tab-group",0),m.NdJ("selectedIndexChange",function(i){return s.shown_tab.next(0===i?"":s.categories[i-1])}),m.TgZ(1,"mat-tab",1),m.YNc(2,E,3,3,"ng-container",2),m.ALo(3,"async"),m.qZA(),m.YNc(4,I,3,4,"mat-tab",3),m.qZA(),m.YNc(5,U,5,0,"ng-template",null,4,m.W1O)),2&C){const u=m.MAs(6);let i;m.xp6(2),m.Q6J("ngIf",null==(i=m.lcZ(3,3,s.menu))?null:i.length)("ngIfElse",u),m.xp6(2),m.Q6J("ngForOf",s.categories)}},dependencies:[a.sg,a.O5,R.SP,R.uX,K.o,L.V,a.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--93.css.map*/"]}),f})()},7413:(G,Q,o)=>{o.d(Q,{M:()=>v});var n=o(2560),t=o(2508),T=o(1484),m=o(3245),a=o(2962),R=o(4666),K=o(8550),L=o(207),b=o(4792),E=o(5306),N=o(5074),I=o(4522),U=o(1267),O=o(1708);function f(h,P){1&h&&(n.TgZ(0,"button",7)(1,"app-icon"),n._uU(2,"close"),n.qZA()())}function x(h,P){if(1&h&&(n.TgZ(0,"div",10)(1,"label",11),n._uU(2," Name"),n.TgZ(3,"span"),n._uU(4,"*"),n.qZA(),n._uU(5,": "),n.qZA(),n.TgZ(6,"mat-form-field",12),n._UZ(7,"input",13),n.TgZ(8,"mat-error"),n._uU(9,"Name is required"),n.qZA()()()),2&h){const D=n.oxw(2);n.xp6(1),n.ekj("error",D.form.controls.name.invalid&&D.form.controls.name.touched)}}function C(h,P){if(1&h&&(n.TgZ(0,"div",10)(1,"label",14),n._uU(2," Type"),n.TgZ(3,"span"),n._uU(4,"*"),n.qZA(),n._uU(5,": "),n.qZA(),n.TgZ(6,"mat-form-field",12),n._UZ(7,"input",15),n.TgZ(8,"mat-error"),n._uU(9,"Type is required"),n.qZA()()()),2&h){const D=n.oxw(2),Y=n.MAs(9);n.xp6(1),n.ekj("error",D.form.controls.group.invalid&&D.form.controls.group.touched),n.xp6(6),n.Q6J("matAutocomplete",Y)}}function s(h,P){1&h&&(n.TgZ(0,"div",10)(1,"label",11),n._uU(2,"Unit Price:"),n.qZA(),n.TgZ(3,"mat-form-field",12),n._UZ(4,"input",16),n.qZA()())}function u(h,P){1&h&&(n.TgZ(0,"div",10)(1,"mat-checkbox",17),n._uU(2," Can select multiple of type "),n.qZA()())}function i(h,P){if(1&h&&(n.TgZ(0,"form",8),n.YNc(1,x,10,2,"div",9),n.YNc(2,C,10,3,"div",9),n.YNc(3,s,5,0,"div",9),n.YNc(4,u,3,0,"div",9),n.qZA()),2&h){const D=n.oxw();n.Q6J("formGroup",D.form),n.xp6(1),n.Q6J("ngIf",D.form.controls.name),n.xp6(1),n.Q6J("ngIf",D.form.controls.group),n.xp6(1),n.Q6J("ngIf",D.form.controls.unit_price),n.xp6(1),n.Q6J("ngIf",D.form.controls.multiple)}}function _(h,P){if(1&h){const D=n.EpF();n.TgZ(0,"footer",18)(1,"button",19),n.NdJ("click",function(){n.CHM(D);const X=n.oxw();return n.KtG(X.saveChanges())}),n._uU(2," Save "),n.qZA()()}if(2&h){const D=n.oxw();n.xp6(1),n.Q6J("disabled",!D.form.dirty)}}function g(h,P){1&h&&(n.TgZ(0,"div",20),n._UZ(1,"mat-spinner",21),n.TgZ(2,"p"),n._uU(3,"Saving catering item option..."),n.qZA()())}function e(h,P){if(1&h&&(n.TgZ(0,"mat-option",22),n._uU(1),n.qZA()),2&h){const D=P.$implicit;n.Q6J("value",D),n.xp6(1),n.hij(" ",D," ")}}let v=(()=>{class h{constructor(D){this._data=D,this.event=new n.vpe,this.form=new t.cw({name:new t.NI(this.option.name||"",[t.kI.required]),group:new t.NI(this.option.group||"",[t.kI.required]),unit_price:new t.NI(this.option.unit_price),multiple:new t.NI(!!this.option.multiple,[])}),this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}saveChanges(){this.loading=!0;const D={...this.option,id:this.option.id||`option-${(0,m.Iy)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new a.U({...this._data.parent,options:this._data.parent.options.filter(Y=>Y.id!==D.id).concat([D])})}})}}return h.\u0275fac=function(D){return new(D||h)(n.Y36(T.WI))},h.\u0275cmp=n.Xpm({type:h,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(D,Y){if(1&D&&(n.TgZ(0,"header")(1,"h3",0),n._uU(2),n.qZA(),n.YNc(3,f,3,0,"button",1),n.qZA(),n.YNc(4,i,5,5,"form",2),n.YNc(5,_,3,1,"footer",3),n.YNc(6,g,4,0,"ng-template",null,4,n.W1O),n.TgZ(8,"mat-autocomplete",null,5),n.YNc(10,e,2,2,"mat-option",6),n.qZA()),2&D){const X=n.MAs(7);n.xp6(2),n.hij(" ",Y.option.id?"Edit":"Add"," Item Option "),n.xp6(1),n.Q6J("ngIf",!Y.loading),n.xp6(1),n.Q6J("ngIf",Y.form&&!Y.loading)("ngIfElse",X),n.xp6(1),n.Q6J("ngIf",!Y.loading),n.xp6(5),n.Q6J("ngForOf",Y.types)}},dependencies:[R.sg,R.O5,K.XC,K.ZL,L.ey,T.ZT,T.uh,b.oG,t._Y,t.Fj,t.wV,t.JJ,t.JL,t.sg,t.u,E.o,N.TO,N.KE,I.lW,U.Nt,O.Ou],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-option-modal.component.ts-angular-inline--89.css.map*/"]}),h})()},4204:(G,Q,o)=>{o.d(Q,{m:()=>K});var n=o(2560),t=o(4666),T=o(5306),m=o(4522);const a=["catering-order-item",""];function R(L,b){if(1&L&&(n.ynx(0),n.TgZ(1,"div",1),n._UZ(2,"div",2),n.qZA(),n.TgZ(3,"div",3)(4,"button",4)(5,"app-icon"),n._uU(6),n.qZA()()(),n.TgZ(7,"div",5),n._uU(8),n.qZA(),n.BQk()),2&L){const E=n.oxw();n.xp6(4),n.ekj("bg-success",E.active)("text-white",E.active)("border-solid",E.active),n.xp6(2),n.Oqu(E.active?"done":"local_pizza"),n.xp6(2),n.hij(" ",null==E.item?null:E.item.name," ")}}let K=(()=>{class L{constructor(){this.active=!1}}return L.\u0275fac=function(E){return new(E||L)},L.\u0275cmp=n.Xpm({type:L,selectors:[["","catering-order-item",""]],inputs:{item:"item"},attrs:a,decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-20","text-right"],["name","item-bar",1,"bg-gray-300"],[1,"w-12","mr-4"],["action","","mat-icon-button","",1,"border","border-gray-300","border-dashed","text-2xl","text-dark-fade"],[1,"flex-1","border-b","border-gray-300","border-solid","py-4"]],template:function(E,N){1&E&&n.YNc(0,R,9,8,"ng-container",0),2&E&&n.Q6J("ngIf",N.item)},dependencies:[t.O5,T.o,m.lW],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}[name=item-bar][_ngcontent-%COMP%]{height:2px;margin-left:auto;margin-right:1rem;width:calc(50% - .9375rem)}\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--94.css.map*/"]}),L})()},2189:(G,Q,o)=>{o.d(Q,{I:()=>L});var n=o(2851),t=o(2560),T=o(4666),m=o(961);function a(b,E){if(1&b&&(t.TgZ(0,"li",12),t._UZ(1,"catering-order",13),t.qZA()),2&b){const N=E.$implicit;t.xp6(1),t.Q6J("order",N)}}function R(b,E){1&b&&(t.TgZ(0,"div",14)(1,"p"),t._uU(2,"No Catering Orders"),t.qZA()())}function K(b,E){1&b&&t._UZ(0,"mat-progress-bar",15)}let L=(()=>{class b{constructor(N){this._orders=N,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(N,I){return I?I.id:void 0}}return b.\u0275fac=function(N){return new(N||b)(t.Y36(n.I))},b.\u0275cmp=t.Xpm({type:b,selectors:[["catering-order-list"]],decls:22,vars:10,consts:[[1,"w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-gray-300","bg-white"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-gray-300",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block text-dark-fade",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-gray-300"],[3,"order"],["empty","",1,"info-block","text-dark-fade"],["mode","indeterminate",1,"w-full"]],template:function(N,I){if(1&N&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Time"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Location"),t.qZA(),t.TgZ(6,"div",4),t._uU(7,"Host"),t.qZA(),t.TgZ(8,"div",2),t._uU(9,"Charge Code"),t.qZA(),t.TgZ(10,"div",5),t._uU(11,"Invoice No."),t.qZA(),t.TgZ(12,"div",6),t._uU(13,"Status"),t.qZA(),t._UZ(14,"div",7),t.qZA(),t.TgZ(15,"ul",8),t.YNc(16,a,2,1,"li",9),t.ALo(17,"async"),t.YNc(18,R,3,0,"div",10),t.ALo(19,"async"),t.qZA(),t.YNc(20,K,1,0,"mat-progress-bar",11),t.ALo(21,"async")),2&N){let U;t.xp6(16),t.Q6J("ngForOf",t.lcZ(17,4,I.order_list))("ngForTrackBy",I.trackByFn),t.xp6(2),t.Q6J("ngIf",!(null!=(U=t.lcZ(19,6,I.order_list))&&U.length)),t.xp6(2),t.Q6J("ngIf",t.lcZ(21,8,I.loading))}},dependencies:[T.sg,T.O5,m.p,T.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--95.css.map*/"]}),b})()},9504:(G,Q,o)=>{o.d(Q,{W:()=>V});var n=o(1670),t=o(2560),T=o(1484),m=o(1233),a=o(6119),R=o(475),K=o(1506),L=o(8025),b=o(2962),E=o(5163),N=o(4666),I=o(5892),U=o(6896),O=o(2508),f=o(5306),x=o(4522),C=o(1708),s=o(2793);function u(M,q){1&M&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function i(M,q){if(1&M){const c=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(W){t.CHM(c);const F=t.oxw().$implicit,j=t.oxw(5);return t.KtG(j.updateItemQuantity(F,W))}),t.qZA()}if(2&M){const c=t.oxw().$implicit;t.Q6J("ngModel",c.quantity)}}function _(M,q){if(1&M){const c=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),t._uU(4,"remove"),t.qZA()()(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(c);const W=t.oxw().$implicit,F=t.oxw(5);return t.KtG(F.addItem(W))}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA()()()}if(2&M){const c=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",c.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",c.quantity," ")}}function g(M,q){if(1&M&&(t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,u,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,i,1,1,"a-counter",15),t.YNc(9,_,10,3,"div",16),t.qZA()),2&M){const c=q.$implicit;t.xp6(3),t.hij(" ",c.name," "),t.xp6(1),t.Q6J("ngIf",c.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,5,c.unit_price/100)," "),t.xp6(2),t.Q6J("ngIf",!c.options.length),t.xp6(1),t.Q6J("ngIf",c.options.length)}}const e=function(){return{}};function v(M,q){if(1&M&&(t.TgZ(0,"mat-tab",8)(1,"div",9),t.YNc(2,g,10,7,"div",10),t.qZA()()),2&M){const c=t.oxw().$implicit,J=t.oxw(3);t.Q6J("label",c),t.xp6(2),t.Q6J("ngForOf",(J.menu_items||t.DdM(2,e))[c])}}function h(M,q){if(1&M&&(t.ynx(0),t.YNc(1,v,3,3,"mat-tab",7),t.BQk()),2&M){const c=q.$implicit,J=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(J.menu_items||t.DdM(1,e))[c].length)}}function P(M,q){if(1&M&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,h,2,2,"ng-container",6),t.qZA(),t.BQk()),2&M){const c=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",c.categories)}}function D(M,q){if(1&M&&(t.TgZ(0,"div",4),t.YNc(1,P,3,1,"ng-container",5),t.qZA()),2&M){const c=t.oxw(),J=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!c.show_order_details)("ngIfElse",J)}}function Y(M,q){if(1&M){const c=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){t.CHM(c);const W=t.oxw(2);return t.KtG(W.show_order_details=!0)}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&M){const c=t.oxw(2);t.xp6(3),t.Q6J("disabled",!c.order.item_count)("matBadge",c.order.item_count)("matBadgeHidden",!c.order.item_count)}}function X(M,q){if(1&M){const c=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(c);const W=t.oxw(2);return t.KtG(W.show_order_details=!1)}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){t.CHM(c);const W=t.oxw(2);return t.KtG(W.saveOrder())}),t._uU(3," Save Order "),t.qZA()}}function et(M,q){if(1&M&&(t.TgZ(0,"footer",24),t.YNc(1,Y,5,3,"ng-container",5),t.YNc(2,X,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&M){const c=t.MAs(3),J=t.oxw();t.xp6(1),t.Q6J("ngIf",!J.show_order_details)("ngIfElse",c)}}function w(M,q){if(1&M&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&M){const c=t.oxw();t.xp6(3),t.Oqu(c.loading)}}function H(M,q){if(1&M&&(t.TgZ(0,"div",37),t._uU(1),t.qZA()),2&M){const c=t.oxw().$implicit,J=t.oxw(2);t.Q6J("matTooltip",J.optionsFor(c)),t.xp6(1),t.AsE(" ",c.options.length," option",1===c.options.length?"":"s"," selected ")}}function Z(M,q){if(1&M){const c=t.EpF();t.TgZ(0,"div",34)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,H,2,3,"div",35),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",36),t.NdJ("ngModelChange",function(W){const j=t.CHM(c).$implicit,$=t.oxw(2);return t.KtG($.updateItemQuantity(j,W))}),t.qZA()()}if(2&M){const c=q.$implicit;t.xp6(3),t.Oqu(c.name),t.xp6(1),t.Q6J("ngIf",c.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,4,c.total_cost/100)," "),t.xp6(2),t.Q6J("ngModel",c.quantity)}}function B(M,q){if(1&M&&(t.TgZ(0,"header",32)(1,"h3"),t._uU(2,"Confirm Order"),t.qZA()(),t.TgZ(3,"div",9),t.YNc(4,Z,9,6,"div",33),t.qZA()),2&M){const c=t.oxw();t.xp6(4),t.Q6J("ngForOf",c.order.items)}}function k(M,q,c){let J=!0;for(const W of q)if(M.category===W.name||M.tags.includes(W.name)||c.space?.zones.includes(W.name)||"*"===W.name){let F=0;for(const j of W.rules){const $=new Date(c.date);switch(j[0]){case"after_hour":F+=(0,m.Z)($,(0,a.Z)($,j[1]))?1:0;break;case"before_hour":F+=(0,R.Z)($,(0,a.Z)($,j[1]))?1:0;break;case"min_length":F+=c.duration>=(0,L.H1)(j[1])?1:0;break;case"max_length":F+=c.duration<=(0,L.H1)(j[1])?1:0;break;case"visitor_type":F+=c.ext("visitor_type")===j[1]?1:0;break;default:F++}}J=F>=W.rules.length}return J}let V=(()=>{class M extends K.KG{constructor(c){super(),this._data=c,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var c=this;return(0,n.Z)(function*(){c.loading="Loading menu...",c.order=new E.G(c._data.order),c.rules=yield c._data.getCateringConfig(c.order.event?.space?.level?.parent_id),c._data.menu.subscribe(J=>{c.loading="Loading menu...";const W=(0,K.Tw)(J.map(j=>j.category)),F={};for(const j of W)F[j]=J.filter($=>$.category===j&&k($,c.rules,c.order.event));c.categories=W,c.menu_items=F,c.updateMenuQuantities(),c.timeout("clear_loading",()=>c.loading="",1e3)})})()}addItem(c,J=!0){const W=this.order.items.find(F=>F.id===c.id&&F.options.length===F.options.reduce((j,$)=>j+(c.options.find(ot=>$.id===ot.id)?1:0),0));J&&c.options?.length?this._data.selectOptions(c.options).then(F=>{const j=new b.U({...c,options:F});this.addItem(j,!1)}):this.order=new E.G(W?{...this.order,items:this.order.items.filter(F=>!(F.id===c.id&&F.options_string===c.options_string)).concat([new b.U({...c,quantity:W.quantity+1})])}:{...this.order,items:this.order.items.concat([new b.U({...c,quantity:1})])}),this.updateMenuQuantities()}removeItem(c){this.order=new E.G({...this.order,items:this.order.items.filter(J=>J.id!==c.id&&J.options_string===c.options_string)}),this.updateMenuQuantities()}updateItemQuantity(c,J){const W=this.order.items.find(j=>j.id===c.id&&j.options_string===c.options_string);let F=[...this.order.items];F=W?this.order.items.filter(j=>!(j.id===c.id&&j.options_string===c.options_string)).concat([new b.U({...c,quantity:J})]):this.order.items.concat([new b.U({...c,quantity:J})]),F.sort((j,$)=>j.name.localeCompare($.name)),this.order=new E.G({...this.order,items:F}),this.updateMenuQuantities()}updateMenuQuantities(){for(const c in this.menu_items)for(const J of this.menu_items[c])J.quantity=this.order.items.reduce((W,F)=>F.id===J.id?W+F.quantity:W,0)}optionsFor(c){return c.options.map(J=>J.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return M.\u0275fac=function(c){return new(c||M)(t.Y36(T.WI))},M.\u0275cmp=t.Xpm({type:M,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(c,J){if(1&c&&(t.YNc(0,D,2,2,"div",0),t.YNc(1,et,4,2,"footer",1),t.YNc(2,w,4,1,"ng-template",null,2,t.W1O),t.YNc(4,B,5,1,"ng-template",null,3,t.W1O)),2&c){const W=t.MAs(3);t.Q6J("ngIf",!J.loading)("ngIfElse",W),t.xp6(1),t.Q6J("ngIf",!J.loading)}},dependencies:[N.sg,N.O5,I.SP,I.uX,T.ZT,U.gM,O.Fj,O.JJ,O.On,f.o,x.lW,C.Ou,s.R,N.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--90.css.map*/"]}),M})()},3129:(G,Q,o)=>{o.d(Q,{R:()=>C});var n=o(2560),t=o(1484),T=o(3245),m=o(4666),a=o(4792),R=o(2922),K=o(2508),L=o(5306),b=o(4522);function E(s,u){if(1&s&&(n.TgZ(0,"div",18),n._uU(1),n.ALo(2,"currency"),n.qZA()),2&s){const i=n.oxw().$implicit;n.xp6(1),n.hij(" +",n.lcZ(2,1,i.unit_price/100)," ")}}function N(s,u){if(1&s&&(n.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),n._uU(3),n.qZA(),n.YNc(4,E,3,3,"div",17),n.qZA()()),2&s){const i=u.$implicit;n.Q6J("value",i.id),n.xp6(3),n.hij(" ",i.name," "),n.xp6(1),n.Q6J("ngIf",i.unit_price)}}function I(s,u){if(1&s){const i=n.EpF();n.ynx(0),n.TgZ(1,"mat-radio-group",10),n.NdJ("ngModelChange",function(g){n.CHM(i);const e=n.oxw().$implicit,v=n.oxw();return n.KtG(v.updateGroupOption(e,g))}),n.TgZ(2,"mat-radio-button",11)(3,"span",12),n._uU(4,"None"),n.qZA()(),n.YNc(5,N,5,3,"mat-radio-button",13),n.qZA(),n.BQk()}if(2&s){const i=n.oxw().$implicit;n.xp6(5),n.Q6J("ngForOf",null==i?null:i.options)}}function U(s,u){if(1&s&&(n.TgZ(0,"div",18),n._uU(1),n.ALo(2,"currency"),n.qZA()),2&s){const i=n.oxw().$implicit;n.xp6(1),n.hij(" +",n.lcZ(2,1,i.unit_price/100)," ")}}function O(s,u){if(1&s){const i=n.EpF();n.TgZ(0,"mat-checkbox",20),n.NdJ("ngModelChange",function(g){const v=n.CHM(i).$implicit,h=n.oxw(3);return n.KtG(h.option_state[v.id]=g)}),n.TgZ(1,"div",15)(2,"div",16),n._uU(3),n.qZA(),n.YNc(4,U,3,3,"div",17),n.qZA()()}if(2&s){const i=u.$implicit,_=n.oxw(3);n.Q6J("ngModel",_.option_state[i.id]),n.xp6(3),n.hij(" ",i.name," "),n.xp6(1),n.Q6J("ngIf",i.unit_price)}}function f(s,u){if(1&s&&n.YNc(0,O,5,3,"mat-checkbox",19),2&s){const i=n.oxw().$implicit;n.Q6J("ngForOf",null==i?null:i.options)}}function x(s,u){if(1&s&&(n.TgZ(0,"div",5)(1,"div",6),n._uU(2),n.qZA(),n.TgZ(3,"div",7),n.YNc(4,I,6,1,"ng-container",8),n.YNc(5,f,1,1,"ng-template",null,9,n.W1O),n.qZA()()),2&s){const i=u.$implicit,_=n.MAs(6);n.uIk("group",i.name),n.xp6(2),n.Oqu(i.name),n.xp6(2),n.Q6J("ngIf",!i.multiple)("ngIfElse",_)}}let C=(()=>{class s{constructor(i){this._data=i,this.event=new n.vpe,this.option_state={};const _=(0,T.Tw)(this._data.options.map(e=>e.group||"Other")),g=[];for(const e of _){const v=this._data.options.filter(h=>h.group===e);g.push({name:e,multiple:!!v.find(h=>h.multiple),options:v})}this.groups=g}updateGroupOption(i,_){for(const g of i.options)this.option_state[g.id]=g.id===_}saveOptions(){const i=this._data.options.filter(_=>this.option_state[_.id]);this.event.emit({reason:"done",metadata:{options:i}})}}return s.\u0275fac=function(i){return new(i||s)(n.Y36(t.WI))},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(i,_){1&i&&(n.TgZ(0,"header")(1,"h3"),n._uU(2,"Select options"),n.qZA(),n.TgZ(3,"button",0)(4,"app-icon"),n._uU(5,"close"),n.qZA()()(),n.TgZ(6,"main",1),n.YNc(7,x,7,4,"div",2),n.qZA(),n.TgZ(8,"footer",3)(9,"button",4),n.NdJ("click",function(){return _.saveOptions()}),n._uU(10," Save "),n.qZA()()),2&i&&(n.xp6(7),n.Q6J("ngForOf",_.groups))},dependencies:[m.sg,m.O5,t.ZT,a.oG,R.VQ,R.U0,K.JJ,K.On,L.o,b.lW,m.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--91.css.map*/"]}),s})()},961:(G,Q,o)=>{o.d(Q,{p:()=>f});var n=o(1506),t=o(2851),m=(o(5163),o(2460)),a=o(2560),R=o(4666),K=o(8589),L=o(5306),b=o(4522),E=o(4204);function N(x,C){if(1&x){const s=a.EpF();a.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),a._uU(4,"room_service"),a.qZA()()(),a.TgZ(5,"div",7),a._uU(6),a.ALo(7,"date"),a.qZA(),a.TgZ(8,"div",8),a._uU(9),a.qZA(),a.TgZ(10,"div",9),a._uU(11),a.qZA(),a.TgZ(12,"div",10),a._uU(13),a.qZA(),a.TgZ(14,"div",11),a._uU(15),a.qZA(),a.TgZ(16,"div",12)(17,"button",13)(18,"div",14),a._uU(19),a.qZA(),a.TgZ(20,"app-icon",15),a._uU(21,"arrow_drop_down"),a.qZA()()(),a.TgZ(22,"div",16)(23,"button",17),a.NdJ("click",function(){a.CHM(s);const i=a.oxw();return a.KtG(i.show_items=!i.show_items)}),a.TgZ(24,"app-icon"),a._uU(25),a.qZA()()()()}if(2&x){const s=a.oxw(),u=a.MAs(3);a.ekj("shown",s.show_items),a.xp6(6),a.Oqu(a.xi3(7,12,s.order.deliver_at,"shortTime")),a.xp6(3),a.hij(" ",(null==s.order.event?null:s.order.event.space.display_name)||(null==s.order.event?null:s.order.event.space.name)||"~ No Location ~"," "),a.xp6(2),a.hij(" ",(null==s.order.event||null==s.order.event.organiser?null:s.order.event.organiser.name)||(null==s.order.event?null:s.order.event.host)||"~ Unknown Host ~"," "),a.xp6(2),a.Oqu(s.order.charge_code||"~ No Code ~"),a.xp6(2),a.hij(" ",s.order.invoice_number||"~ No Invoice ~"," "),a.xp6(2),a.Udp("background",null==s.status?null:s.status.colour),a.Q6J("matMenuTriggerFor",u),a.xp6(2),a.hij(" ",null==s.status?null:s.status.name," "),a.xp6(6),a.Oqu(s.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function I(x,C){1&x&&a._UZ(0,"li",21),2&x&&a.Q6J("item",C.$implicit)}function U(x,C){if(1&x&&(a.TgZ(0,"ul",18),a._UZ(1,"div",19),a.YNc(2,I,1,1,"li",20),a.qZA()),2&x){const s=a.oxw();a.ekj("shown",s.show_items),a.Q6J("@show",s.show_items?"show":"hide"),a.xp6(1),a.Udp("height",3.125*s.order.items.length-1+"rem"),a.xp6(1),a.Q6J("ngForOf",s.order.items)}}function O(x,C){if(1&x){const s=a.EpF();a.TgZ(0,"button",22),a.NdJ("click",function(){const _=a.CHM(s).$implicit,g=a.oxw();return a.KtG(g.updateStatus(_.id))}),a._UZ(1,"div",23),a.TgZ(2,"span",24),a._uU(3),a.qZA()()}if(2&x){const s=C.$implicit;a.xp6(1),a.Udp("background-color",s.colour),a.xp6(2),a.Oqu(s.name)}}let f=(()=>{class x{constructor(s){this._orders=s,this.show_items=!1,this.statuses=m.U,this.updateStatus=u=>this._orders.updateStatus(this.order,u)}get status(){return this.statuses.find(s=>s.id===this.order.status)}}return x.\u0275fac=function(s){return new(s||x)(a.Y36(t.I))},x.\u0275cmp=a.Xpm({type:x,selectors:[["catering-order"]],inputs:{order:"order"},decls:5,vars:3,consts:[["class","w-full flex items-center py-2 bg-gray-100",3,"shown",4,"ngIf"],["class","list-none p-0 m-0 w-full relative",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2","bg-gray-100"],[1,"w-20","flex","items-center","justify-center"],[1,"rounded-full","bg-gray-300","p-2","text-2xl","text-dark-fade","flex","items-center","justify-center"],["time","",1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-24"],[1,"w-28"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["mat-icon-button","",3,"click"],[1,"list-none","p-0","m-0","w-full","relative"],["name","bar",1,"absolute","top-0","bg-gray-300"],["catering-order-item","","class","flex items-center",3,"item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(s,u){1&s&&(a.YNc(0,N,26,15,"div",0),a.YNc(1,U,3,6,"ul",1),a.TgZ(2,"mat-menu",null,2),a.YNc(4,O,4,3,"button",3),a.qZA()),2&s&&(a.Q6J("ngIf",u.order),a.xp6(1),a.Q6J("ngIf",null==u.order?null:u.order.items.length),a.xp6(3),a.Q6J("ngForOf",u.statuses))},dependencies:[R.sg,R.O5,K.VK,K.OP,K.p6,L.o,b.lW,E.m,R.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}.shown[_ngcontent-%COMP%]{background-color:#eee}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}\n/*# sourceMappingURL=catering-order.component.ts-angular-inline--96.css.map*/"],data:{animation:[n.X7]}}),x})()},2851:(G,Q,o)=>{o.d(Q,{I:()=>C});var n=o(4505),t=o(7716),T=o(823),m=o(9095),a=o(6942),R=o(8759),K=o(9128),L=o(1810),b=o(9377),E=o(3200),N=o(1506),I=o(4211),U=o(3902),O=o(5163),f=o(2560);let C=(()=>{class s extends N.KG{constructor(){super(),this._poll=new n.X(0),this._loading=new n.X(!1),this._filters=new n.X({}),this.orders=(0,t.aj)([this._filters,this._poll]).pipe((0,T.b)(500),(0,m.w)(([i])=>{this._loading.next(!0);const _=(0,L.Z)((0,b.Z)(i.date||Date.now())),g=(0,L.Z)((0,E.Z)(i.date||Date.now()));return(0,I.u$)({zone_ids:(i.zones||[]).join(","),period_start:_,period_end:g})}),(0,a.U)(i=>(0,N.xH)(i.map(_=>_.ext("catering")))),(0,R.b)(()=>this._loading.next(!1)),(0,K.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,a.U)(i=>i.filter(_=>function x(s,u){const i=(u.search||"").toLowerCase();return!!s.items.find(_=>_.name.toLowerCase().includes(i)||!!_.options.find(g=>g.name.toLowerCase().includes(i)))}(_,this._filters.getValue())))),this.subscription("changes",this.orders.subscribe())}get filters(){return this._filters.getValue()}set filters(i){this._filters.next(i)}startPolling(i=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),i)}stopPolling(){this.clearInterval("polling")}updateStatus(i,_){const g=new O.G({...i,status:_}),e=new U.y({...i.event,catering:[...i.event.ext("catering").filter(v=>v.id!==i.id),g].map(v=>new O.G({...v}))});return(0,I.ry)(e)}}return s.\u0275fac=function(i){return new(i||s)},s.\u0275prov=f.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},729:(G,Q,o)=>{o.d(Q,{j:()=>C});var n=o(1670),t=o(3690),T=o(4505),m=o(5670),a=o(1506),R=o(3619),K=o(6336),L=o(7413),b=o(2090),E=o(2962),N=o(5163),I=o(9504),U=o(3129),O=o(5730),f=o(2560),x=o(1484);let C=(()=>{class s extends a.KG{constructor(i,_,g){var e;super(),e=this,this._org=i,this._dialog=_,this._settings=g,this._menu=new T.X([]),this._loading=new T.X(!1),this._currency=new T.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(function(){var v=(0,n.Z)(function*(h){if(h){const P=(yield e.getCateringForZone(h.id)).map(D=>new E.U(D));e._currency.next(e._settings.get("app.currency")||h.currency||"USD"),e._menu.next(P)}});return function(h){return v.apply(this,arguments)}}()))}get categories(){const i=this._menu.getValue();return(0,a.Tw)(i.map(_=>_.category))}manageCateringOrder(i){var _=this;return(0,n.Z)(function*(){const g=_._dialog.open(I.W,{data:{order:i,menu:_.menu,loading:_.loading,getCateringConfig:v=>_.getCateringConfig(v),selectOptions:v=>_.selectOptions(v)}}),e=yield Promise.race([g.componentInstance.event.pipe((0,m.P)(v=>"done"===v.reason)).toPromise(),g.afterClosed().toPromise()]);return g.close(),e?.metadata?.order||i})()}addItem(i=new E.U){var _=this;return(0,n.Z)(function*(){const g=_._dialog.open(K.w,{data:{item:i,categories:_.categories}}),e=yield Promise.race([g.componentInstance.event.pipe((0,m.P)(P=>"done"===P.reason)).toPromise(),g.afterClosed().toPromise()]);if("done"!==e?.reason)return;const v=_._menu.getValue(),h=v.findIndex(P=>P.id===i.id);h>=0?v.splice(h,1,e.metadata.item):v.push(e.metadata.item),_.updateMenu(_._org.building.id,v).then(()=>{_._menu.next([...v]),g.close()},()=>g.componentInstance.loading=!1)})()}addOption(i,_={}){var g=this;return(0,n.Z)(function*(){const e=(0,a.Tw)(i.options.map(Y=>Y.group)),v=g._dialog.open(L.M,{data:{parent:i,option:_,types:e}}),h=yield Promise.race([v.componentInstance.event.pipe((0,m.P)(Y=>"done"===Y.reason)).toPromise(),v.afterClosed().toPromise()]);if("done"!==h?.reason)return;const P=g._menu.getValue(),D=P.findIndex(Y=>Y.id===i.id);D>=0?P.splice(D,1,h.metadata.item):P.push(h.metadata.item),g.updateMenu(g._org.building.id,P).then(()=>{g._menu.next([...P]),v.close()},()=>v.componentInstance.loading=!1)})()}selectOptions(i){var _=this;return(0,n.Z)(function*(){const g=_._dialog.open(U.R,{data:{options:i}}),e=yield Promise.race([g.componentInstance.event.pipe((0,m.P)(v=>"done"===v.reason)).toPromise(),g.afterClosed().toPromise()]);return"done"!==e?.reason?[]:(g.close(),e.metadata.options)})()}deleteItem(i){var _=this;return(0,n.Z)(function*(){const g=yield(0,a._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${i.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},_._dialog);if("done"!==g.reason)return;g.loading("Removing catering item...");const e=_._menu.getValue().filter(v=>i.id!==v.id);_.updateMenu(_._org.building.id,e).then(()=>{_._menu.next([...e]),g.close()},()=>g.loading(""))})()}deleteOption(i,_){var g=this;return(0,n.Z)(function*(){const e=yield(0,a._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${_.name}" from "${i.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},g._dialog);if("done"!==e.reason)return;e.loading("Removing catering item option...");const v=g._menu.getValue();v.splice(v.findIndex(h=>h.id===i.id),1,new E.U({...i,options:i.options.filter(h=>h.id!==_.id)})),g.updateMenu(g._org.building.id,v).then(()=>{g._menu.next([...v]),e.close()},()=>e.loading(""))})()}editConfig(){var i=this;return(0,n.Z)(function*(){const _=yield i.getCateringConfig(i._org.building.id),g=i._menu.getValue(),e=(0,a.Tw)((0,a.xH)(g.map(P=>[P.category,...P.tags]))),v=i._dialog.open(b.S,{data:{config:_,types:e}}),h=yield Promise.race([v.componentInstance.event.pipe((0,m.P)(P=>"done"===P.reason)).toPromise(),v.afterClosed().toPromise()]);"done"===h?.reason&&i.updateConfig(i._org.building.id,h.metadata).then(()=>v.close(),()=>v.componentInstance.loading=!1)})()}importMenu(){var i=this;return(0,n.Z)(function*(){const _=i._dialog.open(O.m),g=yield Promise.race([_.componentInstance.event.pipe((0,m.P)(P=>"done"===P.reason)).toPromise(),_.afterClosed().toPromise()]);if("done"!==g?.reason)return;_.componentInstance.loading="Updating menu...";const e=i._menu.getValue(),v=i._org.building,h=(0,a.Tw)(g.metadata.concat(e),"id");yield i.updateMenu(v.id,h).catch(P=>{throw(0,a.cB)("Error importing catering menu"),_.close(),P}),(0,a.t5)(`Successfully imported catering menu. ${g.metadata.length} item(s) added.`),_.close()})()}updateMenu(i,_){return(0,t.Ymr)(i,{id:i,name:"catering",details:_,description:`Catering menu for ${i}`}).toPromise()}getCateringForZone(i){return(0,n.Z)(function*(){const _=(yield(0,t.rlq)(i,"catering").toPromise()).details;return _ instanceof Array?_:[]})()}getCateringConfig(i=this._org.building.id){return(0,n.Z)(function*(){const _=(yield(0,t.rlq)(i,"catering_config").toPromise()).details;return _ instanceof Array?_:[]})()}updateConfig(i,_){return(0,t.Ymr)(i,{id:i,name:"catering_config",details:_,description:`Catering menu config for ${i}`}).toPromise()}addItemToOrder(i,_){let g=i.items;const e=g.find(h=>h.id===_.id&&_.options?.length===h.options?.reduce((P,D)=>P+(_.options.find(Y=>D.id===Y.id)?1:0),0));return e?e.quantity+=1:g=g.concat([new E.U({..._,quantity:1})]),new N.G({...i,items:g,event:null})}}return s.\u0275fac=function(i){return new(i||s)(f.LFG(R.w7),f.LFG(x.uw),f.LFG(a.gb))},s.\u0275prov=f.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},7701:(G,Q,o)=>{o.d(Q,{g:()=>n});const n=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}]},2460:(G,Q,o)=>{o.d(Q,{U:()=>n});const n=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map