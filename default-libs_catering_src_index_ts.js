"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{7027:(j,L,n)=>{n.d(L,{Ud:()=>N.U,GX:()=>T.G,Ii:()=>w.I,jW:()=>S.j,uy:()=>u});var e=n(6362),t=n(587),C=n(3188),_=n(1534),i=n(5758),I=n(2796),b=n(2379),D=n(8390),h=n(89),A=n(7741),U=n(8318),d=(n(2090),n(6336),n(8644),n(8501),n(7413),n(4204),n(2189),n(9504),n(3129),n(961),n(5730),n(3184));let u=(()=>{class W{}return W.\u0275fac=function(y){return new(y||W)},W.\u0275mod=d.oAB({type:W}),W.\u0275inj=d.cJS({providers:[],imports:[[e.ez,I.Tx,b.Nh,C.Bb,i.Is,_.p9,D.Fk,h.AV,t.u5,t.UX,A.Kk,U.W9]]}),W})();var N=n(2962),T=n(5163),w=n(2851),S=n(729);n(7701),n(2460)},2090:(j,L,n)=>{n.d(L,{S:()=>p});var e=n(3184),t=n(5758),C=n(7701),_=n(6362),i=n(7317),I=n(5306),b=n(4770),D=n(4683),h=n(587),A=n(1434),U=n(1130);function x(g,r){1&g&&(e.TgZ(0,"button",5)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function E(g,r){if(1&g&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&g){const c=r.$implicit;e.Q6J("value",c.id),e.xp6(1),e.hij(" ",c.name," ")}}function v(g,r){if(1&g){const c=e.EpF();e.TgZ(0,"div",14)(1,"mat-form-field",8)(2,"mat-select",15),e.NdJ("ngModelChange",function(a){return e.CHM(c).$implicit[0]=a}),e.YNc(3,E,2,2,"mat-option",16),e.qZA()(),e.TgZ(4,"mat-form-field",8)(5,"input",17),e.NdJ("ngModelChange",function(a){return e.CHM(c).$implicit[1]=a}),e.qZA(),e.TgZ(6,"mat-error"),e._uU(7,"Rule value is required"),e.qZA()()()}if(2&g){const c=r.$implicit,o=e.oxw(2);e.xp6(2),e.Q6J("ngModel",c[0]),e.xp6(1),e.Q6J("ngForOf",o.rule_types),e.xp6(2),e.Q6J("ngModel",c[1])}}function m(g,r){if(1&g){const c=e.EpF();e.TgZ(0,"div",6)(1,"div",7)(2,"mat-form-field",8)(3,"input",9),e.NdJ("ngModelChange",function(a){return e.CHM(c).$implicit.name=a}),e.qZA(),e.TgZ(4,"mat-error"),e._uU(5,"Ruleset name is required"),e.qZA()(),e.TgZ(6,"button",10),e.NdJ("click",function(){const l=e.CHM(c).$implicit,d=e.oxw();return l.rules.push(["",""]),d.show_rules=l.id}),e.TgZ(7,"app-icon"),e._uU(8,"add"),e.qZA()(),e.TgZ(9,"button",11),e.NdJ("click",function(){const l=e.CHM(c).$implicit,d=e.oxw();return d.show_rules=d.show_rules!==l.id?l.id:""}),e.TgZ(10,"app-icon"),e._uU(11),e.qZA()()(),e.TgZ(12,"div",12),e.YNc(13,v,8,3,"div",13),e.qZA()()}if(2&g){const c=r.$implicit,o=e.oxw();e.xp6(3),e.Q6J("ngModel",c.name),e.xp6(6),e.Q6J("disabled",!c.rules.length),e.xp6(2),e.Oqu(o.show_rules===c.id?"expand_less":"expand_more"),e.xp6(1),e.Udp("height",(o.show_rules===c.id?3.5*c.rules.length:0)+"em"),e.xp6(1),e.Q6J("ngForOf",c.rules)}}let p=(()=>{class g{constructor(c){this._data=c,this.event=new e.vpe,this.loading=!1,this.rule_types=C.g,this.rulesets=(c.config||[]).map(o=>(o.rules=o.rules.map(a=>[a[0],JSON.stringify(a[1])]),o))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const c=this.rulesets.map(o=>Object.assign(Object.assign({},o),{rules:o.rules.map(a=>{let l=a[1];try{l=JSON.parse(a[1])}catch(d){}return[a[0],l]})}));this.event.emit({reason:"done",metadata:c})}}return g.\u0275fac=function(c){return new(c||g)(e.Y36(t.WI))},g.\u0275cmp=e.Xpm({type:g,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex px-2 h-14 space-x-2",4,"ngFor","ngForOf"],[1,"flex","px-2","h-14","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(c,o){1&c&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Edit Catering Configuration"),e.qZA(),e.YNc(3,x,3,0,"button",0),e.qZA(),e.TgZ(4,"main",1)(5,"button",2),e.NdJ("click",function(){return o.rulesets.push({id:o.new_id,rules:[]})}),e._uU(6," New Ruleset "),e.qZA(),e.YNc(7,m,14,6,"div",3),e.qZA(),e.TgZ(8,"footer",4)(9,"button",2),e.NdJ("click",function(){return o.saveChanges()}),e._uU(10,"Save Changes"),e.qZA()()),2&c&&(e.xp6(3),e.Q6J("ngIf",!o.loading),e.xp6(4),e.Q6J("ngForOf",o.rulesets))},directives:[_.O5,i.lW,t.ZT,I.o,_.sg,b.KE,D.Nt,h.Fj,h.Q7,h.JJ,h.On,b.TO,A.gD,U.ey],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}\n/*# sourceMappingURL=catering-config-modal.component.ts-angular-inline--80.css.map*/"]}),g})()},5730:(j,L,n)=>{n.d(L,{m:()=>x});var e=n(3184),t=n(3294),C=n(2962),_=n(6362),i=n(7317),I=n(5758),b=n(5306),D=n(4742);function h(E,v){1&E&&(e.TgZ(0,"button",4)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function A(E,v){if(1&E){const m=e.EpF();e.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),e._uU(3,"upload"),e.qZA(),e.TgZ(4,"p"),e._uU(5,"Click to select file or Drag and drop files"),e.qZA(),e.TgZ(6,"input",7),e.NdJ("change",function(g){return e.CHM(m),e.oxw().handleFileEvent(g)}),e.qZA()(),e.TgZ(7,"div",8)(8,"button",9),e.NdJ("click",function(){return e.CHM(m),e.oxw().downloadTemplate()}),e._uU(9," Download Template "),e.qZA()()()}}function U(E,v){if(1&E&&(e.TgZ(0,"main",10),e._UZ(1,"mat-spinner",11),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&E){const m=e.oxw();e.xp6(3),e.Oqu(m.loading)}}let x=(()=>{class E{constructor(){this.event=new e.vpe}handleFileEvent(m){this.loading="Processing menu data...";const p=m.target;if(!(null==p?void 0:p.files))return this.loading="";const g=p.files;if(!g.length)return this.loading="";const r=g[0],c=new FileReader;c.addEventListener("loadend",o=>{const l=(0,t.n5)(o.target.result);this.loading="",this.event.emit({reason:"done",metadata:l.filter(d=>"item"===(d.type||"").toLowerCase()).map(d=>new C.U(Object.assign(Object.assign({},d),{options:l.filter(f=>"option"===(f.type||"").toLowerCase()&&f.tags===d.id).map(f=>({id:f.id,name:f.name,group:f.category,multiple:f.multiple,unit_price:f.unit_price}))})))})}),c.readAsText(r)}downloadTemplate(){(0,t.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return E.\u0275fac=function(m){return new(m||E)},E.\u0275cmp=e.Xpm({type:E,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["mat-button","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(m,p){if(1&m&&(e.TgZ(0,"header",0)(1,"h2"),e._uU(2,"Import Catering Menu"),e.qZA(),e.YNc(3,h,3,0,"button",1),e.qZA(),e.YNc(4,A,10,0,"main",2),e.YNc(5,U,4,1,"ng-template",null,3,e.W1O)),2&m){const g=e.MAs(6);e.xp6(3),e.Q6J("ngIf",!p.loading),e.xp6(1),e.Q6J("ngIf",!p.loading)("ngIfElse",g)}},directives:[_.O5,i.lW,I.ZT,b.o,D.Ou],styles:[""]}),E})()},6336:(j,L,n)=>{n.d(L,{w:()=>G});var e=n(5939),t=n(3184),C=n(587),_=n(5758),i=n(3294),I=n(2962),b=n(6362),D=n(7317),h=n(5306),A=n(4770),U=n(4683),x=n(3188),E=n(1196),v=n(1534),m=n(2793),p=n(4742),g=n(1130);function r(P,W){1&P&&(t.TgZ(0,"button",7)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function c(P,W){if(1&P&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",18),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA()()()),2&P){const O=t.oxw(2);t.xp6(1),t.ekj("error",O.form.controls.name.invalid&&O.form.controls.name.touched)}}function o(P,W){if(1&P&&(t.TgZ(0,"div",15)(1,"label",19),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA()()()),2&P){const O=t.oxw(2),y=t.MAs(9);t.xp6(1),t.ekj("error",O.form.controls.category.invalid&&O.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",y)}}const a=function(){return{class:"material-icons",content:"close"}};function l(P,W){if(1&P){const O=t.EpF();t.TgZ(0,"mat-chip",27),t.NdJ("removed",function(){const $=t.CHM(O).$implicit;return t.oxw(3).removeTag($)}),t._uU(1),t._UZ(2,"app-icon",28),t.qZA()}if(2&P){const O=W.$implicit;t.Q6J("selectable",!0)("removable",!0),t.xp6(1),t.hij(" ",O," "),t.xp6(1),t.Q6J("icon",t.DdM(4,a))}}function d(P,W){if(1&P){const O=t.EpF();t.TgZ(0,"div",15)(1,"label",21),t.SDv(2,22),t.qZA(),t.TgZ(3,"mat-form-field",17)(4,"mat-chip-list",23,24),t.YNc(6,l,3,5,"mat-chip",25),t.TgZ(7,"input",26),t.NdJ("matChipInputTokenEnd",function(Q){return t.CHM(O),t.oxw(2).addTag(Q)}),t.qZA()()()()}if(2&P){const O=t.MAs(5),y=t.oxw(2);t.xp6(1),t.ekj("error",y.form.controls.tags.invalid&&y.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",y.tag_list),t.xp6(1),t.Q6J("matChipInputFor",O)("matChipInputSeparatorKeyCodes",y.separators)("matChipInputAddOnBlur",!0)}}function f(P,W){1&P&&(t.TgZ(0,"div",15)(1,"label",29),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",17),t._UZ(4,"textarea",30),t.qZA()())}function u(P,W){if(1&P&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",31),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA()()()),2&P){const O=t.oxw(2);t.xp6(1),t.ekj("error",O.form.controls.unit_price.invalid&&O.form.controls.unit_price.touched)}}function N(P,W){if(1&P&&(t.TgZ(0,"form",8),t.YNc(1,c,10,2,"div",9),t.YNc(2,o,10,3,"div",9),t.YNc(3,d,8,6,"div",9),t.YNc(4,f,5,0,"div",9),t.YNc(5,u,10,2,"div",9),t.TgZ(6,"div",10)(7,"label",11),t._uU(8,"Accept Points?"),t.qZA(),t.TgZ(9,"mat-checkbox",12),t._uU(10),t.qZA()(),t.TgZ(11,"div",10)(12,"label",13),t._uU(13,"Discount Cap"),t.qZA(),t._UZ(14,"a-counter",14),t.qZA()()),2&P){const O=t.oxw();let y;t.Q6J("formGroup",O.form),t.xp6(1),t.Q6J("ngIf",O.form.controls.name),t.xp6(1),t.Q6J("ngIf",O.form.controls.category),t.xp6(1),t.Q6J("ngIf",O.form.controls.tags),t.xp6(1),t.Q6J("ngIf",O.form.controls.description),t.xp6(1),t.Q6J("ngIf",O.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(y=O.form.get("accept_points"))&&y.value?"No":"Yes"),t.xp6(4),t.Q6J("min",0)("max",100)("step",5)("render_fn",O.renderPercent)}}function T(P,W){if(1&P){const O=t.EpF();t.TgZ(0,"footer",32)(1,"button",33),t.NdJ("click",function(){return t.CHM(O),t.oxw().saveChanges()}),t._uU(2," Save "),t.qZA()()}if(2&P){const O=t.oxw();t.xp6(1),t.Q6J("disabled",!O.form.dirty)}}function w(P,W){1&P&&(t.TgZ(0,"div",34),t._UZ(1,"mat-spinner",35),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA()())}function S(P,W){if(1&P&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&P){const O=W.$implicit;t.Q6J("value",O),t.xp6(1),t.hij(" ",O," ")}}let G=(()=>{class P{constructor(O){this._data=O,this.event=new t.vpe,this.form=new C.cw({name:new C.NI(this.item.name||"",[C.kI.required]),description:new C.NI(this.item.description||""),category:new C.NI(this.item.category||"",[C.kI.required]),unit_price:new C.NI(this.item.unit_price,[C.kI.required]),tags:new C.NI(this.item.tags||[]),accept_points:new C.NI(this.item.accept_points||!1),discount_cap:new C.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[e.K5,e.OC,e.L_]}get item(){return this._data.item||new I.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(O=0){return`${O}%`}addTag(O){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const y=O.input,Q=O.value,$=this.tag_list;(Q||"").trim()&&($.push(Q),this.form.controls.tags.setValue($)),y&&(y.value="")}removeTag(O){if(!this.form||!this.form.controls.tags)return;const y=this.tag_list;this.form.controls.tags.markAsDirty();const Q=y.indexOf(O);Q>=0&&(y.splice(Q,1),this.form.controls.tags.setValue(y))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new I.U(Object.assign(Object.assign(Object.assign({},this.item),{id:this.item.id||`item-${(0,i.Iy)(99999999)}`}),this.form.value))}})}}return P.\u0275fac=function(O){return new(O||P)(t.Y36(_.WI))},P.\u0275cmp=t.Xpm({type:P,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let W,O;return W=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,O=$localize`:@@zoneTagsPlaceholder␟8dc7c13b0c6b8ad9c770bce0ad72e14b4aef8456␟3986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],W,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",O,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(O,y){if(1&O&&(t.TgZ(0,"header")(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,r,3,0,"button",1),t.qZA(),t.YNc(4,N,15,11,"form",2),t.YNc(5,T,3,1,"footer",3),t.YNc(6,w,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,S,2,2,"mat-option",6),t.qZA()),2&O){const Q=t.MAs(7);t.xp6(2),t.hij("",y.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!y.loading),t.xp6(1),t.Q6J("ngIf",y.form&&!y.loading)("ngIfElse",Q),t.xp6(1),t.Q6J("ngIf",!y.loading),t.xp6(5),t.Q6J("ngForOf",y.categories)}},directives:[_.uh,b.O5,D.lW,_.ZT,h.o,C._Y,C.JL,C.sg,A.KE,U.Nt,C.Fj,C.JJ,C.u,A.TO,x.ZL,E.qn,b.sg,E.HS,E.qH,E.oH,C.wV,v.oG,m.R,p.Ou,x.XC,g.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--81.css.map*/"]}),P})()},8644:(j,L,n)=>{n.d(L,{V:()=>U});var e=n(729),t=n(3184),C=n(6362),_=n(7317),i=n(2796),I=n(5306);const b=["catering-menu-item",""];function D(x,E){if(1&x){const v=t.EpF();t.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"div"),t._uU(4),t.qZA(),t.TgZ(5,"div",8),t._uU(6),t.qZA()(),t.TgZ(7,"div",9),t._uU(8),t.ALo(9,"currency"),t.ALo(10,"async"),t.qZA()(),t.TgZ(11,"button",10)(12,"app-icon"),t._uU(13,"more_vert"),t.qZA()(),t.TgZ(14,"button",11),t.NdJ("click",function(){t.CHM(v);const p=t.oxw();return p.show_options=!p.show_options}),t.TgZ(15,"app-icon"),t._uU(16,"expand_more"),t.qZA()()()}if(2&x){const v=t.oxw(),m=t.MAs(3);t.xp6(4),t.Oqu(v.item.name),t.xp6(2),t.hij(" ",v.item.category," "),t.xp6(2),t.hij(" ",t.xi3(9,5,v.item.unit_price/100,t.lcZ(10,8,v.symbol))," "),t.xp6(3),t.Q6J("matMenuTriggerFor",m),t.xp6(3),t.Q6J("disabled",!v.item.options.length)}}function h(x,E){if(1&x){const v=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"div",16),t._uU(3),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.qZA()(),t.TgZ(6,"button",17),t.NdJ("click",function(){const g=t.CHM(v).$implicit;return t.oxw(2).editOption(g)}),t.TgZ(7,"app-icon"),t._uU(8,"edit"),t.qZA()(),t.TgZ(9,"button",18),t.NdJ("click",function(){const g=t.CHM(v).$implicit;return t.oxw(2).removeOption(g)}),t.TgZ(10,"app-icon"),t._uU(11,"delete"),t.qZA()()()}if(2&x){const v=E.$implicit;t.xp6(3),t.Oqu(v.name),t.xp6(2),t.Oqu(v.group)}}function A(x,E){if(1&x&&(t.TgZ(0,"div",12),t.YNc(1,h,12,2,"div",13),t.qZA()),2&x){const v=t.oxw();t.Udp("height",v.show_options?3.5*v.item.options.length+"rem":"0"),t.xp6(1),t.Q6J("ngForOf",v.item.options)}}let U=(()=>{class x{constructor(v){this._catering=v,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=m=>this._catering.addOption(this.item,m),this.removeOption=m=>this._catering.deleteOption(this.item,m),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}get symbol(){return this._catering.currency}}return x.\u0275fac=function(v){return new(v||x)(t.Y36(e.j))},x.\u0275cmp=t.Xpm({type:x,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:b,decls:19,vars:2,consts:[["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-gray-100 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","text-dark-fade"],[1,"p-2","m-2","text-xs","font-bold","text-white","rounded","bg-primary"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-icon-button","",3,"disabled","click"],["options","",1,"bg-gray-100","overflow-hidden"],["class","flex p-2 items-center border-none border-t border-solid border-gray-300",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-none","border-t","border-solid","border-gray-300"],[1,"flex-1","px-2"],[1,"text"],["edit","","mat-icon-button","",1,"mx-2",3,"click"],["remove","","mat-icon-button","",1,"mx-2",3,"click"]],template:function(v,m){1&v&&(t.YNc(0,D,17,10,"div",0),t.YNc(1,A,2,3,"div",1),t.TgZ(2,"mat-menu",null,2)(4,"button",3),t.NdJ("click",function(){return m.addOption()}),t.TgZ(5,"app-icon"),t._uU(6,"add"),t.qZA(),t.TgZ(7,"div",4),t._uU(8,"Add Option"),t.qZA()(),t.TgZ(9,"button",3),t.NdJ("click",function(){return m.editItem()}),t.TgZ(10,"app-icon"),t._uU(11,"edit"),t.qZA(),t.TgZ(12,"div",4),t._uU(13,"Edit Item"),t.qZA()(),t.TgZ(14,"button",3),t.NdJ("click",function(){return m.removeItem()}),t.TgZ(15,"app-icon"),t._uU(16,"delete"),t.qZA(),t.TgZ(17,"div",4),t._uU(18,"Remove Item"),t.qZA()()()),2&v&&(t.Q6J("ngIf",m.item),t.xp6(1),t.Q6J("ngIf",m.item))},directives:[C.O5,_.lW,i.p6,I.o,C.sg,i.VK,i.OP],pipes:[C.H9,C.Ov],styles:["[_nghost-%COMP%]{background-color:#fff;border:1px solid #ccc;border-radius:.25rem;overflow:hidden;width:768px;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=catering-menu-item.component.ts-angular-inline--85.css.map*/"]}),x})()},8501:(j,L,n)=>{n.d(L,{B:()=>v});var e=n(4505),t=n(6942),C=n(729),_=n(3184),i=n(2379),I=n(6362),b=n(8644),D=n(5306);function h(m,p){if(1&m&&(_.ynx(0),_._UZ(1,"div",6),_.BQk()),2&m){const g=p.$implicit;_.xp6(1),_.Q6J("item",g)}}function A(m,p){if(1&m&&(_.ynx(0),_.YNc(1,h,2,1,"ng-container",5),_.ALo(2,"async"),_.BQk()),2&m){const g=_.oxw();_.xp6(1),_.Q6J("ngForOf",_.lcZ(2,1,g.menu))}}function U(m,p){if(1&m&&(_.ynx(0),_._UZ(1,"div",6),_.BQk()),2&m){const g=p.$implicit;_.xp6(1),_.Q6J("item",g)}}function x(m,p){if(1&m&&(_.TgZ(0,"mat-tab",7),_.YNc(1,U,2,1,"ng-container",5),_.ALo(2,"async"),_.qZA()),2&m){const g=p.$implicit,r=_.oxw();_.Q6J("label",g),_.xp6(1),_.Q6J("ngForOf",_.lcZ(2,2,r.tab_menu)[g])}}function E(m,p){1&m&&(_.TgZ(0,"div",8)(1,"app-icon"),_._uU(2,"close"),_.qZA(),_.TgZ(3,"p"),_._uU(4,"No items in menu"),_.qZA()())}let v=(()=>{class m{constructor(g){this._catering=g,this.menu=this._catering.menu,this.shown_tab=new e.X(""),this.tab_menu=this.menu.pipe((0,t.U)(r=>{const c={};for(const o of this.categories)c[o]=r.filter(a=>a.category===o);return c}))}get categories(){return this._catering.categories}}return m.\u0275fac=function(g){return new(g||m)(_.Y36(C.j))},m.\u0275cmp=_.Xpm({type:m,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(g,r){if(1&g&&(_.TgZ(0,"mat-tab-group",0),_.NdJ("selectedIndexChange",function(o){return r.shown_tab.next(0===o?"":r.categories[o-1])}),_.TgZ(1,"mat-tab",1),_.YNc(2,A,3,3,"ng-container",2),_.ALo(3,"async"),_.qZA(),_.YNc(4,x,3,4,"mat-tab",3),_.qZA(),_.YNc(5,E,5,0,"ng-template",null,4,_.W1O)),2&g){const c=_.MAs(6);let o;_.xp6(2),_.Q6J("ngIf",null==(o=_.lcZ(3,3,r.menu))?null:o.length)("ngIfElse",c),_.xp6(2),_.Q6J("ngForOf",r.categories)}},directives:[i.SP,i.uX,I.O5,I.sg,b.V,D.o],pipes:[I.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--86.css.map*/"]}),m})()},7413:(j,L,n)=>{n.d(L,{M:()=>f});var e=n(3184),t=n(587),C=n(5758),_=n(3245),i=n(2962),I=n(6362),b=n(7317),D=n(5306),h=n(4770),A=n(4683),U=n(3188),x=n(1534),E=n(4742),v=n(1130);function m(u,N){1&u&&(e.TgZ(0,"button",7)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function p(u,N){if(1&u&&(e.TgZ(0,"div",10)(1,"label",11),e._uU(2," Name"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",12),e._UZ(7,"input",13),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()()),2&u){const T=e.oxw(2);e.xp6(1),e.ekj("error",T.form.controls.name.invalid&&T.form.controls.name.touched)}}function g(u,N){if(1&u&&(e.TgZ(0,"div",10)(1,"label",14),e._uU(2," Type"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",12),e._UZ(7,"input",15),e.TgZ(8,"mat-error"),e._uU(9,"Type is required"),e.qZA()()()),2&u){const T=e.oxw(2),w=e.MAs(9);e.xp6(1),e.ekj("error",T.form.controls.group.invalid&&T.form.controls.group.touched),e.xp6(6),e.Q6J("matAutocomplete",w)}}function r(u,N){1&u&&(e.TgZ(0,"div",10)(1,"label",11),e._uU(2,"Unit Price:"),e.qZA(),e.TgZ(3,"mat-form-field",12),e._UZ(4,"input",16),e.qZA()())}function c(u,N){1&u&&(e.TgZ(0,"div",10)(1,"mat-checkbox",17),e._uU(2," Can select multiple of type "),e.qZA()())}function o(u,N){if(1&u&&(e.TgZ(0,"form",8),e.YNc(1,p,10,2,"div",9),e.YNc(2,g,10,3,"div",9),e.YNc(3,r,5,0,"div",9),e.YNc(4,c,3,0,"div",9),e.qZA()),2&u){const T=e.oxw();e.Q6J("formGroup",T.form),e.xp6(1),e.Q6J("ngIf",T.form.controls.name),e.xp6(1),e.Q6J("ngIf",T.form.controls.group),e.xp6(1),e.Q6J("ngIf",T.form.controls.unit_price),e.xp6(1),e.Q6J("ngIf",T.form.controls.multiple)}}function a(u,N){if(1&u){const T=e.EpF();e.TgZ(0,"footer",18)(1,"button",19),e.NdJ("click",function(){return e.CHM(T),e.oxw().saveChanges()}),e._uU(2," Save "),e.qZA()()}if(2&u){const T=e.oxw();e.xp6(1),e.Q6J("disabled",!T.form.dirty)}}function l(u,N){1&u&&(e.TgZ(0,"div",20),e._UZ(1,"mat-spinner",21),e.TgZ(2,"p"),e._uU(3,"Saving catering item option..."),e.qZA()())}function d(u,N){if(1&u&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&u){const T=N.$implicit;e.Q6J("value",T),e.xp6(1),e.hij(" ",T," ")}}let f=(()=>{class u{constructor(T){this._data=T,this.event=new e.vpe,this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}ngOnInit(){this.form=new t.cw({name:new t.NI(this.option.name||"",[t.kI.required]),group:new t.NI(this.option.group||"",[t.kI.required]),unit_price:new t.NI(this.option.unit_price),multiple:new t.NI(!!this.option.multiple,[])})}saveChanges(){this.loading=!0;const T=Object.assign(Object.assign(Object.assign({},this.option),{id:this.option.id||`option-${(0,_.Iy)(99999999)}`}),this.form.value);this.event.emit({reason:"done",metadata:{item:new i.U(Object.assign(Object.assign({},this._data.parent),{options:this._data.parent.options.filter(w=>w.id!==T.id).concat([T])}))}})}}return u.\u0275fac=function(T){return new(T||u)(e.Y36(C.WI))},u.\u0275cmp=e.Xpm({type:u,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-none border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(T,w){if(1&T&&(e.TgZ(0,"header")(1,"h3",0),e._uU(2),e.qZA(),e.YNc(3,m,3,0,"button",1),e.qZA(),e.YNc(4,o,5,5,"form",2),e.YNc(5,a,3,1,"footer",3),e.YNc(6,l,4,0,"ng-template",null,4,e.W1O),e.TgZ(8,"mat-autocomplete",null,5),e.YNc(10,d,2,2,"mat-option",6),e.qZA()),2&T){const S=e.MAs(7);e.xp6(2),e.hij(" ",w.option.id?"Edit":"Add"," Item Option "),e.xp6(1),e.Q6J("ngIf",!w.loading),e.xp6(1),e.Q6J("ngIf",w.form&&!w.loading)("ngIfElse",S),e.xp6(1),e.Q6J("ngIf",!w.loading),e.xp6(5),e.Q6J("ngForOf",w.types)}},directives:[C.uh,I.O5,b.lW,C.ZT,D.o,t._Y,t.JL,t.sg,h.KE,A.Nt,t.Fj,t.JJ,t.u,h.TO,U.ZL,t.wV,x.oG,E.Ou,U.XC,I.sg,v.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-option-modal.component.ts-angular-inline--82.css.map*/"]}),u})()},4204:(j,L,n)=>{n.d(L,{m:()=>i});var e=n(3184),t=n(7317),C=n(5306);const _=["catering-order-item",""];let i=(()=>{class I{constructor(){this.active=!1}}return I.\u0275fac=function(D){return new(D||I)},I.\u0275cmp=e.Xpm({type:I,selectors:[["","catering-order-item",""]],inputs:{item:"item"},attrs:_,decls:8,vars:8,consts:[[1,"w-20","text-right"],["name","item-bar",1,"bg-gray-300"],[1,"w-12","mr-4"],["mat-icon-button","",1,"border","border-gray-300","border-dashed","text-2xl","text-dark-fade"],[1,"flex-1","border-b","border-gray-300","border-solid","py-4"]],template:function(D,h){1&D&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.qZA(),e.TgZ(2,"div",2)(3,"button",3)(4,"app-icon"),e._uU(5),e.qZA()()(),e.TgZ(6,"div",4),e._uU(7),e.qZA()),2&D&&(e.xp6(3),e.ekj("bg-success",h.active)("text-white",h.active)("border-solid",h.active),e.xp6(2),e.Oqu(h.active?"done":"local_pizza"),e.xp6(2),e.hij(" ",null==h.item?null:h.item.name," "))},directives:[t.lW,C.o],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}[name=item-bar][_ngcontent-%COMP%]{height:2px;margin-left:auto;margin-right:1rem;width:calc(50% - .9375rem)}\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--87.css.map*/"]}),I})()},2189:(j,L,n)=>{n.d(L,{I:()=>D});var e=n(2851),t=n(3184),C=n(6362),_=n(961);function i(h,A){if(1&h&&(t.TgZ(0,"li",12),t._UZ(1,"catering-order",13),t.qZA()),2&h){const U=A.$implicit;t.xp6(1),t.Q6J("order",U)}}function I(h,A){1&h&&(t.TgZ(0,"div",14)(1,"p"),t._uU(2,"No Catering Orders"),t.qZA()())}function b(h,A){1&h&&t._UZ(0,"mat-progress-bar",15)}let D=(()=>{class h{constructor(U){this._orders=U,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(U,x){return x?x.id:void 0}}return h.\u0275fac=function(U){return new(U||h)(t.Y36(e.I))},h.\u0275cmp=t.Xpm({type:h,selectors:[["catering-order-list"]],decls:22,vars:10,consts:[[1,"w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-gray-300","bg-white"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-gray-300",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block text-dark-fade",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-gray-300"],[3,"order"],["empty","",1,"info-block","text-dark-fade"],["mode","indeterminate",1,"w-full"]],template:function(U,x){if(1&U&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Time"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Location"),t.qZA(),t.TgZ(6,"div",4),t._uU(7,"Host"),t.qZA(),t.TgZ(8,"div",2),t._uU(9,"Charge Code"),t.qZA(),t.TgZ(10,"div",5),t._uU(11,"Invoice No."),t.qZA(),t.TgZ(12,"div",6),t._uU(13,"Status"),t.qZA(),t._UZ(14,"div",7),t.qZA(),t.TgZ(15,"ul",8),t.YNc(16,i,2,1,"li",9),t.ALo(17,"async"),t.YNc(18,I,3,0,"div",10),t.ALo(19,"async"),t.qZA(),t.YNc(20,b,1,0,"mat-progress-bar",11),t.ALo(21,"async")),2&U){let E;t.xp6(16),t.Q6J("ngForOf",t.lcZ(17,4,x.order_list))("ngForTrackBy",x.trackByFn),t.xp6(2),t.Q6J("ngIf",!(null!=(E=t.lcZ(19,6,x.order_list))&&E.length)),t.xp6(2),t.Q6J("ngIf",t.lcZ(21,8,x.loading))}},directives:[C.sg,_.p,C.O5],pipes:[C.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--88.css.map*/"]}),h})()},9504:(j,L,n)=>{n.d(L,{W:()=>$});var e=n(4929),t=n(3184),C=n(5758),_=n(1233),i=n(6119),I=n(475),b=n(3294),D=n(8025),h=n(2962),A=n(5163),U=n(6362),x=n(2379),E=n(2793),v=n(587),m=n(89),p=n(7317),g=n(5306),r=n(4742);function c(M,J){1&M&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function o(M,J){if(1&M){const s=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(B){t.CHM(s);const K=t.oxw().$implicit;return t.oxw(5).updateItemQuantity(K,B)}),t.qZA()}if(2&M){const s=t.oxw().$implicit;t.Q6J("ngModel",s.quantity)}}function a(M,J){if(1&M){const s=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),t._uU(4,"remove"),t.qZA()()(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(s);const B=t.oxw().$implicit;return t.oxw(5).addItem(B)}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA()()()}if(2&M){const s=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",s.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",s.quantity," ")}}function l(M,J){if(1&M&&(t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,c,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,o,1,1,"a-counter",15),t.YNc(9,a,10,3,"div",16),t.qZA()),2&M){const s=J.$implicit;t.xp6(3),t.hij(" ",s.name," "),t.xp6(1),t.Q6J("ngIf",s.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,5,s.unit_price/100)," "),t.xp6(2),t.Q6J("ngIf",!s.options.length),t.xp6(1),t.Q6J("ngIf",s.options.length)}}const d=function(){return{}};function f(M,J){if(1&M&&(t.TgZ(0,"mat-tab",8)(1,"div",9),t.YNc(2,l,10,7,"div",10),t.qZA()()),2&M){const s=t.oxw().$implicit,Z=t.oxw(3);t.Q6J("label",s),t.xp6(2),t.Q6J("ngForOf",(Z.menu_items||t.DdM(2,d))[s])}}function u(M,J){if(1&M&&(t.ynx(0),t.YNc(1,f,3,3,"mat-tab",7),t.BQk()),2&M){const s=J.$implicit,Z=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(Z.menu_items||t.DdM(1,d))[s].length)}}function N(M,J){if(1&M&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,u,2,2,"ng-container",6),t.qZA(),t.BQk()),2&M){const s=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",s.categories)}}function T(M,J){if(1&M&&(t.TgZ(0,"div",4),t.YNc(1,N,3,1,"ng-container",5),t.qZA()),2&M){const s=t.oxw(),Z=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!s.show_order_details)("ngIfElse",Z)}}function w(M,J){if(1&M){const s=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){return t.CHM(s),t.oxw(2).show_order_details=!0}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&M){const s=t.oxw(2);t.xp6(3),t.Q6J("disabled",!s.order.item_count)("matBadge",s.order.item_count)("matBadgeHidden",!s.order.item_count)}}function S(M,J){if(1&M){const s=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){return t.CHM(s),t.oxw(2).show_order_details=!1}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){return t.CHM(s),t.oxw(2).saveOrder()}),t._uU(3," Save Order "),t.qZA()}}function G(M,J){if(1&M&&(t.TgZ(0,"footer",24),t.YNc(1,w,5,3,"ng-container",5),t.YNc(2,S,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&M){const s=t.MAs(3),Z=t.oxw();t.xp6(1),t.Q6J("ngIf",!Z.show_order_details)("ngIfElse",s)}}function P(M,J){if(1&M&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&M){const s=t.oxw();t.xp6(3),t.Oqu(s.loading)}}function W(M,J){if(1&M&&(t.TgZ(0,"div",37),t._uU(1),t.qZA()),2&M){const s=t.oxw().$implicit,Z=t.oxw(2);t.Q6J("matTooltip",Z.optionsFor(s)),t.xp6(1),t.AsE(" ",s.options.length," option",1===s.options.length?"":"s"," selected ")}}function O(M,J){if(1&M){const s=t.EpF();t.TgZ(0,"div",34)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,W,2,3,"div",35),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",36),t.NdJ("ngModelChange",function(B){const R=t.CHM(s).$implicit;return t.oxw(2).updateItemQuantity(R,B)}),t.qZA()()}if(2&M){const s=J.$implicit;t.xp6(3),t.Oqu(s.name),t.xp6(1),t.Q6J("ngIf",s.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,4,s.total_cost/100)," "),t.xp6(2),t.Q6J("ngModel",s.quantity)}}function y(M,J){if(1&M&&(t.TgZ(0,"header",32)(1,"h3"),t._uU(2,"Confirm Order"),t.qZA()(),t.TgZ(3,"div",9),t.YNc(4,O,9,6,"div",33),t.qZA()),2&M){const s=t.oxw();t.xp6(4),t.Q6J("ngForOf",s.order.items)}}function Q(M,J,s){var Z;let B=!0;for(const K of J)if(M.category===K.name||M.tags.includes(K.name)||(null===(Z=s.space)||void 0===Z?void 0:Z.zones.includes(K.name))||"*"===K.name){let R=0;for(const F of K.rules){const Y=new Date(s.date);switch(F[0]){case"after_hour":R+=(0,_.Z)(Y,(0,i.Z)(Y,F[1]))?1:0;break;case"before_hour":R+=(0,I.Z)(Y,(0,i.Z)(Y,F[1]))?1:0;break;case"min_length":R+=s.duration>=(0,D.H1)(F[1])?1:0;break;case"max_length":R+=s.duration<=(0,D.H1)(F[1])?1:0;break;case"visitor_type":R+=s.ext("visitor_type")===F[1]?1:0;break;default:R++}}B=R>=K.rules.length}return B}let $=(()=>{class M extends b.KG{constructor(s){super(),this._data=s,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var s,Z,B;return(0,e.mG)(this,void 0,void 0,function*(){this.loading="Loading menu...",this.order=new A.G(this._data.order),this.rules=yield this._data.getCateringConfig(null===(B=null===(Z=null===(s=this.order.event)||void 0===s?void 0:s.space)||void 0===Z?void 0:Z.level)||void 0===B?void 0:B.parent_id),this._data.menu.subscribe(K=>{this.loading="Loading menu...";const R=(0,b.Tw)(K.map(Y=>Y.category)),F={};for(const Y of R)F[Y]=K.filter(H=>H.category===Y&&Q(H,this.rules,this.order.event));this.categories=R,this.menu_items=F,this.updateMenuQuantities(),this.timeout("clear_loading",()=>this.loading="",1e3)})})}addItem(s,Z=!0){var B;const K=this.order.items.find(R=>R.id===s.id&&R.options.length===R.options.reduce((F,Y)=>F+(s.options.find(H=>Y.id===H.id)?1:0),0));Z&&(null===(B=s.options)||void 0===B?void 0:B.length)?this._data.selectOptions(s.options).then(R=>{const F=new h.U(Object.assign(Object.assign({},s),{options:R}));this.addItem(F,!1)}):this.order=new A.G(Object.assign(Object.assign({},this.order),K?{items:this.order.items.filter(R=>!(R.id===s.id&&R.options_string===s.options_string)).concat([new h.U(Object.assign(Object.assign({},s),{quantity:K.quantity+1}))])}:{items:this.order.items.concat([new h.U(Object.assign(Object.assign({},s),{quantity:1}))])})),this.updateMenuQuantities()}removeItem(s){this.order=new A.G(Object.assign(Object.assign({},this.order),{items:this.order.items.filter(Z=>Z.id!==s.id&&Z.options_string===s.options_string)})),this.updateMenuQuantities()}updateItemQuantity(s,Z){const B=this.order.items.find(R=>R.id===s.id&&R.options_string===s.options_string);let K=[...this.order.items];K=B?this.order.items.filter(R=>!(R.id===s.id&&R.options_string===s.options_string)).concat([new h.U(Object.assign(Object.assign({},s),{quantity:Z}))]):this.order.items.concat([new h.U(Object.assign(Object.assign({},s),{quantity:Z}))]),K.sort((R,F)=>R.name.localeCompare(F.name)),this.order=new A.G(Object.assign(Object.assign({},this.order),{items:K})),this.updateMenuQuantities()}updateMenuQuantities(){for(const s in this.menu_items)for(const Z of this.menu_items[s])Z.quantity=this.order.items.reduce((B,K)=>K.id===Z.id?B+K.quantity:B,0)}optionsFor(s){return s.options.map(Z=>Z.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return M.\u0275fac=function(s){return new(s||M)(t.Y36(C.WI))},M.\u0275cmp=t.Xpm({type:M,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(s,Z){if(1&s&&(t.YNc(0,T,2,2,"div",0),t.YNc(1,G,4,2,"footer",1),t.YNc(2,P,4,1,"ng-template",null,2,t.W1O),t.YNc(4,y,5,1,"ng-template",null,3,t.W1O)),2&s){const B=t.MAs(3);t.Q6J("ngIf",!Z.loading)("ngIfElse",B),t.xp6(1),t.Q6J("ngIf",!Z.loading)}},directives:[U.O5,x.SP,U.sg,x.uX,E.R,v.Fj,v.JJ,v.On,m.gM,p.lW,g.o,C.ZT,r.Ou],pipes:[U.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--83.css.map*/"]}),M})()},3129:(j,L,n)=>{n.d(L,{R:()=>g});var e=n(3184),t=n(5758),C=n(3245),_=n(7317),i=n(5306),I=n(6362),b=n(8390),D=n(587),h=n(1534);function A(r,c){if(1&r&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&r){const o=e.oxw().$implicit;e.xp6(1),e.hij(" +",e.lcZ(2,1,o.unit_price/100)," ")}}function U(r,c){if(1&r&&(e.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,A,3,3,"div",17),e.qZA()()),2&r){const o=c.$implicit;e.Q6J("value",o.id),e.xp6(3),e.hij(" ",o.name," "),e.xp6(1),e.Q6J("ngIf",o.unit_price)}}function x(r,c){if(1&r){const o=e.EpF();e.ynx(0),e.TgZ(1,"mat-radio-group",10),e.NdJ("ngModelChange",function(l){e.CHM(o);const d=e.oxw().$implicit;return e.oxw().updateGroupOption(d,l)}),e.TgZ(2,"mat-radio-button",11)(3,"span",12),e._uU(4,"None"),e.qZA()(),e.YNc(5,U,5,3,"mat-radio-button",13),e.qZA(),e.BQk()}if(2&r){const o=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",null==o?null:o.options)}}function E(r,c){if(1&r&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&r){const o=e.oxw().$implicit;e.xp6(1),e.hij(" +",e.lcZ(2,1,o.unit_price/100)," ")}}function v(r,c){if(1&r){const o=e.EpF();e.TgZ(0,"mat-checkbox",20),e.NdJ("ngModelChange",function(l){const f=e.CHM(o).$implicit;return e.oxw(3).option_state[f.id]=l}),e.TgZ(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,E,3,3,"div",17),e.qZA()()}if(2&r){const o=c.$implicit,a=e.oxw(3);e.Q6J("ngModel",a.option_state[o.id]),e.xp6(3),e.hij(" ",o.name," "),e.xp6(1),e.Q6J("ngIf",o.unit_price)}}function m(r,c){if(1&r&&e.YNc(0,v,5,3,"mat-checkbox",19),2&r){const o=e.oxw().$implicit;e.Q6J("ngForOf",null==o?null:o.options)}}function p(r,c){if(1&r&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.qZA(),e.TgZ(3,"div",7),e.YNc(4,x,6,1,"ng-container",8),e.YNc(5,m,1,1,"ng-template",null,9,e.W1O),e.qZA()()),2&r){const o=c.$implicit,a=e.MAs(6);e.uIk("group",o.name),e.xp6(2),e.Oqu(o.name),e.xp6(2),e.Q6J("ngIf",!o.multiple)("ngIfElse",a)}}let g=(()=>{class r{constructor(o){this._data=o,this.event=new e.vpe,this.option_state={};const a=(0,C.Tw)(this._data.options.map(d=>d.group||"Other")),l=[];for(const d of a){const f=this._data.options.filter(u=>u.group===d);l.push({name:d,multiple:!!f.find(u=>u.multiple),options:f})}this.groups=l}updateGroupOption(o,a){for(const l of o.options)this.option_state[l.id]=l.id===a}saveOptions(){const o=this._data.options.filter(a=>this.option_state[a.id]);this.event.emit({reason:"done",metadata:{options:o}})}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(t.WI))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(o,a){1&o&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Select options"),e.qZA(),e.TgZ(3,"button",0)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.TgZ(6,"main",1),e.YNc(7,p,7,4,"div",2),e.qZA(),e.TgZ(8,"footer",3)(9,"button",4),e.NdJ("click",function(){return a.saveOptions()}),e._uU(10," Save "),e.qZA()()),2&o&&(e.xp6(7),e.Q6J("ngForOf",a.groups))},directives:[_.lW,t.ZT,i.o,I.sg,I.O5,b.VQ,D.JJ,D.On,b.U0,h.oG],pipes:[I.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--84.css.map*/"]}),r})()},961:(j,L,n)=>{n.d(L,{p:()=>m});var e=n(3294),t=n(2851),_=(n(5163),n(2460)),i=n(3184),I=n(6362),b=n(5306),D=n(2796),h=n(7317),A=n(4204);function U(p,g){if(1&p){const r=i.EpF();i.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),i._uU(4,"room_service"),i.qZA()()(),i.TgZ(5,"div",7),i._uU(6),i.ALo(7,"date"),i.qZA(),i.TgZ(8,"div",8),i._uU(9),i.qZA(),i.TgZ(10,"div",9),i._uU(11),i.qZA(),i.TgZ(12,"div",7),i._uU(13),i.qZA(),i.TgZ(14,"div",10),i._uU(15),i.qZA(),i.TgZ(16,"div",11)(17,"button",12)(18,"div",13),i._uU(19),i.qZA(),i.TgZ(20,"app-icon",14),i._uU(21,"arrow_drop_down"),i.qZA()()(),i.TgZ(22,"div",15)(23,"button",16),i.NdJ("click",function(){i.CHM(r);const o=i.oxw();return o.show_items=!o.show_items}),i.TgZ(24,"app-icon"),i._uU(25),i.qZA()()()()}if(2&p){const r=i.oxw(),c=i.MAs(3);i.ekj("shown",r.show_items),i.xp6(6),i.Oqu(i.xi3(7,12,r.order.deliver_at,"shortTime")),i.xp6(3),i.hij(" ",(null==r.order.event?null:r.order.event.space.display_name)||(null==r.order.event?null:r.order.event.space.name)||"~ No Location ~"," "),i.xp6(2),i.hij(" ",(null==r.order.event||null==r.order.event.organiser?null:r.order.event.organiser.name)||(null==r.order.event?null:r.order.event.host)||"~ Unknown Host ~"," "),i.xp6(2),i.Oqu(r.order.charge_code||"~ No Code ~"),i.xp6(2),i.hij(" ",r.order.invoice_number||"~ No Invoice ~"," "),i.xp6(2),i.Udp("background",null==r.status?null:r.status.colour),i.Q6J("matMenuTriggerFor",c),i.xp6(2),i.hij(" ",null==r.status?null:r.status.name," "),i.xp6(6),i.Oqu(r.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function x(p,g){1&p&&i._UZ(0,"li",20),2&p&&i.Q6J("item",g.$implicit)}function E(p,g){if(1&p&&(i.TgZ(0,"ul",17),i._UZ(1,"div",18),i.YNc(2,x,1,1,"li",19),i.qZA()),2&p){const r=i.oxw();i.ekj("shown",r.show_items),i.Q6J("@show",r.show_items?"show":"hide"),i.xp6(1),i.Udp("height",3.125*r.order.items.length-1+"rem"),i.xp6(1),i.Q6J("ngForOf",r.order.items)}}function v(p,g){if(1&p){const r=i.EpF();i.TgZ(0,"button",21),i.NdJ("click",function(){const a=i.CHM(r).$implicit;return i.oxw().updateStatus(a.id)}),i._UZ(1,"div",22),i.TgZ(2,"span",23),i._uU(3),i.qZA()()}if(2&p){const r=g.$implicit;i.xp6(1),i.Udp("background-color",r.colour),i.xp6(2),i.Oqu(r.name)}}let m=(()=>{class p{constructor(r){this._orders=r,this.show_items=!1,this.statuses=_.U,this.updateStatus=c=>this._orders.updateStatus(this.order,c)}get status(){return this.statuses.find(r=>r.id===this.order.status)}}return p.\u0275fac=function(r){return new(r||p)(i.Y36(t.I))},p.\u0275cmp=i.Xpm({type:p,selectors:[["catering-order"]],inputs:{order:"order"},decls:5,vars:3,consts:[["class","w-full flex items-center py-2 bg-gray-100",3,"shown",4,"ngIf"],["class","list-none p-0 m-0 w-full relative",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2","bg-gray-100"],[1,"w-20","flex","items-center","justify-center"],[1,"rounded-full","bg-gray-300","p-2","text-2xl","text-dark-fade","flex","items-center","justify-center"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["mat-icon-button","",3,"click"],[1,"list-none","p-0","m-0","w-full","relative"],["name","bar",1,"absolute","top-0","bg-gray-300"],["catering-order-item","","class","flex items-center",3,"item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(r,c){1&r&&(i.YNc(0,U,26,15,"div",0),i.YNc(1,E,3,6,"ul",1),i.TgZ(2,"mat-menu",null,2),i.YNc(4,v,4,3,"button",3),i.qZA()),2&r&&(i.Q6J("ngIf",c.order),i.xp6(1),i.Q6J("ngIf",null==c.order?null:c.order.items.length),i.xp6(3),i.Q6J("ngForOf",c.statuses))},directives:[I.O5,b.o,D.p6,h.lW,I.sg,A.m,D.VK,D.OP],pipes:[I.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}.shown[_ngcontent-%COMP%]{background-color:#eee}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}\n/*# sourceMappingURL=catering-order.component.ts-angular-inline--89.css.map*/"],data:{animation:[e.X7]}}),p})()},2851:(j,L,n)=>{n.d(L,{I:()=>g});var e=n(4505),t=n(7716),C=n(823),_=n(9095),i=n(6942),I=n(8759),b=n(9128),D=n(1810),h=n(9377),A=n(3200),U=n(3294),x=n(4211),E=n(3902),v=n(5163),m=n(3184);let g=(()=>{class r extends U.KG{constructor(){super(),this._poll=new e.X(0),this._loading=new e.X(!1),this._filters=new e.X({}),this.orders=(0,t.aj)([this._filters,this._poll]).pipe((0,C.b)(500),(0,_.w)(([o])=>{this._loading.next(!0);const a=(0,D.Z)((0,h.Z)(o.date||Date.now())),l=(0,D.Z)((0,A.Z)(o.date||Date.now()));return(0,x.u$)({zone_ids:(o.zones||[]).join(","),period_start:a,period_end:l})}),(0,i.U)(o=>(0,U.xH)(o.map(a=>a.ext("catering")))),(0,I.b)(()=>this._loading.next(!1)),(0,b.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,i.U)(o=>o.filter(a=>function p(r,c){const o=(c.search||"").toLowerCase();return!!r.items.find(a=>a.name.toLowerCase().includes(o)||!!a.options.find(l=>l.name.toLowerCase().includes(o)))}(a,this._filters.getValue())))),this.subscription("changes",this.orders.subscribe())}get filters(){return this._filters.getValue()}set filters(o){this._filters.next(o)}startPolling(o=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),o)}stopPolling(){this.clearInterval("polling")}updateStatus(o,a){const l=new v.G(Object.assign(Object.assign({},o),{status:a})),d=new E.y(Object.assign(Object.assign({},o.event),{catering:[...o.event.ext("catering").filter(f=>f.id!==o.id),l].map(f=>new v.G(Object.assign({},f)))}));return(0,x.ry)(d)}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275prov=m.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},729:(j,L,n)=>{n.d(L,{j:()=>g});var e=n(4929),t=n(3499),C=n(4505),_=n(5670),i=n(3294),I=n(3619),b=n(6336),D=n(7413),h=n(2090),A=n(2962),U=n(5163),x=n(9504),E=n(3129),v=n(5730),m=n(3184),p=n(5758);let g=(()=>{class r extends i.KG{constructor(o,a){super(),this._org=o,this._dialog=a,this._menu=new C.X([]),this._loading=new C.X(!1),this._currency=new C.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(l=>(0,e.mG)(this,void 0,void 0,function*(){if(l){const d=(yield this.getCateringForZone(l.id)).map(f=>new A.U(f));this._currency.next(l.currency||"USD"),this._menu.next(d)}})))}get categories(){const o=this._menu.getValue();return(0,i.Tw)(o.map(a=>a.category))}manageCateringOrder(o){var a;return(0,e.mG)(this,void 0,void 0,function*(){const l=this._dialog.open(x.W,{data:{order:o,menu:this.menu,loading:this.loading,getCateringConfig:f=>this.getCateringConfig(f),selectOptions:f=>this.selectOptions(f)}}),d=yield Promise.race([l.componentInstance.event.pipe((0,_.P)(f=>"done"===f.reason)).toPromise(),l.afterClosed().toPromise()]);return l.close(),(null===(a=null==d?void 0:d.metadata)||void 0===a?void 0:a.order)||o})}addItem(o=new A.U){return(0,e.mG)(this,void 0,void 0,function*(){const a=this._dialog.open(b.w,{data:{item:o,categories:this.categories}}),l=yield Promise.race([a.componentInstance.event.pipe((0,_.P)(u=>"done"===u.reason)).toPromise(),a.afterClosed().toPromise()]);if("done"!==(null==l?void 0:l.reason))return;const d=this._menu.getValue(),f=d.findIndex(u=>u.id===o.id);f>=0?d.splice(f,1,l.metadata.item):d.push(l.metadata.item),this.updateMenu(this._org.building.id,d).then(()=>{this._menu.next([...d]),a.close()},()=>a.componentInstance.loading=!1)})}addOption(o,a={}){return(0,e.mG)(this,void 0,void 0,function*(){const l=(0,i.Tw)(o.options.map(T=>T.group)),d=this._dialog.open(D.M,{data:{parent:o,option:a,types:l}}),f=yield Promise.race([d.componentInstance.event.pipe((0,_.P)(T=>"done"===T.reason)).toPromise(),d.afterClosed().toPromise()]);if("done"!==(null==f?void 0:f.reason))return;const u=this._menu.getValue(),N=u.findIndex(T=>T.id===o.id);N>=0?u.splice(N,1,f.metadata.item):u.push(f.metadata.item),this.updateMenu(this._org.building.id,u).then(()=>{this._menu.next([...u]),d.close()},()=>d.componentInstance.loading=!1)})}selectOptions(o){return(0,e.mG)(this,void 0,void 0,function*(){const a=this._dialog.open(E.R,{data:{options:o}}),l=yield Promise.race([a.componentInstance.event.pipe((0,_.P)(d=>"done"===d.reason)).toPromise(),a.afterClosed().toPromise()]);return"done"!==(null==l?void 0:l.reason)?[]:(a.close(),l.metadata.options)})}deleteItem(o){return(0,e.mG)(this,void 0,void 0,function*(){const a=yield(0,i._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${o.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==a.reason)return;a.loading("Removing catering item...");const l=this._menu.getValue().filter(d=>o.id!==d.id);this.updateMenu(this._org.building.id,l).then(()=>{this._menu.next([...l]),a.close()},()=>a.loading(""))})}deleteOption(o,a){return(0,e.mG)(this,void 0,void 0,function*(){const l=yield(0,i._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${a.name}" from "${o.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==l.reason)return;l.loading("Removing catering item option...");const d=this._menu.getValue();d.splice(d.findIndex(f=>f.id===o.id),1,new A.U(Object.assign(Object.assign({},o),{options:o.options.filter(f=>f.id!==a.id)}))),this.updateMenu(this._org.building.id,d).then(()=>{this._menu.next([...d]),l.close()},()=>l.loading(""))})}editConfig(){return(0,e.mG)(this,void 0,void 0,function*(){const o=yield this.getCateringConfig(this._org.building.id),a=this._menu.getValue(),l=(0,i.Tw)((0,i.xH)(a.map(u=>[u.category,...u.tags]))),d=this._dialog.open(h.S,{data:{config:o,types:l}}),f=yield Promise.race([d.componentInstance.event.pipe((0,_.P)(u=>"done"===u.reason)).toPromise(),d.afterClosed().toPromise()]);"done"===(null==f?void 0:f.reason)&&this.updateConfig(this._org.building.id,f.metadata).then(()=>d.close(),()=>d.componentInstance.loading=!1)})}importMenu(){return(0,e.mG)(this,void 0,void 0,function*(){const o=this._dialog.open(v.m),a=yield Promise.race([o.componentInstance.event.pipe((0,_.P)(u=>"done"===u.reason)).toPromise(),o.afterClosed().toPromise()]);if("done"!==(null==a?void 0:a.reason))return;o.componentInstance.loading="Updating menu...";const l=this._menu.getValue(),d=this._org.building,f=(0,i.Tw)(a.metadata.concat(l),"id");yield this.updateMenu(d.id,f).catch(u=>{throw(0,i.cB)("Error importing catering menu"),o.close(),u}),(0,i.t5)(`Successfully imported catering menu. ${a.metadata.length} item(s) added.`),o.close()})}updateMenu(o,a){return(0,t.Ymr)(o,{id:o,name:"catering",details:a,description:`Catering menu for ${o}`}).toPromise()}getCateringForZone(o){return(0,e.mG)(this,void 0,void 0,function*(){const a=(yield(0,t.rlq)(o,"catering").toPromise()).details;return a instanceof Array?a:[]})}getCateringConfig(o=this._org.building.id){return(0,e.mG)(this,void 0,void 0,function*(){const a=(yield(0,t.rlq)(o,"catering_config").toPromise()).details;return a instanceof Array?a:[]})}updateConfig(o,a){return(0,t.Ymr)(o,{id:o,name:"catering_config",details:a,description:`Catering menu config for ${o}`}).toPromise()}addItemToOrder(o,a){let l=o.items;const d=l.find(u=>{var N,T;return u.id===a.id&&(null===(N=a.options)||void 0===N?void 0:N.length)===(null===(T=u.options)||void 0===T?void 0:T.reduce((w,S)=>w+(a.options.find(G=>S.id===G.id)?1:0),0))});return d?d.quantity+=1:l=l.concat([new A.U(Object.assign(Object.assign({},a),{quantity:1}))]),new U.G(Object.assign(Object.assign({},o),{items:l,event:null}))}}return r.\u0275fac=function(o){return new(o||r)(m.LFG(I.w7),m.LFG(p.uw))},r.\u0275prov=m.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},7701:(j,L,n)=>{n.d(L,{g:()=>e});const e=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}]},2460:(j,L,n)=>{n.d(L,{U:()=>e});const e=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map