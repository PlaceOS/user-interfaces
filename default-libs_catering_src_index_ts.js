"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{75566:(Y,N,o)=>{o.d(N,{TI:()=>q.T,QB:()=>tt.Q,_I:()=>M._,sp:()=>J,bR:()=>Z});var e=o(60316),t=o(34456),O=o(79771),n=o(97024),j=o(12587),i=o(31034),G=o(38223),A=o(53804),R=o(80640),L=o(24950),x=o(63046),F=o(25665),W=(o(30807),o(71853),o(48519),o(37053),o(3872),o(41623),o(82912),o(17707),o(98832),o(76095),o(11732),o(32499),o(90699),o(26386),o(61601),o(89204)),m=o(82333),g=o(33602),M=o(52201),a=o(68559),E=o(69434),_=o(85060),c=o(87984),s=o(41134);function d(X,z){if(1&X){const B=a.RV6();a.j41(0,"div",6)(1,"mat-form-field",7)(2,"input",8),a.mxI("ngModelChange",function(S){const w=a.eBV(B).index,Q=a.XpG(2);return a.DH7(Q.charge_codes[w],S)||(Q.charge_codes[w]=S),a.Njj(S)}),a.k0s()(),a.j41(3,"button",9),a.bIt("click",function(){const S=a.eBV(B).index,w=a.XpG(2);return a.Njj(w.removeCode(S))}),a.j41(4,"app-icon"),a.EFF(5,"delete"),a.k0s()()()}if(2&X){const B=z.index,V=a.XpG(2);a.R7$(2),a.R50("ngModel",V.charge_codes[B])}}function K(X,z){if(1&X&&(a.j41(0,"main",4),a.DNE(1,d,6,1,"div",5),a.k0s()),2&X){const B=a.XpG();a.R7$(),a.Y8G("ngForOf",B.charge_codes)("ngForTrackBy",B.trackByFn)}}function $(X,z){if(1&X){const B=a.RV6();a.j41(0,"footer",10)(1,"button",11),a.EFF(2," Import Codes "),a.j41(3,"input",12),a.bIt("change",function(S){a.eBV(B);const w=a.XpG();return a.Njj(w.addCodesFromFile(S))}),a.k0s()(),a.j41(4,"button",13),a.bIt("click",function(){a.eBV(B);const S=a.XpG();return a.Njj(S.newCode())}),a.EFF(5," Add Code "),a.k0s(),a.j41(6,"button",13),a.bIt("click",function(){a.eBV(B);const S=a.XpG();return a.Njj(S.saveChargeCodes())}),a.EFF(7," Save Changes "),a.k0s()()}}function k(X,z){1&X&&(a.j41(0,"main",14),a.nrm(1,"mat-spinner",15),a.j41(2,"p"),a.EFF(3,"Saving changes to charge codes..."),a.k0s()())}let J=(()=>{class X{constructor(B,V){this._state=B,this._dialog_ref=V,this.charge_codes=[],this.loading=!1}ngOnInit(){var B=this;return(0,W.A)(function*(){B.charge_codes=(yield B._state.charge_codes.pipe((0,g.s)(1)).toPromise())||[]})()}newCode(){this.charge_codes.push("")}removeCode(B){this.charge_codes.splice(B,1)}addCodesFromFile(B){if(B.target){const V=B.target.files[0];if(V){const S=new FileReader;S.readAsText(V,"UTF-8"),S.addEventListener("load",w=>{const Q=(0,m.a6)(w.srcElement.result)||[];for(const{code:et}of Q)this.charge_codes.push(et);this.charge_codes=(0,m.Am)(this.charge_codes),B.target.value=""}),S.addEventListener("error",w=>(0,m.UG)("Error reading file."))}}}saveChargeCodes(){var B=this;return(0,W.A)(function*(){B.loading=!0;const V=B.charge_codes.filter(S=>S&&S.trim());yield B._state.saveSettings({charge_codes:V}),B._dialog_ref.close()})()}trackByFn(B,V){return B}static#t=this.\u0275fac=function(V){return new(V||X)(a.rXU(M._),a.rXU(j.CP))};static#e=this.\u0275cmp=a.VBU({type:X,selectors:[["charge-code-list-modal"]],decls:10,vars:3,consts:[["load_state",""],["icon","","mat-dialog-close",""],["class","overflow-auto max-h-[65vh] min-h-[20rem] flex flex-col",4,"ngIf","ngIfElse"],["class","flex items-center p-2 space-x-2 border-t border-base-200",4,"ngIf"],[1,"overflow-auto","max-h-[65vh]","min-h-[20rem]","flex","flex-col"],["class","flex items-center space-x-2 w-full hover:bg-neutral px-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","space-x-2","w-full","hover:bg-neutral","px-2"],["appearance","outline",1,"h-14","flex-1"],["matInput","","placeholder","Charge Code",3,"ngModelChange","ngModel"],["icon","",3,"click"],[1,"flex","items-center","p-2","space-x-2","border-t","border-base-200"],["btn","","matRipple","",1,"w-48","inverse","relative"],["type","file",1,"opacity-0","absolute","inset-0",3,"change"],["btn","","matRipple","",1,"w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-20","space-y-2"],["diameter","32"]],template:function(V,S){if(1&V&&(a.j41(0,"header")(1,"h2"),a.EFF(2,"Edit Charge Codes"),a.k0s(),a.j41(3,"button",1)(4,"app-icon"),a.EFF(5,"close"),a.k0s()()(),a.DNE(6,K,2,2,"main",2)(7,$,8,0,"footer",3)(8,k,4,0,"ng-template",null,0,a.C5r)),2&V){const w=a.sdS(9);a.R7$(6),a.Y8G("ngIf",!S.loading)("ngIfElse",w),a.R7$(),a.Y8G("ngIf",!S.loading)}},dependencies:[e.Sq,e.bT,j.tx,t.me,t.BC,t.vS,E.R,L.rl,_.r6,c.fg,s.LG]})}return X})();o(89505);let Z=(()=>{class X{static#t=this.\u0275fac=function(V){return new(V||X)};static#e=this.\u0275mod=a.$C({type:X});static#n=this.\u0275inj=a.G2t({imports:[e.MD,i.Cn,G.RI,O.jL,j.hM,n.g7,A.Wk,R.uc,t.YN,t.X1,F.h,L.RG,x.cQ]})}return X})();var q=o(25892),tt=(o(75555),o(98197));o(91074)},76095:(Y,N,o)=>{o.d(N,{k:()=>F});var e=o(68559),t=o(82333),O=o(25892),n=o(60316),j=o(12587),i=o(69434),G=o(85060),A=o(41134);function R(C,D){1&C&&(e.j41(0,"button",4)(1,"app-icon"),e.EFF(2,"close"),e.k0s()())}function L(C,D){if(1&C){const I=e.RV6();e.j41(0,"main")(1,"div",5)(2,"app-icon",6),e.EFF(3,"upload"),e.k0s(),e.j41(4,"p"),e.EFF(5,"Click to select file or Drag and drop files"),e.k0s(),e.j41(6,"input",7),e.bIt("change",function(P){e.eBV(I);const u=e.XpG();return e.Njj(u.handleFileEvent(P))}),e.k0s()(),e.j41(7,"div",8)(8,"button",9),e.bIt("click",function(){e.eBV(I);const P=e.XpG();return e.Njj(P.downloadTemplate())}),e.EFF(9," Download Template "),e.k0s()()()}}function x(C,D){if(1&C&&(e.j41(0,"main",10),e.nrm(1,"mat-spinner",11),e.j41(2,"p"),e.EFF(3),e.k0s()()),2&C){const I=e.XpG();e.R7$(3),e.JRh(I.loading)}}let F=(()=>{class C{constructor(){this.event=new e.bkB}handleFileEvent(I){this.loading="Processing menu data...";const y=I.target;if(!y?.files)return this.loading="";const P=y.files;if(!P.length)return this.loading="";const u=P[0],b=new FileReader;b.addEventListener("loadend",p=>{const l=(0,t.a6)(p.target.result);this.loading="",this.event.emit({reason:"done",metadata:l.filter(h=>"item"===(h.type||"").toLowerCase()).map(h=>new O.T({...h,options:l.filter(r=>"option"===(r.type||"").toLowerCase()&&r.tags===h.id).map(r=>({id:r.id,name:r.name,group:r.category,multiple:r.multiple,unit_price:r.unit_price}))}))})}),b.readAsText(u)}downloadTemplate(){(0,t.PE)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}static#t=this.\u0275fac=function(y){return new(y||C)};static#e=this.\u0275cmp=e.VBU({type:C,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[["load_state",""],[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["icon","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["icon","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-base-200","border-dashed","rounded-xl","hover:bg-base-200","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["matRipple","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(y,P){if(1&y&&(e.j41(0,"header",1)(1,"h2"),e.EFF(2,"Import Catering Menu"),e.k0s(),e.DNE(3,R,3,0,"button",2),e.k0s(),e.DNE(4,L,10,0,"main",3)(5,x,4,1,"ng-template",null,0,e.C5r)),2&y){const u=e.sdS(6);e.R7$(3),e.Y8G("ngIf",!P.loading),e.R7$(),e.Y8G("ngIf",!P.loading)("ngIfElse",u)}},dependencies:[n.bT,j.tx,i.R,G.r6,A.LG]})}return C})()},30807:(Y,N,o)=>{o.d(N,{d:()=>M});var e=o(74879),t=o(68559),O=o(34456),n=o(12587),j=o(82333),i=o(25892),G=o(60316),A=o(79771),R=o(85060),L=o(97024),x=o(69434),F=o(24950),C=o(87984),D=o(41134),I=o(12772),y=o(55507),P=o(56864);const u=()=>({standalone:!0});function b(a,E){1&a&&(t.j41(0,"button",9)(1,"app-icon"),t.EFF(2,"close"),t.k0s()())}function p(a,E){if(1&a&&(t.j41(0,"div",20)(1,"label",21),t.EFF(2," Name"),t.j41(3,"span"),t.EFF(4,"*"),t.k0s(),t.EFF(5,": "),t.k0s(),t.j41(6,"mat-form-field",22),t.nrm(7,"input",23),t.j41(8,"mat-error"),t.EFF(9,"Name is required"),t.k0s()()()),2&a){const _=t.XpG(2);t.R7$(),t.AVh("error",_.form.controls.name.invalid&&_.form.controls.name.touched)}}function T(a,E){if(1&a&&(t.j41(0,"div",20)(1,"label",24),t.EFF(2," Category"),t.j41(3,"span"),t.EFF(4,"*"),t.k0s(),t.EFF(5,": "),t.k0s(),t.j41(6,"mat-form-field",22),t.nrm(7,"input",25),t.j41(8,"mat-error"),t.EFF(9,"Category is required"),t.k0s()()()),2&a){const _=t.XpG(2),c=t.sdS(9);t.R7$(),t.AVh("error",_.form.controls.category.invalid&&_.form.controls.category.touched),t.R7$(6),t.Y8G("matAutocomplete",c)}}function l(a,E){if(1&a){const _=t.RV6();t.j41(0,"mat-chip-row",30),t.bIt("removed",function(){const s=t.eBV(_).$implicit,d=t.XpG(3);return t.Njj(d.removeTag(s))}),t.EFF(1),t.j41(2,"button",31)(3,"app-icon"),t.EFF(4,"cancel"),t.k0s()()()}if(2&a){const _=E.$implicit;t.R7$(),t.SpI(" ",_," "),t.R7$(),t.BMQ("aria-label","Remove "+_)}}function h(a,E){if(1&a){const _=t.RV6();t.j41(0,"div",20)(1,"label",26),t.pXf(2,3),t.k0s(),t.j41(3,"mat-form-field",22)(4,"mat-chip-grid",27,2),t.DNE(6,l,5,2,"mat-chip-row",28),t.k0s(),t.j41(7,"input",29),t.bIt("matChipInputTokenEnd",function(s){t.eBV(_);const d=t.XpG(2);return t.Njj(d.addTag(s))}),t.k0s()()()}if(2&a){const _=t.sdS(5),c=t.XpG(2);t.R7$(),t.AVh("error",c.form.controls.tags.invalid&&c.form.controls.tags.touched),t.R7$(5),t.Y8G("ngForOf",c.tag_list),t.R7$(),t.Y8G("matChipInputFor",_)("matChipInputSeparatorKeyCodes",c.separators)("matChipInputAddOnBlur",!0)}}function r(a,E){1&a&&(t.j41(0,"div",20)(1,"label",32),t.EFF(2,"Description:"),t.k0s(),t.j41(3,"mat-form-field",22),t.nrm(4,"textarea",33),t.k0s()())}function v(a,E){if(1&a&&(t.j41(0,"div",20)(1,"label",21),t.EFF(2," Unit Price"),t.j41(3,"span"),t.EFF(4,"*"),t.k0s(),t.EFF(5,": "),t.k0s(),t.j41(6,"mat-form-field",22),t.nrm(7,"input",34),t.j41(8,"mat-error"),t.EFF(9,"Unit Price is required"),t.k0s()()()),2&a){const _=t.XpG(2);t.R7$(),t.AVh("error",_.form.controls.unit_price.invalid&&_.form.controls.unit_price.touched)}}function f(a,E){1&a&&(t.j41(0,"div",20)(1,"label",35),t.pXf(2,4),t.k0s(),t.nrm(3,"image-list-field",36),t.k0s())}function U(a,E){if(1&a){const _=t.RV6();t.j41(0,"form",10)(1,"div",11),t.DNE(2,p,10,2,"div",12)(3,T,10,3,"div",12),t.k0s(),t.DNE(4,h,8,6,"div",12)(5,r,5,0,"div",12)(6,v,10,2,"div",12),t.j41(7,"div",13)(8,"label",14),t.EFF(9,"Accept Points?"),t.k0s(),t.j41(10,"mat-checkbox",15),t.EFF(11),t.k0s()(),t.j41(12,"div",16)(13,"mat-checkbox",17),t.bIt("ngModelChange",function(s){t.eBV(_);const d=t.XpG();return t.Njj(s?d.addTag({value:"Gluten Free"}):d.removeTag("Gluten Free"))}),t.EFF(14," Gluten Free (GF) "),t.k0s(),t.j41(15,"mat-checkbox",17),t.bIt("ngModelChange",function(s){t.eBV(_);const d=t.XpG();return t.Njj(s?d.addTag({value:"Vegan"}):d.removeTag("Vegan"))}),t.EFF(16," Vegan (VG) "),t.k0s(),t.j41(17,"mat-checkbox",17),t.bIt("ngModelChange",function(s){t.eBV(_);const d=t.XpG();return t.Njj(s?d.addTag({value:"Vegetarian"}):d.removeTag("Vegetarian"))}),t.EFF(18," Vegetarian (V) "),t.k0s(),t.j41(19,"mat-checkbox",17),t.bIt("ngModelChange",function(s){t.eBV(_);const d=t.XpG();return t.Njj(s?d.addTag({value:"Contains Dairy"}):d.removeTag("Contains Dairy"))}),t.EFF(20," Contains Dairy (D) "),t.k0s(),t.j41(21,"mat-checkbox",17),t.bIt("ngModelChange",function(s){t.eBV(_);const d=t.XpG();return t.Njj(s?d.addTag({value:"Contains Nuts"}):d.removeTag("Contains Nuts"))}),t.EFF(22," Contains Nuts (N) "),t.k0s()(),t.j41(23,"div",13)(24,"label",18),t.EFF(25,"Discount Cap"),t.k0s(),t.nrm(26,"a-counter",19),t.k0s(),t.DNE(27,f,4,0,"div",12),t.k0s()}if(2&a){let _;const c=t.XpG();t.Y8G("formGroup",c.form),t.R7$(2),t.Y8G("ngIf",c.form.controls.name),t.R7$(),t.Y8G("ngIf",c.form.controls.category),t.R7$(),t.Y8G("ngIf",c.form.controls.tags),t.R7$(),t.Y8G("ngIf",c.form.controls.description),t.R7$(),t.Y8G("ngIf",c.form.controls.unit_price),t.R7$(5),t.JRh(null!=(_=c.form.get("accept_points"))&&_.value?"No":"Yes"),t.R7$(2),t.Y8G("ngModel",c.hasTag("Gluten Free"))("ngModelOptions",t.lJ4(22,u)),t.R7$(2),t.Y8G("ngModel",c.hasTag("Vegan"))("ngModelOptions",t.lJ4(23,u)),t.R7$(2),t.Y8G("ngModel",c.hasTag("Vegetarian"))("ngModelOptions",t.lJ4(24,u)),t.R7$(2),t.Y8G("ngModel",c.hasTag("Contains Dairy"))("ngModelOptions",t.lJ4(25,u)),t.R7$(2),t.Y8G("ngModel",c.hasTag("Contains Nuts"))("ngModelOptions",t.lJ4(26,u)),t.R7$(5),t.Y8G("min",0)("max",100)("step",5)("render_fn",c.renderPercent),t.R7$(),t.Y8G("ngIf",c.form.controls.images)}}function W(a,E){if(1&a){const _=t.RV6();t.j41(0,"footer",37)(1,"button",38),t.bIt("click",function(){t.eBV(_);const s=t.XpG();return t.Njj(s.saveChanges())}),t.EFF(2," Save "),t.k0s()()}if(2&a){const _=t.XpG();t.R7$(),t.Y8G("disabled",!_.form.dirty)}}function m(a,E){1&a&&(t.j41(0,"div",39),t.nrm(1,"mat-spinner",40),t.j41(2,"p"),t.EFF(3,"Saving catering item..."),t.k0s()())}function g(a,E){if(1&a&&(t.j41(0,"mat-option",41),t.EFF(1),t.k0s()),2&a){const _=E.$implicit;t.Y8G("value",_),t.R7$(),t.SpI(" ",_," ")}}let M=(()=>{class a{get item(){return this._data.item||new i.T}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(_=0){return`${_}%`}hasTag(_){return this.tag_list.includes(_)}constructor(_){this._data=_,this.event=new t.bkB,this.form=new O.gE({name:new O.MJ(this.item.name||"",[O.k0.required]),description:new O.MJ(this.item.description||""),category:new O.MJ(this.item.category||"",[O.k0.required]),unit_price:new O.MJ(this.item.unit_price,[O.k0.required]),tags:new O.MJ(this.item.tags||[]),accept_points:new O.MJ(this.item.accept_points||!1),discount_cap:new O.MJ(this.item.discount_cap||0),images:new O.MJ(this.item.images||[])}),this.loading=!1,this.separators=[e.Fm,e.KE,e.t6]}addTag(_){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const c=_.input,s=_.value,d=this.tag_list;(s||"").trim()&&(d.push(s),this.form.controls.tags.setValue(d)),c&&(c.value="")}removeTag(_){if(!this.form||!this.form.controls.tags)return;const c=this.tag_list;this.form.controls.tags.markAsDirty();const s=c.indexOf(_);s>=0&&(c.splice(s,1),this.form.controls.tags.setValue(c))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new i.T({...this.item,id:this.item.id||`item-${(0,j.HO)(99999999)}`,...this.form.value})}})}static#t=this.\u0275fac=function(c){return new(c||a)(t.rXU(n.Vh))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:()=>{let _,c,s;return _=$localize`:@@zoneTagsPlaceholder␟c133beffffe3288bbdbf8572a32910c33ce14991␟2194594490376201833:Item tags e.g. Gluten Free, Vegan etc.`,c=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,s=$localize`:@@imagesLabel␟e5d9e00faa06714d7671b164cad364b26f4c585b␟5137125764814732349:Images:`,[["load_state",""],["auto","matAutocomplete"],["chipList",""],c,s,["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-base-200",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],[1,"flex","items-center","space-x-2"],["class","flex flex-col",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],["list","",1,"flex","items-center","flex-wrap","max-w-lg"],[3,"ngModelChange","ngModel","ngModelOptions"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-base-200","rounded",3,"min","max","step","render_fn"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],["aria-label","Item Tags"],[3,"removed",4,"ngFor","ngForOf"],["name","tags","placeholder",_,3,"matChipInputTokenEnd","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur"],[3,"removed"],["matChipRemove",""],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["for","images"],["name","images","formControlName","images"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-base-200"],["btn","","matRipple","",3,"click","disabled"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(c,s){if(1&c&&(t.j41(0,"header")(1,"h3"),t.EFF(2),t.k0s(),t.DNE(3,b,3,0,"button",5),t.k0s(),t.DNE(4,U,28,27,"form",6)(5,W,3,1,"footer",7)(6,m,4,0,"ng-template",null,0,t.C5r),t.j41(8,"mat-autocomplete",null,1),t.DNE(10,g,2,2,"mat-option",8),t.k0s()),2&c){const d=t.sdS(7);t.R7$(2),t.SpI("",s.item.id?"Edit":"Add"," Item"),t.R7$(),t.Y8G("ngIf",!s.loading),t.R7$(),t.Y8G("ngIf",s.form&&!s.loading)("ngIfElse",d),t.R7$(),t.Y8G("ngIf",!s.loading),t.R7$(5),t.Y8G("ngForOf",s.categories)}},dependencies:[G.Sq,G.bT,A.$3,R.wT,A.pN,n.tx,L.So,O.qT,O.me,O.Q0,O.BC,O.cb,O.vS,O.j4,O.JD,x.R,F.rl,F.TL,R.r6,C.fg,D.LG,I.HW,I.D7,I.Zv,I.jH,y.s,P.$],styles:["[list][_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin:.5rem}\n\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--53.css.map*/"]})}return a})()},71853:(Y,N,o)=>{o.d(N,{P:()=>b});var e=o(82333),t=o(25892),O=o(52201),n=o(68559),j=o(60316),i=o(31034),G=o(97024),A=o(80640),R=o(34456),L=o(69434),x=o(85060);const F=["catering-menu-item",""];function C(p,T){if(1&p&&(n.j41(0,"button",14)(1,"app-icon"),n.EFF(2,"more_vert"),n.k0s()()),2&p){n.XpG(2);const l=n.sdS(4);n.Y8G("matMenuTriggerFor",l)}}function D(p,T){if(1&p){const l=n.RV6();n.j41(0,"div",6)(1,"mat-checkbox",7),n.mxI("ngModelChange",function(r){n.eBV(l);const v=n.XpG();return n.DH7(v.is_enabled,r)||(v.is_enabled=r),n.Njj(r)}),n.k0s(),n.j41(2,"div",8)(3,"div",9)(4,"div"),n.EFF(5),n.k0s(),n.j41(6,"div",10),n.EFF(7),n.k0s()(),n.j41(8,"div",11),n.EFF(9),n.nI1(10,"async"),n.nI1(11,"currency"),n.k0s()(),n.DNE(12,C,3,1,"button",12),n.j41(13,"button",13),n.bIt("click",function(){n.eBV(l);const r=n.XpG();return n.Njj(r.show_options=!r.show_options)}),n.j41(14,"app-icon"),n.EFF(15,"expand_more"),n.k0s()()()}if(2&p){const l=n.XpG();n.R7$(),n.R50("ngModel",l.is_enabled),n.R7$(4),n.JRh(l.item.name),n.R7$(2),n.SpI(" ",l.item.category," "),n.R7$(2),n.SpI(" ",n.i5U(11,8,l.item.unit_price/100,n.bMT(10,6,l.symbol))," "),n.R7$(3),n.Y8G("ngIf",l.can_edit),n.R7$(),n.Y8G("disabled",!l.item.options.length)}}function I(p,T){if(1&p){const l=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(l);const r=n.XpG().$implicit,v=n.XpG(2);return n.Njj(v.editOption(r))}),n.j41(1,"app-icon"),n.EFF(2,"edit"),n.k0s()()}}function y(p,T){if(1&p){const l=n.RV6();n.j41(0,"button",24),n.bIt("click",function(){n.eBV(l);const r=n.XpG().$implicit,v=n.XpG(2);return n.Njj(v.removeOption(r))}),n.j41(1,"app-icon"),n.EFF(2,"delete"),n.k0s()()}}function P(p,T){if(1&p&&(n.j41(0,"div",17),n.nrm(1,"div",18),n.j41(2,"div",19)(3,"div",20),n.EFF(4),n.k0s(),n.j41(5,"div",10),n.EFF(6),n.k0s()(),n.DNE(7,I,3,0,"button",21)(8,y,3,0,"button",22),n.k0s()),2&p){const l=T.$implicit,h=n.XpG(2);n.R7$(4),n.JRh(l.name),n.R7$(2),n.SpI(" ",l.group," "),n.R7$(),n.Y8G("ngIf",h.can_edit),n.R7$(),n.Y8G("ngIf",h.can_edit)}}function u(p,T){if(1&p&&(n.j41(0,"div",15),n.DNE(1,P,9,4,"div",16),n.k0s()),2&p){const l=n.XpG();n.xc7("height",l.show_options?3.5*l.item.options.length+"rem":"0"),n.R7$(),n.Y8G("ngForOf",l.item.options)}}let b=(()=>{class p{get can_edit(){return this._catering.is_editable}get is_enabled(){return!this.item.hide_for_zones.includes(this._catering.zone)}set is_enabled(l){let h=this.item.hide_for_zones;h=l?h.filter(r=>r!==this._catering.zone):(0,e.Am)([...h,this._catering.zone]),this._catering.updateItem(new t.T({...this.item,hide_for_zones:h}))}get symbol(){return this._catering.currency}constructor(l){this._catering=l,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=h=>this._catering.addOption(this.item,h),this.removeOption=h=>this._catering.deleteOption(this.item,h),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}static#t=this.\u0275fac=function(h){return new(h||p)(n.rXU(O._))};static#e=this.\u0275cmp=n.VBU({type:p,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:F,decls:20,vars:2,consts:[["menu","matMenu"],[1,"w-full","h-full","bg-base-100","border","border-base-200","overflow-hidden","rounded"],["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-base-200 overflow-hidden",3,"height",4,"ngIf"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],["matTooltip","Allow Ordering Item",1,"mr-2",3,"ngModelChange","ngModel"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","opacity-60"],[1,"p-2","m-2","text-xs","font-bold","text-secondary-content","rounded","bg-secondary"],["icon","","matRipple","",3,"matMenuTriggerFor",4,"ngIf"],["icon","","matRipple","",3,"click","disabled"],["icon","","matRipple","",3,"matMenuTriggerFor"],["options","",1,"bg-base-200","overflow-hidden"],["class","flex p-2 items-center border-t border-solid border-base-200 relative",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-t","border-solid","border-base-200","relative"],[1,"absolute","inset-y-0","left-0","w-2","bg-black","opacity-10"],[1,"flex-1","pl-4","pr-2"],[1,"text"],["edit","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["remove","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["edit","","icon","","matRipple","",1,"mx-2",3,"click"],["remove","","icon","","matRipple","",1,"mx-2",3,"click"]],template:function(h,r){if(1&h){const v=n.RV6();n.j41(0,"div",1),n.DNE(1,D,16,11,"div",2)(2,u,2,3,"div",3),n.j41(3,"mat-menu",null,0)(5,"button",4),n.bIt("click",function(){return n.eBV(v),n.Njj(r.addOption())}),n.j41(6,"app-icon"),n.EFF(7,"add"),n.k0s(),n.j41(8,"div",5),n.EFF(9,"Add Option"),n.k0s()(),n.j41(10,"button",4),n.bIt("click",function(){return n.eBV(v),n.Njj(r.editItem())}),n.j41(11,"app-icon"),n.EFF(12,"edit"),n.k0s(),n.j41(13,"div",5),n.EFF(14,"Edit Item"),n.k0s()(),n.j41(15,"button",4),n.bIt("click",function(){return n.eBV(v),n.Njj(r.removeItem())}),n.j41(16,"app-icon"),n.EFF(17,"delete"),n.k0s(),n.j41(18,"div",5),n.EFF(19,"Remove Item"),n.k0s()()()()}2&h&&(n.R7$(),n.Y8G("ngIf",r.item),n.R7$(),n.Y8G("ngIf",r.item))},dependencies:[j.Sq,j.bT,i.kk,i.fb,i.Cp,G.So,A.oV,R.BC,R.vS,L.R,x.r6,j.Jj,j.oe],styles:["[_nghost-%COMP%]{overflow:hidden;width:48rem;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}\n\n/*# sourceMappingURL=catering-menu-item.component.ts-angular-inline--68.css.map*/"]})}return p})()},48519:(Y,N,o)=>{o.d(N,{o:()=>D});var e=o(90521),t=o(35443),O=o(52201),n=o(68559),j=o(60316),i=o(38223),G=o(69434),A=o(71853);function R(I,y){if(1&I&&(n.qex(0),n.nrm(1,"div",6),n.bVm()),2&I){const P=y.$implicit;n.R7$(),n.Y8G("item",P)}}function L(I,y){if(1&I&&(n.qex(0),n.DNE(1,R,2,1,"ng-container",5),n.nI1(2,"async"),n.bVm()),2&I){const P=n.XpG();n.R7$(),n.Y8G("ngForOf",n.bMT(2,1,P.menu))}}function x(I,y){if(1&I&&(n.qex(0),n.nrm(1,"div",6),n.bVm()),2&I){const P=y.$implicit;n.R7$(),n.Y8G("item",P)}}function F(I,y){if(1&I&&(n.j41(0,"mat-tab",7),n.DNE(1,x,2,1,"ng-container",5),n.nI1(2,"async"),n.k0s()),2&I){const P=y.$implicit,u=n.XpG();n.Y8G("label",P),n.BMQ("label",P),n.R7$(),n.Y8G("ngForOf",n.bMT(2,3,u.tab_menu)[P])}}function C(I,y){1&I&&(n.j41(0,"div",8)(1,"app-icon"),n.EFF(2,"close"),n.k0s(),n.j41(3,"p"),n.EFF(4,"No items in menu"),n.k0s()())}let D=(()=>{class I{get categories(){return this._catering.categories}constructor(P){this._catering=P,this.menu=this._catering.menu,this.shown_tab=new e.t(""),this.tab_menu=this.menu.pipe((0,t.T)(u=>{const b={};for(const p of this.categories)b[p]=u.filter(T=>T.category===p);return b}))}static#t=this.\u0275fac=function(u){return new(u||I)(n.rXU(O._))};static#e=this.\u0275cmp=n.VBU({type:I,selectors:[["catering-menu"]],decls:7,vars:5,consts:[["empty_state",""],[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(u,b){if(1&u){const p=n.RV6();n.j41(0,"mat-tab-group",1),n.bIt("selectedIndexChange",function(l){return n.eBV(p),n.Njj(b.shown_tab.next(0===l?"":b.categories[l-1]))}),n.j41(1,"mat-tab",2),n.DNE(2,L,3,3,"ng-container",3),n.nI1(3,"async"),n.k0s(),n.DNE(4,F,3,5,"mat-tab",4),n.k0s(),n.DNE(5,C,5,0,"ng-template",null,0,n.C5r)}if(2&u){let p;const T=n.sdS(6);n.R7$(2),n.Y8G("ngIf",null==(p=n.bMT(3,3,b.menu))?null:p.length)("ngIfElse",T),n.R7$(2),n.Y8G("ngForOf",b.categories)}},dependencies:[j.Sq,j.bT,i.mq,i.T8,G.R,A.P,j.Jj],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--69.css.map*/"]})}return I})()},37053:(Y,N,o)=>{o.d(N,{e:()=>h});var e=o(68559),t=o(34456),O=o(12587),n=o(64217),j=o(25892),i=o(60316),G=o(79771),A=o(85060),R=o(97024),L=o(69434),x=o(24950),F=o(87984),C=o(41134);function D(r,v){1&r&&(e.j41(0,"button",6)(1,"app-icon"),e.EFF(2,"close"),e.k0s()())}function I(r,v){if(1&r&&(e.j41(0,"div",9)(1,"label",10),e.EFF(2," Name"),e.j41(3,"span"),e.EFF(4,"*"),e.k0s(),e.EFF(5,": "),e.k0s(),e.j41(6,"mat-form-field",11),e.nrm(7,"input",12),e.j41(8,"mat-error"),e.EFF(9,"Name is required"),e.k0s()()()),2&r){const f=e.XpG(2);e.R7$(),e.AVh("error",f.form.controls.name.invalid&&f.form.controls.name.touched)}}function y(r,v){if(1&r&&(e.j41(0,"div",9)(1,"label",13),e.EFF(2," Type"),e.j41(3,"span"),e.EFF(4,"*"),e.k0s(),e.EFF(5,": "),e.k0s(),e.j41(6,"mat-form-field",11),e.nrm(7,"input",14),e.j41(8,"mat-error"),e.EFF(9,"Type is required"),e.k0s()()()),2&r){const f=e.XpG(2),U=e.sdS(9);e.R7$(),e.AVh("error",f.form.controls.group.invalid&&f.form.controls.group.touched),e.R7$(6),e.Y8G("matAutocomplete",U)}}function P(r,v){1&r&&(e.j41(0,"div",9)(1,"label",10),e.EFF(2,"Unit Price:"),e.k0s(),e.j41(3,"mat-form-field",11),e.nrm(4,"input",15),e.k0s()())}function u(r,v){1&r&&(e.j41(0,"div",9)(1,"mat-checkbox",16),e.EFF(2," Can select multiple of type "),e.k0s()())}function b(r,v){if(1&r&&(e.j41(0,"form",7),e.DNE(1,I,10,2,"div",8)(2,y,10,3,"div",8)(3,P,5,0,"div",8)(4,u,3,0,"div",8),e.k0s()),2&r){const f=e.XpG();e.Y8G("formGroup",f.form),e.R7$(),e.Y8G("ngIf",f.form.controls.name),e.R7$(),e.Y8G("ngIf",f.form.controls.group),e.R7$(),e.Y8G("ngIf",f.form.controls.unit_price),e.R7$(),e.Y8G("ngIf",f.form.controls.multiple)}}function p(r,v){if(1&r){const f=e.RV6();e.j41(0,"footer",17)(1,"button",18),e.bIt("click",function(){e.eBV(f);const W=e.XpG();return e.Njj(W.saveChanges())}),e.EFF(2," Save "),e.k0s()()}if(2&r){const f=e.XpG();e.R7$(),e.Y8G("disabled",!f.form.dirty)}}function T(r,v){1&r&&(e.j41(0,"div",19),e.nrm(1,"mat-spinner",20),e.j41(2,"p"),e.EFF(3,"Saving catering item option..."),e.k0s()())}function l(r,v){if(1&r&&(e.j41(0,"mat-option",21),e.EFF(1),e.k0s()),2&r){const f=v.$implicit;e.Y8G("value",f),e.R7$(),e.SpI(" ",f," ")}}let h=(()=>{class r{get option(){return this._data.option}get types(){return this._data.types||[]}constructor(f){this._data=f,this.event=new e.bkB,this.form=new t.gE({name:new t.MJ(this.option.name||"",[t.k0.required]),group:new t.MJ(this.option.group||"",[t.k0.required]),unit_price:new t.MJ(this.option.unit_price),multiple:new t.MJ(!!this.option.multiple,[])}),this.loading=!1}saveChanges(){this.loading=!0;const f={...this.option,id:this.option.id||`option-${(0,n.HO)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new j.T({...this._data.parent,options:this._data.parent.options.filter(U=>U.id!==f.id).concat([f])})}})}static#t=this.\u0275fac=function(U){return new(U||r)(e.rXU(O.Vh))};static#e=this.\u0275cmp=e.VBU({type:r,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["load_state",""],["auto","matAutocomplete"],["icon","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-base-200",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["icon","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-base-200"],["btn","","matRipple","",3,"click","disabled"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(U,W){if(1&U&&(e.j41(0,"header")(1,"h3"),e.EFF(2),e.k0s(),e.DNE(3,D,3,0,"button",2),e.k0s(),e.DNE(4,b,5,5,"form",3)(5,p,3,1,"footer",4)(6,T,4,0,"ng-template",null,0,e.C5r),e.j41(8,"mat-autocomplete",null,1),e.DNE(10,l,2,2,"mat-option",5),e.k0s()),2&U){const m=e.sdS(7);e.R7$(2),e.SpI("",W.option.id?"Edit":"Add"," Item Option"),e.R7$(),e.Y8G("ngIf",!W.loading),e.R7$(),e.Y8G("ngIf",W.form&&!W.loading)("ngIfElse",m),e.R7$(),e.Y8G("ngIf",!W.loading),e.R7$(5),e.Y8G("ngForOf",W.types)}},dependencies:[i.Sq,i.bT,G.$3,A.wT,G.pN,O.tx,R.So,t.qT,t.me,t.Q0,t.BC,t.cb,t.j4,t.JD,L.R,x.rl,x.TL,A.r6,F.fg,C.LG]})}return r})()},3872:(Y,N,o)=>{o.d(N,{Q:()=>L});var e=o(68559),t=o(60316),O=o(69434),n=o(85060);const j=["catering-order-item",""];function i(x,F){if(1&x&&(e.j41(0,"div",12),e.EFF(1),e.k0s()),2&x){const C=e.XpG().$implicit;e.R7$(),e.SpI(" ",C.name," ")}}function G(x,F){if(1&x&&(e.qex(0),e.DNE(1,i,2,1,"div",11),e.bVm()),2&x){const C=F.$implicit;e.R7$(),e.Y8G("ngIf",C)}}function A(x,F){if(1&x){const C=e.RV6();e.qex(0),e.j41(1,"div",1),e.nrm(2,"div",2),e.k0s(),e.j41(3,"div",3)(4,"button",4),e.bIt("click",function(){e.eBV(C);const I=e.XpG();return e.Njj(I.toggle())}),e.j41(5,"app-icon"),e.EFF(6),e.k0s()()(),e.j41(7,"div",5)(8,"div",6),e.EFF(9),e.k0s(),e.j41(10,"div",7)(11,"div",8),e.EFF(12),e.k0s()(),e.j41(13,"div",9),e.DNE(14,G,2,1,"ng-container",10),e.k0s()(),e.bVm()}if(2&x){const C=e.XpG();e.R7$(4),e.AVh("bg-success",C.active)("text-white",C.active)("border-solid",C.active),e.R7$(2),e.JRh(C.active?"done":"local_pizza"),e.R7$(3),e.JRh(null==C.item?null:C.item.name),e.R7$(3),e.SpI(" \u2a2f",(null==C.item?null:C.item.amount)||(null==C.item?null:C.item.quantity)||1," "),e.R7$(2),e.Y8G("ngForOf",C.item.option_list)}}const R=new Set;let L=(()=>{class x{constructor(){this.active=!1}get item_key(){return`${this.order_id}|${this.item?.id}`}ngOnInit(){this.active=R.has(this.item_key)}toggle(){R.has(this.item_key)?(R.delete(this.item_key),this.active=!1):(R.add(this.item_key),this.active=!0)}static#t=this.\u0275fac=function(D){return new(D||x)};static#e=this.\u0275cmp=e.VBU({type:x,selectors:[["","catering-order-item",""]],inputs:{order_id:"order_id",item:"item"},attrs:j,decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-20","text-right","h-14","relative"],[1,"border-b-2","border-l-2","border-base-200","w-4","h-16","absolute","top-1/2","left-1/2","-translate-y-full"],[1,"w-12","mr-4"],["action","","icon","","matRipple","",1,"border","border-base-200","border-dashed","text-xl","text-dark-fade","p-2",3,"click"],[1,"flex","flex-1","border-b","border-base-200","border-solid","py-4","space-x-2"],[1,""],[1,"flex-1"],[1,"p-1","rounded-full","bg-neutral","w-8","h-8","flex","items-center","justify-center"],[1,"flex","space-x-2","mr-2"],[4,"ngFor","ngForOf"],["class","text-xs py-1 px-2 bg-warning text-black rounded-2xl shadow",4,"ngIf"],[1,"text-xs","py-1","px-2","bg-warning","text-black","rounded-2xl","shadow"]],template:function(D,I){1&D&&e.DNE(0,A,15,10,"ng-container",0),2&D&&e.Y8G("ngIf",I.item)},dependencies:[t.Sq,t.bT,O.R,n.r6],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}\n\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--70.css.map*/"]})}return x})()},41623:(Y,N,o)=>{o.d(N,{r:()=>A});var e=o(98197),t=o(68559),O=o(60316),n=o(98832);function j(R,L){if(1&R&&(t.j41(0,"li",12),t.nrm(1,"catering-order",13),t.k0s()),2&R){const x=L.$implicit;t.R7$(),t.Y8G("order",x)}}function i(R,L){1&R&&(t.j41(0,"div",14)(1,"p",15),t.EFF(2,"No Catering Orders"),t.k0s()())}function G(R,L){1&R&&t.nrm(0,"mat-progress-bar",16)}let A=(()=>{class R{constructor(x){this._orders=x,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(x,F){return F?F.id:void 0}static#t=this.\u0275fac=function(F){return new(F||R)(t.rXU(e.Q))};static#e=this.\u0275cmp=t.VBU({type:R,selectors:[["catering-order-list"]],decls:26,vars:10,consts:[[1,"sticky","top-0","w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-base-200","bg-base-100"],[1,"w-20"],[1,"w-24"],[1,"w-36"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-base-200",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block opacity-30",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-base-200"],[3,"order"],["empty","",1,"info-block","opacity-30"],[1,"p-4","text-center"],["mode","indeterminate",1,"w-full"]],template:function(F,C){if(1&F&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2),t.EFF(3,"Time"),t.k0s(),t.j41(4,"div",3),t.EFF(5,"Meeting Time"),t.k0s(),t.j41(6,"div",4),t.EFF(7,"Location"),t.k0s(),t.j41(8,"div",5),t.EFF(9,"Host"),t.k0s(),t.j41(10,"div",6),t.EFF(11,"Charge Code"),t.k0s(),t.j41(12,"div",2),t.EFF(13,"Notes"),t.k0s(),t.j41(14,"div",6),t.EFF(15,"Invoice No."),t.k0s(),t.j41(16,"div",3),t.EFF(17,"Status"),t.k0s(),t.nrm(18,"div",7),t.k0s(),t.j41(19,"ul",8),t.DNE(20,j,2,1,"li",9),t.nI1(21,"async"),t.DNE(22,i,3,0,"div",10),t.nI1(23,"async"),t.k0s(),t.DNE(24,G,1,0,"mat-progress-bar",11),t.nI1(25,"async")),2&F){let D;t.R7$(20),t.Y8G("ngForOf",t.bMT(21,4,C.order_list))("ngForTrackBy",C.trackByFn),t.R7$(2),t.Y8G("ngIf",!(null!=(D=t.bMT(23,6,C.order_list))&&D.length)),t.R7$(2),t.Y8G("ngIf",t.bMT(25,8,C.loading))}},dependencies:[O.Sq,O.bT,n.l,O.Jj],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--71.css.map*/"]})}return R})()},82912:(Y,N,o)=>{o.d(N,{g:()=>E});var e=o(89204),t=o(68559),O=o(12587),n=o(82333),j=o(25892),i=o(75555),G=o(12185),A=o(60285),R=o(60316),L=o(38223),x=o(80640),F=o(34456),C=o(69434),D=o(85060),I=o(41134),y=o(55507);const P=()=>({});function u(_,c){1&_&&(t.j41(0,"div",18),t.EFF(1," Options Available "),t.k0s())}function b(_,c){if(1&_){const s=t.RV6();t.j41(0,"a-counter",19),t.bIt("ngModelChange",function(K){t.eBV(s);const $=t.XpG().$implicit,k=t.XpG(5);return t.Njj(k.updateItemQuantity($,K))}),t.k0s()}if(2&_){const s=t.XpG().$implicit;t.Y8G("ngModel",s.quantity)}}function p(_,c){if(1&_){const s=t.RV6();t.j41(0,"div",20)(1,"div",21)(2,"button",22)(3,"app-icon"),t.EFF(4,"remove"),t.k0s()()(),t.j41(5,"div",23),t.EFF(6),t.k0s(),t.j41(7,"button",24),t.bIt("click",function(){t.eBV(s);const K=t.XpG().$implicit,$=t.XpG(5);return t.Njj($.addItem(K))}),t.j41(8,"app-icon"),t.EFF(9,"add"),t.k0s()()()}if(2&_){const s=t.XpG().$implicit;t.R7$(),t.Y8G("matTooltip",s.quantity?"Items with options must be removed from order confirmation page":""),t.R7$(),t.Y8G("disabled",!0),t.R7$(4),t.SpI(" ",s.quantity," ")}}function T(_,c){if(1&_&&(t.j41(0,"div",12)(1,"div",13)(2,"div",13),t.EFF(3),t.k0s(),t.DNE(4,u,2,0,"div",14),t.k0s(),t.j41(5,"div",15),t.EFF(6),t.nI1(7,"currency"),t.k0s(),t.DNE(8,b,1,1,"a-counter",16)(9,p,10,3,"div",17),t.k0s()),2&_){const s=c.$implicit,d=t.XpG(5);t.R7$(3),t.SpI(" ",s.name," "),t.R7$(),t.Y8G("ngIf",s.options.length),t.R7$(2),t.SpI(" ",t.i5U(7,5,s.unit_price/100,d.code)," "),t.R7$(2),t.Y8G("ngIf",!s.options.length),t.R7$(),t.Y8G("ngIf",s.options.length)}}function l(_,c){if(1&_&&(t.j41(0,"mat-tab",9)(1,"div",10),t.DNE(2,T,10,8,"div",11),t.k0s()()),2&_){const s=t.XpG().$implicit,d=t.XpG(3);t.Y8G("label",s),t.R7$(2),t.Y8G("ngForOf",(d.menu_items||t.lJ4(2,P))[s])}}function h(_,c){if(1&_&&(t.qex(0),t.DNE(1,l,3,3,"mat-tab",8),t.bVm()),2&_){const s=c.$implicit,d=t.XpG(3);t.R7$(),t.Y8G("ngIf",(d.menu_items||t.lJ4(1,P))[s].length)}}function r(_,c){if(1&_&&(t.qex(0),t.j41(1,"mat-tab-group"),t.DNE(2,h,2,2,"ng-container",7),t.k0s(),t.bVm()),2&_){const s=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",s.categories)}}function v(_,c){if(1&_&&(t.j41(0,"div",5),t.DNE(1,r,3,1,"ng-container",6),t.k0s()),2&_){const s=t.XpG(),d=t.sdS(5);t.R7$(),t.Y8G("ngIf",!s.show_order_details)("ngIfElse",d)}}function f(_,c){if(1&_){const s=t.RV6();t.qex(0),t.j41(1,"button",26),t.EFF(2," Cancel "),t.k0s(),t.j41(3,"button",27),t.bIt("click",function(){t.eBV(s);const K=t.XpG(2);return t.Njj(K.show_order_details=!0)}),t.EFF(4," Confirm "),t.k0s(),t.bVm()}if(2&_){const s=t.XpG(2);t.R7$(3),t.Y8G("disabled",!s.order.item_count)("matBadge",s.order.item_count)("matBadgeHidden",!s.order.item_count)}}function U(_,c){if(1&_){const s=t.RV6();t.j41(0,"button",28),t.bIt("click",function(){t.eBV(s);const K=t.XpG(2);return t.Njj(K.show_order_details=!1)}),t.EFF(1," Back "),t.k0s(),t.j41(2,"button",29),t.bIt("click",function(){t.eBV(s);const K=t.XpG(2);return t.Njj(K.saveOrder())}),t.EFF(3," Save Order "),t.k0s()}}function W(_,c){if(1&_&&(t.j41(0,"footer",25),t.DNE(1,f,5,3,"ng-container",6)(2,U,4,0,"ng-template",null,2,t.C5r),t.k0s()),2&_){const s=t.sdS(3),d=t.XpG();t.R7$(),t.Y8G("ngIf",!d.show_order_details)("ngIfElse",s)}}function m(_,c){if(1&_&&(t.j41(0,"div",30),t.nrm(1,"mat-spinner",31),t.j41(2,"p"),t.EFF(3),t.k0s()()),2&_){const s=t.XpG();t.R7$(3),t.JRh(s.loading)}}function g(_,c){if(1&_&&(t.j41(0,"div",35),t.EFF(1),t.k0s()),2&_){const s=t.XpG().$implicit,d=t.XpG(2);t.Y8G("matTooltip",d.optionsFor(s)),t.R7$(),t.Lme(" ",s.options.length," option",1===s.options.length?"":"s"," selected ")}}function M(_,c){if(1&_){const s=t.RV6();t.j41(0,"div",12)(1,"div",13)(2,"div",13),t.EFF(3),t.k0s(),t.DNE(4,g,2,3,"div",33),t.k0s(),t.j41(5,"div",15),t.EFF(6),t.nI1(7,"currency"),t.k0s(),t.j41(8,"a-counter",34),t.bIt("ngModelChange",function(K){const $=t.eBV(s).$implicit,k=t.XpG(2);return t.Njj(k.updateItemQuantity($,K))}),t.k0s()()}if(2&_){const s=c.$implicit,d=t.XpG(2);t.R7$(3),t.JRh(s.name),t.R7$(),t.Y8G("ngIf",s.options.length),t.R7$(2),t.SpI(" ",t.i5U(7,4,s.total_cost/100,d.code)," "),t.R7$(2),t.Y8G("ngModel",s.quantity)}}function a(_,c){if(1&_&&(t.j41(0,"header",32)(1,"h3"),t.EFF(2,"Confirm Order"),t.k0s()(),t.j41(3,"div",10),t.DNE(4,M,9,7,"div",11),t.k0s()),2&_){const s=t.XpG();t.R7$(4),t.Y8G("ngForOf",s.order.items)}}let E=(()=>{class _ extends n.Tv{get code(){return this._org.currency_code}constructor(s,d){super(),this._org=s,this._data=d,this.event=new t.bkB,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var s=this;return(0,e.A)(function*(){s.loading="Loading menu...",s.order=new i.M(s._data.order),s.rules=yield s._data.getCateringConfig(s.order.event?.space?.level?.parent_id),s._data.menu.subscribe(d=>{s.loading="Loading menu...";const K=(0,n.Am)(d.map(k=>k.category)),$={};for(const k of K)$[k]=d.filter(J=>J.category===k&&(0,A.c)(J,s.rules,s.order.event));s.categories=K,s.menu_items=$,s.updateMenuQuantities(),s.timeout("clear_loading",()=>s.loading="",1e3)})})()}addItem(s,d=!0){const K=this.order.items.find($=>$.id===s.id&&$.options.length===$.options.reduce((k,J)=>k+(s.options.find(H=>J.id===H.id)?1:0),0));d&&s.options?.length?this._data.selectOptions(s.options).then($=>{const k=new j.T({...s,options:$});this.addItem(k,!1)}):this.order=new i.M(K?{...this.order,items:this.order.items.filter($=>!($.id===s.id&&$.options_string===s.options_string)).concat([new j.T({...s,quantity:K.quantity+1})])}:{...this.order,items:this.order.items.concat([new j.T({...s,quantity:1})])}),this.updateMenuQuantities()}removeItem(s){this.order=new i.M({...this.order,items:this.order.items.filter(d=>d.id!==s.id&&d.options_string===s.options_string)}),this.updateMenuQuantities()}updateItemQuantity(s,d){const K=this.order.items.find(k=>k.id===s.id&&k.options_string===s.options_string);let $=[...this.order.items];$=K?this.order.items.filter(k=>!(k.id===s.id&&k.options_string===s.options_string)).concat([new j.T({...s,quantity:d})]):this.order.items.concat([new j.T({...s,quantity:d})]),$.sort((k,J)=>k.name.localeCompare(J.name)),this.order=new i.M({...this.order,items:$}),this.updateMenuQuantities()}updateMenuQuantities(){for(const s in this.menu_items)for(const d of this.menu_items[s])d.quantity=this.order.items.reduce((K,$)=>$.id===d.id?K+$.quantity:K,0)}optionsFor(s){return s.options.map(d=>d.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}static#t=this.\u0275fac=function(d){return new(d||_)(t.rXU(G.yb),t.rXU(O.Vh))};static#e=this.\u0275cmp=t.VBU({type:_,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.Vt3],decls:6,vars:3,consts:[["load_state",""],["order_details",""],["order_actions",""],["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-base-200",4,"ngIf"],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-base-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-base-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModelChange","ngModel"],[1,"flex","items-center"],[3,"matTooltip"],["icon","","matRipple","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["icon","","matRipple","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-base-200"],["btn","","matRipple","","mat-dialog-close","",1,"inverse"],["confirm","","btn","","matRipple","","matBadgeColor","warn",3,"click","disabled","matBadge","matBadgeHidden"],["matRipple","",1,"inverse",3,"click"],["save","","btn","","matRipple","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModelChange","ngModel"],[1,"text-xs","underline",3,"matTooltip"]],template:function(d,K){if(1&d&&t.DNE(0,v,2,2,"div",3)(1,W,4,2,"footer",4)(2,m,4,1,"ng-template",null,0,t.C5r)(4,a,5,1,"ng-template",null,1,t.C5r),2&d){const $=t.sdS(3);t.Y8G("ngIf",!K.loading)("ngIfElse",$),t.R7$(),t.Y8G("ngIf",!K.loading)}},dependencies:[R.Sq,R.bT,L.mq,L.T8,O.tx,x.oV,F.me,F.BC,F.vS,C.R,D.r6,I.LG,y.s,R.oe],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--s);border-bottom:2px solid var(--s);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--54.css.map*/"]})}return _})()},17707:(Y,N,o)=>{o.d(N,{C:()=>P});var e=o(68559),t=o(12587),O=o(64217),n=o(60316),j=o(97024),i=o(53804),G=o(34456),A=o(69434),R=o(85060);function L(u,b){if(1&u&&(e.j41(0,"div",18),e.EFF(1),e.nI1(2,"currency"),e.k0s()),2&u){const p=e.XpG().$implicit,T=e.XpG(3);e.R7$(),e.SpI(" +",e.i5U(2,1,p.unit_price/100,T.code)," ")}}function x(u,b){if(1&u&&(e.j41(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),e.EFF(3),e.k0s(),e.DNE(4,L,3,4,"div",17),e.k0s()()),2&u){const p=b.$implicit;e.Y8G("value",p.id),e.R7$(3),e.SpI(" ",p.name," "),e.R7$(),e.Y8G("ngIf",p.unit_price)}}function F(u,b){if(1&u){const p=e.RV6();e.qex(0),e.j41(1,"mat-radio-group",10),e.bIt("ngModelChange",function(l){e.eBV(p);const h=e.XpG().$implicit,r=e.XpG();return e.Njj(r.updateGroupOption(h,l))}),e.j41(2,"mat-radio-button",11)(3,"span",12),e.EFF(4,"None"),e.k0s()(),e.DNE(5,x,5,3,"mat-radio-button",13),e.k0s(),e.bVm()}if(2&u){const p=e.XpG().$implicit;e.R7$(5),e.Y8G("ngForOf",null==p?null:p.options)}}function C(u,b){if(1&u&&(e.j41(0,"div",18),e.EFF(1),e.nI1(2,"currency"),e.k0s()),2&u){const p=e.XpG().$implicit,T=e.XpG(3);e.R7$(),e.SpI(" +",e.i5U(2,1,p.unit_price/100,T.code)," ")}}function D(u,b){if(1&u){const p=e.RV6();e.j41(0,"mat-checkbox",20),e.mxI("ngModelChange",function(l){const h=e.eBV(p).$implicit,r=e.XpG(3);return e.DH7(r.option_state[h.id],l)||(r.option_state[h.id]=l),e.Njj(l)}),e.j41(1,"div",15)(2,"div",16),e.EFF(3),e.k0s(),e.DNE(4,C,3,4,"div",17),e.k0s()()}if(2&u){const p=b.$implicit,T=e.XpG(3);e.R50("ngModel",T.option_state[p.id]),e.R7$(3),e.SpI(" ",p.name," "),e.R7$(),e.Y8G("ngIf",p.unit_price)}}function I(u,b){if(1&u&&e.DNE(0,D,5,3,"mat-checkbox",19),2&u){const p=e.XpG().$implicit;e.Y8G("ngForOf",null==p?null:p.options)}}function y(u,b){if(1&u&&(e.j41(0,"div",6)(1,"div",7),e.EFF(2),e.k0s(),e.j41(3,"div",8),e.DNE(4,F,6,1,"ng-container",9)(5,I,1,1,"ng-template",null,0,e.C5r),e.k0s()()),2&u){const p=b.$implicit,T=e.sdS(6);e.BMQ("group",p.name),e.R7$(2),e.JRh(p.name),e.R7$(2),e.Y8G("ngIf",!p.multiple)("ngIfElse",T)}}let P=(()=>{class u{constructor(p){this._data=p,this.event=new e.bkB,this.option_state={},this.code=this._data.code;const T=(0,O.Am)(this._data.options.map(h=>h.group||"Other")),l=[];for(const h of T){const r=this._data.options.filter(v=>v.group===h);l.push({name:h,multiple:!!r.find(v=>v.multiple),options:r})}this.groups=l}updateGroupOption(p,T){for(const l of p.options)this.option_state[l.id]=l.id===T}saveOptions(){const p=this._data.options.filter(T=>this.option_state[T.id]);this.event.emit({reason:"done",metadata:{options:p}})}static#t=this.\u0275fac=function(T){return new(T||u)(e.rXU(t.Vh))};static#e=this.\u0275cmp=e.VBU({type:u,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["multi_options",""],["icon","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-base-200",4,"ngFor","ngForOf"],[1,"p-2"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-base-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModelChange","ngModel"]],template:function(T,l){1&T&&(e.j41(0,"header")(1,"h3"),e.EFF(2,"Select options"),e.k0s(),e.j41(3,"button",1)(4,"app-icon"),e.EFF(5,"close"),e.k0s()()(),e.j41(6,"main",2),e.DNE(7,y,7,4,"div",3),e.k0s(),e.j41(8,"footer",4)(9,"button",5),e.bIt("click",function(){return l.saveOptions()}),e.EFF(10," Save "),e.k0s()()),2&T&&(e.R7$(7),e.Y8G("ngForOf",l.groups))},dependencies:[n.Sq,n.bT,t.tx,j.So,i.VT,i._g,G.BC,G.vS,A.R,R.r6,n.oe],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--55.css.map*/"]})}return u})()},98832:(Y,N,o)=>{o.d(N,{l:()=>T});var e=o(89204),t=o(82333),O=o(98197),j=(o(75555),o(91074)),i=o(68559),G=o(60316),A=o(31034),R=o(80640),L=o(69434),x=o(85060),F=o(3872);function C(l,h){1&l&&(i.j41(0,"span",21),i.EFF(1," No Location "),i.k0s())}function D(l,h){1&l&&(i.j41(0,"span",21),i.EFF(1," Unknown Host "),i.k0s())}function I(l,h){if(1&l&&(i.j41(0,"button",22),i.EFF(1," View "),i.k0s()),2&l){const r=i.XpG(2);i.Y8G("matTooltip",r.order.notes)}}function y(l,h){1&l&&(i.j41(0,"span",21),i.EFF(1," No Invoice "),i.k0s())}function P(l,h){if(1&l){const r=i.RV6();i.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),i.EFF(4,"room_service"),i.k0s()()(),i.j41(5,"div",7),i.EFF(6),i.nI1(7,"date"),i.k0s(),i.j41(8,"div",8),i.EFF(9),i.nI1(10,"date"),i.nI1(11,"date"),i.nrm(12,"br"),i.EFF(13),i.nI1(14,"date"),i.nI1(15,"date"),i.k0s(),i.j41(16,"div",9),i.EFF(17),i.DNE(18,C,2,0,"span",10),i.k0s(),i.j41(19,"div",11),i.EFF(20),i.DNE(21,D,2,0,"span",10),i.k0s(),i.j41(22,"div",12),i.EFF(23),i.k0s(),i.j41(24,"div",13),i.DNE(25,I,2,1,"button",14),i.k0s(),i.j41(26,"div",12),i.EFF(27),i.DNE(28,y,2,0,"span",10),i.k0s(),i.j41(29,"div",15)(30,"button",16)(31,"div",17),i.EFF(32),i.k0s(),i.j41(33,"app-icon",18),i.EFF(34,"arrow_drop_down"),i.k0s()()(),i.j41(35,"div",19)(36,"button",20),i.bIt("click",function(){i.eBV(r);const f=i.XpG();return i.Njj(f.show_items=!f.show_items)}),i.j41(37,"app-icon"),i.EFF(38),i.k0s()()()()}if(2&l){const r=i.XpG(),v=i.sdS(3);i.AVh("bg-base-200",!r.show_items)("bg-base-200",r.show_items),i.R7$(),i.AVh("bg-base-200",r.show_items)("dark:bg-neutral-700",r.show_items),i.R7$(5),i.SpI(" ",i.i5U(7,26,r.order.deliver_at,r.time_format)," "),i.R7$(3),i.Lme(" ",i.i5U(10,29,null==r.order.event?null:r.order.event.date,"MMM d"),", ",i.i5U(11,32,null==r.order.event?null:r.order.event.date,r.time_format)," "),i.R7$(4),i.Lme(" ",i.i5U(14,35,null==r.order.event?null:r.order.event.date_end,"MMM d"),", ",i.i5U(15,38,null==r.order.event?null:r.order.event.date_end,r.time_format)," "),i.R7$(4),i.SpI(" ",(null==r.order.event||null==r.order.event.space?null:r.order.event.space.display_name)||(null==r.order.event||null==r.order.event.space?null:r.order.event.space.name)||""," "),i.R7$(),i.Y8G("ngIf",!(null!=r.order.event&&null!=r.order.event.space&&r.order.event.space.display_name||null!=r.order.event&&null!=r.order.event.space&&r.order.event.space.name)),i.R7$(2),i.SpI(" ",(null==r.order.event||null==r.order.event.organiser?null:r.order.event.organiser.name)||(null==r.order.event?null:r.order.event.host)||""," "),i.R7$(),i.Y8G("ngIf",!(null!=r.order.event&&null!=r.order.event.organiser&&r.order.event.organiser.name||null!=r.order.event&&r.order.event.host)),i.R7$(2),i.JRh(r.order.charge_code||"~ No Code ~"),i.R7$(2),i.Y8G("ngIf",r.order.notes),i.R7$(2),i.SpI(" ",r.order.invoice_number||""," "),i.R7$(),i.Y8G("ngIf",!r.order.invoice_number),i.R7$(2),i.xc7("background",null==r.status?null:r.status.colour),i.Y8G("matMenuTriggerFor",v),i.R7$(2),i.SpI(" ",null==r.status?null:r.status.name," "),i.R7$(6),i.JRh(r.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function u(l,h){if(1&l&&i.nrm(0,"li",25),2&l){const r=h.$implicit,v=i.XpG(2);i.Y8G("order_id",null==v.order?null:v.order.id)("item",r)}}function b(l,h){if(1&l&&(i.j41(0,"ul",23),i.DNE(1,u,1,2,"li",24),i.k0s()),2&l){const r=i.XpG();i.AVh("shown",r.show_items),i.Y8G("@show",r.show_items?"show":"hide"),i.R7$(),i.Y8G("ngForOf",r.order.items)}}function p(l,h){if(1&l){const r=i.RV6();i.j41(0,"button",26),i.bIt("click",function(){const f=i.eBV(r).$implicit,U=i.XpG();return i.Njj(U.updateStatus(f.id))}),i.nrm(1,"div",27),i.j41(2,"span",28),i.EFF(3),i.k0s()()}if(2&l){const r=h.$implicit;i.R7$(),i.xc7("background-color",r.colour),i.R7$(2),i.JRh(r.name)}}let T=(()=>{class l extends t.Tv{get status(){return this.statuses.find(r=>r.id===this.order.status)}get time_format(){return this._settings.time_format}constructor(r,v){var f;super(),f=this,this._orders=r,this._settings=v,this.show_items=!1,this.statuses=j.T,this.updateStatus=function(){var U=(0,e.A)(function*(W){yield f._orders.updateStatus(f.order,W),f.timeout("status-change",()=>f.order.status=W)});return function(W){return U.apply(this,arguments)}}()}static#t=this.\u0275fac=function(v){return new(v||l)(i.rXU(O.Q),i.rXU(t.h$))};static#e=this.\u0275cmp=i.VBU({type:l,selectors:[["catering-order"]],inputs:{order:"order"},features:[i.Vt3],decls:5,vars:3,consts:[["menu","matMenu"],["class","w-full flex items-center py-2",3,"bg-base-200",4,"ngIf"],["class","list-none p-0 m-0 w-full relative z-0",3,"shown",4,"ngIf"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2"],[1,"w-20","flex","items-center","justify-center","z-20","h-full"],[1,"rounded-full","bg-base-300","p-2","text-2xl","text-black","opacity-60","flex","items-center","justify-center"],["time","",1,"w-24"],["time","",1,"w-36","text-sm"],[1,"flex-1"],["class","opacity-30",4,"ngIf"],[1,"w-56"],[1,"w-28"],[1,"w-24"],["class","clear underline",3,"matTooltip",4,"ngIf"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["icon","",3,"click"],[1,"opacity-30"],[1,"clear","underline",3,"matTooltip"],[1,"list-none","p-0","m-0","w-full","relative","z-0"],["catering-order-item","","class","flex items-center",3,"order_id","item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"order_id","item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(v,f){1&v&&(i.DNE(0,P,39,41,"div",1)(1,b,2,4,"ul",2),i.j41(2,"mat-menu",null,0),i.DNE(4,p,4,3,"button",3),i.k0s()),2&v&&(i.Y8G("ngIf",f.order),i.R7$(),i.Y8G("ngIf",null==f.order?null:f.order.items.length),i.R7$(3),i.Y8G("ngForOf",f.statuses))},dependencies:[G.Sq,G.bT,A.kk,A.fb,A.Cp,R.oV,L.R,x.r6,F.Q,G.vh],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}\n\n/*# sourceMappingURL=catering-order.component.ts-angular-inline--72.css.map*/"],data:{animation:[t.Ft]}})}return l})()},98197:(Y,N,o)=>{o.d(N,{Q:()=>T});var e=o(89204),t=o(90521),O=o(42175),n=o(71536),j=o(19803),i=o(71963),G=o(29314),A=o(35443),R=o(66e3),L=o(7841),x=o(67450),F=o(27419),C=o(13264),D=o(83866),I=o(82333),y=o(51416),P=o(6727),u=o(75555),b=o(68559);let T=(()=>{class l extends I.Tv{get filters(){return this._filters.getValue()}set filters(r){this._filters.next(r)}constructor(){super(),this._poll=new t.t(0),this._loading=new t.t(!1),this._filters=new t.t({}),this.orders=(0,O.zV)([this._filters,this._poll]).pipe((0,j.B)(1e3),(0,i.n)(([{date:r,zones:v}])=>{this._loading.next(!0);const f=(0,x.A)((0,F.A)(r||Date.now())),U=(0,x.A)((0,C.A)(r||Date.now()));return(0,y.UU)({zone_ids:(v||[]).join(","),period_start:f,period_end:U}).pipe((0,G.W)(()=>(0,n.of)([])),(0,A.T)(W=>(0,I.Bq)(W.map(m=>m.valid_catering.map(g=>new u.M({...g,event:m}))))),(0,A.T)(W=>W.filter(m=>(0,D.A)(m.deliver_at,"yyyy-MM-dd")===(0,D.A)(1e3*f,"yyyy-MM-dd"))))}),(0,R.M)(()=>this._loading.next(!1)),(0,L.t)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,A.T)(r=>r.filter(v=>function p(l,h){const r=(h.search||"").toLowerCase();return!!l.items.find(v=>v.name.toLowerCase().includes(r)||!!v.options.find(f=>f.name.toLowerCase().includes(r)))}(v,this._filters.getValue())).sort((v,f)=>v.deliver_at-f.deliver_at))),this.subscription("changes",this.orders.subscribe())}startPolling(r=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),r)}stopPolling(){this.clearInterval("polling")}updateStatus(r,v){var f=this;return(0,e.A)(function*(){r.status=v;const U=new u.M({...r,status:v,event:null}),W=[...(r.event.extension_data.catering||[]).filter(a=>a.id!==r.id),U].map(a=>new u.M({...a})),m=new P.L({...r.event,catering:W}),g=m?.resources[0]?.id||m?.system?.id,M=yield(0,y.zZ)(m.id,g,m.extension_data).toPromise();return f.timeout("refresh-list",()=>f._poll.next(Date.now()),1e3),r.status=v,M})()}static#t=this.\u0275fac=function(v){return new(v||l)};static#e=this.\u0275prov=b.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})()},52201:(Y,N,o)=>{o.d(N,{_:()=>f});var e=o(89204),t=o(3998),O=o(90521),n=o(42175),j=o(71536),i=o(8627),G=o(71963),A=o(29314),R=o(35443),L=o(66e3),x=o(7841),F=o(57871),C=o(33602),D=o(82333),I=o(12185),y=o(30807),P=o(37053),u=o(46815),b=o(25892),p=o(75555),T=o(82912),l=o(17707),h=o(76095),r=o(68559),v=o(12587);let f=(()=>{class U extends D.Tv{get is_editable(){return!this.zone||this.zone===this._org.building?.id}get categories(){const m=this._menu.getValue();return(0,D.Am)(m.map(g=>g.category))}constructor(m,g,M){var a;super(),a=this,this._org=m,this._dialog=g,this._settings=M,this._updated=new O.t(0),this._menu=new O.t([]),this._loading=new O.t(!1),this._currency=new O.t("USD"),this._change=new O.t(0),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.settings=(0,n.zV)([this._org.active_building,this._change]).pipe((0,i.p)(([E])=>!!E),(0,G.n)(([E])=>(0,t.bpY)(E.id,"catering-settings").pipe((0,A.W)(_=>(0,j.of)({})))),(0,R.T)(E=>E.details||{}),(0,L.M)(E=>this._settings.post("require_catering_notes",!!E?.require_notes)),(0,x.t)(1)),this.charge_codes=this.settings.pipe((0,R.T)(E=>E.charge_codes||[])),this.availability=this.settings.pipe((0,R.T)(E=>E.disabled_rooms||[])),this.zone="",this.subscription("building",this._org.active_building.subscribe(function(){var E=(0,e.A)(function*(_){if(_){const c=(yield a.getCateringForZone(_.id)).map(s=>new b.T(s));a._currency.next(a._settings.get("app.currency")||_.currency||"USD"),a._menu.next(c)}});return function(_){return E.apply(this,arguments)}}()))}manageCateringOrder(m){var g=this;return(0,e.A)(function*(){const M=g._dialog.open(T.g,{data:{code:g._currency.getValue(),order:m,menu:g.menu,loading:g.loading,getCateringConfig:E=>g.getCateringConfig(E),selectOptions:E=>g.selectOptions(E)}}),a=yield Promise.race([M.componentInstance.event.pipe((0,F.$)(E=>"done"===E.reason)).toPromise(),M.afterClosed().toPromise()]);return M.close(),a?.metadata?.order||m})()}addItem(m=new b.T){var g=this;return(0,e.A)(function*(){const M=g._dialog.open(y.d,{data:{item:m,categories:g.categories}}),a=yield Promise.race([M.componentInstance.event.pipe((0,F.$)(c=>"done"===c.reason)).toPromise(),M.afterClosed().toPromise()]);if("done"!==a?.reason)return;const E=g._menu.getValue(),_=E.findIndex(c=>c.id===m.id);_>=0?E.splice(_,1,a.metadata.item):E.push(a.metadata.item),g.updateMenu(g._org.building.id,E).then(()=>{g._menu.next([...E]),M.close()},()=>M.componentInstance.loading=!1)})()}updateItem(m){const g=this._menu.getValue(),M=g.findIndex(a=>a.id===m.id);M>=0?g.splice(M,1,m):g.push(m),this.updateMenu(this._org.building.id,g).then(()=>this._menu.next([...g]))}addOption(m,g={}){var M=this;return(0,e.A)(function*(){const a=(0,D.Am)(m.options.map(d=>d.group)),E=M._dialog.open(P.e,{data:{parent:m,option:g,types:a}}),_=yield Promise.race([E.componentInstance.event.pipe((0,F.$)(d=>"done"===d.reason)).toPromise(),E.afterClosed().toPromise()]);if("done"!==_?.reason)return;const c=M._menu.getValue(),s=c.findIndex(d=>d.id===m.id);s>=0?c.splice(s,1,_.metadata.item):c.push(_.metadata.item),M.updateMenu(M._org.building.id,c).then(()=>{M._menu.next([...c]),E.close()},()=>E.componentInstance.loading=!1)})()}selectOptions(m){var g=this;return(0,e.A)(function*(){const M=g._dialog.open(l.C,{data:{code:g._currency.getValue(),options:m}}),a=yield Promise.race([M.componentInstance.event.pipe((0,F.$)(E=>"done"===E.reason)).toPromise(),M.afterClosed().toPromise()]);return"done"!==a?.reason?[]:(M.close(),a.metadata.options)})()}deleteItem(m){var g=this;return(0,e.A)(function*(){const M=yield(0,D.GE)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${m.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},g._dialog);if("done"!==M.reason)return;M.loading("Removing catering item...");const a=g._menu.getValue().filter(E=>m.id!==E.id);g.updateMenu(g._org.building.id,a).then(()=>{g._menu.next([...a]),M.close()},()=>M.loading(""))})()}deleteOption(m,g){var M=this;return(0,e.A)(function*(){const a=yield(0,D.GE)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${g.name}" from "${m.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},M._dialog);if("done"!==a.reason)return;a.loading("Removing catering item option...");const E=M._menu.getValue();E.splice(E.findIndex(_=>_.id===m.id),1,new b.T({...m,options:m.options.filter(_=>_.id!==g.id)})),M.updateMenu(M._org.building.id,E).then(()=>{M._menu.next([...E]),a.close()},()=>a.loading(""))})()}editConfig(){var m=this;return(0,e.A)(function*(){const g=yield m.getCateringConfig(m._org.building.id),{require_notes:M}=yield m.settings.pipe((0,C.s)(1)).toPromise(),a=m._menu.getValue(),E=(0,D.Am)((0,D.Bq)(a.map(s=>[s.category,...s.tags]))),_=m._dialog.open(u.Rt,{data:{config:g,types:E,require_notes:M,saveNotes:s=>m.saveSettings({require_notes:s})}}),c=yield Promise.race([_.componentInstance.event.pipe((0,F.$)(s=>"done"===s.reason)).toPromise(),_.afterClosed().toPromise()]);"done"===c?.reason&&m.updateConfig(m._org.building.id,c.metadata).then(()=>_.close(),()=>_.componentInstance.loading=!1)})()}importMenu(){var m=this;return(0,e.A)(function*(){const g=m._dialog.open(h.k),M=yield Promise.race([g.componentInstance.event.pipe((0,F.$)(c=>"done"===c.reason)).toPromise(),g.afterClosed().toPromise()]);if("done"!==M?.reason)return;g.componentInstance.loading="Updating menu...";const a=m._menu.getValue(),E=m._org.building,_=(0,D.Am)(M.metadata.concat(a),"id");yield m.updateMenu(E.id,_).catch(c=>{throw(0,D.UG)("Error importing catering menu"),g.close(),c}),(0,D.VX)(`Successfully imported catering menu. ${M.metadata.length} item(s) added.`),g.close()})()}updateMenu(m,g){return(0,t.D58)(m,{id:m,name:"catering",details:g,description:`Catering menu for ${m}`}).toPromise()}saveSettings(m){var g=this;return(0,e.A)(function*(){const M=yield g.settings.pipe((0,C.s)(1)).toPromise(),a=yield(0,t.D58)(g._org.building.id,{id:g._org.building.id,name:"catering-settings",details:{...M,...m},description:`Catering settings for ${g._org.building.id}`}).toPromise();return g._change.next(Date.now()),a})()}getCateringForZone(m){return(0,e.A)(function*(){const g=(yield(0,t.bpY)(m,"catering").toPromise()).details;return g instanceof Array?g:[]})()}getCateringConfig(m=this._org.building.id){return(0,e.A)(function*(){const g=(yield(0,t.bpY)(m,"catering_config").toPromise()).details;return g instanceof Array?g:[]})()}updateConfig(m,g){return(0,t.D58)(m,{id:m,name:"catering_config",details:g,description:`Catering menu config for ${m}`}).toPromise()}addItemToOrder(m,g){let M=m.items;const a=M.find(_=>_.id===g.id&&g.options?.length===_.options?.reduce((c,s)=>c+(g.options.find(d=>s.id===d.id)?1:0),0));return a?a.quantity+=1:M=M.concat([new b.T({...g,quantity:1})]),new p.M({...m,items:M,event:null})}static#t=this.\u0275fac=function(g){return new(g||U)(r.KVO(I.yb),r.KVO(v.bZ),r.KVO(D.h$))};static#e=this.\u0275prov=r.jDH({token:U,factory:U.\u0275fac,providedIn:"root"})}return U})()},91074:(Y,N,o)=>{o.d(N,{T:()=>e});const e=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map