"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{9364:(H,G,o)=>{o.d(G,{Ud:()=>Y.U,GX:()=>wt.G,Ii:()=>Bt.I,jW:()=>St.j,uy:()=>Ut});var n=o(4666),t=o(2508),E=o(8550),m=o(4792),l=o(1484),w=o(8589),F=o(5892),J=o(2922),P=o(6896),A=o(3723),e=(o(2090),o(6336),o(8644),o(8501),o(7413),o(4204),o(2189),o(9504),o(3129),o(961),o(5730),o(9112),o(6221),o(2560)),Y=(o(5306),o(4522),o(3690),o(4505),o(7716),o(9095),o(6942),o(7418),o(8759),o(9128),o(2962));o(1708),o(2581),o(2793),o(1670),o(3910);var rt=o(5074);o(1267),o(158);var Nt=o(9816);let Ut=(()=>{class d{}return d.\u0275fac=function(i){return new(i||d)},d.\u0275mod=e.oAB({type:d}),d.\u0275inj=e.cJS({imports:[n.ez,w.Tx,F.Nh,E.Bb,l.Is,m.p9,J.Fk,P.AV,t.u5,t.UX,A.K,rt.lN,Nt.W9]}),d})();var wt=o(5163),Bt=o(2851),St=o(729);o(7701),o(2460)},2090:(H,G,o)=>{o.d(G,{S:()=>M});var n=o(2560),t=o(1484),E=o(7701),m=o(4666),l=o(207),w=o(2508),F=o(5306),J=o(5074),P=o(7371),A=o(4522),R=o(1267);function h(v,_){1&v&&(n.TgZ(0,"button",5)(1,"app-icon"),n._uU(2,"close"),n.qZA()())}function D(v,_){if(1&v&&(n.TgZ(0,"mat-option",18),n._uU(1),n.qZA()),2&v){const p=_.$implicit;n.Q6J("value",p.id),n.xp6(1),n.hij(" ",p.name," ")}}function x(v,_){if(1&v){const p=n.EpF();n.TgZ(0,"div",14)(1,"mat-form-field",8)(2,"mat-select",15),n.NdJ("ngModelChange",function(s){const f=n.CHM(p).$implicit;return n.KtG(f[0]=s)}),n.YNc(3,D,2,2,"mat-option",16),n.qZA()(),n.TgZ(4,"mat-form-field",8)(5,"input",17),n.NdJ("ngModelChange",function(s){const f=n.CHM(p).$implicit;return n.KtG(f[1]=s)}),n.qZA(),n.TgZ(6,"mat-error"),n._uU(7,"Rule value is required"),n.qZA()(),n.TgZ(8,"button",10),n.NdJ("click",function(){const g=n.CHM(p).index,f=n.oxw().$implicit;return n.KtG(f.rules.splice(g,1))}),n.TgZ(9,"app-icon"),n._uU(10,"delete"),n.qZA()()()}if(2&v){const p=_.$implicit,r=n.oxw(2);n.xp6(2),n.Q6J("ngModel",p[0]),n.xp6(1),n.Q6J("ngForOf",r.rule_types),n.xp6(2),n.Q6J("ngModel",p[1])}}function C(v,_){if(1&v){const p=n.EpF();n.TgZ(0,"div",6)(1,"div",7)(2,"mat-form-field",8)(3,"input",9),n.NdJ("ngModelChange",function(s){const f=n.CHM(p).$implicit;return n.KtG(f.name=s)}),n.qZA(),n.TgZ(4,"mat-error"),n._uU(5,"Ruleset name is required"),n.qZA()(),n.TgZ(6,"button",10),n.NdJ("click",function(){const g=n.CHM(p).$implicit,f=n.oxw();return g.rules.push(["",""]),n.KtG(f.show_rules=g.id)}),n.TgZ(7,"app-icon"),n._uU(8,"add"),n.qZA()(),n.TgZ(9,"button",11),n.NdJ("click",function(){const g=n.CHM(p).$implicit,f=n.oxw();return n.KtG(f.show_rules=f.show_rules!==g.id?g.id:"")}),n.TgZ(10,"app-icon"),n._uU(11),n.qZA()(),n.TgZ(12,"button",10),n.NdJ("click",function(){const g=n.CHM(p).index,f=n.oxw();return n.KtG(f.rulesets.splice(g,1))}),n.TgZ(13,"app-icon"),n._uU(14,"delete"),n.qZA()()(),n.TgZ(15,"div",12),n.YNc(16,x,11,3,"div",13),n.qZA()()}if(2&v){const p=_.$implicit,r=n.oxw();n.xp6(3),n.Q6J("ngModel",p.name),n.xp6(6),n.Q6J("disabled",!p.rules.length),n.xp6(2),n.Oqu(r.show_rules===p.id?"expand_less":"expand_more"),n.xp6(4),n.Udp("height",(r.show_rules===p.id?5*p.rules.length:0)+"em"),n.xp6(1),n.Q6J("ngForOf",p.rules)}}let M=(()=>{class v{constructor(p){this._data=p,this.event=new n.vpe,this.loading=!1,this.rule_types=E.g,this.rulesets=(p.config||[]).map(r=>(r.rules=r.rules.map(s=>[s[0],JSON.stringify(s[1])]),r))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const p=this.rulesets.map(r=>({...r,rules:r.rules.map(s=>{let g=s[1];try{g=JSON.parse(s[1])}catch{}return[s[0],g]})}));this.event.emit({reason:"done",metadata:p})}}return v.\u0275fac=function(p){return new(p||v)(n.Y36(t.WI))},v.\u0275cmp=n.Xpm({type:v,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex items-center px-2 h-20 space-x-2",4,"ngFor","ngForOf"],[1,"flex","items-center","px-2","h-20","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(p,r){1&p&&(n.TgZ(0,"header")(1,"h3"),n._uU(2,"Edit Catering Configuration"),n.qZA(),n.YNc(3,h,3,0,"button",0),n.qZA(),n.TgZ(4,"main",1)(5,"button",2),n.NdJ("click",function(){return r.rulesets.push({id:r.new_id,rules:[]})}),n._uU(6," New Ruleset "),n.qZA(),n.YNc(7,C,17,6,"div",3),n.qZA(),n.TgZ(8,"footer",4)(9,"button",2),n.NdJ("click",function(){return r.saveChanges()}),n._uU(10,"Save Changes"),n.qZA()()),2&p&&(n.xp6(3),n.Q6J("ngIf",!r.loading),n.xp6(4),n.Q6J("ngForOf",r.rulesets))},dependencies:[m.sg,m.O5,l.ey,t.ZT,w.Fj,w.JJ,w.Q7,w.On,F.o,J.TO,J.KE,P.gD,A.lW,R.Nt],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}\n/*# sourceMappingURL=catering-config-modal.component.ts-angular-inline--101.css.map*/"]}),v})()},5730:(H,G,o)=>{o.d(G,{m:()=>h});var n=o(2560),t=o(9112),E=o(2962),m=o(4666),l=o(1484),w=o(5306),F=o(4522),J=o(1708);function P(D,x){1&D&&(n.TgZ(0,"button",4)(1,"app-icon"),n._uU(2,"close"),n.qZA()())}function A(D,x){if(1&D){const C=n.EpF();n.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),n._uU(3,"upload"),n.qZA(),n.TgZ(4,"p"),n._uU(5,"Click to select file or Drag and drop files"),n.qZA(),n.TgZ(6,"input",7),n.NdJ("change",function(v){n.CHM(C);const _=n.oxw();return n.KtG(_.handleFileEvent(v))}),n.qZA()(),n.TgZ(7,"div",8)(8,"button",9),n.NdJ("click",function(){n.CHM(C);const v=n.oxw();return n.KtG(v.downloadTemplate())}),n._uU(9," Download Template "),n.qZA()()()}}function R(D,x){if(1&D&&(n.TgZ(0,"main",10),n._UZ(1,"mat-spinner",11),n.TgZ(2,"p"),n._uU(3),n.qZA()()),2&D){const C=n.oxw();n.xp6(3),n.Oqu(C.loading)}}let h=(()=>{class D{constructor(){this.event=new n.vpe}handleFileEvent(C){this.loading="Processing menu data...";const M=C.target;if(!M?.files)return this.loading="";const v=M.files;if(!v.length)return this.loading="";const _=v[0],p=new FileReader;p.addEventListener("loadend",r=>{const g=(0,t.n5)(r.target.result);this.loading="",this.event.emit({reason:"done",metadata:g.filter(f=>"item"===(f.type||"").toLowerCase()).map(f=>new E.U({...f,options:g.filter(e=>"option"===(e.type||"").toLowerCase()&&e.tags===f.id).map(e=>({id:e.id,name:e.name,group:e.category,multiple:e.multiple,unit_price:e.unit_price}))}))})}),p.readAsText(_)}downloadTemplate(){(0,t.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return D.\u0275fac=function(C){return new(C||D)},D.\u0275cmp=n.Xpm({type:D,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["mat-button","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(C,M){if(1&C&&(n.TgZ(0,"header",0)(1,"h2"),n._uU(2,"Import Catering Menu"),n.qZA(),n.YNc(3,P,3,0,"button",1),n.qZA(),n.YNc(4,A,10,0,"main",2),n.YNc(5,R,4,1,"ng-template",null,3,n.W1O)),2&C){const v=n.MAs(6);n.xp6(3),n.Q6J("ngIf",!M.loading),n.xp6(1),n.Q6J("ngIf",!M.loading)("ngIfElse",v)}},dependencies:[m.O5,l.ZT,w.o,F.lW,J.Ou]}),D})()},6336:(H,G,o)=>{o.d(G,{w:()=>et});var n=o(8456),t=o(2560),E=o(2508),m=o(1484),l=o(9112),w=o(2962),F=o(4666),J=o(8550),P=o(207),A=o(4792),R=o(5306),h=o(5074),D=o(4522),x=o(1267),C=o(1708),M=o(1169),v=o(2793);function _(U,k){1&U&&(t.TgZ(0,"button",7)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function p(U,k){if(1&U&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",18),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA()()()),2&U){const O=t.oxw(2);t.xp6(1),t.ekj("error",O.form.controls.name.invalid&&O.form.controls.name.touched)}}function r(U,k){if(1&U&&(t.TgZ(0,"div",15)(1,"label",19),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA()()()),2&U){const O=t.oxw(2),K=t.MAs(9);t.xp6(1),t.ekj("error",O.form.controls.category.invalid&&O.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",K)}}const s=function(){return{class:"material-icons",content:"close"}};function g(U,k){if(1&U){const O=t.EpF();t.TgZ(0,"mat-chip",27),t.NdJ("removed",function(){const X=t.CHM(O).$implicit,nt=t.oxw(3);return t.KtG(nt.removeTag(X))}),t._uU(1),t._UZ(2,"app-icon",28),t.qZA()}if(2&U){const O=k.$implicit;t.Q6J("selectable",!0)("removable",!0),t.xp6(1),t.hij(" ",O," "),t.xp6(1),t.Q6J("icon",t.DdM(4,s))}}function f(U,k){if(1&U){const O=t.EpF();t.TgZ(0,"div",15)(1,"label",21),t.SDv(2,22),t.qZA(),t.TgZ(3,"mat-form-field",17)(4,"mat-chip-list",23,24),t.YNc(6,g,3,5,"mat-chip",25),t.TgZ(7,"input",26),t.NdJ("matChipInputTokenEnd",function(Y){t.CHM(O);const X=t.oxw(2);return t.KtG(X.addTag(Y))}),t.qZA()()()()}if(2&U){const O=t.MAs(5),K=t.oxw(2);t.xp6(1),t.ekj("error",K.form.controls.tags.invalid&&K.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",K.tag_list),t.xp6(1),t.Q6J("matChipInputFor",O)("matChipInputSeparatorKeyCodes",K.separators)("matChipInputAddOnBlur",!0)}}function e(U,k){1&U&&(t.TgZ(0,"div",15)(1,"label",29),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",17),t._UZ(4,"textarea",30),t.qZA()())}function T(U,k){if(1&U&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",31),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA()()()),2&U){const O=t.oxw(2);t.xp6(1),t.ekj("error",O.form.controls.unit_price.invalid&&O.form.controls.unit_price.touched)}}function L(U,k){if(1&U&&(t.TgZ(0,"form",8),t.YNc(1,p,10,2,"div",9),t.YNc(2,r,10,3,"div",9),t.YNc(3,f,8,6,"div",9),t.YNc(4,e,5,0,"div",9),t.YNc(5,T,10,2,"div",9),t.TgZ(6,"div",10)(7,"label",11),t._uU(8,"Accept Points?"),t.qZA(),t.TgZ(9,"mat-checkbox",12),t._uU(10),t.qZA()(),t.TgZ(11,"div",10)(12,"label",13),t._uU(13,"Discount Cap"),t.qZA(),t._UZ(14,"a-counter",14),t.qZA()()),2&U){const O=t.oxw();let K;t.Q6J("formGroup",O.form),t.xp6(1),t.Q6J("ngIf",O.form.controls.name),t.xp6(1),t.Q6J("ngIf",O.form.controls.category),t.xp6(1),t.Q6J("ngIf",O.form.controls.tags),t.xp6(1),t.Q6J("ngIf",O.form.controls.description),t.xp6(1),t.Q6J("ngIf",O.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(K=O.form.get("accept_points"))&&K.value?"No":"Yes"),t.xp6(4),t.Q6J("min",0)("max",100)("step",5)("render_fn",O.renderPercent)}}function N(U,k){if(1&U){const O=t.EpF();t.TgZ(0,"footer",32)(1,"button",33),t.NdJ("click",function(){t.CHM(O);const Y=t.oxw();return t.KtG(Y.saveChanges())}),t._uU(2," Save "),t.qZA()()}if(2&U){const O=t.oxw();t.xp6(1),t.Q6J("disabled",!O.form.dirty)}}function $(U,k){1&U&&(t.TgZ(0,"div",34),t._UZ(1,"mat-spinner",35),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA()())}function V(U,k){if(1&U&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&U){const O=k.$implicit;t.Q6J("value",O),t.xp6(1),t.hij(" ",O," ")}}let et=(()=>{class U{constructor(O){this._data=O,this.event=new t.vpe,this.form=new E.cw({name:new E.NI(this.item.name||"",[E.kI.required]),description:new E.NI(this.item.description||""),category:new E.NI(this.item.category||"",[E.kI.required]),unit_price:new E.NI(this.item.unit_price,[E.kI.required]),tags:new E.NI(this.item.tags||[]),accept_points:new E.NI(this.item.accept_points||!1),discount_cap:new E.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[n.K5,n.OC,n.L_]}get item(){return this._data.item||new w.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(O=0){return`${O}%`}addTag(O){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const K=O.input,Y=O.value,X=this.tag_list;(Y||"").trim()&&(X.push(Y),this.form.controls.tags.setValue(X)),K&&(K.value="")}removeTag(O){if(!this.form||!this.form.controls.tags)return;const K=this.tag_list;this.form.controls.tags.markAsDirty();const Y=K.indexOf(O);Y>=0&&(K.splice(Y,1),this.form.controls.tags.setValue(K))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new w.U({...this.item,id:this.item.id||`item-${(0,l.Iy)(99999999)}`,...this.form.value})}})}}return U.\u0275fac=function(O){return new(O||U)(t.Y36(m.WI))},U.\u0275cmp=t.Xpm({type:U,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let k,O;return k=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,O=$localize`:@@zoneTagsPlaceholder␟8dc7c13b0c6b8ad9c770bce0ad72e14b4aef8456␟3986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],k,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",O,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(O,K){if(1&O&&(t.TgZ(0,"header")(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,_,3,0,"button",1),t.qZA(),t.YNc(4,L,15,11,"form",2),t.YNc(5,N,3,1,"footer",3),t.YNc(6,$,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,V,2,2,"mat-option",6),t.qZA()),2&O){const Y=t.MAs(7);t.xp6(2),t.hij("",K.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!K.loading),t.xp6(1),t.Q6J("ngIf",K.form&&!K.loading)("ngIfElse",Y),t.xp6(1),t.Q6J("ngIf",!K.loading),t.xp6(5),t.Q6J("ngForOf",K.categories)}},dependencies:[F.sg,F.O5,J.XC,J.ZL,P.ey,m.ZT,m.uh,A.oG,E._Y,E.Fj,E.wV,E.JJ,E.JL,E.sg,E.u,R.o,h.TO,h.KE,D.lW,x.Nt,C.Ou,M.qn,M.HS,M.oH,M.qH,v.R],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--102.css.map*/"]}),U})()},8644:(H,G,o)=>{o.d(G,{V:()=>R});var n=o(729),t=o(2560),E=o(4666),m=o(8589),l=o(5306),w=o(4522);const F=["catering-menu-item",""];function J(h,D){if(1&h){const x=t.EpF();t.TgZ(0,"div",6)(1,"div",7)(2,"div",8)(3,"div"),t._uU(4),t.qZA(),t.TgZ(5,"div",9),t._uU(6),t.qZA()(),t.TgZ(7,"div",10),t._uU(8),t.ALo(9,"currency"),t.ALo(10,"async"),t.qZA()(),t.TgZ(11,"button",11)(12,"app-icon"),t._uU(13,"more_vert"),t.qZA()(),t.TgZ(14,"button",12),t.NdJ("click",function(){t.CHM(x);const M=t.oxw();return t.KtG(M.show_options=!M.show_options)}),t.TgZ(15,"app-icon"),t._uU(16,"expand_more"),t.qZA()()()}if(2&h){const x=t.oxw(),C=t.MAs(4);t.xp6(4),t.Oqu(x.item.name),t.xp6(2),t.hij(" ",x.item.category," "),t.xp6(2),t.hij(" ",t.xi3(9,5,x.item.unit_price/100,t.lcZ(10,8,x.symbol))," "),t.xp6(3),t.Q6J("matMenuTriggerFor",C),t.xp6(3),t.Q6J("disabled",!x.item.options.length)}}function P(h,D){if(1&h){const x=t.EpF();t.TgZ(0,"div",15),t._UZ(1,"div",16),t.TgZ(2,"div",17)(3,"div",18),t._uU(4),t.qZA(),t.TgZ(5,"div",9),t._uU(6),t.qZA()(),t.TgZ(7,"button",19),t.NdJ("click",function(){const v=t.CHM(x).$implicit,_=t.oxw(2);return t.KtG(_.editOption(v))}),t.TgZ(8,"app-icon"),t._uU(9,"edit"),t.qZA()(),t.TgZ(10,"button",20),t.NdJ("click",function(){const v=t.CHM(x).$implicit,_=t.oxw(2);return t.KtG(_.removeOption(v))}),t.TgZ(11,"app-icon"),t._uU(12,"delete"),t.qZA()()()}if(2&h){const x=D.$implicit;t.xp6(4),t.Oqu(x.name),t.xp6(2),t.hij(" ",x.group," ")}}function A(h,D){if(1&h&&(t.TgZ(0,"div",13),t.YNc(1,P,13,2,"div",14),t.qZA()),2&h){const x=t.oxw();t.Udp("height",x.show_options?3.5*x.item.options.length+"rem":"0"),t.xp6(1),t.Q6J("ngForOf",x.item.options)}}let R=(()=>{class h{constructor(x){this._catering=x,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=C=>this._catering.addOption(this.item,C),this.removeOption=C=>this._catering.deleteOption(this.item,C),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}get symbol(){return this._catering.currency}}return h.\u0275fac=function(x){return new(x||h)(t.Y36(n.j))},h.\u0275cmp=t.Xpm({type:h,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:F,decls:20,vars:2,consts:[[1,"w-full","h-full","bg-white","dark:bg-neutral-700","border","border-gray-300","dark:border-neutral-500","overflow-hidden","rounded"],["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-gray-100 dark:bg-neutral-700 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","opacity-60"],[1,"p-2","m-2","text-xs","font-bold","text-white","rounded","bg-primary"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-icon-button","",3,"disabled","click"],["options","",1,"bg-gray-100","dark:bg-neutral-700","overflow-hidden"],["class","flex p-2 items-center border-t border-solid border-gray-300 dark:border-neutral-500 relative",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-t","border-solid","border-gray-300","dark:border-neutral-500","relative"],[1,"absolute","inset-y-0","left-0","w-2","bg-gray-400","dark:bg-neutral-600"],[1,"flex-1","pl-4","pr-2"],[1,"text"],["edit","","mat-icon-button","",1,"mx-2",3,"click"],["remove","","mat-icon-button","",1,"mx-2",3,"click"]],template:function(x,C){1&x&&(t.TgZ(0,"div",0),t.YNc(1,J,17,10,"div",1),t.YNc(2,A,2,3,"div",2),t.TgZ(3,"mat-menu",null,3)(5,"button",4),t.NdJ("click",function(){return C.addOption()}),t.TgZ(6,"app-icon"),t._uU(7,"add"),t.qZA(),t.TgZ(8,"div",5),t._uU(9,"Add Option"),t.qZA()(),t.TgZ(10,"button",4),t.NdJ("click",function(){return C.editItem()}),t.TgZ(11,"app-icon"),t._uU(12,"edit"),t.qZA(),t.TgZ(13,"div",5),t._uU(14,"Edit Item"),t.qZA()(),t.TgZ(15,"button",4),t.NdJ("click",function(){return C.removeItem()}),t.TgZ(16,"app-icon"),t._uU(17,"delete"),t.qZA(),t.TgZ(18,"div",5),t._uU(19,"Remove Item"),t.qZA()()()()),2&x&&(t.xp6(1),t.Q6J("ngIf",C.item),t.xp6(1),t.Q6J("ngIf",C.item))},dependencies:[E.sg,E.O5,m.VK,m.OP,m.p6,l.o,w.lW,E.Ov,E.H9],styles:["[_nghost-%COMP%]{overflow:hidden;width:768px;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=catering-menu-item.component.ts-angular-inline--106.css.map*/"]}),h})()},8501:(H,G,o)=>{o.d(G,{B:()=>x});var n=o(4505),t=o(6942),E=o(729),m=o(2560),l=o(4666),w=o(5892),F=o(5306),J=o(8644);function P(C,M){if(1&C&&(m.ynx(0),m._UZ(1,"div",6),m.BQk()),2&C){const v=M.$implicit;m.xp6(1),m.Q6J("item",v)}}function A(C,M){if(1&C&&(m.ynx(0),m.YNc(1,P,2,1,"ng-container",5),m.ALo(2,"async"),m.BQk()),2&C){const v=m.oxw();m.xp6(1),m.Q6J("ngForOf",m.lcZ(2,1,v.menu))}}function R(C,M){if(1&C&&(m.ynx(0),m._UZ(1,"div",6),m.BQk()),2&C){const v=M.$implicit;m.xp6(1),m.Q6J("item",v)}}function h(C,M){if(1&C&&(m.TgZ(0,"mat-tab",7),m.YNc(1,R,2,1,"ng-container",5),m.ALo(2,"async"),m.qZA()),2&C){const v=M.$implicit,_=m.oxw();m.Q6J("label",v),m.xp6(1),m.Q6J("ngForOf",m.lcZ(2,2,_.tab_menu)[v])}}function D(C,M){1&C&&(m.TgZ(0,"div",8)(1,"app-icon"),m._uU(2,"close"),m.qZA(),m.TgZ(3,"p"),m._uU(4,"No items in menu"),m.qZA()())}let x=(()=>{class C{constructor(v){this._catering=v,this.menu=this._catering.menu,this.shown_tab=new n.X(""),this.tab_menu=this.menu.pipe((0,t.U)(_=>{const p={};for(const r of this.categories)p[r]=_.filter(s=>s.category===r);return p}))}get categories(){return this._catering.categories}}return C.\u0275fac=function(v){return new(v||C)(m.Y36(E.j))},C.\u0275cmp=m.Xpm({type:C,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(v,_){if(1&v&&(m.TgZ(0,"mat-tab-group",0),m.NdJ("selectedIndexChange",function(r){return _.shown_tab.next(0===r?"":_.categories[r-1])}),m.TgZ(1,"mat-tab",1),m.YNc(2,A,3,3,"ng-container",2),m.ALo(3,"async"),m.qZA(),m.YNc(4,h,3,4,"mat-tab",3),m.qZA(),m.YNc(5,D,5,0,"ng-template",null,4,m.W1O)),2&v){const p=m.MAs(6);let r;m.xp6(2),m.Q6J("ngIf",null==(r=m.lcZ(3,3,_.menu))?null:r.length)("ngIfElse",p),m.xp6(2),m.Q6J("ngForOf",_.categories)}},dependencies:[l.sg,l.O5,w.SP,w.uX,F.o,J.V,l.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--107.css.map*/"]}),C})()},7413:(H,G,o)=>{o.d(G,{M:()=>e});var n=o(2560),t=o(2508),E=o(1484),m=o(3245),l=o(2962),w=o(4666),F=o(8550),J=o(207),P=o(4792),A=o(5306),R=o(5074),h=o(4522),D=o(1267),x=o(1708);function C(T,L){1&T&&(n.TgZ(0,"button",7)(1,"app-icon"),n._uU(2,"close"),n.qZA()())}function M(T,L){if(1&T&&(n.TgZ(0,"div",10)(1,"label",11),n._uU(2," Name"),n.TgZ(3,"span"),n._uU(4,"*"),n.qZA(),n._uU(5,": "),n.qZA(),n.TgZ(6,"mat-form-field",12),n._UZ(7,"input",13),n.TgZ(8,"mat-error"),n._uU(9,"Name is required"),n.qZA()()()),2&T){const N=n.oxw(2);n.xp6(1),n.ekj("error",N.form.controls.name.invalid&&N.form.controls.name.touched)}}function v(T,L){if(1&T&&(n.TgZ(0,"div",10)(1,"label",14),n._uU(2," Type"),n.TgZ(3,"span"),n._uU(4,"*"),n.qZA(),n._uU(5,": "),n.qZA(),n.TgZ(6,"mat-form-field",12),n._UZ(7,"input",15),n.TgZ(8,"mat-error"),n._uU(9,"Type is required"),n.qZA()()()),2&T){const N=n.oxw(2),$=n.MAs(9);n.xp6(1),n.ekj("error",N.form.controls.group.invalid&&N.form.controls.group.touched),n.xp6(6),n.Q6J("matAutocomplete",$)}}function _(T,L){1&T&&(n.TgZ(0,"div",10)(1,"label",11),n._uU(2,"Unit Price:"),n.qZA(),n.TgZ(3,"mat-form-field",12),n._UZ(4,"input",16),n.qZA()())}function p(T,L){1&T&&(n.TgZ(0,"div",10)(1,"mat-checkbox",17),n._uU(2," Can select multiple of type "),n.qZA()())}function r(T,L){if(1&T&&(n.TgZ(0,"form",8),n.YNc(1,M,10,2,"div",9),n.YNc(2,v,10,3,"div",9),n.YNc(3,_,5,0,"div",9),n.YNc(4,p,3,0,"div",9),n.qZA()),2&T){const N=n.oxw();n.Q6J("formGroup",N.form),n.xp6(1),n.Q6J("ngIf",N.form.controls.name),n.xp6(1),n.Q6J("ngIf",N.form.controls.group),n.xp6(1),n.Q6J("ngIf",N.form.controls.unit_price),n.xp6(1),n.Q6J("ngIf",N.form.controls.multiple)}}function s(T,L){if(1&T){const N=n.EpF();n.TgZ(0,"footer",18)(1,"button",19),n.NdJ("click",function(){n.CHM(N);const V=n.oxw();return n.KtG(V.saveChanges())}),n._uU(2," Save "),n.qZA()()}if(2&T){const N=n.oxw();n.xp6(1),n.Q6J("disabled",!N.form.dirty)}}function g(T,L){1&T&&(n.TgZ(0,"div",20),n._UZ(1,"mat-spinner",21),n.TgZ(2,"p"),n._uU(3,"Saving catering item option..."),n.qZA()())}function f(T,L){if(1&T&&(n.TgZ(0,"mat-option",22),n._uU(1),n.qZA()),2&T){const N=L.$implicit;n.Q6J("value",N),n.xp6(1),n.hij(" ",N," ")}}let e=(()=>{class T{constructor(N){this._data=N,this.event=new n.vpe,this.form=new t.cw({name:new t.NI(this.option.name||"",[t.kI.required]),group:new t.NI(this.option.group||"",[t.kI.required]),unit_price:new t.NI(this.option.unit_price),multiple:new t.NI(!!this.option.multiple,[])}),this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}saveChanges(){this.loading=!0;const N={...this.option,id:this.option.id||`option-${(0,m.Iy)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new l.U({...this._data.parent,options:this._data.parent.options.filter($=>$.id!==N.id).concat([N])})}})}}return T.\u0275fac=function(N){return new(N||T)(n.Y36(E.WI))},T.\u0275cmp=n.Xpm({type:T,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(N,$){if(1&N&&(n.TgZ(0,"header")(1,"h3",0),n._uU(2),n.qZA(),n.YNc(3,C,3,0,"button",1),n.qZA(),n.YNc(4,r,5,5,"form",2),n.YNc(5,s,3,1,"footer",3),n.YNc(6,g,4,0,"ng-template",null,4,n.W1O),n.TgZ(8,"mat-autocomplete",null,5),n.YNc(10,f,2,2,"mat-option",6),n.qZA()),2&N){const V=n.MAs(7);n.xp6(2),n.hij(" ",$.option.id?"Edit":"Add"," Item Option "),n.xp6(1),n.Q6J("ngIf",!$.loading),n.xp6(1),n.Q6J("ngIf",$.form&&!$.loading)("ngIfElse",V),n.xp6(1),n.Q6J("ngIf",!$.loading),n.xp6(5),n.Q6J("ngForOf",$.types)}},dependencies:[w.sg,w.O5,F.XC,F.ZL,J.ey,E.ZT,E.uh,P.oG,t._Y,t.Fj,t.wV,t.JJ,t.JL,t.sg,t.u,A.o,R.TO,R.KE,h.lW,D.Nt,x.Ou],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-option-modal.component.ts-angular-inline--103.css.map*/"]}),T})()},4204:(H,G,o)=>{o.d(G,{m:()=>P});var n=o(2560),t=o(4666),E=o(5306),m=o(4522);const l=["catering-order-item",""];function w(A,R){if(1&A&&(n.TgZ(0,"div",10),n._uU(1),n.qZA()),2&A){const h=n.oxw().$implicit;n.xp6(1),n.Oqu(h.name)}}function F(A,R){if(1&A&&(n.ynx(0),n.YNc(1,w,2,1,"div",9),n.BQk()),2&A){const h=R.$implicit;n.xp6(1),n.Q6J("ngIf",h)}}function J(A,R){if(1&A){const h=n.EpF();n.ynx(0),n.TgZ(1,"div",1),n._UZ(2,"div",2),n.qZA(),n.TgZ(3,"div",3)(4,"button",4),n.NdJ("click",function(){n.CHM(h);const x=n.oxw();return n.KtG(x.active=!x.active)}),n.TgZ(5,"app-icon"),n._uU(6),n.qZA()()(),n.TgZ(7,"div",5)(8,"div",6),n._uU(9),n.qZA(),n.TgZ(10,"div",7),n.YNc(11,F,2,1,"ng-container",8),n.qZA()(),n.BQk()}if(2&A){const h=n.oxw();n.xp6(4),n.ekj("bg-success",h.active)("text-white",h.active)("border-solid",h.active),n.xp6(2),n.Oqu(h.active?"done":"local_pizza"),n.xp6(3),n.Oqu(null==h.item?null:h.item.name),n.xp6(2),n.Q6J("ngForOf",h.item.options)}}let P=(()=>{class A{constructor(){this.active=!1}}return A.\u0275fac=function(h){return new(h||A)},A.\u0275cmp=n.Xpm({type:A,selectors:[["","catering-order-item",""]],inputs:{item:"item"},attrs:l,decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-20","text-right","h-14","relative"],[1,"border-b-2","border-l-2","border-gray-400","dark:border-neutral-500","w-4","h-16","absolute","top-1/2","left-1/2","-translate-y-full"],[1,"w-12","mr-4"],["action","","mat-icon-button","",1,"border","border-gray-300","dark:border-neutral-500","border-dashed","text-xl","text-dark-fade","p-2",3,"click"],[1,"flex","flex-1","border-b","border-gray-300","dark:border-neutral-500","border-solid","py-4"],[1,"flex-1"],[1,"flex","space-x-2","mr-2"],[4,"ngFor","ngForOf"],["class","text-xs py-1 px-2 bg-yellow-300 text-black rounded-2xl shadow",4,"ngIf"],[1,"text-xs","py-1","px-2","bg-yellow-300","text-black","rounded-2xl","shadow"]],template:function(h,D){1&h&&n.YNc(0,J,12,9,"ng-container",0),2&h&&n.Q6J("ngIf",D.item)},dependencies:[t.sg,t.O5,E.o,m.lW],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--108.css.map*/"]}),A})()},2189:(H,G,o)=>{o.d(G,{I:()=>J});var n=o(2851),t=o(2560),E=o(4666),m=o(961);function l(P,A){if(1&P&&(t.TgZ(0,"li",12),t._UZ(1,"catering-order",13),t.qZA()),2&P){const R=A.$implicit;t.xp6(1),t.Q6J("order",R)}}function w(P,A){1&P&&(t.TgZ(0,"div",14)(1,"p"),t._uU(2,"No Catering Orders"),t.qZA()())}function F(P,A){1&P&&t._UZ(0,"mat-progress-bar",15)}let J=(()=>{class P{constructor(R){this._orders=R,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(R,h){return h?h.id:void 0}}return P.\u0275fac=function(R){return new(R||P)(t.Y36(n.I))},P.\u0275cmp=t.Xpm({type:P,selectors:[["catering-order-list"]],decls:22,vars:10,consts:[[1,"sticky","top-0","w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-gray-300","bg-white","dark:bg-neutral-800","dark:border-neutral-500"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-gray-300 dark:border-neutral-500",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block opacity-60",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-gray-300","dark:border-neutral-500"],[3,"order"],["empty","",1,"info-block","opacity-60"],["mode","indeterminate",1,"w-full"]],template:function(R,h){if(1&R&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Time"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Location"),t.qZA(),t.TgZ(6,"div",4),t._uU(7,"Host"),t.qZA(),t.TgZ(8,"div",2),t._uU(9,"Charge Code"),t.qZA(),t.TgZ(10,"div",5),t._uU(11,"Invoice No."),t.qZA(),t.TgZ(12,"div",6),t._uU(13,"Status"),t.qZA(),t._UZ(14,"div",7),t.qZA(),t.TgZ(15,"ul",8),t.YNc(16,l,2,1,"li",9),t.ALo(17,"async"),t.YNc(18,w,3,0,"div",10),t.ALo(19,"async"),t.qZA(),t.YNc(20,F,1,0,"mat-progress-bar",11),t.ALo(21,"async")),2&R){let D;t.xp6(16),t.Q6J("ngForOf",t.lcZ(17,4,h.order_list))("ngForTrackBy",h.trackByFn),t.xp6(2),t.Q6J("ngIf",!(null!=(D=t.lcZ(19,6,h.order_list))&&D.length)),t.xp6(2),t.Q6J("ngIf",t.lcZ(21,8,h.loading))}},dependencies:[E.sg,E.O5,m.p,E.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--109.css.map*/"]}),P})()},9504:(H,G,o)=>{o.d(G,{W:()=>nt});var n=o(1670),t=o(2560),E=o(1484),m=o(1233),l=o(6119),w=o(475),F=o(9112),J=o(8025),P=o(2962),A=o(5163),R=o(6221),h=o(4666),D=o(5892),x=o(6896),C=o(2508),M=o(5306),v=o(4522),_=o(1708),p=o(2793);function r(I,j){1&I&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function s(I,j){if(1&I){const c=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(W){t.CHM(c);const S=t.oxw().$implicit,Q=t.oxw(5);return t.KtG(Q.updateItemQuantity(S,W))}),t.qZA()}if(2&I){const c=t.oxw().$implicit;t.Q6J("ngModel",c.quantity)}}function g(I,j){if(1&I){const c=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),t._uU(4,"remove"),t.qZA()()(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(c);const W=t.oxw().$implicit,S=t.oxw(5);return t.KtG(S.addItem(W))}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA()()()}if(2&I){const c=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",c.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",c.quantity," ")}}function f(I,j){if(1&I&&(t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,r,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,s,1,1,"a-counter",15),t.YNc(9,g,10,3,"div",16),t.qZA()),2&I){const c=j.$implicit,y=t.oxw(5);t.xp6(3),t.hij(" ",c.name," "),t.xp6(1),t.Q6J("ngIf",c.options.length),t.xp6(2),t.hij(" ",t.xi3(7,5,c.unit_price/100,y.code)," "),t.xp6(2),t.Q6J("ngIf",!c.options.length),t.xp6(1),t.Q6J("ngIf",c.options.length)}}const e=function(){return{}};function T(I,j){if(1&I&&(t.TgZ(0,"mat-tab",8)(1,"div",9),t.YNc(2,f,10,8,"div",10),t.qZA()()),2&I){const c=t.oxw().$implicit,y=t.oxw(3);t.Q6J("label",c),t.xp6(2),t.Q6J("ngForOf",(y.menu_items||t.DdM(2,e))[c])}}function L(I,j){if(1&I&&(t.ynx(0),t.YNc(1,T,3,3,"mat-tab",7),t.BQk()),2&I){const c=j.$implicit,y=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(y.menu_items||t.DdM(1,e))[c].length)}}function N(I,j){if(1&I&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,L,2,2,"ng-container",6),t.qZA(),t.BQk()),2&I){const c=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",c.categories)}}function $(I,j){if(1&I&&(t.TgZ(0,"div",4),t.YNc(1,N,3,1,"ng-container",5),t.qZA()),2&I){const c=t.oxw(),y=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!c.show_order_details)("ngIfElse",y)}}function V(I,j){if(1&I){const c=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){t.CHM(c);const W=t.oxw(2);return t.KtG(W.show_order_details=!0)}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&I){const c=t.oxw(2);t.xp6(3),t.Q6J("disabled",!c.order.item_count)("matBadge",c.order.item_count)("matBadgeHidden",!c.order.item_count)}}function et(I,j){if(1&I){const c=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(c);const W=t.oxw(2);return t.KtG(W.show_order_details=!1)}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){t.CHM(c);const W=t.oxw(2);return t.KtG(W.saveOrder())}),t._uU(3," Save Order "),t.qZA()}}function U(I,j){if(1&I&&(t.TgZ(0,"footer",24),t.YNc(1,V,5,3,"ng-container",5),t.YNc(2,et,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&I){const c=t.MAs(3),y=t.oxw();t.xp6(1),t.Q6J("ngIf",!y.show_order_details)("ngIfElse",c)}}function k(I,j){if(1&I&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&I){const c=t.oxw();t.xp6(3),t.Oqu(c.loading)}}function O(I,j){if(1&I&&(t.TgZ(0,"div",37),t._uU(1),t.qZA()),2&I){const c=t.oxw().$implicit,y=t.oxw(2);t.Q6J("matTooltip",y.optionsFor(c)),t.xp6(1),t.AsE(" ",c.options.length," option",1===c.options.length?"":"s"," selected ")}}function K(I,j){if(1&I){const c=t.EpF();t.TgZ(0,"div",34)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,O,2,3,"div",35),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",36),t.NdJ("ngModelChange",function(W){const Q=t.CHM(c).$implicit,q=t.oxw(2);return t.KtG(q.updateItemQuantity(Q,W))}),t.qZA()()}if(2&I){const c=j.$implicit,y=t.oxw(2);t.xp6(3),t.Oqu(c.name),t.xp6(1),t.Q6J("ngIf",c.options.length),t.xp6(2),t.hij(" ",t.xi3(7,4,c.total_cost/100,y.code)," "),t.xp6(2),t.Q6J("ngModel",c.quantity)}}function Y(I,j){if(1&I&&(t.TgZ(0,"header",32)(1,"h3"),t._uU(2,"Confirm Order"),t.qZA()(),t.TgZ(3,"div",9),t.YNc(4,K,9,7,"div",33),t.qZA()),2&I){const c=t.oxw();t.xp6(4),t.Q6J("ngForOf",c.order.items)}}function X(I,j,c){let y=!0;for(const W of j)if(I.category===W.name||I.tags.includes(W.name)||c.space?.zones.includes(W.name)||"*"===W.name){let S=0;for(const Q of W.rules){const q=new Date(c.date);switch(Q[0]){case"after_hour":S+=(0,m.Z)(q,(0,l.Z)(q,Q[1]))?1:0;break;case"before_hour":S+=(0,w.Z)(q,(0,l.Z)(q,Q[1]))?1:0;break;case"min_length":S+=c.duration>=(0,J.H1)(Q[1])?1:0;break;case"max_length":S+=c.duration<=(0,J.H1)(Q[1])?1:0;break;case"visitor_type":S+=c.ext("visitor_type")===Q[1]?1:0;break;default:S++}}y=S>=W.rules.length}return y}let nt=(()=>{class I extends F.KG{constructor(c,y){super(),this._org=c,this._data=y,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}get code(){return this._org.currency_code}ngOnInit(){var c=this;return(0,n.Z)(function*(){c.loading="Loading menu...",c.order=new A.G(c._data.order),c.rules=yield c._data.getCateringConfig(c.order.event?.space?.level?.parent_id),c._data.menu.subscribe(y=>{c.loading="Loading menu...";const W=(0,F.Tw)(y.map(Q=>Q.category)),S={};for(const Q of W)S[Q]=y.filter(q=>q.category===Q&&X(q,c.rules,c.order.event));c.categories=W,c.menu_items=S,c.updateMenuQuantities(),c.timeout("clear_loading",()=>c.loading="",1e3)})})()}addItem(c,y=!0){const W=this.order.items.find(S=>S.id===c.id&&S.options.length===S.options.reduce((Q,q)=>Q+(c.options.find(it=>q.id===it.id)?1:0),0));y&&c.options?.length?this._data.selectOptions(c.options).then(S=>{const Q=new P.U({...c,options:S});this.addItem(Q,!1)}):this.order=new A.G(W?{...this.order,items:this.order.items.filter(S=>!(S.id===c.id&&S.options_string===c.options_string)).concat([new P.U({...c,quantity:W.quantity+1})])}:{...this.order,items:this.order.items.concat([new P.U({...c,quantity:1})])}),this.updateMenuQuantities()}removeItem(c){this.order=new A.G({...this.order,items:this.order.items.filter(y=>y.id!==c.id&&y.options_string===c.options_string)}),this.updateMenuQuantities()}updateItemQuantity(c,y){const W=this.order.items.find(Q=>Q.id===c.id&&Q.options_string===c.options_string);let S=[...this.order.items];S=W?this.order.items.filter(Q=>!(Q.id===c.id&&Q.options_string===c.options_string)).concat([new P.U({...c,quantity:y})]):this.order.items.concat([new P.U({...c,quantity:y})]),S.sort((Q,q)=>Q.name.localeCompare(q.name)),this.order=new A.G({...this.order,items:S}),this.updateMenuQuantities()}updateMenuQuantities(){for(const c in this.menu_items)for(const y of this.menu_items[c])y.quantity=this.order.items.reduce((W,S)=>S.id===y.id?W+S.quantity:W,0)}optionsFor(c){return c.options.map(y=>y.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return I.\u0275fac=function(c){return new(c||I)(t.Y36(R.w7),t.Y36(E.WI))},I.\u0275cmp=t.Xpm({type:I,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(c,y){if(1&c&&(t.YNc(0,$,2,2,"div",0),t.YNc(1,U,4,2,"footer",1),t.YNc(2,k,4,1,"ng-template",null,2,t.W1O),t.YNc(4,Y,5,1,"ng-template",null,3,t.W1O)),2&c){const W=t.MAs(3);t.Q6J("ngIf",!y.loading)("ngIfElse",W),t.xp6(1),t.Q6J("ngIf",!y.loading)}},dependencies:[h.sg,h.O5,D.SP,D.uX,E.ZT,x.gM,C.Fj,C.JJ,C.On,M.o,v.lW,_.Ou,p.R,h.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--104.css.map*/"]}),I})()},3129:(H,G,o)=>{o.d(G,{R:()=>v});var n=o(2560),t=o(1484),E=o(3245),m=o(4666),l=o(4792),w=o(2922),F=o(2508),J=o(5306),P=o(4522);function A(_,p){if(1&_&&(n.TgZ(0,"div",18),n._uU(1),n.ALo(2,"currency"),n.qZA()),2&_){const r=n.oxw().$implicit,s=n.oxw(3);n.xp6(1),n.hij(" +",n.xi3(2,1,r.unit_price/100,s.code)," ")}}function R(_,p){if(1&_&&(n.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),n._uU(3),n.qZA(),n.YNc(4,A,3,4,"div",17),n.qZA()()),2&_){const r=p.$implicit;n.Q6J("value",r.id),n.xp6(3),n.hij(" ",r.name," "),n.xp6(1),n.Q6J("ngIf",r.unit_price)}}function h(_,p){if(1&_){const r=n.EpF();n.ynx(0),n.TgZ(1,"mat-radio-group",10),n.NdJ("ngModelChange",function(g){n.CHM(r);const f=n.oxw().$implicit,e=n.oxw();return n.KtG(e.updateGroupOption(f,g))}),n.TgZ(2,"mat-radio-button",11)(3,"span",12),n._uU(4,"None"),n.qZA()(),n.YNc(5,R,5,3,"mat-radio-button",13),n.qZA(),n.BQk()}if(2&_){const r=n.oxw().$implicit;n.xp6(5),n.Q6J("ngForOf",null==r?null:r.options)}}function D(_,p){if(1&_&&(n.TgZ(0,"div",18),n._uU(1),n.ALo(2,"currency"),n.qZA()),2&_){const r=n.oxw().$implicit,s=n.oxw(3);n.xp6(1),n.hij(" +",n.xi3(2,1,r.unit_price/100,s.code)," ")}}function x(_,p){if(1&_){const r=n.EpF();n.TgZ(0,"mat-checkbox",20),n.NdJ("ngModelChange",function(g){const e=n.CHM(r).$implicit,T=n.oxw(3);return n.KtG(T.option_state[e.id]=g)}),n.TgZ(1,"div",15)(2,"div",16),n._uU(3),n.qZA(),n.YNc(4,D,3,4,"div",17),n.qZA()()}if(2&_){const r=p.$implicit,s=n.oxw(3);n.Q6J("ngModel",s.option_state[r.id]),n.xp6(3),n.hij(" ",r.name," "),n.xp6(1),n.Q6J("ngIf",r.unit_price)}}function C(_,p){if(1&_&&n.YNc(0,x,5,3,"mat-checkbox",19),2&_){const r=n.oxw().$implicit;n.Q6J("ngForOf",null==r?null:r.options)}}function M(_,p){if(1&_&&(n.TgZ(0,"div",5)(1,"div",6),n._uU(2),n.qZA(),n.TgZ(3,"div",7),n.YNc(4,h,6,1,"ng-container",8),n.YNc(5,C,1,1,"ng-template",null,9,n.W1O),n.qZA()()),2&_){const r=p.$implicit,s=n.MAs(6);n.uIk("group",r.name),n.xp6(2),n.Oqu(r.name),n.xp6(2),n.Q6J("ngIf",!r.multiple)("ngIfElse",s)}}let v=(()=>{class _{constructor(r){this._data=r,this.event=new n.vpe,this.option_state={},this.code=this._data.code;const s=(0,E.Tw)(this._data.options.map(f=>f.group||"Other")),g=[];for(const f of s){const e=this._data.options.filter(T=>T.group===f);g.push({name:f,multiple:!!e.find(T=>T.multiple),options:e})}this.groups=g}updateGroupOption(r,s){for(const g of r.options)this.option_state[g.id]=g.id===s}saveOptions(){const r=this._data.options.filter(s=>this.option_state[s.id]);this.event.emit({reason:"done",metadata:{options:r}})}}return _.\u0275fac=function(r){return new(r||_)(n.Y36(t.WI))},_.\u0275cmp=n.Xpm({type:_,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(r,s){1&r&&(n.TgZ(0,"header")(1,"h3"),n._uU(2,"Select options"),n.qZA(),n.TgZ(3,"button",0)(4,"app-icon"),n._uU(5,"close"),n.qZA()()(),n.TgZ(6,"main",1),n.YNc(7,M,7,4,"div",2),n.qZA(),n.TgZ(8,"footer",3)(9,"button",4),n.NdJ("click",function(){return s.saveOptions()}),n._uU(10," Save "),n.qZA()()),2&r&&(n.xp6(7),n.Q6J("ngForOf",s.groups))},dependencies:[m.sg,m.O5,t.ZT,l.oG,w.VQ,w.U0,F.JJ,F.On,J.o,P.lW,m.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--105.css.map*/"]}),_})()},961:(H,G,o)=>{o.d(G,{p:()=>C});var n=o(9112),t=o(2851),m=(o(5163),o(2460)),l=o(2560),w=o(4666),F=o(8589),J=o(5306),P=o(4522),A=o(4204);function R(M,v){if(1&M){const _=l.EpF();l.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),l._uU(4,"room_service"),l.qZA()()(),l.TgZ(5,"div",7),l._uU(6),l.ALo(7,"date"),l.qZA(),l.TgZ(8,"div",8),l._uU(9),l.qZA(),l.TgZ(10,"div",9),l._uU(11),l.qZA(),l.TgZ(12,"div",10),l._uU(13),l.qZA(),l.TgZ(14,"div",11),l._uU(15),l.qZA(),l.TgZ(16,"div",12)(17,"button",13)(18,"div",14),l._uU(19),l.qZA(),l.TgZ(20,"app-icon",15),l._uU(21,"arrow_drop_down"),l.qZA()()(),l.TgZ(22,"div",16)(23,"button",17),l.NdJ("click",function(){l.CHM(_);const r=l.oxw();return l.KtG(r.show_items=!r.show_items)}),l.TgZ(24,"app-icon"),l._uU(25),l.qZA()()()()}if(2&M){const _=l.oxw(),p=l.MAs(3);l.ekj("bg-gray-100",!_.show_items)("bg-gray-200",_.show_items),l.xp6(1),l.ekj("bg-gray-200",_.show_items)("dark:bg-neutral-700",_.show_items),l.xp6(5),l.hij(" ",l.xi3(7,18,_.order.deliver_at,"shortTime")," "),l.xp6(3),l.hij(" ",(null==_.order.event?null:_.order.event.space.display_name)||(null==_.order.event?null:_.order.event.space.name)||"~ No Location ~"," "),l.xp6(2),l.hij(" ",(null==_.order.event||null==_.order.event.organiser?null:_.order.event.organiser.name)||(null==_.order.event?null:_.order.event.host)||"~ Unknown Host ~"," "),l.xp6(2),l.Oqu(_.order.charge_code||"~ No Code ~"),l.xp6(2),l.hij(" ",_.order.invoice_number||"~ No Invoice ~"," "),l.xp6(2),l.Udp("background",null==_.status?null:_.status.colour),l.Q6J("matMenuTriggerFor",p),l.xp6(2),l.hij(" ",null==_.status?null:_.status.name," "),l.xp6(6),l.Oqu(_.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function h(M,v){1&M&&l._UZ(0,"li",20),2&M&&l.Q6J("item",v.$implicit)}function D(M,v){if(1&M&&(l.TgZ(0,"ul",18),l.YNc(1,h,1,1,"li",19),l.qZA()),2&M){const _=l.oxw();l.ekj("shown",_.show_items),l.Q6J("@show",_.show_items?"show":"hide"),l.xp6(1),l.Q6J("ngForOf",_.order.items)}}function x(M,v){if(1&M){const _=l.EpF();l.TgZ(0,"button",21),l.NdJ("click",function(){const s=l.CHM(_).$implicit,g=l.oxw();return l.KtG(g.updateStatus(s.id))}),l._UZ(1,"div",22),l.TgZ(2,"span",23),l._uU(3),l.qZA()()}if(2&M){const _=v.$implicit;l.xp6(1),l.Udp("background-color",_.colour),l.xp6(2),l.Oqu(_.name)}}let C=(()=>{class M{constructor(_){this._orders=_,this.show_items=!1,this.statuses=m.U,this.updateStatus=p=>this._orders.updateStatus(this.order,p)}get status(){return this.statuses.find(_=>_.id===this.order.status)}}return M.\u0275fac=function(_){return new(_||M)(l.Y36(t.I))},M.\u0275cmp=l.Xpm({type:M,selectors:[["catering-order"]],inputs:{order:"order"},decls:5,vars:3,consts:[["class","w-full flex items-center py-2 dark:bg-neutral-700",3,"bg-gray-100","bg-gray-200",4,"ngIf"],["class","list-none p-0 m-0 w-full relative z-0",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2","dark:bg-neutral-700"],[1,"w-20","flex","items-center","justify-center","z-20","h-full"],[1,"rounded-full","bg-gray-400","dark:bg-neutral-800","p-2","text-2xl","text-black","dark:text-white","opacity-60","flex","items-center","justify-center"],["time","",1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-24"],[1,"w-28"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["mat-icon-button","",3,"click"],[1,"list-none","p-0","m-0","w-full","relative","z-0"],["catering-order-item","","class","flex items-center",3,"item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(_,p){1&_&&(l.YNc(0,R,26,21,"div",0),l.YNc(1,D,2,4,"ul",1),l.TgZ(2,"mat-menu",null,2),l.YNc(4,x,4,3,"button",3),l.qZA()),2&_&&(l.Q6J("ngIf",p.order),l.xp6(1),l.Q6J("ngIf",null==p.order?null:p.order.items.length),l.xp6(3),l.Q6J("ngForOf",p.statuses))},dependencies:[w.sg,w.O5,F.VK,F.OP,F.p6,J.o,P.lW,A.m,w.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}\n/*# sourceMappingURL=catering-order.component.ts-angular-inline--110.css.map*/"],data:{animation:[n.X7]}}),M})()},2851:(H,G,o)=>{o.d(G,{I:()=>v});var n=o(4505),t=o(7716),E=o(823),m=o(9095),l=o(6942),w=o(8759),F=o(9128),J=o(1810),P=o(9377),A=o(3200),R=o(9112),h=o(4211),D=o(3902),x=o(5163),C=o(2560);let v=(()=>{class _ extends R.KG{constructor(){super(),this._poll=new n.X(0),this._loading=new n.X(!1),this._filters=new n.X({}),this.orders=(0,t.aj)([this._filters,this._poll]).pipe((0,E.b)(500),(0,m.w)(([r])=>{this._loading.next(!0);const s=(0,J.Z)((0,P.Z)(r.date||Date.now())),g=(0,J.Z)((0,A.Z)(r.date||Date.now()));return(0,h.u$)({zone_ids:(r.zones||[]).join(","),period_start:s,period_end:g})}),(0,l.U)(r=>(0,R.xH)(r.map(s=>s.ext("catering")))),(0,w.b)(()=>this._loading.next(!1)),(0,F.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,l.U)(r=>r.filter(s=>function M(_,p){const r=(p.search||"").toLowerCase();return!!_.items.find(s=>s.name.toLowerCase().includes(r)||!!s.options.find(g=>g.name.toLowerCase().includes(r)))}(s,this._filters.getValue())))),this.subscription("changes",this.orders.subscribe())}get filters(){return this._filters.getValue()}set filters(r){this._filters.next(r)}startPolling(r=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),r)}stopPolling(){this.clearInterval("polling")}updateStatus(r,s){const g=new x.G({...r,status:s}),f=new D.y({...r.event,catering:[...r.event.ext("catering").filter(e=>e.id!==r.id),g].map(e=>new x.G({...e}))});return(0,h.ry)(f)}}return _.\u0275fac=function(r){return new(r||_)},_.\u0275prov=C.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},729:(H,G,o)=>{o.d(G,{j:()=>v});var n=o(1670),t=o(3690),E=o(4505),m=o(5670),l=o(9112),w=o(6221),F=o(6336),J=o(7413),P=o(2090),A=o(2962),R=o(5163),h=o(9504),D=o(3129),x=o(5730),C=o(2560),M=o(1484);let v=(()=>{class _ extends l.KG{constructor(r,s,g){var f;super(),f=this,this._org=r,this._dialog=s,this._settings=g,this._menu=new E.X([]),this._loading=new E.X(!1),this._currency=new E.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(function(){var e=(0,n.Z)(function*(T){if(T){const L=(yield f.getCateringForZone(T.id)).map(N=>new A.U(N));f._currency.next(f._settings.get("app.currency")||T.currency||"USD"),f._menu.next(L)}});return function(T){return e.apply(this,arguments)}}()))}get categories(){const r=this._menu.getValue();return(0,l.Tw)(r.map(s=>s.category))}manageCateringOrder(r){var s=this;return(0,n.Z)(function*(){const g=s._dialog.open(h.W,{data:{code:s._currency.getValue(),order:r,menu:s.menu,loading:s.loading,getCateringConfig:e=>s.getCateringConfig(e),selectOptions:e=>s.selectOptions(e)}}),f=yield Promise.race([g.componentInstance.event.pipe((0,m.P)(e=>"done"===e.reason)).toPromise(),g.afterClosed().toPromise()]);return g.close(),f?.metadata?.order||r})()}addItem(r=new A.U){var s=this;return(0,n.Z)(function*(){const g=s._dialog.open(F.w,{data:{item:r,categories:s.categories}}),f=yield Promise.race([g.componentInstance.event.pipe((0,m.P)(L=>"done"===L.reason)).toPromise(),g.afterClosed().toPromise()]);if("done"!==f?.reason)return;const e=s._menu.getValue(),T=e.findIndex(L=>L.id===r.id);T>=0?e.splice(T,1,f.metadata.item):e.push(f.metadata.item),s.updateMenu(s._org.building.id,e).then(()=>{s._menu.next([...e]),g.close()},()=>g.componentInstance.loading=!1)})()}addOption(r,s={}){var g=this;return(0,n.Z)(function*(){const f=(0,l.Tw)(r.options.map($=>$.group)),e=g._dialog.open(J.M,{data:{parent:r,option:s,types:f}}),T=yield Promise.race([e.componentInstance.event.pipe((0,m.P)($=>"done"===$.reason)).toPromise(),e.afterClosed().toPromise()]);if("done"!==T?.reason)return;const L=g._menu.getValue(),N=L.findIndex($=>$.id===r.id);N>=0?L.splice(N,1,T.metadata.item):L.push(T.metadata.item),g.updateMenu(g._org.building.id,L).then(()=>{g._menu.next([...L]),e.close()},()=>e.componentInstance.loading=!1)})()}selectOptions(r){var s=this;return(0,n.Z)(function*(){const g=s._dialog.open(D.R,{data:{code:s._currency.getValue(),options:r}}),f=yield Promise.race([g.componentInstance.event.pipe((0,m.P)(e=>"done"===e.reason)).toPromise(),g.afterClosed().toPromise()]);return"done"!==f?.reason?[]:(g.close(),f.metadata.options)})()}deleteItem(r){var s=this;return(0,n.Z)(function*(){const g=yield(0,l._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${r.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},s._dialog);if("done"!==g.reason)return;g.loading("Removing catering item...");const f=s._menu.getValue().filter(e=>r.id!==e.id);s.updateMenu(s._org.building.id,f).then(()=>{s._menu.next([...f]),g.close()},()=>g.loading(""))})()}deleteOption(r,s){var g=this;return(0,n.Z)(function*(){const f=yield(0,l._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${s.name}" from "${r.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},g._dialog);if("done"!==f.reason)return;f.loading("Removing catering item option...");const e=g._menu.getValue();e.splice(e.findIndex(T=>T.id===r.id),1,new A.U({...r,options:r.options.filter(T=>T.id!==s.id)})),g.updateMenu(g._org.building.id,e).then(()=>{g._menu.next([...e]),f.close()},()=>f.loading(""))})()}editConfig(){var r=this;return(0,n.Z)(function*(){const s=yield r.getCateringConfig(r._org.building.id),g=r._menu.getValue(),f=(0,l.Tw)((0,l.xH)(g.map(L=>[L.category,...L.tags]))),e=r._dialog.open(P.S,{data:{config:s,types:f}}),T=yield Promise.race([e.componentInstance.event.pipe((0,m.P)(L=>"done"===L.reason)).toPromise(),e.afterClosed().toPromise()]);"done"===T?.reason&&r.updateConfig(r._org.building.id,T.metadata).then(()=>e.close(),()=>e.componentInstance.loading=!1)})()}importMenu(){var r=this;return(0,n.Z)(function*(){const s=r._dialog.open(x.m),g=yield Promise.race([s.componentInstance.event.pipe((0,m.P)(L=>"done"===L.reason)).toPromise(),s.afterClosed().toPromise()]);if("done"!==g?.reason)return;s.componentInstance.loading="Updating menu...";const f=r._menu.getValue(),e=r._org.building,T=(0,l.Tw)(g.metadata.concat(f),"id");yield r.updateMenu(e.id,T).catch(L=>{throw(0,l.cB)("Error importing catering menu"),s.close(),L}),(0,l.t5)(`Successfully imported catering menu. ${g.metadata.length} item(s) added.`),s.close()})()}updateMenu(r,s){return(0,t.Ymr)(r,{id:r,name:"catering",details:s,description:`Catering menu for ${r}`}).toPromise()}getCateringForZone(r){return(0,n.Z)(function*(){const s=(yield(0,t.rlq)(r,"catering").toPromise()).details;return s instanceof Array?s:[]})()}getCateringConfig(r=this._org.building.id){return(0,n.Z)(function*(){const s=(yield(0,t.rlq)(r,"catering_config").toPromise()).details;return s instanceof Array?s:[]})()}updateConfig(r,s){return(0,t.Ymr)(r,{id:r,name:"catering_config",details:s,description:`Catering menu config for ${r}`}).toPromise()}addItemToOrder(r,s){let g=r.items;const f=g.find(T=>T.id===s.id&&s.options?.length===T.options?.reduce((L,N)=>L+(s.options.find($=>N.id===$.id)?1:0),0));return f?f.quantity+=1:g=g.concat([new A.U({...s,quantity:1})]),new R.G({...r,items:g,event:null})}}return _.\u0275fac=function(r){return new(r||_)(C.LFG(w.w7),C.LFG(M.uw),C.LFG(l.gb))},_.\u0275prov=C.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},7701:(H,G,o)=>{o.d(G,{g:()=>n});const n=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}]},2460:(H,G,o)=>{o.d(G,{U:()=>n});const n=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map