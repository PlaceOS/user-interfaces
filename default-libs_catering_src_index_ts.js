"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{9364:(q,S,o)=>{o.d(S,{Ud:()=>Y.U,GX:()=>Jt.G,Ii:()=>Kt.I,jW:()=>Wt.j,uy:()=>Ft});var n=o(4666),e=o(2508),I=o(8550),i=o(4792),_=o(1484),w=o(8589),J=o(5892),K=o(2922),P=o(6896),Z=o(3723),t=(o(2090),o(6336),o(8644),o(8501),o(7413),o(4204),o(2189),o(9504),o(3129),o(961),o(5730),o(9112),o(6221),o(2560)),Y=(o(5306),o(4522),o(3690),o(4505),o(7716),o(9095),o(6942),o(7418),o(8759),o(9128),o(2962));o(1708),o(2581),o(2793),o(1670),o(3910);var rt=o(5074);o(1267);var Bt=o(9816);let Ft=(()=>{class m{}return m.\u0275fac=function(a){return new(a||m)},m.\u0275mod=t.oAB({type:m}),m.\u0275inj=t.cJS({imports:[n.ez,w.Tx,J.Nh,I.Bb,_.Is,i.p9,K.Fk,P.AV,e.u5,e.UX,Z.K,rt.lN,Bt.W9]}),m})();var Jt=o(5163),Kt=o(2851),Wt=o(729);o(7701),o(2460)},2090:(q,S,o)=>{o.d(S,{S:()=>O});var n=o(2560),e=o(1484),I=o(7701),i=o(4666),_=o(207),w=o(2508),J=o(5306),K=o(5074),P=o(7371),Z=o(4522),U=o(1267);function E(x,d){1&x&&(n.TgZ(0,"button",5)(1,"app-icon"),n._uU(2,"close"),n.qZA()())}function N(x,d){if(1&x&&(n.TgZ(0,"mat-option",18),n._uU(1),n.qZA()),2&x){const C=d.$implicit;n.Q6J("value",C.id),n.xp6(1),n.hij(" ",C.name," ")}}function G(x,d){if(1&x){const C=n.EpF();n.TgZ(0,"div",14)(1,"mat-form-field",8)(2,"mat-select",15),n.NdJ("ngModelChange",function(l){const u=n.CHM(C).$implicit;return n.KtG(u[0]=l)}),n.YNc(3,N,2,2,"mat-option",16),n.qZA()(),n.TgZ(4,"mat-form-field",8)(5,"input",17),n.NdJ("ngModelChange",function(l){const u=n.CHM(C).$implicit;return n.KtG(u[1]=l)}),n.qZA(),n.TgZ(6,"mat-error"),n._uU(7,"Rule value is required"),n.qZA()(),n.TgZ(8,"button",10),n.NdJ("click",function(){const c=n.CHM(C).index,u=n.oxw().$implicit;return n.KtG(u.rules.splice(c,1))}),n.TgZ(9,"app-icon"),n._uU(10,"delete"),n.qZA()()()}if(2&x){const C=d.$implicit,r=n.oxw(2);n.xp6(2),n.Q6J("ngModel",C[0]),n.xp6(1),n.Q6J("ngForOf",r.rule_types),n.xp6(2),n.Q6J("ngModel",C[1])}}function T(x,d){if(1&x){const C=n.EpF();n.TgZ(0,"div",6)(1,"div",7)(2,"mat-form-field",8)(3,"input",9),n.NdJ("ngModelChange",function(l){const u=n.CHM(C).$implicit;return n.KtG(u.name=l)}),n.qZA(),n.TgZ(4,"mat-error"),n._uU(5,"Ruleset name is required"),n.qZA()(),n.TgZ(6,"button",10),n.NdJ("click",function(){const c=n.CHM(C).$implicit,u=n.oxw();return c.rules.push(["",""]),n.KtG(u.show_rules=c.id)}),n.TgZ(7,"app-icon"),n._uU(8,"add"),n.qZA()(),n.TgZ(9,"button",11),n.NdJ("click",function(){const c=n.CHM(C).$implicit,u=n.oxw();return n.KtG(u.show_rules=u.show_rules!==c.id?c.id:"")}),n.TgZ(10,"app-icon"),n._uU(11),n.qZA()(),n.TgZ(12,"button",10),n.NdJ("click",function(){const c=n.CHM(C).index,u=n.oxw();return n.KtG(u.rulesets.splice(c,1))}),n.TgZ(13,"app-icon"),n._uU(14,"delete"),n.qZA()()(),n.TgZ(15,"div",12),n.YNc(16,G,11,3,"div",13),n.qZA()()}if(2&x){const C=d.$implicit,r=n.oxw();n.xp6(3),n.Q6J("ngModel",C.name),n.xp6(6),n.Q6J("disabled",!C.rules.length),n.xp6(2),n.Oqu(r.show_rules===C.id?"expand_less":"expand_more"),n.xp6(4),n.Udp("height",(r.show_rules===C.id?5*C.rules.length:0)+"em"),n.xp6(1),n.Q6J("ngForOf",C.rules)}}let O=(()=>{class x{constructor(C){this._data=C,this.event=new n.vpe,this.loading=!1,this.rule_types=I.g,this.rulesets=(C.config||[]).map(r=>(r.rules=r.rules.map(l=>[l[0],JSON.stringify(l[1])]),r))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const C=this.rulesets.map(r=>({...r,rules:r.rules.map(l=>{let c=l[1];try{c=JSON.parse(l[1])}catch{}return[l[0],c]})}));this.event.emit({reason:"done",metadata:C})}}return x.\u0275fac=function(C){return new(C||x)(n.Y36(e.WI))},x.\u0275cmp=n.Xpm({type:x,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex items-center px-2 h-20 space-x-2",4,"ngFor","ngForOf"],[1,"flex","items-center","px-2","h-20","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(C,r){1&C&&(n.TgZ(0,"header")(1,"h3"),n._uU(2,"Edit Catering Configuration"),n.qZA(),n.YNc(3,E,3,0,"button",0),n.qZA(),n.TgZ(4,"main",1)(5,"button",2),n.NdJ("click",function(){return r.rulesets.push({id:r.new_id,rules:[]})}),n._uU(6," New Ruleset "),n.qZA(),n.YNc(7,T,17,6,"div",3),n.qZA(),n.TgZ(8,"footer",4)(9,"button",2),n.NdJ("click",function(){return r.saveChanges()}),n._uU(10,"Save Changes"),n.qZA()()),2&C&&(n.xp6(3),n.Q6J("ngIf",!r.loading),n.xp6(4),n.Q6J("ngForOf",r.rulesets))},dependencies:[i.sg,i.O5,_.ey,e.ZT,w.Fj,w.JJ,w.Q7,w.On,J.o,K.TO,K.KE,P.gD,Z.lW,U.Nt],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}\n/*# sourceMappingURL=catering-config-modal.component.ts-angular-inline--102.css.map*/"]}),x})()},5730:(q,S,o)=>{o.d(S,{m:()=>E});var n=o(2560),e=o(9112),I=o(2962),i=o(4666),_=o(1484),w=o(5306),J=o(4522),K=o(1708);function P(N,G){1&N&&(n.TgZ(0,"button",4)(1,"app-icon"),n._uU(2,"close"),n.qZA()())}function Z(N,G){if(1&N){const T=n.EpF();n.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),n._uU(3,"upload"),n.qZA(),n.TgZ(4,"p"),n._uU(5,"Click to select file or Drag and drop files"),n.qZA(),n.TgZ(6,"input",7),n.NdJ("change",function(x){n.CHM(T);const d=n.oxw();return n.KtG(d.handleFileEvent(x))}),n.qZA()(),n.TgZ(7,"div",8)(8,"button",9),n.NdJ("click",function(){n.CHM(T);const x=n.oxw();return n.KtG(x.downloadTemplate())}),n._uU(9," Download Template "),n.qZA()()()}}function U(N,G){if(1&N&&(n.TgZ(0,"main",10),n._UZ(1,"mat-spinner",11),n.TgZ(2,"p"),n._uU(3),n.qZA()()),2&N){const T=n.oxw();n.xp6(3),n.Oqu(T.loading)}}let E=(()=>{class N{constructor(){this.event=new n.vpe}handleFileEvent(T){this.loading="Processing menu data...";const O=T.target;if(!O?.files)return this.loading="";const x=O.files;if(!x.length)return this.loading="";const d=x[0],C=new FileReader;C.addEventListener("loadend",r=>{const c=(0,e.n5)(r.target.result);this.loading="",this.event.emit({reason:"done",metadata:c.filter(u=>"item"===(u.type||"").toLowerCase()).map(u=>new I.U({...u,options:c.filter(t=>"option"===(t.type||"").toLowerCase()&&t.tags===u.id).map(t=>({id:t.id,name:t.name,group:t.category,multiple:t.multiple,unit_price:t.unit_price}))}))})}),C.readAsText(d)}downloadTemplate(){(0,e.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return N.\u0275fac=function(T){return new(T||N)},N.\u0275cmp=n.Xpm({type:N,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["mat-button","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(T,O){if(1&T&&(n.TgZ(0,"header",0)(1,"h2"),n._uU(2,"Import Catering Menu"),n.qZA(),n.YNc(3,P,3,0,"button",1),n.qZA(),n.YNc(4,Z,10,0,"main",2),n.YNc(5,U,4,1,"ng-template",null,3,n.W1O)),2&T){const x=n.MAs(6);n.xp6(3),n.Q6J("ngIf",!O.loading),n.xp6(1),n.Q6J("ngIf",!O.loading)("ngIfElse",x)}},dependencies:[i.O5,_.ZT,w.o,J.lW,K.Ou]}),N})()},6336:(q,S,o)=>{o.d(S,{w:()=>et});var n=o(8456),e=o(2560),I=o(2508),i=o(1484),_=o(9112),w=o(2962),J=o(4666),K=o(8550),P=o(207),Z=o(4792),U=o(5306),E=o(5074),N=o(4522),G=o(1267),T=o(1708),O=o(1169),x=o(2793),d=o(3670);function C(L,Y){1&L&&(e.TgZ(0,"button",7)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function r(L,Y){if(1&L&&(e.TgZ(0,"div",18)(1,"label",19),e._uU(2," Name"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",20),e._UZ(7,"input",21),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()()),2&L){const v=e.oxw(2);e.xp6(1),e.ekj("error",v.form.controls.name.invalid&&v.form.controls.name.touched)}}function l(L,Y){if(1&L&&(e.TgZ(0,"div",18)(1,"label",22),e._uU(2," Category"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",20),e._UZ(7,"input",23),e.TgZ(8,"mat-error"),e._uU(9,"Category is required"),e.qZA()()()),2&L){const v=e.oxw(2),B=e.MAs(9);e.xp6(1),e.ekj("error",v.form.controls.category.invalid&&v.form.controls.category.touched),e.xp6(6),e.Q6J("matAutocomplete",B)}}const c=function(){return{class:"material-icons",content:"close"}};function u(L,Y){if(1&L){const v=e.EpF();e.TgZ(0,"mat-chip",30),e.NdJ("removed",function(){const b=e.CHM(v).$implicit,g=e.oxw(3);return e.KtG(g.removeTag(b))}),e._uU(1),e._UZ(2,"app-icon",31),e.qZA()}if(2&L){const v=Y.$implicit;e.Q6J("selectable",!0)("removable",!0),e.xp6(1),e.hij(" ",v," "),e.xp6(1),e.Q6J("icon",e.DdM(4,c))}}function t(L,Y){if(1&L){const v=e.EpF();e.TgZ(0,"div",18)(1,"label",24),e.SDv(2,25),e.qZA(),e.TgZ(3,"mat-form-field",20)(4,"mat-chip-list",26,27),e.YNc(6,u,3,5,"mat-chip",28),e.TgZ(7,"input",29),e.NdJ("matChipInputTokenEnd",function(f){e.CHM(v);const b=e.oxw(2);return e.KtG(b.addTag(f))}),e.qZA()()()()}if(2&L){const v=e.MAs(5),B=e.oxw(2);e.xp6(1),e.ekj("error",B.form.controls.tags.invalid&&B.form.controls.tags.touched),e.xp6(5),e.Q6J("ngForOf",B.tag_list),e.xp6(1),e.Q6J("matChipInputFor",v)("matChipInputSeparatorKeyCodes",B.separators)("matChipInputAddOnBlur",!0)}}function h(L,Y){1&L&&(e.TgZ(0,"div",18)(1,"label",32),e._uU(2,"Description:"),e.qZA(),e.TgZ(3,"mat-form-field",20),e._UZ(4,"textarea",33),e.qZA()())}function y(L,Y){if(1&L&&(e.TgZ(0,"div",18)(1,"label",19),e._uU(2," Unit Price"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",20),e._UZ(7,"input",34),e.TgZ(8,"mat-error"),e._uU(9,"Unit Price is required"),e.qZA()()()),2&L){const v=e.oxw(2);e.xp6(1),e.ekj("error",v.form.controls.unit_price.invalid&&v.form.controls.unit_price.touched)}}function R(L,Y){1&L&&(e.TgZ(0,"div",18)(1,"label",35),e.SDv(2,36),e.qZA(),e._UZ(3,"image-list-field",37),e.qZA())}const Q=function(){return{standalone:!0}};function H(L,Y){if(1&L){const v=e.EpF();e.TgZ(0,"form",8)(1,"div",9),e.YNc(2,r,10,2,"div",10),e.YNc(3,l,10,3,"div",10),e.qZA(),e.YNc(4,t,8,6,"div",10),e.YNc(5,h,5,0,"div",10),e.YNc(6,y,10,2,"div",10),e.TgZ(7,"div",11)(8,"label",12),e._uU(9,"Accept Points?"),e.qZA(),e.TgZ(10,"mat-checkbox",13),e._uU(11),e.qZA()(),e.TgZ(12,"div",14)(13,"mat-checkbox",15),e.NdJ("ngModelChange",function(f){e.CHM(v);const b=e.oxw();return e.KtG(f?b.addTag({value:"Gluten Free"}):b.removeTag("Gluten Free"))}),e._uU(14," Gluten Free (GF) "),e.qZA(),e.TgZ(15,"mat-checkbox",15),e.NdJ("ngModelChange",function(f){e.CHM(v);const b=e.oxw();return e.KtG(f?b.addTag({value:"Vegan"}):b.removeTag("Vegan"))}),e._uU(16," Vegan (VG) "),e.qZA(),e.TgZ(17,"mat-checkbox",15),e.NdJ("ngModelChange",function(f){e.CHM(v);const b=e.oxw();return e.KtG(f?b.addTag({value:"Vegetarian"}):b.removeTag("Vegetarian"))}),e._uU(18," Vegetarian (V) "),e.qZA(),e.TgZ(19,"mat-checkbox",15),e.NdJ("ngModelChange",function(f){e.CHM(v);const b=e.oxw();return e.KtG(f?b.addTag({value:"Contains Dairy"}):b.removeTag("Contains Dairy"))}),e._uU(20," Contains Dairy (D) "),e.qZA(),e.TgZ(21,"mat-checkbox",15),e.NdJ("ngModelChange",function(f){e.CHM(v);const b=e.oxw();return e.KtG(f?b.addTag({value:"Contains Nuts"}):b.removeTag("Contains Nuts"))}),e._uU(22," Contains Nuts (N) "),e.qZA()(),e.TgZ(23,"div",11)(24,"label",16),e._uU(25,"Discount Cap"),e.qZA(),e._UZ(26,"a-counter",17),e.qZA(),e.YNc(27,R,4,0,"div",10),e.qZA()}if(2&L){const v=e.oxw();let B;e.Q6J("formGroup",v.form),e.xp6(2),e.Q6J("ngIf",v.form.controls.name),e.xp6(1),e.Q6J("ngIf",v.form.controls.category),e.xp6(1),e.Q6J("ngIf",v.form.controls.tags),e.xp6(1),e.Q6J("ngIf",v.form.controls.description),e.xp6(1),e.Q6J("ngIf",v.form.controls.unit_price),e.xp6(5),e.Oqu(null!=(B=v.form.get("accept_points"))&&B.value?"No":"Yes"),e.xp6(2),e.Q6J("ngModel",v.hasTag("Gluten Free"))("ngModelOptions",e.DdM(22,Q)),e.xp6(2),e.Q6J("ngModel",v.hasTag("Vegan"))("ngModelOptions",e.DdM(23,Q)),e.xp6(2),e.Q6J("ngModel",v.hasTag("Vegetarian"))("ngModelOptions",e.DdM(24,Q)),e.xp6(2),e.Q6J("ngModel",v.hasTag("Contains Dairy"))("ngModelOptions",e.DdM(25,Q)),e.xp6(2),e.Q6J("ngModel",v.hasTag("Contains Nuts"))("ngModelOptions",e.DdM(26,Q)),e.xp6(5),e.Q6J("min",0)("max",100)("step",5)("render_fn",v.renderPercent),e.xp6(1),e.Q6J("ngIf",v.form.controls.images)}}function z(L,Y){if(1&L){const v=e.EpF();e.TgZ(0,"footer",38)(1,"button",39),e.NdJ("click",function(){e.CHM(v);const f=e.oxw();return e.KtG(f.saveChanges())}),e._uU(2," Save "),e.qZA()()}if(2&L){const v=e.oxw();e.xp6(1),e.Q6J("disabled",!v.form.dirty)}}function V(L,Y){1&L&&(e.TgZ(0,"div",40),e._UZ(1,"mat-spinner",41),e.TgZ(2,"p"),e._uU(3,"Saving catering item..."),e.qZA()())}function tt(L,Y){if(1&L&&(e.TgZ(0,"mat-option",42),e._uU(1),e.qZA()),2&L){const v=Y.$implicit;e.Q6J("value",v),e.xp6(1),e.hij(" ",v," ")}}let et=(()=>{class L{constructor(v){this._data=v,this.event=new e.vpe,this.form=new I.cw({name:new I.NI(this.item.name||"",[I.kI.required]),description:new I.NI(this.item.description||""),category:new I.NI(this.item.category||"",[I.kI.required]),unit_price:new I.NI(this.item.unit_price,[I.kI.required]),tags:new I.NI(this.item.tags||[]),accept_points:new I.NI(this.item.accept_points||!1),discount_cap:new I.NI(this.item.discount_cap||0),images:new I.NI(this.item.images||[])}),this.loading=!1,this.separators=[n.K5,n.OC,n.L_]}get item(){return this._data.item||new w.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(v=0){return`${v}%`}hasTag(v){return this.tag_list.includes(v)}addTag(v){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const B=v.input,f=v.value,b=this.tag_list;(f||"").trim()&&(b.push(f),this.form.controls.tags.setValue(b)),B&&(B.value="")}removeTag(v){if(!this.form||!this.form.controls.tags)return;const B=this.tag_list;this.form.controls.tags.markAsDirty();const f=B.indexOf(v);f>=0&&(B.splice(f,1),this.form.controls.tags.setValue(B))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new w.U({...this.item,id:this.item.id||`item-${(0,_.Iy)(99999999)}`,...this.form.value})}})}}return L.\u0275fac=function(v){return new(v||L)(e.Y36(i.WI))},L.\u0275cmp=e.Xpm({type:L,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let Y,v,B;return Y=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,v=$localize`:@@zoneTagsPlaceholder␟c133beffffe3288bbdbf8572a32910c33ce14991␟2194594490376201833:Item tags e.g. Gluten Free, Vegan etc.`,B=$localize`:@@imagesLabel␟e5d9e00faa06714d7671b164cad364b26f4c585b␟5137125764814732349:Images:`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],[1,"flex","items-center","space-x-2"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],["list","",1,"flex","items-center","flex-wrap"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],Y,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",v,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["for","images"],B,["name","images","formControlName","images"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(v,B){if(1&v&&(e.TgZ(0,"header")(1,"h3",0),e._uU(2),e.qZA(),e.YNc(3,C,3,0,"button",1),e.qZA(),e.YNc(4,H,28,27,"form",2),e.YNc(5,z,3,1,"footer",3),e.YNc(6,V,4,0,"ng-template",null,4,e.W1O),e.TgZ(8,"mat-autocomplete",null,5),e.YNc(10,tt,2,2,"mat-option",6),e.qZA()),2&v){const f=e.MAs(7);e.xp6(2),e.hij("",B.item.id?"Edit":"Add"," Item"),e.xp6(1),e.Q6J("ngIf",!B.loading),e.xp6(1),e.Q6J("ngIf",B.form&&!B.loading)("ngIfElse",f),e.xp6(1),e.Q6J("ngIf",!B.loading),e.xp6(5),e.Q6J("ngForOf",B.categories)}},dependencies:[J.sg,J.O5,K.XC,K.ZL,P.ey,i.ZT,i.uh,Z.oG,I._Y,I.Fj,I.wV,I.JJ,I.JL,I.On,I.sg,I.u,U.o,E.TO,E.KE,N.lW,G.Nt,T.Ou,O.qn,O.HS,O.oH,O.qH,x.R,d.h],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[list][_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin:.5rem}\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--103.css.map*/"]}),L})()},8644:(q,S,o)=>{o.d(S,{V:()=>C});var n=o(9112),e=o(2962),I=o(729),i=o(2560),_=o(4666),w=o(8589),J=o(4792),K=o(6896),P=o(2508),Z=o(5306),U=o(4522);const E=["catering-menu-item",""];function N(r,l){if(1&r&&(i.TgZ(0,"button",14)(1,"app-icon"),i._uU(2,"more_vert"),i.qZA()()),2&r){i.oxw(2);const c=i.MAs(4);i.Q6J("matMenuTriggerFor",c)}}function G(r,l){if(1&r){const c=i.EpF();i.TgZ(0,"div",6)(1,"mat-checkbox",7),i.NdJ("ngModelChange",function(t){i.CHM(c);const h=i.oxw();return i.KtG(h.is_enabled=t)}),i.qZA(),i.TgZ(2,"div",8)(3,"div",9)(4,"div"),i._uU(5),i.qZA(),i.TgZ(6,"div",10),i._uU(7),i.qZA()(),i.TgZ(8,"div",11),i._uU(9),i.ALo(10,"currency"),i.ALo(11,"async"),i.qZA()(),i.YNc(12,N,3,1,"button",12),i.TgZ(13,"button",13),i.NdJ("click",function(){i.CHM(c);const t=i.oxw();return i.KtG(t.show_options=!t.show_options)}),i.TgZ(14,"app-icon"),i._uU(15,"expand_more"),i.qZA()()()}if(2&r){const c=i.oxw();i.xp6(1),i.Q6J("ngModel",c.is_enabled),i.xp6(4),i.Oqu(c.item.name),i.xp6(2),i.hij(" ",c.item.category," "),i.xp6(2),i.hij(" ",i.xi3(10,6,c.item.unit_price/100,i.lcZ(11,9,c.symbol))," "),i.xp6(3),i.Q6J("ngIf",c.can_edit),i.xp6(1),i.Q6J("disabled",!c.item.options.length)}}function T(r,l){if(1&r){const c=i.EpF();i.TgZ(0,"button",23),i.NdJ("click",function(){i.CHM(c);const t=i.oxw().$implicit,h=i.oxw(2);return i.KtG(h.editOption(t))}),i.TgZ(1,"app-icon"),i._uU(2,"edit"),i.qZA()()}}function O(r,l){if(1&r){const c=i.EpF();i.TgZ(0,"button",24),i.NdJ("click",function(){i.CHM(c);const t=i.oxw().$implicit,h=i.oxw(2);return i.KtG(h.removeOption(t))}),i.TgZ(1,"app-icon"),i._uU(2,"delete"),i.qZA()()}}function x(r,l){if(1&r&&(i.TgZ(0,"div",17),i._UZ(1,"div",18),i.TgZ(2,"div",19)(3,"div",20),i._uU(4),i.qZA(),i.TgZ(5,"div",10),i._uU(6),i.qZA()(),i.YNc(7,T,3,0,"button",21),i.YNc(8,O,3,0,"button",22),i.qZA()),2&r){const c=l.$implicit,u=i.oxw(2);i.xp6(4),i.Oqu(c.name),i.xp6(2),i.hij(" ",c.group," "),i.xp6(1),i.Q6J("ngIf",u.can_edit),i.xp6(1),i.Q6J("ngIf",u.can_edit)}}function d(r,l){if(1&r&&(i.TgZ(0,"div",15),i.YNc(1,x,9,4,"div",16),i.qZA()),2&r){const c=i.oxw();i.Udp("height",c.show_options?3.5*c.item.options.length+"rem":"0"),i.xp6(1),i.Q6J("ngForOf",c.item.options)}}let C=(()=>{class r{constructor(c){this._catering=c,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=u=>this._catering.addOption(this.item,u),this.removeOption=u=>this._catering.deleteOption(this.item,u),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}get can_edit(){return this._catering.is_editable}get is_enabled(){return!this.item.hide_for_zones.includes(this._catering.zone)}set is_enabled(c){let u=this.item.hide_for_zones;u=c?u.filter(t=>t!==this._catering.zone):(0,n.Tw)([...u,this._catering.zone]),this._catering.updateItem(new e.U({...this.item,hide_for_zones:u}))}get symbol(){return this._catering.currency}}return r.\u0275fac=function(c){return new(c||r)(i.Y36(I.j))},r.\u0275cmp=i.Xpm({type:r,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:E,decls:20,vars:2,consts:[[1,"w-full","h-full","bg-white","dark:bg-neutral-700","border","border-gray-300","dark:border-neutral-500","overflow-hidden","rounded"],["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-gray-100 dark:bg-neutral-700 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],["matTooltip","Allow Ordering Item",1,"mr-2",3,"ngModel","ngModelChange"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","opacity-60"],[1,"p-2","m-2","text-xs","font-bold","text-white","rounded","bg-primary"],["mat-icon-button","",3,"matMenuTriggerFor",4,"ngIf"],["mat-icon-button","",3,"disabled","click"],["mat-icon-button","",3,"matMenuTriggerFor"],["options","",1,"bg-gray-100","dark:bg-neutral-700","overflow-hidden"],["class","flex p-2 items-center border-t border-solid border-gray-300 dark:border-neutral-500 relative",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-t","border-solid","border-gray-300","dark:border-neutral-500","relative"],[1,"absolute","inset-y-0","left-0","w-2","bg-gray-400","dark:bg-neutral-600"],[1,"flex-1","pl-4","pr-2"],[1,"text"],["edit","","mat-icon-button","","class","mx-2",3,"click",4,"ngIf"],["remove","","mat-icon-button","","class","mx-2",3,"click",4,"ngIf"],["edit","","mat-icon-button","",1,"mx-2",3,"click"],["remove","","mat-icon-button","",1,"mx-2",3,"click"]],template:function(c,u){1&c&&(i.TgZ(0,"div",0),i.YNc(1,G,16,11,"div",1),i.YNc(2,d,2,3,"div",2),i.TgZ(3,"mat-menu",null,3)(5,"button",4),i.NdJ("click",function(){return u.addOption()}),i.TgZ(6,"app-icon"),i._uU(7,"add"),i.qZA(),i.TgZ(8,"div",5),i._uU(9,"Add Option"),i.qZA()(),i.TgZ(10,"button",4),i.NdJ("click",function(){return u.editItem()}),i.TgZ(11,"app-icon"),i._uU(12,"edit"),i.qZA(),i.TgZ(13,"div",5),i._uU(14,"Edit Item"),i.qZA()(),i.TgZ(15,"button",4),i.NdJ("click",function(){return u.removeItem()}),i.TgZ(16,"app-icon"),i._uU(17,"delete"),i.qZA(),i.TgZ(18,"div",5),i._uU(19,"Remove Item"),i.qZA()()()()),2&c&&(i.xp6(1),i.Q6J("ngIf",u.item),i.xp6(1),i.Q6J("ngIf",u.item))},dependencies:[_.sg,_.O5,w.VK,w.OP,w.p6,J.oG,K.gM,P.JJ,P.On,Z.o,U.lW,_.Ov,_.H9],styles:["[_nghost-%COMP%]{overflow:hidden;width:768px;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=catering-menu-item.component.ts-angular-inline--107.css.map*/"]}),r})()},8501:(q,S,o)=>{o.d(S,{B:()=>G});var n=o(4505),e=o(6942),I=o(729),i=o(2560),_=o(4666),w=o(5892),J=o(5306),K=o(8644);function P(T,O){if(1&T&&(i.ynx(0),i._UZ(1,"div",6),i.BQk()),2&T){const x=O.$implicit;i.xp6(1),i.Q6J("item",x)}}function Z(T,O){if(1&T&&(i.ynx(0),i.YNc(1,P,2,1,"ng-container",5),i.ALo(2,"async"),i.BQk()),2&T){const x=i.oxw();i.xp6(1),i.Q6J("ngForOf",i.lcZ(2,1,x.menu))}}function U(T,O){if(1&T&&(i.ynx(0),i._UZ(1,"div",6),i.BQk()),2&T){const x=O.$implicit;i.xp6(1),i.Q6J("item",x)}}function E(T,O){if(1&T&&(i.TgZ(0,"mat-tab",7),i.YNc(1,U,2,1,"ng-container",5),i.ALo(2,"async"),i.qZA()),2&T){const x=O.$implicit,d=i.oxw();i.Q6J("label",x),i.xp6(1),i.Q6J("ngForOf",i.lcZ(2,2,d.tab_menu)[x])}}function N(T,O){1&T&&(i.TgZ(0,"div",8)(1,"app-icon"),i._uU(2,"close"),i.qZA(),i.TgZ(3,"p"),i._uU(4,"No items in menu"),i.qZA()())}let G=(()=>{class T{constructor(x){this._catering=x,this.menu=this._catering.menu,this.shown_tab=new n.X(""),this.tab_menu=this.menu.pipe((0,e.U)(d=>{const C={};for(const r of this.categories)C[r]=d.filter(l=>l.category===r);return C}))}get categories(){return this._catering.categories}}return T.\u0275fac=function(x){return new(x||T)(i.Y36(I.j))},T.\u0275cmp=i.Xpm({type:T,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(x,d){if(1&x&&(i.TgZ(0,"mat-tab-group",0),i.NdJ("selectedIndexChange",function(r){return d.shown_tab.next(0===r?"":d.categories[r-1])}),i.TgZ(1,"mat-tab",1),i.YNc(2,Z,3,3,"ng-container",2),i.ALo(3,"async"),i.qZA(),i.YNc(4,E,3,4,"mat-tab",3),i.qZA(),i.YNc(5,N,5,0,"ng-template",null,4,i.W1O)),2&x){const C=i.MAs(6);let r;i.xp6(2),i.Q6J("ngIf",null==(r=i.lcZ(3,3,d.menu))?null:r.length)("ngIfElse",C),i.xp6(2),i.Q6J("ngForOf",d.categories)}},dependencies:[_.sg,_.O5,w.SP,w.uX,J.o,K.V,_.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--108.css.map*/"]}),T})()},7413:(q,S,o)=>{o.d(S,{M:()=>t});var n=o(2560),e=o(2508),I=o(1484),i=o(3245),_=o(2962),w=o(4666),J=o(8550),K=o(207),P=o(4792),Z=o(5306),U=o(5074),E=o(4522),N=o(1267),G=o(1708);function T(h,y){1&h&&(n.TgZ(0,"button",7)(1,"app-icon"),n._uU(2,"close"),n.qZA()())}function O(h,y){if(1&h&&(n.TgZ(0,"div",10)(1,"label",11),n._uU(2," Name"),n.TgZ(3,"span"),n._uU(4,"*"),n.qZA(),n._uU(5,": "),n.qZA(),n.TgZ(6,"mat-form-field",12),n._UZ(7,"input",13),n.TgZ(8,"mat-error"),n._uU(9,"Name is required"),n.qZA()()()),2&h){const R=n.oxw(2);n.xp6(1),n.ekj("error",R.form.controls.name.invalid&&R.form.controls.name.touched)}}function x(h,y){if(1&h&&(n.TgZ(0,"div",10)(1,"label",14),n._uU(2," Type"),n.TgZ(3,"span"),n._uU(4,"*"),n.qZA(),n._uU(5,": "),n.qZA(),n.TgZ(6,"mat-form-field",12),n._UZ(7,"input",15),n.TgZ(8,"mat-error"),n._uU(9,"Type is required"),n.qZA()()()),2&h){const R=n.oxw(2),Q=n.MAs(9);n.xp6(1),n.ekj("error",R.form.controls.group.invalid&&R.form.controls.group.touched),n.xp6(6),n.Q6J("matAutocomplete",Q)}}function d(h,y){1&h&&(n.TgZ(0,"div",10)(1,"label",11),n._uU(2,"Unit Price:"),n.qZA(),n.TgZ(3,"mat-form-field",12),n._UZ(4,"input",16),n.qZA()())}function C(h,y){1&h&&(n.TgZ(0,"div",10)(1,"mat-checkbox",17),n._uU(2," Can select multiple of type "),n.qZA()())}function r(h,y){if(1&h&&(n.TgZ(0,"form",8),n.YNc(1,O,10,2,"div",9),n.YNc(2,x,10,3,"div",9),n.YNc(3,d,5,0,"div",9),n.YNc(4,C,3,0,"div",9),n.qZA()),2&h){const R=n.oxw();n.Q6J("formGroup",R.form),n.xp6(1),n.Q6J("ngIf",R.form.controls.name),n.xp6(1),n.Q6J("ngIf",R.form.controls.group),n.xp6(1),n.Q6J("ngIf",R.form.controls.unit_price),n.xp6(1),n.Q6J("ngIf",R.form.controls.multiple)}}function l(h,y){if(1&h){const R=n.EpF();n.TgZ(0,"footer",18)(1,"button",19),n.NdJ("click",function(){n.CHM(R);const H=n.oxw();return n.KtG(H.saveChanges())}),n._uU(2," Save "),n.qZA()()}if(2&h){const R=n.oxw();n.xp6(1),n.Q6J("disabled",!R.form.dirty)}}function c(h,y){1&h&&(n.TgZ(0,"div",20),n._UZ(1,"mat-spinner",21),n.TgZ(2,"p"),n._uU(3,"Saving catering item option..."),n.qZA()())}function u(h,y){if(1&h&&(n.TgZ(0,"mat-option",22),n._uU(1),n.qZA()),2&h){const R=y.$implicit;n.Q6J("value",R),n.xp6(1),n.hij(" ",R," ")}}let t=(()=>{class h{constructor(R){this._data=R,this.event=new n.vpe,this.form=new e.cw({name:new e.NI(this.option.name||"",[e.kI.required]),group:new e.NI(this.option.group||"",[e.kI.required]),unit_price:new e.NI(this.option.unit_price),multiple:new e.NI(!!this.option.multiple,[])}),this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}saveChanges(){this.loading=!0;const R={...this.option,id:this.option.id||`option-${(0,i.Iy)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new _.U({...this._data.parent,options:this._data.parent.options.filter(Q=>Q.id!==R.id).concat([R])})}})}}return h.\u0275fac=function(R){return new(R||h)(n.Y36(I.WI))},h.\u0275cmp=n.Xpm({type:h,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(R,Q){if(1&R&&(n.TgZ(0,"header")(1,"h3",0),n._uU(2),n.qZA(),n.YNc(3,T,3,0,"button",1),n.qZA(),n.YNc(4,r,5,5,"form",2),n.YNc(5,l,3,1,"footer",3),n.YNc(6,c,4,0,"ng-template",null,4,n.W1O),n.TgZ(8,"mat-autocomplete",null,5),n.YNc(10,u,2,2,"mat-option",6),n.qZA()),2&R){const H=n.MAs(7);n.xp6(2),n.hij(" ",Q.option.id?"Edit":"Add"," Item Option "),n.xp6(1),n.Q6J("ngIf",!Q.loading),n.xp6(1),n.Q6J("ngIf",Q.form&&!Q.loading)("ngIfElse",H),n.xp6(1),n.Q6J("ngIf",!Q.loading),n.xp6(5),n.Q6J("ngForOf",Q.types)}},dependencies:[w.sg,w.O5,J.XC,J.ZL,K.ey,I.ZT,I.uh,P.oG,e._Y,e.Fj,e.wV,e.JJ,e.JL,e.sg,e.u,Z.o,U.TO,U.KE,E.lW,N.Nt,G.Ou],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-option-modal.component.ts-angular-inline--104.css.map*/"]}),h})()},4204:(q,S,o)=>{o.d(S,{m:()=>P});var n=o(2560),e=o(4666),I=o(5306),i=o(4522);const _=["catering-order-item",""];function w(Z,U){if(1&Z&&(n.TgZ(0,"div",10),n._uU(1),n.qZA()),2&Z){const E=n.oxw().$implicit;n.xp6(1),n.Oqu(E.name)}}function J(Z,U){if(1&Z&&(n.ynx(0),n.YNc(1,w,2,1,"div",9),n.BQk()),2&Z){const E=U.$implicit;n.xp6(1),n.Q6J("ngIf",E)}}function K(Z,U){if(1&Z){const E=n.EpF();n.ynx(0),n.TgZ(1,"div",1),n._UZ(2,"div",2),n.qZA(),n.TgZ(3,"div",3)(4,"button",4),n.NdJ("click",function(){n.CHM(E);const G=n.oxw();return n.KtG(G.active=!G.active)}),n.TgZ(5,"app-icon"),n._uU(6),n.qZA()()(),n.TgZ(7,"div",5)(8,"div",6),n._uU(9),n.qZA(),n.TgZ(10,"div",7),n.YNc(11,J,2,1,"ng-container",8),n.qZA()(),n.BQk()}if(2&Z){const E=n.oxw();n.xp6(4),n.ekj("bg-success",E.active)("text-white",E.active)("border-solid",E.active),n.xp6(2),n.Oqu(E.active?"done":"local_pizza"),n.xp6(3),n.Oqu(null==E.item?null:E.item.name),n.xp6(2),n.Q6J("ngForOf",E.item.options)}}let P=(()=>{class Z{constructor(){this.active=!1}}return Z.\u0275fac=function(E){return new(E||Z)},Z.\u0275cmp=n.Xpm({type:Z,selectors:[["","catering-order-item",""]],inputs:{item:"item"},attrs:_,decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-20","text-right","h-14","relative"],[1,"border-b-2","border-l-2","border-gray-400","dark:border-neutral-500","w-4","h-16","absolute","top-1/2","left-1/2","-translate-y-full"],[1,"w-12","mr-4"],["action","","mat-icon-button","",1,"border","border-gray-300","dark:border-neutral-500","border-dashed","text-xl","text-dark-fade","p-2",3,"click"],[1,"flex","flex-1","border-b","border-gray-300","dark:border-neutral-500","border-solid","py-4"],[1,"flex-1"],[1,"flex","space-x-2","mr-2"],[4,"ngFor","ngForOf"],["class","text-xs py-1 px-2 bg-yellow-300 text-black rounded-2xl shadow",4,"ngIf"],[1,"text-xs","py-1","px-2","bg-yellow-300","text-black","rounded-2xl","shadow"]],template:function(E,N){1&E&&n.YNc(0,K,12,9,"ng-container",0),2&E&&n.Q6J("ngIf",N.item)},dependencies:[e.sg,e.O5,I.o,i.lW],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--109.css.map*/"]}),Z})()},2189:(q,S,o)=>{o.d(S,{I:()=>K});var n=o(2851),e=o(2560),I=o(4666),i=o(961);function _(P,Z){if(1&P&&(e.TgZ(0,"li",12),e._UZ(1,"catering-order",13),e.qZA()),2&P){const U=Z.$implicit;e.xp6(1),e.Q6J("order",U)}}function w(P,Z){1&P&&(e.TgZ(0,"div",14)(1,"p"),e._uU(2,"No Catering Orders"),e.qZA()())}function J(P,Z){1&P&&e._UZ(0,"mat-progress-bar",15)}let K=(()=>{class P{constructor(U){this._orders=U,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(U,E){return E?E.id:void 0}}return P.\u0275fac=function(U){return new(U||P)(e.Y36(n.I))},P.\u0275cmp=e.Xpm({type:P,selectors:[["catering-order-list"]],decls:22,vars:10,consts:[[1,"sticky","top-0","w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-gray-300","bg-white","dark:bg-neutral-800","dark:border-neutral-500"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-gray-300 dark:border-neutral-500",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block opacity-60",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-gray-300","dark:border-neutral-500"],[3,"order"],["empty","",1,"info-block","opacity-60"],["mode","indeterminate",1,"w-full"]],template:function(U,E){if(1&U&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.TgZ(2,"div",2),e._uU(3,"Time"),e.qZA(),e.TgZ(4,"div",3),e._uU(5,"Location"),e.qZA(),e.TgZ(6,"div",4),e._uU(7,"Host"),e.qZA(),e.TgZ(8,"div",2),e._uU(9,"Charge Code"),e.qZA(),e.TgZ(10,"div",5),e._uU(11,"Invoice No."),e.qZA(),e.TgZ(12,"div",6),e._uU(13,"Status"),e.qZA(),e._UZ(14,"div",7),e.qZA(),e.TgZ(15,"ul",8),e.YNc(16,_,2,1,"li",9),e.ALo(17,"async"),e.YNc(18,w,3,0,"div",10),e.ALo(19,"async"),e.qZA(),e.YNc(20,J,1,0,"mat-progress-bar",11),e.ALo(21,"async")),2&U){let N;e.xp6(16),e.Q6J("ngForOf",e.lcZ(17,4,E.order_list))("ngForTrackBy",E.trackByFn),e.xp6(2),e.Q6J("ngIf",!(null!=(N=e.lcZ(19,6,E.order_list))&&N.length)),e.xp6(2),e.Q6J("ngIf",e.lcZ(21,8,E.loading))}},dependencies:[I.sg,I.O5,i.p,I.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--110.css.map*/"]}),P})()},9504:(q,S,o)=>{o.d(S,{W:()=>B});var n=o(1670),e=o(2560),I=o(1484),i=o(1233),_=o(6119),w=o(475),J=o(9112),K=o(8025),P=o(2962),Z=o(5163),U=o(6221),E=o(4666),N=o(5892),G=o(6896),T=o(2508),O=o(5306),x=o(4522),d=o(1708),C=o(2793);function r(f,b){1&f&&(e.TgZ(0,"div",17),e._uU(1," Options Available "),e.qZA())}function l(f,b){if(1&f){const g=e.EpF();e.TgZ(0,"a-counter",18),e.NdJ("ngModelChange",function(W){e.CHM(g);const F=e.oxw().$implicit,$=e.oxw(5);return e.KtG($.updateItemQuantity(F,W))}),e.qZA()}if(2&f){const g=e.oxw().$implicit;e.Q6J("ngModel",g.quantity)}}function c(f,b){if(1&f){const g=e.EpF();e.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),e._uU(4,"remove"),e.qZA()()(),e.TgZ(5,"div",22),e._uU(6),e.qZA(),e.TgZ(7,"button",23),e.NdJ("click",function(){e.CHM(g);const W=e.oxw().$implicit,F=e.oxw(5);return e.KtG(F.addItem(W))}),e.TgZ(8,"app-icon"),e._uU(9,"add"),e.qZA()()()}if(2&f){const g=e.oxw().$implicit;e.xp6(1),e.Q6J("matTooltip",g.quantity?"Items with options must be removed from order confirmation page":""),e.xp6(1),e.Q6J("disabled",!0),e.xp6(4),e.hij(" ",g.quantity," ")}}function u(f,b){if(1&f&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div",12),e._uU(3),e.qZA(),e.YNc(4,r,2,0,"div",13),e.qZA(),e.TgZ(5,"div",14),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.YNc(8,l,1,1,"a-counter",15),e.YNc(9,c,10,3,"div",16),e.qZA()),2&f){const g=b.$implicit,D=e.oxw(5);e.xp6(3),e.hij(" ",g.name," "),e.xp6(1),e.Q6J("ngIf",g.options.length),e.xp6(2),e.hij(" ",e.xi3(7,5,g.unit_price/100,D.code)," "),e.xp6(2),e.Q6J("ngIf",!g.options.length),e.xp6(1),e.Q6J("ngIf",g.options.length)}}const t=function(){return{}};function h(f,b){if(1&f&&(e.TgZ(0,"mat-tab",8)(1,"div",9),e.YNc(2,u,10,8,"div",10),e.qZA()()),2&f){const g=e.oxw().$implicit,D=e.oxw(3);e.Q6J("label",g),e.xp6(2),e.Q6J("ngForOf",(D.menu_items||e.DdM(2,t))[g])}}function y(f,b){if(1&f&&(e.ynx(0),e.YNc(1,h,3,3,"mat-tab",7),e.BQk()),2&f){const g=b.$implicit,D=e.oxw(3);e.xp6(1),e.Q6J("ngIf",(D.menu_items||e.DdM(1,t))[g].length)}}function R(f,b){if(1&f&&(e.ynx(0),e.TgZ(1,"mat-tab-group"),e.YNc(2,y,2,2,"ng-container",6),e.qZA(),e.BQk()),2&f){const g=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",g.categories)}}function Q(f,b){if(1&f&&(e.TgZ(0,"div",4),e.YNc(1,R,3,1,"ng-container",5),e.qZA()),2&f){const g=e.oxw(),D=e.MAs(5);e.xp6(1),e.Q6J("ngIf",!g.show_order_details)("ngIfElse",D)}}function H(f,b){if(1&f){const g=e.EpF();e.ynx(0),e.TgZ(1,"button",26),e._uU(2," Cancel "),e.qZA(),e.TgZ(3,"button",27),e.NdJ("click",function(){e.CHM(g);const W=e.oxw(2);return e.KtG(W.show_order_details=!0)}),e._uU(4," Confirm "),e.qZA(),e.BQk()}if(2&f){const g=e.oxw(2);e.xp6(3),e.Q6J("disabled",!g.order.item_count)("matBadge",g.order.item_count)("matBadgeHidden",!g.order.item_count)}}function z(f,b){if(1&f){const g=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(g);const W=e.oxw(2);return e.KtG(W.show_order_details=!1)}),e._uU(1," Back "),e.qZA(),e.TgZ(2,"button",29),e.NdJ("click",function(){e.CHM(g);const W=e.oxw(2);return e.KtG(W.saveOrder())}),e._uU(3," Save Order "),e.qZA()}}function V(f,b){if(1&f&&(e.TgZ(0,"footer",24),e.YNc(1,H,5,3,"ng-container",5),e.YNc(2,z,4,0,"ng-template",null,25,e.W1O),e.qZA()),2&f){const g=e.MAs(3),D=e.oxw();e.xp6(1),e.Q6J("ngIf",!D.show_order_details)("ngIfElse",g)}}function tt(f,b){if(1&f&&(e.TgZ(0,"div",30),e._UZ(1,"mat-spinner",31),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&f){const g=e.oxw();e.xp6(3),e.Oqu(g.loading)}}function et(f,b){if(1&f&&(e.TgZ(0,"div",37),e._uU(1),e.qZA()),2&f){const g=e.oxw().$implicit,D=e.oxw(2);e.Q6J("matTooltip",D.optionsFor(g)),e.xp6(1),e.AsE(" ",g.options.length," option",1===g.options.length?"":"s"," selected ")}}function L(f,b){if(1&f){const g=e.EpF();e.TgZ(0,"div",34)(1,"div",12)(2,"div",12),e._uU(3),e.qZA(),e.YNc(4,et,2,3,"div",35),e.qZA(),e.TgZ(5,"div",14),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"a-counter",36),e.NdJ("ngModelChange",function(W){const $=e.CHM(g).$implicit,k=e.oxw(2);return e.KtG(k.updateItemQuantity($,W))}),e.qZA()()}if(2&f){const g=b.$implicit,D=e.oxw(2);e.xp6(3),e.Oqu(g.name),e.xp6(1),e.Q6J("ngIf",g.options.length),e.xp6(2),e.hij(" ",e.xi3(7,4,g.total_cost/100,D.code)," "),e.xp6(2),e.Q6J("ngModel",g.quantity)}}function Y(f,b){if(1&f&&(e.TgZ(0,"header",32)(1,"h3"),e._uU(2,"Confirm Order"),e.qZA()(),e.TgZ(3,"div",9),e.YNc(4,L,9,7,"div",33),e.qZA()),2&f){const g=e.oxw();e.xp6(4),e.Q6J("ngForOf",g.order.items)}}function v(f,b,g){let D=!0;for(const W of b)if(f.category===W.name||f.tags.includes(W.name)||g.space?.zones.includes(W.name)||"*"===W.name){let F=0;for(const $ of W.rules){const k=new Date(g.date);switch($[0]){case"after_hour":F+=(0,i.Z)(k,(0,_.Z)(k,$[1]))?1:0;break;case"before_hour":F+=(0,w.Z)(k,(0,_.Z)(k,$[1]))?1:0;break;case"min_length":F+=g.duration>=(0,K.H1)($[1])?1:0;break;case"max_length":F+=g.duration<=(0,K.H1)($[1])?1:0;break;case"visitor_type":F+=g.ext("visitor_type")===$[1]?1:0;break;default:F++}}D=F>=W.rules.length}return D}let B=(()=>{class f extends J.KG{constructor(g,D){super(),this._org=g,this._data=D,this.event=new e.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}get code(){return this._org.currency_code}ngOnInit(){var g=this;return(0,n.Z)(function*(){g.loading="Loading menu...",g.order=new Z.G(g._data.order),g.rules=yield g._data.getCateringConfig(g.order.event?.space?.level?.parent_id),g._data.menu.subscribe(D=>{g.loading="Loading menu...";const W=(0,J.Tw)(D.map($=>$.category)),F={};for(const $ of W)F[$]=D.filter(k=>k.category===$&&v(k,g.rules,g.order.event));g.categories=W,g.menu_items=F,g.updateMenuQuantities(),g.timeout("clear_loading",()=>g.loading="",1e3)})})()}addItem(g,D=!0){const W=this.order.items.find(F=>F.id===g.id&&F.options.length===F.options.reduce(($,k)=>$+(g.options.find(it=>k.id===it.id)?1:0),0));D&&g.options?.length?this._data.selectOptions(g.options).then(F=>{const $=new P.U({...g,options:F});this.addItem($,!1)}):this.order=new Z.G(W?{...this.order,items:this.order.items.filter(F=>!(F.id===g.id&&F.options_string===g.options_string)).concat([new P.U({...g,quantity:W.quantity+1})])}:{...this.order,items:this.order.items.concat([new P.U({...g,quantity:1})])}),this.updateMenuQuantities()}removeItem(g){this.order=new Z.G({...this.order,items:this.order.items.filter(D=>D.id!==g.id&&D.options_string===g.options_string)}),this.updateMenuQuantities()}updateItemQuantity(g,D){const W=this.order.items.find($=>$.id===g.id&&$.options_string===g.options_string);let F=[...this.order.items];F=W?this.order.items.filter($=>!($.id===g.id&&$.options_string===g.options_string)).concat([new P.U({...g,quantity:D})]):this.order.items.concat([new P.U({...g,quantity:D})]),F.sort(($,k)=>$.name.localeCompare(k.name)),this.order=new Z.G({...this.order,items:F}),this.updateMenuQuantities()}updateMenuQuantities(){for(const g in this.menu_items)for(const D of this.menu_items[g])D.quantity=this.order.items.reduce((W,F)=>F.id===D.id?W+F.quantity:W,0)}optionsFor(g){return g.options.map(D=>D.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return f.\u0275fac=function(g){return new(g||f)(e.Y36(U.w7),e.Y36(I.WI))},f.\u0275cmp=e.Xpm({type:f,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[e.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(g,D){if(1&g&&(e.YNc(0,Q,2,2,"div",0),e.YNc(1,V,4,2,"footer",1),e.YNc(2,tt,4,1,"ng-template",null,2,e.W1O),e.YNc(4,Y,5,1,"ng-template",null,3,e.W1O)),2&g){const W=e.MAs(3);e.Q6J("ngIf",!D.loading)("ngIfElse",W),e.xp6(1),e.Q6J("ngIf",!D.loading)}},dependencies:[E.sg,E.O5,N.SP,N.uX,I.ZT,G.gM,T.Fj,T.JJ,T.On,O.o,x.lW,d.Ou,C.R,E.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--105.css.map*/"]}),f})()},3129:(q,S,o)=>{o.d(S,{R:()=>x});var n=o(2560),e=o(1484),I=o(3245),i=o(4666),_=o(4792),w=o(2922),J=o(2508),K=o(5306),P=o(4522);function Z(d,C){if(1&d&&(n.TgZ(0,"div",18),n._uU(1),n.ALo(2,"currency"),n.qZA()),2&d){const r=n.oxw().$implicit,l=n.oxw(3);n.xp6(1),n.hij(" +",n.xi3(2,1,r.unit_price/100,l.code)," ")}}function U(d,C){if(1&d&&(n.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),n._uU(3),n.qZA(),n.YNc(4,Z,3,4,"div",17),n.qZA()()),2&d){const r=C.$implicit;n.Q6J("value",r.id),n.xp6(3),n.hij(" ",r.name," "),n.xp6(1),n.Q6J("ngIf",r.unit_price)}}function E(d,C){if(1&d){const r=n.EpF();n.ynx(0),n.TgZ(1,"mat-radio-group",10),n.NdJ("ngModelChange",function(c){n.CHM(r);const u=n.oxw().$implicit,t=n.oxw();return n.KtG(t.updateGroupOption(u,c))}),n.TgZ(2,"mat-radio-button",11)(3,"span",12),n._uU(4,"None"),n.qZA()(),n.YNc(5,U,5,3,"mat-radio-button",13),n.qZA(),n.BQk()}if(2&d){const r=n.oxw().$implicit;n.xp6(5),n.Q6J("ngForOf",null==r?null:r.options)}}function N(d,C){if(1&d&&(n.TgZ(0,"div",18),n._uU(1),n.ALo(2,"currency"),n.qZA()),2&d){const r=n.oxw().$implicit,l=n.oxw(3);n.xp6(1),n.hij(" +",n.xi3(2,1,r.unit_price/100,l.code)," ")}}function G(d,C){if(1&d){const r=n.EpF();n.TgZ(0,"mat-checkbox",20),n.NdJ("ngModelChange",function(c){const t=n.CHM(r).$implicit,h=n.oxw(3);return n.KtG(h.option_state[t.id]=c)}),n.TgZ(1,"div",15)(2,"div",16),n._uU(3),n.qZA(),n.YNc(4,N,3,4,"div",17),n.qZA()()}if(2&d){const r=C.$implicit,l=n.oxw(3);n.Q6J("ngModel",l.option_state[r.id]),n.xp6(3),n.hij(" ",r.name," "),n.xp6(1),n.Q6J("ngIf",r.unit_price)}}function T(d,C){if(1&d&&n.YNc(0,G,5,3,"mat-checkbox",19),2&d){const r=n.oxw().$implicit;n.Q6J("ngForOf",null==r?null:r.options)}}function O(d,C){if(1&d&&(n.TgZ(0,"div",5)(1,"div",6),n._uU(2),n.qZA(),n.TgZ(3,"div",7),n.YNc(4,E,6,1,"ng-container",8),n.YNc(5,T,1,1,"ng-template",null,9,n.W1O),n.qZA()()),2&d){const r=C.$implicit,l=n.MAs(6);n.uIk("group",r.name),n.xp6(2),n.Oqu(r.name),n.xp6(2),n.Q6J("ngIf",!r.multiple)("ngIfElse",l)}}let x=(()=>{class d{constructor(r){this._data=r,this.event=new n.vpe,this.option_state={},this.code=this._data.code;const l=(0,I.Tw)(this._data.options.map(u=>u.group||"Other")),c=[];for(const u of l){const t=this._data.options.filter(h=>h.group===u);c.push({name:u,multiple:!!t.find(h=>h.multiple),options:t})}this.groups=c}updateGroupOption(r,l){for(const c of r.options)this.option_state[c.id]=c.id===l}saveOptions(){const r=this._data.options.filter(l=>this.option_state[l.id]);this.event.emit({reason:"done",metadata:{options:r}})}}return d.\u0275fac=function(r){return new(r||d)(n.Y36(e.WI))},d.\u0275cmp=n.Xpm({type:d,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(r,l){1&r&&(n.TgZ(0,"header")(1,"h3"),n._uU(2,"Select options"),n.qZA(),n.TgZ(3,"button",0)(4,"app-icon"),n._uU(5,"close"),n.qZA()()(),n.TgZ(6,"main",1),n.YNc(7,O,7,4,"div",2),n.qZA(),n.TgZ(8,"footer",3)(9,"button",4),n.NdJ("click",function(){return l.saveOptions()}),n._uU(10," Save "),n.qZA()()),2&r&&(n.xp6(7),n.Q6J("ngForOf",l.groups))},dependencies:[i.sg,i.O5,e.ZT,_.oG,w.VQ,w.U0,J.JJ,J.On,K.o,P.lW,i.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--106.css.map*/"]}),d})()},961:(q,S,o)=>{o.d(S,{p:()=>T});var n=o(9112),e=o(2851),i=(o(5163),o(2460)),_=o(2560),w=o(4666),J=o(8589),K=o(5306),P=o(4522),Z=o(4204);function U(O,x){if(1&O){const d=_.EpF();_.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),_._uU(4,"room_service"),_.qZA()()(),_.TgZ(5,"div",7),_._uU(6),_.ALo(7,"date"),_.qZA(),_.TgZ(8,"div",8),_._uU(9),_.qZA(),_.TgZ(10,"div",9),_._uU(11),_.qZA(),_.TgZ(12,"div",10),_._uU(13),_.qZA(),_.TgZ(14,"div",11),_._uU(15),_.qZA(),_.TgZ(16,"div",12)(17,"button",13)(18,"div",14),_._uU(19),_.qZA(),_.TgZ(20,"app-icon",15),_._uU(21,"arrow_drop_down"),_.qZA()()(),_.TgZ(22,"div",16)(23,"button",17),_.NdJ("click",function(){_.CHM(d);const r=_.oxw();return _.KtG(r.show_items=!r.show_items)}),_.TgZ(24,"app-icon"),_._uU(25),_.qZA()()()()}if(2&O){const d=_.oxw(),C=_.MAs(3);_.ekj("bg-gray-100",!d.show_items)("bg-gray-200",d.show_items),_.xp6(1),_.ekj("bg-gray-200",d.show_items)("dark:bg-neutral-700",d.show_items),_.xp6(5),_.hij(" ",_.xi3(7,18,d.order.deliver_at,"shortTime")," "),_.xp6(3),_.hij(" ",(null==d.order.event?null:d.order.event.space.display_name)||(null==d.order.event?null:d.order.event.space.name)||"~ No Location ~"," "),_.xp6(2),_.hij(" ",(null==d.order.event||null==d.order.event.organiser?null:d.order.event.organiser.name)||(null==d.order.event?null:d.order.event.host)||"~ Unknown Host ~"," "),_.xp6(2),_.Oqu(d.order.charge_code||"~ No Code ~"),_.xp6(2),_.hij(" ",d.order.invoice_number||"~ No Invoice ~"," "),_.xp6(2),_.Udp("background",null==d.status?null:d.status.colour),_.Q6J("matMenuTriggerFor",C),_.xp6(2),_.hij(" ",null==d.status?null:d.status.name," "),_.xp6(6),_.Oqu(d.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function E(O,x){1&O&&_._UZ(0,"li",20),2&O&&_.Q6J("item",x.$implicit)}function N(O,x){if(1&O&&(_.TgZ(0,"ul",18),_.YNc(1,E,1,1,"li",19),_.qZA()),2&O){const d=_.oxw();_.ekj("shown",d.show_items),_.Q6J("@show",d.show_items?"show":"hide"),_.xp6(1),_.Q6J("ngForOf",d.order.items)}}function G(O,x){if(1&O){const d=_.EpF();_.TgZ(0,"button",21),_.NdJ("click",function(){const l=_.CHM(d).$implicit,c=_.oxw();return _.KtG(c.updateStatus(l.id))}),_._UZ(1,"div",22),_.TgZ(2,"span",23),_._uU(3),_.qZA()()}if(2&O){const d=x.$implicit;_.xp6(1),_.Udp("background-color",d.colour),_.xp6(2),_.Oqu(d.name)}}let T=(()=>{class O{constructor(d){this._orders=d,this.show_items=!1,this.statuses=i.U,this.updateStatus=C=>this._orders.updateStatus(this.order,C)}get status(){return this.statuses.find(d=>d.id===this.order.status)}}return O.\u0275fac=function(d){return new(d||O)(_.Y36(e.I))},O.\u0275cmp=_.Xpm({type:O,selectors:[["catering-order"]],inputs:{order:"order"},decls:5,vars:3,consts:[["class","w-full flex items-center py-2 dark:bg-neutral-700",3,"bg-gray-100","bg-gray-200",4,"ngIf"],["class","list-none p-0 m-0 w-full relative z-0",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2","dark:bg-neutral-700"],[1,"w-20","flex","items-center","justify-center","z-20","h-full"],[1,"rounded-full","bg-gray-400","dark:bg-neutral-800","p-2","text-2xl","text-black","dark:text-white","opacity-60","flex","items-center","justify-center"],["time","",1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-24"],[1,"w-28"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["mat-icon-button","",3,"click"],[1,"list-none","p-0","m-0","w-full","relative","z-0"],["catering-order-item","","class","flex items-center",3,"item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(d,C){1&d&&(_.YNc(0,U,26,21,"div",0),_.YNc(1,N,2,4,"ul",1),_.TgZ(2,"mat-menu",null,2),_.YNc(4,G,4,3,"button",3),_.qZA()),2&d&&(_.Q6J("ngIf",C.order),_.xp6(1),_.Q6J("ngIf",null==C.order?null:C.order.items.length),_.xp6(3),_.Q6J("ngForOf",C.statuses))},dependencies:[w.sg,w.O5,J.VK,J.OP,J.p6,K.o,P.lW,Z.m,w.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}\n/*# sourceMappingURL=catering-order.component.ts-angular-inline--111.css.map*/"],data:{animation:[n.X7]}}),O})()},2851:(q,S,o)=>{o.d(S,{I:()=>x});var n=o(4505),e=o(7716),I=o(823),i=o(9095),_=o(6942),w=o(8759),J=o(9128),K=o(1810),P=o(9377),Z=o(3200),U=o(9112),E=o(4211),N=o(3902),G=o(5163),T=o(2560);let x=(()=>{class d extends U.KG{constructor(){super(),this._poll=new n.X(0),this._loading=new n.X(!1),this._filters=new n.X({}),this.orders=(0,e.aj)([this._filters,this._poll]).pipe((0,I.b)(500),(0,i.w)(([r])=>{this._loading.next(!0);const l=(0,K.Z)((0,P.Z)(r.date||Date.now())),c=(0,K.Z)((0,Z.Z)(r.date||Date.now()));return(0,E.u$)({zone_ids:(r.zones||[]).join(","),period_start:l,period_end:c})}),(0,_.U)(r=>(0,U.xH)(r.map(l=>l.ext("catering")))),(0,w.b)(()=>this._loading.next(!1)),(0,J.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,_.U)(r=>r.filter(l=>function O(d,C){const r=(C.search||"").toLowerCase();return!!d.items.find(l=>l.name.toLowerCase().includes(r)||!!l.options.find(c=>c.name.toLowerCase().includes(r)))}(l,this._filters.getValue())))),this.subscription("changes",this.orders.subscribe())}get filters(){return this._filters.getValue()}set filters(r){this._filters.next(r)}startPolling(r=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),r)}stopPolling(){this.clearInterval("polling")}updateStatus(r,l){const c=new G.G({...r,status:l}),u=new N.y({...r.event,catering:[...r.event.ext("catering").filter(t=>t.id!==r.id),c].map(t=>new G.G({...t}))});return(0,E.ry)(u)}}return d.\u0275fac=function(r){return new(r||d)},d.\u0275prov=T.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},729:(q,S,o)=>{o.d(S,{j:()=>x});var n=o(1670),e=o(3690),I=o(4505),i=o(5670),_=o(9112),w=o(6221),J=o(6336),K=o(7413),P=o(2090),Z=o(2962),U=o(5163),E=o(9504),N=o(3129),G=o(5730),T=o(2560),O=o(1484);let x=(()=>{class d extends _.KG{constructor(r,l,c){var u;super(),u=this,this._org=r,this._dialog=l,this._settings=c,this._menu=new I.X([]),this._loading=new I.X(!1),this._currency=new I.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.zone="",this.subscription("building",this._org.active_building.subscribe(function(){var t=(0,n.Z)(function*(h){if(h){const y=(yield u.getCateringForZone(h.id)).map(R=>new Z.U(R));u._currency.next(u._settings.get("app.currency")||h.currency||"USD"),u._menu.next(y)}});return function(h){return t.apply(this,arguments)}}()))}get is_editable(){return!this.zone||this.zone===this._org.building?.id}get categories(){const r=this._menu.getValue();return(0,_.Tw)(r.map(l=>l.category))}manageCateringOrder(r){var l=this;return(0,n.Z)(function*(){const c=l._dialog.open(E.W,{data:{code:l._currency.getValue(),order:r,menu:l.menu,loading:l.loading,getCateringConfig:t=>l.getCateringConfig(t),selectOptions:t=>l.selectOptions(t)}}),u=yield Promise.race([c.componentInstance.event.pipe((0,i.P)(t=>"done"===t.reason)).toPromise(),c.afterClosed().toPromise()]);return c.close(),u?.metadata?.order||r})()}addItem(r=new Z.U){var l=this;return(0,n.Z)(function*(){const c=l._dialog.open(J.w,{data:{item:r,categories:l.categories}}),u=yield Promise.race([c.componentInstance.event.pipe((0,i.P)(y=>"done"===y.reason)).toPromise(),c.afterClosed().toPromise()]);if("done"!==u?.reason)return;const t=l._menu.getValue(),h=t.findIndex(y=>y.id===r.id);h>=0?t.splice(h,1,u.metadata.item):t.push(u.metadata.item),l.updateMenu(l._org.building.id,t).then(()=>{l._menu.next([...t]),c.close()},()=>c.componentInstance.loading=!1)})()}updateItem(r){const l=this._menu.getValue(),c=l.findIndex(u=>u.id===r.id);c>=0?l.splice(c,1,r):l.push(r),this.updateMenu(this._org.building.id,l).then(()=>this._menu.next([...l]))}addOption(r,l={}){var c=this;return(0,n.Z)(function*(){const u=(0,_.Tw)(r.options.map(Q=>Q.group)),t=c._dialog.open(K.M,{data:{parent:r,option:l,types:u}}),h=yield Promise.race([t.componentInstance.event.pipe((0,i.P)(Q=>"done"===Q.reason)).toPromise(),t.afterClosed().toPromise()]);if("done"!==h?.reason)return;const y=c._menu.getValue(),R=y.findIndex(Q=>Q.id===r.id);R>=0?y.splice(R,1,h.metadata.item):y.push(h.metadata.item),c.updateMenu(c._org.building.id,y).then(()=>{c._menu.next([...y]),t.close()},()=>t.componentInstance.loading=!1)})()}selectOptions(r){var l=this;return(0,n.Z)(function*(){const c=l._dialog.open(N.R,{data:{code:l._currency.getValue(),options:r}}),u=yield Promise.race([c.componentInstance.event.pipe((0,i.P)(t=>"done"===t.reason)).toPromise(),c.afterClosed().toPromise()]);return"done"!==u?.reason?[]:(c.close(),u.metadata.options)})()}deleteItem(r){var l=this;return(0,n.Z)(function*(){const c=yield(0,_._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${r.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},l._dialog);if("done"!==c.reason)return;c.loading("Removing catering item...");const u=l._menu.getValue().filter(t=>r.id!==t.id);l.updateMenu(l._org.building.id,u).then(()=>{l._menu.next([...u]),c.close()},()=>c.loading(""))})()}deleteOption(r,l){var c=this;return(0,n.Z)(function*(){const u=yield(0,_._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${l.name}" from "${r.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},c._dialog);if("done"!==u.reason)return;u.loading("Removing catering item option...");const t=c._menu.getValue();t.splice(t.findIndex(h=>h.id===r.id),1,new Z.U({...r,options:r.options.filter(h=>h.id!==l.id)})),c.updateMenu(c._org.building.id,t).then(()=>{c._menu.next([...t]),u.close()},()=>u.loading(""))})()}editConfig(){var r=this;return(0,n.Z)(function*(){const l=yield r.getCateringConfig(r._org.building.id),c=r._menu.getValue(),u=(0,_.Tw)((0,_.xH)(c.map(y=>[y.category,...y.tags]))),t=r._dialog.open(P.S,{data:{config:l,types:u}}),h=yield Promise.race([t.componentInstance.event.pipe((0,i.P)(y=>"done"===y.reason)).toPromise(),t.afterClosed().toPromise()]);"done"===h?.reason&&r.updateConfig(r._org.building.id,h.metadata).then(()=>t.close(),()=>t.componentInstance.loading=!1)})()}importMenu(){var r=this;return(0,n.Z)(function*(){const l=r._dialog.open(G.m),c=yield Promise.race([l.componentInstance.event.pipe((0,i.P)(y=>"done"===y.reason)).toPromise(),l.afterClosed().toPromise()]);if("done"!==c?.reason)return;l.componentInstance.loading="Updating menu...";const u=r._menu.getValue(),t=r._org.building,h=(0,_.Tw)(c.metadata.concat(u),"id");yield r.updateMenu(t.id,h).catch(y=>{throw(0,_.cB)("Error importing catering menu"),l.close(),y}),(0,_.t5)(`Successfully imported catering menu. ${c.metadata.length} item(s) added.`),l.close()})()}updateMenu(r,l){return(0,e.Ymr)(r,{id:r,name:"catering",details:l,description:`Catering menu for ${r}`}).toPromise()}getCateringForZone(r){return(0,n.Z)(function*(){const l=(yield(0,e.rlq)(r,"catering").toPromise()).details;return l instanceof Array?l:[]})()}getCateringConfig(r=this._org.building.id){return(0,n.Z)(function*(){const l=(yield(0,e.rlq)(r,"catering_config").toPromise()).details;return l instanceof Array?l:[]})()}updateConfig(r,l){return(0,e.Ymr)(r,{id:r,name:"catering_config",details:l,description:`Catering menu config for ${r}`}).toPromise()}addItemToOrder(r,l){let c=r.items;const u=c.find(h=>h.id===l.id&&l.options?.length===h.options?.reduce((y,R)=>y+(l.options.find(Q=>R.id===Q.id)?1:0),0));return u?u.quantity+=1:c=c.concat([new Z.U({...l,quantity:1})]),new U.G({...r,items:c,event:null})}}return d.\u0275fac=function(r){return new(r||d)(T.LFG(w.w7),T.LFG(O.uw),T.LFG(_.gb))},d.\u0275prov=T.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},7701:(q,S,o)=>{o.d(S,{g:()=>n});const n=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}]},2460:(q,S,o)=>{o.d(S,{U:()=>n});const n=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map