"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_catering_src_index_ts"],{75566:(z,S,o)=>{o.d(S,{TI:()=>H.T,QB:()=>tt.Q,_I:()=>p._,sp:()=>u,bR:()=>J});var e=o(60316),t=o(34456),M=o(79771),k=o(97024),n=o(12587),F=o(31034),U=o(38223),K=o(53804),B=o(80640),W=o(24950),R=o(41134),y=o(26354),v=o(63046),D=o(24558),f=(o(30807),o(48519),o(37053),o(3872),o(41623),o(82912),o(17707),o(76095),o(11732),o(32499),o(90699),o(26386),o(61601),o(89204)),l=o(77375),_=o(33602),p=o(52201),i=o(7404),d=o(69434),r=o(85060),m=o(87984);function a(V,Z){if(1&V){const j=i.RV6();i.j41(0,"div",6)(1,"mat-form-field",7)(2,"input",8),i.mxI("ngModelChange",function(Y){const Q=i.eBV(j).index,q=i.XpG(2);return i.DH7(q.charge_codes[Q],Y)||(q.charge_codes[Q]=Y),i.Njj(Y)}),i.k0s()(),i.j41(3,"button",9),i.bIt("click",function(){const Y=i.eBV(j).index,Q=i.XpG(2);return i.Njj(Q.removeCode(Y))}),i.j41(4,"app-icon"),i.EFF(5,"delete"),i.k0s()()()}if(2&V){const j=Z.index,X=i.XpG(2);i.R7$(2),i.R50("ngModel",X.charge_codes[j])}}function s(V,Z){if(1&V&&(i.j41(0,"main",4),i.DNE(1,a,6,1,"div",5),i.k0s()),2&V){const j=i.XpG();i.R7$(),i.Y8G("ngForOf",j.charge_codes)("ngForTrackBy",j.trackByFn)}}function C(V,Z){if(1&V){const j=i.RV6();i.j41(0,"footer",10)(1,"button",11),i.EFF(2," Import Codes "),i.j41(3,"input",12),i.bIt("change",function(Y){i.eBV(j);const Q=i.XpG();return i.Njj(Q.addCodesFromFile(Y))}),i.k0s()(),i.j41(4,"button",13),i.bIt("click",function(){i.eBV(j);const Y=i.XpG();return i.Njj(Y.newCode())}),i.EFF(5," Add Code "),i.k0s(),i.j41(6,"button",13),i.bIt("click",function(){i.eBV(j);const Y=i.XpG();return i.Njj(Y.saveChargeCodes())}),i.EFF(7," Save Changes "),i.k0s()()}}function c(V,Z){1&V&&(i.j41(0,"main",14),i.nrm(1,"mat-spinner",15),i.j41(2,"p"),i.EFF(3,"Saving changes to charge codes..."),i.k0s()())}let u=(()=>{class V{constructor(j,X){this._state=j,this._dialog_ref=X,this.charge_codes=[],this.loading=!1}ngOnInit(){var j=this;return(0,f.A)(function*(){j.charge_codes=(yield j._state.charge_codes.pipe((0,_.s)(1)).toPromise())||[]})()}newCode(){this.charge_codes.push("")}removeCode(j){this.charge_codes.splice(j,1)}addCodesFromFile(j){if(j.target){const X=j.target.files[0];if(X){const Y=new FileReader;Y.readAsText(X,"UTF-8"),Y.addEventListener("load",Q=>{const q=(0,l.a6)(Q.srcElement.result)||[];for(const{code:ot}of q)this.charge_codes.push(ot);this.charge_codes=(0,l.Am)(this.charge_codes),j.target.value=""}),Y.addEventListener("error",Q=>(0,l.UG)("Error reading file."))}}}saveChargeCodes(){var j=this;return(0,f.A)(function*(){j.loading=!0;const X=j.charge_codes.filter(Y=>Y&&Y.trim());yield j._state.saveSettings({charge_codes:X}),j._dialog_ref.close()})()}trackByFn(j,X){return j}static#t=this.\u0275fac=function(X){return new(X||V)(i.rXU(p._),i.rXU(n.CP))};static#e=this.\u0275cmp=i.VBU({type:V,selectors:[["charge-code-list-modal"]],decls:10,vars:3,consts:[["load_state",""],["icon","","mat-dialog-close",""],["class","overflow-auto max-h-[65vh] min-h-[20rem] flex flex-col",4,"ngIf","ngIfElse"],["class","flex items-center p-2 space-x-2 border-t border-base-200",4,"ngIf"],[1,"overflow-auto","max-h-[65vh]","min-h-[20rem]","flex","flex-col"],["class","flex items-center space-x-2 w-full hover:bg-neutral px-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","space-x-2","w-full","hover:bg-neutral","px-2"],["appearance","outline",1,"h-14","flex-1"],["matInput","","placeholder","Charge Code",3,"ngModelChange","ngModel"],["icon","",3,"click"],[1,"flex","items-center","p-2","space-x-2","border-t","border-base-200"],["btn","","matRipple","",1,"w-48","inverse","relative"],["type","file",1,"opacity-0","absolute","inset-0",3,"change"],["btn","","matRipple","",1,"w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-20","space-y-2"],["diameter","32"]],template:function(X,Y){if(1&X&&(i.j41(0,"header")(1,"h2"),i.EFF(2,"Edit Charge Codes"),i.k0s(),i.j41(3,"button",1)(4,"app-icon"),i.EFF(5,"close"),i.k0s()()(),i.DNE(6,s,2,2,"main",2)(7,C,8,0,"footer",3)(8,c,4,0,"ng-template",null,0,i.C5r)),2&X){const Q=i.sdS(9);i.R7$(6),i.Y8G("ngIf",!Y.loading)("ngIfElse",Q),i.R7$(),i.Y8G("ngIf",!Y.loading)}},dependencies:[e.Sq,e.bT,n.tx,t.me,t.BC,t.vS,d.R,W.rl,r.r6,m.fg,R.LG]})}return V})();o(89505);let J=(()=>{class V{static#t=this.\u0275fac=function(X){return new(X||V)};static#e=this.\u0275mod=i.$C({type:V});static#n=this.\u0275inj=i.G2t({imports:[e.MD,F.Cn,U.RI,M.jL,n.hM,k.g7,K.Wk,B.uc,t.YN,t.X1,D.h,W.RG,v.cQ,R.D6,y.PO]})}return V})();var H=o(25892),tt=(o(75555),o(98197));o(91074)},76095:(z,S,o)=>{o.d(S,{k:()=>y});var e=o(7404),t=o(77375),M=o(25892),k=o(60316),n=o(12587),F=o(69434),U=o(85060),K=o(41134);function B(v,D){1&v&&(e.j41(0,"button",4)(1,"app-icon"),e.EFF(2,"close"),e.k0s()())}function W(v,D){if(1&v){const P=e.RV6();e.j41(0,"main")(1,"div",5)(2,"app-icon",6),e.EFF(3,"upload"),e.k0s(),e.j41(4,"p"),e.EFF(5,"Click to select file or Drag and drop files"),e.k0s(),e.j41(6,"input",7),e.bIt("change",function(N){e.eBV(P);const E=e.XpG();return e.Njj(E.handleFileEvent(N))}),e.k0s()(),e.j41(7,"div",8)(8,"button",9),e.bIt("click",function(){e.eBV(P);const N=e.XpG();return e.Njj(N.downloadTemplate())}),e.EFF(9," Download Template "),e.k0s()()()}}function R(v,D){if(1&v&&(e.j41(0,"main",10),e.nrm(1,"mat-spinner",11),e.j41(2,"p"),e.EFF(3),e.k0s()()),2&v){const P=e.XpG();e.R7$(3),e.JRh(P.loading)}}let y=(()=>{class v{constructor(){this.event=new e.bkB}handleFileEvent(P){this.loading="Processing menu data...";const $=P.target;if(!$?.files)return this.loading="";const N=$.files;if(!N.length)return this.loading="";const E=N[0],G=new FileReader;G.addEventListener("loadend",h=>{const T=(0,t.a6)(h.target.result);this.loading="",this.event.emit({reason:"done",metadata:T.filter(L=>"item"===(L.type||"").toLowerCase()).map(L=>new M.T({...L,options:T.filter(g=>"option"===(g.type||"").toLowerCase()&&g.tags===L.id).map(g=>({id:g.id,name:g.name,group:g.category,multiple:g.multiple,unit_price:g.unit_price}))}))})}),G.readAsText(E)}downloadTemplate(){(0,t.PE)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}static#t=this.\u0275fac=function($){return new($||v)};static#e=this.\u0275cmp=e.VBU({type:v,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[["load_state",""],[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["icon","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["icon","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-base-200","border-dashed","rounded-xl","hover:bg-base-200","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["matRipple","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function($,N){if(1&$&&(e.j41(0,"header",1)(1,"h2"),e.EFF(2,"Import Catering Menu"),e.k0s(),e.DNE(3,B,3,0,"button",2),e.k0s(),e.DNE(4,W,10,0,"main",3)(5,R,4,1,"ng-template",null,0,e.C5r)),2&$){const E=e.sdS(6);e.R7$(3),e.Y8G("ngIf",!N.loading),e.R7$(),e.Y8G("ngIf",!N.loading)("ngIfElse",E)}},dependencies:[k.bT,n.tx,F.R,U.r6,K.LG]})}return v})()},30807:(z,S,o)=>{o.d(S,{d:()=>p});var e=o(74879),t=o(7404),M=o(34456),k=o(12587),n=o(77375),F=o(25892),U=o(60316),K=o(79771),B=o(85060),W=o(97024),R=o(69434),y=o(24950),v=o(87984),D=o(41134),P=o(12772),$=o(55507),N=o(56864);const E=()=>({standalone:!0});function G(i,d){1&i&&(t.j41(0,"button",9)(1,"app-icon"),t.EFF(2,"close"),t.k0s()())}function h(i,d){if(1&i&&(t.j41(0,"div",20)(1,"label",21),t.EFF(2," Name"),t.j41(3,"span"),t.EFF(4,"*"),t.k0s(),t.EFF(5,": "),t.k0s(),t.j41(6,"mat-form-field",22),t.nrm(7,"input",23),t.j41(8,"mat-error"),t.EFF(9,"Name is required"),t.k0s()()()),2&i){const r=t.XpG(2);t.R7$(),t.AVh("error",r.form.controls.name.invalid&&r.form.controls.name.touched)}}function x(i,d){if(1&i&&(t.j41(0,"div",20)(1,"label",24),t.EFF(2," Category"),t.j41(3,"span"),t.EFF(4,"*"),t.k0s(),t.EFF(5,": "),t.k0s(),t.j41(6,"mat-form-field",22),t.nrm(7,"input",25),t.j41(8,"mat-error"),t.EFF(9,"Category is required"),t.k0s()()()),2&i){const r=t.XpG(2),m=t.sdS(9);t.R7$(),t.AVh("error",r.form.controls.category.invalid&&r.form.controls.category.touched),t.R7$(6),t.Y8G("matAutocomplete",m)}}function T(i,d){if(1&i){const r=t.RV6();t.j41(0,"mat-chip-row",30),t.bIt("removed",function(){const a=t.eBV(r).$implicit,s=t.XpG(3);return t.Njj(s.removeTag(a))}),t.EFF(1),t.j41(2,"button",31)(3,"app-icon"),t.EFF(4,"cancel"),t.k0s()()()}if(2&i){const r=d.$implicit;t.R7$(),t.SpI(" ",r," "),t.R7$(),t.BMQ("aria-label","Remove "+r)}}function L(i,d){if(1&i){const r=t.RV6();t.j41(0,"div",20)(1,"label",26),t.pXf(2,3),t.k0s(),t.j41(3,"mat-form-field",22)(4,"mat-chip-grid",27,2),t.DNE(6,T,5,2,"mat-chip-row",28),t.k0s(),t.j41(7,"input",29),t.bIt("matChipInputTokenEnd",function(a){t.eBV(r);const s=t.XpG(2);return t.Njj(s.addTag(a))}),t.k0s()()()}if(2&i){const r=t.sdS(5),m=t.XpG(2);t.R7$(),t.AVh("error",m.form.controls.tags.invalid&&m.form.controls.tags.touched),t.R7$(5),t.Y8G("ngForOf",m.tag_list),t.R7$(),t.Y8G("matChipInputFor",r)("matChipInputSeparatorKeyCodes",m.separators)("matChipInputAddOnBlur",!0)}}function g(i,d){1&i&&(t.j41(0,"div",20)(1,"label",32),t.EFF(2,"Description:"),t.k0s(),t.j41(3,"mat-form-field",22),t.nrm(4,"textarea",33),t.k0s()())}function I(i,d){if(1&i&&(t.j41(0,"div",20)(1,"label",21),t.EFF(2," Unit Price"),t.j41(3,"span"),t.EFF(4,"*"),t.k0s(),t.EFF(5,": "),t.k0s(),t.j41(6,"mat-form-field",22),t.nrm(7,"input",34),t.j41(8,"mat-error"),t.EFF(9,"Unit Price is required"),t.k0s()()()),2&i){const r=t.XpG(2);t.R7$(),t.AVh("error",r.form.controls.unit_price.invalid&&r.form.controls.unit_price.touched)}}function O(i,d){1&i&&(t.j41(0,"div",20)(1,"label",35),t.pXf(2,4),t.k0s(),t.nrm(3,"image-list-field",36),t.k0s())}function A(i,d){if(1&i){const r=t.RV6();t.j41(0,"form",10)(1,"div",11),t.DNE(2,h,10,2,"div",12)(3,x,10,3,"div",12),t.k0s(),t.DNE(4,L,8,6,"div",12)(5,g,5,0,"div",12)(6,I,10,2,"div",12),t.j41(7,"div",13)(8,"label",14),t.EFF(9,"Accept Points?"),t.k0s(),t.j41(10,"mat-checkbox",15),t.EFF(11),t.k0s()(),t.j41(12,"div",16)(13,"mat-checkbox",17),t.bIt("ngModelChange",function(a){t.eBV(r);const s=t.XpG();return t.Njj(a?s.addTag({value:"Gluten Free"}):s.removeTag("Gluten Free"))}),t.EFF(14," Gluten Free (GF) "),t.k0s(),t.j41(15,"mat-checkbox",17),t.bIt("ngModelChange",function(a){t.eBV(r);const s=t.XpG();return t.Njj(a?s.addTag({value:"Vegan"}):s.removeTag("Vegan"))}),t.EFF(16," Vegan (VG) "),t.k0s(),t.j41(17,"mat-checkbox",17),t.bIt("ngModelChange",function(a){t.eBV(r);const s=t.XpG();return t.Njj(a?s.addTag({value:"Vegetarian"}):s.removeTag("Vegetarian"))}),t.EFF(18," Vegetarian (V) "),t.k0s(),t.j41(19,"mat-checkbox",17),t.bIt("ngModelChange",function(a){t.eBV(r);const s=t.XpG();return t.Njj(a?s.addTag({value:"Contains Dairy"}):s.removeTag("Contains Dairy"))}),t.EFF(20," Contains Dairy (D) "),t.k0s(),t.j41(21,"mat-checkbox",17),t.bIt("ngModelChange",function(a){t.eBV(r);const s=t.XpG();return t.Njj(a?s.addTag({value:"Contains Nuts"}):s.removeTag("Contains Nuts"))}),t.EFF(22," Contains Nuts (N) "),t.k0s()(),t.j41(23,"div",13)(24,"label",18),t.EFF(25,"Discount Cap"),t.k0s(),t.nrm(26,"a-counter",19),t.k0s(),t.DNE(27,O,4,0,"div",12),t.k0s()}if(2&i){let r;const m=t.XpG();t.Y8G("formGroup",m.form),t.R7$(2),t.Y8G("ngIf",m.form.controls.name),t.R7$(),t.Y8G("ngIf",m.form.controls.category),t.R7$(),t.Y8G("ngIf",m.form.controls.tags),t.R7$(),t.Y8G("ngIf",m.form.controls.description),t.R7$(),t.Y8G("ngIf",m.form.controls.unit_price),t.R7$(5),t.JRh(null!=(r=m.form.get("accept_points"))&&r.value?"No":"Yes"),t.R7$(2),t.Y8G("ngModel",m.hasTag("Gluten Free"))("ngModelOptions",t.lJ4(22,E)),t.R7$(2),t.Y8G("ngModel",m.hasTag("Vegan"))("ngModelOptions",t.lJ4(23,E)),t.R7$(2),t.Y8G("ngModel",m.hasTag("Vegetarian"))("ngModelOptions",t.lJ4(24,E)),t.R7$(2),t.Y8G("ngModel",m.hasTag("Contains Dairy"))("ngModelOptions",t.lJ4(25,E)),t.R7$(2),t.Y8G("ngModel",m.hasTag("Contains Nuts"))("ngModelOptions",t.lJ4(26,E)),t.R7$(5),t.Y8G("min",0)("max",100)("step",5)("render_fn",m.renderPercent),t.R7$(),t.Y8G("ngIf",m.form.controls.images)}}function f(i,d){if(1&i){const r=t.RV6();t.j41(0,"footer",37)(1,"button",38),t.bIt("click",function(){t.eBV(r);const a=t.XpG();return t.Njj(a.saveChanges())}),t.EFF(2," Save "),t.k0s()()}if(2&i){const r=t.XpG();t.R7$(),t.Y8G("disabled",!r.form.dirty)}}function l(i,d){1&i&&(t.j41(0,"div",39),t.nrm(1,"mat-spinner",40),t.j41(2,"p"),t.EFF(3,"Saving catering item..."),t.k0s()())}function _(i,d){if(1&i&&(t.j41(0,"mat-option",41),t.EFF(1),t.k0s()),2&i){const r=d.$implicit;t.Y8G("value",r),t.R7$(),t.SpI(" ",r," ")}}let p=(()=>{class i{get item(){return this._data.item||new F.T}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(r=0){return`${r}%`}hasTag(r){return this.tag_list.includes(r)}constructor(r){this._data=r,this.event=new t.bkB,this.form=new M.gE({name:new M.MJ(this.item.name||"",[M.k0.required]),description:new M.MJ(this.item.description||""),category:new M.MJ(this.item.category||"",[M.k0.required]),unit_price:new M.MJ(this.item.unit_price,[M.k0.required]),tags:new M.MJ(this.item.tags||[]),accept_points:new M.MJ(this.item.accept_points||!1),discount_cap:new M.MJ(this.item.discount_cap||0),images:new M.MJ(this.item.images||[])}),this.loading=!1,this.separators=[e.Fm,e.KE,e.t6]}addTag(r){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const m=r.input,a=r.value,s=this.tag_list;(a||"").trim()&&(s.push(a),this.form.controls.tags.setValue(s)),m&&(m.value="")}removeTag(r){if(!this.form||!this.form.controls.tags)return;const m=this.tag_list;this.form.controls.tags.markAsDirty();const a=m.indexOf(r);a>=0&&(m.splice(a,1),this.form.controls.tags.setValue(m))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new F.T({...this.item,id:this.item.id||`item-${(0,n.HO)(99999999)}`,...this.form.value})}})}static#t=this.\u0275fac=function(m){return new(m||i)(t.rXU(k.Vh))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:()=>{let r,m,a;return r=$localize`:@@zoneTagsPlaceholder␟c133beffffe3288bbdbf8572a32910c33ce14991␟2194594490376201833:Item tags e.g. Gluten Free, Vegan etc.`,m=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,a=$localize`:@@imagesLabel␟e5d9e00faa06714d7671b164cad364b26f4c585b␟5137125764814732349:Images:`,[["load_state",""],["auto","matAutocomplete"],["chipList",""],m,a,["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-base-200",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],[1,"flex","items-center","space-x-2"],["class","flex flex-col",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],["list","",1,"flex","items-center","flex-wrap","max-w-lg"],[3,"ngModelChange","ngModel","ngModelOptions"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-base-200","rounded",3,"min","max","step","render_fn"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],["aria-label","Item Tags"],[3,"removed",4,"ngFor","ngForOf"],["name","tags","placeholder",r,3,"matChipInputTokenEnd","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur"],[3,"removed"],["matChipRemove",""],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["for","images"],["name","images","formControlName","images"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-base-200"],["btn","","matRipple","",3,"click","disabled"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(m,a){if(1&m&&(t.j41(0,"header")(1,"h3"),t.EFF(2),t.k0s(),t.DNE(3,G,3,0,"button",5),t.k0s(),t.DNE(4,A,28,27,"form",6)(5,f,3,1,"footer",7)(6,l,4,0,"ng-template",null,0,t.C5r),t.j41(8,"mat-autocomplete",null,1),t.DNE(10,_,2,2,"mat-option",8),t.k0s()),2&m){const s=t.sdS(7);t.R7$(2),t.SpI("",a.item.id?"Edit":"Add"," Item"),t.R7$(),t.Y8G("ngIf",!a.loading),t.R7$(),t.Y8G("ngIf",a.form&&!a.loading)("ngIfElse",s),t.R7$(),t.Y8G("ngIf",!a.loading),t.R7$(5),t.Y8G("ngForOf",a.categories)}},dependencies:[U.Sq,U.bT,K.$3,B.wT,K.pN,k.tx,W.So,M.qT,M.me,M.Q0,M.BC,M.cb,M.vS,M.j4,M.JD,R.R,y.rl,y.TL,B.r6,v.fg,D.LG,P.HW,P.D7,P.Zv,P.jH,$.s,N.$],styles:["[list][_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin:.5rem}\n\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--54.css.map*/"]})}return i})()},48519:(z,S,o)=>{o.d(S,{o:()=>A});var e=o(52201),t=o(25892),M=o(77375),k=o(98197),n=o(7404),F=o(60316),U=o(31034),K=o(97024),B=o(80640),W=o(34456),R=o(69434),y=o(88328),v=o(85060);const D=f=>({key:"active",name:" ",content:f,size:"3.5rem",sortable:!1}),P=()=>({key:"name",name:"Name"}),$=()=>({key:"category",name:"Category"}),N=f=>({key:"unit_price",name:"Price",content:f,size:"6rem"}),E=f=>({key:"actions",name:" ",content:f,size:"6.5rem",sortable:!1}),G=(f,l,_,p,i)=>[f,l,_,p,i];function h(f,l){if(1&f){const _=n.RV6();n.j41(0,"mat-checkbox",6),n.bIt("ngModelChange",function(i){const d=n.eBV(_).row,r=n.XpG();return n.Njj(r.setEnabled(d,i))}),n.k0s()}if(2&f){const _=l.row,p=n.XpG();n.Y8G("ngModel",p.isEnabled(_))}}function x(f,l){if(1&f&&(n.j41(0,"div",7),n.EFF(1),n.nI1(2,"async"),n.nI1(3,"currency"),n.k0s()),2&f){const _=l.data,p=n.XpG();n.R7$(),n.SpI(" ",n.i5U(3,3,_/100,n.bMT(2,1,p.symbol))," ")}}function T(f,l){if(1&f){const _=n.RV6();n.j41(0,"div",8)(1,"button",9)(2,"app-icon"),n.EFF(3,"more_vert"),n.k0s()(),n.j41(4,"mat-menu",null,4)(6,"button",10),n.bIt("click",function(){const i=n.eBV(_).row,d=n.XpG();return n.Njj(d.addOption(i))}),n.j41(7,"div",11)(8,"app-icon"),n.EFF(9,"add"),n.k0s(),n.j41(10,"div"),n.EFF(11,"Add Option"),n.k0s()()(),n.j41(12,"button",10),n.bIt("click",function(){const i=n.eBV(_).row,d=n.XpG();return n.Njj(d.editItem(i))}),n.j41(13,"div",11)(14,"app-icon"),n.EFF(15,"edit"),n.k0s(),n.j41(16,"div"),n.EFF(17,"Edit Item"),n.k0s()()(),n.j41(18,"button",10),n.bIt("click",function(){const i=n.eBV(_).row,d=n.XpG();return n.Njj(d.removeItem(i))}),n.j41(19,"div",11)(20,"app-icon",12),n.EFF(21,"delete"),n.k0s(),n.j41(22,"div"),n.EFF(23,"Remove Item"),n.k0s()()()(),n.j41(24,"button",13),n.bIt("click",function(){const i=n.eBV(_).row,d=n.XpG();return n.Njj(d.show_children[i.id]=!d.show_children[i.id])}),n.j41(25,"app-icon"),n.EFF(26),n.k0s()()()}if(2&f){const _=l.row,p=n.sdS(5),i=n.XpG();n.R7$(),n.AVh("opacity-0",!i.can_edit),n.Y8G("disabled",!i.can_edit)("matMenuTriggerFor",p),n.R7$(23),n.Y8G("disabled",!(null!=_.options&&_.options.length))("matTooltip",null!=_.options&&_.options.length?(i.show_children[_.id]?"Hide":"Show")+" Menu Item Options":""),n.R7$(2),n.SpI(" ",i.show_children[_.id]?"keyboard_arrow_down":"chevron_right"," ")}}function L(f,l){if(1&f){const _=n.RV6();n.j41(0,"button",22),n.bIt("click",function(){n.eBV(_);const i=n.XpG().$implicit,d=n.XpG().row,r=n.XpG();return n.Njj(r.editOption(d,i))}),n.j41(1,"app-icon"),n.EFF(2,"edit"),n.k0s()()}}function g(f,l){if(1&f){const _=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){n.eBV(_);const i=n.XpG().$implicit,d=n.XpG().row,r=n.XpG();return n.Njj(r.removeOption(d,i))}),n.j41(1,"app-icon",12),n.EFF(2,"delete"),n.k0s()()}}function I(f,l){if(1&f&&(n.j41(0,"div",15),n.nrm(1,"div",16),n.j41(2,"div",17)(3,"div",18),n.EFF(4),n.k0s(),n.j41(5,"div",19),n.EFF(6),n.k0s()(),n.DNE(7,L,3,0,"button",20)(8,g,3,0,"button",21),n.k0s()),2&f){const _=l.$implicit,p=n.XpG(2);n.R7$(4),n.JRh(_.name),n.R7$(2),n.SpI(" ",_.group," "),n.R7$(),n.Y8G("ngIf",p.can_edit),n.R7$(),n.Y8G("ngIf",p.can_edit)}}function O(f,l){1&f&&n.DNE(0,I,9,4,"div",14),2&f&&n.Y8G("ngForOf",l.row.options)}let A=(()=>{class f{get filters(){return this._orders.filters}get can_edit(){return this._catering.is_editable}get categories(){return this._catering.categories}constructor(_,p){this._catering=_,this._orders=p,this.show_children={},this.menu=this._catering.menu,this.addOption=i=>this._catering.addOption(i),this.editOption=(i,d)=>this._catering.addOption(i,d),this.removeOption=(i,d)=>this._catering.deleteOption(i,d),this.editItem=i=>this._catering.addItem(i),this.removeItem=i=>this._catering.deleteItem(i)}isEnabled(_){return!_.hide_for_zones.includes(this._catering.zone)}setEnabled(_,p){let i=_.hide_for_zones;i=p?i.filter(d=>d!==this._catering.zone):(0,M.Am)([...i,this._catering.zone]),this._catering.updateItem(new t.T({..._,hide_for_zones:i}))}static#t=this.\u0275fac=function(p){return new(p||f)(n.rXU(e._),n.rXU(k.Q))};static#e=this.\u0275cmp=n.VBU({type:f,selectors:[["catering-menu"]],decls:9,vars:20,consts:[["active_template",""],["price_template",""],["actions_template",""],["child_template",""],["menu","matMenu"],["empty_message","No Items in Menu",1,"w-full","min-w-[32rem]","block","text-sm",3,"data","columns","filter","show_children","child_template","sortable"],["matTooltip","Allow Ordering Item for this zone","matTooltipPosition","right",1,"mx-auto",3,"ngModelChange","ngModel"],[1,"px-2","py-1","font-mono","text-xs","flex","items-center","mx-auto","bg-secondary","text-secondary-content","rounded"],[1,"p-2","flex","items-center","mx-auto","space-x-2"],["icon","","matRipple","",3,"disabled","matMenuTriggerFor"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"flex","items-center","space-x-2","pr-2"],[1,"text-error"],["icon","","matRipple","",3,"click","disabled","matTooltip"],["class","flex p-2 items-center border-b border-solid border-base-200 relative space-x-2",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-b","border-solid","border-base-200","relative","space-x-2"],[1,"absolute","inset-y-0","left-0","w-2","bg-black","opacity-10"],[1,"flex-1","pl-4","pr-2"],[1,"text"],[1,"text-xs","opacity-60"],["icon","","matRipple","","matTooltip","Edit Menu Item Option",3,"click",4,"ngIf"],["icon","","matRipple","","class","!mr-1","matTooltip","Remove Menu Item Option",3,"click",4,"ngIf"],["icon","","matRipple","","matTooltip","Edit Menu Item Option",3,"click"],["icon","","matRipple","","matTooltip","Remove Menu Item Option",1,"!mr-1",3,"click"]],template:function(p,i){if(1&p&&(n.nrm(0,"simple-table",5),n.DNE(1,h,1,1,"ng-template",null,0,n.C5r)(3,x,4,6,"ng-template",null,1,n.C5r)(5,T,27,7,"ng-template",null,2,n.C5r)(7,O,1,1,"ng-template",null,3,n.C5r)),2&p){const d=n.sdS(2),r=n.sdS(4),m=n.sdS(6),a=n.sdS(8);n.Y8G("data",i.menu)("columns",n.s1E(14,G,n.eq3(6,D,d),n.lJ4(8,P),n.lJ4(9,$),n.eq3(10,N,r),n.eq3(12,E,m)))("filter",null==i.filters?null:i.filters.search)("show_children",i.show_children)("child_template",a)("sortable",!0)}},dependencies:[F.Sq,F.bT,U.kk,U.fb,U.Cp,K.So,B.oV,W.BC,W.vS,R.R,y.O,v.r6,F.Jj,F.oe],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}\n\n/*# sourceMappingURL=catering-menu.component.ts-angular-inline--69.css.map*/"]})}return f})()},37053:(z,S,o)=>{o.d(S,{e:()=>L});var e=o(7404),t=o(34456),M=o(12587),k=o(64217),n=o(25892),F=o(60316),U=o(79771),K=o(85060),B=o(97024),W=o(69434),R=o(24950),y=o(87984),v=o(41134);function D(g,I){1&g&&(e.j41(0,"button",6)(1,"app-icon"),e.EFF(2,"close"),e.k0s()())}function P(g,I){if(1&g&&(e.j41(0,"div",9)(1,"label",10),e.EFF(2," Name"),e.j41(3,"span"),e.EFF(4,"*"),e.k0s(),e.EFF(5,": "),e.k0s(),e.j41(6,"mat-form-field",11),e.nrm(7,"input",12),e.j41(8,"mat-error"),e.EFF(9,"Name is required"),e.k0s()()()),2&g){const O=e.XpG(2);e.R7$(),e.AVh("error",O.form.controls.name.invalid&&O.form.controls.name.touched)}}function $(g,I){if(1&g&&(e.j41(0,"div",9)(1,"label",13),e.EFF(2," Type"),e.j41(3,"span"),e.EFF(4,"*"),e.k0s(),e.EFF(5,": "),e.k0s(),e.j41(6,"mat-form-field",11),e.nrm(7,"input",14),e.j41(8,"mat-error"),e.EFF(9,"Type is required"),e.k0s()()()),2&g){const O=e.XpG(2),A=e.sdS(9);e.R7$(),e.AVh("error",O.form.controls.group.invalid&&O.form.controls.group.touched),e.R7$(6),e.Y8G("matAutocomplete",A)}}function N(g,I){1&g&&(e.j41(0,"div",9)(1,"label",10),e.EFF(2,"Unit Price:"),e.k0s(),e.j41(3,"mat-form-field",11),e.nrm(4,"input",15),e.k0s()())}function E(g,I){1&g&&(e.j41(0,"div",9)(1,"mat-checkbox",16),e.EFF(2," Can select multiple of type "),e.k0s()())}function G(g,I){if(1&g&&(e.j41(0,"form",7),e.DNE(1,P,10,2,"div",8)(2,$,10,3,"div",8)(3,N,5,0,"div",8)(4,E,3,0,"div",8),e.k0s()),2&g){const O=e.XpG();e.Y8G("formGroup",O.form),e.R7$(),e.Y8G("ngIf",O.form.controls.name),e.R7$(),e.Y8G("ngIf",O.form.controls.group),e.R7$(),e.Y8G("ngIf",O.form.controls.unit_price),e.R7$(),e.Y8G("ngIf",O.form.controls.multiple)}}function h(g,I){if(1&g){const O=e.RV6();e.j41(0,"footer",17)(1,"button",18),e.bIt("click",function(){e.eBV(O);const f=e.XpG();return e.Njj(f.saveChanges())}),e.EFF(2," Save "),e.k0s()()}if(2&g){const O=e.XpG();e.R7$(),e.Y8G("disabled",!O.form.dirty)}}function x(g,I){1&g&&(e.j41(0,"div",19),e.nrm(1,"mat-spinner",20),e.j41(2,"p"),e.EFF(3,"Saving catering item option..."),e.k0s()())}function T(g,I){if(1&g&&(e.j41(0,"mat-option",21),e.EFF(1),e.k0s()),2&g){const O=I.$implicit;e.Y8G("value",O),e.R7$(),e.SpI(" ",O," ")}}let L=(()=>{class g{get option(){return this._data.option}get types(){return this._data.types||[]}constructor(O){this._data=O,this.event=new e.bkB,this.form=new t.gE({name:new t.MJ(this.option.name||"",[t.k0.required]),group:new t.MJ(this.option.group||"",[t.k0.required]),unit_price:new t.MJ(this.option.unit_price),multiple:new t.MJ(!!this.option.multiple,[])}),this.loading=!1}saveChanges(){this.loading=!0;const O={...this.option,id:this.option.id||`option-${(0,k.HO)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new n.T({...this._data.parent,options:this._data.parent.options.filter(A=>A.id!==O.id).concat([O])})}})}static#t=this.\u0275fac=function(A){return new(A||g)(e.rXU(M.Vh))};static#e=this.\u0275cmp=e.VBU({type:g,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["load_state",""],["auto","matAutocomplete"],["icon","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-base-200",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["icon","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-base-200"],["btn","","matRipple","",3,"click","disabled"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(A,f){if(1&A&&(e.j41(0,"header")(1,"h3"),e.EFF(2),e.k0s(),e.DNE(3,D,3,0,"button",2),e.k0s(),e.DNE(4,G,5,5,"form",3)(5,h,3,1,"footer",4)(6,x,4,0,"ng-template",null,0,e.C5r),e.j41(8,"mat-autocomplete",null,1),e.DNE(10,T,2,2,"mat-option",5),e.k0s()),2&A){const l=e.sdS(7);e.R7$(2),e.SpI("",f.option.id?"Edit":"Add"," Item Option"),e.R7$(),e.Y8G("ngIf",!f.loading),e.R7$(),e.Y8G("ngIf",f.form&&!f.loading)("ngIfElse",l),e.R7$(),e.Y8G("ngIf",!f.loading),e.R7$(5),e.Y8G("ngForOf",f.types)}},dependencies:[F.Sq,F.bT,U.$3,K.wT,U.pN,M.tx,B.So,t.qT,t.me,t.Q0,t.BC,t.cb,t.j4,t.JD,W.R,R.rl,R.TL,K.r6,y.fg,v.LG]})}return g})()},3872:(z,S,o)=>{o.d(S,{Q:()=>W});var e=o(7404),t=o(60316),M=o(69434),k=o(85060);const n=["catering-order-item",""];function F(R,y){if(1&R&&(e.j41(0,"div",12),e.EFF(1),e.k0s()),2&R){const v=e.XpG().$implicit;e.R7$(),e.SpI(" ",v.name," ")}}function U(R,y){if(1&R&&(e.qex(0),e.DNE(1,F,2,1,"div",11),e.bVm()),2&R){const v=y.$implicit;e.R7$(),e.Y8G("ngIf",v)}}function K(R,y){if(1&R){const v=e.RV6();e.qex(0),e.j41(1,"div",1),e.nrm(2,"div",2),e.k0s(),e.j41(3,"div",3)(4,"button",4),e.bIt("click",function(){e.eBV(v);const P=e.XpG();return e.Njj(P.toggle())}),e.j41(5,"app-icon"),e.EFF(6),e.k0s()()(),e.j41(7,"div",5)(8,"div",6)(9,"div",7),e.EFF(10),e.k0s()(),e.j41(11,"div",8),e.EFF(12),e.k0s(),e.j41(13,"div",9),e.DNE(14,U,2,1,"ng-container",10),e.k0s()(),e.bVm()}if(2&R){const v=e.XpG();e.R7$(4),e.AVh("bg-success",v.active)("text-white",v.active)("border-solid",v.active),e.R7$(2),e.JRh(v.active?"done":"local_pizza"),e.R7$(4),e.SpI(" ",(null==v.item?null:v.item.amount)||(null==v.item?null:v.item.quantity)||1,"\xd7 "),e.R7$(2),e.JRh(null==v.item?null:v.item.name),e.R7$(2),e.Y8G("ngForOf",v.item.option_list)}}const B=new Set;let W=(()=>{class R{constructor(){this.active=!1}get item_key(){return`${this.order_id}|${this.item?.id}`}ngOnInit(){this.active=B.has(this.item_key)}toggle(){B.has(this.item_key)?(B.delete(this.item_key),this.active=!1):(B.add(this.item_key),this.active=!0)}static#t=this.\u0275fac=function(D){return new(D||R)};static#e=this.\u0275cmp=e.VBU({type:R,selectors:[["","catering-order-item",""]],inputs:{order_id:"order_id",item:"item"},attrs:n,decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-16","text-right","h-14","relative"],["arm","",1,"border-b-2","border-l-2","border-base-200","w-4","h-16","absolute","top-1/2","left-1/2","-translate-y-full","-translate-x-px"],[1,"w-12","mr-4"],["action","","icon","","matRipple","",1,"border-2","border-base-200","border-dashed","text-xl","text-dark-fade","p-2",3,"click"],[1,"flex","flex-1","items-center","border-b","border-base-200","border-solid","py-4","space-x-4"],[1,""],[1,"p-1","rounded-full","bg-base-300","w-10","h-10","flex","items-center","justify-center","font-mono","text-sm"],[1,"flex-1"],[1,"flex","space-x-2","mr-2","px-4"],[4,"ngFor","ngForOf"],["class","text-xs py-1 px-2 bg-warning text-warning-content rounded-2xl shadow",4,"ngIf"],[1,"text-xs","py-1","px-2","bg-warning","text-warning-content","rounded-2xl","shadow"]],template:function(D,P){1&D&&e.DNE(0,K,15,10,"ng-container",0),2&D&&e.Y8G("ngIf",P.item)},dependencies:[t.Sq,t.bT,M.R,k.r6],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}\n\n/*# sourceMappingURL=catering-order-item.component.ts-angular-inline--70.css.map*/"]})}return R})()},41623:(z,S,o)=>{o.d(S,{r:()=>a});var e=o(89204),t=o(98197),M=o(77375),k=o(91074),n=o(7404),F=o(60316),U=o(31034),K=o(69434),B=o(22238),W=o(88328),R=o(85060),y=o(26354),v=o(3872);const D=s=>({key:"state",name:" ",size:"4rem",sortable:!1,content:s}),P=s=>({key:"deliver_at",name:"Time",content:s}),$=s=>({key:"event",name:"Location",content:s,sortable:!1}),N=s=>({key:"event",name:"Host",content:s,sortable:!1}),E=()=>({key:"charge_code",name:"Charge Code"}),G=()=>({key:"invoice_number",name:"Invoice No.",empty:"No Invoice"}),h=s=>({key:"status",name:"Status",content:s,size:"11rem"}),x=s=>({key:"actions",name:" ",size:"6.5rem",content:s,sortable:!1}),T=(s,C,c,u,b,w,J,H)=>[s,C,c,u,b,w,J,H];function L(s,C){1&s&&(n.j41(0,"div",12)(1,"div",13)(2,"app-icon"),n.EFF(3,"room_service"),n.k0s()()())}function g(s,C){if(1&s&&(n.j41(0,"div",14)(1,"div"),n.EFF(2),n.nI1(3,"date"),n.k0s(),n.j41(4,"div",15),n.EFF(5),n.nI1(6,"date"),n.nI1(7,"date"),n.nI1(8,"date"),n.nI1(9,"date"),n.k0s()()),2&s){const c=C.data,u=C.row,b=n.XpG();n.R7$(2),n.SpI("Deliver at ",n.i5U(3,5,c,b.time_format),""),n.R7$(3),n.LHq(" ",n.i5U(6,8,null==u||null==u.event?null:u.event.date,"MMM d"),", ",n.i5U(7,11,null==u||null==u.event?null:u.event.date,b.time_format)," - ",n.i5U(8,14,null==u||null==u.event?null:u.event.date_end,"MMM d"),", ",n.i5U(9,17,null==u||null==u.event?null:u.event.date_end,b.time_format)," ")}}function I(s,C){1&s&&(n.j41(0,"span",18),n.EFF(1," No Location "),n.k0s())}function O(s,C){if(1&s&&(n.j41(0,"div",16),n.EFF(1),n.DNE(2,I,2,0,"span",17),n.k0s()),2&s){const c=C.data;n.R7$(),n.SpI(" ",(null==c||null==c.space?null:c.space.display_name)||(null==c||null==c.space?null:c.space.name)||""," "),n.R7$(),n.Y8G("ngIf",!(null!=c&&null!=c.space&&c.space.display_name||null!=c&&null!=c.space&&c.space.name))}}function A(s,C){1&s&&(n.j41(0,"span",18),n.EFF(1," Unknown Host "),n.k0s())}function f(s,C){if(1&s&&(n.j41(0,"div",16)(1,"div"),n.EFF(2),n.DNE(3,A,2,0,"span",17),n.k0s(),n.j41(4,"div",15),n.EFF(5),n.k0s()()),2&s){const c=C.data;n.R7$(2),n.SpI(" ",(null==c||null==c.organiser?null:c.organiser.name)||(null==c?null:c.host)||""," "),n.R7$(),n.Y8G("ngIf",!(null!=c&&null!=c.organiser&&c.organiser.name||null!=c&&c.host)),n.R7$(2),n.SpI(" ",(null==c||null==c.organiser?null:c.organiser.email)||(null==c?null:c.host)," ")}}function l(s,C){if(1&s){const c=n.RV6();n.j41(0,"button",23),n.bIt("click",function(){const b=n.eBV(c).$implicit,w=n.XpG().row,J=n.XpG();return n.Njj(J.updateStatus(w,b.id))}),n.j41(1,"div",24),n.nrm(2,"div",25),n.j41(3,"span",26),n.EFF(4),n.k0s()()()}if(2&s){const c=C.$implicit;n.R7$(2),n.xc7("background-color",c.colour),n.R7$(2),n.JRh(c.name)}}function _(s,C){if(1&s&&(n.j41(0,"div",16)(1,"button",19)(2,"div",20),n.EFF(3),n.k0s(),n.j41(4,"app-icon",21),n.EFF(5,"arrow_drop_down"),n.k0s()()(),n.j41(6,"mat-menu",null,7),n.DNE(8,l,5,3,"button",22),n.k0s()),2&s){let c,u;const b=C.data,w=n.sdS(7),J=n.XpG();n.R7$(),n.xc7("background",null==(c=J.status(b))?null:c.colour),n.Y8G("matMenuTriggerFor",w),n.R7$(2),n.SpI(" ",null==(u=J.status(b))?null:u.name," "),n.R7$(5),n.Y8G("ngForOf",J.statuses)}}function p(s,C){if(1&s&&(n.j41(0,"div",30)(1,"div",31),n.EFF(2,"Notes"),n.k0s(),n.j41(3,"p",32),n.EFF(4),n.k0s()()),2&s){const c=n.XpG().row;n.R7$(4),n.SpI(" ",c.notes," ")}}function i(s,C){if(1&s){const c=n.RV6();n.j41(0,"div",27)(1,"button",28)(2,"app-icon"),n.EFF(3,"description"),n.k0s()(),n.DNE(4,p,5,1,"ng-template",null,8,n.C5r),n.j41(6,"button",29),n.bIt("click",function(){const b=n.eBV(c).row,w=n.XpG();return n.Njj(w.show_children[b.id]=!w.show_children[b.id])}),n.j41(7,"app-icon"),n.EFF(8),n.k0s()()()}if(2&s){const c=C.row,u=n.sdS(5),b=n.XpG();n.R7$(),n.Y8G("hover",!0)("content",u)("disabled",!c.notes),n.R7$(7),n.SpI(" ",b.show_children[c.id]?"keyboard_arrow_down":"chevron_right"," ")}}function d(s,C){if(1&s&&n.nrm(0,"li",36),2&s){const c=C.$implicit,u=n.XpG(2).row;n.Y8G("order_id",null==u?null:u.id)("item",c)}}function r(s,C){if(1&s&&(n.j41(0,"ul",34),n.DNE(1,d,1,2,"li",35),n.k0s()),2&s){const c=n.XpG().row;n.R7$(),n.Y8G("ngForOf",c.items)}}function m(s,C){if(1&s&&n.DNE(0,r,2,1,"ul",33),2&s){const c=C.row;n.Y8G("ngIf",null==c?null:c.items.length)}}let a=(()=>{class s extends M.Tv{get time_format(){return this._settings.time_format}status(c){return k.T.find(u=>u.id===c)}constructor(c,u){var b;super(),b=this,this._orders=c,this._settings=u,this.order_list=this._orders.filtered,this.loading=this._orders.loading,this.statuses=k.T,this.show_children={},this.updateStatus=function(){var w=(0,e.A)(function*(J,H){yield b._orders.updateStatus(J,H),b.timeout("status-change",()=>J.status=H)});return function(J,H){return w.apply(this,arguments)}}()}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(c,u){return u?u.id:void 0}static#t=this.\u0275fac=function(u){return new(u||s)(n.rXU(t.Q),n.rXU(M.h$))};static#e=this.\u0275cmp=n.VBU({type:s,selectors:[["catering-order-list"]],features:[n.Vt3],decls:18,vars:32,consts:[["state_template",""],["time_template",""],["location_template",""],["host_template",""],["status_template",""],["actions_template",""],["child_template",""],["menu","matMenu"],["notes_template",""],[1,"flex","flex-col","h-full","w-full","overflow-auto"],["mode","indeterminate",1,"sticky","top-0","left-0","w-full"],["empty_message","No Catering Orders",1,"min-w-[72rem]","w-full","block","text-sm",3,"data","columns","sortable","show_children","child_template"],[1,"p-2"],[1,"rounded-full","bg-base-200","p-2","text-2xl","flex","items-center","justify-center"],[1,"p-4"],[1,"text-xs","opacity-30"],[1,"px-4","py-2"],["class","opacity-30",4,"ngIf"],[1,"opacity-30"],["status","","matRipple","",1,"rounded-3xl","text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"flex","items-center","space-x-2"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"],[1,"flex","items-center","space-x-2","p-2","mx-auto"],["icon","","matRipple","","customTooltip","","xPosition","end","yPosition","top",3,"hover","content","disabled"],["icon","","matRipple","",3,"click"],[1,"p-2","rounded-lg","bg-base-100","text-base-content","max-w-[32rem]","min-w-[8rem]","shadow","border","border-base-200"],[1,"mb-2"],[1,"text-sm","px-4","py-2","bg-base-200","rounded"],["class","list-none p-0 m-0 w-full relative z-0",4,"ngIf"],[1,"list-none","p-0","m-0","w-full","relative","z-0"],["catering-order-item","","class","flex items-center",3,"order_id","item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"order_id","item"]],template:function(u,b){if(1&u&&(n.j41(0,"div",9),n.nrm(1,"mat-progress-bar",10),n.nI1(2,"async"),n.nrm(3,"simple-table",11),n.DNE(4,L,4,0,"ng-template",null,0,n.C5r)(6,g,10,20,"ng-template",null,1,n.C5r)(8,O,3,2,"ng-template",null,2,n.C5r)(10,f,6,3,"ng-template",null,3,n.C5r)(12,_,9,5,"ng-template",null,4,n.C5r)(14,i,9,4,"ng-template",null,5,n.C5r)(16,m,1,1,"ng-template",null,6,n.C5r),n.k0s()),2&u){const w=n.sdS(5),J=n.sdS(7),H=n.sdS(9),et=n.sdS(11),tt=n.sdS(13),nt=n.sdS(15),V=n.sdS(17);n.R7$(),n.AVh("opacity-0",!n.bMT(2,7,b.loading)),n.R7$(2),n.Y8G("data",b.order_list)("columns",n.lV(23,T,n.eq3(9,D,w),n.eq3(11,P,J),n.eq3(13,$,H),n.eq3(15,N,et),n.lJ4(17,E),n.lJ4(18,G),n.eq3(19,h,tt),n.eq3(21,x,nt)))("sortable",!0)("show_children",b.show_children)("child_template",V)}},dependencies:[F.Sq,F.bT,U.kk,U.fb,U.Cp,K.R,B.I,W.O,R.r6,y.HM,v.Q,F.Jj,F.vh],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n\n/*# sourceMappingURL=catering-order-list.component.ts-angular-inline--71.css.map*/"]})}return s})()},82912:(z,S,o)=>{o.d(S,{g:()=>d});var e=o(89204),t=o(7404),M=o(12587),k=o(77375),n=o(25892),F=o(75555),U=o(12185),K=o(60285),B=o(60316),W=o(38223),R=o(80640),y=o(34456),v=o(69434),D=o(85060),P=o(41134),$=o(55507);const N=()=>({});function E(r,m){1&r&&(t.j41(0,"div",18),t.EFF(1," Options Available "),t.k0s())}function G(r,m){if(1&r){const a=t.RV6();t.j41(0,"a-counter",19),t.bIt("ngModelChange",function(C){t.eBV(a);const c=t.XpG().$implicit,u=t.XpG(5);return t.Njj(u.updateItemQuantity(c,C))}),t.k0s()}if(2&r){const a=t.XpG().$implicit;t.Y8G("ngModel",a.quantity)}}function h(r,m){if(1&r){const a=t.RV6();t.j41(0,"div",20)(1,"div",21)(2,"button",22)(3,"app-icon"),t.EFF(4,"remove"),t.k0s()()(),t.j41(5,"div",23),t.EFF(6),t.k0s(),t.j41(7,"button",24),t.bIt("click",function(){t.eBV(a);const C=t.XpG().$implicit,c=t.XpG(5);return t.Njj(c.addItem(C))}),t.j41(8,"app-icon"),t.EFF(9,"add"),t.k0s()()()}if(2&r){const a=t.XpG().$implicit;t.R7$(),t.Y8G("matTooltip",a.quantity?"Items with options must be removed from order confirmation page":""),t.R7$(),t.Y8G("disabled",!0),t.R7$(4),t.SpI(" ",a.quantity," ")}}function x(r,m){if(1&r&&(t.j41(0,"div",12)(1,"div",13)(2,"div",13),t.EFF(3),t.k0s(),t.DNE(4,E,2,0,"div",14),t.k0s(),t.j41(5,"div",15),t.EFF(6),t.nI1(7,"currency"),t.k0s(),t.DNE(8,G,1,1,"a-counter",16)(9,h,10,3,"div",17),t.k0s()),2&r){const a=m.$implicit,s=t.XpG(5);t.R7$(3),t.SpI(" ",a.name," "),t.R7$(),t.Y8G("ngIf",a.options.length),t.R7$(2),t.SpI(" ",t.i5U(7,5,a.unit_price/100,s.code)," "),t.R7$(2),t.Y8G("ngIf",!a.options.length),t.R7$(),t.Y8G("ngIf",a.options.length)}}function T(r,m){if(1&r&&(t.j41(0,"mat-tab",9)(1,"div",10),t.DNE(2,x,10,8,"div",11),t.k0s()()),2&r){const a=t.XpG().$implicit,s=t.XpG(3);t.Y8G("label",a),t.R7$(2),t.Y8G("ngForOf",(s.menu_items||t.lJ4(2,N))[a])}}function L(r,m){if(1&r&&(t.qex(0),t.DNE(1,T,3,3,"mat-tab",8),t.bVm()),2&r){const a=m.$implicit,s=t.XpG(3);t.R7$(),t.Y8G("ngIf",(s.menu_items||t.lJ4(1,N))[a].length)}}function g(r,m){if(1&r&&(t.qex(0),t.j41(1,"mat-tab-group"),t.DNE(2,L,2,2,"ng-container",7),t.k0s(),t.bVm()),2&r){const a=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",a.categories)}}function I(r,m){if(1&r&&(t.j41(0,"div",5),t.DNE(1,g,3,1,"ng-container",6),t.k0s()),2&r){const a=t.XpG(),s=t.sdS(5);t.R7$(),t.Y8G("ngIf",!a.show_order_details)("ngIfElse",s)}}function O(r,m){if(1&r){const a=t.RV6();t.qex(0),t.j41(1,"button",26),t.EFF(2," Cancel "),t.k0s(),t.j41(3,"button",27),t.bIt("click",function(){t.eBV(a);const C=t.XpG(2);return t.Njj(C.show_order_details=!0)}),t.EFF(4," Confirm "),t.k0s(),t.bVm()}if(2&r){const a=t.XpG(2);t.R7$(3),t.Y8G("disabled",!a.order.item_count)("matBadge",a.order.item_count)("matBadgeHidden",!a.order.item_count)}}function A(r,m){if(1&r){const a=t.RV6();t.j41(0,"button",28),t.bIt("click",function(){t.eBV(a);const C=t.XpG(2);return t.Njj(C.show_order_details=!1)}),t.EFF(1," Back "),t.k0s(),t.j41(2,"button",29),t.bIt("click",function(){t.eBV(a);const C=t.XpG(2);return t.Njj(C.saveOrder())}),t.EFF(3," Save Order "),t.k0s()}}function f(r,m){if(1&r&&(t.j41(0,"footer",25),t.DNE(1,O,5,3,"ng-container",6)(2,A,4,0,"ng-template",null,2,t.C5r),t.k0s()),2&r){const a=t.sdS(3),s=t.XpG();t.R7$(),t.Y8G("ngIf",!s.show_order_details)("ngIfElse",a)}}function l(r,m){if(1&r&&(t.j41(0,"div",30),t.nrm(1,"mat-spinner",31),t.j41(2,"p"),t.EFF(3),t.k0s()()),2&r){const a=t.XpG();t.R7$(3),t.JRh(a.loading)}}function _(r,m){if(1&r&&(t.j41(0,"div",35),t.EFF(1),t.k0s()),2&r){const a=t.XpG().$implicit,s=t.XpG(2);t.Y8G("matTooltip",s.optionsFor(a)),t.R7$(),t.Lme(" ",a.options.length," option",1===a.options.length?"":"s"," selected ")}}function p(r,m){if(1&r){const a=t.RV6();t.j41(0,"div",12)(1,"div",13)(2,"div",13),t.EFF(3),t.k0s(),t.DNE(4,_,2,3,"div",33),t.k0s(),t.j41(5,"div",15),t.EFF(6),t.nI1(7,"currency"),t.k0s(),t.j41(8,"a-counter",34),t.bIt("ngModelChange",function(C){const c=t.eBV(a).$implicit,u=t.XpG(2);return t.Njj(u.updateItemQuantity(c,C))}),t.k0s()()}if(2&r){const a=m.$implicit,s=t.XpG(2);t.R7$(3),t.JRh(a.name),t.R7$(),t.Y8G("ngIf",a.options.length),t.R7$(2),t.SpI(" ",t.i5U(7,4,a.total_cost/100,s.code)," "),t.R7$(2),t.Y8G("ngModel",a.quantity)}}function i(r,m){if(1&r&&(t.j41(0,"header",32)(1,"h3"),t.EFF(2,"Confirm Order"),t.k0s()(),t.j41(3,"div",10),t.DNE(4,p,9,7,"div",11),t.k0s()),2&r){const a=t.XpG();t.R7$(4),t.Y8G("ngForOf",a.order.items)}}let d=(()=>{class r extends k.Tv{get code(){return this._org.currency_code}constructor(a,s){super(),this._org=a,this._data=s,this.event=new t.bkB,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var a=this;return(0,e.A)(function*(){a.loading="Loading menu...",a.order=new F.M(a._data.order),a.rules=yield a._data.getCateringConfig(a.order.event?.space?.level?.parent_id),a._data.menu.subscribe(s=>{a.loading="Loading menu...";const C=(0,k.Am)(s.map(u=>u.category)),c={};for(const u of C)c[u]=s.filter(b=>b.category===u&&(0,K.c)(b,a.rules,a.order.event));a.categories=C,a.menu_items=c,a.updateMenuQuantities(),a.timeout("clear_loading",()=>a.loading="",1e3)})})()}addItem(a,s=!0){const C=this.order.items.find(c=>c.id===a.id&&c.options.length===c.options.reduce((u,b)=>u+(a.options.find(w=>b.id===w.id)?1:0),0));s&&a.options?.length?this._data.selectOptions(a.options).then(c=>{const u=new n.T({...a,options:c});this.addItem(u,!1)}):this.order=new F.M(C?{...this.order,items:this.order.items.filter(c=>!(c.id===a.id&&c.options_string===a.options_string)).concat([new n.T({...a,quantity:C.quantity+1})])}:{...this.order,items:this.order.items.concat([new n.T({...a,quantity:1})])}),this.updateMenuQuantities()}removeItem(a){this.order=new F.M({...this.order,items:this.order.items.filter(s=>s.id!==a.id&&s.options_string===a.options_string)}),this.updateMenuQuantities()}updateItemQuantity(a,s){const C=this.order.items.find(u=>u.id===a.id&&u.options_string===a.options_string);let c=[...this.order.items];c=C?this.order.items.filter(u=>!(u.id===a.id&&u.options_string===a.options_string)).concat([new n.T({...a,quantity:s})]):this.order.items.concat([new n.T({...a,quantity:s})]),c.sort((u,b)=>u.name.localeCompare(b.name)),this.order=new F.M({...this.order,items:c}),this.updateMenuQuantities()}updateMenuQuantities(){for(const a in this.menu_items)for(const s of this.menu_items[a])s.quantity=this.order.items.reduce((C,c)=>c.id===s.id?C+c.quantity:C,0)}optionsFor(a){return a.options.map(s=>s.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}static#t=this.\u0275fac=function(s){return new(s||r)(t.rXU(U.yb),t.rXU(M.Vh))};static#e=this.\u0275cmp=t.VBU({type:r,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.Vt3],decls:6,vars:3,consts:[["load_state",""],["order_details",""],["order_actions",""],["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-base-200",4,"ngIf"],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-base-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-base-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModelChange","ngModel"],[1,"flex","items-center"],[3,"matTooltip"],["icon","","matRipple","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["icon","","matRipple","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-base-200"],["btn","","matRipple","","mat-dialog-close","",1,"inverse"],["confirm","","btn","","matRipple","","matBadgeColor","warn",3,"click","disabled","matBadge","matBadgeHidden"],["matRipple","",1,"inverse",3,"click"],["save","","btn","","matRipple","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModelChange","ngModel"],[1,"text-xs","underline",3,"matTooltip"]],template:function(s,C){if(1&s&&t.DNE(0,I,2,2,"div",3)(1,f,4,2,"footer",4)(2,l,4,1,"ng-template",null,0,t.C5r)(4,i,5,1,"ng-template",null,1,t.C5r),2&s){const c=t.sdS(3);t.Y8G("ngIf",!C.loading)("ngIfElse",c),t.R7$(),t.Y8G("ngIf",!C.loading)}},dependencies:[B.Sq,B.bT,W.mq,W.T8,M.tx,R.oV,y.me,y.BC,y.vS,v.R,D.r6,P.LG,$.s,B.oe],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--s);border-bottom:2px solid var(--s);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--55.css.map*/"]})}return r})()},17707:(z,S,o)=>{o.d(S,{C:()=>N});var e=o(7404),t=o(12587),M=o(64217),k=o(60316),n=o(97024),F=o(53804),U=o(34456),K=o(69434),B=o(85060);function W(E,G){if(1&E&&(e.j41(0,"div",18),e.EFF(1),e.nI1(2,"currency"),e.k0s()),2&E){const h=e.XpG().$implicit,x=e.XpG(3);e.R7$(),e.SpI(" +",e.i5U(2,1,h.unit_price/100,x.code)," ")}}function R(E,G){if(1&E&&(e.j41(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),e.EFF(3),e.k0s(),e.DNE(4,W,3,4,"div",17),e.k0s()()),2&E){const h=G.$implicit;e.Y8G("value",h.id),e.R7$(3),e.SpI(" ",h.name," "),e.R7$(),e.Y8G("ngIf",h.unit_price)}}function y(E,G){if(1&E){const h=e.RV6();e.qex(0),e.j41(1,"mat-radio-group",10),e.bIt("ngModelChange",function(T){e.eBV(h);const L=e.XpG().$implicit,g=e.XpG();return e.Njj(g.updateGroupOption(L,T))}),e.j41(2,"mat-radio-button",11)(3,"span",12),e.EFF(4,"None"),e.k0s()(),e.DNE(5,R,5,3,"mat-radio-button",13),e.k0s(),e.bVm()}if(2&E){const h=e.XpG().$implicit;e.R7$(5),e.Y8G("ngForOf",null==h?null:h.options)}}function v(E,G){if(1&E&&(e.j41(0,"div",18),e.EFF(1),e.nI1(2,"currency"),e.k0s()),2&E){const h=e.XpG().$implicit,x=e.XpG(3);e.R7$(),e.SpI(" +",e.i5U(2,1,h.unit_price/100,x.code)," ")}}function D(E,G){if(1&E){const h=e.RV6();e.j41(0,"mat-checkbox",20),e.mxI("ngModelChange",function(T){const L=e.eBV(h).$implicit,g=e.XpG(3);return e.DH7(g.option_state[L.id],T)||(g.option_state[L.id]=T),e.Njj(T)}),e.j41(1,"div",15)(2,"div",16),e.EFF(3),e.k0s(),e.DNE(4,v,3,4,"div",17),e.k0s()()}if(2&E){const h=G.$implicit,x=e.XpG(3);e.R50("ngModel",x.option_state[h.id]),e.R7$(3),e.SpI(" ",h.name," "),e.R7$(),e.Y8G("ngIf",h.unit_price)}}function P(E,G){if(1&E&&e.DNE(0,D,5,3,"mat-checkbox",19),2&E){const h=e.XpG().$implicit;e.Y8G("ngForOf",null==h?null:h.options)}}function $(E,G){if(1&E&&(e.j41(0,"div",6)(1,"div",7),e.EFF(2),e.k0s(),e.j41(3,"div",8),e.DNE(4,y,6,1,"ng-container",9)(5,P,1,1,"ng-template",null,0,e.C5r),e.k0s()()),2&E){const h=G.$implicit,x=e.sdS(6);e.BMQ("group",h.name),e.R7$(2),e.JRh(h.name),e.R7$(2),e.Y8G("ngIf",!h.multiple)("ngIfElse",x)}}let N=(()=>{class E{constructor(h){this._data=h,this.event=new e.bkB,this.option_state={},this.code=this._data.code;const x=(0,M.Am)(this._data.options.map(L=>L.group||"Other")),T=[];for(const L of x){const g=this._data.options.filter(I=>I.group===L);T.push({name:L,multiple:!!g.find(I=>I.multiple),options:g})}this.groups=T}updateGroupOption(h,x){for(const T of h.options)this.option_state[T.id]=T.id===x}saveOptions(){const h=this._data.options.filter(x=>this.option_state[x.id]);this.event.emit({reason:"done",metadata:{options:h}})}static#t=this.\u0275fac=function(x){return new(x||E)(e.rXU(t.Vh))};static#e=this.\u0275cmp=e.VBU({type:E,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["multi_options",""],["icon","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-base-200",4,"ngFor","ngForOf"],[1,"p-2"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-base-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModelChange","ngModel"]],template:function(x,T){1&x&&(e.j41(0,"header")(1,"h3"),e.EFF(2,"Select options"),e.k0s(),e.j41(3,"button",1)(4,"app-icon"),e.EFF(5,"close"),e.k0s()()(),e.j41(6,"main",2),e.DNE(7,$,7,4,"div",3),e.k0s(),e.j41(8,"footer",4)(9,"button",5),e.bIt("click",function(){return T.saveOptions()}),e.EFF(10," Save "),e.k0s()()),2&x&&(e.R7$(7),e.Y8G("ngForOf",T.groups))},dependencies:[k.Sq,k.bT,t.tx,n.So,F.VT,F._g,U.BC,U.vS,K.R,B.r6,k.oe],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--56.css.map*/"]})}return E})()},98197:(z,S,o)=>{o.d(S,{Q:()=>x});var e=o(89204),t=o(90521),M=o(42175),k=o(71536),n=o(19803),F=o(71963),U=o(29314),K=o(35443),B=o(66e3),W=o(7841),R=o(99908),y=o(33240),v=o(56441),D=o(16671),P=o(77375),$=o(51416),N=o(6727),E=o(75555),G=o(7404);let x=(()=>{class T extends P.Tv{get filters(){return this._filters.getValue()}set filters(g){this._filters.next(g)}constructor(){super(),this._poll=new t.t(0),this._loading=new t.t(!1),this._filters=new t.t({}),this.orders=(0,M.zV)([this._filters,this._poll]).pipe((0,n.B)(1e3),(0,F.n)(([{date:g,zones:I}])=>{this._loading.next(!0);const O=(0,R._)((0,y.o)(g||Date.now())),A=(0,R._)((0,v.D)(g||Date.now()));return(0,$.UU)({zone_ids:(I||[]).join(","),period_start:O,period_end:A}).pipe((0,U.W)(()=>(0,k.of)([])),(0,K.T)(f=>(0,P.Bq)(f.map(l=>l.valid_catering.map(_=>new E.M({..._,event:l}))))),(0,K.T)(f=>f.filter(l=>(0,D.GP)(l.deliver_at,"yyyy-MM-dd")===(0,D.GP)(1e3*O,"yyyy-MM-dd"))))}),(0,B.M)(()=>this._loading.next(!1)),(0,W.t)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,K.T)(g=>g.filter(I=>function h(T,L){const g=(L.search||"").toLowerCase();return!!T.items.find(I=>I.name.toLowerCase().includes(g)||!!I.options.find(O=>O.name.toLowerCase().includes(g)))}(I,this._filters.getValue())).sort((I,O)=>I.deliver_at-O.deliver_at))),this.subscription("changes",this.orders.subscribe())}startPolling(g=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),g)}stopPolling(){this.clearInterval("polling")}updateStatus(g,I){var O=this;return(0,e.A)(function*(){g.status=I;const A=new E.M({...g,status:I,event:null}),f=[...(g.event.extension_data.catering||[]).filter(i=>i.id!==g.id),A].map(i=>new E.M({...i})),l=new N.L({...g.event,catering:f}),_=l?.resources[0]?.id||l?.system?.id,p=yield(0,$.zZ)(l.id,_,l.extension_data).toPromise();return O.timeout("refresh-list",()=>O._poll.next(Date.now()),1e3),g.status=I,p})()}static#t=this.\u0275fac=function(I){return new(I||T)};static#e=this.\u0275prov=G.jDH({token:T,factory:T.\u0275fac,providedIn:"root"})}return T})()},52201:(z,S,o)=>{o.d(S,{_:()=>O});var e=o(89204),t=o(3998),M=o(90521),k=o(42175),n=o(71536),F=o(8627),U=o(71963),K=o(29314),B=o(35443),W=o(66e3),R=o(7841),y=o(57871),v=o(33602),D=o(77375),P=o(12185),$=o(30807),N=o(37053),E=o(46815),G=o(25892),h=o(75555),x=o(82912),T=o(17707),L=o(76095),g=o(7404),I=o(12587);let O=(()=>{class A extends D.Tv{get is_editable(){return!this.zone||this.zone===this._org.building?.id}get categories(){const l=this._menu.getValue();return(0,D.Am)(l.map(_=>_.category))}constructor(l,_,p){var i;super(),i=this,this._org=l,this._dialog=_,this._settings=p,this._updated=new M.t(0),this._menu=new M.t([]),this._loading=new M.t(!1),this._currency=new M.t("USD"),this._change=new M.t(0),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.settings=(0,k.zV)([this._org.active_building,this._change]).pipe((0,F.p)(([d])=>!!d),(0,U.n)(([d])=>(0,t.bpY)(d.id,"catering-settings").pipe((0,K.W)(r=>(0,n.of)({})))),(0,B.T)(d=>d.details||{}),(0,W.M)(d=>this._settings.post("require_catering_notes",!!d?.require_notes)),(0,R.t)(1)),this.charge_codes=this.settings.pipe((0,B.T)(d=>d.charge_codes||[])),this.availability=this.settings.pipe((0,B.T)(d=>d.disabled_rooms||[])),this.zone="",this.subscription("building",this._org.active_building.subscribe(function(){var d=(0,e.A)(function*(r){if(r){const m=(yield i.getCateringForZone(r.id)).map(a=>new G.T(a));i._currency.next(i._settings.get("app.currency")||r.currency||"USD"),i._menu.next(m)}});return function(r){return d.apply(this,arguments)}}()))}manageCateringOrder(l){var _=this;return(0,e.A)(function*(){const p=_._dialog.open(x.g,{data:{code:_._currency.getValue(),order:l,menu:_.menu,loading:_.loading,getCateringConfig:d=>_.getCateringConfig(d),selectOptions:d=>_.selectOptions(d)}}),i=yield Promise.race([p.componentInstance.event.pipe((0,y.$)(d=>"done"===d.reason)).toPromise(),p.afterClosed().toPromise()]);return p.close(),i?.metadata?.order||l})()}addItem(l=new G.T){var _=this;return(0,e.A)(function*(){const p=_._dialog.open($.d,{data:{item:l,categories:_.categories}}),i=yield Promise.race([p.componentInstance.event.pipe((0,y.$)(m=>"done"===m.reason)).toPromise(),p.afterClosed().toPromise()]);if("done"!==i?.reason)return;const d=_._menu.getValue(),r=d.findIndex(m=>m.id===l.id);r>=0?d.splice(r,1,i.metadata.item):d.push(i.metadata.item),_.updateMenu(_._org.building.id,d).then(()=>{_._menu.next([...d]),p.close()},()=>p.componentInstance.loading=!1)})()}updateItem(l){const _=this._menu.getValue(),p=_.findIndex(i=>i.id===l.id);p>=0?_.splice(p,1,l):_.push(l),this.updateMenu(this._org.building.id,_).then(()=>this._menu.next([..._]))}addOption(l,_={}){var p=this;return(0,e.A)(function*(){const i=(0,D.Am)(l.options.map(s=>s.group)),d=p._dialog.open(N.e,{data:{parent:l,option:_,types:i}}),r=yield Promise.race([d.componentInstance.event.pipe((0,y.$)(s=>"done"===s.reason)).toPromise(),d.afterClosed().toPromise()]);if("done"!==r?.reason)return;const m=p._menu.getValue(),a=m.findIndex(s=>s.id===l.id);a>=0?m.splice(a,1,r.metadata.item):m.push(r.metadata.item),p.updateMenu(p._org.building.id,m).then(()=>{p._menu.next([...m]),d.close()},()=>d.componentInstance.loading=!1)})()}selectOptions(l){var _=this;return(0,e.A)(function*(){const p=_._dialog.open(T.C,{data:{code:_._currency.getValue(),options:l}}),i=yield Promise.race([p.componentInstance.event.pipe((0,y.$)(d=>"done"===d.reason)).toPromise(),p.afterClosed().toPromise()]);return"done"!==i?.reason?[]:(p.close(),i.metadata.options)})()}deleteItem(l){var _=this;return(0,e.A)(function*(){const p=yield(0,D.GE)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${l.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},_._dialog);if("done"!==p.reason)return;p.loading("Removing catering item...");const i=_._menu.getValue().filter(d=>l.id!==d.id);_.updateMenu(_._org.building.id,i).then(()=>{_._menu.next([...i]),p.close()},()=>p.loading(""))})()}deleteOption(l,_){var p=this;return(0,e.A)(function*(){const i=yield(0,D.GE)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${_.name}" from "${l.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},p._dialog);if("done"!==i.reason)return;i.loading("Removing catering item option...");const d=p._menu.getValue();d.splice(d.findIndex(r=>r.id===l.id),1,new G.T({...l,options:l.options.filter(r=>r.id!==_.id)})),p.updateMenu(p._org.building.id,d).then(()=>{p._menu.next([...d]),i.close()},()=>i.loading(""))})()}editConfig(){var l=this;return(0,e.A)(function*(){const _=yield l.getCateringConfig(l._org.building.id),{require_notes:p}=yield l.settings.pipe((0,v.s)(1)).toPromise(),i=l._menu.getValue(),d=(0,D.Am)((0,D.Bq)(i.map(a=>[a.category,...a.tags]))),r=l._dialog.open(E.Rt,{data:{config:_,types:d,require_notes:p,saveNotes:a=>l.saveSettings({require_notes:a})}}),m=yield Promise.race([r.componentInstance.event.pipe((0,y.$)(a=>"done"===a.reason)).toPromise(),r.afterClosed().toPromise()]);"done"===m?.reason&&l.updateConfig(l._org.building.id,m.metadata).then(()=>r.close(),()=>r.componentInstance.loading=!1)})()}importMenu(){var l=this;return(0,e.A)(function*(){const _=l._dialog.open(L.k),p=yield Promise.race([_.componentInstance.event.pipe((0,y.$)(m=>"done"===m.reason)).toPromise(),_.afterClosed().toPromise()]);if("done"!==p?.reason)return;_.componentInstance.loading="Updating menu...";const i=l._menu.getValue(),d=l._org.building,r=(0,D.Am)(p.metadata.concat(i),"id");yield l.updateMenu(d.id,r).catch(m=>{throw(0,D.UG)("Error importing catering menu"),_.close(),m}),(0,D.VX)(`Successfully imported catering menu. ${p.metadata.length} item(s) added.`),_.close()})()}updateMenu(l,_){return(0,t.D58)(l,{id:l,name:"catering",details:_,description:`Catering menu for ${l}`}).toPromise()}saveSettings(l){var _=this;return(0,e.A)(function*(){const p=yield _.settings.pipe((0,v.s)(1)).toPromise(),i=yield(0,t.D58)(_._org.building.id,{id:_._org.building.id,name:"catering-settings",details:{...p,...l},description:`Catering settings for ${_._org.building.id}`}).toPromise();return _._change.next(Date.now()),i})()}getCateringForZone(l){return(0,e.A)(function*(){const _=(yield(0,t.bpY)(l,"catering").toPromise()).details;return _ instanceof Array?_:[]})()}getCateringConfig(l=this._org.building.id){return(0,e.A)(function*(){const _=(yield(0,t.bpY)(l,"catering_config").toPromise()).details;return _ instanceof Array?_:[]})()}updateConfig(l,_){return(0,t.D58)(l,{id:l,name:"catering_config",details:_,description:`Catering menu config for ${l}`}).toPromise()}addItemToOrder(l,_){let p=l.items;const i=p.find(r=>r.id===_.id&&_.options?.length===r.options?.reduce((m,a)=>m+(_.options.find(s=>a.id===s.id)?1:0),0));return i?i.quantity+=1:p=p.concat([new G.T({..._,quantity:1})]),new h.M({...l,items:p,event:null})}static#t=this.\u0275fac=function(_){return new(_||A)(g.KVO(P.yb),g.KVO(I.bZ),g.KVO(D.h$))};static#e=this.\u0275prov=g.jDH({token:A,factory:A.\u0275fac,providedIn:"root"})}return A})()},91074:(z,S,o)=>{o.d(S,{T:()=>e});const e=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}}]);
//# sourceMappingURL=default-libs_catering_src_index_ts.js.map