"use strict";(self.webpackChunkworkplace=self.webpackChunkworkplace||[]).push([["common"],{8676:(x,h,t)=>{t.d(h,{I:()=>B});var E=t(4316),v=t(9434),l=t(4549),d=t(1187),i=t(1810),p=t(9377),c=t(312),I=t(3200),r=t(4505),K=t(1942),C=t(7716),L=t(4350),U=t(9095),O=t(9128),T=t(823),g=t(522),D=t(6942),P=t(7418),A=t(8759),M=t(9676);let B=(()=>{class e extends l.KG{constructor(o){super(),this._settings=o,this._poll=new r.X(0),this._options=new r.X({start:Date.now()}),this._loading=new r.X(""),this._schedule=new r.X([]),this.options=this._options.asObservable(),this.loading=this._loading.asObservable(),this.schedule=this._loading.asObservable(),this.calendars=(0,K.H)(1e3).pipe((0,U.w)(s=>(0,v.yJ)()),(0,O.d)(1)),this.events=(0,C.aj)([this._options,this._poll]).pipe((0,T.b)(1e3),(0,g.zg)(([s])=>{this._loading.next("Loading schedule...");const _={period_start:(0,i.Z)((0,p.Z)(s.start)),period_end:(0,i.Z)((0,c.Z)((0,I.Z)(s.start),6))};return s.calendar&&(_.calendar=s.calendar),this._schedule.next(this._schedule.getValue().filter(a=>!(0,l.MZ)(1e3*_.period_start,1e3*_.period_end,a.date,a.date+60*a.duration*1e3))),(0,L.D)([!0===this._settings.get("app.no_user_calendar")?(0,E.F2)({..._,type:"room"}).pipe((0,D.U)(a=>a.map(n=>(0,d.Yd)(n)))):(0,d.u$)({..._}),(0,E.F2)({..._,type:"desk"}),(0,E.F2)({..._,type:"parking"})]).pipe((0,P.K)(a=>[]))}),(0,D.U)(([s,_])=>{const a=[...this._schedule.getValue(),...s,..._.filter(n=>"declined"!==n.status)].sort((n,W)=>n.date-W.date);return this._schedule.next((0,l.Tw)(a,"id")),a}),(0,P.K)(s=>[]),(0,A.b)(s=>this._loading.next("")),(0,O.d)(1))}startPolling(o=15e3){this.interval("poll",()=>this._poll.next(Date.now()),o)}stopPolling(){this.clearInterval("poll")}setOptions(o){this._options.next({...this._options.getValue(),...o})}}return e.\u0275fac=function(o){return new(o||e)(M.LFG(l.gb))},e.\u0275prov=M.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);
//# sourceMappingURL=common.js.map