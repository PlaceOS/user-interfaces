{"version":3,"file":"apps_concierge_src_app_facilities_facilities_module_ts.js","mappings":"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","names":["i0","level_r1","id","display_name","name","type_r2","FacilitiesTopbarComponent","AsyncHandler","constructor","_state","_org","_route","_router","super","this","zones","types","type_list","map","i","setDate","d","levels","active_levels","updateZones","z","navigate","relativeTo","queryParams","zone_ids","join","setZones","updateTypes","setFilters","hide_type","reduce","list","item","includes","push","ngOnInit","_this","_asyncToGenerator","initialised","pipe","first","_","toPromise","subscription","queryParamMap","subscribe","params","has","get","split","length","level","levelWithID","building","buildings","find","bld","parent_id","filter","zone","lvl","static","t","i1","i2","i3","core","VBU","selectors","features","decls","vars","consts","template","rf","ctx","$event","FacilitiesTopbarComponent_mat_option_3_Template","FacilitiesTopbarComponent_mat_option_9_Template","FacilitiesStatusComponent","total","_c0","feedback","FacilitiesMapComponent","_explore","url","map_url","styles","map_styles","positions","map_positions","map_features","actions","map_actions","setLevel","zoom","center","FacilitiesComponent","attrs","ROUTES","path","component","NewFacilitiesComponent","FacilitiesModule","$C","G2t","CommonModule","FormsModule","UIModule","SharedExploreModule","RouterModule","forChild"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./apps/concierge/src/app/facilities/facilities-topbar.component.ts","./apps/concierge/src/app/facilities/facilities-status.component.ts","./apps/concierge/src/app/facilities/facilities-map.component.ts","./apps/concierge/src/app/facilities/facilities.component.ts","./apps/concierge/src/app/facilities/facilities.module.ts","./apps/concierge/src/app/facilities/new-facilities.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { first } from 'rxjs/operators';\n\nimport { AsyncHandler, Identity } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { EventsStateService } from '../day-view/events-state.service';\n\n@Component({\n    selector: 'facilities-topbar',\n    template: `\n        <div\n            class=\"flex items-center bg-base-100 h-20 px-4 border-b border-base-200 space-x-2\"\n        >\n            <mat-form-field appearance=\"outline\">\n                <mat-select\n                    multiple\n                    [(ngModel)]=\"zones\"\n                    (ngModelChange)=\"updateZones($event)\"\n                    placeholder=\"All Levels\"\n                >\n                    <mat-option\n                        *ngFor=\"let level of levels | async\"\n                        [value]=\"level.id\"\n                    >\n                        {{ level.display_name || level.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-form-field appearance=\"outline\">\n                <mat-select\n                    multiple\n                    [(ngModel)]=\"type_list\"\n                    (ngModelChange)=\"updateTypes($event)\"\n                    placeholder=\"No Events\"\n                >\n                    <mat-select-trigger>Legend</mat-select-trigger>\n                    <mat-option *ngFor=\"let type of types\" [value]=\"type.id\">\n                        {{ type.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <div class=\"flex-full\"></div>\n            <searchbar class=\"mr-2\"></searchbar>\n        </div>\n    `,\n    styles: [\n        `\n            .flex-full {\n                flex: 1;\n                width: 0.5em;\n            }\n\n            mat-form-field {\n                height: 3.25em;\n                width: 8em;\n                margin-left: 1em;\n            }\n        `,\n    ],\n})\nexport class FacilitiesTopbarComponent extends AsyncHandler {\n    /** List of selected levels */\n    public zones: string[] = [];\n\n    public readonly types: Identity[] = [\n        { id: 'internal', name: 'Internal' },\n        { id: 'external', name: 'External' },\n        { id: 'cancelled', name: 'Cancelled' },\n    ];\n    /** List of selected types */\n    public type_list: string[] = this.types.map((i) => `${i.id}`);\n    /** Set filtered date */\n    public readonly setDate = (d) => this._state.setDate(d);\n    /** List of levels for the active building */\n    public readonly levels = this._org.active_levels;\n    /** List of levels for the active building */\n    public readonly updateZones = (z) => {\n        this._router.navigate([], {\n            relativeTo: this._route,\n            queryParams: { zone_ids: z.join(',') },\n        });\n        this._state.setZones(z);\n    };\n    /** List of levels for the active building */\n    public readonly updateTypes = (types) =>\n        this._state.setFilters({\n            hide_type: this.types.reduce((list, item) => {\n                !types.includes(item.id) ? list.push(item) : '';\n                return list;\n            }, []),\n        });\n\n    constructor(\n        private _state: EventsStateService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _router: Router\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('zone_ids')) {\n                    const zones = params.get('zone_ids').split(',');\n                    if (zones.length) {\n                        const level = this._org.levelWithID(zones);\n                        if (!level) {\n                            return;\n                        }\n                        this._org.building = this._org.buildings.find(\n                            (bld) => bld.id === level.parent_id\n                        );\n                        this.zones = zones;\n                    }\n                }\n            })\n        );\n        this.subscription(\n            'levels',\n            this._org.active_levels.subscribe((levels) => {\n                this.zones = this.zones.filter((zone) =>\n                    levels.find((lvl) => lvl.id === zone)\n                );\n                if (!this.zones.length && levels.length) {\n                    this.zones.push(levels[0].id);\n                }\n                this.updateZones(this.zones);\n            })\n        );\n        this.updateTypes(this.type_list);\n    }\n}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'facilities-status',\n    template: `\n        <div class=\"rounded-lg flex-1 w-full shadow-sm p-6 bg-base-100\">\n            <h3 class=\"mt-0 mb-4\">People Count</h3>\n            <div\n                class=\"w-full flex items-center border border-base-200 mb-2 rounded-lg\"\n            >\n                <div name=\"status\" class=\"rounded-full\">\n                    <app-icon>account_circle</app-icon>\n                </div>\n                <div class=\"flex-1 text-bold text-xs\">\n                    {{ 'Admin Services' }}\n                </div>\n                <div class=\"text-bold p-4\">{{ '24' }}</div>\n            </div>\n            <div class=\"text-right text-bold mr-4\">Total: {{ total || 0 }}</div>\n        </div>\n        <div class=\"rounded w-full shadow-sm p-6 bg-base-100\">\n            <h3 class=\"mt-0 mb-2\">Mood</h3>\n            <div\n                name=\"mood\"\n                class=\"flex items-center w-full border border-base-200 rounded-lg overflow-hidden\"\n            >\n                <app-icon\n                    class=\"bg-light text-2xl px-1\"\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: 'sentiment_very_satisfied'\n                    }\"\n                ></app-icon>\n                <div class=\"px-4 text-sm text-bold\">4/5 Satisfied</div>\n            </div>\n            <h4>Feedback:</h4>\n            <p>{{ feedback }}</p>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                width: 20em;\n                padding: 2em;\n            }\n\n            .bg-light {\n                background-color: rgba(0, 0, 0, 0.05);\n            }\n\n            [name='mood'] app-icon {\n            }\n\n            [name='status'] {\n                margin: 0.5em;\n                border: 4px solid #21a453;\n                border-radius: 100%;\n            }\n        `,\n    ],\n})\nexport class FacilitiesStatusComponent {\n    public feedback: string;\n    public total: number;\n}\n","import { Component } from '@angular/core';\n\nimport { AsyncHandler } from '@placeos/common';\nimport { ExploreStateService } from '@placeos/explore';\nimport { EventsStateService } from '../day-view/events-state.service';\n\n@Component({\n    selector: 'facilities-map',\n    template: `\n        <interactive-map\n            [src]=\"url | async\"\n            [zoom]=\"(positions | async).zoom\"\n            [center]=\"(positions | async).center\"\n            [styles]=\"styles | async\"\n            [features]=\"features | async\"\n            [actions]=\"actions | async\"\n        ></interactive-map>\n        <explore-zoom-controls\n            class=\"absolute bottom-2 right-2\"\n        ></explore-zoom-controls>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class FacilitiesMapComponent extends AsyncHandler {\n    /** Observable for the active map */\n    public readonly url = this._explore.map_url;\n    /** Observable for the active map */\n    public readonly styles = this._explore.map_styles;\n    /** Observable for the active map */\n    public readonly positions = this._explore.map_positions;\n    /** Observable for the active map */\n    public readonly features = this._explore.map_features;\n    /** Observable for the active map */\n    public readonly actions = this._explore.map_actions;\n\n    constructor(\n        private _explore: ExploreStateService,\n        private _state: EventsStateService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'active_zone',\n            this._state.zones.subscribe((z) => this._explore.setLevel(z[0]))\n        );\n    }\n}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: '[app-facilities]',\n    template: `\n        <sidebar></sidebar>\n        <main class=\"relative w-full flex flex-col bg-base-200\">\n            <facilities-topbar></facilities-topbar>\n            <div class=\"flex flex-1\">\n                <facilities-map class=\"flex-1 h-full\"></facilities-map>\n                <facilities-status class=\"h-full space-y-4\"></facilities-status>\n            </div>\n        </main>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                height: 100%;\n                width: 100%;\n            }\n\n            facilities-map {\n                min-width: 50%;\n            }\n        `,\n    ],\n})\nexport class FacilitiesComponent {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { UIModule } from '../ui/ui.module';\n\nimport { FacilitiesComponent } from './facilities.component';\nimport { FacilitiesTopbarComponent } from './facilities-topbar.component';\nimport { FacilitiesStatusComponent } from './facilities-status.component';\nimport { FacilitiesMapComponent } from './facilities-map.component';\n\nimport { SharedExploreModule } from '@placeos/explore';\nimport { NewFacilitiesComponent } from './new-facilities.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: FacilitiesComponent },\n    { path: 'new', component: NewFacilitiesComponent },\n];\n\n@NgModule({\n    declarations: [\n        NewFacilitiesComponent,\n        FacilitiesComponent,\n        FacilitiesTopbarComponent,\n        FacilitiesStatusComponent,\n        FacilitiesMapComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        UIModule,\n        SharedExploreModule,\n        RouterModule.forChild(ROUTES),\n    ],\n})\nexport class FacilitiesModule {}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: '[app-new-facilities]',\n    template: `\n        <app-topbar></app-topbar>\n        <div class=\"flex flex-1 h-px\">\n            <app-sidebar></app-sidebar>\n            <main class=\"flex flex-col flex-1 w-1/2 h-full\">\n                <facilities-topbar></facilities-topbar>\n                <div class=\"flex flex-1\">\n                    <facilities-map class=\"flex-1 h-full\"></facilities-map>\n                    <facilities-status\n                        class=\"h-full space-y-4\"\n                    ></facilities-status>\n                </div>\n            </main>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n                background-color: var(--b1);\n            }\n\n            facilities-map {\n                min-width: 50%;\n            }\n        `,\n    ],\n})\nexport class NewFacilitiesComponent {}\n"],"x_google_ignoreList":[]}