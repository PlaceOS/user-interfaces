(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{L0xO:function(t,e,n){"use strict";n.r(e),n.d(e,"ScheduleModule",(function(){return Lt}));var i=n("2kYt"),c=n("nIj0"),o=n("qvOF"),a=n("sEIs"),s=n("EM62"),r=n("e81E"),l=n("C9Ki"),d=n("d4mj"),b=n("D57K"),u=n("HM3f"),g=n("20lr"),h=n("eZII"),f=n("Rc+I"),p=n("05Mk"),m=n("OZ4H"),v=n("PBFl"),_=n("ukpX"),O=n("csyo"),y=n("6CBO"),M=n("ceWj"),C=n("BQ33");function w(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",14),s.fc("click",(function(){return s.Ac(t),s.jc(2).showSpace()})),s.Nc(1,"View"),s.Ub()}}const k=function(){return{type:"icon",class:"material-icons",content:"delete_forever"}},P=function(){return{type:"icon",class:"material-icons",content:"perm_identity"}},D=function(){return{type:"icon",class:"material-icons",content:"schedule"}},V=function(){return{type:"icon",class:"material-icons",content:"place"}};function j(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",1),s.Vb(1,"div",2),s.Vb(2,"div",3),s.Nc(3),s.Ub(),s.Vb(4,"div",4),s.Vb(5,"button",5),s.fc("click",(function(){return s.Ac(t),s.jc().cancel()})),s.Qb(6,"app-icon",6),s.Ub(),s.Ub(),s.Ub(),s.Vb(7,"div",7),s.Vb(8,"div",8),s.Vb(9,"div",9),s.Vb(10,"div",10),s.Qb(11,"app-icon",11),s.Ub(),s.Vb(12,"div",12),s.Nc(13),s.Ub(),s.Ub(),s.Vb(14,"div",9),s.Vb(15,"div",10),s.Qb(16,"app-icon",11),s.Ub(),s.Vb(17,"div",12),s.Nc(18),s.Ub(),s.Ub(),s.Vb(19,"div",9),s.Vb(20,"div",10),s.Qb(21,"app-icon",11),s.Ub(),s.Vb(22,"div",12),s.Nc(23),s.Ub(),s.Lc(24,w,2,0,"button",13),s.Ub(),s.Ub(),s.Ub(),s.Ub()}if(2&t){const t=s.jc();s.Db(3),s.Oc(t.item.title||"No Title"),s.Db(3),s.qc("icon",s.tc(9,k)),s.Db(5),s.qc("icon",s.tc(10,P)),s.Db(2),s.Oc(t.item.user_name),s.Db(3),s.qc("icon",s.tc(11,D)),s.Db(2),s.Oc(t.when),s.Db(3),s.qc("icon",s.tc(12,V)),s.Db(2),s.Oc(t.item.description),s.Db(1),s.qc("ngIf",t.item.asset_id)}}let x=(()=>{class t extends g.c{constructor(t,e,n){super(),this._dialog=t,this._router=e,this._events=n,this.loading=new s.o}get when(){if(!this.item)return"Unable to determine.";const t=C(this.item.date),e=t.add(this.item.duration||60,"m");return this.item.all_day||this.item.duration>1380?t.format("DD MMM YYYY")+" - All Day":t.isSame(e,"d")?`${t.format("DD MMM YYYY, h:mm A")} - ${e.format("h:mm A")}`:`${t.format("DD MMM YYYY, h:mm A")} - ${e.format("DD MMM YYYY, h:mm A")}`}cancel(){this.confirmDelete()}showSpace(){const t=new y.b({name:"Desk Booking",map_id:this.item.asset_id,zones:this.item.zones});this._dialog.open(M.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{space:t}})}confirmDelete(){this._dialog.open(f.c,{data:{title:"Cancel Meeting",content:"Are you sure you want to cancel this desk booking ?",okText:"I'm sure",cancelText:"No"}}).afterClosed().subscribe(t=>{t&&this.deleteBooking()})}deleteBooking(){return Object(b.a)(this,void 0,void 0,(function*(){this.loading.emit("Cancelling booking..."),yield this._events.delete(this.item.id).then(()=>{}).catch(()=>{}),this._router.navigate(["schedule"]),this.loading.emit("")}))}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(m.b),s.Pb(a.d),s.Pb(h.b))},t.\u0275cmp=s.Jb({type:t,selectors:[["schedule-booking-details"]],inputs:{item:"item"},outputs:{loading:"loading"},features:[s.Ab],decls:1,vars:1,consts:[["class","booking-details",4,"ngIf"],[1,"booking-details"],[1,"header"],[1,"title"],[1,"icons"],["mat-fab","","color","primary",3,"click"],["name","cancel",3,"icon"],[1,"row"],[1,"booking"],[1,"field"],[1,"icon"],[3,"icon"],[1,"value"],["mat-button","",3,"click",4,"ngIf"],["mat-button","",3,"click"]],template:function(t,e){1&t&&s.Lc(0,j,25,13,"div",0),2&t&&s.qc("ngIf",e.item)},directives:[i.o,v.b,_.a],styles:['.header[_ngcontent-%COMP%]{padding:1em 0;width:100%}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:1.1em;font-weight:600;margin-bottom:.5em}.header[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.header[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:.5em}.header[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.5em}.row[_ngcontent-%COMP%]{display:flex;justify-content:center}.booking[_ngcontent-%COMP%]{background-color:#fff;--tw-shadow:0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px 0 rgba(0,0,0,0.06);box-shadow:var(--tw-ring-offset-shadow,0 0 transparent),var(--tw-ring-shadow,0 0 transparent),var(--tw-shadow)}button[_ngcontent-%COMP%]{color:var(--primary)}.field[_ngcontent-%COMP%]{position:relative;padding:1em;display:flex;align-items:center}.field[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:2em;margin-right:.2em}.field[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{flex:1}.field[_ngcontent-%COMP%]:after{content:"";position:absolute;top:100%;right:0;bottom:-2px;left:0;height:2px;z-index:1;border-radius:inherit;background:linear-gradient(270deg,var(--bg) calc(100% - 3em),transparent 3em)}.field[_ngcontent-%COMP%]:last-of-type:after{content:unset}']}),t})();var U=n("mjT4"),q=n("XTcU");const I=function(){return{type:"icon",class:"material-icons",content:"delete_forever"}};function S(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",8),s.fc("click",(function(){return s.Ac(t),s.jc(3).cancelBooking()})),s.Qb(1,"app-icon",12),s.Ub()}2&t&&(s.Db(1),s.qc("icon",s.tc(1,I)))}const N=function(){return{type:"icon",class:"material-icons",content:"edit"}},L=function(){return{type:"icon",class:"material-icons",content:"control_point_duplicate"}};function Q(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",7),s.Vb(1,"button",8),s.fc("click",(function(){return s.Ac(t),s.jc(2).edit()})),s.Qb(2,"app-icon",9),s.Ub(),s.Lc(3,S,2,2,"button",10),s.Vb(4,"button",8),s.fc("click",(function(){return s.Ac(t),s.jc(2).duplicate()})),s.Qb(5,"app-icon",11),s.Ub(),s.Ub()}if(2&t){const t=s.jc(2);s.Db(2),s.qc("icon",s.tc(3,N)),s.Db(1),s.qc("ngIf",t.can_cancel),s.Db(2),s.qc("icon",s.tc(4,L))}}function A(t,e){if(1&t&&(s.Vb(0,"div",1),s.Vb(1,"div",2),s.Vb(2,"div",3),s.Nc(3),s.Ub(),s.Lc(4,Q,6,5,"div",4),s.Ub(),s.Vb(5,"div",5),s.Qb(6,"schedule-event-view",6),s.Ub(),s.Ub()),2&t){const t=s.jc();s.Db(3),s.Oc(t.item.title||"No Title"),s.Db(1),s.qc("ngIf",t.can_edit),s.Db(2),s.qc("event",t.item)}}let T=(()=>{class t extends g.c{constructor(t,e){super(),this._users=t,this._router=e,this.event=new s.o,this.loading=new s.o,this.last_start={}}get spaces(){return this.item.resources}get organiser(){return this.item.creator||this._users.current.name}get can_edit(){return this.item.creator===this._users.current.email&&"done"!==this.status}get can_cancel(){return this.can_edit&&"future"===this.status}get status(){if(this.item){const t=C(),e=C(this.item.date);if(t.isBefore(e.subtract(15,"m"),"m"))return"future";if(t.isBefore(e,"m"))return"upcoming";if(t.isBefore(e.add(15,"m"),"m"))return"started";if(t.isBefore(e.add(this.item.duration,"m"),"m"))return"in_progress"}return"done"}get is_checked_in(){return this.spaces.reduce((t,e)=>t&&this.item.date<=(this.last_start[e.id]||0),!0)}get can_control(){return this.spaces.length>0&&"future"!==this.status&&"done"!==this.status}get can_checkin(){return this.spaces.length>0&&("upcoming"===this.status||"started"===this.status)}edit(){this.event.emit({type:"edit"})}checkin(){this.checked_in=!this.checked_in}duplicate(){if(localStorage){const t=new p.a(Object.assign(Object.assign({},this.item),{id:""}));localStorage.setItem("STAFF.booking_form",JSON.stringify(t))}this._router.navigate(["/book"])}cancelBooking(){this.event.emit({type:"cancel_booking"})}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(U.d),s.Pb(a.d))},t.\u0275cmp=s.Jb({type:t,selectors:[["schedule-event-details"]],inputs:{item:"item"},outputs:{event:"event",loading:"loading"},features:[s.Ab],decls:1,vars:1,consts:[["class","event-details",4,"ngIf"],[1,"event-details"],[1,"header"],[1,"title"],["class","icons",4,"ngIf"],[1,"event"],[3,"event"],[1,"icons"],["mat-fab","","color","primary",3,"click"],["name","edit",3,"icon"],["mat-fab","","color","primary",3,"click",4,"ngIf"],["name","duplicate",3,"icon"],["name","cancel",3,"icon"]],template:function(t,e){1&t&&s.Lc(0,A,7,3,"div",0),2&t&&s.qc("ngIf",e.item)},directives:[i.o,q.a,v.b,_.a],styles:[".header[_ngcontent-%COMP%]{padding:1em 0;width:100%}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:1.1em;font-weight:600;margin-bottom:.5em}.header[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.header[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:.5em}.header[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.5em}.event[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),t})();function F(t,e){if(1&t&&(s.Tb(0),s.Vb(1,"div",13),s.Vb(2,"div",14),s.Qb(3,"mat-spinner",15),s.Ub(),s.Vb(4,"div",16),s.Nc(5),s.Ub(),s.Ub(),s.Sb()),2&t){const t=s.jc();s.Db(5),s.Pc(" ",t.loading," ")}}function Y(t,e){if(1&t){const t=s.Wb();s.Vb(0,"schedule-booking-details",21),s.fc("loading",(function(e){return s.Ac(t),s.jc(2).loading=e})),s.Ub()}if(2&t){const t=s.jc(2);s.qc("item",t.event)}}function E(t,e){if(1&t){const t=s.Wb();s.Vb(0,"schedule-event-details",22),s.fc("event",(function(e){return s.Ac(t),s.jc(2).onChange(e)}))("loading",(function(e){return s.Ac(t),s.jc(2).loading=e})),s.Ub()}if(2&t){const t=s.jc(2);s.qc("item",t.event)}}function B(t,e){if(1&t&&(s.Vb(0,"div",17),s.Tb(1,18),s.Lc(2,Y,1,1,"schedule-booking-details",19),s.Lc(3,E,1,1,"schedule-event-details",20),s.Sb(),s.Ub()),2&t){const t=s.jc();s.qc("hidden",t.loading),s.Db(1),s.qc("ngSwitch",t.type),s.Db(1),s.qc("ngSwitchCase","booking")}}const J=function(){return{tye:"icon",class:"material-icons",content:"keyboard_backspace"}};let z=(()=>{class t extends g.c{constructor(t,e,n,i,c,o){super(),this._bookings=t,this._events=e,this._router=n,this._route=i,this._dialog=c,this._location=o,this.menu=new s.o(!1)}ngOnInit(){this.subscription("route.params",Object(u.b)([this._route.paramMap,this._route.queryParamMap]).subscribe(([t,e])=>{t.has("id")&&(this.id=t.get("id")),e.has("calendar")&&(this.calendar=e.get("calendar")),e.has("type")&&(this.type=e.get("type")),this.id&&this.loadEvent()}))}back(){this.editing?this.onChange({type:"cancel_edit"}):this._location.back()}loadEvent(){return Object(b.a)(this,void 0,void 0,(function*(){if(this.deleting)return;let t;this.loading="Loading booking data...";try{switch(this.type){case"booking":t=yield this._bookings.show(this.id);break;default:t=yield this._events.show(this.id,{calendar:this.calendar})}this.loading="",this.event=t}catch(e){this.loading="",this._router.navigate(["/schedule"])}}))}deleteEvent(){return Object(b.a)(this,void 0,void 0,(function*(){if(this.event&&!this.loading){this.loading="Cancelling meeting...";const{id:t}=this.event;this.deleting=!0,yield this._events.delete(t,{calendar:this.event.calendar}).catch(()=>{}),this._router.navigate(["/schedule"]),this.event=null,this.loading="",this.deleting=!1}}))}confirmDelete(){this._dialog.open(f.c,{data:{title:"Cancel Meeting",content:"Are you sure you want to cancel this meeting: "+this.event.title,okText:"I'm sure",cancelText:"No"}}).afterClosed().subscribe(t=>{t&&this.deleteEvent()})}onChange(t){if("edit"===t.type){if(localStorage){const t=new h.a(Object.assign({},this.event));localStorage.setItem("STAFF.booking_form",JSON.stringify(t))}this._router.navigate(["/book","spaces"])}else"view"===t.type||"cancel_edit"===t.type?this.editing=!1:"cancel_booking"===t.type&&(this.editing=!1,this.confirmDelete())}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(p.b),s.Pb(h.b),s.Pb(a.d),s.Pb(a.a),s.Pb(m.b),s.Pb(i.j))},t.\u0275cmp=s.Jb({type:t,selectors:[["schedule-view-event"]],outputs:{menu:"menu"},features:[s.Ab],decls:15,vars:8,consts:[[1,"event","page"],[1,"header"],[3,"menuChange"],[1,"actions"],[1,"back"],["mat-button","",3,"click"],[1,"row"],[3,"icon"],[1,"search"],[1,"body"],[4,"ngIf"],[3,"hidden",4,"ngIf"],[1,"footer"],[1,"no-item","center"],[1,"icon"],["diameter","100"],[1,"text"],[3,"hidden"],[3,"ngSwitch"],[3,"item","loading",4,"ngSwitchCase"],[3,"item","event","loading",4,"ngSwitchDefault"],[3,"item","loading"],[3,"item","event","loading"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Vb(1,"header",1),s.Vb(2,"a-topbar-header",2),s.fc("menuChange",(function(t){return e.menu.emit(t)})),s.Ub(),s.Ub(),s.Vb(3,"div",3),s.Vb(4,"div",4),s.Vb(5,"button",5),s.fc("click",(function(){return e.back()})),s.Vb(6,"div",6),s.Qb(7,"app-icon",7),s.Nc(8," Back "),s.Ub(),s.Ub(),s.Ub(),s.Qb(9,"div",8),s.Ub(),s.Vb(10,"main",9),s.Lc(11,F,6,1,"ng-container",10),s.Lc(12,B,4,3,"div",11),s.Ub(),s.Vb(13,"footer",12),s.Qb(14,"a-footer-menu"),s.Ub(),s.Ub()),2&t&&(s.Db(3),s.Hb("blank",!1)("has-back",!0),s.Db(4),s.qc("icon",s.tc(7,J)),s.Db(4),s.qc("ngIf",e.loading),s.Db(1),s.qc("ngIf",e.event))},directives:[r.a,v.b,_.a,i.o,l.a,O.b,i.q,i.r,i.s,x,T],styles:[".page[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;background:#f0f0f0}.page[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{flex:1;overflow:auto}.page[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]{height:3.5em}.page[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{background:#fff;display:flex;align-items:center;flex-wrap:wrap}.page[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.page[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]{display:flex;align-items:center;flex:1}.page[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:none}.page[_ngcontent-%COMP%]   .actions.has-back[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:block}.page[_ngcontent-%COMP%]   .actions.has-back[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{margin-left:.5em;font-size:1.5em}.page[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{height:100%}.page[_ngcontent-%COMP%]   .actions.blank[_ngcontent-%COMP%]{background:transparent}.page[_ngcontent-%COMP%]   .actions.blank[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%], .page[_ngcontent-%COMP%]   .actions.blank[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{display:none}.page[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]{height:3.5em;background:#fff}.event.page[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{position:relative}.icon[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),t})();var W=n("YtkY"),$=n("9MvL"),H=n("XyEp"),R=n("R3DB"),X=n("KuCG"),K=n("EDDe"),Z=n("CzDk"),G=n("mrqE"),tt=n("C05f"),et=n("TLy2"),nt=n("4e/d"),it=n("mWib"),ct=n("7JBE");let ot=(()=>{class t extends g.c{constructor(t,e,n){super(),this._events=t,this._bookings=e,this._calendars=n,this._loading=new tt.a(!1),this._poll=new tt.a(!1),this._active_item=new tt.a(""),this._event_list=new tt.a([]),this._options=new tt.a({date:(new Date).valueOf()}),this.loading=this._loading.asObservable(),this.events=this._event_list.asObservable(),this.options=this._options.asObservable(),this.calendars=this._calendars.calendar_list,this.active_item=this._active_item.pipe(Object(et.a)(t=>this._bookings.show(t,{calendar:this._options.getValue().calendar})),Object(nt.a)(t=>this._events.show(this._active_item.getValue())),Object(nt.a)(t=>null)),this.filtered_events=Object(u.b)([this._options,this._event_list]).pipe(Object(W.a)(([t,e])=>e.filter(e=>t.calendar&&e instanceof h.a||(!t.calendar||"desks"===t.calendar)&&e instanceof p.a))),this.subscription("event_list",Object(u.b)([this._options,this._poll]).pipe(Object(it.a)(1e3),Object(et.a)(([t])=>{this._loading.next(!0);const e=Object($.a)(t.date).valueOf();let n=function(t){return Object(G.a)(1,arguments),Object(K.a)(t,Date.now())}(e)?6:4;const i=Object(X.a)(Object(H.a)(e,n)).valueOf();return Promise.all([this._events.query({period_start:Math.floor(e/1e3),period_end:Math.floor(i/1e3),calendars:t.calendar}),this._bookings.query({period_start:Math.floor(e/1e3),period_end:Math.floor(i/1e3),type:"desk"})])}),Object(W.a)(([t,e])=>t.concat(e)),Object(nt.a)(t=>[])).subscribe(t=>{console.log("Event List:",t);const e=Object($.a)(this._options.getValue().date).valueOf(),n=Object(X.a)(Object(H.a)(e,6)).valueOf();let i=this._event_list.getValue().filter(i=>!Object(g.u)(e,n,i.date,i.date+60*i.duration*1e3)&&!t.find(t=>t.id===i.id));i=i.concat(t),i.sort((t,e)=>t.date-e.date),this._event_list.next(i),this._loading.next(!1)}))}get date(){return this._options.getValue().date}setOptions(t){this._options.next(Object.assign(Object.assign({},this._options.getValue()),t))}startPolling(t=15e3){this._poll.next(!this._poll.getValue()),this.interval("poll",()=>this._poll.next(!this._poll.getValue()),t)}stopPolling(){this.clearInterval("poll")}}return t.\u0275fac=function(e){return new(e||t)(s.cc(h.b),s.cc(p.b),s.cc(ct.a))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var at=n("29Wa"),st=n("R7+U"),rt=n("mFH5"),lt=n("Jb3d"),dt=n("Cd2c"),bt=n("gcUQ"),ut=n("D8Xy"),gt=n("WPBw");function ht(t,e){1&t&&(s.Vb(0,"app-icon"),s.Nc(1,"cancel"),s.Ub())}function ft(t,e){1&t&&(s.Vb(0,"app-icon"),s.Nc(1,"forum"),s.Ub())}function pt(t,e){1&t&&(s.Vb(0,"label"),s.Nc(1,"(Cancelled)"),s.Ub())}const mt=function(){return{type:"icon",class:"material-icons",content:"place"}};function vt(t,e){1&t&&s.Qb(0,"app-icon",10),2&t&&s.qc("icon",s.tc(1,mt))}const _t=function(t){return["/schedule","view",t]};let Ot=(()=>{class t{constructor(t){this._router=t}get isFuture(){return Object(ut.a)(this.event.date,new Date)}get status(){return this.event.status}get is_done(){return Object(R.a)(Object(gt.a)(this.event.date,this.event.duration),new Date)}get location(){return this.event&&"date"!==this.event.type&&"empty"!==this.event.type?this.event.location:"No location"}get type_image(){return this.event&&"date"!==this.event.type&&"empty"!==this.event.type?this.event instanceof h.a&&this.event.has_visitors?"external":"book_room":"block"}get time(){return this.event.all_day||this.event.duration>1380?"All Day":Object(Z.a)(this.event.date,"h:mm a")}get query(){return{calendar:this.event.calendar,type:this.event.type}}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(a.d))},t.\u0275cmp=s.Jb({type:t,selectors:[["schedule-event-item"]],inputs:{event:"event"},decls:15,vars:15,consts:[["matRipple","",1,"flex","mb-1",3,"routerLink","queryParams"],[1,"icon",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],[1,"flex","flex-col","h-20","flex-1","w-1/2","bg-white","p-2","justify-center"],[1,"text-lg","font-medium","capitalize","pl-1","truncate"],[1,"flex","items-center"],[3,"icon",4,"ngIf"],[1,"truncate","pl-1"],[3,"icon"]],template:function(t,e){1&t&&(s.Vb(0,"a",0),s.Vb(1,"div"),s.Vb(2,"div",1),s.Lc(3,ht,2,0,"app-icon",2),s.Lc(4,ft,2,0,"app-icon",3),s.Ub(),s.Vb(5,"div"),s.Nc(6),s.Ub(),s.Lc(7,pt,2,0,"label",4),s.Ub(),s.Vb(8,"div",5),s.Vb(9,"div",6),s.Nc(10),s.Ub(),s.Vb(11,"div",7),s.Lc(12,vt,1,2,"app-icon",8),s.Vb(13,"div",9),s.Nc(14),s.Ub(),s.Ub(),s.Ub(),s.Ub()),2&t&&(s.qc("routerLink",s.uc(13,_t,e.event.id))("queryParams",e.query),s.Db(1),s.Fb("h-20 w-20 flex flex-col items-center justify-center "+e.status),s.Hb("done",e.is_done),s.Db(1),s.qc("ngSwitch",e.event.status),s.Db(1),s.qc("ngSwitchCase","cancelled"),s.Db(3),s.Oc(e.time),s.Db(1),s.qc("ngIf","cancelled"===e.event.status),s.Db(3),s.Pc(" ",e.event.title," "),s.Db(2),s.qc("ngIf",!!e.location),s.Db(2),s.Oc(e.location||"No location"))},directives:[a.f,rt.m,i.q,i.r,i.s,i.o,_.a],styles:[".confirmed[_ngcontent-%COMP%], .approved[_ngcontent-%COMP%] {\n                background: #388e3c;\n                color: #fff;\n            }\n\n            .tentative[_ngcontent-%COMP%] {\n                background: #ffa000;\n                color: #000;\n            }\n\n            .declined[_ngcontent-%COMP%], .cancelled[_ngcontent-%COMP%] {\n                background: #d32f2f;\n                color: #fff;\n            }\n\n            .done[_ngcontent-%COMP%] {\n                opacity: 0.35;\n            }"]}),t})();function yt(t,e){if(1&t&&s.Qb(0,"schedule-event-item",5),2&t){const t=e.$implicit;s.rc("id",e.index),s.qc("event",t)}}function Mt(t,e){if(1&t&&(s.Tb(0),s.Lc(1,yt,1,2,"schedule-event-item",4),s.Sb()),2&t){const t=s.jc();s.Db(1),s.qc("ngForOf",t.events)}}function Ct(t,e){if(1&t&&(s.Vb(0,"div",6),s.Nc(1),s.kc(2,"date"),s.Ub()),2&t){const t=s.jc();s.Db(1),s.Pc("No events for ",s.lc(2,1,t.date),"")}}let wt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Jb({type:t,selectors:[["schedule-event-date-list"]],inputs:{date:"date",events:"events"},decls:7,vars:6,consts:[[1,"text-xl","mb-4"],[4,"ngIf","ngIfElse"],["empty_state",""],[1,"mb-4"],[3,"id","event",4,"ngFor","ngForOf"],[3,"id","event"],[1,"p-8"]],template:function(t,e){if(1&t&&(s.Vb(0,"div",0),s.Nc(1),s.kc(2,"date"),s.Ub(),s.Lc(3,Mt,2,1,"ng-container",1),s.Lc(4,Ct,3,3,"ng-template",null,2,s.Mc),s.Qb(6,"div",3)),2&t){const t=s.xc(5);s.Db(1),s.Pc(" ",s.mc(2,3,e.date,"fullDate")," "),s.Db(2),s.qc("ngIf",null==e.events?null:e.events.length)("ngIfElse",t)}},directives:[i.o,i.n,Ot],pipes:[i.f],styles:[""]}),t})();var kt=n("66mq");function Pt(t,e){if(1&t&&(s.Vb(0,"mat-option",22),s.Nc(1),s.Ub()),2&t){const t=e.$implicit;s.qc("value",t.id),s.Db(1),s.Pc(" ",t.summary," ")}}function Dt(t,e){if(1&t&&(s.Qb(0,"schedule-event-date-list",23),s.kc(1,"date")),2&t){const t=e.$implicit;s.qc("date",t.key)("events",t.value),s.Eb("date",s.mc(1,3,t.key,"yyyy-MM-dd"))}}function Vt(t,e){1&t&&s.Qb(0,"mat-progress-bar",24)}const jt=function(){return{class:"material-icons",content:"event"}};let xt=(()=>{class t extends g.c{constructor(t,e){super(),this._state=t,this._el=e,this.loading=this._state.loading,this.options=this._state.options,this.calendars=this._state.calendars,this.events=Object(u.b)([this._state.filtered_events,this._state.options]).pipe(Object(W.a)(([t,e])=>{let n=Object($.a)(new Date);const i=Object(H.a)(e.date||n,12),c={};let o=0;for(;o<t.length||Object(R.a)(n,i);){const e=Object(X.a)(n),i=t.filter(t=>Object(g.u)(n.valueOf(),e.valueOf(),t.date,t.date+60*t.duration*1e3));o+=i.length,c[n.valueOf()]=i,n=Object(H.a)(n,1)}return c})),this.min_date=Object($.a)(new Date),this.setDate=t=>this._state.setOptions({date:t}),this.setCalendar=t=>this._state.setOptions({calendar:t})}ngOnInit(){this._state.startPolling()}ngOnDestroy(){super.ngOnDestroy(),this._state.stopPolling()}onScroll(t){var e;const n=Array.prototype.slice.call((null===(e=this._el)||void 0===e?void 0:e.nativeElement.querySelectorAll("schedule-event-date-list"))||[]);if(!(null==n?void 0:n.length))return;const i=t.target.scrollTop;let c=null;for(const a of n)if(a.offsetTop-i>0){c=a;break}if(!c)return;const o=new Date(c.getAttribute("date"));Object(K.a)(o,this._state.date)||(console.log("Date:",Object(Z.a)(o,"dd MMM yyyy")),this.setDate(o.valueOf()))}scrollTo(t){this.timeout("scroll_to",()=>{var e;const n=null===(e=this._el)||void 0===e?void 0:e.nativeElement.querySelector(`[date="${Object(Z.a)(t,"yyyy-MM-dd")}"]`);n&&n.scrollIntoView({behavior:"smooth",inline:"center"})},1e3)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(ot),s.Pb(s.m))},t.\u0275cmp=s.Jb({type:t,selectors:[["schedule-event-list"]],features:[s.Ab],decls:37,vars:23,consts:[[1,"flex","p-2","items-center","bg-white","border-b","border-gray-200","shadow","space-x-2"],["appearance","outline",1,"h-12"],["name","calendars",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","desks"],[1,"flex-1","w-0"],["mat-button","",1,"clear",3,"matMenuTriggerFor"],["legend","matMenu"],[1,"flex","items-center","px-4","py-2","hover:bg-gray-100"],[1,"bg-success","h-2","w-2","rounded-full","mr-4"],[1,"bg-pending","h-2","w-2","rounded-full","mr-4"],[1,"bg-error","h-2","w-2","rounded-full","mr-4"],["mat-icon-button","",1,"relative"],["dateMenu",""],[3,"icon"],["matInput","",1,"opacity-0","absolute","inset-0",3,"ngModel","matDatepicker","min","ngModelChange"],["matSuffix","",1,"opacity-0","absolute","inset-0",3,"for"],["picker",""],[1,"w-full","flex-1","h-1/2","flex","flex-col"],[1,"flex-1","w-full","h-1/2","overflow-auto","p-4",3,"scroll"],[3,"date","events",4,"ngFor","ngForOf"],["mode","indeterminate",4,"ngIf"],[3,"value"],[3,"date","events"],["mode","indeterminate"]],template:function(t,e){if(1&t&&(s.Vb(0,"div",0),s.Vb(1,"mat-form-field",1),s.Vb(2,"mat-select",2),s.fc("ngModelChange",(function(t){return e.setCalendar(t)})),s.kc(3,"async"),s.Lc(4,Pt,2,2,"mat-option",3),s.kc(5,"async"),s.Vb(6,"mat-option",4),s.Nc(7,"Desks"),s.Ub(),s.Ub(),s.Ub(),s.Qb(8,"div",5),s.Vb(9,"button",6),s.Nc(10," Legend "),s.Ub(),s.Vb(11,"mat-menu",null,7),s.Vb(13,"div",8),s.Qb(14,"div",9),s.Nc(15," Approved "),s.Ub(),s.Vb(16,"div",8),s.Qb(17,"div",10),s.Nc(18," Tentative "),s.Ub(),s.Vb(19,"div",8),s.Qb(20,"div",11),s.Nc(21," Declined "),s.Ub(),s.Ub(),s.Vb(22,"button",12,13),s.Qb(24,"app-icon",14),s.Vb(25,"input",15),s.fc("ngModelChange",(function(t){return e.setDate(t),e.scrollTo(t)})),s.kc(26,"async"),s.Ub(),s.Qb(27,"mat-datepicker-toggle",16),s.Ub(),s.Qb(28,"mat-datepicker",null,17),s.Ub(),s.Vb(30,"main",18),s.Vb(31,"div",19),s.fc("scroll",(function(t){return e.onScroll(t)})),s.Lc(32,Dt,2,6,"schedule-event-date-list",20),s.kc(33,"keyvalue"),s.kc(34,"async"),s.Ub(),s.Lc(35,Vt,1,0,"mat-progress-bar",21),s.kc(36,"async"),s.Ub()),2&t){const t=s.xc(12),n=s.xc(29);let i=null;s.Db(2),s.qc("ngModel",s.lc(3,10,e.options).calendar),s.Db(2),s.qc("ngForOf",s.lc(5,12,e.calendars)),s.Db(5),s.qc("matMenuTriggerFor",t),s.Db(15),s.qc("icon",s.tc(22,jt)),s.Db(1),s.qc("ngModel",null==(i=s.lc(26,14,e.options))?null:i.date)("matDatepicker",n)("min",e.min_date),s.Db(2),s.qc("for",n),s.Db(5),s.qc("ngForOf",s.lc(33,16,s.lc(34,18,e.events))),s.Db(3),s.qc("ngIf",s.lc(36,20,e.loading))}},directives:[at.c,st.a,c.l,c.o,i.n,rt.j,v.b,lt.d,lt.a,_.a,dt.b,c.c,bt.b,bt.d,at.g,bt.a,i.o,wt,kt.a],pipes:[i.b,i.h,i.f],styles:["[_nghost-%COMP%] {\n                display: flex;\n                flex-direction: column;\n                width: 100%;\n                height: 50%;\n                flex: 1;\n            }"]}),t})();function Ut(t,e){1&t&&(s.Tb(0),s.Qb(1,"schedule-view-event",6),s.Sb())}function qt(t,e){1&t&&(s.Tb(0),s.Qb(1,"schedule-event-list",6),s.Sb())}let It=(()=>{class t{constructor(){this.show_menu=!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Jb({type:t,selectors:[["app-schedule"]],decls:6,vars:4,consts:[[3,"menu","menuChange"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"w-full"],[3,"show","showChange"],[1,"flex-1","h-1/2"]],template:function(t,e){1&t&&(s.Vb(0,"a-topbar-header",0),s.fc("menuChange",(function(t){return e.show_menu=t})),s.Ub(),s.Tb(1,1),s.Lc(2,Ut,2,0,"ng-container",2),s.Lc(3,qt,2,0,"ng-container",3),s.Sb(),s.Qb(4,"a-footer-menu",4),s.Vb(5,"a-overlay-menu",5),s.fc("showChange",(function(t){return e.show_menu=t})),s.Ub()),2&t&&(s.qc("menu",e.show_menu),s.Db(1),s.qc("ngSwitch",e.page),s.Db(1),s.qc("ngSwitchCase","view"),s.Db(3),s.qc("show",e.show_menu))},directives:[r.a,i.q,i.r,i.s,l.a,d.a,z,xt],styles:["[_nghost-%COMP%] {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n            }"]}),t})();const St=[{path:"",component:It},{path:":page",component:It},{path:":page/:id",component:It},{path:"**",redirectTo:""}];var Nt=n("R3Ii");let Lt=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},imports:[[i.c,c.h,c.p,a.g.forChild(St),Nt.a,o.c]]}),t})()}}]);
//# sourceMappingURL=schedule-schedule-module.b87c8b495dafd33cae3d.js.map