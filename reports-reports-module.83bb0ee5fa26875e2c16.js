(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{mjT4:function(t,e,n){"use strict";n.d(e,"a",(function(){return V})),n.d(e,"c",(function(){return U.a})),n.d(e,"b",(function(){return L}));var i=n("MIKl"),o=n("EM62"),s=n("2kYt"),c=n("nIj0"),a=n("29Wa"),r=n("Cd2c"),l=n("+Tre");function b(t,e){1&t&&(o.Vb(0,"mat-error"),o.Lc(1,"Name is required"),o.Ub())}function d(t,e){if(1&t&&(o.Vb(0,"div",4),o.Vb(1,"label",5),o.Lc(2,"Name"),o.Vb(3,"span"),o.Lc(4,"*"),o.Ub(),o.Lc(5,":"),o.Ub(),o.Vb(6,"mat-form-field",6),o.Qb(7,"input",7),o.Jc(8,b,2,0,"mat-error",8),o.Ub(),o.Ub()),2&t){const t=o.jc(2);o.Db(1),o.Hb("error",t.form.controls.name.invalid&&t.form.controls.name.touched),o.Db(7),o.pc("ngIf",t.form.controls.name.invalid)}}function p(t,e){1&t&&(o.Vb(0,"mat-error"),o.Lc(1,"A valid email is required"),o.Ub())}function u(t,e){if(1&t&&(o.Vb(0,"div",4),o.Vb(1,"label",9),o.Lc(2,"Email"),o.Vb(3,"span"),o.Lc(4,"*"),o.Ub(),o.Lc(5,":"),o.Ub(),o.Vb(6,"mat-form-field",6),o.Qb(7,"input",10),o.Jc(8,p,2,0,"mat-error",8),o.Ub(),o.Ub()),2&t){const t=o.jc(2);o.Db(1),o.Hb("error",t.form.controls.email.invalid&&t.form.controls.email.touched),o.Db(7),o.pc("ngIf",t.form.controls.email.invalid)}}function f(t,e){1&t&&(o.Vb(0,"mat-error"),o.Lc(1,"Organisation is required"),o.Ub())}function g(t,e){if(1&t&&(o.Vb(0,"div",4),o.Vb(1,"label",11),o.Lc(2,"Organisation"),o.Vb(3,"span"),o.Lc(4,"*"),o.Ub(),o.Lc(5,":"),o.Ub(),o.Vb(6,"mat-form-field",6),o.Qb(7,"input",12),o.Jc(8,f,2,0,"mat-error",8),o.Ub(),o.Ub()),2&t){const t=o.jc(2);o.Db(1),o.Hb("error",t.form.controls.organisation.invalid&&t.form.controls.organisation.touched),o.Db(7),o.pc("ngIf",t.form.controls.organisation.invalid)}}function h(t,e){1&t&&(o.Vb(0,"mat-error"),o.Lc(1,"Phone format is invalid"),o.Ub())}function m(t,e){if(1&t&&(o.Vb(0,"div",4),o.Vb(1,"label",13),o.Lc(2,"Phone:"),o.Ub(),o.Vb(3,"mat-form-field",6),o.Qb(4,"input",14),o.Jc(5,h,2,0,"mat-error",8),o.Ub(),o.Ub()),2&t){const t=o.jc(2);o.Db(1),o.Hb("error",t.form.controls.phone.invalid&&t.form.controls.phone.touched),o.Db(4),o.pc("ngIf",t.form.controls.phone.invalid)}}function v(t,e){1&t&&(o.Vb(0,"div",4),o.Vb(1,"mat-checkbox",15),o.Lc(2,"Assistance required"),o.Ub(),o.Ub())}function _(t,e){1&t&&(o.Vb(0,"div",4),o.Vb(1,"mat-checkbox",16),o.Lc(2,"Visit expected"),o.Ub(),o.Ub())}function y(t,e){if(1&t&&(o.Vb(0,"div",1),o.Vb(1,"form",2),o.Jc(2,d,9,3,"div",3),o.Jc(3,u,9,3,"div",3),o.Jc(4,g,9,3,"div",3),o.Jc(5,m,6,3,"div",3),o.Jc(6,v,3,0,"div",3),o.Jc(7,_,3,0,"div",3),o.Ub(),o.Ub()),2&t){const t=o.jc();o.Db(1),o.pc("formGroup",t.form),o.Db(1),o.pc("ngIf",t.form.controls.name),o.Db(1),o.pc("ngIf",t.form.controls.email),o.Db(1),o.pc("ngIf",t.form.controls.organisation),o.Db(1),o.pc("ngIf",t.form.controls.phone),o.Db(1),o.pc("ngIf",t.form.controls.assistance_required),o.Db(1),o.pc("ngIf",t.form.controls.visit_expected)}}let O=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Jb({type:t,selectors:[["user-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[["class","user form",4,"ngIf"],[1,"user","form"],[3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","name"],["appearance","outline"],["matInput","","name","name","placeholder","Name","formControlName","name"],[4,"ngIf"],["for","email"],["matInput","","name","email","placeholder","Email Address","formControlName","email"],["for","organisation"],["matInput","","name","organisation","placeholder","Organisation","formControlName","organisation"],["for","phone"],["matInput","","name","phone","placeholder","Phone","formControlName","phone"],["color","primary","formControlName","assistance_required"],["color","primary","formControlName","visit_expected"]],template:function(t,e){1&t&&o.Jc(0,y,8,7,"div",0),2&t&&o.pc("ngIf",e.form)},directives:[s.n,c.r,c.m,c.g,a.c,r.b,c.c,c.l,c.e,a.b,l.a],styles:["label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--pending)}label.error[_ngcontent-%COMP%]{color:var(--error)}.field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),t})();n("/It1"),n("20lr"),n("xuqh"),n("vobO"),n("mqs+");class V{constructor(t){this.type=t.type||t.location||"other",this.position=t.position||t.map_id||{x:t.x/t.map_width,y:t.y/t.map_height},this.variance=t.variance||0,this.last_seen=t.last_seen||Math.floor((new Date).valueOf()/1e3),this.level=t.level,this.building=t.building,this.at_location=!!t.at_location}}n("D57K");var U=n("Vai6"),j=(n("HTl7"),n("OZ4H")),D=n("Rc+I"),k=n("PBFl"),w=n("ukpX"),x=n("csyo");let L=(()=>{class t{}return t.\u0275mod=o.Nb({type:t}),t.\u0275inj=o.Mb({factory:function(e){return new(e||t)},imports:[[s.c,c.h,c.p,j.f,D.b,l.b]]}),t})();o.Bc(i.a,[j.h,k.b,j.d,w.a,j.e,s.n,O,j.c,x.b],[])},uHdG:function(t,e,n){"use strict";n.r(e),n.d(e,"ReportsModule",(function(){return bt}));var i=n("2kYt"),o=n("nIj0"),s=n("sEIs"),c=n("oRDy"),a=n("EM62"),r=n("UfDH"),l=n("D57K"),b=n("jOdJ"),d=n("20lr"),p=n("/It1"),u=n("eZII"),f=n("9MvL"),g=n("KuCG"),h=n("JuBR"),m=n("njY1"),v=n("mrqE"),_=864e5;function y(t,e){Object(v.a)(2,arguments);var n=Object(f.a)(t),i=Object(f.a)(e),o=n.getTime()-Object(m.a)(n),s=i.getTime()-Object(m.a)(i);return Math.round((o-s)/_)}function O(t,e){var n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}var V=n("CzDk"),U=n("ZTXN"),j=n("C05f"),D=n("ROBh"),k=n("HM3f"),w=n("mWib"),x=n("TLy2"),L=n("4e/d"),M=n("YtkY"),I=n("wqq/"),C=n("05Mk"),J=n("dJst");let P=(()=>{class t{constructor(t,e,n){this._bookings=t,this._events=e,this._org=n,this._generate=new U.b,this._loading=new j.a(""),this._active_bookings=new j.a([]),this._options=new j.a({start:new Date,end:new Date}),this._bookings_list=this._generate.pipe(Object(w.a)(500),Object(x.a)(t=>{var e;console.log("Report:",t);const n=this._options.getValue();if(this._loading.next("Loading report details..."),!(null==n?void 0:n.type)&&!(null===(e=null==n?void 0:n.zones)||void 0===e?void 0:e.length))return Object(D.a)([]);const i=Object(f.a)((null==n?void 0:n.start)?new Date(n.start):new Date).valueOf(),o=Object(g.a)((null==n?void 0:n.end)?new Date(n.end):i).valueOf(),s=(null==n?void 0:n.zones)?n.zones.filter(t=>"All"!==t).join(","):"",c={period_start:Math.floor(i/1e3),period_end:Math.floor(o/1e3)};return"desks"===n.type?this._bookings.query(Object.assign(Object.assign({},c),{zone_ids:s,type:"desk"})):this._events.query(Object.assign(Object.assign({},c),{zone_ids:s}))}),Object(L.a)(t=>[]),Object(M.a)(t=>(this._loading.next(""),(null==t?void 0:t.length)||Object(d.l)("No bookings for the selected levels and period"),this._active_bookings.next(t||[]),t)),Object(I.a)()),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.bookings=this._active_bookings.asObservable(),this.counts=this._options.pipe(Object(w.a)(500),Object(x.a)(t=>{const e=(t.zones||[]).filter(t=>-1!==t&&"All"!==t);return Promise.all(e.map(t=>Object(p.t)(t,{name:"desks"}).pipe(Object(M.a)(e=>[t,e.details.length])).toPromise()))}),Object(L.a)(t=>[]),Object(M.a)(t=>{const e={};return this._active_bookings.next([]),t.forEach(([t,n])=>e[t]=n),e}),Object(I.a)()),this.stats=Object(k.b)([this.counts,this.bookings]).pipe(Object(M.a)(([t,e])=>e[0]instanceof u.a?function(t,e=8){const n=t.reduce((t,e)=>t+e.attendees.length,0),i=t.reduce((t,e)=>t+e.system.capacity,0),o=t.reduce((t,e)=>t+e.duration,0)/(60*e),s=n/i;return{count:t.length,avg_length:t.reduce((t,e)=>t+e.duration,0)/t.length,efficiency:(o+s)/2,total_users:n,total_capacity:i,occupancy:s,utilisation:o,events:t}}(e,8*this.duration):function(t,e=1,n={}){console.log("Counts:",n);const i=Object.keys(n).reduce((t,e)=>t+(n[e]||0),0);return{total:i,count:t.length,utilisation:t.length/i,events:t}}(e||[],this.duration,t))),this._bookings_list.subscribe(t=>t)}get duration(){const t=this._options.getValue();return Math.abs(function(t,e){Object(v.a)(2,arguments);var n=Object(h.a)(t),i=Object(h.a)(e),o=O(n,i),s=Math.abs(y(n,i));n.setDate(n.getDate()-o*s);var c=O(n,i)===-o,a=o*(s-c);return 0===a?0:a}(t.start,t.end))}generateReport(){console.log("Report"),this._generate.next((new Date).valueOf())}setOptions(t){var e,n,i,o,s,c,a;(null===(e=t.zones)||void 0===e?void 0:e.includes("All"))?t.zones=["All",...this._org.levelsForBuilding(this._org.building).map(t=>t.id)]:t.zones&&(null===(i=null===(n=this._options.getValue())||void 0===n?void 0:n.zones)||void 0===i?void 0:i.includes("All"))&&(t.zones=[]),(null===(o=t.start)||void 0===o?void 0:o.valueOf())!==(null===(s=this._options.getValue().start)||void 0===s?void 0:s.valueOf())&&(null===(c=t.end)||void 0===c?void 0:c.valueOf())!==(null===(a=this._options.getValue().end)||void 0===a?void 0:a.valueOf())&&this._options.next(Object.assign(Object.assign({},this._options.getValue()),t))}downloadReport(){const t=this._options.getValue(),e=this._active_bookings.getValue();Object(d.h)(`report+${t.type}+${Object(V.a)(t.start,"yyyy-MM-dd")}+${Object(V.a)(t.end,"yyyy-MM-dd")}.csv`,Object(d.k)(e.map(t=>{const e=t.toJSON();return delete e.zones,delete e.server_names,e})))}}return t.\u0275fac=function(e){return new(e||t)(a.cc(C.b),a.cc(u.b),a.cc(J.c))},t.\u0275prov=a.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var N=n("29Wa"),z=n("R7+U"),E=n("mFH5"),R=n("gcUQ"),F=n("PBFl"),T=n("csyo");function q(t,e){if(1&t&&(a.Vb(0,"mat-option",13),a.Lc(1),a.Ub()),2&t){const t=e.$implicit;a.pc("value",t.id),a.Db(1),a.Nc(" ",t.display_name||t.name," ")}}function Q(t,e){1&t&&a.Qb(0,"mat-spinner",14),2&t&&a.pc("diameter",32)}function S(t,e){1&t&&(a.Vb(0,"p"),a.Lc(1,"Generate Report"),a.Ub())}let A=(()=>{class t extends d.c{constructor(t,e,n){super(),this._state=t,this._org=e,this._route=n,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(t=>""+t.id),this.levels=this._org.active_levels,this.loading=this._state.loading,this.bookings=this._state.bookings,this.options=this._state.options,this.generateReport=()=>this._state.generateReport(),this.downloadReport=()=>this._state.downloadReport(),this.setStartDate=t=>this._state.setOptions({start:new Date(t)}),this.setEndDate=t=>this._state.setOptions({end:new Date(t)}),this.setZones=t=>this._state.setOptions({zones:t})}ngOnInit(){return Object(l.a)(this,void 0,void 0,(function*(){yield this._org.initialised.pipe(Object(b.a)(t=>t)).toPromise(),this.subscription("route.query",this._route.queryParamMap.subscribe(t=>{if(t.has("zone_ids")){const e=t.get("zone_ids").split(",");if(e.length){const t=this._org.levelWithID(e);if(!t)return;this._org.building=this._org.buildings.find(e=>e.id===t.parent_id),this.setZones(e)}}}))}))}}return t.\u0275fac=function(e){return new(e||t)(a.Pb(P),a.Pb(J.c),a.Pb(s.a))},t.\u0275cmp=a.Jb({type:t,selectors:[["reports-options"]],features:[a.Ab],decls:26,vars:26,consts:[["appearance","outline",1,"w-48"],["multiple","","placeholder","Select Levels...",3,"ngModel","ngModelChange"],["value","All"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"w-64"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["mat-button","",1,"ml-4",3,"disabled","click"],[3,"diameter",4,"ngIf"],[4,"ngIf"],[3,"value"],[3,"diameter"]],template:function(t,e){if(1&t&&(a.Vb(0,"mat-form-field",0),a.Vb(1,"mat-select",1),a.fc("ngModelChange",(function(t){return e.setZones(t)})),a.kc(2,"async"),a.Vb(3,"mat-option",2),a.Lc(4,"All Levels"),a.Ub(),a.Jc(5,q,2,2,"mat-option",3),a.kc(6,"async"),a.Ub(),a.Ub(),a.Vb(7,"mat-form-field",4),a.Vb(8,"mat-date-range-input",5),a.Vb(9,"input",6),a.fc("ngModelChange",(function(t){return t?e.setStartDate(t):""})),a.kc(10,"async"),a.Ub(),a.Vb(11,"input",7),a.fc("ngModelChange",(function(t){return t?e.setEndDate(t):""})),a.kc(12,"async"),a.Ub(),a.Ub(),a.Qb(13,"mat-datepicker-toggle",8),a.Qb(14,"mat-date-range-picker",null,9),a.Ub(),a.Vb(16,"button",10),a.fc("click",(function(){return e.generateReport()})),a.kc(17,"async"),a.Jc(18,Q,1,1,"mat-spinner",11),a.kc(19,"async"),a.Jc(20,S,2,0,"p",12),a.kc(21,"async"),a.Ub(),a.Vb(22,"button",10),a.fc("click",(function(){return e.downloadReport()})),a.kc(23,"async"),a.Vb(24,"p"),a.Lc(25,"Download Report"),a.Ub(),a.Ub()),2&t){const t=a.vc(15);let n=null,i=null,o=null,s=null;a.Db(1),a.pc("ngModel",null==(n=a.lc(2,10,e.options))?null:n.zones),a.Db(4),a.pc("ngForOf",a.lc(6,12,e.levels)),a.Db(3),a.pc("rangePicker",t),a.Db(1),a.pc("ngModel",null==(i=a.lc(10,14,e.options))?null:i.start),a.Db(2),a.pc("ngModel",null==(o=a.lc(12,16,e.options))?null:o.end),a.Db(2),a.pc("for",t),a.Db(3),a.pc("disabled",!!a.lc(17,18,e.loading)),a.Db(2),a.pc("ngIf",a.lc(19,20,e.loading)),a.Db(2),a.pc("ngIf",!a.lc(21,22,e.loading)),a.Db(2),a.pc("disabled",!(null!=(s=a.lc(23,24,e.bookings))&&s.length))}},directives:[N.c,z.a,o.l,o.o,E.j,i.m,R.a,R.h,o.c,R.g,R.f,N.g,R.b,F.b,i.n,T.b],pipes:[i.b],styles:["[_nghost-%COMP%] {\n                display: flex;\n                align-items: center;\n                background-color: #fff;\n                height: 5em;\n                padding: 0 1em;\n            }\n\n            button[_ngcontent-%COMP%] {\n                min-width: 0;\n                padding: 0 0.85rem;\n            }\n\n            mat-form-field[_ngcontent-%COMP%] {\n                height: 3.25em;\n                margin-left: 1em;\n            }\n\n            mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] {\n                width: 5.5em;\n                white-space: initial;\n                line-height: 1.2em;\n            }"]}),t})(),H=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Jb({type:t,selectors:[["app-reports"]],decls:5,vars:0,consts:[[1,"h-full"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full"],[1,"flex-1","h-1/2","w-full","overflow-auto"]],template:function(t,e){1&t&&(a.Qb(0,"sidebar",0),a.Vb(1,"main",1),a.Qb(2,"reports-options"),a.Vb(3,"div",2),a.Qb(4,"router-outlet"),a.Ub(),a.Ub())},directives:[r.a,A,s.h],styles:["[_nghost-%COMP%] {\n                display: flex;\n                height: 100%;\n                width: 100%;\n            }"]}),t})();var B=n("6CBO"),K=n("mjT4"),Y=n("QHQ3");const Z=["report-spaces",""];function G(t,e){if(1&t&&(a.Tb(0),a.Vb(1,"div",3),a.Vb(2,"div",4),a.Vb(3,"h3"),a.Lc(4,"Total Bookings"),a.Ub(),a.Vb(5,"p"),a.Lc(6),a.kc(7,"async"),a.Ub(),a.Ub(),a.Vb(8,"div",4),a.Vb(9,"h3"),a.Lc(10,"Average Bookings Length"),a.Ub(),a.Vb(11,"p"),a.Lc(12),a.kc(13,"async"),a.Ub(),a.Ub(),a.Ub(),a.Vb(14,"div",5),a.Vb(15,"div",6),a.Vb(16,"h3"),a.Lc(17,"Overall Efficiency"),a.Ub(),a.Vb(18,"p"),a.Lc(19),a.kc(20,"async"),a.Ub(),a.Ub(),a.Vb(21,"div",7),a.Vb(22,"div",8),a.Vb(23,"div",9),a.Vb(24,"h3"),a.Lc(25,"Total Attendees"),a.Ub(),a.Vb(26,"p"),a.Lc(27),a.kc(28,"async"),a.Ub(),a.Ub(),a.Vb(29,"div",9),a.Vb(30,"h3"),a.Lc(31,"Total Capacity"),a.Ub(),a.Vb(32,"p"),a.Lc(33),a.kc(34,"async"),a.Ub(),a.Ub(),a.Ub(),a.Vb(35,"h3"),a.Lc(36,"Occupancy"),a.Ub(),a.Vb(37,"p"),a.Lc(38),a.kc(39,"async"),a.Ub(),a.Ub(),a.Vb(40,"div",10),a.Vb(41,"h3"),a.Lc(42,"Utilisation"),a.Ub(),a.Vb(43,"p"),a.Lc(44),a.kc(45,"async"),a.Ub(),a.Ub(),a.Ub(),a.Sb()),2&t){const t=a.jc(2);a.Db(6),a.Mc(a.lc(7,7,t.total_count)||0),a.Db(6),a.Mc(a.lc(13,9,t.avg_length)||"None"),a.Db(7),a.Nc("",a.lc(20,11,t.efficiency)||0,"%"),a.Db(8),a.Mc(a.lc(28,13,t.total_users)||0),a.Db(6),a.Mc(a.lc(34,15,t.total_capacity)||0),a.Db(5),a.Nc("",a.lc(39,17,t.occupancy)||0,"%"),a.Db(6),a.Nc("",a.lc(45,19,t.utilisation)||0,"%")}}function $(t,e){if(1&t&&(a.Tb(0),a.Jc(1,G,46,21,"ng-container",0),a.kc(2,"async"),a.Sb()),2&t){const t=a.jc(),e=a.vc(5);a.Db(1),a.pc("ngIf",a.lc(2,2,t.total_count))("ngIfElse",e)}}function W(t,e){1&t&&(a.Vb(0,"div",11),a.Qb(1,"mat-spinner",12),a.Vb(2,"p",13),a.Lc(3,"Loading report data..."),a.Ub(),a.Ub()),2&t&&(a.Db(1),a.pc("diameter",32))}function X(t,e){1&t&&(a.Vb(0,"div",11),a.Vb(1,"p",13),a.Lc(2," Select levels and time period to generate a report. "),a.Ub(),a.Ub())}let tt=(()=>{class t{constructor(t){this._state=t,this.total_count=this._state.stats.pipe(Object(M.a)(t=>t.count||0)),this.avg_length=this._state.stats.pipe(Object(M.a)(t=>Object(Y.a)({minutes:t.avg_length||0}))),this.efficiency=this._state.stats.pipe(Object(M.a)(t=>(100*(t.efficiency||0)).toFixed(1))),this.total_users=this._state.stats.pipe(Object(M.a)(t=>t.total_users||0)),this.total_capacity=this._state.stats.pipe(Object(M.a)(t=>t.total_capacity||0)),this.occupancy=this._state.stats.pipe(Object(M.a)(t=>(100*(t.occupancy||0)).toFixed(1))),this.utilisation=this._state.stats.pipe(Object(M.a)(t=>(100*(t.utilisation||0)).toFixed(1))),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}return t.\u0275fac=function(e){return new(e||t)(a.Pb(P))},t.\u0275cmp=a.Jb({type:t,selectors:[["","report-spaces",""]],attrs:Z,decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"m-4","p-4","rounded","flex","justify-center","items-center","space-x-4","text-center"],[1,"flex","flex-col","items-center","justify-center","bg-primary","text-white","shadow","rounded","p-4","w-48","h-48"],[1,"flex","flex-col","items-center","bg-primary","text-white","border-4","border-primary","shadow","overflow-hidden","rounded","pb-4","w-48","h-48"],[1,"flex","divide-x-4","divide-primary","mb-4"],[1,"flex","flex-col","items-center","justify-center","flex-1","bg-gray-200","text-black"],[1,"flex","flex-col","items-center","justify-center","bg-primary","text-white","rounded","p-4","w-48","h-48"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(t,e){if(1&t&&(a.Jc(0,$,3,4,"ng-container",0),a.kc(1,"async"),a.Jc(2,W,4,1,"ng-template",null,1,a.Kc),a.Jc(4,X,3,0,"ng-template",null,2,a.Kc)),2&t){const t=a.vc(3);a.pc("ngIf",!a.lc(1,2,e.loading))("ngIfElse",t)}},directives:[i.n,T.b],pipes:[i.b],styles:["h3[_ngcontent-%COMP%] {\n                font-weight: 500;\n            }\n\n            p[_ngcontent-%COMP%]:not([simple]) {\n                font-size: 1.75rem;\n            }"]}),t})();var et=n("R3DB"),nt=n("XyEp");const it=["report-desks",""];function ot(t,e){if(1&t&&(a.Vb(0,"div",11),a.Vb(1,"div",7),a.Lc(2),a.kc(3,"date"),a.Ub(),a.Vb(4,"div",8),a.Lc(5),a.Ub(),a.Vb(6,"div",8),a.Lc(7),a.Ub(),a.Vb(8,"div",8),a.Lc(9),a.Ub(),a.Vb(10,"div",8),a.Lc(11),a.Ub(),a.Ub()),2&t){const t=e.$implicit;a.Db(2),a.Nc(" ",a.mc(3,6,t.date,"longDate")," "),a.Db(3),a.Oc("",t.free||0," / ",t.total||0,""),a.Db(2),a.Mc(t.approved||0),a.Db(2),a.Mc(t.count||0),a.Db(2),a.Nc("",t.utilisation,"%")}}function st(t,e){if(1&t&&(a.Tb(0),a.Vb(1,"div",3),a.Vb(2,"div",4),a.Vb(3,"h3"),a.Lc(4,"Total Bookings"),a.Ub(),a.Vb(5,"p"),a.Lc(6),a.kc(7,"async"),a.Ub(),a.Ub(),a.Vb(8,"div",4),a.Vb(9,"h3"),a.Lc(10,"Utilisation"),a.Ub(),a.Vb(11,"p"),a.Lc(12),a.kc(13,"async"),a.Ub(),a.Ub(),a.Ub(),a.Vb(14,"div",5),a.Vb(15,"div",6),a.Vb(16,"div",7),a.Lc(17,"Date"),a.Ub(),a.Vb(18,"div",8),a.Lc(19,"Free Desks"),a.Ub(),a.Vb(20,"div",8),a.Lc(21,"Approved Bookings"),a.Ub(),a.Vb(22,"div",8),a.Lc(23,"Total Requests"),a.Ub(),a.Vb(24,"div",8),a.Lc(25,"Utilisation"),a.Ub(),a.Ub(),a.Vb(26,"div",9),a.Jc(27,ot,12,9,"div",10),a.kc(28,"async"),a.Ub(),a.Ub(),a.Sb()),2&t){const t=a.jc(2);a.Db(6),a.Mc(a.lc(7,3,t.total_count)||0),a.Db(6),a.Nc("",a.lc(13,5,t.utilisation)||0,"%"),a.Db(15),a.pc("ngForOf",a.lc(28,7,t.day_list))}}function ct(t,e){if(1&t&&(a.Tb(0),a.Jc(1,st,29,9,"ng-container",0),a.kc(2,"async"),a.Sb()),2&t){const t=a.jc(),e=a.vc(5);a.Db(1),a.pc("ngIf",a.lc(2,2,t.total_count))("ngIfElse",e)}}function at(t,e){1&t&&(a.Vb(0,"div",12),a.Qb(1,"mat-spinner",13),a.Vb(2,"p",14),a.Lc(3,"Loading report data..."),a.Ub(),a.Ub()),2&t&&(a.Db(1),a.pc("diameter",32))}function rt(t,e){1&t&&(a.Vb(0,"div",12),a.Vb(1,"p",14),a.Lc(2," Select levels and time period to generate a report. "),a.Ub(),a.Ub())}const lt=[{path:"",component:H,children:[{path:"spaces",component:tt},{path:"desks",component:(()=>{class t{constructor(t){this._state=t,this.total_count=this._state.stats.pipe(Object(M.a)(t=>t.count||0)),this.utilisation=this._state.stats.pipe(Object(M.a)(t=>(100*(t.utilisation||0)).toFixed(1))),this.loading=this._state.loading,this.day_list=Object(k.b)([this._state.options,this._state.stats]).pipe(Object(M.a)(([t,e])=>{const{start:n,end:i}=t;let o=n;const s=[];for(;Object(et.a)(o,i);){const t=Object(f.a)(o).valueOf(),n=Object(g.a)(t).valueOf(),i=e.events.filter(e=>Object(d.v)(t,n,e.date,e.date+60*e.duration*1e3));s.push({date:t,total:e.total,free:e.total-i.length,approved:i.reduce((t,e)=>t+(e.approved?1:0),0),count:i.length,utilisation:(i.length/e.total*100).toFixed(1)}),o=Object(nt.a)(o,1)}return s}))}ngOnInit(){this._state.setOptions({type:"desks"})}}return t.\u0275fac=function(e){return new(e||t)(a.Pb(P))},t.\u0275cmp=a.Jb({type:t,selectors:[["","report-desks",""]],attrs:it,decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"m-4","rounded","bg-white","shadow"],["table-head","",1,"flex","items-center","font-medium","border-b","border-gray-200"],[1,"w-1/3","p-4"],[1,"w-1/6","p-4"],["table-body",""],["table-row","","class","flex items-center border-b border-gray-200",4,"ngFor","ngForOf"],["table-row","",1,"flex","items-center","border-b","border-gray-200"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(t,e){if(1&t&&(a.Jc(0,ct,3,4,"ng-container",0),a.kc(1,"async"),a.Jc(2,at,4,1,"ng-template",null,1,a.Kc),a.Jc(4,rt,3,0,"ng-template",null,2,a.Kc)),2&t){const t=a.vc(3);a.pc("ngIf",!a.lc(1,2,e.loading))("ngIfElse",t)}},directives:[i.n,i.m,T.b],pipes:[i.b,i.f],styles:["h3[_ngcontent-%COMP%] {\n                font-weight: 500;\n            }\n\n            p[_ngcontent-%COMP%]:not([simple]) {\n                font-size: 1.75rem;\n            }"]}),t})()},{path:"**",redirectTo:"desks"}]}];let bt=(()=>{class t{}return t.\u0275mod=a.Nb({type:t}),t.\u0275inj=a.Mb({factory:function(e){return new(e||t)},imports:[[i.c,o.h,c.a,B.a,K.b,s.g.forChild(lt)]]}),t})()}}]);
//# sourceMappingURL=reports-reports-module.83bb0ee5fa26875e2c16.js.map