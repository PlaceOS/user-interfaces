"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_url-management_url-manager_module_ts"],{93074:(E,f,n)=>{n.r(f),n.d(f,{UrlManagerModule:()=>mt});var u=n(26575),l=n(28849),S=n(92649),T=n(97910),x=n(46514),v=n(59524),d=n(71670),A=n(93121),p=n(70462),M=n(28159),s=n(36520),Z=n(680),P=n(47422),g=n(17401),m=n(34592),t=n(29039),F=n(71268),b=n(99674),O=n(56658),I=n(33910),y=n(53313),U=n(94888);function G(o,c){1&o&&(t.TgZ(0,"button",4)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function w(o,c){1&o&&(t.TgZ(0,"div",10)(1,"label",11),t.tHW(2,12),t._UZ(3,"span"),t.N_p(),t.qZA(),t.TgZ(4,"mat-form-field",13),t._UZ(5,"input",14),t.qZA()())}function $(o,c){1&o&&(t.TgZ(0,"div",15)(1,"label",16),t.SDv(2,17),t.qZA(),t._UZ(3,"rich-text-input",18),t.qZA())}function D(o,c){1&o&&(t.TgZ(0,"div",10)(1,"label",19),t.tHW(2,20),t._UZ(3,"span"),t.N_p(),t.qZA(),t.TgZ(4,"mat-form-field",13),t._UZ(5,"input",21),t.qZA()())}function J(o,c){1&o&&(t.TgZ(0,"div",15)(1,"mat-checkbox",22),t._uU(2," Enabled "),t.qZA()())}function Q(o,c){if(1&o&&(t.TgZ(0,"form",7),t.YNc(1,w,6,0,"div",8)(2,$,4,0,"div",9)(3,D,6,0,"div",8)(4,J,3,0,"div",9),t.qZA()),2&o){const e=t.oxw(2);t.Q6J("formGroup",e.form),t.xp6(),t.Q6J("ngIf",e.form.controls.name),t.xp6(),t.Q6J("ngIf",e.form.controls.description),t.xp6(),t.Q6J("ngIf",e.form.controls.uri),t.xp6(),t.Q6J("ngIf",e.form.controls.enabled)}}function X(o,c){if(1&o&&(t.TgZ(0,"main",5),t.YNc(1,Q,5,5,"form",6),t.qZA()),2&o){const e=t.oxw();t.xp6(),t.Q6J("ngIf",e.form)}}function Y(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"footer",23)(1,"button",24),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.save())}),t._uU(2,"Save"),t.qZA()()}}function j(o,c){1&o&&(t.TgZ(0,"div",25),t._UZ(1,"mat-spinner",26),t.TgZ(2,"p",27),t._uU(3,"Saving Short URL..."),t.qZA()())}let H=(()=>{class o extends m.cx{constructor(e,a){super(),this._data=e,this._dialog_ref=a,this.loading=!1,this.form=new l.cw({id:new l.NI(this._data?.id||""),name:new l.NI(this._data?.name||"",[l.kI.required]),description:new l.NI(this._data?.description||"",[]),uri:new l.NI(this._data?.uri||"",[l.kI.required]),enabled:new l.NI(this._data?.enabled??!0,[])})}ngOnInit(){return(0,d.Z)(function*(){})()}save(){var e=this;return(0,d.Z)(function*(){if(!e.form.valid)return(0,m.cB)(`Some form fields are invalid. [${(0,m.RD)(e.form).join(", ")}]`);const a=e.form.getRawValue();e.loading=!0;const r=yield(0,m.Nc)(a).toPromise().catch(i=>(0,m.cB)(`Error saving Short URL: ${i.message}`));r.id&&e._dialog_ref.close(r),e.loading=!1})()}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(g.WI),t.Y36(g.so))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["short-url-modal"]],features:[t.qOj],decls:8,vars:5,consts:()=>{let e,a,r,i,_;return e=$localize`:@@nameLabel␟5813c0ce49afffe90191cb912c58fa68674457d8␟1912970594501107766: Name${"\ufffd#3\ufffd"}:START_TAG_SPAN:*${"\ufffd/#3\ufffd"}:CLOSE_TAG_SPAN:: `,a=$localize`:@@namePlaceholder␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,r=$localize`:@@nameLabel␟9965b5a3b51c515676f9a276e6a893e2a1732ca3␟8750987738498515809: Description: `,i=$localize`:@@nameLabel␟376ac142eacbbec6739bf8511dbcf6c843326916␟7187203761692841608: URI${"\ufffd#3\ufffd"}:START_TAG_SPAN:*${"\ufffd/#3\ufffd"}:CLOSE_TAG_SPAN:: `,_=$localize`:@@uriPlaceholder␟6afb9c1cbd2b73b7a916ca72a1827142d917dc51␟4044274328469675696:URI`,[["btn","","icon","","mat-dialog-close","",4,"ngIf"],["class","max-h-[65vh] overflow-y-auto overflow-x-hidden p-4",4,"ngIf","ngIfElse"],["class","p-2 flex justify-end border-t border-base-200",4,"ngIf"],["load_state",""],["btn","","icon","","mat-dialog-close",""],[1,"max-h-[65vh]","overflow-y-auto","overflow-x-hidden","p-4"],["system","","class","flex flex-col w-[28rem] max-w-[calc(100vw-4rem)]",3,"formGroup",4,"ngIf"],["system","",1,"flex","flex-col","w-[28rem]","max-w-[calc(100vw-4rem)]",3,"formGroup"],["class","flex flex-col",4,"ngIf"],["class","flex flex-col pb-4",4,"ngIf"],[1,"flex","flex-col"],["for","name"],e,["appearance","outline"],["matInput","","name","name","placeholder",a,"formControlName","name"],[1,"flex","flex-col","pb-4"],["for","description"],r,["name","description","formControlName","description"],["for","uri"],i,["matInput","","name","uri","placeholder",_,"formControlName","uri"],["formControlName","enabled"],[1,"p-2","flex","justify-end","border-t","border-base-200"],["btn","",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","justify-center","w-64","h-64"],["diameter","32"],[1,"mt-4"]]},template:function(a,r){if(1&a&&(t.TgZ(0,"header")(1,"h2"),t._uU(2),t.qZA(),t.YNc(3,G,3,0,"button",0),t.qZA(),t.YNc(4,X,2,1,"main",1)(5,Y,3,0,"footer",2)(6,j,4,0,"ng-template",null,3,t.W1O)),2&a){const i=t.MAs(7);t.xp6(2),t.hij("",r.form.value.id?"Edit":"Add"," Short URL"),t.xp6(),t.Q6J("ngIf",!r.loading),t.xp6(),t.Q6J("ngIf",!r.loading)("ngIfElse",i),t.xp6(),t.Q6J("ngIf",!r.loading)}},dependencies:[u.O5,l._Y,l.Fj,l.JJ,l.JL,F.KE,b.Nt,O.oG,I.Ou,g.ZT,l.sg,l.u,y.n,U.o]})}return o})(),N=(()=>{class o{constructor(e,a){this._org=e,this._dialog=a,this._options=new p.X({}),this._change=new p.X(0),this.options=this._options.asObservable(),this._url_list=(0,M.aj)([this._org.active_building,this._change]).pipe((0,s.w)(([r])=>(0,m.O)({})),(0,Z.d)(1)),this.filtered_urls=(0,M.aj)([this._url_list,this._options]).pipe((0,P.U)(([r,i])=>r.filter(_=>!i.search||_.name.toLowerCase().includes(i.search.toLowerCase()))))}setFilters(e){this._options.next({...this._options.getValue(),...e})}setSearchString(e){this._options.next({...this._options.getValue(),search:e})}editURL(e){this._dialog.open(H,{data:e}).afterClosed().subscribe(()=>this._change.next(Date.now()))}removeURL(e){var a=this;return(0,d.Z)(function*(){const r=yield(0,m._5)({title:"Remove Short URL",content:`Are you sure you want to remove the Short URL "${e.name}"?`,icon:{content:"delete_forever"},confirm_text:"Remove"},a._dialog);if("done"!==r.reason)return r.close();r.loading("Removing Short URL..."),yield(0,m.fF)(e.id).toPromise().catch(i=>{throw(0,m.cB)(`Error removing Short URL: ${i.message}`),r.close(),i}),(0,m.t5)("Successfully removed Short URL."),r.close(),a._change.next(Date.now())})()}static#t=this.\u0275fac=function(a){return new(a||o)(t.LFG(A.w7),t.LFG(g.uw))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var z=n(33005),W=n(19842),L=n(10257),C=n(78128),B=n(27442),K=n(33884),V=n(81886),k=n(16318);function q(o,c){if(1&o&&(t.TgZ(0,"a",4),t._uU(1),t.qZA()),2&o){const e=c.data;t.Q6J("href",e,t.LSH),t.xp6(),t.Oqu(e)}}function tt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"a",16),t.ALo(3,"safe"),t._UZ(4,"img",17),t.qZA(),t.TgZ(5,"div",18),t._uU(6),t.qZA()(),t.TgZ(7,"button",19),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.print())}),t._uU(8," Print QR Code "),t.qZA()()}if(2&o){const e=t.oxw().row;t.xp6(2),t.Q6J("href",t.xi3(3,3,e.uri,"url"),t.LSH),t.xp6(2),t.Q6J("src",e.qr_code,t.LSH),t.xp6(2),t.hij(" ",e.name||e.id," ")}}function et(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",5)(1,"button",6),t.NdJ("click",function(){const i=t.CHM(e).row,_=t.oxw();return t.KtG(_.loadQrCode(i))}),t.TgZ(2,"app-icon"),t._uU(3,"qr_code"),t.qZA()(),t.YNc(4,tt,9,6,"ng-template",null,7,t.W1O),t.TgZ(6,"button",8)(7,"app-icon"),t._uU(8,"more_vert"),t.qZA()(),t.TgZ(9,"mat-menu",null,9)(11,"button",10),t.NdJ("click",function(){const i=t.CHM(e).row,_=t.oxw();return t.KtG(_.edit(i))}),t.TgZ(12,"div",11)(13,"app-icon"),t._uU(14,"edit"),t.qZA(),t.TgZ(15,"span"),t._uU(16,"Edit Short URL"),t.qZA()()(),t.TgZ(17,"button",10),t.NdJ("click",function(){const i=t.CHM(e).row,_=t.oxw();return t.KtG(_.remove(i))}),t.TgZ(18,"div",12)(19,"app-icon",13),t._uU(20,"delete"),t.qZA(),t.TgZ(21,"span"),t._uU(22,"Delete Short URL"),t.qZA()()()()()}if(2&o){const e=t.MAs(5),a=t.MAs(10);t.xp6(),t.Q6J("content",e),t.xp6(5),t.Q6J("matMenuTriggerFor",a)}}const ot=()=>["name","uri","user_name","description","actions"],nt=()=>["Name","URI","Creator","Description"," "],at=()=>["flex","14r","10r","10r","6.5r"],rt=(o,c)=>({uri:o,actions:c});let it=(()=>{class o{get kiosk_url(){const e=this._settings.get("app.kiosk_url_path")||"/map-kiosk";return`${window.location.origin}${e}`}loadQrCode(e){return(0,d.Z)(function*(){e.qr_code=yield(0,m.J5)(e.id)})()}constructor(e,a){this._manager=e,this._settings=a,this.features=this._manager.filtered_urls,this.edit=r=>this._manager.editURL(r),this.remove=r=>this._manager.removeURL(r)}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(N),t.Y36(m.gb))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["short-url-list"]],decls:6,vars:11,consts:[[1,"absolute","inset-0","overflow-auto","px-4"],["empty","No Points of Interest found.",1,"block","min-w-[32rem]","w-full","h-full",3,"dataSource","columns","display_column","column_size","template"],["url_template",""],["action_template",""],["link","",3,"href"],[1,"w-full","flex","justify-end","space-x-2"],["icon","","matRipple","","customTooltip","",3,"content","click"],["qr_menu",""],["btn","","icon","","matRipple","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"flex","items-center","space-x-2"],[1,"flex","items-center","space-x-2","text-red-500"],[1,"text-error"],[1,"bg-base-100","py-2","shadow","rounded"],["printable","",1,""],["target","_blank","ref","noopener noreferrer",1,"block","p-2","mx-4","my-2","rounded-lg","border","border-base-200","bg-base-100",3,"href"],[1,"w-48","mx-auto",3,"src"],[1,"w-[calc(100%-2rem)]","text-center","mt-2","font-mono","text-sm","bg-base-200","rounded","p-2","mx-4"],["btn","","matRipple","",1,"w-[calc(100%-2rem)]","mx-4","my-2",3,"click"]],template:function(a,r){if(1&a&&(t.TgZ(0,"div",0),t._UZ(1,"custom-table",1),t.qZA(),t.YNc(2,q,2,2,"ng-template",null,2,t.W1O)(4,et,23,2,"ng-template",null,3,t.W1O)),2&a){const i=t.MAs(3),_=t.MAs(5);t.xp6(),t.Q6J("dataSource",r.features)("columns",t.DdM(5,ot))("display_column",t.DdM(6,nt))("column_size",t.DdM(7,at))("template",t.WLB(8,rt,i,_))}},dependencies:[C.VK,C.OP,C.p6,L.wG,U.o,B.C,K.X,V.o,k.y]})}return o})();const st=["app-short-url-manager",""];let R=(()=>{class o{constructor(e){this._state=e,this.new=()=>this._state.editURL()}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(N))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["","app-short-url-manager",""]],attrs:st,decls:10,vars:0,consts:[[1,"flex","flex-1","h-px"],[1,"flex","flex-col","flex-1","w-1/2","h-full"],[1,"flex","items-center","justify-between","mb-2","px-4","py-8"],[1,"text-2xl","font-medium"],["btn","","matRipple","",3,"click"],[1,"block","w-full","relative","flex-1","h-1/2"]],template:function(a,r){1&a&&(t._UZ(0,"app-topbar"),t.TgZ(1,"div",0),t._UZ(2,"app-sidebar"),t.TgZ(3,"main",1)(4,"header",2)(5,"h2",3),t._uU(6,"Short URL Management"),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return r.new()}),t._uU(8,"Add Short URL"),t.qZA()(),t._UZ(9,"short-url-list",5),t.qZA()())},dependencies:[z.O,W.u,L.wG,it],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}sidebar[_ngcontent-%COMP%]{height:100%}main[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-width:50%;height:100%}\n\n/*# sourceMappingURL=url-manager.component.ts-angular-inline--190.css.map*/"]})}return o})();var lt=n(21757);const ct=[{path:"",component:R},{path:"new",component:R}];let mt=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[u.ez,l.u5,T.v,x.YR,v.PP,lt.Hi,S.Bz.forChild(ct)]})}return o})()},59524:(E,f,n)=>{n.d(f,{Y:()=>x,PP:()=>u.P,mO:()=>v.mO,VE:()=>p.VE,w0:()=>p.w0,sF:()=>A.sF});var u=n(43211),T=(n(86755),n(80882),n(67343));class x{constructor(s={}){this.type=s.type||s.location||"other",this.position=s.position||s.map_id||s.asset_id||{x:s.x/s.map_width||0,y:s.y/s.map_height||0},this.variance=s.variance||0,this.last_seen=s.last_seen||(0,T.Z)(new Date),this.level=s.level,this.building=s.building,this.at_location=!!s.at_location,this.coordinates_from=s.coordinates_from||"top-left"}}var v=n(223),A=(n(11451),n(38125)),p=n(48675)}}]);
//# sourceMappingURL=apps_concierge_src_app_url-management_url-manager_module_ts.js.map