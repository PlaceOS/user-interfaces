{"version":3,"file":"apps_concierge_src_app_signage_signage_module_ts.js","mappings":"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","names":["SignagePlaylist","constructor","_data","this","id","name","description","media","media_durations","SignageDisplay","orientation","playlists","SignageMedia","type","duration","url","i0","ctx_r0","resource","toString","ctx_r1","SignageMediaPreviewModalComponent","can_save","save","static","t","MAT_DIALOG_DATA","core","Xpm","selectors","decls","vars","consts","template","rf","ctx","SignageMediaPreviewModalComponent_img_8_Template","SignageMediaPreviewModalComponent_video_9_Template","SignageMediaPreviewModalComponent_footer_10_Template","item_r12","_r14","$implicit","ctx_r13","addMedia","_r16","ctx_r15","focusSearchInput","$event","ctx_r17","search","next","SignagePlaylistModalComponent_main_4_button_25_Template","form","media_list","_c1","_c2","_c3","_c4","_r4","_r6","_r9","getValue","_c5","new_media","_r19","ctx_r18","savePlaylist","row_r20","_r23","row","ctx_r22","setDuration","_r21","ctx_r3","value","row_r24","_r28","ctx_r27","changeOrder","ctx_r29","ctx_r30","previewMedia","ctx_r31","removeMedia","first_r25","last_r26","SignagePlaylistModalComponent","_state","_dialog","_dialog_ref","loading","playlist","BehaviorSubject","FormGroup","FormControl","Validators","required","combineLatest","valueChanges","pipe","startWith","getRawValue","map","find","_","all_media","filter","includes","toLowerCase","indexOf","setTimeout","search_input","nativeElement","focus","_this","_asyncToGenerator","markAllAsTouched","updateValueAndValidity","invalid","catch","notifyError","close","new_media_durations","patchValue","item","index","splice","direction","open","data","afterClosed","subscribe","URL","revokeObjectURL","i1","i2","viewQuery","SignagePlaylistModalComponent_button_3_Template","SignagePlaylistModalComponent_main_4_Template","SignagePlaylistModalComponent_footer_5_Template","SignagePlaylistModalComponent_ng_template_6_Template","SignagePlaylistModalComponent_ng_template_8_Template","SignagePlaylistModalComponent_ng_template_10_Template","_r8","addPlaylist","SignageDisplayModalComponent_main_4_button_37_Template","playlist_list","new_playlists","saveDisplay","_r24","ctx_r23","ctx_r25","ctx_r26","previewPlaylist","removePlaylist","first_r21","last_r22","data_r28","SignageDisplayModalComponent","display","reduce","a","b","tap","console","log","all_playlist","SignageDisplayModalComponent_button_3_Template","SignageDisplayModalComponent_main_4_Template","SignageDisplayModalComponent_footer_5_Template","SignageDisplayModalComponent_ng_template_6_Template","SignageDisplayModalComponent_ng_template_8_Template","SignageDisplayModalComponent_ng_template_10_Template","SignageStateService","_org","_loading","_change","_active_upload","asObservable","active_building","switchMap","bld","showMetadata","catchError","of","details","Array","shareReplay","displays","zones","queryZones","parent_id","tags","limit","editPlaylist","Date","now","remove","building","take","toPromise","idx","findIndex","randomString","push","updateMetadata","notifySuccess","_this2","editDisplay","_this3","display_list","removeDisplay","_this4","previewFileMedia","createObjectURL","file","_this5","_uploadFile","is_landscape","Promise","resolve","reader","FileReader","onload","video","document","createElement","addEventListener","videoWidth","videoHeight","src","result","img","Image","width","height","readAsDataURL","reject","fileReader","e","blob","blobUtil","target","upload","uploadFiles","file_name","upload_details","randomInt","progress","size","created_at","status","takeWhile","state","access_url","readAsArrayBuffer","Yz7","factory","ɵfac","providedIn","newItem","active_link","singular","link_r5","ctx_r8","SignageComponent","AsyncHandler","replace","_router","super","links","ngOnInit","subscription","events","event","NavigationEnd","features","attrs","_c0","SignageComponent_button_7_Template","SignageComponent_For_10_Template","_r2","SignageTopbarComponent","_route","levels","active_levels","initialised","first","queryParamMap","params","has","get","split","length","level","levelWithID","buildings","zone","lvl","i3","row_r8","row_r9","_r11","ctx_r10","editItem","ctx_r12","deleteItem","SignagePlaylistsComponent","i","acc","m","SignagePlaylistsComponent_ng_template_1_Template","SignagePlaylistsComponent_ng_template_3_Template","SignagePlaylistsComponent_ng_template_5_Template","SignagePlaylistsComponent_mat_progress_bar_7_Template","_r1","_r3","_r5","SignageDisplaysComponent","SignageDisplaysComponent_ng_template_1_Template","SignageDisplaysComponent_ng_template_3_Template","SignageDisplaysComponent_ng_template_5_Template","SignageDisplaysComponent_mat_progress_bar_7_Template","SignageZonesComponent","SignageTriggersComponent","item_r8","_r12","ctx_r11","SignageMediaComponent_ng_container_1_ng_container_1_div_2_div_11_Template","ctx_r7","count","SignageMediaComponent_ng_container_1_ng_container_1_div_2_Template","ctx_r6","SignageMediaComponent_ng_container_1_ng_container_1_Template","tmp_0_0","previewFile","SignageMediaComponent","onEnter","show_dropzone","dataTransfer","types","hideOverlay","HTMLInputElement","preventDefault","timeout","element","files","SignageMediaComponent_ng_container_1_Template","SignageMediaComponent_div_3_Template","SignageMediaComponent_ng_template_4_Template","SignageMediaComponent_ng_template_6_Template","ROUTES","path","component","children","redirectTo","pathMatch","COMPONENTS","SignageModule","oAB","cJS","CommonModule","FormsModule","UIModule","ComponentsModule","RouterModule","forChild","MatTabsModule"],"sourceRoot":"webpack:///","sources":["./apps/concierge/src/app/signage/signage.classes.ts","./apps/concierge/src/app/signage/signage-media-preview-modal.component.ts","./apps/concierge/src/app/signage/signage-playlist-modal.component.ts","./apps/concierge/src/app/signage/signage-display-modal.component.ts","./apps/concierge/src/app/signage/signage-state.service.ts","./apps/concierge/src/app/signage/signage.component.ts","./apps/concierge/src/app/signage/signage-topbar.component.ts","./apps/concierge/src/app/signage/signage-playlists.component.ts","./apps/concierge/src/app/signage/signage-displays.component.ts","./apps/concierge/src/app/signage/signage-zones.component.ts","./apps/concierge/src/app/signage/signage-triggers.component.ts","./apps/concierge/src/app/signage/signage-media.component.ts","./apps/concierge/src/app/signage/signage.module.ts"],"sourcesContent":["export class SignagePlaylist {\n    public readonly id: string;\n    public readonly name: string;\n    public readonly description: string;\n    public readonly media: string[];\n    public readonly media_durations: Record<string, number>;\n\n    constructor(_data: Partial<SignagePlaylist> = {}) {\n        this.id = _data.id || '';\n        this.name = _data.name || '';\n        this.description = _data.description || '';\n        this.media = _data.media || [];\n        this.media_durations = _data.media_durations || {};\n    }\n}\n\nexport class SignageDisplay {\n    public readonly id: string;\n    public readonly name: string;\n    public readonly description: string;\n    public readonly orientation: 'landscape' | 'portrait';\n    public readonly playlists: string[];\n\n    constructor(_data: Partial<SignageDisplay> = {}) {\n        this.id = _data.id || '';\n        this.name = _data.name || '';\n        this.description = _data.description || '';\n        this.orientation = _data.orientation || 'landscape';\n        this.playlists = _data.playlists || [];\n    }\n}\n\nexport class SignageZone {\n    public readonly id: string;\n    public readonly zone_id: string;\n    public readonly name: string;\n    public readonly description: string;\n    public readonly playlists: string[];\n\n    constructor(_data: Partial<SignageZone> = {}) {\n        this.id = _data.id || '';\n        this.zone_id = _data.zone_id || '';\n        this.name = _data.name || '';\n        this.description = _data.description || '';\n        this.playlists = _data.playlists || [];\n    }\n}\n\nexport class SignageTrigger {\n    public readonly id: string;\n    public readonly zone_id: string;\n    public readonly name: string;\n    public readonly description: string;\n    public readonly playlists: string[];\n\n    constructor(_data: Partial<SignageTrigger> = {}) {\n        this.id = _data.id || '';\n        this.zone_id = _data.zone_id || '';\n        this.name = _data.name || '';\n        this.description = _data.description || '';\n        this.playlists = _data.playlists || [];\n    }\n}\n\nexport class SignageMedia {\n    public readonly id: string;\n    public readonly name: string;\n    public readonly description: string;\n    public readonly type: 'image' | 'video';\n    public readonly duration: number;\n    public readonly orientation: 'landscape' | 'portrait';\n    public readonly url: string;\n\n    constructor(_data: Partial<SignageMedia> = {}) {\n        this.id = _data.id || '';\n        this.name = _data.name || '';\n        this.description = _data.description || '';\n        this.type = _data.type || 'image';\n        this.duration = _data.duration || 15;\n        this.orientation = _data.orientation || 'landscape';\n        this.url = _data.url || '';\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\n@Component({\n    selector: 'signage-media-preview-modal',\n    template: `\n        <header\n            class=\"flex items-center justify-between p-2 border-b border-base-300\"\n        >\n            <h1 class=\"px-2\">Preview - {{ name }}</h1>\n            <button icon matRipple mat-dialog-close>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main class=\"bg-base-200\">\n            <div\n                class=\"max-w-[80vw] max-h-[65vh] w-[80vw] h-[65vh] flex items-center justify-center\"\n            >\n                <img\n                    *ngIf=\"type === 'image'\"\n                    class=\"max-w-full max-h-full\"\n                    [src]=\"resource.toString()\"\n                />\n                <video\n                    *ngIf=\"type === 'video'\"\n                    class=\"max-w-full max-h-full\"\n                    [src]=\"resource.toString()\"\n                    autoplay\n                    controls\n                ></video>\n            </div>\n        </main>\n        <footer\n            *ngIf=\"can_save\"\n            class=\"p-2 flex items-center justify-end space-x-2 border-t border-base-300\"\n        >\n            <button btn matRipple class=\"w-32\">Save Media</button>\n        </footer>\n    `,\n    styles: [``],\n})\nexport class SignageMediaPreviewModalComponent {\n    public readonly resource = this._data.url;\n    public readonly type = this._data.type;\n    public readonly name = this._data.name;\n    public readonly can_save = this._data.save !== false;\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA)\n        private _data: {\n            url: URL;\n            type: 'image' | 'video';\n            save: boolean;\n            name: string;\n        }\n    ) {}\n}\n","import {\n    MAT_DIALOG_DATA,\n    MatDialog,\n    MatDialogRef,\n} from '@angular/material/dialog';\nimport { SignageStateService } from './signage-state.service';\nimport { Component, ElementRef, Inject, ViewChild } from '@angular/core';\nimport { SignageMedia, SignagePlaylist } from './signage.classes';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { filter, map, startWith } from 'rxjs/operators';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { SignageMediaPreviewModalComponent } from './signage-media-preview-modal.component';\nimport { notifyError, notifySuccess } from '@placeos/common';\nimport { th } from 'date-fns/locale';\n\n@Component({\n    selector: 'signage-playlist-modal',\n    template: `\n        <header\n            class=\"flex items-center justify-between p-2 border-b border-base-300\"\n        >\n            <h1 class=\"px-2\">{{ playlist.id ? 'Edit' : 'New' }} Playlist</h1>\n            <button icon matRipple mat-dialog-close *ngIf=\"!loading\">\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            [formGroup]=\"form\"\n            class=\"p-2 flex flex-col\"\n            *ngIf=\"!loading; else load_state\"\n        >\n            <label for=\"name\">Name<span required>*</span></label>\n            <mat-form-field appearance=\"outline\" class=\"w-full\">\n                <input\n                    matInput\n                    name=\"name\"\n                    placeholder=\"Name\"\n                    formControlName=\"name\"\n                />\n                <mat-error>Name is required</mat-error>\n            </mat-form-field>\n            <label for=\"description\">Description</label>\n            <mat-form-field appearance=\"outline\" class=\"w-full\">\n                <textarea\n                    matInput\n                    name=\"description\"\n                    placeholder=\"Description\"\n                    formControlName=\"description\"\n                ></textarea>\n            </mat-form-field>\n            <label for=\"media\">Media</label>\n            <custom-table\n                class=\"block w-full mb-2\"\n                [dataSource]=\"media_list\"\n                [columns]=\"['_index', 'name', 'type', 'duration', 'actions']\"\n                [display_column]=\"[' ', 'Name', 'Type', 'Duration', ' ']\"\n                [column_size]=\"['3r', 'flex', '10r', '6r', '10r']\"\n                [template]=\"{\n                    duration: duration_template,\n                    actions: actions_template\n                }\"\n            >\n            </custom-table>\n            <button\n                btn\n                matRipple\n                class=\"w-full\"\n                [matMenuTriggerFor]=\"media_menu\"\n                (click)=\"focusSearchInput()\"\n            >\n                Add Media\n            </button>\n            <mat-menu #media_menu=\"matMenu\" class=\"w-[32rem] max-w-[80vw]\">\n                <mat-form-field\n                    appearance=\"outline\"\n                    class=\"w-[calc(100%-1rem)] mx-2 no-subscript\"\n                >\n                    <app-icon matPrefix class=\"text-2xl -left-1\">\n                        search\n                    </app-icon>\n                    <input\n                        #search_input\n                        matInput\n                        placeholder=\"Media Name\"\n                        [ngModel]=\"search.getValue()\"\n                        (ngModelChange)=\"search.next($event)\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                    />\n                </mat-form-field>\n                <button\n                    mat-menu-item\n                    *ngFor=\"let item of new_media | async | slice: 0:8\"\n                    (click)=\"addMedia(item)\"\n                >\n                    <div class=\"flex items-center w-full\">\n                        <div class=\"flex-1 truncate\">{{ item.name }}</div>\n                        <code class=\"capitalize\">{{ item.type }}</code>\n                        <code class=\"bg-base-300 text-base-content\">{{\n                            item.duration | mediaDuration\n                        }}</code>\n                    </div>\n                </button>\n            </mat-menu>\n        </main>\n        <footer\n            class=\"p-2 flex items-center justify-end space-x-2 border-t border-base-300\"\n            *ngIf=\"!loading\"\n        >\n            <button btn matRipple class=\"w-32\" (click)=\"savePlaylist()\">\n                Save Playlist\n            </button>\n        </footer>\n        <ng-template #duration_template let-row=\"row\">\n            <button\n                matTooltip=\"Set Custom Duration\"\n                [matMenuTriggerFor]=\"duration_menu\"\n                [class.pointer-events-none]=\"row.type !== 'image'\"\n            >\n                <code\n                    [class.bg-warning]=\"form.value.media_durations[row.id]\"\n                    [class.text-warning-content]=\"\n                        form.value.media_durations[row.id]\n                    \"\n                >\n                    {{\n                        form.value.media_durations[row.id] || row.duration\n                            | mediaDuration\n                    }}\n                </code>\n            </button>\n            <mat-menu #duration_menu=\"matMenu\" class=\"w-[20rem] max-w-[80vw]\">\n                <mat-form-field\n                    appearance=\"outline\"\n                    class=\"w-[calc(100%-1rem)] mx-2 no-subscript\"\n                >\n                    <mat-select\n                        [ngModel]=\"form.value.media_durations[row.id] || 0\"\n                        (ngModelChange)=\"setDuration(row.id, $event)\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                    >\n                        <mat-option [value]=\"0\">Use Media Default</mat-option>\n                        <mat-option [value]=\"5\">5 seconds</mat-option>\n                        <mat-option [value]=\"10\">10 seconds</mat-option>\n                        <mat-option [value]=\"15\">15 seconds</mat-option>\n                        <mat-option [value]=\"30\">30 seconds</mat-option>\n                        <mat-option [value]=\"45\">45 seconds</mat-option>\n                        <mat-option [value]=\"60\">1 minute</mat-option>\n                        <mat-option [value]=\"75\"\n                            >1 minute 15 seconds</mat-option\n                        >\n                        <mat-option [value]=\"90\"\n                            >1 minute 30 seconds</mat-option\n                        >\n                        <mat-option [value]=\"105\"\n                            >1 minute 45 seconds</mat-option\n                        >\n                        <mat-option [value]=\"120\">2 minute</mat-option>\n                        <mat-option [value]=\"135\"\n                            >2 minute 15 seconds</mat-option\n                        >\n                        <mat-option [value]=\"150\"\n                            >2 minute 30 seconds</mat-option\n                        >\n                        <mat-option [value]=\"165\"\n                            >2 minute 45 seconds</mat-option\n                        >\n                        <mat-option [value]=\"180\">3 minute</mat-option>\n                        <mat-option [value]=\"195\"\n                            >3 minute 15 seconds</mat-option\n                        >\n                        <mat-option [value]=\"210\"\n                            >3 minute 30 seconds</mat-option\n                        >\n                        <mat-option [value]=\"225\"\n                            >3 minute 45 seconds</mat-option\n                        >\n                        <mat-option [value]=\"240\">4 minute</mat-option>\n                        <mat-option [value]=\"255\"\n                            >4 minute 15 seconds</mat-option\n                        >\n                        <mat-option [value]=\"270\"\n                            >4 minute 30 seconds</mat-option\n                        >\n                        <mat-option [value]=\"285\"\n                            >4 minute 45 seconds</mat-option\n                        >\n                        <mat-option [value]=\"300\">5 minute</mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </mat-menu>\n        </ng-template>\n        <ng-template\n            #actions_template\n            let-row=\"row\"\n            let-first=\"first\"\n            let-last=\"last\"\n        >\n            <div class=\"w-full flex items-center justify-end\">\n                <button\n                    icon\n                    matRipple\n                    matTooltip=\"Move Media to previous item\"\n                    [disabled]=\"first\"\n                    (click)=\"changeOrder(row, -1)\"\n                >\n                    <app-icon>arrow_upward</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    matTooltip=\"Move Media to next item\"\n                    [disabled]=\"last\"\n                    (click)=\"changeOrder(row, 1)\"\n                >\n                    <app-icon>arrow_downward</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    matTooltip=\"Preview Media\"\n                    (click)=\"previewMedia(row)\"\n                >\n                    <app-icon>visibility</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    matTooltip=\"Remove Media from Playlist\"\n                    class=\"text-error\"\n                    (click)=\"removeMedia(row)\"\n                >\n                    <app-icon>delete</app-icon>\n                </button>\n            </div>\n        </ng-template>\n        <ng-template #load_state>\n            <main class=\"flex flex-col items-center justify-center p-8\">\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p class=\"mt-4\">Saving Playlist...</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class SignagePlaylistModalComponent {\n    public loading = false;\n    public readonly playlist = this._data;\n    public readonly media = this._state.media;\n\n    public readonly search = new BehaviorSubject('');\n\n    public readonly form = new FormGroup({\n        id: new FormControl(this.playlist.id || ''),\n        name: new FormControl(this.playlist.name || '', [Validators.required]),\n        description: new FormControl(this.playlist.description || ''),\n        media: new FormControl(this.playlist.media || []),\n        media_durations: new FormControl(this.playlist.media_durations || {}),\n    });\n\n    public readonly media_list = combineLatest([\n        this.media,\n        this.form.valueChanges.pipe(startWith(this.form.getRawValue())),\n    ]).pipe(\n        map(([media_list, { media }]) =>\n            (this.form.getRawValue().media || []).map(\n                (id) =>\n                    media_list.find((_) => _.id === id) ||\n                    new SignageMedia({ id })\n            )\n        )\n    );\n\n    public readonly new_media = combineLatest([\n        this.media,\n        this.search,\n        this.form.valueChanges.pipe(startWith(this.form.getRawValue())),\n    ]).pipe(\n        map(([all_media, search, _]) =>\n            all_media\n                .filter((_) => !this.form.getRawValue().media.includes(_.id))\n                .filter((_) =>\n                    _.name.toLowerCase().includes(search.toLowerCase())\n                )\n        )\n    );\n\n    @ViewChild('search_input')\n    public search_input: ElementRef<HTMLInputElement>;\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: SignagePlaylist = {} as any,\n        private _state: SignageStateService,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<SignagePlaylistModalComponent>\n    ) {}\n\n    public indexOf(id: string) {\n        return this.form.getRawValue().media.indexOf(id);\n    }\n\n    public focusSearchInput() {\n        setTimeout(() => this.search_input.nativeElement?.focus(), 100);\n    }\n\n    public async savePlaylist() {\n        this.form.markAllAsTouched();\n        this.form.updateValueAndValidity();\n        if (this.form.invalid) return;\n        this.loading = true;\n        await this._state.savePlaylist(this.form.getRawValue()).catch((_) => {\n            notifyError('Error saving playlist');\n            this.loading = false;\n            throw _;\n        });\n        this._dialog_ref.close();\n    }\n\n    public setDuration(id: string, duration: number) {\n        const { media_durations } = this.form.getRawValue();\n        const new_media_durations = { ...media_durations };\n        new_media_durations[id] = duration;\n        this.form.patchValue({ media_durations: new_media_durations });\n    }\n\n    public addMedia(item: SignageMedia) {\n        const { id } = item;\n        const { media } = this.form.getRawValue();\n        this.form.patchValue({\n            media: [...media, id],\n        });\n    }\n\n    public removeMedia(item: SignageMedia) {\n        const { media, media_durations } = this.form.getRawValue();\n        const index = media.indexOf(item.id);\n        const new_media = [...media];\n        delete media_durations[item.id];\n        new_media.splice(index, 1);\n        this.form.patchValue({\n            media: new_media,\n            media_durations: { ...media_durations },\n        });\n    }\n\n    public changeOrder(item: SignageMedia, direction: number) {\n        const { media } = this.form.getRawValue();\n        const index = media.indexOf(item.id);\n        const new_media = [...media];\n        new_media.splice(index, 1);\n        new_media.splice(index + direction, 0, item.id);\n        this.form.patchValue({\n            media: new_media,\n        });\n    }\n\n    public previewMedia(item: SignageMedia) {\n        const { url, type, name } = item;\n        const ref = this._dialog.open(SignageMediaPreviewModalComponent, {\n            data: { url, type, name, save: false },\n        });\n        ref.afterClosed().subscribe(() => URL.revokeObjectURL(url));\n    }\n}\n","import { Component, ElementRef, Inject, ViewChild } from '@angular/core';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map, startWith, tap } from 'rxjs/operators';\nimport { SignageDisplay, SignagePlaylist } from './signage.classes';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialog,\n    MatDialogRef,\n} from '@angular/material/dialog';\nimport { SignageStateService } from './signage-state.service';\nimport { ta } from 'date-fns/locale';\nimport { notifyError } from '@placeos/common';\n\n@Component({\n    selector: 'signage-display-modal',\n    template: `\n        <header\n            class=\"flex items-center justify-between p-2 border-b border-base-300\"\n        >\n            <h1 class=\"px-2\">{{ display.id ? 'Edit' : 'New' }} Display</h1>\n            <button icon matRipple mat-dialog-close *ngIf=\"!loading\">\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            [formGroup]=\"form\"\n            class=\"p-2 flex flex-col\"\n            *ngIf=\"!loading; else load_state\"\n        >\n            <label for=\"name\">Name<span required>*</span></label>\n            <mat-form-field appearance=\"outline\" class=\"w-full\">\n                <input\n                    matInput\n                    name=\"name\"\n                    placeholder=\"Name\"\n                    formControlName=\"name\"\n                />\n                <mat-error>Name is required</mat-error>\n            </mat-form-field>\n            <label for=\"description\">Description</label>\n            <mat-form-field appearance=\"outline\" class=\"w-full\">\n                <textarea\n                    matInput\n                    name=\"description\"\n                    placeholder=\"Description\"\n                    formControlName=\"description\"\n                ></textarea>\n            </mat-form-field>\n            <label for=\"description\">Orientation<span required>*</span></label>\n            <mat-form-field appearance=\"outline\" class=\"w-full\">\n                <mat-select formControlName=\"orientation\">\n                    <mat-option value=\"landscape\">Landscape</mat-option>\n                    <mat-option value=\"portrait\">Portrait</mat-option>\n                </mat-select>\n                <mat-error>Orientation is required</mat-error>\n            </mat-form-field>\n            <label for=\"media\">Playlists</label>\n            <custom-table\n                class=\"block w-full mb-2\"\n                [dataSource]=\"playlist_list\"\n                [columns]=\"['_index', 'name', 'type', 'duration', 'actions']\"\n                [display_column]=\"[' ', 'Name', 'Type', 'Duration', ' ']\"\n                [column_size]=\"['3r', 'flex', '10r', '6r', '10r']\"\n                [template]=\"{\n                    duration: duration_template,\n                    actions: actions_template\n                }\"\n            >\n            </custom-table>\n            <button\n                btn\n                matRipple\n                class=\"w-full\"\n                [matMenuTriggerFor]=\"media_menu\"\n                (click)=\"focusSearchInput()\"\n            >\n                Add Playlist\n            </button>\n            <mat-menu #media_menu=\"matMenu\" class=\"w-[32rem] max-w-[80vw]\">\n                <mat-form-field\n                    appearance=\"outline\"\n                    class=\"w-[calc(100%-1rem)] mx-2 no-subscript\"\n                >\n                    <app-icon matPrefix class=\"text-2xl -left-1\">\n                        search\n                    </app-icon>\n                    <input\n                        #search_input\n                        matInput\n                        placeholder=\"Media Name\"\n                        [ngModel]=\"search.getValue()\"\n                        (ngModelChange)=\"search.next($event)\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                    />\n                </mat-form-field>\n                <button\n                    mat-menu-item\n                    *ngFor=\"let item of new_playlists | async | slice: 0:8\"\n                    (click)=\"addPlaylist(item)\"\n                >\n                    <div class=\"flex items-center w-full\">\n                        <div class=\"flex-1 truncate\">{{ item.name }}</div>\n                        <code class=\"bg-base-300 text-base-content\">{{\n                            item.duration | mediaDuration\n                        }}</code>\n                    </div>\n                </button>\n            </mat-menu>\n        </main>\n        <footer\n            class=\"p-2 flex items-center justify-end space-x-2 border-t border-base-300\"\n            *ngIf=\"!loading\"\n        >\n            <button btn matRipple class=\"w-32\" (click)=\"saveDisplay()\">\n                Save Display\n            </button>\n        </footer>\n        <ng-template\n            #actions_template\n            let-row=\"row\"\n            let-first=\"first\"\n            let-last=\"last\"\n        >\n            <div class=\"w-full flex items-center justify-end\">\n                <button\n                    icon\n                    matRipple\n                    matTooltip=\"Move Playlist to previous item\"\n                    [disabled]=\"first\"\n                    (click)=\"changeOrder(row, -1)\"\n                >\n                    <app-icon>arrow_upward</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    matTooltip=\"Move Playlist to next item\"\n                    [disabled]=\"last\"\n                    (click)=\"changeOrder(row, 1)\"\n                >\n                    <app-icon>arrow_downward</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    matTooltip=\"Preview Playlist\"\n                    (click)=\"previewPlaylist(row)\"\n                >\n                    <app-icon>visibility</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    matTooltip=\"Remove Playlist from Display\"\n                    class=\"text-error\"\n                    (click)=\"removePlaylist(row)\"\n                >\n                    <app-icon>delete</app-icon>\n                </button>\n            </div>\n        </ng-template>\n\n        <ng-template #duration_template let-data=\"data\">\n            <code class=\"bg-base-300 text-base-content\">\n                {{ data | mediaDuration }}\n            </code>\n        </ng-template>\n        <ng-template #load_state>\n            <main class=\"flex flex-col items-center justify-center p-8\">\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p class=\"mt-4\">Saving Display...</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class SignageDisplayModalComponent {\n    public loading = false;\n    public readonly display = this._data;\n    public readonly playlists = combineLatest([\n        this._state.playlists,\n        this._state.media,\n    ]).pipe(\n        map(([playlists, media]) =>\n            playlists.map((_) => ({\n                ..._,\n                duration: _.media.reduce(\n                    (a, b) =>\n                        a +\n                        (_.media_durations[b] ||\n                            media.find(({ id }) => id === b)?.duration ||\n                            0),\n                    0\n                ),\n            }))\n        ),\n        tap(console.log)\n    );\n\n    public readonly search = new BehaviorSubject('');\n\n    public readonly form = new FormGroup({\n        id: new FormControl(this.display.id || ''),\n        name: new FormControl(this.display.name || '', [Validators.required]),\n        description: new FormControl(this.display.description || ''),\n        orientation: new FormControl(this.display.orientation || 'landscape', [\n            Validators.required,\n        ]),\n        playlists: new FormControl(this.display.playlists || []),\n    });\n\n    public readonly playlist_list = combineLatest([\n        this.playlists,\n        this.form.valueChanges.pipe(startWith(this.form.getRawValue())),\n    ]).pipe(\n        map(([playlist_list, _]) =>\n            (this.form.getRawValue().playlists || []).map(\n                (id) =>\n                    playlist_list.find((_) => _.id === id) ||\n                    new SignagePlaylist({ id })\n            )\n        )\n    );\n\n    public readonly new_playlists = combineLatest([\n        this.playlists,\n        this.search,\n        this.form.valueChanges.pipe(startWith(this.form.getRawValue())),\n    ]).pipe(\n        map(([all_playlist, search, _]) =>\n            all_playlist\n                .filter(\n                    (_) => !this.form.getRawValue().playlists.includes(_.id)\n                )\n                .filter((_) =>\n                    _.name.toLowerCase().includes(search.toLowerCase())\n                )\n        )\n    );\n\n    @ViewChild('search_input')\n    public search_input: ElementRef<HTMLInputElement>;\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: SignageDisplay = {} as any,\n        private _state: SignageStateService,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<SignageDisplayModalComponent>\n    ) {}\n\n    public focusSearchInput() {\n        setTimeout(() => this.search_input.nativeElement?.focus(), 100);\n    }\n\n    public async saveDisplay() {\n        this.form.markAllAsTouched();\n        this.form.updateValueAndValidity();\n        if (this.form.invalid) return;\n        this.loading = true;\n        await this._state.saveDisplay(this.form.getRawValue()).catch((_) => {\n            notifyError('Error saving display.');\n            this.loading = false;\n            throw _;\n        });\n        this._dialog_ref.close();\n    }\n\n    public addPlaylist(item: SignagePlaylist) {\n        const { id } = item;\n        const { playlists } = this.form.getRawValue();\n        this.form.patchValue({\n            playlists: [...playlists, id],\n        });\n    }\n\n    public removePlaylist(item: SignagePlaylist) {\n        const { playlists } = this.form.getRawValue();\n        const index = playlists.indexOf(item.id);\n        const new_playlists = [...playlists];\n        new_playlists.splice(index, 1);\n        this.form.patchValue({\n            playlists: new_playlists,\n        });\n    }\n\n    public changeOrder(item: SignagePlaylist, direction: number) {\n        const { playlists } = this.form.getRawValue();\n        const index = playlists.indexOf(item.id);\n        const new_playlists = [...playlists];\n        new_playlists.splice(index, 1);\n        new_playlists.splice(index + direction, 0, item.id);\n        this.form.patchValue({\n            playlists: new_playlists,\n        });\n    }\n\n    public previewPlaylist(item: SignagePlaylist) {}\n}\n","import { Injectable } from '@angular/core';\nimport { uploadFiles } from '@placeos/cloud-uploads';\nimport {\n    notifySuccess,\n    predictableRandomInt,\n    randomInt,\n    randomString,\n} from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport {\n    PlaceMetadata,\n    queryZones,\n    showMetadata,\n    updateMetadata,\n} from '@placeos/ts-client';\nimport { Attachment } from '@placeos/users';\nimport { BehaviorSubject, Observable, combineLatest, of } from 'rxjs';\nimport {\n    catchError,\n    filter,\n    map,\n    shareReplay,\n    switchMap,\n    take,\n    takeWhile,\n} from 'rxjs/operators';\n\nimport * as blobUtil from 'blob-util';\nimport {\n    SignageDisplay,\n    SignageMedia,\n    SignagePlaylist,\n} from './signage.classes';\nimport { MatDialog } from '@angular/material/dialog';\nimport { SignageMediaPreviewModalComponent } from './signage-media-preview-modal.component';\nimport { SignagePlaylistModalComponent } from './signage-playlist-modal.component';\nimport { SignageDisplayModalComponent } from './signage-display-modal.component';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class SignageStateService {\n    private _loading = new BehaviorSubject(false);\n    private _change = new BehaviorSubject(0);\n    private _active_upload = new BehaviorSubject<Attachment>(null);\n\n    public readonly loading = this._loading.asObservable();\n\n    public readonly media: Observable<SignageMedia[]> = combineLatest([\n        this._org.active_building,\n        this._change,\n    ]).pipe(\n        filter(([_]) => !!_?.id),\n        switchMap(([bld]) =>\n            showMetadata(bld.id, 'signage-media').pipe(\n                catchError(() => of({} as PlaceMetadata))\n            )\n        ),\n        map(\n            (_) =>\n                (_.details instanceof Array ? _.details : null) || [\n                    {\n                        id: `media-0001`,\n                        name: 'Welcome to PlaceOS',\n                        description: 'This is a sample media file',\n                        url: 'https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png',\n                        type: 'image',\n                        duration: 15,\n                    },\n                    {\n                        id: `media-0002`,\n                        name: 'Welcome to PlaceOS',\n                        description: 'This is a sample media file',\n                        url: 'https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png',\n                        type: 'image',\n                        duration: 30,\n                    },\n                    {\n                        id: `media-0003`,\n                        name: 'Welcome to PlaceOS',\n                        description: 'This is a sample media file',\n                        url: 'https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png',\n                        type: 'image',\n                        duration: 60,\n                    },\n                    {\n                        id: `media-0004`,\n                        name: 'Welcome to PlaceOS',\n                        description: 'This is a sample media file',\n                        url: 'https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png',\n                        type: 'image',\n                        duration: 15,\n                    },\n                    {\n                        id: `media-0005`,\n                        name: 'Welcome to PlaceOS',\n                        description: 'This is a sample media file',\n                        url: 'https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png',\n                        type: 'image',\n                        duration: 30,\n                    },\n                    {\n                        id: `media-0006`,\n                        name: 'Welcome to PlaceOS',\n                        description: 'This is a sample media file',\n                        url: 'https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png',\n                        type: 'image',\n                        duration: 60,\n                    },\n                ]\n        ),\n        shareReplay(1)\n    );\n\n    public readonly playlists: Observable<SignagePlaylist[]> = combineLatest([\n        this._org.active_building,\n        this._change,\n    ]).pipe(\n        filter(([_]) => !!_?.id),\n        switchMap(([bld]) =>\n            showMetadata(bld.id, 'signage-playlists').pipe(\n                catchError(() => of({} as PlaceMetadata))\n            )\n        ),\n        map((_) => (_.details instanceof Array ? _.details : []))\n    );\n\n    public readonly displays: Observable<SignageDisplay[]> = combineLatest([\n        this._org.active_building,\n        this._change,\n    ]).pipe(\n        filter(([_]) => !!_?.id),\n        switchMap(([bld]) =>\n            showMetadata(bld.id, 'signage-displays').pipe(\n                catchError(() => of({} as PlaceMetadata))\n            )\n        ),\n        map((_) => (_.details instanceof Array ? _.details : []))\n    );\n\n    public readonly zones = combineLatest([\n        this._org.active_building,\n        this._change,\n    ]).pipe(\n        filter(([_]) => !!_?.id),\n        switchMap(([bld]) =>\n            queryZones({ parent_id: bld.id, tags: 'signage', limit: 100 }).pipe(\n                catchError(() => of({ data: [] }))\n            )\n        ),\n        map((_) => _.data || [])\n    );\n\n    constructor(\n        private _org: OrganisationService,\n        private _dialog: MatDialog\n    ) {}\n\n    public editPlaylist(playlist: SignagePlaylist = new SignagePlaylist()) {\n        const ref = this._dialog.open(SignagePlaylistModalComponent, {\n            data: playlist,\n        });\n        ref.afterClosed().subscribe(() => this._change.next(Date.now()));\n    }\n\n    public async savePlaylist(playlist: SignagePlaylist, remove = false) {\n        const bld = this._org.building.id;\n        const playlist_list =\n            (await this.playlists.pipe(take(1)).toPromise()) || [];\n        const idx = playlist_list.findIndex((_) => _.id === playlist.id);\n        if (idx >= 0) playlist_list.splice(idx, 1);\n        if (!playlist.id) (playlist as any).id = `playlist-${randomString(8)}`;\n        if (!remove) playlist_list.push(playlist);\n        await updateMetadata(bld, {\n            name: 'signage-playlists',\n            details: playlist_list,\n            description: 'Playlists for signage displays',\n        }).toPromise();\n        notifySuccess(`Successfully ${remove ? 'removed' : 'saved'} playlist.`);\n        this._change.next(Date.now());\n    }\n\n    public async removePlaylist(playlist: SignagePlaylist) {\n        await this.savePlaylist(playlist, true);\n    }\n\n    public editDisplay(display: SignageDisplay = new SignageDisplay()) {\n        const ref = this._dialog.open(SignageDisplayModalComponent, {\n            data: display,\n        });\n        ref.afterClosed().subscribe(() => this._change.next(Date.now()));\n    }\n\n    public async saveDisplay(display: SignageDisplay, remove = false) {\n        const bld = this._org.building.id;\n        const display_list = await this.displays.pipe(take(1)).toPromise();\n        const idx = display_list.findIndex((_) => _.id === display.id);\n        if (idx >= 0) display_list.splice(idx, 1);\n        if (!display.id) (display as any).id = `display-${randomString(8)}`;\n        if (!remove) display_list.push(display);\n        await updateMetadata(bld, {\n            name: 'signage-displays',\n            details: display_list,\n            description: 'Displays for signage displays',\n        }).toPromise();\n        notifySuccess(`Successfully ${remove ? 'removed' : 'saved'} display.`);\n        this._change.next(Date.now());\n    }\n\n    public async removeDisplay(display: SignageDisplay) {\n        await this.saveDisplay(display, true);\n    }\n\n    public previewMedia(item: SignageMedia) {\n        const { url, type, name } = item;\n        const ref = this._dialog.open(SignageMediaPreviewModalComponent, {\n            data: { url, type, name, save: false },\n        });\n        ref.afterClosed().subscribe(() => URL.revokeObjectURL(url));\n    }\n\n    public previewFileMedia(media: File) {\n        const url = URL.createObjectURL(media);\n        const type = media.type.includes('image') ? 'image' : 'video';\n        const ref = this._dialog.open(SignageMediaPreviewModalComponent, {\n            data: { url, type, name: media.name, save: true },\n        });\n        ref.afterClosed().subscribe(() => URL.revokeObjectURL(url));\n    }\n\n    public async addMedia(file: File) {\n        const media = await this._uploadFile(file);\n        const media_list = await this.media.pipe(take(1)).toPromise();\n        const check_landscape = new Promise((resolve) => {\n            var reader = new FileReader();\n            reader.onload = () => {\n                // file is loaded\n                if (file.type.includes('video')) {\n                    let video = document.createElement('video');\n                    video.addEventListener(\n                        'loadedmetadata',\n                        () => resolve(video.videoWidth > video.videoHeight),\n                        false\n                    );\n                    video.src = reader.result as string;\n                    return;\n                }\n                let img = new Image();\n                img.onload = () => resolve(img.width > img.height);\n                img.src = reader.result as string; // is the data URL because called with readAsDataURL\n            };\n            reader.readAsDataURL(file);\n        });\n        const is_landscape = await check_landscape;\n        media_list.push({\n            id: `media-${randomString(8)}`,\n            name: media.name,\n            description: '',\n            url: media.url,\n            type: file.type.includes('image') ? 'image' : 'video',\n            orientation: is_landscape ? 'landscape' : 'portrait',\n            duration: 15,\n        });\n        const bld = this._org.building.id;\n        await updateMetadata(bld, {\n            name: 'signage-media',\n            details: media_list,\n            description: 'Media for signage displays',\n        }).toPromise();\n        notifySuccess('Successfully added media.');\n        this._active_upload.next(null);\n        this._change.next(Date.now());\n    }\n\n    private _uploadFile(file: File): Promise<Attachment> {\n        return new Promise((resolve, reject) => {\n            const fileReader = new FileReader();\n            fileReader.addEventListener('loadend', (e: any) => {\n                const arrayBuffer = e.target.result;\n                const blob = blobUtil.arrayBufferToBlob(arrayBuffer, file.type);\n                const upload_list = uploadFiles([blob], {\n                    file_name: file.name,\n                });\n                const upload = upload_list[0];\n                const upload_details: Attachment = {\n                    id: `${randomInt(9999_9999_9999)}`,\n                    name: file.name,\n                    progress: 0,\n                    size: file.size,\n                    created_at: Date.now(),\n                    url: '',\n                };\n                upload.status\n                    .pipe(takeWhile((_) => _.status !== 'complete', true))\n                    .subscribe(\n                        (state) => {\n                            if (upload.access_url)\n                                upload_details.url = upload.access_url;\n                            upload_details.progress = state.progress;\n                            if (state.status === 'error') {\n                                upload_details.progress = -1;\n                                reject();\n                            }\n                        },\n                        reject,\n                        () => resolve(upload_details)\n                    );\n                this._active_upload.next(upload_details);\n            });\n            fileReader.readAsArrayBuffer(file);\n        });\n    }\n}\n","import { Component, OnInit } from '@angular/core';\n\nimport { SignageStateService } from './signage-state.service';\nimport { NavigationEnd, Router } from '@angular/router';\nimport { AsyncHandler } from '@placeos/common';\n\n@Component({\n    selector: '[app-new-staff]',\n    template: `\n        <app-topbar></app-topbar>\n        <div class=\"flex flex-1 h-px\">\n            <app-sidebar></app-sidebar>\n            <main class=\"flex flex-col flex-1 w-1/2 h-full\">\n                <div class=\"p-8 h-28 flex items-center justify-between\">\n                    <h2 class=\"text-2xl font-medium\">\n                        Signage - {{ active_link }}\n                    </h2>\n                    <button\n                        btn\n                        matRipple\n                        class=\"w-32\"\n                        (click)=\"newItem(active_link)\"\n                        *ngIf=\"active_link !== 'Media'\"\n                    >\n                        Add {{ singular(active_link) }}\n                    </button>\n                </div>\n                <nav mat-tab-nav-bar [tabPanel]=\"tabPanel\">\n                    @for (link of links; track link) {\n                    <a\n                        mat-tab-link\n                        [routerLink]=\"'/signage/' + (link | lowercase)\"\n                        (click)=\"active_link = link\"\n                        [active]=\"active_link == link\"\n                    >\n                        {{ link }}\n                    </a>\n                    }\n                </nav>\n                <mat-tab-nav-panel class=\"flex-1 h-1/2 overflow-auto\" #tabPanel>\n                    <router-outlet></router-outlet>\n                </mat-tab-nav-panel>\n            </main>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n                background-color: var(--b1);\n            }\n        `,\n    ],\n})\nexport class SignageComponent extends AsyncHandler implements OnInit {\n    public readonly loading = this._state.loading;\n    public links = ['Playlists', 'Media', 'Displays', 'Zones', 'Triggers'];\n    public active_link = this.links[0];\n\n    public singular(name: string) {\n        return name.replace(/s$/, '');\n    }\n\n    public newItem(name: string) {\n        switch (name) {\n            case 'Playlists':\n                this._state.editPlaylist();\n                break;\n            case 'Displays':\n                this._state.editDisplay();\n                break;\n            case 'Zones':\n                // this._state.editZone();\n                break;\n            case 'Triggers':\n                // this._state.editTrigger();\n                break;\n        }\n    }\n\n    constructor(private _state: SignageStateService, private _router: Router) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'route.query',\n            this._router.events.subscribe((event) => {\n                if (event instanceof NavigationEnd) {\n                    this.active_link = this.links.find((_) =>\n                        this._router.url.includes(_.toLowerCase())\n                    );\n                }\n            })\n        );\n        this.active_link = this.links.find((_) =>\n            this._router.url.includes(_.toLowerCase())\n        );\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { first } from 'rxjs/operators';\n\nimport { AsyncHandler } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { SignageStateService } from './signage-state.service';\n\n@Component({\n    selector: 'signage-topbar',\n    template: `\n        <div\n            class=\"flex items-center bg-base-100 h-20 px-4 border-b border-base-200 space-x-2\"\n        >\n            <!-- <mat-form-field appearance=\"outline\">\n                <mat-select\n                    multiple\n                    [(ngModel)]=\"zones\"\n                    (ngModelChange)=\"updateZones($event)\"\n                    placeholder=\"All Levels\"\n                >\n                    <mat-option\n                        *ngFor=\"let level of levels | async\"\n                        [value]=\"level.id\"\n                    >\n                        {{ level.display_name || level.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-slide-toggle\n                class=\"m-2\"\n                [ngModel]=\"(filters | async)?.only_onsite\"\n                (ngModelChange)=\"setFilters({ only_onsite: $event })\"\n                ><div class=\"text-xs\">Onsite Only</div></mat-slide-toggle\n            >\n            <div class=\"flex-1 w-2\"></div>\n            <searchbar\n                class=\"mr-2\"\n                (modelChange)=\"setSearch($event)\"\n            ></searchbar> -->\n        </div>\n    `,\n    styles: [\n        `\n            mat-form-field {\n                height: 3.25em;\n                width: 8em;\n            }\n        `,\n    ],\n})\nexport class SignageTopbarComponent extends AsyncHandler implements OnInit {\n    /** List of selected levels */\n    public zones: string[] = [];\n    /** List of levels for the active building */\n    public readonly levels = this._org.active_levels;\n\n    // public readonly filters = this._state.filters;\n    // /** Set filtered date */\n    // public readonly setDate = (date) => this._state.setFilters({ date });\n    // /** Set filtered date */\n    // public readonly setFilters = (filters) => this._state.setFilters(filters);\n    // /** Set filter string */\n    // public readonly setSearch = (str) => this._state.setSearchString(str);\n    // /** Update active zones for desks */\n    // public readonly updateZones = (zones) => {\n    //     this._router.navigate([], {\n    //         relativeTo: this._route,\n    //         queryParams: { zone_ids: zones.join(',') },\n    //     });\n    //     this._state.setFilters({ zones });\n    // };\n\n    constructor(\n        private _state: SignageStateService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _router: Router\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('zone_ids')) {\n                    const zones = params.get('zone_ids').split(',');\n                    if (zones.length) {\n                        const level = this._org.levelWithID(zones);\n                        if (!level) {\n                            return;\n                        }\n                        this._org.building = this._org.buildings.find(\n                            (bld) => bld.id === level.parent_id\n                        );\n                        this.zones = zones;\n                    }\n                }\n            })\n        );\n        this.subscription(\n            'levels',\n            this._org.active_levels.subscribe((levels) => {\n                this.zones = this.zones.filter((zone) =>\n                    levels.find((lvl) => lvl.id === zone)\n                );\n                if (!this.zones.length && levels.length) {\n                    this.zones.push(levels[0].id);\n                }\n                // this.updateZones(this.zones);\n            })\n        );\n        // this.setSearch('');\n    }\n}\n","import { Component } from '@angular/core';\n\nimport { SignageStateService } from './signage-state.service';\nimport { SignagePlaylist } from './signage.classes';\nimport { map, take, tap } from 'rxjs/operators';\nimport { combineLatest } from 'rxjs';\n\n@Component({\n    selector: 'signage-playlists',\n    template: `\n        <custom-table\n            class=\"block min-w-[48rem]\"\n            [dataSource]=\"playlist_list\"\n            [columns]=\"['name', 'description', 'media', 'duration', 'actions']\"\n            [display_column]=\"['Name', 'Description', 'Media', 'Duration', ' ']\"\n            [column_size]=\"['8r', 'flex', '10r', '6r', '5r']\"\n            [template]=\"{\n                media: media_template,\n                duration: duration_template,\n                actions: actions_template\n            }\"\n        ></custom-table>\n        <ng-template #media_template let-row=\"row\">\n            {{ row.media.length }} Media Item(s)\n        </ng-template>\n        <ng-template #duration_template let-row=\"row\">\n            <code>{{ row.duration | mediaDuration }}</code>\n        </ng-template>\n        <ng-template #actions_template let-row=\"row\">\n            <button icon matRipple (click)=\"editItem(row)\">\n                <app-icon>edit</app-icon>\n            </button>\n            <button icon matRipple class=\"text-error\" (click)=\"deleteItem(row)\">\n                <app-icon>delete</app-icon>\n            </button>\n        </ng-template>\n        <mat-progress-bar\n            class=\"absolute inset-x-0 bottom-0\"\n            *ngIf=\"loading | async\"\n            mode=\"indeterminate\"\n        ></mat-progress-bar>\n    `,\n    styles: [``],\n})\nexport class SignagePlaylistsComponent {\n    public readonly loading = this._state.loading;\n    public readonly playlists = this._state.playlists;\n    public readonly media = this._state.media;\n\n    public readonly deleteItem = (i) => this._state.removePlaylist(i);\n    public readonly editItem = (i) => this._state.editPlaylist(i);\n\n    public readonly playlist_list = combineLatest([\n        this.playlists,\n        this.media,\n    ]).pipe(\n        map(([playlists, media]) =>\n            playlists.map((playlist) => ({\n                ...playlist,\n                duration: playlist.media.reduce(\n                    (acc, item) =>\n                        acc +\n                        (playlist.media_durations[item] ||\n                            media.find((m) => m.id === item)?.duration ||\n                            15),\n                    0\n                ),\n            }))\n        )\n    );\n\n    constructor(private _state: SignageStateService) {}\n}\n","import { Component } from '@angular/core';\n\nimport { SignageStateService } from './signage-state.service';\nimport { combineLatest } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n@Component({\n    selector: 'signage-displays',\n    template: ` <custom-table\n            class=\"block min-w-[52rem]\"\n            [dataSource]=\"display_list\"\n            [columns]=\"[\n                'name',\n                'description',\n                'playlists',\n                'orientation',\n                'duration',\n                'actions'\n            ]\"\n            [display_column]=\"[\n                'Name',\n                'Description',\n                'Media',\n                'Orientation',\n                'Duration',\n                ' '\n            ]\"\n            [column_size]=\"['8r', 'flex', '8r', '7r', '6r', '5r']\"\n            [template]=\"{\n                playlists: playlists_template,\n                duration: duration_template,\n                actions: actions_template\n            }\"\n        ></custom-table>\n        <ng-template #playlists_template let-row=\"row\">\n            {{ row.playlists.length }} Playlist(s)\n        </ng-template>\n        <ng-template #duration_template let-row=\"row\">\n            <code>{{ row.duration | mediaDuration }}</code>\n        </ng-template>\n        <ng-template #actions_template let-row=\"row\">\n            <button icon matRipple (click)=\"editItem(row)\">\n                <app-icon>edit</app-icon>\n            </button>\n            <button icon matRipple class=\"text-error\" (click)=\"deleteItem(row)\">\n                <app-icon>delete</app-icon>\n            </button>\n        </ng-template>\n        <mat-progress-bar\n            class=\"absolute inset-x-0 bottom-0\"\n            *ngIf=\"loading | async\"\n            mode=\"indeterminate\"\n        ></mat-progress-bar>`,\n    styles: [``],\n})\nexport class SignageDisplaysComponent {\n    public readonly loading = this._state.loading;\n    public readonly displays = this._state.displays;\n    public readonly playlists = this._state.playlists;\n    public readonly media = this._state.media;\n\n    public readonly deleteItem = (i) => this._state.removePlaylist(i);\n    public readonly editItem = (i) => this._state.editPlaylist(i);\n\n    public readonly display_list = combineLatest([\n        this.displays,\n        this.playlists,\n        this.media,\n    ]).pipe(\n        map(([displays, playlists, media]) =>\n            (displays || []).map((display) => ({\n                ...display,\n                playlists:\n                    display.playlists?.map((id) =>\n                        playlists.find((i) => i.id === id)\n                    ) || [],\n                duration: display.playlists.reduce((acc, id) => {\n                    const playlist = playlists.find((_) => _.id === id);\n                    if (!playlist) return acc;\n                    return (\n                        acc +\n                        playlist.media.reduce(\n                            (acc, item) =>\n                                acc +\n                                (playlist.media_durations[item] ||\n                                    media.find((m) => m.id === item)\n                                        ?.duration ||\n                                    15),\n                            0\n                        )\n                    );\n                }, 0),\n            }))\n        )\n    );\n\n    constructor(private _state: SignageStateService) {}\n}\n","import { Component } from '@angular/core';\n\nimport { SignageStateService } from './signage-state.service';\n\n@Component({\n    selector: 'signage-zones',\n    template: ``,\n    styles: [``],\n})\nexport class SignageZonesComponent {\n    public readonly loading = this._state.loading;\n\n    constructor(private _state: SignageStateService) {}\n}\n","import { Component } from '@angular/core';\n\nimport { SignageStateService } from './signage-state.service';\n\n@Component({\n    selector: 'signage-triggers',\n    template: ``,\n    styles: [``],\n})\nexport class SignageTriggersComponent {\n    public readonly loading = this._state.loading;\n\n    constructor(private _state: SignageStateService) {}\n}\n","import { Component } from '@angular/core';\n\nimport { SignageStateService } from './signage-state.service';\nimport { AsyncHandler, notifyError } from '@placeos/common';\n\n@Component({\n    selector: 'signage-media',\n    template: `\n        <div\n            class=\"relative bg-base-200 min-h-full w-full\"\n            (document:dragenter)=\"onEnter($event)\"\n            (document:drop)=\"hideOverlay($event)\"\n        >\n            <ng-container *ngIf=\"!(loading | async); else load_template\">\n                <ng-container\n                    *ngIf=\"(media | async)?.length; else empty_template\"\n                >\n                    <div\n                        class=\"flex flex-wrap items-start justify-start w-full p-2\"\n                    >\n                        <div\n                            class=\"m-2 p-2 bg-base-100 rounded-lg overflow-hidden h-[13rem] border border-base-300 shadow\"\n                            *ngFor=\"let item of media | async\"\n                        >\n                            <button\n                                class=\"w-64 h-36 overflow-hidden bg-base-200 rounded m-0 p-0 relative\"\n                                (click)=\"previewMedia(item)\"\n                            >\n                                <img\n                                    [src]=\"item.url\"\n                                    class=\"object-cover w-full h-full\"\n                                />\n                                <div\n                                    class=\"absolute top-2 left-2 flex items-center justify-center rounded overflow-hidden\"\n                                >\n                                    <div\n                                        class=\"absolute inset-0 bg-base-content opacity-60 z-0\"\n                                    ></div>\n                                    <div\n                                        class=\"relative text-base-100 z-10 px-2 py-1 text-xs\"\n                                    >\n                                        {{\n                                            item.type === 'image'\n                                                ? 'Image'\n                                                : 'Video'\n                                        }}\n                                    </div>\n                                </div>\n                                <div\n                                    class=\"absolute top-2 right-2 flex items-center justify-center rounded overflow-hidden\"\n                                >\n                                    <div\n                                        class=\"absolute inset-0 bg-base-content opacity-60 z-0\"\n                                    ></div>\n                                    <div\n                                        class=\"relative text-base-100 z-10 px-2 py-1 text-xs\"\n                                    >\n                                        {{ count || 0 }} Playlist(s)\n                                    </div>\n                                </div>\n                                <div\n                                    class=\"absolute bottom-2 right-2 flex items-center justify-center rounded overflow-hidden\"\n                                    *ngIf=\"item.duration\"\n                                >\n                                    <div\n                                        class=\"absolute inset-0 bg-base-content opacity-60 z-0\"\n                                    ></div>\n                                    <div\n                                        class=\"relative text-base-100 z-10 px-2 py-1 text-xs\"\n                                    >\n                                        {{ item.duration | mediaDuration }}\n                                    </div>\n                                </div>\n                            </button>\n                            <div\n                                class=\"flex items-center justify-between space-x-2\"\n                            >\n                                <div class=\"truncate flex-1 w-1/2 px-2\">\n                                    {{ item.name }}\n                                </div>\n                                <button icon matRipple>\n                                    <app-icon>more_vert</app-icon>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </ng-container>\n            </ng-container>\n            <div class=\"absolute inset-0\" *ngIf=\"show_dropzone\">\n                <div class=\"absolute inset-0 bg-base-200\"></div>\n                <div class=\"absolute inset-0 bg-base-content opacity-70\"></div>\n                <div\n                    class=\"absolute inset-4 border-4 border-dashed border-neutral text-base-100 rounded-xl flex flex-col items-center justify-center\"\n                >\n                    <app-icon class=\"text-8xl\">upload</app-icon>\n                    <p>Drop file to upload file</p>\n                </div>\n                <input\n                    type=\"file\"\n                    class=\"absolute inset-0 w-full opacity-0\"\n                    (change)=\"previewFile($event)\"\n                />\n            </div>\n        </div>\n        <ng-template #empty_template>\n            <div\n                class=\"absolute inset-0 flex flex-col items-center justify-center space-y-2 opacity-30\"\n            >\n                <app-icon class=\"text-8xl\">hide_image</app-icon>\n                <p>No media found.</p>\n            </div>\n        </ng-template>\n        <ng-template #load_template>\n            <div\n                class=\"absolute inset-0 flex flex-col items-center justify-center space-y-2\"\n            >\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>Loading...</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                min-height: 100%;\n            }\n        `,\n    ],\n})\nexport class SignageMediaComponent extends AsyncHandler {\n    public readonly loading = this._state.loading;\n    public readonly media = this._state.media;\n    public show_dropzone = false;\n\n    public readonly previewMedia = (item) => this._state.previewMedia(item);\n\n    public onEnter(e) {\n        this.show_dropzone = e?.dataTransfer?.types.includes('Files');\n    }\n\n    public hideOverlay(e) {\n        if (!(e.target instanceof HTMLInputElement)) {\n            e.preventDefault();\n        }\n        this.timeout('hide_overlay', () => (this.show_dropzone = false));\n    }\n\n    constructor(private _state: SignageStateService) {\n        super();\n    }\n\n    public previewFile(event) {\n        const element: HTMLInputElement = event.target as any;\n        /* istanbul ignore else */\n        if (!element?.files?.length) return;\n        const files: FileList = element.files;\n        const file = files[0];\n        if (\n            file &&\n            (file.type.includes('image') || file.type.includes('video'))\n        ) {\n            this._state.previewFileMedia(file);\n        } else {\n            notifyError('Invalid file type.');\n        }\n    }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule, Type } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { UIModule } from '../ui/ui.module';\nimport { SignageComponent } from './signage.component';\nimport { SignageTopbarComponent } from './signage-topbar.component';\nimport { SignagePlaylistsComponent } from './signage-playlists.component';\nimport { SignageDisplaysComponent } from './signage-displays.component';\nimport { SignageZonesComponent } from './signage-zones.component';\nimport { SignageTriggersComponent } from './signage-triggers.component';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { SignageMediaComponent } from './signage-media.component';\nimport { SignageMediaPreviewModalComponent } from './signage-media-preview-modal.component';\nimport { ComponentsModule } from '@placeos/components';\nimport { SignagePlaylistModalComponent } from './signage-playlist-modal.component';\nimport { SignageDisplayModalComponent } from './signage-display-modal.component';\n\nconst ROUTES: Route[] = [\n    {\n        path: '',\n        component: SignageComponent,\n        children: [\n            { path: '', redirectTo: 'playlists', pathMatch: 'full' },\n            { path: 'playlists', component: SignagePlaylistsComponent },\n            { path: 'media', component: SignageMediaComponent },\n            { path: 'displays', component: SignageDisplaysComponent },\n            { path: 'zones', component: SignageZonesComponent },\n            { path: 'triggers', component: SignageTriggersComponent },\n            { path: '*', redirectTo: 'playlists', pathMatch: 'full' },\n        ],\n    },\n];\n\nexport const COMPONENTS: Type<any>[] = [\n    SignageComponent,\n    SignageTopbarComponent,\n    SignagePlaylistsComponent,\n    SignageMediaComponent,\n    SignageDisplaysComponent,\n    SignageZonesComponent,\n    SignageTriggersComponent,\n    SignageMediaPreviewModalComponent,\n    SignagePlaylistModalComponent,\n    SignageDisplayModalComponent,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [\n        CommonModule,\n        FormsModule,\n        UIModule,\n        ComponentsModule,\n        RouterModule.forChild(ROUTES),\n        MatTabsModule,\n    ],\n})\nexport class SignageModule {}\n"],"x_google_ignoreList":[]}