"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_users_src_index_ts"],{711:(Ae,L,s)=>{s.d(L,{OO:()=>y.OO,Y:()=>Ze,PP:()=>xe,mO:()=>y.mO,ro:()=>g.ro,VE:()=>h.VE,pP:()=>g.pP,w0:()=>h.w0,sF:()=>g.sF});var r=s(4666),u=s(2508),F=s(1708),m=s(8589),f=s(1484),O=s(4792),z=s(5340),K=s(5170),p=(s(9645),s(9036),s(1670)),g=s(4283),h=s(9012),y=s(5197),e=s(2560);new y.n5;var Z=s(9112),X=s(312),V=s(8325),_=s(7367),ee=s(1170),te=s(5380),b=s(1810),S=s(9377),J=s(3200),W=s(6962),E=s(354);function oe(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",23)(1,"div",24),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"div",25)(5,"mat-checkbox",26),e.NdJ("ngModelChange",function(a){const d=e.CHM(t).index,c=e.oxw(2);return e.KtG(c.settings[c.available_weekdays[d]]=a)})("ngModelChange",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.changed=!0)}),e.qZA()()()}if(2&o){const t=i.$implicit,n=i.index,a=e.oxw(2);e.xp6(2),e.hij(" ",e.xi3(3,2,t,"EEE")," "),e.xp6(3),e.Q6J("ngModel",a.settings[a.available_weekdays[n]])}}function ie(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5),e._UZ(2,"a-user-avatar",6),e.TgZ(3,"div"),e._uU(4),e.qZA(),e.TgZ(5,"div",7),e._uU(6),e.qZA(),e.TgZ(7,"div",7),e._uU(8),e.qZA()(),e.TgZ(9,"div",8)(10,"h3",9),e._uU(11," Today's Working Location "),e.qZA(),e.TgZ(12,"button",10)(13,"div",11)(14,"div",12),e._uU(15),e.qZA(),e.TgZ(16,"app-icon",13),e._uU(17,"arrow_drop_down"),e.qZA()()(),e.TgZ(18,"div",14)(19,"div",15)(20,"app-icon"),e._uU(21,"home"),e.qZA()(),e.TgZ(22,"div",16),e._uU(23," Today is a working from home day. Available for online meetings. "),e.qZA()()(),e.TgZ(24,"div",17)(25,"h3",9),e._uU(26," Default Office Days "),e.qZA(),e.TgZ(27,"div",18),e.YNc(28,oe,6,5,"div",19),e.qZA()(),e.TgZ(29,"div",20)(30,"button",21),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.saveChanges())}),e._uU(31," Update "),e.qZA()(),e.TgZ(32,"button",22)(33,"app-icon"),e._uU(34,"close"),e.qZA()()()}if(2&o){const t=e.oxw(),n=e.MAs(2);e.xp6(2),e.Q6J("user",t.user),e.xp6(2),e.Oqu(t.user.name),e.xp6(2),e.Oqu(t.user.email),e.xp6(2),e.Oqu(t.user.phone),e.xp6(4),e.Q6J("matMenuTriggerFor",n),e.xp6(3),e.Oqu(t.option),e.xp6(13),e.Q6J("ngForOf",t.weekdays),e.xp6(2),e.Q6J("disabled",!t.changed)}}function se(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw();return d.option=l.id,e.KtG(d.changed=!0)}),e._uU(1),e.qZA()}if(2&o){const t=i.$implicit;e.uIk("id",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function ae(o,i){1&o&&(e.TgZ(0,"div",28),e._UZ(1,"mat-spinner",29),e.TgZ(2,"p"),e._uU(3,"Saving changes to work location settings..."),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("diameter",32))}const H="wfh-days";let Q=(()=>{class o{constructor(t,n){this._settings=t,this._dialog_ref=n,this.options=[{id:"wfo",name:"Work from office (WFO)"},{id:"wfh",name:"Work from home (WFH)"},{id:"aol",name:"Away on Leave (AOL)"}],this.option=this.options[0].id,this.settings=[!0,!0,!0,!0,!0,!0,!0],this.weekdays=[],this.changed=!1,this.loading=!1,this.available_weekdays=[1,2,3,4,5],this._booking=new W.$({type:"wfh-settings",asset_id:this.options[0].id})}ngOnInit(){this.settings=this._settings.get(H)||[!0,!0,!0,!0,!0,!0,!0],this._initWeekdays(),this._loadOptionForToday()}get user(){return(0,Z.ar)()}saveChanges(){var t=this;return(0,p.Z)(function*(){t.loading=!0,t._dialog_ref.disableClose=!0,t.option!==t.options[0].id&&t.option!==t._booking.asset_id&&(yield(0,E.km)(new W.$({...t._booking,asset_id:t.option})).toPromise().catch(n=>{throw t._dialog_ref.disableClose=!1,t.loading=!1,n})),t._settings.saveUserSetting(H,t.settings),t.loading=!1,t._dialog_ref.close()})()}_initWeekdays(){let t=new Date;this.weekdays=this.available_weekdays.map(n=>function ne(o,i,t){var n,a,l,d,c,w,T,A;(0,ee.Z)(2,arguments);var I=(0,te.j)(),C=(0,_.Z)(null!==(n=null!==(a=null!==(l=null!==(d=t?.weekStartsOn)&&void 0!==d?d:null==t||null===(c=t.locale)||void 0===c||null===(w=c.options)||void 0===w?void 0:w.weekStartsOn)&&void 0!==l?l:I.weekStartsOn)&&void 0!==a?a:null===(T=I.locale)||void 0===T||null===(A=T.options)||void 0===A?void 0:A.weekStartsOn)&&void 0!==n?n:0);if(!(C>=0&&C<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var k=(0,V.Z)(o),v=(0,_.Z)(i),G=k.getDay(),we=(v%7+7)%7,M=7-C;return(0,X.Z)(k,v<0||v>6?v-(G+M)%7:(we+M)%7-(G+M)%7)}(t,n).valueOf())}_loadOptionForToday(){var t=this;return(0,p.Z)(function*(){const n=yield(0,E.F2)({type:"wfh-setting",period_start:(0,b.Z)((0,S.Z)(Date.now())),period_end:(0,b.Z)((0,J.Z)(Date.now()))}).toPromise();n.length&&(t.option=n[0].asset_id,t._booking=n[0])})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Z.gb),e.Y36(f.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["wfh-settings-modal"]],decls:6,vars:3,consts:[["class","relative flex flex-col rounded overflow-hidden w-[18rem]",4,"ngIf","ngIfElse"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["load_state",""],[1,"relative","flex","flex-col","rounded","overflow-hidden","w-[18rem]"],[1,"w-full","px-4","py-8","flex","flex-col","items-center","border-b","border-gray-200"],[3,"user"],[1,"text-xs","opacity-30"],[1,"w-full","p-4","flex","flex-col","border-b","border-gray-200"],[1,"-mt-2","mb-2","text-sm","font-medium"],["mat-button","","today-location","",1,"inverse","rounded-3xl","w-auto",3,"matMenuTriggerFor"],[1,"flex","items-center","justify-between"],[1,"uppercase"],[1,"text-2xl"],[1,"flex","items-center","pt-4","space-x-2"],[1,"h-8","w-8","rounded-full","bg-gray-300","dark:bg-neutral-800","flex","items-center","justify-center"],[1,"flex-1","w-1/2","text-sm"],[1,"w-full","p-4","flex","flex-col"],[1,"border","border-gray-200","rounded","flex","items-center","justify-between","px-2","pt-2"],["class","flex flex-col items-center",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-end","px-4","pb-4"],["mat-button","","save","",3,"disabled","click"],["mat-icon-button","","mat-dialog-close","",1,"absolute","top-0","left-0"],[1,"flex","flex-col","items-center"],[1,"text-sm","font-light"],[1,"h-8","w-8","flex","items-center","justify-center","pr-2"],[3,"ngModel","ngModelChange"],["mat-menu-item","",3,"click"],["loading","",1,"relative","bg-white","flex","flex-col","justify-center","items-center","rounded","overflow-hidden","w-[18rem]","h-[18rem]"],[3,"diameter"]],template:function(t,n){if(1&t&&(e.YNc(0,ie,35,8,"div",0),e.TgZ(1,"mat-menu",null,1),e.YNc(3,se,2,2,"button",2),e.qZA(),e.YNc(4,ae,4,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(5);e.Q6J("ngIf",!n.loading)("ngIfElse",a),e.xp6(3),e.Q6J("ngForOf",n.options)}}}),o})();const le=["container"];function re(o,i){if(1&o&&(e.TgZ(0,"div",19),e._UZ(1,"a-user-avatar",14),e.TgZ(2,"div",15),e._uU(3),e.qZA(),e.TgZ(4,"button",20)(5,"app-icon"),e._uU(6,"close"),e.qZA()(),e._UZ(7,"user-availability-list",16),e.qZA()),2&o){const t=i.$implicit,n=e.oxw();e.xp6(1),e.Q6J("user",n.host),e.xp6(2),e.Oqu(t.name||n.host.email),e.xp6(4),e.Q6J("user",t)("date",n.date)("offset",n.offset)("width",n.width)}}function de(o,i){if(1&o&&(e.TgZ(0,"div",21)(1,"div",22),e._uU(2),e.qZA()()),2&o){const t=i.index;e.xp6(2),e.AsE(" ",t%12?t%12:"12","",t>=12?"pm":"am"," ")}}let j=(()=>{class o extends Z.KG{constructor(t,n){super(),this._data=t,this._dialog_ref=n,this.search="",this.date=this._data.date||Date.now(),this.users=[...this._data.users],this.offset=0,this.width=0,this.host=this._data.host,this.hours=new Array(24).fill(0)}ngAfterViewInit(){this.timeout("init",()=>{this.updateWidth(),this.updateScroll()},300)}updateWidth(){const t=this._container_el.nativeElement.getBoundingClientRect().width,n=this._container_el.nativeElement.querySelector("[users]").getBoundingClientRect().width;console.log("Sizes:",t,n),this.width=Math.floor(t-n)}updateScroll(){this.offset=this._container_el.nativeElement.scrollLeft}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.WI),e.Y36(f.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["find-availability-modal"]],viewQuery:function(t,n){if(1&t&&e.Gf(le,7),2&t){let a;e.iGM(a=e.CRH())&&(n._container_el=a.first)}},features:[e.qOj],decls:24,vars:10,consts:[[1,"relative","flex","items-center","justify-center","p-4"],[1,"text-center"],["mat-icon-button","","mat-dialog-close","",1,"absolute","top-1/2","left-1","-translate-y-1/2"],[1,"flex","flex-col","h-[calc(100vh-3rem)]","sm:h-[65vh]",3,"resize"],[1,"w-full","flex","flex-col","sm:flex-row","sm:space-x-2","p-2"],[1,"h-[3.25rem]",3,"ngModel","ngModelChange"],["appearance","outline",1,"h-[3.25rem]"],["matPrefix","",1,"text-xl"],["matInput","","placeholder","Type a name or email to add",3,"ngModel","ngModelChange"],[1,"flex","flex-1","h-1/2","w-full","border-t","border-gray-300","relative","overflow-auto","divide-x","divide-gray-300","max-w-[100vw]","sm:max-w-[80vw]",3,"scroll"],["container",""],["users","",1,"sticky","left-0","min-h-full","bg-white","border-r","border-gray-300"],["header","",1,"h-10","w-[6rem]","border-b","border-gray-300"],["host","",1,"flex","flex-col","items-center","justify-center","h-24","w-[6rem]","relative","border-b","border-gray-300"],[1,"text-2xl",3,"user"],[1,"text-xs","break-words","overflow-hidden","max-w-full"],[1,"absolute","top-0","-bottom-px","left-full",3,"user","date","offset","width"],["person","","class","flex flex-col items-center justify-center h-24 w-[6rem] relative border-b border-gray-300",4,"ngFor","ngForOf"],["hour","","class","min-w-[5rem] bg-gray-50 min-h-full",4,"ngFor","ngForOf"],["person","",1,"flex","flex-col","items-center","justify-center","h-24","w-[6rem]","relative","border-b","border-gray-300"],["mat-icon-button","",1,"absolute","top-0","left-0"],["hour","",1,"min-w-[5rem]","bg-gray-50","min-h-full"],["header","",1,"h-10","border-b","border-gray-300","p-2"]],template:function(t,n){1&t&&(e.TgZ(0,"header",0)(1,"h2",1),e._uU(2,"Find Availability"),e.qZA(),e.TgZ(3,"button",2)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.TgZ(6,"main",3),e.NdJ("resize",function(){return n.updateWidth()},!1,e.Jf7),e.TgZ(7,"div",4)(8,"a-date-field",5),e.NdJ("ngModelChange",function(l){return n.date=l}),e.qZA(),e.TgZ(9,"mat-form-field",6)(10,"app-icon",7),e._uU(11,"search"),e.qZA(),e.TgZ(12,"input",8),e.NdJ("ngModelChange",function(l){return n.search=l}),e.qZA()()(),e.TgZ(13,"div",9,10),e.NdJ("scroll",function(){return n.updateScroll()}),e.TgZ(15,"div",11),e._UZ(16,"div",12),e.TgZ(17,"div",13),e._UZ(18,"a-user-avatar",14),e.TgZ(19,"div",15),e._uU(20),e.qZA(),e._UZ(21,"user-availability-list",16),e.qZA(),e.YNc(22,re,8,6,"div",17),e.qZA(),e.YNc(23,de,3,2,"div",18),e.qZA()()),2&t&&(e.xp6(8),e.Q6J("ngModel",n.date),e.xp6(4),e.Q6J("ngModel",n.search),e.xp6(6),e.Q6J("user",n.host),e.xp6(2),e.Oqu(n.host.name||n.host.email),e.xp6(1),e.Q6J("user",n.host)("date",n.date)("offset",n.offset)("width",n.width),e.xp6(1),e.Q6J("ngForOf",n.users),e.xp6(1),e.Q6J("ngForOf",n.hours))}}),o})();var ue=s(4505),fe=s(9151),ce=s(9095),me=s(6942),ge=s(9128),ve=s(4211);function pe(o,i){if(1&o&&(e.TgZ(0,"div",3)(1,"div"),e._uU(2,"Unavailable"),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.ALo(5,"date"),e.ALo(6,"date"),e.qZA()()),2&o){const t=i.$implicit;e.Udp("left",t.start+"%")("width",t.size+"%"),e.xp6(4),e.AsE(" ",e.xi3(5,6,t.date,"shortTime")," - ",e.xi3(6,9,t.date+60*t.duration*1e3,"shortTime")," ")}}let D=(()=>{class o{constructor(){this.date=Date.now(),this.offset=0,this.width=0,this._user$=new ue.X(null),this.availability=this._user$.pipe((0,fe.h)(t=>t),(0,ce.w)(t=>(0,ve.u$)({calendars:t.email,period_start:(0,S.Z)(this.date).valueOf(),period_end:(0,J.Z)(this.date).valueOf()})),(0,me.U)(t=>t.map(n=>({date:n.date,duration:n.duration,start:(new Date(n.date).getHours()+new Date(n.date).getMinutes()/60)/24,size:n.duration/60/24}))),(0,ge.d)(1))}ngOnChanges(t){t.user&&this.user&&this._user$.next(this.user)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["user-availability-list"]],inputs:{user:"user",date:"date",offset:"offset",width:"width"},features:[e.TTD],decls:4,vars:5,consts:[[1,"overflow-hidden","relative","border-b","border-gray-300","h-full","pointer-events-none"],[1,"w-[120rem]","h-px"],["event","","class","absolute inset-y-0 bg-primary rounded-lg text-white",3,"left","width",4,"ngFor","ngForOf"],["event","",1,"absolute","inset-y-0","bg-primary","rounded-lg","text-white"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.YNc(2,pe,7,12,"div",2),e.ALo(3,"async"),e.qZA()),2&t&&(e.Udp("width",n.width+"px"),e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,3,n.availability)))},dependencies:[r.sg,r.Ov,r.uU]}),o})();var N=s(5306),$=s(9685),P=s(4522),he=s(2306),Y=s(5074),ye=s(1267);let xe=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[r.ez,u.u5,u.UX,f.Is,K.W,z.K,O.p9,F.Cq,m.Tx]}),o})();e.B6R(Q,[r.sg,r.O5,u.JJ,u.On,f.ZT,N.o,$.k,m.VK,m.OP,m.p6,P.lW,F.Ou,O.oG],[r.uU]),e.B6R(j,[r.sg,u.Fj,u.JJ,u.On,f.ZT,he.Q,N.o,$.k,Y.KE,Y.qo,P.lW,ye.Nt,D],[]);class Ze{constructor(i={}){this.type=i.type||i.location||"other",this.position=i.position||i.map_id||i.asset_id||{x:i.x/i.map_width||0,y:i.y/i.map_height||0},this.variance=i.variance||0,this.last_seen=i.last_seen||(0,b.Z)(new Date),this.level=i.level,this.building=i.building,this.at_location=!!i.at_location,this.coordinates_from=i.coordinates_from||"top-left"}}s(9375)}}]);
//# sourceMappingURL=default-libs_users_src_index_ts.js.map