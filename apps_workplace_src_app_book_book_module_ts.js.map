{"version":3,"file":"apps_workplace_src_app_book_book_module_ts.js","mappings":"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","names":["MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS","InjectionToken","MAT_BUTTON_TOGGLE_GROUP","MAT_BUTTON_TOGGLE_GROUP_VALUE_ACCESSOR","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","MatButtonToggleGroup","multi","uniqueIdCounter","MatButtonToggleChange","constructor","source","value","this","name","_name","_markButtonsForCheck","vertical","_vertical","coerceBooleanProperty","selected","_selectionModel","multiple","map","toggle","undefined","newValue","_setSelectionByValue","valueChange","emit","_multiple","disabled","_disabled","_changeDetector","defaultOptions","_controlValueAccessorChangeFn","_onTouched","EventEmitter","change","appearance","ngOnInit","SelectionModel","ngAfterContentInit","select","_buttonToggles","filter","checked","writeValue","markForCheck","registerOnChange","fn","registerOnTouched","setDisabledState","isDisabled","_emitChangeEvent","event","_syncButtonToggle","isUserInput","deferEvents","deselect","Promise","resolve","then","_updateModelValue","_isSelected","isSelected","_isPrechecked","_rawValue","Array","isArray","some","_clearSelection","forEach","currentValue","_selectValue","clear","correspondingOption","find","_markForCheck","ɵfac","i0","ɵdir","selectors","dirIndex","MatButtonToggle","_t","ctx","_MatButtonToggleBase","mixinDisableRipple","buttonId","id","buttonToggleGroup","_appearance","_checked","_changeDetectorRef","toggleGroup","_elementRef","_focusMonitor","defaultTabIndex","super","ariaLabelledby","parsedTabIndex","Number","tabIndex","group","ngAfterViewInit","monitor","ngOnDestroy","stopMonitoring","focus","options","_buttonElement","nativeElement","_onButtonClick","newChecked","_isSingleSelector","_getButtonName","i1","ɵcmp","_c0","ngContentSelectors","i2","styles","MatButtonToggleModule","ɵmod","ɵinj","MatCommonModule","MatRippleModule","AssetDetailsComponent","images","item","_","url","AssetFiltersComponent","AssetFiltersDisplayComponent","Asset","_data","category","barcode","brand","size","description","specifications","purchase_date","Date","now","purchase_price","purchase_details","consumables","general_details","invoices","quantity","locations","in_use","key","other_data","AssetStateService","BehaviorSubject","date","_search","asObservable","_loading","of","pipe","switchMap","next","getValue","queryAssets","q","query","toQueryString","get","d","catchError","tap","replace","shareReplay","_options","debounceTime","zone","queryBookings","zones","period_start","getUnixTime","startOfDay","period_end","endOfDay","type","combineLatest","asset_list","asset_bookings","list","bookings","b","asset_id","sort","a","localeCompare","available_assets","search","assets","s","toLowerCase","includes","setSearch","setOptions","factory","AssetListComponent","_asset_state","loading","filtered_assets","isFavourite","favorites","selectAsset","asset","onSelect","core","AssetsModule","CommonModule","FormFieldsModule","FormsModule","ComponentsModule","AssetSelectModalComponent","RULE_TYPES","$event","set_r2","CateringConfigModalComponent","AsyncHandler","new_id","Math","floor","random","require_notes","rulesets","config","set","rules","i","JSON","stringify","saveNotesSetting","timeout","saveNotes","saveChanges","parse","reason","metadata","MAT_DIALOG_DATA","ctx_r20","ctx_r22","ctx_r23","ctx_r24","ctx_r25","CateringItemModalComponent","CateringItem","categories","tag_list","form","controls","tags","renderPercent","hasTag","tag","FormGroup","FormControl","Validators","unit_price","accept_points","discount_cap","ENTER","COMMA","SPACE","addTag","markAsDirty","input","trim","push","setValue","removeTag","existing_tag","index","indexOf","splice","randomInt","$localize","CateringItemOptionModalComponent","option","types","new_option","parent","concat","subHours","dirtyDate","dirtyAmount","requiredArgs","arguments","amount","toInteger","addHours","RULE_REQUESTS","cateringItemAvailable","is_available","rule","resources","space","matches","condition","isBefore","isAfter","setHours","duration","stringToMinutes","ext","length","CateringOrderModalComponent","code","_org","currency_code","_this","order","CateringOrder","getCateringConfig","level","parent_id","menu","subscribe","unique","cat","menu_items","updateMenuQuantities","addItem","choose_options","old_item","items","itm","reduce","c","o","opt","selectOptions","new_item","options_string","removeItem","updateItemQuantity","optionsFor","join","saveOrder","confirmOrder","show_order_details","CateringOrderOptionsModalComponent","groups","group_list","updateGroupOption","option_state","saveOptions","CateringImportMenuModalComponent","handleFileEvent","element","target","files","file","fileReader","FileReader","addEventListener","e","data","csvToJson","result","readAsText","downloadTemplate","downloadFile","CateringStateService","is_editable","building","_menu","_dialog","_settings","_currency","active_building","showMetadata","details","post","settings","charge_codes","disabled_rooms","subscription","bld","getCateringForZone","currency","manageCateringOrder","ref","_this2","open","race","componentInstance","first","toPromise","afterClosed","close","_this3","findIndex","updateMenu","updateItem","addOption","_this4","_this5","deleteItem","openConfirmModal","title","content","icon","class","_this6","deleteOption","_this7","editConfig","_this8","take","flatten","saveSettings","updateConfig","importMenu","_this9","updated_menu","catch","notifyError","notifySuccess","zone_id","updateMetadata","old_settings","_this10","addItemToOrder","match","CateringMenuItemComponent","can_edit","_catering","is_enabled","hide_for_zones","state","symbol","CateringMenuComponent","menu_map","CateringOrderItemComponent","CateringOrdersService","filters","_filters","_poll","start","end","queryEvents","zone_ids","events","orders","checkOrder","startPolling","delay","interval","valueOf","stopPolling","clearInterval","updateStatus","status","updated_order","CalendarEvent","catering","saveEvent","CATERING_STATUSES","colour","CateringOrderComponent","statuses","_orders","ANIMATION_SHOW_CONTRACT_EXPAND","CateringOrderListComponent","filtered","trackByFn","CateringOrderStateService","available_menu","l","getCateringRulesForZone","fresh","every","t","opts","setFilters","CateringItemListItemComponent","option_list","CateringItemListComponent","_state","filtered_menu","m","ngOnChanges","changes","selected_items","item_id","selectItem","clear_state","active","CateringItemDetailsComponent","_update","group_state","updateCheckedState","g","ICONS","coffee","drinks","snacks","meals","CateringItemFiltersComponent","f","toggleCategory","toggleTag","EMPTY_FAVS","NewCateringOrderModalComponent","selected_ids","custom_id","count","_order","setSelected","displayed","toggleFavourite","fav_list","saveUserSetting","CateringListFieldComponent","_onChange","_onTouch","new_value","updated_list","addItems","optionList","cateringitem","decls","CateringRoomsStateModalComponent","requestSpacesForZone","availability","toggleRoom","rooms","enableSelected","disableSelected","disabled_list","ChargeCodeListModalComponent","_dialog_ref","newCode","removeCode","addCodesFromFile","reader","evt","srcElement","saveChargeCodes","cleaned_codes","idx","SharedCateringModule","MatMenuModule","MatTabsModule","MatAutocompleteModule","MatDialogModule","MatCheckboxModule","MatRadioModule","MatTooltipModule","ReactiveFormsModule","MatFormFieldModule","BookComponent","hide_nav","localStorage","getItem","_legacyCanvasSize","DEFAULT_CANVAS_SIZE","_preferredCamera","_maxScansPerSecond","_lastScanTimestamp","_destroyed","_flashOn","_paused","_active","$video","$canvas","document","createElement","_onDecode","console","warn","_legacyOnDecode","_onDecodeError","onDecodeError","_calculateScanRegion","calculateScanRegion","preferredCamera","maxScansPerSecond","_onPlay","bind","_onLoadedMetaData","_onVisibilityChange","_updateOverlay","disablePictureInPicture","playsInline","muted","h","hidden","body","contains","appendChild","parentElement","highlightScanRegion","highlightCodeOutline","overlay","$overlay","style","position","display","pointerEvents","classList","add","innerHTML","firstElementChild","animate","transform","iterations","Infinity","direction","easing","insertBefore","nextSibling","insertAdjacentHTML","$codeOutlineHighlight","lastElementChild","_scanRegion","requestAnimationFrame","window","getComputedStyle","setProperty","visibility","opacity","width","height","removeChild","_qrEnginePromise","createQrEngine","WORKER_PATH","static","listCameras","navigator","mediaDevices","enumerateDevices","kind","label","getUserMedia","audio","video","deviceId","_stopVideoStream","hasFlash","srcObject","MediaStream","_getCameraStream","stream","getVideoTracks","getSettings","isFlashOn","toggleFlash","turnFlashOff","turnFlashOn","applyConstraints","advanced","torch","_restartVideoStream","destroy","removeEventListener","stop","_postWorkerMessage","Error","location","protocol","play","facingMode","_setVideoMirror","pause","setTimeout","setCamera","n","scanRegion","qrEngine","canvas","disallowCanvasResizing","alsoTryWithoutScanRegion","p","k","all","_loadImage","_drawToCanvas","Worker","_postWorkerMessageSync","v","w","u","r","y","clearTimeout","cornerPoints","_convertPoints","NO_QR_CODE_FOUND","message","x","getImageData","buffer","asyncToGenerator","detect","rawValue","test","_disableBarcodeDetector","scanImage","setGrayscaleWeights","red","green","blue","useIntegerApproximation","setInversionMode","__webpack_require__","createWorker","BarcodeDetector","getSupportedFormats","userAgentData","brands","platform","getHighEntropyValues","architecture","platformVersion","parseInt","formats","_scanFrame","round","min","videoWidth","videoHeight","downScaledWidth","downScaledHeight","offsetWidth","offsetHeight","offsetLeft","offsetTop","objectFit","objectPosition","split","parseFloat","endsWith","top","left","paused","ended","requestVideoFrameCallback","readyState","_codeOutlineHighlightRemovalTimeout","setAttribute","log","Object","assign","exact","_getFacingMode","getTracks","removeTrack","getContext","alpha","imageSmoothingEnabled","drawImage","Image","_awaitImageLoad","HTMLVideoElement","HTMLCanvasElement","SVGImageElement","OffscreenCanvas","ImageBitmap","File","Blob","URL","src","createObjectURL","toString","revokeObjectURL","complete","naturalWidth","ErrorEvent","_workerMessageId","postMessage","BookCodeFlowComponent","_router","_route","_event_form","_booking_form","_video_el","track","_qr_scanner","queryParamMap","params","has","_checkinBooking","_checkinEvent","error","QrScanner","handleQrCode","regex","exec","navigate","addMinutes","email","currentUser","checkinBooking","queryParams","newForm","Booking","space_id","checkinEventGuest","showSystem","system","DeskFlowDetailedFormComponent","can_book_lockers","can_book_for_others","can_recurr","allow_groups","needs_reason","allow_time_changes","allow_all_day","book_until","addDays","building_list","active_levels","features","DeskFlowFormComponent","is_edit","auto_allocation","time","clearForm","initialised","levels","levelsForBuilding","quickBook","patchValue","roundToNearestMinutes","nearestTo","findDesk","markAllAsTouched","valid","allocateDesk","getInvalidFields","centered_at","lvl","levelWithID","desk_list","desk_id","map_id","findNearbyFeature","desk","asset_name","booking_type","confirmPost","DeskFlowMapComponent","active_desk","_active_desk","hide_map","_explore","map_url","map_styles","map_positions","map_features","map_actions","map_labels","valueChanges","startWith","recurrence","formatRecurrence","pattern","recurr_end","days_of_week","format","setLevel","available","actions","bookable","fill","action","callback","setActiveDesk","setStyles","setActions","setFeatures","DeskFlowConfirmComponent","FlowSuccessComponent","is_host","calendar","BookDeskFlowComponent","view","last_success","loadForm","paramMap","param","setView","DetailBookSpaceFormComponent","has_catering","hide_actions","hide_notes","hide_attendees","max_duration","show_features","features_label","SpaceFlowFormComponent","allow_standalone_bookings","capacity","host","findSpace","confirmBooking","SpaceFlowFindItemComponent","bookSpace","book","bookChange","viewLocation","MapLocateModalComponent","maxWidth","maxHeight","ctx_r32","SpaceFlowFindComponent","setBuilding","_space_pipe","available_spaces","book_space","space_list","_getSpaceList","handleBookEvent","spaces","id_list","keys","SpacePipe","SpaceFlowConfirmComponent","can_view_location","postForm","BookSpaceFlowComponent","SpacePingComponent","_details","zoom$","zoom","ratio$","ratio","MAP_FEATURE_DATA","ParkingFlowMapComponent","levelName","display_name","setActive","active_space","_booking","_parking","week_availablility","existing_event","reset","full_size","z_index","ExploreParkingService","ParkingFlowConfirmComponent","BookParkingFlowComponent","ctx_r2","MeetingFlowConfirmModalComponent","_space","getRawValue","buildings","address","dismiss","cancelPostForm","i18n_5","MeetingFlowConfirmComponent","_sheet_ref","i18n_3","MeetingFormDetailsComponent","end_date","MeetingFlowFormComponent","has_assets","allow_externals","strict_capacity_check","total_capacity","attendee_count","user","attendees","_bottom_sheet","code_filter","resetForm","openEventLinkModal","innerWidth","dialog_ref","show_close","sheet_ref","instance","afterDismissed","_checkCateringEligibility","focusInput","_input_el","findAvailableTime","organiser","FindAvailabilityModalComponent","users","timer","z","disable","notifyWarn","enable","MeetingFlowSuccessComponent","last_event","BookMeetingFlowComponent","listenForStatusChanges","NewDeskFlowConfirmComponent","booking","needs_locker","secondary_resource","assets_count","booking_asset","postFormForGroup","members","NewDeskFormDetailsComponent","setFeature","setBookingAsset","selected_desk","NewDeskFlowFormComponent","startOfMinute","NewDeskFlowSuccessComponent","extension_data","show_links","openBookingLinkModal","outlook_link","generateMicrosoftCalendarLink","google_link","generateGoogleCalendarLink","ical_link","generateCalendarFileLink","NewDeskFlowComponent","Desk","VisitorFlowComponent","onDone","NewParkingFlowConfirmComponent","ParkingFormDetailsComponent","ParkingFlowFormComponent","ParkingFlowSuccessComponent","resource","NewParkingFlowComponent","CodeFlowSuccessComponent","CodeFlowErrorComponent","ROUTES","path","component","children","redirectTo","BookModule","SharedComponentModule","SharedExploreModule","MatBottomSheetModule","SharedBookingsModule","RouterModule"],"sourceRoot":"webpack:///","sources":["./node_modules/@angular/material/fesm2020/button-toggle.mjs","./libs/assets/src/lib/asset-select-modal/asset-details.component.ts","./libs/assets/src/lib/asset-select-modal/asset-filters.component.ts","./libs/assets/src/lib/asset-select-modal/asset-filters-display.component.ts","./libs/assets/src/lib/asset.class.ts","./libs/assets/src/lib/asset-state.service.ts","./libs/assets/src/lib/assets.fn.ts","./libs/assets/src/lib/asset-select-modal/asset-list.component.ts","./libs/assets/src/lib/assets.module.ts","./libs/catering/src/lib/catering.interfaces.ts","./libs/catering/src/lib/catering-config-modal.component.ts","./libs/catering/src/lib/catering-item-modal.component.ts","./libs/catering/src/lib/catering-option-modal.component.ts","./node_modules/date-fns/esm/subHours/index.js","./libs/catering/src/lib/utilities.ts","./libs/catering/src/lib/catering-order-modal.component.ts","./libs/catering/src/lib/catering-order-options-modal.component.ts","./libs/catering/src/lib/catering-import-menu-modal.component.ts","./libs/catering/src/lib/catering-state.service.ts","./libs/catering/src/lib/catering-menu-item.component.ts","./libs/catering/src/lib/catering-menu.component.ts","./libs/catering/src/lib/catering-order-item.component.ts","./libs/catering/src/lib/catering-orders.service.ts","./libs/catering/src/lib/catering.vars.ts","./libs/catering/src/lib/catering-order.component.ts","./libs/catering/src/lib/catering-order-list.component.ts","./libs/catering/src/lib/catering-order-modal/catering-order-state.service.ts","./libs/catering/src/lib/catering-order-modal/catering-item-list-item.component.ts","./libs/catering/src/lib/catering-order-modal/catering-item-list.component.ts","./libs/catering/src/lib/catering-order-modal/catering-item-details.component.ts","./libs/catering/src/lib/catering-order-modal/catering-item-filters.component.ts","./libs/catering/src/lib/catering-order-modal/new-catering-order-modal.component.ts","./libs/catering/src/lib/catering-list-field.component.ts","./libs/catering/src/lib/catering-rooms-state-modal.component.ts","./libs/catering/src/lib/charge-code-list-modal.component.ts","./libs/catering/src/lib/catering.module.ts","./apps/workplace/src/app/book/book.component.ts","./node_modules/qr-scanner/qr-scanner.min.js","./apps/workplace/src/app/book/code-flow.component.ts","./apps/workplace/src/app/book/desk-flow/detailed-form.component.ts","./apps/workplace/src/app/book/desk-flow/form.component.ts","./apps/workplace/src/app/book/desk-flow/map.component.ts","./apps/workplace/src/app/book/desk-flow/confirm.component.ts","./apps/workplace/src/app/book/flow-success.component.ts","./apps/workplace/src/app/book/desk-flow.component.ts","./apps/workplace/src/app/book/space-flow/detailed-form.component.ts","./apps/workplace/src/app/book/space-flow/form.component.ts","./apps/workplace/src/app/book/space-flow/find-item.component.ts","./apps/workplace/src/app/book/space-flow/find.component.ts","./apps/workplace/src/app/book/space-flow/confirm.component.ts","./apps/workplace/src/app/book/space-flow.component.ts","./apps/workplace/src/app/book/parking-flow/parking-flow-map.component.ts","./apps/workplace/src/app/book/parking-flow/parking-flow-confirm.component.ts","./apps/workplace/src/app/book/parking-flow.component.ts","./apps/workplace/src/app/book/meeting-flow/meeting-flow-confirm-modal.component.ts","./apps/workplace/src/app/book/meeting-flow/meeting-flow-confirm.component.ts","./apps/workplace/src/app/book/meeting-flow/meeting-form-details.component.ts","./apps/workplace/src/app/book/meeting-flow/meeting-flow-form.component.ts","./apps/workplace/src/app/book/meeting-flow/meeting-flow-success.component.ts","./apps/workplace/src/app/book/meeting-flow.component.ts","./apps/workplace/src/app/book/new-desk-flow/new-desk-flow-confirm.component.ts","./apps/workplace/src/app/book/new-desk-flow/new-desk-form-details.component.ts","./apps/workplace/src/app/book/new-desk-flow/new-desk-flow-form.component.ts","./apps/workplace/src/app/book/new-desk-flow/new-desk-flow-success.component.ts","./apps/workplace/src/app/book/new-desk-flow.component.ts","./apps/workplace/src/app/book/visitor-flow.component.ts","./apps/workplace/src/app/book/new-parking-flow/parking-flow-confirm.component.ts","./apps/workplace/src/app/book/new-parking-flow/parking-form-details.component.ts","./apps/workplace/src/app/book/new-parking-flow/parking-flow-form.component.ts","./apps/workplace/src/app/book/new-parking-flow/parking-flow-success.component.ts","./apps/workplace/src/app/book/new-parking-flow.component.ts","./apps/workplace/src/app/book/code-flow-success.component.ts","./apps/workplace/src/app/book/code-flow-error.component.ts","./apps/workplace/src/app/book/book.module.ts"],"sourcesContent":["import * as i1 from '@angular/cdk/a11y';\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\nimport { SelectionModel } from '@angular/cdk/collections';\nimport * as i0 from '@angular/core';\nimport { InjectionToken, forwardRef, EventEmitter, Directive, Optional, Inject, ContentChildren, Input, Output, Component, ViewEncapsulation, ChangeDetectionStrategy, Attribute, ViewChild, NgModule } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport * as i2 from '@angular/material/core';\nimport { mixinDisableRipple, MatCommonModule, MatRippleModule } from '@angular/material/core';\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * Injection token that can be used to configure the\n * default options for all button toggles within an app.\n */\nconst MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS = new InjectionToken('MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS');\n/**\n * Injection token that can be used to reference instances of `MatButtonToggleGroup`.\n * It serves as alternative token to the actual `MatButtonToggleGroup` class which\n * could cause unnecessary retention of the class and its component metadata.\n */\nconst MAT_BUTTON_TOGGLE_GROUP = new InjectionToken('MatButtonToggleGroup');\n/**\n * Provider Expression that allows mat-button-toggle-group to register as a ControlValueAccessor.\n * This allows it to support [(ngModel)].\n * @docs-private\n */\nconst MAT_BUTTON_TOGGLE_GROUP_VALUE_ACCESSOR = {\n    provide: NG_VALUE_ACCESSOR,\n    useExisting: forwardRef(() => MatButtonToggleGroup),\n    multi: true,\n};\n// Counter used to generate unique IDs.\nlet uniqueIdCounter = 0;\n/** Change event object emitted by button toggle. */\nclass MatButtonToggleChange {\n    constructor(\n    /** The button toggle that emits the event. */\n    source, \n    /** The value assigned to the button toggle. */\n    value) {\n        this.source = source;\n        this.value = value;\n    }\n}\n/** Exclusive selection button toggle group that behaves like a radio-button group. */\nclass MatButtonToggleGroup {\n    /** `name` attribute for the underlying `input` element. */\n    get name() {\n        return this._name;\n    }\n    set name(value) {\n        this._name = value;\n        this._markButtonsForCheck();\n    }\n    /** Whether the toggle group is vertical. */\n    get vertical() {\n        return this._vertical;\n    }\n    set vertical(value) {\n        this._vertical = coerceBooleanProperty(value);\n    }\n    /** Value of the toggle group. */\n    get value() {\n        const selected = this._selectionModel ? this._selectionModel.selected : [];\n        if (this.multiple) {\n            return selected.map(toggle => toggle.value);\n        }\n        return selected[0] ? selected[0].value : undefined;\n    }\n    set value(newValue) {\n        this._setSelectionByValue(newValue);\n        this.valueChange.emit(this.value);\n    }\n    /** Selected button toggles in the group. */\n    get selected() {\n        const selected = this._selectionModel ? this._selectionModel.selected : [];\n        return this.multiple ? selected : selected[0] || null;\n    }\n    /** Whether multiple button toggles can be selected. */\n    get multiple() {\n        return this._multiple;\n    }\n    set multiple(value) {\n        this._multiple = coerceBooleanProperty(value);\n        this._markButtonsForCheck();\n    }\n    /** Whether multiple button toggle group is disabled. */\n    get disabled() {\n        return this._disabled;\n    }\n    set disabled(value) {\n        this._disabled = coerceBooleanProperty(value);\n        this._markButtonsForCheck();\n    }\n    constructor(_changeDetector, defaultOptions) {\n        this._changeDetector = _changeDetector;\n        this._vertical = false;\n        this._multiple = false;\n        this._disabled = false;\n        /**\n         * The method to be called in order to update ngModel.\n         * Now `ngModel` binding is not supported in multiple selection mode.\n         */\n        this._controlValueAccessorChangeFn = () => { };\n        /** onTouch function registered via registerOnTouch (ControlValueAccessor). */\n        this._onTouched = () => { };\n        this._name = `mat-button-toggle-group-${uniqueIdCounter++}`;\n        /**\n         * Event that emits whenever the value of the group changes.\n         * Used to facilitate two-way data binding.\n         * @docs-private\n         */\n        this.valueChange = new EventEmitter();\n        /** Event emitted when the group's value changes. */\n        this.change = new EventEmitter();\n        this.appearance =\n            defaultOptions && defaultOptions.appearance ? defaultOptions.appearance : 'standard';\n    }\n    ngOnInit() {\n        this._selectionModel = new SelectionModel(this.multiple, undefined, false);\n    }\n    ngAfterContentInit() {\n        this._selectionModel.select(...this._buttonToggles.filter(toggle => toggle.checked));\n    }\n    /**\n     * Sets the model value. Implemented as part of ControlValueAccessor.\n     * @param value Value to be set to the model.\n     */\n    writeValue(value) {\n        this.value = value;\n        this._changeDetector.markForCheck();\n    }\n    // Implemented as part of ControlValueAccessor.\n    registerOnChange(fn) {\n        this._controlValueAccessorChangeFn = fn;\n    }\n    // Implemented as part of ControlValueAccessor.\n    registerOnTouched(fn) {\n        this._onTouched = fn;\n    }\n    // Implemented as part of ControlValueAccessor.\n    setDisabledState(isDisabled) {\n        this.disabled = isDisabled;\n    }\n    /** Dispatch change event with current selection and group value. */\n    _emitChangeEvent(toggle) {\n        const event = new MatButtonToggleChange(toggle, this.value);\n        this._controlValueAccessorChangeFn(event.value);\n        this.change.emit(event);\n    }\n    /**\n     * Syncs a button toggle's selected state with the model value.\n     * @param toggle Toggle to be synced.\n     * @param select Whether the toggle should be selected.\n     * @param isUserInput Whether the change was a result of a user interaction.\n     * @param deferEvents Whether to defer emitting the change events.\n     */\n    _syncButtonToggle(toggle, select, isUserInput = false, deferEvents = false) {\n        // Deselect the currently-selected toggle, if we're in single-selection\n        // mode and the button being toggled isn't selected at the moment.\n        if (!this.multiple && this.selected && !toggle.checked) {\n            this.selected.checked = false;\n        }\n        if (this._selectionModel) {\n            if (select) {\n                this._selectionModel.select(toggle);\n            }\n            else {\n                this._selectionModel.deselect(toggle);\n            }\n        }\n        else {\n            deferEvents = true;\n        }\n        // We need to defer in some cases in order to avoid \"changed after checked errors\", however\n        // the side-effect is that we may end up updating the model value out of sequence in others\n        // The `deferEvents` flag allows us to decide whether to do it on a case-by-case basis.\n        if (deferEvents) {\n            Promise.resolve().then(() => this._updateModelValue(toggle, isUserInput));\n        }\n        else {\n            this._updateModelValue(toggle, isUserInput);\n        }\n    }\n    /** Checks whether a button toggle is selected. */\n    _isSelected(toggle) {\n        return this._selectionModel && this._selectionModel.isSelected(toggle);\n    }\n    /** Determines whether a button toggle should be checked on init. */\n    _isPrechecked(toggle) {\n        if (typeof this._rawValue === 'undefined') {\n            return false;\n        }\n        if (this.multiple && Array.isArray(this._rawValue)) {\n            return this._rawValue.some(value => toggle.value != null && value === toggle.value);\n        }\n        return toggle.value === this._rawValue;\n    }\n    /** Updates the selection state of the toggles in the group based on a value. */\n    _setSelectionByValue(value) {\n        this._rawValue = value;\n        if (!this._buttonToggles) {\n            return;\n        }\n        if (this.multiple && value) {\n            if (!Array.isArray(value) && (typeof ngDevMode === 'undefined' || ngDevMode)) {\n                throw Error('Value must be an array in multiple-selection mode.');\n            }\n            this._clearSelection();\n            value.forEach((currentValue) => this._selectValue(currentValue));\n        }\n        else {\n            this._clearSelection();\n            this._selectValue(value);\n        }\n    }\n    /** Clears the selected toggles. */\n    _clearSelection() {\n        this._selectionModel.clear();\n        this._buttonToggles.forEach(toggle => (toggle.checked = false));\n    }\n    /** Selects a value if there's a toggle that corresponds to it. */\n    _selectValue(value) {\n        const correspondingOption = this._buttonToggles.find(toggle => {\n            return toggle.value != null && toggle.value === value;\n        });\n        if (correspondingOption) {\n            correspondingOption.checked = true;\n            this._selectionModel.select(correspondingOption);\n        }\n    }\n    /** Syncs up the group's value with the model and emits the change event. */\n    _updateModelValue(toggle, isUserInput) {\n        // Only emit the change event for user input.\n        if (isUserInput) {\n            this._emitChangeEvent(toggle);\n        }\n        // Note: we emit this one no matter whether it was a user interaction, because\n        // it is used by Angular to sync up the two-way data binding.\n        this.valueChange.emit(this.value);\n    }\n    /** Marks all of the child button toggles to be checked. */\n    _markButtonsForCheck() {\n        this._buttonToggles?.forEach(toggle => toggle._markForCheck());\n    }\n}\nMatButtonToggleGroup.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"15.2.0-rc.0\", ngImport: i0, type: MatButtonToggleGroup, deps: [{ token: i0.ChangeDetectorRef }, { token: MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS, optional: true }], target: i0.ɵɵFactoryTarget.Directive });\nMatButtonToggleGroup.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: \"14.0.0\", version: \"15.2.0-rc.0\", type: MatButtonToggleGroup, selector: \"mat-button-toggle-group\", inputs: { appearance: \"appearance\", name: \"name\", vertical: \"vertical\", value: \"value\", multiple: \"multiple\", disabled: \"disabled\" }, outputs: { valueChange: \"valueChange\", change: \"change\" }, host: { attributes: { \"role\": \"group\" }, properties: { \"attr.aria-disabled\": \"disabled\", \"class.mat-button-toggle-vertical\": \"vertical\", \"class.mat-button-toggle-group-appearance-standard\": \"appearance === \\\"standard\\\"\" }, classAttribute: \"mat-button-toggle-group\" }, providers: [\n        MAT_BUTTON_TOGGLE_GROUP_VALUE_ACCESSOR,\n        { provide: MAT_BUTTON_TOGGLE_GROUP, useExisting: MatButtonToggleGroup },\n    ], queries: [{ propertyName: \"_buttonToggles\", predicate: i0.forwardRef(function () { return MatButtonToggle; }), descendants: true }], exportAs: [\"matButtonToggleGroup\"], ngImport: i0 });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"15.2.0-rc.0\", ngImport: i0, type: MatButtonToggleGroup, decorators: [{\n            type: Directive,\n            args: [{\n                    selector: 'mat-button-toggle-group',\n                    providers: [\n                        MAT_BUTTON_TOGGLE_GROUP_VALUE_ACCESSOR,\n                        { provide: MAT_BUTTON_TOGGLE_GROUP, useExisting: MatButtonToggleGroup },\n                    ],\n                    host: {\n                        'role': 'group',\n                        'class': 'mat-button-toggle-group',\n                        '[attr.aria-disabled]': 'disabled',\n                        '[class.mat-button-toggle-vertical]': 'vertical',\n                        '[class.mat-button-toggle-group-appearance-standard]': 'appearance === \"standard\"',\n                    },\n                    exportAs: 'matButtonToggleGroup',\n                }]\n        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: undefined, decorators: [{\n                    type: Optional\n                }, {\n                    type: Inject,\n                    args: [MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS]\n                }] }]; }, propDecorators: { _buttonToggles: [{\n                type: ContentChildren,\n                args: [forwardRef(() => MatButtonToggle), {\n                        // Note that this would technically pick up toggles\n                        // from nested groups, but that's not a case that we support.\n                        descendants: true,\n                    }]\n            }], appearance: [{\n                type: Input\n            }], name: [{\n                type: Input\n            }], vertical: [{\n                type: Input\n            }], value: [{\n                type: Input\n            }], valueChange: [{\n                type: Output\n            }], multiple: [{\n                type: Input\n            }], disabled: [{\n                type: Input\n            }], change: [{\n                type: Output\n            }] } });\n// Boilerplate for applying mixins to the MatButtonToggle class.\n/** @docs-private */\nconst _MatButtonToggleBase = mixinDisableRipple(class {\n});\n/** Single button inside of a toggle group. */\nclass MatButtonToggle extends _MatButtonToggleBase {\n    /** Unique ID for the underlying `button` element. */\n    get buttonId() {\n        return `${this.id}-button`;\n    }\n    /** The appearance style of the button. */\n    get appearance() {\n        return this.buttonToggleGroup ? this.buttonToggleGroup.appearance : this._appearance;\n    }\n    set appearance(value) {\n        this._appearance = value;\n    }\n    /** Whether the button is checked. */\n    get checked() {\n        return this.buttonToggleGroup ? this.buttonToggleGroup._isSelected(this) : this._checked;\n    }\n    set checked(value) {\n        const newValue = coerceBooleanProperty(value);\n        if (newValue !== this._checked) {\n            this._checked = newValue;\n            if (this.buttonToggleGroup) {\n                this.buttonToggleGroup._syncButtonToggle(this, this._checked);\n            }\n            this._changeDetectorRef.markForCheck();\n        }\n    }\n    /** Whether the button is disabled. */\n    get disabled() {\n        return this._disabled || (this.buttonToggleGroup && this.buttonToggleGroup.disabled);\n    }\n    set disabled(value) {\n        this._disabled = coerceBooleanProperty(value);\n    }\n    constructor(toggleGroup, _changeDetectorRef, _elementRef, _focusMonitor, defaultTabIndex, defaultOptions) {\n        super();\n        this._changeDetectorRef = _changeDetectorRef;\n        this._elementRef = _elementRef;\n        this._focusMonitor = _focusMonitor;\n        this._checked = false;\n        /**\n         * Users can specify the `aria-labelledby` attribute which will be forwarded to the input element\n         */\n        this.ariaLabelledby = null;\n        this._disabled = false;\n        /** Event emitted when the group value changes. */\n        this.change = new EventEmitter();\n        const parsedTabIndex = Number(defaultTabIndex);\n        this.tabIndex = parsedTabIndex || parsedTabIndex === 0 ? parsedTabIndex : null;\n        this.buttonToggleGroup = toggleGroup;\n        this.appearance =\n            defaultOptions && defaultOptions.appearance ? defaultOptions.appearance : 'standard';\n    }\n    ngOnInit() {\n        const group = this.buttonToggleGroup;\n        this.id = this.id || `mat-button-toggle-${uniqueIdCounter++}`;\n        if (group) {\n            if (group._isPrechecked(this)) {\n                this.checked = true;\n            }\n            else if (group._isSelected(this) !== this._checked) {\n                // As as side effect of the circular dependency between the toggle group and the button,\n                // we may end up in a state where the button is supposed to be checked on init, but it\n                // isn't, because the checked value was assigned too early. This can happen when Ivy\n                // assigns the static input value before the `ngOnInit` has run.\n                group._syncButtonToggle(this, this._checked);\n            }\n        }\n    }\n    ngAfterViewInit() {\n        this._focusMonitor.monitor(this._elementRef, true);\n    }\n    ngOnDestroy() {\n        const group = this.buttonToggleGroup;\n        this._focusMonitor.stopMonitoring(this._elementRef);\n        // Remove the toggle from the selection once it's destroyed. Needs to happen\n        // on the next tick in order to avoid \"changed after checked\" errors.\n        if (group && group._isSelected(this)) {\n            group._syncButtonToggle(this, false, false, true);\n        }\n    }\n    /** Focuses the button. */\n    focus(options) {\n        this._buttonElement.nativeElement.focus(options);\n    }\n    /** Checks the button toggle due to an interaction with the underlying native button. */\n    _onButtonClick() {\n        const newChecked = this._isSingleSelector() ? true : !this._checked;\n        if (newChecked !== this._checked) {\n            this._checked = newChecked;\n            if (this.buttonToggleGroup) {\n                this.buttonToggleGroup._syncButtonToggle(this, this._checked, true);\n                this.buttonToggleGroup._onTouched();\n            }\n        }\n        // Emit a change event when it's the single selector\n        this.change.emit(new MatButtonToggleChange(this, this.value));\n    }\n    /**\n     * Marks the button toggle as needing checking for change detection.\n     * This method is exposed because the parent button toggle group will directly\n     * update bound properties of the radio button.\n     */\n    _markForCheck() {\n        // When the group value changes, the button will not be notified.\n        // Use `markForCheck` to explicit update button toggle's status.\n        this._changeDetectorRef.markForCheck();\n    }\n    /** Gets the name that should be assigned to the inner DOM node. */\n    _getButtonName() {\n        if (this._isSingleSelector()) {\n            return this.buttonToggleGroup.name;\n        }\n        return this.name || null;\n    }\n    /** Whether the toggle is in single selection mode. */\n    _isSingleSelector() {\n        return this.buttonToggleGroup && !this.buttonToggleGroup.multiple;\n    }\n}\nMatButtonToggle.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"15.2.0-rc.0\", ngImport: i0, type: MatButtonToggle, deps: [{ token: MAT_BUTTON_TOGGLE_GROUP, optional: true }, { token: i0.ChangeDetectorRef }, { token: i0.ElementRef }, { token: i1.FocusMonitor }, { token: 'tabindex', attribute: true }, { token: MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS, optional: true }], target: i0.ɵɵFactoryTarget.Component });\nMatButtonToggle.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: \"14.0.0\", version: \"15.2.0-rc.0\", type: MatButtonToggle, selector: \"mat-button-toggle\", inputs: { disableRipple: \"disableRipple\", ariaLabel: [\"aria-label\", \"ariaLabel\"], ariaLabelledby: [\"aria-labelledby\", \"ariaLabelledby\"], id: \"id\", name: \"name\", value: \"value\", tabIndex: \"tabIndex\", appearance: \"appearance\", checked: \"checked\", disabled: \"disabled\" }, outputs: { change: \"change\" }, host: { attributes: { \"role\": \"presentation\" }, listeners: { \"focus\": \"focus()\" }, properties: { \"class.mat-button-toggle-standalone\": \"!buttonToggleGroup\", \"class.mat-button-toggle-checked\": \"checked\", \"class.mat-button-toggle-disabled\": \"disabled\", \"class.mat-button-toggle-appearance-standard\": \"appearance === \\\"standard\\\"\", \"attr.aria-label\": \"null\", \"attr.aria-labelledby\": \"null\", \"attr.id\": \"id\", \"attr.name\": \"null\" }, classAttribute: \"mat-button-toggle\" }, viewQueries: [{ propertyName: \"_buttonElement\", first: true, predicate: [\"button\"], descendants: true }], exportAs: [\"matButtonToggle\"], usesInheritance: true, ngImport: i0, template: \"<button #button class=\\\"mat-button-toggle-button mat-focus-indicator\\\"\\n        type=\\\"button\\\"\\n        [id]=\\\"buttonId\\\"\\n        [attr.tabindex]=\\\"disabled ? -1 : tabIndex\\\"\\n        [attr.aria-pressed]=\\\"checked\\\"\\n        [disabled]=\\\"disabled || null\\\"\\n        [attr.name]=\\\"_getButtonName()\\\"\\n        [attr.aria-label]=\\\"ariaLabel\\\"\\n        [attr.aria-labelledby]=\\\"ariaLabelledby\\\"\\n        (click)=\\\"_onButtonClick()\\\">\\n  <span class=\\\"mat-button-toggle-label-content\\\">\\n    <ng-content></ng-content>\\n  </span>\\n</button>\\n\\n<span class=\\\"mat-button-toggle-focus-overlay\\\"></span>\\n<span class=\\\"mat-button-toggle-ripple\\\" matRipple\\n     [matRippleTrigger]=\\\"button\\\"\\n     [matRippleDisabled]=\\\"this.disableRipple || this.disabled\\\">\\n</span>\\n\", styles: [\".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 36px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}\"], dependencies: [{ kind: \"directive\", type: i2.MatRipple, selector: \"[mat-ripple], [matRipple]\", inputs: [\"matRippleColor\", \"matRippleUnbounded\", \"matRippleCentered\", \"matRippleRadius\", \"matRippleAnimation\", \"matRippleDisabled\", \"matRippleTrigger\"], exportAs: [\"matRipple\"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"15.2.0-rc.0\", ngImport: i0, type: MatButtonToggle, decorators: [{\n            type: Component,\n            args: [{ selector: 'mat-button-toggle', encapsulation: ViewEncapsulation.None, exportAs: 'matButtonToggle', changeDetection: ChangeDetectionStrategy.OnPush, inputs: ['disableRipple'], host: {\n                        '[class.mat-button-toggle-standalone]': '!buttonToggleGroup',\n                        '[class.mat-button-toggle-checked]': 'checked',\n                        '[class.mat-button-toggle-disabled]': 'disabled',\n                        '[class.mat-button-toggle-appearance-standard]': 'appearance === \"standard\"',\n                        'class': 'mat-button-toggle',\n                        '[attr.aria-label]': 'null',\n                        '[attr.aria-labelledby]': 'null',\n                        '[attr.id]': 'id',\n                        '[attr.name]': 'null',\n                        '(focus)': 'focus()',\n                        'role': 'presentation',\n                    }, template: \"<button #button class=\\\"mat-button-toggle-button mat-focus-indicator\\\"\\n        type=\\\"button\\\"\\n        [id]=\\\"buttonId\\\"\\n        [attr.tabindex]=\\\"disabled ? -1 : tabIndex\\\"\\n        [attr.aria-pressed]=\\\"checked\\\"\\n        [disabled]=\\\"disabled || null\\\"\\n        [attr.name]=\\\"_getButtonName()\\\"\\n        [attr.aria-label]=\\\"ariaLabel\\\"\\n        [attr.aria-labelledby]=\\\"ariaLabelledby\\\"\\n        (click)=\\\"_onButtonClick()\\\">\\n  <span class=\\\"mat-button-toggle-label-content\\\">\\n    <ng-content></ng-content>\\n  </span>\\n</button>\\n\\n<span class=\\\"mat-button-toggle-focus-overlay\\\"></span>\\n<span class=\\\"mat-button-toggle-ripple\\\" matRipple\\n     [matRippleTrigger]=\\\"button\\\"\\n     [matRippleDisabled]=\\\"this.disableRipple || this.disabled\\\">\\n</span>\\n\", styles: [\".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 36px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}\"] }]\n        }], ctorParameters: function () { return [{ type: MatButtonToggleGroup, decorators: [{\n                    type: Optional\n                }, {\n                    type: Inject,\n                    args: [MAT_BUTTON_TOGGLE_GROUP]\n                }] }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i1.FocusMonitor }, { type: undefined, decorators: [{\n                    type: Attribute,\n                    args: ['tabindex']\n                }] }, { type: undefined, decorators: [{\n                    type: Optional\n                }, {\n                    type: Inject,\n                    args: [MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS]\n                }] }]; }, propDecorators: { ariaLabel: [{\n                type: Input,\n                args: ['aria-label']\n            }], ariaLabelledby: [{\n                type: Input,\n                args: ['aria-labelledby']\n            }], _buttonElement: [{\n                type: ViewChild,\n                args: ['button']\n            }], id: [{\n                type: Input\n            }], name: [{\n                type: Input\n            }], value: [{\n                type: Input\n            }], tabIndex: [{\n                type: Input\n            }], appearance: [{\n                type: Input\n            }], checked: [{\n                type: Input\n            }], disabled: [{\n                type: Input\n            }], change: [{\n                type: Output\n            }] } });\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nclass MatButtonToggleModule {\n}\nMatButtonToggleModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"15.2.0-rc.0\", ngImport: i0, type: MatButtonToggleModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nMatButtonToggleModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"14.0.0\", version: \"15.2.0-rc.0\", ngImport: i0, type: MatButtonToggleModule, declarations: [MatButtonToggleGroup, MatButtonToggle], imports: [MatCommonModule, MatRippleModule], exports: [MatCommonModule, MatButtonToggleGroup, MatButtonToggle] });\nMatButtonToggleModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"15.2.0-rc.0\", ngImport: i0, type: MatButtonToggleModule, imports: [MatCommonModule, MatRippleModule, MatCommonModule] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"15.2.0-rc.0\", ngImport: i0, type: MatButtonToggleModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: [MatCommonModule, MatRippleModule],\n                    exports: [MatCommonModule, MatButtonToggleGroup, MatButtonToggle],\n                    declarations: [MatButtonToggleGroup, MatButtonToggle],\n                }]\n        }] });\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS, MAT_BUTTON_TOGGLE_GROUP, MAT_BUTTON_TOGGLE_GROUP_VALUE_ACCESSOR, MatButtonToggle, MatButtonToggleChange, MatButtonToggleGroup, MatButtonToggleModule };\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { Asset } from '../asset.class';\n\n@Component({\n    selector: 'asset-details',\n    template: `\n        <ng-container *ngIf=\"item; else empty_state\">\n            <section image class=\"relative w-full h-64 sm:h-40 bg-black/20\">\n                <image-carousel\n                    [images]=\"images\"\n                    class=\"absolute inset-0\"\n                ></image-carousel>\n                <button\n                    icon\n                    matRipple\n                    close\n                    (click)=\"close.emit()\"\n                    class=\"absolute top-2 left-2 bg-black/40 sm:hidden text-white\"\n                >\n                    <app-icon>arrow_back</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    fav\n                    [class.text-white]=\"!fav\"\n                    [class.text-blue-400]=\"fav\"\n                    (click)=\"toggleFav.emit()\"\n                    class=\"absolute top-2 right-2 bg-black/40\"\n                >\n                    <app-icon>{{\n                        fav ? 'favorite' : 'favorite_border'\n                    }}</app-icon>\n                </button>\n            </section>\n            <div class=\"p-2 space-y-2 flex-1 h-1/2 overflow-auto\">\n                <section actions class=\"z-0 flex items-center justify-between\">\n                    <div>\n                        <h2 class=\"text-xl font-medium mb-2 mt-4\">\n                            {{ item.name }}\n                        </h2>\n                        <p>{{ item.count }} Available</p>\n                    </div>\n                    <a-counter\n                        [(ngModel)]=\"item.amount\"\n                        [min]=\"1\"\n                        [max]=\"item.count || 2\"\n                    ></a-counter>\n                </section>\n                <hr />\n                <section details class=\"space-y-2\">\n                    <h2 class=\"text-xl font-medium\">Details</h2>\n                    <div class=\"flex items-center space-x-2\">\n                        <p>{{ item.description || 'No description' }}</p>\n                    </div>\n                </section>\n            </div>\n            <div class=\"p-2 border-t border-gray-200 shadow sm:hidden\">\n                <button\n                    btn\n                    matRipple\n                    select\n                    [class.inverse]=\"active\"\n                    class=\"w-full\"\n                    (click)=\"active = !active; activeChange.emit(active)\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        <app-icon class=\"text-2xl\">{{\n                            active ? 'remove' : 'add'\n                        }}</app-icon>\n                        <p>\n                            {{\n                                active ? 'Remove this asset' : 'Add this asset'\n                            }}\n                        </p>\n                    </div>\n                </button>\n            </div>\n        </ng-container>\n        <ng-template #empty_state>\n            <div\n                empty\n                class=\"p-16 flex flex-col items-center justify-center space-y-2\"\n            >\n                <p class=\"opacity-30 text-center\">\n                    Select an asset to view it's details\n                </p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                width: 30%;\n                min-width: 20rem;\n                height: 100%;\n                min-height: 65vh;\n            }\n        `,\n    ],\n})\nexport class AssetDetailsComponent {\n    @Input() public item?: Asset;\n    @Input() public active: boolean = false;\n    @Input() public fav: boolean = false;\n\n    @Output() public toggleFav = new EventEmitter<void>();\n    @Output() public activeChange = new EventEmitter<boolean>();\n    @Output() public close = new EventEmitter<void>();\n\n    public get images() {\n        return this.item?.images.map((_) => _.url) || [];\n    }\n}\n","import { Component } from \"@angular/core\";\n\n@Component({\n    selector: 'asset-filters',\n    template: ``,\n    styles: [``]\n})\nexport class AssetFiltersComponent {\n    \n}\n","import { Component } from \"@angular/core\";\n\n@Component({\n    selector: 'asset-filters-display',\n    template: ``,\n    styles: [``]\n})\nexport class AssetFiltersDisplayComponent {\n    \n}\n","export interface AssetResource {\n    id?: string;\n    name: string;\n    url: string;\n    price?: number;\n}\n\nexport interface AssetDetail {\n    id: string;\n    name: string;\n}\n\nexport interface AssetPurchase {\n    id?: string;\n    name: string;\n    value: string;\n}\n\nexport class Asset {\n    public readonly id: string;\n    public readonly name: string;\n    public readonly category: string;\n    public readonly images: AssetResource[];\n    public readonly barcode: string;\n    public readonly brand: string;\n    public readonly size: 'Small' | 'Medium' | 'Large';\n    public readonly description: string;\n    public readonly specifications: Record<string, string>;\n    public readonly purchase_date: number;\n    public readonly purchase_price: number;\n    public readonly purchase_details: AssetPurchase[];\n    public readonly consumables: AssetDetail[];\n    public readonly general_details: AssetDetail[];\n    public readonly invoices: AssetResource[];\n    public readonly quantity: number;\n    public readonly locations: [string, string][];\n    public in_use = 1;\n    public other_data: Record<string, any> = {};\n\n    constructor(_data: Partial<Asset> = {}) {\n        this.id = _data.id || '';\n        this.name = _data.name || '';\n        this.category = _data.category || '';\n        this.images = _data.images || [];\n        this.barcode = _data.barcode || '';\n        this.brand = _data.brand || '';\n        this.size = _data.size || 'Small';\n        this.description = _data.description || '';\n        this.specifications = _data.specifications || {};\n        this.purchase_date = _data.purchase_date * 1000 || Date.now();\n        this.purchase_price = _data.purchase_price || 0;\n        this.purchase_details = _data.purchase_details || [];\n        this.consumables = _data.consumables || [];\n        this.general_details = _data.general_details || [];\n        this.invoices = _data.invoices || [];\n        this.quantity = _data.quantity ?? 0;\n        this.locations = _data.locations || [];\n        this.in_use = _data.in_use ?? 1;\n        for (const key in _data.other_data) {\n            if (key in this) {\n                this[key] = _data.other_data[key];\n            }\n        }\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, combineLatest, of } from 'rxjs';\nimport { debounceTime, map, shareReplay, switchMap, tap } from 'rxjs/operators';\nimport { queryAssets } from './assets.fn';\nimport { queryBookings } from 'libs/bookings/src/lib/bookings.fn';\nimport { endOfDay, getUnixTime, startOfDay } from 'date-fns';\n\nexport interface AssetOptions {\n    zone?: string;\n    date: number;\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class AssetStateService {\n    private _options = new BehaviorSubject<AssetOptions>({ date: Date.now() });\n    private _search = new BehaviorSubject<string>('');\n    private _loading = new BehaviorSubject<string>('');\n\n    public readonly search = this._search.asObservable();\n    public readonly loading = this._loading.asObservable();\n\n    public readonly asset_list = of(0).pipe(\n        switchMap(() => {\n            this._loading.next(this._loading.getValue() + '[Assets]');\n            return queryAssets();\n        }),\n        tap((_) =>\n            this._loading.next(\n                this._loading.getValue().replace(/\\[Assets\\]/g, '')\n            )\n        ),\n        shareReplay(1)\n    );\n\n    public readonly asset_bookings = this._options.pipe(\n        debounceTime(300),\n        switchMap(({ zone, date }) => {\n            this._loading.next(this._loading.getValue() + '[Bookings]');\n            return queryBookings({\n                zones: zone || '',\n                period_start: getUnixTime(startOfDay(date)),\n                period_end: getUnixTime(endOfDay(date)),\n                type: 'asset-request',\n            });\n        }),\n        tap((_) =>\n            this._loading.next(\n                this._loading.getValue().replace(/\\[Bookings\\]/g, '')\n            )\n        ),\n        shareReplay(1)\n    );\n\n    public readonly available_assets = combineLatest([\n        this.asset_list,\n        this.asset_bookings,\n    ]).pipe(\n        map(([list, bookings]) =>\n            list\n                .filter((_) => !bookings.find((b) => b.asset_id === _.id))\n                .sort(\n                    (a, b) =>\n                        a.category.localeCompare(b.category) ||\n                        a.name.localeCompare(b.name)\n                )\n        ),\n        shareReplay(1)\n    );\n\n    public readonly filtered_assets = combineLatest([\n        this._search,\n        this.available_assets,\n    ]).pipe(\n        map(([search, assets]) => {\n            const s = search.toLowerCase();\n            return assets.filter(\n                (_) =>\n                    _.name.toLowerCase().includes(s) ||\n                    _.description.toLowerCase().includes(s)\n            );\n        }),\n        shareReplay(1)\n    );\n\n    public setSearch(value: string) {\n        this._search.next(`${value}`);\n    }\n\n    public setOptions(options: Partial<AssetOptions>) {\n        this._options.next({ ...this._options.value, ...options });\n    }\n}\n","import { cleanObject, del, get, post, put } from '@placeos/ts-client';\nimport { toQueryString } from 'libs/common/src/lib/api';\nimport { catchError, map } from 'rxjs/operators';\nimport { Asset } from './asset.class';\nimport { Observable, of } from 'rxjs';\nimport { getUnixTime } from 'date-fns';\n\nconst ASSET_ENDPOINT = '/api/engine/v2/assets';\n\n/**\n * Query the list of available assets\n * @param q Filter the list based of the give string\n */\nexport function queryAssets(q?: string): Observable<Asset[]> {\n    const query = toQueryString({ q });\n    return get(`${ASSET_ENDPOINT}${query ? query : ''}`).pipe(\n        map((_: any) => _.map((d: any) => new Asset(d))),\n        catchError((_) => of([]))\n    );\n}\n\n/**\n * Delete asset with the given ID\n * @param id ID of asset to delete\n */\nexport function deleteAsset(id: string) {\n    return del(`${ASSET_ENDPOINT}/${id}`);\n}\n\n/**\n * Add asset to database with given details\n * @param asset Asset details\n */\nexport function createAsset(asset: Asset): Observable<Asset> {\n    const data = cleanObject(asset, [undefined, null, '']);\n    data.purchase_date = getUnixTime(data.purchase_date);\n    return post(`${ASSET_ENDPOINT}`, data).pipe(map((_) => new Asset(_)));\n}\n\n/**\n * Update asset in database to the new details\n * @param id ID of the asset to update\n * @param asset New details for asset\n */\nexport function updateAsset(id: string, asset: Asset) {\n    return put(`${ASSET_ENDPOINT}/${id}`, asset).pipe(map((_) => new Asset(_)));\n}\n\n/**\n * Save the details for the given asset in the database\n * @param asset Asset details\n */\nexport function saveAsset(asset: Asset) {\n    return asset.id ? updateAsset(asset.id, asset) : createAsset(asset);\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { AssetStateService } from '../asset-state.service';\nimport { Asset } from '../asset.class';\n\n@Component({\n    selector: 'asset-list',\n    template: `\n        <div\n            class=\"w-full h-full overflow-auto py-2 bg-black/5 dark:bg-white/10 dark:border-neutral-500\"\n        >\n            <h3 class=\"font-bold px-2\">Results</h3>\n            <p count class=\"text-sm opacity-60 mb-4 px-2\">\n                {{ (assets | async)?.length || 0 }} result(s) found\n            </p>\n            <ng-container *ngIf=\"!(loading | async); else load_state\">\n                <ul\n                    class=\"list-style-none space-y-2 p-2\"\n                    *ngIf=\"(assets | async)?.length; else empty_state\"\n                >\n                    <li\n                        asset\n                        *ngFor=\"let asset of assets | async\"\n                        class=\"relative p-2 rounded-lg w-full shadow border bg-white dark:bg-neutral-700 border-gray-200 dark:border-neutral-500\"\n                    >\n                        <button\n                            matRipple\n                            select\n                            class=\"w-full h-full flex items-center pr-10\"\n                            (click)=\"selectAsset(asset)\"\n                        >\n                            <div\n                                class=\"relative w-16 h-16 rounded-xl bg-black/20 mr-4\"\n                            >\n                                <div\n                                    class=\"absolute top-1 left-1 border border-white bg-black/50 rounded-full h-6 w-6 flex items-center justify-center text-white\"\n                                    *ngIf=\"selected.includes(asset.id)\"\n                                >\n                                    <span class=\"text-xs\">{{\n                                        asset.amount || 1\n                                    }}</span>\n                                </div>\n                            </div>\n                            <div class=\"space-y-2 text-left flex-1\">\n                                <div\n                                    class=\"font-medium flex items-center justify-between\"\n                                >\n                                    <div>{{ asset.name || 'Asset' }}</div>\n                                    <div class=\"opacity-60 text-xs\">\n                                        {{ asset.category }}\n                                    </div>\n                                </div>\n                                <div\n                                    class=\"flex items-center text-sm space-x-2\"\n                                >\n                                    <p>\n                                        {{ asset.count < 1 ? 2 : asset.count }}\n                                        Available\n                                    </p>\n                                </div>\n                            </div>\n                        </button>\n                        <button\n                            icon\n                            matRipple\n                            fav\n                            class=\"absolute top-1 right-1\"\n                            [class.text-blue-400]=\"isFavourite(asset.id)\"\n                            (click)=\"toggleFav.emit(asset)\"\n                        >\n                            <app-icon>{{\n                                isFavourite(asset.id)\n                                    ? 'favorite'\n                                    : 'favorite_border'\n                            }}</app-icon>\n                        </button>\n                    </li>\n                </ul>\n            </ng-container>\n        </div>\n        <ng-template #empty_state>\n            <div\n                empty\n                class=\"p-16 flex flex-col items-center justify-center space-y-2\"\n            >\n                <p class=\"opacity-30 text-center\">\n                    No available assets for selected time and/or filters\n                </p>\n            </div>\n        </ng-template>\n        <ng-template #load_state>\n            <div\n                loading\n                class=\"p-16 flex flex-col items-center justify-center space-y-2\"\n            >\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p class=\"opacity-30\">Finding available assets...</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                width: 100%;\n                height: 100%;\n            }\n        `,\n    ],\n})\nexport class AssetListComponent {\n    @Input() public selected: string = '';\n    @Input() public favorites: string[] = [];\n    @Output() public toggleFav = new EventEmitter<Asset>();\n    @Output() public onSelect = new EventEmitter<Asset>();\n\n    public readonly loading = this._asset_state.loading;\n    public readonly assets = this._asset_state.filtered_assets;\n\n    constructor(private _asset_state: AssetStateService) {}\n\n    public isFavourite(asset_id: string) {\n        return this.favorites.includes(asset_id);\n    }\n\n    public selectAsset(asset: Asset) {\n        this.onSelect.emit(asset);\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { AssetSelectModalComponent } from './asset-select-modal/asset-select-modal.component';\nimport { ComponentsModule } from '@placeos/components';\nimport { AssetDetailsComponent } from './asset-select-modal/asset-details.component';\nimport { AssetFiltersComponent } from './asset-select-modal/asset-filters.component';\nimport { AssetFiltersDisplayComponent } from './asset-select-modal/asset-filters-display.component';\nimport { AssetListComponent } from './asset-select-modal/asset-list.component';\nimport { FormFieldsModule } from '@placeos/form-fields';\nimport { FormsModule } from '@angular/forms';\n\nexport * from './asset-select-modal/asset-select-modal.component';\n\nconst COMPONENTS = [AssetSelectModalComponent];\n\nconst MODULE_COMPONENTS = [\n    AssetDetailsComponent,\n    AssetFiltersComponent,\n    AssetFiltersDisplayComponent,\n    AssetListComponent,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS, ...MODULE_COMPONENTS],\n    imports: [\n        CommonModule, \n        FormFieldsModule, \n        FormsModule, \n        ComponentsModule\n    ],\n    exports: [...COMPONENTS],\n})\nexport class AssetsModule {}\n","import { Identity } from '@placeos/common';\n\n// Event catering order interfaces\nexport type CateringOrderStatus =\n    | 'accepted'\n    | 'preparing'\n    | 'ready'\n    | 'delivered'\n    | 'cancelled';\n\nexport interface CateringOptionGroup {\n    name: string;\n    multiple: boolean;\n    options: CateringOption[];\n}\n\nexport interface CateringOption {\n    /** Unique Identifier of the catering option */\n    readonly id: string;\n    /** Display name for the catering option */\n    readonly name: string;\n    /** Name of the group associated with the option */\n    readonly group: string;\n    /** Whether multiple items in the group can be selected */\n    readonly multiple: boolean;\n    /** Cost of adding the option to the item */\n    readonly unit_price: number;\n    /** Whether the catering option is active for the item */\n    active?: boolean;\n}\n\nexport type CateringRule =\n    | ['after_hour' | 'before_hour' | 'is_before' | 'within_hours', number]\n    | ['min_length' | 'max_length' | 'visitor_type', string]\n    | ['groups', string[]];\n\nexport interface CateringRuleset {\n    /** ID of the ruleset. Zone ID, category or tag */\n    id: string;\n    /** Descriptive name of the ruleset */\n    name: string;\n    /** List of rules for the id */\n    rules: CateringRule[];\n}\n\nexport const RULE_TYPES: Identity[] = [\n    { id: 'after_hour', name: 'After Hour of Day' },\n    { id: 'before_hour', name: 'Before Hour of Day' },\n    { id: 'min_length', name: 'Min. Meeting Length' },\n    { id: 'max_length', name: 'Max. Meeting Length' },\n    { id: 'is_before', name: 'Is Hours before Meeting' },\n    { id: 'within_hours', name: 'Within Hours before Meeting' },\n    { id: 'visitor_type', name: 'Visitor Type' },\n    { id: 'groups', name: 'User in Groups' },\n];\n","import { Component, EventEmitter, Inject, Output } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { AsyncHandler } from '@placeos/common';\n\nimport { DialogEvent, Identity } from 'libs/common/src/lib/types';\n\nimport { CateringRuleset, RULE_TYPES } from './catering.interfaces';\n\nexport interface CateringConfigModalData {\n    /** List of catering rules */\n    config: CateringRuleset[];\n    /** List of available categories and tags */\n    types?: string[];\n    require_notes?: boolean;\n    saveNotes?: (v: boolean) => void;\n}\n\n@Component({\n    selector: 'catering-config-modal',\n    template: `\n        <header>\n            <h3>Edit Catering Configuration</h3>\n            <button icon mat-dialog-close *ngIf=\"!loading\">\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main class=\"overflow-auto text-center max-w-lg px-4 pt-2 pb-4\">\n            <mat-checkbox\n                class=\"m-2\"\n                [ngModel]=\"require_notes\"\n                (ngModelChange)=\"saveNotesSetting($event)\"\n            >\n                Require notes for orders\n            </mat-checkbox>\n            <br />\n            <button\n                matRipple\n                (click)=\"rulesets.push({ id: new_id, rules: [] })\"\n            >\n                New Ruleset\n            </button>\n            <div *ngFor=\"let set of rulesets; let i = index\" class=\"ruleset\">\n                <div class=\"flex\">\n                    <mat-form-field class=\"flex-1\" appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"name\"\n                            placeholder=\"Zone ID, Category or Tag\"\n                            [(ngModel)]=\"set.name\"\n                            required\n                        />\n                        <mat-error>Ruleset name is required</mat-error>\n                    </mat-form-field>\n                    <button\n                        icon\n                        matRipple\n                        class=\"mb-6\"\n                        (click)=\"set.rules.push(['', '']); show_rules = set.id\"\n                    >\n                        <app-icon>add</app-icon>\n                    </button>\n                    <button\n                        icon\n                        matRipple\n                        class=\"mb-6\"\n                        [disabled]=\"!set.rules.length\"\n                        (click)=\"\n                            show_rules = show_rules !== set.id ? set.id : ''\n                        \"\n                    >\n                        <app-icon>{{\n                            show_rules === set.id\n                                ? 'expand_less'\n                                : 'expand_more'\n                        }}</app-icon>\n                    </button>\n                    <button\n                        icon\n                        matRipple\n                        class=\"mb-6\"\n                        (click)=\"rulesets.splice(i, 1)\"\n                    >\n                        <app-icon>delete</app-icon>\n                    </button>\n                </div>\n                <div\n                    name=\"rules\"\n                    class=\"bg-gray-100 rounded overflow-hidden\"\n                    [style.height]=\"\n                        (show_rules === set.id ? 5 * set.rules.length : 0) +\n                        'em'\n                    \"\n                >\n                    <div\n                        class=\"flex items-center px-2 h-20 space-x-2\"\n                        *ngFor=\"let rule of set.rules; let i = index\"\n                    >\n                        <mat-form-field class=\"flex-1\" appearance=\"outline\">\n                            <mat-select\n                                name=\"booking-type\"\n                                [(ngModel)]=\"rule[0]\"\n                                placeholder=\"Select Rule\"\n                            >\n                                <mat-option\n                                    *ngFor=\"let type of rule_types\"\n                                    [value]=\"type.id\"\n                                >\n                                    {{ type.name }}\n                                </mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                        <mat-form-field class=\"flex-1\" appearance=\"outline\">\n                            <input\n                                matInput\n                                name=\"value\"\n                                placeholder=\"Rule value\"\n                                [(ngModel)]=\"rule[1]\"\n                                required\n                            />\n                            <mat-error>Rule value is required</mat-error>\n                        </mat-form-field>\n                        <button\n                            icon\n                            matRipple\n                            class=\"mb-6\"\n                            (click)=\"set.rules.splice(i, 1)\"\n                        >\n                            <app-icon>delete</app-icon>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </main>\n        <footer\n            class=\"flex p-2 items-center justify-center border-t border-solid border-gray-300\"\n        >\n            <button btn matRipple class=\"mx-auto w-32\" (click)=\"saveChanges()\">\n                Save Changes\n            </button>\n        </footer>\n    `,\n    styles: [\n        `\n            [name='rules'] {\n                transition: height 200ms;\n            }\n        `,\n    ],\n})\nexport class CateringConfigModalComponent extends AsyncHandler {\n    /** Emitter for events on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Whether changes are being saved */\n    public loading = false;\n    /** Whether to show rules for a ruleset */\n    public show_rules: string;\n    public require_notes = this._data.require_notes;\n\n    public readonly rulesets: CateringRuleset[];\n\n    public readonly rule_types: readonly Identity[] = RULE_TYPES;\n\n    public get new_id() {\n        return 'ruleset-' + Math.floor(Math.random() * 9999_9999);\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: CateringConfigModalData\n    ) {\n        super();\n        this.rulesets = (_data.config || []).map((set) => {\n            set.rules = set.rules.map((i) => [\n                i[0],\n                JSON.stringify(i[1]),\n            ]) as any;\n            return set;\n        });\n    }\n\n    public saveNotesSetting(value: boolean) {\n        this.timeout(\n            'save-notes',\n            () => (this._data.saveNotes ? this._data.saveNotes(value) : ''),\n            1000\n        );\n    }\n\n    public saveChanges() {\n        this.loading = true;\n        const rulesets = this.rulesets.map((set) => {\n            return {\n                ...set,\n                rules: set.rules.map((i) => {\n                    let value = i[1];\n                    try {\n                        value = JSON.parse(i[1] as any);\n                    } catch (e) {}\n                    return [i[0], value];\n                }) as any,\n            };\n        });\n        this.event.emit({ reason: 'done', metadata: rulesets });\n    }\n}\n","import { COMMA, ENTER, SPACE } from '@angular/cdk/keycodes';\nimport { Component, EventEmitter, Inject, Output } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MatChipInputEvent } from '@angular/material/chips';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { DialogEvent, randomInt } from '@placeos/common';\nimport { CateringItem } from './catering-item.class';\n\nexport interface CateringItemModalData {\n    item: CateringItem;\n    categories?: string[];\n}\n\n@Component({\n    selector: 'catering-item-modal',\n    template: `\n        <header>\n            <h3>{{ item.id ? 'Edit' : 'Add' }} Item</h3>\n            <button icon matRipple mat-dialog-close *ngIf=\"!loading\">\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <form\n            class=\"p-4 overflow-auto max-h-[65vh]\"\n            *ngIf=\"form && !loading; else load_state\"\n            [formGroup]=\"form\"\n        >\n            <div class=\"flex items-center space-x-2\">\n                <div class=\"flex flex-col\" *ngIf=\"form.controls.name\">\n                    <label\n                        for=\"title\"\n                        [class.error]=\"\n                            form.controls.name.invalid &&\n                            form.controls.name.touched\n                        \"\n                    >\n                        Name<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"name\"\n                            placeholder=\"Item name\"\n                            formControlName=\"name\"\n                        />\n                        <mat-error>Name is required</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col\" *ngIf=\"form.controls.category\">\n                    <label\n                        for=\"category\"\n                        [class.error]=\"\n                            form.controls.category.invalid &&\n                            form.controls.category.touched\n                        \"\n                    >\n                        Category<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"category\"\n                            placeholder=\"Category\"\n                            formControlName=\"category\"\n                            [matAutocomplete]=\"auto\"\n                        />\n                        <mat-error>Category is required</mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n            <div class=\"flex flex-col\" *ngIf=\"form.controls.tags\">\n                <label\n                    for=\"tags\"\n                    [class.error]=\"\n                        form.controls.tags.invalid && form.controls.tags.touched\n                    \"\n                    i18n=\"@@tagsLabel\"\n                >\n                    Tags:\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-chip-grid #chipList aria-label=\"Item Tags\">\n                        <mat-chip-row\n                            *ngFor=\"let item of tag_list\"\n                            (removed)=\"removeTag(item)\"\n                        >\n                            {{ item }}\n                            <button\n                                matChipRemove\n                                [attr.aria-label]=\"'Remove ' + item\"\n                            >\n                                <app-icon>cancel</app-icon>\n                            </button>\n                        </mat-chip-row>\n                    </mat-chip-grid>\n                    <input\n                        name=\"tags\"\n                        placeholder=\"Item tags e.g. Gluten Free, Vegan etc.\"\n                        i18n-placeholder=\"@@zoneTagsPlaceholder\"\n                        [matChipInputFor]=\"chipList\"\n                        [matChipInputSeparatorKeyCodes]=\"separators\"\n                        [matChipInputAddOnBlur]=\"true\"\n                        (matChipInputTokenEnd)=\"addTag($event)\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col\" *ngIf=\"form.controls.description\">\n                <label for=\"description\">Description:</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"description\"\n                        placeholder=\"Item Description\"\n                        formControlName=\"description\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col\" *ngIf=\"form.controls.unit_price\">\n                <label\n                    for=\"title\"\n                    [class.error]=\"\n                        form.controls.unit_price.invalid &&\n                        form.controls.unit_price.touched\n                    \"\n                >\n                    Unit Price<span>*</span>:\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"unit-price\"\n                        type=\"number\"\n                        placeholder=\"Unit Price\"\n                        formControlName=\"unit_price\"\n                    />\n                    <mat-error>Unit Price is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"flex items-center\">\n                <label class=\"flex-none w-28 min-w-0\">Accept Points?</label>\n                <mat-checkbox formControlName=\"accept_points\">{{\n                    form.get('accept_points')?.value ? 'No' : 'Yes'\n                }}</mat-checkbox>\n            </div>\n            <div class=\"flex items-center flex-wrap max-w-lg\" list>\n                <mat-checkbox\n                    [ngModel]=\"hasTag('Gluten Free')\"\n                    (ngModelChange)=\"\n                        $event\n                            ? addTag({ value: 'Gluten Free' })\n                            : removeTag('Gluten Free')\n                    \"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                >\n                    Gluten Free (GF)\n                </mat-checkbox>\n                <mat-checkbox\n                    [ngModel]=\"hasTag('Vegan')\"\n                    (ngModelChange)=\"\n                        $event ? addTag({ value: 'Vegan' }) : removeTag('Vegan')\n                    \"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                >\n                    Vegan (VG)\n                </mat-checkbox>\n                <mat-checkbox\n                    [ngModel]=\"hasTag('Vegetarian')\"\n                    (ngModelChange)=\"\n                        $event\n                            ? addTag({ value: 'Vegetarian' })\n                            : removeTag('Vegetarian')\n                    \"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                >\n                    Vegetarian (V)\n                </mat-checkbox>\n                <mat-checkbox\n                    [ngModel]=\"hasTag('Contains Dairy')\"\n                    (ngModelChange)=\"\n                        $event\n                            ? addTag({ value: 'Contains Dairy' })\n                            : removeTag('Contains Dairy')\n                    \"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                >\n                    Contains Dairy (D)\n                </mat-checkbox>\n                <mat-checkbox\n                    [ngModel]=\"hasTag('Contains Nuts')\"\n                    (ngModelChange)=\"\n                        $event\n                            ? addTag({ value: 'Contains Nuts' })\n                            : removeTag('Contains Nuts')\n                    \"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                >\n                    Contains Nuts (N)\n                </mat-checkbox>\n            </div>\n            <div class=\"flex items-center\">\n                <label class=\"flex-1 w-24 min-w-0\">Discount Cap</label>\n                <a-counter\n                    class=\"border border-gray-200 rounded\"\n                    formControlName=\"discount_cap\"\n                    [min]=\"0\"\n                    [max]=\"100\"\n                    [step]=\"5\"\n                    [render_fn]=\"renderPercent\"\n                ></a-counter>\n            </div>\n            <div class=\"flex flex-col\" *ngIf=\"form.controls.images\">\n                <label for=\"images\" i18n=\"@@imagesLabel\">Images:</label>\n                <image-list-field\n                    name=\"images\"\n                    formControlName=\"images\"\n                ></image-list-field>\n            </div>\n        </form>\n        <footer\n            *ngIf=\"!loading\"\n            class=\"flex p-2 items-center justify-center border-t border-solid border-gray-300\"\n        >\n            <button\n                btn\n                matRipple\n                [disabled]=\"!form.dirty\"\n                (click)=\"saveChanges()\"\n            >\n                Save\n            </button>\n        </footer>\n        <ng-template #load_state>\n            <div class=\"flex flex-col items-center p-8 space-y-2 w-64\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>Saving catering item...</p>\n            </div>\n        </ng-template>\n        <mat-autocomplete #auto=\"matAutocomplete\">\n            <mat-option *ngFor=\"let option of categories\" [value]=\"option\">\n                {{ option }}\n            </mat-option>\n        </mat-autocomplete>\n    `,\n    styles: [\n        `\n            [list] mat-checkbox {\n                margin: 0.5rem;\n            }\n        `,\n    ],\n})\nexport class CateringItemModalComponent {\n    /** Emitter for events on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form fields for item */\n    public form = new FormGroup({\n        name: new FormControl(this.item.name || '', [Validators.required]),\n        description: new FormControl(this.item.description || ''),\n        category: new FormControl(this.item.category || '', [\n            Validators.required,\n        ]),\n        unit_price: new FormControl(this.item.unit_price, [\n            Validators.required,\n        ]),\n        tags: new FormControl(this.item.tags || []),\n        accept_points: new FormControl(this.item.accept_points || false),\n        discount_cap: new FormControl(this.item.discount_cap || 0),\n        images: new FormControl(this.item.images || []),\n    });\n    /** Whether changes are being saved */\n    public loading = false;\n    /** List of separator characters for tags */\n    public readonly separators: number[] = [ENTER, COMMA, SPACE];\n\n    /** Current item details */\n    public get item(): CateringItem {\n        return this._data.item || new CateringItem();\n    }\n\n    /** List of available categories */\n    public get categories(): string[] {\n        return this._data.categories || [];\n    }\n\n    public get tag_list(): string[] {\n        return this.form.controls.tags.value;\n    }\n\n    public renderPercent(value: number = 0) {\n        return `${value}%`;\n    }\n\n    public hasTag(tag: string) {\n        return this.tag_list.includes(tag);\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: CateringItemModalData\n    ) {}\n\n    /**\n     * Add a tag to the list of tags for the item\n     * @param event Input event\n     */\n    public addTag(event: MatChipInputEvent): void {\n        if (!this.form || !this.form.controls.tags) return;\n        this.form.controls.tags.markAsDirty();\n        const input = event.input;\n        const value = event.value;\n        const tag_list = this.tag_list;\n        if ((value || '').trim()) {\n            tag_list.push(value);\n            this.form.controls.tags.setValue(tag_list);\n        }\n\n        // Reset the input value\n        if (input) input.value = '';\n    }\n\n    /**\n     * Remove tag from the list\n     * @param existing_tag Tag to remove\n     */\n    public removeTag(existing_tag: string): void {\n        if (!this.form || !this.form.controls.tags) return;\n        const tag_list = this.tag_list;\n        this.form.controls.tags.markAsDirty();\n        const index = tag_list.indexOf(existing_tag);\n\n        if (index >= 0) {\n            tag_list.splice(index, 1);\n            this.form.controls.tags.setValue(tag_list);\n        }\n    }\n\n    public saveChanges() {\n        this.loading = true;\n        this.event.emit({\n            reason: 'done',\n            metadata: {\n                item: new CateringItem({\n                    ...this.item,\n                    id: this.item.id || `item-${randomInt(9999_9999)}`,\n                    ...this.form.value,\n                }),\n            },\n        });\n    }\n}\n","import { Component, EventEmitter, Inject, OnInit, Output } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { DialogEvent } from 'libs/common/src/lib/types';\nimport { randomInt } from 'libs/common/src/lib/general';\n\nimport { CateringItem } from './catering-item.class';\nimport { CateringOption } from './catering.interfaces';\n\nexport interface CateringItemOptionModalData {\n    parent: CateringItem;\n    option: CateringOption;\n    types: string[];\n}\n\n@Component({\n    selector: 'catering-option-modal',\n    template: `\n        <header>\n            <h3>{{ option.id ? 'Edit' : 'Add' }} Item Option</h3>\n            <button icon mat-dialog-close *ngIf=\"!loading\">\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <form\n            class=\"p-4 overflow-auto max-h-[65vh]\"\n            *ngIf=\"form && !loading; else load_state\"\n            [formGroup]=\"form\"\n        >\n            <div class=\"flex flex-col\" *ngIf=\"form.controls.name\">\n                <label\n                    for=\"title\"\n                    [class.error]=\"\n                        form.controls.name.invalid && form.controls.name.touched\n                    \"\n                >\n                    Name<span>*</span>:\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"name\"\n                        placeholder=\"Item name\"\n                        formControlName=\"name\"\n                    />\n                    <mat-error>Name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col\" *ngIf=\"form.controls.group\">\n                <label\n                    for=\"group\"\n                    [class.error]=\"\n                        form.controls.group.invalid &&\n                        form.controls.group.touched\n                    \"\n                >\n                    Type<span>*</span>:\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"group\"\n                        placeholder=\"Type of option e.g. Number of sugars\"\n                        formControlName=\"group\"\n                        [matAutocomplete]=\"auto\"\n                    />\n                    <mat-error>Type is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col\" *ngIf=\"form.controls.unit_price\">\n                <label for=\"title\">Unit Price:</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"unit-price\"\n                        type=\"number\"\n                        placeholder=\"Unit Price\"\n                        formControlName=\"unit_price\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col\" *ngIf=\"form.controls.multiple\">\n                <mat-checkbox name=\"multiple\" formControlName=\"multiple\">\n                    Can select multiple of type\n                </mat-checkbox>\n            </div>\n        </form>\n        <footer\n            *ngIf=\"!loading\"\n            class=\"flex p-2 items-center justify-center border-t border-solid border-gray-300\"\n        >\n            <button\n                btn\n                matRipple\n                [disabled]=\"!form.dirty\"\n                (click)=\"saveChanges()\"\n            >\n                Save\n            </button>\n        </footer>\n        <ng-template #load_state>\n            <div loading class=\"flex flex-col items-center p-8 space-y-2 w-64\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>Saving catering item option...</p>\n            </div>\n        </ng-template>\n        <mat-autocomplete #auto=\"matAutocomplete\">\n            <mat-option *ngFor=\"let option of types\" [value]=\"option\">\n                {{ option }}\n            </mat-option>\n        </mat-autocomplete>\n    `,\n    styles: [``],\n})\nexport class CateringItemOptionModalComponent {\n    /** Emitter for events on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form fields for item */\n    public form = new FormGroup({\n        name: new FormControl(this.option.name || '', [Validators.required]),\n        group: new FormControl(this.option.group || '', [Validators.required]),\n        unit_price: new FormControl(this.option.unit_price),\n        multiple: new FormControl(!!this.option.multiple, []),\n    });\n    /** Whether changes are being saved */\n    public loading = false;\n\n    /** Current item details */\n    public get option(): CateringOption {\n        return this._data.option;\n    }\n\n    /** List of available categories */\n    public get types(): string[] {\n        return this._data.types || [];\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: CateringItemOptionModalData\n    ) {}\n\n    public saveChanges() {\n        this.loading = true;\n        const new_option = {\n            ...this.option,\n            id: this.option.id || `option-${randomInt(9999_9999)}`,\n            ...this.form.value,\n        } as CateringOption;\n        this.event.emit({\n            reason: 'done',\n            metadata: {\n                item: new CateringItem({\n                    ...this._data.parent,\n                    options: this._data.parent.options\n                        .filter((i) => i.id !== new_option.id)\n                        .concat([new_option]),\n                }),\n            },\n        });\n    }\n}\n","import addHours from \"../addHours/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport toInteger from \"../_lib/toInteger/index.js\";\n/**\n * @name subHours\n * @category Hour Helpers\n * @summary Subtract the specified number of hours from the given date.\n *\n * @description\n * Subtract the specified number of hours from the given date.\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of hours to be subtracted. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the hours subtracted\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Subtract 2 hours from 11 July 2014 01:00:00:\n * const result = subHours(new Date(2014, 6, 11, 1, 0), 2)\n * //=> Thu Jul 10 2014 23:00:00\n */\n\nexport default function subHours(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addHours(dirtyDate, -amount);\n}","import { isAfter, isBefore, setHours, subHours } from 'date-fns';\n\nimport { stringToMinutes } from 'libs/events/src/lib/helpers';\nimport { CalendarEvent } from 'libs/events/src/lib/event.class';\nimport { CateringItem } from './catering-item.class';\nimport { CateringRuleset } from './catering.interfaces';\nimport { Observable, of } from 'rxjs';\nimport { showMetadata } from '@placeos/ts-client';\nimport { catchError, map } from 'rxjs/operators';\n\nconst RULE_REQUESTS: Record<string, Observable<CateringRuleset[]>> = {};\n\nexport function getCateringRulesForZone(\n    zone_id: string,\n    fresh: boolean = false\n) {\n    if (!zone_id) return of([] as CateringRuleset[]);\n    if (!RULE_REQUESTS[zone_id] || fresh)\n        RULE_REQUESTS[zone_id] = showMetadata(zone_id, 'catering_config').pipe(\n            map((_) => _.details as CateringRuleset[]),\n            catchError((e) => of([] as CateringRuleset[]))\n        );\n    return RULE_REQUESTS[zone_id];\n}\n\nexport function cateringItemAvailable(\n    item: CateringItem,\n    rules: CateringRuleset[],\n    event: CalendarEvent\n) {\n    let is_available = true;\n    for (const rule of rules) {\n        if (\n            item.category === rule.name ||\n            item.tags.includes(rule.name) ||\n            event.resources.find((_) => _.zones.includes(rule.name)) ||\n            event.space?.zones.includes(rule.name) ||\n            rule.name === '*'\n        ) {\n            let matches = 0;\n            for (const condition of rule.rules) {\n                const date = new Date(event.date);\n                switch (condition[0]) {\n                    case 'is_before':\n                        matches += isBefore(\n                            Date.now(),\n                            subHours(date, condition[1])\n                        )\n                            ? 1\n                            : 0;\n                        break;\n                    case 'within_hours':\n                        matches += isAfter(\n                            Date.now(),\n                            subHours(date, condition[1])\n                        )\n                            ? 1\n                            : 0;\n                        break;\n                    case 'after_hour':\n                        matches += isAfter(date, setHours(date, condition[1]))\n                            ? 1\n                            : 0;\n                        break;\n                    case 'before_hour':\n                        matches += isBefore(date, setHours(date, condition[1]))\n                            ? 1\n                            : 0;\n                        break;\n                    case 'min_length':\n                        matches +=\n                            event.duration >= stringToMinutes(condition[1])\n                                ? 1\n                                : 0;\n                        break;\n                    case 'max_length':\n                        matches +=\n                            event.duration <= stringToMinutes(condition[1])\n                                ? 1\n                                : 0;\n                        break;\n                    case 'visitor_type':\n                        matches +=\n                            event.ext('visitor_type') === condition[1] ? 1 : 0;\n                        break;\n                    default:\n                        matches += 1;\n                }\n            }\n            is_available = matches >= rule.rules.length;\n        }\n    }\n    return is_available;\n}\n","import { Component, Inject, Output, EventEmitter, OnInit } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { Observable } from 'rxjs';\n\nimport { AsyncHandler, DialogEvent, HashMap, unique } from '@placeos/common';\n\nimport { CateringItem } from './catering-item.class';\nimport { CateringOrder } from './catering-order.class';\nimport { CateringOption, CateringRuleset } from './catering.interfaces';\nimport { OrganisationService } from '@placeos/organisation';\nimport { cateringItemAvailable } from './utilities';\n\nexport interface CateringOrderModalData {\n    order: CateringOrder;\n    code: string;\n    menu: Observable<CateringItem[]>;\n    loading: Observable<boolean>;\n    getCateringConfig: (_: string) => Promise<CateringRuleset[]>;\n    selectOptions: (_: CateringOption[]) => Promise<CateringOption[]>;\n}\n\n// TODO: Split template into 2 children components. Order menu and Order Confirm;\n\n@Component({\n    selector: 'app-catering-order-modal',\n    template: `\n        <div class=\"main min-w-[20rem]\" *ngIf=\"!loading; else load_state\">\n            <ng-container *ngIf=\"!show_order_details; else order_details\">\n                <mat-tab-group>\n                    <ng-container *ngFor=\"let cat of categories\">\n                        <mat-tab\n                            *ngIf=\"(menu_items || {})[cat].length\"\n                            [label]=\"cat\"\n                        >\n                            <div class=\"list\">\n                                <div\n                                    item\n                                    class=\"flex items-center p-2 border-b border-gray-200\"\n                                    *ngFor=\"let item of (menu_items || {})[cat]\"\n                                >\n                                    <div class=\"flex-1 w-1/2\">\n                                        <div class=\"flex-1 w-1/2\">\n                                            {{ item.name }}\n                                        </div>\n                                        <div\n                                            class=\"text-xs no-underline\"\n                                            *ngIf=\"item.options.length\"\n                                        >\n                                            Options Available\n                                        </div>\n                                    </div>\n                                    <div\n                                        class=\"bg-primary text-xs rounded px-4 py-2 mx-2 text-white font-medium\"\n                                    >\n                                        {{\n                                            item.unit_price / 100\n                                                | currency: code\n                                        }}\n                                    </div>\n                                    <a-counter\n                                        ngDefaultControl\n                                        [ngModel]=\"item.quantity\"\n                                        (ngModelChange)=\"\n                                            updateItemQuantity(item, $event)\n                                        \"\n                                        *ngIf=\"!item.options.length\"\n                                    ></a-counter>\n                                    <div\n                                        class=\"flex items-center\"\n                                        *ngIf=\"item.options.length\"\n                                    >\n                                        <div\n                                            [matTooltip]=\"\n                                                item.quantity\n                                                    ? 'Items with options must be removed from order confirmation page'\n                                                    : ''\n                                            \"\n                                        >\n                                            <button\n                                                icon\n                                                matRipple\n                                                [disabled]=\"true\"\n                                            >\n                                                <app-icon>remove</app-icon>\n                                            </button>\n                                        </div>\n                                        <div\n                                            class=\"count h-12 w-12 flex items-center justify-center\"\n                                        >\n                                            {{ item.quantity }}\n                                        </div>\n                                        <button\n                                            icon\n                                            matRipple\n                                            (click)=\"addItem(item)\"\n                                        >\n                                            <app-icon>add</app-icon>\n                                        </button>\n                                    </div>\n                                </div>\n                            </div>\n                        </mat-tab>\n                    </ng-container>\n                </mat-tab-group>\n            </ng-container>\n        </div>\n        <footer\n            *ngIf=\"!loading\"\n            class=\"flex items-center justify-center space-x-2 p-2 border-t border-gray-200\"\n        >\n            <ng-container *ngIf=\"!show_order_details; else order_actions\">\n                <button btn matRipple class=\"inverse\" mat-dialog-close>\n                    Cancel\n                </button>\n                <button\n                    confirm\n                    btn\n                    matRipple\n                    [disabled]=\"!order.item_count\"\n                    [matBadge]=\"order.item_count\"\n                    [matBadgeHidden]=\"!order.item_count\"\n                    matBadgeColor=\"warn\"\n                    (click)=\"show_order_details = true\"\n                >\n                    Confirm\n                </button>\n            </ng-container>\n            <ng-template #order_actions>\n                <button\n                    matRipple\n                    class=\"inverse\"\n                    (click)=\"show_order_details = false\"\n                >\n                    Back\n                </button>\n                <button save btn matRipple (click)=\"saveOrder()\">\n                    Save Order\n                </button>\n            </ng-template>\n        </footer>\n        <ng-template #load_state>\n            <div class=\"flex flex-col w-64 p-8 items-center space-y-2\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>{{ loading }}</p>\n            </div>\n        </ng-template>\n        <ng-template #order_details>\n            <header class=\"h-[3.25rem]\">\n                <h3>Confirm Order</h3>\n            </header>\n            <div class=\"list\">\n                <div\n                    item\n                    class=\"flex items-center p-2 border-b border-gray-50\"\n                    *ngFor=\"let item of order.items\"\n                >\n                    <div class=\"flex-1 w-1/2\">\n                        <div class=\"flex-1 w-1/2\">{{ item.name }}</div>\n                        <div\n                            class=\"text-xs underline\"\n                            *ngIf=\"item.options.length\"\n                            [matTooltip]=\"optionsFor(item)\"\n                        >\n                            {{ item.options.length }} option{{\n                                item.options.length === 1 ? '' : 's'\n                            }}\n                            selected\n                        </div>\n                    </div>\n                    <div\n                        class=\"bg-primary text-xs rounded px-4 py-2 mx-2 text-white font-medium\"\n                    >\n                        {{ item.total_cost / 100 | currency: code }}\n                    </div>\n                    <a-counter\n                        [ngModel]=\"item.quantity\"\n                        (ngModelChange)=\"updateItemQuantity(item, $event)\"\n                    ></a-counter>\n                </div>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            .list {\n                height: 24em;\n                min-width: 32em;\n                max-width: calc(100vw - 1em);\n            }\n\n            footer button {\n                min-width: 12em;\n            }\n\n            input {\n                position: relative;\n                width: 100%;\n                padding: 1em;\n                border: none;\n                border-radius: 0 !important;\n                border-top: 1px solid #ccc;\n                border-bottom: 1px solid #ccc;\n                outline: none;\n                font-size: 1em;\n            }\n\n            input:focus {\n                border: none;\n                border-top: 2px solid var(--primary);\n                border-bottom: 2px solid var(--primary);\n                box-shadow: none;\n            }\n\n            input.error::placeholder {\n                color: rgba(var(--error), 0.45);\n            }\n        `,\n    ],\n})\nexport class CateringOrderModalComponent\n    extends AsyncHandler\n    implements OnInit\n{\n    /** Emitter for events on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Whether changes are being saved */\n    public loading = '';\n    /** Current order */\n    public order: CateringOrder;\n    /** Name of the active category */\n    public category: string;\n    /** Whether order details should be shown */\n    public show_order_details: boolean;\n    /** Catering rules for selected space */\n    public rules: readonly CateringRuleset[];\n    /** List of menu items to show */\n    public menu_items: HashMap<CateringItem[]> = {};\n    /** List of categories for the active menu */\n    public categories: string[] = [];\n\n    public get code() {\n        return this._org.currency_code;\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringOrderModalData\n    ) {\n        super();\n        this.loading = 'Loading menu...';\n    }\n\n    public async ngOnInit() {\n        this.loading = 'Loading menu...';\n        this.order = new CateringOrder(this._data.order);\n        this.rules = await this._data.getCateringConfig(\n            this.order.event?.space?.level?.parent_id\n        );\n        this._data.menu.subscribe((list) => {\n            this.loading = 'Loading menu...';\n            const categories = unique(list.map((item) => item.category));\n            const map = {};\n            for (const cat of categories) {\n                map[cat] = list.filter((item) => {\n                    return (\n                        item.category === cat &&\n                        cateringItemAvailable(\n                            item,\n                            this.rules as any,\n                            this.order.event\n                        )\n                    );\n                });\n            }\n            this.categories = categories;\n            this.menu_items = map;\n            this.updateMenuQuantities();\n            this.timeout('clear_loading', () => (this.loading = ''), 1000);\n        });\n    }\n\n    public addItem(item: CateringItem, choose_options: boolean = true) {\n        const old_item = this.order.items.find(\n            (itm) =>\n                itm.id === item.id &&\n                itm.options.length ===\n                    itm.options.reduce(\n                        (c, o) =>\n                            c +\n                            (item.options.find((opt) => o.id === opt.id)\n                                ? 1\n                                : 0),\n                        0\n                    )\n        );\n        if (choose_options && item.options?.length) {\n            this._data.selectOptions(item.options).then((options) => {\n                const new_item = new CateringItem({ ...item, options });\n                this.addItem(new_item, false);\n            });\n        } else if (old_item) {\n            this.order = new CateringOrder({\n                ...this.order,\n                items: this.order.items\n                    .filter(\n                        (i) =>\n                            !(\n                                i.id === item.id &&\n                                i.options_string === item.options_string\n                            )\n                    )\n                    .concat([\n                        new CateringItem({\n                            ...item,\n                            quantity: old_item.quantity + 1,\n                        }),\n                    ]),\n            });\n        } else {\n            this.order = new CateringOrder({\n                ...this.order,\n                items: this.order.items.concat([\n                    new CateringItem({ ...item, quantity: 1 }),\n                ]),\n            });\n        }\n        this.updateMenuQuantities();\n    }\n\n    public removeItem(item: CateringItem) {\n        this.order = new CateringOrder({\n            ...this.order,\n            items: this.order.items.filter(\n                (_) =>\n                    _.id !== item.id && _.options_string === item.options_string\n            ),\n        });\n        this.updateMenuQuantities();\n    }\n\n    public updateItemQuantity(item: CateringItem, amount: number) {\n        const old_item = this.order.items.find(\n            (itm) =>\n                itm.id === item.id && itm.options_string === item.options_string\n        );\n        let items = [...this.order.items];\n        if (old_item) {\n            items = this.order.items\n                .filter(\n                    (i) =>\n                        !(\n                            i.id === item.id &&\n                            i.options_string === item.options_string\n                        )\n                )\n                .concat([new CateringItem({ ...item, quantity: amount })]);\n        } else {\n            items = this.order.items.concat([\n                new CateringItem({ ...item, quantity: amount }),\n            ]);\n        }\n        items.sort((a, b) => a.name.localeCompare(b.name));\n        this.order = new CateringOrder({\n            ...this.order,\n            items,\n        });\n        this.updateMenuQuantities();\n    }\n\n    public updateMenuQuantities() {\n        for (const cat in this.menu_items) {\n            for (const item of this.menu_items[cat]) {\n                (item as any).quantity = this.order.items.reduce(\n                    (c, i) => (i.id === item.id ? c + i.quantity : c),\n                    0\n                );\n            }\n        }\n    }\n\n    public optionsFor(item: CateringItem) {\n        return item.options.map((i) => i.name).join('\\n');\n    }\n\n    public saveOrder() {\n        this.event.emit({\n            reason: 'done',\n            metadata: { order: this.order },\n        });\n    }\n\n    public confirmOrder() {\n        this.show_order_details = true;\n    }\n}\n","import { Component, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { DialogEvent, HashMap } from 'libs/common/src/lib/types';\nimport { unique } from 'libs/common/src/lib/general';\n\nimport { CateringOption, CateringOptionGroup } from './catering.interfaces';\n\nexport interface CateringOrderOptionsModalData {\n    code: string;\n    options: CateringOption[];\n}\n\n@Component({\n    selector: 'app-catering-options-modal',\n    template: `\n        <header>\n            <h3>Select options</h3>\n            <button icon mat-dialog-close>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main class=\"overflow-auto\">\n            <div\n                class=\"pt-1 pb-2 border-b border-gray-200\"\n                *ngFor=\"let group of groups\"\n                [attr.group]=\"group.name\"\n            >\n                <div class=\"font-medium p-2 capitalize\">{{ group.name }}</div>\n                <div class=\"flex flex-col pl-6\">\n                    <ng-container *ngIf=\"!group.multiple; else multi_options\">\n                        <mat-radio-group\n                            class=\"flex flex-col\"\n                            aria-label=\"Select an option\"\n                            ngModel\n                            (ngModelChange)=\"updateGroupOption(group, $event)\"\n                        >\n                            <mat-radio-button class=\"my-1 mx-0\" value=\"\">\n                                <span class=\"font-medium p-2\">None</span>\n                            </mat-radio-button>\n                            <mat-radio-button\n                                class=\"my-1 mx-0\"\n                                *ngFor=\"let opt of group?.options\"\n                                [value]=\"opt.id\"\n                            >\n                                <div class=\"flex items-center justify-center\">\n                                    <div class=\"font-medium p-2 flex-1 w-1/2\">\n                                        {{ opt.name }}\n                                    </div>\n                                    <div\n                                        class=\"opacity-60 text-xs\"\n                                        *ngIf=\"opt.unit_price\"\n                                    >\n                                        +{{\n                                            opt.unit_price / 100\n                                                | currency: code\n                                        }}\n                                    </div>\n                                </div>\n                            </mat-radio-button>\n                        </mat-radio-group>\n                    </ng-container>\n                    <ng-template #multi_options>\n                        <mat-checkbox\n                            *ngFor=\"let opt of group?.options\"\n                            [(ngModel)]=\"option_state[opt.id]\"\n                        >\n                            <div class=\"flex items-center justify-center\">\n                                <div class=\"font-medium p-2 flex-1 w-1/2\">\n                                    {{ opt.name }}\n                                </div>\n                                <div\n                                    class=\"opacity-60 text-xs\"\n                                    *ngIf=\"opt.unit_price\"\n                                >\n                                    +{{ opt.unit_price / 100 | currency: code }}\n                                </div>\n                            </div>\n                        </mat-checkbox>\n                    </ng-template>\n                </div>\n            </div>\n        </main>\n        <footer class=\"p-2\">\n            <button btn matRipple class=\"w-32\" (click)=\"saveOptions()\">\n                Save\n            </button>\n        </footer>\n    `,\n    styles: [\n        `\n            main {\n                min-height: 24em;\n                width: 24rem;\n                max-width: calc(100vw - 2rem);\n            }\n        `,\n    ],\n})\nexport class CateringOrderOptionsModalComponent {\n    /** Emitter for events on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** List of option groups */\n    public readonly groups: CateringOptionGroup[];\n    /** Mapping of options to their active state */\n    public option_state: HashMap<boolean> = {};\n    public readonly code = this._data.code;\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: CateringOrderOptionsModalData\n    ) {\n        const groups = unique(\n            this._data.options.map((i) => i.group || 'Other')\n        );\n        const group_list = [];\n        for (const group of groups) {\n            const options = this._data.options.filter((i) => i.group === group);\n            group_list.push({\n                name: group,\n                multiple: !!options.find((i) => i.multiple),\n                options,\n            });\n        }\n        this.groups = group_list;\n    }\n\n    public updateGroupOption(group: CateringOptionGroup, id: string) {\n        for (const option of group.options) {\n            this.option_state[option.id] = option.id === id;\n        }\n    }\n\n    public saveOptions() {\n        const options = this._data.options.filter(\n            (opt) => this.option_state[opt.id]\n        );\n        this.event.emit({ reason: 'done', metadata: { options } });\n    }\n}\n","import { Component, EventEmitter, Output } from '@angular/core';\nimport { csvToJson, DialogEvent, downloadFile } from '@placeos/common';\nimport { CateringItem } from './catering-item.class';\n\n@Component({\n    selector: 'catering-import-menu-modal',\n    template: `\n        <header class=\"h-12 bg-primary flex items-center justify-between px-4\">\n            <h2>Import Catering Menu</h2>\n            <button icon mat-dialog-close *ngIf=\"!loading\">\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main *ngIf=\"!loading; else load_state\">\n            <div\n                class=\"relative flex flex-col items-center justify-center space-y-2 h-[24rem] w-[24rem] border-4 border-gray-200 border-dashed rounded-xl hover:bg-gray-100 m-4 p-4 cursor-pointer\"\n            >\n                <app-icon class=\"text-4xl\">upload</app-icon>\n                <p>Click to select file or Drag and drop files</p>\n                <input\n                    type=\"file\"\n                    class=\"absolute inset-0 opacity-0\"\n                    (change)=\"handleFileEvent($event)\"\n                />\n            </div>\n            <div class=\"flex items-center justify-center px-4 pb-4\">\n                <button\n                    matRipple\n                    class=\"clear underline w-48\"\n                    (click)=\"downloadTemplate()\"\n                >\n                    Download Template\n                </button>\n            </div>\n        </main>\n        <ng-template #load_state>\n            <main\n                class=\"flex flex-col items-center justify-center space-y-2 p-8 h-[24rem] w-[24rem]\"\n            >\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>{{ loading }}</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class CateringImportMenuModalComponent {\n    @Output() public event = new EventEmitter<DialogEvent>();\n    public loading: string;\n\n    /** Upload the image to the cloud */\n    public handleFileEvent(event: DragEvent) {\n        this.loading = 'Processing menu data...';\n        const element: HTMLInputElement = event.target as any;\n        if (!element?.files) return (this.loading = '');\n        const files: FileList = element.files;\n        if (!files.length) return (this.loading = '');\n        const file = files[0];\n        const fileReader = new FileReader();\n        fileReader.addEventListener('loadend', (e: any) => {\n            const contents = e.target.result;\n            const data = csvToJson(contents);\n            this.loading = '';\n            this.event.emit({\n                reason: 'done',\n                metadata: data\n                    .filter((_) => (_.type || '').toLowerCase() === 'item')\n                    .map(\n                        (i) =>\n                            new CateringItem({\n                                ...i,\n                                options: data\n                                    .filter(\n                                        (_) =>\n                                            (_.type || '').toLowerCase() ===\n                                                'option' && _.tags === i.id\n                                    )\n                                    .map((_) => ({\n                                        id: _.id,\n                                        name: _.name,\n                                        group: _.category,\n                                        multiple: _.multiple,\n                                        unit_price: _.unit_price,\n                                    })),\n                            })\n                    ),\n            });\n        });\n        fileReader.readAsText(file);\n    }\n\n    public downloadTemplate() {\n        const template = `ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false`;\n        downloadFile('import-menu-template.csv', template);\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    updateMetadata,\n    showMetadata,\n    PlaceMetadata,\n} from '@placeos/ts-client';\nimport { BehaviorSubject, combineLatest, Observable, of } from 'rxjs';\nimport {\n    catchError,\n    filter,\n    first,\n    map,\n    shareReplay,\n    switchMap,\n    take,\n    tap,\n} from 'rxjs/operators';\n\nimport {\n    AsyncHandler,\n    flatten,\n    notifyError,\n    notifySuccess,\n    openConfirmModal,\n    SettingsService,\n    unique,\n} from '@placeos/common';\nimport { Building, OrganisationService } from '@placeos/organisation';\n\nimport {\n    CateringItemModalComponent,\n    CateringItemModalData,\n} from './catering-item-modal.component';\nimport {\n    CateringItemOptionModalComponent,\n    CateringItemOptionModalData,\n} from './catering-option-modal.component';\nimport {\n    CateringConfigModalComponent,\n    CateringConfigModalData,\n} from './catering-config-modal.component';\nimport { CateringItem } from './catering-item.class';\nimport { CateringOrder } from './catering-order.class';\nimport {\n    CateringOrderModalComponent,\n    CateringOrderModalData,\n} from './catering-order-modal.component';\nimport { CateringOption, CateringRuleset } from './catering.interfaces';\nimport {\n    CateringOrderOptionsModalComponent,\n    CateringOrderOptionsModalData,\n} from './catering-order-options-modal.component';\nimport { CateringImportMenuModalComponent } from './catering-import-menu-modal.component';\n\nexport interface CateringSettings {\n    require_notes?: boolean;\n    charge_codes?: string[];\n    disabled_rooms?: string[];\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class CateringStateService extends AsyncHandler {\n    private _updated = new BehaviorSubject(0);\n    /** Active menu */\n    private _menu = new BehaviorSubject<CateringItem[]>([]);\n    /** Whether the menu for the active building is loading */\n    private _loading = new BehaviorSubject<boolean>(false);\n    /** Currency code for the active building */\n    private _currency = new BehaviorSubject<string>('USD');\n    /** Observable for the active menu */\n    public readonly menu = this._menu.asObservable();\n    /** Observable for whether the menu for the active building is loadingg */\n    public readonly loading = this._loading.asObservable();\n    /** Observable for the currency code of the active building */\n    public readonly currency = this._currency.asObservable();\n\n    public readonly settings = this._org.active_building.pipe(\n        filter((_) => !!_),\n        switchMap((_) =>\n            showMetadata(_.id, 'catering-settings').pipe(\n                catchError((_) => of({} as PlaceMetadata))\n            )\n        ),\n        map((_) => (_.details as CateringSettings) || {}),\n        tap((_) =>\n            this._settings.post('require_catering_notes', !!_?.require_notes)\n        ),\n        shareReplay(1)\n    );\n\n    public readonly charge_codes = this.settings.pipe(\n        map((_) => _.charge_codes || [])\n    );\n    public readonly availability = this.settings.pipe(\n        map((_) => _.disabled_rooms || [])\n    );\n\n    public zone = '';\n\n    public get is_editable() {\n        return !this.zone || this.zone === this._org.building?.id;\n    }\n\n    public get categories() {\n        const menu = this._menu.getValue();\n        return unique(menu.map((i) => i.category));\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _dialog: MatDialog,\n        private _settings: SettingsService\n    ) {\n        super();\n        this.subscription(\n            'building',\n            this._org.active_building.subscribe(async (bld: Building) => {\n                if (bld) {\n                    const menu = (await this.getCateringForZone(bld.id)).map(\n                        (i) => new CateringItem(i)\n                    );\n                    this._currency.next(\n                        this._settings.get('app.currency') ||\n                            bld.currency ||\n                            'USD'\n                    );\n                    this._menu.next(menu);\n                }\n            })\n        );\n    }\n\n    /**\n     * Create/Edit catering order\n     * @param order Order to manipulate\n     */\n    public async manageCateringOrder(order: CateringOrder) {\n        const ref = this._dialog.open<\n            CateringOrderModalComponent,\n            CateringOrderModalData\n        >(CateringOrderModalComponent, {\n            data: {\n                code: this._currency.getValue(),\n                order,\n                menu: this.menu,\n                loading: this.loading,\n                getCateringConfig: (_) => this.getCateringConfig(_),\n                selectOptions: (_) => this.selectOptions(_),\n            },\n        });\n        const details = await Promise.race([\n            ref.componentInstance.event\n                .pipe(first((_) => _.reason === 'done'))\n                .toPromise(),\n            ref.afterClosed().toPromise(),\n        ]);\n        ref.close();\n        return details?.metadata?.order || order;\n    }\n\n    public async addItem(item: CateringItem = new CateringItem()) {\n        const ref = this._dialog.open<\n            CateringItemModalComponent,\n            CateringItemModalData\n        >(CateringItemModalComponent, {\n            data: {\n                item,\n                categories: this.categories,\n            },\n        });\n        const details = await Promise.race([\n            ref.componentInstance.event\n                .pipe(first((_) => _.reason === 'done'))\n                .toPromise(),\n            ref.afterClosed().toPromise(),\n        ]);\n        if (details?.reason !== 'done') return;\n        const menu = this._menu.getValue();\n        const index = menu.findIndex((itm) => itm.id === item.id);\n        if (index >= 0) {\n            menu.splice(index, 1, details.metadata.item);\n        } else {\n            menu.push(details.metadata.item);\n        }\n        this.updateMenu(this._org.building.id, menu).then(\n            () => {\n                this._menu.next([...menu]);\n                ref.close();\n            },\n            () => (ref.componentInstance.loading = false)\n        );\n    }\n\n    public updateItem(item: CateringItem) {\n        const menu = this._menu.getValue();\n        const index = menu.findIndex((itm) => itm.id === item.id);\n        if (index >= 0) menu.splice(index, 1, item);\n        else menu.push(item);\n        this.updateMenu(this._org.building.id, menu).then(() =>\n            this._menu.next([...menu])\n        );\n    }\n\n    public async addOption(\n        item: CateringItem,\n        option: CateringOption = {} as any\n    ) {\n        const types = unique(item.options.map((i) => i.group));\n        const ref = this._dialog.open<\n            CateringItemOptionModalComponent,\n            CateringItemOptionModalData\n        >(CateringItemOptionModalComponent, {\n            data: {\n                parent: item,\n                option,\n                types,\n            },\n        });\n        const details = await Promise.race([\n            ref.componentInstance.event\n                .pipe(first((_) => _.reason === 'done'))\n                .toPromise(),\n            ref.afterClosed().toPromise(),\n        ]);\n        if (details?.reason !== 'done') return;\n        const menu = this._menu.getValue();\n        const index = menu.findIndex((itm) => itm.id === item.id);\n        if (index >= 0) {\n            menu.splice(index, 1, details.metadata.item);\n        } else {\n            menu.push(details.metadata.item);\n        }\n        this.updateMenu(this._org.building.id, menu).then(\n            () => {\n                this._menu.next([...menu]);\n                ref.close();\n            },\n            () => (ref.componentInstance.loading = false)\n        );\n    }\n\n    public async selectOptions(options: CateringOption[]) {\n        const ref = this._dialog.open<\n            CateringOrderOptionsModalComponent,\n            CateringOrderOptionsModalData\n        >(CateringOrderOptionsModalComponent, {\n            data: {\n                code: this._currency.getValue(),\n                options,\n            },\n        });\n        const details = await Promise.race([\n            ref.componentInstance.event\n                .pipe(first((_) => _.reason === 'done'))\n                .toPromise(),\n            ref.afterClosed().toPromise(),\n        ]);\n        if (details?.reason !== 'done') return [];\n        ref.close();\n        return details.metadata.options;\n    }\n\n    public async deleteItem(item: CateringItem) {\n        const details = await openConfirmModal(\n            {\n                title: 'Delete Catering Item',\n                content: `Are you sure you wish to remove the catering item ${item.name} from the menu?`,\n                icon: {\n                    type: 'icon',\n                    class: 'material-icons',\n                    content: 'delete',\n                },\n            },\n            this._dialog\n        );\n        if (details.reason !== 'done') return;\n        details.loading('Removing catering item...');\n        const menu = this._menu.getValue().filter((itm) => item.id !== itm.id);\n        this.updateMenu(this._org.building.id, menu).then(\n            () => {\n                this._menu.next([...menu]);\n                details.close();\n            },\n            () => details.loading('')\n        );\n    }\n\n    public async deleteOption(item: CateringItem, option: CateringOption) {\n        const details = await openConfirmModal(\n            {\n                title: 'Delete Catering Item Option',\n                content: `Are you sure you wish to remove the catering option \"${option.name}\" from \"${item.name}\"?`,\n                icon: {\n                    type: 'icon',\n                    class: 'material-icons',\n                    content: 'delete',\n                },\n            },\n            this._dialog\n        );\n        if (details.reason !== 'done') return;\n        details.loading('Removing catering item option...');\n        const menu = this._menu.getValue();\n        menu.splice(\n            menu.findIndex((itm) => itm.id === item.id),\n            1,\n            new CateringItem({\n                ...item,\n                options: item.options.filter((opt) => opt.id !== option.id),\n            })\n        );\n        this.updateMenu(this._org.building.id, menu).then(\n            () => {\n                this._menu.next([...menu]);\n                details.close();\n            },\n            () => details.loading('')\n        );\n    }\n\n    public async editConfig() {\n        const config = await this.getCateringConfig(this._org.building.id);\n        const { require_notes } = await this.settings.pipe(take(1)).toPromise();\n        const menu = this._menu.getValue();\n        const types = unique(flatten(menu.map((i) => [i.category, ...i.tags])));\n        const ref = this._dialog.open<\n            CateringConfigModalComponent,\n            CateringConfigModalData\n        >(CateringConfigModalComponent, {\n            data: {\n                config,\n                types,\n                require_notes,\n                saveNotes: (b) => this.saveSettings({ require_notes: b }),\n            },\n        });\n        const details = await Promise.race([\n            ref.componentInstance.event\n                .pipe(first((_) => _.reason === 'done'))\n                .toPromise(),\n            ref.afterClosed().toPromise(),\n        ]);\n        if (details?.reason !== 'done') return;\n        this.updateConfig(this._org.building.id, details.metadata).then(\n            () => ref.close(),\n            () => (ref.componentInstance.loading = false)\n        );\n    }\n\n    public async importMenu() {\n        const ref = this._dialog.open(CateringImportMenuModalComponent);\n        const details = await Promise.race([\n            ref.componentInstance.event\n                .pipe(first((_) => _.reason === 'done'))\n                .toPromise(),\n            ref.afterClosed().toPromise(),\n        ]);\n        if (details?.reason !== 'done') return;\n        ref.componentInstance.loading = 'Updating menu...';\n        const menu = this._menu.getValue();\n        const bld = this._org.building;\n        const updated_menu = unique(details.metadata.concat(menu), 'id');\n        await this.updateMenu(bld.id, updated_menu).catch((_) => {\n            notifyError('Error importing catering menu');\n            ref.close();\n            throw _;\n        });\n        notifySuccess(\n            `Successfully imported catering menu. ${details.metadata.length} item(s) added.`\n        );\n        ref.close();\n    }\n\n    private updateMenu(zone_id: string, menu: CateringItem[]) {\n        return updateMetadata(zone_id, {\n            id: zone_id,\n            name: 'catering',\n            details: menu,\n            description: `Catering menu for ${zone_id}`,\n        }).toPromise();\n    }\n\n    public async saveSettings(settings: CateringSettings) {\n        const old_settings = await this.settings.pipe(take(1)).toPromise();\n        return updateMetadata(this._org.building.id, {\n            id: this._org.building.id,\n            name: 'catering-settings',\n            details: { ...old_settings, ...settings },\n            description: `Catering settings for ${this._org.building.id}`,\n        }).toPromise();\n    }\n\n    private async getCateringForZone(zone_id: string): Promise<CateringItem[]> {\n        const menu = (await showMetadata(zone_id, 'catering').toPromise())\n            .details;\n        return menu instanceof Array ? menu : [];\n    }\n\n    public async getCateringConfig(\n        zone_id: string = this._org.building.id\n    ): Promise<CateringRuleset[]> {\n        const rules = (\n            await showMetadata(zone_id, 'catering_config').toPromise()\n        ).details;\n        return rules instanceof Array ? (rules as any) : [];\n    }\n\n    private updateConfig(zone_id: string, config: CateringRuleset[]) {\n        return updateMetadata(zone_id, {\n            id: zone_id,\n            name: 'catering_config',\n            details: config,\n            description: `Catering menu config for ${zone_id}`,\n        }).toPromise();\n    }\n\n    public addItemToOrder(order: CateringOrder, new_item: CateringItem) {\n        let items = order.items;\n        const match = items.find(\n            (item) =>\n                item.id === new_item.id &&\n                new_item.options?.length ===\n                    item.options?.reduce(\n                        (c, o) =>\n                            c +\n                            (new_item.options.find((opt) => o.id === opt.id)\n                                ? 1\n                                : 0),\n                        0\n                    )\n        );\n        match\n            ? ((match as any).quantity += 1)\n            : (items = items.concat([\n                  new CateringItem({ ...new_item, quantity: 1 }),\n              ]));\n        const new_order = new CateringOrder({\n            ...order,\n            items,\n            event: null,\n        });\n        return new_order;\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { unique } from '@placeos/common';\n\nimport { CateringItem } from './catering-item.class';\nimport { CateringStateService } from './catering-state.service';\nimport { CateringOption } from './catering.interfaces';\n\n@Component({\n    selector: '[catering-menu-item]',\n    template: `\n        <div\n            class=\"w-full h-full bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-500 overflow-hidden rounded\"\n        >\n            <div item class=\"flex items-center px-2\" *ngIf=\"item\">\n                <mat-checkbox\n                    class=\"mr-2\"\n                    matTooltip=\"Allow Ordering Item\"\n                    [(ngModel)]=\"is_enabled\"\n                ></mat-checkbox>\n                <div class=\"flex items-center p-2 flex-1\">\n                    <div class=\"flex-1\">\n                        <div>{{ item.name }}</div>\n                        <div class=\"text-xs opacity-60\">\n                            {{ item.category }}\n                        </div>\n                    </div>\n                    <div\n                        class=\"p-2 m-2 text-xs font-bold text-white rounded bg-primary\"\n                    >\n                        {{ item.unit_price / 100 | currency: (symbol | async) }}\n                    </div>\n                </div>\n                <button\n                    icon\n                    matRipple\n                    [matMenuTriggerFor]=\"menu\"\n                    *ngIf=\"can_edit\"\n                >\n                    <app-icon>more_vert</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    [disabled]=\"!item.options.length\"\n                    (click)=\"show_options = !show_options\"\n                >\n                    <app-icon>expand_more</app-icon>\n                </button>\n            </div>\n            <div\n                options\n                *ngIf=\"item\"\n                class=\"bg-gray-100 dark:bg-neutral-700 overflow-hidden\"\n                [style.height]=\"\n                    show_options ? item.options.length * 3.5 + 'rem' : '0'\n                \"\n            >\n                <div\n                    class=\"flex p-2 items-center border-t border-solid border-gray-300 dark:border-neutral-500 relative\"\n                    *ngFor=\"let option of item.options\"\n                >\n                    <div\n                        class=\"absolute inset-y-0 left-0 w-2 bg-gray-400 dark:bg-neutral-600\"\n                    ></div>\n                    <div class=\"flex-1 pl-4 pr-2\">\n                        <div class=\"text\">{{ option.name }}</div>\n                        <div class=\"text-xs opacity-60\">\n                            {{ option.group }}\n                        </div>\n                    </div>\n                    <button\n                        edit\n                        icon\n                        matRipple\n                        class=\"mx-2\"\n                        (click)=\"editOption(option)\"\n                        *ngIf=\"can_edit\"\n                    >\n                        <app-icon>edit</app-icon>\n                    </button>\n                    <button\n                        remove\n                        icon\n                        matRipple\n                        class=\"mx-2\"\n                        (click)=\"removeOption(option)\"\n                        *ngIf=\"can_edit\"\n                    >\n                        <app-icon>delete</app-icon>\n                    </button>\n                </div>\n            </div>\n            <mat-menu #menu=\"matMenu\">\n                <button\n                    mat-menu-item\n                    class=\"flex items-center\"\n                    (click)=\"addOption()\"\n                >\n                    <app-icon>add</app-icon>\n                    <div class=\"ml-2\">Add Option</div>\n                </button>\n                <button\n                    mat-menu-item\n                    class=\"flex items-center\"\n                    (click)=\"editItem()\"\n                >\n                    <app-icon>edit</app-icon>\n                    <div class=\"ml-2\">Edit Item</div>\n                </button>\n                <button\n                    mat-menu-item\n                    class=\"flex items-center\"\n                    (click)=\"removeItem()\"\n                >\n                    <app-icon>delete</app-icon>\n                    <div class=\"ml-2\">Remove Item</div>\n                </button>\n            </mat-menu>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                overflow: hidden;\n                width: 48rem;\n                margin: 0.5rem auto;\n                max-width: calc(100vw - 1rem);\n            }\n\n            button[mat-menu-item] {\n                display: flex;\n            }\n\n            [options] {\n                transition: height 200ms;\n            }\n        `,\n    ],\n})\nexport class CateringMenuItemComponent {\n    /** Item to display */\n    @Input() public item: CateringItem;\n    /** Whether to show item options */\n    public show_options = false;\n\n    public readonly addOption = () => this._catering.addOption(this.item);\n\n    public readonly editOption = (option: CateringOption) =>\n        this._catering.addOption(this.item, option);\n\n    public readonly removeOption = (option: CateringOption) =>\n        this._catering.deleteOption(this.item, option);\n\n    public readonly editItem = () => this._catering.addItem(this.item);\n\n    public readonly removeItem = () => this._catering.deleteItem(this.item);\n\n    public get can_edit() {\n        return this._catering.is_editable;\n    }\n\n    public get is_enabled() {\n        return !this.item.hide_for_zones.includes(this._catering.zone);\n    }\n\n    public set is_enabled(state: boolean) {\n        let list = this.item.hide_for_zones;\n        if (!state) list = unique([...list, this._catering.zone]);\n        else list = list.filter((_) => _ !== this._catering.zone);\n        this._catering.updateItem(\n            new CateringItem({ ...this.item, hide_for_zones: list })\n        );\n    }\n\n    /** Currency symbol for active menu */\n    public get symbol() {\n        return this._catering.currency;\n    }\n\n    constructor(private _catering: CateringStateService) {}\n}\n","import { Component } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { CateringStateService } from './catering-state.service';\n\n@Component({\n    selector: 'catering-menu',\n    template: `\n        <mat-tab-group\n            class=\"h-full\"\n            (selectedIndexChange)=\"\n                shown_tab.next($event === 0 ? '' : categories[$event - 1])\n            \"\n        >\n            <mat-tab label=\"All Items\">\n                <ng-container *ngIf=\"(menu | async)?.length; else empty_state\">\n                    <ng-container *ngFor=\"let item of menu | async\">\n                        <div catering-menu-item [item]=\"item\"></div>\n                    </ng-container>\n                </ng-container>\n            </mat-tab>\n            <mat-tab\n                *ngFor=\"let group of categories\"\n                [attr.label]=\"group\"\n                [label]=\"group\"\n            >\n                <ng-container *ngFor=\"let item of (tab_menu | async)[group]\">\n                    <div catering-menu-item [item]=\"item\"></div>\n                </ng-container>\n            </mat-tab>\n        </mat-tab-group>\n        <ng-template #empty_state>\n            <div class=\"flex flex-col items-center p-8 space-y-2\">\n                <app-icon>close</app-icon>\n                <p>No items in menu</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 90%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class CateringMenuComponent {\n    /** Observable for the currently active menu */\n    public readonly menu = this._catering.menu;\n    /** Store for the currently selected tab */\n    public readonly shown_tab = new BehaviorSubject<string>('');\n    /** Observable for the menu list for the selected tab */\n    public readonly tab_menu = this.menu.pipe(\n        map((menu) => {\n            const menu_map = {};\n            for (const group of this.categories) {\n                menu_map[group] = menu.filter(\n                    (item) => item.category === group\n                );\n            }\n            return menu_map;\n        })\n    );\n\n    public get categories() {\n        return this._catering.categories;\n    }\n\n    constructor(private _catering: CateringStateService) {}\n}\n","import { Component, Input } from '@angular/core';\n\nimport { CateringItem } from './catering-item.class';\n\n@Component({\n    selector: '[catering-order-item]',\n    template: `\n        <ng-container *ngIf=\"item\">\n            <div class=\"w-20 text-right h-14 relative\">\n                <div\n                    class=\"border-b-2 border-l-2 border-gray-400 dark:border-neutral-500 w-4 h-16 absolute top-1/2 left-1/2 -translate-y-full\"\n                ></div>\n            </div>\n            <div class=\"w-12 mr-4\">\n                <button\n                    action\n                    icon\n                    matRipple\n                    class=\"border border-gray-300 dark:border-neutral-500 border-dashed text-xl text-dark-fade p-2\"\n                    [class.bg-success]=\"active\"\n                    [class.text-white]=\"active\"\n                    [class.border-solid]=\"active\"\n                    (click)=\"active = !active\"\n                >\n                    <app-icon>{{ active ? 'done' : 'local_pizza' }}</app-icon>\n                </button>\n            </div>\n            <div\n                class=\"flex flex-1 border-b border-gray-300 dark:border-neutral-500 border-solid py-4\"\n            >\n                <div class=\"flex-1\">{{ item?.name }}</div>\n                <div class=\"flex space-x-2 mr-2\">\n                    <ng-container *ngFor=\"let opt of item.option_list\">\n                        <div\n                            class=\"text-xs py-1 px-2 bg-yellow-300 text-black rounded-2xl shadow\"\n                            *ngIf=\"opt\"\n                        >\n                            {{ opt.name }}\n                        </div>\n                    </ng-container>\n                </div>\n            </div>\n        </ng-container>\n    `,\n    styles: [\n        `\n            :host:last-child > div {\n                border: none !important;\n            }\n        `,\n    ],\n})\nexport class CateringOrderItemComponent {\n    @Input() public item: CateringItem;\n\n    public active = false;\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, combineLatest, Observable } from 'rxjs';\nimport { map, switchMap, debounceTime, tap, shareReplay } from 'rxjs/operators';\nimport { startOfDay, endOfDay, getUnixTime } from 'date-fns';\n\nimport { AsyncHandler, flatten } from '@placeos/common';\nimport { queryEvents, saveEvent } from 'libs/events/src/lib/events.fn';\nimport { CalendarEvent } from 'libs/events/src/lib/event.class';\n\nimport { CateringOrder } from './catering-order.class';\nimport { CateringOrderStatus } from './catering.interfaces';\n\nexport interface CateringOrderFilters {\n    /** UTC epoch of the date to get catering orders for */\n    date?: number;\n    /** List of zones to filter catering order bookings */\n    zones?: string[];\n    /** Search string to filter orders on */\n    search?: string;\n}\n\nfunction checkOrder(\n    order: CateringOrder,\n    filters: CateringOrderFilters\n): boolean {\n    const s = (filters.search || '').toLowerCase();\n    return !!order.items.find(\n        (item) =>\n            item.name.toLowerCase().includes(s) ||\n            !!item.options.find((option) =>\n                option.name.toLowerCase().includes(s)\n            )\n    );\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class CateringOrdersService extends AsyncHandler {\n    private _poll = new BehaviorSubject<number>(0);\n    private _loading = new BehaviorSubject<boolean>(false);\n    private _filters = new BehaviorSubject<CateringOrderFilters>({});\n\n    /** Observable for list of orders */\n    public readonly orders: Observable<CateringOrder[]> = combineLatest([\n        this._filters,\n        this._poll,\n    ]).pipe(\n        debounceTime(500),\n        switchMap(([{ date, zones }]) => {\n            this._loading.next(true);\n            const start = getUnixTime(startOfDay(date || Date.now()));\n            const end = getUnixTime(endOfDay(date || Date.now()));\n            return queryEvents({\n                zone_ids: (zones || []).join(','),\n                period_start: start,\n                period_end: end,\n            });\n        }),\n        map((events) => flatten(events.map((event) => event.ext('catering')))),\n        tap(() => this._loading.next(false)),\n        shareReplay(1)\n    );\n    /** Observable for loading status of orders */\n    public readonly loading = this._loading.asObservable();\n    /** Order filters */\n    public get filters() {\n        return this._filters.getValue();\n    }\n    /** Order filters */\n    public set filters(filters: CateringOrderFilters) {\n        this._filters.next(filters);\n    }\n    /** Filtered list of catering orders */\n    public readonly filtered = this.orders.pipe(\n        map((list) =>\n            list.filter((order) => checkOrder(order, this._filters.getValue()))\n        )\n    );\n\n    constructor() {\n        super();\n        this.subscription('changes', this.orders.subscribe());\n    }\n\n    /** Start polling for catering orders */\n    public startPolling(delay: number = 15 * 1000) {\n        this.interval(\n            'polling',\n            () => this._poll.next(new Date().valueOf()),\n            delay\n        );\n    }\n\n    /** Stop polling for new catering orders */\n    public stopPolling() {\n        this.clearInterval('polling');\n    }\n\n    /**\n     * Update the status of the order\n     * @param order Order to update\n     * @param status New order status\n     */\n    public updateStatus(order: CateringOrder, status: CateringOrderStatus) {\n        const updated_order = new CateringOrder({ ...order, status });\n        const event = new CalendarEvent({\n            ...order.event,\n            catering: [\n                ...order.event.ext('catering').filter((o) => o.id !== order.id),\n                updated_order,\n            ].map((i) => new CateringOrder({ ...i })),\n        });\n        return saveEvent(event);\n    }\n}\n","import { Identity } from '@placeos/common';\n\nexport const CATERING_STATUSES: Identity[] = [\n    { id: 'pending', name: 'Pending', icon: { class: 'custom-pending' }, colour: '#ccc' },\n    { id: 'accepted', name: 'Accepted', icon: { class: 'custom-accepted' }, colour: '#3996B6' },\n    {\n        id: 'preparing',\n        name: 'Preparing',\n        icon: { class: 'custom-preparing' },\n        colour: '#E7536B',\n    },\n    { id: 'ready', name: 'Ready', icon: { class: 'custom-ready' }, colour: '#FFD028' },\n    {\n        id: 'delivered',\n        name: 'Delivered',\n        icon: { class: 'custom-delivered' },\n        colour: '#75BB43',\n    },\n    {\n        id: 'cancelled',\n        name: 'Cancelled',\n        icon: { class: 'custom-cancelled' },\n        colour: '#747474',\n    },\n];\n","import { Component, Input } from '@angular/core';\n\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from '@placeos/common';\n\nimport { CateringOrdersService } from './catering-orders.service';\nimport { CateringOrder } from './catering-order.class';\nimport { CATERING_STATUSES } from './catering.vars';\n\n@Component({\n    selector: 'catering-order',\n    template: `\n        <div\n            class=\"w-full flex items-center py-2 dark:bg-neutral-700\"\n            [class.bg-gray-100]=\"!show_items\"\n            [class.bg-gray-200]=\"show_items\"\n            *ngIf=\"order\"\n        >\n            <div\n                class=\"w-20 flex items-center justify-center z-20 h-full\"\n                [class.bg-gray-200]=\"show_items\"\n                [class.dark:bg-neutral-700]=\"show_items\"\n            >\n                <div\n                    class=\"rounded-full bg-gray-400 dark:bg-neutral-800 p-2 text-2xl text-black dark:text-white opacity-60 flex items-center justify-center\"\n                >\n                    <app-icon>room_service</app-icon>\n                </div>\n            </div>\n            <div time class=\"w-24\">\n                {{ order.deliver_at | date: 'shortTime' }}\n            </div>\n            <div class=\"flex-1\">\n                {{\n                    order.event?.space.display_name ||\n                        order.event?.space.name ||\n                        '~ No Location ~'\n                }}\n            </div>\n            <div class=\"w-56\">\n                {{\n                    order.event?.organiser?.name ||\n                        order.event?.host ||\n                        '~ Unknown Host ~'\n                }}\n            </div>\n            <div class=\"w-28\">{{ order.charge_code || '~ No Code ~' }}</div>\n            <div class=\"w-24\">\n                <button\n                    *ngIf=\"order.notes\"\n                    class=\"clear underline\"\n                    [matTooltip]=\"order.notes\"\n                >\n                    View\n                </button>\n            </div>\n            <div class=\"w-28\">\n                {{ order.invoice_number || '~ No Invoice ~' }}\n            </div>\n            <div class=\"w-36\">\n                <button\n                    name=\"status\"\n                    class=\"text-base border-none h-10 px-4 flex items-center text-white w-36\"\n                    matRipple\n                    [style.background]=\"status?.colour\"\n                    [matMenuTriggerFor]=\"menu\"\n                >\n                    <div class=\"flex text-center capitalize mx-2\">\n                        {{ status?.name }}\n                    </div>\n                    <app-icon class=\"pl-2\">arrow_drop_down</app-icon>\n                </button>\n            </div>\n            <div class=\"w-12\">\n                <button icon (click)=\"show_items = !show_items\">\n                    <app-icon>{{\n                        show_items\n                            ? 'keyboard_arrow_down'\n                            : 'keyboard_arrow_right'\n                    }}</app-icon>\n                </button>\n            </div>\n        </div>\n        <ul\n            *ngIf=\"order?.items.length\"\n            class=\"list-none p-0 m-0 w-full relative z-0\"\n            [class.shown]=\"show_items\"\n            [@show]=\"show_items ? 'show' : 'hide'\"\n        >\n            <li\n                catering-order-item\n                class=\"flex items-center\"\n                *ngFor=\"let item of order.items; let i = index\"\n                [item]=\"item\"\n            ></li>\n        </ul>\n        <mat-menu #menu=\"matMenu\">\n            <button\n                mat-menu-item\n                *ngFor=\"let status of statuses\"\n                class=\"flex items-center\"\n                (click)=\"updateStatus(status.id)\"\n            >\n                <div\n                    class=\"rounded-full h-4 w-4 mr-2\"\n                    [style.background-color]=\"status.colour\"\n                ></div>\n                <span class=\"mr-2 w-20\">{{ status.name }}</span>\n            </button>\n        </mat-menu>\n    `,\n    styles: [\n        `\n            [name='status'] {\n                border-radius: 1.55rem;\n            }\n\n            button[mat-menu-item] {\n                display: flex;\n            }\n\n            [name='bar'] {\n                width: 2px;\n                top: -0.5rem;\n                left: calc(2.5rem - 1px);\n            }\n        `,\n    ],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n})\nexport class CateringOrderComponent {\n    @Input() public order: CateringOrder;\n    /** Whether to show the items in the catering order */\n    public show_items = false;\n    /** List of status available to select */\n    public readonly statuses = CATERING_STATUSES;\n\n    public readonly updateStatus = (s) =>\n        this._orders.updateStatus(this.order, s);\n\n    public get status() {\n        return this.statuses.find((i) => i.id === this.order.status);\n    }\n\n    constructor(private _orders: CateringOrdersService) {}\n}\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { CateringOrder } from './catering-order.class';\n\nimport { CateringOrdersService } from './catering-orders.service';\n\n@Component({\n    selector: 'catering-order-list',\n    template: `\n        <div\n            class=\"sticky top-0 w-full text-sm font-medium flex items-center py-4 border-solid border-b border-gray-300 bg-white dark:bg-neutral-800 dark:border-neutral-500\"\n        >\n            <div class=\"w-20\"></div>\n            <div class=\"w-24\">Time</div>\n            <div class=\"flex-1\">Location</div>\n            <div class=\"w-56\">Host</div>\n            <div class=\"w-28\">Charge Code</div>\n            <div class=\"w-24\">Notes</div>\n            <div class=\"w-28\">Invoice No.</div>\n            <div class=\"w-36\">Status</div>\n            <div class=\"w-12\"></div>\n        </div>\n        <ul class=\"list-none p-0 m-0 w-full flex-1 overflow-auto\">\n            <li\n                class=\"border-solid border-b border-gray-300 dark:border-neutral-500\"\n                *ngFor=\"let order of order_list | async; trackBy: trackByFn\"\n            >\n                <catering-order [order]=\"order\"></catering-order>\n            </li>\n            <div\n                empty\n                class=\"info-block opacity-60\"\n                *ngIf=\"!(order_list | async)?.length\"\n            >\n                <p>No Catering Orders</p>\n            </div>\n        </ul>\n        <mat-progress-bar\n            *ngIf=\"loading | async\"\n            class=\"w-full\"\n            mode=\"indeterminate\"\n        ></mat-progress-bar>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class CateringOrderListComponent implements OnInit, OnDestroy {\n    /** List of filtered orders */\n    public readonly order_list = this._orders.filtered;\n    /** Whether order list is loading */\n    public readonly loading = this._orders.loading;\n\n    constructor(private _orders: CateringOrdersService) {}\n\n    public ngOnInit() {\n        this._orders.startPolling();\n    }\n\n    public ngOnDestroy() {\n        this._orders.stopPolling();\n    }\n\n    /* istanbul ignore next */\n    public trackByFn(index: number, order: CateringOrder) {\n        return order ? order.id : undefined;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { SettingsService, unique } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { PlaceMetadata, showMetadata } from '@placeos/ts-client';\nimport { BehaviorSubject, combineLatest, Observable, of } from 'rxjs';\nimport {\n    catchError,\n    filter,\n    map,\n    shareReplay,\n    switchMap,\n    tap,\n} from 'rxjs/operators';\nimport { CateringItem } from '../catering-item.class';\nimport { cateringItemAvailable, getCateringRulesForZone } from '../utilities';\nimport { CateringSettings } from '../catering-state.service';\nimport { Space } from 'libs/spaces/src/lib/space.class';\n\nexport interface CateringOrderOptions {\n    // Affects backend requests\n    zone?: string;\n}\n\nexport interface CateringOrderFilters {\n    // Affects frontend filtering\n    date?: number;\n    duration?: number;\n    zone_id?: string;\n    resources?: Space[];\n    search: string;\n    tags: string[];\n    categories: string[];\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class CateringOrderStateService {\n    private _options = new BehaviorSubject<CateringOrderOptions>({});\n    private _filters = new BehaviorSubject<CateringOrderFilters>({\n        search: '',\n        tags: [],\n        categories: [],\n    });\n    private _loading = new BehaviorSubject('');\n\n    public readonly loading = this._loading.asObservable();\n    public readonly filters = this._filters.asObservable();\n\n    public readonly settings = this._org.active_building.pipe(\n        filter((_) => !!_),\n        switchMap((_) =>\n            showMetadata(_.id, 'catering-settings').pipe(\n                catchError((_) => of({} as PlaceMetadata))\n            )\n        ),\n        map((_) => _.details as CateringSettings),\n        tap((_) =>\n            this._settings.post('require_catering_notes', !!_.require_notes)\n        ),\n        shareReplay(1)\n    );\n\n    public readonly charge_codes = this.settings.pipe(\n        map((_) => _.charge_codes || [])\n    );\n    public readonly availability = this.settings.pipe(\n        map((_) => _.disabled_rooms || [])\n    );\n\n    public readonly available_menu: Observable<CateringItem[]> = combineLatest([\n        this._options,\n        this._org.active_building,\n    ]).pipe(\n        filter(([_, bld]) => !!bld),\n        switchMap(([{ zone }, bld]) => {\n            this._loading.next('[Menu]');\n            return showMetadata(zone || bld.id, 'catering').pipe(\n                map((d) => d.details.map((_) => new CateringItem(_))),\n                catchError((_) => [])\n            );\n        }),\n        tap((_) => this._loading.next('')),\n        shareReplay(1)\n    );\n\n    public readonly categories = this.available_menu.pipe(\n        map((_) => unique(_.map((i) => i.category)))\n    );\n\n    public readonly filtered_menu = combineLatest([\n        this._filters,\n        this.available_menu,\n    ]).pipe(\n        switchMap(\n            async ([\n                {\n                    search,\n                    tags,\n                    categories,\n                    zone_id,\n                    date,\n                    duration,\n                    resources,\n                },\n                l,\n            ]) => {\n                const rules = await getCateringRulesForZone(\n                    zone_id\n                ).toPromise();\n                search = search.toLowerCase();\n                let list = search\n                    ? l.filter((_) => _.name.toLowerCase().includes(search))\n                    : l;\n                list = tags.length\n                    ? list.filter((_) => tags.every((t) => _.tags.includes(t)))\n                    : list;\n                list = categories.length\n                    ? list.filter((_) => categories.includes(_.category))\n                    : list;\n                list = list.filter((_) =>\n                    cateringItemAvailable(_, rules, {\n                        date,\n                        duration,\n                        resources,\n                    } as any)\n                );\n                return list;\n            }\n        ),\n        shareReplay(1)\n    );\n\n    public get currency_code() {\n        return this._org.currency_code;\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _settings: SettingsService\n    ) {}\n\n    public setOptions(opts: Partial<CateringOrderOptions>) {\n        this._options.next({ ...this._options.getValue(), ...opts });\n    }\n\n    public setFilters(opts: Partial<CateringOrderFilters>) {\n        this._filters.next({ ...this._filters.getValue(), ...opts });\n    }\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { CateringItem } from '../catering-item.class';\n\n@Component({\n    selector: 'catering-item-list-item',\n    template: `\n        <li\n            item\n            [class.!border-black]=\"active\"\n            class=\"relative p-2 rounded-lg w-full shadow border bg-white dark:bg-neutral-600 border-gray-200 dark:border-neutral-500 sm:w-[20rem]\"\n        >\n            <button\n                matRipple\n                name=\"select-catering-item\"\n                class=\"w-full h-full flex items-center\"\n                (click)=\"select.emit()\"\n            >\n                <div\n                    class=\"relative w-16 h-16 rounded-xl bg-black/20 mr-4 overflow-hidden border border-gray-100 dark:border-neutral-600 flex items-center justify-center\"\n                >\n                    <div\n                        class=\"absolute top-1 left-1 border border-white bg-black/50 rounded-full h-6 w-6 flex items-center justify-center text-white text-xs\"\n                        *ngIf=\"item.quantity && selected\"\n                    >\n                        {{ item.quantity || '1' }}\n                    </div>\n                    <img\n                        *ngIf=\"item.images?.length; else placeholder\"\n                        class=\"object-cover min-h-full min-w-full\"\n                        [src]=\"item.images[0]\"\n                    />\n                    <ng-template #placeholder>\n                        <img\n                            class=\"m-auto\"\n                            src=\"assets/icons/catering-placeholder.svg\"\n                        />\n                    </ng-template>\n                </div>\n                <div class=\"space-y-2 text-left flex-1\">\n                    <div class=\"font-medium flex flex-col pr-10\">\n                        <div>{{ item.name || 'Item' }}</div>\n                        <div class=\"opacity-60 text-xs\">\n                            {{ item.category }}\n                        </div>\n                    </div>\n                    <div class=\"flex items-center text-sm space-x-1\">\n                        <p\n                            class=\"flex-1 w-px bg-white rounded\"\n                            *ngIf=\"item.unit_price\"\n                        >\n                            {{ item.unit_price / 100 | currency: code }}\n                        </p>\n                        <div\n                            class=\"text-xs px-2 py-1 rounded-2xl shadow border border-gray-100\"\n                            *ngIf=\"item.option_list.length\"\n                        >\n                            {{ options }}\n                        </div>\n                        <div\n                            class=\"text-xs h-5 w-7 rounded-xl shadow bg-green-500 flex items-center justify-center\"\n                            *ngIf=\"item.tags?.includes('Gluten Free')\"\n                        >\n                            GF\n                        </div>\n                        <div\n                            class=\"text-xs h-5 w-7 rounded-xl shadow bg-blue-600 flex items-center justify-center\"\n                            *ngIf=\"item.tags?.includes('Vegan')\"\n                        >\n                            VG\n                        </div>\n                        <div\n                            class=\"text-xs h-5 w-7 rounded-xl shadow bg-blue-400 flex items-center justify-center\"\n                            *ngIf=\"item.tags?.includes('Vegetarian')\"\n                        >\n                            V\n                        </div>\n                        <div\n                            class=\"text-xs h-5 w-7 rounded-xl shadow bg-yellow-500 flex items-center justify-center\"\n                            *ngIf=\"item.tags?.includes('Contains Dairy')\"\n                        >\n                            D\n                        </div>\n                        <div\n                            class=\"text-xs h-5 w-7 rounded-xl shadow bg-orange-600 flex items-center justify-center\"\n                            *ngIf=\"item.tags?.includes('Contains Nuts')\"\n                        >\n                            N\n                        </div>\n                    </div>\n                </div>\n            </button>\n            <button\n                icon\n                matRipple\n                name=\"toggle-catering-item-favourite\"\n                class=\"absolute top-1 right-1\"\n                [class.text-blue-400]=\"favourite\"\n                (click)=\"toggleFav.emit()\"\n            >\n                <app-icon>{{\n                    favourite ? 'favorite' : 'favorite_border'\n                }}</app-icon>\n            </button>\n        </li>\n    `,\n    styles: [``],\n})\nexport class CateringItemListItemComponent {\n    @Input() public item: CateringItem;\n    @Input() public active = false;\n    @Input() public selected = false;\n    @Input() public favourite = false;\n    @Input() public code: string = 'USD';\n    @Output() public toggleFav = new EventEmitter();\n    @Output() public select = new EventEmitter();\n\n    public get options() {\n        return this.item.option_list.map((_) => _.name).join(', ');\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map, shareReplay } from 'rxjs/operators';\nimport { CateringItem } from '../catering-item.class';\nimport { CateringStateService } from '../catering-state.service';\nimport { CateringOrderStateService } from './catering-order-state.service';\n\n@Component({\n    selector: 'catering-item-list',\n    template: `\n        <div class=\"w-full h-full overflow-auto py-2\">\n            <ng-container *ngIf=\"(custom_items | async)?.length\">\n                <h3 class=\"font-bold px-2\">Ordered Items</h3>\n                <p count class=\"text-sm opacity-60 mb-2 px-2\">\n                    {{ (custom_items | async)?.length || 0 }} items(s)\n                </p>\n\n                <ul class=\"list-style-none space-y-2 p-2\">\n                    <catering-item-list-item\n                        class=\"block\"\n                        *ngFor=\"let item of custom_items | async\"\n                        [item]=\"item\"\n                        [active]=\"active === item.custom_id\"\n                        [selected]=\"true\"\n                        [favourite]=\"isFavourite(item.id)\"\n                        (toggleFav)=\"toggleFav.emit(item.id)\"\n                        (select)=\"selectItem(item, true)\"\n                    ></catering-item-list-item>\n                </ul>\n            </ng-container>\n            <h3 class=\"font-bold px-2\">Results</h3>\n            <p count class=\"text-sm opacity-60 mb-2 px-2\">\n                {{ (item_list | async)?.length || 0 }} result(s) found\n            </p>\n            <ng-container *ngIf=\"!(loading | async); else load_state\">\n                <ul\n                    class=\"list-style-none space-y-2 p-2\"\n                    *ngIf=\"(item_list | async)?.length; else empty_state\"\n                >\n                    <catering-item-list-item\n                        class=\"block\"\n                        *ngFor=\"let item of item_list | async\"\n                        [item]=\"item\"\n                        [active]=\"active === item.custom_id\"\n                        [selected]=\"selected.includes(item.custom_id)\"\n                        [favourite]=\"isFavourite(item.id)\"\n                        [code]=\"code\"\n                        (toggleFav)=\"toggleFav(item.id)\"\n                        (select)=\"selectItem(item, true)\"\n                    ></catering-item-list-item>\n                </ul>\n            </ng-container>\n        </div>\n        <ng-template #empty_state>\n            <div\n                empty\n                class=\"p-16 flex flex-col items-center justify-center space-y-2\"\n            >\n                <p class=\"opacity-30 text-center\">\n                    No available items for selected time and/or filters\n                </p>\n            </div>\n        </ng-template>\n        <ng-template #load_state>\n            <div\n                loading\n                class=\"p-16 flex flex-col items-center justify-center space-y-2\"\n            >\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p class=\"opacity-30\">Finding available items...</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class CateringItemListComponent {\n    @Input() public active: string = '';\n    @Input() public selected: string = '';\n    @Input() public selected_items: CateringItem[] = [];\n    @Input() public favorites: string[] = [];\n    @Output() public toggleFav = new EventEmitter<CateringItem>();\n    @Output() public onSelect = new EventEmitter<CateringItem>();\n\n    public readonly list = new BehaviorSubject<CateringItem[]>([]);\n    public readonly loading = this._state.loading;\n    public readonly item_list = this._state.filtered_menu;\n    public readonly custom_items = combineLatest([\n        this.list,\n        this._state.available_menu,\n    ]).pipe(map(([l, m]) => l.filter((_) => _.option_list?.length)));\n\n    public get code() {\n        return this._state.currency_code;\n    }\n\n    constructor(private _state: CateringOrderStateService) {}\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.selected_items) {\n            this.list.next(this.selected_items || []);\n        }\n    }\n\n    public isFavourite(item_id: string) {\n        return this.favorites?.includes(item_id);\n    }\n\n    public selectItem(item: CateringItem, clear_state: boolean = false) {\n        this.onSelect.emit(item);\n        if (clear_state) {\n            item.options?.forEach((_) => delete _.active);\n        }\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { unique } from '@placeos/common';\nimport { CateringItem } from '../catering-item.class';\nimport { CateringOption } from '../catering.interfaces';\n\ninterface CateringOptionGroup {\n    name: string;\n    multiple: boolean;\n    options: CateringOption[];\n}\n\n@Component({\n    selector: 'catering-item-details',\n    template: `\n        <ng-container *ngIf=\"item; else empty_state\">\n            <section image class=\"relative w-full h-64 sm:h-40 bg-black/20\">\n                <image-carousel\n                    [images]=\"item.images\"\n                    class=\"absolute inset-0\"\n                ></image-carousel>\n                <button\n                    icon\n                    matRipple\n                    name=\"close-catering-item-details\"\n                    (click)=\"close.emit()\"\n                    class=\"absolute top-2 left-2 bg-black/40 sm:hidden text-white\"\n                >\n                    <app-icon>arrow_back</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    name=\"toggle-catering-item-favourite-details\"\n                    [class.text-white]=\"!fav\"\n                    [class.text-blue-400]=\"fav\"\n                    (click)=\"toggleFav.emit()\"\n                    class=\"absolute top-2 right-2 bg-black/40\"\n                >\n                    <app-icon>{{\n                        fav ? 'favorite' : 'favorite_border'\n                    }}</app-icon>\n                </button>\n            </section>\n            <div class=\"p-2 space-y-2 flex-1 h-1/2 overflow-auto\">\n                <section actions class=\"z-0 flex items-center justify-between\">\n                    <div>\n                        <h2 class=\"text-xl font-medium mb-2 mt-4\">\n                            {{ item.name }}\n                        </h2>\n                        <p *ngIf=\"item.unit_price\">\n                            {{ item.unit_price / 100 | currency: code }}\n                        </p>\n                    </div>\n                    <a-counter\n                        [(ngModel)]=\"item.quantity\"\n                        [min]=\"1\"\n                        [max]=\"item.count || 10\"\n                    ></a-counter>\n                </section>\n                <section class=\"flex items-center flex-wrap\">\n                    <div\n                        class=\"px-2 py-1 rounded-2xl bg-gray-200 dark:bg-neutral-500 text-sm capitalize m-1\"\n                        *ngFor=\"let tag of item.tags\"\n                    >\n                        {{ tag }}\n                    </div>\n                </section>\n                <hr />\n                <section details class=\"space-y-2\">\n                    <div class=\"flex flex-col flex-wrap\">\n                        <div\n                            class=\"min-w-1/2 flex-1\"\n                            *ngFor=\"let group of groups\"\n                            [attr.group]=\"group.name\"\n                        >\n                            <div class=\"font-medium p-2 capitalize\">\n                                {{ group.name }}\n                            </div>\n                            <div class=\"flex flex-col pl-4\">\n                                <ng-container\n                                    *ngIf=\"!group.multiple; else multi_options\"\n                                >\n                                    <mat-radio-group\n                                        class=\"flex flex-col\"\n                                        aria-label=\"Select an option\"\n                                        [(ngModel)]=\"group_state[group.name]\"\n                                        (ngModelChange)=\"\n                                            updateGroupOption(group, $event)\n                                        \"\n                                    >\n                                        <mat-radio-button class=\"m-0\" value=\"\">\n                                            <span class=\"font-medium p-2\" i18n\n                                                >None</span\n                                            >\n                                        </mat-radio-button>\n                                        <mat-radio-button\n                                            class=\"m-0\"\n                                            *ngFor=\"let opt of group?.options\"\n                                            [value]=\"opt.id\"\n                                        >\n                                            <div\n                                                class=\"flex items-center justify-center max-w-[calc(100vw-4rem)] sm:max-w-[15rem]\"\n                                            >\n                                                <div\n                                                    class=\"font-medium p-2 flex-1 w-1/2 whitespace-normal\"\n                                                >\n                                                    {{ opt.name }}\n                                                </div>\n                                                <div\n                                                    class=\"opacity-60 text-xs\"\n                                                    *ngIf=\"opt.unit_price\"\n                                                >\n                                                    +{{\n                                                        opt.unit_price / 100\n                                                            | currency: code\n                                                    }}\n                                                </div>\n                                            </div>\n                                        </mat-radio-button>\n                                    </mat-radio-group>\n                                </ng-container>\n                                <ng-template #multi_options>\n                                    <mat-checkbox\n                                        *ngFor=\"let opt of group?.options\"\n                                        [(ngModel)]=\"option_state[opt.id]\"\n                                        (ngModelChange)=\"\n                                            updateCheckedState(opt.id, $event)\n                                        \"\n                                    >\n                                        <div\n                                            class=\"flex items-center justify-center\"\n                                        >\n                                            <div\n                                                class=\"font-medium p-2 flex-1 w-1/2\"\n                                            >\n                                                {{ opt.name }}\n                                            </div>\n                                            <div\n                                                class=\"opacity-60 text-xs\"\n                                                *ngIf=\"opt.unit_price\"\n                                            >\n                                                +{{\n                                                    opt.unit_price / 100\n                                                        | currency: code\n                                                }}\n                                            </div>\n                                        </div>\n                                    </mat-checkbox>\n                                </ng-template>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n            </div>\n            <div\n                class=\"px-2 pt-2 pb-[5.5rem] border-t border-gray-200 shadow sm:hidden\"\n            >\n                <button\n                    btn\n                    matRipple\n                    name=\"select-catering-item-details\"\n                    [class.inverse]=\"active\"\n                    class=\"w-full\"\n                    (click)=\"active = !active; activeChange.emit(active)\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        <app-icon class=\"text-2xl\">{{\n                            active ? 'remove' : 'add'\n                        }}</app-icon>\n                        <p>\n                            {{ active ? 'Remove this item' : 'Add this item' }}\n                        </p>\n                    </div>\n                </button>\n            </div>\n        </ng-container>\n        <ng-template #empty_state>\n            <div\n                empty\n                class=\"p-16 flex flex-col items-center justify-center space-y-2\"\n            >\n                <p class=\"opacity-30 text-center\" i18n>\n                    Select an item to view it's details\n                </p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                width: 30%;\n                min-width: 20rem;\n                height: 100%;\n                min-height: 65vh;\n            }\n        `,\n    ],\n})\nexport class CateringItemDetailsComponent {\n    @Input() public item?: CateringItem;\n    @Input() public active: boolean = false;\n    @Input() public fav: boolean = false;\n    @Input() public code: string = 'USD';\n\n    @Output() public toggleFav = new EventEmitter<void>();\n    @Output() public activeChange = new EventEmitter<boolean>();\n    @Output() public close = new EventEmitter<void>();\n\n    public option_state: Record<string, boolean> = {};\n    public group_state: Record<string, string> = {};\n    public groups: CateringOptionGroup[];\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.item && this.item) {\n            this._update();\n        }\n    }\n\n    public updateGroupOption(group: CateringOptionGroup, id: string) {\n        if (!group) return;\n        this.group_state[group.name] = id;\n        for (const option of group.options) {\n            option.active = option.id === id;\n        }\n    }\n\n    public updateCheckedState(id: string, state: boolean) {\n        const option = this.item?.options.find((_) => _.id === id);\n        if (option) option.active = state;\n    }\n\n    private _update() {\n        if (!this.item) return;\n        if (!this.item.quantity) {\n            (this.item as any).quantity = 1;\n        }\n        this.option_state = {};\n        this.group_state = {};\n        const groups = unique(this.item.options.map((i) => i.group || 'Other'));\n        const group_list = [];\n        for (const group of groups) {\n            const options = this.item.options.filter((i) => i.group === group);\n            group_list.push({\n                name: group,\n                multiple: !!options.find((i) => i.multiple),\n                options,\n            });\n        }\n        this.groups = group_list;\n        if (this.item.option_list) {\n            for (const opt of this.item.option_list) {\n                const option = this.item.options.find((_) => _.id === opt.id);\n                if (option) {\n                    option.active = true;\n                    this.option_state[opt.id] = true;\n                    this.updateGroupOption(\n                        this.groups.find((g) => g.name === option.group),\n                        option.id\n                    );\n                }\n            }\n        }\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { take } from 'rxjs/operators';\nimport { CateringOrderStateService } from './catering-order-state.service';\n\nconst ICONS = {\n    coffee: `<svg width=\"40\" height=\"40\" viewBox=\"0 0 40 40\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clip-path=\"url(#clip0_605_8664)\">\n    <path d=\"M38.388 21.2474C37.8243 20.7996 37.1598 20.4847 36.4474 20.3278C35.735 20.1708 34.9944 20.1762 34.2846 20.3434C34.2476 19.7774 34.2049 19.2037 34.1483 18.6155C34.1243 18.3664 34.0043 18.1349 33.8119 17.9668C33.6195 17.7986 33.3687 17.706 33.1088 17.707H1.26151C1.00166 17.706 0.750839 17.7986 0.558442 17.9668C0.366045 18.1349 0.246035 18.3664 0.222073 18.6155C-0.42931 25.3581 0.106585 30.5307 4.80024 35.4799C8.88062 39.7819 15.7271 39.9998 17.0599 39.9998H17.3047C18.6375 39.9998 25.4863 39.7774 29.5643 35.4799C30.5412 34.4597 31.3937 33.3353 32.1052 32.1286C32.2481 32.1199 32.3875 32.0819 32.514 32.0174C34.0959 31.2139 35.6169 30.3039 37.0656 29.2943C38.3815 28.4227 39.3664 27.1618 39.871 25.7028C40.0702 24.9006 40.0372 24.0612 39.7758 23.2757C39.5144 22.4902 39.0344 21.7887 38.388 21.2474ZM28.0329 34.13C24.4699 37.8905 18.0323 37.9984 17.3093 37.9984H17.0645C16.3426 37.9984 9.90389 37.8872 6.34092 34.13C2.37257 29.9436 1.75351 25.466 2.21549 19.7085H32.1583C32.6214 25.4649 32.0024 29.9425 28.0329 34.13ZM37.8498 25.2091C37.4485 26.2369 36.7212 27.117 35.771 27.7243C35.024 28.2636 34.2434 28.7582 33.4334 29.2053C34.1268 27.0036 34.4428 24.7078 34.3689 22.4082C34.3839 22.4027 34.3989 22.4082 34.4139 22.3982C34.8447 22.2182 35.3192 22.1579 35.7837 22.2242C36.2482 22.2905 36.6841 22.4808 37.0421 22.7733C37.4001 23.0659 37.6658 23.4491 37.8092 23.8796C37.9525 24.3101 37.9678 24.7707 37.8533 25.2091H37.8498Z\" fill=\"currentcolor\"/>\n    <path d=\"M9.43243 8.16274C9.85735 8.48322 10.2069 8.88673 10.4582 9.34669C10.7094 9.80666 10.8565 10.3126 10.89 10.8313C10.7939 11.9569 10.2754 13.0103 9.43128 13.7946C9.32937 13.883 9.24664 13.9899 9.18786 14.1092C9.12907 14.2286 9.0954 14.3579 9.08878 14.4898C9.08216 14.6217 9.10275 14.7536 9.14931 14.8778C9.19588 15.002 9.26753 15.1161 9.36012 15.2136C9.45271 15.311 9.56442 15.3898 9.6888 15.4455C9.81319 15.5012 9.9478 15.5326 10.0849 15.538C10.2219 15.5433 10.3587 15.5225 10.4874 15.4767C10.6161 15.4309 10.734 15.3611 10.8345 15.2712C12.1048 14.1093 12.8679 12.5254 12.9688 10.8413C12.9432 10.042 12.7392 9.25727 12.3708 8.5405C12.0023 7.82373 11.478 7.19166 10.8334 6.68722C10.4067 6.38353 10.055 5.99283 9.80341 5.54303C9.55184 5.09323 9.40662 4.59547 9.37815 4.08534C9.51392 3.18283 10.0073 2.36595 10.7548 1.80591C10.9718 1.64618 11.1147 1.41065 11.1528 1.15024C11.1908 0.889843 11.1208 0.625512 10.958 0.414392C10.7951 0.203272 10.5525 0.062327 10.2826 0.0220596C10.0127 -0.0182078 9.73715 0.0454338 9.51559 0.199206C8.90219 0.651996 8.39004 1.21933 8.0098 1.86721C7.62956 2.5151 7.38907 3.2302 7.30273 3.9697C7.30292 4.77855 7.49485 5.5767 7.86392 6.30333C8.23298 7.02996 8.76944 7.66592 9.43243 8.16274Z\" fill=\"currentcolor\"/>\n    <path d=\"M23.0984 8.16274C23.5234 8.48322 23.8729 8.88673 24.1242 9.34669C24.3754 9.80666 24.5225 10.3126 24.556 10.8313C24.4599 11.9569 23.9414 13.0103 23.0973 13.7946C22.9954 13.883 22.9126 13.9899 22.8539 14.1092C22.7951 14.2286 22.7614 14.3579 22.7548 14.4898C22.7482 14.6217 22.7687 14.7536 22.8153 14.8778C22.8619 15.002 22.9335 15.1161 23.0261 15.2136C23.1187 15.311 23.2304 15.3898 23.3548 15.4455C23.4792 15.5012 23.6138 15.5326 23.7509 15.538C23.8879 15.5433 24.0247 15.5225 24.1534 15.4767C24.2821 15.4309 24.4 15.3611 24.5005 15.2712C25.7708 14.1093 26.5339 12.5254 26.6348 10.8413C26.6092 10.042 26.4052 9.25727 26.0368 8.5405C25.6683 7.82373 25.144 7.19166 24.4994 6.68722C24.0727 6.38353 23.721 5.99283 23.4694 5.54303C23.2178 5.09323 23.0726 4.59547 23.0442 4.08534C23.1799 3.18283 23.6733 2.36595 24.4208 1.80591C24.6378 1.64618 24.7807 1.41065 24.8188 1.15024C24.8568 0.889843 24.7868 0.625512 24.624 0.414392C24.4611 0.203272 24.2185 0.062327 23.9486 0.0220596C23.6787 -0.0182078 23.4032 0.0454338 23.1816 0.199206C22.5682 0.651996 22.0561 1.21933 21.6758 1.86721C21.2956 2.5151 21.0551 3.2302 20.9688 3.9697C20.9689 4.77855 21.1609 5.5767 21.5299 6.30333C21.899 7.02996 22.4355 7.66592 23.0984 8.16274Z\" fill=\"currentcolor\"/>\n    <path d=\"M16.2645 8.16274C16.6894 8.48322 17.039 8.88673 17.2902 9.34669C17.5414 9.80666 17.6886 10.3126 17.722 10.8313C17.626 11.9569 17.1074 13.0103 16.2633 13.7946C16.1614 13.883 16.0787 13.9899 16.0199 14.1092C15.9611 14.2286 15.9274 14.3579 15.9208 14.4898C15.9142 14.6217 15.9348 14.7536 15.9813 14.8778C16.0279 15.002 16.0996 15.1161 16.1922 15.2136C16.2847 15.311 16.3964 15.3898 16.5208 15.4455C16.6452 15.5012 16.7798 15.5326 16.9169 15.538C17.054 15.5433 17.1908 15.5225 17.3194 15.4767C17.4481 15.4309 17.5661 15.3611 17.6666 15.2712C18.9368 14.1093 19.6999 12.5254 19.8009 10.8413C19.7752 10.042 19.5713 9.25727 19.2028 8.5405C18.8343 7.82373 18.31 7.19166 17.6654 6.68722C17.2387 6.38353 16.887 5.99283 16.6354 5.54303C16.3839 5.09323 16.2386 4.59547 16.2102 4.08534C16.346 3.18283 16.8393 2.36595 17.5869 1.80591C17.8038 1.64618 17.9468 1.41065 17.9848 1.15024C18.0228 0.889843 17.9528 0.625512 17.79 0.414392C17.6271 0.203272 17.3845 0.062327 17.1146 0.0220596C16.8447 -0.0182078 16.5692 0.0454338 16.3476 0.199206C15.7342 0.651996 15.2221 1.21933 14.8418 1.86721C14.4616 2.5151 14.2211 3.2302 14.1348 3.9697C14.1349 4.77855 14.3269 5.5767 14.6959 6.30333C15.065 7.02996 15.6015 7.66592 16.2645 8.16274Z\" fill=\"currentcolor\"/>\n    <path d=\"M7.16328 29.7138C5.86597 27.7051 5.17938 25.3866 5.18141 23.0212C5.18141 22.7558 5.07191 22.5013 4.87697 22.3136C4.68204 22.1259 4.41765 22.0205 4.14198 22.0205C3.8663 22.0205 3.60191 22.1259 3.40698 22.3136C3.21204 22.5013 3.10254 22.7558 3.10254 23.0212C3.10081 25.7653 3.89738 28.4551 5.40201 30.7857C5.55001 31.0072 5.78275 31.1637 6.04976 31.2211C6.31677 31.2784 6.59652 31.2322 6.82832 31.0923C7.06012 30.9524 7.22529 30.7301 7.288 30.4737C7.35071 30.2174 7.30588 29.9475 7.16328 29.7227V29.7138Z\" fill=\"currentcolor\"/>\n    <path d=\"M9.06498 32.7103C8.94112 32.6482 8.84235 32.548 8.78434 32.4257C8.73082 32.3026 8.65227 32.1911 8.55334 32.0977C8.45441 32.0043 8.33708 31.9309 8.20825 31.8818C8.07942 31.8327 7.9417 31.8089 7.80317 31.8118C7.66464 31.8146 7.5281 31.8441 7.40159 31.8986C7.27508 31.953 7.16115 32.0312 7.06649 32.1286C6.97184 32.226 6.89837 32.3407 6.8504 32.4658C6.80244 32.591 6.78094 32.7241 6.78719 32.8574C6.79344 32.9906 6.8273 33.1213 6.88678 33.2418C7.13536 33.7758 7.56332 34.2136 8.10177 34.4849C8.34682 34.6079 8.63256 34.6321 8.89616 34.5523C9.15975 34.4724 9.37959 34.295 9.50732 34.0591C9.63505 33.8232 9.6602 33.5481 9.57725 33.2943C9.49429 33.0405 9.31003 32.8289 9.06498 32.7059V32.7103Z\" fill=\"currentcolor\"/>\n    </g>\n    <defs>\n    <clipPath id=\"clip0_605_8664\">\n    <rect width=\"40\" height=\"40\" fill=\"white\"/>\n    </clipPath>\n    </defs>\n    </svg>\n    `,\n    drinks: `<svg width=\"28\" height=\"39\" viewBox=\"0 0 28 39\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clip-path=\"url(#clip0_598_8203)\">\n    <path d=\"M0 0L0.662157 8.11078C0.662157 8.12619 0.653028 8.1394 0.653028 8.15481C0.658117 8.18851 0.664982 8.22193 0.673584 8.25496L3.1852 39H25.1048L28.0034 0H0ZM25.7932 1.98093L25.4085 7.16985C25.3982 7.16985 25.3902 7.16985 25.3799 7.16985H2.64519L2.22279 1.98642L25.7932 1.98093ZM23.1948 37.0191H5.08147L2.80846 9.14527H25.2612L23.1948 37.0191Z\" fill=\"currentcolor\"/>\n    <path d=\"M6.24983 23.3122C6.28864 23.3122 6.32861 23.3122 6.364 23.3122C6.49825 23.2972 6.6281 23.2567 6.74613 23.1933C6.86415 23.1298 6.96804 23.0445 7.05181 22.9423C7.13559 22.8401 7.19762 22.7229 7.23436 22.5975C7.2711 22.4722 7.28181 22.341 7.26589 22.2117C7.0661 20.5444 6.86517 18.8155 6.66538 17.0855C6.4576 15.2861 6.24869 13.4846 6.03862 11.7502C5.99894 11.4962 5.85848 11.267 5.64686 11.111C5.43525 10.955 5.16904 10.8843 4.90438 10.9138C4.63973 10.9434 4.39731 11.0708 4.22831 11.2694C4.0593 11.4679 3.9769 11.722 3.9985 11.978C4.20628 13.7091 4.41522 15.5084 4.623 17.3056C4.82392 19.0378 5.02485 20.77 5.22578 22.4395C5.25574 22.6807 5.37661 22.9029 5.56542 23.0638C5.75424 23.2247 5.99781 23.3131 6.24983 23.3122Z\" fill=\"currentcolor\"/>\n    <path d=\"M6.05485 24.414C5.9204 24.4288 5.79029 24.469 5.67201 24.5323C5.55372 24.5957 5.44958 24.6809 5.36557 24.7832C5.28156 24.8854 5.21933 25.0027 5.18245 25.1282C5.14557 25.2537 5.13477 25.385 5.15067 25.5145L5.31392 26.8857C5.34197 27.1276 5.46141 27.351 5.64945 27.5134C5.83748 27.6758 6.08096 27.7658 6.33341 27.7662C6.37223 27.7662 6.41105 27.7662 6.44759 27.7607C6.5817 27.7462 6.71152 27.7063 6.82966 27.6434C6.9478 27.5806 7.05194 27.4959 7.13612 27.3942C7.22029 27.2925 7.28287 27.1758 7.32027 27.0508C7.35766 26.9258 7.36913 26.7949 7.35404 26.6656L7.1908 25.2889C7.15839 25.0286 7.02114 24.791 6.80864 24.6273C6.59614 24.4636 6.32541 24.387 6.05485 24.414Z\" fill=\"currentcolor\"/>\n    </g>\n    <defs>\n    <clipPath id=\"clip0_598_8203\">\n    <rect width=\"28\" height=\"39\" fill=\"white\"/>\n    </clipPath>\n    </defs>\n    </svg>\n    `,\n    snacks: `<svg width=\"44\" height=\"30\" viewBox=\"0 0 44 30\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M39.9739 12.3839H39.9673C39.8416 11.3068 39.529 10.2613 39.0441 9.29623C38.2937 7.89066 37.2396 6.67826 35.9616 5.75118C34.6837 4.82411 33.2156 4.20677 31.669 3.94605C31.658 3.94605 31.6471 3.94605 31.635 3.94605C29.7116 1.41671 26.4577 0.0219894 22.162 0.00292969C17.7851 0.0287164 14.3819 1.44362 12.4015 3.94605C12.3773 3.94605 12.3553 3.94605 12.3312 3.94605C10.7845 4.20721 9.31631 4.82484 8.03823 5.75207C6.76016 6.6793 5.70574 7.89174 4.95505 9.29734C4.47112 10.2623 4.15888 11.3074 4.03289 12.3839H4.02631C2.34137 14.0479 1.12087 16.1402 0.490328 18.4457C-0.140217 20.7512 -0.15805 23.1866 0.438675 25.5015C1.16762 28.1328 2.30494 29.6228 3.81991 29.9323C4.02143 29.975 4.22667 29.9968 4.43249 29.9973C5.03503 29.925 5.61546 29.722 6.13483 29.4017C6.6542 29.0815 7.1005 28.6516 7.44377 28.1407C8.13563 27.3077 8.96125 26.601 9.88529 26.0508C10.6588 25.658 11.4715 25.3513 12.3092 25.136C12.7407 25.007 13.2105 24.8624 13.7122 24.6875C14.2182 24.7717 14.7299 24.8148 15.2426 24.8164C16.5191 24.8132 17.7827 24.5561 18.963 24.0597C19.2243 24.1678 19.4915 24.2603 19.7633 24.3366C20.4624 24.5255 21.1737 24.6634 21.892 24.7492C21.9649 24.7584 22.0386 24.7584 22.1115 24.7492C22.8298 24.6634 23.5411 24.5255 24.2402 24.3366C24.5121 24.2602 24.7794 24.1674 25.0405 24.0585C26.6985 24.7663 28.5179 24.9843 30.2913 24.6875C30.7941 24.8568 31.2639 25.0014 31.6954 25.136C32.5326 25.3518 33.3449 25.6585 34.1182 26.0508C35.0422 26.6006 35.8675 27.3074 36.5586 28.1407C36.9021 28.6516 37.3486 29.0816 37.8682 29.4018C38.3877 29.722 38.9683 29.925 39.571 29.9973C39.7765 29.9968 39.9813 29.975 40.1825 29.9323C41.6986 29.6228 42.8359 28.1317 43.5648 25.5015C44.1604 23.1863 44.1418 20.7509 43.5107 18.4455C42.8796 16.1401 41.6588 14.0479 39.9739 12.3839ZM8.94886 24.276C7.83296 24.927 6.83512 25.7694 5.99906 26.7661C5.09447 27.7561 4.76074 28.07 4.20854 27.9568C3.49936 27.8111 2.83628 26.7459 2.34227 24.9543C1.92223 23.3112 1.86627 21.5932 2.17848 19.9252C2.4907 18.2572 3.16322 16.6814 4.14706 15.3124C4.29059 16.0686 4.52165 16.8048 4.83539 17.5054C6.01506 20.1182 8.00316 22.2624 10.4935 23.6078C9.96108 23.7857 9.44437 24.0092 8.94886 24.276ZM14.1514 22.7266C13.9962 22.6555 13.8256 22.6265 13.6562 22.6425C12.1235 22.2411 10.6976 21.4958 9.48221 20.461C8.26685 19.4261 7.2926 18.1277 6.63029 16.66C6.16216 15.6502 5.92631 14.5445 5.94077 13.4274C5.95523 12.3102 6.21962 11.2112 6.71373 10.2145C7.64306 8.45293 9.17618 7.10357 11.0193 6.42493C9.99726 9.36013 10.6472 13.6553 12.7165 17.6365C13.6785 19.5654 15.0132 21.2752 16.6401 22.6627C15.8195 22.8232 14.9787 22.8448 14.1514 22.7266ZM23.7451 22.3903C23.1716 22.5448 22.5889 22.6613 22.0007 22.7389C21.4117 22.6614 20.8283 22.5449 20.254 22.3903C18.2033 21.8521 16.0374 19.7219 14.462 16.6925C12.6704 13.2438 12.0469 9.47672 12.8834 7.09538C14.473 2.55356 19.9093 2.03223 22.1653 2.01765C25.4445 2.03783 29.66 2.93475 31.1157 7.09538C31.9501 9.4756 31.3353 13.2427 29.5393 16.6903C27.9628 19.7197 25.798 21.851 23.7451 22.3891V22.3903ZM27.3579 22.6649C28.9873 21.2782 30.3233 19.5673 31.2848 17.6365C33.353 13.6542 34.0019 9.36013 32.9798 6.42493C34.8231 7.1032 36.3564 8.45266 37.2854 10.2145C37.7798 11.2111 38.0446 12.31 38.0594 13.4271C38.0743 14.5442 37.8388 15.6501 37.371 16.66C36.7089 18.1267 35.7356 19.4246 34.5215 20.4595C33.3074 21.4945 31.883 22.2405 30.3517 22.6436C30.1773 22.6248 30.0013 22.6546 29.8423 22.73C29.0162 22.8474 28.1769 22.825 27.3579 22.6638V22.6649ZM41.6601 24.9555C41.165 26.7493 40.5009 27.8122 39.7939 27.9579C39.2516 28.07 38.9156 27.7595 38.0033 26.7673C37.1671 25.7707 36.1693 24.9284 35.0536 24.2772C34.5589 24.0089 34.0429 23.7839 33.5111 23.6045C36.0014 22.2591 37.9895 20.1148 39.1692 17.502C39.4825 16.8016 39.7135 16.0659 39.8575 15.3101C40.8408 16.6799 41.5127 18.2562 41.8245 19.9245C42.1364 21.5927 42.0802 23.311 41.6601 24.9543V24.9555Z\" fill=\"currentColor\"/>\n    <path d=\"M17.3428 15.7782C16.1626 13.048 15.7674 10.0313 16.2032 7.08028C16.2231 6.94931 16.2174 6.81565 16.1867 6.68691C16.1559 6.55816 16.1006 6.43686 16.024 6.32994C15.9473 6.22302 15.8508 6.13257 15.7399 6.06375C15.629 5.99493 15.5059 5.94908 15.3777 5.92884C15.2495 5.90859 15.1186 5.91434 14.9925 5.94576C14.8665 5.97717 14.7477 6.03365 14.643 6.11194C14.5383 6.19023 14.4497 6.2888 14.3824 6.40205C14.315 6.5153 14.2701 6.641 14.2503 6.77197C13.7579 10.1061 14.2045 13.5144 15.538 16.5989C15.5889 16.7227 15.6636 16.8349 15.7575 16.9289C15.8515 17.0229 15.9628 17.0967 16.0851 17.1462C16.2074 17.1956 16.3381 17.2197 16.4695 17.2168C16.601 17.214 16.7306 17.1844 16.8507 17.1298C16.9709 17.0752 17.0791 16.9966 17.1691 16.8987C17.2591 16.8008 17.3291 16.6855 17.3749 16.5597C17.4208 16.4338 17.4415 16.2998 17.436 16.1656C17.4305 16.0315 17.3988 15.8997 17.3428 15.7782Z\" fill=\"currentColor\"/>\n    <path d=\"M19.696 19.2067C19.2865 18.9533 18.9569 18.5852 18.7464 18.146C18.6921 18.023 18.6143 17.9124 18.5174 17.8206C18.4206 17.7288 18.3067 17.6578 18.1825 17.6118C18.0583 17.5658 17.9263 17.5456 17.7944 17.5526C17.6625 17.5596 17.5333 17.5935 17.4144 17.6524C17.2955 17.7112 17.1894 17.7939 17.1023 17.8953C17.0153 17.9968 16.949 18.1151 16.9075 18.2432C16.866 18.3712 16.85 18.5065 16.8606 18.641C16.8712 18.7755 16.908 18.9065 16.969 19.0262C17.3477 19.8156 17.9407 20.4772 18.6772 20.9321C18.7884 21.0004 18.9117 21.0457 19.0401 21.0654C19.1684 21.085 19.2993 21.0786 19.4253 21.0466C19.5512 21.0146 19.6698 20.9576 19.7741 20.8788C19.8785 20.8 19.9666 20.701 20.0335 20.5874C20.1004 20.4738 20.1448 20.3478 20.164 20.2168C20.1832 20.0857 20.177 19.952 20.1456 19.8234C20.1143 19.6947 20.0585 19.5737 19.9813 19.4671C19.9041 19.3605 19.8072 19.2705 19.696 19.2022V19.2067Z\" fill=\"currentColor\"/>\n    </svg>\n    `,\n    meals: `<svg width=\"44\" height=\"47\" viewBox=\"0 0 44 47\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clip-path=\"url(#clip0_598_8219)\">\n    <path d=\"M42.941 2.11595C42.7415 1.9851 42.4981 1.93888 42.2644 1.98745C42.0307 2.03602 41.8259 2.1754 41.695 2.37496L34.006 14.102C33.3796 13.6496 32.7178 13.2483 32.027 12.902C32.0551 12.8557 32.0786 12.8068 32.097 12.756L35.4431 1.14795C35.5094 0.91841 35.4818 0.671927 35.3663 0.46273C35.2509 0.253533 35.0571 0.098759 34.8275 0.0324549C34.598 -0.0338492 34.3515 -0.0062506 34.1423 0.109178C33.9331 0.224607 33.7783 0.41841 33.712 0.647954L30.382 12.202C28.8498 11.6558 27.2357 11.3751 25.609 11.372C23.5868 11.3208 21.5789 11.7248 19.7337 12.5541C17.8886 13.3834 16.2534 14.6167 14.949 16.163C13.472 15.5617 11.8698 15.3326 10.2834 15.4959C8.69704 15.6593 7.17511 16.21 5.85156 17.0996C4.528 17.9893 3.44339 19.1906 2.69314 20.5978C1.94289 22.0051 1.54999 23.5752 1.54904 25.17H0.900049C0.781014 25.1699 0.663159 25.1936 0.553309 25.2394C0.443459 25.2853 0.343801 25.3524 0.260096 25.4371C0.176391 25.5217 0.110305 25.6221 0.0656684 25.7325C0.0210317 25.8428 -0.00126705 25.9609 5.5571e-05 26.08C0.0892682 29.5951 1.16582 33.0142 3.10662 35.9464C5.04743 38.8786 7.77413 41.2054 10.975 42.661V45.147C10.975 45.3856 11.0699 45.6146 11.2386 45.7834C11.4074 45.9521 11.6364 46.047 11.8751 46.047H29.692C29.9307 46.047 30.1596 45.9521 30.3284 45.7834C30.4972 45.6146 30.592 45.3856 30.592 45.147V42.665C33.7927 41.2092 36.5191 38.8822 38.4597 35.9501C40.4004 33.018 41.4768 29.599 41.566 26.084C41.5674 25.9649 41.5451 25.8468 41.5004 25.7365C41.4558 25.6261 41.3897 25.5257 41.306 25.4411C41.2223 25.3565 41.1226 25.2893 41.0128 25.2434C40.9029 25.1976 40.7851 25.1739 40.666 25.174H39.976C39.82 21.3924 38.1759 17.8258 35.402 15.251L43.197 3.36196C43.3282 3.16274 43.3749 2.91961 43.3269 2.68598C43.2789 2.45235 43.1401 2.24733 42.941 2.11595ZM11.292 17.249C13.3949 17.2513 15.4113 18.0864 16.9 19.5716C18.3887 21.0568 19.2286 23.0711 19.236 25.174H18.476C18.4537 23.2835 17.6871 21.4779 16.3423 20.149C14.9976 18.82 13.1832 18.0747 11.2925 18.0747C9.4019 18.0747 7.58747 18.82 6.24273 20.149C4.89799 21.4779 4.13134 23.2835 4.10903 25.174H3.34905C3.35619 23.0712 4.1959 21.0569 5.68447 19.5717C7.17304 18.0865 9.18928 17.2513 11.292 17.249ZM30.46 25.174C30.3295 24.0738 29.829 23.0506 29.0406 22.2723C28.2521 21.494 27.2226 21.0067 26.1208 20.8904C25.019 20.7742 23.9104 21.0358 22.9769 21.6324C22.0433 22.2291 21.3403 23.1252 20.983 24.174C20.8976 23.3879 20.7156 22.6154 20.441 21.874C21.2275 20.8287 22.312 20.0461 23.5519 19.6292C24.7917 19.2124 26.1287 19.1807 27.3869 19.5384C28.6451 19.8962 29.7655 20.6265 30.6005 21.6334C31.4356 22.6402 31.9461 23.8763 32.065 25.179L30.46 25.174ZM28.66 25.174H22.555C22.6942 24.4666 23.0746 23.8296 23.6314 23.3717C24.1882 22.9138 24.8867 22.6634 25.6075 22.6634C26.3284 22.6634 27.0269 22.9138 27.5837 23.3717C28.1404 23.8296 28.5209 24.4666 28.66 25.174ZM33.8661 25.174C33.7524 23.5697 33.1734 22.0335 32.1999 20.7533C31.2265 19.4731 29.9008 18.5046 28.3853 17.9663C26.8698 17.428 25.2303 17.3434 23.6674 17.7227C22.1045 18.102 20.6862 18.9288 19.5861 20.102C19.3425 19.7013 19.0704 19.3187 18.772 18.957C19.6483 18.0285 20.7095 17.2942 21.8871 16.8014C23.0648 16.3086 24.3327 16.0683 25.609 16.096C28.0701 16.1 30.4374 17.0409 32.2298 18.7275C34.0222 20.414 35.1053 22.7196 35.259 25.176L33.8661 25.174ZM15.376 25.174C15.376 24.0911 14.9459 23.0525 14.1802 22.2868C13.4145 21.5211 12.3759 21.091 11.2931 21.091C10.2102 21.091 9.17165 21.5211 8.40594 22.2868C7.64023 23.0525 7.21005 24.0911 7.21005 25.174H5.91003C5.92931 23.7594 6.5048 22.4093 7.51193 21.4158C8.51906 20.4223 9.87684 19.8653 11.2915 19.8653C12.7062 19.8653 14.064 20.4223 15.0712 21.4158C16.0783 22.4093 16.6537 23.7594 16.673 25.174H15.376ZM13.576 25.174H9.01205C9.02455 24.5769 9.27051 24.0085 9.6972 23.5906C10.1239 23.1728 10.6973 22.9387 11.2945 22.9387C11.8918 22.9387 12.4652 23.1728 12.8919 23.5906C13.3186 24.0085 13.5646 24.5769 13.5771 25.174H13.576ZM12.7761 44.251V43.132H28.792V44.251H12.7761ZM29.136 41.332H12.436C9.52258 40.1406 6.99281 38.1712 5.12332 35.6389C3.25383 33.1066 2.11663 30.109 1.83605 26.974H39.7281C39.4482 30.1081 38.3122 33.1051 36.4441 35.6373C34.5761 38.1695 32.048 40.1395 29.136 41.332ZM38.178 25.174H37.0601C36.9048 22.2401 35.6312 19.4773 33.5013 17.4538C31.3713 15.4303 28.547 14.2998 25.609 14.295C24.0957 14.2643 22.5927 14.55 21.1962 15.1338C19.7996 15.7176 18.5404 16.5865 17.499 17.685C17.2087 17.4481 16.9052 17.2277 16.5901 17.025C17.7218 15.7645 19.1155 14.7668 20.6734 14.1017C22.2314 13.4367 23.9159 13.1204 25.609 13.175C28.8438 13.1792 31.9531 14.4275 34.2929 16.6611C36.6327 18.8948 38.0237 21.9428 38.178 25.174Z\" fill=\"currentColor\"/>\n    <path d=\"M3.39209 30.1722C4.045 32.6025 5.31628 34.8222 7.08209 36.6152C7.16443 36.7021 7.26327 36.7717 7.37286 36.8199C7.48244 36.8682 7.60056 36.8941 7.72027 36.8961C7.83999 36.8981 7.95888 36.8762 8.07003 36.8317C8.18118 36.7872 8.28235 36.7209 8.36758 36.6368C8.45281 36.5528 8.52038 36.4525 8.56637 36.342C8.61237 36.2314 8.63585 36.1128 8.63543 35.9931C8.63501 35.8733 8.6107 35.7549 8.56393 35.6447C8.51716 35.5344 8.44888 35.4347 8.36306 35.3512C6.81633 33.7796 5.70257 31.8346 5.13006 29.7052C5.1013 29.589 5.04966 29.4797 4.97815 29.3837C4.90663 29.2878 4.81669 29.207 4.71359 29.1462C4.61049 29.0854 4.49631 29.0458 4.37771 29.0297C4.25912 29.0136 4.1385 29.0213 4.02291 29.0523C3.90733 29.0834 3.7991 29.1372 3.70456 29.2106C3.61001 29.284 3.53106 29.3755 3.47232 29.4798C3.41357 29.584 3.3762 29.699 3.36242 29.8179C3.34865 29.9368 3.35875 30.0572 3.39209 30.1722Z\" fill=\"#323232\"/>\n    <path d=\"M10.5356 39.5502C10.7282 39.6767 10.962 39.7245 11.1889 39.6838C11.4157 39.643 11.6182 39.5168 11.7547 39.3312C11.8913 39.1456 11.9514 38.9146 11.9227 38.6859C11.8941 38.4573 11.7788 38.2483 11.6006 38.1022L10.3336 37.1752C10.1407 37.0392 9.90209 36.9844 9.66918 37.0226C9.43627 37.0609 9.2277 37.1891 9.08843 37.3797C8.94915 37.5702 8.89031 37.8079 8.92458 38.0414C8.95884 38.2749 9.08345 38.4857 9.27159 38.6282L10.5356 39.5502Z\" fill=\"#323232\"/>\n    </g>\n    <defs>\n    <clipPath id=\"clip0_598_8219\">\n    <rect width=\"43.348\" height=\"46.051\" fill=\"white\"/>\n    </clipPath>\n    </defs>\n    </svg>`,\n};\n\n@Component({\n    selector: 'catering-item-filters',\n    template: `\n        <div class=\"px-4 mt-3 mb-2\" [class.sm:hidden]=\"!search\">\n            <mat-form-field appearance=\"outline\" class=\"w-full h-14\">\n                <app-icon matPrefix class=\"text-xl\">search</app-icon>\n                <input\n                    matInput\n                    [ngModel]=\"(filters | async)?.search\"\n                    (ngModelChange)=\"setFilters({ search: $event })\"\n                    placeholder=\"Search menu...\"\n                />\n            </mat-form-field>\n        </div>\n        <h3 class=\"hidden sm:block font-medium px-2 py-4\" *ngIf=\"!search\" i18n>\n            Catergories\n        </h3>\n        <div\n            class=\"flex flex-col px-2 space-y-4\"\n            [class.sm:hidden]=\"search\"\n            [class.sm:pt-1]=\"!search\"\n        >\n            <mat-checkbox\n                *ngFor=\"let item of categories | async\"\n                [attr.name]=\"item\"\n                [ngModel]=\"(filters | async)?.categories?.includes(item)\"\n                (ngModelChange)=\"toggleCategory(item)\"\n            >\n                {{ item }}\n            </mat-checkbox>\n        </div>\n    `,\n    styles: [`\n        :host {\n            min-width: 16rem;\n        }\n    `],\n})\nexport class CateringItemFiltersComponent {\n    @Input() public search = false;\n\n    public readonly icons = ICONS;\n\n    public readonly filters = this._state.filters;\n\n    public readonly setFilters = (f) => this._state.setFilters(f);\n\n    public readonly categories = this._state.categories;\n\n    constructor(private _state: CateringOrderStateService) {}\n\n    public async toggleCategory(name: string) {\n        const { categories } = await this.filters.pipe(take(1)).toPromise();\n        if (categories.includes(name))\n            this.setFilters({\n                categories: categories.filter((_) => _ !== name),\n            });\n        else this.setFilters({ categories: [...categories, name] });\n    }\n\n    public async toggleTag(tag: string) {\n        const { tags } = await this.filters.pipe(take(1)).toPromise();\n        if (tags.includes(tag))\n            this.setFilters({ tags: tags.filter((_) => _ !== tag) });\n        else this.setFilters({ tags: [...tags, tag] });\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { SettingsService } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { CateringItem } from '../catering-item.class';\nimport { CateringOrderStateService } from './catering-order-state.service';\n\nconst EMPTY_FAVS: string[] = [];\n\n@Component({\n    selector: 'new-catering-order-modal',\n    template: `\n        <div\n            class=\"w-[100vw] h-[100vh] sm:relative sm:w-auto sm:h-auto flex flex-col bg-white dark:bg-neutral-700\"\n        >\n            <header class=\"flex items-center space-x-4 w-full\">\n                <button\n                    icon\n                    matRipple\n                    [mat-dialog-close]=\"selected\"\n                    class=\"bg-black/20\"\n                >\n                    <app-icon>close</app-icon>\n                </button>\n                <h3 i18n>Add Catering</h3>\n            </header>\n            <main\n                class=\"flex-1 flex items-center divide-x divide-gray-200 dark:divide-neutral-500 min-h-[65vh] h-[65vh] sm:max-h-[65vh] sm:max-w-[95vw] w-full overflow-hidden\"\n            >\n                <catering-item-filters\n                    class=\"h-full hidden sm:block sm:max-w-[12rem] sm:h-[65vh] sm:max-h-full\"\n                ></catering-item-filters>\n                <div\n                    class=\"flex flex-col items-center flex-1 w-1/2 h-full sm:h-[65vh]\"\n                >\n                    <catering-item-filters\n                        class=\"w-full border-b border-gray-200 dark:border-neutral-500\"\n                        [search]=\"true\"\n                    ></catering-item-filters>\n                    <catering-item-list\n                        [active]=\"displayed?.custom_id\"\n                        [selected]=\"selected_ids\"\n                        [selected_items]=\"selected\"\n                        [favorites]=\"favorites\"\n                        (toggleFav)=\"toggleFavourite($event)\"\n                        (onSelect)=\"displayed = $event\"\n                        class=\"flex-1 h-1/2 w-full overflow-hidden\"\n                    ></catering-item-list>\n                </div>\n                <catering-item-details\n                    [item]=\"displayed!\"\n                    class=\"h-full w-full sm:h-[65vh] absolute sm:relative sm:flex sm:max-w-[16rem] z-20 bg-white dark:bg-neutral-700\"\n                    [class.hidden]=\"!displayed\"\n                    [class.inset-0]=\"displayed\"\n                    [active]=\"selected_ids.includes(displayed?.custom_id || '')\"\n                    (activeChange)=\"setSelected(displayed!, $event)\"\n                    [code]=\"code\"\n                    [fav]=\"\n                        !!displayed &&\n                        this.favorites.includes(displayed?.id || '')\n                    \"\n                    (toggleFav)=\"toggleFavourite(displayed!)\"\n                    (close)=\"displayed = null\"\n                ></catering-item-details>\n            </main>\n            <footer\n                class=\"flex sm:hidden flex-col-reverse items-center justify-end px-2 pt-2 pb-[5.5rem] border-t border-gray-200 dark:border-neutral-500 w-full\"\n            >\n                <button\n                    btn\n                    matRipple\n                    name=\"catering-item-return\"\n                    class=\"inverse sm:hidden w-full sm:w-auto\"\n                    *ngIf=\"displayed\"\n                    (click)=\"displayed = null\"\n                    i18n\n                >\n                    Back\n                </button>\n                <button\n                    btn\n                    matRipple\n                    name=\"save-catering-item\"\n                    [mat-dialog-close]=\"selected\"\n                    [class.mb-2]=\"displayed\"\n                    class=\"w-full sm:w-auto sm:mb-0\"\n                    i18n\n                >\n                    View List\n                </button>\n            </footer>\n            <footer\n                class=\"hidden sm:flex items-center justify-between p-2 border-t border-gray-200 dark:border-neutral-500 w-full\"\n            >\n                <button\n                    btn\n                    matRipple\n                    name=\"catering-item-return\"\n                    [mat-dialog-close]=\"selected\"\n                    class=\"clear text-primary\"\n                >\n                    <div class=\"flex items-center\">\n                        <app-icon class=\"text-xl\">arrow_back</app-icon>\n                        <div class=\"mr-1 underline\" i18n>Back to form</div>\n                    </div>\n                </button>\n                <p class=\"opacity-60 text-sm\" i18n>\n                    {{ count }} items(s) added\n                </p>\n                <button\n                    btn\n                    matRipple\n                    name=\"toggle-catering-item\"\n                    [disabled]=\"!displayed\"\n                    [class.inverse]=\"isSelected(displayed?.custom_id)\"\n                    (click)=\"\n                        setSelected(\n                            displayed,\n                            !isSelected(displayed?.custom_id)\n                        )\n                    \"\n                >\n                    <div class=\"flex items-center\">\n                        <app-icon class=\"text-xl\">{{\n                            isSelected(displayed?.custom_id) ? 'remove' : 'add'\n                        }}</app-icon>\n                        <div class=\"mr-1\">\n                            {{\n                                isSelected(displayed?.custom_id)\n                                    ? 'Remove from Booking'\n                                    : 'Add to booking'\n                            }}\n                        </div>\n                    </div>\n                </button>\n            </footer>\n        </div>\n    `,\n    styles: [``],\n})\nexport class NewCateringOrderModalComponent {\n    public displayed: CateringItem | null = null;\n    public selected: CateringItem[] = [...(this._data[0] || [])];\n\n    public get favorites() {\n        return (\n            this._settings.get<string[]>('favourite_menu_items') || EMPTY_FAVS\n        );\n    }\n\n    public get selected_ids() {\n        return this.selected.map((_) => _.custom_id).join(',');\n    }\n\n    public get count() {\n        return this.selected.reduce((t, i) => t + i.quantity, 0);\n    }\n\n    public get code() {\n        return this._org.currency_code;\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _order: CateringOrderStateService,\n        private _org: OrganisationService,\n        @Inject(MAT_DIALOG_DATA) private _data: [CateringItem[], any]\n    ) {\n        this._order.setFilters(this._data[1]);\n    }\n\n    public isSelected(id: string) {\n        return id && this.selected_ids.includes(id);\n    }\n\n    public setSelected(item: CateringItem, state: boolean) {\n        const list = this.selected.filter(\n            (_) => _.custom_id !== item.custom_id\n        );\n        if (state) {\n            const new_item = new CateringItem(item);\n            list.push(new_item);\n            this.displayed = new_item;\n        }\n        this.selected = list;\n    }\n\n    public toggleFavourite(item: CateringItem) {\n        const fav_list = this.favorites;\n        const new_state = !fav_list.includes(item.id);\n        if (new_state) {\n            this._settings.saveUserSetting('favourite_menu_items', [\n                ...fav_list,\n                item.id,\n            ]);\n        } else {\n            this._settings.saveUserSetting(\n                'favourite_menu_items',\n                fav_list.filter((_) => _ !== item.id)\n            );\n        }\n    }\n}\n","import { Component, forwardRef, Input } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { MatDialog } from '@angular/material/dialog';\nimport { SettingsService } from '@placeos/common';\n\nimport { CateringItem } from 'libs/catering/src/lib/catering-item.class';\nimport { NewCateringOrderModalComponent } from 'libs/catering/src/lib/catering-order-modal/new-catering-order-modal.component';\n\nconst EMPTY_FAVS = [];\n\n@Component({\n    selector: `catering-list-field`,\n    template: ` <div list class=\"space-y-2\">\n            <div\n                space\n                class=\"relative p-2 rounded-lg w-full flex items-center shadow border border-gray-200\"\n                *ngFor=\"let item of items\"\n            >\n                <div\n                    class=\"w-16 h-16 rounded-xl bg-black/20 mr-4 overflow-hidden flex items-center justify-center\"\n                >\n                    <img\n                        *ngIf=\"item.images?.length; else placeholder\"\n                        class=\"object-cover min-h-full min-w-full\"\n                        [src]=\"item.images[0]\"\n                    />\n                    <ng-template #placeholder>\n                        <img\n                            class=\"m-auto\"\n                            src=\"assets/icons/catering-placeholder.svg\"\n                        />\n                    </ng-template>\n                </div>\n                <div class=\"pb-4\">\n                    <div class=\"font-medium flex items-center\">\n                        {{ item.name || 'Item' }}\n                        <span\n                            class=\"text-xs opacity-60 ml-4 font-normal\"\n                            *ngIf=\"item.option_list.length\"\n                            [matTooltip]=\"optionList(item)\"\n                        >\n                            {{ item.option_list.length }} option(s)\n                        </span>\n                    </div>\n                    <div>{{ item.quantity }} requested</div>\n                    <div\n                        class=\"absolute bottom-0 right-0 flex items-center justify-end text-xs\"\n                    >\n                        <button\n                            btn\n                            matRipple\n                            name=\"edit-catering-item\"\n                            class=\"clear\"\n                            (click)=\"addItems(item)\"\n                        >\n                            <div class=\"flex items-center space-x-2\">\n                                <app-icon>edit</app-icon>\n                                Change\n                            </div>\n                        </button>\n                        <button\n                            btn\n                            matRipple\n                            name=\"remove-catering-item\"\n                            class=\"clear\"\n                            (click)=\"removeItem(item)\"\n                        >\n                            <div class=\"flex items-center space-x-2\">\n                                <app-icon>close</app-icon>\n                                Remove\n                            </div>\n                        </button>\n                    </div>\n                </div>\n                <button\n                    icon\n                    matRipple\n                    name=\"toggle-catering-item-favourite\"\n                    class=\"absolute top-1 right-1\"\n                    [class.text-blue-400]=\"favorites.includes(item.id)\"\n                    (click)=\"toggleFavourite(item)\"\n                >\n                    <app-icon>{{\n                        favorites.includes(item.id)\n                            ? 'favorite'\n                            : 'favorite_border'\n                    }}</app-icon>\n                </button>\n            </div>\n        </div>\n        <button\n            btn\n            matRipple\n            name=\"add-catering-item\"\n            class=\"w-full inverse mt-2\"\n            [disabled]=\"disabled\"\n            (click)=\"addItems()\"\n        >\n            <div class=\"flex items-center justify-center space-x-2\">\n                <app-icon>search</app-icon>\n                <span>Add Item</span>\n            </div>\n        </button>`,\n    styles: [``],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            /* istanbul ignore next */\n            useExisting: forwardRef(() => CateringListFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class CateringListFieldComponent implements ControlValueAccessor {\n    @Input() public options: {\n        date?: number;\n        duration?: number;\n        zone_id?: string;\n    } = {};\n    public items: CateringItem[] = [];\n    public disabled = false;\n\n    private _onChange: (_: CateringItem[]) => void;\n    private _onTouch: (_: CateringItem[]) => void;\n    public selected: CateringItem[] = [];\n\n    public get favorites() {\n        return (\n            this._settings.get<string[]>('favourite_menu_items') || EMPTY_FAVS\n        );\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _dialog: MatDialog\n    ) {}\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: CateringItem[]) {\n        this.items = new_value;\n        if (this._onChange) this._onChange(this.items);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: CateringItem[]) {\n        this.items = value || [];\n    }\n\n    public readonly registerOnChange = (fn: (_: CateringItem[]) => void) =>\n        (this._onChange = fn);\n    public readonly registerOnTouched = (fn: (_: CateringItem[]) => void) =>\n        (this._onTouch = fn);\n    public readonly setDisabledState = (s: boolean) => (this.disabled = s);\n\n    public removeItem(item: CateringItem) {\n        const updated_list = this.items.filter((_) => _.id !== item.id);\n        this.setValue(updated_list);\n    }\n\n    public addItems(item?: CateringItem) {\n        const ref = this._dialog.open(NewCateringOrderModalComponent, {\n            data: [this.items, this.options],\n        });\n        ref.afterClosed().subscribe((items?: CateringItem[]) => {\n            if (!items) return;\n            this.setValue(items);\n        });\n    }\n\n    public optionList(item: CateringItem) {\n        return item.option_list.map((_) => _.name).join('\\n');\n    }\n\n    public toggleFavourite(cateringitem: CateringItem) {\n        const fav_list = this.favorites;\n        const new_state = !fav_list.includes(cateringitem.id);\n        if (new_state) {\n            this._settings.saveUserSetting('favourite_menu_items', [\n                ...fav_list,\n                cateringitem.id,\n            ]);\n        } else {\n            this._settings.saveUserSetting(\n                'favourite_menu_items',\n                fav_list.filter((_) => _ !== cateringitem.id)\n            );\n        }\n    }\n}\n","import { Component } from '@angular/core';\nimport { unique } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { requestSpacesForZone } from 'libs/spaces/src/lib/space.utilities';\nimport { take } from 'rxjs/operators';\nimport { CateringStateService } from './catering';\n\n@Component({\n    selector: 'catering-rooms-state-modal',\n    template: `\n        <div>\n            <header class=\"flex items-center justify-between p-2\">\n                <h3 class=\"p-2\">Set Catering Availability for Rooms</h3>\n                <button icon mat-dialog-close>\n                    <app-icon>close</app-icon>\n                </button>\n            </header>\n            <main\n                class=\"max-h-[65vh] overflow-auto\"\n                *ngIf=\"!loading; else load_state\"\n            >\n                <table class=\"min-w-[32rem]\">\n                    <thead\n                        class=\"border-b border-gray-200 dark:border-neutral-500\"\n                    >\n                        <tr>\n                            <td class=\"w-12\" (click)=\"toggleRoom('*')\">\n                                <mat-checkbox\n                                    class=\"pointer-events-none\"\n                                    [checked]=\"\n                                        (rooms | async)?.length ===\n                                        selected.length\n                                    \"\n                                    [indeterminate]=\"\n                                        selected.length > 0 &&\n                                        (rooms | async)?.length !==\n                                            selected.length\n                                    \"\n                                ></mat-checkbox>\n                            </td>\n                            <td></td>\n                            <td class=\"text-right text-xs\">\n                                {{ (rooms | async)?.length }} Room(s)\n                            </td>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr\n                            *ngFor=\"let space of rooms | async\"\n                            class=\"hover:bg-black/10 dark:hover:bg-white/5\"\n                            (click)=\"toggleRoom(space.id)\"\n                        >\n                            <td>\n                                <mat-checkbox\n                                    class=\"pointer-events-none\"\n                                    [checked]=\"selected.includes(space.id)\"\n                                ></mat-checkbox>\n                            </td>\n                            <td>{{ space.display_name || space.name }}</td>\n                            <td class=\"text-right\">\n                                <span\n                                    class=\"px-2 py-1 rounded-2xl\"\n                                    [class.bg-green-600]=\"\n                                        !(availability | async)?.includes(\n                                            space.id\n                                        )\n                                    \"\n                                    [class.bg-red-600]=\"\n                                        (availability | async)?.includes(\n                                            space.id\n                                        )\n                                    \"\n                                >\n                                    {{\n                                        !(availability | async)?.includes(\n                                            space.id\n                                        )\n                                            ? 'Enabled'\n                                            : 'Disabled'\n                                    }}\n                                </span>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </main>\n            <footer\n                class=\"flex items-center p-2 justify-end space-x-2 border-t border-gray-200 dark:border-neutral-500\"\n            >\n                <button btn matRipple (click)=\"enableSelected()\">\n                    Enable Selected\n                </button>\n                <button btn matRipple (click)=\"disableSelected()\">\n                    Disable Selected\n                </button>\n            </footer>\n        </div>\n        <ng-template #load_state>\n            <main\n                class=\"w-64 h-48 p-8 flex flex-col items-center justify-center space-y-2\"\n            >\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>Saving disabled room list...</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [\n        `\n            td {\n                padding: 0.5rem;\n            }\n        `,\n    ],\n})\nexport class CateringRoomsStateModalComponent {\n    public loading = false;\n    public selected: string[] = [];\n    public readonly rooms = requestSpacesForZone(this._org.building.id);\n    public readonly availability = this._catering.availability;\n\n    constructor(\n        private _catering: CateringStateService,\n        private _org: OrganisationService\n    ) {}\n\n    public async toggleRoom(id: string) {\n        if (id === '*') {\n            const rooms = await this.rooms.pipe(take(1)).toPromise();\n            if (this.selected.length !== rooms.length)\n                this.selected = rooms.map((_) => _.id);\n            else this.selected = [];\n        } else {\n            if (this.selected.includes(id))\n                this.selected = this.selected.filter((_) => _ !== id);\n            else this.selected = [...this.selected, id];\n        }\n    }\n\n    public async enableSelected() {\n        this.loading = true;\n        const disabled_list = await this.availability.pipe(take(1)).toPromise();\n        const list = disabled_list.filter((_) => !this.selected.includes(_));\n        await this._catering\n            .saveSettings({ disabled_rooms: list })\n            .catch(() => null);\n        this.loading = false;\n    }\n\n    public async disableSelected() {\n        const disabled_list = await this.availability.pipe(take(1)).toPromise();\n        const list = unique(disabled_list.concat(this.selected));\n        await this._catering\n            .saveSettings({ disabled_rooms: list })\n            .catch(() => null);\n        this.loading = false;\n    }\n}\n","import { Component } from '@angular/core';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport { csvToJson, notifyError, unique } from '@placeos/common';\nimport { take } from 'rxjs/operators';\nimport { CateringStateService } from './catering-state.service';\n\n@Component({\n    selector: 'charge-code-list-modal',\n    template: `\n        <header>\n            <h2>Edit Charge Codes</h2>\n            <button icon mat-dialog-close>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            *ngIf=\"!loading; else load_state\"\n            class=\"overflow-auto max-h-[65vh] min-h-[20rem] flex flex-col\"\n        >\n            <div\n                class=\"flex items-center space-x-2 w-full hover:bg-black/10 px-2\"\n                *ngFor=\"\n                    let code of charge_codes;\n                    let i = index;\n                    trackBy: trackByFn\n                \"\n            >\n                <mat-form-field appearance=\"outline\" class=\"h-14 flex-1\">\n                    <input\n                        matInput\n                        [(ngModel)]=\"charge_codes[i]\"\n                        placeholder=\"Charge Code\"\n                    />\n                </mat-form-field>\n                <button icon (click)=\"removeCode(i)\">\n                    <app-icon>delete</app-icon>\n                </button>\n            </div>\n        </main>\n        <footer\n            class=\"flex items-center p-2 space-x-2 border-t border-gray-200\"\n            *ngIf=\"!loading\"\n        >\n            <button btn matRipple class=\"w-48 inverse relative\">\n                Import Codes\n                <input\n                    class=\"opacity-0 absolute inset-0\"\n                    type=\"file\"\n                    (change)=\"addCodesFromFile($event)\"\n                />\n            </button>\n            <button btn matRipple class=\"w-48\" (click)=\"newCode()\">\n                Add Code\n            </button>\n            <button btn matRipple class=\"w-48\" (click)=\"saveChargeCodes()\">\n                Save Changes\n            </button>\n        </footer>\n        <ng-template #load_state>\n            <main\n                class=\"flex flex-col items-center justify-center p-20 space-y-2\"\n            >\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>Saving changes to charge codes...</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class ChargeCodeListModalComponent {\n    public charge_codes: string[] = [];\n    public loading = false;\n\n    constructor(\n        private _state: CateringStateService,\n        private _dialog_ref: MatDialogRef<ChargeCodeListModalComponent>\n    ) {}\n\n    public async ngOnInit() {\n        this.charge_codes =\n            (await this._state.charge_codes.pipe(take(1)).toPromise()) || [];\n    }\n\n    public newCode() {\n        this.charge_codes.push('');\n    }\n\n    public removeCode(index: number) {\n        this.charge_codes.splice(index, 1);\n    }\n\n    /**\n     * Load CSV file and populate the code list with the contents\n     * @param event File input field event\n     */\n    public addCodesFromFile(event) {\n        /* istanbul ignore else */\n        if (event.target) {\n            const file = event.target.files[0];\n            /* istanbul ignore else */\n            if (file) {\n                const reader = new FileReader();\n                reader.readAsText(file, 'UTF-8');\n                reader.addEventListener('load', (evt) => {\n                    const list =\n                        csvToJson((evt.srcElement as any).result) || [];\n                    for (const { code, description } of list) {\n                        this.charge_codes.push(code);\n                    }\n                    this.charge_codes = unique(this.charge_codes);\n                    event.target.value = '';\n                });\n                reader.addEventListener('error', (_) =>\n                    notifyError('Error reading file.')\n                );\n            }\n        }\n    }\n\n    public async saveChargeCodes() {\n        this.loading = true;\n        const cleaned_codes = this.charge_codes.filter((_) => _ && _.trim());\n        await this._state.saveSettings({ charge_codes: cleaned_codes });\n        this._dialog_ref.close();\n    }\n\n    public trackByFn(idx: number, item: any) {\n        return idx;\n    }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule, Type } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatFormFieldModule } from '@angular/material/form-field';\n\nimport { FormFieldsModule } from '@placeos/form-fields';\n\nimport { ComponentsModule } from 'libs/components/src/lib/components.module';\n\nimport { CateringConfigModalComponent } from './catering-config-modal.component';\nimport { CateringItemModalComponent } from './catering-item-modal.component';\nimport { CateringMenuItemComponent } from './catering-menu-item.component';\nimport { CateringMenuComponent } from './catering-menu.component';\nimport { CateringItemOptionModalComponent } from './catering-option-modal.component';\nimport { CateringOrderItemComponent } from './catering-order-item.component';\nimport { CateringOrderListComponent } from './catering-order-list.component';\nimport { CateringOrderModalComponent } from './catering-order-modal.component';\nimport { CateringOrderOptionsModalComponent } from './catering-order-options-modal.component';\nimport { CateringOrderComponent } from './catering-order.component';\nimport { CateringImportMenuModalComponent } from './catering-import-menu-modal.component';\n\nimport { NewCateringOrderModalComponent } from './catering-order-modal/new-catering-order-modal.component';\nimport { CateringItemListComponent } from './catering-order-modal/catering-item-list.component';\nimport { CateringItemDetailsComponent } from './catering-order-modal/catering-item-details.component';\nimport { CateringItemFiltersComponent } from './catering-order-modal/catering-item-filters.component';\nimport { CateringListFieldComponent } from './catering-list-field.component';\nimport { CateringRoomsStateModalComponent } from './catering-rooms-state-modal.component';\nimport { ChargeCodeListModalComponent } from './charge-code-list-modal.component';\nimport { CateringItemListItemComponent } from './catering-order-modal/catering-item-list-item.component';\n\nconst COMPONENTS: Type<any>[] = [\n    CateringOrderOptionsModalComponent,\n    CateringOrderModalComponent,\n    CateringConfigModalComponent,\n    CateringItemModalComponent,\n    CateringMenuComponent,\n    CateringMenuItemComponent,\n    CateringItemOptionModalComponent,\n    CateringOrderListComponent,\n    CateringOrderComponent,\n    CateringOrderItemComponent,\n    CateringImportMenuModalComponent,\n\n    CateringListFieldComponent,\n    NewCateringOrderModalComponent,\n    CateringItemListComponent,\n    CateringItemDetailsComponent,\n    CateringItemFiltersComponent,\n    CateringRoomsStateModalComponent,\n    CateringItemListItemComponent,\n\n    ChargeCodeListModalComponent,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [\n        CommonModule,\n        MatMenuModule,\n        MatTabsModule,\n        MatAutocompleteModule,\n        MatDialogModule,\n        MatCheckboxModule,\n        MatRadioModule,\n        MatTooltipModule,\n        FormsModule,\n        ReactiveFormsModule,\n        ComponentsModule,\n        MatFormFieldModule,\n        FormFieldsModule,\n    ],\n    providers: [],\n    exports: [...COMPONENTS],\n})\nexport class SharedCateringModule {}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'placeos-book',\n    template: `\n        <topbar *ngIf=\"!hide_nav\"></topbar>\n        <div class=\"flex-1 flex sm:flex-row flex-col-reverse h-1/2\">\n            <main\n                class=\"flex flex-col flex-1 h-1/2 sm:h-auto overflow-hidden\"\n            >\n                <router-outlet></router-outlet>\n            </main>\n        </div>\n        <footer-menu class=\"z-10\" *ngIf=\"!hide_nav\"></footer-menu>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class BookComponent {\n    public get hide_nav() {\n        return localStorage.getItem('PlaceOS.hide_nav') === 'true';\n    }\n}\n","class e{constructor(a,b,c,d,f){this._legacyCanvasSize=e.DEFAULT_CANVAS_SIZE;this._preferredCamera=\"environment\";this._maxScansPerSecond=25;this._lastScanTimestamp=-1;this._destroyed=this._flashOn=this._paused=this._active=!1;this.$video=a;this.$canvas=document.createElement(\"canvas\");c&&\"object\"===typeof c?this._onDecode=b:(c||d||f?console.warn(\"You're using a deprecated version of the QrScanner constructor which will be removed in the future\"):console.warn(\"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true.\"),\nthis._legacyOnDecode=b);b=\"object\"===typeof c?c:{};this._onDecodeError=b.onDecodeError||(\"function\"===typeof c?c:this._onDecodeError);this._calculateScanRegion=b.calculateScanRegion||(\"function\"===typeof d?d:this._calculateScanRegion);this._preferredCamera=b.preferredCamera||f||this._preferredCamera;this._legacyCanvasSize=\"number\"===typeof c?c:\"number\"===typeof d?d:this._legacyCanvasSize;this._maxScansPerSecond=b.maxScansPerSecond||this._maxScansPerSecond;this._onPlay=this._onPlay.bind(this);this._onLoadedMetaData=\nthis._onLoadedMetaData.bind(this);this._onVisibilityChange=this._onVisibilityChange.bind(this);this._updateOverlay=this._updateOverlay.bind(this);a.disablePictureInPicture=!0;a.playsInline=!0;a.muted=!0;let h=!1;a.hidden&&(a.hidden=!1,h=!0);document.body.contains(a)||(document.body.appendChild(a),h=!0);c=a.parentElement;if(b.highlightScanRegion||b.highlightCodeOutline){d=!!b.overlay;this.$overlay=b.overlay||document.createElement(\"div\");f=this.$overlay.style;f.position=\"absolute\";f.display=\"none\";\nf.pointerEvents=\"none\";this.$overlay.classList.add(\"scan-region-highlight\");if(!d&&b.highlightScanRegion){this.$overlay.innerHTML='<svg class=\"scan-region-highlight-svg\" viewBox=\"0 0 238 238\" preserveAspectRatio=\"none\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round\"><path d=\"M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21\"/></svg>';try{this.$overlay.firstElementChild.animate({transform:[\"scale(.98)\",\n\"scale(1.01)\"]},{duration:400,iterations:Infinity,direction:\"alternate\",easing:\"ease-in-out\"})}catch(m){}c.insertBefore(this.$overlay,this.$video.nextSibling)}b.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML(\"beforeend\",'<svg class=\"code-outline-highlight\" preserveAspectRatio=\"none\" style=\"display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round\"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=\nthis._calculateScanRegion(a);requestAnimationFrame(()=>{let m=window.getComputedStyle(a);\"none\"===m.display&&(a.style.setProperty(\"display\",\"block\",\"important\"),h=!0);\"visible\"!==m.visibility&&(a.style.setProperty(\"visibility\",\"visible\",\"important\"),h=!0);h&&(console.warn(\"QrScanner has overwritten the video hiding style to avoid Safari stopping the playback.\"),a.style.opacity=\"0\",a.style.width=\"0\",a.style.height=\"0\",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),\ndelete this.$overlay,delete this.$codeOutlineHighlight);this.$overlay&&this._updateOverlay()});a.addEventListener(\"play\",this._onPlay);a.addEventListener(\"loadedmetadata\",this._onLoadedMetaData);document.addEventListener(\"visibilitychange\",this._onVisibilityChange);window.addEventListener(\"resize\",this._updateOverlay);this._qrEnginePromise=e.createQrEngine()}static set WORKER_PATH(a){console.warn(\"Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.\")}static async hasCamera(){try{return!!(await e.listCameras(!1)).length}catch(a){return!1}}static async listCameras(a=\n!1){if(!navigator.mediaDevices)return[];let b=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(d=>\"videoinput\"===d.kind),c;try{a&&(await b()).every(d=>!d.label)&&(c=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch(d){}try{return(await b()).map((d,f)=>({id:d.deviceId,label:d.label||(0===f?\"Default Camera\":`Camera ${f+1}`)}))}finally{c&&(console.warn(\"Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream\"),e._stopVideoStream(c))}}async hasFlash(){let a;\ntry{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;a=this.$video.srcObject}else a=(await this._getCameraStream()).stream;return\"torch\"in a.getVideoTracks()[0].getSettings()}catch(b){return!1}finally{a&&a!==this.$video.srcObject&&(console.warn(\"Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream\"),e._stopVideoStream(a))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&\n!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw\"No flash available\";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(a){throw this._flashOn=!1,a;}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener(\"loadedmetadata\",this._onLoadedMetaData);this.$video.removeEventListener(\"play\",this._onPlay);document.removeEventListener(\"visibilitychange\",\nthis._onVisibilityChange);window.removeEventListener(\"resize\",this._updateOverlay);this._destroyed=!0;this._flashOn=!1;this.stop();e._postWorkerMessage(this._qrEnginePromise,\"close\")}async start(){if(this._destroyed)throw Error(\"The QR scanner can not be started as it had been destroyed.\");if(!this._active||this._paused)if(\"https:\"!==window.location.protocol&&console.warn(\"The camera stream is only accessible if the page is transferred via https.\"),this._active=!0,!document.hidden)if(this._paused=\n!1,this.$video.srcObject)await this.$video.play();else try{let {stream:a,facingMode:b}=await this._getCameraStream();!this._active||this._paused?e._stopVideoStream(a):(this._setVideoMirror(b),this.$video.srcObject=a,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(a){if(!this._paused)throw this._active=!1,a;}}stop(){this.pause();this._active=!1}async pause(a=!1){this._paused=!0;if(!this._active)return!0;this.$video.pause();this.$overlay&&(this.$overlay.style.display=\n\"none\");let b=()=>{this.$video.srcObject instanceof MediaStream&&(e._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};if(a)return b(),!0;await new Promise(c=>setTimeout(c,300));if(!this._paused)return!1;b();return!0}async setCamera(a){a!==this._preferredCamera&&(this._preferredCamera=a,await this._restartVideoStream())}static async scanImage(a,b,c,d,f=!1,h=!1){let m,n=!1;b&&(\"scanRegion\"in b||\"qrEngine\"in b||\"canvas\"in b||\"disallowCanvasResizing\"in b||\"alsoTryWithoutScanRegion\"in\nb||\"returnDetailedScanResult\"in b)?(m=b.scanRegion,c=b.qrEngine,d=b.canvas,f=b.disallowCanvasResizing||!1,h=b.alsoTryWithoutScanRegion||!1,n=!0):b||c||d||f||h?console.warn(\"You're using a deprecated api for scanImage which will be removed in the future.\"):console.warn(\"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true.\");b=!!c;try{let p,k;[c,p]=await Promise.all([c||e.createQrEngine(),e._loadImage(a)]);\n[d,k]=e._drawToCanvas(p,m,d,f);let q;if(c instanceof Worker){let g=c;b||e._postWorkerMessageSync(g,\"inversionMode\",\"both\");q=await new Promise((l,v)=>{let w,u,r,y=-1;u=t=>{t.data.id===y&&(g.removeEventListener(\"message\",u),g.removeEventListener(\"error\",r),clearTimeout(w),null!==t.data.data?l({data:t.data.data,cornerPoints:e._convertPoints(t.data.cornerPoints,m)}):v(e.NO_QR_CODE_FOUND))};r=t=>{g.removeEventListener(\"message\",u);g.removeEventListener(\"error\",r);clearTimeout(w);v(\"Scanner error: \"+(t?\nt.message||t:\"Unknown Error\"))};g.addEventListener(\"message\",u);g.addEventListener(\"error\",r);w=setTimeout(()=>r(\"timeout\"),1E4);let x=k.getImageData(0,0,d.width,d.height);y=e._postWorkerMessageSync(g,\"decode\",x,[x.data.buffer])})}else q=await Promise.race([new Promise((g,l)=>window.setTimeout(()=>l(\"Scanner error: timeout\"),1E4)),(async()=>{try{var [g]=await c.detect(d);if(!g)throw e.NO_QR_CODE_FOUND;return{data:g.rawValue,cornerPoints:e._convertPoints(g.cornerPoints,m)}}catch(l){g=l.message||l;\nif(/not implemented|service unavailable/.test(g))return e._disableBarcodeDetector=!0,e.scanImage(a,{scanRegion:m,canvas:d,disallowCanvasResizing:f,alsoTryWithoutScanRegion:h});throw`Scanner error: ${g}`;}})()]);return n?q:q.data}catch(p){if(!m||!h)throw p;let k=await e.scanImage(a,{qrEngine:c,canvas:d,disallowCanvasResizing:f});return n?k:k.data}finally{b||e._postWorkerMessage(c,\"close\")}}setGrayscaleWeights(a,b,c,d=!0){e._postWorkerMessage(this._qrEnginePromise,\"grayscaleWeights\",{red:a,green:b,\nblue:c,useIntegerApproximation:d})}setInversionMode(a){e._postWorkerMessage(this._qrEnginePromise,\"inversionMode\",a)}static async createQrEngine(a){a&&console.warn(\"Specifying a worker path is not required and not supported anymore.\");a=()=>import(\"./qr-scanner-worker.min.js\").then(c=>c.createWorker());if(!(!e._disableBarcodeDetector&&\"BarcodeDetector\"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes(\"qr_code\")))return a();let b=navigator.userAgentData;\nreturn b&&b.brands.some(({brand:c})=>/Chromium/i.test(c))&&/mac ?OS/i.test(b.platform)&&await b.getHighEntropyValues([\"architecture\",\"platformVersion\"]).then(({architecture:c,platformVersion:d})=>/arm/i.test(c||\"arm\")&&13<=parseInt(d||\"13\")).catch(()=>!0)?a():new BarcodeDetector({formats:[\"qr_code\"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video);this._updateOverlay();this.$overlay&&(this.$overlay.style.display=\"\");this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video);\nthis._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(a){let b=Math.round(2/3*Math.min(a.videoWidth,a.videoHeight));return{x:Math.round((a.videoWidth-b)/2),y:Math.round((a.videoHeight-b)/2),width:b,height:b,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var a=this.$video,b=a.videoWidth,c=a.videoHeight,d=a.offsetWidth,f=a.offsetHeight,h=a.offsetLeft,\nm=a.offsetTop,n=window.getComputedStyle(a),p=n.objectFit,k=b/c,q=d/f;switch(p){case \"none\":var g=b;var l=c;break;case \"fill\":g=d;l=f;break;default:(\"cover\"===p?k>q:k<q)?(l=f,g=l*k):(g=d,l=g/k),\"scale-down\"===p&&(g=Math.min(g,b),l=Math.min(l,c))}var [v,w]=n.objectPosition.split(\" \").map((r,y)=>{const x=parseFloat(r);return r.endsWith(\"%\")?(y?f-l:d-g)*x/100:x});n=this._scanRegion.width||b;q=this._scanRegion.height||c;p=this._scanRegion.x||0;var u=this._scanRegion.y||0;k=this.$overlay.style;k.width=\n`${n/b*g}px`;k.height=`${q/c*l}px`;k.top=`${m+w+u/c*l}px`;c=/scaleX\\(-1\\)/.test(a.style.transform);k.left=`${h+(c?d-v-g:v)+(c?b-p-n:p)/b*g}px`;k.transform=a.style.transform}})}static _convertPoints(a,b){if(!b)return a;let c=b.x||0,d=b.y||0,f=b.width&&b.downScaledWidth?b.width/b.downScaledWidth:1;b=b.height&&b.downScaledHeight?b.height/b.downScaledHeight:1;for(let h of a)h.x=h.x*f+c,h.y=h.y*b+d;return a}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||(\"requestVideoFrameCallback\"in\nthis.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var a=Date.now()-this._lastScanTimestamp,b=1E3/this._maxScansPerSecond;a<b&&await new Promise(d=>setTimeout(d,b-a));this._lastScanTimestamp=Date.now();try{var c=await e.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(d){if(!this._active)return;this._onDecodeError(d)}!e._disableBarcodeDetector||await this._qrEnginePromise instanceof\nWorker||(this._qrEnginePromise=e.createQrEngine());c?(this._onDecode?this._onDecode(c):this._legacyOnDecode&&this._legacyOnDecode(c.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute(\"viewBox\",`${this._scanRegion.x||0} `+`${this._scanRegion.y||0} `+`${this._scanRegion.width||this.$video.videoWidth} `+`${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute(\"points\",\nc.cornerPoints.map(({x:d,y:f})=>`${d},${f}`).join(\" \")),this.$codeOutlineHighlight.style.display=\"\")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display=\"none\",100))}this._scanFrame()})}_onDecodeError(a){a!==e.NO_QR_CODE_FOUND&&console.log(a)}async _getCameraStream(){if(!navigator.mediaDevices)throw\"Camera not found.\";let a=/^(environment|user)$/.test(this._preferredCamera)?\"facingMode\":\n\"deviceId\",b=[{width:{min:1024}},{width:{min:768}},{}],c=b.map(d=>Object.assign({},d,{[a]:{exact:this._preferredCamera}}));for(let d of[...c,...b])try{let f=await navigator.mediaDevices.getUserMedia({video:d,audio:!1}),h=this._getFacingMode(f)||(d.facingMode?this._preferredCamera:\"environment\"===this._preferredCamera?\"user\":\"environment\");return{stream:f,facingMode:h}}catch(f){}throw\"Camera not found.\";}async _restartVideoStream(){let a=this._paused;await this.pause(!0)&&!a&&this._active&&await this.start()}static _stopVideoStream(a){for(let b of a.getTracks())b.stop(),\na.removeTrack(b)}_setVideoMirror(a){this.$video.style.transform=\"scaleX(\"+(\"user\"===a?-1:1)+\")\"}_getFacingMode(a){return(a=a.getVideoTracks()[0])?/rear|back|environment/i.test(a.label)?\"environment\":/front|user|face/i.test(a.label)?\"user\":null:null}static _drawToCanvas(a,b,c,d=!1){c=c||document.createElement(\"canvas\");let f=b&&b.x?b.x:0,h=b&&b.y?b.y:0,m=b&&b.width?b.width:a.videoWidth||a.width,n=b&&b.height?b.height:a.videoHeight||a.height;d||(d=b&&b.downScaledWidth?b.downScaledWidth:m,b=b&&b.downScaledHeight?\nb.downScaledHeight:n,c.width!==d&&(c.width=d),c.height!==b&&(c.height=b));b=c.getContext(\"2d\",{alpha:!1});b.imageSmoothingEnabled=!1;b.drawImage(a,f,h,m,n,0,0,c.width,c.height);return[c,b]}static async _loadImage(a){if(a instanceof Image)return await e._awaitImageLoad(a),a;if(a instanceof HTMLVideoElement||a instanceof HTMLCanvasElement||a instanceof SVGImageElement||\"OffscreenCanvas\"in window&&a instanceof OffscreenCanvas||\"ImageBitmap\"in window&&a instanceof ImageBitmap)return a;if(a instanceof\nFile||a instanceof Blob||a instanceof URL||\"string\"===typeof a){let b=new Image;b.src=a instanceof File||a instanceof Blob?URL.createObjectURL(a):a.toString();try{return await e._awaitImageLoad(b),b}finally{(a instanceof File||a instanceof Blob)&&URL.revokeObjectURL(b.src)}}else throw\"Unsupported image type.\";}static async _awaitImageLoad(a){a.complete&&0!==a.naturalWidth||await new Promise((b,c)=>{let d=f=>{a.removeEventListener(\"load\",d);a.removeEventListener(\"error\",d);f instanceof ErrorEvent?\nc(\"Image load error\"):b()};a.addEventListener(\"load\",d);a.addEventListener(\"error\",d)})}static async _postWorkerMessage(a,b,c,d){return e._postWorkerMessageSync(await a,b,c,d)}static _postWorkerMessageSync(a,b,c,d){if(!(a instanceof Worker))return-1;let f=e._workerMessageId++;a.postMessage({id:f,type:b,data:c},d);return f}}e.DEFAULT_CANVAS_SIZE=400;e.NO_QR_CODE_FOUND=\"No QR code found\";e._disableBarcodeDetector=!1;e._workerMessageId=0;export default e\n","import {\n    Component,\n    OnInit,\n    Output,\n    EventEmitter,\n    ViewChild,\n    ElementRef,\n    OnDestroy,\n} from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport {\n    Booking,\n    BookingFormService,\n    BookingType,\n    checkinBooking,\n    queryBookings,\n} from '@placeos/bookings';\nimport {\n    AsyncHandler,\n    currentUser,\n    notifyError,\n    notifyInfo,\n    notifySuccess,\n} from '@placeos/common';\nimport {\n    CalendarEvent,\n    checkinEventGuest,\n    EventFormService,\n    queryEvents,\n} from '@placeos/events';\nimport { showSystem } from '@placeos/ts-client';\nimport { addMinutes, endOfDay, getUnixTime } from 'date-fns';\nimport QrScanner from 'qr-scanner';\n\n@Component({\n    selector: 'book-code-flow',\n    template: `\n        <div\n            class=\"flex-1 overflow-hidden flex items-center justify-center bg-black relative\"\n            *ngIf=\"!loading; else load_state\"\n        >\n            <video\n                class=\"min-w-full min-h-full object-cover\"\n                id=\"video\"\n                #video\n            ></video>\n            <div\n                class=\"absolute text-white text-center inset-0 flex flex-col items-center justify-center\"\n            >\n                <div\n                    class=\"flex flex-col z-10 justify-end items-center relative\"\n                    *ngIf=\"is_scanning\"\n                >\n                    <h2 class=\"text-3xl mb-1 uppercase subpixel-antialiased\">\n                        Scan QR Code\n                    </h2>\n                    <span class=\" mb-4 \">\n                        Scan the QR code outisde a PlaceOS room or space.\n                    </span>\n                </div>\n                <div\n                    class=\"flex flex-col z-10 justify-end items-center relative\"\n                    *ngIf=\"!is_scanning\"\n                >\n                    <h2 class=\"text-3xl mb-1 uppercase subpixel-antialiased\">\n                        Enter Room ID\n                    </h2>\n                    <span class=\"mb-4\">\n                        Enter the room ID number outisde a PlaceOS room or\n                        space.\n                    </span>\n                </div>\n                <div class=\"flex items-center justify-center\">\n                    <div\n                        box\n                        class=\"rounded-2xl h-64 w-64 transition-all flex items-center justify-center p-8 m-8 space-x-2\"\n                        [class.input]=\"!is_scanning\"\n                    >\n                        <span class=\"uppercase\">Booking ID</span>\n                        <input\n                            matInput\n                            class=\"border-none bg-none w-full text-3xl text-left\"\n                            [(ngModel)]=\"room_code\"\n                            name=\"booking-id\"\n                            placeholder=\"e.g. 12102910\"\n                        />\n                    </div>\n                </div>\n                <div\n                    class=\"m-4 p-2 flex items-center space-x-2 bg-white bg-opacity-50 rounded\"\n                >\n                    <button\n                        matRipple\n                        [class]=\"\n                            'flex-1 text-black border-none w-40 ' +\n                            (is_scanning\n                                ? 'bg-white dark:bg-neutral-600'\n                                : 'bg-transparent hover:bg-white hover:dark:bg-neutral-600 bg-opacity-50')\n                        \"\n                        (click)=\"is_scanning = true\"\n                    >\n                        Scan Code\n                    </button>\n                    <button\n                        matRipple\n                        [class]=\"\n                            'flex-1 text-black border-none w-40 ' +\n                            (!is_scanning\n                                ? 'bg-white dark:bg-neutral-600'\n                                : 'bg-transparent hover:bg-white hover:dark:bg-neutral-600 bg-opacity-50')\n                        \"\n                        (click)=\"is_scanning = false\"\n                    >\n                        Enter Code\n                    </button>\n                </div>\n            </div>\n        </div>\n        <ng-template #load_state>\n            <div\n                class=\"absolute inset-0 flex flex-col items-center justify-center space-y-2\"\n            >\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p>Checking in booking...</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                width: 100%;\n                height: 100vh;\n                display: flex;\n                flex-direction: column;\n                background: #f0f0f0;\n            }\n\n            [box] {\n                box-shadow: 0px 0px 0px 100vw rgba(0, 0, 0, 0.5);\n            }\n\n            [box] > * {\n                display: none;\n            }\n\n            [box].input {\n                width: 32rem !important;\n                max-width: calc(100% - 2rem) !important;\n                padding: 1rem !important;\n                height: 4rem !important;\n                color: black !important;\n                background: white;\n                box-shadow: 0px 0px 0px 100vw rgba(0, 0, 0, 0.8);\n            }\n\n            [box].input > * {\n                display: initial;\n            }\n\n            [box] span {\n                font-family: var(--heading-font);\n                font-weight: 500;\n                text-transform: uppercase;\n                letter-spacing: 0.05em;\n            }\n        `,\n    ],\n})\nexport class BookCodeFlowComponent\n    extends AsyncHandler\n    implements OnInit, OnDestroy\n{\n    /** Menu event */\n    @Output() public menu = new EventEmitter(false);\n    /** Boolean to toggle scan/code */\n    public is_scanning = true;\n    /** Room Code input value */\n    public room_code: string;\n    public loading = false;\n\n    private _qr_scanner;\n    /** Video element to emit camera feed */\n    @ViewChild('video')\n    private _video_el: ElementRef<HTMLVideoElement>;\n\n    constructor(\n        private _router: Router,\n        private _route: ActivatedRoute,\n        private _event_form: EventFormService,\n        private _booking_form: BookingFormService\n    ) {\n        super();\n    }\n\n    public ngOnDestroy() {\n        if (this._video_el?.nativeElement?.srcObject) {\n            (this._video_el.nativeElement.srcObject as any)\n                .getTracks()\n                .forEach((track) => track?.stop());\n        }\n        this._qr_scanner?.stop();\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('asset_id'))\n                    this._checkinBooking(params.get('asset_id'));\n                if (params.has('space_id'))\n                    this._checkinEvent(\n                        params.get('space_id'),\n                        params.get('email')\n                    );\n            })\n        );\n    }\n\n    public ngAfterViewInit() {\n        if (!navigator.mediaDevices?.getUserMedia || this.loading) return;\n        navigator.mediaDevices\n            .getUserMedia({ video: true })\n            .then((stream) => (this._video_el.nativeElement.srcObject = stream))\n            .catch((e) => console.error('Unable to fetch media devices!', e));\n        this._qr_scanner = new QrScanner(this._video_el.nativeElement, (r) =>\n            this.handleQrCode(r)\n        );\n        this._qr_scanner.start();\n    }\n\n    private handleQrCode(result: string) {\n        const url = result;\n        const hashindex = url.indexOf('/#/');\n        // could just whole page redirect to url\n        if (hashindex > 0) {\n            const regex = /[?&]([^=#]+)=([^&#]*)/g;\n            const params = {};\n            let match;\n            while ((match = regex.exec(url))) {\n                params[match[1]] = match[2];\n            }\n            this._router.navigate([url.split('/#')[1].split('?')[0]], params);\n        }\n    }\n\n    private async _checkinBooking(\n        asset_id: string,\n        type: BookingType = 'desk'\n    ) {\n        this.loading = true;\n        let bookings = await queryBookings({\n            period_start: getUnixTime(Date.now()),\n            period_end: getUnixTime(addMinutes(Date.now(), 5)),\n            type,\n            email: currentUser().email,\n        })\n            .toPromise()\n            .catch((_) => [] as Booking[]);\n        const item = bookings.find((_) => _.asset_id === asset_id);\n        if (item) {\n            await checkinBooking(item.id, true)\n                .toPromise()\n                .catch((_) => {\n                    notifyError(\n                        `Unable to checkin booking with resource \"${asset_id}\"`\n                    );\n                    this.loading = false;\n                    throw _;\n                });\n            this._router.navigate(['/book', 'code', 'success']);\n        } else {\n            bookings = await queryBookings({\n                period_start: getUnixTime(Date.now()),\n                period_end: getUnixTime(endOfDay(Date.now())),\n                type,\n            })\n                .toPromise()\n                .catch((_) => [] as Booking[]);\n            let item = bookings.find((_) => _.asset_id === asset_id);\n            if (item) {\n                this._router.navigate(['/book', 'code', 'error'], {\n                    queryParams: { type: 'not_started', asset_id },\n                });\n                return;\n            }\n            bookings = await queryBookings({\n                period_start: getUnixTime(Date.now()),\n                period_end: getUnixTime(addMinutes(Date.now(), 5)),\n                type,\n            })\n                .toPromise()\n                .catch((_) => [] as Booking[]);\n            item = bookings.find((_) => _.asset_id === asset_id);\n            if (item) {\n                this._router.navigate(['/book', 'code', 'error'], {\n                    queryParams: { type: 'wrong_resource', asset_id },\n                });\n                return;\n            }\n            this._router.navigate(['/book', 'code', 'error'], {\n                queryParams: { type: 'no_booking', asset_id },\n            });\n            this._booking_form.newForm(new Booking({ asset_id, type }));\n            this._booking_form.setOptions({ type });\n        }\n        this.loading = false;\n    }\n\n    private async _checkinEvent(space_id: string, email?: string) {\n        if (!email) email = currentUser().email;\n        this.loading = true;\n        const bookings = await queryEvents({\n            period_start: getUnixTime(Date.now()),\n            period_end: getUnixTime(Date.now() + 5 * 60 * 1000),\n        })\n            .toPromise()\n            .catch((_) => []);\n        const item = bookings.find((_) =>\n            _.resources.find((s) => s.id === space_id || s.email === space_id)\n        );\n        if (item) {\n            await checkinEventGuest(item.id, email, true)\n                .toPromise()\n                .catch((_) => {\n                    notifyError(\n                        `Unable to checkin event with resource \"${space_id}\"`\n                    );\n                    this.loading = false;\n                    throw _;\n                });\n            this._router.navigate(['/book', 'code', 'success']);\n            this.loading = false;\n        } else {\n            const space = await showSystem(space_id).toPromise();\n            if (space) {\n                this._event_form.newForm(new CalendarEvent({ system: space }));\n            }\n            this._router.navigate(['/book', 'meeting']);\n        }\n        this.loading = false;\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { BookingFormService } from '@placeos/bookings';\nimport { SettingsService } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { addDays, endOfDay, format } from 'date-fns';\n\n@Component({\n    selector: 'detailed-book-desks-form',\n    template: `\n        <form *ngIf=\"form\" [formGroup]=\"form\">\n            <div\n                class=\"w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4\"\n                *ngIf=\"allow_groups\"\n            >\n                <mat-button-toggle-group\n                    class=\"w-full\"\n                    [ngModel]=\"(options | async)?.group ? 'group' : 'single'\"\n                    (ngModelChange)=\"\n                        setOptions({\n                            group: $event === 'group'\n                        })\n                    \"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                >\n                    <mat-button-toggle class=\"w-1/2\" value=\"single\">\n                        Single\n                    </mat-button-toggle>\n                    <mat-button-toggle class=\"w-1/2\" value=\"group\">\n                        Group\n                    </mat-button-toggle>\n                </mat-button-toggle-group>\n            </div>\n            <div\n                class=\"flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n            >\n                <div class=\"flex flex-col flex-1 w-full sm:w-1/4\">\n                    <label>Date</label>\n                    <a-date-field [to]=\"book_until\" formControlName=\"date\">\n                        Date and time must be in the future\n                    </a-date-field>\n                </div>\n                <div\n                    class=\"flex flex-col flex-1 w-full sm:w-1/4\"\n                    *ngIf=\"(buildings | async)?.length > 1\"\n                >\n                    <label>Building</label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            placeholder=\"Select building\"\n                            [(ngModel)]=\"building\"\n                            (ngModelChange)=\"\n                                setOptions({\n                                    zone_id: $event?.id\n                                })\n                            \"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                        >\n                            <mat-option\n                                *ngFor=\"let bld of buildings | async\"\n                                [value]=\"bld\"\n                            >\n                                {{ bld.display_name || bld.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <div\n                    class=\"flex flex-col flex-1 w-full sm:w-1/4\"\n                    *ngIf=\"(levels | async)?.length > 1\"\n                >\n                    <label>Level</label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            placeholder=\"Any Level\"\n                            ngModel\n                            [disabled]=\"!building\"\n                            (ngModelChange)=\"\n                                setOptions({\n                                    zone_id: $event || building.id\n                                })\n                            \"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                        >\n                            <mat-option\n                                *ngFor=\"let lvl of levels | async\"\n                                [value]=\"lvl.id\"\n                            >\n                                {{ lvl.display_name || lvl.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n            </div>\n            <div\n                class=\"flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n                *ngIf=\"allow_time_changes\"\n            >\n                <div class=\"flex flex-col flex-1 w-full sm:w-1/3\">\n                    <label>Start Time</label>\n                    <a-time-field\n                        [ngModel]=\"form.value.date\"\n                        (ngModelChange)=\"form.patchValue({ date: $event })\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                    ></a-time-field>\n                </div>\n                <div class=\"flex flex-col flex-1 w-full sm:w-1/3 relative\">\n                    <label>End Time</label>\n                    <a-duration-field\n                        formControlName=\"duration\"\n                        [time]=\"form.get('date')?.value\"\n                        [max]=\"12 * 60\"\n                        [min]=\"60\"\n                        [step]=\"60\"\n                        [disabled]=\"form.value.all_day\"\n                    >\n                    </a-duration-field>\n                    <mat-checkbox\n                        formControlName=\"all_day\"\n                        *ngIf=\"allow_all_day\"\n                        class=\"absolute top-0 right-0\"\n                    >\n                        All Day\n                    </mat-checkbox>\n                </div>\n            </div>\n            <div\n                class=\"flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n                *ngIf=\"can_book_for_others\"\n            >\n                <label>Host</label>\n                <a-user-search-field\n                    formControlName=\"user\"\n                ></a-user-search-field>\n            </div>\n            <div\n                class=\"flex flex-col flex-1 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n                *ngIf=\"needs_reason\"\n            >\n                <label>Details</label>\n                <mat-form-field class=\"w-full\" appearance=\"outline\">\n                    <input\n                        matInput\n                        formControlName=\"description\"\n                        placeholder=\"Reason for booking...\"\n                    />\n                </mat-form-field>\n            </div>\n            <div\n                class=\"flex flex-col flex-1 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n                *ngIf=\"(options | async)?.group\"\n            >\n                <label>Group Members</label>\n                <a-user-list-field\n                    [simple]=\"true\"\n                    [ngModel]=\"(options | async)?.members || []\"\n                    (ngModelChange)=\"setOptions({ members: $event })\"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                ></a-user-list-field>\n            </div>\n            <div\n                class=\"flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n                *ngIf=\"can_recurr\"\n            >\n                <div class=\"flex flex-col flex-1 w-full sm:w-1/3\">\n                    <label>Recurrence Period</label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            [ngModel]=\"(options | async)?.recurrence_pattern\"\n                            (ngModelChange)=\"setOptions({ pattern: $event })\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            placeholder=\"None\"\n                        >\n                            <mat-option value=\"none\">None</mat-option>\n                            <mat-option\n                                *ngFor=\"let opt of recurrence_options\"\n                                [value]=\"opt\"\n                            >\n                                <span class=\"capitalize\">{{ opt }}</span>\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col flex-1 w-full sm:w-1/3\">\n                    <label>Recurrence End</label>\n                    <a-date-field\n                        [disabled]=\"\n                            !(options | async)?.pattern ||\n                            (options | async)?.pattern === 'none'\n                        \"\n                        [ngModel]=\"\n                            (options | async)?.recurr_end || form?.value?.date\n                        \"\n                        (ngModelChange)=\"\n                            setOptions({\n                                recurr_end: $event\n                            })\n                        \"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                        [to]=\"book_until\"\n                    >\n                        Date and time must be in the future\n                    </a-date-field>\n                </div>\n            </div>\n            <div\n                class=\"flex flex-col flex-1 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n                *ngIf=\"(features | async)?.length\"\n            >\n                <label>Desk Features</label>\n                <mat-form-field class=\"w-full\" appearance=\"outline\">\n                    <mat-select\n                        multiple\n                        [ngModel]=\"(options | async)?.features || []\"\n                        (ngModelChange)=\"\n                            setOptions({\n                                features: $event || []\n                            })\n                        \"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                        placeholder=\"Any Feature\"\n                    >\n                        <mat-option\n                            *ngFor=\"let opt of features | async\"\n                            class=\"capitalize\"\n                            [value]=\"opt\"\n                        >\n                            {{ opt }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div\n                class=\"flex flex-col flex-1 w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4\"\n                *ngIf=\"can_book_lockers\"\n            >\n                <mat-checkbox\n                    [ngModel]=\"!!form.value.secondary_resource\"\n                    (ngModelChange)=\"\n                        form.patchValue({\n                            secondary_resource: $event ? 'locker' : ''\n                        })\n                    \"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                >\n                    Require locker\n                </mat-checkbox>\n            </div>\n        </form>\n    `,\n    styles: [``],\n})\nexport class DeskFlowDetailedFormComponent {\n    @Input() public form: FormGroup;\n    /** List of available buildings to select */\n    public readonly buildings = this._org.building_list;\n    /** List of available levels for the selected building */\n    public readonly levels = this._org.active_levels;\n    /** List of set options for desk booking */\n    public readonly options = this._state.options;\n    /** List of set options for desk booking */\n    public readonly features = this._state.features;\n\n    public readonly recurrence_options = ['daily', 'weekly', 'monthly'];\n\n    public get building() {\n        return this._org.building;\n    }\n    public set building(bld) {\n        this._org.building = bld;\n    }\n\n    public readonly setOptions = (o) => this._state.setOptions(o);\n\n    public get can_book_lockers() {\n        return this._settings.get('app.desks.can_book_lockers');\n    }\n\n    public get can_book_for_others() {\n        return this._settings.get('app.desks.can_book_for_others');\n    }\n\n    public get can_recurr() {\n        return this._settings.get('app.desks.recurrence_allowed');\n    }\n\n    public get allow_groups() {\n        return this._settings.get('app.desks.allow_groups');\n    }\n\n    public get needs_reason() {\n        return this._settings.get('app.desks.needs_reason') === true;\n    }\n\n    public get allow_time_changes() {\n        return !!this._settings.get('app.desks.allow_time_changes');\n    }\n\n    public get allow_all_day() {\n        return (\n            this.allow_time_changes &&\n            !!this._settings.get('app.desks.allow_all_day')\n        );\n    }\n\n    public get book_until() {\n        return endOfDay(\n            addDays(\n                Date.now(),\n                this._settings.get('app.desks.available_period') || 90\n            )\n        );\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _org: OrganisationService,\n        private _settings: SettingsService\n    ) {}\n}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BookingFormService, findNearbyFeature } from '@placeos/bookings';\nimport {\n    currentUser,\n    getInvalidFields,\n    notifyError,\n    randomInt,\n    SettingsService,\n} from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { addDays, setHours, addMinutes, roundToNearestMinutes } from 'date-fns';\nimport { first, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'desk-flow-form',\n    template: `\n        <section form class=\"flex-1 min-h-[50%]\">\n            <h2\n                class=\"text-xl uppercase font-medium mb-2 mt-4 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n            >\n                {{ is_edit ? 'Edit' : 'Detailed' }} Desk Booking\n            </h2>\n            <detailed-book-desks-form [form]=\"form\"></detailed-book-desks-form>\n            <div\n                class=\"mb-4 border-b border-gray-300 dark:border-neutral-500 w-full\"\n            ></div>\n            <div\n                class=\"flex flex-col sm:flex-row items-center justify-center space-x-0 space-y-2 sm:space-y-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4\"\n            >\n                <button\n                    class=\"sm:flex-1 w-full sm:w-auto h-[2.75rem] inverse\"\n                    btn\n                    matRipple\n                    clear\n                    (click)=\"clearForm()\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        <app-icon class=\"text-xl\">clear</app-icon>\n                        <span class=\"ml-2 mx-4\">{{\n                            is_edit ? 'Cancel Edit' : 'Clear Form'\n                        }}</span>\n                    </div>\n                </button>\n                <button\n                    class=\"sm:flex-1 w-full sm:w-auto h-[2.75rem]\"\n                    find\n                    btn\n                    matRipple\n                    *ngIf=\"!auto_allocation; else alloc_button\"\n                    (click)=\"findDesk()\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        <app-icon class=\"text-xl\">search</app-icon>\n                        <span class=\"ml-2 mx-4\">{{\n                            is_edit ? 'Update Desk' : 'Find Desk'\n                        }}</span>\n                    </div>\n                </button>\n            </div>\n        </section>\n        <ng-template #alloc_button>\n            <button\n                class=\"sm:flex-1 w-full sm:w-auto h-[2.75rem]\"\n                find\n                btn\n                matRipple\n                (click)=\"allocateDesk()\"\n            >\n                {{ is_edit ? 'Update Desk' : 'Book Desk' }}\n            </button>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n                display: flex;\n                flex-direction: column;\n                overflow: auto;\n            }\n\n            [quick] {\n                background-color: #007ac8;\n            }\n        `,\n    ],\n})\nexport class DeskFlowFormComponent implements OnInit {\n    public time = 0;\n    public level = '';\n\n    public readonly quick_times = [\n        { name: 'Now', value: 0 },\n        {\n            name: 'Tomorrow',\n            value: setHours(addDays(new Date(), 1), 9).valueOf(),\n        },\n    ];\n\n    public levels = [];\n\n    public get is_edit() {\n        return !!this.form?.get('id')?.value;\n    }\n\n    public get auto_allocation() {\n        return !!this._settings.get('app.desks.auto_allocation');\n    }\n\n    public get form() {\n        return this._state.form;\n    }\n\n    public readonly clearForm = () => {\n        this.time = 0;\n        this.level = this._org.building.id;\n        this._state.clearForm();\n    };\n\n    constructor(\n        private _state: BookingFormService,\n        private _router: Router,\n        private _org: OrganisationService,\n        private _settings: SettingsService\n    ) {}\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _));\n        await this._org.active_levels.pipe(first((_) => _?.length > 0));\n        this.level = this._org.building?.id;\n        this.levels = [\n            { id: this._org.building?.id, name: 'Any Level' },\n            ...this._org.levelsForBuilding(this._org.building),\n        ];\n    }\n\n    public quickBook() {\n        this.form.patchValue({\n            date: (this.time < 24 * 60\n                ? addMinutes(\n                      roundToNearestMinutes(new Date(), { nearestTo: 5 }),\n                      this.time\n                  )\n                : setHours(addDays(new Date(), 1), 8)\n            ).valueOf(),\n            title: 'Ad-hoc Desk Booking',\n        });\n        this.findDesk();\n    }\n\n    public findDesk() {\n        this.form.markAllAsTouched();\n        this.form.patchValue({ asset_id: ' ' });\n        if (!this.form.valid) return;\n        this.form.patchValue({ asset_id: '' });\n        this._router.navigate(['/book', 'desks', 'map']);\n    }\n\n    public async allocateDesk() {\n        this.form.markAllAsTouched();\n        this.form.patchValue({ asset_id: ' ' });\n        if (!this.form.valid)\n            return notifyError(\n                `Some fields are invalid. [${getInvalidFields(this.form).join(\n                    ', '\n                )}]`\n            );\n        // Find nearby desk for user's department\n        const settings = this._settings.get('app.departments') || {\n            '*': {\n                level: this._org.levelsForBuilding()[0]?.id,\n                centered_at: { x: 0.5, y: 0.5 },\n            },\n        };\n        const group = currentUser().groups.find((_) => _ in settings) ?? '*';\n        if (!settings[group]) {\n            this._router.navigate(['/book', 'desks', 'map']);\n            return;\n        }\n        const { level, centered_at } = settings[group];\n        const lvl = this._org.levelWithID([level]);\n        if (!lvl) {\n            this._router.navigate(['/book', 'desks', 'map']);\n            return;\n        }\n        const desk_list = await this._state.available_assets\n            .pipe(take(1))\n            .toPromise();\n        const desk_id = level.map_id\n            ? await findNearbyFeature(\n                  lvl.map_id,\n                  centered_at,\n                  desk_list.map((_) => _?.map_id || _?.id || '')\n              )\n            : desk_list[randomInt(desk_list.length)].id;\n        const desk = desk_list.find(\n            (_) => _.map_id === desk_id || _.id === desk_id\n        );\n        if (!desk) {\n            this._router.navigate(['/book', 'desks', 'map']);\n            return;\n        }\n        this._state.form.patchValue({\n            asset_id: desk?.id,\n            asset_name: desk.name || desk.id,\n            map_id: desk?.map_id || desk?.id,\n            description: desk.name || desk.id,\n            booking_type: 'desk',\n            zones: desk.zone ? [desk.zone?.parent_id, desk.zone?.id] : [],\n        });\n        await this._state.confirmPost().catch((_) => console.error(_));\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { BookingFormService } from '@placeos/bookings';\nimport {\n    AsyncHandler,\n    formatRecurrence,\n    SettingsService,\n} from '@placeos/common';\nimport { ExploreStateService } from '@placeos/explore';\nimport { Desk } from '@placeos/organisation';\nimport { format } from 'date-fns';\nimport { BehaviorSubject, combineLatest, of } from 'rxjs';\nimport { debounceTime, map, startWith } from 'rxjs/operators';\n\n@Component({\n    selector: 'desk-flow-map',\n    template: `\n        <div topbar class=\"\">\n            <a\n                button\n                class=\"clear h-[2.75rem] text-white\"\n                btn\n                matRipple\n                [routerLink]=\"['/book', 'desks', 'form']\"\n            >\n                <div class=\"flex items-center justify-center h-full\">\n                    <app-icon class=\"text-xl\">arrow_back</app-icon>\n                    <span class=\"ml-2 mx-4\">Back</span>\n                </div>\n            </a>\n        </div>\n        <div class=\"flex flex-col flex-1 h-1/2 w-full \">\n            <h2 class=\"text-2xl px-4 pt-4 text-center\">Available Desks</h2>\n            <an-action-field\n                class=\"my-4 mx-auto w-[640px] max-w-[calc(100vw-2rem)]\"\n                [matMenuTriggerFor]=\"menu\"\n            >\n                {{ (option_details | async) || 'No Filters' }}\n            </an-action-field>\n            <mat-menu #menu=\"matMenu\">\n                <div\n                    (click)=\"$event.stopPropagation(); ($event.preventDefault)\"\n                    class=\"pt-4 max-h-[65vh] overflow-auto\"\n                >\n                    <detailed-book-desks-form\n                        [form]=\"form\"\n                    ></detailed-book-desks-form>\n                </div>\n            </mat-menu>\n            <div listing class=\"flex flex-1 h-1/2 relative space-x-2\">\n                <ul\n                    class=\"list-style-none w-full sm:w-[20rem] max-w-[48rem] mx-auto bg-gray-100 dark:bg-neutral-600 pb-32 overflow-auto h-full rounded-tr-lg space-y-2\"\n                    [class.!w-full]=\"hide_map\"\n                    [class.rounded-tl-lg]=\"hide_map\"\n                >\n                    <div\n                        class=\"py-2 px-4 sticky top-0 inset-x-0 bg-gray-100 dark:bg-neutral-600 border-b border-gray-200 dark:border-neutral-500 z-10\"\n                    >\n                        {{ (desks | async)?.length || '0' }} matches available\n                    </div>\n                    <li\n                        matRipple\n                        *ngFor=\"let desk of desks | async\"\n                        [attr.desk-id]=\"desk.id\"\n                        class=\"flex items-center p-2 mx-2 bg-white dark:bg-neutral-700 rounded shadow cursor-pointer space-x-2 min-h-[5rem] border\"\n                        [class.border-primary]=\"active_desk?.id === desk.id\"\n                        (click)=\"setActiveDesk(desk)\"\n                    >\n                        <app-icon class=\"text-2xl\">place</app-icon>\n                        <div class=\"flex flex-col w-1/2 flex-1\">\n                            <div name class=\"\">{{ desk.name || desk.id }}</div>\n                            <div level class=\"text-xs\">\n                                {{\n                                    desk.zone?.display_name ||\n                                        desk.zone?.name ||\n                                        '&lt;No Level&gt;'\n                                }}\n                            </div>\n                            <div features class=\"w-full flex flex-wrap\">\n                                <div\n                                    *ngFor=\"let feat of desk.features || []\"\n                                    class=\"text-xs bg-primary text-white rounded-xl px-2 py-1 mt-1 mr-2\"\n                                >\n                                    {{ feat }}\n                                </div>\n                            </div>\n                        </div>\n                    </li>\n                </ul>\n                <div\n                    class=\"hidden sm:block flex-1 bg-gray-200 dark:bg-neutral-600 rounded-tl-lg border-l border-t border-gray-300 dark:border-neutral-500 relative overflow-hidden h-full\"\n                    *ngIf=\"!hide_map\"\n                >\n                    <i-map\n                        [src]=\"url | async\"\n                        [zoom]=\"(positions | async)?.zoom\"\n                        [center]=\"(positions | async)?.center\"\n                        [styles]=\"styles | async\"\n                        [features]=\"features | async\"\n                        [actions]=\"actions | async\"\n                        [labels]=\"labels | async\"\n                        [focus]=\"active_desk?.map_id || active_desk?.id\"\n                    ></i-map>\n                    <div\n                        class=\"absolute top-2 left-2 bg-white dark:bg-neutral-700 rounded-3xl h-10 px-3 flex items-center border border-gray-300 dark:border-neutral-500\"\n                        *ngIf=\"level | async\"\n                    >\n                        {{\n                            (level | async)?.display_name ||\n                                (level | async)?.name\n                        }}\n                    </div>\n                </div>\n                <div\n                    *ngIf=\"loading | async\"\n                    class=\"absolute inset-0 bg-white dark:bg-neutral-700 bg-opacity-60 flex flex-col items-center justify-center space-y-2 !m-0 z-20\"\n                >\n                    <mat-spinner [diameter]=\"32\"></mat-spinner>\n                    <p>{{ loading | async }}</p>\n                </div>\n                <div\n                    selection\n                    class=\"absolute bottom-2 left-1/2 transform -translate-x-1/2 p-2 bg-white dark:bg-neutral-700 shadow rounded w-[24rem] max-w-[calc(100vw-1rem)] space-y-2 !m-0 border border-gray-200\"\n                    *ngIf=\"active_desk\"\n                >\n                    <div class=\"\">\n                        <div name class=\"\">{{ active_desk.name }}</div>\n                        <div level class=\"text-xs\">\n                            {{\n                                active_desk.zone?.display_name ||\n                                    active_desk.zone.name ||\n                                    '&lt;No Level&gt;'\n                            }}\n                        </div>\n                    </div>\n                    <div class=\"flex items-center space-x-2\">\n                        <button\n                            matRipple\n                            class=\"inverse flex-1\"\n                            (click)=\"setActiveDesk(null)\"\n                        >\n                            Clear\n                        </button>\n                        <button\n                            matRipple\n                            class=\"flex-1\"\n                            (click)=\"makeBooking()\"\n                        >\n                            Book\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n                display: flex;\n                flex-direction: column;\n            }\n\n            [topbar] {\n                background-color: #00539f;\n            }\n        `,\n    ],\n})\nexport class DeskFlowMapComponent extends AsyncHandler implements OnInit {\n    /** Observable for the active map */\n    public readonly url = this._explore.map_url;\n    /** Observable for the active map */\n    public readonly styles = this._explore.map_styles;\n    /** Observable for the active map */\n    public readonly positions = this._explore.map_positions;\n    /** Observable for the active map */\n    public readonly features = this._explore.map_features;\n    /** Observable for the active map */\n    public readonly actions = this._explore.map_actions;\n    /** Observable for the labels map */\n    public readonly labels = this._explore.map_labels;\n    public readonly level = this._explore.level;\n\n    public readonly desks = this._state.available_assets;\n\n    public readonly loading = this._state.loading;\n\n    public readonly form = this._state.form;\n\n    public readonly option_details = combineLatest([\n        this._state.options,\n        this.form.valueChanges.pipe(startWith({})),\n    ]).pipe(\n        map(([options]) => {\n            const form = this._state.form;\n            const recurrence = formatRecurrence({\n                pattern: options.pattern as any,\n                end: options.recurr_end,\n                start: form.value.date,\n                interval: 1,\n                days_of_week: -1,\n            });\n            const details = `${format(form.value.date, 'dd MMM yyyy')}${\n                options.pattern && options.pattern !== 'none'\n                    ? ', ' + recurrence\n                    : ''\n            }${options.group ? ', ' + options.group : ''}, ${\n                options.features?.length || 'Any'\n            } Feature${(options.features?.length || 0) < 2 ? '' : 's'}`;\n            if (options.zone_id) this._explore.setLevel(options.zone_id);\n            return details;\n        })\n    );\n\n    private _active_desk = new BehaviorSubject<Desk>(null);\n\n    public readonly makeBooking = () => this._state.confirmPost();\n\n    public get active_desk(): Desk {\n        return this._active_desk.getValue();\n    }\n\n    public get hide_map() {\n        return !!this._settings.get('app.desks.hide_map');\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _settings: SettingsService,\n        private _explore: ExploreStateService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'assets-statue',\n            combineLatest([\n                this._state.assets,\n                this._state.available_assets,\n                this._active_desk,\n            ])\n                .pipe(debounceTime(200))\n                .subscribe(([assets, available]) => {\n                    const status = {};\n                    const actions = [];\n                    for (const desk of assets) {\n                        const active =\n                            desk.bookable &&\n                            available.find((d) => d.id === desk.id);\n                        status[`#${desk.map_id || desk.id}`] = {\n                            fill: desk.bookable\n                                ? available.find((d) => d.id === desk.id)\n                                    ? '#43a047'\n                                    : '#e53935'\n                                : '#999',\n                            opacity: 0.6,\n                        };\n                        if (active)\n                            actions.push({\n                                id: desk.map_id || desk.id,\n                                action: 'click',\n                                callback: () => this.setActiveDesk(desk as any),\n                            });\n                    }\n                    this._explore.setStyles('desks', status);\n                    this._explore.setActions('desks', actions);\n                    this._explore.setFeatures(\n                        'desks',\n                        this.active_desk\n                            ? [\n                                  {\n                                      location:\n                                          this.active_desk.map_id ||\n                                          this.active_desk.id,\n                                      content: `\n                    <span class=\"flex h-4 w-4 rounded-full absolute top-1/4 left-1/4 transform -translate-x-1/2 -translate-y-1/2 border-[3px] border-white dark:border-neutral-4å00 shadow\" >\n                        <span class=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75\"></span>\n                        <span class=\"relative inline-flex rounded-full h-full w-full bg-primary\"></span>\n                    </span>`,\n                                  },\n                              ]\n                            : []\n                    );\n                })\n        );\n    }\n\n    public setActiveDesk(desk: Desk) {\n        this._explore.setLevel(desk?.zone?.id);\n        this._active_desk.next(desk);\n        this._state.form.patchValue({\n            asset_id: desk?.id,\n            asset_name: desk.name,\n            map_id: desk?.map_id || desk?.id,\n            description: desk.name,\n            booking_type: 'desk',\n            zones: desk.zone ? [desk.zone?.parent_id, desk.zone?.id] : [],\n        });\n    }\n}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'desk-flow-confirm',\n    template: `\n        <div topbar class=\"\">\n            <a\n                btn\n                matRipple\n                class=\"clear h-[2.75rem] text-white\"\n                [routerLink]=\"['/book', 'desks', 'map']\"\n            >\n                <div class=\"flex items-center justify-center h-full\">\n                    <app-icon class=\"text-xl\">arrow_back</app-icon>\n                    <span class=\"ml-2 mx-4\">Back</span>\n                </div>\n            </a>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n                display: flex;\n                flex-direction: column;\n            }\n\n            [topbar] {\n                background-color: #00539f;\n            }\n        `,\n    ],\n})\nexport class DeskFlowConfirmComponent {}\n","import { Component, Input } from '@angular/core';\nimport { currentUser } from '@placeos/common';\n\n@Component({\n    selector: 'flow-success',\n    template: `\n        <div\n            name=\"success\"\n            class=\"fixed inset-0 flex flex-col bg-indigo-900 items-center justify-center z-50\"\n        >\n            <div class=\"text-7xl rounded-full bg-white text-success mb-4\">\n                <app-icon>done</app-icon>\n            </div>\n            <div class=\"text-center text-lg text-white mb-4 leading-10\">\n                Thank you, your {{ type }} booking was successful!<br />\n                {{ extra }} <br *ngIf=\"extra\" />\n                An event has been added to {{ title }} calendar\n            </div>\n            <div class=\"flex items-center space-x-2\">\n                <a\n                    btn\n                    matRipple\n                    class=\"w-32 border border-white\"\n                    [routerLink]=\"['/book', route]\"\n                    [queryParams]=\"{}\"\n                >\n                    New Booking\n                </a>\n                <a\n                    btn\n                    matRipple\n                    class=\"w-32 border border-white\"\n                    [routerLink]=\"['/schedule']\"\n                    [queryParams]=\"{ email: calendar }\"\n                >\n                    Your Bookings\n                </a>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class FlowSuccessComponent {\n    @Input() public calendar: string;\n    @Input() public extra = '';\n    @Input() public route = 'spaces';\n    @Input() public type = 'space';\n\n    public get is_host(): boolean {\n        return this.calendar === currentUser()?.email;\n    }\n\n    public get title() {\n        return this.is_host ? 'your' : \"the host'\";\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { BookingFormService } from '@placeos/bookings';\nimport { AsyncHandler } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { first } from 'rxjs/operators';\n\n@Component({\n    selector: 'placeos-book-desk-flow',\n    template: `\n        <div class=\"bg-white dark:bg-neutral-700 h-full w-full\">\n            <ng-container [ngSwitch]=\"view\">\n                <ng-container *ngSwitchCase=\"'map'\">\n                    <desk-flow-map></desk-flow-map>\n                </ng-container>\n                <ng-container *ngSwitchCase=\"'confirm'\">\n                    <desk-flow-confirm></desk-flow-confirm>\n                </ng-container>\n                <ng-container *ngSwitchCase=\"'success'\">\n                    <flow-success\n                        type=\"desk\"\n                        route=\"desks\"\n                        [calendar]=\"last_success?.user_email\"\n                        [extra]=\"\n                            last_success?.extension_data?.secondary_resource\n                                ? 'Locker E-093 has been allocated for this booking.'\n                                : ''\n                        \"\n                    ></flow-success>\n                </ng-container>\n                <ng-container *ngSwitchDefault>\n                    <desk-flow-form></desk-flow-form>\n                </ng-container>\n            </ng-container>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class BookDeskFlowComponent extends AsyncHandler implements OnInit {\n    public get view() {\n        return this._state.view;\n    }\n    public get last_success() {\n        return this._state.last_success;\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _route: ActivatedRoute,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this._state.loadForm();\n        if (!this._state.form) this._state.newForm();\n        this._state.form.patchValue({ booking_type: 'desk' });\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((param) => {\n                if (param.has('step'))\n                    this._state.setView(param.get('step') as any);\n            })\n        );\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((param) => {\n                if (param.has('success'))\n                    this._state.setView(param.get('success') as any);\n            })\n        );\n    }\n}\n","import { Component, Input, EventEmitter, Output } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { CateringOrder, CateringStateService } from '@placeos/catering';\nimport { SettingsService } from '@placeos/common';\nimport { EventFlowOptions } from '@placeos/events';\nimport { OrganisationService } from '@placeos/organisation';\n\n@Component({\n    selector: 'detailed-book-space-form',\n    template: `\n        <form *ngIf=\"form\" [formGroup]=\"form\">\n            <section class=\"mb-4 border-b border-gray-300 dark:border-neutral-500\">\n                <div\n                    class=\"flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n                >\n                    <div class=\"flex flex-col flex-1 w-full sm:w-1/3\">\n                        <label for=\"date\">Date</label>\n                        <a-date-field name=\"date\" formControlName=\"date\">\n                            Date and time must be in the future\n                        </a-date-field>\n                    </div>\n                    <div class=\"flex flex-col flex-1 w-full sm:w-1/3\">\n                        <label for=\"start-time\">Start Time</label>\n                        <a-time-field\n                            name=\"start-time\"\n                            [ngModel]=\"form.value.date\"\n                            (ngModelChange)=\"form.patchValue({ date: $event })\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                        ></a-time-field>\n                    </div>\n                    <div class=\"flex flex-col flex-1 w-full sm:w-1/3 relative\">\n                        <label for=\"end-time\">End Time</label>\n                        <a-duration-field\n                            name=\"end-time\"\n                            formControlName=\"duration\"\n                            [time]=\"form.value.date\"\n                            [max]=\"max_duration\"\n                        >\n                        </a-duration-field>\n                        <mat-checkbox\n                            formControlName=\"all_day\"\n                            *ngIf=\"allow_all_day\"\n                            class=\"absolute top-0 right-0\"\n                        >\n                            All Day\n                        </mat-checkbox>\n                    </div>\n                </div>\n                <div\n                    class=\"flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n                >\n                    <div\n                        class=\"flex flex-col flex-1 w-full\"\n                        *ngIf=\"show_features && features?.length\"\n                    >\n                        <label for=\"building\">Building</label>\n                        <mat-form-field\n                            overlay\n                            buildings\n                            class=\"w-full h-[3.25rem]\"\n                            *ngIf=\"(buildings | async)?.length > 1\"\n                            appearance=\"outline\"\n                        >\n                            <mat-select\n                                placeholder=\"Select Building...\"\n                                [ngModel]=\"building\"\n                                (ngModelChange)=\"setBuilding($event)\"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                            >\n                                <mat-option\n                                    *ngFor=\"let bld of buildings | async\"\n                                    [value]=\"bld\"\n                                >\n                                    {{ bld.display_name || bld.name }}\n                                </mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <div\n                        class=\"flex flex-col flex-1 w-full\"\n                        *ngIf=\"show_features && features?.length\"\n                    >\n                        <label for=\"features\">Features</label>\n                        <mat-form-field\n                            class=\"w-full h-[3.25rem]\"\n                            overlay\n                            appearance=\"outline\"\n                        >\n                            <mat-select\n                                [placeholder]=\"'Any ' + features_label\"\n                                multiple\n                                [ngModel]=\"options?.features\"\n                                (ngModelChange)=\"\n                                    optionsChange.emit({ features: $event })\n                                \"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                            >\n                                <mat-option\n                                    *ngFor=\"let item of features\"\n                                    [value]=\"item\"\n                                >\n                                    {{ item }}\n                                </mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                </div>\n            </section>\n            <section\n                class=\"mb-4 border-b border-gray-300 dark:border-neutral-500\"\n                *ngIf=\"can_book_for_others || !hide_attendees\"\n            >\n                <div\n                    class=\"flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n                    *ngIf=\"can_book_for_others\"\n                >\n                    <label for=\"host\">Host<span>*</span></label>\n                    <host-select-field\n                        name=\"host\"\n                        formControlName=\"organiser\"\n                    ></host-select-field>\n                </div>\n                <div\n                    class=\"flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-2\"\n                    *ngIf=\"!hide_attendees\"\n                >\n                    <label for=\"attendees\">Attendees</label>\n                    <a-user-list-field\n                        name=\"attendees\"\n                        [hideActions]=\"hide_actions\"\n                        formControlName=\"attendees\"\n                    ></a-user-list-field>\n                </div>\n            </section>\n            <section class=\"mb-4 border-b border-gray-300 dark:border-neutral-500\">\n                <div class=\"w-[640px] max-w-[calc(100%-2rem)] mx-auto\">\n                    <div class=\"flex flex-col\">\n                        <label for=\"title\"\n                            >Meeting Subject <span>*</span></label\n                        >\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                name=\"title\"\n                                matInput\n                                formControlName=\"title\"\n                                placeholder=\"Meeting title\"\n                            />\n                            <mat-error>Meeting Subject is required</mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div\n                        class=\"flex flex-col resize-y mb-4\"\n                        *ngIf=\"!hide_notes\"\n                    >\n                        <label for=\"notes\">Notes</label>\n                        <rich-text-input\n                            name=\"notes\"\n                            formControlName=\"body\"\n                            placeholder=\"Add meeting notes here...\"\n                        ></rich-text-input>\n                    </div>\n                    <div class=\"flex flex-col mb-4\" *ngIf=\"has_catering\">\n                        <label>Catering</label>\n                        <an-action-field (onAction)=\"editCatering()\">\n                            <div\n                                class=\"opacity-40\"\n                                *ngIf=\"!form?.value.catering?.length\"\n                            >\n                                Add catering\n                            </div>\n                            <div\n                                class=\"flex items-center\"\n                                *ngIf=\"form?.value.catering?.length\"\n                            >\n                                <div class=\"flex-1 w-1/2\">\n                                    {{ form?.value.catering[0].item_count }}\n                                    item(s)\n                                </div>\n                                <div class=\"text-xs opacity-60 px-4\">\n                                    {{\n                                        form?.value.catering[0].total_cost / 100\n                                            | currency:code\n                                    }}\n                                </div>\n                            </div>\n                        </an-action-field>\n                    </div>\n                </div>\n            </section>\n        </form>\n    `,\n    styles: [``],\n})\nexport class DetailBookSpaceFormComponent {\n    @Input() public form: FormGroup;\n    @Input() public options: EventFlowOptions;\n    @Input() public features: string[] = [];\n    @Output() public optionsChange = new EventEmitter<EventFlowOptions>();\n\n    public readonly buildings = this._org.building_list;\n    public readonly setBuilding = (b) => this._org.building = b;\n\n    public get building() {\n        return this._org.building;\n    }\n\n    public get has_catering() {\n        return !!this._settings.get('app.events.has_catering');\n    }\n\n    public get hide_actions() {\n        return !!this._settings.get('app.events.hide_user_actions');\n    }\n\n    public get hide_notes() {\n        return !!this._settings.get('app.events.hide_notes');\n    }\n\n    public get hide_attendees() {\n        return !!this._settings.get('app.events.hide_attendees');\n    }\n\n    public get can_book_for_others() {\n        return this._settings.get('app.events.can_book_for_others');\n    }\n\n    public get allow_all_day() {\n        return this._settings.get('app.events.allow_all_day');\n    }\n\n    public get max_duration() {\n        return this._settings.get('app.events.max_duration') || 4 * 60;\n    }\n\n    public get show_features() {\n        return !!this._settings.get('app.events.features_on_form');\n    }\n\n    public get features_label() {\n        return this._settings.get('app.events.features_label') || 'feature';\n    }\n\n    public get code() {\n        return this._org.currency_code;\n    }\n\n    public readonly editCatering = async () =>\n        this.form.patchValue({\n            catering: [\n                await this._catering.manageCateringOrder(\n                    (this.form.value.catering\n                        ? this.form.value.catering[0]\n                        : null) || new CateringOrder()\n                ),\n            ],\n        });\n\n    constructor(\n        private _catering: CateringStateService,\n        private _org: OrganisationService,\n        private _settings: SettingsService\n    ) {}\n}\n","import { Component } from '@angular/core';\nimport { Router } from '@angular/router';\nimport {\n    currentUser,\n    getInvalidFields,\n    notifyError,\n    SettingsService,\n} from '@placeos/common';\nimport { EventFormService } from '@placeos/events';\nimport { addDays, addMinutes, roundToNearestMinutes, setHours } from 'date-fns';\n\n@Component({\n    selector: 'space-flow-form',\n    template: `\n        <section form class=\"flex-1 min-h-[50%]\">\n            <h2\n                class=\"text-xl uppercase font-medium mb-2 mt-4 w-[640px] max-w-[calc(100%-2rem)] mx-auto\"\n            >\n                {{ is_edit ? 'Edit' : 'Detailed' }} Space Booking\n            </h2>\n            <detailed-book-space-form\n                [form]=\"form\"\n                [options]=\"options | async\"\n                (optionsChange)=\"setOptions($event)\"\n                [features]=\"features | async\"\n            ></detailed-book-space-form>\n            <div\n                class=\"flex flex-col sm:flex-row items-center justify-center space-x-0 space-y-2 sm:space-y-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4\"\n            >\n                <button\n                    class=\"sm:flex-1 w-full sm:w-auto h-[2.75rem] inverse\"\n                    btn\n                    matRipple\n                    clear\n                    (click)=\"clearForm()\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        <app-icon class=\"text-xl\">clear</app-icon>\n                        <span class=\"ml-2 mx-4\">{{\n                            is_edit ? 'Cancel Edit' : 'Clear Form'\n                        }}</span>\n                    </div>\n                </button>\n                <button\n                    class=\"sm:flex-1 w-full sm:w-auto h-[2.75rem]\"\n                    btn\n                    matRipple\n                    find-space\n                    (click)=\"findSpace()\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        <app-icon class=\"text-xl\">search</app-icon>\n                        <span class=\"ml-2 mx-4\">{{\n                            is_edit ? 'Update Spaces' : 'Find Space'\n                        }}</span>\n                    </div>\n                </button>\n                <button\n                    class=\"sm:flex-1 w-full sm:w-auto h-[2.75rem]\"\n                    btn\n                    matRipple\n                    standalone\n                    *ngIf=\"is_edit || allow_standalone_bookings\"\n                    (click)=\"confirmBooking()\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        <app-icon class=\"text-xl\">event_available</app-icon>\n                        <span class=\"ml-2 mx-4\">{{\n                            is_edit ? 'Confirm changes' : 'Book without Space'\n                        }}</span>\n                    </div>\n                </button>\n            </div>\n        </section>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n                display: flex;\n                flex-direction: column;\n                overflow: auto;\n            }\n\n            [quick] {\n                background-color: #007ac8;\n            }\n        `,\n    ],\n})\nexport class SpaceFlowFormComponent {\n    public time = 0;\n    public capacity = 0;\n\n    public readonly quick_times = [\n        { name: 'Now', value: 0 },\n        { name: 'Later Today', value: 120 },\n        {\n            name: 'Tomorrow',\n            value: setHours(addDays(new Date(), 1), 9).valueOf(),\n        },\n    ];\n\n    public readonly quick_capacities = [\n        { name: 'Any Capacity', value: 0 },\n        { name: 'Small (1 - 4)', value: 1 },\n        { name: 'Medium (5 - 12)', value: 5 },\n        { name: 'Large (13 - 32)', value: 13 },\n        { name: 'Huge (32+)', value: 33 },\n    ];\n\n    public readonly options = this._state.options;\n    public readonly features = this._state.features;\n    public readonly setOptions = (o) => this._state.setOptions(o);\n\n    public get is_edit() {\n        return !!this.form?.value?.id;\n    }\n\n    public get form() {\n        return this._state.form;\n    }\n\n    public get allow_standalone_bookings() {\n        return this._settings.get('app.events.allow_standalone_bookings');\n    }\n\n    public readonly clearForm = () => {\n        this.time = this.capacity = 0;\n        this._state.clearForm();\n    };\n\n    constructor(\n        private _state: EventFormService,\n        private _settings: SettingsService,\n        private _router: Router\n    ) {}\n\n    public quickBook() {\n        if (!this.form.value.host)\n            this.form.patchValue({ host: currentUser()?.email });\n        this.form.patchValue({\n            date: (this.time < 24 * 60\n                ? addMinutes(\n                      roundToNearestMinutes(new Date(), { nearestTo: 5 }),\n                      this.time\n                  )\n                : setHours(addDays(new Date(), 1), 8)\n            ).valueOf(),\n            title: 'Ad-hoc Meeting',\n        });\n        this._state.setOptions({ capacity: this.capacity });\n        this._router.navigate(['/book', 'spaces', 'find']);\n    }\n\n    public findSpace() {\n        this.form.markAllAsTouched();\n        if (!this.form.value.host)\n            this.form.patchValue({ host: currentUser()?.email });\n        if (!this.form.valid)\n            return notifyError(\n                `Some fields are invalid. [${getInvalidFields(this.form).join(\n                    ', '\n                )}]`\n            );\n        this._router.navigate(['/book', 'spaces', 'find']);\n    }\n\n    public confirmBooking() {\n        if (!this.form.value.host)\n            this.form.patchValue({ host: currentUser()?.email });\n        this.form.markAllAsTouched();\n        if (!this.form.valid)\n            return notifyError(\n                `Some fields are invalid. [${getInvalidFields(this.form).join(\n                    ', '\n                )}]`\n            );\n        this._router.navigate(['/book', 'spaces', 'confirm']);\n    }\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Space } from '@placeos/spaces';\nimport { MapLocateModalComponent } from '@placeos/components';\n\n@Component({\n    selector: 'space-flow-find-item',\n    template: `\n        <div\n            class=\"flex items-center bg-white dark:bg-neutral-700 p-2 my-2 shadow w-[640px] max-w-[calc(100%-2rem)] mx-auto rounded\"\n        >\n            <div class=\"flex flex-col flex-1 space-y-2 \">\n                <div class=\"flex items-center\">\n                    <div\n                        class=\"p-2 rounded-full bg-gray-300 dark:bg-neutral-600 mr-2\"\n                    >\n                        <app-icon>place</app-icon>\n                    </div>\n                    <span\n                        >{{ space?.level?.display_name || space?.level?.name }},\n                        {{ space?.display_name || space?.name }}</span\n                    >\n                </div>\n                <div class=\"flex items-center\">\n                    <div\n                        class=\"p-2 rounded-full bg-gray-300 dark:bg-neutral-600 mr-2\"\n                    >\n                        <app-icon>group</app-icon>\n                    </div>\n                    <span>{{ space?.capacity || 0 }} People</span>\n                </div>\n            </div>\n            <div class=\"flex flex-col space-y-2 ml-2\">\n                <button\n                    matRipple\n                    book\n                    [class.bg-pending]=\"multiple && book\"\n                    [class.border-pending]=\"multiple && book\"\n                    (click)=\"bookSpace()\"\n                >\n                    {{ multiple ? (book ? 'Remove' : 'Select') : 'Book' }}\n                </button>\n                <button\n                    locate\n                    btn\n                    matRipple\n                    class=\"inverse\"\n                    (click)=\"viewLocation()\"\n                >\n                    Map\n                </button>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            button {\n                width: 8rem;\n            }\n        `,\n    ],\n})\nexport class SpaceFlowFindItemComponent {\n    /** Space to display details for */\n    @Input() public space: Space;\n    /** Whether space should be booked */\n    @Input() public multiple: boolean;\n    /** Whether space should be booked */\n    @Input() public book: boolean;\n    /** Emitter for changes to book value */\n    @Output() public bookChange = new EventEmitter<boolean>();\n\n    constructor(private _dialog: MatDialog) {}\n\n    public bookSpace() {\n        this.book = this.multiple ? !this.book : true;\n        this.bookChange.emit(this.book);\n    }\n\n    public viewLocation() {\n        this._dialog.open(MapLocateModalComponent, {\n            maxWidth: '95vw',\n            maxHeight: '95vh',\n            data: { item: this.space },\n        });\n    }\n}\n","import { Component, OnInit, Optional } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { HashMap, SettingsService } from '@placeos/common';\nimport { EventFormService } from '@placeos/events';\nimport { OrganisationService } from '@placeos/organisation';\nimport { Space } from '@placeos/spaces';\nimport { SpacePipe } from 'libs/spaces/src/lib/space.pipe';\nimport { combineLatest } from 'rxjs';\nimport { filter, first, map, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'space-flow-find',\n    template: `\n        <div topbar class=\"\">\n            <a\n                button\n                class=\"clear h-[2.75rem] text-white\"\n                btn\n                matRipple\n                [routerLink]=\"['/book', 'spaces', 'form']\"\n            >\n                <div class=\"flex items-center justify-center h-full\">\n                    <app-icon class=\"text-xl\">arrow_back</app-icon>\n                    <span class=\"ml-2 mx-4\">Back</span>\n                </div>\n            </a>\n        </div>\n        <div filters>\n            <div class=\"w-[640px] max-w-[calc(100%-2rem)] mx-auto py-4\">\n                <h2 class=\"text-xl uppercase font-medium text-white\">\n                    Available Spaces\n                </h2>\n                <div\n                    class=\"flex flex-col items-center sm:flex-row space-x-0 sm:space-x-2\"\n                >\n                    <mat-form-field\n                        overlay\n                        buildings\n                        class=\"w-full sm:w-px sm:flex-1 h-[3.25rem]\"\n                        *ngIf=\"(buildings | async)?.length > 1\"\n                        appearance=\"outline\"\n                    >\n                        <mat-select\n                            placeholder=\"Select Building...\"\n                            [ngModel]=\"building | async\"\n                            (ngModelChange)=\"setBuilding($event)\"\n                        >\n                            <mat-option\n                                *ngFor=\"let bld of buildings | async\"\n                                [value]=\"bld\"\n                            >\n                                {{ bld.display_name || bld.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                    <mat-form-field\n                        class=\"w-full sm:w-px sm:flex-1 h-[3.25rem]\"\n                        overlay\n                        *ngIf=\"(levels | async)?.length > 0\"\n                        appearance=\"outline\"\n                    >\n                        <mat-select\n                            placeholder=\"Level\"\n                            [ngModel]=\"\n                                (options | async)?.zone_ids?.length\n                                    ? (options | async)?.zone_ids[0]\n                                    : ''\n                            \"\n                            (ngModelChange)=\"setOptions({ zone_ids: [$event] })\"\n                        >\n                            <mat-option\n                                *ngFor=\"let item of levels | async\"\n                                [value]=\"item.id\"\n                            >\n                                {{ item.display_name || item.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                    <mat-form-field\n                        class=\"w-full sm:w-px sm:flex-1 h-[3.25rem] hidden sm:block\"\n                        overlay\n                        appearance=\"outline\"\n                    >\n                        <mat-select\n                            placeholder=\"Any Capacity\"\n                            [ngModel]=\"(options | async)?.capacity\"\n                            (ngModelChange)=\"setOptions({ capacity: $event })\"\n                        >\n                            <mat-option\n                                *ngFor=\"let item of quick_capacities\"\n                                [value]=\"item.value\"\n                            >\n                                {{ item.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                    <mat-form-field\n                        class=\"w-full sm:w-px sm:flex-1 h-[3.25rem] hidden sm:block\"\n                        overlay\n                        appearance=\"outline\"\n                        *ngIf=\"(features | async)?.length\"\n                    >\n                        <mat-select\n                            [placeholder]=\"'Any ' + features_label\"\n                            multiple\n                            [ngModel]=\"(options | async)?.features\"\n                            (ngModelChange)=\"setOptions({ features: $event })\"\n                        >\n                            <mat-option\n                                *ngFor=\"let item of features | async\"\n                                [value]=\"item\"\n                            >\n                                {{ item }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n            </div>\n        </div>\n        <div\n            class=\"flex-1 w-full bg-gray-100 dark:bg-neutral-600 overflow-auto\"\n        >\n            <ng-container *ngIf=\"!(loading | async); else load_state\">\n                <ng-container\n                    *ngIf=\"(spaces | async)?.length > 0; else empty_state\"\n                >\n                    <space-flow-find-item\n                        *ngFor=\"let space of spaces | async\"\n                        class=\"w-[640px] max-w-[calc(100%-2rem)] mx-auto \"\n                        [space]=\"space\"\n                        [multiple]=\"multiple\"\n                        [book]=\"book_space[space.id]\"\n                        (bookChange)=\"handleBookEvent(space, $event)\"\n                    ></space-flow-find-item>\n                    <p class=\"p-4 text-center opacity-60\">\n                        End of available spaces list\n                    </p>\n                </ng-container>\n            </ng-container>\n        </div>\n        <div\n            *ngIf=\"multiple\"\n            class=\"bg-white dark:bg-neutral-700 border-t border-gray-200\"\n        >\n            <div\n                class=\"flex items-center w-[640px] max-w-[calc(100%-2rem)] mx-auto p-2\"\n            >\n                <div class=\"flex-1 underline\" [matMenuTriggerFor]=\"menu\">\n                    {{ space_list?.length }} space(s) selected\n                </div>\n                <button\n                    class=\"w-32\"\n                    [disabled]=\"!space_list?.length\"\n                    btn\n                    matRipple\n                    (click)=\"confirmBooking()\"\n                >\n                    Book\n                </button>\n            </div>\n            <mat-menu #menu=\"matMenu\" yPosition=\"above\">\n                <div\n                    class=\"flex items-center pointer-events-none leading-tight\"\n                    mat-menu-item\n                    *ngFor=\"let space of space_list\"\n                >\n                    <div class=\"flex flex-col mr-4\">\n                        <div>{{ space.display_name || space.name }}</div>\n                        <div class=\"text-xs opacity-70\">\n                            {{ space.level?.display_name || space.level?.name }}\n                            ~ {{ space.capacity || '2+' }} People\n                        </div>\n                    </div>\n                    <button\n                        icon\n                        matRipple\n                        class=\"pointer-events-auto\"\n                        (click)=\"\n                            this.handleBookEvent(space, false);\n                            $event.stopPropagation()\n                        \"\n                    >\n                        <app-icon>close</app-icon>\n                    </button>\n                </div>\n                <div\n                    mat-menu-item\n                    class=\" opacity-60\"\n                    *ngIf=\"!space_list?.length\"\n                >\n                    No selected spaces\n                </div>\n            </mat-menu>\n        </div>\n        <ng-template #load_state>\n            <div\n                class=\"h-full w-full flex flex-col items-center justify-center space-y-2\"\n            >\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p>Retrieving available spaces...</p>\n            </div>\n        </ng-template>\n        <ng-template #empty_state>\n            <div\n                class=\"h-full w-full flex flex-col items-center justify-center space-y-2 p-8 text-center\"\n            >\n                <p>\n                    No available spaces for selected time, capacity or level(s)\n                </p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n                display: flex;\n                flex-direction: column;\n            }\n\n            [topbar] {\n                background-color: var(--secondary-dark);\n            }\n\n            [filters] {\n                background-color: var(--secondary);\n            }\n        `,\n    ],\n    providers: [SpacePipe],\n})\nexport class SpaceFlowFindComponent implements OnInit {\n    public book_space: HashMap<boolean> = {};\n    public quick_capacities = [\n        { name: 'Any Capacity', value: 0 },\n        { name: 'Small (1 - 4)', value: 1 },\n        { name: 'Medium (5 - 12)', value: 5 },\n        { name: 'Large (13 - 32)', value: 13 },\n        { name: 'Huge (32+)', value: 33 },\n    ];\n\n    public space_list: Space[] = [];\n\n    /** List of available buildings */\n    public readonly buildings = this._org.building_list;\n    /** Currently active building */\n    public readonly building = this._org.active_building;\n\n    public readonly levels = combineLatest([\n        this.building,\n        this._state.options,\n    ]).pipe(\n        filter(([_]) => !!_),\n        map(([bld]) => [\n            {\n                id: this._org.building.id,\n                name: 'All Levels',\n            },\n            ...this._org.levelsForBuilding(bld),\n        ])\n    );\n\n    public readonly loading = this._state.loading;\n    public readonly options = this._state.options;\n\n    public readonly spaces = this._state.available_spaces;\n    public readonly features = this._state.features;\n    public async setBuilding(bld) {\n        const opts = await this.options.pipe(take(1)).toPromise();\n        if (bld) this._org.building = bld;\n        const levels = this._org.levelsForBuilding(this._org.building);\n        const lvl = levels.find((_) => opts.zone_ids?.includes(_.id));\n        if (!lvl && levels.length) {\n            this.setOptions({ zone_ids: [levels[0].id] });\n        }\n    }\n\n    public readonly setOptions = (o) => this._state.setOptions(o);\n\n    public get multiple() {\n        return this._settings.get('app.events.multiple_spaces') ?? false;\n    }\n\n    public get features_label() {\n        return this._settings.get('app.events.features_label') || 'feature';\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _state: EventFormService,\n        private _settings: SettingsService,\n        private _router: Router,\n        private _space_pipe: SpacePipe\n    ) {}\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => !!_)).toPromise();\n        this.setBuilding(this._org.building);\n        this.book_space = {};\n        const resources = this._state.form?.get('resources')?.value || [];\n        resources.forEach((_) => (this.book_space[_.id] = true));\n        this.space_list = await this._getSpaceList();\n    }\n\n    public async handleBookEvent(space: Space, book: boolean = true) {\n        if (this.multiple) {\n            this.book_space[space.id] = book;\n        } else {\n            this.book_space = {};\n            this.book_space[space.id] = book;\n            this.confirmBooking();\n        }\n        this.space_list = await this._getSpaceList();\n    }\n\n    public async confirmBooking() {\n        const spaces = await this._getSpaceList();\n        this._state.form.patchValue({\n            resources: spaces,\n            system: spaces[0] as any,\n        });\n        this._router.navigate(['/book', 'spaces', 'confirm']);\n    }\n\n    private _getSpaceList() {\n        const id_list = Object.keys(this.book_space).filter(\n            (k) => this.book_space[k]\n        );\n        return id_list.length\n            ? Promise.all(id_list.map((_) => this._space_pipe.transform(_)))\n            : Promise.resolve([]);\n    }\n}\n","import { Component } from '@angular/core';\nimport { CateringItem } from '@placeos/catering';\nimport { notifyError, SettingsService } from '@placeos/common';\nimport { EventFormService } from '@placeos/events';\nimport { OrganisationService } from '@placeos/organisation';\n\n@Component({\n    selector: 'space-flow-confirm',\n    template: `\n        <div topbar class=\"\">\n            <a\n                button\n                class=\"clear h-[2.75rem] text-white\"\n                btn\n                matRipple\n                [routerLink]=\"['/book', 'spaces', 'find']\"\n            >\n                <div class=\"flex items-center justify-center h-full\">\n                    <app-icon class=\"text-xl\">arrow_back</app-icon>\n                    <span class=\"ml-2 mx-4\">Back</span>\n                </div>\n            </a>\n        </div>\n        <div\n            class=\"flex flex-col items-center space-y-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4\"\n        >\n            <h2 class=\"text-xl uppercase font-medium w-full my-4\">\n                Your meeting details\n            </h2>\n            <div\n                class=\"flex items-center py-2 space-x-2 border-b border-gray-200 w-full\"\n            >\n                <div\n                    class=\"p-2 rounded-full bg-gray-300 dark:bg-neutral-600 mr-2\"\n                >\n                    <app-icon>event</app-icon>\n                </div>\n                <div class=\"flex-1 truncate\">\n                    {{ form.value.date | date: 'longDate' }}\n                    <span *ngIf=\"!form.value.all_day\">\n                        at {{ form.value.date | date: 'shortTime' }} ~\n                        {{\n                            form.value.date + form.value.duration * 60 * 1000\n                                | date: 'shortTime'\n                        }}\n                    </span>\n                </div>\n                <a\n                    btn\n                    matRipple\n                    class=\"clear underline\"\n                    [routerLink]=\"['/book', 'spaces', 'form']\"\n                    >Edit</a\n                >\n            </div>\n            <div\n                class=\"flex items-center py-2 space-x-2 border-b border-gray-200 w-full\"\n            >\n                <div\n                    class=\"p-2 rounded-full bg-gray-300 dark:bg-neutral-600 mr-2\"\n                >\n                    <app-icon>schedule</app-icon>\n                </div>\n                <div class=\"flex-1 truncate\">\n                    {{\n                        form.value.all_day\n                            ? 'All Day'\n                            : (form.value.duration | duration)\n                    }}\n                </div>\n                <a\n                    btn\n                    matRipple\n                    class=\"clear underline\"\n                    [routerLink]=\"['/book', 'spaces', 'form']\"\n                >\n                    Edit\n                </a>\n            </div>\n            <div class=\"border-b border-gray-200 w-full\">\n                <div class=\"flex items-center py-2 space-x-2 \">\n                    <div\n                        class=\"p-2 rounded-full bg-gray-300 dark:bg-neutral-600 mr-2\"\n                    >\n                        <app-icon>place</app-icon>\n                    </div>\n                    <div class=\"flex-1 truncate\">\n                        {{ form.get('resources')?.value?.length }} Space(s)\n                    </div>\n                    <button\n                        matRipple\n                        [disabled]=\"!form.get('resources')?.value?.length\"\n                        class=\"clear bg-transparent border-none underline\"\n                        (click)=\"show_spaces = !show_spaces\"\n                    >\n                        {{ show_spaces ? 'Hide' : 'Show' }}\n                    </button>\n                    <a\n                        btn\n                        matRipple\n                        class=\"clear underline\"\n                        [routerLink]=\"['/book', 'spaces', 'find']\"\n                        >Edit</a\n                    >\n                </div>\n                <div\n                    list\n                    [style.height]=\"\n                        !show_spaces\n                            ? '0'\n                            : form.get('resources')?.value?.length * 2.5 + 'rem'\n                    \"\n                    class=\"overflow-hidden\"\n                >\n                    <div\n                        class=\"flex items-center h-10 pl-12\"\n                        *ngFor=\"let space of form.get('resources')?.value\"\n                    >\n                        <span\n                            >{{ space.display_name || space.name }} [{{\n                                space.level?.display_name || space.level?.name\n                            }}]</span\n                        >\n\n                        <button\n                            matRipple\n                            class=\"bg-transparent border-none underline\"\n                            *ngIf=\"can_view_location\"\n                        >\n                            Map\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <div class=\"border-b border-gray-200 w-full\">\n                <div class=\"flex items-center py-2 space-x-2 \">\n                    <div\n                        class=\"p-2 rounded-full bg-gray-300 dark:bg-neutral-600 mr-2\"\n                    >\n                        <app-icon>group</app-icon>\n                    </div>\n                    <div class=\"flex-1 truncate\">\n                        {{ form.get('attendees')?.value?.length || 0 }}\n                        Attendee(s)\n                    </div>\n                    <button\n                        matRipple\n                        [disabled]=\"!form.get('attendees')?.value?.length\"\n                        class=\"clear bg-transparent border-none underline\"\n                        (click)=\"show_people = !show_people\"\n                    >\n                        {{ show_people ? 'Hide' : 'Show' }}\n                    </button>\n                    <a\n                        btn\n                        matRipple\n                        class=\"clear underline\"\n                        [routerLink]=\"['/book', 'spaces', 'form']\"\n                        >Edit</a\n                    >\n                </div>\n                <div\n                    list\n                    [style.height]=\"\n                        !show_people\n                            ? '0'\n                            : form.get('attendees')?.value?.length * 3 + 'rem'\n                    \"\n                    class=\"overflow-hidden\"\n                >\n                    <div\n                        class=\"flex items-center h-12 pl-12 space-x-2\"\n                        *ngFor=\"let user of form.get('attendees')?.value\"\n                    >\n                        <a-user-avatar\n                            class=\"text-sm\"\n                            [user]=\"user\"\n                        ></a-user-avatar>\n                        <span>{{ user.name || user.email }}</span>\n                    </div>\n                </div>\n            </div>\n            <div\n                class=\"border-b border-gray-200 w-full\"\n                *ngIf=\"form.value.catering?.length\"\n            >\n                <div class=\"flex items-center py-2 space-x-2 \">\n                    <div\n                        class=\"p-2 rounded-full bg-gray-300 dark:bg-neutral-600 mr-2\"\n                    >\n                        <app-icon>group</app-icon>\n                    </div>\n                    <div class=\"flex-1 truncate\">\n                        {{ form.value.catering[0]?.item_count || 0 }}\n                        Catering Item(s)\n                    </div>\n                    <button\n                        matRipple\n                        class=\"clear bg-transparent border-none underline\"\n                        (click)=\"show_catering = !show_catering\"\n                    >\n                        {{ show_people ? 'Hide' : 'Show' }}\n                    </button>\n                    <a\n                        btn\n                        matRipple\n                        class=\"clear underline\"\n                        [routerLink]=\"['/book', 'spaces', 'form']\"\n                        >Edit</a\n                    >\n                </div>\n                <div\n                    list\n                    [style.height]=\"\n                        !show_catering\n                            ? '0'\n                            : form.value.catering[0]?.items.length * 3 + 'rem'\n                    \"\n                    class=\"overflow-hidden\"\n                >\n                    <div\n                        class=\"flex items-center h-12 pl-12 space-x-2\"\n                        *ngFor=\"let item of form.value.catering[0]?.items\"\n                    >\n                        <div class=\"flex-1 w-1/2\">\n                            <div class=\"flex-1 w-1/2\">{{ item.name }}</div>\n                            <div\n                                class=\"text-xs underline\"\n                                *ngIf=\"item.options.length\"\n                                [matTooltip]=\"optionsFor(item)\"\n                            >\n                                {{ item.options.length }} option{{\n                                    item.options.length === 1 ? '' : 's'\n                                }}\n                                selected\n                            </div>\n                        </div>\n                        <div\n                            class=\"bg-primary text-xs rounded px-4 py-2 mx-2 text-white font-medium\"\n                        >\n                            {{ item.total_cost / 100 | currency: code }}\n                        </div>\n                        <a-counter [(ngModel)]=\"item.quantity\"></a-counter>\n                    </div>\n                </div>\n            </div>\n            <button\n                matRipple\n                class=\"w-32\"\n                confirm\n                [disabled]=\"loading\"\n                (click)=\"postForm()\"\n            >\n                <span *ngIf=\"!loading\">Confirm</span>\n                <mat-spinner\n                    class=\"mx-auto\"\n                    [diameter]=\"24\"\n                    *ngIf=\"loading\"\n                ></mat-spinner>\n            </button>\n        </div>\n        <\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n                display: flex;\n                flex-direction: column;\n            }\n\n            [topbar] {\n                background-color: #00539f;\n            }\n\n            [list] {\n                transition: height 200ms;\n            }\n        `,\n    ],\n})\nexport class SpaceFlowConfirmComponent {\n    public show_spaces = false;\n    public show_people = false;\n    public show_catering = false;\n    public loading = false;\n\n    public readonly postForm = async () => {\n        this.loading = true;\n        await this._state\n            .postForm()\n            .catch((_) =>\n                notifyError(\n                    _ instanceof Object ? _.message || 'Bad Request' : _\n                )\n            );\n        this.loading = false;\n    };\n\n    public optionsFor(item: CateringItem) {\n        return item.options.map((i) => i.name).join('\\n');\n    }\n\n    public get can_view_location() {\n        return !this._settings.get('app.no_maps');\n    }\n\n    public get form() {\n        return this._state.form;\n    }\n\n    public get code() {\n        return this._org.currency_code;\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _state: EventFormService,\n        private _settings: SettingsService\n    ) {}\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AsyncHandler } from '@placeos/common';\nimport { EventFormService } from '@placeos/events';\n\n@Component({\n    selector: 'placeos-book-space-flow',\n    template: `\n        <div class=\"bg-white dark:bg-neutral-700 h-full w-full\">\n            <ng-container [ngSwitch]=\"view\">\n                <ng-container *ngSwitchCase=\"'find'\">\n                    <space-flow-find></space-flow-find>\n                </ng-container>\n                <ng-container *ngSwitchCase=\"'confirm'\">\n                    <space-flow-confirm></space-flow-confirm>\n                </ng-container>\n                <ng-container *ngSwitchCase=\"'success'\">\n                    <flow-success\n                        [calendar]=\"last_success?.host\"\n                    ></flow-success>\n                </ng-container>\n                <ng-container *ngSwitchDefault>\n                    <space-flow-form></space-flow-form>\n                </ng-container>\n            </ng-container>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class BookSpaceFlowComponent extends AsyncHandler implements OnInit {\n    public get view() {\n        return this._state.view;\n    }\n    public get last_success() {\n        return this._state.last_success;\n    }\n\n    constructor(\n        private _state: EventFormService,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.loadForm();\n        if (!this._state.form) this._state.newForm();\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((param) => {\n                if (param.has('step'))\n                    this._state.setView(param.get('step') as any);\n            })\n        );\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((param) => {\n                if (param.has('success'))\n                    this._state.setView(param.get('success') as any);\n            })\n        );\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BookingFormService } from '@placeos/bookings';\nimport { AsyncHandler } from '@placeos/common';\nimport { MAP_FEATURE_DATA } from '@placeos/components';\nimport { ExploreParkingService, ExploreStateService } from '@placeos/explore';\nimport { OrganisationService } from '@placeos/organisation';\nimport { addDays, format, startOfDay } from 'date-fns';\nimport { BehaviorSubject } from 'rxjs';\nimport { first, take } from 'rxjs/operators';\n\n@Component({\n    selector: 'space-ping',\n    template: `\n        <div\n            class=\"absolute inset-0 pointer-events-auto\"\n            [style.transform]=\"'scale(' + zoom * ratio + ')'\"\n        >\n            <div\n                class=\"absolute inset-0 animate-ping border-4 border-green-600\"\n            ></div>\n        </div>\n    `,\n})\nclass SpacePingComponent extends AsyncHandler {\n    public zoom = 1;\n    public ratio = 1;\n    constructor(@Inject(MAP_FEATURE_DATA) private _details: any) {\n        super();\n        this.subscription(\n            'zoom',\n            this._details.zoom$?.subscribe((_) => (this.zoom = _))\n        );\n        this.subscription(\n            'ratio',\n            this._details.ratio$?.subscribe((_) => (this.ratio = _))\n        );\n    }\n}\n\n@Component({\n    selector: 'parking-flow-map',\n    template: `\n        <div\n            class=\"w-full h-full flex flex-col items-center relative\"\n            *ngIf=\"!(loading | async); else load_state\"\n        >\n            <div\n                class=\"p-4 flex items-center justify-center bg-secondary w-full shadow z-10 text-white space-x-2\"\n            >\n                <button\n                    matRipple\n                    *ngFor=\"let date of dates\"\n                    [class.selected]=\"date.id === (options | async)?.date\"\n                    class=\"border border-white flex flex-col items-center justify-center h-24 w-28 rounded\"\n                    (click)=\"setDate(date.id)\"\n                >\n                    <p class=\"mb-2 font-medium\">{{ date.name }}</p>\n                    <p class=\"text-2xl\">\n                        {{ ((counts | async) || {})[date.id] || '0' }}\n                    </p>\n                    <p class=\"text-sm\">Available</p>\n                </button>\n            </div>\n            <div class=\"flex w-full h-1/2 flex-1 z-0\">\n                <div\n                    class=\"p-2 sm:w-[18rem] w-full h-full bg-gray-50 dark:bg-neutral-600 shadow border-r border-gray-200 dark:border-neutral-500 z-10 overflow-auto space-y-2\"\n                >\n                    <div\n                        class=\"bg-white dark:bg-neutral-700 sticky top-0 w-full z-10\"\n                        *ngIf=\"(levels | async)?.length > 1\"\n                    >\n                        <mat-form-field\n                            appearance=\"outline\"\n                            class=\"w-full h-[3.25rem]\"\n                        >\n                            <mat-select\n                                [ngModel]=\"level | async\"\n                                (ngModelChange)=\"setLevel($event?.id)\"\n                            >\n                                <mat-option\n                                    *ngFor=\"let lvl of levels | async\"\n                                    [value]=\"lvl\"\n                                >\n                                    {{ lvl.display_name || lvl.name }}\n                                </mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <p>{{ (available | async)?.length }} space(s) available</p>\n                    <button\n                        matRipple\n                        class=\"flex items-center justify-between bg-white dark:bg-neutral-700 rounded-lg border border-gray-200 p-2 w-full\"\n                        [class.active]=\"(active_space | async)?.id === space.id\"\n                        (click)=\"setActive(space)\"\n                        *ngFor=\"let space of available | async\"\n                    >\n                        <div class=\"text-lg\">Bay No. {{ space.name }}</div>\n                        <div class=\"opacity-60\">\n                            {{ levelName(space.zone_id) }}\n                        </div>\n                    </button>\n                </div>\n                <div\n                    class=\"bg-gray-200 dark:bg-neutral-600 flex-1 w-1/2 h-full z-0 relative hidden sm:block\"\n                >\n                    <i-map\n                        [src]=\"url | async\"\n                        [zoom]=\"(positions | async)?.zoom\"\n                        [center]=\"(positions | async)?.center\"\n                        [styles]=\"styles | async\"\n                        [features]=\"features | async\"\n                        [actions]=\"actions | async\"\n                        [labels]=\"labels | async\"\n                    ></i-map>\n                    <explore-zoom-controls\n                        class=\"absolute bottom-0 right-0\"\n                    ></explore-zoom-controls>\n                </div>\n                <div\n                    *ngIf=\"active_space | async\"\n                    class=\"absolute left-1/2 bottom-2 -translate-x-1/2 bg-white dark:bg-neutral-800 shadow rounded p-4 flex flex-col space-y-2\"\n                >\n                    <p>\n                        Parking Bay No.\n                        {{ (active_space | async).name }} selected.\n                    </p>\n                    <p\n                        class=\"p-2 rounded text-sm max-w-[20rem] text-center text-pending leading-tight\"\n                        *ngIf=\"(existing | async)?.length\"\n                    >\n                        Note that your existing parking space reservation will\n                        be replaced\n                    </p>\n                    <button btn matRipple (click)=\"reserveSpace()\">\n                        Reserve Space\n                    </button>\n                </div>\n                <div\n                    class=\"absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-50\"\n                    *ngIf=\"!(levels | async)?.length\"\n                >\n                    <p>\n                        Parking is not available for\n                        {{\n                            (building | async)?.display_name ||\n                                (building | async)?.name\n                        }}\n                    </p>\n                </div>\n            </div>\n        </div>\n        <ng-template #load_state>\n            <div\n                class=\"absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-50 space-y-2\"\n                *ngIf=\"!(levels | async)?.length\"\n            >\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>Reserving parking space...</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            .active {\n                background-color: var(--primary) !important;\n                color: #fff;\n            }\n\n            .selected {\n                background-color: #fff !important;\n                color: #000d;\n            }\n        `,\n    ],\n    providers: [ExploreParkingService],\n})\nexport class ParkingFlowMapComponent extends AsyncHandler {\n    /** Observable for the active map */\n    public readonly url = this._state.map_url;\n    /** Observable for the active map */\n    public readonly styles = this._state.map_styles;\n    /** Observable for the active map */\n    public readonly positions = this._state.map_positions;\n    /** Observable for the active map */\n    public readonly features = this._state.map_features;\n    /** Observable for the active map */\n    public readonly actions = this._state.map_actions;\n    /** Observable for the labels map */\n    public readonly labels = this._state.map_labels;\n\n    public readonly building = this._org.active_building;\n\n    public readonly level = this._state.level;\n\n    public readonly levels = this._parking.levels;\n\n    public readonly available = this._parking.available_spaces;\n\n    public readonly counts = this._parking.week_availablility;\n\n    public readonly options = this._parking.options;\n\n    public readonly existing = this._parking.existing_event;\n\n    public readonly loading = this._booking.loading;\n\n    public readonly active_space = new BehaviorSubject(null);\n\n    public readonly dates = new Array(7).fill(0).map((_, idx) => ({\n        id: startOfDay(addDays(Date.now(), idx)).valueOf(),\n        name: format(addDays(Date.now(), idx), 'EEE, dd MMM'),\n        available: 0,\n    }));\n\n    public readonly setDate = (d) => this._parking.setOptions({ date: d });\n\n    public levelName(zone_id) {\n        const lvl = this._org.levelWithID([zone_id]);\n        return lvl?.display_name || lvl?.name || '';\n    }\n\n    public setActive(space) {\n        if (space === this.active_space.getValue())\n            this.active_space.next(null);\n        else {\n            this._booking.form.patchValue({\n                asset_id: space.id,\n                asset_name: space.name,\n            });\n            this.active_space.next(space);\n        }\n    }\n\n    public readonly setLevel = (l) => this._state.setLevel(l);\n    public readonly reserveSpace = async () => {\n        const events = await this._parking.existing_event\n            .pipe(take(1))\n            .toPromise();\n        if (events.length) this._booking.form.patchValue({ id: events[0].id }); // Prevent booking duplicate parking spaces\n        await this._booking.postForm();\n        this._router.navigate(['book', 'parking', 'success']);\n    };\n\n    constructor(\n        private _state: ExploreStateService,\n        private _parking: ExploreParkingService,\n        private _org: OrganisationService,\n        private _booking: BookingFormService,\n        private _router: Router\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this._state.reset();\n        this.subscription(\n            'levels',\n            this._parking.levels.subscribe((levels) => {\n                this._state.setLevel(levels[0]?.id);\n            })\n        );\n        this.subscription(\n            'spaces',\n            this._parking.available_spaces.subscribe((spaces) => {\n                this._state.setActions(\n                    'parking_spaces',\n                    (spaces || []).map((_) => ({\n                        id: _.map_id,\n                        action: 'click',\n                        callback: () => this.setActive(_),\n                    }))\n                );\n            })\n        );\n        this.subscription(\n            'active_space',\n            this.active_space.subscribe((space) => {\n                if (!space) return this._state.setFeatures('parking_space', []);\n                this._state.setFeatures('parking_space', [\n                    {\n                        location: space.map_id,\n                        content: SpacePingComponent,\n                        full_size: true,\n                        z_index: 0,\n                    },\n                ]);\n            })\n        );\n    }\n}\n","import { Component } from \"@angular/core\";\n\n@Component({\n    selector: 'parking-flow-confirm',\n    template: ``,\n    styles: [``]\n})\nexport class ParkingFlowConfirmComponent {\n    \n}","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { BookingFormService } from '@placeos/bookings';\nimport { AsyncHandler } from '@placeos/common';\n\n@Component({\n    selector: 'placeos-book-parking-flow',\n    template: `\n        <div class=\"bg-white dark:bg-neutral-700 h-full w-full\">\n            <ng-container [ngSwitch]=\"view\">\n                <ng-container *ngSwitchCase=\"'confirm'\">\n                    <parking-flow-confirm></parking-flow-confirm>\n                </ng-container>\n                <ng-container *ngSwitchCase=\"'success'\">\n                    <flow-success\n                        [calendar]=\"last_success?.host\"\n                        route=\"parking\"\n                        type=\"parking\"\n                    ></flow-success>\n                </ng-container>\n                <ng-container *ngSwitchDefault>\n                    <parking-flow-map></parking-flow-map>\n                </ng-container>\n            </ng-container>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class BookParkingFlowComponent extends AsyncHandler implements OnInit {\n    public get view() {\n        return this._state.view;\n    }\n    public get last_success() {\n        return this._state.last_success;\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.setOptions({ type: 'parking' });\n        this._state.loadForm();\n        if (!this._state.form) this._state.newForm();\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((param) => {\n                if (param.has('step'))\n                    this._state.setView(param.get('step') as any);\n            })\n        );\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((param) => {\n                if (param.has('success'))\n                    this._state.setView(param.get('success') as any);\n            })\n        );\n    }\n}\n","import { Component, Input, Optional } from '@angular/core';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { CateringOrder } from '@placeos/catering';\nimport { AsyncHandler, notifyError, openConfirmModal } from '@placeos/common';\nimport { CalendarEvent, EventFormService } from '@placeos/events';\nimport { OrganisationService } from '@placeos/organisation';\nimport { Space } from '@placeos/spaces';\nimport { SpacePipe } from 'libs/spaces/src/lib/space.pipe';\n\n@Component({\n    selector: 'meeting-flow-confirm-modal',\n    template: `\n        <div\n            header\n            class=\"p-4 flex items-center justify-center border-b border-grey-200 relative\"\n        >\n            <button\n                icon\n                name=\"close-meeting-confirm\"\n                matRipple\n                mat-dialog-close\n                *ngIf=\"show_close\"\n                class=\"absolute left-2 top-1/2 -translate-y-1/2\"\n            >\n                <app-icon>close</app-icon>\n            </button>\n            <h2 class=\"text-xl font-medium\" i18n>Confirm Meeting booking</h2>\n            <mat-spinner\n                diameter=\"32\"\n                class=\"absolute right-2 top-1/2 -translate-y-1/2\"\n                [class.opacity-0]=\"!(loading | async)\"\n            ></mat-spinner>\n        </div>\n        <main class=\"min-w-[48rem] divide-y divide-gray-300 p-4 space-y-4\">\n            <div class=\"flex divide-x divide-gray-300\">\n                <div class=\"pr-4 py-4 pl-16 relative space-y-2 flex-1\">\n                    <div\n                        class=\"absolute top-4 left-4 flex items-center justify-center rounded-full border border-success text-success text-2xl\"\n                    >\n                        <app-icon>done</app-icon>\n                    </div>\n                    <h3 class=\"text-xl !mt-0\">\n                        {{ event.title || 'Meeting Details' }}\n                    </h3>\n                    <div class=\"flex items-center space-x-2\">\n                        <app-icon>today</app-icon>\n                        <div date>{{ event.date | date: 'fullDate' }}</div>\n                    </div>\n                    <div class=\"flex items-center space-x-2\">\n                        <app-icon>schedule</app-icon>\n                        <div time>\n                            {{\n                                event.all_day\n                                    ? 'All Day'\n                                    : (event.date | date: 'shortTime') +\n                                      ' - ' +\n                                      (event.date + event.duration * 60 * 1000\n                                          | date: 'h:mm a (z)')\n                            }}\n                        </div>\n                    </div>\n                </div>\n                <div\n                    class=\"pr-4 py-4 pl-16 relative space-y-2 flex-1\"\n                    *ngIf=\"event.resources.length\"\n                >\n                    <div\n                        class=\"absolute top-4 left-4 flex items-center justify-center rounded-full border border-success text-success text-2xl\"\n                    >\n                        <app-icon>done</app-icon>\n                    </div>\n                    <h3 class=\"text-xl !mt-0\" i18n>Booked Room</h3>\n                    <ng-container *ngFor=\"let s of event.resources\">\n                        <div class=\"flex items-center space-x-2\">\n                            <app-icon>layers</app-icon>\n                            <div>\n                                {{ level?.display_name || level?.name }},\n                                {{ s.display_name || s.name }}\n                            </div>\n                        </div>\n                    </ng-container>\n                    <div class=\"flex items-center space-x-2\">\n                        <app-icon>place</app-icon>\n                        <div>{{ location }}</div>\n                    </div>\n                </div>\n            </div>\n            <div\n                class=\"pr-4 py-4 pl-16 relative space-y-2\"\n                *ngIf=\"event.attendees.length\"\n            >\n                <div\n                    class=\"absolute top-4 left-4 flex items-center justify-center rounded-full border border-success text-success text-2xl\"\n                >\n                    <app-icon>done</app-icon>\n                </div>\n                <h3 class=\"text-xl !mt-0\" i18n>\n                    {{ event.attendees.length }} { event.attendees.length,\n                    plural, =1 { Attendee } other { Attendees } }\n                </h3>\n                <div attendee-list>\n                    <mat-chip-list #chipList aria-label=\"User selection\">\n                        <mat-chip *ngFor=\"let user of event.attendees\">\n                            <div class=\"flex items-center\">\n                                <app-icon class=\"mr-2\">business</app-icon>\n                                {{ user.name || user.email }}\n                            </div>\n                        </mat-chip>\n                    </mat-chip-list>\n                </div>\n            </div>\n            <div\n                class=\"flex divide-x divide-gray-300\"\n                *ngIf=\"event.catering?.length || event.assets?.length\"\n            >\n                <div\n                    class=\"pr-4 py-4 pl-16 relative space-y-2 flex-1\"\n                    *ngIf=\"event.catering?.length\"\n                >\n                    <div\n                        class=\"absolute top-4 left-4 flex items-center justify-center rounded-full border border-success text-success text-2xl\"\n                    >\n                        <app-icon>done</app-icon>\n                    </div>\n                    <h3 class=\"text-xl !mt-0\" i18n>Catering</h3>\n                    <div class=\"space-y-2\">\n                        <div\n                            class=\"flex items-center space-x-2\"\n                            *ngFor=\"let item of catering_order\"\n                        >\n                            <div\n                                count\n                                class=\"flex items-center justify-center min-w-[2rem] h-8 rounded-full bg-gray-200\"\n                            >\n                                ×{{ item.quantity }}\n                            </div>\n                            <div name class=\"flex-1\">{{ item.name }}</div>\n                            <div class=\"flex items-center space-x-2\">\n                                <div\n                                    class=\"flex items-center text-xs px-2 py-1 rounded-2xl bg-gray-100\"\n                                    [matTooltip]=\"opt.name\"\n                                    *ngFor=\"let opt of item.option_list\"\n                                >\n                                    <div class=\"font-medium\">\n                                        {{ opt.name }}\n                                    </div>\n                                    <!-- <div\n                                        class=\"font-mono ml-2\"\n                                        *ngIf=\"opt.unit_price\"\n                                    >\n                                        +{{\n                                            opt.unit_price / 100\n                                                | currency: code\n                                        }}\n                                    </div> -->\n                                </div>\n                            </div>\n                            <div\n                                price\n                                class=\"font-mono text-right p-2 text-sm\"\n                                *ngIf=\"item.quantity > 1\"\n                            >\n                                {{\n                                    item.unit_price_with_options / 100\n                                        | currency: code\n                                }}\n                                ea\n                            </div>\n                            <div\n                                total-price\n                                class=\"font-mono min-w-[6rem] text-right p-2\"\n                            >\n                                {{ item.total_cost / 100 | currency: code }}\n                            </div>\n                        </div>\n                        <div class=\"w-full bg-gray-200 flex justify-end p-2\">\n                            <div class=\"font-medium\">Total:</div>\n                            <div class=\"font-mono text-right min-w-[6rem]\">\n                                {{\n                                    catering_order.total_cost / 100\n                                        | currency: code\n                                }}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div\n                    class=\"pr-4 py-4 pl-16 relative space-y-2 flex-1\"\n                    *ngIf=\"event.assets?.length\"\n                >\n                    <div\n                        class=\"absolute top-4 left-4 flex items-center justify-center rounded-full border border-success text-success text-2xl\"\n                    >\n                        <app-icon>done</app-icon>\n                    </div>\n                    <h3 class=\"text-xl !mt-0\" i18n>Assets</h3>\n                    <div\n                        class=\"flex items-center\"\n                        *ngFor=\"let item of event.assets\"\n                    >\n                        <div\n                            count\n                            class=\"flex items-center justify-center w-12 h-12 rounded-full\"\n                        >\n                            {{ item.amount }}\n                        </div>\n                        <div name class=\"flex-1\">{{ item.name }}</div>\n                    </div>\n                </div>\n            </div>\n            <div class=\"pr-4 py-4 pl-16 relative space-y-2\" *ngIf=\"event.body\">\n                <div\n                    class=\"absolute top-4 left-4 flex items-center justify-center rounded-full border border-success text-success text-2xl\"\n                >\n                    <app-icon>done</app-icon>\n                </div>\n                <h3 class=\"text-xl !mt-0\" i18n>Notes</h3>\n                <div [innerHTML]=\"event.body | sanitize\"></div>\n            </div>\n        </main>\n        <footer\n            class=\"p-2 border-t border-gray-200 flex items-center justify-end\"\n        >\n            <button\n                btn\n                name=\"confirm-meeting\"\n                matRipple\n                class=\"w-32\"\n                *ngIf=\"!(loading | async)\"\n                (click)=\"postForm()\"\n                i18n\n            >\n                Confirm\n            </button>\n            <!-- <button\n                btn\n                matRipple\n                class=\"inverse w-32\"\n                *ngIf=\"loading | async\"\n                (click)=\"cancelPost()\"\n                i18n\n            >\n                Undo\n            </button> -->\n        </footer>\n    `,\n    styles: [``],\n    providers: [SpacePipe],\n})\nexport class MeetingFlowConfirmModalComponent extends AsyncHandler {\n    @Input() public show_close: boolean = false;\n\n    public readonly loading = this._event_form.loading;\n    public readonly catering_order =\n        this.event.catering[0]?.items || this.event.catering || [];\n\n    public readonly postForm = async () => {\n        if (!this.space) {\n            const result = await openConfirmModal(\n                {\n                    title: 'Make Booking without a Room',\n                    content:\n                        'You are creating a booking without a room, are you sure?',\n                    icon: { content: 'event_available' },\n                },\n                this._dialog\n            );\n            if (result.reason !== 'done') return;\n            result.close();\n        }\n        const resp = await this._event_form.postForm().catch((_) => {\n            notifyError(_);\n            return false;\n        });\n        if (resp) this.dismiss(true);\n    };\n    public readonly cancelPost = () => this._event_form.cancelPostForm();\n    public readonly dismiss = (e?) => this._dialog_ref?.close(e);\n\n    private _space = this.event.resources[0];\n\n    public async ngOnInit() {\n        this._space =\n            (await this._space_pipe.transform(\n                this.event.resources[0]?.email\n            )) || this._space;\n    }\n\n    public get event() {\n        return this._event_form.form.getRawValue() as any;\n    }\n\n    public get space(): Space {\n        return this.event.resources[0];\n    }\n\n    public get level() {\n        return this._org.levelWithID(this.space.zones);\n    }\n\n    public get location() {\n        const building = this._org.buildings.find((_) =>\n            this.space.zones.includes(_.id)\n        );\n        return building?.address || building?.display_name || building?.name;\n    }\n\n    public get code() {\n        return this._org.currency_code;\n    }\n\n    constructor(\n        private _event_form: EventFormService,\n        private _org: OrganisationService,\n        private _space_pipe: SpacePipe,\n        @Optional()\n        private _dialog_ref: MatDialogRef<MeetingFlowConfirmModalComponent>,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n}\n","import { Component, Input, Optional } from '@angular/core';\nimport { MatBottomSheetRef } from '@angular/material/bottom-sheet';\nimport { MatDialog } from '@angular/material/dialog';\nimport { AsyncHandler, notifyError, openConfirmModal } from '@placeos/common';\nimport { CalendarEvent, EventFormService } from '@placeos/events';\nimport { OrganisationService } from '@placeos/organisation';\nimport { SpacePipe } from 'libs/spaces/src/lib/space.pipe';\n\n@Component({\n    selector: 'meeting-flow-confirm',\n    template: `\n        <button\n            icon\n            matRipple\n            name=\"close-meeting-confirm\"\n            *ngIf=\"show_close\"\n            (click)=\"dismiss()\"\n        >\n            <app-icon>close</app-icon>\n        </button>\n        <header class=\"flex items-center justify-between px-2\">\n            <h2 i18n>Confirm Meeting booking</h2>\n            <mat-spinner diameter=\"32\" *ngIf=\"loading | async\"></mat-spinner>\n        </header>\n        <section period class=\"flex space-x-1 px-2\">\n            <app-icon class=\"text-success mt-1\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3>{{ event.title || 'Meeting Details' }}</h3>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>today</app-icon>\n                    <div date>{{ event.date | date: 'fullDate' }}</div>\n                </div>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>schedule</app-icon>\n                    <div time>\n                        {{\n                            event.all_day\n                                ? 'All Day'\n                                : (event.date | date: 'shortTime') +\n                                  ' - ' +\n                                  (event.date + event.duration * 60 * 1000\n                                      | date: 'h:mm a (z)')\n                        }}\n                    </div>\n                </div>\n            </div>\n        </section>\n        <section\n            attendees\n            class=\"flex space-x-1 px-2\"\n            *ngIf=\"event.attendees.length\"\n        >\n            <app-icon class=\"text-success mt-1\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3 i18n>\n                    {{ event.attendees.length }} { event.attendees.length,\n                    plural, =1 { attendee } other { attendees } }\n                </h3>\n                <div attendee-list>\n                    <mat-chip-list #chipList aria-label=\"User selection\">\n                        <mat-chip *ngFor=\"let user of event.attendees\">\n                            <div class=\"flex items-center\">\n                                <app-icon class=\"mr-2\">business</app-icon>\n                                {{ user.name || user.email }}\n                            </div>\n                        </mat-chip>\n                    </mat-chip-list>\n                </div>\n            </div>\n        </section>\n        <section spaces class=\"flex space-x-1 px-2\" *ngIf=\"space?.id\">\n            <app-icon class=\"text-success mt-1\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3 i18n>Booked Room</h3>\n                <ng-container *ngFor=\"let s of event.resources\">\n                    <div class=\"flex items-center space-x-2\">\n                        <app-icon>meeting_room</app-icon>\n                        <div>\n                            {{ level?.display_name || level?.name }},\n                            {{ s.display_name || s.name }}\n                        </div>\n                    </div>\n                </ng-container>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>place</app-icon>\n                    <div>{{ location }}</div>\n                </div>\n            </div>\n        </section>\n        <footer class=\"p-2 w-full border-t border-gray-200 mt-4\">\n            <button\n                btn\n                name=\"confirm-meeting\"\n                matRipple\n                class=\"w-full\"\n                *ngIf=\"!(loading | async)\"\n                (click)=\"postForm()\"\n                i18n\n            >\n                Confirm\n            </button>\n            <!-- <button\n                btn\n                matRipple\n                class=\"inverse w-full\"\n                *ngIf=\"loading | async\"\n                (click)=\"cancelPost()\"\n                i18n\n            >\n                Undo\n            </button> -->\n        </footer>\n    `,\n    styles: [\n        `\n            section > app-icon {\n                font-size: 1.5rem;\n            }\n\n            h2 {\n                font-size: 1.5rem;\n                font-weight: medium;\n                margin-bottom: 0.5rem;\n            }\n\n            h3 {\n                font-size: 1.25rem;\n                font-weight: medium;\n                margin: 0.5rem 0;\n            }\n        `,\n    ],\n    providers: [SpacePipe],\n})\nexport class MeetingFlowConfirmComponent extends AsyncHandler {\n    @Input() public show_close: boolean = false;\n\n    public readonly loading = this._event_form.loading;\n\n    public readonly postForm = async () => {\n        if (!this.space) {\n            const result = await openConfirmModal(\n                {\n                    title: 'Make Booking without a Room',\n                    content:\n                        'You are creating a booking without a room, are you sure?',\n                    icon: { content: 'event_available' },\n                },\n                this._dialog\n            );\n            if (result.reason !== 'done') return;\n        }\n        await this._event_form.postForm().catch((_) => {\n            notifyError(_);\n            throw _;\n        });\n        this.dismiss(true);\n    };\n    public readonly cancelPost = () => this._event_form.cancelPostForm();\n    public readonly dismiss = (e?) => this._sheet_ref?.dismiss(e);\n\n    private _space = this.event.resources[0];\n\n    public async ngOnInit() {\n        this._space =\n            (await this._space_pipe.transform(this.event.resources[0].email)) ||\n            this._space;\n    }\n\n    public get event(): CalendarEvent {\n        return this._event_form.form.value as any;\n    }\n\n    public get space() {\n        return this._space;\n    }\n\n    public get level() {\n        return this._org.levelWithID(this.space.zones);\n    }\n\n    public get location() {\n        const building = this._org.buildings.find((_) =>\n            this.space.zones.includes(_.id)\n        );\n        return building?.address || building?.display_name || building?.name;\n    }\n\n    constructor(\n        private _event_form: EventFormService,\n        private _org: OrganisationService,\n        private _space_pipe: SpacePipe,\n        @Optional() private _sheet_ref: MatBottomSheetRef,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { SettingsService } from '@placeos/common';\nimport { addDays, endOfDay } from 'date-fns';\n\n@Component({\n    selector: 'meeting-form-details',\n    template: `\n        <div *ngIf=\"form\" [formGroup]=\"form\">\n            <div class=\"flex items-center flex-wrap sm:space-x-2\">\n                <div class=\"flex-1 min-w-[256px]\">\n                    <label for=\"title\"\n                        >{{ 'FORM.TITLE' | translate }}<span>*</span></label\n                    >\n                    <mat-form-field appearance=\"outline\" class=\"w-full\">\n                        <input\n                            matInput\n                            name=\"title\"\n                            formControlName=\"title\"\n                            placeholder=\"e.g. Team Meeting\"\n                        />\n                        <mat-error>{{\n                            'FORM.TITLE_ERROR' | translate\n                        }}</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex-1 min-w-[256px]\">\n                    <label for=\"date\"\n                        >{{ 'FORM.DATE' | translate }}<span>*</span></label\n                    >\n                    <a-date-field\n                        name=\"date\"\n                        [ngModel]=\"form.value.date\"\n                        (ngModelChange)=\"form.patchValue({ date: $event })\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                        [to]=\"end_date\"\n                    >\n                        {{ 'FORM.DATE_ERROR' | translate }}\n                    </a-date-field>\n                </div>\n            </div>\n            <div class=\"flex items-center space-x-2\">\n                <div class=\"flex-1 w-1/3\">\n                    <label for=\"start-time\">\n                        {{ 'FORM.START_TIME' | translate }}\n                        <span>*</span>\n                    </label>\n                    <a-time-field\n                        name=\"start-time\"\n                        [ngModel]=\"form.value.date\"\n                        (ngModelChange)=\"form.patchValue({ date: $event })\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                    ></a-time-field>\n                </div>\n                <div class=\"flex-1 w-1/3 relative\">\n                    <label for=\"end-time\"\n                        >{{ 'FORM.END_TIME' | translate }}<span>*</span></label\n                    >\n                    <a-duration-field\n                        name=\"end-time\"\n                        [ngModel]=\"form.value.duration\"\n                        (ngModelChange)=\"form.patchValue({ duration: $event })\"\n                        [time]=\"form?.value?.date\"\n                        [max]=\"max_duration\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                    >\n                        Meeting must end at a future time.\n                    </a-duration-field>\n                    <mat-checkbox\n                        formControlName=\"all_day\"\n                        *ngIf=\"allow_all_day\"\n                        class=\"absolute -top-2 right-0\"\n                    >\n                        {{ 'FORM.ALL_DAY' | translate }}\n                    </mat-checkbox>\n                </div>\n            </div>\n            <div *ngIf=\"can_book_for_others\" class=\"w-full\">\n                <label for=\"host\"\n                    >{{ 'FORM.HOST' | translate }}<span>*</span></label\n                >\n                <host-select-field\n                    name=\"host\"\n                    formControlName=\"organiser\"\n                ></host-select-field>\n            </div>\n        </div>\n    `,\n    styles: [],\n})\nexport class MeetingFormDetailsComponent {\n    @Input() public form: FormGroup;\n\n    public get max_duration() {\n        return this._settings.get('app.events.max_duration') || 480;\n    }\n\n    public get can_book_for_others() {\n        return this._settings.get('app.events.can_book_for_others');\n    }\n\n    public get allow_all_day() {\n        return this._settings.get('app.events.allow_all_day');\n    }\n\n    public get end_date() {\n        return endOfDay(\n            addDays(\n                Date.now(),\n                this._settings.get('app.events.allowed_future_days') || 180\n            )\n        );\n    }\n\n    constructor(private _settings: SettingsService) {}\n}\n","import { Component, ElementRef, TemplateRef, ViewChild } from '@angular/core';\nimport {\n    MatBottomSheet,\n    MatBottomSheetRef,\n} from '@angular/material/bottom-sheet';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { Router } from '@angular/router';\nimport {\n    ANIMATION_SHOW_CONTRACT_EXPAND,\n    AsyncHandler,\n    currentUser,\n    getInvalidFields,\n    notifyError,\n    notifyWarn,\n    SettingsService,\n} from '@placeos/common';\nimport { EventFormService } from '@placeos/events';\nimport { OrganisationService } from '@placeos/organisation';\nimport { Space } from '@placeos/spaces';\nimport { FindAvailabilityModalComponent } from '@placeos/users';\nimport { CateringOrderStateService } from 'libs/catering/src/lib/catering-order-modal/catering-order-state.service';\nimport { BehaviorSubject, combineLatest, timer } from 'rxjs';\nimport { first, map, take, tap } from 'rxjs/operators';\nimport { MeetingFlowConfirmModalComponent } from './meeting-flow-confirm-modal.component';\nimport { MeetingFlowConfirmComponent } from './meeting-flow-confirm.component';\n\n@Component({\n    selector: 'meeting-flow-form',\n    template: `\n        <div\n            class=\"h-full w-full bg-gray-100 dark:bg-neutral-900 overflow-auto\"\n        >\n            <div\n                class=\"max-w-full w-[48rem] mx-auto sm:my-4 bg-white dark:bg-[#1F2021] border border-gray-300 dark:border-neutral-700\"\n            >\n                <h2\n                    class=\"w-full p-4 sm:py-4 sm:px-16 text-2xl font-medium border-b border-gray-300 dark:border-neutral-700\"\n                >\n                    {{ !!form.value.id ? 'Edit' : 'Book' }}\n                    {{ 'WPA.BOOK_MEETING_HEADING' | translate }}\n                </h2>\n                <form\n                    class=\"p-0 sm:py-4 sm:px-16 divide-y divide-gray-300 space-y-2\"\n                    [formGroup]=\"form\"\n                >\n                    <section class=\"p-2\">\n                        <h3 class=\"space-x-2 flex items-center\">\n                            <div\n                                class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                            >\n                                1\n                            </div>\n                            <div class=\"text-xl\">\n                                {{ 'WPA.DETAILS' | translate }}\n                            </div>\n                            <div class=\"flex-1 w-px\"></div>\n                            <button\n                                icon\n                                name=\"toggle-details-meeting\"\n                                matRipple\n                                (click)=\"\n                                    hide_block.details = !hide_block.details\n                                \"\n                            >\n                                <app-icon>{{\n                                    hide_block.details\n                                        ? 'expand_more'\n                                        : 'expand_less'\n                                }}</app-icon>\n                            </button>\n                        </h3>\n                        <div\n                            class=\"overflow-hidden\"\n                            [@show]=\"hide_block.details ? 'hide' : 'show'\"\n                        >\n                            <meeting-form-details\n                                class=\"mt-4\"\n                                [form]=\"form\"\n                            ></meeting-form-details>\n                        </div>\n                    </section>\n                    <section class=\"p-2\" *ngIf=\"!hide_attendees\">\n                        <h3 class=\"space-x-2 flex items-center\">\n                            <div\n                                class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                            >\n                                2\n                            </div>\n                            <div class=\"text-xl\">\n                                {{ 'FORM.ATTENDEES' | translate }}\n                            </div>\n                            <div class=\"flex-1 w-px\"></div>\n                            <button\n                                matRipple\n                                name=\"find-attendee-availability\"\n                                class=\"bg-none underline text-xs text-blue-500\"\n                                (click)=\"findAvailableTime()\"\n                            >\n                                {{ 'WPA.AVAILABILITY' | translate }}\n                            </button>\n                            <button\n                                icon\n                                name=\"toggle-attendees-meeting\"\n                                matRipple\n                                (click)=\"\n                                    hide_block.attendees = !hide_block.attendees\n                                \"\n                            >\n                                <app-icon>{{\n                                    hide_block.attendees\n                                        ? 'expand_more'\n                                        : 'expand_less'\n                                }}</app-icon>\n                            </button>\n                        </h3>\n                        <div\n                            class=\"overflow-hidden\"\n                            [@show]=\"hide_block.attendees ? 'hide' : 'show'\"\n                        >\n                            <a-user-list-field\n                                class=\"mt-4\"\n                                formControlName=\"attendees\"\n                                [guests]=\"allow_externals\"\n                            ></a-user-list-field>\n                        </div>\n                    </section>\n                    <section class=\"p-2\">\n                        <h3 class=\"space-x-2 flex items-center\">\n                            <div\n                                class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                            >\n                                3\n                            </div>\n                            <div class=\"text-xl\">\n                                {{ 'WPA.ROOM' | translate }}\n                            </div>\n                            <div class=\"flex-1 w-px\"></div>\n                            <button\n                                icon\n                                name=\"toggle-spaces-meeting\"\n                                matRipple\n                                (click)=\"\n                                    hide_block.resources = !hide_block.resources\n                                \"\n                            >\n                                <app-icon>{{\n                                    hide_block.resources\n                                        ? 'expand_more'\n                                        : 'expand_less'\n                                }}</app-icon>\n                            </button>\n                        </h3>\n                        <div\n                            class=\"overflow-hidden flex flex-col items-center\"\n                            [@show]=\"hide_block.resources ? 'hide' : 'show'\"\n                        >\n                            <div\n                                *ngIf=\"\n                                    !strict_capacity_check &&\n                                    total_capacity &&\n                                    total_capacity <=\n                                        form.value.attendees?.length\n                                \"\n                                class=\"bg-yellow-500 rounded shadow p-2 text-xs mx-auto my-2 text-black inline-flex\"\n                            >\n                                The selected room has less capacity than the\n                                number of meeting attendees.\n                            </div>\n                            <space-list-field\n                                class=\"w-full\"\n                                formControlName=\"resources\"\n                            ></space-list-field>\n                        </div>\n                    </section>\n                    <section class=\"p-2\" *ngIf=\"has_catering | async\">\n                        <h3 class=\"space-x-2 flex items-center\">\n                            <div\n                                class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                            >\n                                4\n                            </div>\n                            <div class=\"text-xl\">\n                                {{ 'WPA.CATERING' | translate }}\n                            </div>\n                            <div class=\"flex-1 w-px\"></div>\n                            <button\n                                icon\n                                name=\"toggle-catering-meeting\"\n                                matRipple\n                                (click)=\"\n                                    hide_block.catering = !hide_block.catering\n                                \"\n                            >\n                                <app-icon>{{\n                                    hide_block.catering\n                                        ? 'expand_more'\n                                        : 'expand_less'\n                                }}</app-icon>\n                            </button>\n                        </h3>\n                        <div\n                            class=\"overflow-hidden\"\n                            [@show]=\"hide_block.catering ? 'hide' : 'show'\"\n                        >\n                            <catering-list-field\n                                formControlName=\"catering\"\n                                [options]=\"{\n                                    date: form.value.date,\n                                    duration: form.value.duration,\n                                    zone_id:\n                                        form.value.resources[0]?.level\n                                            ?.parent_id\n                                }\"\n                            ></catering-list-field>\n                            <mat-form-field\n                                appearance=\"outline\"\n                                class=\"w-full mt-2\"\n                                *ngIf=\"\n                                    form.value.catering?.length && has_codes\n                                        | async\n                                \"\n                                (openedChange)=\"focusInput()\"\n                            >\n                                <mat-select\n                                    formControlName=\"catering_charge_code\"\n                                    placeholder=\"Charge Code\"\n                                >\n                                    <input\n                                        #input\n                                        class=\"sticky top-0 bg-white px-4 py-3 text-base border-x-0 border-t-0 border-b focus:border-b border-gray-200 w-full rounded-none z-50\"\n                                        [ngModel]=\"code_filter.getValue()\"\n                                        (ngModelChange)=\"\n                                            code_filter.next($event)\n                                        \"\n                                        [ngModelOptions]=\"{ standalone: true }\"\n                                        placeholder=\"Search charge codes...\"\n                                    />\n                                    <mat-option class=\"hidden\"></mat-option>\n                                    <mat-option\n                                        *ngFor=\"\n                                            let code of filtered_codes | async\n                                        \"\n                                        [value]=\"code\"\n                                    >\n                                        {{ code }}\n                                    </mat-option>\n                                </mat-select>\n                                <mat-error>\n                                    Catering charge code is required\n                                </mat-error>\n                            </mat-form-field>\n                            <mat-form-field\n                                appearance=\"outline\"\n                                class=\"w-full\"\n                                *ngIf=\"form.value.catering?.length\"\n                            >\n                                <textarea\n                                    matInput\n                                    formControlName=\"catering_notes\"\n                                    placeholder=\"Extra catering details...\"\n                                ></textarea>\n                                <mat-error>\n                                    Catering Order notes are required\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </section>\n                    <section class=\"p-2\" *ngIf=\"has_assets\">\n                        <h3 class=\"space-x-2 flex items-center\">\n                            <div\n                                class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                            >\n                                {{ !(has_catering | async) ? '4' : '5' }}\n                            </div>\n                            <div class=\"text-xl\">\n                                {{ 'WPA.ASSETS' | translate }}\n                            </div>\n                            <div class=\"flex-1 w-px\"></div>\n                            <button\n                                icon\n                                name=\"toggle-assets-meeting\"\n                                matRipple\n                                (click)=\"hide_block.assets = !hide_block.assets\"\n                            >\n                                <app-icon>{{\n                                    hide_block.assets\n                                        ? 'expand_more'\n                                        : 'expand_less'\n                                }}</app-icon>\n                            </button>\n                        </h3>\n                        <div\n                            class=\"overflow-hidden\"\n                            [@show]=\"hide_block.assets ? 'hide' : 'show'\"\n                        >\n                            <asset-list-field\n                                formControlName=\"assets\"\n                            ></asset-list-field>\n                        </div>\n                    </section>\n                    <section class=\"p-2\" *ngIf=\"!hide_notes\">\n                        <h3 class=\"space-x-2 flex items-center mb-4\">\n                            <div\n                                class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                            >\n                                {{\n                                    !(has_catering | async) || !has_assets\n                                        ? !(has_catering | async) && !has_assets\n                                            ? '4'\n                                            : '5'\n                                        : '6'\n                                }}\n                            </div>\n                            <div class=\"text-xl\">\n                                {{ 'FORM.NOTES' | translate }}\n                            </div>\n                        </h3>\n                        <div class=\"w-full flex flex-col\">\n                            <label for=\"notes\">\n                                {{ 'WPA.NOTES_INFO' | translate }}\n                            </label>\n                            <rich-text-input\n                                name=\"notes\"\n                                formControlName=\"body\"\n                                placeholder=\"Notes...\"\n                            ></rich-text-input>\n                        </div>\n                    </section>\n                    <section\n                        class=\"flex flex-col sm:flex-row items-center sm:space-x-2 p-2\"\n                    >\n                        <button\n                            btn\n                            name=\"open-meeting-confirm\"\n                            matRipple\n                            confirm\n                            class=\"mb-2 sm:mb-0 w-full sm:w-auto\"\n                            (click)=\"viewConfirm()\"\n                        >\n                            {{ 'WPA.CONFIRM_MEETING' | translate }}\n                        </button>\n                        <button\n                            btn\n                            name=\"clear-form-meeting\"\n                            matRipple\n                            clear-form\n                            class=\"inverse w-full sm:w-auto\"\n                            (click)=\"clearForm()\"\n                        >\n                            { !!form.value.id, select, true { Reset } false {\n                            Clear } } {{ 'WPA.CLEAR_FORM' | translate }}\n                        </button>\n                    </section>\n                </form>\n            </div>\n        </div>\n    `,\n    styles: [],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n})\nexport class MeetingFlowFormComponent extends AsyncHandler {\n    public sheet_ref: MatBottomSheetRef<any>;\n    public dialog_ref: MatDialogRef<any>;\n    public hide_block: Record<string, boolean> = {};\n    public code_filter = new BehaviorSubject('');\n\n    public readonly has_catering = this._catering.available_menu.pipe(\n        map((l) => l.length > 0)\n    );\n\n    public readonly has_codes = this._catering.charge_codes.pipe(\n        map((l) => l.length > 0)\n    );\n\n    public readonly filtered_codes = combineLatest([\n        this.code_filter,\n        this._catering.charge_codes,\n    ]).pipe(\n        map(([s, l]) =>\n            l.filter((_) => _.toLowerCase().includes(s.toLowerCase()))\n        )\n    );\n\n    public get form() {\n        return this._state.form;\n    }\n\n    public get has_assets() {\n        return !!this._settings.get('app.events.has_assets');\n    }\n\n    public get hide_notes() {\n        return !!this._settings.get('app.events.hide_notes');\n    }\n\n    public get hide_attendees() {\n        return !!this._settings.get('app.events.hide_attendees');\n    }\n\n    public get allow_externals() {\n        return this._settings.get('app.events.allow_externals');\n    }\n\n    public get strict_capacity_check() {\n        return this._settings.get('app.events.strict_capacity_check');\n    }\n\n    public get total_capacity() {\n        return (\n            this.form.value.resources?.reduce((c, i) => c + i.capacity, 0) || 0\n        );\n    }\n\n    public get attendee_count() {\n        const user = currentUser();\n        let count = this.form.value.attendees?.length || 0;\n        if (\n            !this.form.value.attendees.find(\n                (_) => _.email.toLowerCase() === user.email.toLowerCase()\n            )\n        ) {\n            count += 1;\n        }\n        return count;\n    }\n\n    public readonly clearForm = () => this._state.resetForm();\n\n    public readonly viewConfirm = () => {\n        if (!this.form.value.host)\n            this.form.patchValue({ host: currentUser()?.email });\n        if (\n            this.strict_capacity_check &&\n            this.attendee_count > this.total_capacity\n        ) {\n            return notifyError(\n                'Attendee count is greater than the capacity of the selected rooms'\n            );\n        }\n        this.form.markAllAsTouched();\n        if (!this.form.valid)\n            return notifyError(\n                `Some fields are invalid. [${getInvalidFields(this.form).join(\n                    ', '\n                )}]`\n            );\n        if (\n            this._settings.get('app.events.no_standalone') &&\n            !this.form.value.resources.length\n        )\n            return notifyError('You need to select a room to make a booking');\n        if (this._settings.get('app.events.booking_unavailable'))\n            return this._state.openEventLinkModal();\n        if (window.innerWidth >= 768) {\n            this.dialog_ref = this._dialog.open(\n                MeetingFlowConfirmModalComponent\n            );\n            this.dialog_ref.componentInstance.show_close = true;\n            this.dialog_ref.afterClosed().subscribe((value) => {\n                if (value) {\n                    this._router.navigate(['/book', 'meeting', 'success']);\n                    this._state.setView('success');\n                }\n            });\n        } else {\n            this.sheet_ref = this._bottom_sheet.open(\n                MeetingFlowConfirmComponent\n            );\n            this.sheet_ref.instance.show_close = true;\n            this.sheet_ref.afterDismissed().subscribe((value) => {\n                if (value) {\n                    this._router.navigate(['/book', 'meeting', 'success']);\n                    this._state.setView('success');\n                }\n            });\n        }\n    };\n\n    @ViewChild('confirm_ref') private _confirm_ref: TemplateRef<any>;\n    @ViewChild('input') private _input_el: ElementRef<HTMLInputElement>;\n\n    constructor(\n        private _state: EventFormService,\n        private _catering: CateringOrderStateService,\n        private _settings: SettingsService,\n        private _router: Router,\n        private _dialog: MatDialog,\n        private _bottom_sheet: MatBottomSheet,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this.subscription(\n            'space_changes',\n            this.form.controls.resources.valueChanges.subscribe((l) =>\n                this._checkCateringEligibility(l)\n            )\n        );\n        this.subscription(\n            'date_changes',\n            this.form.controls.date.valueChanges.subscribe((l) =>\n                this._checkCateringEligibility(this.form.value.resources)\n            )\n        );\n        this.subscription(\n            'duration_changes',\n            this.form.controls.duration.valueChanges.subscribe((l) =>\n                this._checkCateringEligibility(this.form.value.resources)\n            )\n        );\n        this._catering.setOptions({ zone: '' });\n        this._checkCateringEligibility(this.form.value.resources || []);\n    }\n\n    public focusInput() {\n        this.timeout(\n            'input-focus',\n            () => {\n                this._input_el.nativeElement.value = '';\n                this._input_el?.nativeElement?.focus();\n            },\n            300\n        );\n    }\n\n    public findAvailableTime() {\n        const { attendees, organiser, date, duration } = this.form.value;\n        const ref = this._dialog.open(FindAvailabilityModalComponent, {\n            data: {\n                users: attendees,\n                host: organiser || currentUser(),\n                date,\n                duration,\n            },\n        });\n        ref.afterClosed().subscribe((d) => {\n            if (!d) return;\n            this.form.patchValue({\n                date: ref.componentInstance.date,\n                attendees: ref.componentInstance.users.getValue(),\n                duration: ref.componentInstance.duration,\n            });\n        });\n    }\n\n    private async _checkCateringEligibility(list: Space[]) {\n        if (list?.length) {\n            await timer(100).toPromise();\n            const value = this.form.getRawValue();\n            this._catering.setFilters({\n                search: '',\n                date: value.date,\n                duration: value.duration,\n                resources: list,\n                zone_id: this._org.levelWithID(list[0].zones)?.parent_id,\n            });\n            await timer(500).toPromise();\n            const menu = await this._catering.filtered_menu\n                .pipe(take(1))\n                .toPromise();\n            const disabled_rooms = await this._catering.availability\n                .pipe(take(1))\n                .toPromise();\n            const can_cater = list.every(\n                (s) =>\n                    menu.filter(\n                        (_) =>\n                            !_.hide_for_zones.find((z) => s.zones.includes(z))\n                    ).length > 0\n            );\n            if (\n                !can_cater ||\n                disabled_rooms.find((_) => list.find((i) => i.id === _))\n            ) {\n                this.form.patchValue({ catering: [] });\n                this.form.controls.catering.disable();\n                notifyWarn(\n                    `Catering is unavailable for some of the selected spaces.`\n                );\n            } else {\n                this.form.controls.catering.enable();\n            }\n        } else {\n            this.form.controls.catering.disable();\n        }\n    }\n}\n","import { Component } from '@angular/core';\nimport { EventFormService } from '@placeos/events';\n\n@Component({\n    selector: 'meeting-flow-success',\n    template: `\n        <div\n            class=\"absolute inset-0 bg-white dark:bg-neutral-600 flex flex-col z-50\"\n        >\n            <main\n                class=\"flex-1 flex flex-col items-center justify-center space-y-2 p-8\"\n            >\n                <h2 class=\"text-2xl font-medium\">\n                    {{ 'WPA.BOOKING_CONFIRMED' | translate }}\n                </h2>\n                <img src=\"assets/icons/success.svg\" />\n                <p class=\"text-center max-w-[32rem]\" i18n>\n                    Your\n                    <span *ngIf=\"space\">\n                        room booking for\n                        {{ space?.level.display_name || space?.level.name }},\n                        {{ space?.display_name || space?.name }}\n                    </span>\n                    <span *ngIf=\"!space\">meeting</span> has been successfully\n                    booked for the {{ last_event.date | date: 'mediumDate' }} at\n                    {{ last_event.date | date: 'shortTime' }}-{{\n                        last_event.date + last_event.duration * 60 * 1000\n                            | date: 'shortTime'\n                    }}.\n                </p>\n            </main>\n            <footer\n                class=\"p-2 w-full border-t border-gray-200 dark:bg-neutral-500 mt-4 flex items-center justify-center\"\n            >\n                <a\n                    btn\n                    name=\"meeting-created-continue\"\n                    matRipple\n                    class=\"w-full max-w-[32rem]\"\n                    [routerLink]=\"['/']\"\n                >\n                    {{ 'WPA.BOOKING_DONE_CONTINUE' | translate }}\n                </a>\n            </footer>\n        </div>\n    `,\n    styles: [``],\n})\nexport class MeetingFlowSuccessComponent {\n    public get last_event() {\n        return this._event_form.last_success;\n    }\n\n    public get space() {\n        return this.last_event.space;\n    }\n\n    constructor(private _event_form: EventFormService) {}\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AsyncHandler } from '@placeos/common';\nimport { EventFormService } from '@placeos/events';\n\n@Component({\n    selector: 'placeos-book-meeting-flow',\n    template: `\n        <div\n            class=\"bg-white dark:bg-neutral-900 h-full w-full z-50\"\n            [ngSwitch]=\"view\"\n        >\n            <meeting-flow-success *ngSwitchCase=\"'success'\">\n            </meeting-flow-success>\n            <meeting-flow-confirm *ngSwitchCase=\"'confirm'\">\n            </meeting-flow-confirm>\n            <meeting-flow-form *ngSwitchDefault></meeting-flow-form>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class BookMeetingFlowComponent extends AsyncHandler implements OnInit {\n    public get view() {\n        return this._state.view;\n    }\n    public get last_success() {\n        return this._state.last_success;\n    }\n\n    constructor(\n        private _state: EventFormService,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.loadForm();\n        if (!this._state.form) this._state.newForm();\n        this._state.listenForStatusChanges();\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((param) => {\n                if (param.has('step'))\n                    this._state.setView(param.get('step') as any);\n            })\n        );\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((param) => {\n                if (param.has('success')) this._state.setView('success');\n            })\n        );\n    }\n}\n","import { Component, Input, Optional } from '@angular/core';\nimport { MatBottomSheetRef } from '@angular/material/bottom-sheet';\nimport { BookingFormService } from '@placeos/bookings';\nimport { AsyncHandler, notifyError } from '@placeos/common';\nimport { Desk, OrganisationService } from '@placeos/organisation';\nimport { take } from 'rxjs/operators';\n\n@Component({\n    selector: 'new-desk-flow-confirm',\n    styles: [\n        `\n            section > app-icon {\n                font-size: 1.5rem;\n                margin-top: 0.3rem;\n            }\n\n            h3 {\n                font-size: 1.25rem;\n                font-weight: medium;\n                margin: 0.5rem 0;\n            }\n        `,\n    ],\n    template: `\n        <button\n            icon\n            name=\"close-desk-confirm\"\n            matRipple\n            *ngIf=\"show_close\"\n            (click)=\"dismiss()\"\n        >\n            <app-icon>close</app-icon>\n        </button>\n        <header class=\"flex items-center justify-between px-2\">\n            <h2 class=\"text-2xl font-medium mb-2\" i18n>Confirm Desk Booking</h2>\n            <mat-spinner diameter=\"32\" *ngIf=\"loading | async\"></mat-spinner>\n        </header>\n        <section period class=\"flex space-x-1 py-4 px-2\">\n            <app-icon class=\"text-success\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3>{{ booking.title || '~Untitled~' }}</h3>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>calendar_today</app-icon>\n                    <div date>{{ booking.date | date: 'fullDate' }}</div>\n                </div>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>schedule</app-icon>\n                    <div time>\n                        {{\n                            booking.all_day\n                                ? 'All Day'\n                                : (booking.date | date: 'shortTime') +\n                                  ' - ' +\n                                  (booking.date + booking.duration * 60 * 1000\n                                      | date: 'h:mm a (z)')\n                        }}\n                    </div>\n                </div>\n            </div>\n        </section>\n        <section\n            desk\n            class=\"flex space-x-1 py-4 px-2 border-t dark:border-neutral-500\"\n            *ngIf=\"booking_asset?.id\"\n        >\n            <app-icon class=\"text-success\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3 name>\n                    {{ booking_asset?.name || booking_asset?.id || '' }}\n                </h3>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>person</app-icon>\n                    <span i18n>Single desk</span>\n                </div>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>place</app-icon>\n                    <div>{{ location }}</div>\n                </div>\n                <ng-container *ngFor=\"let feat of booking_asset.features\">\n                    <div features class=\"flex items-center space-x-2\">\n                        <app-icon>arrow_upward</app-icon>\n                        <div>{{ feat }}</div>\n                    </div>\n                </ng-container>\n            </div>\n        </section>\n        <section\n            assets\n            class=\"flex space-x-1 py-4 px-2 border-t dark:border-neutral-500\"\n            *ngIf=\"assets?.length\"\n        >\n            <app-icon class=\"text-success\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3 i18n>{{ assets_count }} Asset(s)</h3>\n                <div class=\"flex space-x-2\" *ngFor=\"let asset of assets\">\n                    <div\n                        class=\"h-5 w-5 bg-gray-100 dark:bg-neutral-600 rounded-full\"\n                    >\n                        {{ asset.amount }}\n                    </div>\n                    <span>{{ asset.name }}</span>\n                </div>\n            </div>\n        </section>\n        <section\n            assets\n            class=\"flex space-x-1 py-4 px-2 border-t dark:border-neutral-500\"\n            *ngIf=\"needs_locker\"\n        >\n            <app-icon class=\"text-success\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3 i18n>Requested Locker</h3>\n                <div class=\"flex space-x-2\">\n                    <span>Locker E-043</span>\n                </div>\n            </div>\n        </section>\n        <footer\n            class=\"p-2 w-full border-t border-gray-200 dark:border-neutral-500 mt-4\"\n        >\n            <button\n                name=\"confirm-desk\"\n                btn\n                matRipple\n                class=\"w-full\"\n                *ngIf=\"!(loading | async)\"\n                (click)=\"postForm()\"\n                i18n\n            >\n                Confirm\n            </button>\n        </footer>\n    `,\n})\nexport class NewDeskFlowConfirmComponent extends AsyncHandler {\n    @Input() public show_close: boolean = false;\n\n    public readonly loading = this._state.loading;\n\n    public readonly postForm = async () => {\n        try {\n            if ((await this._state.options.pipe(take(1)).toPromise())?.group) {\n                await this._state.postFormForGroup();\n            } else {\n                await this._state.postForm();\n            }\n            this.dismiss(true);\n        } catch (e) {\n            notifyError(e);\n        }\n    };\n    public readonly dismiss = (e?) => this._sheet_ref?.dismiss(e);\n\n    public get booking() {\n        return this._state.form.value as any;\n    }\n\n    public get assets() {\n        return this.booking.assets || null;\n    }\n\n    public get needs_locker() {\n        return !!this.booking.secondary_resource;\n    }\n\n    public get assets_count() {\n        return this.assets?.length\n            ? this.assets.reduce((a, b) => a + b.amount, 0)\n            : 0;\n    }\n\n    public get booking_asset() {\n        return this.booking.booking_asset as Desk;\n    }\n\n    public get location() {\n        const building = this._org.buildings.find(\n            (b) => b.id === this.booking_asset?.zone?.parent_id\n        );\n        const level = this._org.levels.find(\n            (l) => l.id === this.booking_asset?.zone?.id\n        );\n        return `${level?.display_name || level?.name}${building ? ',' : ''} ${\n            building?.address || building?.display_name || building?.name || ''\n        }`;\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _org: OrganisationService,\n        @Optional() private _sheet_ref: MatBottomSheetRef\n    ) {\n        super();\n    }\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\nimport { BookingFormService } from '@placeos/bookings';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport { Desk, OrganisationService } from '@placeos/organisation';\nimport { addMinutes, roundToNearestMinutes } from 'date-fns';\n\n@Component({\n    selector: 'new-desk-form-details',\n    styles: [],\n    template: `\n        <!-- <div class=\"m-2 bg-yellow-500 p-2 text-center rounded shadow text-sm\">\n            The selected desk hasn't been booked. Please book the desk to be\n            able to check-in.\n        </div> -->\n        <div\n            class=\"p-0 sm:py-4 sm:px-16 divide-y divide-gray-300 space-y-2\"\n            *ngIf=\"form\"\n            [formGroup]=\"form\"\n        >\n            <section class=\"flex items-center\" *ngIf=\"allow_groups\">\n                <button\n                    matRipple\n                    class=\"relative h-16 flex items-center justify-center flex-1 space-x-2\"\n                    [class.text-primary]=\"!(options | async)?.group\"\n                    [class.opacity-60]=\"(options | async)?.group\"\n                    (click)=\"setOptions({ group: false, members: [] })\"\n                >\n                    <app-icon class=\"text-2xl\">person</app-icon>\n                    <div class=\"\" i18n>Single</div>\n                    <div\n                        class=\"absolute h-2 inset-x-0 bottom-0 !m-0\"\n                        [class.bg-gray-200]=\"(options | async)?.group\"\n                        [class.bg-primary]=\"!(options | async)?.group\"\n                    ></div>\n                </button>\n                <button\n                    matRipple\n                    class=\"relative h-16 flex items-center justify-center flex-1 space-x-2\"\n                    [class.text-primary]=\"(options | async)?.group\"\n                    [class.opacity-60]=\"!(options | async)?.group\"\n                    (click)=\"setOptions({ group: true })\"\n                >\n                    <app-icon class=\"text-2xl\">group_add</app-icon>\n                    <div class=\"\" i18n>Group</div>\n                    <div\n                        class=\"absolute h-2 inset-x-0 bottom-0 !m-0\"\n                        [class.bg-gray-200]=\"!(options | async)?.group\"\n                        [class.bg-primary]=\"(options | async)?.group\"\n                    ></div>\n                </button>\n            </section>\n            <section class=\"p-2\" [class.!border-none]=\"allow_groups\">\n                <h3 class=\"space-x-2 flex items-center mb-4\">\n                    <div\n                        class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                    >\n                        1\n                    </div>\n                    <div class=\"text-xl\" i18n>Details</div>\n                </h3>\n                <div class=\"flex items-center flex-wrap sm:space-x-2\">\n                    <div class=\"flex-1 min-w-[256px]\">\n                        <label for=\"title\">Add Title<span>*</span></label>\n                        <mat-form-field appearance=\"outline\" class=\"w-full\">\n                            <input\n                                matInput\n                                name=\"title\"\n                                formControlName=\"title\"\n                                placeholder=\"e.g. Focus Time\"\n                            />\n                            <mat-error i18n\n                                >Booking title is required.</mat-error\n                            >\n                        </mat-form-field>\n                    </div>\n                    <div class=\"flex-1 min-w-[256px]\">\n                        <label for=\"date\" i18n>Date<span>*</span></label>\n                        <a-date-field name=\"date\" formControlName=\"date\" i18n>\n                            Date and time must be in the future\n                        </a-date-field>\n                    </div>\n                </div>\n                <div class=\"flex items-center space-x-2\">\n                    <div class=\"flex-1 w-1/3\">\n                        <label for=\"start-time\" i18n\n                            >Start Time<span>*</span></label\n                        >\n                        <a-time-field\n                            name=\"start-time\"\n                            [ngModel]=\"form.value.date\"\n                            (ngModelChange)=\"form.patchValue({ date: $event })\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                        ></a-time-field>\n                    </div>\n                    <div class=\"flex-1 w-1/3 relative\">\n                        <label for=\"end-time\" i18n\n                            >End Time<span>*</span></label\n                        >\n                        <a-duration-field\n                            name=\"end-time\"\n                            formControlName=\"duration\"\n                            [time]=\"form.get('date')?.value\"\n                            [max]=\"12 * 60\"\n                            [min]=\"60\"\n                            [step]=\"60\"\n                        >\n                        </a-duration-field>\n                        <mat-checkbox\n                            formControlName=\"all_day\"\n                            *ngIf=\"allow_all_day\"\n                            class=\"absolute -top-2 right-0\"\n                            i18n\n                        >\n                            All Day\n                        </mat-checkbox>\n                    </div>\n                </div>\n                <div\n                    class=\"flex items-center space-x-2\"\n                    *ngIf=\"can_book_lockers\"\n                >\n                    <div class=\"flex-1 w-1/3\">\n                        <mat-checkbox\n                            [ngModel]=\"!!form.value.secondary_resource\"\n                            (ngModelChange)=\"\n                                form.patchValue({\n                                    secondary_resource: $event ? 'locker' : ''\n                                })\n                            \"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            i18n\n                        >\n                            Require locker\n                        </mat-checkbox>\n                    </div>\n                </div>\n            </section>\n            <section class=\"p-2\" *ngIf=\"(options | async)?.group\">\n                <h3 class=\"space-x-2 flex items-center\">\n                    <div\n                        class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                    >\n                        2\n                    </div>\n                    <div class=\"text-xl\" i18n>Group Members</div>\n                    <div class=\"flex-1 w-px\"></div>\n                </h3>\n                <div class=\"overflow-hidden\">\n                    <a-user-list-field\n                        class=\"mt-4\"\n                        [ngModel]=\"(options | async)?.members || []\"\n                        (ngModelChange)=\"setOptions({ members: $event })\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                    ></a-user-list-field>\n                </div>\n            </section>\n            <section class=\"p-2\">\n                <h3 class=\"space-x-2 flex items-center mb-4\">\n                    <div\n                        class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                    >\n                        {{ (options | async)?.group ? 3 : 2 }}\n                    </div>\n                    <div class=\"text-xl\" i18n>Desk</div>\n                </h3>\n                <desk-list-field formControlName=\"resources\"></desk-list-field>\n                <p\n                    *ngIf=\"(options | async)?.group\"\n                    class=\"text-center rounded px-2 py-1 bg-yellow-400 shadow text-xs\"\n                >\n                    Desks nearby to the selected desk will booked for group\n                    members\n                </p>\n            </section>\n            <section class=\"p-2\" *ngIf=\"has_assets\">\n                <h3 class=\"space-x-2 flex items-center mb-4\">\n                    <div\n                        class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                    >\n                        {{ (options | async)?.group ? 4 : 3 }}\n                    </div>\n                    <div class=\"text-xl\" i18n>Request Asset</div>\n                </h3>\n                <asset-list-field formControlName=\"assets\"></asset-list-field>\n            </section>\n        </div>\n    `,\n})\nexport class NewDeskFormDetailsComponent extends AsyncHandler {\n    @Input() public form: FormGroup;\n    @Output() public find = new EventEmitter<void>();\n    /** List of available buildings to select */\n    public readonly buildings = this._org.building_list;\n    /** List of available levels for the selected building */\n    public readonly levels = this._org.active_levels;\n    /** List of set options for desk booking */\n    public readonly options = this._state.options;\n    /** List of set options for desk booking */\n    public readonly features = this._state.features;\n\n    /** Selected desk for booking */\n    public selected_desk: Desk;\n    public from_id = false;\n\n    public readonly recurrence_options = ['daily', 'weekly', 'monthly'];\n\n    public get building() {\n        return this._org.building;\n    }\n    public set building(bld) {\n        this._org.building = bld;\n    }\n\n    public readonly setOptions = (o) => this._state.setOptions(o);\n\n    public readonly setFeature = (f, e) => this._state.setFeature(f, e);\n\n    public get can_book_for_others() {\n        return this._settings.get('app.desks.can_book_for_others');\n    }\n\n    public get can_book_lockers() {\n        return this._settings.get('app.desks.can_book_lockers');\n    }\n    public get can_recurr() {\n        return this._settings.get('app.desks.recurrence_allowed');\n    }\n\n    public get allow_groups() {\n        return this._settings.get('app.desks.allow_groups');\n    }\n\n    public get has_assets() {\n        return !!this._settings.get('app.desks.has_assets');\n    }\n\n    public get needs_reason() {\n        return this._settings.get('app.desks.needs_reason') === true;\n    }\n\n    public get allow_time_changes() {\n        return !!this._settings.get('app.desks.allow_time_changes');\n    }\n\n    public get allow_all_day() {\n        return (\n            this.allow_time_changes &&\n            !!this._settings.get('app.desks.allow_all_day')\n        );\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _org: OrganisationService,\n        private _settings: SettingsService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'change',\n            this._state.form\n                .get('resources')\n                ?.valueChanges?.subscribe((list) =>\n                    list?.length ? this.setBookingAsset(list[0]) : ''\n                )\n        );\n    }\n\n    private setBookingAsset(desk: Desk) {\n        this._state.form.patchValue({ asset_id: undefined });\n        if (!desk) return;\n        this.selected_desk = desk;\n        this._state.form.patchValue({\n            asset_id: desk?.id,\n            asset_name: desk.name,\n            map_id: desk?.map_id || desk?.id,\n            description: desk.name,\n            booking_type: 'desk',\n            zones: desk.zone ? [desk.zone?.parent_id, desk.zone?.id] : [],\n            booking_asset: desk,\n        });\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport {\n    MatBottomSheet,\n    MatBottomSheetRef,\n} from '@angular/material/bottom-sheet';\nimport { Router } from '@angular/router';\nimport { BookingFormService } from '@placeos/bookings';\nimport {\n    getInvalidFields,\n    notifyError,\n    SettingsService,\n} from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { isBefore, startOfMinute } from 'date-fns';\nimport { first } from 'rxjs/operators';\nimport { NewDeskFlowConfirmComponent } from './new-desk-flow-confirm.component';\n\n@Component({\n    selector: 'new-desk-flow-form',\n    styles: [],\n    template: `\n        <div\n            class=\"h-full w-full bg-gray-100 dark:bg-neutral-600 overflow-auto\"\n        >\n            <div\n                class=\"max-w-full w-[48rem] mx-auto sm:my-4 bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-500\"\n            >\n                <h2\n                    class=\"w-full p-4 sm:py-4 sm:px-16 text-2xl font-medium border-b border-gray-300 dark:border-neutral-500\"\n                    i18n\n                >\n                    Book Desk\n                </h2>\n                <new-desk-form-details [form]=\"form\"></new-desk-form-details>\n                <div\n                    class=\"sm:mb-2 border-b border-gray-300 dark:border-neutral-500 w-full\"\n                ></div>\n                <section\n                    class=\"flex flex-col sm:flex-row items-center sm:space-x-2 p-2 sm:px-16 sm:mb-2\"\n                >\n                    <button\n                        btn\n                        name=\"open-desk-confirm\"\n                        matRipple\n                        confirm\n                        class=\"w-full sm:w-auto\"\n                        (click)=\"viewConfirm()\"\n                        i18n\n                    >\n                        Confirm Desk\n                    </button>\n                </section>\n            </div>\n        </div>\n    `,\n})\nexport class NewDeskFlowFormComponent implements OnInit {\n    public sheet_ref: MatBottomSheetRef<any>;\n    public level = '';\n    public levels = [];\n\n    public get form() {\n        return this._state.form;\n    }\n\n    public readonly clearForm = () => {\n        this.level = this._org.building.id;\n        this._state.clearForm();\n    };\n\n    public readonly viewConfirm = () => {\n        if (!this.form.valid)\n            return notifyError(\n                `Some fields are invalid. [${getInvalidFields(this.form).join(\n                    ', '\n                )}]`\n            );\n        this.sheet_ref = this._bottom_sheet.open(NewDeskFlowConfirmComponent);\n        this.sheet_ref.instance.show_close = true;\n        this.sheet_ref.afterDismissed().subscribe((value) => {\n            if (value) {\n                this._router.navigate(['/book', 'new-desks', 'success']);\n                this._state.setView('success');\n            }\n        });\n    };\n\n    constructor(\n        private _state: BookingFormService,\n        private _router: Router,\n        private _org: OrganisationService,\n        private _bottom_sheet: MatBottomSheet,\n        private _settings: SettingsService\n    ) {}\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _));\n        await this._org.active_levels.pipe(first((_) => _?.length > 0));\n        this.level = this._org.building?.id;\n        this.levels = [\n            { id: this._org.building?.id, name: 'Any Level' },\n            ...this._org.levelsForBuilding(this._org.building),\n        ];\n        if (isBefore(this.form.value.date, Date.now())) {\n            this.form.patchValue({ date: startOfMinute(Date.now()).valueOf() });\n        }\n    }\n}\n","import { Component } from '@angular/core';\nimport { BookingFormService } from '@placeos/bookings';\nimport { SettingsService } from '@placeos/common';\nimport {\n    generateCalendarFileLink,\n    generateGoogleCalendarLink,\n    generateMicrosoftCalendarLink,\n} from 'libs/common/src/lib/calendar-links';\n\n@Component({\n    selector: 'new-desk-flow-success',\n    styles: [],\n    template: `\n        <div\n            class=\"absolute inset-0 bg-white dark:bg-neutral-600 flex flex-col z-50\"\n        >\n            <main\n                class=\"flex-1 flex flex-col items-center justify-center space-y-2 p-8\"\n            >\n                <h2 class=\"text-2xl font-medium text-center\" i18n>\n                    {{ last_event.asset_name || last_event.asset_id\n                    }}{{ location }} Booked!\n                </h2>\n                <img src=\"assets/icons/success.svg\" />\n                <p class=\"text-center\" i18n>\n                    Your\n                    <span group *ngIf=\"last_event?.attendees?.length\">\n                        group of\n                        {{ last_event?.attendees?.length + 1 }}\n                    </span>\n                    desk{{ last_event?.attendees?.length ? 's' : '' }} has been\n                    successfully booked\n                    <span\n                        assets\n                        *ngIf=\"last_event?.extension_data?.assets?.length\"\n                    >\n                        including\n                        {{ last_event?.extension_data?.assets?.length }}\n                        asset(s)\n                    </span>\n                    for the\n                    {{ last_event.date | date: 'mediumDate' }} at\n                    {{ last_event.date | date: 'shortTime' }}-{{\n                        last_event.date + last_event.duration * 60 * 1000\n                            | date: 'shortTime'\n                    }}.\n                </p>\n                <div\n                    class=\"flex flex-col items-center space-y-4 p-4 relative\"\n                    *ngIf=\"show_links\"\n                >\n                    <a\n                        btn\n                        matRipple\n                        name=\"desk-outlook-link\"\n                        class=\"flex items-center p-2 space-x-2 pr-4 w-64 rounded inverse\"\n                        [href]=\"outlook_link | sanitize: 'url'\"\n                        target=\"_blank\"\n                        rel=\"noopener noreferer\"\n                    >\n                        <img src=\"assets/icons/outlook.svg\" class=\"w-6\" />\n                        <span i18n>Add to Outlook</span>\n                    </a>\n                    <a\n                        btn\n                        matRipple\n                        name=\"desk-google-link\"\n                        class=\"flex items-center p-2 space-x-2 pr-4 w-64 rounded inverse\"\n                        [href]=\"google_link | sanitize: 'url'\"\n                        target=\"_blank\"\n                        rel=\"noopener noreferer\"\n                    >\n                        <img src=\"assets/icons/gcal.svg\" class=\"w-6\" />\n                        <span i18n>Add to Google Calendar</span>\n                    </a>\n                    <a\n                        btn\n                        matRipple\n                        name=\"desk-ical-link\"\n                        class=\"flex items-center p-2 space-x-2 pr-4 w-64 rounded inverse\"\n                        [href]=\"ical_link | safe: 'url'\"\n                        target=\"_blank\"\n                        rel=\"noopener noreferer\"\n                    >\n                        <app-icon class=\"text-xl\">download</app-icon>\n                        <span i18n>Download iCal File</span>\n                    </a>\n                </div>\n            </main>\n            <footer\n                class=\"p-2 w-full border-t border-gray-200 dark:border-neutral-500 mt-4 flex items-center justify-center\"\n            >\n                <a\n                    btn\n                    name=\"desk-confirm-continue\"\n                    matRipple\n                    class=\"w-full max-w-[32rem] mx-auto\"\n                    [routerLink]=\"['/']\"\n                    i18n\n                >\n                    Great, thanks!\n                </a>\n            </footer>\n        </div>\n    `,\n})\nexport class NewDeskFlowSuccessComponent {\n    public outlook_link = '';\n    public google_link = '';\n    public ical_link = '';\n    public get location() {\n        const desk = this.last_event?.extension_data?.booking_asset;\n        if (!desk) return '';\n        return desk.zone\n            ? `, ${desk.zone.display_name || desk.zone.name || desk.zone.id}`\n            : '';\n    }\n\n    public get last_event() {\n        return this._state.last_success;\n    }\n\n    public get show_links() {\n        return this._settings.get('app.desks.show_calendar_links');\n    }\n\n    public readonly viewCalendarLinks = () =>\n        this._state.openBookingLinkModal();\n\n    constructor(\n        private _state: BookingFormService,\n        private _settings: SettingsService\n    ) {}\n\n    public ngOnInit() {\n        this.outlook_link = generateMicrosoftCalendarLink(\n            this.last_event as any\n        );\n        this.google_link = generateGoogleCalendarLink(this.last_event as any);\n        this.ical_link = generateCalendarFileLink(this.last_event as any);\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { BookingFormService } from '@placeos/bookings';\nimport { AsyncHandler } from '@placeos/common';\nimport { Desk, OrganisationService } from '@placeos/organisation';\nimport { first } from 'rxjs/operators';\n\n@Component({\n    selector: 'placeos-new-book-desk-flow',\n    template: `\n        <div class=\"bg-white dark:bg-neutral-900 h-full w-full z-50\">\n            <ng-container [ngSwitch]=\"view\">\n                <ng-container *ngSwitchCase=\"'success'\">\n                    <new-desk-flow-success></new-desk-flow-success>\n                </ng-container>\n                <ng-container *ngSwitchDefault>\n                    <new-desk-flow-form></new-desk-flow-form>\n                </ng-container>\n            </ng-container>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class NewDeskFlowComponent extends AsyncHandler implements OnInit {\n    public get view() {\n        return this._state.view;\n    }\n    public get last_success() {\n        return this._state.last_success;\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _route: ActivatedRoute,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this._state.loadForm();\n        if (!this._state.form) this._state.newForm();\n        this._state.setOptions({ type: 'desk' });\n        this._state.form.patchValue({ booking_type: 'desk' });\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((param) => {\n                if (param.has('step'))\n                    this._state.setView(param.get('step') as any);\n            })\n        );\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('success')) {\n                    this._state.setView(params.get('success') as any);\n                }\n                if (params.has('asset_id')) {\n                    this._state.form.patchValue({\n                        resources: [\n                            new Desk({\n                                id: params.get('asset_id'),\n                                name: params.get('asset_id'),\n                            }),\n                        ],\n                    });\n                }\n            })\n        );\n    }\n}\n","import { Component } from '@angular/core';\nimport { Router } from '@angular/router';\n\n@Component({\n    selector: 'placeos-book-space-flow',\n    template: `\n        <div class=\"bg-gray-100 dark:bg-neutral-600 h-full w-full overflow-auto\">\n            <div class=\"w-full h-full sm:h-auto max-w-[640px] mx-auto sm:my-4 bg-white shadow border border-gray-200 dark:border-neutral-500 overflow-hidden\">\n                <invite-visitor-form (done)=\"onDone()\"></invite-visitor-form>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class VisitorFlowComponent {\n\n    constructor(private _router: Router) {}\n\n    public onDone() {\n        this._router.navigate(['/']);\n    }\n}\n","import { Component, Input, Optional } from '@angular/core';\nimport { MatBottomSheetRef } from '@angular/material/bottom-sheet';\nimport { BookingFormService } from '@placeos/bookings';\nimport { AsyncHandler } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\n\n@Component({\n    selector: 'new-parking-flow-confirm',\n    template: ` <button\n            close\n            icon\n            matRipple\n            *ngIf=\"show_close\"\n            (click)=\"dismiss()\"\n        >\n            <app-icon>close</app-icon>\n        </button>\n        <header class=\"flex items-center justify-between px-2\">\n            <h2 class=\"text-2xl font-medium mb-2\" i18n>\n                Confirm Parking Reservation\n            </h2>\n            <mat-spinner diameter=\"32\" *ngIf=\"loading | async\"></mat-spinner>\n        </header>\n        <section period class=\"flex space-x-1 py-4 px-2\">\n            <app-icon class=\"text-success\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3>{{ booking.title || '~Untitled~' }}</h3>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>calendar_today</app-icon>\n                    <div date>{{ booking.date | date: 'fullDate' }}</div>\n                </div>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>schedule</app-icon>\n                    <div time>\n                        {{\n                            booking.all_day\n                                ? 'All Day'\n                                : (booking.date | date: 'shortTime') +\n                                  ' - ' +\n                                  (booking.date + booking.duration * 60 * 1000\n                                      | date: 'h:mm a (z)')\n                        }}\n                    </div>\n                </div>\n            </div>\n        </section>\n        <section\n            resource\n            class=\"flex space-x-1 py-4 px-2 border-t\"\n            *ngIf=\"booking_asset?.id\"\n        >\n            <app-icon class=\"text-success\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3 name>\n                    {{ booking_asset?.name || booking_asset?.id || '' }}\n                </h3>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>person</app-icon>\n                    <span i18n>Car Park</span>\n                </div>\n                <div class=\"flex items-center space-x-2\">\n                    <app-icon>place</app-icon>\n                    <div>{{ location }}</div>\n                </div>\n                <ng-container *ngFor=\"let feat of booking_asset.features\">\n                    <div features class=\"flex items-center space-x-2\">\n                        <app-icon>arrow_upward</app-icon>\n                        <div>{{ feat }}</div>\n                    </div>\n                </ng-container>\n            </div>\n        </section>\n        <section\n            assets\n            class=\"flex space-x-1 py-4 px-2 border-t\"\n            *ngIf=\"assets?.length\"\n        >\n            <app-icon class=\"text-success\">done</app-icon>\n            <div details class=\"leading-6\">\n                <h3 i18n>{{ assets_count }} Asset(s)</h3>\n                <div class=\"flex space-x-2\" *ngFor=\"let asset of assets\">\n                    <div class=\"h-5 w-5 bg-gray-100 rounded-full\">\n                        {{ asset.amount }}\n                    </div>\n                    <span>{{ asset.name }}</span>\n                </div>\n            </div>\n        </section>\n        <footer class=\"p-2 w-full border-t border-gray-200 mt-4\">\n            <button\n                confirm\n                btn\n                matRipple\n                class=\"w-full\"\n                *ngIf=\"!(loading | async)\"\n                (click)=\"postForm()\"\n                i18n\n            >\n                Confirm\n            </button>\n        </footer>`,\n    styles: [\n        `\n            section > app-icon {\n                font-size: 1.5rem;\n                margin-top: 0.3rem;\n            }\n\n            h3 {\n                font-size: 1.25rem;\n                font-weight: medium;\n                margin: 0.5rem 0;\n            }\n        `,\n    ],\n})\nexport class NewParkingFlowConfirmComponent extends AsyncHandler {\n    @Input() public show_close: boolean = false;\n\n    public readonly loading = this._state.loading;\n\n    public readonly postForm = async () => {\n        await this._state.postForm();\n        this.dismiss(true);\n    };\n    public readonly dismiss = (e?) => this._sheet_ref?.dismiss(e);\n\n    public get booking() {\n        return this._state.form.value as any;\n    }\n\n    public get assets() {\n        return this.booking.assets || null;\n    }\n\n    public get assets_count() {\n        return this.assets?.length\n            ? this.assets.reduce((a, b) => a + b.amount, 0)\n            : 0;\n    }\n\n    public get booking_asset() {\n        return this.booking.booking_asset;\n    }\n\n    public get location() {\n        const building = this._org.buildings.find(\n            (b) => b.id === this.booking_asset?.zone?.parent_id\n        );\n        const level = this._org.levels.find(\n            (l) => l.id === this.booking_asset?.zone?.id\n        );\n        return `${level?.display_name || level?.name}${building ? ',' : ''} ${\n            building?.address || building?.display_name || building?.name || ''\n        }`;\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _org: OrganisationService,\n        @Optional() private _sheet_ref: MatBottomSheetRef\n    ) {\n        super();\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { BookingAsset } from '@placeos/bookings';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\n\n@Component({\n    selector: 'parking-form-details',\n    template: `\n        <div *ngIf=\"form\" [formGroup]=\"form\">\n            <div class=\"flex items-center flex-wrap sm:space-x-2\">\n                <div class=\"flex-1 min-w-[256px]\">\n                    <label for=\"title\" i18n>Building<span>*</span></label>\n                    <mat-form-field appearance=\"outline\" class=\"w-full\">\n                        <mat-select\n                            [ngModel]=\"building | async\"\n                            (ngModelChange)=\"setBuilding($event)\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                        >\n                            <mat-option\n                                *ngFor=\"let bld of building_list | async\"\n                                [value]=\"bld\"\n                            >\n                                {{ bld.display_name || bld.name }}\n                            </mat-option>\n                        </mat-select>\n                        <mat-error i18n>Building is required</mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n            <div class=\"flex items-center flex-wrap sm:space-x-2\">\n                <div class=\"flex-1 min-w-[256px]\">\n                    <label for=\"title\" i18n>Add Title<span>*</span></label>\n                    <mat-form-field appearance=\"outline\" class=\"w-full\">\n                        <input\n                            matInput\n                            name=\"title\"\n                            formControlName=\"title\"\n                            placeholder=\"e.g. Team Meeting\"\n                        />\n                        <mat-error i18n>Meeting title is required.</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex-1 min-w-[256px]\">\n                    <label for=\"date\" i18n>Date<span>*</span></label>\n                    <a-date-field name=\"date\" formControlName=\"date\" i18n>\n                        Date and time must be in the future\n                    </a-date-field>\n                </div>\n            </div>\n            <div class=\"flex items-center space-x-2\">\n                <div class=\"flex-1 w-1/3\">\n                    <label for=\"start-time\" i18n\n                        >Start Time<span>*</span></label\n                    >\n                    <a-time-field\n                        name=\"start-time\"\n                        [ngModel]=\"form.value.date\"\n                        (ngModelChange)=\"form.patchValue({ date: $event })\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                    ></a-time-field>\n                </div>\n                <div class=\"flex-1 w-1/3 relative\">\n                    <label for=\"end-time\" i18n>End Time<span>*</span></label>\n                    <a-duration-field\n                        name=\"end-time\"\n                        formControlName=\"duration\"\n                        [time]=\"form?.value?.date\"\n                        [max]=\"max_duration\"\n                    >\n                    </a-duration-field>\n                    <mat-checkbox\n                        formControlName=\"all_day\"\n                        *ngIf=\"allow_all_day\"\n                        class=\"absolute top-0 right-0\"\n                        i18n\n                    >\n                        All Day\n                    </mat-checkbox>\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class ParkingFormDetailsComponent extends AsyncHandler {\n    @Input() public form: FormGroup;\n\n    public readonly building = this._org.active_building;\n    public readonly building_list = this._org.building_list;\n\n    public get max_duration() {\n        return this._settings.get('app.bookings.max_duration') || 480;\n    }\n\n    public get allow_all_day() {\n        return this._settings.get('app.bookings.allow_all_day');\n    }\n\n    public readonly setBuilding = (bld) => (this._org.building = bld);\n\n    constructor(\n        private _settings: SettingsService,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'change',\n            this.form\n                .get('resources')\n                ?.valueChanges?.subscribe((list) =>\n                    list.length ? this.setBookingAsset(list[0]) : ''\n                )\n        );\n    }\n\n    private setBookingAsset(item: BookingAsset) {\n        if (!item) return;\n        this.form.patchValue({\n            asset_id: item?.id,\n            asset_name: item.name,\n            map_id: item?.map_id || item?.id,\n            description: item.name,\n            booking_type: 'parking',\n            zones: item.zone ? [item.zone?.parent_id, item.zone?.id] : [],\n            booking_asset: item,\n        });\n    }\n}\n","import { Component } from '@angular/core';\nimport { MatBottomSheet } from '@angular/material/bottom-sheet';\nimport { Router } from '@angular/router';\nimport { BookingFormService } from '@placeos/bookings';\nimport {\n    ANIMATION_SHOW_CONTRACT_EXPAND,\n    AsyncHandler,\n    getInvalidFields,\n    notifyError,\n    SettingsService,\n} from '@placeos/common';\nimport { NewParkingFlowConfirmComponent } from './parking-flow-confirm.component';\n\n@Component({\n    selector: 'parking-flow-form',\n    template: `\n        <div\n            class=\"h-full w-full bg-gray-100 dark:bg-neutral-600 overflow-auto\"\n        >\n            <div\n                class=\"max-w-full w-[48rem] mx-auto sm:my-4 bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-500\"\n            >\n                <h2\n                    class=\"w-full p-4 sm:py-4 sm:px-16 text-2xl font-medium border-b border-gray-300 dark:border-neutral-500\"\n                    i18n\n                >\n                    {{ form.value.id ? 'Edit' : 'Book' }} Parking Reservation\n                </h2>\n                <form\n                    class=\"p-0 sm:py-4 sm:px-16 divide-y divide-gray-300 space-y-2\"\n                    [formGroup]=\"form\"\n                >\n                    <section class=\"p-2\">\n                        <h3 class=\"space-x-2 flex items-center\">\n                            <div\n                                class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                            >\n                                1\n                            </div>\n                            <div class=\"text-xl\" i18n>Details</div>\n                            <div class=\"flex-1 w-px\"></div>\n                            <button\n                                icon\n                                matRipple\n                                (click)=\"\n                                    hide_block.details = !hide_block.details\n                                \"\n                            >\n                                <app-icon>{{\n                                    hide_block.details\n                                        ? 'expand_more'\n                                        : 'expand_less'\n                                }}</app-icon>\n                            </button>\n                        </h3>\n                        <div\n                            class=\"overflow-hidden\"\n                            [@show]=\"hide_block.details ? 'hide' : 'show'\"\n                        >\n                            <parking-form-details\n                                class=\"mt-4\"\n                                [form]=\"form\"\n                            ></parking-form-details>\n                        </div>\n                    </section>\n                    <section class=\"p-2\">\n                        <h3 class=\"space-x-2 flex items-center\">\n                            <div\n                                class=\"bg-black/20 rounded-full h-6 w-6 flex items-center justify-center\"\n                            >\n                                2\n                            </div>\n                            <div class=\"text-xl\" i18n>Space</div>\n                            <div class=\"flex-1 w-px\"></div>\n                            <button\n                                icon\n                                matRipple\n                                (click)=\"hide_block.space = !hide_block.space\"\n                            >\n                                <app-icon>{{\n                                    hide_block.space\n                                        ? 'expand_more'\n                                        : 'expand_less'\n                                }}</app-icon>\n                            </button>\n                        </h3>\n                        <div\n                            class=\"overflow-hidden\"\n                            [@show]=\"hide_block.space ? 'hide' : 'show'\"\n                        >\n                            <parking-space-list-field\n                                formControlName=\"resources\"\n                            ></parking-space-list-field>\n                        </div>\n                    </section>\n                    <section\n                        class=\"flex flex-col sm:flex-row items-center sm:space-x-2 p-2\"\n                    >\n                        <button\n                            btn\n                            matRipple\n                            confirm\n                            class=\"mb-2 sm:mb-0 w-full sm:w-auto\"\n                            (click)=\"viewConfirm()\"\n                            i18n\n                        >\n                            Confirm Reservation\n                        </button>\n                        <button\n                            btn\n                            matRipple\n                            clear-form\n                            class=\"inverse w-full sm:w-auto\"\n                            (click)=\"clearForm()\"\n                            i18n\n                        >\n                            {{ form.value.id ? 'Reset' : 'Clear' }} Form\n                        </button>\n                    </section>\n                </form>\n            </div>\n        </div>\n    `,\n    styles: [``],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n})\nexport class ParkingFlowFormComponent extends AsyncHandler {\n    public hide_block: Record<string, boolean> = {};\n    public sheet_ref: any;\n\n    public readonly clearForm = () => this._state.resetForm();\n\n    public get form() {\n        return this._state.form;\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _settings: SettingsService,\n        private _router: Router,\n        private _bottom_sheet: MatBottomSheet\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.setOptions({ type: 'parking' });\n    }\n\n    public readonly viewConfirm = () => {\n        if (!this.form.valid)\n            return notifyError(\n                `Some fields are invalid. [${getInvalidFields(this.form).join(\n                    ', '\n                )}]`\n            );\n        this.sheet_ref = this._bottom_sheet.open(\n            NewParkingFlowConfirmComponent\n        );\n        this.sheet_ref.instance.show_close = true;\n        this.sheet_ref.afterDismissed().subscribe((value) => {\n            if (value) {\n                this._router.navigate(['/book', 'new-parking', 'success']);\n                this._state.setView('success');\n            }\n        });\n    };\n}\n","import { Component } from '@angular/core';\nimport { BookingFormService } from '@placeos/bookings';\n\n@Component({\n    selector: 'parking-flow-success',\n    template: ` <div class=\"absolute inset-0 bg-white flex flex-col z-50\">\n        <main\n            class=\"flex-1 flex flex-col items-center justify-center space-y-2 p-8\"\n        >\n            <h2 class=\"text-2xl font-medium\" i18n>Parking Space Confirmed!</h2>\n            <p class=\"text-center max-w-[32rem]\" i18n>\n                Your\n                <span>\n                    parking space reservation for\n                    {{ last_event.asset_name }} at {{ location }}, </span\n                >has been successfully booked for the\n                {{ last_event.date | date: 'mediumDate' }} at\n                {{ last_event.date | date: 'shortTime' }}-{{\n                    last_event.date + last_event.duration * 60 * 1000\n                        | date: 'shortTime'\n                }}.\n            </p>\n            <img src=\"assets/icons/parking-success.svg\" />\n        </main>\n        <footer\n            class=\"p-2 w-full border-t border-gray-200 mt-4 flex items-center justify-center\"\n        >\n            <a\n                button\n                btn\n                matRipple\n                class=\"w-full max-w-[32rem]\"\n                [routerLink]=\"['/']\"\n                i18n\n            >\n                Great, thanks!\n            </a>\n        </footer>\n    </div>`,\n    styles: [``],\n})\nexport class ParkingFlowSuccessComponent {\n    public get location() {\n        const resource = this.last_event?.extension_data?.booking_asset;\n        if (!resource) return '';\n        return resource.zone\n            ? `, ${\n                  resource.zone.display_name ||\n                  resource.zone.name ||\n                  resource.zone.id\n              }`\n            : '';\n    }\n\n    public get last_event() {\n        return this._state.last_success;\n    }\n\n    constructor(private _state: BookingFormService) {}\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { BookingFormService } from '@placeos/bookings';\nimport { AsyncHandler } from '@placeos/common';\n\n@Component({\n    selector: 'placeos-new-parking-flow',\n    template: `\n        <div\n            class=\"bg-white dark:bg-neutral-900 h-full w-full z-50\"\n            [ngSwitch]=\"view\"\n        >\n            <parking-flow-success *ngSwitchCase=\"'success'\">\n            </parking-flow-success>\n            <parking-flow-confirm *ngSwitchCase=\"'confirm'\">\n            </parking-flow-confirm>\n            <parking-flow-form *ngSwitchDefault></parking-flow-form>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class NewParkingFlowComponent extends AsyncHandler implements OnInit {\n    public get view() {\n        return this._state.view;\n    }\n    public get last_success() {\n        return this._state.last_success;\n    }\n\n    constructor(\n        private _state: BookingFormService,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.loadForm();\n        if (!this._state.form) this._state.newForm();\n        this._state.setOptions({ type: 'parking' });\n        this._state.form.patchValue({ booking_type: 'parking' });\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((param) => {\n                if (param.has('step'))\n                    this._state.setView(param.get('step') as any);\n            })\n        );\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((param) => {\n                if (param.has('success')) this._state.setView('success');\n            })\n        );\n    }\n}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'code-flow-success',\n    template: `\n        <div\n            class=\"absolute inset-0 bg-white dark:bg-neutral-600 flex flex-col z-50\"\n        >\n            <main\n                class=\"flex-1 flex flex-col items-center justify-center space-y-2 p-8\"\n            >\n                <h2 class=\"text-2xl font-medium\">\n                    {{ 'WPA.RESOURCE_CHECKED_IN' | translate }}\n                </h2>\n                <img src=\"assets/icons/success.svg\" />\n                <p class=\"text-center max-w-[32rem]\">\n                    {{ 'WPA.CHECKED_IN' | translate }}\n                </p>\n            </main>\n            <footer\n                class=\"p-2 w-full border-t border-gray-200 dark:bg-neutral-500 mt-4 flex items-center justify-center\"\n            >\n                <a\n                    button\n                    btn\n                    matRipple\n                    class=\"w-full max-w-[32rem]\"\n                    [routerLink]=\"['/']\"\n                >\n                    {{ 'WPA.BOOKING_DONE_CONTINUE' | translate }}\n                </a>\n            </footer>\n        </div>\n    `,\n    styles: [``],\n})\nexport class CodeFlowSuccessComponent {}\n","import { Component } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AsyncHandler } from '@placeos/common';\n\n@Component({\n    selector: 'code-flow-success',\n    template: `\n        <div\n            class=\"absolute inset-0 bg-white dark:bg-neutral-600 flex flex-col z-50\"\n        >\n            <main\n                class=\"flex-1 flex flex-col items-center justify-center space-y-2 p-8\"\n            >\n                <h2 class=\"text-2xl font-medium\">\n                    {{ 'WPA.RESOURCE_CHECKED_IN_FAILED' | translate }}\n                </h2>\n                <div class=\"py-4\">\n                    <img src=\"assets/icons/not-found.svg\" class=\"h-64\" />\n                </div>\n                <p class=\"text-center max-w-[32rem]\" [ngSwitch]=\"type\">\n                    <ng-container *ngSwitchCase=\"'not_started'\">\n                        Booking has not started yet. Please try again once the\n                        booking has commenced.\n                    </ng-container>\n                    <ng-container *ngSwitchCase=\"'wrong_resource'\">\n                        You have booking with a difference resource.\n                    </ng-container>\n                    <ng-container *ngSwitchDefault>\n                        You do not have a booking. Would you like to book\n                        {{ asset_id }}?\n                    </ng-container>\n                </p>\n            </main>\n            <footer\n                class=\"p-2 w-full border-t border-gray-200 dark:bg-neutral-500 mt-4 flex items-center justify-center space-x-2\"\n            >\n                <a\n                    button\n                    btn\n                    matRipple\n                    class=\"w-full max-w-[32rem]\"\n                    [routerLink]=\"['/book', 'code']\"\n                    [queryParams]=\"{ asset_id: asset_id }\"\n                    *ngIf=\"type === 'not_started'\"\n                >\n                    {{ 'WPA.TRY_AGAIN' | translate }}\n                </a>\n                <a\n                    button\n                    btn\n                    matRipple\n                    class=\"w-full max-w-[32rem]\"\n                    [routerLink]=\"['/book', 'new-desks']\"\n                    [queryParams]=\"{ asset_id: asset_id }\"\n                    *ngIf=\"type === 'no_booking'\"\n                >\n                    {{ 'WPA.BOOK' | translate }}\n                </a>\n                <a\n                    button\n                    btn\n                    matRipple\n                    class=\"w-full max-w-[32rem] inverse\"\n                    [routerLink]=\"['/']\"\n                >\n                    {{ 'COMMON.CONTINUE' | translate }}\n                </a>\n            </footer>\n        </div>\n    `,\n    styles: [``],\n})\nexport class CodeFlowErrorComponent extends AsyncHandler {\n    public type = '';\n    public asset_id = '';\n\n    constructor(private _route: ActivatedRoute) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                this.type = params.get('type');\n                this.asset_id = params.get('asset_id');\n            })\n        );\n    }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { Route, RouterModule } from '@angular/router';\nimport { MatButtonToggleModule } from '@angular/material/button-toggle';\nimport { MatBottomSheetModule } from '@angular/material/bottom-sheet';\n\nimport { SharedExploreModule } from '@placeos/explore';\nimport { SharedBookingsModule } from '@placeos/bookings';\nimport { AssetsModule } from '@placeos/assets';\nimport { SharedCateringModule } from '@placeos/catering';\n\nimport { BookComponent } from './book.component';\nimport { BookCodeFlowComponent } from './code-flow.component';\nimport { BookDeskFlowComponent } from './desk-flow.component';\nimport { DeskFlowConfirmComponent } from './desk-flow/confirm.component';\nimport { DeskFlowFormComponent } from './desk-flow/form.component';\nimport { DeskFlowDetailedFormComponent } from './desk-flow/detailed-form.component';\nimport { DeskFlowMapComponent } from './desk-flow/map.component';\nimport { FlowSuccessComponent } from './flow-success.component';\nimport { BookSpaceFlowComponent } from './space-flow.component';\nimport { SpaceFlowConfirmComponent } from './space-flow/confirm.component';\nimport { DetailBookSpaceFormComponent } from './space-flow/detailed-form.component';\nimport { SpaceFlowFindItemComponent } from './space-flow/find-item.component';\nimport { SpaceFlowFindComponent } from './space-flow/find.component';\nimport { SpaceFlowFormComponent } from './space-flow/form.component';\nimport { SharedComponentModule } from '../components/shared.module';\nimport { BookParkingFlowComponent } from './parking-flow.component';\nimport { ParkingFlowMapComponent } from './parking-flow/parking-flow-map.component';\nimport { ParkingFlowConfirmComponent } from './parking-flow/parking-flow-confirm.component';\nimport { BookMeetingFlowComponent } from './meeting-flow.component';\nimport { MeetingFlowFormComponent } from './meeting-flow/meeting-flow-form.component';\nimport { MeetingFormDetailsComponent } from './meeting-flow/meeting-form-details.component';\nimport { MeetingFlowConfirmComponent } from './meeting-flow/meeting-flow-confirm.component';\nimport { MeetingFlowSuccessComponent } from './meeting-flow/meeting-flow-success.component';\nimport { NewDeskFlowComponent } from './new-desk-flow.component';\nimport { NewDeskFlowFormComponent } from './new-desk-flow/new-desk-flow-form.component';\nimport { NewDeskFormDetailsComponent } from './new-desk-flow/new-desk-form-details.component';\nimport { NewDeskFlowConfirmComponent } from './new-desk-flow/new-desk-flow-confirm.component';\nimport { NewDeskFlowSuccessComponent } from './new-desk-flow/new-desk-flow-success.component';\nimport { VisitorFlowComponent } from './visitor-flow.component';\nimport { NewParkingFlowComponent } from './new-parking-flow.component';\nimport { ParkingFlowFormComponent } from './new-parking-flow/parking-flow-form.component';\nimport { ParkingFlowSuccessComponent } from './new-parking-flow/parking-flow-success.component';\nimport { ParkingFormDetailsComponent } from './new-parking-flow/parking-form-details.component';\nimport { MeetingFlowConfirmModalComponent } from './meeting-flow/meeting-flow-confirm-modal.component';\nimport { NewParkingFlowConfirmComponent } from './new-parking-flow/parking-flow-confirm.component';\nimport { CodeFlowSuccessComponent } from './code-flow-success.component';\nimport { CodeFlowErrorComponent } from './code-flow-error.component';\n\nconst ROUTES: Route[] = [\n    {\n        path: '',\n        component: BookComponent,\n        children: [\n            { path: 'code', component: BookCodeFlowComponent },\n            { path: 'code/success', component: CodeFlowSuccessComponent },\n            { path: 'code/error', component: CodeFlowErrorComponent },\n            { path: 'new-desks', redirectTo: 'new-desks/form' },\n            { path: 'new-desks/:step', component: NewDeskFlowComponent },\n            { path: 'desks', redirectTo: 'desks/form' },\n            { path: 'desks/:step', component: BookDeskFlowComponent },\n            { path: 'spaces', redirectTo: 'spaces/form' },\n            { path: 'spaces/:step', component: BookSpaceFlowComponent },\n            { path: 'meeting', redirectTo: 'meeting/form' },\n            { path: 'meeting/:step', component: BookMeetingFlowComponent },\n            { path: 'parking', redirectTo: 'parking/form' },\n            { path: 'parking/:step', component: BookParkingFlowComponent },\n            { path: 'new-parking', redirectTo: 'new-parking/form' },\n            { path: 'new-parking/:step', component: NewParkingFlowComponent },\n            { path: 'visitor', redirectTo: 'visitor/form' },\n            { path: 'visitor/:step', component: VisitorFlowComponent },\n            { path: '*', redirectTo: 'spaces/form' },\n        ],\n    },\n    { path: '*', redirectTo: 'spaces/form' },\n];\n\n@NgModule({\n    declarations: [\n        BookComponent,\n        BookSpaceFlowComponent,\n        SpaceFlowFormComponent,\n        SpaceFlowFindComponent,\n        SpaceFlowFindItemComponent,\n        SpaceFlowConfirmComponent,\n        DetailBookSpaceFormComponent,\n        BookDeskFlowComponent,\n        DeskFlowFormComponent,\n        DeskFlowDetailedFormComponent,\n        DeskFlowMapComponent,\n        DeskFlowConfirmComponent,\n        BookCodeFlowComponent,\n        CodeFlowSuccessComponent,\n        CodeFlowErrorComponent,\n        BookParkingFlowComponent,\n        ParkingFlowMapComponent,\n        ParkingFlowConfirmComponent,\n        FlowSuccessComponent,\n        BookMeetingFlowComponent,\n        MeetingFlowFormComponent,\n        MeetingFormDetailsComponent,\n        MeetingFlowConfirmComponent,\n        MeetingFlowConfirmModalComponent,\n        MeetingFlowSuccessComponent,\n        NewDeskFlowFormComponent,\n        NewDeskFormDetailsComponent,\n        NewDeskFlowComponent,\n        NewDeskFlowConfirmComponent,\n        NewDeskFlowSuccessComponent,\n        VisitorFlowComponent,\n\n        NewParkingFlowComponent,\n        ParkingFlowFormComponent,\n        NewParkingFlowConfirmComponent,\n        ParkingFlowSuccessComponent,\n        ParkingFormDetailsComponent,\n    ],\n    imports: [\n        CommonModule,\n        SharedComponentModule,\n        FormsModule,\n        AssetsModule,\n        SharedCateringModule,\n        SharedExploreModule,\n        ReactiveFormsModule,\n        MatButtonToggleModule,\n        MatBottomSheetModule,\n        SharedBookingsModule,\n        RouterModule.forChild(ROUTES),\n    ],\n})\nexport class BookModule {}\n"],"x_google_ignoreList":[0,13,37]}