"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_visitors_visitors_module_ts"],{2359:(Gt,y,l)=>{l.r(y),l.d(y,{VisitorsModule:()=>Nt});var m=l(6477),_=l(9542),g=l(647),S=l(3045),d=l(1670),x=l(4505),M=l(7716),O=l(4139),k=l(9151),D=l(823),Y=l(9095),Q=l(7418),I=l(8759),P=l(9128),E=l(6942),j=l(3910),z=l(9377),R=l(312),V=l(1810),A=l(1535),p=l(9743),H=l(5533),h=l(5375),Z=l(5912),K=l(1790),t=l(6839),w=l(7486);let C=(()=>{class n extends p.cx{get search(){return this._search.getValue()}get time_format(){return this._settings.time_format}constructor(e,o,s){super(),this._dialog=e,this._org=o,this._settings=s,this._poll=new x.X(0),this._filters=new x.X({}),this._search=new x.X(""),this._loading=new x.X(!1),this._space_pipe=new K.XE,this.loading=this._loading.asObservable(),this.filters=this._filters.asObservable(),this.bookings=(0,M.aj)([this._org.active_building,this._filters,this._poll]).pipe((0,k.h)(([i])=>!!i),(0,D.b)(150),(0,Y.w)(([i,r])=>{this._loading.next(!0);const c=r.date?new Date(r.date):new Date,f=(0,z.Z)(c),u=(0,R.Z)(f,r.period||1);return(0,h.F2)({type:"visitor",period_start:(0,V.Z)(f),period_end:(0,V.Z)(u),zones:(r.zones||[]).join(",")||i.id}).pipe((0,Q.K)(v=>(0,O.of)([])))}),(0,I.b)(()=>this._loading.next(!1)),(0,P.d)(1)),this.filtered_bookings=(0,M.aj)([this._search,this.bookings]).pipe((0,E.U)(([i,r])=>{const c=i.toLowerCase();return r.filter(u=>u.asset_name.toLowerCase().includes(c)||u.user_name.toLowerCase().includes(c)||u.user_email.toLowerCase().includes(c)||u.asset_id.toLowerCase().includes(c)).sort((u,v)=>u.date-v.date)}))}setFilters(e){this._filters.next({...this._filters.getValue(),...e})}setSearchString(e){this._search.next(e)}poll(){this._poll.next(Date.now())}startPolling(e=3e4){this.interval("poll",()=>this._poll.next(Date.now()),e)}stopPolling(){this.clearInterval("poll")}setExt(e,o,s){var i=this;return(0,d.Z)(function*(){const r={...e.extension_data};r[o]=s,yield(0,H.sF)(e.id,{...e,extension_data:r}).toPromise(),i._poll.next(Date.now())})()}approveVisitor(e){var o=this;return(0,d.Z)(function*(){const s=yield(0,p._5)({title:"Approve Visitor",content:`Approve attendance of ${e.asset_name||e.asset_id} to their meeting?`,icon:{content:"event_available"}},o._dialog);if("done"!==s.reason)return s.close();s.loading("Updating guest details"),yield(0,h.jT)(e.id).toPromise().catch(i=>{throw(0,p.cB)(`Error approving visitor: ${i.message||i.error||i}`),s.close(),i}),(0,p.t5)("Successfully approved visitor"),o._poll.next(Date.now()),s.close()})()}declineVisitor(e){var o=this;return(0,d.Z)(function*(){const s=yield(0,p._5)({title:"Decline Visitor",content:`Decline attendance of ${e.asset_name||e.asset_id} to their meeting?`,icon:{content:"event_available"}},o._dialog);if("done"!==s.reason)return s.close();s.loading("Updating guest details"),yield(0,h.FP)(e.id).toPromise().catch(i=>{throw(0,p.cB)(`Error declining visitor: ${i.message||i.error||i}`),s.close(),i}),(0,p.t5)("Successfully declining visitor"),o._poll.next(Date.now()),s.close()})()}setCheckinState(e,o=!0){return(0,d.Z)(function*(){yield(0,h.FD)(e.id,o).toPromise().catch(i=>{throw(0,p.cB)(`Error checking ${o?"in":"out"} ${e.asset_name||e.asset_id} for ${e.user_name}'s meeting`),i}),(0,p.t5)(`Successfully checked ${o?"in":"out"} ${e.asset_name||e.asset_id} from ${e.user_name}'s meeting`)})()}downloadVisitorsList(){var e=this;return(0,d.Z)(function*(){const o=yield e.filtered_bookings.pipe((0,j.q)(1)).toPromise();if(!o.length)return;const{date:s}=e._filters.getValue(),i=o.map(c=>({Name:c.asset_name,Email:c.asset_id,"Checked In":c.checked_in,Host:c.user_email||"",Status:c.status,Date:(0,A.Z)(c.date,"dd MMM "+e.time_format)})),r=(0,p.o3)(i);(0,p.Sv)(`visitor-list-${(0,A.Z)(s||Date.now(),"MMM-dd")}.csv`,r)})()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(w.uw),t.LFG(Z.w7),t.LFG(p.gb))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var W=l(4945),L=l(6297),$=l(5670),J=l(8441),N=l(9396),G=l(8750),U=l(6508),T=l(7728);function X(n,a){if(1&n&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.display_name||e.name," ")}}let B=(()=>{class n extends p.cx{constructor(e,o,s,i){super(),this._state=e,this._org=o,this._route=s,this._router=i,this.zones=[],this.levels=this._org.active_levels,this.filters=this._state.filters,this.setDate=r=>this._state.setFilters({date:r}),this.setFilters=r=>this._state.setFilters(r),this.setSearch=r=>this._state.setSearchString(r),this.updateZones=r=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:r.join(",")}}),this._state.setFilters({zones:r})}}ngOnInit(){var e=this;return(0,d.Z)(function*(){yield e._org.initialised.pipe((0,$.P)(o=>o)).toPromise(),e.subscription("route.query",e._route.queryParamMap.subscribe(o=>{if(o.has("zone_ids")){const s=o.get("zone_ids").split(",");if(s.length){const i=e._org.levelWithID(s);if(e.zones=s,!i)return;e._org.building=e._org.buildings.find(r=>r.id===i.parent_id)}}})),e.subscription("levels",e._org.active_levels.subscribe(o=>{e.zones=e.zones.filter(s=>o.find(i=>i.id===s)),!e.zones.length&&o.length&&e.zones.push(o[0].id),e.updateZones(e.zones)})),e.setSearch("")})()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(C),t.Y36(Z.w7),t.Y36(g.gz),t.Y36(g.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["visitors-topbar"]],features:[t.qOj],decls:17,vars:10,consts:[[1,"flex","items-center","bg-base-100","h-20","px-4","border-b","border-base-200","space-x-2"],["appearance","outline"],["multiple","","placeholder","All Levels",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Viewing Period",3,"ngModel","ngModelChange"],[3,"value"],[1,"flex-1","w-2"],[1,"mr-2",3,"modelChange"],[3,"dateChange"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-select",2),t.NdJ("ngModelChange",function(i){return o.zones=i})("ngModelChange",function(i){return o.updateZones(i)}),t.YNc(3,X,2,2,"mat-option",3),t.ALo(4,"async"),t.qZA()(),t.TgZ(5,"mat-form-field",1)(6,"mat-select",4),t.NdJ("ngModelChange",function(i){return o.setFilters({period:i})}),t.ALo(7,"async"),t.TgZ(8,"mat-option",5),t._uU(9,"Show Day"),t.qZA(),t.TgZ(10,"mat-option",5),t._uU(11,"Show Week"),t.qZA(),t.TgZ(12,"mat-option",5),t._uU(13,"Show Month"),t.qZA()()(),t._UZ(14,"div",6),t.TgZ(15,"searchbar",7),t.NdJ("modelChange",function(i){return o.setSearch(i)}),t.qZA(),t.TgZ(16,"date-options",8),t.NdJ("dateChange",function(i){return o.setDate(i)}),t.qZA()()),2&e){let s;t.xp6(2),t.Q6J("ngModel",o.zones),t.xp6(1),t.Q6J("ngForOf",t.lcZ(4,6,o.levels)),t.xp6(3),t.Q6J("ngModel",(null==(s=t.lcZ(7,8,o.filters))?null:s.period)||1),t.xp6(2),t.Q6J("value",1),t.xp6(2),t.Q6J("value",7),t.xp6(2),t.Q6J("value",30)}},dependencies:[m.sg,_.JJ,_.On,J.E,N.U,G.KE,U.gD,T.ey,m.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em}\n/*# sourceMappingURL=visitors-topbar.component.ts-angular-inline--111.css.map*/"]}),n})();var b=l(9314),q=l(2423),tt=l(1637),et=l(5306),nt=l(1110),ot=l(3970);function it(n,a){1&n&&(t.TgZ(0,"i",14),t._uU(1,"face"),t.qZA())}function st(n,a){1&n&&(t.TgZ(0,"i",15),t._uU(1,"done"),t.qZA())}function at(n,a){if(1&n&&(t.YNc(0,it,2,0,"i",10),t.TgZ(1,"div",11)(2,"app-icon",12),t._uU(3," event_available "),t.qZA()(),t.YNc(4,st,2,0,"ng-template",null,13,t.W1O)),2&n){const e=a.row,o=t.MAs(5);t.Q6J("ngIf",!(null!=e&&e.checked_in))("ngIfElse",o),t.xp6(1),t.ekj("pointer-events-none",!e.linked_event),t.xp6(1),t.ekj("opacity-0",!e.linked_event)}}function lt(n,a){if(1&n&&t._uU(0),2&n){const e=a.row;t.hij(" ",null==e.extension_data?null:e.extension_data.host," ")}}function rt(n,a){if(1&n&&(t.TgZ(0,"button",19),t._uU(1),t.qZA()),2&n){const e=t.oxw().row;t.xp6(1),t.hij(" ",null!=e.extension_data&&e.extension_data.vaccination_confirmed?"Confirmed":!1===(null==e.extension_data?null:e.extension_data.vaccination_confirmed)?"Rejected":"Submitted"," ")}}function ct(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",20),t._UZ(1,"img",21),t.TgZ(2,"button",22),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().row,i=t.oxw();return t.KtG(i.setExt(s,"vaccination_confirmed",!0))}),t._uU(3," Confirm Vaccination Proof "),t.qZA(),t.TgZ(4,"button",23),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().row,i=t.oxw();return t.KtG(i.setExt(s,"vaccination_confirmed",!1))}),t._uU(5," Reject Vaccination Proof "),t.qZA()()}if(2&n){const e=t.oxw().row;t.xp6(1),t.Q6J("src",null==e.extension_data||null==e.extension_data.vaccination_proof?null:e.extension_data.vaccination_proof.url,t.LSH)}}function pt(n,a){if(1&n&&(t.TgZ(0,"div",16),t.YNc(1,rt,2,1,"button",17),t.qZA(),t.YNc(2,ct,6,1,"ng-template",null,18,t.W1O)),2&n){const e=a.row,o=t.MAs(3);t.Q6J("content",o),t.xp6(1),t.Q6J("ngIf",null==e.extension_data||null==e.extension_data.vaccination_proof?null:e.extension_data.vaccination_proof.url)}}function mt(n,a){if(1&n&&(t.TgZ(0,"button",19),t._uU(1),t.qZA()),2&n){const e=t.oxw().row;t.xp6(1),t.hij(" ",null!=e.extension_data&&e.extension_data.id_confirmed?"Confirmed":!1===(null==e.extension_data?null:e.extension_data.id_confirmed)?"Rejected":"Submitted"," ")}}function ut(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",20),t._UZ(1,"img",25),t.TgZ(2,"button",22),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().row,i=t.oxw();return t.KtG(i.setExt(s,"id_confirmed",!0))}),t._uU(3," Confirm ID "),t.qZA(),t.TgZ(4,"button",23),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().row,i=t.oxw();return t.KtG(i.setExt(s,"id_confirmed",!1))}),t._uU(5," Reject ID "),t.qZA()()}if(2&n){const e=t.oxw().row;t.xp6(1),t.Q6J("src",null==e.extension_data||null==e.extension_data.id_data?null:e.extension_data.id_data.url,t.LSH)}}function dt(n,a){if(1&n&&(t.TgZ(0,"div",16),t.YNc(1,mt,2,1,"button",17),t.qZA(),t.YNc(2,ut,6,1,"ng-template",null,24,t.W1O)),2&n){const e=a.row,o=t.MAs(3);t.Q6J("content",o),t.xp6(1),t.Q6J("ngIf",null==e.extension_data||null==e.extension_data.id_data?null:e.extension_data.id_data.url)}}function _t(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",26)(1,"div",27)(2,"div",28),t._uU(3),t.qZA(),t.TgZ(4,"app-icon",12),t._uU(5,"arrow_drop_down"),t.qZA()()(),t.TgZ(6,"mat-menu",null,29)(8,"button",30),t.NdJ("click",function(){const i=t.CHM(e).row,r=t.oxw();return t.KtG(r.approveVisitor(i))}),t._uU(9," Approve Visitor "),t.qZA(),t.TgZ(10,"button",30),t.NdJ("click",function(){const i=t.CHM(e).row,r=t.oxw();return t.KtG(r.declineVisitor(i))}),t._uU(11," Decline Visitor "),t.qZA()()}if(2&n){const e=a.row,o=t.MAs(7);t.ekj("!text-success-content","approved"===(null==e?null:e.status))("!bg-success","approved"===(null==e?null:e.status))("!text-error-content","declined"===(null==e?null:e.status))("!bg-error","declined"===(null==e?null:e.status)),t.Q6J("matMenuTriggerFor",o),t.xp6(3),t.hij(" ","approved"===(null==e?null:e.status)?"Approved":"declined"===(null==e?null:e.status)?"Declined":"Pending"," ")}}function gt(n,a){if(1&n&&(t._uU(0),t.ALo(1,"date"),t.ALo(2,"async")),2&n){const e=a.row,o=t.oxw();let s;t.hij(" ",t.xi3(1,1,e.date,(null==(s=t.lcZ(2,4,o.filters))?null:s.period)>1?"MMM d, "+o.time_format:o.time_format)," ")}}function ht(n,a){if(1&n&&(t.TgZ(0,"a",38),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("href",e.url,t.LSH),t.xp6(1),t.Oqu(e.name)}}function ft(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",31)(1,"app-icon"),t._uU(2,"attachment"),t.qZA()(),t.TgZ(3,"mat-menu",null,29),t.YNc(5,ht,2,2,"a",32),t.qZA(),t.TgZ(6,"action-icon",33),t.NdJ("click",function(){const i=t.CHM(e).row,r=t.oxw();return t.KtG(r.setExt(i,"remote",!i.extension_data.remote))}),t.qZA(),t.TgZ(7,"action-icon",34),t.NdJ("click",function(){const i=t.CHM(e).row,r=t.oxw();return t.KtG(r.checkin(i))}),t.qZA(),t.TgZ(8,"action-icon",35),t.NdJ("click",function(){const i=t.CHM(e).row,r=t.oxw();return t.KtG(r.checkout(i))}),t.qZA(),t.TgZ(9,"a",36)(10,"app-icon"),t._uU(11,"email"),t.qZA()(),t.TgZ(12,"action-icon",37),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.printQRCode())}),t.qZA()}if(2&n){const e=a.row,o=t.MAs(4),s=t.oxw();t.Q6J("disabled",!(null!=e.attachments&&e.attachments.length))("matMenuTriggerFor",o),t.xp6(5),t.Q6J("ngForOf",e.attachments),t.xp6(1),t.Q6J("matTooltip",e.extension_data.remote?"Set as In-Person Visitor":"Set as Remote Visitior")("loading","remote"===s.loading)("content",e.extension_data.remote?"tap_and_play":"business"),t.xp6(1),t.Q6J("loading","checkin"===s.loading)("state",null!=e&&e.checked_in?"success":""),t.xp6(1),t.Q6J("loading","checkout"===s.loading),t.xp6(1),t.Q6J("href","mailto:"+(null==e?null:e.asset_id),t.LSH)("matTooltip",(null==e?null:e.user_email)===(null==e?null:e.asset_id)?"Email Host":"Email Guest"),t.xp6(3),t.ekj("invisible",!s.can_print),t.Q6J("loading","printing"===s.loading)}}function vt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.downloadVisitorList())}),t.TgZ(1,"app-icon"),t._uU(2,"download"),t.qZA()()}}const xt=function(n,a,e,o,s,i){return{state:n,status:a,date:e,host:o,id_data:s,actions:i}};let F=(()=>{class n{get columns(){return["state","date","asset_name","user_name","asset_id","status","actions"]}get display_columns(){const e={state:" ",date:"Time",asset_name:"Person",user_name:"Host",asset_id:"Email",id_data:"ID",status:"State",actions:" "};return this.columns.map(o=>e[o]||o)}get column_sizes(){const e={state:"6r",date:"8r",asset_name:"12r",user_name:"12r",asset_id:"flex",id_data:"8r",status:"10r",actions:"12r"};return this.columns.map(o=>e[o]||o)}get time_format(){return this._settings.time_format}constructor(e,o){var s=this;this._state=e,this._settings=o,this.guests=this._state.filtered_bookings,this.search=this._state.search,this.filters=this._state.filters,this.downloadVisitorList=()=>this._state.downloadVisitorsList(),this.approveVisitor=i=>this._state.approveVisitor(i),this.declineVisitor=i=>this._state.declineVisitor(i),this.setExt=(i,r,c)=>this._state.setExt(i,r,c),this.checkin=function(){var i=(0,d.Z)(function*(r){yield s._state.setCheckinState(r,!0),s._state.poll()});return function(r){return i.apply(this,arguments)}}(),this.checkout=function(){var i=(0,d.Z)(function*(r){yield s._state.setCheckinState(r,!1),s._state.poll()});return function(r){return i.apply(this,arguments)}}()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(C),t.Y36(p.gb))},n.\u0275cmp=t.Xpm({type:n,selectors:[["guest-listings"]],decls:20,vars:21,consts:[[1,"w-full","flex","flex-col","flex-1","text-sm","h-full","overflow-auto","pb-20"],[1,"min-w-[72rem]",3,"dataSource","filter","columns","display_column","column_size","template","empty"],["state_template",""],["host_template",""],["vaccinated_template",""],["id_template",""],["status_template",""],["date_template",""],["action_template",""],["class","bg-secondary hover:shadow-lg shadow absolute bottom-4 right-4 text-white h-12 w-12","matTooltip","Download Visitor List","matTooltipPosition","left","icon","","matRipple","",3,"click",4,"ngIf"],["matTooltip","Not checked in","class","p-2 rounded-full material-icons border-2 border-dotted border-base-200",4,"ngIf","ngIfElse"],["matTooltip","Linked to Room Booking",1,"px-2"],[1,"text-2xl"],["checkin_state",""],["matTooltip","Not checked in",1,"p-2","rounded-full","material-icons","border-2","border-dotted","border-base-200"],["matTooltip","Checked In",1,"p-2","rounded-full","material-icons","bg-success","border-2","border-green-600","text-white"],["customTooltip","",3,"content"],["matRipple","","class","bg-success rounded-3xl px-4 py-2 text-white",4,"ngIf"],["vaccine_confirmation",""],["matRipple","",1,"bg-success","rounded-3xl","px-4","py-2","text-white"],[1,"bg-base-100","rounded","p-2","flex","flex-col","space-y-2","my-2","w-[20rem]"],[1,"max-w-[20rem]","max-h-[20rem]","p-2","object-contain",3,"src"],["matRipple","",3,"click"],["matRipple","",1,"inverse","mt-2",3,"click"],["id_confirmation",""],[1,"max-w-[20rem]","max-h-[20rem]","object-contain",3,"src"],["matRipple","",1,"rounded-3xl","bg-warning","text-warning-content","border-none",3,"matMenuTriggerFor"],[1,"flex","items-center"],[1,"mx-2"],["menu","matMenu"],["mat-menu-item","",3,"click"],["icon","","matRipple","","title","","matTooltip","View Attachments",3,"disabled","matMenuTriggerFor"],["mat-menu-item","",3,"href",4,"ngFor","ngForOf"],["remote","",3,"matTooltip","loading","content","click"],["checkin","","matTooltip","Checkin Guest","content","event_available",3,"loading","state","click"],["checkout","","matTooltip","Checkout Guest","content","event_busy",3,"loading","click"],["icon","","matRipple","",3,"href","matTooltip"],["matTooltip","Print QR Code","content","event_busy",3,"loading","click"],["mat-menu-item","",3,"href"],["matTooltip","Download Visitor List","matTooltipPosition","left","icon","","matRipple","",1,"bg-secondary","hover:shadow-lg","shadow","absolute","bottom-4","right-4","text-white","h-12","w-12",3,"click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0),t._UZ(1,"custom-table",1),t.ALo(2,"async"),t.ALo(3,"async"),t.qZA(),t.YNc(4,at,6,6,"ng-template",null,2,t.W1O),t.YNc(6,lt,1,1,"ng-template",null,3,t.W1O),t.YNc(8,pt,4,2,"ng-template",null,4,t.W1O),t.YNc(10,dt,4,2,"ng-template",null,5,t.W1O),t.YNc(12,_t,12,10,"ng-template",null,6,t.W1O),t.YNc(14,gt,3,6,"ng-template",null,7,t.W1O),t.YNc(16,ft,13,14,"ng-template",null,8,t.W1O),t.YNc(18,vt,3,0,"button",9),t.ALo(19,"async")),2&e){const s=t.MAs(5),i=t.MAs(7),r=t.MAs(11),c=t.MAs(13),f=t.MAs(15),u=t.MAs(17);let v;t.xp6(1),t.Q6J("dataSource",o.guests)("filter",t.lcZ(2,8,o.search))("columns",o.columns)("display_column",o.display_columns)("column_size",o.column_sizes)("template",t.HTZ(14,xt,s,c,f,i,r,u))("empty",t.lcZ(3,10,o.search)?"No matching visitors":"There are visitors for the currently selected date."),t.xp6(17),t.Q6J("ngIf",null==(v=t.lcZ(19,12,o.guests))?null:v.length)}},dependencies:[m.sg,m.O5,b.VK,b.OP,b.p6,q.gM,T.wG,tt.m,et.o,nt.C,ot.X,m.Ov,m.uU]}),n})();const Ct=["app-visitors",""];function Tt(n,a){1&n&&t._UZ(0,"mat-progress-bar",4)}let Zt=(()=>{class n{constructor(e){this._state=e,this.loading=this._state.loading,this.filters=this._state.filters}ngOnInit(){this._state.startPolling()}ngOnDestroy(){this._state.stopPolling()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(C))},n.\u0275cmp=t.Xpm({type:n,selectors:[["","app-visitors",""]],attrs:Ct,decls:6,vars:3,consts:[[1,"relative","w-full","flex","flex-col","bg-base-200"],[1,"w-full"],[1,"w-full","flex-1","h-0"],["class","w-full","mode","indeterminate",4,"ngIf"],["mode","indeterminate",1,"w-full"]],template:function(e,o){1&e&&(t._UZ(0,"sidebar"),t.TgZ(1,"main",0),t._UZ(2,"visitors-topbar",1)(3,"guest-listings",2),t.YNc(4,Tt,1,0,"mat-progress-bar",3),t.ALo(5,"async"),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",t.lcZ(5,1,o.loading)))},dependencies:[m.O5,W.k,L.pW,B,F,m.Ov],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%}\n/*# sourceMappingURL=visitors.component.ts-angular-inline--110.css.map*/"]}),n})();var wt=l(9761);let bt=(()=>{class n{constructor(e){this._dialog_ref=e}onDone(){this._dialog_ref.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(w.so))},n.\u0275cmp=t.Xpm({type:n,selectors:[["invite-visitor-modal"]],decls:2,vars:0,consts:[[1,"relative","min-w-[40rem]","min-h-[40rem]"],[3,"done"]],template:function(e,o){1&e&&(t.TgZ(0,"main",0)(1,"invite-visitor-form",1),t.NdJ("done",function(){return o.onDone()}),t.qZA()())},dependencies:[wt.C]}),n})();var yt=l(6866),Mt=l(3320);const Vt=["app-new-visitors",""];function At(n,a){if(1&n&&(t.TgZ(0,"mat-option",14),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.display_name||e.name," ")}}function Lt(n,a){1&n&&t._UZ(0,"mat-progress-bar",15)}const Jt=[{path:"",component:Zt},{path:"new",component:(()=>{class n{constructor(e,o,s,i,r){this._state=e,this._org=o,this._router=s,this._route=i,this._dialog=r,this.loading=this._state.loading,this.filters=this._state.filters,this.zones=[],this.levels=this._org.active_levels,this.setDate=c=>this._state.setFilters({date:c}),this.setFilters=c=>this._state.setFilters(c),this.setSearch=c=>this._state.setSearchString(c),this.updateZones=c=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:c.join(",")}}),this._state.setFilters({zones:c})}}inviteVisitor(){this._dialog.open(bt)}ngOnInit(){this._state.startPolling()}ngOnDestroy(){this._state.stopPolling()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(C),t.Y36(Z.w7),t.Y36(g.F0),t.Y36(g.gz),t.Y36(w.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["","app-new-visitors",""]],attrs:Vt,decls:21,vars:7,consts:[[1,"flex","flex-1","h-px"],[1,"flex","flex-col","flex-1","w-1/2","h-full"],[1,"flex","items-center","p-4","space-x-2"],[1,"text-2xl","font-medium"],[1,"flex-1","w-2"],[3,"dateChange"],["btn","","matRipple","",3,"click"],[1,"flex","items-center","px-4","pb-4"],["appearance","outline",1,"no-subscript"],["multiple","","placeholder","All Levels",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"modelChange"],[1,"w-full","flex-1","h-0"],["class","w-full","mode","indeterminate",4,"ngIf"],[3,"value"],["mode","indeterminate",1,"w-full"]],template:function(e,o){1&e&&(t._UZ(0,"app-topbar"),t.TgZ(1,"div",0),t._UZ(2,"app-sidebar"),t.TgZ(3,"main",1)(4,"div",2)(5,"h2",3),t._uU(6,"Visitors"),t.qZA(),t._UZ(7,"div",4),t.TgZ(8,"date-options",5),t.NdJ("dateChange",function(i){return o.setDate(i)}),t.qZA(),t.TgZ(9,"button",6),t.NdJ("click",function(){return o.inviteVisitor()}),t._uU(10," Invite Visitor "),t.qZA()(),t.TgZ(11,"div",7)(12,"mat-form-field",8)(13,"mat-select",9),t.NdJ("ngModelChange",function(i){return o.zones=i})("ngModelChange",function(i){return o.updateZones(i)}),t.YNc(14,At,2,2,"mat-option",10),t.ALo(15,"async"),t.qZA()(),t._UZ(16,"div",4),t.TgZ(17,"searchbar",11),t.NdJ("modelChange",function(i){return o.setSearch(i)}),t.qZA()(),t._UZ(18,"guest-listings",12),t.YNc(19,Lt,1,0,"mat-progress-bar",13),t.ALo(20,"async"),t.qZA()()),2&e&&(t.xp6(13),t.Q6J("ngModel",o.zones),t.xp6(1),t.Q6J("ngForOf",t.lcZ(15,3,o.levels)),t.xp6(5),t.Q6J("ngIf",t.lcZ(20,5,o.loading)))},dependencies:[m.sg,m.O5,_.JJ,_.On,J.E,N.U,yt.O,Mt.u,G.KE,U.gD,T.ey,L.pW,T.wG,F,m.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}\n/*# sourceMappingURL=new-visitors.component.ts-angular-inline--112.css.map*/"]}),n})()}];let Nt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,_.u5,S.v,h.EP,g.Bz.forChild(Jt)]}),n})()}}]);
//# sourceMappingURL=apps_concierge_src_app_visitors_visitors_module_ts.js.map