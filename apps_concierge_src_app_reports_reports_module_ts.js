(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_reports_reports_module_ts"],{5780:(Se,fe,R)=>{"use strict";R.r(fe),R.d(fe,{ReportsModule:()=>ln});var I=R(6362),B=R(587),k=R(9481),t=R(2656),L=R(9861),e=R(3184),r=R(4945),a=R(3294),d=R(1130),n=R(5306);const i=function(){return["/reports","desks"]};function c(s,g){1&s&&(e.TgZ(0,"a",1),e.TgZ(1,"app-icon",2),e._uU(2,"room"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Desks"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA(),e.qZA(),e.qZA()),2&s&&e.Q6J("routerLink",e.DdM(1,i))}const f=function(){return["/reports","spaces"]};function p(s,g){1&s&&(e.TgZ(0,"a",1),e.TgZ(1,"app-icon",2),e._uU(2,"meeting_room"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Rooms"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA(),e.qZA(),e.qZA()),2&s&&e.Q6J("routerLink",e.DdM(1,f))}const u=function(){return["/reports","catering"]};function v(s,g){1&s&&(e.TgZ(0,"a",1),e.TgZ(1,"app-icon",2),e._uU(2,"room_service"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Catering"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA(),e.qZA(),e.qZA()),2&s&&e.Q6J("routerLink",e.DdM(1,u))}const x=function(){return["/reports","contact-tracing"]};function A(s,g){1&s&&(e.TgZ(0,"a",1),e.TgZ(1,"app-icon",2),e._uU(2,"connect_without_contact"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Contact Tracing"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA(),e.qZA(),e.qZA()),2&s&&e.Q6J("routerLink",e.DdM(1,x))}const T=["desks","spaces","catering","contact-tracing"];let S=(()=>{class s{constructor(o){this._settings=o}get features(){return this._settings.get("app.reports.features")||T}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(a.gb))},s.\u0275cmp=e.Xpm({type:s,selectors:[["reports-menu"],["","reports-menu",""]],decls:4,vars:4,consts:[["matRipple","","class","h-64 w-64 m-4 p-4 flex flex-col items-center justify-center bg-white rounded shadow hover:bg-gray-100",3,"routerLink",4,"ngIf"],["matRipple","",1,"h-64","w-64","m-4","p-4","flex","flex-col","items-center","justify-center","bg-white","rounded","shadow","hover:bg-gray-100",3,"routerLink"],[1,"text-8xl"],[1,"text-xl","font-bold","mb-4"],[1,"flex","items-center"],[1,"ml-2"]],template:function(o,l){1&o&&(e.YNc(0,c,10,2,"a",0),e.YNc(1,p,10,2,"a",0),e.YNc(2,v,10,2,"a",0),e.YNc(3,A,10,2,"a",0)),2&o&&(e.Q6J("ngIf",l.features.includes("desks")),e.xp6(1),e.Q6J("ngIf",l.features.includes("spaces")),e.xp6(1),e.Q6J("ngIf",l.features.includes("catering")),e.xp6(1),e.Q6J("ngIf",l.features.includes("contact-tracing")))},directives:[I.O5,k.yS,d.wG,n.o],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;background:var(--bg)}\n/*# sourceMappingURL=reports-menu.component.ts-angular-inline--75.css.map*/"]}),s})();const q=["app-reports",""];function Q(s,g){1&s&&e._UZ(0,"div",3)}let P=(()=>{class s{constructor(o){this._router=o}get path(){const o=this._router.url.split("/");return o[o.length-1]}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(k.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["","app-reports",""]],attrs:q,decls:4,vars:1,consts:[[1,"h-full"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full"],["reports-menu","","class","absolute inset-0",4,"ngIf"],["reports-menu","",1,"absolute","inset-0"]],template:function(o,l){1&o&&(e._UZ(0,"sidebar",0),e.TgZ(1,"main",1),e._UZ(2,"router-outlet"),e.YNc(3,Q,1,0,"div",2),e.qZA()),2&o&&(e.xp6(3),e.Q6J("ngIf","reports"===l.path))},directives:[r.k,k.lC,I.O5,S],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%;background:var(--bg)}\n/*# sourceMappingURL=reports.component.ts-angular-inline--72.css.map*/"]}),s})();var O=R(3985),M=R(6862),w=R(6942),z=R(3499),j=R(4099),_=R(8426),Z=R(3619),U=R(9377),N=R(3200),F=R(475),X=R(312),D=R(8325),Y=R(6610),V=R(1170),W=864e5;function ge(s,g){(0,V.Z)(2,arguments);var o=(0,U.Z)(s),l=(0,U.Z)(g),h=o.getTime()-(0,Y.Z)(o),m=l.getTime()-(0,Y.Z)(l);return Math.round((h-m)/W)}function ae(s,g){var o=s.getFullYear()-g.getFullYear()||s.getMonth()-g.getMonth()||s.getDate()-g.getDate()||s.getHours()-g.getHours()||s.getMinutes()-g.getMinutes()||s.getSeconds()-g.getSeconds()||s.getMilliseconds()-g.getMilliseconds();return o<0?-1:o>0?1:o}function le(s,g){(0,V.Z)(2,arguments);var o=(0,D.Z)(s),l=(0,D.Z)(g),h=ae(o,l),m=Math.abs(ge(o,l));o.setDate(o.getDate()-h*m);var y=Number(ae(o,l)===-h),b=h*(m-y);return 0===b?0:b}var ze=R(2317),oe=R(5148),Ne=R(2218),de=R(4505),ce=R(4139),te=R(7716),me=R(823),Ze=R(9095),he=R(7418),ee=R(9128);let C=(()=>{class s{constructor(o){this._org=o,this._generate=new Ne.xQ,this._loading=new de.X(""),this._active_bookings=new de.X([]),this._options=new de.X({start:new Date,end:new Date}),this._bookings_list=this._generate.pipe((0,me.b)(500),(0,Ze.w)(l=>{var h;const m=this._options.getValue();if(this._loading.next("Loading report details..."),!(null==m?void 0:m.type)&&!(null===(h=null==m?void 0:m.zones)||void 0===h?void 0:h.length))return(0,ce.of)([]);const y=(0,U.Z)((null==m?void 0:m.start)?new Date(m.start):new Date).valueOf(),b=(0,N.Z)((null==m?void 0:m.end)?new Date(m.end):y).valueOf(),E=(null==m?void 0:m.zones)?m.zones.filter(G=>"All"!==G).join(","):"",J={period_start:Math.floor(y/1e3),period_end:Math.floor(b/1e3)};return"desks"===m.type?(0,j.F2)(Object.assign(Object.assign({},J),{zones:E,type:"desk"})):(0,_.u$)(Object.assign(Object.assign({},J),{zone_ids:E}))}),(0,he.K)(l=>[]),(0,w.U)(l=>(this._loading.next(""),(null==l?void 0:l.length)||(0,a.cB)("No bookings for the selected levels and period"),this._active_bookings.next(l||[]),l)),(0,ee.d)()),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.bookings=this._active_bookings.asObservable(),this.counts=this._options.pipe((0,me.b)(500),(0,Ze.w)(l=>{const h=(l.zones||[]).filter(m=>-1!==m&&"All"!==m);return Promise.all(h.map(m=>(0,z.rlq)(m,"desks").pipe((0,w.U)(y=>[m,y.details.length])).toPromise()))}),(0,he.K)(l=>[]),(0,w.U)(l=>{const h={};return this._active_bookings.next([]),l.forEach(([m,y])=>h[m]=y),h}),(0,ee.d)()),this.stats=(0,te.aj)([this.counts,this.bookings]).pipe((0,w.U)(([l,h])=>h[0]instanceof _.ym?function ke(s,g=8){const o=s.reduce((y,b)=>y+b.attendees.length,0),l=s.reduce((y,b)=>{var E;return y+(null===(E=b.system)||void 0===E?void 0:E.capacity)},0),h=Math.floor(s.reduce((y,b)=>y+b.duration,0)/(60*g)*100)/100,m=Math.floor(o/l*100)/100;return{count:s.length,avg_length:Math.floor(s.reduce((y,b)=>y+b.duration,0)/s.length*100)/100,efficiency:Math.floor((h+m)/2*100)/100,total_users:o,total_capacity:l,occupancy:m,utilisation:h,events:s}}(h,8*this.duration):function qe(s,g=1,o={}){g=Math.max(1,g);const l=Object.keys(o).reduce((m,y)=>m+(o[y]||0),0),h=Math.floor(s.length/l/g*1e4)/1e4;return{total:l,count:s.length,utilisation:h,events:s}}(h||[],this.duration,l))),this.day_list=(0,te.aj)([this.options,this.stats]).pipe((0,w.U)(([l,h])=>{const{start:m}=l;let y=(0,U.Z)(m);const b=(0,N.Z)(l.end||y),E=[];for(;(0,F.Z)(y,b);){const J=(0,U.Z)(y).valueOf(),G=(0,N.Z)(J).valueOf(),$=h.events.filter(H=>(0,a.MZ)(J,G,H.date,H.date+60*H.duration*1e3));E.push({date:J,total:h.total,free:h.total-$.length,approved:$.reduce((H,se)=>H+(se.approved?1:0),0),count:$.length,utilisation:($.length/h.total*100).toFixed(1)}),y=(0,X.Z)(y,1)}return E}),(0,ee.d)(1)),this._bookings_list.subscribe(l=>l)}get duration(){const o=this._options.getValue();return Math.abs(le((0,U.Z)(o.start),(0,ze.Z)((0,N.Z)(o.end),1)))}generateReport(){this._generate.next((new Date).valueOf())}setOptions(o){var l,h,m,y,b,E,J;(null===(l=o.zones)||void 0===l?void 0:l.includes("All"))?o.zones=["All",...this._org.levelsForBuilding(this._org.building).map(G=>G.id)]:o.zones&&(null===(m=null===(h=this._options.getValue())||void 0===h?void 0:h.zones)||void 0===m?void 0:m.includes("All"))&&(o.zones=[]),(null===(y=o.start)||void 0===y?void 0:y.valueOf())!==(null===(b=this._options.getValue().start)||void 0===b?void 0:b.valueOf())&&(null===(E=o.end)||void 0===E?void 0:E.valueOf())!==(null===(J=this._options.getValue().end)||void 0===J?void 0:J.valueOf())&&this._options.next(Object.assign(Object.assign({},this._options.getValue()),o))}downloadReport(){const o=this._options.getValue(),l=this._active_bookings.getValue();(0,a.Sv)(`report+${o.type}+${(0,oe.Z)(o.start,"yyyy-MM-dd")}+${(0,oe.Z)(o.end,"yyyy-MM-dd")}.csv`,(0,a.o3)(l.map(h=>{const m=h.toJSON();return delete m.zones,delete m.server_names,delete m.extension_data,m})))}}return s.\u0275fac=function(o){return new(o||s)(e.LFG(Z.w7))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var ne=R(4929),De=R(5670),ve=R(4770),je=R(1434),K=R(5818),ue=R(7317),_e=R(4742);function Pe(s,g){if(1&s&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&s){const o=g.$implicit;e.Q6J("value",o.id),e.xp6(1),e.hij(" ",o.display_name||o.name," ")}}function Ie(s,g){1&s&&e._UZ(0,"mat-spinner",14),2&s&&e.Q6J("diameter",32)}function Ye(s,g){1&s&&(e.TgZ(0,"p"),e._uU(1,"Generate Report"),e.qZA())}let Ae=(()=>{class s extends a.KG{constructor(o,l,h,m){super(),this._state=o,this._org=l,this._route=h,this._router=m,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(y=>`${y.id}`),this.levels=this._org.active_levels,this.loading=this._state.loading,this.bookings=this._state.bookings,this.options=this._state.options,this.page="",this.generateReport=()=>this._state.generateReport(),this.downloadReport=()=>this._state.downloadReport(),this.setStartDate=y=>this._state.setOptions({start:new Date(y)}),this.setEndDate=y=>this._state.setOptions({end:new Date(y)}),this.setZones=y=>this._state.setOptions({zones:y})}ngOnInit(){return(0,ne.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,De.P)(o=>o)).toPromise(),this.page=this._router.url,this.subscription("routing",this._router.events.subscribe(()=>{this.page=this._router.url})),this.subscription("route.query",this._route.queryParamMap.subscribe(o=>{if(o.has("zone_ids")){const l=o.get("zone_ids").split(",");if(l.length){const h=this._org.levelWithID(l);if(!h)return;this._org.building=this._org.buildings.find(m=>m.id===h.parent_id),this.setZones(l)}}}))})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C),e.Y36(Z.w7),e.Y36(k.gz),e.Y36(k.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["reports-options"]],features:[e.qOj],decls:27,vars:28,consts:[["appearance","outline",1,"w-48"],["multiple","","placeholder","Select Levels...",3,"ngModel","ngModelChange"],["value","All"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"w-64"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["mat-button","",1,"ml-4",3,"disabled","click"],[3,"diameter",4,"ngIf"],[4,"ngIf"],[3,"value"],[3,"diameter"]],template:function(o,l){if(1&o&&(e.TgZ(0,"mat-form-field",0),e.TgZ(1,"mat-select",1),e.NdJ("ngModelChange",function(m){return l.setZones(m)}),e.ALo(2,"async"),e.TgZ(3,"mat-option",2),e._uU(4,"All Levels"),e.qZA(),e.YNc(5,Pe,2,2,"mat-option",3),e.ALo(6,"async"),e.qZA(),e.qZA(),e.TgZ(7,"mat-form-field",4),e.TgZ(8,"mat-date-range-input",5),e.TgZ(9,"input",6),e.NdJ("ngModelChange",function(m){return m?l.setStartDate(m):""}),e.ALo(10,"async"),e.qZA(),e.TgZ(11,"input",7),e.NdJ("ngModelChange",function(m){return m?l.setEndDate(m):""}),e.ALo(12,"async"),e.qZA(),e.qZA(),e._UZ(13,"mat-datepicker-toggle",8),e._UZ(14,"mat-date-range-picker",null,9),e.qZA(),e.TgZ(16,"button",10),e.NdJ("click",function(){return l.generateReport()}),e.ALo(17,"async"),e.ALo(18,"async"),e.YNc(19,Ie,1,1,"mat-spinner",11),e.ALo(20,"async"),e.YNc(21,Ye,2,0,"p",12),e.ALo(22,"async"),e.qZA(),e.TgZ(23,"button",10),e.NdJ("click",function(){return l.downloadReport()}),e.ALo(24,"async"),e.TgZ(25,"p"),e._uU(26,"Download Report"),e.qZA(),e.qZA()),2&o){const h=e.MAs(15);let m,y,b,E,J;e.xp6(1),e.Q6J("ngModel",null==(m=e.lcZ(2,10,l.options))?null:m.zones),e.xp6(4),e.Q6J("ngForOf",e.lcZ(6,12,l.levels)),e.xp6(3),e.Q6J("rangePicker",h),e.xp6(1),e.Q6J("ngModel",null==(y=e.lcZ(10,14,l.options))?null:y.start),e.xp6(2),e.Q6J("ngModel",null==(b=e.lcZ(12,16,l.options))?null:b.end),e.xp6(2),e.Q6J("for",h),e.xp6(3),e.Q6J("disabled",!!e.lcZ(17,18,l.loading)||!(null!=(E=e.lcZ(18,20,l.options))&&null!=E.zones&&E.zones.length)),e.xp6(3),e.Q6J("ngIf",e.lcZ(20,22,l.loading)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(22,24,l.loading)),e.xp6(2),e.Q6J("disabled",!(null!=(J=e.lcZ(24,26,l.bookings))&&J.length))}},directives:[ve.KE,je.gD,B.JJ,B.On,d.ey,I.sg,K.wx,K.zY,B.Fj,K.By,K.nW,ve.R9,K._g,ue.lW,I.O5,_e.$g],pipes:[I.Ov],styles:["[_nghost-%COMP%]{display:flex;align-items:center;background-color:#fff;height:5em;padding:0 1em}button[_ngcontent-%COMP%]{min-width:0;padding:0 .85rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;margin-left:1em}mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:5.5em;white-space:initial;line-height:1.2em}\n/*# sourceMappingURL=reports-options.component.ts-angular-inline--73.css.map*/"]}),s})();var Be=R(1799);let Fe=(()=>{class s{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,w.U)(l=>l.count||0)),this.avg_length=this._state.stats.pipe((0,w.U)(l=>(0,Be.Z)({minutes:l.avg_length||0}))),this.efficiency=this._state.stats.pipe((0,w.U)(l=>(100*(l.efficiency||0)).toFixed(1))),this.total_users=this._state.stats.pipe((0,w.U)(l=>l.total_users||0)),this.total_capacity=this._state.stats.pipe((0,w.U)(l=>l.total_capacity||0)),this.occupancy=this._state.stats.pipe((0,w.U)(l=>(100*(l.occupancy||0)).toFixed(1))),this.utilisation=this._state.stats.pipe((0,w.U)(l=>(100*(l.utilisation||0)).toFixed(1)))}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C))},s.\u0275cmp=e.Xpm({type:s,selectors:[["report-spaces-overall"]],decls:44,vars:21,consts:[[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"flex-1","flex","flex-col","items-center","justify-center"]],template:function(o,l){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3"),e._uU(3,"Total Bookings"),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"async"),e.qZA(),e.qZA(),e.TgZ(7,"div",1),e.TgZ(8,"h3"),e._uU(9,"Average Bookings Length"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.ALo(12,"async"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",0),e.TgZ(14,"div",2),e.TgZ(15,"h3"),e._uU(16,"Overall Efficiency"),e.qZA(),e.TgZ(17,"p"),e._uU(18),e.ALo(19,"async"),e.qZA(),e.qZA(),e.TgZ(20,"div",2),e.TgZ(21,"h3"),e._uU(22,"Occupancy"),e.qZA(),e.TgZ(23,"p"),e._uU(24),e.ALo(25,"async"),e.qZA(),e.qZA(),e.TgZ(26,"div",2),e.TgZ(27,"h3"),e._uU(28,"Total Attendees"),e.qZA(),e.TgZ(29,"p"),e._uU(30),e.ALo(31,"async"),e.qZA(),e.qZA(),e.TgZ(32,"div",2),e.TgZ(33,"h3"),e._uU(34,"Total Capacity"),e.qZA(),e.TgZ(35,"p"),e._uU(36),e.ALo(37,"async"),e.qZA(),e.qZA(),e.TgZ(38,"div",2),e.TgZ(39,"h3"),e._uU(40,"Utilisation"),e.qZA(),e.TgZ(41,"p"),e._uU(42),e.ALo(43,"async"),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(5),e.Oqu(e.lcZ(6,7,l.total_count)||0),e.xp6(6),e.Oqu(e.lcZ(12,9,l.avg_length)||"None"),e.xp6(7),e.hij("",e.lcZ(19,11,l.efficiency)||0,"%"),e.xp6(6),e.hij("",e.lcZ(25,13,l.occupancy)||0,"%"),e.xp6(6),e.Oqu(e.lcZ(31,15,l.total_users)||0),e.xp6(6),e.Oqu(e.lcZ(37,17,l.total_capacity)||0),e.xp6(6),e.hij("",e.lcZ(43,19,l.utilisation)||0,"%"))},pipes:[I.Ov],styles:["h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n/*# sourceMappingURL=report-spaces-overall.component.ts-angular-inline--76.css.map*/"]}),s})();var ie=R(3910),re=R(1110);const Je=function(){return["name","capacity","count","utilisation","avg_attendees","occupancy"]},Qe=function(){return["Name","Capacity","Meeting Count","Utilisation","Avg. Attendees","Occupancy"]},Ge=function(){return["flex"]};let Xe=(()=>{class s{constructor(o){this._reports=o,this.space_list=(0,te.aj)([this._reports.stats,this._reports.options]).pipe((0,me.b)(300),(0,w.U)(([l,{start:h,end:m}])=>{let y=[];for(const E of l.events){const J=E.resources||[];for(const G of J){y.find(H=>H.id===G.id)||y.push({id:G.id,name:G.display_name||G.name,capacity:G.capacity||1,count:0,attendees:0,avg_attendees:0,usage:0,utilisation:0,occupancy:0});const $=y.find(H=>H.id===G.id);$.count+=1,$.usage+=E.duration,$.attendees+=E.attendees.length}}const b=le(m,h);for(const E of y)E.avg_attendees=Math.floor(E.attendees/E.count*100)/100,E.utilisation=Math.floor(E.usage/60/8/b*100)/100,E.occupancy=Math.floor(E.avg_attendees/E.capacity*100)/100;return y})),this.download=()=>(0,ne.mG)(this,void 0,void 0,function*(){const l=yield this.space_list.pipe((0,ie.q)(1)).toPromise();(0,a.Sv)("report-spaces-usage.csv",(0,a.o3)(l))})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C))},s.\u0275cmp=e.Xpm({type:s,selectors:[["report-spaces-space-listing"]],decls:8,vars:8,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],[3,"dataSource","pagination","columns","display_column","column_size"]],template:function(o,l){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3",2),e._uU(3,"Space Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return l.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(7,"custom-table",4),e.qZA()),2&o&&(e.xp6(7),e.Q6J("dataSource",l.space_list)("pagination",!0)("columns",e.DdM(5,Je))("display_column",e.DdM(6,Qe))("column_size",e.DdM(7,Ge)))},directives:[ue.lW,n.o,re.C],styles:[""]}),s})();const Ve=function(){return["name","capacity","count","avg_attendees","occupancy"]},He=function(){return["Name","Capacity","Meeting Count","Avg. Attendees","Occupancy"]},We=function(){return["flex"]};let Ce=(()=>{class s{constructor(o){this._reports=o,this.user_list=(0,te.aj)([this._reports.stats]).pipe((0,me.b)(300),(0,w.U)(([l])=>{let h=[];for(const m of l.events){const y=m.attendees||[],b=m.resources.reduce((E,J)=>E+J.capacity,0)||1;for(const E of y){h.find(G=>G.email===E.email)||h.push({id:E.email,name:E.name,capacity:b,count:0,attendees:0,avg_attendees:0,occupancy:0});const J=h.find(G=>G.id===E.email);J.count+=1,J.attendees+=m.attendees.length}}for(const m of h)m.avg_attendees=Math.floor(m.attendees/m.count*100)/100,m.occupancy=Math.floor(m.avg_attendees/m.capacity*100)/100;return h}),(0,ee.d)(1)),this.download=()=>(0,ne.mG)(this,void 0,void 0,function*(){const l=yield this.user_list.pipe((0,ie.q)(1)).toPromise();(0,a.Sv)("report-space-attendee-usage.csv",(0,a.o3)(l))})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C))},s.\u0275cmp=e.Xpm({type:s,selectors:[["report-spaces-user-listing"]],decls:8,vars:8,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],[3,"dataSource","pagination","columns","display_column","column_size"]],template:function(o,l){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3",2),e._uU(3,"Staff Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return l.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(7,"custom-table",4),e.qZA()),2&o&&(e.xp6(7),e.Q6J("dataSource",l.user_list)("pagination",!0)("columns",e.DdM(5,Ve))("display_column",e.DdM(6,He))("column_size",e.DdM(7,We)))},directives:[ue.lW,n.o,re.C],styles:[""]}),s})();const $e=["report-spaces",""];function Ke(s,g){1&s&&(e.ynx(0),e._UZ(1,"report-spaces-overall"),e._UZ(2,"report-spaces-space-listing"),e._UZ(3,"report-spaces-user-listing"),e.BQk())}function et(s,g){if(1&s&&(e.ynx(0),e.YNc(1,Ke,4,0,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&s){const o=e.oxw(),l=e.MAs(7);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,o.total_count))("ngIfElse",l)}}function tt(s,g){1&s&&(e.TgZ(0,"div",4),e._UZ(1,"mat-spinner",5),e.TgZ(2,"p",6),e._uU(3,"Loading report data..."),e.qZA(),e.qZA()),2&s&&(e.xp6(1),e.Q6J("diameter",32))}function nt(s,g){1&s&&(e.TgZ(0,"div",4),e.TgZ(1,"p",6),e._uU(2," Select levels and time period to generate a report. "),e.qZA(),e.qZA())}let st=(()=>{class s{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,w.U)(l=>l.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C))},s.\u0275cmp=e.Xpm({type:s,selectors:[["","report-spaces",""]],attrs:$e,decls:8,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(o,l){if(1&o&&(e._UZ(0,"reports-options"),e.TgZ(1,"div",0),e.YNc(2,et,3,4,"ng-container",1),e.ALo(3,"async"),e.qZA(),e.YNc(4,tt,4,1,"ng-template",null,2,e.W1O),e.YNc(6,nt,3,0,"ng-template",null,3,e.W1O)),2&o){const h=e.MAs(5);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,l.loading))("ngIfElse",h)}},directives:[Ae,I.O5,Fe,Xe,Ce,_e.$g],pipes:[I.Ov],styles:[""]}),s})();var Ue=R(7103);let ot=(()=>{class s extends a.KG{constructor(o,l){super(),this._state=o,this._org=l,this.day_list=this._state.day_list,this.stats=(0,te.aj)([this._state.options,this._state.counts])}ngOnInit(){this.subscription("day_list",this.day_list.subscribe(o=>this.updateDailyChart(o))),this.subscription("stats",this.stats.subscribe(([o,l])=>this.updateLevelChart(o,l)))}updateDailyChart(o){const l={labels:o.map(h=>(0,oe.Z)(h.date,"dd MMM")),series:[o.map(h=>h.utilisation)]};this._day_chart=new Ue.Line("#day-chart",l)}updateLevelChart(o,l){let{zones:h}=o||{};h.includes("All")&&(h=this._org.levels.filter(y=>y.parent_id===this._org.building.id).map(y=>y.id));const m={labels:(h||[]).map(y=>{const b=this._org.levelWithID([y]);return(null==b?void 0:b.display_name)||b.name||""}),series:(h||[]).map(y=>l[y])};this._level_chart=new Ue.Pie("#level-chart",m)}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C),e.Y36(Z.w7))},s.\u0275cmp=e.Xpm({type:s,selectors:[["report-desks-charts"]],features:[e.qOj],decls:11,vars:0,consts:[[1,"flex","items-center","space-x-4","w-full","px-4"],[1,"bg-white","rounded","shadow","flex-1"],[1,"border-b","border-gray-300","p-4","text-xl","font-bold"],["id","day-chart",1,"ct-chart","ct-octave"],["util_chart",""],["id","level-chart",1,"ct-chart","ct-octave"],["level_chart",""]],template:function(o,l){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._uU(3," Daily Utilisation "),e.qZA(),e._UZ(4,"div",3,4),e.qZA(),e.TgZ(6,"div",1),e.TgZ(7,"div",2),e._uU(8," Level Utilisation "),e.qZA(),e._UZ(9,"div",5,6),e.qZA(),e.qZA())},styles:["[_nghost-%COMP%]{display:block}\n/*# sourceMappingURL=report-desks-charts.component.ts-angular-inline--88.css.map*/"]}),s})();function it(s,g){1&s&&(e._uU(0),e.ALo(1,"date")),2&s&&e.hij(" ",e.xi3(1,1,g.data,"mediumDate")," ")}function rt(s,g){1&s&&e._uU(0),2&s&&e.hij(" ",g.data||"0","% ")}const at=function(){return["date","usage","approved","count","utilisation"]},lt=function(){return["Date","Used Desks","Approved Bookings","Total Requests","Utilisation"]},ct=function(){return["flex"]},ut=function(s,g,o){return{date:s,usage:g,utilisation:o}};let dt=(()=>{class s{constructor(o){this._state=o,this.day_list=this._state.day_list,this.download=()=>(0,ne.mG)(this,void 0,void 0,function*(){let l=yield this.day_list.pipe((0,ie.q)(1)).toPromise();l=l.map(h=>Object.assign(Object.assign({},h),{date:(0,oe.Z)(h.date,"MMMM d, y(EEE)")})),(0,a.Sv)("desks-usage.csv",(0,a.o3)(l))})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C))},s.\u0275cmp=e.Xpm({type:s,selectors:[["report-desks-overall-list"]],decls:12,vars:13,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["date_view",""],["percent_view",""]],template:function(o,l){if(1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3",2),e._uU(3,"Daily Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return l.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(7,"custom-table",4),e.YNc(8,it,2,4,"ng-template",null,5,e.W1O),e.YNc(10,rt,1,1,"ng-template",null,6,e.W1O),e.qZA()),2&o){const h=e.MAs(9),m=e.MAs(11);e.xp6(7),e.Q6J("dataSource",l.day_list)("pagination",!0)("columns",e.DdM(6,at))("display_column",e.DdM(7,lt))("column_size",e.DdM(8,ct))("template",e.kEZ(9,ut,h,m,m))}},directives:[ue.lW,n.o,re.C],pipes:[I.uU],encapsulation:2}),s})();function pt(s,g){1&s&&e._uU(0),2&s&&e.hij(" ",g.data||"0","% ")}const ft=function(){return["name","avg_usage","approved","count","utilisation"]},gt=function(){return["Level","Avg. Used Desks","Approved Bookings","Total Requests","Utilisation"]},mt=function(){return["flex"]},ht=function(s){return{utilisation:s}};let vt=(()=>{class s{constructor(o,l){this._state=o,this._org=l,this.level_list=(0,te.aj)([this._state.options,this._state.stats,this._state.counts]).pipe((0,w.U)(([h,m,y])=>{const{start:b,end:E,zones:J}=h,G=le(E,b)||1,$=[];for(const H of J){if("All"===H)continue;const se=this._org.levelWithID([H]),Oe=y[H]||0,pe=m.events.filter(Me=>Me.zones.includes(H));let xe=(Oe*G-pe.length)/G;xe%1!=0&&(xe=xe.toFixed(2)),$.push({name:(null==se?void 0:se.display_name)||(null==se?void 0:se.name),free:xe,approved:pe.filter(Me=>Me.approved).length||0,avg_usage:pe.length/G,total:Oe,count:pe.length,utilisation:(pe.length/((Oe||1)*G)*100||0).toFixed(2)})}return $}),(0,ee.d)(1)),this.download=()=>(0,ne.mG)(this,void 0,void 0,function*(){let h=yield this.level_list.pipe((0,ie.q)(1)).toPromise();(0,a.Sv)("desks-levels-usage.csv",(0,a.o3)(h))})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C),e.Y36(Z.w7))},s.\u0275cmp=e.Xpm({type:s,selectors:[["report-desks-levels-list"]],decls:11,vars:11,consts:[[1,"px-4","mb-4","w-full"],[1,"rounded","bg-white","shadow","overflow-hidden","w-full"],[1,"border-b","border-gray-300","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["percent_view",""]],template:function(o,l){if(1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"h3",3),e._uU(4,"Level Utilisation"),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return l.download()}),e.TgZ(6,"app-icon"),e._uU(7,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(8,"custom-table",5),e.YNc(9,pt,1,1,"ng-template",null,6,e.W1O),e.qZA(),e.qZA()),2&o){const h=e.MAs(10);e.xp6(8),e.Q6J("dataSource",l.level_list)("pagination",!0)("columns",e.DdM(6,ft))("display_column",e.DdM(7,gt))("column_size",e.DdM(8,mt))("template",e.VKq(9,ht,h))}},directives:[ue.lW,n.o,re.C],encapsulation:2}),s})();const _t=["report-desks",""];function yt(s,g){if(1&s&&(e.ynx(0),e.TgZ(1,"div",4),e.TgZ(2,"div",5),e.TgZ(3,"h3"),e._uU(4,"Total Bookings"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.ALo(7,"async"),e.qZA(),e.qZA(),e.TgZ(8,"div",5),e.TgZ(9,"h3"),e._uU(10,"Utilisation"),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.ALo(13,"async"),e.qZA(),e.qZA(),e.qZA(),e._UZ(14,"report-desks-charts"),e._UZ(15,"report-desks-overall-list"),e._UZ(16,"report-desks-levels-list"),e.BQk()),2&s){const o=e.oxw(2);e.xp6(6),e.Oqu(e.lcZ(7,2,o.total_count)||0),e.xp6(6),e.hij("",e.lcZ(13,4,o.utilisation)||0,"%")}}function xt(s,g){if(1&s&&(e.ynx(0),e.YNc(1,yt,17,6,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&s){const o=e.oxw(),l=e.MAs(7);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,o.total_count))("ngIfElse",l)}}function Zt(s,g){1&s&&(e.TgZ(0,"div",6),e._UZ(1,"mat-spinner",7),e.TgZ(2,"p",8),e._uU(3,"Loading report data..."),e.qZA(),e.qZA()),2&s&&(e.xp6(1),e.Q6J("diameter",32))}function At(s,g){1&s&&(e.TgZ(0,"div",6),e.TgZ(1,"p",8),e._uU(2," Select levels and time period to generate a report. "),e.qZA(),e.qZA())}let wt=(()=>{class s{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,w.U)(l=>l.count||0)),this.utilisation=this._state.stats.pipe((0,w.U)(l=>(100*(l.utilisation||0)).toFixed(1))),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"desks"})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C))},s.\u0275cmp=e.Xpm({type:s,selectors:[["","report-desks",""]],attrs:_t,decls:8,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(o,l){if(1&o&&(e._UZ(0,"reports-options"),e.TgZ(1,"div",0),e.YNc(2,xt,3,4,"ng-container",1),e.ALo(3,"async"),e.YNc(4,Zt,4,1,"ng-template",null,2,e.W1O),e.YNc(6,At,3,0,"ng-template",null,3,e.W1O),e.qZA()),2&o){const h=e.MAs(5);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,l.loading))("ngIfElse",h)}},directives:[Ae,I.O5,ot,dt,vt,_e.$g],pipes:[I.Ov],styles:["h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n/*# sourceMappingURL=report-desks.component.ts-angular-inline--74.css.map*/"]}),s})();var Le=R(7027);let we=(()=>{class s{constructor(o){this._reports=o,this.catering_orders=this._reports.bookings.pipe((0,w.U)(l=>(0,a.xH)(l.filter(m=>{var y,b;return null===(b=null===(y=m.extension_data)||void 0===y?void 0:y.catering)||void 0===b?void 0:b.length}).map(m=>{var y;return null===(y=m.extension_data)||void 0===y?void 0:y.catering.map(b=>new Le.GX(Object.assign(Object.assign({},b),{deliver_at:m.date,event:m})))})).filter(m=>m).sort((m,y)=>{var b,E;return(null===(b=m.event)||void 0===b?void 0:b.date)-(null===(E=y.event)||void 0===E?void 0:E.date)})),(0,ee.d)(1)),this.catering_items=this.catering_orders.pipe((0,w.U)(l=>{var h;const m=[];for(const y of l)for(const b of(null==y?void 0:y.items)||[]){const E=m.findIndex(J=>b.options_string===J.options_string);E>=0?b[E]=new Le.Ud(Object.assign(Object.assign({},b),{quantity:(null==b?void 0:b.quantity)+(null===(h=b[E])||void 0===h?void 0:h.quantity)})):m.push(b)}return m.sort((y,b)=>b.quantity-y.quantity)})),this.stats=(0,te.aj)([this.catering_orders,this.catering_items]).pipe((0,w.U)(([l,h])=>{const m=l.reduce((y,b)=>y+b.total_cost,0);return{order_count:l.length,unique_items:h.length,item_count:l.reduce((y,b)=>y+b.item_count,0),total_cost:m,avg_cost:m/l.length}}))}downloadOrders(){return(0,ne.mG)(this,void 0,void 0,function*(){const o=yield this.catering_orders.pipe((0,ie.q)(1)).toPromise(),l=(0,a.o3)(o);return(0,a.Sv)("catering-orders.csv",l)})}}return s.\u0275fac=function(o){return new(o||s)(e.LFG(C))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),bt=(()=>{class s{constructor(o){this._report=o,this.stats=this._report.stats}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(we))},s.\u0275cmp=e.Xpm({type:s,selectors:[["catering-report-overall"]],decls:32,vars:19,consts:[[1,"bg-white","shadow","rounded","m-2","px-8","w-48","h-24","flex","flex-col","items-center","justify-center"],[1,"text-3xl"],[1,""]],template:function(o,l){if(1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._uU(2),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"div",2),e._uU(5,"Orders"),e.qZA(),e.qZA(),e.TgZ(6,"div",0),e.TgZ(7,"div",1),e._uU(8),e.ALo(9,"async"),e.qZA(),e.TgZ(10,"div",2),e._uU(11,"Unique Items"),e.qZA(),e.qZA(),e.TgZ(12,"div",0),e.TgZ(13,"div",1),e._uU(14),e.ALo(15,"async"),e.qZA(),e.TgZ(16,"div",2),e._uU(17,"Ordered Items"),e.qZA(),e.qZA(),e.TgZ(18,"div",0),e.TgZ(19,"div",1),e._uU(20),e.ALo(21,"currency"),e.ALo(22,"async"),e.qZA(),e.TgZ(23,"div",2),e._uU(24,"Total"),e.qZA(),e.qZA(),e.TgZ(25,"div",0),e.TgZ(26,"div",1),e._uU(27),e.ALo(28,"currency"),e.ALo(29,"async"),e.qZA(),e.TgZ(30,"div",2),e._uU(31,"Order Average"),e.qZA(),e.qZA()),2&o){let h,m,y,b,E;e.xp6(2),e.hij(" ",(null==(h=e.lcZ(3,5,l.stats))?null:h.order_count)||"0"," "),e.xp6(6),e.hij(" ",(null==(m=e.lcZ(9,7,l.stats))?null:m.unique_items)||"0"," "),e.xp6(6),e.Oqu((null==(y=e.lcZ(15,9,l.stats))?null:y.item_count)||"0"),e.xp6(6),e.hij(" ",e.lcZ(21,11,(null==(b=e.lcZ(22,13,l.stats))?null:b.total_cost)/100||0)," "),e.xp6(7),e.hij(" ",e.lcZ(28,15,(null==(E=e.lcZ(29,17,l.stats))?null:E.avg_cost)/100||0)," ")}},pipes:[I.Ov,I.H9],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:center;padding:.5rem}\n/*# sourceMappingURL=catering-report-overall.component.ts-angular-inline--87.css.map*/"]}),s})();var be=R(89);function Tt(s,g){if(1&s&&(e._uU(0),e.ALo(1,"date"),e.ALo(2,"date")),2&s){const o=g.data;e.AsE(" ",e.lcZ(1,2,o)," at ",e.xi3(2,4,o,"shortTime")," ")}}function Ot(s,g){1&s&&(e._uU(0),e.ALo(1,"currency")),2&s&&e.hij(" ",e.lcZ(1,1,g.data/100)," ")}const Mt=function(){return["deliver_at","item_count","total_cost"]},St=function(){return["Date","Items","Total Cost"]},Ut=function(){return["flex"]},Lt=function(s,g){return{deliver_at:s,total_cost:g}};let Rt=(()=>{class s{constructor(o){this._report=o,this.orders=this._report.catering_orders,this.download=()=>this._report.downloadOrders()}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(we))},s.\u0275cmp=e.Xpm({type:s,selectors:[["catering-report-orders"]],decls:12,vars:12,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["mat-button-icon","","matTooltip","Download list",3,"click"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["date_state",""],["cost_state",""]],template:function(o,l){if(1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h2",2),e._uU(3,"Orders"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return l.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(7,"custom-table",4),e.YNc(8,Tt,3,7,"ng-template",null,5,e.W1O),e.YNc(10,Ot,2,3,"ng-template",null,6,e.W1O),e.qZA()),2&o){const h=e.MAs(9),m=e.MAs(11);e.xp6(7),e.Q6J("dataSource",l.orders)("columns",e.DdM(6,Mt))("display_column",e.DdM(7,St))("column_size",e.DdM(8,Ut))("template",e.WLB(9,Lt,h,m))("pagination",!0)}},directives:[be.gM,n.o,re.C],pipes:[I.uU,I.H9],styles:[""]}),s})();function Et(s,g){if(1&s&&(e.TgZ(0,"span",7),e._uU(1),e.qZA()),2&s){const o=e.oxw().data,l=e.oxw();e.Q6J("matTooltip",l.options(o)),e.xp6(1),e.hij(" ",o.length," option(s) ")}}function zt(s,g){1&s&&e.YNc(0,Et,2,2,"span",6),2&s&&e.Q6J("ngIf",g.data.length)}function Nt(s,g){1&s&&(e._uU(0),e.ALo(1,"currency")),2&s&&e.hij(" ",e.lcZ(1,1,(g.data||0)/100)," ")}const qt=function(){return["name","options","quantity","unit_price","total_cost"]},kt=function(){return["Name","Options","Quantity","Unit Price","Total Cost"]},Dt=function(){return["flex"]},jt=function(s,g,o){return{options:s,unit_price:g,total_cost:o}};let Pt=(()=>{class s{constructor(o){this._report=o,this.items=this._report.catering_items}options(o){return o.map(l=>l.name).join("\n")}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(we))},s.\u0275cmp=e.Xpm({type:s,selectors:[["catering-report-items"]],decls:9,vars:13,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["option_state",""],["cost_state",""],["class","text-xs px-2 py-1 rounded bg-gray-300",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-gray-300",3,"matTooltip"]],template:function(o,l){if(1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h2",2),e._uU(3,"Ordered Items"),e.qZA(),e.qZA(),e._UZ(4,"custom-table",3),e.YNc(5,zt,1,1,"ng-template",null,4,e.W1O),e.YNc(7,Nt,2,3,"ng-template",null,5,e.W1O),e.qZA()),2&o){const h=e.MAs(6),m=e.MAs(8);e.xp6(4),e.Q6J("dataSource",l.items)("columns",e.DdM(6,qt))("display_column",e.DdM(7,kt))("column_size",e.DdM(8,Dt))("template",e.kEZ(9,jt,h,m,m))("pagination",!0)}},directives:[re.C,I.O5,be.gM],pipes:[I.H9],styles:[""]}),s})();function It(s,g){1&s&&(e.TgZ(0,"div",5),e._UZ(1,"catering-report-overall"),e._UZ(2,"catering-report-orders"),e._UZ(3,"catering-report-items"),e.qZA())}function Yt(s,g){if(1&s&&(e.ynx(0),e.YNc(1,It,4,0,"div",4),e.ALo(2,"async"),e.BQk()),2&s){const o=e.oxw(),l=e.MAs(7);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,o.total_count))("ngIfElse",l)}}function Bt(s,g){1&s&&(e.TgZ(0,"div",6),e._UZ(1,"mat-spinner",7),e.TgZ(2,"p",8),e._uU(3,"Loading report data..."),e.qZA(),e.qZA()),2&s&&(e.xp6(1),e.Q6J("diameter",32))}function Ft(s,g){1&s&&(e.TgZ(0,"div",6),e.TgZ(1,"p",8),e._uU(2," Select levels and time period to generate a report. "),e.qZA(),e.qZA())}let Jt=(()=>{class s{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,w.U)(l=>l.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(C))},s.\u0275cmp=e.Xpm({type:s,selectors:[["catering-report"]],decls:8,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],["class","h-full w-full",4,"ngIf","ngIfElse"],[1,"h-full","w-full"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(o,l){if(1&o&&(e._UZ(0,"reports-options"),e.TgZ(1,"div",0),e.YNc(2,Yt,3,4,"ng-container",1),e.ALo(3,"async"),e.YNc(4,Bt,4,1,"ng-template",null,2,e.W1O),e.YNc(6,Ft,3,0,"ng-template",null,3,e.W1O),e.qZA()),2&o){const h=e.MAs(5);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,l.loading))("ngIfElse",h)}},directives:[Ae,I.O5,bt,Rt,Pt,_e.$g],pipes:[I.Ov],styles:[""]}),s})();var Re=R(1810),Qt=R(8759);const ye={};let Te=(()=>{class s{transform(o){return o?(ye[o]||(ye[o]=(0,M.VE)(o).pipe((0,w.U)(l=>l[0]||new M.mO({id:o,name:o})),(0,he.K)(l=>(0,ce.of)(new M.mO({id:o,name:o}))),(0,ee.d)(1))),ye[o]):(0,ce.of)(null)}static addUser(o){ye[o.id]=(0,ce.of)(o).pipe((0,ee.d)(1))}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275pipe=e.Yjl({name:"user",type:s,pure:!0}),s})(),Ee=(()=>{class s{constructor(o,l){this._org=o,this._reports=l,this._loading=new de.X(""),this._options=new de.X({start:(0,U.Z)(Date.now()),end:(0,N.Z)(Date.now())}),this.events=(0,te.aj)([this._options]).pipe((0,Ze.w)(([{start:h,end:m,user:y}])=>{this._loading.next("Loading contact events...");const b=(0,z.rTZ)(this.system_id,"ContactTracing");return y=y||(0,a.ar)(),Te.addUser(y),this.system_id&&b?b.execute("close_contacts",[y.email,y.username,(0,Re.Z)(h),(0,Re.Z)(m)]):(0,ce.of)([])}),(0,w.U)(h=>{const m=this._options.getValue().user||(0,a.ar)();return h.map(y=>({mac_address:y.mac_address,date:1e3*y.contact_time,duration:Math.floor(y.duration/60),user_id:m.id,user:m.name,contact_id:y.username,distance:1}))}),(0,he.K)(h=>((0,a.cB)(`${(null==h?void 0:h.msg)||JSON.stringify(h)}`),(0,ce.of)([]))),(0,Qt.b)(h=>this._loading.next("")),(0,ee.d)(1)),this.options=this._options.asObservable(),this.loading=this._loading.asObservable()}get system_id(){return this._org.binding("contact_tracing")}setOptions(o){this._options.next(Object.assign(Object.assign({},this._options.getValue()),o))}downloadReport(){return(0,ne.mG)(this,void 0,void 0,function*(){const{start:o,end:l}=yield this._reports.options.pipe((0,ie.q)(1)).toPromise(),h=yield this.events.pipe((0,ie.q)(1)).toPromise(),m=new Te,y=yield Promise.all(h.map(b=>(0,ne.mG)(this,void 0,void 0,function*(){var E;return{"MAC Address":b.mac_address,Date:(0,oe.Z)(b.date,"dd MMM yyyy, h:mm a"),"User Name":b.user,"Contact Name":(null===(E=yield m.transform(b.contact_id).toPromise())||void 0===E?void 0:E.name)||("null"!==b.contact_id?b.contact_id:null)||b.mac_address,Duration:`${Math.floor(b.duration/60)?Math.floor(b.duration/60)+"h ":""}${Math.floor(b.duration%60)+"m"}`,Distance:b.distance}})));(0,a.Sv)(`report+contact-tracing+${(0,oe.Z)(o,"yyyy-MM-dd")}+${(0,oe.Z)(l,"yyyy-MM-dd")}.csv`,(0,a.o3)(y))})}}return s.\u0275fac=function(o){return new(o||s)(e.LFG(Z.w7),e.LFG(C))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var Gt=R(9697);let Xt=(()=>{class s{constructor(o){this._state=o,this.options=this._state.options,this.setOptions=l=>this._state.setOptions(l)}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(Ee))},s.\u0275cmp=e.Xpm({type:s,selectors:[["contact-tracing-options"]],decls:12,vars:11,consts:[[1,"flex","items-center","space-x-2","w-full","p-2","bg-white","shadow"],["appearance","outline",1,"w-64"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],[1,"w-64","h-12","mb-2","mt-1",3,"ngModel","ngModelChange"]],template:function(o,l){if(1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"mat-form-field",1),e.TgZ(2,"mat-date-range-input",2),e.TgZ(3,"input",3),e.NdJ("ngModelChange",function(m){return m?l.setOptions({start:m,user:null}):""}),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"input",4),e.NdJ("ngModelChange",function(m){return m?l.setOptions({end:m,user:null}):""}),e.ALo(6,"async"),e.qZA(),e.qZA(),e._UZ(7,"mat-datepicker-toggle",5),e._UZ(8,"mat-date-range-picker",null,6),e.qZA(),e.TgZ(10,"a-user-search-field",7),e.NdJ("ngModelChange",function(m){return l.setOptions({user:m})}),e.ALo(11,"async"),e.qZA(),e.qZA()),2&o){const h=e.MAs(9);let m,y,b;e.xp6(2),e.Q6J("rangePicker",h),e.xp6(1),e.Q6J("ngModel",null==(m=e.lcZ(4,5,l.options))?null:m.start),e.xp6(2),e.Q6J("ngModel",null==(y=e.lcZ(6,7,l.options))?null:y.end),e.xp6(2),e.Q6J("for",h),e.xp6(3),e.Q6J("ngModel",null==(b=e.lcZ(11,9,l.options))?null:b.user)}},directives:[ve.KE,K.wx,K.zY,B.Fj,B.JJ,B.On,K.By,K.nW,ve.R9,K._g,Gt.d],pipes:[I.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{height:3.25rem}\n/*# sourceMappingURL=contact-tracing-options.components.ts-angular-inline--89.css.map*/"]}),s})();const Vt=function(){return["date","user_id","contact_id","duration"]},Ht=function(){return["Time of Contact","Person","Close Contact","Duration"]},Wt=function(){return["12r","14r","flex"]},Ct=function(s,g,o,l,h,m){return{options:s,date:g,distance:o,user_id:l,contact_id:h,duration:m}};function $t(s,g){if(1&s&&e._UZ(0,"custom-table",12),2&s){const o=e.oxw(),l=e.MAs(9),h=e.MAs(13),m=e.MAs(17),y=e.MAs(11),b=e.MAs(15);e.Q6J("dataSource",o.tracing_events)("columns",e.DdM(7,Vt))("display_column",e.DdM(8,Ht))("column_size",e.DdM(9,Wt))("template",e.HTZ(10,Ct,l,h,m,y,y,b))("pagination",!0)("page_size",30)}}function Kt(s,g){if(1&s&&(e.TgZ(0,"span",14),e._uU(1),e.qZA()),2&s){const o=e.oxw().data,l=e.oxw();e.Q6J("matTooltip",l.options(o)),e.xp6(1),e.hij(" ",o.length," option(s) ")}}function en(s,g){1&s&&e.YNc(0,Kt,2,2,"span",13),2&s&&e.Q6J("ngIf",g.data.length)}function tn(s,g){if(1&s&&(e._uU(0),e.ALo(1,"async"),e.ALo(2,"user")),2&s){const l=g.row;let h;e.Oqu((null==(h=e.lcZ(1,1,e.lcZ(2,3,g.data)))?null:h.name)||l.mac_address)}}function nn(s,g){if(1&s&&(e._uU(0),e.ALo(1,"date"),e.ALo(2,"date")),2&s){const o=g.data;e.AsE(" ",e.xi3(1,2,o,"mediumDate"),", ",e.xi3(2,5,o,"shortTime")," ")}}function sn(s,g){1&s&&(e._uU(0),e.ALo(1,"duration")),2&s&&e.hij(" ",e.lcZ(1,1,g.data)," ")}function on(s,g){1&s&&e._uU(0),2&s&&e.hij(" ",g.data,"m ")}function rn(s,g){if(1&s&&(e.TgZ(0,"div",15),e._UZ(1,"map-spinner",16),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"async"),e.qZA(),e.qZA()),2&s){const o=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,1,o.loading))}}const an=[{path:"",component:P,children:[{path:""},{path:"spaces",component:st},{path:"desks",component:wt},{path:"catering",component:Jt},{path:"contact-tracing",component:(()=>{class s{constructor(o){this._state=o,this.loading=this._state.loading,this.options=this._state.options,this.tracing_events=this._state.events,this.setOptions=l=>this._state.setOptions(l),this.downloadReport=()=>this._state.downloadReport()}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(Ee))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-contact-tracing-report"]],decls:23,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["class","w-full h-full","empty","No contact records for selected period",3,"dataSource","columns","display_column","column_size","template","pagination","page_size",4,"ngIf","ngIfElse"],["option_state",""],["user_state",""],["date_state",""],["duration_state",""],["distance_state",""],["mat-icon-button","","matTooltip","Download Report",1,"bg-white","absolute","bottom-2","left-2","shadow",3,"click"],["load_state",""],["empty","No contact records for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination","page_size"],["class","text-xs px-2 py-1 rounded bg-gray-300",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-gray-300",3,"matTooltip"],[1,"p-8","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"]],template:function(o,l){if(1&o&&(e._UZ(0,"contact-tracing-options"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e.TgZ(4,"h2",3),e._uU(5,"Contact Events"),e.qZA(),e.qZA(),e.YNc(6,$t,1,17,"custom-table",4),e.ALo(7,"async"),e.YNc(8,en,1,1,"ng-template",null,5,e.W1O),e.YNc(10,tn,3,5,"ng-template",null,6,e.W1O),e.YNc(12,nn,3,8,"ng-template",null,7,e.W1O),e.YNc(14,sn,2,3,"ng-template",null,8,e.W1O),e.YNc(16,on,1,1,"ng-template",null,9,e.W1O),e.qZA(),e.qZA(),e.TgZ(18,"button",10),e.NdJ("click",function(){return l.downloadReport()}),e.TgZ(19,"app-icon"),e._uU(20,"download"),e.qZA(),e.qZA(),e.YNc(21,rn,5,3,"ng-template",null,11,e.W1O)),2&o){const h=e.MAs(22);e.xp6(6),e.Q6J("ngIf",!e.lcZ(7,2,l.loading))("ngIfElse",h)}},directives:[Xt,I.O5,re.C,be.gM,ue.lW,n.o],pipes:[I.Ov,Te,I.uU],styles:[""]}),s})()},{path:"**",redirectTo:"desks"}]}];let ln=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[I.ez,B.u5,t.v,O.YR,M.PP,L.TU,k.Bz.forChild(an)]]}),s})()},7103:function(Se,fe){var I,B;B=this,I=function(){return B.Chartist=function(){var B={version:"0.11.4"};return function(k,t){"use strict";var L=k.window,e=k.document;t.namespaces={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},t.noop=function(r){return r},t.alphaNumerate=function(r){return String.fromCharCode(97+r%26)},t.extend=function(r){var a,d,n;for(r=r||{},a=1;a<arguments.length;a++)for(var i in d=arguments[a])r[i]="object"!=typeof(n=d[i])||null===n||n instanceof Array?n:t.extend(r[i],n);return r},t.replaceAll=function(r,a,d){return r.replace(new RegExp(a,"g"),d)},t.ensureUnit=function(r,a){return"number"==typeof r&&(r+=a),r},t.quantity=function(r){if("string"==typeof r){var a=/^(\d+)\s*(.*)$/g.exec(r);return{value:+a[1],unit:a[2]||void 0}}return{value:r}},t.querySelector=function(r){return r instanceof Node?r:e.querySelector(r)},t.times=function(r){return Array.apply(null,new Array(r))},t.sum=function(r,a){return r+(a||0)},t.mapMultiply=function(r){return function(a){return a*r}},t.mapAdd=function(r){return function(a){return a+r}},t.serialMap=function(r,a){var d=[],n=Math.max.apply(null,r.map(function(i){return i.length}));return t.times(n).forEach(function(i,c){var f=r.map(function(p){return p[c]});d[c]=a.apply(null,f)}),d},t.roundWithPrecision=function(r,a){var d=Math.pow(10,a||t.precision);return Math.round(r*d)/d},t.precision=8,t.escapingMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t.serialize=function(r){return null==r?r:("number"==typeof r?r=""+r:"object"==typeof r&&(r=JSON.stringify({data:r})),Object.keys(t.escapingMap).reduce(function(a,d){return t.replaceAll(a,d,t.escapingMap[d])},r))},t.deserialize=function(r){if("string"!=typeof r)return r;r=Object.keys(t.escapingMap).reduce(function(a,d){return t.replaceAll(a,t.escapingMap[d],d)},r);try{r=void 0!==(r=JSON.parse(r)).data?r.data:r}catch(a){}return r},t.createSvg=function(r,a,d,n){var i;return a=a||"100%",d=d||"100%",Array.prototype.slice.call(r.querySelectorAll("svg")).filter(function(f){return f.getAttributeNS(t.namespaces.xmlns,"ct")}).forEach(function(f){r.removeChild(f)}),(i=new t.Svg("svg").attr({width:a,height:d}).addClass(n))._node.style.width=a,i._node.style.height=d,r.appendChild(i._node),i},t.normalizeData=function(r,a,d){var n,i={raw:r,normalized:{}};return i.normalized.series=t.getDataArray({series:r.series||[]},a,d),n=i.normalized.series.every(function(c){return c instanceof Array})?Math.max.apply(null,i.normalized.series.map(function(c){return c.length})):i.normalized.series.length,i.normalized.labels=(r.labels||[]).slice(),Array.prototype.push.apply(i.normalized.labels,t.times(Math.max(0,n-i.normalized.labels.length)).map(function(){return""})),a&&t.reverseData(i.normalized),i},t.safeHasProperty=function(r,a){return null!==r&&"object"==typeof r&&r.hasOwnProperty(a)},t.isDataHoleValue=function(r){return null==r||"number"==typeof r&&isNaN(r)},t.reverseData=function(r){r.labels.reverse(),r.series.reverse();for(var a=0;a<r.series.length;a++)"object"==typeof r.series[a]&&void 0!==r.series[a].data?r.series[a].data.reverse():r.series[a]instanceof Array&&r.series[a].reverse()},t.getDataArray=function(r,a,d){return r.series.map(function n(i){if(t.safeHasProperty(i,"value"))return n(i.value);if(t.safeHasProperty(i,"data"))return n(i.data);if(i instanceof Array)return i.map(n);if(!t.isDataHoleValue(i)){if(d){var c={};return"string"==typeof d?c[d]=t.getNumberOrUndefined(i):c.y=t.getNumberOrUndefined(i),c.x=i.hasOwnProperty("x")?t.getNumberOrUndefined(i.x):c.x,c.y=i.hasOwnProperty("y")?t.getNumberOrUndefined(i.y):c.y,c}return t.getNumberOrUndefined(i)}})},t.normalizePadding=function(r,a){return a=a||0,"number"==typeof r?{top:r,right:r,bottom:r,left:r}:{top:"number"==typeof r.top?r.top:a,right:"number"==typeof r.right?r.right:a,bottom:"number"==typeof r.bottom?r.bottom:a,left:"number"==typeof r.left?r.left:a}},t.getMetaData=function(r,a){var d=r.data?r.data[a]:r[a];return d?d.meta:void 0},t.orderOfMagnitude=function(r){return Math.floor(Math.log(Math.abs(r))/Math.LN10)},t.projectLength=function(r,a,d){return a/d.range*r},t.getAvailableHeight=function(r,a){return Math.max((t.quantity(a.height).value||r.height())-(a.chartPadding.top+a.chartPadding.bottom)-a.axisX.offset,0)},t.getHighLow=function(r,a,d){var n={high:void 0===(a=t.extend({},a,d?a["axis"+d.toUpperCase()]:{})).high?-Number.MAX_VALUE:+a.high,low:void 0===a.low?Number.MAX_VALUE:+a.low},i=void 0===a.high,c=void 0===a.low;return(i||c)&&function f(p){if(void 0!==p)if(p instanceof Array)for(var u=0;u<p.length;u++)f(p[u]);else{var v=d?+p[d]:+p;i&&v>n.high&&(n.high=v),c&&v<n.low&&(n.low=v)}}(r),(a.referenceValue||0===a.referenceValue)&&(n.high=Math.max(a.referenceValue,n.high),n.low=Math.min(a.referenceValue,n.low)),n.high<=n.low&&(0===n.low?n.high=1:n.low<0?n.high=0:(n.high>0||(n.high=1),n.low=0)),n},t.isNumeric=function(r){return null!==r&&isFinite(r)},t.isFalseyButZero=function(r){return!r&&0!==r},t.getNumberOrUndefined=function(r){return t.isNumeric(r)?+r:void 0},t.isMultiValue=function(r){return"object"==typeof r&&("x"in r||"y"in r)},t.getMultiValue=function(r,a){return t.isMultiValue(r)?t.getNumberOrUndefined(r[a||"y"]):t.getNumberOrUndefined(r)},t.rho=function(r){if(1===r)return r;function a(f,p){return f%p==0?p:a(p,f%p)}function d(f){return f*f+1}var c,n=2,i=2;if(r%2==0)return 2;do{n=d(n)%r,i=d(d(i))%r,c=a(Math.abs(n-i),r)}while(1===c);return c},t.getBounds=function(r,a,d,n){var i,f,p,c=0,u={high:a.high,low:a.low};u.valueRange=u.high-u.low,u.oom=t.orderOfMagnitude(u.valueRange),u.step=Math.pow(10,u.oom),u.min=Math.floor(u.low/u.step)*u.step,u.max=Math.ceil(u.high/u.step)*u.step,u.range=u.max-u.min,u.numberOfSteps=Math.round(u.range/u.step);var x=t.projectLength(r,u.step,u)<d,A=n?t.rho(u.range):0;if(n&&t.projectLength(r,1,u)>=d)u.step=1;else if(n&&A<u.step&&t.projectLength(r,A,u)>=d)u.step=A;else for(;;){if(x&&t.projectLength(r,u.step,u)<=d)u.step*=2;else{if(x||!(t.projectLength(r,u.step/2,u)>=d))break;if(u.step/=2,n&&u.step%1!=0){u.step*=2;break}}if(c++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}var T=2221e-19;function S(P,O){return P===(P+=O)&&(P*=1+(O>0?T:-T)),P}for(u.step=Math.max(u.step,T),f=u.min,p=u.max;f+u.step<=u.low;)f=S(f,u.step);for(;p-u.step>=u.high;)p=S(p,-u.step);u.min=f,u.max=p,u.range=u.max-u.min;var q=[];for(i=u.min;i<=u.max;i=S(i,u.step)){var Q=t.roundWithPrecision(i);Q!==q[q.length-1]&&q.push(Q)}return u.values=q,u},t.polarToCartesian=function(r,a,d,n){var i=(n-90)*Math.PI/180;return{x:r+d*Math.cos(i),y:a+d*Math.sin(i)}},t.createChartRect=function(r,a,d){var n=!(!a.axisX&&!a.axisY),i=n?a.axisY.offset:0,c=n?a.axisX.offset:0,f=r.width()||t.quantity(a.width).value||0,p=r.height()||t.quantity(a.height).value||0,u=t.normalizePadding(a.chartPadding,d);f=Math.max(f,i+u.left+u.right),p=Math.max(p,c+u.top+u.bottom);var v={padding:u,width:function(){return this.x2-this.x1},height:function(){return this.y1-this.y2}};return n?("start"===a.axisX.position?(v.y2=u.top+c,v.y1=Math.max(p-u.bottom,v.y2+1)):(v.y2=u.top,v.y1=Math.max(p-u.bottom-c,v.y2+1)),"start"===a.axisY.position?(v.x1=u.left+i,v.x2=Math.max(f-u.right,v.x1+1)):(v.x1=u.left,v.x2=Math.max(f-u.right-i,v.x1+1))):(v.x1=u.left,v.x2=Math.max(f-u.right,v.x1+1),v.y2=u.top,v.y1=Math.max(p-u.bottom,v.y2+1)),v},t.createGrid=function(r,a,d,n,i,c,f,p){var u={};u[d.units.pos+"1"]=r,u[d.units.pos+"2"]=r,u[d.counterUnits.pos+"1"]=n,u[d.counterUnits.pos+"2"]=n+i;var v=c.elem("line",u,f.join(" "));p.emit("draw",t.extend({type:"grid",axis:d,index:a,group:c,element:v},u))},t.createGridBackground=function(r,a,d,n){var i=r.elem("rect",{x:a.x1,y:a.y2,width:a.width(),height:a.height()},d,!0);n.emit("draw",{type:"gridBackground",group:r,element:i})},t.createLabel=function(r,a,d,n,i,c,f,p,u,v,x){var A,T={};if(T[i.units.pos]=r+f[i.units.pos],T[i.counterUnits.pos]=f[i.counterUnits.pos],T[i.units.len]=a,T[i.counterUnits.len]=Math.max(0,c-10),v){var S=e.createElement("span");S.className=u.join(" "),S.setAttribute("xmlns",t.namespaces.xhtml),S.innerText=n[d],S.style[i.units.len]=Math.round(T[i.units.len])+"px",S.style[i.counterUnits.len]=Math.round(T[i.counterUnits.len])+"px",A=p.foreignObject(S,t.extend({style:"overflow: visible;"},T))}else A=p.elem("text",T,u.join(" ")).text(n[d]);x.emit("draw",t.extend({type:"label",axis:i,index:d,group:p,element:A,text:n[d]},T))},t.getSeriesOption=function(r,a,d){if(r.name&&a.series&&a.series[r.name]){var n=a.series[r.name];return n.hasOwnProperty(d)?n[d]:a[d]}return a[d]},t.optionsProvider=function(r,a,d){var i,f,n=t.extend({},r),c=[];function p(x){var A=i;if(i=t.extend({},n),a)for(f=0;f<a.length;f++)L.matchMedia(a[f][0]).matches&&(i=t.extend(i,a[f][1]));d&&x&&d.emit("optionsChanged",{previousOptions:A,currentOptions:i})}if(!L.matchMedia)throw"window.matchMedia not found! Make sure you're using a polyfill.";if(a)for(f=0;f<a.length;f++){var v=L.matchMedia(a[f][0]);v.addListener(p),c.push(v)}return p(),{removeMediaQueryListeners:function u(){c.forEach(function(x){x.removeListener(p)})},getCurrentOptions:function(){return t.extend({},i)}}},t.splitIntoSegments=function(r,a,d){d=t.extend({},{increasingX:!1,fillHoles:!1},d);for(var i=[],c=!0,f=0;f<r.length;f+=2)void 0===t.getMultiValue(a[f/2].value)?d.fillHoles||(c=!0):(d.increasingX&&f>=2&&r[f]<=r[f-2]&&(c=!0),c&&(i.push({pathCoordinates:[],valueData:[]}),c=!1),i[i.length-1].pathCoordinates.push(r[f],r[f+1]),i[i.length-1].valueData.push(a[f/2]));return i}}(this||global,B),function(k,t){"use strict";t.Interpolation={},t.Interpolation.none=function(L){return L=t.extend({},{fillHoles:!1},L),function(a,d){for(var n=new t.Svg.Path,i=!0,c=0;c<a.length;c+=2){var f=a[c],p=a[c+1],u=d[c/2];void 0!==t.getMultiValue(u.value)?(i?n.move(f,p,!1,u):n.line(f,p,!1,u),i=!1):L.fillHoles||(i=!0)}return n}},t.Interpolation.simple=function(L){L=t.extend({},{divisor:2,fillHoles:!1},L);var r=1/Math.max(1,L.divisor);return function(d,n){for(var c,f,p,i=new t.Svg.Path,u=0;u<d.length;u+=2){var v=d[u],x=d[u+1],A=(v-c)*r,T=n[u/2];void 0!==T.value?(void 0===p?i.move(v,x,!1,T):i.curve(c+A,f,v-A,x,v,x,!1,T),c=v,f=x,p=T):L.fillHoles||(c=v=p=void 0)}return i}},t.Interpolation.cardinal=function(L){L=t.extend({},{tension:1,fillHoles:!1},L);var r=Math.min(1,Math.max(0,L.tension)),a=1-r;return function d(n,i){var c=t.splitIntoSegments(n,i,{fillHoles:L.fillHoles});if(c.length){if(c.length>1){var f=[];return c.forEach(function(T){f.push(d(T.pathCoordinates,T.valueData))}),t.Svg.Path.join(f)}if(i=c[0].valueData,(n=c[0].pathCoordinates).length<=4)return t.Interpolation.none()(n,i);for(var p=(new t.Svg.Path).move(n[0],n[1],!1,i[0]),v=0,x=n.length;x-2>v;v+=2){var A=[{x:+n[v-2],y:+n[v-1]},{x:+n[v],y:+n[v+1]},{x:+n[v+2],y:+n[v+3]},{x:+n[v+4],y:+n[v+5]}];x-4===v?A[3]=A[2]:v||(A[0]={x:+n[v],y:+n[v+1]}),p.curve(r*(6*A[1].x-A[0].x+A[2].x)/6+a*A[2].x,r*(6*A[1].y-A[0].y+A[2].y)/6+a*A[2].y,r*(A[1].x+6*A[2].x-A[3].x)/6+a*A[2].x,r*(A[1].y+6*A[2].y-A[3].y)/6+a*A[2].y,A[2].x,A[2].y,!1,i[(v+2)/2])}return p}return t.Interpolation.none()([])}},t.Interpolation.monotoneCubic=function(L){return L=t.extend({},{fillHoles:!1},L),function r(a,d){var n=t.splitIntoSegments(a,d,{fillHoles:L.fillHoles,increasingX:!0});if(n.length){if(n.length>1){var i=[];return n.forEach(function(q){i.push(r(q.pathCoordinates,q.valueData))}),t.Svg.Path.join(i)}if(d=n[0].valueData,(a=n[0].pathCoordinates).length<=4)return t.Interpolation.none()(a,d);var p,S,c=[],f=[],u=a.length/2,v=[],x=[],A=[],T=[];for(p=0;p<u;p++)c[p]=a[2*p],f[p]=a[2*p+1];for(p=0;p<u-1;p++)A[p]=f[p+1]-f[p],T[p]=c[p+1]-c[p],x[p]=A[p]/T[p];for(v[0]=x[0],v[u-1]=x[u-2],p=1;p<u-1;p++)0===x[p]||0===x[p-1]||x[p-1]>0!=x[p]>0?v[p]=0:(v[p]=3*(T[p-1]+T[p])/((2*T[p]+T[p-1])/x[p-1]+(T[p]+2*T[p-1])/x[p]),isFinite(v[p])||(v[p]=0));for(S=(new t.Svg.Path).move(c[0],f[0],!1,d[0]),p=0;p<u-1;p++)S.curve(c[p]+T[p]/3,f[p]+v[p]*T[p]/3,c[p+1]-T[p]/3,f[p+1]-v[p+1]*T[p]/3,c[p+1],f[p+1],!1,d[p+1]);return S}return t.Interpolation.none()([])}},t.Interpolation.step=function(L){return L=t.extend({},{postpone:!0,fillHoles:!1},L),function(a,d){for(var i,c,f,n=new t.Svg.Path,p=0;p<a.length;p+=2){var u=a[p],v=a[p+1],x=d[p/2];void 0!==x.value?(void 0===f?n.move(u,v,!1,x):(L.postpone?n.line(u,c,!1,f):n.line(i,v,!1,x),n.line(u,v,!1,x)),i=u,c=v,f=x):L.fillHoles||(i=c=f=void 0)}return n}}}(this||global,B),function(k,t){"use strict";t.EventEmitter=function(){var L=[];return{addEventHandler:function e(d,n){L[d]=L[d]||[],L[d].push(n)},removeEventHandler:function r(d,n){L[d]&&(n?(L[d].splice(L[d].indexOf(n),1),0===L[d].length&&delete L[d]):delete L[d])},emit:function a(d,n){L[d]&&L[d].forEach(function(i){i(n)}),L["*"]&&L["*"].forEach(function(i){i(d,n)})}}}}(this||global,B),function(k,t){"use strict";function L(a){var d=[];if(a.length)for(var n=0;n<a.length;n++)d.push(a[n]);return d}t.Class={extend:function e(a,d){var n=d||this.prototype||t.Class,i=Object.create(n);t.Class.cloneDefinitions(i,a);var c=function(){var p,f=i.constructor||function(){};return p=this===t?Object.create(i):this,f.apply(p,Array.prototype.slice.call(arguments,0)),p};return c.prototype=i,c.super=n,c.extend=this.extend,c},cloneDefinitions:function r(){var a=L(arguments),d=a[0];return a.splice(1,a.length-1).forEach(function(n){Object.getOwnPropertyNames(n).forEach(function(i){delete d[i],Object.defineProperty(d,i,Object.getOwnPropertyDescriptor(n,i))})}),d}}}(this||global,B),function(k,t){"use strict";var L=k.window;function n(){L.addEventListener("resize",this.resizeListener),this.optionsProvider=t.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.addEventHandler("optionsChanged",function(){this.update()}.bind(this)),this.options.plugins&&this.options.plugins.forEach(function(c){c instanceof Array?c[0](this,c[1]):c(this)}.bind(this)),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=void 0}t.Base=t.Class.extend({constructor:function i(c,f,p,u,v){this.container=t.querySelector(c),this.data=f||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.defaultOptions=p,this.options=u,this.responsiveOptions=v,this.eventEmitter=t.EventEmitter(),this.supportsForeignObject=t.Svg.isSupported("Extensibility"),this.supportsAnimations=t.Svg.isSupported("AnimationEventsAttribute"),this.resizeListener=function(){this.update()}.bind(this),this.container&&(this.container.__chartist__&&this.container.__chartist__.detach(),this.container.__chartist__=this),this.initializeTimeoutId=setTimeout(n.bind(this),0)},optionsProvider:void 0,container:void 0,svg:void 0,eventEmitter:void 0,createChart:function(){throw new Error("Base chart type can't be instantiated!")},update:function e(c,f,p){return c&&(this.data=c||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.eventEmitter.emit("data",{type:"update",data:this.data})),f&&(this.options=t.extend({},p?this.options:this.defaultOptions,f),this.initializeTimeoutId||(this.optionsProvider.removeMediaQueryListeners(),this.optionsProvider=t.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter))),this.initializeTimeoutId||this.createChart(this.optionsProvider.getCurrentOptions()),this},detach:function r(){return this.initializeTimeoutId?L.clearTimeout(this.initializeTimeoutId):(L.removeEventListener("resize",this.resizeListener),this.optionsProvider.removeMediaQueryListeners()),this},on:function a(c,f){return this.eventEmitter.addEventHandler(c,f),this},off:function d(c,f){return this.eventEmitter.removeEventHandler(c,f),this},version:t.version,supportsForeignObject:!1})}(this||global,B),function(k,t){"use strict";var L=k.document;t.Svg=t.Class.extend({constructor:function e(_,Z,U,N,F){_ instanceof Element?this._node=_:(this._node=L.createElementNS(t.namespaces.svg,_),"svg"===_&&this.attr({"xmlns:ct":t.namespaces.ct})),Z&&this.attr(Z),U&&this.addClass(U),N&&(F&&N._node.firstChild?N._node.insertBefore(this._node,N._node.firstChild):N._node.appendChild(this._node))},attr:function r(_,Z){return"string"==typeof _?Z?this._node.getAttributeNS(Z,_):this._node.getAttribute(_):(Object.keys(_).forEach(function(U){if(void 0!==_[U])if(-1!==U.indexOf(":")){var N=U.split(":");this._node.setAttributeNS(t.namespaces[N[0]],U,_[U])}else this._node.setAttribute(U,_[U])}.bind(this)),this)},elem:function a(_,Z,U,N){return new t.Svg(_,Z,U,this,N)},parent:function d(){return this._node.parentNode instanceof SVGElement?new t.Svg(this._node.parentNode):null},root:function n(){for(var _=this._node;"svg"!==_.nodeName;)_=_.parentNode;return new t.Svg(_)},querySelector:function i(_){var Z=this._node.querySelector(_);return Z?new t.Svg(Z):null},querySelectorAll:function c(_){var Z=this._node.querySelectorAll(_);return Z.length?new t.Svg.List(Z):null},getNode:function f(){return this._node},foreignObject:function p(_,Z,U,N){if("string"==typeof _){var F=L.createElement("div");F.innerHTML=_,_=F.firstChild}_.setAttribute("xmlns",t.namespaces.xmlns);var X=this.elem("foreignObject",Z,U,N);return X._node.appendChild(_),X},text:function u(_){return this._node.appendChild(L.createTextNode(_)),this},empty:function v(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this},remove:function x(){return this._node.parentNode.removeChild(this._node),this.parent()},replace:function A(_){return this._node.parentNode.replaceChild(_._node,this._node),_},append:function T(_,Z){return Z&&this._node.firstChild?this._node.insertBefore(_._node,this._node.firstChild):this._node.appendChild(_._node),this},classes:function S(){return this._node.getAttribute("class")?this._node.getAttribute("class").trim().split(/\s+/):[]},addClass:function q(_){return this._node.setAttribute("class",this.classes(this._node).concat(_.trim().split(/\s+/)).filter(function(Z,U,N){return N.indexOf(Z)===U}).join(" ")),this},removeClass:function Q(_){var Z=_.trim().split(/\s+/);return this._node.setAttribute("class",this.classes(this._node).filter(function(U){return-1===Z.indexOf(U)}).join(" ")),this},removeAllClasses:function P(){return this._node.setAttribute("class",""),this},height:function O(){return this._node.getBoundingClientRect().height},width:function M(){return this._node.getBoundingClientRect().width},animate:function w(_,Z,U){return void 0===Z&&(Z=!0),Object.keys(_).forEach(function(F){function X(D,Y){var W,ge,ae,V={};D.easing&&(ae=D.easing instanceof Array?D.easing:t.Svg.Easing[D.easing],delete D.easing),D.begin=t.ensureUnit(D.begin,"ms"),D.dur=t.ensureUnit(D.dur,"ms"),ae&&(D.calcMode="spline",D.keySplines=ae.join(" "),D.keyTimes="0;1"),Y&&(D.fill="freeze",V[F]=D.from,this.attr(V),ge=t.quantity(D.begin||0).value,D.begin="indefinite"),W=this.elem("animate",t.extend({attributeName:F},D)),Y&&setTimeout(function(){try{W._node.beginElement()}catch(le){V[F]=D.to,this.attr(V),W.remove()}}.bind(this),ge),U&&W._node.addEventListener("beginEvent",function(){U.emit("animationBegin",{element:this,animate:W._node,params:D})}.bind(this)),W._node.addEventListener("endEvent",function(){U&&U.emit("animationEnd",{element:this,animate:W._node,params:D}),Y&&(V[F]=D.to,this.attr(V),W.remove())}.bind(this))}_[F]instanceof Array?_[F].forEach(function(D){X.bind(this)(D,!1)}.bind(this)):X.bind(this)(_[F],Z)}.bind(this)),this}}),t.Svg.isSupported=function(_){return L.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#"+_,"1.1")},t.Svg.Easing={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]},t.Svg.List=t.Class.extend({constructor:function j(_){var Z=this;this.svgElements=[];for(var U=0;U<_.length;U++)this.svgElements.push(new t.Svg(_[U]));Object.keys(t.Svg.prototype).filter(function(N){return-1===["constructor","parent","querySelector","querySelectorAll","replace","append","classes","height","width"].indexOf(N)}).forEach(function(N){Z[N]=function(){var F=Array.prototype.slice.call(arguments,0);return Z.svgElements.forEach(function(X){t.Svg.prototype[N].apply(X,F)}),Z}})}})}(this||global,B),function(k,t){"use strict";var L={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},e={accuracy:3};function r(O,M,w,z,j,_){var Z=t.extend({command:j?O.toLowerCase():O.toUpperCase()},M,_?{data:_}:{});w.splice(z,0,Z)}function a(O,M){O.forEach(function(w,z){L[w.command.toLowerCase()].forEach(function(j,_){M(w,j,z,_,O)})})}t.Svg.Path=t.Class.extend({constructor:function d(O,M){this.pathElements=[],this.pos=0,this.close=O,this.options=t.extend({},e,M)},position:function n(O){return void 0!==O?(this.pos=Math.max(0,Math.min(this.pathElements.length,O)),this):this.pos},remove:function i(O){return this.pathElements.splice(this.pos,O),this},move:function c(O,M,w,z){return r("M",{x:+O,y:+M},this.pathElements,this.pos++,w,z),this},line:function f(O,M,w,z){return r("L",{x:+O,y:+M},this.pathElements,this.pos++,w,z),this},curve:function p(O,M,w,z,j,_,Z,U){return r("C",{x1:+O,y1:+M,x2:+w,y2:+z,x:+j,y:+_},this.pathElements,this.pos++,Z,U),this},arc:function u(O,M,w,z,j,_,Z,U,N){return r("A",{rx:+O,ry:+M,xAr:+w,lAf:+z,sf:+j,x:+_,y:+Z},this.pathElements,this.pos++,U,N),this},scale:function A(O,M){return a(this.pathElements,function(w,z){w[z]*="x"===z[0]?O:M}),this},translate:function T(O,M){return a(this.pathElements,function(w,z){w[z]+="x"===z[0]?O:M}),this},transform:function S(O){return a(this.pathElements,function(M,w,z,j,_){var Z=O(M,w,z,j,_);(Z||0===Z)&&(M[w]=Z)}),this},parse:function v(O){var M=O.replace(/([A-Za-z])([0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce(function(j,_){return _.match(/[A-Za-z]/)&&j.push([]),j[j.length-1].push(_),j},[]);"Z"===M[M.length-1][0].toUpperCase()&&M.pop();var w=M.map(function(j){var _=j.shift(),Z=L[_.toLowerCase()];return t.extend({command:_},Z.reduce(function(U,N,F){return U[N]=+j[F],U},{}))}),z=[this.pos,0];return Array.prototype.push.apply(z,w),Array.prototype.splice.apply(this.pathElements,z),this.pos+=w.length,this},stringify:function x(){var O=Math.pow(10,this.options.accuracy);return this.pathElements.reduce(function(M,w){var z=L[w.command.toLowerCase()].map(function(j){return this.options.accuracy?Math.round(w[j]*O)/O:w[j]}.bind(this));return M+w.command+z.join(",")}.bind(this),"")+(this.close?"Z":"")},clone:function q(O){var M=new t.Svg.Path(O||this.close);return M.pos=this.pos,M.pathElements=this.pathElements.slice().map(function(z){return t.extend({},z)}),M.options=t.extend({},this.options),M},splitByCommand:function Q(O){var M=[new t.Svg.Path];return this.pathElements.forEach(function(w){w.command===O.toUpperCase()&&0!==M[M.length-1].pathElements.length&&M.push(new t.Svg.Path),M[M.length-1].pathElements.push(w)}),M}}),t.Svg.Path.elementDescriptions=L,t.Svg.Path.join=function P(O,M,w){for(var z=new t.Svg.Path(M,w),j=0;j<O.length;j++)for(var _=O[j],Z=0;Z<_.pathElements.length;Z++)z.pathElements.push(_.pathElements[Z]);return z}}(this||global,B),function(k,t){"use strict";var r={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};t.Axis=t.Class.extend({constructor:function a(n,i,c,f){this.units=n,this.counterUnits=n===r.x?r.y:r.x,this.chartRect=i,this.axisLength=i[n.rectEnd]-i[n.rectStart],this.gridOffset=i[n.rectOffset],this.ticks=c,this.options=f},createGridAndLabels:function d(n,i,c,f,p){var u=f["axis"+this.units.pos.toUpperCase()],v=this.ticks.map(this.projectValue.bind(this)),x=this.ticks.map(u.labelInterpolationFnc);v.forEach(function(A,T){var q,S={x:0,y:0};q=v[T+1]?v[T+1]-A:Math.max(this.axisLength-A,30),(!t.isFalseyButZero(x[T])||""===x[T])&&("x"===this.units.pos?(A=this.chartRect.x1+A,S.x=f.axisX.labelOffset.x,S.y="start"===f.axisX.position?this.chartRect.padding.top+f.axisX.labelOffset.y+(c?5:20):this.chartRect.y1+f.axisX.labelOffset.y+(c?5:20)):(A=this.chartRect.y1-A,S.y=f.axisY.labelOffset.y-(c?q:0),S.x="start"===f.axisY.position?c?this.chartRect.padding.left+f.axisY.labelOffset.x:this.chartRect.x1-10:this.chartRect.x2+f.axisY.labelOffset.x+10),u.showGrid&&t.createGrid(A,T,this,this.gridOffset,this.chartRect[this.counterUnits.len](),n,[f.classNames.grid,f.classNames[this.units.dir]],p),u.showLabel&&t.createLabel(A,q,T,x,this,u.offset,S,i,[f.classNames.label,f.classNames[this.units.dir],"start"===u.position?f.classNames[u.position]:f.classNames.end],c,p))}.bind(this))},projectValue:function(n,i,c){throw new Error("Base axis can't be instantiated!")}}),t.Axis.units=r}(this||global,B),function(k,t){"use strict";t.AutoScaleAxis=t.Axis.extend({constructor:function r(d,n,i,c){var f=c.highLow||t.getHighLow(n,c,d.pos);this.bounds=t.getBounds(i[d.rectEnd]-i[d.rectStart],f,c.scaleMinSpace||20,c.onlyInteger),this.range={min:this.bounds.min,max:this.bounds.max},t.AutoScaleAxis.super.constructor.call(this,d,i,this.bounds.values,c)},projectValue:function a(d){return this.axisLength*(+t.getMultiValue(d,this.units.pos)-this.bounds.min)/this.bounds.range}})}(this||global,B),function(k,t){"use strict";t.FixedScaleAxis=t.Axis.extend({constructor:function r(d,n,i,c){var f=c.highLow||t.getHighLow(n,c,d.pos);this.divisor=c.divisor||1,this.ticks=c.ticks||t.times(this.divisor).map(function(p,u){return f.low+(f.high-f.low)/this.divisor*u}.bind(this)),this.ticks.sort(function(p,u){return p-u}),this.range={min:f.low,max:f.high},t.FixedScaleAxis.super.constructor.call(this,d,i,this.ticks,c),this.stepLength=this.axisLength/this.divisor},projectValue:function a(d){return this.axisLength*(+t.getMultiValue(d,this.units.pos)-this.range.min)/(this.range.max-this.range.min)}})}(this||global,B),function(k,t){"use strict";t.StepAxis=t.Axis.extend({constructor:function r(d,n,i,c){t.StepAxis.super.constructor.call(this,d,i,c.ticks,c);var f=Math.max(1,c.ticks.length-(c.stretch?1:0));this.stepLength=this.axisLength/f},projectValue:function a(d,n){return this.stepLength*n}})}(this||global,B),function(k,t){"use strict";var r={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,showGridBackground:!1,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};t.Line=t.Base.extend({constructor:function d(n,i,c,f){t.Line.super.constructor.call(this,n,i,r,t.extend({},r,c),f)},createChart:function a(n){var i=t.normalizeData(this.data,n.reverseData,!0);this.svg=t.createSvg(this.container,n.width,n.height,n.classNames.chart);var v,x,c=this.svg.elem("g").addClass(n.classNames.gridGroup),f=this.svg.elem("g"),p=this.svg.elem("g").addClass(n.classNames.labelGroup),u=t.createChartRect(this.svg,n,r.padding);v=void 0===n.axisX.type?new t.StepAxis(t.Axis.units.x,i.normalized.series,u,t.extend({},n.axisX,{ticks:i.normalized.labels,stretch:n.fullWidth})):n.axisX.type.call(t,t.Axis.units.x,i.normalized.series,u,n.axisX),x=void 0===n.axisY.type?new t.AutoScaleAxis(t.Axis.units.y,i.normalized.series,u,t.extend({},n.axisY,{high:t.isNumeric(n.high)?n.high:n.axisY.high,low:t.isNumeric(n.low)?n.low:n.axisY.low})):n.axisY.type.call(t,t.Axis.units.y,i.normalized.series,u,n.axisY),v.createGridAndLabels(c,p,this.supportsForeignObject,n,this.eventEmitter),x.createGridAndLabels(c,p,this.supportsForeignObject,n,this.eventEmitter),n.showGridBackground&&t.createGridBackground(c,u,n.classNames.gridBackground,this.eventEmitter),i.raw.series.forEach(function(A,T){var S=f.elem("g");S.attr({"ct:series-name":A.name,"ct:meta":t.serialize(A.meta)}),S.addClass([n.classNames.series,A.className||n.classNames.series+"-"+t.alphaNumerate(T)].join(" "));var q=[],Q=[];i.normalized.series[T].forEach(function(_,Z){var U={x:u.x1+v.projectValue(_,Z,i.normalized.series[T]),y:u.y1-x.projectValue(_,Z,i.normalized.series[T])};q.push(U.x,U.y),Q.push({value:_,valueIndex:Z,meta:t.getMetaData(A,Z)})}.bind(this));var P={lineSmooth:t.getSeriesOption(A,n,"lineSmooth"),showPoint:t.getSeriesOption(A,n,"showPoint"),showLine:t.getSeriesOption(A,n,"showLine"),showArea:t.getSeriesOption(A,n,"showArea"),areaBase:t.getSeriesOption(A,n,"areaBase")},M=("function"==typeof P.lineSmooth?P.lineSmooth:P.lineSmooth?t.Interpolation.monotoneCubic():t.Interpolation.none())(q,Q);if(P.showPoint&&M.pathElements.forEach(function(_){var Z=S.elem("line",{x1:_.x,y1:_.y,x2:_.x+.01,y2:_.y},n.classNames.point).attr({"ct:value":[_.data.value.x,_.data.value.y].filter(t.isNumeric).join(","),"ct:meta":t.serialize(_.data.meta)});this.eventEmitter.emit("draw",{type:"point",value:_.data.value,index:_.data.valueIndex,meta:_.data.meta,series:A,seriesIndex:T,axisX:v,axisY:x,group:S,element:Z,x:_.x,y:_.y})}.bind(this)),P.showLine){var w=S.elem("path",{d:M.stringify()},n.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:i.normalized.series[T],path:M.clone(),chartRect:u,index:T,series:A,seriesIndex:T,seriesMeta:A.meta,axisX:v,axisY:x,group:S,element:w})}if(P.showArea&&x.range){var z=Math.max(Math.min(P.areaBase,x.range.max),x.range.min),j=u.y1-x.projectValue(z);M.splitByCommand("M").filter(function(Z){return Z.pathElements.length>1}).map(function(Z){var U=Z.pathElements[0],N=Z.pathElements[Z.pathElements.length-1];return Z.clone(!0).position(0).remove(1).move(U.x,j).line(U.x,U.y).position(Z.pathElements.length+1).line(N.x,j)}).forEach(function(Z){var U=S.elem("path",{d:Z.stringify()},n.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:i.normalized.series[T],path:Z.clone(),series:A,seriesIndex:T,axisX:v,axisY:x,chartRect:u,index:T,group:S,element:U})}.bind(this))}}.bind(this)),this.eventEmitter.emit("created",{bounds:x.bounds,chartRect:u,axisX:v,axisY:x,svg:this.svg,options:n})}})}(this||global,B),function(k,t){"use strict";var r={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,scaleMinSpace:30,onlyInteger:!1},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,high:void 0,low:void 0,referenceValue:0,chartPadding:{top:15,right:15,bottom:5,left:10},seriesBarDistance:15,stackBars:!1,stackMode:"accumulate",horizontalBars:!1,distributeSeries:!1,reverseData:!1,showGridBackground:!1,classNames:{chart:"ct-chart-bar",horizontalBars:"ct-horizontal-bars",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",bar:"ct-bar",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};t.Bar=t.Base.extend({constructor:function d(n,i,c,f){t.Bar.super.constructor.call(this,n,i,r,t.extend({},r,c),f)},createChart:function a(n){var i,c;n.distributeSeries?(i=t.normalizeData(this.data,n.reverseData,n.horizontalBars?"x":"y")).normalized.series=i.normalized.series.map(function(M){return[M]}):i=t.normalizeData(this.data,n.reverseData,n.horizontalBars?"x":"y"),this.svg=t.createSvg(this.container,n.width,n.height,n.classNames.chart+(n.horizontalBars?" "+n.classNames.horizontalBars:""));var f=this.svg.elem("g").addClass(n.classNames.gridGroup),p=this.svg.elem("g"),u=this.svg.elem("g").addClass(n.classNames.labelGroup);if(n.stackBars&&0!==i.normalized.series.length){var v=t.serialMap(i.normalized.series,function(){return Array.prototype.slice.call(arguments).map(function(w){return w}).reduce(function(w,z){return{x:w.x+(z&&z.x)||0,y:w.y+(z&&z.y)||0}},{x:0,y:0})});c=t.getHighLow([v],n,n.horizontalBars?"x":"y")}else c=t.getHighLow(i.normalized.series,n,n.horizontalBars?"x":"y");c.high=+n.high||(0===n.high?0:c.high),c.low=+n.low||(0===n.low?0:c.low);var A,T,S,q,Q,x=t.createChartRect(this.svg,n,r.padding);T=n.distributeSeries&&n.stackBars?i.normalized.labels.slice(0,1):i.normalized.labels,n.horizontalBars?(A=q=void 0===n.axisX.type?new t.AutoScaleAxis(t.Axis.units.x,i.normalized.series,x,t.extend({},n.axisX,{highLow:c,referenceValue:0})):n.axisX.type.call(t,t.Axis.units.x,i.normalized.series,x,t.extend({},n.axisX,{highLow:c,referenceValue:0})),S=Q=void 0===n.axisY.type?new t.StepAxis(t.Axis.units.y,i.normalized.series,x,{ticks:T}):n.axisY.type.call(t,t.Axis.units.y,i.normalized.series,x,n.axisY)):(S=q=void 0===n.axisX.type?new t.StepAxis(t.Axis.units.x,i.normalized.series,x,{ticks:T}):n.axisX.type.call(t,t.Axis.units.x,i.normalized.series,x,n.axisX),A=Q=void 0===n.axisY.type?new t.AutoScaleAxis(t.Axis.units.y,i.normalized.series,x,t.extend({},n.axisY,{highLow:c,referenceValue:0})):n.axisY.type.call(t,t.Axis.units.y,i.normalized.series,x,t.extend({},n.axisY,{highLow:c,referenceValue:0})));var P=n.horizontalBars?x.x1+A.projectValue(0):x.y1-A.projectValue(0),O=[];S.createGridAndLabels(f,u,this.supportsForeignObject,n,this.eventEmitter),A.createGridAndLabels(f,u,this.supportsForeignObject,n,this.eventEmitter),n.showGridBackground&&t.createGridBackground(f,x,n.classNames.gridBackground,this.eventEmitter),i.raw.series.forEach(function(M,w){var j,_,z=w-(i.raw.series.length-1)/2;j=n.distributeSeries&&!n.stackBars?S.axisLength/i.normalized.series.length/2:n.distributeSeries&&n.stackBars?S.axisLength/2:S.axisLength/i.normalized.series[w].length/2,(_=p.elem("g")).attr({"ct:series-name":M.name,"ct:meta":t.serialize(M.meta)}),_.addClass([n.classNames.series,M.className||n.classNames.series+"-"+t.alphaNumerate(w)].join(" ")),i.normalized.series[w].forEach(function(Z,U){var N,F,X,D;if(D=n.distributeSeries&&!n.stackBars?w:n.distributeSeries&&n.stackBars?0:U,N=n.horizontalBars?{x:x.x1+A.projectValue(Z&&Z.x?Z.x:0,U,i.normalized.series[w]),y:x.y1-S.projectValue(Z&&Z.y?Z.y:0,D,i.normalized.series[w])}:{x:x.x1+S.projectValue(Z&&Z.x?Z.x:0,D,i.normalized.series[w]),y:x.y1-A.projectValue(Z&&Z.y?Z.y:0,U,i.normalized.series[w])},S instanceof t.StepAxis&&(S.options.stretch||(N[S.units.pos]+=j*(n.horizontalBars?-1:1)),N[S.units.pos]+=n.stackBars||n.distributeSeries?0:z*n.seriesBarDistance*(n.horizontalBars?-1:1)),O[U]=(X=O[U]||P)-(P-N[S.counterUnits.pos]),void 0!==Z){var Y={};Y[S.units.pos+"1"]=N[S.units.pos],Y[S.units.pos+"2"]=N[S.units.pos],!n.stackBars||"accumulate"!==n.stackMode&&n.stackMode?(Y[S.counterUnits.pos+"1"]=P,Y[S.counterUnits.pos+"2"]=N[S.counterUnits.pos]):(Y[S.counterUnits.pos+"1"]=X,Y[S.counterUnits.pos+"2"]=O[U]),Y.x1=Math.min(Math.max(Y.x1,x.x1),x.x2),Y.x2=Math.min(Math.max(Y.x2,x.x1),x.x2),Y.y1=Math.min(Math.max(Y.y1,x.y2),x.y1),Y.y2=Math.min(Math.max(Y.y2,x.y2),x.y1);var V=t.getMetaData(M,U);F=_.elem("line",Y,n.classNames.bar).attr({"ct:value":[Z.x,Z.y].filter(t.isNumeric).join(","),"ct:meta":t.serialize(V)}),this.eventEmitter.emit("draw",t.extend({type:"bar",value:Z,index:U,meta:V,series:M,seriesIndex:w,axisX:q,axisY:Q,chartRect:x,group:_,element:F},Y))}}.bind(this))}.bind(this)),this.eventEmitter.emit("created",{bounds:A.bounds,chartRect:x,axisX:q,axisY:Q,svg:this.svg,options:n})}})}(this||global,B),function(k,t){"use strict";var r={width:void 0,height:void 0,chartPadding:5,classNames:{chartPie:"ct-chart-pie",chartDonut:"ct-chart-donut",series:"ct-series",slicePie:"ct-slice-pie",sliceDonut:"ct-slice-donut",sliceDonutSolid:"ct-slice-donut-solid",label:"ct-label"},startAngle:0,total:void 0,donut:!1,donutSolid:!1,donutWidth:60,showLabel:!0,labelOffset:0,labelPosition:"inside",labelInterpolationFnc:t.noop,labelDirection:"neutral",reverseData:!1,ignoreEmptyValues:!1};function a(i,c,f){var p=c.x>i.x;return p&&"explode"===f||!p&&"implode"===f?"start":p&&"implode"===f||!p&&"explode"===f?"end":"middle"}t.Pie=t.Base.extend({constructor:function n(i,c,f,p){t.Pie.super.constructor.call(this,i,c,r,t.extend({},r,f),p)},createChart:function d(i){var p,u,v,x,A,c=t.normalizeData(this.data),f=[],T=i.startAngle;this.svg=t.createSvg(this.container,i.width,i.height,i.donut?i.classNames.chartDonut:i.classNames.chartPie),u=t.createChartRect(this.svg,i,r.padding),v=Math.min(u.width()/2,u.height()/2),A=i.total||c.normalized.series.reduce(function(P,O){return P+O},0);var S=t.quantity(i.donutWidth);"%"===S.unit&&(S.value*=v/100),v-=i.donut&&!i.donutSolid?S.value/2:0,x="outside"===i.labelPosition||i.donut&&!i.donutSolid?v:"center"===i.labelPosition?0:i.donutSolid?v-S.value/2:v/2,x+=i.labelOffset;var q={x:u.x1+u.width()/2,y:u.y2+u.height()/2},Q=1===c.raw.series.filter(function(P){return P.hasOwnProperty("value")?0!==P.value:0!==P}).length;c.raw.series.forEach(function(P,O){f[O]=this.svg.elem("g",null,null)}.bind(this)),i.showLabel&&(p=this.svg.elem("g",null,null)),c.raw.series.forEach(function(P,O){if(0!==c.normalized.series[O]||!i.ignoreEmptyValues){f[O].attr({"ct:series-name":P.name}),f[O].addClass([i.classNames.series,P.className||i.classNames.series+"-"+t.alphaNumerate(O)].join(" "));var M=A>0?T+c.normalized.series[O]/A*360:0,w=Math.max(0,T-(0===O||Q?0:.2));M-w>=359.99&&(M=w+359.99);var _,Z,U,z=t.polarToCartesian(q.x,q.y,v,w),j=t.polarToCartesian(q.x,q.y,v,M),N=new t.Svg.Path(!i.donut||i.donutSolid).move(j.x,j.y).arc(v,v,0,M-T>180,0,z.x,z.y);i.donut?i.donutSolid&&(_=t.polarToCartesian(q.x,q.y,U=v-S.value,T-(0===O||Q?0:.2)),Z=t.polarToCartesian(q.x,q.y,U,M),N.line(_.x,_.y),N.arc(U,U,0,M-T>180,1,Z.x,Z.y)):N.line(q.x,q.y);var F=i.classNames.slicePie;i.donut&&(F=i.classNames.sliceDonut,i.donutSolid&&(F=i.classNames.sliceDonutSolid));var X=f[O].elem("path",{d:N.stringify()},F);if(X.attr({"ct:value":c.normalized.series[O],"ct:meta":t.serialize(P.meta)}),i.donut&&!i.donutSolid&&(X._node.style.strokeWidth=S.value+"px"),this.eventEmitter.emit("draw",{type:"slice",value:c.normalized.series[O],totalDataSum:A,index:O,meta:P.meta,series:P,group:f[O],element:X,path:N.clone(),center:q,radius:v,startAngle:T,endAngle:M}),i.showLabel){var D,Y;D=1===c.raw.series.length?{x:q.x,y:q.y}:t.polarToCartesian(q.x,q.y,x,T+(M-T)/2),Y=c.normalized.labels&&!t.isFalseyButZero(c.normalized.labels[O])?c.normalized.labels[O]:c.normalized.series[O];var V=i.labelInterpolationFnc(Y,O);if(V||0===V){var W=p.elem("text",{dx:D.x,dy:D.y,"text-anchor":a(q,D,i.labelDirection)},i.classNames.label).text(""+V);this.eventEmitter.emit("draw",{type:"label",index:O,group:p,element:W,text:""+V,x:D.x,y:D.y})}}T=M}}.bind(this)),this.eventEmitter.emit("created",{chartRect:u,svg:this.svg,options:i})},determineAnchorPosition:a})}(this||global,B),B}()}.apply(fe,[]),void 0!==I&&(Se.exports=I)}}]);
//# sourceMappingURL=apps_concierge_src_app_reports_reports_module_ts.js.map