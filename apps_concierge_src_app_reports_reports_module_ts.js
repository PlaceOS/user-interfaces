"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_reports_reports_module_ts"],{67229:(Li,$t,g)=>{g.r($t),g.d($t,{ReportsModule:()=>Oi});var y=g(26575),K=g(28849),Q=g(92649),Oe=g(97910),Ue=g(39687),t=g(29039),Le=g(42349),v=g(34592),D=g(10257),Y=g(94888);const Re=()=>["/reports","desks"];function Ee(s,i){1&s&&(t.TgZ(0,"a",4)(1,"app-icon",5),t._uU(2,"room"),t.qZA(),t.TgZ(3,"h3",6),t._uU(4,"Desks"),t.qZA(),t.TgZ(5,"div",7)(6,"p"),t._uU(7,"View Report"),t.qZA(),t.TgZ(8,"app-icon",8),t._uU(9,"chevron_right"),t.qZA()()()),2&s&&t.Q6J("routerLink",t.DdM(1,Re))}const Ne=()=>["/reports","bookings"];function Se(s,i){1&s&&(t.TgZ(0,"a",4)(1,"app-icon",5),t._uU(2,"meeting_room"),t.qZA(),t.TgZ(3,"h3",6),t._uU(4,"Rooms"),t.qZA(),t.TgZ(5,"div",7)(6,"p"),t._uU(7,"View Report"),t.qZA(),t.TgZ(8,"app-icon",8),t._uU(9,"chevron_right"),t.qZA()()()),2&s&&t.Q6J("routerLink",t.DdM(1,Ne))}const De=()=>["/reports","catering"];function ke(s,i){1&s&&(t.TgZ(0,"a",4)(1,"app-icon",5),t._uU(2,"room_service"),t.qZA(),t.TgZ(3,"h3",6),t._uU(4,"Catering"),t.qZA(),t.TgZ(5,"div",7)(6,"p"),t._uU(7,"View Report"),t.qZA(),t.TgZ(8,"app-icon",8),t._uU(9,"chevron_right"),t.qZA()()()),2&s&&t.Q6J("routerLink",t.DdM(1,De))}const ze=()=>["/reports","contact-tracing"];function Ie(s,i){1&s&&(t.TgZ(0,"a",4)(1,"app-icon",5),t._uU(2,"connect_without_contact"),t.qZA(),t.TgZ(3,"h3",6),t._uU(4,"Contact Tracing"),t.qZA(),t.TgZ(5,"div",7)(6,"p"),t._uU(7,"View Report"),t.qZA(),t.TgZ(8,"app-icon",8),t._uU(9,"chevron_right"),t.qZA()()()),2&s&&t.Q6J("routerLink",t.DdM(1,ze))}const Ye=s=>["/reports",s];function je(s,i){if(1&s&&(t.TgZ(0,"a",4)(1,"app-icon",5),t._uU(2),t.qZA(),t.TgZ(3,"h3",6),t._uU(4),t.qZA(),t.TgZ(5,"div",7)(6,"p"),t._uU(7,"View Report"),t.qZA(),t.TgZ(8,"app-icon",8),t._uU(9,"chevron_right"),t.qZA()()()),2&s){const n=i.$implicit;t.Q6J("routerLink",t.VKq(3,Ye,n.id)),t.xp6(2),t.Oqu(n.icon),t.xp6(2),t.Oqu(n.name)}}const qe=["desks","spaces","catering","contact-tracing"];let Kt=(()=>{class s{get custom_reports(){return this._settings.get("app.custom_reports")||[]}get features(){return this._settings.get("app.reports.features")||qe}constructor(n){this._settings=n}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(v.gb))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["reports-menu"],["","reports-menu",""]],decls:7,vars:5,consts:[[1,"absolute","inset-0","flex","items-center","justify-center","bg-base-200","overflow-auto"],[1,"grid","w-full","justify-items-center"],["matRipple","","class","h-64 w-64 p-4 flex flex-col items-center justify-center bg-base-100 rounded shadow hover:opacity-80 border border-base-200",3,"routerLink",4,"ngIf"],["matRipple","","class","h-64 w-64 p-4 flex flex-col items-center justify-center bg-base-100 rounded shadow hover:opacity-80 border border-base-200",3,"routerLink",4,"ngFor","ngForOf"],["matRipple","",1,"h-64","w-64","p-4","flex","flex-col","items-center","justify-center","bg-base-100","rounded","shadow","hover:opacity-80","border","border-base-200",3,"routerLink"],[1,"text-8xl"],[1,"text-xl","font-bold","mb-4"],[1,"flex","items-center"],[1,"ml-2"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Ee,10,2,"a",2)(3,Se,10,2,"a",2)(4,ke,10,2,"a",2)(5,Ie,10,2,"a",2)(6,je,10,5,"a",3),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngIf",o.features.includes("desks")),t.xp6(),t.Q6J("ngIf",o.features.includes("spaces")),t.xp6(),t.Q6J("ngIf",o.features.includes("catering")),t.xp6(),t.Q6J("ngIf",o.features.includes("contact-tracing")),t.xp6(),t.Q6J("ngForOf",o.custom_reports))},dependencies:[y.sg,y.O5,D.wG,Y.o,Q.rH],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row!important;align-items:center;justify-content:center;background:inherit}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(16rem,1fr));gap:1rem}\n\n/*# sourceMappingURL=reports-menu.component.ts-angular-inline--135.css.map*/"]})}return s})();const Je=["app-reports",""];function Be(s,i){1&s&&t._UZ(0,"div",3)}let Pe=(()=>{class s{get path(){const n=this._router.url.split("/");return n[n.length-1]}constructor(n){this._router=n}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(Q.F0))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["","app-reports",""]],attrs:Je,decls:4,vars:1,consts:[[1,"h-full","screen-only"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full","bg-base-200"],["reports-menu","","class","absolute inset-0 screen-only",4,"ngIf"],["reports-menu","",1,"absolute","inset-0","screen-only"]],template:function(e,o){1&e&&(t._UZ(0,"sidebar",0),t.TgZ(1,"main",1),t._UZ(2,"router-outlet"),t.YNc(3,Be,1,0,"div",2),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngIf","reports"===o.path))},dependencies:[y.O5,Le.k,Q.lC,Kt],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%}main[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(router-outlet){display:flex;flex-direction:column;width:100%;height:100%}\n\n/*# sourceMappingURL=reports.component.ts-angular-inline--131.css.map*/"]})}return s})();var te=g(47049),vt=g(10060),k=g(71670),Qe=g(17627),G=g(93121),ee=g(47298),Fe=g(78466),St=g(39916),j=g(14884),ne=g(83106),tt=g(57016),Xe=g(58415),et=g(4512),lt=g(65822),yt=g(67343),Ge=g(27508),Ve=g(32484),st=g(70462),V=g(9681),He=g(92130),F=g(28159),xt=g(95933),it=g(36520),ct=g(58175),Z=g(47422),q=g(680),Ke=g(60942);const Dt={0:"sunday",1:"monday",2:"tuesday",3:"wednesday",4:"thurday",5:"friday",6:"saturday"};let R=(()=>{class s{get duration(){const n=this._options.getValue(),e=this._settings.get("app.reports.ignore_days")?.map(l=>"string"==typeof l?l.toLowerCase():(0,j.Z)((0,ne.Z)(new Date,l),"eeee").toLowerCase())||[];let o=(0,tt.Z)(n.start);const a=(0,Xe.Z)((0,et.Z)(n.end),1);let r=0;for(;o.valueOf()<a.valueOf();)e.includes(Dt[o.getDay()])||r++,o=(0,lt.Z)(o,1);return Math.max(1,r)}constructor(n,e){var o=this;this._org=n,this._settings=e,this._space_pipe=new Ke.X(this._org),this._generate=new Ve.xQ,this._loading=new st.X(""),this._active_bookings=new st.X([]),this._options=new st.X({start:new Date,end:new Date}),this._bookings_list=this._generate.pipe((0,xt.b)(500),(0,it.w)(a=>{const r=this._options.getValue();if(this._loading.next("Loading report details..."),!r?.type&&!r?.zones?.length)return(0,V.of)([]);const l=(0,tt.Z)(r.start||Date.now()),u=(0,et.Z)(r.end||l),c=r?.zones?r.zones.filter(f=>"All"!==f).join(","):"",p={period_start:(0,yt.Z)(l),period_end:(0,yt.Z)(u)};return"desks"===r.type?(0,Fe.NP)({...p,zones:c,type:"desk",limit:1e3}):(0,St.CA)({...p,zone_ids:c,limit:1e3}).pipe((0,it.w)(function(){var f=(0,k.Z)(function*(d){return Promise.all(d.map(function(){var h=(0,k.Z)(function*(m){return new St.ym({...m,resources:(yield Promise.all(m.resources.map(b=>o._space_pipe.transform(b.id||b.email)))).filter(b=>r.zones.find(_=>b.zones.includes(_)))})});return function(m){return h.apply(this,arguments)}}()))});return function(d){return f.apply(this,arguments)}}()))}),(0,ct.K)(a=>[]),(0,Z.U)(a=>{this._loading.next(""),a?.length||(0,v.cB)("No bookings for the selected levels and period");const r=this._settings.get("app.reports.ignore_days")?.map(l=>"string"==typeof l?l.toLowerCase():(0,j.Z)((0,ne.Z)(new Date,l),"eeee").toLowerCase())||[];return a=a.filter(l=>!r.includes(Dt[new Date(l.date).getDay()])),this._active_bookings.next(a||[]),a}),(0,q.d)(1)),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.bookings=this._active_bookings.asObservable(),this.spaces=this._options.pipe((0,it.w)(({zones:a})=>{const r=this._settings.get("app.use_region");return a?.length||(a=[(r?this._org.building?.parent_id:this._org.building?.id)||this._org.building?.id]),(0,He.D)(a.map(l=>(0,te.u2)(l).pipe((0,ct.K)(()=>(0,V.of)([])))))}),(0,Z.U)(a=>(0,v.xH)(a)),(0,q.d)(1)),this.counts=this._options.pipe((0,xt.b)(500),(0,it.w)(a=>{const r=(a.zones||[]).filter(l=>-1!==l&&"All"!==l);return"events"===a.type?this.spaces.pipe((0,Z.U)(l=>r.map(u=>[u,l.filter(c=>c.zones.includes(u)).length]))):Promise.all(r.map(l=>(0,ee.rlq)(l,"desks").pipe((0,Z.U)(u=>[l,u.details.length])).toPromise()))}),(0,ct.K)(a=>[]),(0,Z.U)(a=>{const r={};return this._active_bookings.next([]),a.forEach(([l,u])=>r[l]=u),r}),(0,q.d)()),this.stats=(0,F.aj)([this.counts,this.bookings]).pipe((0,it.w)(function(){var a=(0,k.Z)(function*([r,l]){return l[0]instanceof St.ym?function $e(s,i=8,n={}){i=Math.max(1,i);const e=s.reduce((u,c)=>u+c.attendees.length,0),o=s.reduce((u,c)=>u+c.system?.capacity,0),a=Math.floor(s.reduce((u,c)=>u+c.duration,0)/(60*i)*100)/100,r=Math.floor(e/o*100)/100,l=Object.keys(n).reduce((u,c)=>u+(n[c]||0),0);return{count:s.length,avg_length:Math.floor(s.reduce((u,c)=>u+c.duration,0)/s.length*100)/100,efficiency:Math.floor((a+r)/2*100)/100,total:l,total_users:e,total_capacity:o,occupancy:r,utilisation:a,events:s}}(l,8*o.duration,r):function We(s,i=1,n={}){i=Math.max(1,i);const e=Object.keys(n).reduce((a,r)=>a+(n[r]||0),0),o=Math.floor(s.length/e/i*1e4)/1e4;return{total:e,count:s.length,utilisation:o,events:s}}(l||[],o.duration,r)});return function(r){return a.apply(this,arguments)}}())),this.day_list=(0,F.aj)([this.options,this.stats]).pipe((0,Z.U)(([a,r])=>{const{start:l}=a;let u=(0,tt.Z)(l);const c=(0,et.Z)(a.end||u),p=[],f=this._settings.get("app.reports.ignore_days")?.map(d=>d.toLowerCase())||[];for(console.log("Stats:",r);(0,Ge.Z)(u,c);){if(f.includes(Dt[u.getDay()])){u=(0,lt.Z)(u,1);continue}const d=(0,tt.Z)(u).valueOf(),h=(0,et.Z)(d).valueOf(),m=r.events.filter(_=>(0,v.MZ)(d,h,_.date,_.date+60*_.duration*1e3)),b="desks"===a.type?(0,v.Tw)(m,"system_id").length:(0,v.Tw)(m,"asset_id").length;p.push({date:d,total:r.total,usage:b,free:r.total-m.length,approved:m.reduce((_,M)=>_+(M.approved||"approved"===M.status?1:0),0),count:m.length,utilisation:(m.length/r.total*100).toFixed(1)}),u=(0,lt.Z)(u,1)}return p}),(0,q.d)(1)),this._bookings_list.subscribe(a=>a)}generateReport(){this._generate.next((new Date).valueOf())}setOptions(n){n.zones?.includes("All")?n.zones=["All",...this._org.levelsForBuilding(this._org.building).map(e=>e.id)]:n.zones&&this._options.getValue()?.zones?.includes("All")&&(n.zones=[]),n.start?.valueOf()!==this._options.getValue().start?.valueOf()&&n.end?.valueOf()!==this._options.getValue().end?.valueOf()&&this._options.next({...this._options.getValue(),...n})}downloadReport(){const n=this._options.getValue(),e=this._active_bookings.getValue();(0,v.Sv)(`report+${n.type}+${(0,j.Z)(n.start,"yyyy-MM-dd")}+${(0,j.Z)(n.end,"yyyy-MM-dd")}.tsv`,(0,v.o3)(e.map(o=>{const a=o.toJSON();return delete a.zones,delete a.server_names,delete a.extension_data,a}),"\t"))}static#t=this.\u0275fac=function(e){return new(e||s)(t.LFG(G.w7),t.LFG(v.gb))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var bt=g(71268),tn=g(96355),J=g(82226),wt=g(33910);function en(s,i){if(1&s&&(t.TgZ(0,"mat-option",14),t._uU(1),t.qZA()),2&s){const n=i.$implicit;t.Q6J("value",n.id),t.xp6(),t.hij(" ",n.display_name||n.name," ")}}function nn(s,i){1&s&&t._UZ(0,"mat-spinner",15),2&s&&t.Q6J("diameter",32)}function sn(s,i){1&s&&(t.TgZ(0,"p"),t._uU(1,"Generate Report"),t.qZA())}let Zt=(()=>{class s extends v.cx{constructor(n,e,o,a){super(),this._state=n,this._org=e,this._route=o,this._router=a,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(r=>`${r.id}`),this.levels=this._org.active_levels,this.loading=this._state.loading,this.bookings=this._state.bookings,this.options=this._state.options,this.page="",this.generateReport=()=>this._state.generateReport(),this.downloadReport=()=>this._state.downloadReport(),this.setStartDate=r=>{r instanceof Date&&(r=r.valueOf()),this._router.navigate([],{relativeTo:this._route,queryParams:{start:r},queryParamsHandling:"merge"})},this.setEndDate=r=>{r instanceof Date&&(r=r.valueOf()),this._router.navigate([],{relativeTo:this._route,queryParams:{end:r},queryParamsHandling:"merge"})},this.setZones=r=>{this._state.setOptions({zones:r}),this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:r.join(",")},queryParamsHandling:"merge"})}}ngOnInit(){var n=this;return(0,k.Z)(function*(){yield n._org.initialised.pipe((0,Qe.P)(e=>e)).toPromise(),n.page=n._router.url,n.subscription("routing",n._router.events.subscribe(()=>{n.page=n._router.url})),n.subscription("route.query",n._route.queryParamMap.subscribe(e=>{if(e.has("zone_ids")){const o=e.get("zone_ids").split(",");if(o.length){const a=n._org.levelWithID(o);if(!a)return;n._org.building=n._org.buildings.find(r=>r.id===a.parent_id),n.setZones(o)}}e.has("start")&&n._state.setOptions({start:new Date(+e.get("start"))}),e.has("end")&&n._state.setOptions({end:new Date(+e.get("end"))})}))})()}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R),t.Y36(G.w7),t.Y36(Q.gz),t.Y36(Q.F0))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["reports-options"]],features:[t.qOj],decls:28,vars:28,consts:[[1,"bg-base-100","h-20","w-full","flex","items-center","px-2","shadow","z-20","border-b","border-base-200","screen-only"],["appearance","outline",1,"w-48"],["multiple","","placeholder","Select Levels...",3,"ngModel","ngModelChange"],["value","All"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"w-64"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["btn","","matRipple","",1,"ml-4",3,"disabled","click"],[3,"diameter",4,"ngIf"],[4,"ngIf"],[3,"value"],[3,"diameter"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-select",2),t.NdJ("ngModelChange",function(r){return o.setZones(r)}),t.ALo(3,"async"),t.TgZ(4,"mat-option",3),t._uU(5,"All Levels"),t.qZA(),t.YNc(6,en,2,2,"mat-option",4),t.ALo(7,"async"),t.qZA()(),t.TgZ(8,"mat-form-field",5)(9,"mat-date-range-input",6)(10,"input",7),t.NdJ("ngModelChange",function(r){return r?o.setStartDate(r):""}),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"input",8),t.NdJ("ngModelChange",function(r){return r?o.setEndDate(r):""}),t.ALo(13,"async"),t.qZA()(),t._UZ(14,"mat-datepicker-toggle",9)(15,"mat-date-range-picker",null,10),t.qZA(),t.TgZ(17,"button",11),t.NdJ("click",function(){return o.generateReport()}),t.ALo(18,"async"),t.ALo(19,"async"),t.YNc(20,nn,1,1,"mat-spinner",12),t.ALo(21,"async"),t.YNc(22,sn,2,0,"p",13),t.ALo(23,"async"),t.qZA(),t.TgZ(24,"button",11),t.NdJ("click",function(){return o.downloadReport()}),t.ALo(25,"async"),t.TgZ(26,"p"),t._uU(27,"Download Data"),t.qZA()()()),2&e){const a=t.MAs(16);let r,l,u,c,p;t.xp6(2),t.Q6J("ngModel",null==(r=t.lcZ(3,10,o.options))?null:r.zones),t.xp6(4),t.Q6J("ngForOf",t.lcZ(7,12,o.levels)),t.xp6(3),t.Q6J("rangePicker",a),t.xp6(),t.Q6J("ngModel",null==(l=t.lcZ(11,14,o.options))?null:l.start),t.xp6(2),t.Q6J("ngModel",null==(u=t.lcZ(13,16,o.options))?null:u.end),t.xp6(2),t.Q6J("for",a),t.xp6(3),t.Q6J("disabled",!!t.lcZ(18,18,o.loading)||!(null!=(c=t.lcZ(19,20,o.options))&&null!=c.zones&&c.zones.length)),t.xp6(3),t.Q6J("ngIf",t.lcZ(21,22,o.loading)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(23,24,o.loading)),t.xp6(2),t.Q6J("disabled",!(null!=(p=t.lcZ(25,26,o.bookings))&&p.length))}},dependencies:[y.sg,y.O5,K.Fj,K.JJ,K.On,bt.KE,bt.R9,tn.gD,D.ey,J.nW,J.wx,J.zY,J.By,J._g,wt.Ou,D.wG,y.Ov],styles:["button[_ngcontent-%COMP%]{min-width:0;padding:0 .85rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;margin-left:1em}mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:5.5em;white-space:initial;line-height:1.2em}\n\n/*# sourceMappingURL=reports-options.component.ts-angular-inline--132.css.map*/"]})}return s})();var At=g(81886),on=g(7746),an=g(77393),se=g(33142),kt=g(47120),ie=g(67265);function rn(s){(0,ie.Z)(1,arguments);var n=(0,kt.Z)(s).getDay();return 0===n||6===n}var ln=g(21578),zt=g(6324);function un(s,i){if(1&s&&(t.TgZ(0,"div",3)(1,"div",4)(2,"h3"),t._uU(3,"No show count"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"async"),t.qZA()(),t.TgZ(7,"div",4)(8,"h3"),t._uU(9,"% of No show Bookings"),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.ALo(12,"async"),t.qZA()(),t.TgZ(13,"div",4)(14,"h3"),t._uU(15,"Total in-room attendance"),t.qZA(),t.TgZ(16,"p"),t._uU(17),t.ALo(18,"async"),t.qZA()()()),2&s){const n=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,3,n.no_shows)||0),t.xp6(6),t.hij("",t.lcZ(12,5,n.no_show_percent)||0,"%"),t.xp6(6),t.Oqu(t.lcZ(18,7,n.attendance)||0)}}let pn=(()=>{class s{constructor(n){this._state=n,this.business_days=this._state.options.pipe((0,Z.U)(({start:e,end:o})=>function cn(s,i){(0,ie.Z)(2,arguments);var n=(0,kt.Z)(s),e=(0,kt.Z)(i);if(!(0,se.Z)(n)||!(0,se.Z)(e))return NaN;var o=(0,on.Z)(n,e),a=o<0?-1:1,r=(0,ln.Z)(o/7),l=5*r;for(e=(0,lt.Z)(e,7*r);!(0,an.Z)(n,e);)l+=rn(e)?0:a,e=(0,lt.Z)(e,a);return 0===l?0:l}((0,tt.Z)(o||Date.now()),(0,et.Z)(e||Date.now()))||1)),this.total_count=this._state.stats.pipe((0,Z.U)(e=>e.count||0)),this.avg_length=this._state.stats.pipe((0,Z.U)(e=>(0,zt.Z)({minutes:Math.floor(e.avg_length||0)}))),this.attendance=this._state.stats.pipe((0,Z.U)(({events:e})=>e.reduce((o,{extension_data:a})=>o+(+a?.people_count?.max||0),0))),this.no_shows=this._state.stats.pipe((0,Z.U)(({events:e})=>e.reduce((o,{extension_data:a})=>o+ +a?.people_count?.max?1:0,0))),this.no_show_percent=this._state.stats.pipe((0,Z.U)(({events:e})=>Math.floor(e.reduce((o,{extension_data:a})=>o+ +a?.people_count?.max?1:0,0)/e.length*1e4)/100)),this.has_attendance=this._state.stats.pipe((0,Z.U)(({events:e})=>!!e.find(({extension_data:o})=>!!o?.people_count)))}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["report-spaces-overall"]],decls:21,vars:12,consts:[[1,"m-4","p-4","rounded","bg-base-100","border","border-base-200","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],["class","m-4 p-4 rounded bg-base-100 shadow flex justify-center items-center space-x-2",4,"ngIf"],[1,"m-4","p-4","rounded","bg-base-100","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex-1","flex","flex-col","items-center","justify-center"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3,"Business Days"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"async"),t.qZA()(),t.TgZ(7,"div",1)(8,"h3"),t._uU(9,"Total Bookings"),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.ALo(12,"async"),t.qZA()(),t.TgZ(13,"div",1)(14,"h3"),t._uU(15,"Average Booking Length"),t.qZA(),t.TgZ(16,"p"),t._uU(17),t.ALo(18,"async"),t.qZA()()(),t.YNc(19,un,19,9,"div",2),t.ALo(20,"async")),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,4,o.business_days)||0),t.xp6(6),t.Oqu(t.lcZ(12,6,o.total_count)||0),t.xp6(6),t.Oqu(t.lcZ(18,8,o.avg_length)||"None"),t.xp6(2),t.Q6J("ngIf",t.lcZ(20,10,o.has_attendance)))},dependencies:[y.O5,y.Ov],styles:["h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n\n/*# sourceMappingURL=report-spaces-overall.component.ts-angular-inline--136.css.map*/"]})}return s})();var H=g(46939),W=g(27442);function dn(s,i){if(1&s){const n=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.download())}),t.TgZ(1,"app-icon"),t._uU(2,"download"),t.qZA()()}}function mn(s,i){1&s&&(t._uU(0),t.ALo(1,"date")),2&s&&t.hij(" ",t.xi3(1,1,i.data,"mediumDate")," ")}function hn(s,i){1&s&&t._uU(0),2&s&&t.hij(" ",i.data||"0","% ")}const fn=()=>["date","approved","count","utilisation"],gn=()=>["Date","Approved Bookings","Total Requests","Utilisation"],_n=()=>["flex"],vn=(s,i,n)=>({date:s,usage:i,utilisation:n});let yn=(()=>{class s{constructor(n){var e=this;this._state=n,this.print=!1,this.day_list=this._state.day_list,this.download=(0,k.Z)(function*(){let o=yield e.day_list.pipe((0,H.q)(1)).toPromise();o=o.map(a=>({...a,date:(0,j.Z)(a.date,"MMMM d, y(EEE)")})),(0,v.Sv)("spaces-usage.csv",(0,v.o3)(o))})}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["report-spaces-overall-list"]],inputs:{print:"print"},decls:11,vars:14,consts:[[1,"pb-2","w-full"],[1,"m-4","rounded","bg-base-100","border","border-base-200","shadow","overflow-hidden"],[1,"border-b","border-base-200","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["icon","","matRipple","",3,"click",4,"ngIf"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["date_view",""],["percent_view",""],["icon","","matRipple","",3,"click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t._uU(4,"Daily Utilisation"),t.qZA(),t.YNc(5,dn,3,0,"button",4),t.qZA(),t._UZ(6,"custom-table",5),t.YNc(7,mn,2,4,"ng-template",null,6,t.W1O)(9,hn,1,1,"ng-template",null,7,t.W1O),t.qZA()()),2&e){const a=t.MAs(8),r=t.MAs(10);t.xp6(5),t.Q6J("ngIf",!o.print),t.xp6(),t.Q6J("dataSource",o.day_list)("pagination",!o.print)("columns",t.DdM(7,fn))("display_column",t.DdM(8,gn))("column_size",t.DdM(9,_n))("template",t.kEZ(10,vn,a,r,r))}},dependencies:[y.O5,D.wG,Y.o,W.C,y.uU],encapsulation:2})}return s})();var oe=g(49520);function xn(s,i){if(1&s){const n=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.download())}),t.TgZ(1,"app-icon"),t._uU(2,"download"),t.qZA()()}}const bn=()=>["flex"];let wn=(()=>{class s{constructor(n){var e=this;this._reports=n,this.print=!1,this.space_list=(0,F.aj)([this._reports.stats,this._reports.options]).pipe((0,xt.b)(300),(0,Z.U)(([o,{start:a,end:r}])=>{let l=[],u=!1;for(const p of o.events){const f=(0,v.Tw)(p.resources,"email")||[p.system];for(const d of f){let h=l.find(m=>m.id===d.id||m.id?.toLowerCase()===d.email.toLowerCase());if(!h){if(h={id:d.id||d.email,name:d.display_name||d.name,capacity:d.capacity||1,booking_count:0,attendance:0,avg_attendance:0,min_attendance:99,max_attendance:0,attendees:0,avg_attendees:0,usage:0,no_shows:0,utilisation:0,occupancy:0},!h.id||!h.name)continue;l.push(h)}0===p.extension_data?.people_count?.max&&(h.no_shows+=1),h.booking_count+=1,h.attendance+=p.extension_data?.people_count?.max??0,h.avg_attendance+=p.extension_data?.people_count?.avg??0,h.min_attendance=Math.min(h.max_attendance,p.extension_data?.people_count?.max??99),h.max_attendance=Math.max(h.max_attendance,p.extension_data?.people_count?.max??0),h.usage+=p.duration,h.attendees+=p.attendees.length,u=u||!!p.extension_data.people_count}}const c=Math.max(1,(0,oe.Z)(r,a)+1);for(const p of l)p.avg_attendees=Math.floor(p.attendees/p.booking_count*100)/100,p.avg_attendance=Math.floor(p.attendance/p.booking_count*100)/100,p.utilisation=`${Math.floor(p.usage/60/8/c*100)}%`,p.min_attendance=99===p.min_attendance?"?":p.min_attendance,p.occupancy=Math.floor(p.avg_attendees/p.capacity*1e3)/10+"%",(p.attendance<0||!u)&&(p.attendance="?",p.avg_attendance="?");return l})),this.has_attendance=this.space_list.pipe((0,Z.U)(o=>!!o.find(({attendance:a})=>"?"!==a))),this.column_list=this.has_attendance.pipe((0,Z.U)(o=>o?["name","capacity","booking_count","utilisation","avg_attendees","no_shows","min_attendance","max_attendance","occupancy"]:["name","capacity","booking_count","utilisation","avg_attendees","occupancy"])),this.column_name_list=this.has_attendance.pipe((0,Z.U)(o=>o?["Name","Room Capacity","Bookings","% Time booked during office hrs","Avg. invitees per booking","No Shows","Min. In-room Attendance","Max. In-room Attendance","Occupancy %"]:["Name","Room Capacity","Bookings","% Time booked during office hrs","Avg. invitees per booking"])),this.download=(0,k.Z)(function*(){const o=yield e.space_list.pipe((0,H.q)(1)).toPromise();for(const a of o)delete a.attendance,delete a.avg_attendance,delete a.no_shows,delete a.min_attendance,delete a.max_attendance;(0,v.Sv)("report-spaces-usage.csv",(0,v.o3)(o))})}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["report-spaces-space-listing"]],inputs:{print:"print"},decls:8,vars:11,consts:[[1,"m-4","rounded","bg-base-100","border","border-base-200","shadow","overflow-hidden"],[1,"border-b","border-base-200","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["icon","","matRipple","",3,"click",4,"ngIf"],[3,"dataSource","pagination","columns","display_column","column_size"],["icon","","matRipple","",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),t._uU(3,"Room Utilisation"),t.qZA(),t.YNc(4,xn,3,0,"button",3),t.qZA(),t._UZ(5,"custom-table",4),t.ALo(6,"async"),t.ALo(7,"async"),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",!o.print),t.xp6(),t.Q6J("dataSource",o.space_list)("pagination",!o.print)("columns",t.lcZ(6,6,o.column_list))("display_column",t.lcZ(7,8,o.column_name_list))("column_size",t.DdM(10,bn)))},dependencies:[y.O5,D.wG,Y.o,W.C,y.Ov]})}return s})();function Zn(s,i){if(1&s){const n=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.download())}),t.TgZ(1,"app-icon"),t._uU(2,"download"),t.qZA()()}}const An=()=>["name","booking_count","avg_attendees","total_time","no_shows"],Cn=()=>["Name","Bookings","Avg. Invitees per Booking","Total Booked Time","No Shows"],Mn=()=>["flex"];let Tn=(()=>{class s{constructor(n){var e=this;this._reports=n,this.print=!1,this.user_list=(0,F.aj)([this._reports.stats]).pipe((0,xt.b)(300),(0,Z.U)(([o])=>{let a=[];for(const r of o.events){const l=r.attendees?.find(p=>p.email===r.extension_data?.host_override||p.email===r.host);if(!l)continue;const u=Math.max(r.resources.reduce((p,f)=>p+f.capacity,0)||1,1);let c=a.find(p=>p.id?.toLowerCase()===l.email.toLowerCase());c||(c={id:l.email,name:l.name,capacity:u,booking_count:0,attendees:0,avg_attendees:0,no_shows:0,occupancy:0,total_time:0},a.push(c)),0===r.extension_data?.people_count?.max&&(c.no_shows+=1),c.booking_count+=1,c.attendees+=r.attendees.length,c.total_time+=r.duration||15}for(const r of a)r.avg_attendees=Math.floor(r.attendees/r.booking_count*100)/100,r.occupancy=Math.floor(r.avg_attendees/r.capacity*100)/100,r.total_time=(0,zt.Z)({hours:Math.floor(r.total_time/60),minutes:r.total_time%60});return a}),(0,q.d)(1)),this.download=(0,k.Z)(function*(){const o=yield e.user_list.pipe((0,H.q)(1)).toPromise();for(const a of o)delete a.attendance,delete a.avg_attendance,delete a.min_attendance,delete a.max_attendance,delete a.occupancy;(0,v.Sv)("report-space-attendee-usage.csv",(0,v.o3)(o))})}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["report-spaces-user-listing"]],inputs:{print:"print"},decls:6,vars:9,consts:[[1,"m-4","rounded","bg-base-100","border","border-base-200","shadow","overflow-hidden"],[1,"border-b","border-base-200","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["icon","","matRipple","",3,"click",4,"ngIf"],[3,"dataSource","pagination","columns","display_column","column_size"],["icon","","matRipple","",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),t._uU(3,"Meeting Organisers"),t.qZA(),t.YNc(4,Zn,3,0,"button",3),t.qZA(),t._UZ(5,"custom-table",4),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",!o.print),t.xp6(),t.Q6J("dataSource",o.user_list)("pagination",!o.print)("columns",t.DdM(6,An))("display_column",t.DdM(7,Cn))("column_size",t.DdM(8,Mn)))},dependencies:[y.O5,D.wG,Y.o,W.C]})}return s})();const On=["report-spaces",""];function Un(s,i){if(1&s&&(t.ynx(0),t._UZ(1,"report-spaces-overall")(2,"report-spaces-overall-list",5)(3,"report-spaces-space-listing",5)(4,"report-spaces-user-listing",5),t.BQk()),2&s){const n=t.oxw(2);t.xp6(2),t.Q6J("print",n.printing),t.xp6(),t.Q6J("print",n.printing),t.xp6(),t.Q6J("print",n.printing)}}function Ln(s,i){if(1&s&&(t.ynx(0),t.YNc(1,Un,5,3,"ng-container",1),t.ALo(2,"async"),t.BQk()),2&s){const n=t.oxw(),e=t.MAs(7);t.xp6(),t.Q6J("ngIf",t.lcZ(2,2,n.total_count))("ngIfElse",e)}}function Rn(s,i){1&s&&(t.TgZ(0,"div",6),t._UZ(1,"mat-spinner",7),t.TgZ(2,"p",8),t._uU(3,"Loading report data..."),t.qZA()()),2&s&&(t.xp6(),t.Q6J("diameter",32))}function En(s,i){1&s&&(t.TgZ(0,"div",9)(1,"p",8),t._uU(2," Select levels and time period to generate a report. "),t.qZA()())}function Nn(s,i){if(1&s){const n=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.print())}),t.TgZ(1,"app-icon"),t._uU(2,"print"),t.qZA()()}}let Sn=(()=>{class s{constructor(n){this._state=n,this.printing=!1,this.total_count=this._state.stats.pipe((0,Z.U)(e=>e.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}print(){this.printing=!0,setTimeout(()=>{window.print(),this.printing=!1},300)}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["","report-spaces",""]],attrs:On,decls:10,vars:7,consts:[["printable","",1,"relative","flex-1","h-1/2","w-full","overflow-auto","print:overflow-visible","print:h-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],["icon","","matRipple","","class","absolute top-24 left-4 bg-secondary text-secondary-content border border-base-200 shadow z-20 print:hidden",3,"click",4,"ngIf"],[3,"print"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""],[1,"h-full","w-full","flex","flex-col","items-center","p-8","screen-only"],["icon","","matRipple","",1,"absolute","top-24","left-4","bg-secondary","text-secondary-content","border","border-base-200","shadow","z-20","print:hidden",3,"click"]],template:function(e,o){if(1&e&&(t._UZ(0,"reports-options"),t.TgZ(1,"div",0),t.YNc(2,Ln,3,4,"ng-container",1),t.ALo(3,"async"),t.qZA(),t.YNc(4,Rn,4,1,"ng-template",null,2,t.W1O)(6,En,3,0,"ng-template",null,3,t.W1O)(8,Nn,3,0,"button",4),t.ALo(9,"async")),2&e){const a=t.MAs(5);t.xp6(2),t.Q6J("ngIf",!t.lcZ(3,3,o.loading))("ngIfElse",a),t.xp6(6),t.Q6J("ngIf",t.lcZ(9,5,o.total_count))}},dependencies:[y.O5,wt.Ou,D.wG,Y.o,At.o,Zt,pn,yn,wn,Tn,y.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}\n\n/*# sourceMappingURL=report-spaces.component.ts-angular-inline--133.css.map*/"]})}return s})();function Dn(s,i){if(1&s){const n=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.download())}),t.TgZ(1,"app-icon"),t._uU(2,"download"),t.qZA()()}}function kn(s,i){1&s&&(t._uU(0),t.ALo(1,"date")),2&s&&t.hij(" ",t.xi3(1,1,i.data,"mediumDate")," ")}function zn(s,i){1&s&&t._uU(0),2&s&&t.hij(" ",i.data||"0","% ")}const In=()=>["date","approved","count","utilisation"],Yn=()=>["Date","Approved Bookings","Total Requests","Utilisation"],jn=()=>["flex"],qn=(s,i,n)=>({date:s,usage:i,utilisation:n});let Jn=(()=>{class s{constructor(n){var e=this;this._state=n,this.print=!1,this.day_list=this._state.day_list,this.download=(0,k.Z)(function*(){let o=yield e.day_list.pipe((0,H.q)(1)).toPromise();o=o.map(a=>({...a,date:(0,j.Z)(a.date,"MMMM d, y(EEE)")})),(0,v.Sv)("desks-usage.csv",(0,v.o3)(o))})}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["report-desks-overall-list"]],inputs:{print:"print"},decls:11,vars:14,consts:[[1,"pb-2","w-full"],[1,"m-4","rounded","bg-base-100","border","border-base-200","shadow","overflow-hidden"],[1,"border-b","border-base-200","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["icon","","matRipple","",3,"click",4,"ngIf"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["date_view",""],["percent_view",""],["icon","","matRipple","",3,"click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t._uU(4,"Daily Utilisation"),t.qZA(),t.YNc(5,Dn,3,0,"button",4),t.qZA(),t._UZ(6,"custom-table",5),t.YNc(7,kn,2,4,"ng-template",null,6,t.W1O)(9,zn,1,1,"ng-template",null,7,t.W1O),t.qZA()()),2&e){const a=t.MAs(8),r=t.MAs(10);t.xp6(5),t.Q6J("ngIf",!o.print),t.xp6(),t.Q6J("dataSource",o.day_list)("pagination",!o.print)("columns",t.DdM(7,In))("display_column",t.DdM(8,Yn))("column_size",t.DdM(9,jn))("template",t.kEZ(10,qn,a,r,r))}},dependencies:[y.O5,D.wG,Y.o,W.C,y.uU],encapsulation:2})}return s})();function Bn(s,i){if(1&s){const n=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.download())}),t.TgZ(1,"app-icon"),t._uU(2,"download"),t.qZA()()}}function Pn(s,i){1&s&&t._uU(0),2&s&&t.hij(" ",i.data||"0","% ")}const Qn=()=>["name","avg_usage","approved","count","utilisation"],Fn=()=>["Level","Avg. Used Desks","Approved Bookings","Total Requests","Utilisation"],Xn=()=>["flex"],Gn=s=>({utilisation:s});let Vn=(()=>{class s{constructor(n,e){var o=this;this._state=n,this._org=e,this.print=!1,this.level_list=(0,F.aj)([this._state.options,this._state.stats,this._state.counts]).pipe((0,Z.U)(([a,r,l])=>{const{start:u,end:c,zones:p}=a,f=(0,oe.Z)(c,u)||1,d=[];for(const h of p){if("All"===h)continue;const m=this._org.levelWithID([h]),b=l[h]||0,_=r.events.filter(N=>N.zones.includes(h));let M=(b*f-_.length)/f;M%1!=0&&(M=M.toFixed(2)),d.push({name:m?.display_name||m?.name,free:M,approved:_.filter(N=>N.approved).length||0,avg_usage:(_.length/f||0).toFixed(2),total:b,count:_.length,utilisation:(_.length/((b||1)*f)*100||0).toFixed(2)})}return d}),(0,q.d)(1)),this.download=(0,k.Z)(function*(){let a=yield o.level_list.pipe((0,H.q)(1)).toPromise();(0,v.Sv)("desks-levels-usage.csv",(0,v.o3)(a))})}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R),t.Y36(G.w7))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["report-desks-levels-list"]],inputs:{print:"print"},decls:9,vars:12,consts:[[1,"px-4","pb-2","w-full"],[1,"rounded","bg-base-100","border","border-base-200","shadow","overflow-hidden","w-full"],[1,"border-b","border-base-200","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["icon","","matRipple","",3,"click",4,"ngIf"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["percent_view",""],["icon","","matRipple","",3,"click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t._uU(4,"Level Utilisation"),t.qZA(),t.YNc(5,Bn,3,0,"button",4),t.qZA(),t._UZ(6,"custom-table",5),t.YNc(7,Pn,1,1,"ng-template",null,6,t.W1O),t.qZA()()),2&e){const a=t.MAs(8);t.xp6(5),t.Q6J("ngIf",!o.print),t.xp6(),t.Q6J("dataSource",o.level_list)("pagination",!o.print)("columns",t.DdM(7,Qn))("display_column",t.DdM(8,Fn))("column_size",t.DdM(9,Xn))("template",t.VKq(10,Gn,a))}},dependencies:[y.O5,D.wG,Y.o,W.C],encapsulation:2})}return s})();const ut={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},Hn=8,Ct={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function ae(s,i){return"number"==typeof s?s+i:s}function Mt(s){if("string"==typeof s){const i=/^(\d+)\s*(.*)$/g.exec(s);return{value:i?+i[1]:0,unit:i?.[2]||void 0}}return{value:Number(s)}}function It(s){return String.fromCharCode(97+s%26)}const Yt=2221e-19;function pt(s,i,n){return i/n.range*s}function $n(s,i){const n=Math.pow(10,i||Hn);return Math.round(s*n)/n}function jt(s,i,n,e){const o=(e-90)*Math.PI/180;return{x:s+n*Math.cos(o),y:i+n*Math.sin(o)}}function nt(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var i=arguments.length,n=new Array(i>1?i-1:0),e=1;e<i;e++)n[e-1]=arguments[e];for(let o=0;o<n.length;o++){const a=n[o];for(const r in a){const l=a[r];s[r]="object"!=typeof l||null===l||l instanceof Array?l:nt(s[r],l)}}return s}const dt=s=>s;function Tt(s,i){return Array.from({length:s},i?(n,e)=>i(e):()=>{})}const es=(s,i)=>s+(i||0);function A(s,i){return null!==s&&"object"==typeof s&&Reflect.has(s,i)}function mt(s){return null!==s&&isFinite(s)}function re(s){return!s&&0!==s}function ot(s){return mt(s)?Number(s):void 0}function ce(s,i){const n=Array.isArray(s)?s[i]:A(s,"data")?s.data[i]:null;return A(n,"meta")?n.meta:void 0}function ue(s){return null==s||"number"==typeof s&&isNaN(s)}function Ot(s){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y";return function os(s){return"object"==typeof s&&null!==s&&(Reflect.has(s,"x")||Reflect.has(s,"y"))}(s)&&A(s,i)?ot(s[i]):ot(s)}function qt(s){let o,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,e=arguments.length>3?arguments[3]:void 0;const a={labels:(s.labels||[]).slice(),series:ls(s.series,n,e)},r=a.labels.length;return function ss(s){return!!Array.isArray(s)&&s.every(Array.isArray)}(a.series)?(o=Math.max(r,...a.series.map(l=>l.length)),a.series.forEach(l=>{l.push(...Tt(Math.max(0,o-l.length)))})):o=a.series.length,a.labels.push(...Tt(Math.max(0,o-r),()=>"")),i&&function as(s){var i;null===(i=s.labels)||void 0===i||i.reverse(),s.series.reverse();for(const n of s.series)A(n,"data")?n.data.reverse():Array.isArray(n)&&n.reverse()}(a),a}function pe(s,i){if(!ue(s))return i?function rs(s,i){let n,e;if("object"!=typeof s){const o=ot(s);"x"===i?n=o:e=o}else A(s,"x")&&(n=ot(s.x)),A(s,"y")&&(e=ot(s.y));if(void 0!==n||void 0!==e)return{x:n,y:e}}(s,i):ot(s)}function Jt(s,i){return Array.isArray(s)?s.map(n=>A(n,"value")?pe(n.value,i):pe(n,i)):Jt(s.data,i)}function ls(s,i,n){if(function is(s){return Array.isArray(s)&&s.every(i=>Array.isArray(i)||A(i,"data"))}(s))return s.map(o=>Jt(o,i));const e=Jt(s,i);return n?e.map(o=>[o]):e}function ht(s){let i="";return null==s?s:(i="number"==typeof s?""+s:"object"==typeof s?JSON.stringify({data:s}):String(s),Object.keys(Ct).reduce((n,e)=>n.replaceAll(e,Ct[e]),i))}class cs{call(i,n){return this.svgElements.forEach(e=>Reflect.apply(e[i],e,n)),this}attr(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("attr",n)}elem(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("elem",n)}root(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("root",n)}getNode(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("getNode",n)}foreignObject(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("foreignObject",n)}text(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("text",n)}empty(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("empty",n)}remove(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("remove",n)}addClass(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("addClass",n)}removeClass(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("removeClass",n)}removeAllClasses(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("removeAllClasses",n)}animate(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return this.call("animate",n)}constructor(i){this.svgElements=[];for(let n=0;n<i.length;n++)this.svgElements.push(new fe(i[n]))}}const me={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]};function he(s,i,n){let e=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;const{easing:a,...r}=n,l={};let u,c;a&&(u=Array.isArray(a)?a:me[a]),r.begin=ae(r.begin,"ms"),r.dur=ae(r.dur,"ms"),u&&(r.calcMode="spline",r.keySplines=u.join(" "),r.keyTimes="0;1"),e&&(r.fill="freeze",l[i]=r.from,s.attr(l),c=Mt(r.begin||0).value,r.begin="indefinite");const p=s.elem("animate",{attributeName:i,...r});e&&setTimeout(()=>{try{p._node.beginElement()}catch{l[i]=r.to,s.attr(l),p.remove()}},c);const f=p.getNode();o&&f.addEventListener("beginEvent",()=>o.emit("animationBegin",{element:s,animate:f,params:n})),f.addEventListener("endEvent",()=>{o&&o.emit("animationEnd",{element:s,animate:f,params:n}),e&&(l[i]=r.to,s.attr(l),p.remove())})}let fe=(()=>{class s{attr(n,e){return"string"==typeof n?e?this._node.getAttributeNS(e,n):this._node.getAttribute(n):(Object.keys(n).forEach(o=>{if(void 0!==n[o])if(-1!==o.indexOf(":")){const a=o.split(":");this._node.setAttributeNS(ut[a[0]],o,String(n[o]))}else this._node.setAttribute(o,String(n[o]))}),this)}elem(n,e,o){return new s(n,e,o,this,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}parent(){return this._node.parentNode instanceof SVGElement?new s(this._node.parentNode):null}root(){let n=this._node;for(;"svg"!==n.nodeName&&n.parentElement;)n=n.parentElement;return new s(n)}querySelector(n){const e=this._node.querySelector(n);return e?new s(e):null}querySelectorAll(n){const e=this._node.querySelectorAll(n);return new cs(e)}getNode(){return this._node}foreignObject(n,e,o){let r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("string"==typeof n){const u=document.createElement("div");u.innerHTML=n,r=u.firstChild}else r=n;r instanceof Element&&r.setAttribute("xmlns",ut.xmlns);const l=this.elem("foreignObject",e,o,a);return l._node.appendChild(r),l}text(n){return this._node.appendChild(document.createTextNode(n)),this}empty(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this}remove(){var n;return null===(n=this._node.parentNode)||void 0===n||n.removeChild(this._node),this.parent()}replace(n){var e;return null===(e=this._node.parentNode)||void 0===e||e.replaceChild(n._node,this._node),n}append(n){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&this._node.firstChild?this._node.insertBefore(n._node,this._node.firstChild):this._node.appendChild(n._node),this}classes(){const n=this._node.getAttribute("class");return n?n.trim().split(/\s+/):[]}addClass(n){return this._node.setAttribute("class",this.classes().concat(n.trim().split(/\s+/)).filter(function(e,o,a){return a.indexOf(e)===o}).join(" ")),this}removeClass(n){const e=n.trim().split(/\s+/);return this._node.setAttribute("class",this.classes().filter(o=>-1===e.indexOf(o)).join(" ")),this}removeAllClasses(){return this._node.setAttribute("class",""),this}height(){return this._node.getBoundingClientRect().height}width(){return this._node.getBoundingClientRect().width}animate(n){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2?arguments[2]:void 0;return Object.keys(n).forEach(a=>{const r=n[a];Array.isArray(r)?r.forEach(l=>he(this,a,l,!1,o)):he(this,a,r,e,o)}),this}constructor(n,e,o,a,r=!1){n instanceof Element?this._node=n:(this._node=document.createElementNS(ut.svg,n),"svg"===n&&this.attr({"xmlns:ct":ut.ct})),e&&this.attr(e),o&&this.addClass(o),a&&(r&&a._node.firstChild?a._node.insertBefore(this._node,a._node.firstChild):a._node.appendChild(this._node))}}return s.Easing=me,s})();function Bt(s){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"100%",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"100%",e=arguments.length>3?arguments[3]:void 0;Array.from(s.querySelectorAll("svg")).filter(a=>a.getAttributeNS(ut.xmlns,"ct")).forEach(a=>s.removeChild(a));const o=new fe("svg").attr({width:i,height:n}).attr({style:"width: ".concat(i,"; height: ").concat(n,";")});return e&&o.addClass(e),s.appendChild(o.getNode()),o}function Pt(s,i){var n,e,o,a;const r=!(!i.axisX&&!i.axisY),l=(null===(n=i.axisY)||void 0===n?void 0:n.offset)||0,u=(null===(e=i.axisX)||void 0===e?void 0:e.offset)||0,c=null===(o=i.axisY)||void 0===o?void 0:o.position,p=null===(a=i.axisX)||void 0===a?void 0:a.position;let f=s.width()||Mt(i.width).value||0,d=s.height()||Mt(i.height).value||0;const h=function us(s){return"number"==typeof s?{top:s,right:s,bottom:s,left:s}:void 0===s?{top:0,right:0,bottom:0,left:0}:{top:"number"==typeof s.top?s.top:0,right:"number"==typeof s.right?s.right:0,bottom:"number"==typeof s.bottom?s.bottom:0,left:"number"==typeof s.left?s.left:0}}(i.chartPadding);f=Math.max(f,l+h.left+h.right),d=Math.max(d,u+h.top+h.bottom);const m={x1:0,x2:0,y1:0,y2:0,padding:h,width(){return this.x2-this.x1},height(){return this.y1-this.y2}};return r?("start"===p?(m.y2=h.top+u,m.y1=Math.max(d-h.bottom,m.y2+1)):(m.y2=h.top,m.y1=Math.max(d-h.bottom-u,m.y2+1)),"start"===c?(m.x1=h.left+l,m.x2=Math.max(f-h.right,m.x1+1)):(m.x1=h.left,m.x2=Math.max(f-h.right-l,m.x1+1))):(m.x1=h.left,m.x2=Math.max(f-h.right,m.x1+1),m.y2=h.top,m.y1=Math.max(d-h.bottom,m.y2+1)),m}function _e(s,i,n){let e;const o=[];function a(l){const u=e;e=nt({},s),i&&i.forEach(c=>{window.matchMedia(c[0]).matches&&(e=nt(e,c[1]))}),n&&l&&n.emit("optionsChanged",{previousOptions:u,currentOptions:e})}if(!window.matchMedia)throw new Error("window.matchMedia not found! Make sure you're using a polyfill.");return i&&i.forEach(l=>{const u=window.matchMedia(l[0]);u.addEventListener("change",a),o.push(u)}),a(),{removeMediaQueryListeners:function r(){o.forEach(l=>l.removeEventListener("change",a))},getCurrentOptions:()=>e}}const Qt={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},ms={accuracy:3};function Lt(s,i,n,e,o,a){const r={command:o?s.toLowerCase():s.toUpperCase(),...i,...a?{data:a}:{}};n.splice(e,0,r)}function Ft(s,i){s.forEach((n,e)=>{Qt[n.command.toLowerCase()].forEach((o,a)=>{i(n,o,e,a,s)})})}class E{static join(i){const o=new E(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2?arguments[2]:void 0);for(let a=0;a<i.length;a++){const r=i[a];for(let l=0;l<r.pathElements.length;l++)o.pathElements.push(r.pathElements[l])}return o}position(i){return void 0!==i?(this.pos=Math.max(0,Math.min(this.pathElements.length,i)),this):this.pos}remove(i){return this.pathElements.splice(this.pos,i),this}move(i,n){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;return Lt("M",{x:+i,y:+n},this.pathElements,this.pos++,e,o),this}line(i,n){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;return Lt("L",{x:+i,y:+n},this.pathElements,this.pos++,e,o),this}curve(i,n,e,o,a,r){let l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7?arguments[7]:void 0;return Lt("C",{x1:+i,y1:+n,x2:+e,y2:+o,x:+a,y:+r},this.pathElements,this.pos++,l,u),this}arc(i,n,e,o,a,r,l){let u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8?arguments[8]:void 0;return Lt("A",{rx:i,ry:n,xAr:e,lAf:o,sf:a,x:r,y:l},this.pathElements,this.pos++,u,c),this}parse(i){const n=i.replace(/([A-Za-z])(-?[0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce((o,a)=>(a.match(/[A-Za-z]/)&&o.push([]),o[o.length-1].push(a),o),[]);"Z"===n[n.length-1][0].toUpperCase()&&n.pop();const e=n.map(o=>{const a=o.shift(),r=Qt[a.toLowerCase()];return{command:a,...r.reduce((l,u,c)=>(l[u]=+o[c],l),{})}});return this.pathElements.splice(this.pos,0,...e),this.pos+=e.length,this}stringify(){const i=Math.pow(10,this.options.accuracy);return this.pathElements.reduce((n,e)=>{const o=Qt[e.command.toLowerCase()].map(a=>{const r=e[a];return this.options.accuracy?Math.round(r*i)/i:r});return n+e.command+o.join(",")},"")+(this.close?"Z":"")}scale(i,n){return Ft(this.pathElements,(e,o)=>{e[o]*="x"===o[0]?i:n}),this}translate(i,n){return Ft(this.pathElements,(e,o)=>{e[o]+="x"===o[0]?i:n}),this}transform(i){return Ft(this.pathElements,(n,e,o,a,r)=>{const l=i(n,e,o,a,r);(l||0===l)&&(n[e]=l)}),this}clone(){const n=new E(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.close);return n.pos=this.pos,n.pathElements=this.pathElements.slice().map(e=>({...e})),n.options={...this.options},n}splitByCommand(i){const n=[new E];return this.pathElements.forEach(e=>{e.command===i.toUpperCase()&&0!==n[n.length-1].pathElements.length&&n.push(new E),n[n.length-1].pathElements.push(e)}),n}constructor(i=!1,n){this.close=i,this.pathElements=[],this.pos=0,this.options={...ms,...n}}}function at(s){const i={fillHoles:!1,...s};return function(e,o){const a=new E;let r=!0;for(let l=0;l<e.length;l+=2){const u=e[l],c=e[l+1],p=o[l/2];void 0!==Ot(p.value)?(r?a.move(u,c,!1,p):a.line(u,c,!1,p),r=!1):i.fillHoles||(r=!0)}return a}}function ve(s){const i={fillHoles:!1,...s};return function n(e,o){const a=function de(s,i,n){const e={increasingX:!1,fillHoles:!1,...n},o=[];let a=!0;for(let r=0;r<s.length;r+=2)void 0===Ot(i[r/2].value)?e.fillHoles||(a=!0):(e.increasingX&&r>=2&&s[r]<=s[r-2]&&(a=!0),a&&(o.push({pathCoordinates:[],valueData:[]}),a=!1),o[o.length-1].pathCoordinates.push(s[r],s[r+1]),o[o.length-1].valueData.push(i[r/2]));return o}(e,o,{fillHoles:i.fillHoles,increasingX:!0});if(a.length){if(a.length>1)return E.join(a.map(r=>n(r.pathCoordinates,r.valueData)));{if(o=a[0].valueData,(e=a[0].pathCoordinates).length<=4)return at()(e,o);const r=[],l=[],u=e.length/2,c=[],p=[],f=[],d=[];for(let m=0;m<u;m++)r[m]=e[2*m],l[m]=e[2*m+1];for(let m=0;m<u-1;m++)f[m]=l[m+1]-l[m],d[m]=r[m+1]-r[m],p[m]=f[m]/d[m];c[0]=p[0],c[u-1]=p[u-2];for(let m=1;m<u-1;m++)0===p[m]||0===p[m-1]||p[m-1]>0!=p[m]>0?c[m]=0:(c[m]=3*(d[m-1]+d[m])/((2*d[m]+d[m-1])/p[m-1]+(d[m]+2*d[m-1])/p[m]),isFinite(c[m])||(c[m]=0));const h=(new E).move(r[0],l[0],!1,o[0]);for(let m=0;m<u-1;m++)h.curve(r[m]+d[m]/3,l[m]+c[m]*d[m]/3,r[m+1]-d[m]/3,l[m+1]-c[m+1]*d[m]/3,r[m+1],l[m+1],!1,o[m+1]);return h}}return at()([],[])}}class _s{on(i,n){const{allListeners:e,listeners:o}=this;"*"===i?e.add(n):(o.has(i)||o.set(i,new Set),o.get(i).add(n))}off(i,n){const{allListeners:e,listeners:o}=this;if("*"===i)n?e.delete(n):e.clear();else if(o.has(i)){const a=o.get(i);n?a.delete(n):a.clear(),a.size||o.delete(i)}}emit(i,n){const{allListeners:e,listeners:o}=this;o.has(i)&&o.get(i).forEach(a=>a(n)),e.forEach(a=>a(i,n))}constructor(){this.listeners=new Map,this.allListeners=new Set}}const Xt=new WeakMap;class ye{update(i,n){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var o;return i&&(this.data=i||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.eventEmitter.emit("data",{type:"update",data:this.data})),n&&(this.options=nt({},e?this.options:this.defaultOptions,n),!this.initializeTimeoutId)&&(null===(o=this.optionsProvider)||void 0===o||o.removeMediaQueryListeners(),this.optionsProvider=_e(this.options,this.responsiveOptions,this.eventEmitter)),!this.initializeTimeoutId&&this.optionsProvider&&this.createChart(this.optionsProvider.getCurrentOptions()),this}detach(){var i;return this.initializeTimeoutId?window.clearTimeout(this.initializeTimeoutId):(window.removeEventListener("resize",this.resizeListener),null===(i=this.optionsProvider)||void 0===i||i.removeMediaQueryListeners()),Xt.delete(this.container),this}on(i,n){return this.eventEmitter.on(i,n),this}off(i,n){return this.eventEmitter.off(i,n),this}initialize(){window.addEventListener("resize",this.resizeListener),this.optionsProvider=_e(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.on("optionsChanged",()=>this.update()),this.options.plugins&&this.options.plugins.forEach(i=>{Array.isArray(i)?i[0](this,i[1]):i(this)}),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=null}constructor(i,n,e,o,a){this.data=n,this.defaultOptions=e,this.options=o,this.responsiveOptions=a,this.eventEmitter=new _s,this.resizeListener=()=>this.update(),this.initializeTimeoutId=setTimeout(()=>this.initialize(),0);const r="string"==typeof i?document.querySelector(i):i;if(!r)throw new Error("Target element is not found");this.container=r;const l=Xt.get(r);l&&l.detach(),Xt.set(r,this)}}const U={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};class xe{createGridAndLabels(i,n,e,o){const a="x"===this.units.pos?e.axisX:e.axisY,r=this.ticks.map((u,c)=>this.projectValue(u,c)),l=this.ticks.map(a.labelInterpolationFnc);r.forEach((u,c)=>{const p=l[c],f={x:0,y:0};let d;d=r[c+1]?r[c+1]-u:Math.max(this.axisLength-u,this.axisLength/this.ticks.length),(""===p||!re(p))&&("x"===this.units.pos?(u=this.chartRect.x1+u,f.x=e.axisX.labelOffset.x,f.y="start"===e.axisX.position?this.chartRect.padding.top+e.axisX.labelOffset.y+5:this.chartRect.y1+e.axisX.labelOffset.y+5):(u=this.chartRect.y1-u,f.y=e.axisY.labelOffset.y-d,f.x="start"===e.axisY.position?this.chartRect.padding.left+e.axisY.labelOffset.x:this.chartRect.x2+e.axisY.labelOffset.x+10),a.showGrid&&function ps(s,i,n,e,o,a,r,l){const u={["".concat(n.units.pos,"1")]:s,["".concat(n.units.pos,"2")]:s,["".concat(n.counterUnits.pos,"1")]:e,["".concat(n.counterUnits.pos,"2")]:e+o},c=a.elem("line",u,r.join(" "));l.emit("draw",{type:"grid",axis:n,index:i,group:a,element:c,...u})}(u,c,this,this.gridOffset,this.chartRect[this.counterUnits.len](),i,[e.classNames.grid,e.classNames[this.units.dir]],o),a.showLabel&&function ds(s,i,n,e,o,a,r,l,u,c){const p={[o.units.pos]:s+r[o.units.pos],[o.counterUnits.pos]:r[o.counterUnits.pos],[o.units.len]:i,[o.counterUnits.len]:Math.max(0,a-10)},f=Math.round(p[o.units.len]),d=Math.round(p[o.counterUnits.len]),h=document.createElement("span");h.className=u.join(" "),h.style[o.units.len]=f+"px",h.style[o.counterUnits.len]=d+"px",h.textContent=String(e);const m=l.foreignObject(h,{style:"overflow: visible;",...p});c.emit("draw",{type:"label",axis:o,index:n,group:l,element:m,text:e,...p})}(u,d,c,p,this,a.offset,f,n,[e.classNames.label,e.classNames[this.units.dir],"start"===a.position?e.classNames[a.position]:e.classNames.end],o))})}constructor(i,n,e){this.units=i,this.chartRect=n,this.ticks=e,this.counterUnits=i===U.x?U.y:U.x,this.axisLength=n[this.units.rectEnd]-n[this.units.rectStart],this.gridOffset=n[this.units.rectOffset]}}class Gt extends xe{projectValue(i){const n=Number(Ot(i,this.units.pos));return this.axisLength*(n-this.bounds.min)/this.bounds.range}constructor(i,n,e,o){const a=o.highLow||function Ut(s,i,n){const e={high:void 0===(i={...i,...n?"x"===n?i.axisX:i.axisY:{}}).high?-Number.MAX_VALUE:+i.high,low:void 0===i.low?Number.MAX_VALUE:+i.low},o=void 0===i.high,a=void 0===i.low;return(o||a)&&function r(l){if(!ue(l))if(Array.isArray(l))for(let u=0;u<l.length;u++)r(l[u]);else{const u=Number(n&&A(l,n)?l[n]:l);o&&u>e.high&&(e.high=u),a&&u<e.low&&(e.low=u)}}(s),(i.referenceValue||0===i.referenceValue)&&(e.high=Math.max(i.referenceValue,e.high),e.low=Math.min(i.referenceValue,e.low)),e.high<=e.low&&(0===e.low?e.high=1:e.low<0?e.high=0:(e.high>0||(e.high=1),e.low=0)),e}(n,o,i.pos),r=function ts(s,i,n){let e=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o={high:i.high,low:i.low,valueRange:0,oom:0,step:0,min:0,max:0,range:0,numberOfSteps:0,values:[]};o.valueRange=o.high-o.low,o.oom=function Wn(s){return Math.floor(Math.log(Math.abs(s))/Math.LN10)}(o.valueRange),o.step=Math.pow(10,o.oom),o.min=Math.floor(o.low/o.step)*o.step,o.max=Math.ceil(o.high/o.step)*o.step,o.range=o.max-o.min,o.numberOfSteps=Math.round(o.range/o.step);const r=pt(s,o.step,o)<n,l=e?function Kn(s){if(1===s)return s;function i(r,l){return r%l==0?l:i(l,r%l)}function n(r){return r*r+1}let a,e=2,o=2;if(s%2==0)return 2;do{e=n(e)%s,o=n(n(o))%s,a=i(Math.abs(e-o),s)}while(1===a);return a}(o.range):0;if(e&&pt(s,1,o)>=n)o.step=1;else if(e&&l<o.step&&pt(s,l,o)>=n)o.step=l;else{let d=0;for(;;){if(r&&pt(s,o.step,o)<=n)o.step*=2;else{if(r||!(pt(s,o.step/2,o)>=n))break;if(o.step/=2,e&&o.step%1!=0){o.step*=2;break}}if(d++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}}function u(d,h){return d===(d+=h)&&(d*=1+(h>0?Yt:-Yt)),d}o.step=Math.max(o.step,Yt);let c=o.min,p=o.max;for(;c+o.step<=o.low;)c=u(c,o.step);for(;p-o.step>=o.high;)p=u(p,-o.step);o.min=c,o.max=p,o.range=o.max-o.min;const f=[];for(let d=o.min;d<=o.max;d=u(d,o.step)){const h=$n(d);h!==f[f.length-1]&&f.push(h)}return o.values=f,o}(e[i.rectEnd]-e[i.rectStart],a,o.scaleMinSpace||20,o.onlyInteger),l={min:r.min,max:r.max};super(i,e,r.values),this.bounds=r,this.range=l}}class Rt extends xe{projectValue(i,n){return this.stepLength*n}constructor(i,n,e,o){const a=o.ticks||[];super(i,e,a);const r=Math.max(1,a.length-(o.stretch?1:0));this.stepLength=this.axisLength/r,this.stretch=!!o.stretch}}function ft(s,i,n){var e;if(A(s,"name")&&s.name&&null!==(e=i.series)&&void 0!==e&&e[s.name]){const a=(i?.series[s.name])[n];return void 0===a?i[n]:a}return i[n]}const be={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:dt,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:dt,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,showGridBackground:!1,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};class vs extends ye{createChart(i){const{data:n}=this,e=qt(n,i.reverseData,!0),o=Bt(this.container,i.width,i.height,i.classNames.chart);this.svg=o;const a=o.elem("g").addClass(i.classNames.gridGroup),r=o.elem("g"),l=o.elem("g").addClass(i.classNames.labelGroup),u=Pt(o,i);let c,p;c=void 0===i.axisX.type?new Rt(U.x,e.series,u,{...i.axisX,ticks:e.labels,stretch:i.fullWidth}):new i.axisX.type(U.x,e.series,u,i.axisX),p=void 0===i.axisY.type?new Gt(U.y,e.series,u,{...i.axisY,high:mt(i.high)?i.high:i.axisY.high,low:mt(i.low)?i.low:i.axisY.low}):new i.axisY.type(U.y,e.series,u,i.axisY),c.createGridAndLabels(a,l,i,this.eventEmitter),p.createGridAndLabels(a,l,i,this.eventEmitter),i.showGridBackground&&function ge(s,i,n,e){const o=s.elem("rect",{x:i.x1,y:i.y2,width:i.width(),height:i.height()},n,!0);e.emit("draw",{type:"gridBackground",group:s,element:o})}(a,u,i.classNames.gridBackground,this.eventEmitter),function le(s,i){let e=0;s[arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"reduceRight":"reduce"]((o,a,r)=>i(a,e++,r),void 0)}(n.series,(f,d)=>{const h=r.elem("g"),m=A(f,"name")&&f.name,b=A(f,"className")&&f.className,_=A(f,"meta")?f.meta:void 0;m&&h.attr({"ct:series-name":m}),_&&h.attr({"ct:meta":ht(_)}),h.addClass([i.classNames.series,b||"".concat(i.classNames.series,"-").concat(It(d))].join(" "));const M=[],N=[];e.series[d].forEach((x,w)=>{const C={x:u.x1+c.projectValue(x,w,e.series[d]),y:u.y1-p.projectValue(x,w,e.series[d])};M.push(C.x,C.y),N.push({value:x,valueIndex:w,meta:ce(f,w)})});const z={lineSmooth:ft(f,i,"lineSmooth"),showPoint:ft(f,i,"showPoint"),showLine:ft(f,i,"showLine"),showArea:ft(f,i,"showArea"),areaBase:ft(f,i,"areaBase")};let B;B="function"==typeof z.lineSmooth?z.lineSmooth:z.lineSmooth?ve():at();const T=B(M,N);if(z.showPoint&&T.pathElements.forEach(x=>{const{data:w}=x,C=h.elem("line",{x1:x.x,y1:x.y,x2:x.x+.01,y2:x.y},i.classNames.point);if(w){let O,I;A(w.value,"x")&&(O=w.value.x),A(w.value,"y")&&(I=w.value.y),C.attr({"ct:value":[O,I].filter(mt).join(","),"ct:meta":ht(w.meta)})}this.eventEmitter.emit("draw",{type:"point",value:w?.value,index:w?.valueIndex||0,meta:w?.meta,series:f,seriesIndex:d,axisX:c,axisY:p,group:h,element:C,x:x.x,y:x.y,chartRect:u})}),z.showLine){const x=h.elem("path",{d:T.stringify()},i.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:e.series[d],path:T.clone(),chartRect:u,index:d,series:f,seriesIndex:d,meta:_,axisX:c,axisY:p,group:h,element:x})}if(z.showArea&&p.range){const x=Math.max(Math.min(z.areaBase,p.range.max),p.range.min),w=u.y1-p.projectValue(x);T.splitByCommand("M").filter(C=>C.pathElements.length>1).map(C=>{const O=C.pathElements[0],I=C.pathElements[C.pathElements.length-1];return C.clone(!0).position(0).remove(1).move(O.x,w).line(O.x,O.y).position(C.pathElements.length+1).line(I.x,w)}).forEach(C=>{const O=h.elem("path",{d:C.stringify()},i.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:e.series[d],path:C.clone(),series:f,seriesIndex:d,axisX:c,axisY:p,chartRect:u,index:d,group:h,element:O,meta:_})})}},i.reverseData),this.eventEmitter.emit("created",{chartRect:u,axisX:c,axisY:p,svg:o,options:i})}constructor(i,n,e,o){super(i,n,be,nt({},be,e),o),this.data=n}}const Ze={width:void 0,height:void 0,chartPadding:5,classNames:{chartPie:"ct-chart-pie",chartDonut:"ct-chart-donut",series:"ct-series",slicePie:"ct-slice-pie",sliceDonut:"ct-slice-donut",label:"ct-label"},startAngle:0,total:void 0,donut:!1,donutWidth:60,showLabel:!0,labelOffset:0,labelPosition:"inside",labelInterpolationFnc:dt,labelDirection:"neutral",ignoreEmptyValues:!1};function xs(s,i,n){const e=i.x>s.x;return e&&"explode"===n||!e&&"implode"===n?"start":e&&"implode"===n||!e&&"explode"===n?"end":"middle"}class bs extends ye{createChart(i){const{data:n}=this,e=qt(n),o=[];let a,r,l=i.startAngle;const u=Bt(this.container,i.width,i.height,i.donut?i.classNames.chartDonut:i.classNames.chartPie);this.svg=u;const c=Pt(u,i);let p=Math.min(c.width()/2,c.height()/2);const f=i.total||e.series.reduce(es,0),d=Mt(i.donutWidth);"%"===d.unit&&(d.value*=p/100),p-=i.donut?d.value/2:0,r="outside"===i.labelPosition||i.donut?p:"center"===i.labelPosition?0:p/2,i.labelOffset&&(r+=i.labelOffset);const h={x:c.x1+c.width()/2,y:c.y2+c.height()/2},m=1===n.series.filter(b=>A(b,"value")?0!==b.value:0!==b).length;n.series.forEach((b,_)=>o[_]=u.elem("g")),i.showLabel&&(a=u.elem("g")),n.series.forEach((b,_)=>{var M,N;if(0===e.series[_]&&i.ignoreEmptyValues)return;const z=A(b,"name")&&b.name,B=A(b,"className")&&b.className,T=A(b,"meta")?b.meta:void 0;z&&o[_].attr({"ct:series-name":z}),o[_].addClass([null===(M=i.classNames)||void 0===M?void 0:M.series,B||"".concat(null===(N=i.classNames)||void 0===N?void 0:N.series,"-").concat(It(_))].join(" "));let x=f>0?l+e.series[_]/f*360:0;const w=Math.max(0,l-(0===_||m?0:.2));x-w>=359.99&&(x=w+359.99);const C=jt(h.x,h.y,p,w),O=jt(h.x,h.y,p,x),I=new E(!i.donut).move(O.x,O.y).arc(p,p,0,+(x-l>180),0,C.x,C.y);i.donut||I.line(h.x,h.y);const gt=o[_].elem("path",{d:I.stringify()},i.donut?i.classNames.sliceDonut:i.classNames.slicePie);if(gt.attr({"ct:value":e.series[_],"ct:meta":ht(T)}),i.donut&&gt.attr({style:"stroke-width: "+d.value+"px"}),this.eventEmitter.emit("draw",{type:"slice",value:e.series[_],totalDataSum:f,index:_,meta:T,series:b,group:o[_],element:gt,path:I.clone(),center:h,radius:p,startAngle:l,endAngle:x,chartRect:c}),i.showLabel){let X,P;X=1===n.series.length?{x:h.x,y:h.y}:jt(h.x,h.y,r,l+(x-l)/2),P=e.labels&&!re(e.labels[_])?e.labels[_]:e.series[_];const S=i.labelInterpolationFnc(P,_);if(S||0===S){const rt=a.elem("text",{dx:X.x,dy:X.y,"text-anchor":xs(h,X,i.labelDirection)},i.classNames.label).text(String(S));this.eventEmitter.emit("draw",{type:"label",index:_,group:a,element:rt,text:""+S,chartRect:c,series:b,meta:T,...X})}}l=x}),this.eventEmitter.emit("created",{chartRect:c,svg:u,options:i})}constructor(i,n,e,o){super(i,n,Ze,nt({},Ze,e),o),this.data=n}}let ws=(()=>{class s extends v.cx{constructor(n,e){super(),this._state=n,this._org=e,this.day_list=this._state.day_list,this.stats=(0,F.aj)([this._state.options,this._state.counts])}ngOnInit(){this.subscription("day_list",this.day_list.subscribe(n=>this.updateDailyChart(n))),this.subscription("stats",this.stats.subscribe(([n,e])=>this.updateLevelChart(n,e)))}updateDailyChart(n){const e={labels:n.map(o=>(0,j.Z)(o.date,"dd MMM")),series:[n.map(o=>o.utilisation)]};this._day_chart=new vs("#day-chart",e)}updateLevelChart(n,e){let{zones:o}=n||{};o.includes("All")&&(o=this._org.levels.filter(l=>l.parent_id===this._org.building.id).map(l=>l.id));const a=(o||[]).filter(l=>(e[l]||0)>0),r={labels:a.map(l=>{const u=this._org.levelWithID([l]);return u?.display_name||u.name||""}),series:a.map(l=>e[l]||0)};this._level_chart=new bs("#level-chart",r)}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R),t.Y36(G.w7))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["report-desks-charts"]],features:[t.qOj],decls:11,vars:0,consts:[[1,"flex","items-center","space-x-4","w-full","px-4"],[1,"bg-base-100","border","border-base-200","rounded","shadow","flex-1"],[1,"border-b","border-base-200","p-4","text-xl","font-bold"],["id","day-chart",1,"ct-chart","ct-octave","!w-full","h-56"],["util_chart",""],["id","level-chart",1,"ct-chart","ct-octave","!w-full","h-56"],["level_chart",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3," Daily Utilisation "),t.qZA(),t._UZ(4,"div",3,4),t.qZA(),t.TgZ(6,"div",1)(7,"div",2),t._uU(8," Level Utilisation "),t.qZA(),t._UZ(9,"div",5,6),t.qZA()())},styles:["[_nghost-%COMP%]{display:block}\n\n/*# sourceMappingURL=report-desks-charts.component.ts-angular-inline--139.css.map*/"]})}return s})();const Zs=["report-desks",""];function As(s,i){if(1&s&&(t.ynx(0),t.TgZ(1,"div",5)(2,"div",6)(3,"h3"),t._uU(4,"Total Bookings"),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.ALo(7,"async"),t.qZA()(),t.TgZ(8,"div",6)(9,"h3"),t._uU(10,"Utilisation"),t.qZA(),t.TgZ(11,"p"),t._uU(12),t.ALo(13,"async"),t.qZA()()(),t._UZ(14,"report-desks-charts")(15,"report-desks-overall-list",7)(16,"report-desks-levels-list",7),t.BQk()),2&s){const n=t.oxw(2);t.xp6(6),t.Oqu(t.lcZ(7,4,n.total_count)||0),t.xp6(6),t.hij("",t.lcZ(13,6,n.utilisation)||0,"%"),t.xp6(3),t.Q6J("print",n.printing),t.xp6(),t.Q6J("print",n.printing)}}function Cs(s,i){if(1&s&&(t.ynx(0),t.YNc(1,As,17,8,"ng-container",1),t.ALo(2,"async"),t.BQk()),2&s){const n=t.oxw(),e=t.MAs(7);t.xp6(),t.Q6J("ngIf",t.lcZ(2,2,n.total_count))("ngIfElse",e)}}function Ms(s,i){1&s&&(t.TgZ(0,"div",8),t._UZ(1,"mat-spinner",9),t.TgZ(2,"p",10),t._uU(3,"Loading report data..."),t.qZA()()),2&s&&(t.xp6(),t.Q6J("diameter",32))}function Ts(s,i){1&s&&(t.TgZ(0,"div",11)(1,"p",10),t._uU(2," Select levels and time period to generate a report. "),t.qZA()())}function Os(s,i){if(1&s){const n=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.print())}),t.TgZ(1,"app-icon"),t._uU(2,"print"),t.qZA()()}}let Us=(()=>{class s{constructor(n){this._state=n,this.printing=!1,this.total_count=this._state.stats.pipe((0,Z.U)(e=>e.count||0)),this.utilisation=this._state.stats.pipe((0,Z.U)(e=>(100*(e.utilisation||0)).toFixed(1))),this.loading=this._state.loading}print(){this.printing=!0,setTimeout(()=>{window.print(),this.printing=!1},300)}ngOnInit(){this._state.setOptions({type:"desks"})}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["","report-desks",""]],attrs:Zs,decls:10,vars:7,consts:[["printable","",1,"relative","flex-1","h-1/2","w-full","overflow-auto","print:overflow-visible","print:h-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],["icon","","matRipple","","class","absolute top-24 left-4 bg-secondary text-secondary-content border border-base-200 shadow z-20 print:hidden",3,"click",4,"ngIf"],[1,"m-4","p-4","rounded","bg-base-100","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[3,"print"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""],[1,"h-full","w-full","flex","flex-col","items-center","p-8","screen-only"],["icon","","matRipple","",1,"absolute","top-24","left-4","bg-secondary","text-secondary-content","border","border-base-200","shadow","z-20","print:hidden",3,"click"]],template:function(e,o){if(1&e&&(t._UZ(0,"reports-options"),t.TgZ(1,"div",0),t.YNc(2,Cs,3,4,"ng-container",1),t.ALo(3,"async"),t.YNc(4,Ms,4,1,"ng-template",null,2,t.W1O)(6,Ts,3,0,"ng-template",null,3,t.W1O),t.qZA(),t.YNc(8,Os,3,0,"button",4),t.ALo(9,"async")),2&e){const a=t.MAs(5);t.xp6(2),t.Q6J("ngIf",!t.lcZ(3,3,o.loading))("ngIfElse",a),t.xp6(6),t.Q6J("ngIf",t.lcZ(9,5,o.total_count))}},dependencies:[y.O5,wt.Ou,D.wG,Y.o,At.o,Zt,Jn,Vn,ws,y.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n\n/*# sourceMappingURL=report-desks.component.ts-angular-inline--134.css.map*/"]})}return s})();var Ls=g(91311);let Vt=(()=>{class s{constructor(n){this._reports=n,this.catering_orders=(0,F.aj)([this._reports.options,this._reports.bookings]).pipe((0,Z.U)(([{start:e,end:o},a])=>{const r=(0,tt.Z)(e).valueOf(),l=(0,et.Z)(o).valueOf();return(0,v.xH)(a.map(p=>p.valid_catering||[])).filter(p=>p.deliver_at_time>=r&&p.deliver_at_time<l&&"cancelled"!==p.status).sort((p,f)=>p.event?.date-f.event?.date)}),(0,q.d)(1)),this.catering_items=this.catering_orders.pipe((0,Z.U)(e=>{const o=[];for(const a of e)for(const r of a?.items||[]){const l=o.findIndex(u=>r.options_string===u.options_string);l>=0?r[l]=new Ls.Ud({...r,quantity:r?.quantity+r[l]?.quantity}):o.push(r)}return o.sort((a,r)=>r.quantity-a.quantity)})),this.stats=(0,F.aj)([this.catering_orders,this.catering_items]).pipe((0,Z.U)(([e,o])=>{const a=e.reduce((r,l)=>r+l.total_cost,0);return{order_count:e.length,unique_items:o.length,item_count:e.reduce((r,l)=>r+l.item_count,0),total_cost:a,avg_cost:a/e.length}}))}downloadOrders(){var n=this;return(0,k.Z)(function*(){const e=yield n.catering_orders.pipe((0,H.q)(1)).toPromise(),o=(0,v.o3)(e);return(0,v.Sv)("catering-orders.csv",o)})()}static#t=this.\u0275fac=function(e){return new(e||s)(t.LFG(R))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),Rs=(()=>{class s{get code(){return this._org.currency_code}constructor(n,e){this._report=n,this._org=e,this.stats=this._report.stats}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(Vt),t.Y36(G.w7))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["catering-report-overall"]],decls:32,vars:21,consts:[[1,"bg-base-100","shadow","rounded","m-2","px-8","w-48","h-24","flex","flex-col","items-center","justify-center"],["count","",1,"text-3xl"],[1,""],["unique","",1,"text-3xl"],["items","",1,"text-3xl"],["total","",1,"text-3xl"],["average","",1,"text-3xl"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"div",2),t._uU(5,"Orders"),t.qZA()(),t.TgZ(6,"div",0)(7,"div",3),t._uU(8),t.ALo(9,"async"),t.qZA(),t.TgZ(10,"div",2),t._uU(11,"Unique Items"),t.qZA()(),t.TgZ(12,"div",0)(13,"div",4),t._uU(14),t.ALo(15,"async"),t.qZA(),t.TgZ(16,"div",2),t._uU(17,"Ordered Items"),t.qZA()(),t.TgZ(18,"div",0)(19,"div",5),t._uU(20),t.ALo(21,"currency"),t.ALo(22,"async"),t.qZA(),t.TgZ(23,"div",2),t._uU(24,"Total"),t.qZA()(),t.TgZ(25,"div",0)(26,"div",6),t._uU(27),t.ALo(28,"currency"),t.ALo(29,"async"),t.qZA(),t.TgZ(30,"div",2),t._uU(31,"Order Average"),t.qZA()()),2&e){let a,r,l,u,c;t.xp6(2),t.hij(" ",(null==(a=t.lcZ(3,5,o.stats))?null:a.order_count)||"0"," "),t.xp6(6),t.hij(" ",(null==(r=t.lcZ(9,7,o.stats))?null:r.unique_items)||"0"," "),t.xp6(6),t.hij(" ",(null==(l=t.lcZ(15,9,o.stats))?null:l.item_count)||"0"," "),t.xp6(6),t.hij(" ",t.xi3(21,11,(null==(u=t.lcZ(22,14,o.stats))?null:u.total_cost)/100||0,o.code)," "),t.xp6(7),t.hij(" ",t.xi3(28,16,(null==(c=t.lcZ(29,19,o.stats))?null:c.avg_cost)/100||0,o.code)," ")}},dependencies:[y.Ov,y.H9],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:center;padding:.5rem}\n\n/*# sourceMappingURL=catering-report-overall.component.ts-angular-inline--138.css.map*/"]})}return s})();var Ht=g(60702);function Es(s,i){if(1&s&&(t._uU(0),t.ALo(1,"date"),t.ALo(2,"date")),2&s){const n=i.data,e=t.oxw();t.AsE(" ",t.lcZ(1,2,n)," at ",t.xi3(2,4,n,e.time_format)," ")}}function Ns(s,i){if(1&s&&(t._uU(0),t.ALo(1,"currency")),2&s){const n=i.data,e=t.oxw();t.hij(" ",t.xi3(1,1,n/100,e.code)," ")}}const Ss=()=>["deliver_at","item_count","total_cost"],Ds=()=>["Date","Items","Total Cost"],ks=()=>["flex"],zs=(s,i)=>({deliver_at:s,total_cost:i});let Is=(()=>{class s{get code(){return this._org.currency_code}get time_format(){return this._settings.time_format}constructor(n,e,o){this._report=n,this._org=e,this._settings=o,this.orders=this._report.catering_orders,this.download=()=>this._report.downloadOrders()}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(Vt),t.Y36(G.w7),t.Y36(v.gb))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["catering-report-orders"]],decls:12,vars:12,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-base-100","shadow","mx-auto","my-2"],[1,"border-b","border-base-200","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["matRipple-icon","","matTooltip","Download list",3,"click"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["date_state",""],["cost_state",""]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3,"Orders"),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return o.download()}),t.TgZ(5,"app-icon"),t._uU(6,"download"),t.qZA()()(),t._UZ(7,"custom-table",4),t.YNc(8,Es,3,7,"ng-template",null,5,t.W1O)(10,Ns,2,4,"ng-template",null,6,t.W1O),t.qZA()),2&e){const a=t.MAs(9),r=t.MAs(11);t.xp6(7),t.Q6J("dataSource",o.orders)("columns",t.DdM(6,Ss))("display_column",t.DdM(7,Ds))("column_size",t.DdM(8,ks))("template",t.WLB(9,zs,a,r))("pagination",!0)}},dependencies:[Ht.gM,Y.o,W.C,y.H9,y.uU]})}return s})();function Ys(s,i){if(1&s&&(t.TgZ(0,"span",7),t._uU(1),t.qZA()),2&s){const n=t.oxw().data,e=t.oxw();t.Q6J("matTooltip",e.options(n)),t.xp6(),t.hij(" ",n.length," option(s) ")}}function js(s,i){1&s&&t.YNc(0,Ys,2,2,"span",6),2&s&&t.Q6J("ngIf",i.data.length)}function qs(s,i){if(1&s&&(t._uU(0),t.ALo(1,"currency")),2&s){const n=i.data,e=t.oxw();t.hij(" ",t.xi3(1,1,(n||0)/100,e.code)," ")}}const Js=()=>["name","options","quantity","unit_price","total_cost"],Bs=()=>["Name","Options","Quantity","Unit Price","Total Cost"],Ps=()=>["flex"],Qs=(s,i,n)=>({options:s,unit_price:i,total_cost:n});let Fs=(()=>{class s{get code(){return this._org.currency_code}constructor(n,e){this._report=n,this._org=e,this.items=this._report.catering_items}options(n){return n.map(e=>e.name).join("\n")}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(Vt),t.Y36(G.w7))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["catering-report-items"]],decls:9,vars:13,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-base-100","shadow","mx-auto","my-2"],[1,"border-b","border-base-200","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["option_state",""],["cost_state",""],["class","text-xs px-2 py-1 rounded bg-base-200",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-base-200",3,"matTooltip"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3,"Ordered Items"),t.qZA()(),t._UZ(4,"custom-table",3),t.YNc(5,js,1,1,"ng-template",null,4,t.W1O)(7,qs,2,4,"ng-template",null,5,t.W1O),t.qZA()),2&e){const a=t.MAs(6),r=t.MAs(8);t.xp6(4),t.Q6J("dataSource",o.items)("columns",t.DdM(6,Js))("display_column",t.DdM(7,Bs))("column_size",t.DdM(8,Ps))("template",t.kEZ(9,Qs,a,r,r))("pagination",!0)}},dependencies:[y.O5,Ht.gM,W.C,y.H9]})}return s})();function Xs(s,i){1&s&&(t.TgZ(0,"div",5),t._UZ(1,"catering-report-overall")(2,"catering-report-orders")(3,"catering-report-items"),t.qZA())}function Gs(s,i){if(1&s&&(t.ynx(0),t.YNc(1,Xs,4,0,"div",4),t.ALo(2,"async"),t.BQk()),2&s){const n=t.oxw(),e=t.MAs(7);t.xp6(),t.Q6J("ngIf",t.lcZ(2,2,n.total_count))("ngIfElse",e)}}function Vs(s,i){1&s&&(t.TgZ(0,"div",6),t._UZ(1,"mat-spinner",7),t.TgZ(2,"p",8),t._uU(3,"Loading report data..."),t.qZA()()),2&s&&(t.xp6(),t.Q6J("diameter",32))}function Hs(s,i){1&s&&(t.TgZ(0,"div",9)(1,"p",8),t._uU(2," Select levels and time period to generate a report. "),t.qZA()())}let Ws=(()=>{class s{constructor(n){this._state=n,this.total_count=this._state.stats.pipe((0,Z.U)(e=>e.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(R))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["catering-report"]],decls:8,vars:4,consts:[["printable","",1,"relative","flex-1","h-1/2","w-full","overflow-auto","print:overflow-visible","print:h-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],["class","h-full w-full","printable","",4,"ngIf","ngIfElse"],["printable","",1,"h-full","w-full"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""],[1,"h-full","w-full","flex","flex-col","items-center","p-8","screen-only"]],template:function(e,o){if(1&e&&(t._UZ(0,"reports-options"),t.TgZ(1,"div",0),t.YNc(2,Gs,3,4,"ng-container",1),t.ALo(3,"async"),t.YNc(4,Vs,4,1,"ng-template",null,2,t.W1O)(6,Hs,3,0,"ng-template",null,3,t.W1O),t.qZA()),2&e){const a=t.MAs(5);t.xp6(2),t.Q6J("ngIf",!t.lcZ(3,2,o.loading))("ngIfElse",a)}},dependencies:[y.O5,wt.Ou,At.o,Zt,Rs,Is,Fs,y.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}\n\n/*# sourceMappingURL=catering-report.component.ts-angular-inline--137.css.map*/"]})}return s})();var $s=g(45083),Ks=g(85046),ti=g(15746);const Et={};let Wt=(()=>{class s{transform(n){return n?(Et[n]||(Et[n]=(0,vt.VE)(n).pipe((0,Z.U)(e=>e[0]||new vt.mO({id:n,name:n})),(0,ct.K)(e=>(0,V.of)(new vt.mO({id:n,name:n}))),(0,q.d)(1))),Et[n]):(0,V.of)(null)}static addUser(n){Et[n.id]=(0,V.of)(n).pipe((0,q.d)(1))}static#t=this.\u0275fac=function(e){return new(e||s)};static#e=this.\u0275pipe=t.Yjl({name:"user",type:s,pure:!0})}return s})(),Ae=(()=>{class s{get system_id(){return this._org.binding("contact_tracing")}get time_format(){return this._settings.time_format}constructor(n,e,o){this._org=n,this._reports=e,this._settings=o,this._loading=new st.X(""),this._generate=new st.X(0),this._options=new st.X({start:(0,tt.Z)(Date.now()),end:(0,et.Z)(Date.now())}),this.events=(0,F.aj)([this._options,this._generate]).pipe((0,$s.x)((a,r)=>a[1]===r[1]),(0,Ks.h)(([a,r])=>!!r),(0,it.w)(([{start:a,end:r,user:l}])=>{if(!l)return(0,V.of)([]);this._loading.next("Loading contact events...");const u=(0,ee.rTZ)(this.system_id,"ContactTracing");return l=l||(0,v.ar)(),Wt.addUser(l),this.system_id&&u?u.execute("close_contacts",[l.email,l.username,(0,yt.Z)(a),(0,yt.Z)(r)]).catch(c=>((0,v.cB)(`${c?.msg||JSON.stringify(c)}`),[])):(0,V.of)([])}),(0,Z.U)(a=>{const r=this._options.getValue().user||(0,v.ar)();return a.map(l=>({mac_address:l.mac_address,date:1e3*l.contact_time,duration:Math.floor(l.duration/60)||0,user_id:r.id,user:r.name,contact_id:l.username,distance:1}))}),(0,ct.K)(a=>((0,v.cB)(`${a?.msg||JSON.stringify(a)}`),(0,V.of)([]))),(0,ti.b)(a=>this._loading.next("")),(0,q.d)(1)),this.options=this._options.asObservable(),this.loading=this._loading.asObservable()}setOptions(n){this._options.next({...this._options.getValue(),...n})}generateReport(){this._generate.next(Date.now())}downloadReport(){var n=this;return(0,k.Z)(function*(){const{start:e,end:o}=yield n._reports.options.pipe((0,H.q)(1)).toPromise(),a=yield n.events.pipe((0,H.q)(1)).toPromise(),r=new Wt,l=yield Promise.all(a.map(function(){var u=(0,k.Z)(function*(c){return{"MAC Address":c.mac_address,Date:(0,j.Z)(c.date,"dd MMM yyyy, "+n.time_format),"User Name":c.user,"Contact Name":(yield r.transform(c.contact_id).toPromise())?.name||("null"!==c.contact_id?c.contact_id:null)||c.mac_address,Duration:`${Math.floor(c.duration/60)?Math.floor(c.duration/60)+"h ":""}${Math.floor(c.duration%60)+"m"}`,Distance:c.distance}});return function(c){return u.apply(this,arguments)}}()));(0,v.Sv)(`report+contact-tracing+${(0,j.Z)(e,"yyyy-MM-dd")}+${(0,j.Z)(o,"yyyy-MM-dd")}.csv`,(0,v.o3)(l))})()}static#t=this.\u0275fac=function(e){return new(e||s)(t.LFG(G.w7),t.LFG(R),t.LFG(v.gb))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var ei=g(20576);let ni=(()=>{class s{constructor(n){this._state=n,this.options=this._state.options,this.setOptions=e=>this._state.setOptions(e),this.generate=()=>this._state.generateReport()}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(Ae))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["contact-tracing-options"]],decls:15,vars:14,consts:[[1,"flex","items-center","space-x-2","w-full","p-2","bg-base-100","shadow"],["appearance","outline",1,"w-[18rem]"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["placeholder","Search for user to trace...",1,"w-64","h-12","mb-2","mt-1",3,"ngModel","ngModelChange"],["btn","","matRipple","",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-date-range-input",2)(3,"input",3),t.NdJ("ngModelChange",function(r){return r?o.setOptions({start:r,user:null}):""}),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"input",4),t.NdJ("ngModelChange",function(r){return r?o.setOptions({end:r,user:null}):""}),t.ALo(6,"async"),t.qZA()(),t._UZ(7,"mat-datepicker-toggle",5)(8,"mat-date-range-picker",null,6),t.qZA(),t.TgZ(10,"a-user-search-field",7),t.NdJ("ngModelChange",function(r){return o.setOptions({user:r})}),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"button",8),t.NdJ("click",function(){return o.generate()}),t.ALo(13,"async"),t._uU(14," Generate Report "),t.qZA()()),2&e){const a=t.MAs(9);let r,l,u,c;t.xp6(2),t.Q6J("rangePicker",a),t.xp6(),t.Q6J("ngModel",null==(r=t.lcZ(4,6,o.options))?null:r.start),t.xp6(2),t.Q6J("ngModel",null==(l=t.lcZ(6,8,o.options))?null:l.end),t.xp6(2),t.Q6J("for",a),t.xp6(3),t.Q6J("ngModel",null==(u=t.lcZ(11,10,o.options))?null:u.user),t.xp6(2),t.Q6J("disabled",!(null!=(c=t.lcZ(13,12,o.options))&&c.user))}},dependencies:[K.Fj,K.JJ,K.On,bt.KE,bt.R9,J.nW,J.wx,J.zY,J.By,J._g,D.wG,ei.d,y.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{height:3.25rem}\n\n/*# sourceMappingURL=contact-tracing-options.component.ts-angular-inline--141.css.map*/"]})}return s})();function si(s,i){if(1&s&&(t.TgZ(0,"span",16),t._uU(1),t.qZA()),2&s){const n=t.oxw().data,e=t.oxw(3);t.Q6J("matTooltip",e.options(n)),t.xp6(),t.hij(" ",n.length," option(s) ")}}function ii(s,i){1&s&&t.YNc(0,si,2,2,"span",15),2&s&&t.Q6J("ngIf",i.data.length)}function oi(s,i){if(1&s&&(t._uU(0),t.ALo(1,"async"),t.ALo(2,"user")),2&s){const e=i.row;let o;t.Oqu((null==(o=t.lcZ(1,1,t.lcZ(2,3,i.data)))?null:o.name)||e.mac_address)}}function ai(s,i){if(1&s&&(t._uU(0),t.ALo(1,"date"),t.ALo(2,"date")),2&s){const n=i.data,e=t.oxw(3);t.AsE(" ",t.xi3(1,2,n,"mediumDate"),", ",t.xi3(2,5,n,e.time_format)," ")}}function ri(s,i){if(1&s&&t._uU(0),2&s){const n=i.data,e=t.oxw(3);t.hij(" ",e.formatDuration(n||0)||"Less than a minute"," ")}}function li(s,i){1&s&&t._uU(0),2&s&&t.hij(" ",i.data,"m ")}const ci=()=>["date","user_id","contact_id","duration"],ui=()=>["Time of Contact","Person","Close Contact","Duration"],pi=()=>["12r","14r","flex","10r"],di=(s,i,n,e,o,a)=>({options:s,date:i,distance:n,user_id:e,contact_id:o,duration:a});function mi(s,i){if(1&s&&(t.TgZ(0,"div",6)(1,"div",7)(2,"h2",8),t._uU(3,"Contact Events"),t.qZA()(),t._UZ(4,"custom-table",9),t.YNc(5,ii,1,1,"ng-template",null,10,t.W1O)(7,oi,3,5,"ng-template",null,11,t.W1O)(9,ai,3,8,"ng-template",null,12,t.W1O)(11,ri,1,1,"ng-template",null,13,t.W1O)(13,li,1,1,"ng-template",null,14,t.W1O),t.qZA()),2&s){const n=t.MAs(6),e=t.MAs(8),o=t.MAs(10),a=t.MAs(12),r=t.MAs(14),l=t.oxw(2);t.xp6(4),t.Q6J("dataSource",l.tracing_events)("columns",t.DdM(7,ci))("display_column",t.DdM(8,ui))("column_size",t.DdM(9,pi))("template",t.HTZ(10,di,n,o,r,e,e,a))("pagination",!0)("page_size",30)}}function hi(s,i){if(1&s&&(t.ynx(0),t.YNc(1,mi,15,17,"div",5),t.ALo(2,"async"),t.BQk()),2&s){const n=t.oxw(),e=t.MAs(10);let o;t.xp6(),t.Q6J("ngIf",null==(o=t.lcZ(2,2,n.options))?null:o.user)("ngIfElse",e)}}function fi(s,i){if(1&s&&(t.TgZ(0,"div",17),t._UZ(1,"map-spinner",18),t.TgZ(2,"p"),t._uU(3),t.ALo(4,"async"),t.qZA()()),2&s){const n=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,1,n.loading))}}function gi(s,i){1&s&&(t.TgZ(0,"div",19)(1,"p",20),t._uU(2,"Select a user from the topbar to begin"),t.qZA()())}let _i=(()=>{class s{get time_format(){return this._settings.time_format}constructor(n,e){this._state=n,this._settings=e,this.loading=this._state.loading,this.options=this._state.options,this.tracing_events=this._state.events,this.setOptions=o=>this._state.setOptions(o),this.downloadReport=()=>this._state.downloadReport(),this.formatDuration=o=>(0,zt.Z)({hours:Math.floor(o/60),minutes:o%60})}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(Ae),t.Y36(v.gb))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-contact-tracing-report"]],decls:11,vars:4,consts:[["printable","",1,"relative","flex-1","h-1/2","w-full","overflow-auto","print:overflow-visible","print:h-auto"],[4,"ngIf","ngIfElse"],["icon","","matRipple","","matTooltip","Download Report",1,"bg-base-100","absolute","bottom-2","left-2","shadow",3,"click"],["load_state",""],["empty_state",""],["class","w-[64rem] max-w-[calc(100%-2rem)] rounded overflow-hidden bg-base-100 shadow mx-auto my-2","printable","",4,"ngIf","ngIfElse"],["printable","",1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-base-100","shadow","mx-auto","my-2"],[1,"border-b","border-base-200","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["empty","No contact records for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination","page_size"],["option_state",""],["user_state",""],["date_state",""],["duration_state",""],["distance_state",""],["class","text-xs px-2 py-1 rounded bg-base-200",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-base-200",3,"matTooltip"],[1,"p-8","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"],[1,"p-8","flex","flex-col","items-center","justify-center","space-y-2","screen-only"],[1,"opacity-60"]],template:function(e,o){if(1&e&&(t._UZ(0,"contact-tracing-options"),t.TgZ(1,"div",0),t.YNc(2,hi,3,4,"ng-container",1),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return o.downloadReport()}),t.TgZ(5,"app-icon"),t._uU(6,"download"),t.qZA()(),t.YNc(7,fi,5,3,"ng-template",null,3,t.W1O)(9,gi,3,0,"ng-template",null,4,t.W1O)),2&e){const a=t.MAs(8);t.xp6(2),t.Q6J("ngIf",!t.lcZ(3,2,o.loading))("ngIfElse",a)}},dependencies:[y.O5,Ht.gM,D.wG,Y.o,W.C,At.o,ni,y.Ov,y.uU,Wt],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}\n\n/*# sourceMappingURL=contact-tracing-report.component.ts-angular-inline--140.css.map*/"]})}return s})();var vi=g(16318);function yi(s,i){if(1&s&&(t._UZ(0,"iframe",1),t.ALo(1,"safe")),2&s){const n=t.oxw();t.Q6J("src",t.xi3(1,1,n.report_url,"resource"),t.uOi)}}const xi={};let bi=(()=>{class s extends v.cx{get report_url(){let n=(this._settings.get("app.custom_reports")||[]).find(o=>o.id===this.id)||xi;return n.url?n.url+(n.url.includes("?")?"&":"?")+"kiosk=tv"+(n.api_key?`&key=${encodeURIComponent(n.api_key)}`:""):""}constructor(n,e){super(),this._settings=n,this._route=e,this.id=""}ngOnInit(){this.subscription("route.params",this._route.paramMap.subscribe(n=>this.id=n.get("id")||""))}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(v.gb),t.Y36(Q.gz))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["custom-report"]],features:[t.qOj],decls:1,vars:1,consts:[["class","w-full h-full",3,"src",4,"ngIf"],[1,"w-full","h-full",3,"src"]],template:function(e,o){1&e&&t.YNc(0,yi,2,4,"iframe",0),2&e&&t.Q6J("ngIf",o.id)},dependencies:[y.O5,vi.y],styles:["[_nghost-%COMP%]{height:100%;width:100%}\n\n/*# sourceMappingURL=custom-report.component.ts-angular-inline--142.css.map*/"]})}return s})();var wi=g(33005),Zi=g(19842);const Ai=["app-new-reports",""];function Ci(s,i){1&s&&t._UZ(0,"div",4)}const Ce=[{path:"",component:Zt},{path:"bookings",component:Sn},{path:"desks",component:Us},{path:"catering",component:Ws},{path:"contact-tracing",component:_i},{path:":id",component:bi},{path:"**",redirectTo:"desks",pathMatch:"full"}],Ti=[{path:"new",component:(()=>{class s{get path(){const n=this._router.url.split("/");return n[n.length-1]}constructor(n){this._router=n}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(Q.F0))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["","app-new-reports",""]],attrs:Ai,decls:6,vars:1,consts:[[1,"screen-only"],[1,"flex","flex-1","h-px"],[1,"flex","flex-col","flex-1","w-1/2","h-full","relative"],["reports-menu","","class","absolute inset-0 screen-only",4,"ngIf"],["reports-menu","",1,"absolute","inset-0","screen-only"]],template:function(e,o){1&e&&(t._UZ(0,"app-topbar",0),t.TgZ(1,"div",1),t._UZ(2,"app-sidebar",0),t.TgZ(3,"main",2),t._UZ(4,"router-outlet"),t.YNc(5,Ci,1,0,"div",3),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("ngIf","reports"===o.path))},dependencies:[y.O5,wi.O,Zi.u,Q.lC,Kt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}main[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(router-outlet){display:flex;flex-direction:column;width:100%;height:100%}\n\n/*# sourceMappingURL=new-reports.component.ts-angular-inline--143.css.map*/"]})}return s})(),children:Ce},{path:"",component:Pe,children:Ce}];let Oi=(()=>{class s{static#t=this.\u0275fac=function(e){return new(e||s)};static#e=this.\u0275mod=t.oAB({type:s});static#n=this.\u0275inj=t.cJS({imports:[y.ez,K.u5,Oe.v,te.YR,vt.PP,Ue.TU,Q.Bz.forChild(Ti)]})}return s})()}}]);
//# sourceMappingURL=apps_concierge_src_app_reports_reports_module_ts.js.map