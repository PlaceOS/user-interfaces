(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_reports_reports_module_ts"],{8993:(Je,Le,S)=>{"use strict";S.r(Le),S.d(Le,{ReportsModule:()=>fe});var Y=S(4666),X=S(2508),I=S(9885),t=S(3045),O=S(4567),e=S(2560),r=S(4945),i=S(3770),p=S(207),n=S(5306);const a=function(){return["/reports","desks"]};function u(l,o){1&l&&(e.TgZ(0,"a",1)(1,"app-icon",2),e._uU(2,"room"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Desks"),e.qZA(),e.TgZ(5,"div",4)(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA()()()),2&l&&e.Q6J("routerLink",e.DdM(1,a))}const m=function(){return["/reports","spaces"]};function f(l,o){1&l&&(e.TgZ(0,"a",1)(1,"app-icon",2),e._uU(2,"meeting_room"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Rooms"),e.qZA(),e.TgZ(5,"div",4)(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA()()()),2&l&&e.Q6J("routerLink",e.DdM(1,m))}const d=function(){return["/reports","catering"]};function h(l,o){1&l&&(e.TgZ(0,"a",1)(1,"app-icon",2),e._uU(2,"room_service"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Catering"),e.qZA(),e.TgZ(5,"div",4)(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA()()()),2&l&&e.Q6J("routerLink",e.DdM(1,d))}const x=function(){return["/reports","contact-tracing"]};function y(l,o){1&l&&(e.TgZ(0,"a",1)(1,"app-icon",2),e._uU(2,"connect_without_contact"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Contact Tracing"),e.qZA(),e.TgZ(5,"div",4)(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA()()()),2&l&&e.Q6J("routerLink",e.DdM(1,x))}const b=["desks","spaces","catering","contact-tracing"];class A{constructor(o){this._settings=o}get features(){return this._settings.get("app.reports.features")||b}}function G(l,o){1&l&&e._UZ(0,"div",3)}A.\u0275fac=function(o){return new(o||A)(e.Y36(i.gb))},A.\u0275cmp=e.Xpm({type:A,selectors:[["reports-menu"],["","reports-menu",""]],decls:4,vars:4,consts:[["matRipple","","class","h-64 w-64 m-4 p-4 flex flex-col items-center justify-center bg-white dark:bg-neutral-700 rounded shadow hover:opacity-80",3,"routerLink",4,"ngIf"],["matRipple","",1,"h-64","w-64","m-4","p-4","flex","flex-col","items-center","justify-center","bg-white","dark:bg-neutral-700","rounded","shadow","hover:opacity-80",3,"routerLink"],[1,"text-8xl"],[1,"text-xl","font-bold","mb-4"],[1,"flex","items-center"],[1,"ml-2"]],template:function(o,s){1&o&&(e.YNc(0,u,10,2,"a",0),e.YNc(1,f,10,2,"a",0),e.YNc(2,h,10,2,"a",0),e.YNc(3,y,10,2,"a",0)),2&o&&(e.Q6J("ngIf",s.features.includes("desks")),e.xp6(1),e.Q6J("ngIf",s.features.includes("spaces")),e.xp6(1),e.Q6J("ngIf",s.features.includes("catering")),e.xp6(1),e.Q6J("ngIf",s.features.includes("contact-tracing")))},dependencies:[Y.O5,p.wG,n.o,I.rH],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row!important;align-items:center;justify-content:center;background:inherit}\n/*# sourceMappingURL=reports-menu.component.ts-angular-inline--100.css.map*/"]});class P{constructor(o){this._router=o}get path(){const o=this._router.url.split("/");return o[o.length-1]}}P.\u0275fac=function(o){return new(o||P)(e.Y36(I.F0))},P.\u0275cmp=e.Xpm({type:P,selectors:[["","app-reports",""]],attrs:["app-reports",""],decls:4,vars:1,consts:[[1,"h-full"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full","bg-gray-300","dark:bg-neutral-600"],["reports-menu","","class","absolute inset-0",4,"ngIf"],["reports-menu","",1,"absolute","inset-0"]],template:function(o,s){1&o&&(e._UZ(0,"sidebar",0),e.TgZ(1,"main",1),e._UZ(2,"router-outlet"),e.YNc(3,G,1,0,"div",2),e.qZA()),2&o&&(e.xp6(3),e.Q6J("ngIf","reports"===s.path))},dependencies:[Y.O5,r.k,I.lC,A],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%}main[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(router-outlet){display:flex;flex-direction:column;width:100%;height:100%}\n/*# sourceMappingURL=reports.component.ts-angular-inline--96.css.map*/"]});var Z=S(2886),M=S(711),T=S(3918),z=S(5670),E=S(6221),v=S(3690),w=S(9232),L=S(9830),R=S(9377),q=S(3200),H=S(475),B=S(312),Q=S(8210),$=S(2317),V=S(3861),Re=S(2218),ee=S(4505),te=S(4139),ae=S(7716),Ee=S(823),me=S(9095),ke=S(7418),F=S(6942),se=S(9128),Ce=S(6198);class W{constructor(o){var s=this;this._org=o,this._space_pipe=new Ce.X(this._org),this._generate=new Re.xQ,this._loading=new ee.X(""),this._active_bookings=new ee.X([]),this._options=new ee.X({start:new Date,end:new Date}),this._bookings_list=this._generate.pipe((0,Ee.b)(500),(0,me.w)(c=>{const g=this._options.getValue();if(this._loading.next("Loading report details..."),!g?.type&&!g?.zones?.length)return(0,te.of)([]);const _=(0,R.Z)(g?.start?new Date(g.start):new Date).valueOf(),U=(0,q.Z)(g?.end?new Date(g.end):_).valueOf(),D=g?.zones?g.zones.filter(N=>"All"!==N).join(","):"",j={period_start:Math.floor(_/1e3),period_end:Math.floor(U/1e3)};return"desks"===g.type?(0,w.F2)({...j,zones:D,type:"desk"}):(0,L.u$)({...j,zone_ids:D}).pipe((0,me.w)(function(){var N=(0,T.Z)(function*(K){return Promise.all(K.map(function(){var C=(0,T.Z)(function*(J){return new L.ym({...J,resources:yield Promise.all(J.resources.map(oe=>s._space_pipe.transform(oe.id||oe.email)))})});return function(J){return C.apply(this,arguments)}}()))});return function(K){return N.apply(this,arguments)}}()))}),(0,ke.K)(c=>[]),(0,F.U)(c=>(this._loading.next(""),c?.length||(0,i.cB)("No bookings for the selected levels and period"),this._active_bookings.next(c||[]),c)),(0,se.d)()),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.bookings=this._active_bookings.asObservable(),this.counts=this._options.pipe((0,Ee.b)(500),(0,me.w)(c=>{const g=(c.zones||[]).filter(_=>-1!==_&&"All"!==_);return Promise.all(g.map(_=>(0,v.rlq)(_,"desks").pipe((0,F.U)(U=>[_,U.details.length])).toPromise()))}),(0,ke.K)(c=>[]),(0,F.U)(c=>{const g={};return this._active_bookings.next([]),c.forEach(([_,U])=>g[_]=U),g}),(0,se.d)()),this.stats=(0,ae.aj)([this.counts,this.bookings]).pipe((0,me.w)(function(){var c=(0,T.Z)(function*([g,_]){return _[0]instanceof L.ym?function We(l,o=8){o=Math.max(1,o);const s=l.reduce((U,D)=>U+D.attendees.length,0),c=l.reduce((U,D)=>U+D.system?.capacity,0),g=Math.floor(l.reduce((U,D)=>U+D.duration,0)/(60*o)*100)/100,_=Math.floor(s/c*100)/100;return{count:l.length,avg_length:Math.floor(l.reduce((U,D)=>U+D.duration,0)/l.length*100)/100,efficiency:Math.floor((g+_)/2*100)/100,total_users:s,total_capacity:c,occupancy:_,utilisation:g,events:l}}(_,8*s.duration):function He(l,o=1,s={}){o=Math.max(1,o);const c=Object.keys(s).reduce((_,U)=>_+(s[U]||0),0),g=Math.floor(l.length/c/o*1e4)/1e4;return{total:c,count:l.length,utilisation:g,events:l}}(_||[],s.duration,g)});return function(g){return c.apply(this,arguments)}}())),this.day_list=(0,ae.aj)([this.options,this.stats]).pipe((0,F.U)(([c,g])=>{const{start:_}=c;let U=(0,R.Z)(_);const D=(0,q.Z)(c.end||U),j=[];for(;(0,H.Z)(U,D);){const N=(0,R.Z)(U).valueOf(),K=(0,q.Z)(N).valueOf(),C=g.events.filter(J=>(0,i.MZ)(N,K,J.date,J.date+60*J.duration*1e3));j.push({date:N,total:g.total,free:g.total-C.length,approved:C.reduce((J,oe)=>J+(oe.approved?1:0),0),count:C.length,utilisation:(C.length/g.total*100).toFixed(1)}),U=(0,B.Z)(U,1)}return j}),(0,se.d)(1)),this._bookings_list.subscribe(c=>c)}get duration(){const o=this._options.getValue();return Math.max(1,Math.abs((0,Q.Z)((0,R.Z)(o.start),(0,$.Z)((0,q.Z)(o.end),1))))}generateReport(){this._generate.next((new Date).valueOf())}setOptions(o){o.zones?.includes("All")?o.zones=["All",...this._org.levelsForBuilding(this._org.building).map(s=>s.id)]:o.zones&&this._options.getValue()?.zones?.includes("All")&&(o.zones=[]),o.start?.valueOf()!==this._options.getValue().start?.valueOf()&&o.end?.valueOf()!==this._options.getValue().end?.valueOf()&&this._options.next({...this._options.getValue(),...o})}downloadReport(){const o=this._options.getValue(),s=this._active_bookings.getValue();(0,i.Sv)(`report+${o.type}+${(0,V.Z)(o.start,"yyyy-MM-dd")}+${(0,V.Z)(o.end,"yyyy-MM-dd")}.csv`,(0,i.o3)(s.map(c=>{const g=c.toJSON();return delete g.zones,delete g.server_names,delete g.extension_data,g})))}}W.\u0275fac=function(o){return new(o||W)(e.LFG(E.w7))},W.\u0275prov=e.Yz7({token:W,factory:W.\u0275fac,providedIn:"root"});var le=S(9159),ze=S(1204),$e=S(9732),Ke=S(7090),ne=S(7265),Ne=S(4217);function et(l,o){if(1&l&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&l){const s=o.$implicit;e.Q6J("value",s.id),e.xp6(1),e.hij(" ",s.display_name||s.name," ")}}function tt(l,o){1&l&&e._UZ(0,"mat-spinner",15),2&l&&e.Q6J("diameter",32)}function nt(l,o){1&l&&(e.TgZ(0,"p"),e._uU(1,"Generate Report"),e.qZA())}class re extends i.KG{constructor(o,s,c,g){super(),this._state=o,this._org=s,this._route=c,this._router=g,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(_=>`${_.id}`),this.levels=this._org.active_levels,this.loading=this._state.loading,this.bookings=this._state.bookings,this.options=this._state.options,this.page="",this.generateReport=()=>this._state.generateReport(),this.downloadReport=()=>this._state.downloadReport(),this.setStartDate=_=>this._state.setOptions({start:new Date(_)}),this.setEndDate=_=>this._state.setOptions({end:new Date(_)}),this.setZones=_=>this._state.setOptions({zones:_})}ngOnInit(){var o=this;return(0,T.Z)(function*(){yield o._org.initialised.pipe((0,z.P)(s=>s)).toPromise(),o.page=o._router.url,o.subscription("routing",o._router.events.subscribe(()=>{o.page=o._router.url})),o.subscription("route.query",o._route.queryParamMap.subscribe(s=>{if(s.has("zone_ids")){const c=s.get("zone_ids").split(",");if(c.length){const g=o._org.levelWithID(c);if(!g)return;o._org.building=o._org.buildings.find(_=>_.id===g.parent_id),o.setZones(c)}}}))})()}}re.\u0275fac=function(o){return new(o||re)(e.Y36(W),e.Y36(E.w7),e.Y36(I.gz),e.Y36(I.F0))},re.\u0275cmp=e.Xpm({type:re,selectors:[["reports-options"]],features:[e.qOj],decls:28,vars:28,consts:[[1,"bg-white","dark:bg-neutral-700","h-20","w-full","flex","items-center","px-2","shadow","z-20","border-b","border-gray-200"],["appearance","outline",1,"w-48"],["multiple","","placeholder","Select Levels...",3,"ngModel","ngModelChange"],["value","All"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"w-64"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["mat-button","",1,"ml-4",3,"disabled","click"],[3,"diameter",4,"ngIf"],[4,"ngIf"],[3,"value"],[3,"diameter"]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-select",2),e.NdJ("ngModelChange",function(g){return s.setZones(g)}),e.ALo(3,"async"),e.TgZ(4,"mat-option",3),e._uU(5,"All Levels"),e.qZA(),e.YNc(6,et,2,2,"mat-option",4),e.ALo(7,"async"),e.qZA()(),e.TgZ(8,"mat-form-field",5)(9,"mat-date-range-input",6)(10,"input",7),e.NdJ("ngModelChange",function(g){return g?s.setStartDate(g):""}),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"input",8),e.NdJ("ngModelChange",function(g){return g?s.setEndDate(g):""}),e.ALo(13,"async"),e.qZA()(),e._UZ(14,"mat-datepicker-toggle",9)(15,"mat-date-range-picker",null,10),e.qZA(),e.TgZ(17,"button",11),e.NdJ("click",function(){return s.generateReport()}),e.ALo(18,"async"),e.ALo(19,"async"),e.YNc(20,tt,1,1,"mat-spinner",12),e.ALo(21,"async"),e.YNc(22,nt,2,0,"p",13),e.ALo(23,"async"),e.qZA(),e.TgZ(24,"button",11),e.NdJ("click",function(){return s.downloadReport()}),e.ALo(25,"async"),e.TgZ(26,"p"),e._uU(27,"Download Report"),e.qZA()()()),2&o){const c=e.MAs(16);let g,_,U,D,j;e.xp6(2),e.Q6J("ngModel",null==(g=e.lcZ(3,10,s.options))?null:g.zones),e.xp6(4),e.Q6J("ngForOf",e.lcZ(7,12,s.levels)),e.xp6(3),e.Q6J("rangePicker",c),e.xp6(1),e.Q6J("ngModel",null==(_=e.lcZ(11,14,s.options))?null:_.start),e.xp6(2),e.Q6J("ngModel",null==(U=e.lcZ(13,16,s.options))?null:U.end),e.xp6(2),e.Q6J("for",c),e.xp6(3),e.Q6J("disabled",!!e.lcZ(18,18,s.loading)||!(null!=(D=e.lcZ(19,20,s.options))&&null!=D.zones&&D.zones.length)),e.xp6(3),e.Q6J("ngIf",e.lcZ(21,22,s.loading)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(23,24,s.loading)),e.xp6(2),e.Q6J("disabled",!(null!=(j=e.lcZ(25,26,s.bookings))&&j.length))}},dependencies:[Y.sg,Y.O5,X.Fj,X.JJ,X.On,le.eB,ze.v_,ze.nX,$e.x8,Ke.CK,ne.nW,ne.wx,ne.zY,ne.By,ne._g,Ne.sN,Y.Ov],styles:["button[_ngcontent-%COMP%]{min-width:0;padding:0 .85rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;margin-left:1em}mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:5.5em;white-space:initial;line-height:1.2em}\n/*# sourceMappingURL=reports-options.component.ts-angular-inline--97.css.map*/"]});var ot=S(6323),st=S(5845),Qe=S(7684),Ie=S(8325),Fe=S(1170);function at(l){(0,Fe.Z)(1,arguments);var o=(0,Ie.Z)(l),s=o.getDay();return 0===s||6===s}var rt=S(7367),Pe=S(1799);function lt(l,o){if(1&l&&(e.TgZ(0,"div",0)(1,"div",3)(2,"h3"),e._uU(3,"No show count"),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"div",3)(8,"h3"),e._uU(9,"% of No show Bookings"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.ALo(12,"async"),e.qZA()(),e.TgZ(13,"div",3)(14,"h3"),e._uU(15,"Total in-room attendance"),e.qZA(),e.TgZ(16,"p"),e._uU(17),e.ALo(18,"async"),e.qZA()()()),2&l){const s=e.oxw();e.xp6(5),e.Oqu(e.lcZ(6,3,s.no_shows)||0),e.xp6(6),e.hij("",e.lcZ(12,5,s.no_show_percent)||0,"%"),e.xp6(6),e.Oqu(e.lcZ(18,7,s.attendance)||0)}}class ge{constructor(o){this._state=o,this.business_days=this._state.options.pipe((0,F.U)(({start:s,end:c})=>function it(l,o){(0,Fe.Z)(2,arguments);var s=(0,Ie.Z)(l),c=(0,Ie.Z)(o);if(!(0,Qe.Z)(s)||!(0,Qe.Z)(c))return NaN;var g=(0,ot.Z)(s,c),_=g<0?-1:1,U=(0,rt.Z)(g/7),D=5*U;for(c=(0,B.Z)(c,7*U);!(0,st.Z)(s,c);)D+=at(c)?0:_,c=(0,B.Z)(c,_);return 0===D?0:D}((0,R.Z)(c||Date.now()),(0,q.Z)(s||Date.now()))||1)),this.total_count=this._state.stats.pipe((0,F.U)(s=>s.count||0)),this.avg_length=this._state.stats.pipe((0,F.U)(s=>(0,Pe.Z)({minutes:Math.floor(s.avg_length||0)}))),this.attendance=this._state.stats.pipe((0,F.U)(({events:s})=>s.reduce((c,{extension_data:g})=>c+(+g?.people_count?.max||0),0))),this.no_shows=this._state.stats.pipe((0,F.U)(({events:s})=>s.reduce((c,{extension_data:g})=>c+ +g?.people_count?.max?1:0,0))),this.no_show_percent=this._state.stats.pipe((0,F.U)(({events:s})=>Math.floor(s.reduce((c,{extension_data:g})=>c+ +g?.people_count?.max?1:0,0)/s.length*1e4)/100)),this.has_attendance=this._state.stats.pipe((0,F.U)(({events:s})=>!!s.find(({extension_data:c})=>!!c?.people_count)))}}ge.\u0275fac=function(o){return new(o||ge)(e.Y36(W))},ge.\u0275cmp=e.Xpm({type:ge,selectors:[["report-spaces-overall"]],decls:21,vars:12,consts:[[1,"m-4","p-4","rounded","bg-white","dark:bg-neutral-700","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],["class","m-4 p-4 rounded bg-white dark:bg-neutral-700 shadow flex justify-center items-center space-x-2",4,"ngIf"],[1,"flex-1","flex","flex-col","items-center","justify-center"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3"),e._uU(3,"Business Days"),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"div",1)(8,"h3"),e._uU(9,"Total Bookings"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.ALo(12,"async"),e.qZA()(),e.TgZ(13,"div",1)(14,"h3"),e._uU(15,"Average Booking Length"),e.qZA(),e.TgZ(16,"p"),e._uU(17),e.ALo(18,"async"),e.qZA()()(),e.YNc(19,lt,19,9,"div",2),e.ALo(20,"async")),2&o&&(e.xp6(5),e.Oqu(e.lcZ(6,4,s.business_days)||0),e.xp6(6),e.Oqu(e.lcZ(12,6,s.total_count)||0),e.xp6(6),e.Oqu(e.lcZ(18,8,s.avg_length)||"None"),e.xp6(2),e.Q6J("ngIf",e.lcZ(20,10,s.has_attendance)))},dependencies:[Y.O5,Y.Ov],styles:["h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n/*# sourceMappingURL=report-spaces-overall.component.ts-angular-inline--101.css.map*/"]});var ce=S(3910),ue=S(1110);const ct=function(){return["flex"]};class he{constructor(o){var s=this;this._reports=o,this.space_list=(0,ae.aj)([this._reports.stats,this._reports.options]).pipe((0,Ee.b)(300),(0,F.U)(([c,{start:g,end:_}])=>{let U=[],D=!1;for(const N of c.events){const K=(0,i.Tw)(N.resources,"email")||[N.system];for(const C of K){let J=U.find(oe=>oe.id===C.id||oe.id?.toLowerCase()===C.email.toLowerCase());if(!J){if(J={id:C.id||C.email,name:C.display_name||C.name,capacity:C.capacity||1,count:0,attendance:0,avg_attendance:0,min_attendance:99,max_attendance:0,attendees:0,avg_attendees:0,usage:0,no_shows:0,utilisation:0,occupancy:0},!J.id||!J.name)continue;U.push(J)}0===N.extension_data?.people_count?.max&&(J.no_shows+=1),J.count+=1,J.attendance+=N.extension_data?.people_count?.max??0,J.avg_attendance+=N.extension_data?.people_count?.avg??0,J.min_attendance=Math.min(J.max_attendance,N.extension_data?.people_count?.max??99),J.max_attendance=Math.max(J.max_attendance,N.extension_data?.people_count?.max??0),J.usage+=N.duration,J.attendees+=N.attendees.length,D=D||!!N.extension_data.people_count}}const j=Math.max(1,(0,Q.Z)(_,g)+1);for(const N of U)N.avg_attendees=Math.floor(N.attendees/N.count*100)/100,N.avg_attendance=Math.floor(N.attendance/N.count*100)/100,N.utilisation=`${Math.floor(N.usage/60/8/j*100)}%`,N.min_attendance=99===N.min_attendance?"?":N.min_attendance,N.occupancy=Math.floor(N.avg_attendees/N.capacity*1e3)/10+"%",(N.attendance<0||!D)&&(N.attendance="?",N.avg_attendance="?");return U})),this.has_attendance=this.space_list.pipe((0,F.U)(c=>!!c.find(({attendance:g})=>"?"!==g))),this.column_list=this.has_attendance.pipe((0,F.U)(c=>c?["name","capacity","count","utilisation","avg_attendees","attendance","avg_attendance","no_shows","min_attendance","max_attendance"]:["name","capacity","count","utilisation","avg_attendees"])),this.column_name_list=this.has_attendance.pipe((0,F.U)(c=>c?["Name","Room Capacity","Bookings","% Time booked during office hrs","Avg. invitees per booking","Total In-room Attendance","Avg. In-room Attendance","No Shows","Min. In-room Attendance","Max. In-room Attendance"]:["Name","Room Capacity","Bookings","% Time booked during office hrs","Avg. invitees per booking"])),this.download=(0,T.Z)(function*(){const c=yield s.space_list.pipe((0,ce.q)(1)).toPromise();(0,i.Sv)("report-spaces-usage.csv",(0,i.o3)(c))})}}he.\u0275fac=function(o){return new(o||he)(e.Y36(W))},he.\u0275cmp=e.Xpm({type:he,selectors:[["report-spaces-space-listing"]],decls:10,vars:10,consts:[[1,"m-4","rounded","bg-white","dark:bg-neutral-700","shadow","overflow-hidden"],[1,"border-b","border-gray-300","dark:border-neutral-500","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],[3,"dataSource","pagination","columns","display_column","column_size"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3,"Room Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return s.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()()(),e._UZ(7,"custom-table",4),e.ALo(8,"async"),e.ALo(9,"async"),e.qZA()),2&o&&(e.xp6(7),e.Q6J("dataSource",s.space_list)("pagination",!0)("columns",e.lcZ(8,5,s.column_list))("display_column",e.lcZ(9,7,s.column_name_list))("column_size",e.DdM(9,ct)))},dependencies:[le.eB,n.o,ue.C,Y.Ov]});const ut=function(){return["name","count","avg_attendees","total_time","no_shows"]},dt=function(){return["Name","Bookings","Avg. Invitees per Booking","Total Booked Time","No Shows"]},pt=function(){return["flex"]};class _e{constructor(o){var s=this;this._reports=o,this.user_list=(0,ae.aj)([this._reports.stats]).pipe((0,Ee.b)(300),(0,F.U)(([c])=>{let g=[];for(const _ of c.events){const U=_.attendees?.find(N=>N.email===_.host);if(!U)continue;const D=Math.max(_.resources.reduce((N,K)=>N+K.capacity,0)||1,1);let j=g.find(N=>N.id?.toLowerCase()===U.email.toLowerCase());j||(j={id:U.email,name:U.name,capacity:D,count:0,attendees:0,avg_attendees:0,no_shows:0,occupancy:0,total_time:0},g.push(j)),0===_.extension_data?.people_count?.max&&(j.no_shows+=1),j.count+=1,j.attendees+=_.attendees.length,j.total_time+=_.duration||15}for(const _ of g)_.avg_attendees=Math.floor(_.attendees/_.count*100)/100,_.occupancy=Math.floor(_.avg_attendees/_.capacity*100)/100,_.total_time=(0,Pe.Z)({hours:Math.floor(_.total_time/60),minutes:_.total_time%60});return g}),(0,se.d)(1)),this.download=(0,T.Z)(function*(){const c=yield s.user_list.pipe((0,ce.q)(1)).toPromise();(0,i.Sv)("report-space-attendee-usage.csv",(0,i.o3)(c))})}}function mt(l,o){1&l&&(e.ynx(0),e._UZ(1,"report-spaces-overall")(2,"report-spaces-space-listing")(3,"report-spaces-user-listing"),e.BQk())}function gt(l,o){if(1&l&&(e.ynx(0),e.YNc(1,mt,4,0,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&l){const s=e.oxw(),c=e.MAs(7);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,s.total_count))("ngIfElse",c)}}function ht(l,o){1&l&&(e.TgZ(0,"div",4),e._UZ(1,"mat-spinner",5),e.TgZ(2,"p",6),e._uU(3,"Loading report data..."),e.qZA()()),2&l&&(e.xp6(1),e.Q6J("diameter",32))}function _t(l,o){1&l&&(e.TgZ(0,"div",4)(1,"p",6),e._uU(2," Select levels and time period to generate a report. "),e.qZA()())}_e.\u0275fac=function(o){return new(o||_e)(e.Y36(W))},_e.\u0275cmp=e.Xpm({type:_e,selectors:[["report-spaces-user-listing"]],decls:8,vars:8,consts:[[1,"m-4","rounded","bg-white","dark:bg-neutral-700","shadow","overflow-hidden"],[1,"border-b","border-gray-300","dark:border-neutral-500","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],[3,"dataSource","pagination","columns","display_column","column_size"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3,"Meeting Organisers"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return s.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()()(),e._UZ(7,"custom-table",4),e.qZA()),2&o&&(e.xp6(7),e.Q6J("dataSource",s.user_list)("pagination",!0)("columns",e.DdM(5,ut))("display_column",e.DdM(6,dt))("column_size",e.DdM(7,pt)))},dependencies:[le.eB,n.o,ue.C]});class ve{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,F.U)(s=>s.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}function vt(l,o){1&l&&(e._uU(0),e.ALo(1,"date")),2&l&&e.hij(" ",e.xi3(1,1,o.data,"mediumDate")," ")}function xt(l,o){1&l&&e._uU(0),2&l&&e.hij(" ",o.data||"0","% ")}ve.\u0275fac=function(o){return new(o||ve)(e.Y36(W))},ve.\u0275cmp=e.Xpm({type:ve,selectors:[["","report-spaces",""]],attrs:["report-spaces",""],decls:8,vars:4,consts:[[1,"relative","flex-1","h-1/2","w-full","overflow-auto","z-0"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(o,s){if(1&o&&(e._UZ(0,"reports-options"),e.TgZ(1,"div",0),e.YNc(2,gt,3,4,"ng-container",1),e.ALo(3,"async"),e.qZA(),e.YNc(4,ht,4,1,"ng-template",null,2,e.W1O),e.YNc(6,_t,3,0,"ng-template",null,3,e.W1O)),2&o){const c=e.MAs(5);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,s.loading))("ngIfElse",c)}},dependencies:[Y.O5,Ne.sN,re,ge,he,_e,Y.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}\n/*# sourceMappingURL=report-spaces.component.ts-angular-inline--98.css.map*/"]});const yt=function(){return["date","usage","approved","count","utilisation"]},wt=function(){return["Date","Used Desks","Approved Bookings","Total Requests","Utilisation"]},bt=function(){return["flex"]},At=function(l,o,s){return{date:l,usage:o,utilisation:s}};class xe{constructor(o){var s=this;this._state=o,this.day_list=this._state.day_list,this.download=(0,T.Z)(function*(){let c=yield s.day_list.pipe((0,ce.q)(1)).toPromise();c=c.map(g=>({...g,date:(0,V.Z)(g.date,"MMMM d, y(EEE)")})),(0,i.Sv)("desks-usage.csv",(0,i.o3)(c))})}}function Zt(l,o){1&l&&e._uU(0),2&l&&e.hij(" ",o.data||"0","% ")}xe.\u0275fac=function(o){return new(o||xe)(e.Y36(W))},xe.\u0275cmp=e.Xpm({type:xe,selectors:[["report-desks-overall-list"]],decls:12,vars:13,consts:[[1,"m-4","rounded","bg-white","dark:bg-neutral-700","shadow","overflow-hidden"],[1,"border-b","border-gray-300","dark:border-neutral-500","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["date_view",""],["percent_view",""]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3,"Daily Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return s.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()()(),e._UZ(7,"custom-table",4),e.YNc(8,vt,2,4,"ng-template",null,5,e.W1O),e.YNc(10,xt,1,1,"ng-template",null,6,e.W1O),e.qZA()),2&o){const c=e.MAs(9),g=e.MAs(11);e.xp6(7),e.Q6J("dataSource",s.day_list)("pagination",!0)("columns",e.DdM(6,yt))("display_column",e.DdM(7,wt))("column_size",e.DdM(8,bt))("template",e.kEZ(9,At,c,g,g))}},dependencies:[le.eB,n.o,ue.C,Y.uU],encapsulation:2});const Mt=function(){return["name","avg_usage","approved","count","utilisation"]},Tt=function(){return["Level","Avg. Used Desks","Approved Bookings","Total Requests","Utilisation"]},Ot=function(){return["flex"]},St=function(l){return{utilisation:l}};class ye{constructor(o,s){var c=this;this._state=o,this._org=s,this.level_list=(0,ae.aj)([this._state.options,this._state.stats,this._state.counts]).pipe((0,F.U)(([g,_,U])=>{const{start:D,end:j,zones:N}=g,K=(0,Q.Z)(j,D)||1,C=[];for(const J of N){if("All"===J)continue;const oe=this._org.levelWithID([J]),Ye=U[J]||0,Ue=_.events.filter(qe=>qe.zones.includes(J));let Be=(Ye*K-Ue.length)/K;Be%1!=0&&(Be=Be.toFixed(2)),C.push({name:oe?.display_name||oe?.name,free:Be,approved:Ue.filter(qe=>qe.approved).length||0,avg_usage:Ue.length/K,total:Ye,count:Ue.length,utilisation:(Ue.length/((Ye||1)*K)*100||0).toFixed(2)})}return C}),(0,se.d)(1)),this.download=(0,T.Z)(function*(){let g=yield c.level_list.pipe((0,ce.q)(1)).toPromise();(0,i.Sv)("desks-levels-usage.csv",(0,i.o3)(g))})}}ye.\u0275fac=function(o){return new(o||ye)(e.Y36(W),e.Y36(E.w7))},ye.\u0275cmp=e.Xpm({type:ye,selectors:[["report-desks-levels-list"]],decls:11,vars:11,consts:[[1,"px-4","mb-4","w-full"],[1,"rounded","bg-white","dark:bg-neutral-700","shadow","overflow-hidden","w-full"],[1,"border-b","border-gray-300","dark:border-neutral-500","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["percent_view",""]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),e._uU(4,"Level Utilisation"),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return s.download()}),e.TgZ(6,"app-icon"),e._uU(7,"download"),e.qZA()()(),e._UZ(8,"custom-table",5),e.YNc(9,Zt,1,1,"ng-template",null,6,e.W1O),e.qZA()()),2&o){const c=e.MAs(10);e.xp6(8),e.Q6J("dataSource",s.level_list)("pagination",!0)("columns",e.DdM(6,Mt))("display_column",e.DdM(7,Tt))("column_size",e.DdM(8,Ot))("template",e.VKq(9,St,c))}},dependencies:[le.eB,n.o,ue.C],encapsulation:2});var Xe=S(7103);class we extends i.KG{constructor(o,s){super(),this._state=o,this._org=s,this.day_list=this._state.day_list,this.stats=(0,ae.aj)([this._state.options,this._state.counts])}ngOnInit(){this.subscription("day_list",this.day_list.subscribe(o=>this.updateDailyChart(o))),this.subscription("stats",this.stats.subscribe(([o,s])=>this.updateLevelChart(o,s)))}updateDailyChart(o){const s={labels:o.map(c=>(0,V.Z)(c.date,"dd MMM")),series:[o.map(c=>c.utilisation)]};this._day_chart=new Xe.Line("#day-chart",s)}updateLevelChart(o,s){let{zones:c}=o||{};c.includes("All")&&(c=this._org.levels.filter(_=>_.parent_id===this._org.building.id).map(_=>_.id));const g={labels:(c||[]).map(_=>{const U=this._org.levelWithID([_]);return U?.display_name||U.name||""}),series:(c||[]).map(_=>s[_])};this._level_chart=new Xe.Pie("#level-chart",g)}}function Lt(l,o){if(1&l&&(e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"h3"),e._uU(4,"Total Bookings"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.ALo(7,"async"),e.qZA()(),e.TgZ(8,"div",5)(9,"h3"),e._uU(10,"Utilisation"),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.ALo(13,"async"),e.qZA()()(),e._UZ(14,"report-desks-charts")(15,"report-desks-overall-list")(16,"report-desks-levels-list"),e.BQk()),2&l){const s=e.oxw(2);e.xp6(6),e.Oqu(e.lcZ(7,2,s.total_count)||0),e.xp6(6),e.hij("",e.lcZ(13,4,s.utilisation)||0,"%")}}function Rt(l,o){if(1&l&&(e.ynx(0),e.YNc(1,Lt,17,6,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&l){const s=e.oxw(),c=e.MAs(7);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,s.total_count))("ngIfElse",c)}}function Et(l,o){1&l&&(e.TgZ(0,"div",6),e._UZ(1,"mat-spinner",7),e.TgZ(2,"p",8),e._uU(3,"Loading report data..."),e.qZA()()),2&l&&(e.xp6(1),e.Q6J("diameter",32))}function kt(l,o){1&l&&(e.TgZ(0,"div",6)(1,"p",8),e._uU(2," Select levels and time period to generate a report. "),e.qZA()())}we.\u0275fac=function(o){return new(o||we)(e.Y36(W),e.Y36(E.w7))},we.\u0275cmp=e.Xpm({type:we,selectors:[["report-desks-charts"]],features:[e.qOj],decls:11,vars:0,consts:[[1,"flex","items-center","space-x-4","w-full","px-4"],[1,"bg-white","dark:bg-neutral-700","rounded","shadow","flex-1"],[1,"border-b","border-gray-300","dark:border-neutral-500","p-4","text-xl","font-bold"],["id","day-chart",1,"ct-chart","ct-octave"],["util_chart",""],["id","level-chart",1,"ct-chart","ct-octave"],["level_chart",""]],template:function(o,s){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3," Daily Utilisation "),e.qZA(),e._UZ(4,"div",3,4),e.qZA(),e.TgZ(6,"div",1)(7,"div",2),e._uU(8," Level Utilisation "),e.qZA(),e._UZ(9,"div",5,6),e.qZA()())},styles:["[_nghost-%COMP%]{display:block}\n/*# sourceMappingURL=report-desks-charts.component.ts-angular-inline--116.css.map*/"]});class be{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,F.U)(s=>s.count||0)),this.utilisation=this._state.stats.pipe((0,F.U)(s=>(100*(s.utilisation||0)).toFixed(1))),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"desks"})}}be.\u0275fac=function(o){return new(o||be)(e.Y36(W))},be.\u0275cmp=e.Xpm({type:be,selectors:[["","report-desks",""]],attrs:["report-desks",""],decls:8,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(o,s){if(1&o&&(e._UZ(0,"reports-options"),e.TgZ(1,"div",0),e.YNc(2,Rt,3,4,"ng-container",1),e.ALo(3,"async"),e.YNc(4,Et,4,1,"ng-template",null,2,e.W1O),e.YNc(6,kt,3,0,"ng-template",null,3,e.W1O),e.qZA()),2&o){const c=e.MAs(5);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,s.loading))("ngIfElse",c)}},dependencies:[Y.O5,Ne.sN,re,xe,ye,we,Y.Ov],styles:["h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n/*# sourceMappingURL=report-desks.component.ts-angular-inline--99.css.map*/"]});var Ge=S(1950);class ie{constructor(o){this._reports=o,this.catering_orders=this._reports.bookings.pipe((0,F.U)(s=>(0,i.xH)(s.filter(g=>g.extension_data?.catering?.length).map(g=>g.extension_data?.catering.map(_=>new Ge.GX({..._,deliver_at:g.date,event:g})))).filter(g=>g).sort((g,_)=>g.event?.date-_.event?.date)),(0,se.d)(1)),this.catering_items=this.catering_orders.pipe((0,F.U)(s=>{const c=[];for(const g of s)for(const _ of g?.items||[]){const U=c.findIndex(D=>_.options_string===D.options_string);U>=0?_[U]=new Ge.Ud({..._,quantity:_?.quantity+_[U]?.quantity}):c.push(_)}return c.sort((g,_)=>_.quantity-g.quantity)})),this.stats=(0,ae.aj)([this.catering_orders,this.catering_items]).pipe((0,F.U)(([s,c])=>{const g=s.reduce((_,U)=>_+U.total_cost,0);return{order_count:s.length,unique_items:c.length,item_count:s.reduce((_,U)=>_+U.item_count,0),total_cost:g,avg_cost:g/s.length}}))}downloadOrders(){var o=this;return(0,T.Z)(function*(){const s=yield o.catering_orders.pipe((0,ce.q)(1)).toPromise(),c=(0,i.o3)(s);return(0,i.Sv)("catering-orders.csv",c)})()}}ie.\u0275fac=function(o){return new(o||ie)(e.LFG(W))},ie.\u0275prov=e.Yz7({token:ie,factory:ie.\u0275fac,providedIn:"root"});class Ae{constructor(o,s){this._report=o,this._org=s,this.stats=this._report.stats}get code(){return this._org.currency_code}}Ae.\u0275fac=function(o){return new(o||Ae)(e.Y36(ie),e.Y36(E.w7))},Ae.\u0275cmp=e.Xpm({type:Ae,selectors:[["catering-report-overall"]],decls:32,vars:21,consts:[[1,"bg-white","dark:bg-neutral-700","shadow","rounded","m-2","px-8","w-48","h-24","flex","flex-col","items-center","justify-center"],["count","",1,"text-3xl"],[1,""],["unique","",1,"text-3xl"],["items","",1,"text-3xl"],["total","",1,"text-3xl"],["average","",1,"text-3xl"]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"div",2),e._uU(5,"Orders"),e.qZA()(),e.TgZ(6,"div",0)(7,"div",3),e._uU(8),e.ALo(9,"async"),e.qZA(),e.TgZ(10,"div",2),e._uU(11,"Unique Items"),e.qZA()(),e.TgZ(12,"div",0)(13,"div",4),e._uU(14),e.ALo(15,"async"),e.qZA(),e.TgZ(16,"div",2),e._uU(17,"Ordered Items"),e.qZA()(),e.TgZ(18,"div",0)(19,"div",5),e._uU(20),e.ALo(21,"currency"),e.ALo(22,"async"),e.qZA(),e.TgZ(23,"div",2),e._uU(24,"Total"),e.qZA()(),e.TgZ(25,"div",0)(26,"div",6),e._uU(27),e.ALo(28,"currency"),e.ALo(29,"async"),e.qZA(),e.TgZ(30,"div",2),e._uU(31,"Order Average"),e.qZA()()),2&o){let c,g,_,U,D;e.xp6(2),e.hij(" ",(null==(c=e.lcZ(3,5,s.stats))?null:c.order_count)||"0"," "),e.xp6(6),e.hij(" ",(null==(g=e.lcZ(9,7,s.stats))?null:g.unique_items)||"0"," "),e.xp6(6),e.Oqu((null==(_=e.lcZ(15,9,s.stats))?null:_.item_count)||"0"),e.xp6(6),e.hij(" ",e.xi3(21,11,(null==(U=e.lcZ(22,14,s.stats))?null:U.total_cost)/100||0,s.code)," "),e.xp6(7),e.hij(" ",e.xi3(28,16,(null==(D=e.lcZ(29,19,s.stats))?null:D.avg_cost)/100||0,s.code)," ")}},dependencies:[Y.Ov,Y.H9],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:center;padding:.5rem}\n/*# sourceMappingURL=catering-report-overall.component.ts-angular-inline--115.css.map*/"]});var je=S(6029);function zt(l,o){if(1&l&&(e._uU(0),e.ALo(1,"date"),e.ALo(2,"date")),2&l){const s=o.data;e.AsE(" ",e.lcZ(1,2,s)," at ",e.xi3(2,4,s,"shortTime")," ")}}function Nt(l,o){if(1&l&&(e._uU(0),e.ALo(1,"currency")),2&l){const s=o.data,c=e.oxw();e.hij(" ",e.xi3(1,1,s/100,c.code)," ")}}const Dt=function(){return["deliver_at","item_count","total_cost"]},Bt=function(){return["Date","Items","Total Cost"]},It=function(){return["flex"]},Pt=function(l,o){return{deliver_at:l,total_cost:o}};class Ze{constructor(o,s){this._report=o,this._org=s,this.orders=this._report.catering_orders,this.download=()=>this._report.downloadOrders()}get code(){return this._org.currency_code}}function jt(l,o){if(1&l&&(e.TgZ(0,"span",7),e._uU(1),e.qZA()),2&l){const s=e.oxw().data,c=e.oxw();e.Q6J("matTooltip",c.options(s)),e.xp6(1),e.hij(" ",s.length," option(s) ")}}function Yt(l,o){1&l&&e.YNc(0,jt,2,2,"span",6),2&l&&e.Q6J("ngIf",o.data.length)}function qt(l,o){if(1&l&&(e._uU(0),e.ALo(1,"currency")),2&l){const s=o.data,c=e.oxw();e.hij(" ",e.xi3(1,1,(s||0)/100,c.code)," ")}}Ze.\u0275fac=function(o){return new(o||Ze)(e.Y36(ie),e.Y36(E.w7))},Ze.\u0275cmp=e.Xpm({type:Ze,selectors:[["catering-report-orders"]],decls:12,vars:12,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","dark:bg-neutral-700","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","dark:border-neutral-500","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["mat-button-icon","","matTooltip","Download list",3,"click"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["date_state",""],["cost_state",""]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3,"Orders"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return s.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()()(),e._UZ(7,"custom-table",4),e.YNc(8,zt,3,7,"ng-template",null,5,e.W1O),e.YNc(10,Nt,2,4,"ng-template",null,6,e.W1O),e.qZA()),2&o){const c=e.MAs(9),g=e.MAs(11);e.xp6(7),e.Q6J("dataSource",s.orders)("columns",e.DdM(6,Dt))("display_column",e.DdM(7,Bt))("column_size",e.DdM(8,It))("template",e.WLB(9,Pt,c,g))("pagination",!0)}},dependencies:[je.Kd,n.o,ue.C,Y.H9,Y.uU]});const Jt=function(){return["name","options","quantity","unit_price","total_cost"]},Qt=function(){return["Name","Options","Quantity","Unit Price","Total Cost"]},Ft=function(){return["flex"]},Xt=function(l,o,s){return{options:l,unit_price:o,total_cost:s}};class Me{constructor(o,s){this._report=o,this._org=s,this.items=this._report.catering_items}get code(){return this._org.currency_code}options(o){return o.map(s=>s.name).join("\n")}}function Gt(l,o){1&l&&(e.TgZ(0,"div",5),e._UZ(1,"catering-report-overall")(2,"catering-report-orders")(3,"catering-report-items"),e.qZA())}function Vt(l,o){if(1&l&&(e.ynx(0),e.YNc(1,Gt,4,0,"div",4),e.ALo(2,"async"),e.BQk()),2&l){const s=e.oxw(),c=e.MAs(7);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,s.total_count))("ngIfElse",c)}}function Ht(l,o){1&l&&(e.TgZ(0,"div",6),e._UZ(1,"mat-spinner",7),e.TgZ(2,"p",8),e._uU(3,"Loading report data..."),e.qZA()()),2&l&&(e.xp6(1),e.Q6J("diameter",32))}function Wt(l,o){1&l&&(e.TgZ(0,"div",6)(1,"p",8),e._uU(2," Select levels and time period to generate a report. "),e.qZA()())}Me.\u0275fac=function(o){return new(o||Me)(e.Y36(ie),e.Y36(E.w7))},Me.\u0275cmp=e.Xpm({type:Me,selectors:[["catering-report-items"]],decls:9,vars:13,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","dark:bg-neutral-700","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","dark:border-neutral-500","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["option_state",""],["cost_state",""],["class","text-xs px-2 py-1 rounded bg-gray-300",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-gray-300",3,"matTooltip"]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3,"Ordered Items"),e.qZA()(),e._UZ(4,"custom-table",3),e.YNc(5,Yt,1,1,"ng-template",null,4,e.W1O),e.YNc(7,qt,2,4,"ng-template",null,5,e.W1O),e.qZA()),2&o){const c=e.MAs(6),g=e.MAs(8);e.xp6(4),e.Q6J("dataSource",s.items)("columns",e.DdM(6,Jt))("display_column",e.DdM(7,Qt))("column_size",e.DdM(8,Ft))("template",e.kEZ(9,Xt,c,g,g))("pagination",!0)}},dependencies:[Y.O5,je.Kd,ue.C,Y.H9]});class Te{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,F.U)(s=>s.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}Te.\u0275fac=function(o){return new(o||Te)(e.Y36(W))},Te.\u0275cmp=e.Xpm({type:Te,selectors:[["catering-report"]],decls:8,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],["class","h-full w-full",4,"ngIf","ngIfElse"],[1,"h-full","w-full"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(o,s){if(1&o&&(e._UZ(0,"reports-options"),e.TgZ(1,"div",0),e.YNc(2,Vt,3,4,"ng-container",1),e.ALo(3,"async"),e.YNc(4,Ht,4,1,"ng-template",null,2,e.W1O),e.YNc(6,Wt,3,0,"ng-template",null,3,e.W1O),e.qZA()),2&o){const c=e.MAs(5);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,s.loading))("ngIfElse",c)}},dependencies:[Y.O5,Ne.sN,re,Ae,Ze,Me,Y.Ov]});var Ve=S(1810),Ct=S(3298),$t=S(9151),Kt=S(8759);const De={};class de{transform(o){return o?(De[o]||(De[o]=(0,M.VE)(o).pipe((0,F.U)(s=>s[0]||new M.mO({id:o,name:o})),(0,ke.K)(s=>(0,te.of)(new M.mO({id:o,name:o}))),(0,se.d)(1))),De[o]):(0,te.of)(null)}static addUser(o){De[o.id]=(0,te.of)(o).pipe((0,se.d)(1))}}de.\u0275fac=function(o){return new(o||de)},de.\u0275pipe=e.Yjl({name:"user",type:de,pure:!0});class pe{constructor(o,s){this._org=o,this._reports=s,this._loading=new ee.X(""),this._generate=new ee.X(0),this._options=new ee.X({start:(0,R.Z)(Date.now()),end:(0,q.Z)(Date.now())}),this.events=(0,ae.aj)([this._options,this._generate]).pipe((0,Ct.x)((c,g)=>c[1]===g[1]),(0,$t.h)(([c,g])=>!!g),(0,me.w)(([{start:c,end:g,user:_}])=>{if(!_)return(0,te.of)([]);this._loading.next("Loading contact events...");const U=(0,v.rTZ)(this.system_id,"ContactTracing");return _=_||(0,i.ar)(),de.addUser(_),this.system_id&&U?U.execute("close_contacts",[_.email,_.username,(0,Ve.Z)(c),(0,Ve.Z)(g)]).catch(D=>((0,i.cB)(`${D?.msg||JSON.stringify(D)}`),[])):(0,te.of)([])}),(0,F.U)(c=>{const g=this._options.getValue().user||(0,i.ar)();return c.map(_=>({mac_address:_.mac_address,date:1e3*_.contact_time,duration:Math.floor(_.duration/60)||0,user_id:g.id,user:g.name,contact_id:_.username,distance:1}))}),(0,ke.K)(c=>((0,i.cB)(`${c?.msg||JSON.stringify(c)}`),(0,te.of)([]))),(0,Kt.b)(c=>this._loading.next("")),(0,se.d)(1)),this.options=this._options.asObservable(),this.loading=this._loading.asObservable()}get system_id(){return this._org.binding("contact_tracing")}setOptions(o){this._options.next({...this._options.getValue(),...o})}generateReport(){this._generate.next(Date.now())}downloadReport(){var o=this;return(0,T.Z)(function*(){const{start:s,end:c}=yield o._reports.options.pipe((0,ce.q)(1)).toPromise(),g=yield o.events.pipe((0,ce.q)(1)).toPromise(),_=new de,U=yield Promise.all(g.map(function(){var D=(0,T.Z)(function*(j){return{"MAC Address":j.mac_address,Date:(0,V.Z)(j.date,"dd MMM yyyy, h:mm a"),"User Name":j.user,"Contact Name":(yield _.transform(j.contact_id).toPromise())?.name||("null"!==j.contact_id?j.contact_id:null)||j.mac_address,Duration:`${Math.floor(j.duration/60)?Math.floor(j.duration/60)+"h ":""}${Math.floor(j.duration%60)+"m"}`,Distance:j.distance}});return function(j){return D.apply(this,arguments)}}()));(0,i.Sv)(`report+contact-tracing+${(0,V.Z)(s,"yyyy-MM-dd")}+${(0,V.Z)(c,"yyyy-MM-dd")}.csv`,(0,i.o3)(U))})()}}pe.\u0275fac=function(o){return new(o||pe)(e.LFG(E.w7),e.LFG(W))},pe.\u0275prov=e.Yz7({token:pe,factory:pe.\u0275fac,providedIn:"root"});var en=S(9697);class Oe{constructor(o){this._state=o,this.options=this._state.options,this.setOptions=s=>this._state.setOptions(s),this.generate=()=>this._state.generateReport()}}function tn(l,o){if(1&l&&(e.TgZ(0,"span",16),e._uU(1),e.qZA()),2&l){const s=e.oxw().data,c=e.oxw(3);e.Q6J("matTooltip",c.options(s)),e.xp6(1),e.hij(" ",s.length," option(s) ")}}function nn(l,o){1&l&&e.YNc(0,tn,2,2,"span",15),2&l&&e.Q6J("ngIf",o.data.length)}function on(l,o){if(1&l&&(e._uU(0),e.ALo(1,"async"),e.ALo(2,"user")),2&l){const c=o.row;let g;e.Oqu((null==(g=e.lcZ(1,1,e.lcZ(2,3,o.data)))?null:g.name)||c.mac_address)}}function sn(l,o){if(1&l&&(e._uU(0),e.ALo(1,"date"),e.ALo(2,"date")),2&l){const s=o.data;e.AsE(" ",e.xi3(1,2,s,"mediumDate"),", ",e.xi3(2,5,s,"shortTime")," ")}}function an(l,o){if(1&l&&e._uU(0),2&l){const s=o.data,c=e.oxw(3);e.hij(" ",c.formatDuration(s||0)||"Less than a minute"," ")}}function rn(l,o){1&l&&e._uU(0),2&l&&e.hij(" ",o.data,"m ")}Oe.\u0275fac=function(o){return new(o||Oe)(e.Y36(pe))},Oe.\u0275cmp=e.Xpm({type:Oe,selectors:[["contact-tracing-options"]],decls:15,vars:14,consts:[[1,"flex","items-center","space-x-2","w-full","p-2","bg-white","dark:bg-neutral-700","shadow"],["appearance","outline",1,"w-[18rem]"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["placeholder","Search for user to trace...",1,"w-64","h-12","mb-2","mt-1",3,"ngModel","ngModelChange"],["mat-button","",3,"disabled","click"]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-date-range-input",2)(3,"input",3),e.NdJ("ngModelChange",function(g){return g?s.setOptions({start:g,user:null}):""}),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"input",4),e.NdJ("ngModelChange",function(g){return g?s.setOptions({end:g,user:null}):""}),e.ALo(6,"async"),e.qZA()(),e._UZ(7,"mat-datepicker-toggle",5)(8,"mat-date-range-picker",null,6),e.qZA(),e.TgZ(10,"a-user-search-field",7),e.NdJ("ngModelChange",function(g){return s.setOptions({user:g})}),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"button",8),e.NdJ("click",function(){return s.generate()}),e.ALo(13,"async"),e._uU(14," Generate Report "),e.qZA()()),2&o){const c=e.MAs(9);let g,_,U,D;e.xp6(2),e.Q6J("rangePicker",c),e.xp6(1),e.Q6J("ngModel",null==(g=e.lcZ(4,6,s.options))?null:g.start),e.xp6(2),e.Q6J("ngModel",null==(_=e.lcZ(6,8,s.options))?null:_.end),e.xp6(2),e.Q6J("for",c),e.xp6(3),e.Q6J("ngModel",null==(U=e.lcZ(11,10,s.options))?null:U.user),e.xp6(2),e.Q6J("disabled",!(null!=(D=e.lcZ(13,12,s.options))&&D.user))}},dependencies:[X.Fj,X.JJ,X.On,le.eB,ze.v_,ze.nX,ne.nW,ne.wx,ne.zY,ne.By,ne._g,en.d,Y.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{height:3.25rem}\n/*# sourceMappingURL=contact-tracing-options.component.ts-angular-inline--118.css.map*/"]});const ln=function(){return["date","user_id","contact_id","duration"]},cn=function(){return["Time of Contact","Person","Close Contact","Duration"]},un=function(){return["12r","14r","flex","10r"]},dn=function(l,o,s,c,g,_){return{options:l,date:o,distance:s,user_id:c,contact_id:g,duration:_}};function pn(l,o){if(1&l&&(e.TgZ(0,"div",6)(1,"div",7)(2,"h2",8),e._uU(3,"Contact Events"),e.qZA()(),e._UZ(4,"custom-table",9),e.YNc(5,nn,1,1,"ng-template",null,10,e.W1O),e.YNc(7,on,3,5,"ng-template",null,11,e.W1O),e.YNc(9,sn,3,8,"ng-template",null,12,e.W1O),e.YNc(11,an,1,1,"ng-template",null,13,e.W1O),e.YNc(13,rn,1,1,"ng-template",null,14,e.W1O),e.qZA()),2&l){const s=e.MAs(6),c=e.MAs(8),g=e.MAs(10),_=e.MAs(12),U=e.MAs(14),D=e.oxw(2);e.xp6(4),e.Q6J("dataSource",D.tracing_events)("columns",e.DdM(7,ln))("display_column",e.DdM(8,cn))("column_size",e.DdM(9,un))("template",e.HTZ(10,dn,s,g,U,c,c,_))("pagination",!0)("page_size",30)}}function fn(l,o){if(1&l&&(e.ynx(0),e.YNc(1,pn,15,17,"div",5),e.ALo(2,"async"),e.BQk()),2&l){const s=e.oxw(),c=e.MAs(10);let g;e.xp6(1),e.Q6J("ngIf",null==(g=e.lcZ(2,2,s.options))?null:g.user)("ngIfElse",c)}}function mn(l,o){if(1&l&&(e.TgZ(0,"div",17),e._UZ(1,"map-spinner",18),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"async"),e.qZA()()),2&l){const s=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,1,s.loading))}}function gn(l,o){1&l&&(e.TgZ(0,"div",17)(1,"p",19),e._uU(2,"Select a user from the topbar to begin"),e.qZA()())}class Se{constructor(o){this._state=o,this.loading=this._state.loading,this.options=this._state.options,this.tracing_events=this._state.events,this.setOptions=s=>this._state.setOptions(s),this.downloadReport=()=>this._state.downloadReport(),this.formatDuration=s=>(0,Pe.Z)({hours:Math.floor(s/60),minutes:s%60})}}Se.\u0275fac=function(o){return new(o||Se)(e.Y36(pe))},Se.\u0275cmp=e.Xpm({type:Se,selectors:[["app-contact-tracing-report"]],decls:11,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["mat-icon-button","","matTooltip","Download Report",1,"bg-white","dark:bg-neutral-700","absolute","bottom-2","left-2","shadow",3,"click"],["load_state",""],["empty_state",""],["class","w-[64rem] max-w-[calc(100%-2rem)] rounded overflow-hidden bg-white dark:bg-neutral-700 shadow mx-auto my-2",4,"ngIf","ngIfElse"],[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","dark:bg-neutral-700","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","dark:border-neutral-500","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["empty","No contact records for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination","page_size"],["option_state",""],["user_state",""],["date_state",""],["duration_state",""],["distance_state",""],["class","text-xs px-2 py-1 rounded bg-gray-300 dark:bg-neutral-600",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-gray-300","dark:bg-neutral-600",3,"matTooltip"],[1,"p-8","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"],[1,"opacity-60"]],template:function(o,s){if(1&o&&(e._UZ(0,"contact-tracing-options"),e.TgZ(1,"div",0),e.YNc(2,fn,3,4,"ng-container",1),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return s.downloadReport()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()(),e.YNc(7,mn,5,3,"ng-template",null,3,e.W1O),e.YNc(9,gn,3,0,"ng-template",null,4,e.W1O)),2&o){const c=e.MAs(8);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,s.loading))("ngIfElse",c)}},dependencies:[Y.O5,le.eB,je.Kd,n.o,ue.C,Oe,Y.Ov,Y.uU,de],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}\n/*# sourceMappingURL=contact-tracing-report.component.ts-angular-inline--117.css.map*/"]});const hn=[{path:"",component:P,children:[{path:"",component:re},{path:"spaces",component:ve},{path:"desks",component:be},{path:"catering",component:Te},{path:"contact-tracing",component:Se},{path:"**",redirectTo:"desks",pathMatch:"full"}]}];class fe{}fe.\u0275fac=function(o){return new(o||fe)},fe.\u0275mod=e.oAB({type:fe}),fe.\u0275inj=e.cJS({imports:[Y.ez,X.u5,t.v,Z.YR,M.PP,O.gf,I.Bz.forChild(hn)]})},7103:function(Je,Le){var Y,X;X=this,Y=function(){return X.Chartist=function(){var X={version:"0.11.4"};return function(I,t){"use strict";var O=I.window,e=I.document;t.namespaces={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},t.noop=function(r){return r},t.alphaNumerate=function(r){return String.fromCharCode(97+r%26)},t.extend=function(r){var i,p,n;for(r=r||{},i=1;i<arguments.length;i++)for(var a in p=arguments[i])r[a]="object"!=typeof(n=p[a])||null===n||n instanceof Array?n:t.extend(r[a],n);return r},t.replaceAll=function(r,i,p){return r.replace(new RegExp(i,"g"),p)},t.ensureUnit=function(r,i){return"number"==typeof r&&(r+=i),r},t.quantity=function(r){if("string"==typeof r){var i=/^(\d+)\s*(.*)$/g.exec(r);return{value:+i[1],unit:i[2]||void 0}}return{value:r}},t.querySelector=function(r){return r instanceof Node?r:e.querySelector(r)},t.times=function(r){return Array.apply(null,new Array(r))},t.sum=function(r,i){return r+(i||0)},t.mapMultiply=function(r){return function(i){return i*r}},t.mapAdd=function(r){return function(i){return i+r}},t.serialMap=function(r,i){var p=[],n=Math.max.apply(null,r.map(function(a){return a.length}));return t.times(n).forEach(function(a,u){var m=r.map(function(f){return f[u]});p[u]=i.apply(null,m)}),p},t.roundWithPrecision=function(r,i){var p=Math.pow(10,i||t.precision);return Math.round(r*p)/p},t.precision=8,t.escapingMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t.serialize=function(r){return null==r?r:("number"==typeof r?r=""+r:"object"==typeof r&&(r=JSON.stringify({data:r})),Object.keys(t.escapingMap).reduce(function(i,p){return t.replaceAll(i,p,t.escapingMap[p])},r))},t.deserialize=function(r){if("string"!=typeof r)return r;r=Object.keys(t.escapingMap).reduce(function(i,p){return t.replaceAll(i,t.escapingMap[p],p)},r);try{r=void 0!==(r=JSON.parse(r)).data?r.data:r}catch{}return r},t.createSvg=function(r,i,p,n){var a;return i=i||"100%",p=p||"100%",Array.prototype.slice.call(r.querySelectorAll("svg")).filter(function(m){return m.getAttributeNS(t.namespaces.xmlns,"ct")}).forEach(function(m){r.removeChild(m)}),(a=new t.Svg("svg").attr({width:i,height:p}).addClass(n))._node.style.width=i,a._node.style.height=p,r.appendChild(a._node),a},t.normalizeData=function(r,i,p){var n,a={raw:r,normalized:{}};return a.normalized.series=t.getDataArray({series:r.series||[]},i,p),n=a.normalized.series.every(function(u){return u instanceof Array})?Math.max.apply(null,a.normalized.series.map(function(u){return u.length})):a.normalized.series.length,a.normalized.labels=(r.labels||[]).slice(),Array.prototype.push.apply(a.normalized.labels,t.times(Math.max(0,n-a.normalized.labels.length)).map(function(){return""})),i&&t.reverseData(a.normalized),a},t.safeHasProperty=function(r,i){return null!==r&&"object"==typeof r&&r.hasOwnProperty(i)},t.isDataHoleValue=function(r){return null==r||"number"==typeof r&&isNaN(r)},t.reverseData=function(r){r.labels.reverse(),r.series.reverse();for(var i=0;i<r.series.length;i++)"object"==typeof r.series[i]&&void 0!==r.series[i].data?r.series[i].data.reverse():r.series[i]instanceof Array&&r.series[i].reverse()},t.getDataArray=function(r,i,p){return r.series.map(function n(a){if(t.safeHasProperty(a,"value"))return n(a.value);if(t.safeHasProperty(a,"data"))return n(a.data);if(a instanceof Array)return a.map(n);if(!t.isDataHoleValue(a)){if(p){var u={};return"string"==typeof p?u[p]=t.getNumberOrUndefined(a):u.y=t.getNumberOrUndefined(a),u.x=a.hasOwnProperty("x")?t.getNumberOrUndefined(a.x):u.x,u.y=a.hasOwnProperty("y")?t.getNumberOrUndefined(a.y):u.y,u}return t.getNumberOrUndefined(a)}})},t.normalizePadding=function(r,i){return i=i||0,"number"==typeof r?{top:r,right:r,bottom:r,left:r}:{top:"number"==typeof r.top?r.top:i,right:"number"==typeof r.right?r.right:i,bottom:"number"==typeof r.bottom?r.bottom:i,left:"number"==typeof r.left?r.left:i}},t.getMetaData=function(r,i){var p=r.data?r.data[i]:r[i];return p?p.meta:void 0},t.orderOfMagnitude=function(r){return Math.floor(Math.log(Math.abs(r))/Math.LN10)},t.projectLength=function(r,i,p){return i/p.range*r},t.getAvailableHeight=function(r,i){return Math.max((t.quantity(i.height).value||r.height())-(i.chartPadding.top+i.chartPadding.bottom)-i.axisX.offset,0)},t.getHighLow=function(r,i,p){var n={high:void 0===(i=t.extend({},i,p?i["axis"+p.toUpperCase()]:{})).high?-Number.MAX_VALUE:+i.high,low:void 0===i.low?Number.MAX_VALUE:+i.low},a=void 0===i.high,u=void 0===i.low;return(a||u)&&function m(f){if(void 0!==f)if(f instanceof Array)for(var d=0;d<f.length;d++)m(f[d]);else{var h=p?+f[p]:+f;a&&h>n.high&&(n.high=h),u&&h<n.low&&(n.low=h)}}(r),(i.referenceValue||0===i.referenceValue)&&(n.high=Math.max(i.referenceValue,n.high),n.low=Math.min(i.referenceValue,n.low)),n.high<=n.low&&(0===n.low?n.high=1:n.low<0?n.high=0:(n.high>0||(n.high=1),n.low=0)),n},t.isNumeric=function(r){return null!==r&&isFinite(r)},t.isFalseyButZero=function(r){return!r&&0!==r},t.getNumberOrUndefined=function(r){return t.isNumeric(r)?+r:void 0},t.isMultiValue=function(r){return"object"==typeof r&&("x"in r||"y"in r)},t.getMultiValue=function(r,i){return t.isMultiValue(r)?t.getNumberOrUndefined(r[i||"y"]):t.getNumberOrUndefined(r)},t.rho=function(r){if(1===r)return r;function i(m,f){return m%f==0?f:i(f,m%f)}function p(m){return m*m+1}var u,n=2,a=2;if(r%2==0)return 2;do{n=p(n)%r,a=p(p(a))%r,u=i(Math.abs(n-a),r)}while(1===u);return u},t.getBounds=function(r,i,p,n){var a,m,f,u=0,d={high:i.high,low:i.low};d.valueRange=d.high-d.low,d.oom=t.orderOfMagnitude(d.valueRange),d.step=Math.pow(10,d.oom),d.min=Math.floor(d.low/d.step)*d.step,d.max=Math.ceil(d.high/d.step)*d.step,d.range=d.max-d.min,d.numberOfSteps=Math.round(d.range/d.step);var x=t.projectLength(r,d.step,d)<p,y=n?t.rho(d.range):0;if(n&&t.projectLength(r,1,d)>=p)d.step=1;else if(n&&y<d.step&&t.projectLength(r,y,d)>=p)d.step=y;else for(;;){if(x&&t.projectLength(r,d.step,d)<=p)d.step*=2;else{if(x||!(t.projectLength(r,d.step/2,d)>=p))break;if(d.step/=2,n&&d.step%1!=0){d.step*=2;break}}if(u++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}var b=2221e-19;function A(P,Z){return P===(P+=Z)&&(P*=1+(Z>0?b:-b)),P}for(d.step=Math.max(d.step,b),m=d.min,f=d.max;m+d.step<=d.low;)m=A(m,d.step);for(;f-d.step>=d.high;)f=A(f,-d.step);d.min=m,d.max=f,d.range=d.max-d.min;var k=[];for(a=d.min;a<=d.max;a=A(a,d.step)){var G=t.roundWithPrecision(a);G!==k[k.length-1]&&k.push(G)}return d.values=k,d},t.polarToCartesian=function(r,i,p,n){var a=(n-90)*Math.PI/180;return{x:r+p*Math.cos(a),y:i+p*Math.sin(a)}},t.createChartRect=function(r,i,p){var n=!(!i.axisX&&!i.axisY),a=n?i.axisY.offset:0,u=n?i.axisX.offset:0,m=r.width()||t.quantity(i.width).value||0,f=r.height()||t.quantity(i.height).value||0,d=t.normalizePadding(i.chartPadding,p);m=Math.max(m,a+d.left+d.right),f=Math.max(f,u+d.top+d.bottom);var h={padding:d,width:function(){return this.x2-this.x1},height:function(){return this.y1-this.y2}};return n?("start"===i.axisX.position?(h.y2=d.top+u,h.y1=Math.max(f-d.bottom,h.y2+1)):(h.y2=d.top,h.y1=Math.max(f-d.bottom-u,h.y2+1)),"start"===i.axisY.position?(h.x1=d.left+a,h.x2=Math.max(m-d.right,h.x1+1)):(h.x1=d.left,h.x2=Math.max(m-d.right-a,h.x1+1))):(h.x1=d.left,h.x2=Math.max(m-d.right,h.x1+1),h.y2=d.top,h.y1=Math.max(f-d.bottom,h.y2+1)),h},t.createGrid=function(r,i,p,n,a,u,m,f){var d={};d[p.units.pos+"1"]=r,d[p.units.pos+"2"]=r,d[p.counterUnits.pos+"1"]=n,d[p.counterUnits.pos+"2"]=n+a;var h=u.elem("line",d,m.join(" "));f.emit("draw",t.extend({type:"grid",axis:p,index:i,group:u,element:h},d))},t.createGridBackground=function(r,i,p,n){var a=r.elem("rect",{x:i.x1,y:i.y2,width:i.width(),height:i.height()},p,!0);n.emit("draw",{type:"gridBackground",group:r,element:a})},t.createLabel=function(r,i,p,n,a,u,m,f,d,h,x){var y,b={};if(b[a.units.pos]=r+m[a.units.pos],b[a.counterUnits.pos]=m[a.counterUnits.pos],b[a.units.len]=i,b[a.counterUnits.len]=Math.max(0,u-10),h){var A=e.createElement("span");A.className=d.join(" "),A.setAttribute("xmlns",t.namespaces.xhtml),A.innerText=n[p],A.style[a.units.len]=Math.round(b[a.units.len])+"px",A.style[a.counterUnits.len]=Math.round(b[a.counterUnits.len])+"px",y=f.foreignObject(A,t.extend({style:"overflow: visible;"},b))}else y=f.elem("text",b,d.join(" ")).text(n[p]);x.emit("draw",t.extend({type:"label",axis:a,index:p,group:f,element:y,text:n[p]},b))},t.getSeriesOption=function(r,i,p){if(r.name&&i.series&&i.series[r.name]){var n=i.series[r.name];return n.hasOwnProperty(p)?n[p]:i[p]}return i[p]},t.optionsProvider=function(r,i,p){var a,m,n=t.extend({},r),u=[];function f(x){var y=a;if(a=t.extend({},n),i)for(m=0;m<i.length;m++)O.matchMedia(i[m][0]).matches&&(a=t.extend(a,i[m][1]));p&&x&&p.emit("optionsChanged",{previousOptions:y,currentOptions:a})}if(!O.matchMedia)throw"window.matchMedia not found! Make sure you're using a polyfill.";if(i)for(m=0;m<i.length;m++){var h=O.matchMedia(i[m][0]);h.addListener(f),u.push(h)}return f(),{removeMediaQueryListeners:function d(){u.forEach(function(x){x.removeListener(f)})},getCurrentOptions:function(){return t.extend({},a)}}},t.splitIntoSegments=function(r,i,p){p=t.extend({},{increasingX:!1,fillHoles:!1},p);for(var a=[],u=!0,m=0;m<r.length;m+=2)void 0===t.getMultiValue(i[m/2].value)?p.fillHoles||(u=!0):(p.increasingX&&m>=2&&r[m]<=r[m-2]&&(u=!0),u&&(a.push({pathCoordinates:[],valueData:[]}),u=!1),a[a.length-1].pathCoordinates.push(r[m],r[m+1]),a[a.length-1].valueData.push(i[m/2]));return a}}(this||global,X),function(I,t){"use strict";t.Interpolation={},t.Interpolation.none=function(O){return O=t.extend({},{fillHoles:!1},O),function(i,p){for(var n=new t.Svg.Path,a=!0,u=0;u<i.length;u+=2){var m=i[u],f=i[u+1],d=p[u/2];void 0!==t.getMultiValue(d.value)?(a?n.move(m,f,!1,d):n.line(m,f,!1,d),a=!1):O.fillHoles||(a=!0)}return n}},t.Interpolation.simple=function(O){O=t.extend({},{divisor:2,fillHoles:!1},O);var r=1/Math.max(1,O.divisor);return function(p,n){for(var u,m,f,a=new t.Svg.Path,d=0;d<p.length;d+=2){var h=p[d],x=p[d+1],y=(h-u)*r,b=n[d/2];void 0!==b.value?(void 0===f?a.move(h,x,!1,b):a.curve(u+y,m,h-y,x,h,x,!1,b),u=h,m=x,f=b):O.fillHoles||(u=h=f=void 0)}return a}},t.Interpolation.cardinal=function(O){O=t.extend({},{tension:1,fillHoles:!1},O);var r=Math.min(1,Math.max(0,O.tension)),i=1-r;return function p(n,a){var u=t.splitIntoSegments(n,a,{fillHoles:O.fillHoles});if(u.length){if(u.length>1){var m=[];return u.forEach(function(b){m.push(p(b.pathCoordinates,b.valueData))}),t.Svg.Path.join(m)}if(a=u[0].valueData,(n=u[0].pathCoordinates).length<=4)return t.Interpolation.none()(n,a);for(var f=(new t.Svg.Path).move(n[0],n[1],!1,a[0]),h=0,x=n.length;x-2>h;h+=2){var y=[{x:+n[h-2],y:+n[h-1]},{x:+n[h],y:+n[h+1]},{x:+n[h+2],y:+n[h+3]},{x:+n[h+4],y:+n[h+5]}];x-4===h?y[3]=y[2]:h||(y[0]={x:+n[h],y:+n[h+1]}),f.curve(r*(6*y[1].x-y[0].x+y[2].x)/6+i*y[2].x,r*(6*y[1].y-y[0].y+y[2].y)/6+i*y[2].y,r*(y[1].x+6*y[2].x-y[3].x)/6+i*y[2].x,r*(y[1].y+6*y[2].y-y[3].y)/6+i*y[2].y,y[2].x,y[2].y,!1,a[(h+2)/2])}return f}return t.Interpolation.none()([])}},t.Interpolation.monotoneCubic=function(O){return O=t.extend({},{fillHoles:!1},O),function r(i,p){var n=t.splitIntoSegments(i,p,{fillHoles:O.fillHoles,increasingX:!0});if(n.length){if(n.length>1){var a=[];return n.forEach(function(k){a.push(r(k.pathCoordinates,k.valueData))}),t.Svg.Path.join(a)}if(p=n[0].valueData,(i=n[0].pathCoordinates).length<=4)return t.Interpolation.none()(i,p);var f,A,u=[],m=[],d=i.length/2,h=[],x=[],y=[],b=[];for(f=0;f<d;f++)u[f]=i[2*f],m[f]=i[2*f+1];for(f=0;f<d-1;f++)y[f]=m[f+1]-m[f],b[f]=u[f+1]-u[f],x[f]=y[f]/b[f];for(h[0]=x[0],h[d-1]=x[d-2],f=1;f<d-1;f++)0===x[f]||0===x[f-1]||x[f-1]>0!=x[f]>0?h[f]=0:(h[f]=3*(b[f-1]+b[f])/((2*b[f]+b[f-1])/x[f-1]+(b[f]+2*b[f-1])/x[f]),isFinite(h[f])||(h[f]=0));for(A=(new t.Svg.Path).move(u[0],m[0],!1,p[0]),f=0;f<d-1;f++)A.curve(u[f]+b[f]/3,m[f]+h[f]*b[f]/3,u[f+1]-b[f]/3,m[f+1]-h[f+1]*b[f]/3,u[f+1],m[f+1],!1,p[f+1]);return A}return t.Interpolation.none()([])}},t.Interpolation.step=function(O){return O=t.extend({},{postpone:!0,fillHoles:!1},O),function(i,p){for(var a,u,m,n=new t.Svg.Path,f=0;f<i.length;f+=2){var d=i[f],h=i[f+1],x=p[f/2];void 0!==x.value?(void 0===m?n.move(d,h,!1,x):(O.postpone?n.line(d,u,!1,m):n.line(a,h,!1,x),n.line(d,h,!1,x)),a=d,u=h,m=x):O.fillHoles||(a=u=m=void 0)}return n}}}(this||global,X),function(I,t){"use strict";t.EventEmitter=function(){var O=[];return{addEventHandler:function e(p,n){O[p]=O[p]||[],O[p].push(n)},removeEventHandler:function r(p,n){O[p]&&(n?(O[p].splice(O[p].indexOf(n),1),0===O[p].length&&delete O[p]):delete O[p])},emit:function i(p,n){O[p]&&O[p].forEach(function(a){a(n)}),O["*"]&&O["*"].forEach(function(a){a(p,n)})}}}}(this||global,X),function(I,t){"use strict";function O(i){var p=[];if(i.length)for(var n=0;n<i.length;n++)p.push(i[n]);return p}t.Class={extend:function e(i,p){var n=p||this.prototype||t.Class,a=Object.create(n);t.Class.cloneDefinitions(a,i);var u=function(){var f,m=a.constructor||function(){};return f=this===t?Object.create(a):this,m.apply(f,Array.prototype.slice.call(arguments,0)),f};return u.prototype=a,u.super=n,u.extend=this.extend,u},cloneDefinitions:function r(){var i=O(arguments),p=i[0];return i.splice(1,i.length-1).forEach(function(n){Object.getOwnPropertyNames(n).forEach(function(a){delete p[a],Object.defineProperty(p,a,Object.getOwnPropertyDescriptor(n,a))})}),p}}}(this||global,X),function(I,t){"use strict";var O=I.window;function n(){O.addEventListener("resize",this.resizeListener),this.optionsProvider=t.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.addEventHandler("optionsChanged",function(){this.update()}.bind(this)),this.options.plugins&&this.options.plugins.forEach(function(u){u instanceof Array?u[0](this,u[1]):u(this)}.bind(this)),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=void 0}t.Base=t.Class.extend({constructor:function a(u,m,f,d,h){this.container=t.querySelector(u),this.data=m||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.defaultOptions=f,this.options=d,this.responsiveOptions=h,this.eventEmitter=t.EventEmitter(),this.supportsForeignObject=t.Svg.isSupported("Extensibility"),this.supportsAnimations=t.Svg.isSupported("AnimationEventsAttribute"),this.resizeListener=function(){this.update()}.bind(this),this.container&&(this.container.__chartist__&&this.container.__chartist__.detach(),this.container.__chartist__=this),this.initializeTimeoutId=setTimeout(n.bind(this),0)},optionsProvider:void 0,container:void 0,svg:void 0,eventEmitter:void 0,createChart:function(){throw new Error("Base chart type can't be instantiated!")},update:function e(u,m,f){return u&&(this.data=u||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.eventEmitter.emit("data",{type:"update",data:this.data})),m&&(this.options=t.extend({},f?this.options:this.defaultOptions,m),this.initializeTimeoutId||(this.optionsProvider.removeMediaQueryListeners(),this.optionsProvider=t.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter))),this.initializeTimeoutId||this.createChart(this.optionsProvider.getCurrentOptions()),this},detach:function r(){return this.initializeTimeoutId?O.clearTimeout(this.initializeTimeoutId):(O.removeEventListener("resize",this.resizeListener),this.optionsProvider.removeMediaQueryListeners()),this},on:function i(u,m){return this.eventEmitter.addEventHandler(u,m),this},off:function p(u,m){return this.eventEmitter.removeEventHandler(u,m),this},version:t.version,supportsForeignObject:!1})}(this||global,X),function(I,t){"use strict";var O=I.document;t.Svg=t.Class.extend({constructor:function e(v,w,L,R,q){v instanceof Element?this._node=v:(this._node=O.createElementNS(t.namespaces.svg,v),"svg"===v&&this.attr({"xmlns:ct":t.namespaces.ct})),w&&this.attr(w),L&&this.addClass(L),R&&(q&&R._node.firstChild?R._node.insertBefore(this._node,R._node.firstChild):R._node.appendChild(this._node))},attr:function r(v,w){return"string"==typeof v?w?this._node.getAttributeNS(w,v):this._node.getAttribute(v):(Object.keys(v).forEach(function(L){if(void 0!==v[L])if(-1!==L.indexOf(":")){var R=L.split(":");this._node.setAttributeNS(t.namespaces[R[0]],L,v[L])}else this._node.setAttribute(L,v[L])}.bind(this)),this)},elem:function i(v,w,L,R){return new t.Svg(v,w,L,this,R)},parent:function p(){return this._node.parentNode instanceof SVGElement?new t.Svg(this._node.parentNode):null},root:function n(){for(var v=this._node;"svg"!==v.nodeName;)v=v.parentNode;return new t.Svg(v)},querySelector:function a(v){var w=this._node.querySelector(v);return w?new t.Svg(w):null},querySelectorAll:function u(v){var w=this._node.querySelectorAll(v);return w.length?new t.Svg.List(w):null},getNode:function m(){return this._node},foreignObject:function f(v,w,L,R){if("string"==typeof v){var q=O.createElement("div");q.innerHTML=v,v=q.firstChild}v.setAttribute("xmlns",t.namespaces.xmlns);var H=this.elem("foreignObject",w,L,R);return H._node.appendChild(v),H},text:function d(v){return this._node.appendChild(O.createTextNode(v)),this},empty:function h(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this},remove:function x(){return this._node.parentNode.removeChild(this._node),this.parent()},replace:function y(v){return this._node.parentNode.replaceChild(v._node,this._node),v},append:function b(v,w){return w&&this._node.firstChild?this._node.insertBefore(v._node,this._node.firstChild):this._node.appendChild(v._node),this},classes:function A(){return this._node.getAttribute("class")?this._node.getAttribute("class").trim().split(/\s+/):[]},addClass:function k(v){return this._node.setAttribute("class",this.classes(this._node).concat(v.trim().split(/\s+/)).filter(function(w,L,R){return R.indexOf(w)===L}).join(" ")),this},removeClass:function G(v){var w=v.trim().split(/\s+/);return this._node.setAttribute("class",this.classes(this._node).filter(function(L){return-1===w.indexOf(L)}).join(" ")),this},removeAllClasses:function P(){return this._node.setAttribute("class",""),this},height:function Z(){return this._node.getBoundingClientRect().height},width:function M(){return this._node.getBoundingClientRect().width},animate:function T(v,w,L){return void 0===w&&(w=!0),Object.keys(v).forEach(function(q){function H(B,Q){var V,Re,ee,$={};B.easing&&(ee=B.easing instanceof Array?B.easing:t.Svg.Easing[B.easing],delete B.easing),B.begin=t.ensureUnit(B.begin,"ms"),B.dur=t.ensureUnit(B.dur,"ms"),ee&&(B.calcMode="spline",B.keySplines=ee.join(" "),B.keyTimes="0;1"),Q&&(B.fill="freeze",$[q]=B.from,this.attr($),Re=t.quantity(B.begin||0).value,B.begin="indefinite"),V=this.elem("animate",t.extend({attributeName:q},B)),Q&&setTimeout(function(){try{V._node.beginElement()}catch{$[q]=B.to,this.attr($),V.remove()}}.bind(this),Re),L&&V._node.addEventListener("beginEvent",function(){L.emit("animationBegin",{element:this,animate:V._node,params:B})}.bind(this)),V._node.addEventListener("endEvent",function(){L&&L.emit("animationEnd",{element:this,animate:V._node,params:B}),Q&&($[q]=B.to,this.attr($),V.remove())}.bind(this))}v[q]instanceof Array?v[q].forEach(function(B){H.bind(this)(B,!1)}.bind(this)):H.bind(this)(v[q],w)}.bind(this)),this}}),t.Svg.isSupported=function(v){return O.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#"+v,"1.1")},t.Svg.Easing={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]},t.Svg.List=t.Class.extend({constructor:function E(v){var w=this;this.svgElements=[];for(var L=0;L<v.length;L++)this.svgElements.push(new t.Svg(v[L]));Object.keys(t.Svg.prototype).filter(function(R){return-1===["constructor","parent","querySelector","querySelectorAll","replace","append","classes","height","width"].indexOf(R)}).forEach(function(R){w[R]=function(){var q=Array.prototype.slice.call(arguments,0);return w.svgElements.forEach(function(H){t.Svg.prototype[R].apply(H,q)}),w}})}})}(this||global,X),function(I,t){"use strict";var O={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},e={accuracy:3};function r(Z,M,T,z,E,v){var w=t.extend({command:E?Z.toLowerCase():Z.toUpperCase()},M,v?{data:v}:{});T.splice(z,0,w)}function i(Z,M){Z.forEach(function(T,z){O[T.command.toLowerCase()].forEach(function(E,v){M(T,E,z,v,Z)})})}t.Svg.Path=t.Class.extend({constructor:function p(Z,M){this.pathElements=[],this.pos=0,this.close=Z,this.options=t.extend({},e,M)},position:function n(Z){return void 0!==Z?(this.pos=Math.max(0,Math.min(this.pathElements.length,Z)),this):this.pos},remove:function a(Z){return this.pathElements.splice(this.pos,Z),this},move:function u(Z,M,T,z){return r("M",{x:+Z,y:+M},this.pathElements,this.pos++,T,z),this},line:function m(Z,M,T,z){return r("L",{x:+Z,y:+M},this.pathElements,this.pos++,T,z),this},curve:function f(Z,M,T,z,E,v,w,L){return r("C",{x1:+Z,y1:+M,x2:+T,y2:+z,x:+E,y:+v},this.pathElements,this.pos++,w,L),this},arc:function d(Z,M,T,z,E,v,w,L,R){return r("A",{rx:+Z,ry:+M,xAr:+T,lAf:+z,sf:+E,x:+v,y:+w},this.pathElements,this.pos++,L,R),this},scale:function y(Z,M){return i(this.pathElements,function(T,z){T[z]*="x"===z[0]?Z:M}),this},translate:function b(Z,M){return i(this.pathElements,function(T,z){T[z]+="x"===z[0]?Z:M}),this},transform:function A(Z){return i(this.pathElements,function(M,T,z,E,v){var w=Z(M,T,z,E,v);(w||0===w)&&(M[T]=w)}),this},parse:function h(Z){var M=Z.replace(/([A-Za-z])([0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce(function(E,v){return v.match(/[A-Za-z]/)&&E.push([]),E[E.length-1].push(v),E},[]);"Z"===M[M.length-1][0].toUpperCase()&&M.pop();var T=M.map(function(E){var v=E.shift(),w=O[v.toLowerCase()];return t.extend({command:v},w.reduce(function(L,R,q){return L[R]=+E[q],L},{}))}),z=[this.pos,0];return Array.prototype.push.apply(z,T),Array.prototype.splice.apply(this.pathElements,z),this.pos+=T.length,this},stringify:function x(){var Z=Math.pow(10,this.options.accuracy);return this.pathElements.reduce(function(M,T){var z=O[T.command.toLowerCase()].map(function(E){return this.options.accuracy?Math.round(T[E]*Z)/Z:T[E]}.bind(this));return M+T.command+z.join(",")}.bind(this),"")+(this.close?"Z":"")},clone:function k(Z){var M=new t.Svg.Path(Z||this.close);return M.pos=this.pos,M.pathElements=this.pathElements.slice().map(function(z){return t.extend({},z)}),M.options=t.extend({},this.options),M},splitByCommand:function G(Z){var M=[new t.Svg.Path];return this.pathElements.forEach(function(T){T.command===Z.toUpperCase()&&0!==M[M.length-1].pathElements.length&&M.push(new t.Svg.Path),M[M.length-1].pathElements.push(T)}),M}}),t.Svg.Path.elementDescriptions=O,t.Svg.Path.join=function P(Z,M,T){for(var z=new t.Svg.Path(M,T),E=0;E<Z.length;E++)for(var v=Z[E],w=0;w<v.pathElements.length;w++)z.pathElements.push(v.pathElements[w]);return z}}(this||global,X),function(I,t){"use strict";var r={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};t.Axis=t.Class.extend({constructor:function i(n,a,u,m){this.units=n,this.counterUnits=n===r.x?r.y:r.x,this.chartRect=a,this.axisLength=a[n.rectEnd]-a[n.rectStart],this.gridOffset=a[n.rectOffset],this.ticks=u,this.options=m},createGridAndLabels:function p(n,a,u,m,f){var d=m["axis"+this.units.pos.toUpperCase()],h=this.ticks.map(this.projectValue.bind(this)),x=this.ticks.map(d.labelInterpolationFnc);h.forEach(function(y,b){var k,A={x:0,y:0};k=h[b+1]?h[b+1]-y:Math.max(this.axisLength-y,30),(!t.isFalseyButZero(x[b])||""===x[b])&&("x"===this.units.pos?(y=this.chartRect.x1+y,A.x=m.axisX.labelOffset.x,A.y="start"===m.axisX.position?this.chartRect.padding.top+m.axisX.labelOffset.y+(u?5:20):this.chartRect.y1+m.axisX.labelOffset.y+(u?5:20)):(y=this.chartRect.y1-y,A.y=m.axisY.labelOffset.y-(u?k:0),A.x="start"===m.axisY.position?u?this.chartRect.padding.left+m.axisY.labelOffset.x:this.chartRect.x1-10:this.chartRect.x2+m.axisY.labelOffset.x+10),d.showGrid&&t.createGrid(y,b,this,this.gridOffset,this.chartRect[this.counterUnits.len](),n,[m.classNames.grid,m.classNames[this.units.dir]],f),d.showLabel&&t.createLabel(y,k,b,x,this,d.offset,A,a,[m.classNames.label,m.classNames[this.units.dir],"start"===d.position?m.classNames[d.position]:m.classNames.end],u,f))}.bind(this))},projectValue:function(n,a,u){throw new Error("Base axis can't be instantiated!")}}),t.Axis.units=r}(this||global,X),function(I,t){"use strict";t.AutoScaleAxis=t.Axis.extend({constructor:function r(p,n,a,u){var m=u.highLow||t.getHighLow(n,u,p.pos);this.bounds=t.getBounds(a[p.rectEnd]-a[p.rectStart],m,u.scaleMinSpace||20,u.onlyInteger),this.range={min:this.bounds.min,max:this.bounds.max},t.AutoScaleAxis.super.constructor.call(this,p,a,this.bounds.values,u)},projectValue:function i(p){return this.axisLength*(+t.getMultiValue(p,this.units.pos)-this.bounds.min)/this.bounds.range}})}(this||global,X),function(I,t){"use strict";t.FixedScaleAxis=t.Axis.extend({constructor:function r(p,n,a,u){var m=u.highLow||t.getHighLow(n,u,p.pos);this.divisor=u.divisor||1,this.ticks=u.ticks||t.times(this.divisor).map(function(f,d){return m.low+(m.high-m.low)/this.divisor*d}.bind(this)),this.ticks.sort(function(f,d){return f-d}),this.range={min:m.low,max:m.high},t.FixedScaleAxis.super.constructor.call(this,p,a,this.ticks,u),this.stepLength=this.axisLength/this.divisor},projectValue:function i(p){return this.axisLength*(+t.getMultiValue(p,this.units.pos)-this.range.min)/(this.range.max-this.range.min)}})}(this||global,X),function(I,t){"use strict";t.StepAxis=t.Axis.extend({constructor:function r(p,n,a,u){t.StepAxis.super.constructor.call(this,p,a,u.ticks,u);var m=Math.max(1,u.ticks.length-(u.stretch?1:0));this.stepLength=this.axisLength/m},projectValue:function i(p,n){return this.stepLength*n}})}(this||global,X),function(I,t){"use strict";var r={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,showGridBackground:!1,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};t.Line=t.Base.extend({constructor:function p(n,a,u,m){t.Line.super.constructor.call(this,n,a,r,t.extend({},r,u),m)},createChart:function i(n){var a=t.normalizeData(this.data,n.reverseData,!0);this.svg=t.createSvg(this.container,n.width,n.height,n.classNames.chart);var h,x,u=this.svg.elem("g").addClass(n.classNames.gridGroup),m=this.svg.elem("g"),f=this.svg.elem("g").addClass(n.classNames.labelGroup),d=t.createChartRect(this.svg,n,r.padding);h=void 0===n.axisX.type?new t.StepAxis(t.Axis.units.x,a.normalized.series,d,t.extend({},n.axisX,{ticks:a.normalized.labels,stretch:n.fullWidth})):n.axisX.type.call(t,t.Axis.units.x,a.normalized.series,d,n.axisX),x=void 0===n.axisY.type?new t.AutoScaleAxis(t.Axis.units.y,a.normalized.series,d,t.extend({},n.axisY,{high:t.isNumeric(n.high)?n.high:n.axisY.high,low:t.isNumeric(n.low)?n.low:n.axisY.low})):n.axisY.type.call(t,t.Axis.units.y,a.normalized.series,d,n.axisY),h.createGridAndLabels(u,f,this.supportsForeignObject,n,this.eventEmitter),x.createGridAndLabels(u,f,this.supportsForeignObject,n,this.eventEmitter),n.showGridBackground&&t.createGridBackground(u,d,n.classNames.gridBackground,this.eventEmitter),a.raw.series.forEach(function(y,b){var A=m.elem("g");A.attr({"ct:series-name":y.name,"ct:meta":t.serialize(y.meta)}),A.addClass([n.classNames.series,y.className||n.classNames.series+"-"+t.alphaNumerate(b)].join(" "));var k=[],G=[];a.normalized.series[b].forEach(function(v,w){var L={x:d.x1+h.projectValue(v,w,a.normalized.series[b]),y:d.y1-x.projectValue(v,w,a.normalized.series[b])};k.push(L.x,L.y),G.push({value:v,valueIndex:w,meta:t.getMetaData(y,w)})}.bind(this));var P={lineSmooth:t.getSeriesOption(y,n,"lineSmooth"),showPoint:t.getSeriesOption(y,n,"showPoint"),showLine:t.getSeriesOption(y,n,"showLine"),showArea:t.getSeriesOption(y,n,"showArea"),areaBase:t.getSeriesOption(y,n,"areaBase")},M=("function"==typeof P.lineSmooth?P.lineSmooth:P.lineSmooth?t.Interpolation.monotoneCubic():t.Interpolation.none())(k,G);if(P.showPoint&&M.pathElements.forEach(function(v){var w=A.elem("line",{x1:v.x,y1:v.y,x2:v.x+.01,y2:v.y},n.classNames.point).attr({"ct:value":[v.data.value.x,v.data.value.y].filter(t.isNumeric).join(","),"ct:meta":t.serialize(v.data.meta)});this.eventEmitter.emit("draw",{type:"point",value:v.data.value,index:v.data.valueIndex,meta:v.data.meta,series:y,seriesIndex:b,axisX:h,axisY:x,group:A,element:w,x:v.x,y:v.y})}.bind(this)),P.showLine){var T=A.elem("path",{d:M.stringify()},n.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:a.normalized.series[b],path:M.clone(),chartRect:d,index:b,series:y,seriesIndex:b,seriesMeta:y.meta,axisX:h,axisY:x,group:A,element:T})}if(P.showArea&&x.range){var z=Math.max(Math.min(P.areaBase,x.range.max),x.range.min),E=d.y1-x.projectValue(z);M.splitByCommand("M").filter(function(w){return w.pathElements.length>1}).map(function(w){var L=w.pathElements[0],R=w.pathElements[w.pathElements.length-1];return w.clone(!0).position(0).remove(1).move(L.x,E).line(L.x,L.y).position(w.pathElements.length+1).line(R.x,E)}).forEach(function(w){var L=A.elem("path",{d:w.stringify()},n.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:a.normalized.series[b],path:w.clone(),series:y,seriesIndex:b,axisX:h,axisY:x,chartRect:d,index:b,group:A,element:L})}.bind(this))}}.bind(this)),this.eventEmitter.emit("created",{bounds:x.bounds,chartRect:d,axisX:h,axisY:x,svg:this.svg,options:n})}})}(this||global,X),function(I,t){"use strict";var r={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,scaleMinSpace:30,onlyInteger:!1},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,high:void 0,low:void 0,referenceValue:0,chartPadding:{top:15,right:15,bottom:5,left:10},seriesBarDistance:15,stackBars:!1,stackMode:"accumulate",horizontalBars:!1,distributeSeries:!1,reverseData:!1,showGridBackground:!1,classNames:{chart:"ct-chart-bar",horizontalBars:"ct-horizontal-bars",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",bar:"ct-bar",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};t.Bar=t.Base.extend({constructor:function p(n,a,u,m){t.Bar.super.constructor.call(this,n,a,r,t.extend({},r,u),m)},createChart:function i(n){var a,u;n.distributeSeries?(a=t.normalizeData(this.data,n.reverseData,n.horizontalBars?"x":"y")).normalized.series=a.normalized.series.map(function(M){return[M]}):a=t.normalizeData(this.data,n.reverseData,n.horizontalBars?"x":"y"),this.svg=t.createSvg(this.container,n.width,n.height,n.classNames.chart+(n.horizontalBars?" "+n.classNames.horizontalBars:""));var m=this.svg.elem("g").addClass(n.classNames.gridGroup),f=this.svg.elem("g"),d=this.svg.elem("g").addClass(n.classNames.labelGroup);if(n.stackBars&&0!==a.normalized.series.length){var h=t.serialMap(a.normalized.series,function(){return Array.prototype.slice.call(arguments).map(function(T){return T}).reduce(function(T,z){return{x:T.x+(z&&z.x)||0,y:T.y+(z&&z.y)||0}},{x:0,y:0})});u=t.getHighLow([h],n,n.horizontalBars?"x":"y")}else u=t.getHighLow(a.normalized.series,n,n.horizontalBars?"x":"y");u.high=+n.high||(0===n.high?0:u.high),u.low=+n.low||(0===n.low?0:u.low);var y,b,A,k,G,x=t.createChartRect(this.svg,n,r.padding);b=n.distributeSeries&&n.stackBars?a.normalized.labels.slice(0,1):a.normalized.labels,n.horizontalBars?(y=k=void 0===n.axisX.type?new t.AutoScaleAxis(t.Axis.units.x,a.normalized.series,x,t.extend({},n.axisX,{highLow:u,referenceValue:0})):n.axisX.type.call(t,t.Axis.units.x,a.normalized.series,x,t.extend({},n.axisX,{highLow:u,referenceValue:0})),A=G=void 0===n.axisY.type?new t.StepAxis(t.Axis.units.y,a.normalized.series,x,{ticks:b}):n.axisY.type.call(t,t.Axis.units.y,a.normalized.series,x,n.axisY)):(A=k=void 0===n.axisX.type?new t.StepAxis(t.Axis.units.x,a.normalized.series,x,{ticks:b}):n.axisX.type.call(t,t.Axis.units.x,a.normalized.series,x,n.axisX),y=G=void 0===n.axisY.type?new t.AutoScaleAxis(t.Axis.units.y,a.normalized.series,x,t.extend({},n.axisY,{highLow:u,referenceValue:0})):n.axisY.type.call(t,t.Axis.units.y,a.normalized.series,x,t.extend({},n.axisY,{highLow:u,referenceValue:0})));var P=n.horizontalBars?x.x1+y.projectValue(0):x.y1-y.projectValue(0),Z=[];A.createGridAndLabels(m,d,this.supportsForeignObject,n,this.eventEmitter),y.createGridAndLabels(m,d,this.supportsForeignObject,n,this.eventEmitter),n.showGridBackground&&t.createGridBackground(m,x,n.classNames.gridBackground,this.eventEmitter),a.raw.series.forEach(function(M,T){var E,v,z=T-(a.raw.series.length-1)/2;E=n.distributeSeries&&!n.stackBars?A.axisLength/a.normalized.series.length/2:n.distributeSeries&&n.stackBars?A.axisLength/2:A.axisLength/a.normalized.series[T].length/2,(v=f.elem("g")).attr({"ct:series-name":M.name,"ct:meta":t.serialize(M.meta)}),v.addClass([n.classNames.series,M.className||n.classNames.series+"-"+t.alphaNumerate(T)].join(" ")),a.normalized.series[T].forEach(function(w,L){var R,q,H,B;if(B=n.distributeSeries&&!n.stackBars?T:n.distributeSeries&&n.stackBars?0:L,R=n.horizontalBars?{x:x.x1+y.projectValue(w&&w.x?w.x:0,L,a.normalized.series[T]),y:x.y1-A.projectValue(w&&w.y?w.y:0,B,a.normalized.series[T])}:{x:x.x1+A.projectValue(w&&w.x?w.x:0,B,a.normalized.series[T]),y:x.y1-y.projectValue(w&&w.y?w.y:0,L,a.normalized.series[T])},A instanceof t.StepAxis&&(A.options.stretch||(R[A.units.pos]+=E*(n.horizontalBars?-1:1)),R[A.units.pos]+=n.stackBars||n.distributeSeries?0:z*n.seriesBarDistance*(n.horizontalBars?-1:1)),Z[L]=(H=Z[L]||P)-(P-R[A.counterUnits.pos]),void 0!==w){var Q={};Q[A.units.pos+"1"]=R[A.units.pos],Q[A.units.pos+"2"]=R[A.units.pos],!n.stackBars||"accumulate"!==n.stackMode&&n.stackMode?(Q[A.counterUnits.pos+"1"]=P,Q[A.counterUnits.pos+"2"]=R[A.counterUnits.pos]):(Q[A.counterUnits.pos+"1"]=H,Q[A.counterUnits.pos+"2"]=Z[L]),Q.x1=Math.min(Math.max(Q.x1,x.x1),x.x2),Q.x2=Math.min(Math.max(Q.x2,x.x1),x.x2),Q.y1=Math.min(Math.max(Q.y1,x.y2),x.y1),Q.y2=Math.min(Math.max(Q.y2,x.y2),x.y1);var $=t.getMetaData(M,L);q=v.elem("line",Q,n.classNames.bar).attr({"ct:value":[w.x,w.y].filter(t.isNumeric).join(","),"ct:meta":t.serialize($)}),this.eventEmitter.emit("draw",t.extend({type:"bar",value:w,index:L,meta:$,series:M,seriesIndex:T,axisX:k,axisY:G,chartRect:x,group:v,element:q},Q))}}.bind(this))}.bind(this)),this.eventEmitter.emit("created",{bounds:y.bounds,chartRect:x,axisX:k,axisY:G,svg:this.svg,options:n})}})}(this||global,X),function(I,t){"use strict";var r={width:void 0,height:void 0,chartPadding:5,classNames:{chartPie:"ct-chart-pie",chartDonut:"ct-chart-donut",series:"ct-series",slicePie:"ct-slice-pie",sliceDonut:"ct-slice-donut",sliceDonutSolid:"ct-slice-donut-solid",label:"ct-label"},startAngle:0,total:void 0,donut:!1,donutSolid:!1,donutWidth:60,showLabel:!0,labelOffset:0,labelPosition:"inside",labelInterpolationFnc:t.noop,labelDirection:"neutral",reverseData:!1,ignoreEmptyValues:!1};function i(a,u,m){var f=u.x>a.x;return f&&"explode"===m||!f&&"implode"===m?"start":f&&"implode"===m||!f&&"explode"===m?"end":"middle"}t.Pie=t.Base.extend({constructor:function n(a,u,m,f){t.Pie.super.constructor.call(this,a,u,r,t.extend({},r,m),f)},createChart:function p(a){var f,d,h,x,y,u=t.normalizeData(this.data),m=[],b=a.startAngle;this.svg=t.createSvg(this.container,a.width,a.height,a.donut?a.classNames.chartDonut:a.classNames.chartPie),d=t.createChartRect(this.svg,a,r.padding),h=Math.min(d.width()/2,d.height()/2),y=a.total||u.normalized.series.reduce(function(P,Z){return P+Z},0);var A=t.quantity(a.donutWidth);"%"===A.unit&&(A.value*=h/100),h-=a.donut&&!a.donutSolid?A.value/2:0,x="outside"===a.labelPosition||a.donut&&!a.donutSolid?h:"center"===a.labelPosition?0:a.donutSolid?h-A.value/2:h/2,x+=a.labelOffset;var k={x:d.x1+d.width()/2,y:d.y2+d.height()/2},G=1===u.raw.series.filter(function(P){return P.hasOwnProperty("value")?0!==P.value:0!==P}).length;u.raw.series.forEach(function(P,Z){m[Z]=this.svg.elem("g",null,null)}.bind(this)),a.showLabel&&(f=this.svg.elem("g",null,null)),u.raw.series.forEach(function(P,Z){if(0!==u.normalized.series[Z]||!a.ignoreEmptyValues){m[Z].attr({"ct:series-name":P.name}),m[Z].addClass([a.classNames.series,P.className||a.classNames.series+"-"+t.alphaNumerate(Z)].join(" "));var M=y>0?b+u.normalized.series[Z]/y*360:0,T=Math.max(0,b-(0===Z||G?0:.2));M-T>=359.99&&(M=T+359.99);var v,w,L,z=t.polarToCartesian(k.x,k.y,h,T),E=t.polarToCartesian(k.x,k.y,h,M),R=new t.Svg.Path(!a.donut||a.donutSolid).move(E.x,E.y).arc(h,h,0,M-b>180,0,z.x,z.y);a.donut?a.donutSolid&&(v=t.polarToCartesian(k.x,k.y,L=h-A.value,b-(0===Z||G?0:.2)),w=t.polarToCartesian(k.x,k.y,L,M),R.line(v.x,v.y),R.arc(L,L,0,M-b>180,1,w.x,w.y)):R.line(k.x,k.y);var q=a.classNames.slicePie;a.donut&&(q=a.classNames.sliceDonut,a.donutSolid&&(q=a.classNames.sliceDonutSolid));var H=m[Z].elem("path",{d:R.stringify()},q);if(H.attr({"ct:value":u.normalized.series[Z],"ct:meta":t.serialize(P.meta)}),a.donut&&!a.donutSolid&&(H._node.style.strokeWidth=A.value+"px"),this.eventEmitter.emit("draw",{type:"slice",value:u.normalized.series[Z],totalDataSum:y,index:Z,meta:P.meta,series:P,group:m[Z],element:H,path:R.clone(),center:k,radius:h,startAngle:b,endAngle:M}),a.showLabel){var B,Q;B=1===u.raw.series.length?{x:k.x,y:k.y}:t.polarToCartesian(k.x,k.y,x,b+(M-b)/2),Q=u.normalized.labels&&!t.isFalseyButZero(u.normalized.labels[Z])?u.normalized.labels[Z]:u.normalized.series[Z];var $=a.labelInterpolationFnc(Q,Z);if($||0===$){var V=f.elem("text",{dx:B.x,dy:B.y,"text-anchor":i(k,B,a.labelDirection)},a.classNames.label).text(""+$);this.eventEmitter.emit("draw",{type:"label",index:Z,group:f,element:V,text:""+$,x:B.x,y:B.y})}}b=M}}.bind(this)),this.eventEmitter.emit("created",{chartRect:d,svg:this.svg,options:a})},determineAnchorPosition:i})}(this||global,X),X}()}.apply(Le,[]),void 0!==Y&&(Je.exports=Y)}}]);
//# sourceMappingURL=apps_concierge_src_app_reports_reports_module_ts.js.map