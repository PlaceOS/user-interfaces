(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_reports_reports_module_ts"],{3695:(_e,ae,E)=>{"use strict";E.r(ae),E.d(ae,{ReportsModule:()=>sn});var B=E(6362),F=E(587),D=E(9481),t=E(2656),U=E(9861),e=E(3184),r=E(4945),l=E(4929),d=E(5670),n=E(3294),o=E(3619),u=E(3499),f=E(4099),p=E(8426),c=E(9377),v=E(3200),y=E(475),A=E(312),b=E(8325),M=E(6610),q=E(1170),Q=864e5;function P(i,m){(0,q.Z)(2,arguments);var s=(0,c.Z)(i),a=(0,c.Z)(m),h=s.getTime()-(0,M.Z)(s),g=a.getTime()-(0,M.Z)(a);return Math.round((h-g)/Q)}function T(i,m){var s=i.getFullYear()-m.getFullYear()||i.getMonth()-m.getMonth()||i.getDate()-m.getDate()||i.getHours()-m.getHours()||i.getMinutes()-m.getMinutes()||i.getSeconds()-m.getSeconds()||i.getMilliseconds()-m.getMilliseconds();return s<0?-1:s>0?1:s}function O(i,m){(0,q.Z)(2,arguments);var s=(0,b.Z)(i),a=(0,b.Z)(m),h=T(s,a),g=Math.abs(P(s,a));s.setDate(s.getDate()-h*g);var x=Number(T(s,a)===-h),w=h*(g-x);return 0===w?0:w}var R=E(2317),N=E(5148),j=E(2218),_=E(4505),Z=E(4139),S=E(7716),k=E(823),Y=E(9095),X=E(7418),L=E(6942),I=E(9128);let V=(()=>{class i{constructor(s){this._org=s,this._generate=new j.xQ,this._loading=new _.X(""),this._active_bookings=new _.X([]),this._options=new _.X({start:new Date,end:new Date}),this._bookings_list=this._generate.pipe((0,k.b)(500),(0,Y.w)(a=>{var h;const g=this._options.getValue();if(this._loading.next("Loading report details..."),!(null==g?void 0:g.type)&&!(null===(h=null==g?void 0:g.zones)||void 0===h?void 0:h.length))return(0,Z.of)([]);const x=(0,c.Z)((null==g?void 0:g.start)?new Date(g.start):new Date).valueOf(),w=(0,v.Z)((null==g?void 0:g.end)?new Date(g.end):x).valueOf(),z=(null==g?void 0:g.zones)?g.zones.filter(G=>"All"!==G).join(","):"",J={period_start:Math.floor(x/1e3),period_end:Math.floor(w/1e3)};return"desks"===g.type?(0,f.F2)(Object.assign(Object.assign({},J),{zones:z,type:"desk"})):(0,p.u$)(Object.assign(Object.assign({},J),{zone_ids:z}))}),(0,X.K)(a=>[]),(0,L.U)(a=>(this._loading.next(""),(null==a?void 0:a.length)||(0,n.cB)("No bookings for the selected levels and period"),this._active_bookings.next(a||[]),a)),(0,I.d)()),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.bookings=this._active_bookings.asObservable(),this.counts=this._options.pipe((0,k.b)(500),(0,Y.w)(a=>{const h=(a.zones||[]).filter(g=>-1!==g&&"All"!==g);return Promise.all(h.map(g=>(0,u.rlq)(g,"desks").pipe((0,L.U)(x=>[g,x.details.length])).toPromise()))}),(0,X.K)(a=>[]),(0,L.U)(a=>{const h={};return this._active_bookings.next([]),a.forEach(([g,x])=>h[g]=x),h}),(0,I.d)()),this.stats=(0,S.aj)([this.counts,this.bookings]).pipe((0,L.U)(([a,h])=>h[0]instanceof p.ym?function $(i,m=8){const s=i.reduce((x,w)=>x+w.attendees.length,0),a=i.reduce((x,w)=>{var z;return x+(null===(z=w.system)||void 0===z?void 0:z.capacity)},0),h=Math.floor(i.reduce((x,w)=>x+w.duration,0)/(60*m)*100)/100,g=Math.floor(s/a*100)/100;return{count:i.length,avg_length:Math.floor(i.reduce((x,w)=>x+w.duration,0)/i.length*100)/100,efficiency:Math.floor((h+g)/2*100)/100,total_users:s,total_capacity:a,occupancy:g,utilisation:h,events:i}}(h,8*this.duration):function H(i,m=1,s={}){m=Math.max(1,m);const a=Object.keys(s).reduce((g,x)=>g+(s[x]||0),0),h=Math.floor(i.length/a/m*1e4)/1e4;return{total:a,count:i.length,utilisation:h,events:i}}(h||[],this.duration,a))),this.day_list=(0,S.aj)([this.options,this.stats]).pipe((0,L.U)(([a,h])=>{const{start:g}=a;let x=(0,c.Z)(g);const w=(0,v.Z)(a.end||x),z=[];for(;(0,y.Z)(x,w);){const J=(0,c.Z)(x).valueOf(),G=(0,v.Z)(J).valueOf(),C=h.events.filter(W=>(0,n.MZ)(J,G,W.date,W.date+60*W.duration*1e3));z.push({date:J,total:h.total,free:h.total-C.length,approved:C.reduce((W,K)=>W+(K.approved?1:0),0),count:C.length,utilisation:(C.length/h.total*100).toFixed(1)}),x=(0,A.Z)(x,1)}return z}),(0,I.d)(1)),this._bookings_list.subscribe(a=>a)}get duration(){const s=this._options.getValue();return Math.abs(O((0,c.Z)(s.start),(0,R.Z)((0,v.Z)(s.end),1)))}generateReport(){this._generate.next((new Date).valueOf())}setOptions(s){var a,h,g,x,w,z,J;(null===(a=s.zones)||void 0===a?void 0:a.includes("All"))?s.zones=["All",...this._org.levelsForBuilding(this._org.building).map(G=>G.id)]:s.zones&&(null===(g=null===(h=this._options.getValue())||void 0===h?void 0:h.zones)||void 0===g?void 0:g.includes("All"))&&(s.zones=[]),(null===(x=s.start)||void 0===x?void 0:x.valueOf())!==(null===(w=this._options.getValue().start)||void 0===w?void 0:w.valueOf())&&(null===(z=s.end)||void 0===z?void 0:z.valueOf())!==(null===(J=this._options.getValue().end)||void 0===J?void 0:J.valueOf())&&this._options.next(Object.assign(Object.assign({},this._options.getValue()),s))}downloadReport(){const s=this._options.getValue(),a=this._active_bookings.getValue();(0,n.Sv)(`report+${s.type}+${(0,N.Z)(s.start,"yyyy-MM-dd")}+${(0,N.Z)(s.end,"yyyy-MM-dd")}.csv`,(0,n.o3)(a.map(h=>{const g=h.toJSON();return delete g.zones,delete g.server_names,delete g.extension_data,g})))}}return i.\u0275fac=function(s){return new(s||i)(e.LFG(o.w7))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var se=E(4770),le=E(1434),ye=E(1130),oe=E(5818),ie=E(7317),ce=E(4742);function be(i,m){if(1&i&&(e.TgZ(0,"mat-option",11),e._uU(1),e.qZA()),2&i){const s=m.$implicit;e.Q6J("value",s.id),e.xp6(1),e.hij(" ",s.display_name||s.name," ")}}function we(i,m){1&i&&e._UZ(0,"mat-spinner",15),2&i&&e.Q6J("diameter",32)}function Te(i,m){1&i&&(e.TgZ(0,"p"),e._uU(1,"Generate Report"),e.qZA())}function Oe(i,m){if(1&i){const s=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){return e.CHM(s),e.oxw().generateReport()}),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,we,1,1,"mat-spinner",13),e.ALo(4,"async"),e.YNc(5,Te,2,0,"p",14),e.ALo(6,"async"),e.qZA()}if(2&i){const s=e.oxw();let a;e.Q6J("disabled",!!e.lcZ(1,3,s.loading)||!(null!=(a=e.lcZ(2,5,s.options))&&null!=a.zones&&a.zones.length)),e.xp6(3),e.Q6J("ngIf",e.lcZ(4,7,s.loading)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(6,9,s.loading))}}function Me(i,m){if(1&i){const s=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){return e.CHM(s),e.oxw().downloadReport()}),e.ALo(1,"async"),e.TgZ(2,"p"),e._uU(3,"Download Report"),e.qZA(),e.qZA()}if(2&i){const s=e.oxw();let a;e.Q6J("disabled",!(null!=(a=e.lcZ(1,1,s.bookings))&&a.length))}}let Se=(()=>{class i extends n.KG{constructor(s,a,h,g){super(),this._state=s,this._org=a,this._route=h,this._router=g,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(x=>`${x.id}`),this.levels=this._org.active_levels,this.loading=this._state.loading,this.bookings=this._state.bookings,this.options=this._state.options,this.page="",this.generateReport=()=>this._state.generateReport(),this.downloadReport=()=>this._state.downloadReport(),this.setStartDate=x=>this._state.setOptions({start:new Date(x)}),this.setEndDate=x=>this._state.setOptions({end:new Date(x)}),this.setZones=x=>this._state.setOptions({zones:x})}ngOnInit(){return(0,l.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,d.P)(s=>s)).toPromise(),this.page=this._router.url,this.subscription("routing",this._router.events.subscribe(()=>{this.page=this._router.url})),this.subscription("route.query",this._route.queryParamMap.subscribe(s=>{if(s.has("zone_ids")){const a=s.get("zone_ids").split(",");if(a.length){const h=this._org.levelWithID(a);if(!h)return;this._org.building=this._org.buildings.find(g=>g.id===h.parent_id),this.setZones(a)}}}))})}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V),e.Y36(o.w7),e.Y36(D.gz),e.Y36(D.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["reports-options"]],features:[e.qOj],decls:18,vars:16,consts:[["appearance","outline",1,"w-48"],["multiple","","placeholder","Select Levels...",3,"ngModel","ngModelChange"],["value","All"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"w-64"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["mat-button","","class","ml-4",3,"disabled","click",4,"ngIf"],[3,"value"],["mat-button","",1,"ml-4",3,"disabled","click"],[3,"diameter",4,"ngIf"],[4,"ngIf"],[3,"diameter"]],template:function(s,a){if(1&s&&(e.TgZ(0,"mat-form-field",0),e.TgZ(1,"mat-select",1),e.NdJ("ngModelChange",function(g){return a.setZones(g)}),e.ALo(2,"async"),e.TgZ(3,"mat-option",2),e._uU(4,"All Levels"),e.qZA(),e.YNc(5,be,2,2,"mat-option",3),e.ALo(6,"async"),e.qZA(),e.qZA(),e.TgZ(7,"mat-form-field",4),e.TgZ(8,"mat-date-range-input",5),e.TgZ(9,"input",6),e.NdJ("ngModelChange",function(g){return g?a.setStartDate(g):""}),e.ALo(10,"async"),e.qZA(),e.TgZ(11,"input",7),e.NdJ("ngModelChange",function(g){return g?a.setEndDate(g):""}),e.ALo(12,"async"),e.qZA(),e.qZA(),e._UZ(13,"mat-datepicker-toggle",8),e._UZ(14,"mat-date-range-picker",null,9),e.qZA(),e.YNc(16,Oe,7,11,"button",10),e.YNc(17,Me,4,3,"button",10)),2&s){const h=e.MAs(15);let g,x,w;e.xp6(1),e.Q6J("ngModel",null==(g=e.lcZ(2,8,a.options))?null:g.zones),e.xp6(4),e.Q6J("ngForOf",e.lcZ(6,10,a.levels)),e.xp6(3),e.Q6J("rangePicker",h),e.xp6(1),e.Q6J("ngModel",null==(x=e.lcZ(10,12,a.options))?null:x.start),e.xp6(2),e.Q6J("ngModel",null==(w=e.lcZ(12,14,a.options))?null:w.end),e.xp6(2),e.Q6J("for",h),e.xp6(3),e.Q6J("ngIf",!a.page.includes("contact-tracing")),e.xp6(1),e.Q6J("ngIf",!a.page.includes("contact-tracing"))}},directives:[se.KE,le.gD,F.JJ,F.On,ye.ey,B.sg,oe.wx,oe.zY,F.Fj,oe.By,oe.nW,se.R9,oe._g,B.O5,ie.lW,ce.$g],pipes:[B.Ov],styles:["[_nghost-%COMP%]{display:flex;align-items:center;background-color:#fff;height:5em;padding:0 1em}button[_ngcontent-%COMP%]{min-width:0;padding:0 .85rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;margin-left:1em}mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:5.5em;white-space:initial;line-height:1.2em}\n/*# sourceMappingURL=reports-options.component.ts-angular-inline--72.css.map*/"]}),i})();var ee=E(5306);const Ue=function(){return["/reports","desks"]};function Le(i,m){1&i&&(e.TgZ(0,"a",1),e.TgZ(1,"app-icon",2),e._uU(2,"room"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Desks"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA(),e.qZA(),e.qZA()),2&i&&e.Q6J("routerLink",e.DdM(1,Ue))}const Re=function(){return["/reports","spaces"]};function Ee(i,m){1&i&&(e.TgZ(0,"a",1),e.TgZ(1,"app-icon",2),e._uU(2,"meeting_room"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Rooms"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA(),e.qZA(),e.qZA()),2&i&&e.Q6J("routerLink",e.DdM(1,Re))}const ze=function(){return["/reports","catering"]};function Ne(i,m){1&i&&(e.TgZ(0,"a",1),e.TgZ(1,"app-icon",2),e._uU(2,"room_service"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Catering"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA(),e.qZA(),e.qZA()),2&i&&e.Q6J("routerLink",e.DdM(1,ze))}const qe=function(){return["/reports","contact-tracing"]};function ke(i,m){1&i&&(e.TgZ(0,"a",1),e.TgZ(1,"app-icon",2),e._uU(2,"connect_without_contact"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Contact Tracing"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA(),e.qZA(),e.qZA()),2&i&&e.Q6J("routerLink",e.DdM(1,qe))}let De=(()=>{class i{constructor(s){this._settings=s,this.features=[]}ngOnInit(){return(0,l.mG)(this,void 0,void 0,function*(){yield this._settings.initialised.pipe((0,d.P)(s=>!!s)).toPromise(),this.features=this._settings.get("app.reports.features")||["desks","spaces","catering","contact-tracing"]})}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(n.gb))},i.\u0275cmp=e.Xpm({type:i,selectors:[["reports-menu"],["","reports-menu",""]],decls:4,vars:4,consts:[["matRipple","","class","h-64 w-64 m-4 p-4 flex flex-col items-center justify-center bg-white rounded shadow hover:bg-gray-100",3,"routerLink",4,"ngIf"],["matRipple","",1,"h-64","w-64","m-4","p-4","flex","flex-col","items-center","justify-center","bg-white","rounded","shadow","hover:bg-gray-100",3,"routerLink"],[1,"text-8xl"],[1,"text-xl","font-bold","mb-4"],[1,"flex","items-center"],[1,"ml-2"]],template:function(s,a){1&s&&(e.YNc(0,Le,10,2,"a",0),e.YNc(1,Ee,10,2,"a",0),e.YNc(2,Ne,10,2,"a",0),e.YNc(3,ke,10,2,"a",0)),2&s&&(e.Q6J("ngIf",a.features.includes("desks")),e.xp6(1),e.Q6J("ngIf",a.features.includes("spaces")),e.xp6(1),e.Q6J("ngIf",a.features.includes("catering")),e.xp6(1),e.Q6J("ngIf",a.features.includes("contact-tracing")))},directives:[B.O5,D.yS,ye.wG,ee.o],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;background:var(--bg)}\n/*# sourceMappingURL=reports-menu.component.ts-angular-inline--74.css.map*/"]}),i})();const je=["app-reports",""];function Pe(i,m){1&i&&e._UZ(0,"div",4)}let Ie=(()=>{class i{constructor(s){this._router=s}get path(){const s=this._router.url.split("/");return s[s.length-1]}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(D.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["","app-reports",""]],attrs:je,decls:6,vars:1,consts:[[1,"h-full"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full"],[1,"flex-1","h-1/2","w-full","overflow-auto"],["reports-menu","","class","absolute inset-0",4,"ngIf"],["reports-menu","",1,"absolute","inset-0"]],template:function(s,a){1&s&&(e._UZ(0,"sidebar",0),e.TgZ(1,"main",1),e._UZ(2,"reports-options"),e.TgZ(3,"div",2),e._UZ(4,"router-outlet"),e.qZA(),e.YNc(5,Pe,1,0,"div",3),e.qZA()),2&s&&(e.xp6(5),e.Q6J("ngIf","reports"===a.path))},directives:[r.k,Se,D.lC,B.O5,De],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%;background:var(--bg)}\n/*# sourceMappingURL=reports.component.ts-angular-inline--71.css.map*/"]}),i})();var Be=E(3985),ue=E(6862),Ye=E(1799);let Fe=(()=>{class i{constructor(s){this._state=s,this.total_count=this._state.stats.pipe((0,L.U)(a=>a.count||0)),this.avg_length=this._state.stats.pipe((0,L.U)(a=>(0,Ye.Z)({minutes:a.avg_length||0}))),this.efficiency=this._state.stats.pipe((0,L.U)(a=>(100*(a.efficiency||0)).toFixed(1))),this.total_users=this._state.stats.pipe((0,L.U)(a=>a.total_users||0)),this.total_capacity=this._state.stats.pipe((0,L.U)(a=>a.total_capacity||0)),this.occupancy=this._state.stats.pipe((0,L.U)(a=>(100*(a.occupancy||0)).toFixed(1))),this.utilisation=this._state.stats.pipe((0,L.U)(a=>(100*(a.utilisation||0)).toFixed(1)))}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V))},i.\u0275cmp=e.Xpm({type:i,selectors:[["report-spaces-overall"]],decls:44,vars:21,consts:[[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"flex-1","flex","flex-col","items-center","justify-center"]],template:function(s,a){1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3"),e._uU(3,"Total Bookings"),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"async"),e.qZA(),e.qZA(),e.TgZ(7,"div",1),e.TgZ(8,"h3"),e._uU(9,"Average Bookings Length"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.ALo(12,"async"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",0),e.TgZ(14,"div",2),e.TgZ(15,"h3"),e._uU(16,"Overall Efficiency"),e.qZA(),e.TgZ(17,"p"),e._uU(18),e.ALo(19,"async"),e.qZA(),e.qZA(),e.TgZ(20,"div",2),e.TgZ(21,"h3"),e._uU(22,"Occupancy"),e.qZA(),e.TgZ(23,"p"),e._uU(24),e.ALo(25,"async"),e.qZA(),e.qZA(),e.TgZ(26,"div",2),e.TgZ(27,"h3"),e._uU(28,"Total Attendees"),e.qZA(),e.TgZ(29,"p"),e._uU(30),e.ALo(31,"async"),e.qZA(),e.qZA(),e.TgZ(32,"div",2),e.TgZ(33,"h3"),e._uU(34,"Total Capacity"),e.qZA(),e.TgZ(35,"p"),e._uU(36),e.ALo(37,"async"),e.qZA(),e.qZA(),e.TgZ(38,"div",2),e.TgZ(39,"h3"),e._uU(40,"Utilisation"),e.qZA(),e.TgZ(41,"p"),e._uU(42),e.ALo(43,"async"),e.qZA(),e.qZA(),e.qZA()),2&s&&(e.xp6(5),e.Oqu(e.lcZ(6,7,a.total_count)||0),e.xp6(6),e.Oqu(e.lcZ(12,9,a.avg_length)||"None"),e.xp6(7),e.hij("",e.lcZ(19,11,a.efficiency)||0,"%"),e.xp6(6),e.hij("",e.lcZ(25,13,a.occupancy)||0,"%"),e.xp6(6),e.Oqu(e.lcZ(31,15,a.total_users)||0),e.xp6(6),e.Oqu(e.lcZ(37,17,a.total_capacity)||0),e.xp6(6),e.hij("",e.lcZ(43,19,a.utilisation)||0,"%"))},pipes:[B.Ov],styles:["h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n/*# sourceMappingURL=report-spaces-overall.component.ts-angular-inline--75.css.map*/"]}),i})();var te=E(3910),ne=E(1110);const Qe=function(){return["name","capacity","count","utilisation","avg_attendees","occupancy"]},Je=function(){return["Name","Capacity","Meeting Count","Utilisation","Avg. Attendees","Occupancy"]},Ge=function(){return["flex"]};let Xe=(()=>{class i{constructor(s){this._reports=s,this.space_list=(0,S.aj)([this._reports.stats,this._reports.options]).pipe((0,k.b)(300),(0,L.U)(([a,{start:h,end:g}])=>{let x=[];for(const z of a.events){const J=z.resources||[];for(const G of J){x.find(W=>W.id===G.id)||x.push({id:G.id,name:G.display_name||G.name,capacity:G.capacity||1,count:0,attendees:0,avg_attendees:0,usage:0,utilisation:0,occupancy:0});const C=x.find(W=>W.id===G.id);C.count+=1,C.usage+=z.duration,C.attendees+=z.attendees.length}}const w=O(g,h);for(const z of x)z.avg_attendees=Math.floor(z.attendees/z.count*100)/100,z.utilisation=Math.floor(z.usage/60/8/w*100)/100,z.occupancy=Math.floor(z.avg_attendees/z.capacity*100)/100;return x})),this.download=()=>(0,l.mG)(this,void 0,void 0,function*(){const a=yield this.space_list.pipe((0,te.q)(1)).toPromise();(0,n.Sv)("report-spaces-usage.csv",(0,n.o3)(a))})}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V))},i.\u0275cmp=e.Xpm({type:i,selectors:[["report-spaces-space-listing"]],decls:8,vars:8,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],[3,"dataSource","pagination","columns","display_column","column_size"]],template:function(s,a){1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3",2),e._uU(3,"Space Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(7,"custom-table",4),e.qZA()),2&s&&(e.xp6(7),e.Q6J("dataSource",a.space_list)("pagination",!0)("columns",e.DdM(5,Qe))("display_column",e.DdM(6,Je))("column_size",e.DdM(7,Ge)))},directives:[ie.lW,ee.o,ne.C],styles:[""]}),i})();const He=function(){return["name","capacity","count","avg_attendees","occupancy"]},Ve=function(){return["Name","Capacity","Meeting Count","Avg. Attendees","Occupancy"]},We=function(){return["flex"]};let $e=(()=>{class i{constructor(s){this._reports=s,this.user_list=(0,S.aj)([this._reports.stats]).pipe((0,k.b)(300),(0,L.U)(([a])=>{let h=[];for(const g of a.events){const x=g.attendees||[],w=g.resources.reduce((z,J)=>z+J.capacity,0)||1;for(const z of x){h.find(G=>G.email===z.email)||h.push({id:z.email,name:z.name,capacity:w,count:0,attendees:0,avg_attendees:0,occupancy:0});const J=h.find(G=>G.id===z.email);J.count+=1,J.attendees+=g.attendees.length}}for(const g of h)g.avg_attendees=Math.floor(g.attendees/g.count*100)/100,g.occupancy=Math.floor(g.avg_attendees/g.capacity*100)/100;return h}),(0,I.d)(1)),this.download=()=>(0,l.mG)(this,void 0,void 0,function*(){const a=yield this.user_list.pipe((0,te.q)(1)).toPromise();(0,n.Sv)("report-space-attendee-usage.csv",(0,n.o3)(a))})}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V))},i.\u0275cmp=e.Xpm({type:i,selectors:[["report-spaces-user-listing"]],decls:8,vars:8,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],[3,"dataSource","pagination","columns","display_column","column_size"]],template:function(s,a){1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3",2),e._uU(3,"Staff Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(7,"custom-table",4),e.qZA()),2&s&&(e.xp6(7),e.Q6J("dataSource",a.user_list)("pagination",!0)("columns",e.DdM(5,He))("display_column",e.DdM(6,Ve))("column_size",e.DdM(7,We)))},directives:[ie.lW,ee.o,ne.C],styles:[""]}),i})();const Ce=["report-spaces",""];function Ke(i,m){1&i&&(e.ynx(0),e._UZ(1,"report-spaces-overall"),e._UZ(2,"report-spaces-space-listing"),e._UZ(3,"report-spaces-user-listing"),e.BQk())}function et(i,m){if(1&i&&(e.ynx(0),e.YNc(1,Ke,4,0,"ng-container",0),e.ALo(2,"async"),e.BQk()),2&i){const s=e.oxw(),a=e.MAs(5);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,s.total_count))("ngIfElse",a)}}function tt(i,m){1&i&&(e.TgZ(0,"div",3),e._UZ(1,"mat-spinner",4),e.TgZ(2,"p",5),e._uU(3,"Loading report data..."),e.qZA(),e.qZA()),2&i&&(e.xp6(1),e.Q6J("diameter",32))}function nt(i,m){1&i&&(e.TgZ(0,"div",3),e.TgZ(1,"p",5),e._uU(2," Select levels and time period to generate a report. "),e.qZA(),e.qZA())}let st=(()=>{class i{constructor(s){this._state=s,this.total_count=this._state.stats.pipe((0,L.U)(a=>a.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V))},i.\u0275cmp=e.Xpm({type:i,selectors:[["","report-spaces",""]],attrs:Ce,decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(s,a){if(1&s&&(e.YNc(0,et,3,4,"ng-container",0),e.ALo(1,"async"),e.YNc(2,tt,4,1,"ng-template",null,1,e.W1O),e.YNc(4,nt,3,0,"ng-template",null,2,e.W1O)),2&s){const h=e.MAs(3);e.Q6J("ngIf",!e.lcZ(1,2,a.loading))("ngIfElse",h)}},directives:[B.O5,Fe,Xe,$e,ce.$g],pipes:[B.Ov],styles:[""]}),i})();var xe=E(7103);let it=(()=>{class i extends n.KG{constructor(s,a){super(),this._state=s,this._org=a,this.day_list=this._state.day_list,this.stats=(0,S.aj)([this._state.options,this._state.counts])}ngOnInit(){this.subscription("day_list",this.day_list.subscribe(s=>this.updateDailyChart(s))),this.subscription("stats",this.stats.subscribe(([s,a])=>this.updateLevelChart(s,a)))}updateDailyChart(s){const a={labels:s.map(h=>(0,N.Z)(h.date,"dd MMM")),series:[s.map(h=>h.utilisation)]};this._day_chart=new xe.Line("#day-chart",a)}updateLevelChart(s,a){let{zones:h}=s||{};h.includes("All")&&(h=this._org.levels.filter(x=>x.parent_id===this._org.building.id).map(x=>x.id));const g={labels:(h||[]).map(x=>{const w=this._org.levelWithID([x]);return(null==w?void 0:w.display_name)||w.name||""}),series:(h||[]).map(x=>a[x])};this._level_chart=new xe.Pie("#level-chart",g)}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V),e.Y36(o.w7))},i.\u0275cmp=e.Xpm({type:i,selectors:[["report-desks-charts"]],features:[e.qOj],decls:11,vars:0,consts:[[1,"flex","items-center","space-x-4","w-full","px-4"],[1,"bg-white","rounded","shadow","flex-1"],[1,"border-b","border-gray-300","p-4","text-xl","font-bold"],["id","day-chart",1,"ct-chart","ct-octave"],["util_chart",""],["id","level-chart",1,"ct-chart","ct-octave"],["level_chart",""]],template:function(s,a){1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._uU(3," Daily Utilisation "),e.qZA(),e._UZ(4,"div",3,4),e.qZA(),e.TgZ(6,"div",1),e.TgZ(7,"div",2),e._uU(8," Level Utilisation "),e.qZA(),e._UZ(9,"div",5,6),e.qZA(),e.qZA())},styles:["[_nghost-%COMP%]{display:block}\n/*# sourceMappingURL=report-desks-charts.component.ts-angular-inline--87.css.map*/"]}),i})();function ot(i,m){1&i&&(e._uU(0),e.ALo(1,"date")),2&i&&e.hij(" ",e.xi3(1,1,m.data,"mediumDate")," ")}function rt(i,m){1&i&&e._uU(0),2&i&&e.hij(" ",m.data||"0","% ")}const at=function(){return["date","usage","approved","count","utilisation"]},lt=function(){return["Date","Used Desks","Approved Bookings","Total Requests","Utilisation"]},ct=function(){return["flex"]},ut=function(i,m,s){return{date:i,usage:m,utilisation:s}};let dt=(()=>{class i{constructor(s){this._state=s,this.day_list=this._state.day_list,this.download=()=>(0,l.mG)(this,void 0,void 0,function*(){let a=yield this.day_list.pipe((0,te.q)(1)).toPromise();a=a.map(h=>Object.assign(Object.assign({},h),{date:(0,N.Z)(h.date,"MMMM d, y(EEE)")})),(0,n.Sv)("desks-usage.csv",(0,n.o3)(a))})}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V))},i.\u0275cmp=e.Xpm({type:i,selectors:[["report-desks-overall-list"]],decls:12,vars:13,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["date_view",""],["percent_view",""]],template:function(s,a){if(1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3",2),e._uU(3,"Daily Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(7,"custom-table",4),e.YNc(8,ot,2,4,"ng-template",null,5,e.W1O),e.YNc(10,rt,1,1,"ng-template",null,6,e.W1O),e.qZA()),2&s){const h=e.MAs(9),g=e.MAs(11);e.xp6(7),e.Q6J("dataSource",a.day_list)("pagination",!0)("columns",e.DdM(6,at))("display_column",e.DdM(7,lt))("column_size",e.DdM(8,ct))("template",e.kEZ(9,ut,h,g,g))}},directives:[ie.lW,ee.o,ne.C],pipes:[B.uU],encapsulation:2}),i})();function pt(i,m){1&i&&e._uU(0),2&i&&e.hij(" ",m.data||"0","% ")}const ft=function(){return["name","avg_usage","approved","count","utilisation"]},mt=function(){return["Level","Avg. Used Desks","Approved Bookings","Total Requests","Utilisation"]},gt=function(){return["flex"]},ht=function(i){return{utilisation:i}};let vt=(()=>{class i{constructor(s,a){this._state=s,this._org=a,this.level_list=(0,S.aj)([this._state.options,this._state.stats,this._state.counts]).pipe((0,L.U)(([h,g,x])=>{const{start:w,end:z,zones:J}=h,G=O(z,w)||1,C=[];for(const W of J){if("All"===W)continue;const K=this._org.levelWithID([W]),he=x[W]||0,re=g.events.filter(ve=>ve.zones.includes(W));let pe=(he*G-re.length)/G;pe%1!=0&&(pe=pe.toFixed(2)),C.push({name:(null==K?void 0:K.display_name)||(null==K?void 0:K.name),free:pe,approved:re.filter(ve=>ve.approved).length||0,avg_usage:re.length/G,total:he,count:re.length,utilisation:(re.length/((he||1)*G)*100||0).toFixed(2)})}return C}),(0,I.d)(1)),this.download=()=>(0,l.mG)(this,void 0,void 0,function*(){let h=yield this.level_list.pipe((0,te.q)(1)).toPromise();(0,n.Sv)("desks-levels-usage.csv",(0,n.o3)(h))})}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V),e.Y36(o.w7))},i.\u0275cmp=e.Xpm({type:i,selectors:[["report-desks-levels-list"]],decls:11,vars:11,consts:[[1,"px-4","mb-4","w-full"],[1,"rounded","bg-white","shadow","overflow-hidden","w-full"],[1,"border-b","border-gray-300","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["percent_view",""]],template:function(s,a){if(1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"h3",3),e._uU(4,"Level Utilisation"),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return a.download()}),e.TgZ(6,"app-icon"),e._uU(7,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(8,"custom-table",5),e.YNc(9,pt,1,1,"ng-template",null,6,e.W1O),e.qZA(),e.qZA()),2&s){const h=e.MAs(10);e.xp6(8),e.Q6J("dataSource",a.level_list)("pagination",!0)("columns",e.DdM(6,ft))("display_column",e.DdM(7,mt))("column_size",e.DdM(8,gt))("template",e.VKq(9,ht,h))}},directives:[ie.lW,ee.o,ne.C],encapsulation:2}),i})();const _t=["report-desks",""];function yt(i,m){if(1&i&&(e.ynx(0),e.TgZ(1,"div",3),e.TgZ(2,"div",4),e.TgZ(3,"h3"),e._uU(4,"Total Bookings"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.ALo(7,"async"),e.qZA(),e.qZA(),e.TgZ(8,"div",4),e.TgZ(9,"h3"),e._uU(10,"Utilisation"),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.ALo(13,"async"),e.qZA(),e.qZA(),e.qZA(),e._UZ(14,"report-desks-charts"),e._UZ(15,"report-desks-overall-list"),e._UZ(16,"report-desks-levels-list"),e.BQk()),2&i){const s=e.oxw(2);e.xp6(6),e.Oqu(e.lcZ(7,2,s.total_count)||0),e.xp6(6),e.hij("",e.lcZ(13,4,s.utilisation)||0,"%")}}function xt(i,m){if(1&i&&(e.ynx(0),e.YNc(1,yt,17,6,"ng-container",0),e.ALo(2,"async"),e.BQk()),2&i){const s=e.oxw(),a=e.MAs(5);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,s.total_count))("ngIfElse",a)}}function Zt(i,m){1&i&&(e.TgZ(0,"div",5),e._UZ(1,"mat-spinner",6),e.TgZ(2,"p",7),e._uU(3,"Loading report data..."),e.qZA(),e.qZA()),2&i&&(e.xp6(1),e.Q6J("diameter",32))}function At(i,m){1&i&&(e.TgZ(0,"div",5),e.TgZ(1,"p",7),e._uU(2," Select levels and time period to generate a report. "),e.qZA(),e.qZA())}let bt=(()=>{class i{constructor(s){this._state=s,this.total_count=this._state.stats.pipe((0,L.U)(a=>a.count||0)),this.utilisation=this._state.stats.pipe((0,L.U)(a=>(100*(a.utilisation||0)).toFixed(1))),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"desks"})}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V))},i.\u0275cmp=e.Xpm({type:i,selectors:[["","report-desks",""]],attrs:_t,decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(s,a){if(1&s&&(e.YNc(0,xt,3,4,"ng-container",0),e.ALo(1,"async"),e.YNc(2,Zt,4,1,"ng-template",null,1,e.W1O),e.YNc(4,At,3,0,"ng-template",null,2,e.W1O)),2&s){const h=e.MAs(3);e.Q6J("ngIf",!e.lcZ(1,2,a.loading))("ngIfElse",h)}},directives:[B.O5,it,dt,vt,ce.$g],pipes:[B.Ov],styles:["h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n/*# sourceMappingURL=report-desks.component.ts-angular-inline--73.css.map*/"]}),i})();var Ze=E(7027);let fe=(()=>{class i{constructor(s){this._reports=s,this.catering_orders=this._reports.bookings.pipe((0,L.U)(a=>(0,n.xH)(a.filter(g=>{var x,w;return null===(w=null===(x=g.extension_data)||void 0===x?void 0:x.catering)||void 0===w?void 0:w.length}).map(g=>{var x;return null===(x=g.extension_data)||void 0===x?void 0:x.catering.map(w=>new Ze.GX(Object.assign(Object.assign({},w),{deliver_at:g.date,event:g})))})).filter(g=>g).sort((g,x)=>{var w,z;return(null===(w=g.event)||void 0===w?void 0:w.date)-(null===(z=x.event)||void 0===z?void 0:z.date)})),(0,I.d)(1)),this.catering_items=this.catering_orders.pipe((0,L.U)(a=>{var h;const g=[];for(const x of a)for(const w of(null==x?void 0:x.items)||[]){const z=g.findIndex(J=>w.options_string===J.options_string);z>=0?w[z]=new Ze.Ud(Object.assign(Object.assign({},w),{quantity:(null==w?void 0:w.quantity)+(null===(h=w[z])||void 0===h?void 0:h.quantity)})):g.push(w)}return g.sort((x,w)=>w.quantity-x.quantity)})),this.stats=(0,S.aj)([this.catering_orders,this.catering_items]).pipe((0,L.U)(([a,h])=>{const g=a.reduce((x,w)=>x+w.total_cost,0);return{order_count:a.length,unique_items:h.length,item_count:a.reduce((x,w)=>x+w.item_count,0),total_cost:g,avg_cost:g/a.length}}))}downloadOrders(){return(0,l.mG)(this,void 0,void 0,function*(){const s=yield this.catering_orders.pipe((0,te.q)(1)).toPromise(),a=(0,n.o3)(s);return(0,n.Sv)("catering-orders.csv",a)})}}return i.\u0275fac=function(s){return new(s||i)(e.LFG(V))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),wt=(()=>{class i{constructor(s){this._report=s,this.stats=this._report.stats}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(fe))},i.\u0275cmp=e.Xpm({type:i,selectors:[["catering-report-overall"]],decls:32,vars:19,consts:[[1,"bg-white","shadow","rounded","m-2","px-8","w-48","h-24","flex","flex-col","items-center","justify-center"],[1,"text-3xl"],[1,""]],template:function(s,a){if(1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._uU(2),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"div",2),e._uU(5,"Orders"),e.qZA(),e.qZA(),e.TgZ(6,"div",0),e.TgZ(7,"div",1),e._uU(8),e.ALo(9,"async"),e.qZA(),e.TgZ(10,"div",2),e._uU(11,"Unique Items"),e.qZA(),e.qZA(),e.TgZ(12,"div",0),e.TgZ(13,"div",1),e._uU(14),e.ALo(15,"async"),e.qZA(),e.TgZ(16,"div",2),e._uU(17,"Ordered Items"),e.qZA(),e.qZA(),e.TgZ(18,"div",0),e.TgZ(19,"div",1),e._uU(20),e.ALo(21,"currency"),e.ALo(22,"async"),e.qZA(),e.TgZ(23,"div",2),e._uU(24,"Total"),e.qZA(),e.qZA(),e.TgZ(25,"div",0),e.TgZ(26,"div",1),e._uU(27),e.ALo(28,"currency"),e.ALo(29,"async"),e.qZA(),e.TgZ(30,"div",2),e._uU(31,"Order Average"),e.qZA(),e.qZA()),2&s){let h,g,x,w,z;e.xp6(2),e.hij(" ",(null==(h=e.lcZ(3,5,a.stats))?null:h.order_count)||"0"," "),e.xp6(6),e.hij(" ",(null==(g=e.lcZ(9,7,a.stats))?null:g.unique_items)||"0"," "),e.xp6(6),e.Oqu((null==(x=e.lcZ(15,9,a.stats))?null:x.item_count)||"0"),e.xp6(6),e.hij(" ",e.lcZ(21,11,(null==(w=e.lcZ(22,13,a.stats))?null:w.total_cost)/100||0)," "),e.xp6(7),e.hij(" ",e.lcZ(28,15,(null==(z=e.lcZ(29,17,a.stats))?null:z.avg_cost)/100||0)," ")}},pipes:[B.Ov,B.H9],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:center;padding:.5rem}\n/*# sourceMappingURL=catering-report-overall.component.ts-angular-inline--86.css.map*/"]}),i})();var me=E(89);function Tt(i,m){if(1&i&&(e._uU(0),e.ALo(1,"date"),e.ALo(2,"date")),2&i){const s=m.data;e.AsE(" ",e.lcZ(1,2,s)," at ",e.xi3(2,4,s,"shortTime")," ")}}function Ot(i,m){1&i&&(e._uU(0),e.ALo(1,"currency")),2&i&&e.hij(" ",e.lcZ(1,1,m.data/100)," ")}const Mt=function(){return["deliver_at","item_count","total_cost"]},St=function(){return["Date","Items","Total Cost"]},Ut=function(){return["flex"]},Lt=function(i,m){return{deliver_at:i,total_cost:m}};let Rt=(()=>{class i{constructor(s){this._report=s,this.orders=this._report.catering_orders,this.download=()=>this._report.downloadOrders()}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(fe))},i.\u0275cmp=e.Xpm({type:i,selectors:[["catering-report-orders"]],decls:12,vars:12,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["mat-button-icon","","matTooltip","Download list",3,"click"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["date_state",""],["cost_state",""]],template:function(s,a){if(1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h2",2),e._uU(3,"Orders"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA(),e.qZA(),e.qZA(),e._UZ(7,"custom-table",4),e.YNc(8,Tt,3,7,"ng-template",null,5,e.W1O),e.YNc(10,Ot,2,3,"ng-template",null,6,e.W1O),e.qZA()),2&s){const h=e.MAs(9),g=e.MAs(11);e.xp6(7),e.Q6J("dataSource",a.orders)("columns",e.DdM(6,Mt))("display_column",e.DdM(7,St))("column_size",e.DdM(8,Ut))("template",e.WLB(9,Lt,h,g))("pagination",!0)}},directives:[me.gM,ee.o,ne.C],pipes:[B.uU,B.H9],styles:[""]}),i})();function Et(i,m){if(1&i&&(e.TgZ(0,"span",7),e._uU(1),e.qZA()),2&i){const s=e.oxw().data,a=e.oxw();e.Q6J("matTooltip",a.options(s)),e.xp6(1),e.hij(" ",s.length," option(s) ")}}function zt(i,m){1&i&&e.YNc(0,Et,2,2,"span",6),2&i&&e.Q6J("ngIf",m.data.length)}function Nt(i,m){1&i&&(e._uU(0),e.ALo(1,"currency")),2&i&&e.hij(" ",e.lcZ(1,1,(m.data||0)/100)," ")}const qt=function(){return["name","options","quantity","unit_price","total_cost"]},kt=function(){return["Name","Options","Quantity","Unit Price","Total Cost"]},Dt=function(){return["flex"]},jt=function(i,m,s){return{options:i,unit_price:m,total_cost:s}};let Pt=(()=>{class i{constructor(s){this._report=s,this.items=this._report.catering_items}options(s){return s.map(a=>a.name).join("\n")}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(fe))},i.\u0275cmp=e.Xpm({type:i,selectors:[["catering-report-items"]],decls:9,vars:13,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["option_state",""],["cost_state",""],["class","text-xs px-2 py-1 rounded bg-gray-300",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-gray-300",3,"matTooltip"]],template:function(s,a){if(1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h2",2),e._uU(3,"Ordered Items"),e.qZA(),e.qZA(),e._UZ(4,"custom-table",3),e.YNc(5,zt,1,1,"ng-template",null,4,e.W1O),e.YNc(7,Nt,2,3,"ng-template",null,5,e.W1O),e.qZA()),2&s){const h=e.MAs(6),g=e.MAs(8);e.xp6(4),e.Q6J("dataSource",a.items)("columns",e.DdM(6,qt))("display_column",e.DdM(7,kt))("column_size",e.DdM(8,Dt))("template",e.kEZ(9,jt,h,g,g))("pagination",!0)}},directives:[ne.C,B.O5,me.gM],pipes:[B.H9],styles:[""]}),i})();function It(i,m){1&i&&(e.TgZ(0,"div",4),e._UZ(1,"catering-report-overall"),e._UZ(2,"catering-report-orders"),e._UZ(3,"catering-report-items"),e.qZA())}function Bt(i,m){if(1&i&&(e.ynx(0),e.YNc(1,It,4,0,"div",3),e.ALo(2,"async"),e.BQk()),2&i){const s=e.oxw(),a=e.MAs(5);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,s.total_count))("ngIfElse",a)}}function Yt(i,m){1&i&&(e.TgZ(0,"div",5),e._UZ(1,"mat-spinner",6),e.TgZ(2,"p",7),e._uU(3,"Loading report data..."),e.qZA(),e.qZA()),2&i&&(e.xp6(1),e.Q6J("diameter",32))}function Ft(i,m){1&i&&(e.TgZ(0,"div",5),e.TgZ(1,"p",7),e._uU(2," Select levels and time period to generate a report. "),e.qZA(),e.qZA())}let Qt=(()=>{class i{constructor(s){this._state=s,this.total_count=this._state.stats.pipe((0,L.U)(a=>a.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(V))},i.\u0275cmp=e.Xpm({type:i,selectors:[["catering-report"]],decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],["class","h-full w-full",4,"ngIf","ngIfElse"],[1,"h-full","w-full"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(s,a){if(1&s&&(e.YNc(0,Bt,3,4,"ng-container",0),e.ALo(1,"async"),e.YNc(2,Yt,4,1,"ng-template",null,1,e.W1O),e.YNc(4,Ft,3,0,"ng-template",null,2,e.W1O)),2&s){const h=e.MAs(3);e.Q6J("ngIf",!e.lcZ(1,2,a.loading))("ngIfElse",h)}},directives:[B.O5,wt,Rt,Pt,ce.$g],pipes:[B.Ov],styles:[""]}),i})();var Ae=E(1810);const de={};let ge=(()=>{class i{transform(s){return de[s]||(de[s]=(0,ue.VE)(s).pipe((0,L.U)(a=>a[0]||new ue.mO({id:s,name:s})),(0,X.K)(a=>(0,Z.of)(new ue.mO({id:s,name:s}))),(0,I.d)(1))),de[s]}static addUser(s){de[s.id]=(0,Z.of)(s).pipe((0,I.d)(1))}}return i.\u0275fac=function(s){return new(s||i)},i.\u0275pipe=e.Yjl({name:"user",type:i,pure:!0}),i})(),Jt=(()=>{class i{constructor(s,a){this._org=s,this._reports=a,this._options=new _.X({}),this.events=(0,S.aj)([this._options,this._reports.options]).pipe((0,Y.w)(([{user:h},{start:g,end:x}])=>{const w=(0,u.rTZ)(this.system_id,"ContactTracing");return h=h||(0,n.ar)(),ge.addUser(h),this.system_id&&w?w.execute("close_contacts",[h.email,h.username,(0,Ae.Z)(g),(0,Ae.Z)(x)]):(0,Z.of)([])}),(0,L.U)(h=>{const g=this._options.getValue().user||(0,n.ar)();return h.map(x=>({mac_address:x.mac_address,date:1e3*x.contact_time,duration:x.duration/60,user_id:g.id,user:g.name,contact_id:x.username,distance:1}))}),(0,X.K)(h=>((0,n.cB)(`${h}`),(0,Z.of)([]))),(0,I.d)(1)),this.options=this._options.asObservable()}get system_id(){var s,a,h,g;return(null===(a=null===(s=this._org.organisation)||void 0===s?void 0:s.bindings)||void 0===a?void 0:a.contact_tracing)||(null===(g=null===(h=this._org.building)||void 0===h?void 0:h.bindings)||void 0===g?void 0:g.contact_tracing)}setOptions(s){this._options.next(Object.assign(Object.assign({},this._options.getValue()),s))}downloadReport(){return(0,l.mG)(this,void 0,void 0,function*(){const{start:s,end:a}=yield this._reports.options.pipe((0,te.q)(1)).toPromise(),h=yield this.events.pipe((0,te.q)(1)).toPromise(),g=new ge,x=yield Promise.all(h.map(w=>(0,l.mG)(this,void 0,void 0,function*(){var z;return{"MAC Address":w.mac_address,Date:(0,N.Z)(w.date,"dd MMM yyyy, h:mm a"),"User Name":w.user,"Contact Name":(null===(z=yield g.transform(w.contact_id).toPromise())||void 0===z?void 0:z.name)||("null"!==w.contact_id?w.contact_id:null)||w.mac_address,Duration:Math.round(w.duration),Distance:w.distance}})));(0,n.Sv)(`report+contact-tracing+${(0,N.Z)(s,"yyyy-MM-dd")}+${(0,N.Z)(a,"yyyy-MM-dd")}.csv`,(0,n.o3)(x))})}}return i.\u0275fac=function(s){return new(s||i)(e.LFG(o.w7),e.LFG(V))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Gt=E(9697);function Xt(i,m){if(1&i&&(e.TgZ(0,"span",11),e._uU(1),e.qZA()),2&i){const s=e.oxw().data,a=e.oxw();e.Q6J("matTooltip",a.options(s)),e.xp6(1),e.hij(" ",s.length," option(s) ")}}function Ht(i,m){1&i&&e.YNc(0,Xt,2,2,"span",10),2&i&&e.Q6J("ngIf",m.data.length)}function Vt(i,m){if(1&i&&(e._uU(0),e.ALo(1,"async"),e.ALo(2,"user")),2&i){let a;e.Oqu(null==(a=e.lcZ(1,1,e.lcZ(2,3,m.data)))?null:a.name)}}function Wt(i,m){if(1&i&&(e._uU(0),e.ALo(1,"date"),e.ALo(2,"date")),2&i){const s=m.data;e.AsE(" ",e.xi3(1,2,s,"mediumDate"),", ",e.xi3(2,5,s,"shortTime")," ")}}function $t(i,m){1&i&&e._uU(0),2&i&&e.hij(" ",m.data,"m ")}const Ct=function(){return["date","user_id","contact_id"]},Kt=function(){return["Time of Contact","Person","Close Contact"]},en=function(){return["12r","14r","flex"]},tn=function(i,m,s,a,h){return{options:i,date:m,distance:s,user_id:a,contact_id:h}},nn=[{path:"",component:Ie,children:[{path:""},{path:"spaces",component:st},{path:"desks",component:bt},{path:"catering",component:Qt},{path:"contact-tracing",component:(()=>{class i{constructor(s){this._state=s,this.options=this._state.options,this.tracing_events=this._state.events,this.setOptions=a=>this._state.setOptions(a),this.downloadReport=()=>this._state.downloadReport()}}return i.\u0275fac=function(s){return new(s||i)(e.Y36(Jt))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-contact-tracing-report"]],decls:18,vars:19,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],[1,"w-64","h-12","mb-2","mt-1",3,"ngModel","ngModelChange"],["empty","No contact records for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination","page_size"],["option_state",""],["user_state",""],["date_state",""],["distance_state",""],["mat-icon-button","","matTooltip","Download Report",1,"bg-white","absolute","bottom-2","left-2","shadow",3,"click"],["class","text-xs px-2 py-1 rounded bg-gray-300",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-gray-300",3,"matTooltip"]],template:function(s,a){if(1&s&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h2",2),e._uU(3,"Contact Events"),e.qZA(),e.TgZ(4,"a-user-search-field",3),e.NdJ("ngModelChange",function(g){return a.setOptions({user:g})}),e.ALo(5,"async"),e.qZA(),e.qZA(),e._UZ(6,"custom-table",4),e.YNc(7,Ht,1,1,"ng-template",null,5,e.W1O),e.YNc(9,Vt,3,5,"ng-template",null,6,e.W1O),e.YNc(11,Wt,3,8,"ng-template",null,7,e.W1O),e.YNc(13,$t,1,1,"ng-template",null,8,e.W1O),e.qZA(),e.TgZ(15,"button",9),e.NdJ("click",function(){return a.downloadReport()}),e.TgZ(16,"app-icon"),e._uU(17,"download"),e.qZA(),e.qZA()),2&s){const h=e.MAs(8),g=e.MAs(10),x=e.MAs(12),w=e.MAs(14);let z;e.xp6(4),e.Q6J("ngModel",null==(z=e.lcZ(5,8,a.options))?null:z.user),e.xp6(2),e.Q6J("dataSource",a.tracing_events)("columns",e.DdM(10,Ct))("display_column",e.DdM(11,Kt))("column_size",e.DdM(12,en))("template",e.qbA(13,tn,h,x,w,g,g))("pagination",!0)("page_size",30)}},directives:[Gt.d,F.JJ,F.On,ne.C,B.O5,me.gM,ie.lW,ee.o],pipes:[B.Ov,ge,B.uU],styles:[""]}),i})()},{path:"**",redirectTo:"desks"}]}];let sn=(()=>{class i{}return i.\u0275fac=function(s){return new(s||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[B.ez,F.u5,t.v,Be.YR,ue.PP,U.TU,D.Bz.forChild(nn)]]}),i})()},7103:function(_e,ae){var B,F;F=this,B=function(){return F.Chartist=function(){var F={version:"0.11.4"};return function(D,t){"use strict";var U=D.window,e=D.document;t.namespaces={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},t.noop=function(r){return r},t.alphaNumerate=function(r){return String.fromCharCode(97+r%26)},t.extend=function(r){var l,d,n;for(r=r||{},l=1;l<arguments.length;l++)for(var o in d=arguments[l])r[o]="object"!=typeof(n=d[o])||null===n||n instanceof Array?n:t.extend(r[o],n);return r},t.replaceAll=function(r,l,d){return r.replace(new RegExp(l,"g"),d)},t.ensureUnit=function(r,l){return"number"==typeof r&&(r+=l),r},t.quantity=function(r){if("string"==typeof r){var l=/^(\d+)\s*(.*)$/g.exec(r);return{value:+l[1],unit:l[2]||void 0}}return{value:r}},t.querySelector=function(r){return r instanceof Node?r:e.querySelector(r)},t.times=function(r){return Array.apply(null,new Array(r))},t.sum=function(r,l){return r+(l||0)},t.mapMultiply=function(r){return function(l){return l*r}},t.mapAdd=function(r){return function(l){return l+r}},t.serialMap=function(r,l){var d=[],n=Math.max.apply(null,r.map(function(o){return o.length}));return t.times(n).forEach(function(o,u){var f=r.map(function(p){return p[u]});d[u]=l.apply(null,f)}),d},t.roundWithPrecision=function(r,l){var d=Math.pow(10,l||t.precision);return Math.round(r*d)/d},t.precision=8,t.escapingMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t.serialize=function(r){return null==r?r:("number"==typeof r?r=""+r:"object"==typeof r&&(r=JSON.stringify({data:r})),Object.keys(t.escapingMap).reduce(function(l,d){return t.replaceAll(l,d,t.escapingMap[d])},r))},t.deserialize=function(r){if("string"!=typeof r)return r;r=Object.keys(t.escapingMap).reduce(function(l,d){return t.replaceAll(l,t.escapingMap[d],d)},r);try{r=void 0!==(r=JSON.parse(r)).data?r.data:r}catch(l){}return r},t.createSvg=function(r,l,d,n){var o;return l=l||"100%",d=d||"100%",Array.prototype.slice.call(r.querySelectorAll("svg")).filter(function(f){return f.getAttributeNS(t.namespaces.xmlns,"ct")}).forEach(function(f){r.removeChild(f)}),(o=new t.Svg("svg").attr({width:l,height:d}).addClass(n))._node.style.width=l,o._node.style.height=d,r.appendChild(o._node),o},t.normalizeData=function(r,l,d){var n,o={raw:r,normalized:{}};return o.normalized.series=t.getDataArray({series:r.series||[]},l,d),n=o.normalized.series.every(function(u){return u instanceof Array})?Math.max.apply(null,o.normalized.series.map(function(u){return u.length})):o.normalized.series.length,o.normalized.labels=(r.labels||[]).slice(),Array.prototype.push.apply(o.normalized.labels,t.times(Math.max(0,n-o.normalized.labels.length)).map(function(){return""})),l&&t.reverseData(o.normalized),o},t.safeHasProperty=function(r,l){return null!==r&&"object"==typeof r&&r.hasOwnProperty(l)},t.isDataHoleValue=function(r){return null==r||"number"==typeof r&&isNaN(r)},t.reverseData=function(r){r.labels.reverse(),r.series.reverse();for(var l=0;l<r.series.length;l++)"object"==typeof r.series[l]&&void 0!==r.series[l].data?r.series[l].data.reverse():r.series[l]instanceof Array&&r.series[l].reverse()},t.getDataArray=function(r,l,d){return r.series.map(function n(o){if(t.safeHasProperty(o,"value"))return n(o.value);if(t.safeHasProperty(o,"data"))return n(o.data);if(o instanceof Array)return o.map(n);if(!t.isDataHoleValue(o)){if(d){var u={};return"string"==typeof d?u[d]=t.getNumberOrUndefined(o):u.y=t.getNumberOrUndefined(o),u.x=o.hasOwnProperty("x")?t.getNumberOrUndefined(o.x):u.x,u.y=o.hasOwnProperty("y")?t.getNumberOrUndefined(o.y):u.y,u}return t.getNumberOrUndefined(o)}})},t.normalizePadding=function(r,l){return l=l||0,"number"==typeof r?{top:r,right:r,bottom:r,left:r}:{top:"number"==typeof r.top?r.top:l,right:"number"==typeof r.right?r.right:l,bottom:"number"==typeof r.bottom?r.bottom:l,left:"number"==typeof r.left?r.left:l}},t.getMetaData=function(r,l){var d=r.data?r.data[l]:r[l];return d?d.meta:void 0},t.orderOfMagnitude=function(r){return Math.floor(Math.log(Math.abs(r))/Math.LN10)},t.projectLength=function(r,l,d){return l/d.range*r},t.getAvailableHeight=function(r,l){return Math.max((t.quantity(l.height).value||r.height())-(l.chartPadding.top+l.chartPadding.bottom)-l.axisX.offset,0)},t.getHighLow=function(r,l,d){var n={high:void 0===(l=t.extend({},l,d?l["axis"+d.toUpperCase()]:{})).high?-Number.MAX_VALUE:+l.high,low:void 0===l.low?Number.MAX_VALUE:+l.low},o=void 0===l.high,u=void 0===l.low;return(o||u)&&function f(p){if(void 0!==p)if(p instanceof Array)for(var c=0;c<p.length;c++)f(p[c]);else{var v=d?+p[d]:+p;o&&v>n.high&&(n.high=v),u&&v<n.low&&(n.low=v)}}(r),(l.referenceValue||0===l.referenceValue)&&(n.high=Math.max(l.referenceValue,n.high),n.low=Math.min(l.referenceValue,n.low)),n.high<=n.low&&(0===n.low?n.high=1:n.low<0?n.high=0:(n.high>0||(n.high=1),n.low=0)),n},t.isNumeric=function(r){return null!==r&&isFinite(r)},t.isFalseyButZero=function(r){return!r&&0!==r},t.getNumberOrUndefined=function(r){return t.isNumeric(r)?+r:void 0},t.isMultiValue=function(r){return"object"==typeof r&&("x"in r||"y"in r)},t.getMultiValue=function(r,l){return t.isMultiValue(r)?t.getNumberOrUndefined(r[l||"y"]):t.getNumberOrUndefined(r)},t.rho=function(r){if(1===r)return r;function l(f,p){return f%p==0?p:l(p,f%p)}function d(f){return f*f+1}var u,n=2,o=2;if(r%2==0)return 2;do{n=d(n)%r,o=d(d(o))%r,u=l(Math.abs(n-o),r)}while(1===u);return u},t.getBounds=function(r,l,d,n){var o,f,p,u=0,c={high:l.high,low:l.low};c.valueRange=c.high-c.low,c.oom=t.orderOfMagnitude(c.valueRange),c.step=Math.pow(10,c.oom),c.min=Math.floor(c.low/c.step)*c.step,c.max=Math.ceil(c.high/c.step)*c.step,c.range=c.max-c.min,c.numberOfSteps=Math.round(c.range/c.step);var y=t.projectLength(r,c.step,c)<d,A=n?t.rho(c.range):0;if(n&&t.projectLength(r,1,c)>=d)c.step=1;else if(n&&A<c.step&&t.projectLength(r,A,c)>=d)c.step=A;else for(;;){if(y&&t.projectLength(r,c.step,c)<=d)c.step*=2;else{if(y||!(t.projectLength(r,c.step/2,c)>=d))break;if(c.step/=2,n&&c.step%1!=0){c.step*=2;break}}if(u++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}var b=2221e-19;function M(P,T){return P===(P+=T)&&(P*=1+(T>0?b:-b)),P}for(c.step=Math.max(c.step,b),f=c.min,p=c.max;f+c.step<=c.low;)f=M(f,c.step);for(;p-c.step>=c.high;)p=M(p,-c.step);c.min=f,c.max=p,c.range=c.max-c.min;var q=[];for(o=c.min;o<=c.max;o=M(o,c.step)){var Q=t.roundWithPrecision(o);Q!==q[q.length-1]&&q.push(Q)}return c.values=q,c},t.polarToCartesian=function(r,l,d,n){var o=(n-90)*Math.PI/180;return{x:r+d*Math.cos(o),y:l+d*Math.sin(o)}},t.createChartRect=function(r,l,d){var n=!(!l.axisX&&!l.axisY),o=n?l.axisY.offset:0,u=n?l.axisX.offset:0,f=r.width()||t.quantity(l.width).value||0,p=r.height()||t.quantity(l.height).value||0,c=t.normalizePadding(l.chartPadding,d);f=Math.max(f,o+c.left+c.right),p=Math.max(p,u+c.top+c.bottom);var v={padding:c,width:function(){return this.x2-this.x1},height:function(){return this.y1-this.y2}};return n?("start"===l.axisX.position?(v.y2=c.top+u,v.y1=Math.max(p-c.bottom,v.y2+1)):(v.y2=c.top,v.y1=Math.max(p-c.bottom-u,v.y2+1)),"start"===l.axisY.position?(v.x1=c.left+o,v.x2=Math.max(f-c.right,v.x1+1)):(v.x1=c.left,v.x2=Math.max(f-c.right-o,v.x1+1))):(v.x1=c.left,v.x2=Math.max(f-c.right,v.x1+1),v.y2=c.top,v.y1=Math.max(p-c.bottom,v.y2+1)),v},t.createGrid=function(r,l,d,n,o,u,f,p){var c={};c[d.units.pos+"1"]=r,c[d.units.pos+"2"]=r,c[d.counterUnits.pos+"1"]=n,c[d.counterUnits.pos+"2"]=n+o;var v=u.elem("line",c,f.join(" "));p.emit("draw",t.extend({type:"grid",axis:d,index:l,group:u,element:v},c))},t.createGridBackground=function(r,l,d,n){var o=r.elem("rect",{x:l.x1,y:l.y2,width:l.width(),height:l.height()},d,!0);n.emit("draw",{type:"gridBackground",group:r,element:o})},t.createLabel=function(r,l,d,n,o,u,f,p,c,v,y){var A,b={};if(b[o.units.pos]=r+f[o.units.pos],b[o.counterUnits.pos]=f[o.counterUnits.pos],b[o.units.len]=l,b[o.counterUnits.len]=Math.max(0,u-10),v){var M=e.createElement("span");M.className=c.join(" "),M.setAttribute("xmlns",t.namespaces.xhtml),M.innerText=n[d],M.style[o.units.len]=Math.round(b[o.units.len])+"px",M.style[o.counterUnits.len]=Math.round(b[o.counterUnits.len])+"px",A=p.foreignObject(M,t.extend({style:"overflow: visible;"},b))}else A=p.elem("text",b,c.join(" ")).text(n[d]);y.emit("draw",t.extend({type:"label",axis:o,index:d,group:p,element:A,text:n[d]},b))},t.getSeriesOption=function(r,l,d){if(r.name&&l.series&&l.series[r.name]){var n=l.series[r.name];return n.hasOwnProperty(d)?n[d]:l[d]}return l[d]},t.optionsProvider=function(r,l,d){var o,f,n=t.extend({},r),u=[];function p(y){var A=o;if(o=t.extend({},n),l)for(f=0;f<l.length;f++)U.matchMedia(l[f][0]).matches&&(o=t.extend(o,l[f][1]));d&&y&&d.emit("optionsChanged",{previousOptions:A,currentOptions:o})}if(!U.matchMedia)throw"window.matchMedia not found! Make sure you're using a polyfill.";if(l)for(f=0;f<l.length;f++){var v=U.matchMedia(l[f][0]);v.addListener(p),u.push(v)}return p(),{removeMediaQueryListeners:function c(){u.forEach(function(y){y.removeListener(p)})},getCurrentOptions:function(){return t.extend({},o)}}},t.splitIntoSegments=function(r,l,d){d=t.extend({},{increasingX:!1,fillHoles:!1},d);for(var o=[],u=!0,f=0;f<r.length;f+=2)void 0===t.getMultiValue(l[f/2].value)?d.fillHoles||(u=!0):(d.increasingX&&f>=2&&r[f]<=r[f-2]&&(u=!0),u&&(o.push({pathCoordinates:[],valueData:[]}),u=!1),o[o.length-1].pathCoordinates.push(r[f],r[f+1]),o[o.length-1].valueData.push(l[f/2]));return o}}(this||global,F),function(D,t){"use strict";t.Interpolation={},t.Interpolation.none=function(U){return U=t.extend({},{fillHoles:!1},U),function(l,d){for(var n=new t.Svg.Path,o=!0,u=0;u<l.length;u+=2){var f=l[u],p=l[u+1],c=d[u/2];void 0!==t.getMultiValue(c.value)?(o?n.move(f,p,!1,c):n.line(f,p,!1,c),o=!1):U.fillHoles||(o=!0)}return n}},t.Interpolation.simple=function(U){U=t.extend({},{divisor:2,fillHoles:!1},U);var r=1/Math.max(1,U.divisor);return function(d,n){for(var u,f,p,o=new t.Svg.Path,c=0;c<d.length;c+=2){var v=d[c],y=d[c+1],A=(v-u)*r,b=n[c/2];void 0!==b.value?(void 0===p?o.move(v,y,!1,b):o.curve(u+A,f,v-A,y,v,y,!1,b),u=v,f=y,p=b):U.fillHoles||(u=v=p=void 0)}return o}},t.Interpolation.cardinal=function(U){U=t.extend({},{tension:1,fillHoles:!1},U);var r=Math.min(1,Math.max(0,U.tension)),l=1-r;return function d(n,o){var u=t.splitIntoSegments(n,o,{fillHoles:U.fillHoles});if(u.length){if(u.length>1){var f=[];return u.forEach(function(b){f.push(d(b.pathCoordinates,b.valueData))}),t.Svg.Path.join(f)}if(o=u[0].valueData,(n=u[0].pathCoordinates).length<=4)return t.Interpolation.none()(n,o);for(var p=(new t.Svg.Path).move(n[0],n[1],!1,o[0]),v=0,y=n.length;y-2>v;v+=2){var A=[{x:+n[v-2],y:+n[v-1]},{x:+n[v],y:+n[v+1]},{x:+n[v+2],y:+n[v+3]},{x:+n[v+4],y:+n[v+5]}];y-4===v?A[3]=A[2]:v||(A[0]={x:+n[v],y:+n[v+1]}),p.curve(r*(6*A[1].x-A[0].x+A[2].x)/6+l*A[2].x,r*(6*A[1].y-A[0].y+A[2].y)/6+l*A[2].y,r*(A[1].x+6*A[2].x-A[3].x)/6+l*A[2].x,r*(A[1].y+6*A[2].y-A[3].y)/6+l*A[2].y,A[2].x,A[2].y,!1,o[(v+2)/2])}return p}return t.Interpolation.none()([])}},t.Interpolation.monotoneCubic=function(U){return U=t.extend({},{fillHoles:!1},U),function r(l,d){var n=t.splitIntoSegments(l,d,{fillHoles:U.fillHoles,increasingX:!0});if(n.length){if(n.length>1){var o=[];return n.forEach(function(q){o.push(r(q.pathCoordinates,q.valueData))}),t.Svg.Path.join(o)}if(d=n[0].valueData,(l=n[0].pathCoordinates).length<=4)return t.Interpolation.none()(l,d);var p,M,u=[],f=[],c=l.length/2,v=[],y=[],A=[],b=[];for(p=0;p<c;p++)u[p]=l[2*p],f[p]=l[2*p+1];for(p=0;p<c-1;p++)A[p]=f[p+1]-f[p],b[p]=u[p+1]-u[p],y[p]=A[p]/b[p];for(v[0]=y[0],v[c-1]=y[c-2],p=1;p<c-1;p++)0===y[p]||0===y[p-1]||y[p-1]>0!=y[p]>0?v[p]=0:(v[p]=3*(b[p-1]+b[p])/((2*b[p]+b[p-1])/y[p-1]+(b[p]+2*b[p-1])/y[p]),isFinite(v[p])||(v[p]=0));for(M=(new t.Svg.Path).move(u[0],f[0],!1,d[0]),p=0;p<c-1;p++)M.curve(u[p]+b[p]/3,f[p]+v[p]*b[p]/3,u[p+1]-b[p]/3,f[p+1]-v[p+1]*b[p]/3,u[p+1],f[p+1],!1,d[p+1]);return M}return t.Interpolation.none()([])}},t.Interpolation.step=function(U){return U=t.extend({},{postpone:!0,fillHoles:!1},U),function(l,d){for(var o,u,f,n=new t.Svg.Path,p=0;p<l.length;p+=2){var c=l[p],v=l[p+1],y=d[p/2];void 0!==y.value?(void 0===f?n.move(c,v,!1,y):(U.postpone?n.line(c,u,!1,f):n.line(o,v,!1,y),n.line(c,v,!1,y)),o=c,u=v,f=y):U.fillHoles||(o=u=f=void 0)}return n}}}(this||global,F),function(D,t){"use strict";t.EventEmitter=function(){var U=[];return{addEventHandler:function e(d,n){U[d]=U[d]||[],U[d].push(n)},removeEventHandler:function r(d,n){U[d]&&(n?(U[d].splice(U[d].indexOf(n),1),0===U[d].length&&delete U[d]):delete U[d])},emit:function l(d,n){U[d]&&U[d].forEach(function(o){o(n)}),U["*"]&&U["*"].forEach(function(o){o(d,n)})}}}}(this||global,F),function(D,t){"use strict";function U(l){var d=[];if(l.length)for(var n=0;n<l.length;n++)d.push(l[n]);return d}t.Class={extend:function e(l,d){var n=d||this.prototype||t.Class,o=Object.create(n);t.Class.cloneDefinitions(o,l);var u=function(){var p,f=o.constructor||function(){};return p=this===t?Object.create(o):this,f.apply(p,Array.prototype.slice.call(arguments,0)),p};return u.prototype=o,u.super=n,u.extend=this.extend,u},cloneDefinitions:function r(){var l=U(arguments),d=l[0];return l.splice(1,l.length-1).forEach(function(n){Object.getOwnPropertyNames(n).forEach(function(o){delete d[o],Object.defineProperty(d,o,Object.getOwnPropertyDescriptor(n,o))})}),d}}}(this||global,F),function(D,t){"use strict";var U=D.window;function n(){U.addEventListener("resize",this.resizeListener),this.optionsProvider=t.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.addEventHandler("optionsChanged",function(){this.update()}.bind(this)),this.options.plugins&&this.options.plugins.forEach(function(u){u instanceof Array?u[0](this,u[1]):u(this)}.bind(this)),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=void 0}t.Base=t.Class.extend({constructor:function o(u,f,p,c,v){this.container=t.querySelector(u),this.data=f||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.defaultOptions=p,this.options=c,this.responsiveOptions=v,this.eventEmitter=t.EventEmitter(),this.supportsForeignObject=t.Svg.isSupported("Extensibility"),this.supportsAnimations=t.Svg.isSupported("AnimationEventsAttribute"),this.resizeListener=function(){this.update()}.bind(this),this.container&&(this.container.__chartist__&&this.container.__chartist__.detach(),this.container.__chartist__=this),this.initializeTimeoutId=setTimeout(n.bind(this),0)},optionsProvider:void 0,container:void 0,svg:void 0,eventEmitter:void 0,createChart:function(){throw new Error("Base chart type can't be instantiated!")},update:function e(u,f,p){return u&&(this.data=u||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.eventEmitter.emit("data",{type:"update",data:this.data})),f&&(this.options=t.extend({},p?this.options:this.defaultOptions,f),this.initializeTimeoutId||(this.optionsProvider.removeMediaQueryListeners(),this.optionsProvider=t.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter))),this.initializeTimeoutId||this.createChart(this.optionsProvider.getCurrentOptions()),this},detach:function r(){return this.initializeTimeoutId?U.clearTimeout(this.initializeTimeoutId):(U.removeEventListener("resize",this.resizeListener),this.optionsProvider.removeMediaQueryListeners()),this},on:function l(u,f){return this.eventEmitter.addEventHandler(u,f),this},off:function d(u,f){return this.eventEmitter.removeEventHandler(u,f),this},version:t.version,supportsForeignObject:!1})}(this||global,F),function(D,t){"use strict";var U=D.document;t.Svg=t.Class.extend({constructor:function e(_,Z,S,k,Y){_ instanceof Element?this._node=_:(this._node=U.createElementNS(t.namespaces.svg,_),"svg"===_&&this.attr({"xmlns:ct":t.namespaces.ct})),Z&&this.attr(Z),S&&this.addClass(S),k&&(Y&&k._node.firstChild?k._node.insertBefore(this._node,k._node.firstChild):k._node.appendChild(this._node))},attr:function r(_,Z){return"string"==typeof _?Z?this._node.getAttributeNS(Z,_):this._node.getAttribute(_):(Object.keys(_).forEach(function(S){if(void 0!==_[S])if(-1!==S.indexOf(":")){var k=S.split(":");this._node.setAttributeNS(t.namespaces[k[0]],S,_[S])}else this._node.setAttribute(S,_[S])}.bind(this)),this)},elem:function l(_,Z,S,k){return new t.Svg(_,Z,S,this,k)},parent:function d(){return this._node.parentNode instanceof SVGElement?new t.Svg(this._node.parentNode):null},root:function n(){for(var _=this._node;"svg"!==_.nodeName;)_=_.parentNode;return new t.Svg(_)},querySelector:function o(_){var Z=this._node.querySelector(_);return Z?new t.Svg(Z):null},querySelectorAll:function u(_){var Z=this._node.querySelectorAll(_);return Z.length?new t.Svg.List(Z):null},getNode:function f(){return this._node},foreignObject:function p(_,Z,S,k){if("string"==typeof _){var Y=U.createElement("div");Y.innerHTML=_,_=Y.firstChild}_.setAttribute("xmlns",t.namespaces.xmlns);var X=this.elem("foreignObject",Z,S,k);return X._node.appendChild(_),X},text:function c(_){return this._node.appendChild(U.createTextNode(_)),this},empty:function v(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this},remove:function y(){return this._node.parentNode.removeChild(this._node),this.parent()},replace:function A(_){return this._node.parentNode.replaceChild(_._node,this._node),_},append:function b(_,Z){return Z&&this._node.firstChild?this._node.insertBefore(_._node,this._node.firstChild):this._node.appendChild(_._node),this},classes:function M(){return this._node.getAttribute("class")?this._node.getAttribute("class").trim().split(/\s+/):[]},addClass:function q(_){return this._node.setAttribute("class",this.classes(this._node).concat(_.trim().split(/\s+/)).filter(function(Z,S,k){return k.indexOf(Z)===S}).join(" ")),this},removeClass:function Q(_){var Z=_.trim().split(/\s+/);return this._node.setAttribute("class",this.classes(this._node).filter(function(S){return-1===Z.indexOf(S)}).join(" ")),this},removeAllClasses:function P(){return this._node.setAttribute("class",""),this},height:function T(){return this._node.getBoundingClientRect().height},width:function O(){return this._node.getBoundingClientRect().width},animate:function R(_,Z,S){return void 0===Z&&(Z=!0),Object.keys(_).forEach(function(Y){function X(L,I){var $,V,se,H={};L.easing&&(se=L.easing instanceof Array?L.easing:t.Svg.Easing[L.easing],delete L.easing),L.begin=t.ensureUnit(L.begin,"ms"),L.dur=t.ensureUnit(L.dur,"ms"),se&&(L.calcMode="spline",L.keySplines=se.join(" "),L.keyTimes="0;1"),I&&(L.fill="freeze",H[Y]=L.from,this.attr(H),V=t.quantity(L.begin||0).value,L.begin="indefinite"),$=this.elem("animate",t.extend({attributeName:Y},L)),I&&setTimeout(function(){try{$._node.beginElement()}catch(le){H[Y]=L.to,this.attr(H),$.remove()}}.bind(this),V),S&&$._node.addEventListener("beginEvent",function(){S.emit("animationBegin",{element:this,animate:$._node,params:L})}.bind(this)),$._node.addEventListener("endEvent",function(){S&&S.emit("animationEnd",{element:this,animate:$._node,params:L}),I&&(H[Y]=L.to,this.attr(H),$.remove())}.bind(this))}_[Y]instanceof Array?_[Y].forEach(function(L){X.bind(this)(L,!1)}.bind(this)):X.bind(this)(_[Y],Z)}.bind(this)),this}}),t.Svg.isSupported=function(_){return U.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#"+_,"1.1")},t.Svg.Easing={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]},t.Svg.List=t.Class.extend({constructor:function j(_){var Z=this;this.svgElements=[];for(var S=0;S<_.length;S++)this.svgElements.push(new t.Svg(_[S]));Object.keys(t.Svg.prototype).filter(function(k){return-1===["constructor","parent","querySelector","querySelectorAll","replace","append","classes","height","width"].indexOf(k)}).forEach(function(k){Z[k]=function(){var Y=Array.prototype.slice.call(arguments,0);return Z.svgElements.forEach(function(X){t.Svg.prototype[k].apply(X,Y)}),Z}})}})}(this||global,F),function(D,t){"use strict";var U={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},e={accuracy:3};function r(T,O,R,N,j,_){var Z=t.extend({command:j?T.toLowerCase():T.toUpperCase()},O,_?{data:_}:{});R.splice(N,0,Z)}function l(T,O){T.forEach(function(R,N){U[R.command.toLowerCase()].forEach(function(j,_){O(R,j,N,_,T)})})}t.Svg.Path=t.Class.extend({constructor:function d(T,O){this.pathElements=[],this.pos=0,this.close=T,this.options=t.extend({},e,O)},position:function n(T){return void 0!==T?(this.pos=Math.max(0,Math.min(this.pathElements.length,T)),this):this.pos},remove:function o(T){return this.pathElements.splice(this.pos,T),this},move:function u(T,O,R,N){return r("M",{x:+T,y:+O},this.pathElements,this.pos++,R,N),this},line:function f(T,O,R,N){return r("L",{x:+T,y:+O},this.pathElements,this.pos++,R,N),this},curve:function p(T,O,R,N,j,_,Z,S){return r("C",{x1:+T,y1:+O,x2:+R,y2:+N,x:+j,y:+_},this.pathElements,this.pos++,Z,S),this},arc:function c(T,O,R,N,j,_,Z,S,k){return r("A",{rx:+T,ry:+O,xAr:+R,lAf:+N,sf:+j,x:+_,y:+Z},this.pathElements,this.pos++,S,k),this},scale:function A(T,O){return l(this.pathElements,function(R,N){R[N]*="x"===N[0]?T:O}),this},translate:function b(T,O){return l(this.pathElements,function(R,N){R[N]+="x"===N[0]?T:O}),this},transform:function M(T){return l(this.pathElements,function(O,R,N,j,_){var Z=T(O,R,N,j,_);(Z||0===Z)&&(O[R]=Z)}),this},parse:function v(T){var O=T.replace(/([A-Za-z])([0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce(function(j,_){return _.match(/[A-Za-z]/)&&j.push([]),j[j.length-1].push(_),j},[]);"Z"===O[O.length-1][0].toUpperCase()&&O.pop();var R=O.map(function(j){var _=j.shift(),Z=U[_.toLowerCase()];return t.extend({command:_},Z.reduce(function(S,k,Y){return S[k]=+j[Y],S},{}))}),N=[this.pos,0];return Array.prototype.push.apply(N,R),Array.prototype.splice.apply(this.pathElements,N),this.pos+=R.length,this},stringify:function y(){var T=Math.pow(10,this.options.accuracy);return this.pathElements.reduce(function(O,R){var N=U[R.command.toLowerCase()].map(function(j){return this.options.accuracy?Math.round(R[j]*T)/T:R[j]}.bind(this));return O+R.command+N.join(",")}.bind(this),"")+(this.close?"Z":"")},clone:function q(T){var O=new t.Svg.Path(T||this.close);return O.pos=this.pos,O.pathElements=this.pathElements.slice().map(function(N){return t.extend({},N)}),O.options=t.extend({},this.options),O},splitByCommand:function Q(T){var O=[new t.Svg.Path];return this.pathElements.forEach(function(R){R.command===T.toUpperCase()&&0!==O[O.length-1].pathElements.length&&O.push(new t.Svg.Path),O[O.length-1].pathElements.push(R)}),O}}),t.Svg.Path.elementDescriptions=U,t.Svg.Path.join=function P(T,O,R){for(var N=new t.Svg.Path(O,R),j=0;j<T.length;j++)for(var _=T[j],Z=0;Z<_.pathElements.length;Z++)N.pathElements.push(_.pathElements[Z]);return N}}(this||global,F),function(D,t){"use strict";var r={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};t.Axis=t.Class.extend({constructor:function l(n,o,u,f){this.units=n,this.counterUnits=n===r.x?r.y:r.x,this.chartRect=o,this.axisLength=o[n.rectEnd]-o[n.rectStart],this.gridOffset=o[n.rectOffset],this.ticks=u,this.options=f},createGridAndLabels:function d(n,o,u,f,p){var c=f["axis"+this.units.pos.toUpperCase()],v=this.ticks.map(this.projectValue.bind(this)),y=this.ticks.map(c.labelInterpolationFnc);v.forEach(function(A,b){var q,M={x:0,y:0};q=v[b+1]?v[b+1]-A:Math.max(this.axisLength-A,30),(!t.isFalseyButZero(y[b])||""===y[b])&&("x"===this.units.pos?(A=this.chartRect.x1+A,M.x=f.axisX.labelOffset.x,M.y="start"===f.axisX.position?this.chartRect.padding.top+f.axisX.labelOffset.y+(u?5:20):this.chartRect.y1+f.axisX.labelOffset.y+(u?5:20)):(A=this.chartRect.y1-A,M.y=f.axisY.labelOffset.y-(u?q:0),M.x="start"===f.axisY.position?u?this.chartRect.padding.left+f.axisY.labelOffset.x:this.chartRect.x1-10:this.chartRect.x2+f.axisY.labelOffset.x+10),c.showGrid&&t.createGrid(A,b,this,this.gridOffset,this.chartRect[this.counterUnits.len](),n,[f.classNames.grid,f.classNames[this.units.dir]],p),c.showLabel&&t.createLabel(A,q,b,y,this,c.offset,M,o,[f.classNames.label,f.classNames[this.units.dir],"start"===c.position?f.classNames[c.position]:f.classNames.end],u,p))}.bind(this))},projectValue:function(n,o,u){throw new Error("Base axis can't be instantiated!")}}),t.Axis.units=r}(this||global,F),function(D,t){"use strict";t.AutoScaleAxis=t.Axis.extend({constructor:function r(d,n,o,u){var f=u.highLow||t.getHighLow(n,u,d.pos);this.bounds=t.getBounds(o[d.rectEnd]-o[d.rectStart],f,u.scaleMinSpace||20,u.onlyInteger),this.range={min:this.bounds.min,max:this.bounds.max},t.AutoScaleAxis.super.constructor.call(this,d,o,this.bounds.values,u)},projectValue:function l(d){return this.axisLength*(+t.getMultiValue(d,this.units.pos)-this.bounds.min)/this.bounds.range}})}(this||global,F),function(D,t){"use strict";t.FixedScaleAxis=t.Axis.extend({constructor:function r(d,n,o,u){var f=u.highLow||t.getHighLow(n,u,d.pos);this.divisor=u.divisor||1,this.ticks=u.ticks||t.times(this.divisor).map(function(p,c){return f.low+(f.high-f.low)/this.divisor*c}.bind(this)),this.ticks.sort(function(p,c){return p-c}),this.range={min:f.low,max:f.high},t.FixedScaleAxis.super.constructor.call(this,d,o,this.ticks,u),this.stepLength=this.axisLength/this.divisor},projectValue:function l(d){return this.axisLength*(+t.getMultiValue(d,this.units.pos)-this.range.min)/(this.range.max-this.range.min)}})}(this||global,F),function(D,t){"use strict";t.StepAxis=t.Axis.extend({constructor:function r(d,n,o,u){t.StepAxis.super.constructor.call(this,d,o,u.ticks,u);var f=Math.max(1,u.ticks.length-(u.stretch?1:0));this.stepLength=this.axisLength/f},projectValue:function l(d,n){return this.stepLength*n}})}(this||global,F),function(D,t){"use strict";var r={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,showGridBackground:!1,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};t.Line=t.Base.extend({constructor:function d(n,o,u,f){t.Line.super.constructor.call(this,n,o,r,t.extend({},r,u),f)},createChart:function l(n){var o=t.normalizeData(this.data,n.reverseData,!0);this.svg=t.createSvg(this.container,n.width,n.height,n.classNames.chart);var v,y,u=this.svg.elem("g").addClass(n.classNames.gridGroup),f=this.svg.elem("g"),p=this.svg.elem("g").addClass(n.classNames.labelGroup),c=t.createChartRect(this.svg,n,r.padding);v=void 0===n.axisX.type?new t.StepAxis(t.Axis.units.x,o.normalized.series,c,t.extend({},n.axisX,{ticks:o.normalized.labels,stretch:n.fullWidth})):n.axisX.type.call(t,t.Axis.units.x,o.normalized.series,c,n.axisX),y=void 0===n.axisY.type?new t.AutoScaleAxis(t.Axis.units.y,o.normalized.series,c,t.extend({},n.axisY,{high:t.isNumeric(n.high)?n.high:n.axisY.high,low:t.isNumeric(n.low)?n.low:n.axisY.low})):n.axisY.type.call(t,t.Axis.units.y,o.normalized.series,c,n.axisY),v.createGridAndLabels(u,p,this.supportsForeignObject,n,this.eventEmitter),y.createGridAndLabels(u,p,this.supportsForeignObject,n,this.eventEmitter),n.showGridBackground&&t.createGridBackground(u,c,n.classNames.gridBackground,this.eventEmitter),o.raw.series.forEach(function(A,b){var M=f.elem("g");M.attr({"ct:series-name":A.name,"ct:meta":t.serialize(A.meta)}),M.addClass([n.classNames.series,A.className||n.classNames.series+"-"+t.alphaNumerate(b)].join(" "));var q=[],Q=[];o.normalized.series[b].forEach(function(_,Z){var S={x:c.x1+v.projectValue(_,Z,o.normalized.series[b]),y:c.y1-y.projectValue(_,Z,o.normalized.series[b])};q.push(S.x,S.y),Q.push({value:_,valueIndex:Z,meta:t.getMetaData(A,Z)})}.bind(this));var P={lineSmooth:t.getSeriesOption(A,n,"lineSmooth"),showPoint:t.getSeriesOption(A,n,"showPoint"),showLine:t.getSeriesOption(A,n,"showLine"),showArea:t.getSeriesOption(A,n,"showArea"),areaBase:t.getSeriesOption(A,n,"areaBase")},O=("function"==typeof P.lineSmooth?P.lineSmooth:P.lineSmooth?t.Interpolation.monotoneCubic():t.Interpolation.none())(q,Q);if(P.showPoint&&O.pathElements.forEach(function(_){var Z=M.elem("line",{x1:_.x,y1:_.y,x2:_.x+.01,y2:_.y},n.classNames.point).attr({"ct:value":[_.data.value.x,_.data.value.y].filter(t.isNumeric).join(","),"ct:meta":t.serialize(_.data.meta)});this.eventEmitter.emit("draw",{type:"point",value:_.data.value,index:_.data.valueIndex,meta:_.data.meta,series:A,seriesIndex:b,axisX:v,axisY:y,group:M,element:Z,x:_.x,y:_.y})}.bind(this)),P.showLine){var R=M.elem("path",{d:O.stringify()},n.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:o.normalized.series[b],path:O.clone(),chartRect:c,index:b,series:A,seriesIndex:b,seriesMeta:A.meta,axisX:v,axisY:y,group:M,element:R})}if(P.showArea&&y.range){var N=Math.max(Math.min(P.areaBase,y.range.max),y.range.min),j=c.y1-y.projectValue(N);O.splitByCommand("M").filter(function(Z){return Z.pathElements.length>1}).map(function(Z){var S=Z.pathElements[0],k=Z.pathElements[Z.pathElements.length-1];return Z.clone(!0).position(0).remove(1).move(S.x,j).line(S.x,S.y).position(Z.pathElements.length+1).line(k.x,j)}).forEach(function(Z){var S=M.elem("path",{d:Z.stringify()},n.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:o.normalized.series[b],path:Z.clone(),series:A,seriesIndex:b,axisX:v,axisY:y,chartRect:c,index:b,group:M,element:S})}.bind(this))}}.bind(this)),this.eventEmitter.emit("created",{bounds:y.bounds,chartRect:c,axisX:v,axisY:y,svg:this.svg,options:n})}})}(this||global,F),function(D,t){"use strict";var r={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,scaleMinSpace:30,onlyInteger:!1},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,high:void 0,low:void 0,referenceValue:0,chartPadding:{top:15,right:15,bottom:5,left:10},seriesBarDistance:15,stackBars:!1,stackMode:"accumulate",horizontalBars:!1,distributeSeries:!1,reverseData:!1,showGridBackground:!1,classNames:{chart:"ct-chart-bar",horizontalBars:"ct-horizontal-bars",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",bar:"ct-bar",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};t.Bar=t.Base.extend({constructor:function d(n,o,u,f){t.Bar.super.constructor.call(this,n,o,r,t.extend({},r,u),f)},createChart:function l(n){var o,u;n.distributeSeries?(o=t.normalizeData(this.data,n.reverseData,n.horizontalBars?"x":"y")).normalized.series=o.normalized.series.map(function(O){return[O]}):o=t.normalizeData(this.data,n.reverseData,n.horizontalBars?"x":"y"),this.svg=t.createSvg(this.container,n.width,n.height,n.classNames.chart+(n.horizontalBars?" "+n.classNames.horizontalBars:""));var f=this.svg.elem("g").addClass(n.classNames.gridGroup),p=this.svg.elem("g"),c=this.svg.elem("g").addClass(n.classNames.labelGroup);if(n.stackBars&&0!==o.normalized.series.length){var v=t.serialMap(o.normalized.series,function(){return Array.prototype.slice.call(arguments).map(function(R){return R}).reduce(function(R,N){return{x:R.x+(N&&N.x)||0,y:R.y+(N&&N.y)||0}},{x:0,y:0})});u=t.getHighLow([v],n,n.horizontalBars?"x":"y")}else u=t.getHighLow(o.normalized.series,n,n.horizontalBars?"x":"y");u.high=+n.high||(0===n.high?0:u.high),u.low=+n.low||(0===n.low?0:u.low);var A,b,M,q,Q,y=t.createChartRect(this.svg,n,r.padding);b=n.distributeSeries&&n.stackBars?o.normalized.labels.slice(0,1):o.normalized.labels,n.horizontalBars?(A=q=void 0===n.axisX.type?new t.AutoScaleAxis(t.Axis.units.x,o.normalized.series,y,t.extend({},n.axisX,{highLow:u,referenceValue:0})):n.axisX.type.call(t,t.Axis.units.x,o.normalized.series,y,t.extend({},n.axisX,{highLow:u,referenceValue:0})),M=Q=void 0===n.axisY.type?new t.StepAxis(t.Axis.units.y,o.normalized.series,y,{ticks:b}):n.axisY.type.call(t,t.Axis.units.y,o.normalized.series,y,n.axisY)):(M=q=void 0===n.axisX.type?new t.StepAxis(t.Axis.units.x,o.normalized.series,y,{ticks:b}):n.axisX.type.call(t,t.Axis.units.x,o.normalized.series,y,n.axisX),A=Q=void 0===n.axisY.type?new t.AutoScaleAxis(t.Axis.units.y,o.normalized.series,y,t.extend({},n.axisY,{highLow:u,referenceValue:0})):n.axisY.type.call(t,t.Axis.units.y,o.normalized.series,y,t.extend({},n.axisY,{highLow:u,referenceValue:0})));var P=n.horizontalBars?y.x1+A.projectValue(0):y.y1-A.projectValue(0),T=[];M.createGridAndLabels(f,c,this.supportsForeignObject,n,this.eventEmitter),A.createGridAndLabels(f,c,this.supportsForeignObject,n,this.eventEmitter),n.showGridBackground&&t.createGridBackground(f,y,n.classNames.gridBackground,this.eventEmitter),o.raw.series.forEach(function(O,R){var j,_,N=R-(o.raw.series.length-1)/2;j=n.distributeSeries&&!n.stackBars?M.axisLength/o.normalized.series.length/2:n.distributeSeries&&n.stackBars?M.axisLength/2:M.axisLength/o.normalized.series[R].length/2,(_=p.elem("g")).attr({"ct:series-name":O.name,"ct:meta":t.serialize(O.meta)}),_.addClass([n.classNames.series,O.className||n.classNames.series+"-"+t.alphaNumerate(R)].join(" ")),o.normalized.series[R].forEach(function(Z,S){var k,Y,X,L;if(L=n.distributeSeries&&!n.stackBars?R:n.distributeSeries&&n.stackBars?0:S,k=n.horizontalBars?{x:y.x1+A.projectValue(Z&&Z.x?Z.x:0,S,o.normalized.series[R]),y:y.y1-M.projectValue(Z&&Z.y?Z.y:0,L,o.normalized.series[R])}:{x:y.x1+M.projectValue(Z&&Z.x?Z.x:0,L,o.normalized.series[R]),y:y.y1-A.projectValue(Z&&Z.y?Z.y:0,S,o.normalized.series[R])},M instanceof t.StepAxis&&(M.options.stretch||(k[M.units.pos]+=j*(n.horizontalBars?-1:1)),k[M.units.pos]+=n.stackBars||n.distributeSeries?0:N*n.seriesBarDistance*(n.horizontalBars?-1:1)),T[S]=(X=T[S]||P)-(P-k[M.counterUnits.pos]),void 0!==Z){var I={};I[M.units.pos+"1"]=k[M.units.pos],I[M.units.pos+"2"]=k[M.units.pos],!n.stackBars||"accumulate"!==n.stackMode&&n.stackMode?(I[M.counterUnits.pos+"1"]=P,I[M.counterUnits.pos+"2"]=k[M.counterUnits.pos]):(I[M.counterUnits.pos+"1"]=X,I[M.counterUnits.pos+"2"]=T[S]),I.x1=Math.min(Math.max(I.x1,y.x1),y.x2),I.x2=Math.min(Math.max(I.x2,y.x1),y.x2),I.y1=Math.min(Math.max(I.y1,y.y2),y.y1),I.y2=Math.min(Math.max(I.y2,y.y2),y.y1);var H=t.getMetaData(O,S);Y=_.elem("line",I,n.classNames.bar).attr({"ct:value":[Z.x,Z.y].filter(t.isNumeric).join(","),"ct:meta":t.serialize(H)}),this.eventEmitter.emit("draw",t.extend({type:"bar",value:Z,index:S,meta:H,series:O,seriesIndex:R,axisX:q,axisY:Q,chartRect:y,group:_,element:Y},I))}}.bind(this))}.bind(this)),this.eventEmitter.emit("created",{bounds:A.bounds,chartRect:y,axisX:q,axisY:Q,svg:this.svg,options:n})}})}(this||global,F),function(D,t){"use strict";var r={width:void 0,height:void 0,chartPadding:5,classNames:{chartPie:"ct-chart-pie",chartDonut:"ct-chart-donut",series:"ct-series",slicePie:"ct-slice-pie",sliceDonut:"ct-slice-donut",sliceDonutSolid:"ct-slice-donut-solid",label:"ct-label"},startAngle:0,total:void 0,donut:!1,donutSolid:!1,donutWidth:60,showLabel:!0,labelOffset:0,labelPosition:"inside",labelInterpolationFnc:t.noop,labelDirection:"neutral",reverseData:!1,ignoreEmptyValues:!1};function l(o,u,f){var p=u.x>o.x;return p&&"explode"===f||!p&&"implode"===f?"start":p&&"implode"===f||!p&&"explode"===f?"end":"middle"}t.Pie=t.Base.extend({constructor:function n(o,u,f,p){t.Pie.super.constructor.call(this,o,u,r,t.extend({},r,f),p)},createChart:function d(o){var p,c,v,y,A,u=t.normalizeData(this.data),f=[],b=o.startAngle;this.svg=t.createSvg(this.container,o.width,o.height,o.donut?o.classNames.chartDonut:o.classNames.chartPie),c=t.createChartRect(this.svg,o,r.padding),v=Math.min(c.width()/2,c.height()/2),A=o.total||u.normalized.series.reduce(function(P,T){return P+T},0);var M=t.quantity(o.donutWidth);"%"===M.unit&&(M.value*=v/100),v-=o.donut&&!o.donutSolid?M.value/2:0,y="outside"===o.labelPosition||o.donut&&!o.donutSolid?v:"center"===o.labelPosition?0:o.donutSolid?v-M.value/2:v/2,y+=o.labelOffset;var q={x:c.x1+c.width()/2,y:c.y2+c.height()/2},Q=1===u.raw.series.filter(function(P){return P.hasOwnProperty("value")?0!==P.value:0!==P}).length;u.raw.series.forEach(function(P,T){f[T]=this.svg.elem("g",null,null)}.bind(this)),o.showLabel&&(p=this.svg.elem("g",null,null)),u.raw.series.forEach(function(P,T){if(0!==u.normalized.series[T]||!o.ignoreEmptyValues){f[T].attr({"ct:series-name":P.name}),f[T].addClass([o.classNames.series,P.className||o.classNames.series+"-"+t.alphaNumerate(T)].join(" "));var O=A>0?b+u.normalized.series[T]/A*360:0,R=Math.max(0,b-(0===T||Q?0:.2));O-R>=359.99&&(O=R+359.99);var _,Z,S,N=t.polarToCartesian(q.x,q.y,v,R),j=t.polarToCartesian(q.x,q.y,v,O),k=new t.Svg.Path(!o.donut||o.donutSolid).move(j.x,j.y).arc(v,v,0,O-b>180,0,N.x,N.y);o.donut?o.donutSolid&&(_=t.polarToCartesian(q.x,q.y,S=v-M.value,b-(0===T||Q?0:.2)),Z=t.polarToCartesian(q.x,q.y,S,O),k.line(_.x,_.y),k.arc(S,S,0,O-b>180,1,Z.x,Z.y)):k.line(q.x,q.y);var Y=o.classNames.slicePie;o.donut&&(Y=o.classNames.sliceDonut,o.donutSolid&&(Y=o.classNames.sliceDonutSolid));var X=f[T].elem("path",{d:k.stringify()},Y);if(X.attr({"ct:value":u.normalized.series[T],"ct:meta":t.serialize(P.meta)}),o.donut&&!o.donutSolid&&(X._node.style.strokeWidth=M.value+"px"),this.eventEmitter.emit("draw",{type:"slice",value:u.normalized.series[T],totalDataSum:A,index:T,meta:P.meta,series:P,group:f[T],element:X,path:k.clone(),center:q,radius:v,startAngle:b,endAngle:O}),o.showLabel){var L,I;L=1===u.raw.series.length?{x:q.x,y:q.y}:t.polarToCartesian(q.x,q.y,y,b+(O-b)/2),I=u.normalized.labels&&!t.isFalseyButZero(u.normalized.labels[T])?u.normalized.labels[T]:u.normalized.series[T];var H=o.labelInterpolationFnc(I,T);if(H||0===H){var $=p.elem("text",{dx:L.x,dy:L.y,"text-anchor":l(q,L,o.labelDirection)},o.classNames.label).text(""+H);this.eventEmitter.emit("draw",{type:"label",index:T,group:p,element:$,text:""+H,x:L.x,y:L.y})}}b=O}}.bind(this)),this.eventEmitter.emit("created",{chartRect:c,svg:this.svg,options:o})},determineAnchorPosition:l})}(this||global,F),F}()}.apply(ae,[]),void 0!==B&&(_e.exports=B)}}]);
//# sourceMappingURL=apps_concierge_src_app_reports_reports_module_ts.js.map