(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_reports_reports_module_ts"],{8141:(Ue,fe,L)=>{"use strict";L.r(fe),L.d(fe,{ReportsModule:()=>fn});var B=L(4666),F=L(2508),P=L(9885),t=L(3045),S=L(6060),e=L(2560),i=L(4945),l=L(9112),d=L(207),s=L(5306);const r=function(){return["/reports","desks"]};function c(n,m){1&n&&(e.TgZ(0,"a",1)(1,"app-icon",2),e._uU(2,"room"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Desks"),e.qZA(),e.TgZ(5,"div",4)(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA()()()),2&n&&e.Q6J("routerLink",e.DdM(1,r))}const f=function(){return["/reports","spaces"]};function p(n,m){1&n&&(e.TgZ(0,"a",1)(1,"app-icon",2),e._uU(2,"meeting_room"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Rooms"),e.qZA(),e.TgZ(5,"div",4)(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA()()()),2&n&&e.Q6J("routerLink",e.DdM(1,f))}const u=function(){return["/reports","catering"]};function _(n,m){1&n&&(e.TgZ(0,"a",1)(1,"app-icon",2),e._uU(2,"room_service"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Catering"),e.qZA(),e.TgZ(5,"div",4)(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA()()()),2&n&&e.Q6J("routerLink",e.DdM(1,u))}const x=function(){return["/reports","contact-tracing"]};function w(n,m){1&n&&(e.TgZ(0,"a",1)(1,"app-icon",2),e._uU(2,"connect_without_contact"),e.qZA(),e.TgZ(3,"h3",3),e._uU(4,"Contact Tracing"),e.qZA(),e.TgZ(5,"div",4)(6,"p"),e._uU(7,"View Report"),e.qZA(),e.TgZ(8,"app-icon",5),e._uU(9,"chevron_right"),e.qZA()()()),2&n&&e.Q6J("routerLink",e.DdM(1,x))}const A=["desks","spaces","catering","contact-tracing"];let O=(()=>{class n{constructor(o){this._settings=o}get features(){return this._settings.get("app.reports.features")||A}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(l.gb))},n.\u0275cmp=e.Xpm({type:n,selectors:[["reports-menu"],["","reports-menu",""]],decls:4,vars:4,consts:[["matRipple","","class","h-64 w-64 m-4 p-4 flex flex-col items-center justify-center bg-white dark:bg-neutral-700 rounded shadow hover:opacity-80",3,"routerLink",4,"ngIf"],["matRipple","",1,"h-64","w-64","m-4","p-4","flex","flex-col","items-center","justify-center","bg-white","dark:bg-neutral-700","rounded","shadow","hover:opacity-80",3,"routerLink"],[1,"text-8xl"],[1,"text-xl","font-bold","mb-4"],[1,"flex","items-center"],[1,"ml-2"]],template:function(o,a){1&o&&(e.YNc(0,c,10,2,"a",0),e.YNc(1,p,10,2,"a",0),e.YNc(2,_,10,2,"a",0),e.YNc(3,w,10,2,"a",0)),2&o&&(e.Q6J("ngIf",a.features.includes("desks")),e.xp6(1),e.Q6J("ngIf",a.features.includes("spaces")),e.xp6(1),e.Q6J("ngIf",a.features.includes("catering")),e.xp6(1),e.Q6J("ngIf",a.features.includes("contact-tracing")))},dependencies:[B.O5,d.wG,s.o,P.yS],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row!important;align-items:center;justify-content:center;background:inherit}\n/*# sourceMappingURL=reports-menu.component.ts-angular-inline--98.css.map*/"]}),n})();const k=["app-reports",""];function X(n,m){1&n&&e._UZ(0,"div",3)}let j=(()=>{class n{constructor(o){this._router=o}get path(){const o=this._router.url.split("/");return o[o.length-1]}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(P.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["","app-reports",""]],attrs:k,decls:4,vars:1,consts:[[1,"h-full"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full","bg-gray-300","dark:bg-neutral-600"],["reports-menu","","class","absolute inset-0",4,"ngIf"],["reports-menu","",1,"absolute","inset-0"]],template:function(o,a){1&o&&(e._UZ(0,"sidebar",0),e.TgZ(1,"main",1),e._UZ(2,"router-outlet"),e.YNc(3,X,1,0,"div",2),e.qZA()),2&o&&(e.xp6(3),e.Q6J("ngIf","reports"===a.path))},dependencies:[B.O5,i.k,P.lC,O],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%}main[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(router-outlet){display:flex;flex-direction:column;width:100%;height:100%}\n/*# sourceMappingURL=reports.component.ts-angular-inline--95.css.map*/"]}),n})();var Z=L(8215),M=L(711),T=L(1670),N=L(5670),z=L(6221),v=L(3690),b=L(9232),U=L(9830),E=L(9377),Y=L(3200),C=L(475),I=L(312),J=L(8325),V=L(6610),H=L(1170);function ue(n,m){(0,H.Z)(2,arguments);var o=(0,E.Z)(n),a=(0,E.Z)(m),g=o.getTime()-(0,V.Z)(o),h=a.getTime()-(0,V.Z)(a);return Math.round((g-h)/864e5)}function de(n,m){var o=n.getFullYear()-m.getFullYear()||n.getMonth()-m.getMonth()||n.getDate()-m.getDate()||n.getHours()-m.getHours()||n.getMinutes()-m.getMinutes()||n.getSeconds()-m.getSeconds()||n.getMilliseconds()-m.getMilliseconds();return o<0?-1:o>0?1:o}function be(n,m){(0,H.Z)(2,arguments);var o=(0,J.Z)(n),a=(0,J.Z)(m),g=de(o,a),h=Math.abs(ue(o,a));o.setDate(o.getDate()-g*h);var y=Number(de(o,a)===-g),R=g*(h-y);return 0===R?0:R}var De=L(2317),oe=L(5148),Pe=L(2218),ce=L(4505),re=L(4139),se=L(7716),ge=L(823),Ae=L(9095),he=L(7418),Q=L(6942),ne=L(9128);let W=(()=>{class n{constructor(o){this._org=o,this._generate=new Pe.xQ,this._loading=new ce.X(""),this._active_bookings=new ce.X([]),this._options=new ce.X({start:new Date,end:new Date}),this._bookings_list=this._generate.pipe((0,ge.b)(500),(0,Ae.w)(a=>{const g=this._options.getValue();if(this._loading.next("Loading report details..."),!g?.type&&!g?.zones?.length)return(0,re.of)([]);const h=(0,E.Z)(g?.start?new Date(g.start):new Date).valueOf(),y=(0,Y.Z)(g?.end?new Date(g.end):h).valueOf(),R=g?.zones?g.zones.filter(D=>"All"!==D).join(","):"",q={period_start:Math.floor(h/1e3),period_end:Math.floor(y/1e3)};return"desks"===g.type?(0,b.F2)({...q,zones:R,type:"desk"}):(0,U.u$)({...q,zone_ids:R})}),(0,he.K)(a=>[]),(0,Q.U)(a=>(this._loading.next(""),a?.length||(0,l.cB)("No bookings for the selected levels and period"),this._active_bookings.next(a||[]),a)),(0,ne.d)()),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.bookings=this._active_bookings.asObservable(),this.counts=this._options.pipe((0,ge.b)(500),(0,Ae.w)(a=>{const g=(a.zones||[]).filter(h=>-1!==h&&"All"!==h);return Promise.all(g.map(h=>(0,v.rlq)(h,"desks").pipe((0,Q.U)(y=>[h,y.details.length])).toPromise()))}),(0,he.K)(a=>[]),(0,Q.U)(a=>{const g={};return this._active_bookings.next([]),a.forEach(([h,y])=>g[h]=y),g}),(0,ne.d)()),this.stats=(0,se.aj)([this.counts,this.bookings]).pipe((0,Q.U)(([a,g])=>g[0]instanceof U.ym?function je(n,m=8){const o=n.reduce((y,R)=>y+R.attendees.length,0),a=n.reduce((y,R)=>y+R.system?.capacity,0),g=Math.floor(n.reduce((y,R)=>y+R.duration,0)/(60*m)*100)/100,h=Math.floor(o/a*100)/100;return{count:n.length,avg_length:Math.floor(n.reduce((y,R)=>y+R.duration,0)/n.length*100)/100,efficiency:Math.floor((g+h)/2*100)/100,total_users:o,total_capacity:a,occupancy:h,utilisation:g,events:n}}(g,8*this.duration):function Ie(n,m=1,o={}){m=Math.max(1,m);const a=Object.keys(o).reduce((h,y)=>h+(o[y]||0),0),g=Math.floor(n.length/a/m*1e4)/1e4;return{total:a,count:n.length,utilisation:g,events:n}}(g||[],this.duration,a))),this.day_list=(0,se.aj)([this.options,this.stats]).pipe((0,Q.U)(([a,g])=>{const{start:h}=a;let y=(0,E.Z)(h);const R=(0,Y.Z)(a.end||y),q=[];for(;(0,C.Z)(y,R);){const D=(0,E.Z)(y).valueOf(),te=(0,Y.Z)(D).valueOf(),G=g.events.filter($=>(0,l.MZ)(D,te,$.date,$.date+60*$.duration*1e3));q.push({date:D,total:g.total,free:g.total-G.length,approved:G.reduce(($,K)=>$+(K.approved?1:0),0),count:G.length,utilisation:(G.length/g.total*100).toFixed(1)}),y=(0,I.Z)(y,1)}return q}),(0,ne.d)(1)),this._bookings_list.subscribe(a=>a)}get duration(){const o=this._options.getValue();return Math.abs(be((0,E.Z)(o.start),(0,De.Z)((0,Y.Z)(o.end),1)))}generateReport(){this._generate.next((new Date).valueOf())}setOptions(o){o.zones?.includes("All")?o.zones=["All",...this._org.levelsForBuilding(this._org.building).map(a=>a.id)]:o.zones&&this._options.getValue()?.zones?.includes("All")&&(o.zones=[]),o.start?.valueOf()!==this._options.getValue().start?.valueOf()&&o.end?.valueOf()!==this._options.getValue().end?.valueOf()&&this._options.next({...this._options.getValue(),...o})}downloadReport(){const o=this._options.getValue(),a=this._active_bookings.getValue();(0,l.Sv)(`report+${o.type}+${(0,oe.Z)(o.start,"yyyy-MM-dd")}+${(0,oe.Z)(o.end,"yyyy-MM-dd")}.csv`,(0,l.o3)(a.map(g=>{const h=g.toJSON();return delete h.zones,delete h.server_names,delete h.extension_data,h})))}}return n.\u0275fac=function(o){return new(o||n)(e.LFG(z.w7))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ie=L(4522),_e=L(5074),Ye=L(7371),ee=L(2298),ve=L(1708);function Be(n,m){if(1&n&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&n){const o=m.$implicit;e.Q6J("value",o.id),e.xp6(1),e.hij(" ",o.display_name||o.name," ")}}function qe(n,m){1&n&&e._UZ(0,"mat-spinner",15),2&n&&e.Q6J("diameter",32)}function Je(n,m){1&n&&(e.TgZ(0,"p"),e._uU(1,"Generate Report"),e.qZA())}let ye=(()=>{class n extends l.KG{constructor(o,a,g,h){super(),this._state=o,this._org=a,this._route=g,this._router=h,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(y=>`${y.id}`),this.levels=this._org.active_levels,this.loading=this._state.loading,this.bookings=this._state.bookings,this.options=this._state.options,this.page="",this.generateReport=()=>this._state.generateReport(),this.downloadReport=()=>this._state.downloadReport(),this.setStartDate=y=>this._state.setOptions({start:new Date(y)}),this.setEndDate=y=>this._state.setOptions({end:new Date(y)}),this.setZones=y=>this._state.setOptions({zones:y})}ngOnInit(){var o=this;return(0,T.Z)(function*(){yield o._org.initialised.pipe((0,N.P)(a=>a)).toPromise(),o.page=o._router.url,o.subscription("routing",o._router.events.subscribe(()=>{o.page=o._router.url})),o.subscription("route.query",o._route.queryParamMap.subscribe(a=>{if(a.has("zone_ids")){const g=a.get("zone_ids").split(",");if(g.length){const h=o._org.levelWithID(g);if(!h)return;o._org.building=o._org.buildings.find(y=>y.id===h.parent_id),o.setZones(g)}}}))})()}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W),e.Y36(z.w7),e.Y36(P.gz),e.Y36(P.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["reports-options"]],features:[e.qOj],decls:28,vars:28,consts:[[1,"bg-white","dark:bg-neutral-700","h-20","w-full","flex","items-center","px-2"],["appearance","outline",1,"w-48"],["multiple","","placeholder","Select Levels...",3,"ngModel","ngModelChange"],["value","All"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"w-64"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["mat-button","",1,"ml-4",3,"disabled","click"],[3,"diameter",4,"ngIf"],[4,"ngIf"],[3,"value"],[3,"diameter"]],template:function(o,a){if(1&o&&(e.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-select",2),e.NdJ("ngModelChange",function(h){return a.setZones(h)}),e.ALo(3,"async"),e.TgZ(4,"mat-option",3),e._uU(5,"All Levels"),e.qZA(),e.YNc(6,Be,2,2,"mat-option",4),e.ALo(7,"async"),e.qZA()(),e.TgZ(8,"mat-form-field",5)(9,"mat-date-range-input",6)(10,"input",7),e.NdJ("ngModelChange",function(h){return h?a.setStartDate(h):""}),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"input",8),e.NdJ("ngModelChange",function(h){return h?a.setEndDate(h):""}),e.ALo(13,"async"),e.qZA()(),e._UZ(14,"mat-datepicker-toggle",9)(15,"mat-date-range-picker",null,10),e.qZA(),e.TgZ(17,"button",11),e.NdJ("click",function(){return a.generateReport()}),e.ALo(18,"async"),e.ALo(19,"async"),e.YNc(20,qe,1,1,"mat-spinner",12),e.ALo(21,"async"),e.YNc(22,Je,2,0,"p",13),e.ALo(23,"async"),e.qZA(),e.TgZ(24,"button",11),e.NdJ("click",function(){return a.downloadReport()}),e.ALo(25,"async"),e.TgZ(26,"p"),e._uU(27,"Download Report"),e.qZA()()()),2&o){const g=e.MAs(16);let h,y,R,q,D;e.xp6(2),e.Q6J("ngModel",null==(h=e.lcZ(3,10,a.options))?null:h.zones),e.xp6(4),e.Q6J("ngForOf",e.lcZ(7,12,a.levels)),e.xp6(3),e.Q6J("rangePicker",g),e.xp6(1),e.Q6J("ngModel",null==(y=e.lcZ(11,14,a.options))?null:y.start),e.xp6(2),e.Q6J("ngModel",null==(R=e.lcZ(13,16,a.options))?null:R.end),e.xp6(2),e.Q6J("for",g),e.xp6(3),e.Q6J("disabled",!!e.lcZ(18,18,a.loading)||!(null!=(q=e.lcZ(19,20,a.options))&&null!=q.zones&&q.zones.length)),e.xp6(3),e.Q6J("ngIf",e.lcZ(21,22,a.loading)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(23,24,a.loading)),e.xp6(2),e.Q6J("disabled",!(null!=(D=e.lcZ(25,26,a.bookings))&&D.length))}},dependencies:[B.sg,B.O5,F.Fj,F.JJ,F.On,ie.lW,_e.KE,_e.R9,Ye.gD,d.ey,ee.nW,ee.wx,ee.zY,ee.By,ee._g,ve.Ou,B.Ov],styles:["button[_ngcontent-%COMP%]{min-width:0;padding:0 .85rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;margin-left:1em}mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:5.5em;white-space:initial;line-height:1.2em}\n/*# sourceMappingURL=reports-options.component.ts-angular-inline--96.css.map*/"]}),n})();var Le=L(1799);let Fe=(()=>{class n{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,Q.U)(a=>a.count||0)),this.avg_length=this._state.stats.pipe((0,Q.U)(a=>(0,Le.Z)({minutes:a.avg_length||0}))),this.efficiency=this._state.stats.pipe((0,Q.U)(a=>(100*(a.efficiency||0)).toFixed(1))),this.total_users=this._state.stats.pipe((0,Q.U)(a=>a.total_users||0)),this.total_capacity=this._state.stats.pipe((0,Q.U)(a=>a.total_capacity||0)),this.occupancy=this._state.stats.pipe((0,Q.U)(a=>(100*(a.occupancy||0)).toFixed(1))),this.utilisation=this._state.stats.pipe((0,Q.U)(a=>(100*(a.utilisation||0)).toFixed(1)))}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W))},n.\u0275cmp=e.Xpm({type:n,selectors:[["report-spaces-overall"]],decls:44,vars:21,consts:[[1,"m-4","p-4","rounded","bg-white","dark:bg-neutral-700","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"flex-1","flex","flex-col","items-center","justify-center"]],template:function(o,a){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3"),e._uU(3,"Total Bookings"),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"div",1)(8,"h3"),e._uU(9,"Average Bookings Length"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.ALo(12,"async"),e.qZA()()(),e.TgZ(13,"div",0)(14,"div",2)(15,"h3"),e._uU(16,"Overall Efficiency"),e.qZA(),e.TgZ(17,"p"),e._uU(18),e.ALo(19,"async"),e.qZA()(),e.TgZ(20,"div",2)(21,"h3"),e._uU(22,"Occupancy"),e.qZA(),e.TgZ(23,"p"),e._uU(24),e.ALo(25,"async"),e.qZA()(),e.TgZ(26,"div",2)(27,"h3"),e._uU(28,"Total Attendees"),e.qZA(),e.TgZ(29,"p"),e._uU(30),e.ALo(31,"async"),e.qZA()(),e.TgZ(32,"div",2)(33,"h3"),e._uU(34,"Total Capacity"),e.qZA(),e.TgZ(35,"p"),e._uU(36),e.ALo(37,"async"),e.qZA()(),e.TgZ(38,"div",2)(39,"h3"),e._uU(40,"Utilisation"),e.qZA(),e.TgZ(41,"p"),e._uU(42),e.ALo(43,"async"),e.qZA()()()),2&o&&(e.xp6(5),e.Oqu(e.lcZ(6,7,a.total_count)||0),e.xp6(6),e.Oqu(e.lcZ(12,9,a.avg_length)||"None"),e.xp6(7),e.hij("",e.lcZ(19,11,a.efficiency)||0,"%"),e.xp6(6),e.hij("",e.lcZ(25,13,a.occupancy)||0,"%"),e.xp6(6),e.Oqu(e.lcZ(31,15,a.total_users)||0),e.xp6(6),e.Oqu(e.lcZ(37,17,a.total_capacity)||0),e.xp6(6),e.hij("",e.lcZ(43,19,a.utilisation)||0,"%"))},dependencies:[B.Ov],styles:["h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n/*# sourceMappingURL=report-spaces-overall.component.ts-angular-inline--99.css.map*/"]}),n})();var ae=L(3910),le=L(1110);const Qe=function(){return["name","capacity","count","utilisation","avg_attendees","occupancy"]},Ge=function(){return["Name","Capacity","Meeting Count","Utilisation","Avg. Attendees","Occupancy"]},Xe=function(){return["flex"]};let Ce=(()=>{class n{constructor(o){var a=this;this._reports=o,this.space_list=(0,se.aj)([this._reports.stats,this._reports.options]).pipe((0,ge.b)(300),(0,Q.U)(([g,{start:h,end:y}])=>{let R=[];for(const D of g.events){const te=D.resources||[];for(const G of te){R.find(K=>K.id===G.id||K.id?.toLowerCase()===G.email.toLowerCase())||R.push({id:G.id||G.email,name:G.display_name||G.name,capacity:G.capacity||1,count:0,attendees:0,avg_attendees:0,usage:0,utilisation:0,occupancy:0});const $=R.find(K=>K.id===G.id||K.id?.toLowerCase()===G.email.toLowerCase());$.count+=1,$.usage+=D.duration,$.attendees+=D.attendees.length}}const q=be(y,h);for(const D of R)D.avg_attendees=Math.floor(D.attendees/D.count*100)/100,D.utilisation=Math.floor(D.usage/60/8/q*100)/100,D.occupancy=Math.floor(D.avg_attendees/D.capacity*100)/100;return R})),this.download=(0,T.Z)(function*(){const g=yield a.space_list.pipe((0,ae.q)(1)).toPromise();(0,l.Sv)("report-spaces-usage.csv",(0,l.o3)(g))})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W))},n.\u0275cmp=e.Xpm({type:n,selectors:[["report-spaces-space-listing"]],decls:8,vars:8,consts:[[1,"m-4","rounded","bg-white","dark:bg-neutral-700","shadow","overflow-hidden"],[1,"border-b","border-gray-300","dark:border-neutral-500","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],[3,"dataSource","pagination","columns","display_column","column_size"]],template:function(o,a){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3,"Space Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()()(),e._UZ(7,"custom-table",4),e.qZA()),2&o&&(e.xp6(7),e.Q6J("dataSource",a.space_list)("pagination",!0)("columns",e.DdM(5,Qe))("display_column",e.DdM(6,Ge))("column_size",e.DdM(7,Xe)))},dependencies:[ie.lW,s.o,le.C]}),n})();const Ve=function(){return["name","capacity","count","avg_attendees","occupancy"]},He=function(){return["Name","Capacity","Meeting Count","Avg. Attendees","Occupancy"]},We=function(){return["flex"]};let $e=(()=>{class n{constructor(o){var a=this;this._reports=o,this.user_list=(0,se.aj)([this._reports.stats]).pipe((0,ge.b)(300),(0,Q.U)(([g])=>{let h=[];for(const y of g.events){const R=y.attendees||[],q=Math.max(y.resources.reduce((D,te)=>D+te.capacity,0)||1,1);for(const D of R){h.find(G=>G.id?.toLowerCase()===D.email.toLowerCase())||h.push({id:D.email,name:D.name,capacity:q,count:0,attendees:0,avg_attendees:0,occupancy:0});const te=h.find(G=>G?.id===D.email);te.count+=1,te.attendees+=y.attendees.length}}for(const y of h)y.avg_attendees=Math.floor(y.attendees/y.count*100)/100,y.occupancy=Math.floor(y.avg_attendees/y.capacity*100)/100;return h}),(0,ne.d)(1)),this.download=(0,T.Z)(function*(){const g=yield a.user_list.pipe((0,ae.q)(1)).toPromise();(0,l.Sv)("report-space-attendee-usage.csv",(0,l.o3)(g))})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W))},n.\u0275cmp=e.Xpm({type:n,selectors:[["report-spaces-user-listing"]],decls:8,vars:8,consts:[[1,"m-4","rounded","bg-white","dark:bg-neutral-700","shadow","overflow-hidden"],[1,"border-b","border-gray-300","dark:border-neutral-500","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],[3,"dataSource","pagination","columns","display_column","column_size"]],template:function(o,a){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3,"Staff Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()()(),e._UZ(7,"custom-table",4),e.qZA()),2&o&&(e.xp6(7),e.Q6J("dataSource",a.user_list)("pagination",!0)("columns",e.DdM(5,Ve))("display_column",e.DdM(6,He))("column_size",e.DdM(7,We)))},dependencies:[ie.lW,s.o,le.C]}),n})();const Ke=["report-spaces",""];function et(n,m){1&n&&(e.ynx(0),e._UZ(1,"report-spaces-overall")(2,"report-spaces-space-listing")(3,"report-spaces-user-listing"),e.BQk())}function tt(n,m){if(1&n&&(e.ynx(0),e.YNc(1,et,4,0,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&n){const o=e.oxw(),a=e.MAs(7);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,o.total_count))("ngIfElse",a)}}function nt(n,m){1&n&&(e.TgZ(0,"div",4),e._UZ(1,"mat-spinner",5),e.TgZ(2,"p",6),e._uU(3,"Loading report data..."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("diameter",32))}function st(n,m){1&n&&(e.TgZ(0,"div",4)(1,"p",6),e._uU(2," Select levels and time period to generate a report. "),e.qZA()())}let ot=(()=>{class n{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,Q.U)(a=>a.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W))},n.\u0275cmp=e.Xpm({type:n,selectors:[["","report-spaces",""]],attrs:Ke,decls:8,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(o,a){if(1&o&&(e._UZ(0,"reports-options"),e.TgZ(1,"div",0),e.YNc(2,tt,3,4,"ng-container",1),e.ALo(3,"async"),e.qZA(),e.YNc(4,nt,4,1,"ng-template",null,2,e.W1O),e.YNc(6,st,3,0,"ng-template",null,3,e.W1O)),2&o){const g=e.MAs(5);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,a.loading))("ngIfElse",g)}},dependencies:[B.O5,ve.Ou,ye,Fe,Ce,$e,B.Ov]}),n})();function rt(n,m){1&n&&(e._uU(0),e.ALo(1,"date")),2&n&&e.hij(" ",e.xi3(1,1,m.data,"mediumDate")," ")}function it(n,m){1&n&&e._uU(0),2&n&&e.hij(" ",m.data||"0","% ")}const at=function(){return["date","usage","approved","count","utilisation"]},lt=function(){return["Date","Used Desks","Approved Bookings","Total Requests","Utilisation"]},ct=function(){return["flex"]},ut=function(n,m,o){return{date:n,usage:m,utilisation:o}};let dt=(()=>{class n{constructor(o){var a=this;this._state=o,this.day_list=this._state.day_list,this.download=(0,T.Z)(function*(){let g=yield a.day_list.pipe((0,ae.q)(1)).toPromise();g=g.map(h=>({...h,date:(0,oe.Z)(h.date,"MMMM d, y(EEE)")})),(0,l.Sv)("desks-usage.csv",(0,l.o3)(g))})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W))},n.\u0275cmp=e.Xpm({type:n,selectors:[["report-desks-overall-list"]],decls:12,vars:13,consts:[[1,"m-4","rounded","bg-white","dark:bg-neutral-700","shadow","overflow-hidden"],[1,"border-b","border-gray-300","dark:border-neutral-500","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["date_view",""],["percent_view",""]],template:function(o,a){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3,"Daily Utilisation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()()(),e._UZ(7,"custom-table",4),e.YNc(8,rt,2,4,"ng-template",null,5,e.W1O),e.YNc(10,it,1,1,"ng-template",null,6,e.W1O),e.qZA()),2&o){const g=e.MAs(9),h=e.MAs(11);e.xp6(7),e.Q6J("dataSource",a.day_list)("pagination",!0)("columns",e.DdM(6,at))("display_column",e.DdM(7,lt))("column_size",e.DdM(8,ct))("template",e.kEZ(9,ut,g,h,h))}},dependencies:[ie.lW,s.o,le.C,B.uU],encapsulation:2}),n})();function pt(n,m){1&n&&e._uU(0),2&n&&e.hij(" ",m.data||"0","% ")}const ft=function(){return["name","avg_usage","approved","count","utilisation"]},mt=function(){return["Level","Avg. Used Desks","Approved Bookings","Total Requests","Utilisation"]},gt=function(){return["flex"]},ht=function(n){return{utilisation:n}};let _t=(()=>{class n{constructor(o,a){var g=this;this._state=o,this._org=a,this.level_list=(0,se.aj)([this._state.options,this._state.stats,this._state.counts]).pipe((0,Q.U)(([h,y,R])=>{const{start:q,end:D,zones:te}=h,G=be(D,q)||1,$=[];for(const K of te){if("All"===K)continue;const Ne=this._org.levelWithID([K]),Te=R[K]||0,pe=y.events.filter(Se=>Se.zones.includes(K));let we=(Te*G-pe.length)/G;we%1!=0&&(we=we.toFixed(2)),$.push({name:Ne?.display_name||Ne?.name,free:we,approved:pe.filter(Se=>Se.approved).length||0,avg_usage:pe.length/G,total:Te,count:pe.length,utilisation:(pe.length/((Te||1)*G)*100||0).toFixed(2)})}return $}),(0,ne.d)(1)),this.download=(0,T.Z)(function*(){let h=yield g.level_list.pipe((0,ae.q)(1)).toPromise();(0,l.Sv)("desks-levels-usage.csv",(0,l.o3)(h))})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W),e.Y36(z.w7))},n.\u0275cmp=e.Xpm({type:n,selectors:[["report-desks-levels-list"]],decls:11,vars:11,consts:[[1,"px-4","mb-4","w-full"],[1,"rounded","bg-white","dark:bg-neutral-700","shadow","overflow-hidden","w-full"],[1,"border-b","border-gray-300","dark:border-neutral-500","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["red-header","",3,"dataSource","pagination","columns","display_column","column_size","template"],["percent_view",""]],template:function(o,a){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),e._uU(4,"Level Utilisation"),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return a.download()}),e.TgZ(6,"app-icon"),e._uU(7,"download"),e.qZA()()(),e._UZ(8,"custom-table",5),e.YNc(9,pt,1,1,"ng-template",null,6,e.W1O),e.qZA()()),2&o){const g=e.MAs(10);e.xp6(8),e.Q6J("dataSource",a.level_list)("pagination",!0)("columns",e.DdM(6,ft))("display_column",e.DdM(7,mt))("column_size",e.DdM(8,gt))("template",e.VKq(9,ht,g))}},dependencies:[ie.lW,s.o,le.C],encapsulation:2}),n})();var Re=L(7103);let vt=(()=>{class n extends l.KG{constructor(o,a){super(),this._state=o,this._org=a,this.day_list=this._state.day_list,this.stats=(0,se.aj)([this._state.options,this._state.counts])}ngOnInit(){this.subscription("day_list",this.day_list.subscribe(o=>this.updateDailyChart(o))),this.subscription("stats",this.stats.subscribe(([o,a])=>this.updateLevelChart(o,a)))}updateDailyChart(o){const a={labels:o.map(g=>(0,oe.Z)(g.date,"dd MMM")),series:[o.map(g=>g.utilisation)]};this._day_chart=new Re.Line("#day-chart",a)}updateLevelChart(o,a){let{zones:g}=o||{};g.includes("All")&&(g=this._org.levels.filter(y=>y.parent_id===this._org.building.id).map(y=>y.id));const h={labels:(g||[]).map(y=>{const R=this._org.levelWithID([y]);return R?.display_name||R.name||""}),series:(g||[]).map(y=>a[y])};this._level_chart=new Re.Pie("#level-chart",h)}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W),e.Y36(z.w7))},n.\u0275cmp=e.Xpm({type:n,selectors:[["report-desks-charts"]],features:[e.qOj],decls:11,vars:0,consts:[[1,"flex","items-center","space-x-4","w-full","px-4"],[1,"bg-white","dark:bg-neutral-700","rounded","shadow","flex-1"],[1,"border-b","border-gray-300","dark:border-neutral-500","p-4","text-xl","font-bold"],["id","day-chart",1,"ct-chart","ct-octave"],["util_chart",""],["id","level-chart",1,"ct-chart","ct-octave"],["level_chart",""]],template:function(o,a){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3," Daily Utilisation "),e.qZA(),e._UZ(4,"div",3,4),e.qZA(),e.TgZ(6,"div",1)(7,"div",2),e._uU(8," Level Utilisation "),e.qZA(),e._UZ(9,"div",5,6),e.qZA()())},styles:["[_nghost-%COMP%]{display:block}\n/*# sourceMappingURL=report-desks-charts.component.ts-angular-inline--112.css.map*/"]}),n})();const yt=["report-desks",""];function xt(n,m){if(1&n&&(e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"h3"),e._uU(4,"Total Bookings"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.ALo(7,"async"),e.qZA()(),e.TgZ(8,"div",5)(9,"h3"),e._uU(10,"Utilisation"),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.ALo(13,"async"),e.qZA()()(),e._UZ(14,"report-desks-charts")(15,"report-desks-overall-list")(16,"report-desks-levels-list"),e.BQk()),2&n){const o=e.oxw(2);e.xp6(6),e.Oqu(e.lcZ(7,2,o.total_count)||0),e.xp6(6),e.hij("",e.lcZ(13,4,o.utilisation)||0,"%")}}function wt(n,m){if(1&n&&(e.ynx(0),e.YNc(1,xt,17,6,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&n){const o=e.oxw(),a=e.MAs(7);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,o.total_count))("ngIfElse",a)}}function bt(n,m){1&n&&(e.TgZ(0,"div",6),e._UZ(1,"mat-spinner",7),e.TgZ(2,"p",8),e._uU(3,"Loading report data..."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("diameter",32))}function At(n,m){1&n&&(e.TgZ(0,"div",6)(1,"p",8),e._uU(2," Select levels and time period to generate a report. "),e.qZA()())}let Zt=(()=>{class n{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,Q.U)(a=>a.count||0)),this.utilisation=this._state.stats.pipe((0,Q.U)(a=>(100*(a.utilisation||0)).toFixed(1))),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"desks"})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W))},n.\u0275cmp=e.Xpm({type:n,selectors:[["","report-desks",""]],attrs:yt,decls:8,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(o,a){if(1&o&&(e._UZ(0,"reports-options"),e.TgZ(1,"div",0),e.YNc(2,wt,3,4,"ng-container",1),e.ALo(3,"async"),e.YNc(4,bt,4,1,"ng-template",null,2,e.W1O),e.YNc(6,At,3,0,"ng-template",null,3,e.W1O),e.qZA()),2&o){const g=e.MAs(5);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,a.loading))("ngIfElse",g)}},dependencies:[B.O5,ve.Ou,ye,dt,_t,vt,B.Ov],styles:["h3[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]:not([simple]){font-size:1.75rem}\n/*# sourceMappingURL=report-desks.component.ts-angular-inline--97.css.map*/"]}),n})();var Ee=L(9364);let Ze=(()=>{class n{constructor(o){this._reports=o,this.catering_orders=this._reports.bookings.pipe((0,Q.U)(a=>(0,l.xH)(a.filter(h=>h.extension_data?.catering?.length).map(h=>h.extension_data?.catering.map(y=>new Ee.GX({...y,deliver_at:h.date,event:h})))).filter(h=>h).sort((h,y)=>h.event?.date-y.event?.date)),(0,ne.d)(1)),this.catering_items=this.catering_orders.pipe((0,Q.U)(a=>{const g=[];for(const h of a)for(const y of h?.items||[]){const R=g.findIndex(q=>y.options_string===q.options_string);R>=0?y[R]=new Ee.Ud({...y,quantity:y?.quantity+y[R]?.quantity}):g.push(y)}return g.sort((h,y)=>y.quantity-h.quantity)})),this.stats=(0,se.aj)([this.catering_orders,this.catering_items]).pipe((0,Q.U)(([a,g])=>{const h=a.reduce((y,R)=>y+R.total_cost,0);return{order_count:a.length,unique_items:g.length,item_count:a.reduce((y,R)=>y+R.item_count,0),total_cost:h,avg_cost:h/a.length}}))}downloadOrders(){var o=this;return(0,T.Z)(function*(){const a=yield o.catering_orders.pipe((0,ae.q)(1)).toPromise(),g=(0,l.o3)(a);return(0,l.Sv)("catering-orders.csv",g)})()}}return n.\u0275fac=function(o){return new(o||n)(e.LFG(W))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Mt=(()=>{class n{constructor(o,a){this._report=o,this._org=a,this.stats=this._report.stats}get code(){return this._org.currency_code}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(Ze),e.Y36(z.w7))},n.\u0275cmp=e.Xpm({type:n,selectors:[["catering-report-overall"]],decls:32,vars:21,consts:[[1,"bg-white","dark:bg-neutral-700","shadow","rounded","m-2","px-8","w-48","h-24","flex","flex-col","items-center","justify-center"],["count","",1,"text-3xl"],[1,""],["unique","",1,"text-3xl"],["items","",1,"text-3xl"],["total","",1,"text-3xl"],["average","",1,"text-3xl"]],template:function(o,a){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"div",2),e._uU(5,"Orders"),e.qZA()(),e.TgZ(6,"div",0)(7,"div",3),e._uU(8),e.ALo(9,"async"),e.qZA(),e.TgZ(10,"div",2),e._uU(11,"Unique Items"),e.qZA()(),e.TgZ(12,"div",0)(13,"div",4),e._uU(14),e.ALo(15,"async"),e.qZA(),e.TgZ(16,"div",2),e._uU(17,"Ordered Items"),e.qZA()(),e.TgZ(18,"div",0)(19,"div",5),e._uU(20),e.ALo(21,"currency"),e.ALo(22,"async"),e.qZA(),e.TgZ(23,"div",2),e._uU(24,"Total"),e.qZA()(),e.TgZ(25,"div",0)(26,"div",6),e._uU(27),e.ALo(28,"currency"),e.ALo(29,"async"),e.qZA(),e.TgZ(30,"div",2),e._uU(31,"Order Average"),e.qZA()()),2&o){let g,h,y,R,q;e.xp6(2),e.hij(" ",(null==(g=e.lcZ(3,5,a.stats))?null:g.order_count)||"0"," "),e.xp6(6),e.hij(" ",(null==(h=e.lcZ(9,7,a.stats))?null:h.unique_items)||"0"," "),e.xp6(6),e.Oqu((null==(y=e.lcZ(15,9,a.stats))?null:y.item_count)||"0"),e.xp6(6),e.hij(" ",e.xi3(21,11,(null==(R=e.lcZ(22,14,a.stats))?null:R.total_cost)/100||0,a.code)," "),e.xp6(7),e.hij(" ",e.xi3(28,16,(null==(q=e.lcZ(29,19,a.stats))?null:q.avg_cost)/100||0,a.code)," ")}},dependencies:[B.Ov,B.H9],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:center;padding:.5rem}\n/*# sourceMappingURL=catering-report-overall.component.ts-angular-inline--111.css.map*/"]}),n})();var Me=L(6896);function Ot(n,m){if(1&n&&(e._uU(0),e.ALo(1,"date"),e.ALo(2,"date")),2&n){const o=m.data;e.AsE(" ",e.lcZ(1,2,o)," at ",e.xi3(2,4,o,"shortTime")," ")}}function Tt(n,m){if(1&n&&(e._uU(0),e.ALo(1,"currency")),2&n){const o=m.data,a=e.oxw();e.hij(" ",e.xi3(1,1,o/100,a.code)," ")}}const St=function(){return["deliver_at","item_count","total_cost"]},Ut=function(){return["Date","Items","Total Cost"]},Lt=function(){return["flex"]},Rt=function(n,m){return{deliver_at:n,total_cost:m}};let Et=(()=>{class n{constructor(o,a){this._report=o,this._org=a,this.orders=this._report.catering_orders,this.download=()=>this._report.downloadOrders()}get code(){return this._org.currency_code}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(Ze),e.Y36(z.w7))},n.\u0275cmp=e.Xpm({type:n,selectors:[["catering-report-orders"]],decls:12,vars:12,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","dark:bg-neutral-700","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","dark:border-neutral-500","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["mat-button-icon","","matTooltip","Download list",3,"click"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["date_state",""],["cost_state",""]],template:function(o,a){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3,"Orders"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.download()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()()(),e._UZ(7,"custom-table",4),e.YNc(8,Ot,3,7,"ng-template",null,5,e.W1O),e.YNc(10,Tt,2,4,"ng-template",null,6,e.W1O),e.qZA()),2&o){const g=e.MAs(9),h=e.MAs(11);e.xp6(7),e.Q6J("dataSource",a.orders)("columns",e.DdM(6,St))("display_column",e.DdM(7,Ut))("column_size",e.DdM(8,Lt))("template",e.WLB(9,Rt,g,h))("pagination",!0)}},dependencies:[Me.gM,s.o,le.C,B.H9,B.uU]}),n})();function zt(n,m){if(1&n&&(e.TgZ(0,"span",7),e._uU(1),e.qZA()),2&n){const o=e.oxw().data,a=e.oxw();e.Q6J("matTooltip",a.options(o)),e.xp6(1),e.hij(" ",o.length," option(s) ")}}function kt(n,m){1&n&&e.YNc(0,zt,2,2,"span",6),2&n&&e.Q6J("ngIf",m.data.length)}function Nt(n,m){if(1&n&&(e._uU(0),e.ALo(1,"currency")),2&n){const o=m.data,a=e.oxw();e.hij(" ",e.xi3(1,1,(o||0)/100,a.code)," ")}}const Dt=function(){return["name","options","quantity","unit_price","total_cost"]},Pt=function(){return["Name","Options","Quantity","Unit Price","Total Cost"]},It=function(){return["flex"]},jt=function(n,m,o){return{options:n,unit_price:m,total_cost:o}};let Yt=(()=>{class n{constructor(o,a){this._report=o,this._org=a,this.items=this._report.catering_items}get code(){return this._org.currency_code}options(o){return o.map(a=>a.name).join("\n")}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(Ze),e.Y36(z.w7))},n.\u0275cmp=e.Xpm({type:n,selectors:[["catering-report-items"]],decls:9,vars:13,consts:[[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","dark:bg-neutral-700","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","dark:border-neutral-500","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["empty","No orders for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination"],["option_state",""],["cost_state",""],["class","text-xs px-2 py-1 rounded bg-gray-300",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-gray-300",3,"matTooltip"]],template:function(o,a){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3,"Ordered Items"),e.qZA()(),e._UZ(4,"custom-table",3),e.YNc(5,kt,1,1,"ng-template",null,4,e.W1O),e.YNc(7,Nt,2,4,"ng-template",null,5,e.W1O),e.qZA()),2&o){const g=e.MAs(6),h=e.MAs(8);e.xp6(4),e.Q6J("dataSource",a.items)("columns",e.DdM(6,Dt))("display_column",e.DdM(7,Pt))("column_size",e.DdM(8,It))("template",e.kEZ(9,jt,g,h,h))("pagination",!0)}},dependencies:[B.O5,Me.gM,le.C,B.H9]}),n})();function Bt(n,m){1&n&&(e.TgZ(0,"div",5),e._UZ(1,"catering-report-overall")(2,"catering-report-orders")(3,"catering-report-items"),e.qZA())}function qt(n,m){if(1&n&&(e.ynx(0),e.YNc(1,Bt,4,0,"div",4),e.ALo(2,"async"),e.BQk()),2&n){const o=e.oxw(),a=e.MAs(7);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,o.total_count))("ngIfElse",a)}}function Jt(n,m){1&n&&(e.TgZ(0,"div",6),e._UZ(1,"mat-spinner",7),e.TgZ(2,"p",8),e._uU(3,"Loading report data..."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("diameter",32))}function Ft(n,m){1&n&&(e.TgZ(0,"div",6)(1,"p",8),e._uU(2," Select levels and time period to generate a report. "),e.qZA()())}let Qt=(()=>{class n{constructor(o){this._state=o,this.total_count=this._state.stats.pipe((0,Q.U)(a=>a.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(W))},n.\u0275cmp=e.Xpm({type:n,selectors:[["catering-report"]],decls:8,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],["class","h-full w-full",4,"ngIf","ngIfElse"],[1,"h-full","w-full"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(o,a){if(1&o&&(e._UZ(0,"reports-options"),e.TgZ(1,"div",0),e.YNc(2,qt,3,4,"ng-container",1),e.ALo(3,"async"),e.YNc(4,Jt,4,1,"ng-template",null,2,e.W1O),e.YNc(6,Ft,3,0,"ng-template",null,3,e.W1O),e.qZA()),2&o){const g=e.MAs(5);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,a.loading))("ngIfElse",g)}},dependencies:[B.O5,ve.Ou,ye,Mt,Et,Yt,B.Ov]}),n})();var ze=L(1810),Gt=L(3298),Xt=L(9151),Ct=L(8759);const xe={};let Oe=(()=>{class n{transform(o){return o?(xe[o]||(xe[o]=(0,M.VE)(o).pipe((0,Q.U)(a=>a[0]||new M.mO({id:o,name:o})),(0,he.K)(a=>(0,re.of)(new M.mO({id:o,name:o}))),(0,ne.d)(1))),xe[o]):(0,re.of)(null)}static addUser(o){xe[o.id]=(0,re.of)(o).pipe((0,ne.d)(1))}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275pipe=e.Yjl({name:"user",type:n,pure:!0}),n})(),ke=(()=>{class n{constructor(o,a){this._org=o,this._reports=a,this._loading=new ce.X(""),this._generate=new ce.X(0),this._options=new ce.X({start:(0,E.Z)(Date.now()),end:(0,Y.Z)(Date.now())}),this.events=(0,se.aj)([this._options,this._generate]).pipe((0,Gt.x)((g,h)=>g[1]===h[1]),(0,Xt.h)(([g,h])=>!!h),(0,Ae.w)(([{start:g,end:h,user:y}])=>{if(!y)return(0,re.of)([]);this._loading.next("Loading contact events...");const R=(0,v.rTZ)(this.system_id,"ContactTracing");return y=y||(0,l.ar)(),Oe.addUser(y),this.system_id&&R?R.execute("close_contacts",[y.email,y.username,(0,ze.Z)(g),(0,ze.Z)(h)]).catch(q=>((0,l.cB)(`${q?.msg||JSON.stringify(q)}`),[])):(0,re.of)([])}),(0,Q.U)(g=>{const h=this._options.getValue().user||(0,l.ar)();return g.map(y=>({mac_address:y.mac_address,date:1e3*y.contact_time,duration:Math.floor(y.duration/60)||0,user_id:h.id,user:h.name,contact_id:y.username,distance:1}))}),(0,he.K)(g=>((0,l.cB)(`${g?.msg||JSON.stringify(g)}`),(0,re.of)([]))),(0,Ct.b)(g=>this._loading.next("")),(0,ne.d)(1)),this.options=this._options.asObservable(),this.loading=this._loading.asObservable()}get system_id(){return this._org.binding("contact_tracing")}setOptions(o){this._options.next({...this._options.getValue(),...o})}generateReport(){this._generate.next(Date.now())}downloadReport(){var o=this;return(0,T.Z)(function*(){const{start:a,end:g}=yield o._reports.options.pipe((0,ae.q)(1)).toPromise(),h=yield o.events.pipe((0,ae.q)(1)).toPromise(),y=new Oe,R=yield Promise.all(h.map(function(){var q=(0,T.Z)(function*(D){return{"MAC Address":D.mac_address,Date:(0,oe.Z)(D.date,"dd MMM yyyy, h:mm a"),"User Name":D.user,"Contact Name":(yield y.transform(D.contact_id).toPromise())?.name||("null"!==D.contact_id?D.contact_id:null)||D.mac_address,Duration:`${Math.floor(D.duration/60)?Math.floor(D.duration/60)+"h ":""}${Math.floor(D.duration%60)+"m"}`,Distance:D.distance}});return function(D){return q.apply(this,arguments)}}()));(0,l.Sv)(`report+contact-tracing+${(0,oe.Z)(a,"yyyy-MM-dd")}+${(0,oe.Z)(g,"yyyy-MM-dd")}.csv`,(0,l.o3)(R))})()}}return n.\u0275fac=function(o){return new(o||n)(e.LFG(z.w7),e.LFG(W))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Vt=L(9697);let Ht=(()=>{class n{constructor(o){this._state=o,this.options=this._state.options,this.setOptions=a=>this._state.setOptions(a),this.generate=()=>this._state.generateReport()}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(ke))},n.\u0275cmp=e.Xpm({type:n,selectors:[["contact-tracing-options"]],decls:15,vars:14,consts:[[1,"flex","items-center","space-x-2","w-full","p-2","bg-white","dark:bg-neutral-700","shadow"],["appearance","outline",1,"w-[18rem]"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["placeholder","Search for user to trace...",1,"w-64","h-12","mb-2","mt-1",3,"ngModel","ngModelChange"],["mat-button","",3,"disabled","click"]],template:function(o,a){if(1&o&&(e.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-date-range-input",2)(3,"input",3),e.NdJ("ngModelChange",function(h){return h?a.setOptions({start:h,user:null}):""}),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"input",4),e.NdJ("ngModelChange",function(h){return h?a.setOptions({end:h,user:null}):""}),e.ALo(6,"async"),e.qZA()(),e._UZ(7,"mat-datepicker-toggle",5)(8,"mat-date-range-picker",null,6),e.qZA(),e.TgZ(10,"a-user-search-field",7),e.NdJ("ngModelChange",function(h){return a.setOptions({user:h})}),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"button",8),e.NdJ("click",function(){return a.generate()}),e.ALo(13,"async"),e._uU(14," Generate Report "),e.qZA()()),2&o){const g=e.MAs(9);let h,y,R,q;e.xp6(2),e.Q6J("rangePicker",g),e.xp6(1),e.Q6J("ngModel",null==(h=e.lcZ(4,6,a.options))?null:h.start),e.xp6(2),e.Q6J("ngModel",null==(y=e.lcZ(6,8,a.options))?null:y.end),e.xp6(2),e.Q6J("for",g),e.xp6(3),e.Q6J("ngModel",null==(R=e.lcZ(11,10,a.options))?null:R.user),e.xp6(2),e.Q6J("disabled",!(null!=(q=e.lcZ(13,12,a.options))&&q.user))}},dependencies:[F.Fj,F.JJ,F.On,ie.lW,_e.KE,_e.R9,ee.nW,ee.wx,ee.zY,ee.By,ee._g,Vt.d,B.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{height:3.25rem}\n/*# sourceMappingURL=contact-tracing-options.component.ts-angular-inline--114.css.map*/"]}),n})();function Wt(n,m){if(1&n&&(e.TgZ(0,"span",16),e._uU(1),e.qZA()),2&n){const o=e.oxw().data,a=e.oxw(3);e.Q6J("matTooltip",a.options(o)),e.xp6(1),e.hij(" ",o.length," option(s) ")}}function $t(n,m){1&n&&e.YNc(0,Wt,2,2,"span",15),2&n&&e.Q6J("ngIf",m.data.length)}function Kt(n,m){if(1&n&&(e._uU(0),e.ALo(1,"async"),e.ALo(2,"user")),2&n){const a=m.row;let g;e.Oqu((null==(g=e.lcZ(1,1,e.lcZ(2,3,m.data)))?null:g.name)||a.mac_address)}}function en(n,m){if(1&n&&(e._uU(0),e.ALo(1,"date"),e.ALo(2,"date")),2&n){const o=m.data;e.AsE(" ",e.xi3(1,2,o,"mediumDate"),", ",e.xi3(2,5,o,"shortTime")," ")}}function tn(n,m){if(1&n&&e._uU(0),2&n){const o=m.data,a=e.oxw(3);e.hij(" ",a.formatDuration(o||0)||"Less than a minute"," ")}}function nn(n,m){1&n&&e._uU(0),2&n&&e.hij(" ",m.data,"m ")}const sn=function(){return["date","user_id","contact_id","duration"]},on=function(){return["Time of Contact","Person","Close Contact","Duration"]},rn=function(){return["12r","14r","flex","10r"]},an=function(n,m,o,a,g,h){return{options:n,date:m,distance:o,user_id:a,contact_id:g,duration:h}};function ln(n,m){if(1&n&&(e.TgZ(0,"div",6)(1,"div",7)(2,"h2",8),e._uU(3,"Contact Events"),e.qZA()(),e._UZ(4,"custom-table",9),e.YNc(5,$t,1,1,"ng-template",null,10,e.W1O),e.YNc(7,Kt,3,5,"ng-template",null,11,e.W1O),e.YNc(9,en,3,8,"ng-template",null,12,e.W1O),e.YNc(11,tn,1,1,"ng-template",null,13,e.W1O),e.YNc(13,nn,1,1,"ng-template",null,14,e.W1O),e.qZA()),2&n){const o=e.MAs(6),a=e.MAs(8),g=e.MAs(10),h=e.MAs(12),y=e.MAs(14),R=e.oxw(2);e.xp6(4),e.Q6J("dataSource",R.tracing_events)("columns",e.DdM(7,sn))("display_column",e.DdM(8,on))("column_size",e.DdM(9,rn))("template",e.HTZ(10,an,o,g,y,a,a,h))("pagination",!0)("page_size",30)}}function cn(n,m){if(1&n&&(e.ynx(0),e.YNc(1,ln,15,17,"div",5),e.ALo(2,"async"),e.BQk()),2&n){const o=e.oxw(),a=e.MAs(10);let g;e.xp6(1),e.Q6J("ngIf",null==(g=e.lcZ(2,2,o.options))?null:g.user)("ngIfElse",a)}}function un(n,m){if(1&n&&(e.TgZ(0,"div",17),e._UZ(1,"map-spinner",18),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"async"),e.qZA()()),2&n){const o=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,1,o.loading))}}function dn(n,m){1&n&&(e.TgZ(0,"div",17)(1,"p",19),e._uU(2,"Select a user from the topbar to begin"),e.qZA()())}const pn=[{path:"",component:j,children:[{path:"",component:ye},{path:"spaces",component:ot},{path:"desks",component:Zt},{path:"catering",component:Qt},{path:"contact-tracing",component:(()=>{class n{constructor(o){this._state=o,this.loading=this._state.loading,this.options=this._state.options,this.tracing_events=this._state.events,this.setOptions=a=>this._state.setOptions(a),this.downloadReport=()=>this._state.downloadReport(),this.formatDuration=a=>(0,Le.Z)({hours:Math.floor(a/60),minutes:a%60})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(ke))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-contact-tracing-report"]],decls:11,vars:4,consts:[[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["mat-icon-button","","matTooltip","Download Report",1,"bg-white","dark:bg-neutral-700","absolute","bottom-2","left-2","shadow",3,"click"],["load_state",""],["empty_state",""],["class","w-[64rem] max-w-[calc(100%-2rem)] rounded overflow-hidden bg-white dark:bg-neutral-700 shadow mx-auto my-2",4,"ngIf","ngIfElse"],[1,"w-[64rem]","max-w-[calc(100%-2rem)]","rounded","overflow-hidden","bg-white","dark:bg-neutral-700","shadow","mx-auto","my-2"],[1,"border-b","border-gray-200","dark:border-neutral-500","flex","items-center","justify-between","px-4"],[1,"py-2","text-xl","font-medium"],["empty","No contact records for selected period",1,"w-full","h-full",3,"dataSource","columns","display_column","column_size","template","pagination","page_size"],["option_state",""],["user_state",""],["date_state",""],["duration_state",""],["distance_state",""],["class","text-xs px-2 py-1 rounded bg-gray-300 dark:bg-neutral-600",3,"matTooltip",4,"ngIf"],[1,"text-xs","px-2","py-1","rounded","bg-gray-300","dark:bg-neutral-600",3,"matTooltip"],[1,"p-8","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"],[1,"opacity-60"]],template:function(o,a){if(1&o&&(e._UZ(0,"contact-tracing-options"),e.TgZ(1,"div",0),e.YNc(2,cn,3,4,"ng-container",1),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return a.downloadReport()}),e.TgZ(5,"app-icon"),e._uU(6,"download"),e.qZA()(),e.YNc(7,un,5,3,"ng-template",null,3,e.W1O),e.YNc(9,dn,3,0,"ng-template",null,4,e.W1O)),2&o){const g=e.MAs(8);e.xp6(2),e.Q6J("ngIf",!e.lcZ(3,2,a.loading))("ngIfElse",g)}},dependencies:[B.O5,ie.lW,Me.gM,s.o,le.C,Ht,B.Ov,B.uU,Oe],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}\n/*# sourceMappingURL=contact-tracing-report.component.ts-angular-inline--113.css.map*/"]}),n})()},{path:"**",redirectTo:"desks",pathMatch:"full"}]}];let fn=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[B.ez,F.u5,t.v,Z.YR,M.PP,S.TU,P.Bz.forChild(pn)]}),n})()},7103:function(Ue,fe){var B,F;F=this,B=function(){return F.Chartist=function(){var F={version:"0.11.4"};return function(P,t){"use strict";var S=P.window,e=P.document;t.namespaces={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",ct:"http://gionkunz.github.com/chartist-js/ct"},t.noop=function(i){return i},t.alphaNumerate=function(i){return String.fromCharCode(97+i%26)},t.extend=function(i){var l,d,s;for(i=i||{},l=1;l<arguments.length;l++)for(var r in d=arguments[l])i[r]="object"!=typeof(s=d[r])||null===s||s instanceof Array?s:t.extend(i[r],s);return i},t.replaceAll=function(i,l,d){return i.replace(new RegExp(l,"g"),d)},t.ensureUnit=function(i,l){return"number"==typeof i&&(i+=l),i},t.quantity=function(i){if("string"==typeof i){var l=/^(\d+)\s*(.*)$/g.exec(i);return{value:+l[1],unit:l[2]||void 0}}return{value:i}},t.querySelector=function(i){return i instanceof Node?i:e.querySelector(i)},t.times=function(i){return Array.apply(null,new Array(i))},t.sum=function(i,l){return i+(l||0)},t.mapMultiply=function(i){return function(l){return l*i}},t.mapAdd=function(i){return function(l){return l+i}},t.serialMap=function(i,l){var d=[],s=Math.max.apply(null,i.map(function(r){return r.length}));return t.times(s).forEach(function(r,c){var f=i.map(function(p){return p[c]});d[c]=l.apply(null,f)}),d},t.roundWithPrecision=function(i,l){var d=Math.pow(10,l||t.precision);return Math.round(i*d)/d},t.precision=8,t.escapingMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t.serialize=function(i){return null==i?i:("number"==typeof i?i=""+i:"object"==typeof i&&(i=JSON.stringify({data:i})),Object.keys(t.escapingMap).reduce(function(l,d){return t.replaceAll(l,d,t.escapingMap[d])},i))},t.deserialize=function(i){if("string"!=typeof i)return i;i=Object.keys(t.escapingMap).reduce(function(l,d){return t.replaceAll(l,t.escapingMap[d],d)},i);try{i=void 0!==(i=JSON.parse(i)).data?i.data:i}catch{}return i},t.createSvg=function(i,l,d,s){var r;return l=l||"100%",d=d||"100%",Array.prototype.slice.call(i.querySelectorAll("svg")).filter(function(f){return f.getAttributeNS(t.namespaces.xmlns,"ct")}).forEach(function(f){i.removeChild(f)}),(r=new t.Svg("svg").attr({width:l,height:d}).addClass(s))._node.style.width=l,r._node.style.height=d,i.appendChild(r._node),r},t.normalizeData=function(i,l,d){var s,r={raw:i,normalized:{}};return r.normalized.series=t.getDataArray({series:i.series||[]},l,d),s=r.normalized.series.every(function(c){return c instanceof Array})?Math.max.apply(null,r.normalized.series.map(function(c){return c.length})):r.normalized.series.length,r.normalized.labels=(i.labels||[]).slice(),Array.prototype.push.apply(r.normalized.labels,t.times(Math.max(0,s-r.normalized.labels.length)).map(function(){return""})),l&&t.reverseData(r.normalized),r},t.safeHasProperty=function(i,l){return null!==i&&"object"==typeof i&&i.hasOwnProperty(l)},t.isDataHoleValue=function(i){return null==i||"number"==typeof i&&isNaN(i)},t.reverseData=function(i){i.labels.reverse(),i.series.reverse();for(var l=0;l<i.series.length;l++)"object"==typeof i.series[l]&&void 0!==i.series[l].data?i.series[l].data.reverse():i.series[l]instanceof Array&&i.series[l].reverse()},t.getDataArray=function(i,l,d){return i.series.map(function s(r){if(t.safeHasProperty(r,"value"))return s(r.value);if(t.safeHasProperty(r,"data"))return s(r.data);if(r instanceof Array)return r.map(s);if(!t.isDataHoleValue(r)){if(d){var c={};return"string"==typeof d?c[d]=t.getNumberOrUndefined(r):c.y=t.getNumberOrUndefined(r),c.x=r.hasOwnProperty("x")?t.getNumberOrUndefined(r.x):c.x,c.y=r.hasOwnProperty("y")?t.getNumberOrUndefined(r.y):c.y,c}return t.getNumberOrUndefined(r)}})},t.normalizePadding=function(i,l){return l=l||0,"number"==typeof i?{top:i,right:i,bottom:i,left:i}:{top:"number"==typeof i.top?i.top:l,right:"number"==typeof i.right?i.right:l,bottom:"number"==typeof i.bottom?i.bottom:l,left:"number"==typeof i.left?i.left:l}},t.getMetaData=function(i,l){var d=i.data?i.data[l]:i[l];return d?d.meta:void 0},t.orderOfMagnitude=function(i){return Math.floor(Math.log(Math.abs(i))/Math.LN10)},t.projectLength=function(i,l,d){return l/d.range*i},t.getAvailableHeight=function(i,l){return Math.max((t.quantity(l.height).value||i.height())-(l.chartPadding.top+l.chartPadding.bottom)-l.axisX.offset,0)},t.getHighLow=function(i,l,d){var s={high:void 0===(l=t.extend({},l,d?l["axis"+d.toUpperCase()]:{})).high?-Number.MAX_VALUE:+l.high,low:void 0===l.low?Number.MAX_VALUE:+l.low},r=void 0===l.high,c=void 0===l.low;return(r||c)&&function f(p){if(void 0!==p)if(p instanceof Array)for(var u=0;u<p.length;u++)f(p[u]);else{var _=d?+p[d]:+p;r&&_>s.high&&(s.high=_),c&&_<s.low&&(s.low=_)}}(i),(l.referenceValue||0===l.referenceValue)&&(s.high=Math.max(l.referenceValue,s.high),s.low=Math.min(l.referenceValue,s.low)),s.high<=s.low&&(0===s.low?s.high=1:s.low<0?s.high=0:(s.high>0||(s.high=1),s.low=0)),s},t.isNumeric=function(i){return null!==i&&isFinite(i)},t.isFalseyButZero=function(i){return!i&&0!==i},t.getNumberOrUndefined=function(i){return t.isNumeric(i)?+i:void 0},t.isMultiValue=function(i){return"object"==typeof i&&("x"in i||"y"in i)},t.getMultiValue=function(i,l){return t.isMultiValue(i)?t.getNumberOrUndefined(i[l||"y"]):t.getNumberOrUndefined(i)},t.rho=function(i){if(1===i)return i;function l(f,p){return f%p==0?p:l(p,f%p)}function d(f){return f*f+1}var c,s=2,r=2;if(i%2==0)return 2;do{s=d(s)%i,r=d(d(r))%i,c=l(Math.abs(s-r),i)}while(1===c);return c},t.getBounds=function(i,l,d,s){var r,f,p,c=0,u={high:l.high,low:l.low};u.valueRange=u.high-u.low,u.oom=t.orderOfMagnitude(u.valueRange),u.step=Math.pow(10,u.oom),u.min=Math.floor(u.low/u.step)*u.step,u.max=Math.ceil(u.high/u.step)*u.step,u.range=u.max-u.min,u.numberOfSteps=Math.round(u.range/u.step);var x=t.projectLength(i,u.step,u)<d,w=s?t.rho(u.range):0;if(s&&t.projectLength(i,1,u)>=d)u.step=1;else if(s&&w<u.step&&t.projectLength(i,w,u)>=d)u.step=w;else for(;;){if(x&&t.projectLength(i,u.step,u)<=d)u.step*=2;else{if(x||!(t.projectLength(i,u.step/2,u)>=d))break;if(u.step/=2,s&&u.step%1!=0){u.step*=2;break}}if(c++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}var A=2221e-19;function O(j,Z){return j===(j+=Z)&&(j*=1+(Z>0?A:-A)),j}for(u.step=Math.max(u.step,A),f=u.min,p=u.max;f+u.step<=u.low;)f=O(f,u.step);for(;p-u.step>=u.high;)p=O(p,-u.step);u.min=f,u.max=p,u.range=u.max-u.min;var k=[];for(r=u.min;r<=u.max;r=O(r,u.step)){var X=t.roundWithPrecision(r);X!==k[k.length-1]&&k.push(X)}return u.values=k,u},t.polarToCartesian=function(i,l,d,s){var r=(s-90)*Math.PI/180;return{x:i+d*Math.cos(r),y:l+d*Math.sin(r)}},t.createChartRect=function(i,l,d){var s=!(!l.axisX&&!l.axisY),r=s?l.axisY.offset:0,c=s?l.axisX.offset:0,f=i.width()||t.quantity(l.width).value||0,p=i.height()||t.quantity(l.height).value||0,u=t.normalizePadding(l.chartPadding,d);f=Math.max(f,r+u.left+u.right),p=Math.max(p,c+u.top+u.bottom);var _={padding:u,width:function(){return this.x2-this.x1},height:function(){return this.y1-this.y2}};return s?("start"===l.axisX.position?(_.y2=u.top+c,_.y1=Math.max(p-u.bottom,_.y2+1)):(_.y2=u.top,_.y1=Math.max(p-u.bottom-c,_.y2+1)),"start"===l.axisY.position?(_.x1=u.left+r,_.x2=Math.max(f-u.right,_.x1+1)):(_.x1=u.left,_.x2=Math.max(f-u.right-r,_.x1+1))):(_.x1=u.left,_.x2=Math.max(f-u.right,_.x1+1),_.y2=u.top,_.y1=Math.max(p-u.bottom,_.y2+1)),_},t.createGrid=function(i,l,d,s,r,c,f,p){var u={};u[d.units.pos+"1"]=i,u[d.units.pos+"2"]=i,u[d.counterUnits.pos+"1"]=s,u[d.counterUnits.pos+"2"]=s+r;var _=c.elem("line",u,f.join(" "));p.emit("draw",t.extend({type:"grid",axis:d,index:l,group:c,element:_},u))},t.createGridBackground=function(i,l,d,s){var r=i.elem("rect",{x:l.x1,y:l.y2,width:l.width(),height:l.height()},d,!0);s.emit("draw",{type:"gridBackground",group:i,element:r})},t.createLabel=function(i,l,d,s,r,c,f,p,u,_,x){var w,A={};if(A[r.units.pos]=i+f[r.units.pos],A[r.counterUnits.pos]=f[r.counterUnits.pos],A[r.units.len]=l,A[r.counterUnits.len]=Math.max(0,c-10),_){var O=e.createElement("span");O.className=u.join(" "),O.setAttribute("xmlns",t.namespaces.xhtml),O.innerText=s[d],O.style[r.units.len]=Math.round(A[r.units.len])+"px",O.style[r.counterUnits.len]=Math.round(A[r.counterUnits.len])+"px",w=p.foreignObject(O,t.extend({style:"overflow: visible;"},A))}else w=p.elem("text",A,u.join(" ")).text(s[d]);x.emit("draw",t.extend({type:"label",axis:r,index:d,group:p,element:w,text:s[d]},A))},t.getSeriesOption=function(i,l,d){if(i.name&&l.series&&l.series[i.name]){var s=l.series[i.name];return s.hasOwnProperty(d)?s[d]:l[d]}return l[d]},t.optionsProvider=function(i,l,d){var r,f,s=t.extend({},i),c=[];function p(x){var w=r;if(r=t.extend({},s),l)for(f=0;f<l.length;f++)S.matchMedia(l[f][0]).matches&&(r=t.extend(r,l[f][1]));d&&x&&d.emit("optionsChanged",{previousOptions:w,currentOptions:r})}if(!S.matchMedia)throw"window.matchMedia not found! Make sure you're using a polyfill.";if(l)for(f=0;f<l.length;f++){var _=S.matchMedia(l[f][0]);_.addListener(p),c.push(_)}return p(),{removeMediaQueryListeners:function u(){c.forEach(function(x){x.removeListener(p)})},getCurrentOptions:function(){return t.extend({},r)}}},t.splitIntoSegments=function(i,l,d){d=t.extend({},{increasingX:!1,fillHoles:!1},d);for(var r=[],c=!0,f=0;f<i.length;f+=2)void 0===t.getMultiValue(l[f/2].value)?d.fillHoles||(c=!0):(d.increasingX&&f>=2&&i[f]<=i[f-2]&&(c=!0),c&&(r.push({pathCoordinates:[],valueData:[]}),c=!1),r[r.length-1].pathCoordinates.push(i[f],i[f+1]),r[r.length-1].valueData.push(l[f/2]));return r}}(this||global,F),function(P,t){"use strict";t.Interpolation={},t.Interpolation.none=function(S){return S=t.extend({},{fillHoles:!1},S),function(l,d){for(var s=new t.Svg.Path,r=!0,c=0;c<l.length;c+=2){var f=l[c],p=l[c+1],u=d[c/2];void 0!==t.getMultiValue(u.value)?(r?s.move(f,p,!1,u):s.line(f,p,!1,u),r=!1):S.fillHoles||(r=!0)}return s}},t.Interpolation.simple=function(S){S=t.extend({},{divisor:2,fillHoles:!1},S);var i=1/Math.max(1,S.divisor);return function(d,s){for(var c,f,p,r=new t.Svg.Path,u=0;u<d.length;u+=2){var _=d[u],x=d[u+1],w=(_-c)*i,A=s[u/2];void 0!==A.value?(void 0===p?r.move(_,x,!1,A):r.curve(c+w,f,_-w,x,_,x,!1,A),c=_,f=x,p=A):S.fillHoles||(c=_=p=void 0)}return r}},t.Interpolation.cardinal=function(S){S=t.extend({},{tension:1,fillHoles:!1},S);var i=Math.min(1,Math.max(0,S.tension)),l=1-i;return function d(s,r){var c=t.splitIntoSegments(s,r,{fillHoles:S.fillHoles});if(c.length){if(c.length>1){var f=[];return c.forEach(function(A){f.push(d(A.pathCoordinates,A.valueData))}),t.Svg.Path.join(f)}if(r=c[0].valueData,(s=c[0].pathCoordinates).length<=4)return t.Interpolation.none()(s,r);for(var p=(new t.Svg.Path).move(s[0],s[1],!1,r[0]),_=0,x=s.length;x-2>_;_+=2){var w=[{x:+s[_-2],y:+s[_-1]},{x:+s[_],y:+s[_+1]},{x:+s[_+2],y:+s[_+3]},{x:+s[_+4],y:+s[_+5]}];x-4===_?w[3]=w[2]:_||(w[0]={x:+s[_],y:+s[_+1]}),p.curve(i*(6*w[1].x-w[0].x+w[2].x)/6+l*w[2].x,i*(6*w[1].y-w[0].y+w[2].y)/6+l*w[2].y,i*(w[1].x+6*w[2].x-w[3].x)/6+l*w[2].x,i*(w[1].y+6*w[2].y-w[3].y)/6+l*w[2].y,w[2].x,w[2].y,!1,r[(_+2)/2])}return p}return t.Interpolation.none()([])}},t.Interpolation.monotoneCubic=function(S){return S=t.extend({},{fillHoles:!1},S),function i(l,d){var s=t.splitIntoSegments(l,d,{fillHoles:S.fillHoles,increasingX:!0});if(s.length){if(s.length>1){var r=[];return s.forEach(function(k){r.push(i(k.pathCoordinates,k.valueData))}),t.Svg.Path.join(r)}if(d=s[0].valueData,(l=s[0].pathCoordinates).length<=4)return t.Interpolation.none()(l,d);var p,O,c=[],f=[],u=l.length/2,_=[],x=[],w=[],A=[];for(p=0;p<u;p++)c[p]=l[2*p],f[p]=l[2*p+1];for(p=0;p<u-1;p++)w[p]=f[p+1]-f[p],A[p]=c[p+1]-c[p],x[p]=w[p]/A[p];for(_[0]=x[0],_[u-1]=x[u-2],p=1;p<u-1;p++)0===x[p]||0===x[p-1]||x[p-1]>0!=x[p]>0?_[p]=0:(_[p]=3*(A[p-1]+A[p])/((2*A[p]+A[p-1])/x[p-1]+(A[p]+2*A[p-1])/x[p]),isFinite(_[p])||(_[p]=0));for(O=(new t.Svg.Path).move(c[0],f[0],!1,d[0]),p=0;p<u-1;p++)O.curve(c[p]+A[p]/3,f[p]+_[p]*A[p]/3,c[p+1]-A[p]/3,f[p+1]-_[p+1]*A[p]/3,c[p+1],f[p+1],!1,d[p+1]);return O}return t.Interpolation.none()([])}},t.Interpolation.step=function(S){return S=t.extend({},{postpone:!0,fillHoles:!1},S),function(l,d){for(var r,c,f,s=new t.Svg.Path,p=0;p<l.length;p+=2){var u=l[p],_=l[p+1],x=d[p/2];void 0!==x.value?(void 0===f?s.move(u,_,!1,x):(S.postpone?s.line(u,c,!1,f):s.line(r,_,!1,x),s.line(u,_,!1,x)),r=u,c=_,f=x):S.fillHoles||(r=c=f=void 0)}return s}}}(this||global,F),function(P,t){"use strict";t.EventEmitter=function(){var S=[];return{addEventHandler:function e(d,s){S[d]=S[d]||[],S[d].push(s)},removeEventHandler:function i(d,s){S[d]&&(s?(S[d].splice(S[d].indexOf(s),1),0===S[d].length&&delete S[d]):delete S[d])},emit:function l(d,s){S[d]&&S[d].forEach(function(r){r(s)}),S["*"]&&S["*"].forEach(function(r){r(d,s)})}}}}(this||global,F),function(P,t){"use strict";function S(l){var d=[];if(l.length)for(var s=0;s<l.length;s++)d.push(l[s]);return d}t.Class={extend:function e(l,d){var s=d||this.prototype||t.Class,r=Object.create(s);t.Class.cloneDefinitions(r,l);var c=function(){var p,f=r.constructor||function(){};return p=this===t?Object.create(r):this,f.apply(p,Array.prototype.slice.call(arguments,0)),p};return c.prototype=r,c.super=s,c.extend=this.extend,c},cloneDefinitions:function i(){var l=S(arguments),d=l[0];return l.splice(1,l.length-1).forEach(function(s){Object.getOwnPropertyNames(s).forEach(function(r){delete d[r],Object.defineProperty(d,r,Object.getOwnPropertyDescriptor(s,r))})}),d}}}(this||global,F),function(P,t){"use strict";var S=P.window;function s(){S.addEventListener("resize",this.resizeListener),this.optionsProvider=t.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter),this.eventEmitter.addEventHandler("optionsChanged",function(){this.update()}.bind(this)),this.options.plugins&&this.options.plugins.forEach(function(c){c instanceof Array?c[0](this,c[1]):c(this)}.bind(this)),this.eventEmitter.emit("data",{type:"initial",data:this.data}),this.createChart(this.optionsProvider.getCurrentOptions()),this.initializeTimeoutId=void 0}t.Base=t.Class.extend({constructor:function r(c,f,p,u,_){this.container=t.querySelector(c),this.data=f||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.defaultOptions=p,this.options=u,this.responsiveOptions=_,this.eventEmitter=t.EventEmitter(),this.supportsForeignObject=t.Svg.isSupported("Extensibility"),this.supportsAnimations=t.Svg.isSupported("AnimationEventsAttribute"),this.resizeListener=function(){this.update()}.bind(this),this.container&&(this.container.__chartist__&&this.container.__chartist__.detach(),this.container.__chartist__=this),this.initializeTimeoutId=setTimeout(s.bind(this),0)},optionsProvider:void 0,container:void 0,svg:void 0,eventEmitter:void 0,createChart:function(){throw new Error("Base chart type can't be instantiated!")},update:function e(c,f,p){return c&&(this.data=c||{},this.data.labels=this.data.labels||[],this.data.series=this.data.series||[],this.eventEmitter.emit("data",{type:"update",data:this.data})),f&&(this.options=t.extend({},p?this.options:this.defaultOptions,f),this.initializeTimeoutId||(this.optionsProvider.removeMediaQueryListeners(),this.optionsProvider=t.optionsProvider(this.options,this.responsiveOptions,this.eventEmitter))),this.initializeTimeoutId||this.createChart(this.optionsProvider.getCurrentOptions()),this},detach:function i(){return this.initializeTimeoutId?S.clearTimeout(this.initializeTimeoutId):(S.removeEventListener("resize",this.resizeListener),this.optionsProvider.removeMediaQueryListeners()),this},on:function l(c,f){return this.eventEmitter.addEventHandler(c,f),this},off:function d(c,f){return this.eventEmitter.removeEventHandler(c,f),this},version:t.version,supportsForeignObject:!1})}(this||global,F),function(P,t){"use strict";var S=P.document;t.Svg=t.Class.extend({constructor:function e(v,b,U,E,Y){v instanceof Element?this._node=v:(this._node=S.createElementNS(t.namespaces.svg,v),"svg"===v&&this.attr({"xmlns:ct":t.namespaces.ct})),b&&this.attr(b),U&&this.addClass(U),E&&(Y&&E._node.firstChild?E._node.insertBefore(this._node,E._node.firstChild):E._node.appendChild(this._node))},attr:function i(v,b){return"string"==typeof v?b?this._node.getAttributeNS(b,v):this._node.getAttribute(v):(Object.keys(v).forEach(function(U){if(void 0!==v[U])if(-1!==U.indexOf(":")){var E=U.split(":");this._node.setAttributeNS(t.namespaces[E[0]],U,v[U])}else this._node.setAttribute(U,v[U])}.bind(this)),this)},elem:function l(v,b,U,E){return new t.Svg(v,b,U,this,E)},parent:function d(){return this._node.parentNode instanceof SVGElement?new t.Svg(this._node.parentNode):null},root:function s(){for(var v=this._node;"svg"!==v.nodeName;)v=v.parentNode;return new t.Svg(v)},querySelector:function r(v){var b=this._node.querySelector(v);return b?new t.Svg(b):null},querySelectorAll:function c(v){var b=this._node.querySelectorAll(v);return b.length?new t.Svg.List(b):null},getNode:function f(){return this._node},foreignObject:function p(v,b,U,E){if("string"==typeof v){var Y=S.createElement("div");Y.innerHTML=v,v=Y.firstChild}v.setAttribute("xmlns",t.namespaces.xmlns);var C=this.elem("foreignObject",b,U,E);return C._node.appendChild(v),C},text:function u(v){return this._node.appendChild(S.createTextNode(v)),this},empty:function _(){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);return this},remove:function x(){return this._node.parentNode.removeChild(this._node),this.parent()},replace:function w(v){return this._node.parentNode.replaceChild(v._node,this._node),v},append:function A(v,b){return b&&this._node.firstChild?this._node.insertBefore(v._node,this._node.firstChild):this._node.appendChild(v._node),this},classes:function O(){return this._node.getAttribute("class")?this._node.getAttribute("class").trim().split(/\s+/):[]},addClass:function k(v){return this._node.setAttribute("class",this.classes(this._node).concat(v.trim().split(/\s+/)).filter(function(b,U,E){return E.indexOf(b)===U}).join(" ")),this},removeClass:function X(v){var b=v.trim().split(/\s+/);return this._node.setAttribute("class",this.classes(this._node).filter(function(U){return-1===b.indexOf(U)}).join(" ")),this},removeAllClasses:function j(){return this._node.setAttribute("class",""),this},height:function Z(){return this._node.getBoundingClientRect().height},width:function M(){return this._node.getBoundingClientRect().width},animate:function T(v,b,U){return void 0===b&&(b=!0),Object.keys(v).forEach(function(Y){function C(I,J){var H,me,ue,V={};I.easing&&(ue=I.easing instanceof Array?I.easing:t.Svg.Easing[I.easing],delete I.easing),I.begin=t.ensureUnit(I.begin,"ms"),I.dur=t.ensureUnit(I.dur,"ms"),ue&&(I.calcMode="spline",I.keySplines=ue.join(" "),I.keyTimes="0;1"),J&&(I.fill="freeze",V[Y]=I.from,this.attr(V),me=t.quantity(I.begin||0).value,I.begin="indefinite"),H=this.elem("animate",t.extend({attributeName:Y},I)),J&&setTimeout(function(){try{H._node.beginElement()}catch{V[Y]=I.to,this.attr(V),H.remove()}}.bind(this),me),U&&H._node.addEventListener("beginEvent",function(){U.emit("animationBegin",{element:this,animate:H._node,params:I})}.bind(this)),H._node.addEventListener("endEvent",function(){U&&U.emit("animationEnd",{element:this,animate:H._node,params:I}),J&&(V[Y]=I.to,this.attr(V),H.remove())}.bind(this))}v[Y]instanceof Array?v[Y].forEach(function(I){C.bind(this)(I,!1)}.bind(this)):C.bind(this)(v[Y],b)}.bind(this)),this}}),t.Svg.isSupported=function(v){return S.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#"+v,"1.1")},t.Svg.Easing={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]},t.Svg.List=t.Class.extend({constructor:function z(v){var b=this;this.svgElements=[];for(var U=0;U<v.length;U++)this.svgElements.push(new t.Svg(v[U]));Object.keys(t.Svg.prototype).filter(function(E){return-1===["constructor","parent","querySelector","querySelectorAll","replace","append","classes","height","width"].indexOf(E)}).forEach(function(E){b[E]=function(){var Y=Array.prototype.slice.call(arguments,0);return b.svgElements.forEach(function(C){t.Svg.prototype[E].apply(C,Y)}),b}})}})}(this||global,F),function(P,t){"use strict";var S={m:["x","y"],l:["x","y"],c:["x1","y1","x2","y2","x","y"],a:["rx","ry","xAr","lAf","sf","x","y"]},e={accuracy:3};function i(Z,M,T,N,z,v){var b=t.extend({command:z?Z.toLowerCase():Z.toUpperCase()},M,v?{data:v}:{});T.splice(N,0,b)}function l(Z,M){Z.forEach(function(T,N){S[T.command.toLowerCase()].forEach(function(z,v){M(T,z,N,v,Z)})})}t.Svg.Path=t.Class.extend({constructor:function d(Z,M){this.pathElements=[],this.pos=0,this.close=Z,this.options=t.extend({},e,M)},position:function s(Z){return void 0!==Z?(this.pos=Math.max(0,Math.min(this.pathElements.length,Z)),this):this.pos},remove:function r(Z){return this.pathElements.splice(this.pos,Z),this},move:function c(Z,M,T,N){return i("M",{x:+Z,y:+M},this.pathElements,this.pos++,T,N),this},line:function f(Z,M,T,N){return i("L",{x:+Z,y:+M},this.pathElements,this.pos++,T,N),this},curve:function p(Z,M,T,N,z,v,b,U){return i("C",{x1:+Z,y1:+M,x2:+T,y2:+N,x:+z,y:+v},this.pathElements,this.pos++,b,U),this},arc:function u(Z,M,T,N,z,v,b,U,E){return i("A",{rx:+Z,ry:+M,xAr:+T,lAf:+N,sf:+z,x:+v,y:+b},this.pathElements,this.pos++,U,E),this},scale:function w(Z,M){return l(this.pathElements,function(T,N){T[N]*="x"===N[0]?Z:M}),this},translate:function A(Z,M){return l(this.pathElements,function(T,N){T[N]+="x"===N[0]?Z:M}),this},transform:function O(Z){return l(this.pathElements,function(M,T,N,z,v){var b=Z(M,T,N,z,v);(b||0===b)&&(M[T]=b)}),this},parse:function _(Z){var M=Z.replace(/([A-Za-z])([0-9])/g,"$1 $2").replace(/([0-9])([A-Za-z])/g,"$1 $2").split(/[\s,]+/).reduce(function(z,v){return v.match(/[A-Za-z]/)&&z.push([]),z[z.length-1].push(v),z},[]);"Z"===M[M.length-1][0].toUpperCase()&&M.pop();var T=M.map(function(z){var v=z.shift(),b=S[v.toLowerCase()];return t.extend({command:v},b.reduce(function(U,E,Y){return U[E]=+z[Y],U},{}))}),N=[this.pos,0];return Array.prototype.push.apply(N,T),Array.prototype.splice.apply(this.pathElements,N),this.pos+=T.length,this},stringify:function x(){var Z=Math.pow(10,this.options.accuracy);return this.pathElements.reduce(function(M,T){var N=S[T.command.toLowerCase()].map(function(z){return this.options.accuracy?Math.round(T[z]*Z)/Z:T[z]}.bind(this));return M+T.command+N.join(",")}.bind(this),"")+(this.close?"Z":"")},clone:function k(Z){var M=new t.Svg.Path(Z||this.close);return M.pos=this.pos,M.pathElements=this.pathElements.slice().map(function(N){return t.extend({},N)}),M.options=t.extend({},this.options),M},splitByCommand:function X(Z){var M=[new t.Svg.Path];return this.pathElements.forEach(function(T){T.command===Z.toUpperCase()&&0!==M[M.length-1].pathElements.length&&M.push(new t.Svg.Path),M[M.length-1].pathElements.push(T)}),M}}),t.Svg.Path.elementDescriptions=S,t.Svg.Path.join=function j(Z,M,T){for(var N=new t.Svg.Path(M,T),z=0;z<Z.length;z++)for(var v=Z[z],b=0;b<v.pathElements.length;b++)N.pathElements.push(v.pathElements[b]);return N}}(this||global,F),function(P,t){"use strict";var i={x:{pos:"x",len:"width",dir:"horizontal",rectStart:"x1",rectEnd:"x2",rectOffset:"y2"},y:{pos:"y",len:"height",dir:"vertical",rectStart:"y2",rectEnd:"y1",rectOffset:"x1"}};t.Axis=t.Class.extend({constructor:function l(s,r,c,f){this.units=s,this.counterUnits=s===i.x?i.y:i.x,this.chartRect=r,this.axisLength=r[s.rectEnd]-r[s.rectStart],this.gridOffset=r[s.rectOffset],this.ticks=c,this.options=f},createGridAndLabels:function d(s,r,c,f,p){var u=f["axis"+this.units.pos.toUpperCase()],_=this.ticks.map(this.projectValue.bind(this)),x=this.ticks.map(u.labelInterpolationFnc);_.forEach(function(w,A){var k,O={x:0,y:0};k=_[A+1]?_[A+1]-w:Math.max(this.axisLength-w,30),(!t.isFalseyButZero(x[A])||""===x[A])&&("x"===this.units.pos?(w=this.chartRect.x1+w,O.x=f.axisX.labelOffset.x,O.y="start"===f.axisX.position?this.chartRect.padding.top+f.axisX.labelOffset.y+(c?5:20):this.chartRect.y1+f.axisX.labelOffset.y+(c?5:20)):(w=this.chartRect.y1-w,O.y=f.axisY.labelOffset.y-(c?k:0),O.x="start"===f.axisY.position?c?this.chartRect.padding.left+f.axisY.labelOffset.x:this.chartRect.x1-10:this.chartRect.x2+f.axisY.labelOffset.x+10),u.showGrid&&t.createGrid(w,A,this,this.gridOffset,this.chartRect[this.counterUnits.len](),s,[f.classNames.grid,f.classNames[this.units.dir]],p),u.showLabel&&t.createLabel(w,k,A,x,this,u.offset,O,r,[f.classNames.label,f.classNames[this.units.dir],"start"===u.position?f.classNames[u.position]:f.classNames.end],c,p))}.bind(this))},projectValue:function(s,r,c){throw new Error("Base axis can't be instantiated!")}}),t.Axis.units=i}(this||global,F),function(P,t){"use strict";t.AutoScaleAxis=t.Axis.extend({constructor:function i(d,s,r,c){var f=c.highLow||t.getHighLow(s,c,d.pos);this.bounds=t.getBounds(r[d.rectEnd]-r[d.rectStart],f,c.scaleMinSpace||20,c.onlyInteger),this.range={min:this.bounds.min,max:this.bounds.max},t.AutoScaleAxis.super.constructor.call(this,d,r,this.bounds.values,c)},projectValue:function l(d){return this.axisLength*(+t.getMultiValue(d,this.units.pos)-this.bounds.min)/this.bounds.range}})}(this||global,F),function(P,t){"use strict";t.FixedScaleAxis=t.Axis.extend({constructor:function i(d,s,r,c){var f=c.highLow||t.getHighLow(s,c,d.pos);this.divisor=c.divisor||1,this.ticks=c.ticks||t.times(this.divisor).map(function(p,u){return f.low+(f.high-f.low)/this.divisor*u}.bind(this)),this.ticks.sort(function(p,u){return p-u}),this.range={min:f.low,max:f.high},t.FixedScaleAxis.super.constructor.call(this,d,r,this.ticks,c),this.stepLength=this.axisLength/this.divisor},projectValue:function l(d){return this.axisLength*(+t.getMultiValue(d,this.units.pos)-this.range.min)/(this.range.max-this.range.min)}})}(this||global,F),function(P,t){"use strict";t.StepAxis=t.Axis.extend({constructor:function i(d,s,r,c){t.StepAxis.super.constructor.call(this,d,r,c.ticks,c);var f=Math.max(1,c.ticks.length-(c.stretch?1:0));this.stepLength=this.axisLength/f},projectValue:function l(d,s){return this.stepLength*s}})}(this||global,F),function(P,t){"use strict";var i={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,type:void 0},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,type:void 0,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,showLine:!0,showPoint:!0,showArea:!1,areaBase:0,lineSmooth:!0,showGridBackground:!1,low:void 0,high:void 0,chartPadding:{top:15,right:15,bottom:5,left:10},fullWidth:!1,reverseData:!1,classNames:{chart:"ct-chart-line",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",line:"ct-line",point:"ct-point",area:"ct-area",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};t.Line=t.Base.extend({constructor:function d(s,r,c,f){t.Line.super.constructor.call(this,s,r,i,t.extend({},i,c),f)},createChart:function l(s){var r=t.normalizeData(this.data,s.reverseData,!0);this.svg=t.createSvg(this.container,s.width,s.height,s.classNames.chart);var _,x,c=this.svg.elem("g").addClass(s.classNames.gridGroup),f=this.svg.elem("g"),p=this.svg.elem("g").addClass(s.classNames.labelGroup),u=t.createChartRect(this.svg,s,i.padding);_=void 0===s.axisX.type?new t.StepAxis(t.Axis.units.x,r.normalized.series,u,t.extend({},s.axisX,{ticks:r.normalized.labels,stretch:s.fullWidth})):s.axisX.type.call(t,t.Axis.units.x,r.normalized.series,u,s.axisX),x=void 0===s.axisY.type?new t.AutoScaleAxis(t.Axis.units.y,r.normalized.series,u,t.extend({},s.axisY,{high:t.isNumeric(s.high)?s.high:s.axisY.high,low:t.isNumeric(s.low)?s.low:s.axisY.low})):s.axisY.type.call(t,t.Axis.units.y,r.normalized.series,u,s.axisY),_.createGridAndLabels(c,p,this.supportsForeignObject,s,this.eventEmitter),x.createGridAndLabels(c,p,this.supportsForeignObject,s,this.eventEmitter),s.showGridBackground&&t.createGridBackground(c,u,s.classNames.gridBackground,this.eventEmitter),r.raw.series.forEach(function(w,A){var O=f.elem("g");O.attr({"ct:series-name":w.name,"ct:meta":t.serialize(w.meta)}),O.addClass([s.classNames.series,w.className||s.classNames.series+"-"+t.alphaNumerate(A)].join(" "));var k=[],X=[];r.normalized.series[A].forEach(function(v,b){var U={x:u.x1+_.projectValue(v,b,r.normalized.series[A]),y:u.y1-x.projectValue(v,b,r.normalized.series[A])};k.push(U.x,U.y),X.push({value:v,valueIndex:b,meta:t.getMetaData(w,b)})}.bind(this));var j={lineSmooth:t.getSeriesOption(w,s,"lineSmooth"),showPoint:t.getSeriesOption(w,s,"showPoint"),showLine:t.getSeriesOption(w,s,"showLine"),showArea:t.getSeriesOption(w,s,"showArea"),areaBase:t.getSeriesOption(w,s,"areaBase")},M=("function"==typeof j.lineSmooth?j.lineSmooth:j.lineSmooth?t.Interpolation.monotoneCubic():t.Interpolation.none())(k,X);if(j.showPoint&&M.pathElements.forEach(function(v){var b=O.elem("line",{x1:v.x,y1:v.y,x2:v.x+.01,y2:v.y},s.classNames.point).attr({"ct:value":[v.data.value.x,v.data.value.y].filter(t.isNumeric).join(","),"ct:meta":t.serialize(v.data.meta)});this.eventEmitter.emit("draw",{type:"point",value:v.data.value,index:v.data.valueIndex,meta:v.data.meta,series:w,seriesIndex:A,axisX:_,axisY:x,group:O,element:b,x:v.x,y:v.y})}.bind(this)),j.showLine){var T=O.elem("path",{d:M.stringify()},s.classNames.line,!0);this.eventEmitter.emit("draw",{type:"line",values:r.normalized.series[A],path:M.clone(),chartRect:u,index:A,series:w,seriesIndex:A,seriesMeta:w.meta,axisX:_,axisY:x,group:O,element:T})}if(j.showArea&&x.range){var N=Math.max(Math.min(j.areaBase,x.range.max),x.range.min),z=u.y1-x.projectValue(N);M.splitByCommand("M").filter(function(b){return b.pathElements.length>1}).map(function(b){var U=b.pathElements[0],E=b.pathElements[b.pathElements.length-1];return b.clone(!0).position(0).remove(1).move(U.x,z).line(U.x,U.y).position(b.pathElements.length+1).line(E.x,z)}).forEach(function(b){var U=O.elem("path",{d:b.stringify()},s.classNames.area,!0);this.eventEmitter.emit("draw",{type:"area",values:r.normalized.series[A],path:b.clone(),series:w,seriesIndex:A,axisX:_,axisY:x,chartRect:u,index:A,group:O,element:U})}.bind(this))}}.bind(this)),this.eventEmitter.emit("created",{bounds:x.bounds,chartRect:u,axisX:_,axisY:x,svg:this.svg,options:s})}})}(this||global,F),function(P,t){"use strict";var i={axisX:{offset:30,position:"end",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,scaleMinSpace:30,onlyInteger:!1},axisY:{offset:40,position:"start",labelOffset:{x:0,y:0},showLabel:!0,showGrid:!0,labelInterpolationFnc:t.noop,scaleMinSpace:20,onlyInteger:!1},width:void 0,height:void 0,high:void 0,low:void 0,referenceValue:0,chartPadding:{top:15,right:15,bottom:5,left:10},seriesBarDistance:15,stackBars:!1,stackMode:"accumulate",horizontalBars:!1,distributeSeries:!1,reverseData:!1,showGridBackground:!1,classNames:{chart:"ct-chart-bar",horizontalBars:"ct-horizontal-bars",label:"ct-label",labelGroup:"ct-labels",series:"ct-series",bar:"ct-bar",grid:"ct-grid",gridGroup:"ct-grids",gridBackground:"ct-grid-background",vertical:"ct-vertical",horizontal:"ct-horizontal",start:"ct-start",end:"ct-end"}};t.Bar=t.Base.extend({constructor:function d(s,r,c,f){t.Bar.super.constructor.call(this,s,r,i,t.extend({},i,c),f)},createChart:function l(s){var r,c;s.distributeSeries?(r=t.normalizeData(this.data,s.reverseData,s.horizontalBars?"x":"y")).normalized.series=r.normalized.series.map(function(M){return[M]}):r=t.normalizeData(this.data,s.reverseData,s.horizontalBars?"x":"y"),this.svg=t.createSvg(this.container,s.width,s.height,s.classNames.chart+(s.horizontalBars?" "+s.classNames.horizontalBars:""));var f=this.svg.elem("g").addClass(s.classNames.gridGroup),p=this.svg.elem("g"),u=this.svg.elem("g").addClass(s.classNames.labelGroup);if(s.stackBars&&0!==r.normalized.series.length){var _=t.serialMap(r.normalized.series,function(){return Array.prototype.slice.call(arguments).map(function(T){return T}).reduce(function(T,N){return{x:T.x+(N&&N.x)||0,y:T.y+(N&&N.y)||0}},{x:0,y:0})});c=t.getHighLow([_],s,s.horizontalBars?"x":"y")}else c=t.getHighLow(r.normalized.series,s,s.horizontalBars?"x":"y");c.high=+s.high||(0===s.high?0:c.high),c.low=+s.low||(0===s.low?0:c.low);var w,A,O,k,X,x=t.createChartRect(this.svg,s,i.padding);A=s.distributeSeries&&s.stackBars?r.normalized.labels.slice(0,1):r.normalized.labels,s.horizontalBars?(w=k=void 0===s.axisX.type?new t.AutoScaleAxis(t.Axis.units.x,r.normalized.series,x,t.extend({},s.axisX,{highLow:c,referenceValue:0})):s.axisX.type.call(t,t.Axis.units.x,r.normalized.series,x,t.extend({},s.axisX,{highLow:c,referenceValue:0})),O=X=void 0===s.axisY.type?new t.StepAxis(t.Axis.units.y,r.normalized.series,x,{ticks:A}):s.axisY.type.call(t,t.Axis.units.y,r.normalized.series,x,s.axisY)):(O=k=void 0===s.axisX.type?new t.StepAxis(t.Axis.units.x,r.normalized.series,x,{ticks:A}):s.axisX.type.call(t,t.Axis.units.x,r.normalized.series,x,s.axisX),w=X=void 0===s.axisY.type?new t.AutoScaleAxis(t.Axis.units.y,r.normalized.series,x,t.extend({},s.axisY,{highLow:c,referenceValue:0})):s.axisY.type.call(t,t.Axis.units.y,r.normalized.series,x,t.extend({},s.axisY,{highLow:c,referenceValue:0})));var j=s.horizontalBars?x.x1+w.projectValue(0):x.y1-w.projectValue(0),Z=[];O.createGridAndLabels(f,u,this.supportsForeignObject,s,this.eventEmitter),w.createGridAndLabels(f,u,this.supportsForeignObject,s,this.eventEmitter),s.showGridBackground&&t.createGridBackground(f,x,s.classNames.gridBackground,this.eventEmitter),r.raw.series.forEach(function(M,T){var z,v,N=T-(r.raw.series.length-1)/2;z=s.distributeSeries&&!s.stackBars?O.axisLength/r.normalized.series.length/2:s.distributeSeries&&s.stackBars?O.axisLength/2:O.axisLength/r.normalized.series[T].length/2,(v=p.elem("g")).attr({"ct:series-name":M.name,"ct:meta":t.serialize(M.meta)}),v.addClass([s.classNames.series,M.className||s.classNames.series+"-"+t.alphaNumerate(T)].join(" ")),r.normalized.series[T].forEach(function(b,U){var E,Y,C,I;if(I=s.distributeSeries&&!s.stackBars?T:s.distributeSeries&&s.stackBars?0:U,E=s.horizontalBars?{x:x.x1+w.projectValue(b&&b.x?b.x:0,U,r.normalized.series[T]),y:x.y1-O.projectValue(b&&b.y?b.y:0,I,r.normalized.series[T])}:{x:x.x1+O.projectValue(b&&b.x?b.x:0,I,r.normalized.series[T]),y:x.y1-w.projectValue(b&&b.y?b.y:0,U,r.normalized.series[T])},O instanceof t.StepAxis&&(O.options.stretch||(E[O.units.pos]+=z*(s.horizontalBars?-1:1)),E[O.units.pos]+=s.stackBars||s.distributeSeries?0:N*s.seriesBarDistance*(s.horizontalBars?-1:1)),Z[U]=(C=Z[U]||j)-(j-E[O.counterUnits.pos]),void 0!==b){var J={};J[O.units.pos+"1"]=E[O.units.pos],J[O.units.pos+"2"]=E[O.units.pos],!s.stackBars||"accumulate"!==s.stackMode&&s.stackMode?(J[O.counterUnits.pos+"1"]=j,J[O.counterUnits.pos+"2"]=E[O.counterUnits.pos]):(J[O.counterUnits.pos+"1"]=C,J[O.counterUnits.pos+"2"]=Z[U]),J.x1=Math.min(Math.max(J.x1,x.x1),x.x2),J.x2=Math.min(Math.max(J.x2,x.x1),x.x2),J.y1=Math.min(Math.max(J.y1,x.y2),x.y1),J.y2=Math.min(Math.max(J.y2,x.y2),x.y1);var V=t.getMetaData(M,U);Y=v.elem("line",J,s.classNames.bar).attr({"ct:value":[b.x,b.y].filter(t.isNumeric).join(","),"ct:meta":t.serialize(V)}),this.eventEmitter.emit("draw",t.extend({type:"bar",value:b,index:U,meta:V,series:M,seriesIndex:T,axisX:k,axisY:X,chartRect:x,group:v,element:Y},J))}}.bind(this))}.bind(this)),this.eventEmitter.emit("created",{bounds:w.bounds,chartRect:x,axisX:k,axisY:X,svg:this.svg,options:s})}})}(this||global,F),function(P,t){"use strict";var i={width:void 0,height:void 0,chartPadding:5,classNames:{chartPie:"ct-chart-pie",chartDonut:"ct-chart-donut",series:"ct-series",slicePie:"ct-slice-pie",sliceDonut:"ct-slice-donut",sliceDonutSolid:"ct-slice-donut-solid",label:"ct-label"},startAngle:0,total:void 0,donut:!1,donutSolid:!1,donutWidth:60,showLabel:!0,labelOffset:0,labelPosition:"inside",labelInterpolationFnc:t.noop,labelDirection:"neutral",reverseData:!1,ignoreEmptyValues:!1};function l(r,c,f){var p=c.x>r.x;return p&&"explode"===f||!p&&"implode"===f?"start":p&&"implode"===f||!p&&"explode"===f?"end":"middle"}t.Pie=t.Base.extend({constructor:function s(r,c,f,p){t.Pie.super.constructor.call(this,r,c,i,t.extend({},i,f),p)},createChart:function d(r){var p,u,_,x,w,c=t.normalizeData(this.data),f=[],A=r.startAngle;this.svg=t.createSvg(this.container,r.width,r.height,r.donut?r.classNames.chartDonut:r.classNames.chartPie),u=t.createChartRect(this.svg,r,i.padding),_=Math.min(u.width()/2,u.height()/2),w=r.total||c.normalized.series.reduce(function(j,Z){return j+Z},0);var O=t.quantity(r.donutWidth);"%"===O.unit&&(O.value*=_/100),_-=r.donut&&!r.donutSolid?O.value/2:0,x="outside"===r.labelPosition||r.donut&&!r.donutSolid?_:"center"===r.labelPosition?0:r.donutSolid?_-O.value/2:_/2,x+=r.labelOffset;var k={x:u.x1+u.width()/2,y:u.y2+u.height()/2},X=1===c.raw.series.filter(function(j){return j.hasOwnProperty("value")?0!==j.value:0!==j}).length;c.raw.series.forEach(function(j,Z){f[Z]=this.svg.elem("g",null,null)}.bind(this)),r.showLabel&&(p=this.svg.elem("g",null,null)),c.raw.series.forEach(function(j,Z){if(0!==c.normalized.series[Z]||!r.ignoreEmptyValues){f[Z].attr({"ct:series-name":j.name}),f[Z].addClass([r.classNames.series,j.className||r.classNames.series+"-"+t.alphaNumerate(Z)].join(" "));var M=w>0?A+c.normalized.series[Z]/w*360:0,T=Math.max(0,A-(0===Z||X?0:.2));M-T>=359.99&&(M=T+359.99);var v,b,U,N=t.polarToCartesian(k.x,k.y,_,T),z=t.polarToCartesian(k.x,k.y,_,M),E=new t.Svg.Path(!r.donut||r.donutSolid).move(z.x,z.y).arc(_,_,0,M-A>180,0,N.x,N.y);r.donut?r.donutSolid&&(v=t.polarToCartesian(k.x,k.y,U=_-O.value,A-(0===Z||X?0:.2)),b=t.polarToCartesian(k.x,k.y,U,M),E.line(v.x,v.y),E.arc(U,U,0,M-A>180,1,b.x,b.y)):E.line(k.x,k.y);var Y=r.classNames.slicePie;r.donut&&(Y=r.classNames.sliceDonut,r.donutSolid&&(Y=r.classNames.sliceDonutSolid));var C=f[Z].elem("path",{d:E.stringify()},Y);if(C.attr({"ct:value":c.normalized.series[Z],"ct:meta":t.serialize(j.meta)}),r.donut&&!r.donutSolid&&(C._node.style.strokeWidth=O.value+"px"),this.eventEmitter.emit("draw",{type:"slice",value:c.normalized.series[Z],totalDataSum:w,index:Z,meta:j.meta,series:j,group:f[Z],element:C,path:E.clone(),center:k,radius:_,startAngle:A,endAngle:M}),r.showLabel){var I,J;I=1===c.raw.series.length?{x:k.x,y:k.y}:t.polarToCartesian(k.x,k.y,x,A+(M-A)/2),J=c.normalized.labels&&!t.isFalseyButZero(c.normalized.labels[Z])?c.normalized.labels[Z]:c.normalized.series[Z];var V=r.labelInterpolationFnc(J,Z);if(V||0===V){var H=p.elem("text",{dx:I.x,dy:I.y,"text-anchor":l(k,I,r.labelDirection)},r.classNames.label).text(""+V);this.eventEmitter.emit("draw",{type:"label",index:Z,group:p,element:H,text:""+V,x:I.x,y:I.y})}}A=M}}.bind(this)),this.eventEmitter.emit("created",{chartRect:u,svg:this.svg,options:r})},determineAnchorPosition:l})}(this||global,F),F}()}.apply(fe,[]),void 0!==B&&(Ue.exports=B)}}]);
//# sourceMappingURL=apps_concierge_src_app_reports_reports_module_ts.js.map