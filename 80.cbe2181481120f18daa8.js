(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([[80],{4080:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ScheduleModule:()=>Ge});var i=n(856),s=n(1511),o=n(6073),a=n(6898),l=n(9144),c=n(9996),r=n(3206),u=n(4762),d=n(2547),g=n(3743),h=n(7022),p=n(205),f=n(4941),m=n(6280),v=n(8125),Z=n(3848),_=n(8512),x=n(3080),w=n(1225),A=n(878),y=n(7701),b=n(4689),q=n(7727),T=n(8303),M=n(3530),U=n(2619),k=n(4608);let O=(()=>{class e extends r.KG{constructor(e,t,n){super(),this._calendars=e,this._dialog=t,this._router=n,this._loading=new _.X(""),this._poll=new _.X(!1),this._active_item=new _.X(""),this._options=new _.X({date:(new Date).valueOf()}),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.calendars=this._calendars.calendar_list,this.events=(0,x.aj)([this._options,this._poll]).pipe((0,y.b)(1e3),(0,b.w)(([e])=>{this._loading.next(" ");const t=(0,p.Z)(e.date).valueOf();let n=function(e){return(0,m.Z)(1,arguments),(0,f.Z)(e,Date.now())}(t)?6:4;const i=(0,v.Z)((0,Z.Z)(t,n)).valueOf();return"desks"===e.calendar?(0,d.F2)({period_start:Math.floor(t/1e3),period_end:Math.floor(i/1e3),type:"desk"}):(0,h.u$)({period_start:Math.floor(t/1e3),period_end:Math.floor(i/1e3),calendars:e.calendar})}),(0,q.K)(e=>[]),(0,T.d)(1)),this.active_item=this._active_item.pipe((0,y.b)(500),(0,b.w)(e=>e?(0,h.Vh)(e,{calendar:this._options.getValue().calendar||(0,r.ar)().email}):(0,w._)("No ID")),(0,q.K)(e=>this._active_item.getValue()?(0,d.Fo)(this._active_item.getValue()):(0,A.of)(null)),(0,q.K)(e=>(0,A.of)(null)),(0,c.U)(e=>(this._item=e,e)),(0,T.d)()),this.calendars.pipe((0,M.P)(e=>(null==e?void 0:e.length)>0)).subscribe(e=>this.setOptions({calendar:e[0].id}))}get date(){return this._options.getValue().date}setOptions(e){this._options.next(Object.assign(Object.assign({},this._options.getValue()),e))}setItem(e){this._active_item.next(e)}startPolling(e=15e3){this._poll.next(!this._poll.getValue()),this.interval("poll",()=>this._poll.next(!this._poll.getValue()),e)}stopPolling(){this.clearInterval("poll")}duplicateEvent(){if(sessionStorage){const e=new h.ym(Object.assign(Object.assign({},this._item),{id:""}));sessionStorage.setItem("STAFF.booking_form",JSON.stringify(e))}this._router.navigate(["/book"])}deleteEvent(){return(0,u.mG)(this,void 0,void 0,function*(){if(!this._item)return;const e=yield(0,r._5)({title:"Cancel Meeting",content:`Are you sure you want to cancel this meeting: ${this._item.title}`,icon:{content:"delete"}},this._dialog);if(!e)return;const t=this._item instanceof h.ym;e.loading(`Cancelling ${t?"meeting":"desk booking"}...`);const n=t?(0,h.xC)(this._item.id).toPromise():(0,d.pv)(this._item.id).toPromise(),i=yield n.catch(e=>e);if(e.close(),i)return(0,r.cB)(`Error unable to cancel ${t?"meeting":"desk booking"}. Error: ${i.statusText||i.message||i}`);(0,r.t5)(`Successfully cancelled ${t?"meeting":"desk booking"}.`),this._router.navigate(["/schedule","listing"],{queryParamsHandling:"preserve"})})}}return e.\u0275fac=function(t){return new(t||e)(U.LFG(g.ot),U.LFG(k.uw),U.LFG(a.F0))},e.\u0275prov=U.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Y=n(9310),J=n(4441),C=n(6283),N=n(4786),I=n(1522),D=n(5980),Q=n(8055),F=n(1548),P=n(6756),S=n(5812),E=n(8774),j=n(804);function L(e,t){1&e&&(U.TgZ(0,"app-icon"),U._uU(1,"cancel"),U.qZA())}function $(e,t){1&e&&(U.TgZ(0,"app-icon"),U._uU(1,"forum"),U.qZA())}function G(e,t){1&e&&(U.TgZ(0,"label"),U._uU(1,"(Cancelled)"),U.qZA())}const H=function(){return{type:"icon",class:"material-icons",content:"place"}};function V(e,t){1&e&&U._UZ(0,"app-icon",10),2&e&&U.Q6J("icon",U.DdM(1,H))}const W=function(e){return["/schedule","view",e]};let K=(()=>{class e{constructor(e){this._router=e}get isFuture(){return(0,E.Z)(this.event.date,new Date)}get status(){return this.event.status}get is_done(){return(0,Y.Z)((0,j.Z)(this.event.date,this.event.duration),new Date)}get location(){return this.event&&"date"!==this.event.type&&"empty"!==this.event.type?this.event.location:"No location"}get type_image(){return this.event&&"date"!==this.event.type&&"empty"!==this.event.type?this.event instanceof h.ym&&this.event.guests.length?"external":"book_room":"block"}get time(){return this.event.all_day||this.event.duration>1380?"All Day":(0,J.Z)(this.event.date,"h:mm a")}get query(){return{calendar:this.event.calendar,type:this.event.type}}}return e.\u0275fac=function(t){return new(t||e)(U.Y36(a.F0))},e.\u0275cmp=U.Xpm({type:e,selectors:[["schedule-event-item"]],inputs:{event:"event"},decls:15,vars:15,consts:[["matRipple","",1,"flex","mb-1",3,"routerLink","queryParams"],[1,"icon",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],[1,"flex","flex-col","h-20","flex-1","w-1/2","bg-white","p-2","justify-center"],[1,"text-lg","font-medium","capitalize","pl-1","truncate"],[1,"flex","items-center"],[3,"icon",4,"ngIf"],[1,"truncate","pl-1"],[3,"icon"]],template:function(e,t){1&e&&(U.TgZ(0,"a",0),U.TgZ(1,"div"),U.TgZ(2,"div",1),U.YNc(3,L,2,0,"app-icon",2),U.YNc(4,$,2,0,"app-icon",3),U.qZA(),U.TgZ(5,"div"),U._uU(6),U.qZA(),U.YNc(7,G,2,0,"label",4),U.qZA(),U.TgZ(8,"div",5),U.TgZ(9,"div",6),U._uU(10),U.qZA(),U.TgZ(11,"div",7),U.YNc(12,V,1,2,"app-icon",8),U.TgZ(13,"div",9),U._uU(14),U.qZA(),U.qZA(),U.qZA(),U.qZA()),2&e&&(U.Q6J("routerLink",U.VKq(13,W,t.event.id))("queryParams",t.query),U.xp6(1),U.Tol("h-20 w-20 flex flex-col items-center justify-center "+t.status),U.ekj("done",t.is_done),U.xp6(1),U.Q6J("ngSwitch",t.event.status),U.xp6(1),U.Q6J("ngSwitchCase","declined"),U.xp6(3),U.Oqu(t.time),U.xp6(1),U.Q6J("ngIf","declined"===t.event.status),U.xp6(3),U.hij(" ",t.event.title," "),U.xp6(2),U.Q6J("ngIf",!!t.location),U.xp6(2),U.hij(" ",t.location||"No location"," "))},directives:[a.yS,I.wG,s.RF,s.n9,s.ED,s.O5,F.o],styles:[".approved[_ngcontent-%COMP%], .confirmed[_ngcontent-%COMP%]{background:#388e3c;color:#fff}.tentative[_ngcontent-%COMP%]{background:#ffa000;color:#000}.cancelled[_ngcontent-%COMP%], .declined[_ngcontent-%COMP%]{background:#d32f2f;color:#fff}.done[_ngcontent-%COMP%]{opacity:.35}"]}),e})();function X(e,t){if(1&e&&U._UZ(0,"schedule-event-item",5),2&e){const e=t.$implicit;U.s9C("id",t.index),U.Q6J("event",e)}}function z(e,t){if(1&e&&(U.ynx(0),U.YNc(1,X,1,2,"schedule-event-item",4),U.BQk()),2&e){const e=U.oxw();U.xp6(1),U.Q6J("ngForOf",e.events)}}function B(e,t){if(1&e&&(U.TgZ(0,"div",6),U._uU(1),U.ALo(2,"date"),U.qZA()),2&e){const e=U.oxw();U.xp6(1),U.hij("No events for ",U.lcZ(2,1,e.date),"")}}let R=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=U.Xpm({type:e,selectors:[["schedule-event-date-list"]],inputs:{date:"date",events:"events"},decls:7,vars:6,consts:[[1,"text-xl","mb-4"],[4,"ngIf","ngIfElse"],["empty_state",""],[1,"mb-4"],[3,"id","event",4,"ngFor","ngForOf"],[3,"id","event"],[1,"p-8"]],template:function(e,t){if(1&e&&(U.TgZ(0,"div",0),U._uU(1),U.ALo(2,"date"),U.qZA(),U.YNc(3,z,2,1,"ng-container",1),U.YNc(4,B,3,3,"ng-template",null,2,U.W1O),U._UZ(6,"div",3)),2&e){const e=U.MAs(5);U.xp6(1),U.hij(" ",U.xi3(2,3,t.date,"fullDate")," "),U.xp6(2),U.Q6J("ngIf",null==t.events?null:t.events.length)("ngIfElse",e)}},directives:[s.O5,s.sg,K],pipes:[s.uU],styles:[""]}),e})();var ee=n(5994);function te(e,t){if(1&e&&(U.TgZ(0,"mat-option",22),U._uU(1),U.qZA()),2&e){const e=t.$implicit;U.Q6J("value",e.id),U.xp6(1),U.hij(" ",e.summary||"Calendar"," ")}}function ne(e,t){if(1&e&&(U._UZ(0,"schedule-event-date-list",23),U.ALo(1,"date")),2&e){const e=t.$implicit;U.Q6J("date",e.key)("events",e.value),U.uIk("date",U.xi3(1,3,e.key,"yyyy-MM-dd"))}}function ie(e,t){1&e&&U._UZ(0,"mat-progress-bar",24)}const se=function(){return{class:"material-icons",content:"event"}};let oe=(()=>{class e extends r.KG{constructor(e,t){super(),this._state=e,this._el=t,this.loading=this._state.loading,this.options=this._state.options,this.calendars=this._state.calendars,this.events=(0,x.aj)([this._state.events,this._state.options]).pipe((0,c.U)(([e,t])=>{let n=(0,p.Z)(new Date);const i=(0,Z.Z)(t.date||n,12),s={};let o=0;for(;o<e.length||(0,Y.Z)(n,i);){const t=(0,v.Z)(n),i=e.filter(e=>(0,r.MZ)(n.valueOf(),t.valueOf(),e.date,e.date+60*e.duration*1e3));o+=i.length,s[n.valueOf()]=i,n=(0,Z.Z)(n,1)}return s})),this.min_date=(0,p.Z)(new Date),this.setDate=e=>this._state.setOptions({date:e}),this.setCalendar=e=>this._state.setOptions({calendar:e})}ngOnInit(){this._state.startPolling()}ngOnDestroy(){super.ngOnDestroy(),this._state.stopPolling()}onScroll(e){var t;const n=Array.prototype.slice.call((null===(t=this._el)||void 0===t?void 0:t.nativeElement.querySelectorAll("schedule-event-date-list"))||[]);if(!(null==n?void 0:n.length))return;const i=e.target.scrollTop;let s=null;for(const a of n)if(a.offsetTop-i>0){s=a;break}if(!s)return;const o=new Date(s.getAttribute("date"));(0,f.Z)(o,this._state.date)||this.setDate(o.valueOf())}scrollTo(e){this.timeout("scroll_to",()=>{var t;const n=null===(t=this._el)||void 0===t?void 0:t.nativeElement.querySelector(`[date="${(0,J.Z)(e,"yyyy-MM-dd")}"]`);n&&n.scrollIntoView({behavior:"smooth",inline:"center"})},1e3)}}return e.\u0275fac=function(t){return new(t||e)(U.Y36(O),U.Y36(U.SBq))},e.\u0275cmp=U.Xpm({type:e,selectors:[["schedule-event-list"]],features:[U.qOj],decls:37,vars:23,consts:[[1,"flex","p-2","items-center","bg-white","border-b","border-gray-200","shadow","space-x-2"],["appearance","outline",1,"h-12"],["name","calendars",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","desks"],[1,"flex-1","w-0"],["mat-button","",1,"clear",3,"matMenuTriggerFor"],["legend","matMenu"],[1,"flex","items-center","px-4","py-2","hover:bg-gray-100"],[1,"bg-success","h-2","w-2","rounded-full","mr-4"],[1,"bg-pending","h-2","w-2","rounded-full","mr-4"],[1,"bg-error","h-2","w-2","rounded-full","mr-4"],["mat-icon-button","",1,"relative"],["dateMenu",""],[3,"icon"],["matInput","",1,"opacity-0","absolute","inset-0",3,"ngModel","matDatepicker","min","ngModelChange"],["matSuffix","",1,"opacity-0","absolute","inset-0",3,"for"],["picker",""],[1,"w-full","flex-1","h-1/2","flex","flex-col"],[1,"flex-1","w-full","h-1/2","overflow-auto","p-4",3,"scroll"],[3,"date","events",4,"ngFor","ngForOf"],["mode","indeterminate",4,"ngIf"],[3,"value"],[3,"date","events"],["mode","indeterminate"]],template:function(e,t){if(1&e&&(U.TgZ(0,"div",0),U.TgZ(1,"mat-form-field",1),U.TgZ(2,"mat-select",2),U.NdJ("ngModelChange",function(e){return t.setCalendar(e)}),U.ALo(3,"async"),U.YNc(4,te,2,2,"mat-option",3),U.ALo(5,"async"),U.TgZ(6,"mat-option",4),U._uU(7,"Desks"),U.qZA(),U.qZA(),U.qZA(),U._UZ(8,"div",5),U.TgZ(9,"button",6),U._uU(10," Legend "),U.qZA(),U.TgZ(11,"mat-menu",null,7),U.TgZ(13,"div",8),U._UZ(14,"div",9),U._uU(15," Approved "),U.qZA(),U.TgZ(16,"div",8),U._UZ(17,"div",10),U._uU(18," Tentative "),U.qZA(),U.TgZ(19,"div",8),U._UZ(20,"div",11),U._uU(21," Declined "),U.qZA(),U.qZA(),U.TgZ(22,"button",12,13),U._UZ(24,"app-icon",14),U.TgZ(25,"input",15),U.NdJ("ngModelChange",function(e){return t.setDate(e),t.scrollTo(e)}),U.ALo(26,"async"),U.qZA(),U._UZ(27,"mat-datepicker-toggle",16),U.qZA(),U._UZ(28,"mat-datepicker",null,17),U.qZA(),U.TgZ(30,"main",18),U.TgZ(31,"div",19),U.NdJ("scroll",function(e){return t.onScroll(e)}),U.YNc(32,ne,2,6,"schedule-event-date-list",20),U.ALo(33,"keyvalue"),U.ALo(34,"async"),U.qZA(),U.YNc(35,ie,1,0,"mat-progress-bar",21),U.ALo(36,"async"),U.qZA()),2&e){const e=U.MAs(12),n=U.MAs(29);let i;U.xp6(2),U.Q6J("ngModel",U.lcZ(3,10,t.options).calendar),U.xp6(2),U.Q6J("ngForOf",U.lcZ(5,12,t.calendars)),U.xp6(5),U.Q6J("matMenuTriggerFor",e),U.xp6(15),U.Q6J("icon",U.DdM(22,se)),U.xp6(1),U.Q6J("ngModel",null==(i=U.lcZ(26,14,t.options))?null:i.date)("matDatepicker",n)("min",t.min_date),U.xp6(2),U.Q6J("for",n),U.xp6(5),U.Q6J("ngForOf",U.lcZ(33,16,U.lcZ(34,18,t.events))),U.xp6(3),U.Q6J("ngIf",U.lcZ(36,20,t.loading))}},directives:[C.KE,N.gD,o.JJ,o.On,s.sg,I.ey,D.lW,Q.p6,Q.VK,F.o,P.Nt,o.Fj,S.hl,S.nW,C.R9,S.Mq,s.O5,R,ee.pW],pipes:[s.Ov,s.Nd,s.uU],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:50%;flex:1}main[_ngcontent-%COMP%]{background:#f0f0f0}"]}),e})();var ae=n(5251),le=n(6258),ce=n(5769);let re=(()=>{class e extends r.KG{constructor(e,t){super(),this._route=e,this._state=t,this.show_menu=!1}ngOnInit(){this.subscription("route.query",this._route.queryParamMap.subscribe(e=>{e.has("email")&&this._state.setOptions({calendar:e.get("email")})}))}}return e.\u0275fac=function(t){return new(t||e)(U.Y36(a.gz),U.Y36(O))},e.\u0275cmp=U.Xpm({type:e,selectors:[["app-schedule"]],features:[U.qOj],decls:4,vars:2,consts:[[3,"menu","menuChange"],[1,"w-full"],[3,"show","showChange"]],template:function(e,t){1&e&&(U.TgZ(0,"a-topbar-header",0),U.NdJ("menuChange",function(e){return t.show_menu=e}),U.qZA(),U._UZ(1,"router-outlet"),U._UZ(2,"a-footer-menu",1),U.TgZ(3,"a-overlay-menu",2),U.NdJ("showChange",function(e){return t.show_menu=e}),U.qZA()),2&e&&(U.Q6J("menu",t.show_menu),U.xp6(3),U.Q6J("show",t.show_menu))},directives:[ae.B,a.lC,le.i,ce.t],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}"]}),e})();var ue=n(4164),de=n(4312),ge=n(7531);function he(e,t){if(1&e){const e=U.EpF();U.TgZ(0,"button",10),U.NdJ("click",function(){return U.CHM(e),U.oxw().locate()}),U._uU(1," View "),U.qZA()}}let pe=(()=>{class e extends r.KG{constructor(e,t){super(),this._state=e,this._dialog=t,this.event=this._state.active_item,this.when=this.event.pipe((0,c.U)(e=>{if(!e)return"Unable to determine.";const t=de(e.date),n=t.add(e.duration||60,"m");return e.all_day||e.duration>1380?`${t.format("DD MMM YYYY")} - All Day`:t.isSame(n,"d")?`${t.format("DD MMM YYYY, h:mm A")} - ${n.format("h:mm A")}`:`${t.format("DD MMM YYYY, h:mm A")} - ${n.format("DD MMM YYYY, h:mm A")}`})),this.deleteEvent=()=>this._state.deleteEvent()}locate(){return(0,u.mG)(this,void 0,void 0,function*(){const e=yield this.event.toPromise(),t=new ue.T({name:"Desk Booking",map_id:e.asset_id,zones:e.zones});this._dialog.open(ge.k,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{space:t}})})}}return e.\u0275fac=function(t){return new(t||e)(U.Y36(O),U.Y36(k.uw))},e.\u0275cmp=U.Xpm({type:e,selectors:[["schedule-booking-details"]],features:[U.qOj],decls:33,vars:15,consts:[[1,"flex","flex-col","items-center","mb-4"],[1,"text-xl","capitalize","mb-2","font-medium"],[1,"rounded","py-4","bg-white","border-gray-300","shadow","space-y-4","w-full","text-lg"],[1,"flex","items-center","space-x-2","px-3"],[1,"text-2xl"],[1,"flex-1"],[1,"ml-12"],[1,"flex","items-center","space-x-2","px-4"],["class","w-24","mat-button","",3,"click",4,"ngIf"],["mat-button","",1,"error","w-24",3,"click"],["mat-button","",1,"w-24",3,"click"]],template:function(e,t){if(1&e&&(U.TgZ(0,"div"),U.TgZ(1,"div",0),U.TgZ(2,"div",1),U._uU(3),U.ALo(4,"async"),U.qZA(),U.qZA(),U.TgZ(5,"div",2),U.TgZ(6,"div",3),U.TgZ(7,"app-icon",4),U._uU(8,"perm_identity"),U.qZA(),U.TgZ(9,"div",5),U._uU(10),U.ALo(11,"async"),U.qZA(),U.qZA(),U._UZ(12,"hr",6),U.TgZ(13,"div",3),U.TgZ(14,"app-icon",4),U._uU(15,"schedule"),U.qZA(),U.TgZ(16,"div",5),U._uU(17),U.ALo(18,"async"),U.qZA(),U.qZA(),U._UZ(19,"hr",6),U.TgZ(20,"div",3),U.TgZ(21,"app-icon",4),U._uU(22,"place"),U.qZA(),U.TgZ(23,"div",5),U._uU(24),U.ALo(25,"async"),U.qZA(),U.qZA(),U._UZ(26,"hr",6),U.TgZ(27,"div",7),U.YNc(28,he,2,0,"button",8),U.ALo(29,"async"),U._UZ(30,"div",5),U.TgZ(31,"button",9),U.NdJ("click",function(){return t.deleteEvent()}),U._uU(32," Delete "),U.qZA(),U.qZA(),U.qZA(),U.qZA()),2&e){let e,n,i,s;U.xp6(3),U.hij(" ",(null==(e=U.lcZ(4,5,t.event))?null:e.title)||"No Title"," "),U.xp6(7),U.Oqu(null==(n=U.lcZ(11,7,t.event))?null:n.user_name),U.xp6(7),U.Oqu(U.lcZ(18,9,t.when)),U.xp6(7),U.Oqu(null==(i=U.lcZ(25,11,t.event))?null:i.description),U.xp6(4),U.Q6J("ngIf",null==(s=U.lcZ(29,13,t.event))?null:s.asset_id)}},directives:[F.o,s.O5,D.lW],pipes:[s.Ov],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin:auto;width:640px;max-width:100vw;padding:1rem}"]}),e})();var fe=n(8276),me=n(2962),ve=n(6905),Ze=n(7052),_e=n(8084);function xe(e,t){if(1&e){const e=U.EpF();U.TgZ(0,"form",1),U.NdJ("ngSubmit",function(){return U.CHM(e),U.oxw().save()}),U._UZ(1,"booking-edit",2),U.TgZ(2,"div",3),U.TgZ(3,"button",4),U.NdJ("click",function(){return U.CHM(e),U.oxw().cancel()}),U._uU(4," Cancel "),U.qZA(),U.TgZ(5,"button",5),U._uU(6,"Save"),U.qZA(),U.qZA(),U.qZA()}if(2&e){const e=U.oxw();U.Q6J("formGroup",e.form),U.xp6(1),U.Q6J("form",e.form)("event",e.event)}}let we=(()=>{class e extends r.KG{constructor(e){super(),this._dialog=e,this.change=new U.vpe,this.loading=new U.vpe}ngOnInit(){this.event&&(this.form=(0,h.r7)(this.event))}ngOnChanges(e){e.event&&this.event&&(this.form=(0,h.r7)(this.event))}cancel(){this.change.emit({type:"cancel_edit"})}save(){if(this.form.markAllAsTouched(),this.form.valid){const e=this._dialog.open(Ze.A,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{booking:this.event}});e.componentInstance.event.subscribe(t=>{"success"===t.reason&&(this.change.emit({type:"view"}),e.close())})}else console.warn("Some form fields are invalid:",this.form)}handleEvent(e){}}return e.\u0275fac=function(t){return new(t||e)(U.Y36(k.uw))},e.\u0275cmp=U.Xpm({type:e,selectors:[["schedule-event-edit"]],inputs:{event:"event"},outputs:{change:"change",loading:"loading"},features:[U.qOj,U.TTD],decls:1,vars:1,consts:[["class","grid m-auto mt-8",3,"formGroup","ngSubmit",4,"ngIf"],[1,"grid","m-auto","mt-8",3,"formGroup","ngSubmit"],[3,"form","event"],[1,"footer","flex","items-center","justify-center","w-full","p-2","space-x-2"],["mat-button","","type","button",1,"inverse",3,"click"],["mat-button","","type","submit"]],template:function(e,t){1&e&&U.YNc(0,xe,7,3,"form",0),2&e&&U.Q6J("ngIf",t.form&&t.event)},directives:[s.O5,o._Y,o.JL,o.sg,_e.e,D.lW],styles:['form[_ngcontent-%COMP%]{grid-template-columns:-webkit-max-content;grid-template-columns:max-content;grid-template-rows:1fr auto;grid-template-areas:"edit" "actions";max-width:600px}booking-edit[_ngcontent-%COMP%], schedule-event-view[_ngcontent-%COMP%]{grid-area:edit}.footer[_ngcontent-%COMP%]{grid-area:actions}']}),e})();function Ae(e,t){if(1&e){const e=U.EpF();U.TgZ(0,"button",21),U.NdJ("click",function(){U.CHM(e);const t=U.oxw().$implicit;return U.oxw(4).showSpace(t)}),U._uU(1," View "),U.qZA()}}function ye(e,t){if(1&e&&(U.TgZ(0,"div",18),U.TgZ(1,"label",19),U._uU(2),U.qZA(),U.YNc(3,Ae,2,0,"button",20),U.qZA()),2&e){const e=t.$implicit;U.xp6(2),U.Oqu((null==e?null:e.name)||"No location"),U.xp6(1),U.Q6J("ngIf",null==e?null:e.map_id)}}function be(e,t){if(1&e&&(U.TgZ(0,"div",16),U.YNc(1,ye,4,2,"div",17),U.qZA()),2&e){const e=U.oxw(3);U.xp6(1),U.Q6J("ngForOf",e.spaces)}}function qe(e,t){if(1&e&&(U.TgZ(0,"div",5),U.TgZ(1,"app-icon",6),U._uU(2,"place"),U.qZA(),U.YNc(3,be,2,1,"div",15),U.qZA()),2&e){const e=U.oxw(2);U.xp6(3),U.Q6J("ngIf","event"===e.event.type)}}function Te(e,t){1&e&&U._UZ(0,"hr",8)}function Me(e,t){if(1&e){const e=U.EpF();U.TgZ(0,"button",21),U.NdJ("click",function(){return U.CHM(e),U.oxw(3).showAttendees()}),U._uU(1," View "),U.qZA()}}function Ue(e,t){if(1&e&&(U.TgZ(0,"div",5),U.TgZ(1,"app-icon",6),U._uU(2,"people_outline"),U.qZA(),U.TgZ(3,"div",22),U.TgZ(4,"p",19),U._uU(5),U.qZA(),U.YNc(6,Me,2,0,"button",20),U.qZA(),U.qZA()),2&e){const e=U.oxw(2);U.xp6(5),U.hij(" ",e.attendees.length," Attendees "),U.xp6(1),U.Q6J("ngIf",e.attendees.length>0)}}function ke(e,t){1&e&&U._UZ(0,"hr",8)}function Oe(e,t){if(1&e&&(U.TgZ(0,"div",5),U.TgZ(1,"app-icon",6),U._uU(2,"screen_share"),U.qZA(),U.TgZ(3,"div",7),U.TgZ(4,"a",23),U._uU(5),U.qZA(),U.qZA(),U.qZA()),2&e){const e=U.oxw(2);U.xp6(4),U.s9C("href",e.link,U.LSH),U.xp6(1),U.Oqu(e.link)}}function Ye(e,t){1&e&&U._UZ(0,"hr",8)}function Je(e,t){if(1&e){const e=U.EpF();U.TgZ(0,"div",24),U.TgZ(1,"app-icon",6),U._uU(2,"people_outline"),U.qZA(),U.TgZ(3,"div",22),U.TgZ(4,"p",19),U._uU(5,"Catered"),U.qZA(),U.TgZ(6,"button",21),U.NdJ("click",function(){return U.CHM(e),U.oxw(2).showCatering()}),U._uU(7," View "),U.qZA(),U.qZA(),U.qZA()}}function Ce(e,t){1&e&&U._UZ(0,"hr",8)}function Ne(e,t){if(1&e&&(U.TgZ(0,"div",24),U.TgZ(1,"app-icon",6),U._uU(2,"subject"),U.qZA(),U._UZ(3,"div",25),U.qZA()),2&e){const e=U.oxw(2);U.xp6(3),U.Q6J("innerHTML",e.body,U.oJD)}}function Ie(e,t){1&e&&U._UZ(0,"hr",8)}function De(e,t){if(1&e){const e=U.EpF();U.TgZ(0,"div"),U.TgZ(1,"div",2),U.TgZ(2,"div",3),U._uU(3),U.qZA(),U.qZA(),U.TgZ(4,"div",4),U.TgZ(5,"div",5),U.TgZ(6,"app-icon",6),U._uU(7,"perm_identity"),U.qZA(),U.TgZ(8,"div",7),U._uU(9),U.qZA(),U.qZA(),U._UZ(10,"hr",8),U.TgZ(11,"div",5),U.TgZ(12,"app-icon",6),U._uU(13,"schedule"),U.qZA(),U.TgZ(14,"div",7),U._uU(15),U.qZA(),U.qZA(),U._UZ(16,"hr",8),U.YNc(17,qe,4,1,"div",9),U.YNc(18,Te,1,0,"hr",10),U.YNc(19,Ue,7,2,"div",9),U.YNc(20,ke,1,0,"hr",10),U.YNc(21,Oe,6,2,"div",9),U.YNc(22,Ye,1,0,"hr",10),U.YNc(23,Je,8,0,"div",11),U.YNc(24,Ce,1,0,"hr",10),U.YNc(25,Ne,4,1,"div",11),U.YNc(26,Ie,1,0,"hr",10),U.TgZ(27,"div",12),U.TgZ(28,"button",13),U.NdJ("click",function(){return U.CHM(e),U.oxw().duplicateEvent()}),U._uU(29," Duplicate "),U.qZA(),U.TgZ(30,"button",14),U.NdJ("click",function(){return U.CHM(e),U.oxw().deleteEvent()}),U._uU(31," Delete "),U.qZA(),U.qZA(),U.qZA(),U.qZA()}if(2&e){const e=U.oxw();U.xp6(3),U.hij(" ",(null==e.event?null:e.event.title)||"No Title"," "),U.xp6(6),U.Oqu(null==e.event||null==e.event.organiser?null:e.event.organiser.name),U.xp6(6),U.Oqu(e.when),U.xp6(2),U.Q6J("ngIf",e.spaces&&e.spaces.length),U.xp6(1),U.Q6J("ngIf",e.spaces&&e.spaces.length),U.xp6(1),U.Q6J("ngIf",null==e.attendees?null:e.attendees.length),U.xp6(1),U.Q6J("ngIf",null==e.attendees?null:e.attendees.length),U.xp6(1),U.Q6J("ngIf",e.link),U.xp6(1),U.Q6J("ngIf",e.link),U.xp6(1),U.Q6J("ngIf",null==e.catering_items?null:e.catering_items.length),U.xp6(1),U.Q6J("ngIf",null==e.catering_items?null:e.catering_items.length),U.xp6(1),U.Q6J("ngIf",e.body),U.xp6(1),U.Q6J("ngIf",e.body)}}function Qe(e,t){if(1&e&&U._UZ(0,"schedule-event-edit",26),2&e){const e=U.oxw();U.Q6J("event",e.event)}}let Fe=(()=>{class e extends r.KG{constructor(e,t,n){super(),this._dialog=e,this._spaces=t,this._state=n,this.editing=!1,this.deleteEvent=()=>this._state.deleteEvent(),this.duplicateEvent=()=>this._state.duplicateEvent(),this.editEvent=()=>this.editing=!0}get organiser(){return this.event.creator||(0,r.ar)().name}get when(){if(!this.event)return"Unable to determine.";const e=de(this.event.date),t=e.add(this.event.duration||60,"m");return this.event.all_day||this.event.duration>1380?`${e.format("DD MMM YYYY")} - All Day`:e.isSame(t,"d")?`${e.format("DD MMM YYYY, h:mm A")} - ${t.format("h:mm A")}`:`${e.format("DD MMM YYYY, h:mm A")} - ${t.format("DD MMM YYYY, h:mm A")}`}get duration(){return(0,fe.Z)({minutes:this.event.duration||60})}get catering_items(){var e;if(!(null===(e=this.event.ext("catering"))||void 0===e?void 0:e.length))return;const t=this.event.ext("catering")[0];return t?[...t.items]:[]}get catering_note(){return""}get spaces(){var e;return(null===(e=this.event.resources)||void 0===e?void 0:e.length)?this.event.resources.map(e=>this._spaces.find(e.email)):[]}get attendees(){var e;return(null===(e=this.event.attendees)||void 0===e?void 0:e.filter(e=>e.email!==this.event.creator))||[]}get link(){return this.event.ext("meeting_link")}get body(){return this.event.body}showCatering(){this._dialog.open(ve.G,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{catering:this.catering_items,catering_note:this.catering_note}})}showAttendees(){this._dialog.open(me.J,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{attendees:this.attendees}})}showSpace(e){const t=this._spaces.find(e.id);this._dialog.open(ge.k,{width:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:t}})}}return e.\u0275fac=function(t){return new(t||e)(U.Y36(k.uw),U.Y36(ue.sK),U.Y36(O))},e.\u0275cmp=U.Xpm({type:e,selectors:[["schedule-event-details"]],inputs:{event:"event"},features:[U.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["edit_state",""],[1,"flex","flex-col","items-center","mb-4"],[1,"text-xl","capitalize","mb-2","font-medium"],[1,"rounded","py-4","bg-white","border-gray-300","shadow","space-y-4","w-full","text-lg"],[1,"flex","items-center","space-x-2","px-3"],[1,"text-2xl"],[1,"flex-1"],[1,"ml-12"],["class","flex items-center space-x-2 px-3",4,"ngIf"],["class","ml-12",4,"ngIf"],["class","flex space-x-2 px-3",4,"ngIf"],[1,"flex","items-center","space-x-2","px-4"],["mat-button","",1,"flex-1","inverse",3,"click"],["mat-button","",1,"flex-1","error",3,"click"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],["class","flex",4,"ngFor","ngForOf"],[1,"flex"],[1,"flex-1","w-1/2"],["mat-button","","class","clear underline",3,"click",4,"ngIf"],["mat-button","",1,"clear","underline",3,"click"],[1,"flex-1","flex","items-center"],["target","blank",1,"underline",3,"href"],[1,"flex","space-x-2","px-3"],[1,"flex","flex-col",3,"innerHTML"],[3,"event"]],template:function(e,t){if(1&e&&(U.YNc(0,De,32,13,"div",0),U.YNc(1,Qe,1,1,"ng-template",null,1,U.W1O)),2&e){const e=U.MAs(2);U.Q6J("ngIf",!t.editing)("ngIfElse",e)}},directives:[s.O5,F.o,D.lW,s.sg,we],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin:auto;width:640px;max-width:100vw;padding:1rem}"]}),e})();var Pe=n(7806);function Se(e,t){1&e&&U._UZ(0,"schedule-booking-details")}function Ee(e,t){if(1&e&&(U._UZ(0,"schedule-event-details",10),U.ALo(1,"async")),2&e){const e=U.oxw(2);U.Q6J("event",U.lcZ(1,1,e.event))}}function je(e,t){if(1&e&&(U.TgZ(0,"div"),U.ynx(1,7),U.YNc(2,Se,1,0,"schedule-booking-details",8),U.YNc(3,Ee,2,3,"schedule-event-details",9),U.BQk(),U.qZA()),2&e){const e=U.oxw();U.xp6(1),U.Q6J("ngSwitch",e.type),U.xp6(1),U.Q6J("ngSwitchCase","booking")}}function Le(e,t){if(1&e&&(U.TgZ(0,"div",11),U._UZ(1,"mat-spinner",12),U.TgZ(2,"p"),U._uU(3),U.ALo(4,"async"),U.qZA(),U.qZA()),2&e){const e=U.oxw();U.xp6(1),U.Q6J("diameter",48),U.xp6(2),U.Oqu(U.lcZ(4,2,e.loading)||"Loading event details...")}}const $e=[{path:"",component:re,children:[{path:"listing",component:oe},{path:"view/:id",component:(()=>{class e extends r.KG{constructor(e,t,n,i){super(),this._state=e,this._router=t,this._route=n,this._location=i,this.loading=this._state.loading,this.event=this._state.active_item,this.setOptions=e=>this._state.setOptions(e),this.setID=e=>this._state.setItem(e),this.type=""}ngOnInit(){this.subscription("route.params",(0,x.aj)([this._route.paramMap,this._route.queryParamMap]).subscribe(([e,t])=>{e.has("id")&&this.setID(e.get("id")),t.has("type")&&(this.type=t.get("type")),t.has("calendar")&&this.setOptions({calendar:t.get("calendar")})})),this.timeout("check_event",()=>(0,u.mG)(this,void 0,void 0,function*(){return this._router.navigate(["/schedule","listing"],{queryParamsHandling:"preserve"})}),3e3),this._state.active_item.pipe((0,M.P)(e=>!!e)).subscribe(()=>this.clearTimeout("check_event"))}back(){this._location.back()}}return e.\u0275fac=function(t){return new(t||e)(U.Y36(O),U.Y36(a.F0),U.Y36(a.gz),U.Y36(s.Ye))},e.\u0275cmp=U.Xpm({type:e,selectors:[["schedule-view-event"]],features:[U.qOj],decls:12,vars:6,consts:[[1,"w-full","h-12","flex","items-center","bg-white","shadow","px-2"],["mat-button","",1,"clear",3,"click"],[1,"flex","items-center"],[1,"mr-2"],[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"event",4,"ngSwitchDefault"],[3,"event"],[1,"p-8","flex","flex-col","items-center","justify-center","h-full","w-full"],[1,"mb-4",3,"diameter"]],template:function(e,t){if(1&e&&(U.TgZ(0,"div",0),U.TgZ(1,"button",1),U.NdJ("click",function(){return t.back()}),U.TgZ(2,"div",2),U.TgZ(3,"app-icon",3),U._uU(4,"keyboard_backspace"),U.qZA(),U._uU(5," Back "),U.qZA(),U.qZA(),U.qZA(),U.TgZ(6,"main",4),U.YNc(7,je,4,2,"div",5),U.ALo(8,"async"),U.ALo(9,"async"),U.qZA(),U.YNc(10,Le,5,4,"ng-template",null,6,U.W1O)),2&e){const e=U.MAs(11);U.xp6(7),U.Q6J("ngIf",U.lcZ(8,2,t.event)&&!U.lcZ(9,4,t.loading))("ngIfElse",e)}},directives:[D.lW,F.o,s.O5,s.RF,s.n9,s.ED,pe,Fe,Pe.$g],pipes:[s.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:50%;flex:1}main[_ngcontent-%COMP%]{background:#f0f0f0}"]}),e})()},{path:"**",redirectTo:"listing"}]},{path:"**",redirectTo:""}];let Ge=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=U.oAB({type:e}),e.\u0275inj=U.cJS({imports:[[s.ez,o.u5,o.UX,a.Bz.forChild($e),l.X,i.Cl]]}),e})()}}]);