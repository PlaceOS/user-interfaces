"use strict";(self.webpackChunkworkplace=self.webpackChunkworkplace||[]).push([["apps_workplace_src_app_landing_landing_module_ts"],{2253:(un,_,o)=>{o.r(_),o.d(_,{AppLandingModule:()=>pn});var l=o(4666),y=o(959),O=o(1992),d=o(1670),g=o(3690),v=o(4505),F=o(4139),S=o(823),M=o(9095),P=o(7418),Q=o(9128),E=o(5670),J=o(9151),Y=o(6942),Z=o(3200),u=o(6365),N=o(8426),f=o(6862),D=o(3619),j=o(9434),n=o(9676);let x=(()=>{class e extends u.KG{constructor(t,i){super(),this._calendar=t,this._org=i,this._options=new v.X({}),this._free_spaces=new v.X([]),this._upcoming_events=new v.X([]),this._contacts=new v.X([]),this._level_occupancy=new v.X([]),this.free_spaces=this._free_spaces.asObservable(),this.upcoming_events=this._upcoming_events.asObservable(),this.contacts=this._contacts.asObservable(),this.options=this._options.asObservable(),this.search_results=this._options.pipe((0,S.b)(500),(0,M.w)(({search:s})=>s?(0,f.VE)(s):(0,F.of)([])),(0,P.K)(s=>[]),(0,Q.d)(1)),this.level_occupancy=this._level_occupancy.asObservable(),this.init()}init(){var t=this;return(0,d.Z)(function*(){yield t._org.initialised.pipe((0,E.P)(c=>c)).toPromise(),t.subscription("building",t._org.active_building.pipe((0,J.h)(c=>!!c)).subscribe(()=>t.updateBuildingMetadata()));let i=t._org.binding("area_management");if(!i)return;const s=(0,g.rTZ)(i,"AreaManagement").binding("overview");s.listen().subscribe(c=>t.updateOccupancy(c||{})),s.bind()})()}setOptions(t){this._options.next({...this._options.getValue(),...t})}pollFreeSpaces(t=1e4){this.updateFreeSpaces(),this.interval("free_spaces",()=>this.updateFreeSpaces(),t)}stopPollingFreeSpaces(){this.clearInterval("free_spaces")}pollUpcomingEvents(t=1e4){this.updateUpcomingEvents(),this.interval("upcoming_events",()=>this.updateUpcomingEvents(),t)}stopPollingUpcomingEvents(){this.clearInterval("upcoming_events")}updateContacts(){var t=this;return(0,d.Z)(function*(){const i=yield(0,g.rlq)((0,u.ar)().id,"contacts").toPromise();t._contacts.next((i.details instanceof Array?i.details:[]).map(c=>new f.n5(c)))})()}addContact(t){var i=this;return(0,d.Z)(function*(){let s=[...i._contacts.getValue()];s.push(t),s=(0,u.Tw)(s,"email");const c=yield(0,g.Ymr)((0,u.ar)().id,{name:"contacts",description:"Contacts for the User",details:s}).toPromise();i._contacts.next((c.details instanceof Array?c.details:[]).map(r=>new f.n5(r)))})()}removeContact(t){var i=this;return(0,d.Z)(function*(){let s=[...i._contacts.getValue()];s=s.filter(r=>r.email!==t.email);const c=yield(0,g.Ymr)((0,u.ar)().id,{name:"contacts",description:"Contacts for the User",details:s}).toPromise();i._contacts.next((c.details instanceof Array?c.details:[]).map(r=>new f.n5(r)))})()}updateOccupancy(t){var i=this;return(0,d.Z)(function*(){const s=[...i._org.levels];s.sort((c,p)=>t[c.id]?.recommendation-t[p.id]?.recommendation),i._level_occupancy.next(s)})()}updateFreeSpaces(){var t=this;return(0,d.Z)(function*(){if(!t._org.building)return;const i=Math.floor((new Date).valueOf()/1e3),s=Math.floor((0,Z.Z)(new Date).valueOf()/1e3),c=yield t._calendar.freeBusy({period_start:i,period_end:s,zone_ids:t._org.building.id}).pipe((0,Y.U)(p=>p.filter(r=>!r.availability.length||r.availability.find(h=>"busy"!==h.status)))).toPromise();c.sort((p,r)=>p.capacity-r.capacity),t._free_spaces.next(c)})()}updateUpcomingEvents(){var t=this;return(0,d.Z)(function*(){const i=Math.floor((new Date).valueOf()/1e3),s=Math.floor((0,Z.Z)(new Date).valueOf()/1e3),c=yield(0,N.u$)({period_start:i,period_end:s,calendars:(0,u.ar)().email}).toPromise();t._upcoming_events.next(c)})()}updateBuildingMetadata(){var t=this;return(0,d.Z)(function*(){const i=t._org.building,s=yield(0,g.rlq)(i.id,"bindings").toPromise();if(!s.details.occupancy)return;const c=s.details.occupancy,p=(0,g.rTZ)(c.sys,c.module,c.index);!p||(t._occupancy_binding&&t._occupancy_binding.unbind(),t._occupancy_binding=p.binding("occupancy"),t._occupancy_binding.bind(),t.subscription("occupancy_binding",t._occupancy_binding.listen().subscribe(r=>{const h=Object.keys(r).map(m=>({id:m,...r[m]}));h.sort((m,dn)=>m.recommendation_factor-dn.recommendation_factor),t._level_occupancy.next(h.map(m=>t._org.levelWithID([m.id])))})))})()}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(j.ot),n.LFG(D.w7))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var k=o(5306),B=o(207);const b=function(){return["/explore"]},I=function(e){return{level:e}};function q(e,a){if(1&e&&(n.TgZ(0,"button",7),n._UZ(1,"div",8),n.TgZ(2,"div",9)(3,"div",10),n._uU(4),n.qZA(),n.TgZ(5,"div",11)(6,"app-icon",12),n._uU(7,"place"),n.qZA(),n.TgZ(8,"span"),n._uU(9,"Unknown Building"),n.qZA()()()()),2&e){const t=a.$implicit;n.Q6J("routerLink",n.DdM(3,b))("queryParams",n.VKq(4,I,t.id)),n.xp6(4),n.hij(" ",t.display_name||t.name," ")}}function X(e,a){1&e&&(n.TgZ(0,"span",13),n._uU(1," No free spaces "),n.qZA())}const R=function(e){return{space:e}};function V(e,a){if(1&e&&(n.TgZ(0,"button",7),n._UZ(1,"div",8),n.TgZ(2,"div",9)(3,"div",10),n._uU(4),n.qZA(),n.TgZ(5,"div",11)(6,"app-icon",12),n._uU(7,"place"),n.qZA(),n.TgZ(8,"span"),n._uU(9),n.qZA()()()()),2&e){const t=a.$implicit;n.Q6J("routerLink",n.DdM(4,b))("queryParams",n.VKq(5,R,t.email)),n.xp6(4),n.hij(" ",t.display_name||t.name," "),n.xp6(5),n.Oqu(t.level.display_name||t.level.name)}}function $(e,a){1&e&&(n.TgZ(0,"span",13),n._uU(1," No free rooms "),n.qZA())}let A=(()=>{class e{constructor(t){this._state=t,this.space_list=this._state.free_spaces,this.levels_free=this._state.level_occupancy}ngOnInit(){var t=this;return(0,d.Z)(function*(){t._state.pollFreeSpaces()})()}ngOnDestroy(){this._state.stopPollingFreeSpaces()}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(x))},e.\u0275cmp=n.Xpm({type:e,selectors:[["landing-availability"]],decls:17,vars:12,consts:[[1,"py-2"],[1,"sm:text-lg","font-medium","mb-2","sm:mb-4","px-4"],[1,"text-sm","sm:text-base","px-4"],[1,"w-full","overflow-auto","flex","items-center","space-x-4","px-4","py-2"],["matRipple","","class","flex items-center h-24 min-w-[12.5rem] rounded-lg bg-white shadow p-4 space-x-2",3,"routerLink","queryParams",4,"ngFor","ngForOf"],["class","text-dark-fade text-sm mb-2",4,"ngIf"],[1,"text-sm","sm:text-base","my-2","px-4"],["matRipple","",1,"flex","items-center","h-24","min-w-[12.5rem]","rounded-lg","bg-white","shadow","p-4","space-x-2",3,"routerLink","queryParams"],[1,"min-w-[4.5rem]","h-[4.5rem]","rounded","bg-gray-200"],[1,"text-left"],[1,"max-w-full","truncate","px-1.5"],[1,"max-w-full","truncate","text-sm","opacity-60","flex","items-center"],[1,"text-blue-500","text-lg"],[1,"text-dark-fade","text-sm","mb-2"]],template:function(t,i){1&t&&(n.TgZ(0,"div",0)(1,"div",1),n._uU(2,"Available Now"),n.qZA(),n.TgZ(3,"div",2),n._uU(4,"Spaces"),n.qZA(),n.TgZ(5,"div",3),n.YNc(6,q,10,6,"button",4),n.ALo(7,"async"),n.YNc(8,X,2,0,"span",5),n.ALo(9,"async"),n.qZA(),n.TgZ(10,"div",6),n._uU(11,"Rooms"),n.qZA(),n.TgZ(12,"div",3),n.YNc(13,V,10,7,"button",4),n.ALo(14,"async"),n.YNc(15,$,2,0,"span",5),n.ALo(16,"async"),n.qZA()()),2&t&&(n.xp6(6),n.Q6J("ngForOf",n.lcZ(7,4,i.levels_free)),n.xp6(2),n.Q6J("ngIf",!n.lcZ(9,6,i.levels_free).length),n.xp6(5),n.Q6J("ngForOf",n.lcZ(14,8,i.space_list)),n.xp6(2),n.Q6J("ngIf",!n.lcZ(16,10,i.space_list).length))},dependencies:[l.sg,l.O5,k.o,B.wG,y.rH,l.Ov],styles:["*[_ngcontent-%COMP%]{flex-shrink:0}\n/*# sourceMappingURL=landing-availability.component.ts-angular-inline--60.css.map*/"]}),e})();var z=o(9685),U=o(4522);function G(e,a){if(1&e&&(n.TgZ(0,"div",6)(1,"div",7),n._UZ(2,"a-user-avatar",8)(3,"div",9),n.qZA(),n.TgZ(4,"div",10)(5,"div",11),n._uU(6),n.qZA(),n.TgZ(7,"div",12),n._uU(8),n.qZA(),n.TgZ(9,"div",13),n._uU(10),n.qZA()()()),2&e){const t=a.$implicit;n.xp6(2),n.Q6J("user",t),n.xp6(1),n.ekj("bg-error",!t.location)("bg-success",t.location),n.xp6(3),n.Oqu(t.name),n.xp6(2),n.hij(" ",t.organisation," "),n.xp6(2),n.hij(" ",t.location," ")}}let T=(()=>{class e{constructor(t){this._state=t,this.contacts=this._state.contacts,this.search_results=this._state.search_results,this.addUser=i=>this._state.addContact(i),this.removeUser=i=>this._state.removeContact(i),this.updateSearch=i=>this._state.setOptions({search:i})}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(x))},e.\u0275cmp=n.Xpm({type:e,selectors:[["landing-colleagues"]],decls:9,vars:3,consts:[[1,"flex","flex-col","w-[18rem]","h-full","overflow-hidden","bg-white","border-r","border-gray-200"],[1,"flex","items-center","justify-between","px-4","py-2"],[1,"font-medium"],["mat-button","",1,"inverse"],[1,"flex-1","h-1/2","w-full","space-y-4","overflow-auto","pt-4"],["class","flex items-center px-4 space-x-4",4,"ngFor","ngForOf"],[1,"flex","items-center","px-4","space-x-4"],[1,"text-xl","relative"],[3,"user"],[1,"rounded-full","h-3","w-3","border","border-white","absolute","bottom-1","right-1"],[1,"leading-tight"],[1,"truncate"],[1,"text-sm","truncate"],[1,"text-xs","opacity-60","truncate"]],template:function(t,i){1&t&&(n.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),n._uU(3,"Colleagues"),n.qZA(),n.TgZ(4,"button",3),n._uU(5,"Add"),n.qZA()(),n.TgZ(6,"div",4),n.YNc(7,G,11,8,"div",5),n.ALo(8,"async"),n.qZA()()),2&t&&(n.xp6(7),n.Q6J("ngForOf",n.lcZ(8,1,i.contacts)))},dependencies:[l.sg,z.k,U.lW,l.Ov],encapsulation:2}),e})();var K=o(7381),W=o(4502),H=o(9371);function nn(e,a){if(1&e&&n._UZ(0,"event-card",12),2&e){const t=n.oxw().$implicit;n.Q6J("event",t)("show_day",!0)}}function tn(e,a){if(1&e&&n._UZ(0,"booking-card",13),2&e){const t=n.oxw(3);n.Q6J("booking",t.booking)("show_day",!0)}}function en(e,a){if(1&e&&(n.ynx(0)(1,9),n.YNc(2,nn,1,2,"event-card",10),n.YNc(3,tn,1,2,"booking-card",11),n.BQk()()),2&e){const t=a.$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngSwitch",i.type(t)),n.xp6(1),n.Q6J("ngSwitchCase","event"),n.xp6(1),n.Q6J("ngSwitchCase","booking")}}function on(e,a){if(1&e&&(n.ynx(0),n.YNc(1,en,4,3,"ng-container",8),n.ALo(2,"slice"),n.ALo(3,"async"),n.BQk()),2&e){const t=n.oxw();n.xp6(1),n.Q6J("ngForOf",n.Dn7(2,2,n.lcZ(3,6,t.upcoming_events),0,3))("ngForTrackBy",t.trackByFn)}}function an(e,a){1&e&&(n.TgZ(0,"div",14),n._UZ(1,"img",15),n.TgZ(2,"p",16),n._uU(3,"You have no upcoming bookings"),n.qZA()())}const L=function(){return["/your-bookings"]};let C=(()=>{class e{constructor(t){this._state=t,this.upcoming_events=this._state.upcoming_events}type(t){return t instanceof K.$N?"booking":"event"}ngOnInit(){this._state.pollUpcomingEvents()}ngOnDestroy(){this._state.stopPollingUpcomingEvents()}trackByFn(t,i){return i?.id}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(x))},e.\u0275cmp=n.Xpm({type:e,selectors:[["landing-upcoming"]],decls:13,vars:8,consts:[[1,"py-2"],[1,"flex","items-center","justify-between","mb-2","sm:mb-4","px-4"],[1,"sm:text-lg","font-medium"],["button","","mat-button","",1,"inverse","hidden","sm:block",3,"routerLink"],[1,"inverse","block","sm:hidden","text-blue-500","underline","relative","top-8",3,"routerLink"],[1,"space-y-4","px-4"],[4,"ngIf","ngIfElse"],["empty_state",""],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngSwitch"],[3,"event","show_day",4,"ngSwitchCase"],[3,"booking","show_day",4,"ngSwitchCase"],[3,"event","show_day"],[3,"booking","show_day"],[1,"w-full","p-8","flex","flex-col","items-center","justify-center","space-y-4"],["src","assets/img/no-events.svg",1,"mr-4"],[1,"opacity-30"]],template:function(t,i){if(1&t&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2),n._uU(3,"Your Bookings"),n.qZA(),n.TgZ(4,"a",3),n._uU(5," View All "),n.qZA(),n.TgZ(6,"a",4),n._uU(7," View All "),n.qZA()(),n.TgZ(8,"div",5),n.YNc(9,on,4,8,"ng-container",6),n.ALo(10,"async"),n.qZA()(),n.YNc(11,an,4,0,"ng-template",null,7,n.W1O)),2&t){const s=n.MAs(12);let c;n.xp6(4),n.Q6J("routerLink",n.DdM(6,L)),n.xp6(2),n.Q6J("routerLink",n.DdM(7,L)),n.xp6(3),n.Q6J("ngIf",null==(c=n.lcZ(10,4,i.upcoming_events))?null:c.length)("ngIfElse",s)}},dependencies:[l.sg,l.O5,l.RF,l.n9,W.j,H.E,U.zs,y.yS,l.Ov,l.OU]}),e})();var sn=o(6361),cn=o(4187),ln=o(6012);const rn=[{path:"",component:(()=>{class e{get date(){return(0,sn.Z)(this.time||Date.now())}get user(){return(0,u.ar)()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-dashboard"]],decls:19,vars:5,consts:[[1,"flex","flex-1","h-1/2","bg-[#E5E5E5]"],[1,"h-full","hidden","sm:block"],[1,"flex-1","h-full","w-1/2","sm:px-4","overflow-auto"],[1,"sticky","top-0","z-50","bg-[#ECF0F3]","px-4","rounded-b","flex","items-center","justify-between","overflow-hidden"],[1,""],[1,"sm:text-xl","font-medium"],[1,"text-sm","sm:text-base"],[1,"h-32","pt-4"],["src","assets/img/landing.svg"],[1,"mx-4","w-[calc(100%-2rem)]","h-px","bg-gray-300","mb-2"]],template:function(t,i){1&t&&(n._UZ(0,"topbar"),n.TgZ(1,"div",0),n._UZ(2,"landing-colleagues",1),n.TgZ(3,"div",2)(4,"header",3)(5,"div",4)(6,"div",5),n._uU(7),n.qZA(),n.TgZ(8,"div",6),n._uU(9),n.ALo(10,"date"),n.qZA(),n.TgZ(11,"div",6),n._uU(12,"Sydney Australia"),n.qZA()(),n.TgZ(13,"div",7),n._UZ(14,"img",8),n.qZA()(),n._UZ(15,"landing-availability")(16,"div",9)(17,"landing-upcoming"),n.qZA()(),n._UZ(18,"footer-menu")),2&t&&(n.xp6(7),n.hij("Hello ",null==i.user?null:i.user.name,","),n.xp6(2),n.Oqu(n.xi3(10,2,i.date,"fullDate")))},dependencies:[cn.o,ln.i,T,A,C,l.uU],styles:["[_nghost-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;display:flex;flex-direction:column}main[_ngcontent-%COMP%]{min-height:50%}\n/*# sourceMappingURL=landing.component.ts-angular-inline--61.css.map*/"]}),e})()}];let pn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[l.ez,O.v,y.Bz.forChild(rn)]}),e})()}}]);
//# sourceMappingURL=apps_workplace_src_app_landing_landing_module_ts.js.map