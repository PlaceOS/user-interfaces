"use strict";(self.webpackChunkworkplace=self.webpackChunkworkplace||[]).push([["apps_workplace_src_app_landing_landing_module_ts"],{2253:(_t,b,s)=>{s.r(b),s.d(b,{AppLandingModule:()=>vt});var d=s(4666),_=s(959),M=s(1992),g=s(1670),u=s(3690),h=s(4505),k=s(4139),Z=s(6942),S=s(823),Y=s(9095),J=s(7418),P=s(9128),Q=s(5670),N=s(9151),E=s(3200),p=s(4549),f=s(1187),y=s(1522),I=s(3619),j=s(9434),D=s(7625),t=s(9676);let x=(()=>{class e extends p.KG{constructor(n,o,a){super(),this._calendar=n,this._schedule=o,this._org=a,this._options=new h.X({}),this._free_spaces=new h.X([]),this._contacts=new h.X([]),this._level_occupancy=new h.X([]),this.free_spaces=this._free_spaces.asObservable(),this.upcoming_events=this._schedule.filtered_bookings.pipe((0,Z.U)(i=>i.filter(l=>l instanceof f.ym))),this.contacts=this._contacts.asObservable(),this.options=this._options.asObservable(),this.search_results=this._options.pipe((0,S.b)(500),(0,Y.w)(({search:i})=>i?(0,y.VE)(i):(0,k.of)([])),(0,J.K)(i=>[]),(0,P.d)(1)),this.level_occupancy=this._level_occupancy.asObservable(),this.init()}init(){var n=this;return(0,g.Z)(function*(){yield n._org.initialised.pipe((0,Q.P)(i=>i)).toPromise(),n.subscription("building",n._org.active_building.pipe((0,N.h)(i=>!!i)).subscribe(()=>n.updateBuildingMetadata()));let o=n._org.binding("area_management");if(!o)return;const a=(0,u.rTZ)(o,"AreaManagement").binding("overview");a.listen().subscribe(i=>n.updateOccupancy(i||{})),a.bind()})()}setOptions(n){this._options.next({...this._options.getValue(),...n})}pollFreeSpaces(n=1e4){this.updateFreeSpaces(),this.interval("free_spaces",()=>this.updateFreeSpaces(),n)}stopPollingFreeSpaces(){this.clearInterval("free_spaces")}pollUpcomingEvents(n=1e4){return this._schedule.setDate(Date.now()),this._schedule.startPolling(n)}stopPollingUpcomingEvents(){this._schedule.stopPolling()}updateContacts(){var n=this;return(0,g.Z)(function*(){const o=yield(0,u.rlq)((0,p.ar)().id,"contacts").toPromise();n._contacts.next((o.details instanceof Array?o.details:[]).map(i=>new y.n5(i)))})()}addContact(n){var o=this;return(0,g.Z)(function*(){let a=[...o._contacts.getValue()];a.push(n),a=(0,p.Tw)(a,"email");const i=yield(0,u.Ymr)((0,p.ar)().id,{name:"contacts",description:"Contacts for the User",details:a}).toPromise();o._contacts.next((i.details instanceof Array?i.details:[]).map(r=>new y.n5(r)))})()}removeContact(n){var o=this;return(0,g.Z)(function*(){let a=[...o._contacts.getValue()];a=a.filter(r=>r.email!==n.email);const i=yield(0,u.Ymr)((0,p.ar)().id,{name:"contacts",description:"Contacts for the User",details:a}).toPromise();o._contacts.next((i.details instanceof Array?i.details:[]).map(r=>new y.n5(r)))})()}updateOccupancy(n){var o=this;return(0,g.Z)(function*(){const a=[...o._org.levels];a.sort((i,l)=>n[i.id]?.recommendation-n[l.id]?.recommendation),o._level_occupancy.next(a)})()}updateFreeSpaces(){var n=this;return(0,g.Z)(function*(){if(!n._org.building)return;const o=Math.floor((new Date).valueOf()/1e3),a=Math.floor((0,E.Z)(new Date).valueOf()/1e3),i=yield n._calendar.freeBusy({period_start:o,period_end:a,zone_ids:n._org.building.id}).pipe((0,Z.U)(l=>l.filter(r=>!r.availability.length||r.availability.find(m=>"busy"!==m.status)))).toPromise();i.sort((l,r)=>l.capacity-r.capacity),n._free_spaces.next(i)})()}updateBuildingMetadata(){var n=this;return(0,g.Z)(function*(){const o=n._org.building,a=yield(0,u.rlq)(o.id,"bindings").toPromise();if(!a.details.occupancy)return;const i=a.details.occupancy,l=(0,u.rTZ)(i.sys,i.module,i.index);!l||(n._occupancy_binding&&n._occupancy_binding.unbind(),n._occupancy_binding=l.binding("occupancy"),n._occupancy_binding.bind(),n.subscription("occupancy_binding",n._occupancy_binding.listen().subscribe(r=>{const m=Object.keys(r).map(v=>({id:v,...r[v]}));m.sort((v,ft)=>v.recommendation_factor-ft.recommendation_factor),n._level_occupancy.next(m.map(v=>n._org.levelWithID([v.id])))})))})()}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(j.ot),t.LFG(D.I),t.LFG(I.w7))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var B=s(5306),$=s(207);const A=function(){return["/explore"]},q=function(e){return{level:e}};function G(e,c){if(1&e&&(t.TgZ(0,"button",7),t._UZ(1,"div",8),t.TgZ(2,"div",9)(3,"div",10),t._uU(4),t.qZA(),t.TgZ(5,"div",11)(6,"app-icon",12),t._uU(7,"place"),t.qZA(),t.TgZ(8,"span"),t._uU(9,"Unknown Building"),t.qZA()()()()),2&e){const n=c.$implicit;t.Q6J("routerLink",t.DdM(3,A))("queryParams",t.VKq(4,q,n.id)),t.xp6(4),t.hij(" ",n.display_name||n.name," ")}}function R(e,c){1&e&&(t.TgZ(0,"span",13),t._uU(1," No free spaces "),t.qZA())}function V(e,c){if(1&e&&t._UZ(0,"img",16),2&e){const n=t.oxw().$implicit;t.Q6J("src",n.images[0],t.LSH)}}const X=function(e){return{space:e}};function z(e,c){if(1&e&&(t.TgZ(0,"button",7)(1,"div",14),t.YNc(2,V,1,1,"img",15),t.qZA(),t.TgZ(3,"div",9)(4,"div",10),t._uU(5),t.qZA(),t.TgZ(6,"div",11)(7,"app-icon",12),t._uU(8,"place"),t.qZA(),t.TgZ(9,"span"),t._uU(10),t.qZA()()()()),2&e){const n=c.$implicit;t.Q6J("routerLink",t.DdM(5,A))("queryParams",t.VKq(6,X,n.email)),t.xp6(2),t.Q6J("ngIf",n.images.length),t.xp6(3),t.hij(" ",n.display_name||n.name," "),t.xp6(5),t.Oqu(n.level.display_name||n.level.name)}}function H(e,c){1&e&&(t.TgZ(0,"span",13),t._uU(1," No free rooms "),t.qZA())}let T=(()=>{class e{constructor(n){this._state=n,this.space_list=this._state.free_spaces,this.levels_free=this._state.level_occupancy}ngOnInit(){var n=this;return(0,g.Z)(function*(){n._state.pollFreeSpaces()})()}ngOnDestroy(){this._state.stopPollingFreeSpaces()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(x))},e.\u0275cmp=t.Xpm({type:e,selectors:[["landing-availability"]],decls:17,vars:12,consts:[[1,"py-2"],[1,"sm:text-lg","font-medium","mb-2","sm:mb-4","px-4"],[1,"text-sm","sm:text-base","px-4"],[1,"w-full","overflow-auto","flex","items-center","space-x-4","px-4","py-2"],["matRipple","","class","flex items-center h-24 min-w-[12.5rem] rounded-lg bg-white dark:bg-neutral-800 shadow p-4 space-x-2",3,"routerLink","queryParams",4,"ngFor","ngForOf"],["class","text-dark-fade text-sm mb-2",4,"ngIf"],[1,"text-sm","sm:text-base","my-2","px-4"],["matRipple","",1,"flex","items-center","h-24","min-w-[12.5rem]","rounded-lg","bg-white","dark:bg-neutral-800","shadow","p-4","space-x-2",3,"routerLink","queryParams"],[1,"min-w-[4.5rem]","h-[4.5rem]","rounded","bg-gray-200","dark:bg-neutral-700"],[1,"text-left"],[1,"max-w-full","truncate","px-1.5"],[1,"max-w-full","truncate","text-sm","opacity-60","flex","items-center"],[1,"text-blue-500","text-lg"],[1,"text-dark-fade","text-sm","mb-2"],[1,"w-[4.5rem]","h-[4.5rem]","rounded","bg-gray-200","dark:bg-neutral-700","overflow-hidden"],["class","min-h-full object-cover",3,"src",4,"ngIf"],[1,"min-h-full","object-cover",3,"src"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2,"Available Now"),t.qZA(),t.TgZ(3,"div",2),t._uU(4,"Spaces"),t.qZA(),t.TgZ(5,"div",3),t.YNc(6,G,10,6,"button",4),t.ALo(7,"async"),t.YNc(8,R,2,0,"span",5),t.ALo(9,"async"),t.qZA(),t.TgZ(10,"div",6),t._uU(11,"Rooms"),t.qZA(),t.TgZ(12,"div",3),t.YNc(13,z,11,8,"button",4),t.ALo(14,"async"),t.YNc(15,H,2,0,"span",5),t.ALo(16,"async"),t.qZA()()),2&n&&(t.xp6(6),t.Q6J("ngForOf",t.lcZ(7,4,o.levels_free)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(9,6,o.levels_free).length),t.xp6(5),t.Q6J("ngForOf",t.lcZ(14,8,o.space_list)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(16,10,o.space_list).length))},dependencies:[d.sg,d.O5,B.o,$.wG,_.rH,d.Ov],styles:["*[_ngcontent-%COMP%]{flex-shrink:0}\n/*# sourceMappingURL=landing-availability.component.ts-angular-inline--59.css.map*/"]}),e})();var K=s(9685),C=s(4522);function W(e,c){if(1&e&&(t.TgZ(0,"div",8)(1,"div",9),t._UZ(2,"a-user-avatar",10)(3,"div",11),t.qZA(),t.TgZ(4,"div",12)(5,"div",13),t._uU(6),t.qZA(),t.TgZ(7,"div",14),t._uU(8),t.qZA(),t.TgZ(9,"div",15),t._uU(10),t.qZA()()()),2&e){const n=c.$implicit;t.xp6(2),t.Q6J("user",n),t.xp6(1),t.ekj("bg-error",!n.location)("bg-success",n.location),t.xp6(3),t.Oqu(n.name),t.xp6(2),t.hij(" ",n.organisation," "),t.xp6(2),t.hij(" ",n.location," ")}}function tt(e,c){if(1&e&&(t.ynx(0),t.YNc(1,W,11,8,"div",7),t.ALo(2,"async"),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,n.contacts))}}function nt(e,c){1&e&&(t.TgZ(0,"div",16),t._UZ(1,"img",17),t.TgZ(2,"p",18),t._uU(3,'You have no colleagues added. Please select the "Add" button to get started.'),t.qZA()())}let L=(()=>{class e{constructor(n){this._state=n,this.contacts=this._state.contacts,this.search_results=this._state.search_results,this.addUser=o=>this._state.addContact(o),this.removeUser=o=>this._state.removeContact(o),this.updateSearch=o=>this._state.setOptions({search:o})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(x))},e.\u0275cmp=t.Xpm({type:e,selectors:[["landing-colleagues"]],decls:11,vars:4,consts:[[1,"flex","flex-col","w-[18rem]","h-full","overflow-hidden","bg-white","dark:bg-neutral-700","border-r","border-gray-200","dark:border-neutral-500"],[1,"flex","items-center","justify-between","px-4","py-2"],[1,"font-medium"],["mat-button","",1,"inverse"],[1,"flex-1","h-1/2","w-full","space-y-4","overflow-auto","pt-4"],[4,"ngIf","ngIfElse"],["empty_state",""],["class","flex items-center px-4 space-x-4",4,"ngFor","ngForOf"],[1,"flex","items-center","px-4","space-x-4"],[1,"text-xl","relative"],[3,"user"],[1,"rounded-full","h-3","w-3","border","border-white","dark:border-neutral-400","absolute","bottom-1","right-1"],[1,"leading-tight"],[1,"truncate"],[1,"text-sm","truncate"],[1,"text-xs","opacity-60","truncate"],[1,"w-full","h-full","flex","flex-col","items-center","justify-center","space-y-2","p-8"],["src","assets/icons/no-contacts.svg"],[1,"opacity-60","text-sm","text-center"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3,"Colleagues"),t.qZA(),t.TgZ(4,"button",3),t._uU(5,"Add"),t.qZA()(),t.TgZ(6,"div",4),t.YNc(7,tt,3,3,"ng-container",5),t.ALo(8,"async"),t.qZA()(),t.YNc(9,nt,4,0,"ng-template",null,6,t.W1O)),2&n){const a=t.MAs(10);let i;t.xp6(7),t.Q6J("ngIf",null==(i=t.lcZ(8,2,o.contacts))?null:i.length)("ngIfElse",a)}},dependencies:[d.sg,d.O5,K.k,C.lW,d.Ov],encapsulation:2}),e})();var U=s(3070),et=s(5148),ot=s(1484),it=s(2551),at=s(4088);function st(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"event-card",12),t.NdJ("edit",function(){t.CHM(n);const a=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.edit(a))})("remove",function(){t.CHM(n);const a=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.remove(a))}),t.qZA()}if(2&e){const n=t.oxw().$implicit;t.Q6J("event",n)("show_day",!0)}}function ct(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"booking-card",13),t.NdJ("remove",function(){t.CHM(n);const a=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.remove(a))}),t.qZA()}if(2&e){const n=t.oxw().$implicit;t.Q6J("booking",n)("show_day",!0)}}function rt(e,c){if(1&e&&(t.ynx(0)(1,9),t.YNc(2,st,1,2,"event-card",10),t.YNc(3,ct,1,2,"booking-card",11),t.BQk()()),2&e){const n=c.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngSwitch",o.type(n)),t.xp6(1),t.Q6J("ngSwitchCase","event"),t.xp6(1),t.Q6J("ngSwitchCase","booking")}}function lt(e,c){if(1&e&&(t.ynx(0),t.YNc(1,rt,4,3,"ng-container",8),t.ALo(2,"slice"),t.ALo(3,"async"),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.Dn7(2,2,t.lcZ(3,6,n.upcoming_events),0,3))("ngForTrackBy",n.trackByFn)}}function dt(e,c){1&e&&(t.TgZ(0,"div",14),t._UZ(1,"img",15),t.TgZ(2,"p",16),t._uU(3,"You have no upcoming bookings"),t.qZA()())}const w=function(){return["/your-bookings"]};let O=(()=>{class e{constructor(n,o,a,i){this._state=n,this._event_form=o,this._router=a,this._dialog=i,this.upcoming_events=this._state.upcoming_events}type(n){return n instanceof U.$N?"booking":"event"}ngOnInit(){this._state.pollUpcomingEvents()}ngOnDestroy(){this._state.stopPollingUpcomingEvents()}trackByFn(n,o){return o?.id}edit(n){this._router.navigate(["/book","meeting","form"]),this._event_form.newForm(n)}remove(n){var o=this;return(0,g.Z)(function*(){const a=`${(0,et.Z)(n.date,"dd MMM yyyy h:mma")}`,l=`Delete the booking for ${n instanceof f.ym?n.space?.display_name:n.asset_name||n.asset_id} at ${a}`,r=yield(0,p._5)({title:"Delete booking",content:l,icon:{content:"delete"}},o._dialog);"done"===r.reason&&(r.loading("Requesting booking deletion..."),yield(n instanceof f.ym?f.xC:U.pv)(n.id).toPromise().catch(m=>{throw(0,p.cB)(`Unable to delete booking. ${m}`),r.close(),m}),(0,p.t5)("Successfully deleted booking."),r.close())})()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(x),t.Y36(f.MH),t.Y36(_.F0),t.Y36(ot.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["landing-upcoming"]],decls:13,vars:8,consts:[[1,"py-2"],[1,"flex","items-center","justify-between","mb-2","sm:mb-4","px-4"],[1,"sm:text-lg","font-medium"],["button","","mat-button","",1,"inverse","hidden","sm:block",3,"routerLink"],[1,"inverse","block","sm:hidden","text-blue-500","underline","relative","top-8",3,"routerLink"],[1,"space-y-4","px-4"],[4,"ngIf","ngIfElse"],["empty_state",""],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngSwitch"],[3,"event","show_day","edit","remove",4,"ngSwitchCase"],[3,"booking","show_day","remove",4,"ngSwitchCase"],[3,"event","show_day","edit","remove"],[3,"booking","show_day","remove"],[1,"w-full","p-8","flex","flex-col","items-center","justify-center","space-y-4"],["src","assets/img/no-events.svg",1,"mr-4"],[1,"opacity-30"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Your Bookings"),t.qZA(),t.TgZ(4,"a",3),t._uU(5," View All "),t.qZA(),t.TgZ(6,"a",4),t._uU(7," View All "),t.qZA()(),t.TgZ(8,"div",5),t.YNc(9,lt,4,8,"ng-container",6),t.ALo(10,"async"),t.qZA()(),t.YNc(11,dt,4,0,"ng-template",null,7,t.W1O)),2&n){const a=t.MAs(12);let i;t.xp6(4),t.Q6J("routerLink",t.DdM(6,w)),t.xp6(2),t.Q6J("routerLink",t.DdM(7,w)),t.xp6(3),t.Q6J("ngIf",null==(i=t.lcZ(10,4,o.upcoming_events))?null:i.length)("ngIfElse",a)}},dependencies:[d.sg,d.O5,d.RF,d.n9,C.zs,it.j,at.E,_.yS,d.Ov,d.OU]}),e})();var gt=s(6361),pt=s(4187),mt=s(6012);const ut=[{path:"",component:(()=>{class e{get date(){return(0,gt.Z)(this.time||Date.now())}get user(){return(0,p.ar)()}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-dashboard"]],decls:19,vars:5,consts:[[1,"flex","flex-1","h-1/2","bg-[#E5E5E5]","dark:bg-zinc-700"],[1,"h-full","hidden","sm:block"],[1,"flex-1","h-full","w-1/2","sm:px-4","overflow-auto"],[1,"sticky","top-0","z-50","bg-[#ECF0F3]","dark:bg-neutral-800","px-4","rounded-b","flex","items-center","justify-between","overflow-hidden"],[1,""],[1,"sm:text-xl","font-medium"],["date","",1,"text-sm","sm:text-base"],[1,"text-sm","sm:text-base"],[1,"h-32","pt-4"],["src","assets/img/landing.svg"],[1,"mx-4","w-[calc(100%-2rem)]","h-px","bg-gray-300","mb-2"]],template:function(n,o){1&n&&(t._UZ(0,"topbar"),t.TgZ(1,"div",0),t._UZ(2,"landing-colleagues",1),t.TgZ(3,"div",2)(4,"header",3)(5,"div",4)(6,"div",5),t._uU(7),t.qZA(),t.TgZ(8,"div",6),t._uU(9),t.ALo(10,"date"),t.qZA(),t.TgZ(11,"div",7),t._uU(12,"Sydney Australia"),t.qZA()(),t.TgZ(13,"div",8),t._UZ(14,"img",9),t.qZA()(),t._UZ(15,"landing-availability")(16,"div",10)(17,"landing-upcoming"),t.qZA()(),t._UZ(18,"footer-menu")),2&n&&(t.xp6(7),t.hij("Hello ",null==o.user?null:o.user.name,","),t.xp6(2),t.Oqu(t.xi3(10,2,o.date,"fullDate")))},dependencies:[pt.o,mt.i,L,T,O,d.uU],styles:["[_nghost-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;display:flex;flex-direction:column}main[_ngcontent-%COMP%]{min-height:50%}\n/*# sourceMappingURL=landing.component.ts-angular-inline--60.css.map*/"]}),e})()}];let vt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.ez,M.v,_.Bz.forChild(ut)]}),e})()}}]);
//# sourceMappingURL=apps_workplace_src_app_landing_landing_module_ts.js.map