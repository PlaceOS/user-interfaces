"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-apps_concierge_src_app_parking_parking-state_service_ts"],{6685:(S,B,o)=>{o.d(B,{U:()=>E});var t=o(9204),e=o(4456),a=o(2587),U=o(7915),p=o(2333),n=o(7404),I=o(316),b=o(4950),F=o(7984),x=o(1134),R=o(5060),L=o(9608),T=o(8e3),A=o(9434),j=o(4844);function y(d,k){1&d&&(n.j41(0,"button",7)(1,"app-icon"),n.EFF(2,"close"),n.k0s()())}function W(d,k){1&d&&(n.j41(0,"div",24),n.nrm(1,"a-user-search-field",25),n.k0s())}function P(d,k){1&d&&(n.j41(0,"span"),n.EFF(1,"*"),n.k0s())}function u(d,k){if(1&d&&(n.j41(0,"main",8),n.DNE(1,W,2,0,"div",9),n.j41(2,"div",10)(3,"div",11)(4,"label",12),n.EFF(5,"Name"),n.k0s(),n.j41(6,"mat-form-field",13),n.nrm(7,"input",14),n.j41(8,"mat-error"),n.EFF(9,"A name is required"),n.k0s()()(),n.j41(10,"div",11)(11,"label",15),n.EFF(12,"Email"),n.k0s(),n.j41(13,"mat-form-field",13),n.nrm(14,"input",16),n.j41(15,"mat-error"),n.EFF(16,"An email is required"),n.k0s()()()(),n.j41(17,"label",17),n.EFF(18,"Date"),n.k0s(),n.nrm(19,"a-date-field",18),n.j41(20,"label",19),n.EFF(21,"Parking Space"),n.k0s(),n.nrm(22,"parking-space-list-field",20),n.j41(23,"label",21),n.EFF(24," Plate Number"),n.DNE(25,P,2,0,"span",22),n.k0s(),n.j41(26,"mat-form-field",13),n.nrm(27,"input",23),n.j41(28,"mat-error"),n.EFF(29,"A plate number is required"),n.k0s()()()),2&d){const m=n.XpG();n.Y8G("formGroup",m.form),n.R7$(),n.Y8G("ngIf",!m.user),n.R7$(24),n.Y8G("ngIf",m.user)}}function i(d,k){if(1&d){const m=n.RV6();n.j41(0,"footer",26)(1,"button",27),n.EFF(2," Cancel "),n.k0s(),n.j41(3,"button",28),n.bIt("click",function(){n.eBV(m);const v=n.XpG();return n.Njj(v.postForm())}),n.EFF(4," Save "),n.k0s()()}}function s(d,k){1&d&&(n.j41(0,"main",29),n.nrm(1,"mat-spinner",30),n.j41(2,"p"),n.EFF(3,"Saving parking reservation..."),n.k0s()())}let E=(()=>{class d extends p.Tv{get id(){return this.form.value.id}constructor(m,O,v){super(),this._data=m,this._booking_form=O,this._dialog_ref=v,this.loading=!1,this.user=this._data.user,this.date=this._data.date,this.form=this._booking_form.form}ngOnInit(){this._booking_form.newForm(this._data.booking),this._booking_form.setOptions({type:"parking"}),this.subscription("user_changes",this.form.controls.user.valueChanges.subscribe(m=>{m&&this.form.patchValue({user_name:m.name,user_email:m.email,user_id:m.id||m.email,attendees:[m]})})),this.form.patchValue({all_day:!0,booking_type:"parking",user:this._data.user||(0,p.Ny)()}),this._data.user&&(this.form.patchValue({user_email:this._data.user.email,user_id:this._data.user.email,user_name:this._data.user.name,attendees:[this._data.user]}),this.form.controls.plate_number.setValidators([e.k0.required]),this.form.controls.user_name.disable(),this.form.controls.user_email.disable()),this._data.level&&this._booking_form.setOptions({zone_id:this._data.level.id}),this._data.link_id&&this.form.patchValue({parent_id:this._data.link_id}),this._data.space&&this.form.patchValue({resources:[this._data.space]}),this._data.date&&(this.timeout("init_date",()=>{this.form.patchValue({date:this._data.date}),this._data.allow_time_changes||this.form.get("date").disable()},300),this._data.allow_time_changes||this.subscription("form_change",this.form.valueChanges.subscribe(m=>{this.timeout("disable_date",()=>this.form.get("date").disable({emitEvent:!1}),50)})))}postForm(){var m=this;return(0,t.A)(function*(){if(m.form.updateValueAndValidity(),!m.form.valid)return;m.loading=!0,m._data.external_user&&m.form.patchValue({user_id:void 0});const O=yield m._booking_form.postForm().catch(v=>{throw m.loading=!1,m.form.controls.plate_number.setValidators([]),(0,p.UG)(v),v});m.form.controls.plate_number.setValidators([]),m._dialog_ref.close(O.id)})()}static#e=this.\u0275fac=function(O){return new(O||d)(n.rXU(a.Vh),n.rXU(U.nx),n.rXU(a.CP))};static#t=this.\u0275cmp=n.VBU({type:d,selectors:[["parking-booking-modal"]],features:[n.Vt3],decls:9,vars:5,consts:[["load_state",""],[1,"w-[32rem]"],[1,"flex","items-center","justify-between","px-2","w-full"],[1,"px-2"],["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 flex flex-col max-h-[65vh] overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex items-center justify-end space-x-2 p-2 border-t border-base-200",4,"ngIf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","flex","flex-col","max-h-[65vh]","overflow-auto",3,"formGroup"],["class","flex items-center space-x-2 mb-4",4,"ngIf"],[1,"flex","items-center","space-x-2"],[1,"flex-1"],["for","user-name"],["appearance","outline",1,"w-full"],["matInput","","name","user-name","formControlName","user_name","placeholder","Name"],["for","email"],["matInput","","name","email","formControlName","user_email","placeholder","Email"],["for","date"],["formControlName","date"],["for","parking-space"],["name","parking-space","formControlName","resources",1,"mb-2"],["for","plate-number"],[4,"ngIf"],["matInput","","name","plate-number","formControlName","plate_number","placeholder","Plate Number"],[1,"flex","items-center","space-x-2","mb-4"],["name","user","formControlName","user",1,"flex-1"],[1,"flex","items-center","justify-end","space-x-2","p-2","border-t","border-base-200"],["btn","","matRipple","","mat-dialog-close","",1,"w-32","inverse"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"p-8","flex","flex-col","items-center","justify-center","user-y-2"],["diameter","32"]],template:function(O,v){if(1&O&&(n.j41(0,"div",1)(1,"header",2)(2,"h2",3),n.EFF(3),n.k0s(),n.DNE(4,y,3,0,"button",4),n.k0s(),n.DNE(5,u,30,3,"main",5)(6,i,5,0,"footer",6),n.k0s(),n.DNE(7,s,4,0,"ng-template",null,0,n.C5r)),2&O){const G=n.sdS(8);n.R7$(3),n.SpI(" ",v.id?"Edit":"New"," Parking Reservation "),n.R7$(),n.Y8G("ngIf",!v.loading),n.R7$(),n.Y8G("ngIf",!v.loading)("ngIfElse",G),n.R7$(),n.Y8G("ngIf",!v.loading)}},dependencies:[I.bT,b.rl,b.TL,F.fg,x.LG,a.tx,R.r6,e.me,e.BC,e.cb,e.j4,e.JD,L.G,T.$,A.R,j.I]})}return d})()},4836:(S,B,o)=>{o.d(B,{D:()=>W});var t=o(9204),e=o(7404),a=o(4456),U=o(2587),p=o(8390),n=o(316),I=o(4950),b=o(7984),F=o(640),x=o(1134),R=o(5060),L=o(8e3),T=o(9434);function A(P,u){1&P&&(e.j41(0,"button",6)(1,"app-icon"),e.EFF(2,"close"),e.k0s()())}function j(P,u){if(1&P){const i=e.RV6();e.j41(0,"main",7)(1,"label",8),e.EFF(2,"Parking Space Name/Bay Number"),e.k0s(),e.j41(3,"mat-form-field",9),e.nrm(4,"input",10),e.j41(5,"mat-error"),e.EFF(6,"A name is required for parking spaces"),e.k0s()(),e.j41(7,"label",11),e.EFF(8,"Map ID"),e.k0s(),e.j41(9,"mat-form-field",9),e.nrm(10,"input",12),e.j41(11,"mat-error"),e.EFF(12," A map ID is required for parking spaces "),e.k0s()(),e.j41(13,"label",13),e.EFF(14,"Assigned User"),e.k0s(),e.j41(15,"div",14),e.nrm(16,"a-user-search-field",15),e.j41(17,"button",16),e.bIt("click",function(){e.eBV(i);const E=e.XpG();return e.Njj(E.form.patchValue({assigned_user:null,assigned_to:null,assigned_name:null}))}),e.j41(18,"app-icon",17),e.EFF(19," person_cancel "),e.k0s()()(),e.j41(20,"label",18),e.EFF(21,"Notes"),e.k0s(),e.j41(22,"mat-form-field",9),e.nrm(23,"textarea",19),e.k0s(),e.j41(24,"div",20)(25,"button",21),e.EFF(26," Cancel "),e.k0s(),e.j41(27,"button",22),e.bIt("click",function(){e.eBV(i);const E=e.XpG();return e.Njj(E.postForm())}),e.EFF(28," Save "),e.k0s()()()}if(2&P){const i=e.XpG();e.Y8G("formGroup",i.form)}}function y(P,u){1&P&&(e.j41(0,"main",23),e.nrm(1,"mat-spinner",24),e.j41(2,"p"),e.EFF(3,"Saving parking space details..."),e.k0s()())}let W=(()=>{class P{get id(){return this._data?.id||""}constructor(i,s){this._data=i,this._dialog_ref=s,this.event=new e.bkB,this.form=new a.gE({id:new a.MJ(""),name:new a.MJ("",[a.k0.required]),map_id:new a.MJ("",[a.k0.required]),assigned_user:new a.MJ(null),assigned_to:new a.MJ(""),assigned_name:new a.MJ(""),notes:new a.MJ(""),map_rotation:new a.MJ(0)}),i&&this.form.patchValue(i)}ngOnInit(){var i=this;return(0,t.A)(function*(){if(i._data.assigned_to){const s=yield(0,p.SZ)(i._data.assigned_to).toPromise();s&&i.form.patchValue({assigned_user:s,assigned_to:s.email,assigned_name:s.name})}})()}postForm(){if(!this.form.valid)return;this.loading=!0;const i={...this.form.getRawValue()};i.assigned_user&&(i.assigned_to=i.assigned_user.email,i.assigned_name=i.assigned_user.name,delete i.assigned_user),this._dialog_ref.disableClose=!0,this.event.emit({reason:"done",metadata:i})}static#e=this.\u0275fac=function(s){return new(s||P)(e.rXU(U.Vh),e.rXU(U.CP))};static#t=this.\u0275cmp=e.VBU({type:P,selectors:[["parking-space-modal"]],outputs:{event:"event"},decls:8,vars:4,consts:[["load_state",""],[1,"w-[28rem]"],[1,"flex","items-center","justify-between","px-2","w-full"],[1,"px-2"],["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 flex flex-col",3,"formGroup",4,"ngIf","ngIfElse"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","flex","flex-col",3,"formGroup"],["for","name"],["appearance","outline"],["matInput","","name","name","formControlName","name"],["for","map-id"],["matInput","","name","map-id","formControlName","map_id"],["for","user"],[1,"flex","items-center","space-x-2","mb-4"],["name","user","formControlName","assigned_user",1,"flex-1"],["icon","","matRipple","","matTooltip","Clear Assigned User",1,"h-12","w-12","min-w-12","rounded","bg-secondary","text-secondary-content",3,"click"],["className","material-symbols-outlined"],["for","notes"],["matInput","","name","notes","formControlName","notes"],[1,"flex","items-center","justify-center","space-x-2"],["btn","","matRipple","","mat-dialog-close","",1,"w-32","inverse"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"p-8","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"]],template:function(s,E){if(1&s&&(e.j41(0,"div",1)(1,"header",2)(2,"h2",3),e.EFF(3),e.k0s(),e.DNE(4,A,3,0,"button",4),e.k0s(),e.DNE(5,j,29,1,"main",5),e.k0s(),e.DNE(6,y,4,0,"ng-template",null,0,e.C5r)),2&s){const d=e.sdS(7);e.R7$(3),e.SpI("",E.id?"Edit":"New"," Parking Space"),e.R7$(),e.Y8G("ngIf",!E.loading),e.R7$(),e.Y8G("ngIf",!E.loading)("ngIfElse",d)}},dependencies:[n.bT,I.rl,I.TL,b.fg,F.oV,x.LG,U.tx,R.r6,a.me,a.BC,a.cb,a.j4,a.JD,L.$,T.R]})}return P})()},8007:(S,B,o)=>{o.d(B,{X:()=>O});var t=o(9204),e=o(7915),a=o(2333),U=o(2185),p=o(3998),n=o(9908),I=o(3240),b=o(6441),F=o(6671),x=o(521),R=o(2175),L=o(1536),T=o(5443),A=o(1963),j=o(6e3),y=o(7841),W=o(8627),P=o(9803),u=o(7871),i=o(3602),s=o(4836),E=o(6233),d=o(6685),k=o(7404),m=o(2587);let O=(()=>{class v extends a.Tv{constructor(l,r,f){super(),this._org=l,this._dialog=r,this._settings=f,this._poll=new x.t(0),this._change=new x.t(0),this._options=new x.t({date:Date.now(),search:"",zones:[]}),this._loading=new x.t([]),this.levels=(0,R.zV)([this._org.active_region,this._org.active_building]).pipe((0,T.T)(([_,g])=>{const c=this._org.levels.filter(h=>h.tags.includes("parking"));if(this._settings.get("app.use_region")){const h=this._org.buildingsForRegion(),M=h.map(D=>D.id),C=c.filter(D=>M.includes(D.parent_id));return C.map(D=>({...D,display_name:`${h.find(K=>K.id===D.parent_id)?.display_name} - ${D.display_name}`})),C}return c.filter(h=>h.parent_id===g.id)})),this.spaces=(0,R.zV)([this.levels,this._options,this._change]).pipe((0,A.n)(([_,g])=>g.zones[0]||_[0]?.id?(this._loading.next([...this._loading.getValue(),"spaces"]),(0,p.bpY)(g.zones[0]||_[0]?.id,"parking-spaces").pipe((0,T.T)(({details:c})=>(c instanceof Array?c:[]).map(h=>({...h,zone_id:g.zones[0]||_[0]?.id}))))):(0,L.of)([])),(0,j.M)(()=>this._loading.next(this._loading.getValue().filter(_=>"spaces"!==_))),(0,y.t)(1)),this.users=(0,R.zV)([this._org.active_building,this._change]).pipe((0,W.p)(([_])=>!!_?.id),(0,A.n)(([_])=>(this._loading.next([...this._loading.getValue(),"users"]),(0,p.bpY)(_.id,"parking-users"))),(0,T.T)(_=>_.details instanceof Array?_.details:[]),(0,j.M)(()=>this._loading.next(this._loading.getValue().filter(_=>"users"!==_))),(0,y.t)(1)),this.bookings=(0,R.zV)([this._org.active_building,this._options,this.users,this._poll,this._change]).pipe((0,P.B)(500),(0,A.n)(([_,g,c])=>(this._loading.next([...this._loading.getValue(),"bookings"]),(0,e.tj)({period_start:(0,n._)((0,I.o)(g.date)),period_end:(0,n._)((0,b.D)(g.date)),type:"parking",zones:g.zones?.length?g.zones.join(","):(this._settings.get("app.use_region")?this._org.region?.id:"")||_?.id,include_checked_out:!0}).pipe((0,T.T)(h=>{for(const M of h){const C=c.find(D=>D.email.toLowerCase()===M.user_email.toLowerCase());C&&(M.extension_data.plate_number=M.extension_data.plate_number||C.plate_number)}return h})))),(0,j.M)(()=>this._loading.next(this._loading.getValue().filter(_=>"bookings"!==_))),(0,y.t)(1)),this.options=this._options.asObservable(),this.loading=this._loading.asObservable()}setOptions(l){this._options.next({...this._options.getValue(),...l})}startPolling(l=12e4){return this._poll.next(Date.now()),this.interval("poll",()=>this._poll.next(Date.now()),l),()=>this.stopPolling()}stopPolling(){this.clearInterval("poll")}editSpace(l={}){var r=this;return(0,t.A)(function*(){const f=r._dialog.open(s.D,{data:l}),_=yield Promise.race([f.afterClosed().toPromise(),f.componentInstance.event.pipe((0,u.$)(D=>"done"===D.reason)).toPromise()]);if("done"!==_?.reason)return;const g=r._options.getValue().zones[0]||l.zone_id||r._org.levelsForBuilding()[0]?.id,c={..._.metadata,id:_.metadata.id||`parking-${g}.${(0,a.HO)(999999)}`},h=yield r.spaces.pipe((0,i.s)(1)).toPromise(),M=h.findIndex(D=>D.id===c.id);if(l.assigned_to&&l.assigned_to!==c.assigned_to){const K=(yield(0,e.tj)({period_start:(0,n._)((0,I.o)(Date.now())),period_end:(0,n._)((0,b.D)(Date.now())),type:"parking",email:c.assigned_to}).toPromise()).filter(N=>N.asset_id===l.id);yield Promise.all(K.map(N=>(0,e.UN)(N.id).toPromise()))}l.assigned_to!==c.assigned_to&&c.assigned_to&&(yield(0,e.X0)(new e.Qr({user_id:c.assigned_to,user_email:c.assigned_to,booking_start:(0,n._)((0,I.o)(Date.now())),booking_end:(0,n._)((0,b.D)(Date.now())),type:"parking",booking_type:"parking",asset_id:c.id,asset_name:c.name,recurrence_type:"daily",recurrence_days:e.WS.MONDAY|e.WS.TUESDAY|e.WS.WEDNESDAY|e.WS.THURSDAY|e.WS.FRIDAY,zones:(0,a.Am)([r._org.organisation.id,r._org.region?.id,r._org.building?.id,l.zone_id]),extension_data:{asset_name:c.name}})).toPromise()),M>=0?h[M]=c:h.push(c);const C=h;yield(0,p.D58)(g,{name:"parking-spaces",details:C,description:"List of available parking spaces"}).toPromise(),r._change.next(Date.now()),f.close()})()}removeSpace(l){var r=this;return(0,t.A)(function*(){const f=yield(0,a.GE)({title:"Remove Parking Space",content:`Are you sure you wish to remove the parking space "${l.name}"?`,icon:{content:"delete"}},r._dialog);if("done"!==f?.reason)return;f.loading("Removing parking space...");const _=r._options.getValue().zones[0],g=yield r.spaces.pipe((0,i.s)(1)).toPromise();yield(0,p.D58)(_,{name:"parking-spaces",details:g.filter(c=>c.id!==l.id),description:"List of available parking spaces"}).toPromise(),f.close()})()}editUser(l){var r=this;return(0,t.A)(function*(){console.log("Edit User",l);const f=r._dialog.open(E.K,{data:l}),_=yield Promise.race([f.afterClosed().toPromise(),f.componentInstance.event.pipe((0,u.$)(C=>"done"===C.reason)).toPromise()]);if("done"!==_?.reason)return;const g=r._org.building.id,c={..._.metadata,id:_.metadata.id||`P:USR-${(0,a.HO)(999999)}`};"user"in c&&delete c.user;const h=yield r.users.pipe((0,i.s)(1)).toPromise(),M=h.findIndex(C=>C.id===c.id);M>=0?h[M]=c:h.push(c),yield(0,p.D58)(g,{name:"parking-users",details:h,description:"List of available parking users"}).toPromise(),r._change.next(Date.now()),f.close()})()}removeUser(l){var r=this;return(0,t.A)(function*(){const f=yield(0,a.GE)({title:"Remove Parking User",content:`Are you sure you wish to remove the parking user "${l.name}"?`,icon:{content:"delete"}},r._dialog);if("done"!==f?.reason)return;f.loading("Removing parking user...");const _=r._options.getValue().zones[0],g=yield r.users.pipe((0,i.s)(1)).toPromise();yield(0,p.D58)(_,{name:"parking-users",details:g.filter(c=>c.id!==l.id),description:"List of available parking users"}).toPromise(),f.close()})()}editReservation(l,{user:r,link_id:f,date:_,space:g,allow_time_changes:c,external_user:h}={}){var M=this;return console.log("Reservation:",g),new Promise(function(){var C=(0,t.A)(function*(D){const K=yield M.levels.pipe((0,i.s)(1)).toPromise(),N=yield M.spaces.pipe((0,i.s)(1)).toPromise();!g&&l?.asset_id&&(g=N.find(V=>V.id===l.asset_id)),M._dialog.open(d.U,{data:{booking:l,user:r,link_id:f,date:_,level:K[0],space:g,allow_time_changes:c,external_user:h}}).afterClosed().subscribe(V=>D(V))});return function(D){return C.apply(this,arguments)}}())}approveBooking(l){var r=this;return(0,t.A)(function*(){const f=yield(0,e.DD)(l.id).toPromise().catch(_=>"failed");"failed"===f?(0,a.UG)("Error approving in desk booking"):(0,a.VX)(`Approved parking reservation for ${l.user_name} on ${(0,F.GP)(l.date,"MMM Do")}.`),"failed"!==f&&r._change.next(Date.now())})()}rejectBooking(l){var r=this;return(0,t.A)(function*(){const f=yield(0,e.vB)(l.id).toPromise().catch(_=>"failed");"failed"===f?(0,a.UG)("Error rejecting in desk booking"):(0,a.VX)(`Rejected parking reservation for ${l.user_name} on ${(0,F.GP)(l.date,"MMM dd")}.`),"failed"!==f&&r._change.next(Date.now())})()}static#e=this.\u0275fac=function(r){return new(r||v)(k.KVO(U.yb),k.KVO(m.bZ),k.KVO(a.h$))};static#t=this.\u0275prov=k.jDH({token:v,factory:v.\u0275fac,providedIn:"root"})}return v})()},6233:(S,B,o)=>{o.d(B,{K:()=>P});var t=o(7404),e=o(4456),a=o(2587),U=o(2333),p=o(316),n=o(4950),I=o(7984),b=o(7024),F=o(640),x=o(1134),R=o(5060),L=o(8e3),T=o(9434);function A(u,i){1&u&&(t.j41(0,"button",8)(1,"app-icon"),t.EFF(2,"close"),t.k0s()())}function j(u,i){if(1&u){const s=t.RV6();t.j41(0,"main",9)(1,"div",10),t.nrm(2,"a-user-search-field",11),t.j41(3,"button",12),t.bIt("click",function(){t.eBV(s);const d=t.XpG();return t.Njj(d.form.patchValue({user:null,email:null,name:null,phone:null}))}),t.j41(4,"app-icon",13),t.EFF(5," person_cancel "),t.k0s()()(),t.j41(6,"label",14),t.EFF(7,"Name"),t.k0s(),t.j41(8,"mat-form-field",15),t.nrm(9,"input",16),t.j41(10,"mat-error"),t.EFF(11,"A name is required"),t.k0s()(),t.j41(12,"label",17),t.EFF(13,"Email"),t.k0s(),t.j41(14,"mat-form-field",15),t.nrm(15,"input",18),t.j41(16,"mat-error"),t.EFF(17,"An email is required"),t.k0s()(),t.j41(18,"div",19)(19,"div",20)(20,"label",21),t.EFF(21,"Car Number Plate"),t.k0s(),t.j41(22,"mat-form-field",22),t.nrm(23,"input",23),t.k0s()(),t.j41(24,"div",20)(25,"label",24),t.EFF(26,"Car Colour"),t.k0s(),t.j41(27,"mat-form-field",22),t.nrm(28,"input",25),t.k0s()()(),t.j41(29,"label",26),t.EFF(30,"Notes"),t.k0s(),t.j41(31,"mat-form-field",15),t.nrm(32,"textarea",27),t.k0s(),t.j41(33,"div",28)(34,"mat-checkbox",29),t.pXf(35,1),t.k0s()()()}if(2&u){const s=t.XpG();t.Y8G("formGroup",s.form)}}function y(u,i){if(1&u){const s=t.RV6();t.j41(0,"footer",30)(1,"button",31),t.EFF(2," Cancel "),t.k0s(),t.j41(3,"button",32),t.bIt("click",function(){t.eBV(s);const d=t.XpG();return t.Njj(d.postForm())}),t.EFF(4," Save "),t.k0s()()}}function W(u,i){1&u&&(t.j41(0,"main",33),t.nrm(1,"mat-spinner",34),t.j41(2,"p"),t.EFF(3,"Saving parking user details..."),t.k0s()())}let P=(()=>{class u extends U.Tv{get id(){return this._data?.id||""}constructor(s,E){super(),this._data=s,this._dialog_ref=E,this.event=new t.bkB,this.loading=!1,this.form=new e.gE({id:new e.MJ(""),user:new e.MJ(null),name:new e.MJ("",[e.k0.required]),email:new e.MJ("",[e.k0.required]),plate_number:new e.MJ(""),car_color:new e.MJ(""),notes:new e.MJ(""),deny:new e.MJ(!1)}),s&&this.form.patchValue(s),console.log("User Modal",this.form.value,s)}ngOnInit(){this.subscription("user",this.form.valueChanges.subscribe(s=>{s.user&&this.form.patchValue({email:s.user.email,name:s.user.name})}))}postForm(){if(!this.form.valid)return;this.loading=!0;const s=this.form.value;s.user&&(s.email=s.user.email,s.name=s.user.name),this._dialog_ref.disableClose=!0,this.event.emit({reason:"done",metadata:s})}static#e=this.\u0275fac=function(E){return new(E||u)(t.rXU(a.Vh),t.rXU(a.CP))};static#t=this.\u0275cmp=t.VBU({type:u,selectors:[["parking-user-modal"]],outputs:{event:"event"},features:[t.Vt3],decls:9,vars:5,consts:()=>{let s;return s=$localize`:@@deny␟52641a66d27267c758ce08ae66f779767c90552f␟5404152440006125242: Deny User Parking Access `,[["load_state",""],s,[1,"w-[28rem]"],[1,"flex","items-center","justify-between","px-2","w-full"],[1,"px-2"],["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 flex flex-col max-h-[65vh] overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex items-center justify-end space-x-2 p-2 border-t border-base-200",4,"ngIf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","flex","flex-col","max-h-[65vh]","overflow-auto",3,"formGroup"],[1,"flex","items-center","space-x-2","mb-4"],["name","user","formControlName","user",1,"flex-1"],["icon","","matRipple","","matTooltip","Clear Selected User",1,"h-12","w-12","min-w-12","rounded","bg-secondary","text-secondary-content",3,"click"],["className","material-symbols-outlined"],["for","name"],["appearance","outline"],["matInput","","name","name","formControlName","name","placeholder","Name"],["for","email"],["matInput","","name","email","formControlName","email","placeholder","Email"],[1,"flex","items-center","space-x-2"],[1,"flex-1","w-1/3"],["for","plate-number"],["appearance","outline",1,"w-full"],["matInput","","name","plate-number","formControlName","plate_number","placeholder","Car Plate Number"],["for","car-color"],["matInput","","name","car-color","formControlName","car_color","placeholder","Car Colour"],["for","notes"],["matInput","","name","notes","formControlName","notes","placeholder","User's Notes"],[1,"px-2","pb-2"],["name","deny","formControlName","deny"],[1,"flex","items-center","justify-end","space-x-2","p-2","border-t","border-base-200"],["btn","","matRipple","","mat-dialog-close","",1,"w-32","inverse"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"p-8","flex","flex-col","items-center","justify-center","user-y-2"],["diameter","32"]]},template:function(E,d){if(1&E&&(t.j41(0,"div",2)(1,"header",3)(2,"h2",4),t.EFF(3),t.k0s(),t.DNE(4,A,3,0,"button",5),t.k0s(),t.DNE(5,j,36,1,"main",6)(6,y,5,0,"footer",7),t.k0s(),t.DNE(7,W,4,0,"ng-template",null,0,t.C5r)),2&E){const k=t.sdS(8);t.R7$(3),t.SpI("",d.id?"Edit":"New"," Parking User"),t.R7$(),t.Y8G("ngIf",!d.loading),t.R7$(),t.Y8G("ngIf",!d.loading)("ngIfElse",k),t.R7$(),t.Y8G("ngIf",!d.loading)}},dependencies:[p.bT,n.rl,n.TL,I.fg,b.So,F.oV,x.LG,a.tx,R.r6,e.me,e.BC,e.cb,e.j4,e.JD,L.$,T.R]})}return u})()},7915:(S,B,o)=>{o.d(B,{Qr:()=>a.Q,nx:()=>e.n,WS:()=>a.W,SG:()=>t.S,DD:()=>p.DD,Z$:()=>p.Z$,u3:()=>p.u3,tj:()=>p.tj,WE:()=>p.WE,vB:()=>p.vB,UN:()=>p.UN,X0:()=>p.X0,DO:()=>p.DO,vq:()=>p.vq});var t=o(9478),e=o(8379),a=o(3857),p=(o(7141),o(8026));o(2333),o(5762),o(3367),o(7254),o(8796),o(1781),o(7547),o(7642),o(1593)}}]);
//# sourceMappingURL=default-apps_concierge_src_app_parking_parking-state_service_ts.js.map