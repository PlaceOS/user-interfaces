(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([[592],{8592:(e,t,i)=>{"use strict";i.r(t),i.d(t,{VisitorsModule:()=>oe});var n=i(1511),s=i(6073),o=i(6898),l=i(787),r=i(4762),a=i(8512),c=i(3080),d=i(7701),u=i(4689),g=i(9996),h=i(8303),v=i(2324),p=i(205),f=i(2161),m=i(8125),_=i(4914),Z=i(3206),x=i(7022),w=i(2619);let b=(()=>{class e extends Z.KG{constructor(){super(),this._poll=new a.X(0),this._filters=new a.X({}),this._search=new a.X(""),this._loading=new a.X(!1),this.loading=this._loading.asObservable(),this.filters=this._filters.asObservable(),this.events=(0,c.aj)([this._filters,this._poll]).pipe((0,d.b)(500),(0,u.w)(([e])=>{this._loading.next(!0);const t=e.date?new Date(e.date):new Date,i=e.show_week?(0,v.Z)(t):(0,p.Z)(t),n=e.show_week?(0,f.Z)(t):(0,m.Z)(t);return(0,x.u$)({period_start:(0,_.Z)(i),period_end:(0,_.Z)(n),zone_ids:(e.zones||[]).join(",")})}),(0,g.U)(e=>(this._loading.next(!1),this._filters.getValue().all_bookings?e:e.filter(e=>e.guests.length&&e.attendees.length>1))),(0,h.d)(1)),this.filtered_events=(0,c.aj)([this._search,this.events]).pipe((0,g.U)(e=>{const[t,i]=e,n=t.toLowerCase();return i.filter(e=>e.attendees.find(e=>e.name.toLowerCase().includes(n)||e.email.toLowerCase().includes(n)))}))}get search(){return this._search.getValue()}setFilters(e){this._filters.next(Object.assign(Object.assign({},this._filters.getValue()),e))}setSearchString(e){this._search.next(e)}startPolling(e=3e4){this.interval("poll",()=>this._poll.next((new Date).valueOf()),e)}stopPolling(){this.clearInterval("poll")}checkGuestIn(e,t){var i,n;return(0,r.mG)(this,void 0,void 0,function*(){const s=(0,x.rq)(e.id,t.id,!0,{system_id:(null===(i=e.system)||void 0===i?void 0:i.id)||(null===(n=e.resources[0])||void 0===n?void 0:n.id)}).toPromise().catch(i=>{throw(0,Z.cB)(`Error checking in ${t.name} for ${e.organiser.name}'s meeting`),i});(0,Z.t5)(`Successfully checked in ${t.name} for ${e.organiser.name}'s meeting`);const o=(0,Z.Tw)([s,...e.attendees],"email");return o.sort((e,t)=>e.organizer?-1:e.email.localeCompare(t.email)),new x.ym(Object.assign(Object.assign({},e),{attendees:o}))})}checkGuestOut(e,t){var i,n;return(0,r.mG)(this,void 0,void 0,function*(){const s=yield(0,x.rq)(e.id,t.id,!1,{system_id:(null===(i=e.system)||void 0===i?void 0:i.id)||(null===(n=e.resources[0])||void 0===n?void 0:n.id)}).toPromise().catch(i=>{throw(0,Z.cB)(`Error checking out ${t.name} from ${e.organiser.name}'s meeting`),i});(0,Z.t5)(`Successfully checked out ${t.name} from ${e.organiser.name}'s meeting`);const o=(0,Z.Tw)([s,...e.attendees],"email");return o.sort((e,t)=>e.organizer?-1:e.email.localeCompare(t.email)),new x.ym(Object.assign(Object.assign({},e),{attendees:o}))})}checkAllGuestsIn(e){return(0,r.mG)(this,void 0,void 0,function*(){const t=e.attendees.filter(e=>e.is_external&&!e.checked_in);if(t.length<=0)throw new Error("No Guests to checkin");const i=yield Promise.all(t.map(t=>{var i,n;return(0,x.rq)(e.id,t.id,!0,{system_id:(null===(i=e.system)||void 0===i?void 0:i.id)||(null===(n=e.resources[0])||void 0===n?void 0:n.id)}).toPromise()})).catch(t=>{throw(0,Z.cB)(`Error checking in all guests for ${e.organiser.name}'s meeting`),t});(0,Z.t5)(`Successfully checked in all guests for ${e.organiser.name}'s meeting`);const n=(0,Z.Tw)([...i,...e.attendees],"email");return n.sort((e,t)=>e.organizer?-1:e.email.localeCompare(t.email)),new x.ym(Object.assign(Object.assign({},e),{attendees:n}))})}checkAllGuestsOut(e){return(0,r.mG)(this,void 0,void 0,function*(){const t=e.attendees.filter(e=>e.is_external&&e.checked_in&&!e.organizer);if(t.length<=0)throw new Error("No Guests to checkout");const i=yield Promise.all(t.map(t=>{var i,n;return(0,x.rq)(e.id,t.id,!1,{system_id:(null===(i=e.system)||void 0===i?void 0:i.id)||(null===(n=e.resources[0])||void 0===n?void 0:n.id)}).toPromise()})).catch(t=>{throw(0,Z.cB)(`Error checking out all guests from ${e.organiser.name}'s meeting`),t});(0,Z.t5)(`Successfully checked out all guests from ${e.organiser.name}'s meeting`);const n=(0,Z.Tw)([...i,...e.attendees],"email");return n.sort((e,t)=>e.organizer?-1:e.email.localeCompare(t.email)),new x.ym(Object.assign(Object.assign({},e),{attendees:n}))})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var y=i(1490),k=i(3530),q=i(9294),T=i(6283),A=i(4786),O=i(7521),C=i(2319),U=i(3708),J=i(1522);function M(e,t){if(1&e&&(w.TgZ(0,"mat-option",8),w._uU(1),w.qZA()),2&e){const e=t.$implicit;w.Q6J("value",e.id),w.xp6(1),w.hij(" ",e.display_name||e.name," ")}}let P=(()=>{class e extends Z.KG{constructor(e,t,i,n){super(),this._state=e,this._org=t,this._route=i,this._router=n,this.zones=[],this.levels=this._org.active_levels,this.filters=this._state.filters,this.setDate=e=>this._state.setFilters({date:e}),this.setFilters=e=>this._state.setFilters(e),this.setSearch=e=>this._state.setSearchString(e),this.updateZones=e=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:e.join(",")}}),this._state.setFilters({zones:e})}}ngOnInit(){return(0,r.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,k.P)(e=>e)).toPromise(),this.subscription("route.query",this._route.queryParamMap.subscribe(e=>{if(e.has("zone_ids")){const t=e.get("zone_ids").split(",");if(t.length){const e=this._org.levelWithID(t);if(!e)return;this._org.building=this._org.buildings.find(t=>t.id===e.parent_id),this.zones=t}}})),this.subscription("levels",this._org.active_levels.subscribe(e=>{this.zones=this.zones.filter(t=>e.find(e=>e.id===t)),!this.zones.length&&e.length&&this.zones.push(e[0].id),this.updateZones(this.zones)})),this.setSearch("")})}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(b),w.Y36(q.w7),w.Y36(o.gz),w.Y36(o.F0))},e.\u0275cmp=w.Xpm({type:e,selectors:[["visitors-topbar"]],features:[w.qOj],decls:15,vars:10,consts:[["appearance","outline"],["multiple","","placeholder","All Levels",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"m-2",3,"ngModel","ngModelChange"],[1,"text-xs"],[1,"flex-1","w-2"],[1,"mr-2",3,"modelChange"],[3,"dateChange"],[3,"value"]],template:function(e,t){if(1&e&&(w.TgZ(0,"mat-form-field",0),w.TgZ(1,"mat-select",1),w.NdJ("ngModelChange",function(e){return t.zones=e})("ngModelChange",function(e){return t.updateZones(e)}),w.YNc(2,M,2,2,"mat-option",2),w.ALo(3,"async"),w.qZA(),w.qZA(),w.TgZ(4,"mat-slide-toggle",3),w.NdJ("ngModelChange",function(e){return t.setFilters({all_bookings:e})}),w.ALo(5,"async"),w.TgZ(6,"div",4),w._uU(7,"All Bookings"),w.qZA(),w.qZA(),w.TgZ(8,"mat-slide-toggle",3),w.NdJ("ngModelChange",function(e){return t.setFilters({show_week:e})}),w.ALo(9,"async"),w.TgZ(10,"div",4),w._uU(11,"Show Week"),w.qZA(),w.qZA(),w._UZ(12,"div",5),w.TgZ(13,"searchbar",6),w.NdJ("modelChange",function(e){return t.setSearch(e)}),w.qZA(),w.TgZ(14,"date-options",7),w.NdJ("dateChange",function(e){return t.setDate(e)}),w.qZA()),2&e){let e,i;w.xp6(1),w.Q6J("ngModel",t.zones),w.xp6(1),w.Q6J("ngForOf",w.lcZ(3,4,t.levels)),w.xp6(2),w.Q6J("ngModel",null==(e=w.lcZ(5,6,t.filters))?null:e.all_bookings),w.xp6(4),w.Q6J("ngModel",null==(i=w.lcZ(9,8,t.filters))?null:i.show_week)}},directives:[T.KE,A.gD,s.JJ,s.On,n.sg,O.Rr,C.U,U.E,J.ey],pipes:[n.Ov],styles:["[_nghost-%COMP%]{display:flex;align-items:center;background-color:#fff;height:5em;padding:0 1em;border-bottom:1px solid #ccc}[_nghost-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-left:.5rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em}"]}),e})();var j=i(9436),G=i(6828),I=i(5980),Q=i(1548),z=i(4587);function N(e,t){1&e&&(w.TgZ(0,"i",14),w._uU(1,"face"),w.qZA())}function Y(e,t){if(1&e&&(w.ynx(0),w.YNc(1,N,2,0,"i",13),w.BQk()),2&e){const e=w.oxw(),t=w.MAs(3);w.xp6(1),w.Q6J("ngIf",!(null!=e.visitor&&e.visitor.checked_in))("ngIfElse",t)}}function F(e,t){1&e&&(w.TgZ(0,"i",15),w._uU(1,"done"),w.qZA())}function L(e,t){1&e&&(w.TgZ(0,"i",16),w._uU(1,"assignment_ind"),w.qZA())}function S(e,t){if(1&e&&(w.TgZ(0,"div",17),w.TgZ(1,"h2"),w._uU(2),w.qZA(),w.TgZ(3,"div"),w.TgZ(4,"span"),w._uU(5,"Host:"),w.qZA(),w._uU(6),w.qZA(),w.TgZ(7,"div"),w.TgZ(8,"span"),w._uU(9,"Purpose:"),w.qZA(),w._uU(10),w.qZA(),w.TgZ(11,"div"),w.TgZ(12,"span"),w._uU(13,"Location:"),w.qZA(),w._uU(14),w.qZA(),w.TgZ(15,"div"),w.TgZ(16,"span"),w._uU(17,"Issue Date:"),w.qZA(),w._uU(18),w.ALo(19,"date"),w.qZA(),w.TgZ(20,"div",18),w._UZ(21,"img",19),w.qZA(),w.qZA()),2&e){const e=w.oxw();w.xp6(2),w.Oqu((null==e.visitor?null:e.visitor.name)||(null==e.visitor?null:e.visitor.email)),w.xp6(4),w.hij(" ",(null==e.event||null==e.event.organiser?null:e.event.organiser.name)||(null==e.event||null==e.event.organiser?null:e.event.organiser.name)||(null==e.event?null:e.event.creator)," "),w.xp6(4),w.hij(" ",null==e.event?null:e.event.title,""),w.xp6(4),w.hij(" ",(null==e.event?null:e.event.location)||"<Unspecified>"," "),w.xp6(4),w.hij(" ",w.xi3(19,6,e.today,"mediumDate"),""),w.xp6(3),w.Q6J("src",(null==e.visitor||null==e.visitor.extension_data||null==e.visitor.extension_data.qr?null:e.visitor.extension_data.qr.code)||"",w.LSH)}}let E=(()=>{class e extends Z.KG{constructor(e,t){super(),this._state=e,this._settings=t,this.eventChange=new w.vpe,this.checkin=()=>(0,r.mG)(this,void 0,void 0,function*(){this.loading="checkin",this.event=yield this._state.checkGuestIn(this.event,this.visitor).catch(e=>this.event),this.eventChange.emit(this.event),this.loading=""}),this.toggleRemote=()=>(0,r.mG)(this,void 0,void 0,function*(){var e;this.loading="remote";const t=null===(e=this.event.ext("remote"))||void 0===e?void 0:e.filter(e=>e!==this.visitor.email);this.remote||t.push(this.visitor.email);const i=new x.ym(Object.assign(Object.assign({},this.event.toJSON()),{remote:t})).toJSON();this.event=yield(0,x.ry)(i).toPromise().catch(e=>((0,Z.cB)(`Error setting visitor status. Error: ${e.statusText||e.message||e}`),this.event)),this.eventChange.emit(this.event),this.loading=""}),this.checkout=()=>(0,r.mG)(this,void 0,void 0,function*(){this.loading="checkout",this.event=yield this._state.checkGuestOut(this.event,this.visitor).catch(e=>this.event),this.eventChange.emit(this.event),this.loading=""}),this.printQRCode=()=>{this.show_qr_code=!0,this.timeout("print",()=>{window.print(),this.show_qr_code=!1},50)}}get can_print(){var e;return this._settings.get("app.can_print_qr")&&this.visitor.checked_in&&(null===(e=this.visitor)||void 0===e?void 0:e.extension_data.qr)}get today(){return Date.now()}get remote(){var e,t;return!!(null===(t=null===(e=this.event)||void 0===e?void 0:e.ext("remote"))||void 0===t?void 0:t.find(e=>{var t;return e===(null===(t=this.visitor)||void 0===t?void 0:t.email)}))}ngOnChanges(e){e.visitor&&this.loadGuest()}loadGuest(e=0){var t,i;return(0,r.mG)(this,void 0,void 0,function*(){if(this.visitor)if(this.loading="printing",this.visitor.checked_in){const n=yield(0,z.pP)(this.visitor.email).toPromise().catch(e=>null);!(null===(i=null===(t=null==n?void 0:n.extension_data)||void 0===t?void 0:t.qr)||void 0===i?void 0:i.code)&&e<5?this.timeout("load_guest",()=>this.loadGuest(++e),1e3):this.loading=""}else this.loading=""})}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(b),w.Y36(Z.gb))},e.\u0275cmp=w.Xpm({type:e,selectors:[["visitor-details"]],inputs:{event:"event",visitor:"visitor"},outputs:{eventChange:"eventChange"},features:[w.qOj,w.TTD],decls:18,vars:21,consts:[[1,"w-12","text-lg","flex","justify-center"],[4,"ngIf","ngIfElse"],["checkin_state",""],["host_state",""],["flex","",1,"p-2","flex-1"],[1,"w-48","py-2","flex","items-center","justify-end"],[3,"matTooltip","loading","content","click"],["matTooltip","Checkin Guest","content","event_available",3,"loading","state","click"],["matTooltip","Checkout Guest","content","event_busy",3,"loading","click"],["mat-icon-button","",3,"href","matTooltip"],["matTooltip","Print QR Code","content","event_busy",3,"loading","click"],[1,"w-14","p-2"],["qr-code","","class","print-only fixed inset-0 flex flex-col justify-center bg-white space-y-2",4,"ngIf"],["class","p-2 rounded-full material-icons border-2 border-dotted border-gray-600",4,"ngIf","ngIfElse"],[1,"p-2","rounded-full","material-icons","border-2","border-dotted","border-gray-600"],[1,"p-2","rounded-full","material-icons","bg-green-600","border-2","border-green-600","text-white"],[1,"p-2","rounded-full","material-icons","bg-blue-600","border-2","border-blue-600","text-white"],["qr-code","",1,"print-only","fixed","inset-0","flex","flex-col","justify-center","bg-white","space-y-2"],[1,"flex","justify-center"],["alt","qr-code",3,"src"]],template:function(e,t){if(1&e&&(w.TgZ(0,"div",0),w.YNc(1,Y,2,2,"ng-container",1),w.YNc(2,F,2,0,"ng-template",null,2,w.W1O),w.YNc(4,L,2,0,"ng-template",null,3,w.W1O),w.qZA(),w.TgZ(6,"div",4),w._uU(7),w.qZA(),w.TgZ(8,"div",5),w.TgZ(9,"action-icon",6),w.NdJ("click",function(){return t.toggleRemote()}),w.qZA(),w.TgZ(10,"action-icon",7),w.NdJ("click",function(){return t.checkin()}),w.qZA(),w.TgZ(11,"action-icon",8),w.NdJ("click",function(){return t.checkout()}),w.qZA(),w.TgZ(12,"a",9),w.TgZ(13,"app-icon"),w._uU(14,"email"),w.qZA(),w.qZA(),w.TgZ(15,"action-icon",10),w.NdJ("click",function(){return t.printQRCode()}),w.qZA(),w.qZA(),w._UZ(16,"div",11),w.YNc(17,S,22,9,"div",12)),2&e){const e=w.MAs(5);w.xp6(1),w.Q6J("ngIf",!t.visitor.organizer)("ngIfElse",e),w.xp6(6),w.Oqu((null==t.visitor?null:t.visitor.name)||(null==t.visitor?null:t.visitor.email)),w.xp6(2),w.ekj("invisible",!(null!=t.visitor&&t.visitor.is_external)||(null==t.visitor?null:t.visitor.organizer)),w.Q6J("matTooltip",t.remote?"Set as In-Person Visitor":"Set as Remote Visitior")("loading","remote"===t.loading)("content",t.remote?"tap_and_play":"business"),w.xp6(1),w.ekj("invisible",!(null!=t.visitor&&t.visitor.is_external)||(null==t.visitor?null:t.visitor.organizer)),w.Q6J("loading","checkin"===t.loading)("state",null!=t.visitor&&t.visitor.checked_in?"success":""),w.xp6(1),w.ekj("invisible",!(null!=t.visitor&&t.visitor.is_external)||(null==t.visitor?null:t.visitor.organizer)),w.Q6J("loading","checkout"===t.loading),w.xp6(1),w.Q6J("href","mailto:"+(null==t.visitor?null:t.visitor.email),w.LSH)("matTooltip",null!=t.visitor&&t.visitor.organizer?"Email Host":"Email Guest"),w.xp6(3),w.ekj("invisible",!t.can_print),w.Q6J("loading","printing"===t.loading),w.xp6(2),w.Q6J("ngIf",t.show_qr_code)}},directives:[n.O5,j.m,G.gM,I.zs,Q.o],pipes:[n.uU],styles:["[_nghost-%COMP%]{width:100%;padding:0 .5rem}[_nghost-%COMP%], [_nghost-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{height:100%;border-bottom:1px solid #ccc;height:3.5rem}[_nghost-%COMP%] > div[_ngcontent-%COMP%]:first-child{border:none}.invisible[_ngcontent-%COMP%]{opacity:0;pointer-events:none}"]}),e})();function $(e,t){1&e&&(w.TgZ(0,"i",16),w._uU(1,"event"),w.qZA())}function B(e,t){1&e&&(w.TgZ(0,"i",16),w._uU(1,"close"),w.qZA())}function D(e,t){1&e&&(w.TgZ(0,"i",16),w._uU(1,"done"),w.qZA())}function H(e,t){if(1&e){const e=w.EpF();w.TgZ(0,"div",18),w._UZ(1,"div",19),w.TgZ(2,"visitor-details",20),w.NdJ("eventChange",function(t){return w.CHM(e),w.oxw(2).event=t}),w.qZA(),w.qZA()}if(2&e){const e=t.$implicit,i=w.oxw(2);w.xp6(2),w.Q6J("visitor",e)("event",i.event),w.uIk("disabled",!i.matches[e.email])}}function X(e,t){if(1&e&&(w.ynx(0),w.YNc(1,H,3,3,"div",17),w.BQk()),2&e){const e=w.oxw();w.xp6(1),w.Q6J("ngForOf",e.event.attendees)}}let R=(()=>{class e extends Z.KG{constructor(e){super(),this._state=e,this.matches={},this.filters=this._state.filters,this.checkinGuests=()=>(0,r.mG)(this,void 0,void 0,function*(){this.loading="checkin",this.event=yield this._state.checkAllGuestsIn(this.event).catch(e=>this.event),this.loading=""}),this.checkoutGuests=()=>(0,r.mG)(this,void 0,void 0,function*(){this.loading="checkout",this.event=yield this._state.checkAllGuestsOut(this.event).catch(e=>this.event),this.loading=""})}get guestCount(){var e;return(null===(e=this.event)||void 0===e?void 0:e.attendees.reduce((e,t)=>e+(t.is_external&&!t.organizer?1:0),0))||0}get has_search(){return this._state.search}ngOnInit(){this.subscription("events",this._state.filtered_events.subscribe(()=>this.updateMatches()))}updateMatches(){this.matches={};const e=(this._state.search||"").toLowerCase();for(const t of this.event.attendees)this.matches[t.email]=!e||t.email.toLowerCase().includes(e)||t.name.toLowerCase().includes(e)}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(b))},e.\u0275cmp=w.Xpm({type:e,selectors:[["visitor-event"]],inputs:{event:"event"},features:[w.qOj],decls:28,vars:25,consts:[[1,"flex","items-center","px-2","bg-gray-100"],[1,"w-12","text-lg","flex","justify-center"],["class","p-2 rounded-full material-icons bg-gray-400",4,"ngIf"],[1,"w-24","p-2"],[1,"w-48","p-2"],["flex","",1,"p-2","flex-1"],[1,"w-64","p-2","truncate"],[1,"w-32","py-2","flex","items-center"],["matTooltip","Checkin All Guests","content","event_available",3,"loading","disabled","click"],["matTooltip","Checkout All Guests","content","event_busy",3,"loading","disabled","click"],["mat-icon-button","","matTooltip","Email Host",3,"href"],[1,"w-16","p-2"],["mat-icon-button","",3,"disabled","matTooltip","click"],["attendees","",1,"w-full","overflow-hidden","relative","border-b","border-gray-300"],["bar","",1,"absolute","top-0","bg-gray-400","z-10"],[4,"ngIf"],[1,"p-2","rounded-full","material-icons","bg-gray-400"],["visitor","","class","relative w-full pl-12 bg-gray-200",4,"ngFor","ngForOf"],["visitor","",1,"relative","w-full","pl-12","bg-gray-200"],["l-bar","",1,"absolute","bg-gray-400"],[3,"visitor","event","eventChange"]],template:function(e,t){if(1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"div",1),w.YNc(2,$,2,0,"i",2),w.YNc(3,B,2,0,"i",2),w.YNc(4,D,2,0,"i",2),w.qZA(),w.TgZ(5,"div",3),w._uU(6),w.ALo(7,"date"),w.ALo(8,"async"),w.qZA(),w.TgZ(9,"div",4),w._uU(10),w.qZA(),w.TgZ(11,"div",5),w._uU(12),w.qZA(),w.TgZ(13,"div",6),w._uU(14),w.qZA(),w.TgZ(15,"div",7),w.TgZ(16,"action-icon",8),w.NdJ("click",function(){return t.checkinGuests()}),w.qZA(),w.TgZ(17,"action-icon",9),w.NdJ("click",function(){return t.checkoutGuests()}),w.qZA(),w.TgZ(18,"a",10),w.TgZ(19,"app-icon"),w._uU(20,"email"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(21,"div",11),w.TgZ(22,"button",12),w.NdJ("click",function(){return t.show_attendees=!t.show_attendees}),w.TgZ(23,"app-icon"),w._uU(24),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.TgZ(25,"div",13),w._UZ(26,"div",14),w.YNc(27,X,2,1,"ng-container",15),w.qZA()),2&e){let e;w.xp6(2),w.Q6J("ngIf","declined"!==(null==t.event?null:t.event.status)&&"done"!==(null==t.event?null:t.event.state)),w.xp6(1),w.Q6J("ngIf","declined"===(null==t.event?null:t.event.status)),w.xp6(1),w.Q6J("ngIf","done"===(null==t.event?null:t.event.state)&&"declined"!==(null==t.event?null:t.event.status)),w.xp6(2),w.hij(" ",w.xi3(7,20,null==t.event?null:t.event.date,null!=(e=w.lcZ(8,23,t.filters))&&e.show_week?"MMM d, h:mm a":"shortTime")," "),w.xp6(4),w.hij(" ",(null==t.event||null==t.event.organiser?null:t.event.organiser.name)||(null==t.event||null==t.event.organiser?null:t.event.organiser.email)," "),w.xp6(2),w.Oqu(null==t.event?null:t.event.title),w.xp6(2),w.Oqu(null==t.event?null:t.event.location),w.xp6(2),w.Q6J("loading","checkin"===t.loading)("disabled",t.guestCount<=0),w.xp6(1),w.Q6J("loading","checkout"===t.loading)("disabled",t.guestCount<=0),w.xp6(1),w.Q6J("href","mailto:"+(null==t.event||null==t.event.organiser?null:t.event.organiser.email),w.LSH),w.xp6(4),w.Q6J("disabled",!(null!=t.event&&null!=t.event.attendees&&t.event.attendees.length))("matTooltip",t.show_attendees||t.has_search?"Hide Attendees":"Show Attendees"),w.xp6(2),w.Oqu(t.show_attendees?"keyboard_arrow_down":"keyboard_arrow_right"),w.xp6(1),w.Udp("height",t.show_attendees||t.has_search?3.5*t.event.attendees.length+"rem":"0rem"),w.xp6(1),w.Udp("height","calc("+(3.5*(t.event.attendees.length-1)+1.75)+"rem + 1px)"),w.xp6(1),w.Q6J("ngIf",t.show_attendees||t.has_search)}},directives:[n.O5,j.m,G.gM,I.zs,Q.o,I.lW,n.sg,E],pipes:[n.uU,n.Ov],styles:["[_nghost-%COMP%]{width:100%}visitor-details[_ngcontent-%COMP%]{transition:opacity .2s}[attendees][_ngcontent-%COMP%]{transition:height .2s}[visitor][_ngcontent-%COMP%]{height:3.5rem}[bar][_ngcontent-%COMP%]{width:2px;left:calc(2rem - 1px)}[l-bar][_ngcontent-%COMP%]{height:2px;left:2rem;top:calc(50% - 1px);width:1rem}[disabled=true][_ngcontent-%COMP%]{opacity:.35}"]}),e})();function W(e,t){1&e&&w._UZ(0,"visitor-event",13),2&e&&w.Q6J("event",t.$implicit)}function V(e,t){if(1&e&&(w.ynx(0),w.YNc(1,W,1,1,"visitor-event",12),w.ALo(2,"async"),w.BQk()),2&e){const e=w.oxw();w.xp6(1),w.Q6J("ngForOf",w.lcZ(2,2,e.bookings))("ngForTrackBy",e.trackByFn)}}function K(e,t){1&e&&(w.TgZ(0,"div",14),w.TgZ(1,"p",15),w._uU(2," There are no visitors for the currently selected date. "),w.qZA(),w.qZA())}let ee=(()=>{class e{constructor(e){this._state=e,this.bookings=this._state.filtered_events}trackByFn(e,t){return t?t.id:void 0}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(b))},e.\u0275cmp=w.Xpm({type:e,selectors:[["visitor-listings"]],decls:19,vars:4,consts:[[1,"w-full","flex","flex-col","flex-1","text-sm","h-full"],[1,"w-full","flex","items-center","bg-white","border-b","border-gray-500","p-2","font-medium"],[1,"w-12","p-2"],[1,"w-24","p-2"],[1,"w-48","p-2"],["flex","",1,"p-2","flex-1"],[1,"w-64","p-2"],[1,"w-32","p-2"],[1,"w-16","p-2"],[1,"w-full","flex-1","overflow-auto","h-1/2"],[4,"ngIf","ngIfElse"],["empty_state",""],[3,"event",4,"ngFor","ngForOf","ngForTrackBy"],[3,"event"],[1,"h-full","w-full","flex","items-center","justify-center"],[1,"p-8"]],template:function(e,t){if(1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"div",1),w._UZ(2,"div",2),w.TgZ(3,"div",3),w._uU(4,"Time"),w.qZA(),w.TgZ(5,"div",4),w._uU(6,"Host"),w.qZA(),w.TgZ(7,"div",5),w._uU(8,"Title"),w.qZA(),w.TgZ(9,"div",6),w._uU(10,"Location"),w.qZA(),w.TgZ(11,"div",7),w._uU(12,"Actions"),w.qZA(),w._UZ(13,"div",8),w.qZA(),w.TgZ(14,"div",9),w.YNc(15,V,3,4,"ng-container",10),w.ALo(16,"async"),w.qZA(),w.qZA(),w.YNc(17,K,3,0,"ng-template",null,11,w.W1O)),2&e){const e=w.MAs(18);let i;w.xp6(15),w.Q6J("ngIf",null==(i=w.lcZ(16,2,t.bookings))?null:i.length)("ngIfElse",e)}},directives:[n.O5,n.sg,R],pipes:[n.Ov],styles:[""]}),e})();var te=i(5994);const ie=["app-visitors",""];function ne(e,t){1&e&&w._UZ(0,"mat-progress-bar",4)}const se=[{path:"",component:(()=>{class e{constructor(e){this._state=e,this.loading=this._state.loading}ngOnInit(){this._state.startPolling()}ngOnDestroy(){this._state.stopPolling()}}return e.\u0275fac=function(t){return new(t||e)(w.Y36(b))},e.\u0275cmp=w.Xpm({type:e,selectors:[["","app-visitors",""]],attrs:ie,decls:6,vars:3,consts:[[1,"relative","overflow-hidden","flex-1","flex","flex-col"],[1,"w-full"],[1,"w-full","flex-1","h-0"],["class","w-full","mode","indeterminate",4,"ngIf"],["mode","indeterminate",1,"w-full"]],template:function(e,t){1&e&&(w._UZ(0,"sidebar"),w.TgZ(1,"main",0),w._UZ(2,"visitors-topbar",1),w._UZ(3,"visitor-listings",2),w.YNc(4,ne,1,0,"mat-progress-bar",3),w.ALo(5,"async"),w.qZA()),2&e&&(w.xp6(4),w.Q6J("ngIf",w.lcZ(5,1,t.loading)))},directives:[y.k,P,ee,n.O5,te.pW],pipes:[n.Ov],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%;background:var(--bg)}"]}),e})()}];let oe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[n.ez,s.u5,l.v,o.Bz.forChild(se)]]}),e})()}}]);