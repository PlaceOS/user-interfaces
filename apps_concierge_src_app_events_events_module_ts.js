"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_events_events_module_ts"],{3655:(oe,M,a)=>{a.r(M),a.d(M,{EventsModule:()=>Jt});var e=a(7404),P=a(5189),R=a(6843),v=a(6842);const u=["app-events",""];let $=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["","app-events",""]],attrs:u,decls:5,vars:0,consts:[[1,"flex","flex-1","h-px"],[1,"relative","flex","flex-col","flex-1","w-1/2","h-full"]],template:function(n,s){1&n&&(e.nrm(0,"app-topbar"),e.j41(1,"div",0),e.nrm(2,"app-sidebar"),e.j41(3,"main",1),e.nrm(4,"router-outlet"),e.k0s()())},dependencies:[P.S,R.c,v.n3],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}\n\n/*# sourceMappingURL=events.component.ts-angular-inline--145.css.map*/"]})}return o})();var m=a(316),_=a(4456),G=a(363),g=a(9204),d=a(7375),k=a(8113),J=a(2185),W=a(9908),L=a(3240),H=a(6441),O=a(521),D=a(2175),V=a(8627),Z=a(9803),K=a(1963),b=a(5443),Y=a(6e3),j=a(7841),S=a(2587);let E=(()=>{class o extends d.Tv{changed(){this.timeout("changed",()=>this._changed.next(Date.now()),100)}get period(){return this._options.getValue()?.period}get calendar(){return this._settings.get("app.group_events_calendar")}constructor(t,n,s,i){super(),this._settings=t,this._org=n,this._dialog=s,this._router=i,this._options=new O.t({period:"week"}),this._loading=new O.t(""),this._poll=new O.t(0),this._changed=new O.t(0),this.event_list=(0,D.zV)([this._org.active_building,this._options,this._changed,this._poll]).pipe((0,V.p)(([l])=>!!l),(0,Z.B)(310),(0,K.n)(([l,c])=>(this._loading.next("Loading event list..."),(0,k.UU)({period_start:(0,W._)((0,L.o)(c.date)),period_end:(0,W._)((0,H.D)(c.end||c.date||Date.now())),calendars:this.calendar}))),(0,b.T)(l=>l.filter(c=>c.extension_data?.shared_event).sort((c,p)=>c.date-p.date)),(0,Y.M)(()=>this._loading.next("")),(0,j.t)(1)),this.options=this._options.asObservable(),this.loading=this._loading.asObservable()}startPolling(t=6e4){return this.interval("poll",()=>document.hasFocus()?this._poll.next(Date.now()):"",t),()=>this.stopPolling()}stopPolling(){this.clearInterval("poll")}setOptions(t){this._options.next({...this._options.value,...t})}viewEvent(t){var n=this;const s=this._dialog.open(k.E2,{data:{event:t,concierge:!0}});this.subscription(`edit:${t.id}`,s.componentInstance.edit.subscribe(()=>{this._router.navigate(["/entertainment","events","manage",t.id])})),this.subscription(`remove:${t.id}`,s.componentInstance.remove.subscribe((0,g.A)(function*(){yield n.removeEvent(t),s.close()})))}removeEvent(t){var n=this;return(0,g.A)(function*(){const s=yield(0,d.GE)({title:"Delete Event",content:`Are you sure you want to delete the event "${t.title}"?`,icon:{content:"delete"},confirm_text:"Delete"},n._dialog);"done"===s.reason&&(s.loading("Deleting event..."),yield(0,k.Nn)(t.id,{calendar:n.calendar}).toPromise().catch(i=>{throw(0,d.UG)(i),s.close(),i}),s.close(),(0,d.VX)("Successfully deleted event."),n._changed.next(Date.now()))})()}static#e=this.\u0275fac=function(n){return new(n||o)(e.KVO(d.h$),e.KVO(J.yb),e.KVO(S.bZ),e.KVO(v.Ix))};static#t=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var N=a(6243),y=a(6337),Q=a(452),q=a(610),I=a(8797),h=a(6671),me=a(6109),ee=a(3602),X=a(4950),ie=a(5175),x=a(5060),U=a(9434),C=a(1034),pe=a(6354),te=a(2238),ue=a(8328),ve=a(3208),fe=a(7249),_e=a(3666),he=a(6062),ge=a(2011);const be=o=>({key:"date",name:"Event",content:o}),Ee=o=>({key:"level",name:"Level",content:o,size:"8rem",sortable:!1}),ye=o=>({key:"room",name:"Room",content:o,size:"12rem",sortable:!1}),xe=o=>({key:"interested",name:"Interested",content:o,size:"6rem",sortable:!1}),ke=o=>({key:"attending",name:"Attending",content:o,size:"6rem",sortable:!1}),Fe=o=>({key:"state",name:"Status",content:o,size:"8.5rem"}),Me=o=>({key:"access",name:"Published",content:o,size:"6rem",sortable:!1}),je=o=>({key:"actions",name:" ",content:o,size:"4rem",sortable:!1}),Te=(o,r,t,n,s,i,l,c)=>[o,r,t,n,s,i,l,c],Ie=o=>["/entertainment","events","manage",o];function Ce(o,r){if(1&o&&e.nrm(0,"img",23),2&o){const t=e.XpG().row;e.Y8G("source",t.images[0])}}function we(o,r){if(1&o&&(e.j41(0,"div",13)(1,"div",14)(2,"div",15),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.j41(5,"div",16),e.EFF(6),e.nI1(7,"date"),e.k0s()(),e.j41(8,"div",17),e.DNE(9,Ce,1,1,"img",18),e.k0s(),e.j41(10,"div",19)(11,"div",20),e.EFF(12),e.k0s(),e.j41(13,"div",21),e.EFF(14),e.nI1(15,"date"),e.nI1(16,"date"),e.k0s(),e.j41(17,"div",22),e.EFF(18),e.nI1(19,"space"),e.nI1(20,"async"),e.nI1(21,"building"),e.k0s()()()),2&o){let t;const n=r.row,s=e.XpG();e.R7$(3),e.SpI(" ",e.i5U(4,7,n.date,"MMM")," "),e.R7$(3),e.SpI(" ",e.i5U(7,10,n.date,"d")," "),e.R7$(3),e.Y8G("ngIf",null==n.images?null:n.images.length),e.R7$(3),e.JRh(n.title),e.R7$(2),e.Lme(" ",e.i5U(15,13,n.date,"EEEE, "+s.time_format)," \u2013 ",e.i5U(16,16,n.date+60*n.duration*1e3,s.time_format+" (z)")," "),e.R7$(4),e.SpI(" ",null==(t=e.bMT(21,23,null==(t=e.bMT(20,21,e.bMT(19,19,null==n.linked_event?null:n.linked_event.system_id)))?null:t.zones))?null:t.address," ")}}function Re(o,r){1&o&&(e.j41(0,"span",26),e.EFF(1," No Level "),e.k0s())}function $e(o,r){if(1&o&&(e.j41(0,"div",24),e.EFF(1),e.nI1(2,"space"),e.nI1(3,"async"),e.nI1(4,"level"),e.DNE(5,Re,2,0,"span",25),e.k0s()),2&o){let t,n;const s=r.row,i=e.XpG();e.R7$(),e.SpI(" ",null==(t=e.bMT(4,6,null==(t=e.bMT(3,4,e.bMT(2,2,null==(t=i.room(s))?null:t.email)))?null:t.zones))?null:t.display_name," "),e.R7$(4),e.Y8G("ngIf",!(null!=(n=i.room(s))&&n.email))}}function Ge(o,r){1&o&&(e.j41(0,"span",26),e.EFF(1," No Room "),e.k0s())}function Oe(o,r){if(1&o&&(e.j41(0,"div",24),e.EFF(1),e.nI1(2,"space"),e.nI1(3,"async"),e.DNE(4,Ge,2,0,"span",25),e.k0s()),2&o){let t,n;const s=r.row,i=e.XpG();e.R7$(),e.SpI(" ",null==(t=e.bMT(3,4,e.bMT(2,2,null==(t=i.room(s))?null:t.email)))?null:t.display_name," "),e.R7$(3),e.Y8G("ngIf",!(null!=(n=i.room(s))&&n.email))}}function De(o,r){if(1&o&&(e.j41(0,"div",28),e.nrm(1,"attendee-list",29),e.k0s()),2&o){const t=e.XpG().row;e.R7$(),e.Y8G("list",t.attendees)("host",t.user_email||t.host)("show_host",!1)("hide_close",!0)("custom_title","Interested")}}function Ve(o,r){if(1&o&&(e.j41(0,"button",27),e.EFF(1),e.k0s(),e.DNE(2,De,2,5,"ng-template",null,8,e.C5r)),2&o){const t=r.row,n=e.sdS(3);e.Y8G("content",n)("disabled",!(null!=t.attendees&&t.attendees.length)),e.R7$(),e.SpI(" ",(null==t.attendees?null:t.attendees.length)||0," ")}}function Se(o,r){if(1&o&&(e.j41(0,"div",28),e.nrm(1,"attendee-list",30),e.k0s()),2&o){const t=e.XpG().row,n=e.XpG();e.R7$(),e.Y8G("show_host",!1)("list",n.checkedInList(t.attendees))("host",t.user_email||t.host)("hide_close",!0)}}function Ne(o,r){if(1&o&&(e.j41(0,"button",27),e.EFF(1),e.k0s(),e.DNE(2,Se,2,4,"ng-template",null,8,e.C5r)),2&o){const t=r.row,n=e.sdS(3),s=e.XpG();e.Y8G("content",n)("disabled",!s.checkedInCount(t.attendees)),e.R7$(),e.SpI(" ",s.checkedInCount(t.attendees)," ")}}function Pe(o,r){1&o&&(e.j41(0,"div",32)(1,"app-icon"),e.EFF(2,"done"),e.k0s()())}function Le(o,r){if(1&o&&e.DNE(0,Pe,3,0,"div",31),2&o){const t=r.data;e.Y8G("ngIf","OPEN"===t||"open"===t)}}function Ye(o,r){if(1&o&&(e.j41(0,"div",24)(1,"div",33),e.EFF(2),e.k0s()()),2&o){const t=r.row;e.R7$(),e.AVh("bg-success","done"!==t.state&&"in_progress"!==t.state&&"started"!==t.state)("text-success-content","done"!==t.state&&"in_progress"!==t.state&&"started"!==t.state)("bg-warning","in_progress"===t.state||"started"===t.state)("text-warning-content","in_progress"===t.state||"started"===t.state)("bg-base-200","done"===t.state)("text-base-content","done"===t.state),e.R7$(),e.SpI(" ","done"===t.state?"Done":"in_progress"===t.state||"started"===t.state?"In Progress":"Active"," ")}}function Xe(o,r){if(1&o){const t=e.RV6();e.j41(0,"button",34)(1,"app-icon"),e.EFF(2,"more_vert"),e.k0s()(),e.j41(3,"mat-menu",null,9)(5,"button",35)(6,"div",36)(7,"app-icon",37),e.EFF(8," confirmation_number "),e.k0s(),e.j41(9,"div",38),e.EFF(10,"Promote Event"),e.k0s()()(),e.j41(11,"button",39),e.bIt("click",function(){const s=e.eBV(t).row,i=e.XpG();return e.Njj(i.viewEvent(s))}),e.j41(12,"div",36)(13,"app-icon",37),e.EFF(14,"visibility"),e.k0s(),e.j41(15,"div",38),e.EFF(16,"View Event"),e.k0s()()(),e.j41(17,"a",40)(18,"div",36)(19,"app-icon",37),e.EFF(20,"edit"),e.k0s(),e.j41(21,"div",38),e.EFF(22,"Edit Event"),e.k0s()()(),e.j41(23,"button",35)(24,"div",36)(25,"app-icon",37),e.EFF(26,"content_copy"),e.k0s(),e.j41(27,"div",38),e.EFF(28,"Copy URL"),e.k0s()()(),e.j41(29,"button",39),e.bIt("click",function(){const s=e.eBV(t).row,i=e.XpG();return e.Njj(i.removeEvent(s))}),e.j41(30,"div",36)(31,"app-icon",41),e.EFF(32,"delete"),e.k0s(),e.j41(33,"div",38),e.EFF(34,"Delete Event"),e.k0s()()()()}if(2&o){const t=r.row,n=e.sdS(4);e.Y8G("matMenuTriggerFor",n)("disabled","done"===t.state),e.R7$(5),e.Y8G("disabled",!0),e.R7$(12),e.Y8G("routerLink",e.eq3(5,Ie,null==t?null:t.id)),e.R7$(6),e.Y8G("disabled",!0)}}let Ue=(()=>{class o{room(t){return t.resources.find(n=>n.email!==this._state.calendar)}get time_format(){return this._settings.time_format}constructor(t,n){this._settings=t,this._state=n,this.loading=this._state.loading,this.event_list=this._state.event_list.pipe((0,Y.M)(s=>console.log("Event List:",s))),this.viewEvent=s=>this._state.viewEvent(s),this.removeEvent=s=>this._state.removeEvent(s)}checkedInCount(t){return t?.length?t.filter(n=>n.checked_in).length:0}checkedInList(t){return t?.length?t.filter(n=>n.checked_in):[]}static#e=this.\u0275fac=function(n){return new(n||o)(e.rXU(d.h$),e.rXU(E))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["event-listing"]],decls:20,vars:32,consts:[["event_template",""],["level_template",""],["room_template",""],["interested_template",""],["attending_template",""],["published_template",""],["status_template",""],["actions_template",""],["view_attendees",""],["menu","matMenu"],["mode","indeterminate",1,"w-full"],["empty_message","No group events for selected period",1,"min-w-[72rem]","w-full","block","text-sm",3,"data","columns","sortable"],[1,"w-full","h-20"],[1,"flex","items-center","space-x-2","px-3","py-2"],["date","",1,"flex","flex-col","items-center","leading-tight","w-8"],["month","",1,"text-sm","font-medium","relative","top-0.5","opacity-60"],["day","",1,"text-2xl","font-light","relative","-top-0.5"],[1,"flex","items-center","justify-center","h-12","w-12","rounded","overflow-hidden","bg-base-200","border","border-base-200"],["auth","","class","min-h-full min-w-full object-cover",3,"source",4,"ngIf"],["details","",1,"flex","flex-col"],[1,"text-sm"],[1,"text-xs","opacity-40"],[1,"text-xs"],["auth","",1,"min-h-full","min-w-full","object-cover",3,"source"],[1,"p-4"],["class","opacity-30",4,"ngIf"],[1,"opacity-30"],["icon","","matRipple","","customTooltip","",1,"rounded","h-12","w-12","mx-auto",3,"content","disabled"],[1,"relative","w-[20rem]","h-[28rem]","overflow-auto","bg-white","rounded","shadow"],[3,"list","host","show_host","hide_close","custom_title"],[3,"show_host","list","host","hide_close"],["class","rounded h-8 w-8 flex items-center justify-center text-2xl bg-success text-success-content mx-auto",4,"ngIf"],[1,"rounded","h-8","w-8","flex","items-center","justify-center","text-2xl","bg-success","text-success-content","mx-auto"],[1,"px-4","py-1","rounded-full"],["icon","","matRipple","",1,"h-12","w-12","rounded","mx-2",3,"matMenuTriggerFor","disabled"],["mat-menu-item","",3,"disabled"],[1,"flex","items-center","space-x-2"],[1,"text-2xl"],[1,"mr-2"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"routerLink"],[1,"text-2xl","text-error"]],template:function(n,s){if(1&n&&(e.nrm(0,"mat-progress-bar",10),e.nI1(1,"async"),e.nrm(2,"simple-table",11)(3,"div",12),e.DNE(4,we,22,25,"ng-template",null,0,e.C5r)(6,$e,6,8,"ng-template",null,1,e.C5r)(8,Oe,5,6,"ng-template",null,2,e.C5r)(10,Ve,4,3,"ng-template",null,3,e.C5r)(12,Ne,4,3,"ng-template",null,4,e.C5r)(14,Le,1,1,"ng-template",null,5,e.C5r)(16,Ye,3,13,"ng-template",null,6,e.C5r)(18,Xe,35,7,"ng-template",null,7,e.C5r)),2&n){const i=e.sdS(5),l=e.sdS(7),c=e.sdS(9),p=e.sdS(11),f=e.sdS(13),F=e.sdS(15),Wt=e.sdS(17),Ht=e.sdS(19);e.AVh("opacity-0",!e.bMT(1,5,s.loading)),e.R7$(2),e.Y8G("data",s.event_list)("columns",e.lV(23,Te,e.eq3(7,be,i),e.eq3(9,Ee,l),e.eq3(11,ye,c),e.eq3(13,xe,p),e.eq3(15,ke,f),e.eq3(17,Fe,Wt),e.eq3(19,Me,F),e.eq3(21,je,Ht)))("sortable",!0)}},dependencies:[m.bT,C.kk,C.fb,C.Cp,pe.HM,x.r6,U.R,te.I,ue.O,ve.U,fe.I,v.Wk,m.Jj,m.vh,_e.D,he.b,ge.J]})}return o})();var ze=a(3206),ae=a(9273),re=a(7535);const Ae=()=>[];function Be(o,r){if(1&o&&(e.j41(0,"div",12)(1,"div",13),e.EFF(2),e.k0s()()),2&o){const t=r.$implicit,n=r.index;e.R7$(2),e.Lme(" ",t," ",n>=12?"PM":"AM"," ")}}function Je(o,r){if(1&o&&(e.j41(0,"div",14)(1,"div",15),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.j41(4,"div"),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&o){const t=r.$implicit;e.R7$(2),e.SpI(" ",e.i5U(3,2,t,"EEEE")," "),e.R7$(3),e.JRh(e.i5U(6,5,t,"d"))}}function We(o,r){1&o&&e.nrm(0,"div",16)}function He(o,r){if(1&o&&(e.j41(0,"div",24),e.nrm(1,"group-event-card",25),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.Y8G("event",t)}}function Ze(o,r){if(1&o){const t=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){const s=e.eBV(t).$implicit,i=e.XpG(2);return e.Njj(i.viewEvent(s))}),e.nrm(1,"div",21),e.j41(2,"div",22),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.nrm(5,"div",23),e.DNE(6,He,2,1,"ng-template",null,0,e.C5r),e.k0s()}if(2&o){const t=r.$implicit,n=e.sdS(7);e.xc7("top",100*t.offset+"%")("height",100*t.length+"%"),e.R7$(3),e.Lme(" ",e.i5U(4,8,t.date,"shortTime")," \u2014 ",t.title," "),e.R7$(2),e.Y8G("content",n)("hover",!0)}}function Ke(o,r){if(1&o&&(e.j41(0,"div",26),e.nrm(1,"div",27),e.k0s()),2&o){const t=e.XpG(2);e.xc7("top",100*t.now_offset+"%")}}function Qe(o,r){if(1&o&&(e.j41(0,"div",17),e.DNE(1,Ze,8,11,"button",18),e.nI1(2,"async"),e.DNE(3,Ke,2,2,"div",19),e.k0s()),2&o){const t=r.$implicit,n=r.index,s=e.XpG();e.xc7("transform","translateX("+100*n+"%)"),e.R7$(),e.Y8G("ngForOf",e.bMT(2,4,s.event_day_map)[s.dateString(t)]||e.lJ4(6,Ae)),e.R7$(2),e.Y8G("ngIf",s.isCurrentDay(t))}}let qe=(()=>{class o extends d.Tv{dateString(t){return t?(0,h.GP)(t,"yyyy-MM-dd"):""}isCurrentDay(t){return!!t&&(0,h.GP)(Date.now(),"yyyy-MM-dd")===(0,h.GP)(t,"yyyy-MM-dd")}get now(){return(0,ze.c)(Date.now()).valueOf()}get now_offset(){const t=new Date(this.now);return(60*t.getHours()+t.getMinutes())/1440}constructor(t,n,s){super(),this._state=t,this._dialog=n,this._router=s,this.days=new Array(7).fill(0).map((i,l)=>l+1),this.hours=new Array(24).fill(0).map((i,l)=>l%12?l%12:12),this.event_list=this._state.event_list,this.event_day_map=this.event_list.pipe((0,b.T)(i=>{const l={};for(const c of i){const p=(0,h.GP)(c.date,"yyyy-MM-dd");l[p]||(l[p]=[]);const f=new Date(c.date);l[p].push({...c,offset:(60*f.getHours()+f.getMinutes())/1440,length:c.duration/1440})}return l}),(0,ae.Z)({}),(0,j.t)(1)),this.viewEvent=i=>this._state.viewEvent(i)}ngOnInit(){this.subscription("date",this._state.options.subscribe(({date:t})=>{t&&(this.days=this.days.map((n,s)=>(0,I.f)(t,s).valueOf()))}))}static#e=this.\u0275fac=function(n){return new(n||o)(e.rXU(E),e.rXU(S.bZ),e.rXU(v.Ix))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["event-week-view"]],features:[e.Vt3],decls:13,vars:8,consts:[["event_card",""],[1,"absolute","inset-0","overflow-auto","flex"],[1,"sticky","left-0","w-24","min-h-full","flex","flex-col","items-end","z-20","bg-base-100"],["header","",1,"sticky","top-0","h-16","min-h-16","flex","justify-end","z-10"],[1,"bg-base-100","pt-6","h-10"],[1,"opacity-30","text-xs","px-2"],["class","relative min-h-10 w-full flex-1 bg-base-100",4,"ngFor","ngForOf"],[1,"relative","min-w-[84rem]","min-h-full","z-10"],["header","",1,"sticky","flex","top-0","h-16","min-h-16","border-b","border-base-200","bg-base-100","z-10"],["date","","class","flex flex-col items-center justify-center p-4 min-w-48 flex-1 border-r border-base-200",4,"ngFor","ngForOf"],["class","relative flex min-h-10 min-w-[84rem] flex-1 border-x border-b border-base-200 pointer-events-none",4,"ngFor","ngForOf"],["date","","class","absolute top-16 left-0 w-[calc(100%/7)] h-[60rem] flex-1 border-r border-base-200 pointer-events-none",3,"transform",4,"ngFor","ngForOf"],[1,"relative","min-h-10","w-full","flex-1","bg-base-100"],["hour","",1,"absolute","top-0","right-1","-translate-y-1/2","whitespace-nowrap","text-xs","opacity-60"],["date","",1,"flex","flex-col","items-center","justify-center","p-4","min-w-48","flex-1","border-r","border-base-200"],[1,"text-sm","opacity-60"],[1,"relative","flex","min-h-10","min-w-[84rem]","flex-1","border-x","border-b","border-base-200","pointer-events-none"],["date","",1,"absolute","top-16","left-0","w-[calc(100%/7)]","h-[60rem]","flex-1","border-r","border-base-200","pointer-events-none"],["matRipple","","class","absolute inset-x-1 bg-base-100 rounded border border-base-200 hover:border-info shadow pl-3 pr-2 py-1 overflow-hidden pointer-events-auto",3,"top","height","click",4,"ngFor","ngForOf"],["now","","class","absolute inset-x-0 h-0 border-y-2 border-base-content",3,"top",4,"ngIf"],["matRipple","",1,"absolute","inset-x-1","bg-base-100","rounded","border","border-base-200","hover:border-info","shadow","pl-3","pr-2","py-1","overflow-hidden","pointer-events-auto",3,"click"],[1,"absolute","left-0","inset-y-0","bg-info","w-1.5"],[1,"text-sm","opacity-60","h-full","text-left"],["customTooltip","","xPosition","center","yPosition","bottom",1,"absolute","inset-0",3,"content","hover"],[1,"p-2","pointer-events-none"],[3,"event"],["now","",1,"absolute","inset-x-0","h-0","border-y-2","border-base-content"],[1,"absolute","left-0","top-0","-translate-x-1/2","-translate-y-1/2","h-4","w-4","rounded-full","bg-base-content"]],template:function(n,s){1&n&&(e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),e.EFF(5),e.nI1(6,"date"),e.k0s()()(),e.DNE(7,Be,3,2,"div",6),e.k0s(),e.j41(8,"div",7)(9,"div",8),e.DNE(10,Je,7,8,"div",9),e.k0s(),e.DNE(11,We,1,0,"div",10)(12,Qe,4,7,"div",11),e.k0s()()),2&n&&(e.R7$(5),e.SpI(" ",e.i5U(6,5,s.now,"zzzz")," "),e.R7$(2),e.Y8G("ngForOf",s.hours),e.R7$(3),e.Y8G("ngForOf",s.days),e.R7$(),e.Y8G("ngForOf",s.hours),e.R7$(),e.Y8G("ngForOf",s.days))},dependencies:[m.Sq,m.bT,x.r6,te.I,re.T,m.Jj,m.vh]})}return o})();var et=a(1257),tt=a(9681),nt=a(640);const z=()=>[];function ot(o,r){if(1&o&&(e.j41(0,"div",6),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&o){const t=r.$implicit;e.R7$(),e.SpI(" ",e.i5U(2,1,t,"EEEE")," ")}}function st(o,r){if(1&o&&(e.j41(0,"div",16),e.nrm(1,"group-event-card",17),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.Y8G("event",t)}}function it(o,r){if(1&o){const t=e.RV6();e.j41(0,"button",12),e.bIt("click",function(){const s=e.eBV(t).$implicit,i=e.XpG(2);return e.Njj(i.viewEvent(s))}),e.nrm(1,"div",13),e.j41(2,"div",14),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.nrm(5,"div",15),e.DNE(6,st,2,1,"ng-template",null,1,e.C5r),e.k0s()}if(2&o){const t=r.$implicit,n=e.sdS(7);e.R7$(3),e.Lme(" ",e.i5U(4,4,t.date,"shortTime")," \u2014 ",t.title," "),e.R7$(2),e.Y8G("content",n)("hover",!0)}}function at(o,r){if(1&o&&(e.j41(0,"button",18),e.EFF(1),e.nI1(2,"async"),e.k0s()),2&o){const t=e.XpG().$implicit,n=e.sdS(10),s=e.XpG();e.Y8G("matMenuTriggerFor",n),e.R7$(),e.SpI(" ",(e.bMT(2,2,s.event_day_map)[s.dateString(t.id)]||e.lJ4(4,z)).length-3," more event(s) ")}}function rt(o,r){if(1&o){const t=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){const s=e.eBV(t).$implicit,i=e.XpG(2);return e.Njj(i.viewEvent(s))}),e.j41(1,"div",20)(2,"div",21),e.EFF(3),e.k0s(),e.j41(4,"div",22),e.EFF(5),e.nI1(6,"date"),e.k0s()()()}if(2&o){const t=r.$implicit;e.R7$(3),e.JRh(t.title),e.R7$(2),e.SpI(" ",e.i5U(6,2,t.date,"shortTime")," ")}}function lt(o,r){if(1&o&&(e.j41(0,"div",7)(1,"div",8),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.DNE(4,it,8,7,"button",9),e.nI1(5,"async"),e.nI1(6,"slice"),e.DNE(7,at,3,5,"button",10),e.nI1(8,"async"),e.j41(9,"mat-menu",null,0),e.DNE(11,rt,7,5,"button",11),e.nI1(12,"async"),e.nI1(13,"slice"),e.k0s()()),2&o){const t=r.$implicit,n=e.XpG();e.R7$(),e.AVh("opacity-30",!t.is_month)("bg-secondary",t.is_today)("text-secondary-content",t.is_today),e.R7$(),e.SpI(" ",e.i5U(3,10,t.id,"d")," "),e.R7$(2),e.Y8G("ngForOf",e.brH(6,15,e.bMT(5,13,n.event_day_map)[n.dateString(t.id)]||e.lJ4(26,z),0,3)),e.R7$(3),e.Y8G("ngIf",(e.bMT(8,19,n.event_day_map)[n.dateString(t.id)]||e.lJ4(27,z)).length>3),e.R7$(4),e.Y8G("ngForOf",e.i5U(13,23,e.bMT(12,21,n.event_day_map)[n.dateString(t.id)]||e.lJ4(28,z),3))}}let dt=(()=>{class o extends d.Tv{dateString(t){return t?(0,h.GP)(t,"yyyy-MM-dd"):""}get offset_weekday(){return this._settings.get("app.week_start")||0}constructor(t,n,s,i){super(),this._state=t,this._settings=n,this._dialog=s,this._router=i,this.month=(0,L.o)(Date.now()).valueOf(),this.weekdays=[],this.month_days=[],this.event_list=this._state.event_list,this.event_day_map=this.event_list.pipe((0,b.T)(l=>{const c={};for(const p of l){const f=(0,h.GP)(p.date,"yyyy-MM-dd");c[f]||(c[f]=[]);const F=new Date(p.date);c[f].push({...p,offset:(60*F.getHours()+F.getMinutes())/1440,length:p.duration/1440})}return c}),(0,ae.Z)({}),(0,j.t)(1)),this.viewEvent=l=>this._state.viewEvent(l)}ngOnInit(){this.subscription("date",this._state.options.subscribe(({date:t})=>{this.month=t,this._setMonthDays(),this._setWeekdays()})),this._setMonthDays(),this._setWeekdays()}_setMonthDays(){const t=(0,q.k)((0,Q.w)(this.month),{weekStartsOn:this.offset_weekday});this.month_days=Array.from(Array(42).keys()).map(n=>{const s=(0,I.f)(t,n).valueOf();return{id:s,is_today:(0,et.r)(s,Date.now()),is_month:(0,tt.t)(s,this.month)}})}_setWeekdays(){const t=(0,q.k)(Date.now(),{weekStartsOn:this.offset_weekday});this.weekdays=Array.from(Array(7).keys()).map(n=>(0,I.f)(t,n))}static#e=this.\u0275fac=function(n){return new(n||o)(e.rXU(E),e.rXU(d.h$),e.rXU(S.bZ),e.rXU(v.Ix))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["event-month-view"]],features:[e.Vt3],decls:4,vars:2,consts:[["menu","matMenu"],["event_card",""],[1,"absolute","inset-0","overflow-auto"],[1,"grid","grid-cols-7","min-w-full","w-[80rem]","min-h-full","h-[56rem]","m-2","border-b","border-base-200"],["weekday","","class","relative flex items-center justify-center text-sm opacity-60 p-2 h-12",4,"ngFor","ngForOf"],["monthday","","class","relative border border-base-200 flex flex-col space-y-1",4,"ngFor","ngForOf"],["weekday","",1,"relative","flex","items-center","justify-center","text-sm","opacity-60","p-2","h-12"],["monthday","",1,"relative","border","border-base-200","flex","flex-col","space-y-1"],[1,"rounded-full","w-8","h-8","flex","items-center","justify-center","mt-1","ml-1"],["matRipple","","class","relative w-[calc(100%-0.5rem)] h-7 bg-base-100 rounded border border-base-200 hover:border-info shadow pl-3 pr-2 py-1 overflow-hidden mx-1",3,"click",4,"ngFor","ngForOf"],["matRipple","","matTooltip","More events","class","relative w-[calc(100%-0.5rem)] h-7 rounded pl-3 pr-2 py-1 overflow-hidden mx-1 underline text-sm",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["matRipple","",1,"relative","w-[calc(100%-0.5rem)]","h-7","bg-base-100","rounded","border","border-base-200","hover:border-info","shadow","pl-3","pr-2","py-1","overflow-hidden","mx-1",3,"click"],[1,"absolute","left-0","inset-y-0","bg-info","w-1.5"],[1,"text-sm","opacity-60","h-full","text-left","truncate"],["customTooltip","","xPosition","center","yPosition","bottom",1,"absolute","inset-0",3,"content","hover"],[1,"p-2","pointer-events-none"],[3,"event"],["matRipple","","matTooltip","More events",1,"relative","w-[calc(100%-0.5rem)]","h-7","rounded","pl-3","pr-2","py-1","overflow-hidden","mx-1","underline","text-sm",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"flex","items-center","space-x-4"],[1,"flex-1"],[1,"text-xs","opacity-60","py-1","px-2","rounded","bg-base-200","text-base-content"]],template:function(n,s){1&n&&(e.j41(0,"div",2)(1,"div",3),e.DNE(2,ot,3,4,"div",4)(3,lt,14,29,"div",5),e.k0s()()),2&n&&(e.R7$(2),e.Y8G("ngForOf",s.weekdays),e.R7$(),e.Y8G("ngForOf",s.month_days))},dependencies:[m.Sq,m.bT,C.kk,C.fb,C.Cp,nt.oV,x.r6,te.I,re.T,m.Jj,m.P9,m.vh],styles:[".grid[_ngcontent-%COMP%]{grid-template-rows:3rem repeat(6,minmax(0,1fr))}\n\n/*# sourceMappingURL=event-month-view.component.ts-angular-inline--147.css.map*/"]})}return o})();function ct(o,r){if(1&o&&(e.j41(0,"span",12),e.EFF(1),e.nI1(2,"async"),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.JRh("week"===e.bMT(2,1,t.period)?"This Week":"This Month")}}function mt(o,r){1&o&&e.nrm(0,"event-week-view")}function pt(o,r){1&o&&e.nrm(0,"event-month-view")}let ut=(()=>{class o{get time_format(){return this._settings.time_format}constructor(t,n,s,i){this._settings=t,this._state=n,this._router=s,this._route=i,this.period=this._state.options.pipe((0,b.T)(l=>l.period)),this.options=this._state.options,this.is_today=this.options.pipe((0,b.T)(l=>l.date<=Date.now()&&l.end>Date.now())),this.event_list=this._state.event_list,this.event_day_map=this.event_list.pipe((0,b.T)(l=>{const c={};for(const p of l){const f=(0,h.GP)(p.date,"yyyy-MM-dd");c[f]||(c[f]=[]),c[f].push(p)}return c}),(0,j.t)(1))}setPeriod(t){this._state.setOptions({period:t}),this._router.navigate([],{relativeTo:this._route,queryParams:{period:t},queryParamsHandling:"merge"})}nextPeriod(){var t=this;return(0,g.A)(function*(){const{date:n,period:s}=yield t.options.pipe((0,ee.s)(1)).toPromise();t._router.navigate([],{relativeTo:t._route,queryParams:{range:"week"===s?(0,N.J)(n,1).valueOf():(0,y.P)(n,1).valueOf()},queryParamsHandling:"merge"})})()}previousPeriod(){var t=this;return(0,g.A)(function*(){const{date:n,period:s}=yield t.options.pipe((0,ee.s)(1)).toPromise();t._router.navigate([],{relativeTo:t._route,queryParams:{range:"week"===s?(0,N.J)(n,-1).valueOf():(0,y.P)(n,-1).valueOf()},queryParamsHandling:"merge"})})()}static#e=this.\u0275fac=function(n){return new(n||o)(e.rXU(d.h$),e.rXU(E),e.rXU(v.Ix),e.rXU(v.nX))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["event-calendar"]],decls:28,vars:21,consts:[["month_calendar",""],[1,"flex","items-center","border-y","border-base-200","w-full"],[1,"flex-1","px-2","py-4"],["class","text-info text-xs",4,"ngIf"],[1,"flex-2","flex","items-center","justify-center","space-x-2"],[1,"font-medium","pl-4"],["icon","","matRipple","",3,"click"],[1,"flex-1","flex","items-center","justify-end","space-x-2","py-2"],["btn","","matRipple","",1,"rounded-3xl",3,"click"],[1,"w-full","h-4"],[1,"relative","flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],[1,"text-info","text-xs"]],template:function(n,s){if(1&n){const i=e.RV6();e.j41(0,"div",1)(1,"div",2),e.DNE(2,ct,3,3,"span",3),e.nI1(3,"async"),e.k0s(),e.j41(4,"div",4)(5,"div",5),e.EFF(6),e.nI1(7,"async"),e.nI1(8,"date"),e.k0s(),e.j41(9,"button",6),e.bIt("click",function(){return e.eBV(i),e.Njj(s.previousPeriod())}),e.j41(10,"app-icon"),e.EFF(11,"chevron_left"),e.k0s()(),e.j41(12,"button",6),e.bIt("click",function(){return e.eBV(i),e.Njj(s.nextPeriod())}),e.j41(13,"app-icon"),e.EFF(14,"chevron_right"),e.k0s()()(),e.j41(15,"div",7)(16,"button",8),e.nI1(17,"async"),e.bIt("click",function(){return e.eBV(i),e.Njj(s.setPeriod("week"))}),e.EFF(18," Week "),e.k0s(),e.j41(19,"button",8),e.nI1(20,"async"),e.bIt("click",function(){return e.eBV(i),e.Njj(s.setPeriod("month"))}),e.EFF(21," Month "),e.k0s()()(),e.nrm(22,"div",9),e.j41(23,"div",10),e.DNE(24,mt,1,0,"event-week-view",11),e.nI1(25,"async"),e.DNE(26,pt,1,0,"ng-template",null,0,e.C5r),e.k0s()}if(2&n){let i;const l=e.sdS(27);e.R7$(2),e.Y8G("ngIf",e.bMT(3,8,s.is_today)),e.R7$(4),e.SpI(" ",e.i5U(8,12,null==(i=e.bMT(7,10,s.options))?null:i.date,"MMM yyyy")," "),e.R7$(10),e.AVh("inverse","week"!==e.bMT(17,15,s.period)),e.R7$(3),e.AVh("inverse","month"!==e.bMT(20,17,s.period)),e.R7$(5),e.Y8G("ngIf","month"!==e.bMT(25,19,s.period))("ngIfElse",l)}},dependencies:[m.bT,x.r6,U.R,qe,dt,m.Jj,m.vh],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n\n/*# sourceMappingURL=event-calendar.component.ts-angular-inline--148.css.map*/"]})}return o})();const vt=()=>["/entertainment","events","manage"];function ft(o,r){if(1&o&&(e.j41(0,"mat-option",23),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.display," ")}}function _t(o,r){1&o&&(e.j41(0,"div",24),e.nrm(1,"event-listing",25),e.k0s())}function ht(o,r){if(1&o&&(e.nrm(0,"event-calendar",26),e.nI1(1,"async")),2&o){const t=e.XpG();e.Y8G("period",e.bMT(1,1,t.period))}}function gt(o,r){1&o&&(e.j41(0,"div",27),e.nrm(1,"div",28),e.j41(2,"p",29),e.EFF(3," A shared calendar is required to view and manage group events. "),e.k0s()())}let bt=(()=>{class o extends d.Tv{get has_calendar(){return this._settings.get("app.group_events_calendar")}constructor(t,n,s,i){super(),this._settings=t,this._state=n,this._router=s,this._route=i,this.period=this._state.options.pipe((0,b.T)(l=>l.period),(0,me.F)()),this.view="list",this.period_list=[]}ngOnInit(){this.subscription("poll_events",this._state.startPolling()),this.subscription("period",this.period.subscribe(()=>{this._generatePeriods(),this._initPeriod()})),this._generatePeriods(),this._initPeriod(),this.subscription("route.query",this._route.queryParamMap.subscribe(t=>{t.has("view")&&(this.view=t.get("view")),t.has("period")&&t.get("period")!==this._state.period&&this.setPeriodType(t.get("period"),!1),this._generatePeriods(),t.has("range")&&this.timeout("update",()=>{const n=parseInt(t.get("range"),10),s=this.period_list.find(i=>n>=i.start&&n<i.end)||this.period_list[0]||{start:n,end:"week"===this._state.period?(0,N.J)(n,1).valueOf():(0,y.P)(n,1).valueOf()};this.selected_range=s.id||n,this._state.setOptions({date:s.start,end:s.end}),this.setPeriod(this.selected_range)})}))}setView(t){this.view=t,this._router.navigate([],{relativeTo:this._route,queryParams:{view:t},queryParamsHandling:"merge"})}setPeriodType(t,n=!0){this._state.setOptions({period:t}),n&&this._router.navigate([],{relativeTo:this._route,queryParams:{period:t},queryParamsHandling:"merge"})}setPeriod(t){this.timeout("set_period",()=>{const n=this.period_list.find(l=>t>=l.start&&t<l.end)||this.period_list[0];if(!n)return;this.selected_range=n.id;const{start:s,end:i}=n;this._state.setOptions({date:s,end:i}),this._router.navigate([],{relativeTo:this._route,queryParams:{range:t},queryParamsHandling:"merge"})})}_generatePeriods(){var t=this;this.timeout("generate_periods",(0,g.A)(function*(){const n=[],s=yield t.period.pipe((0,ee.s)(1)).toPromise();let i=function se(o,r){return(0,y.P)(o,-r)}(Date.now(),6).valueOf();const l=(0,y.P)(Date.now(),6).valueOf(),c=t._settings.get("app.week_start")||0;for("month"===s?i=(0,Q.w)(i).valueOf():"week"===s&&(i=(0,q.k)(i,{weekStartsOn:c}).valueOf());i<l;)if("week"===s){const p=(0,H.D)((0,I.f)(i,6)).valueOf();n.push({id:i,start:i,end:p,display:`${(0,h.GP)(i,"EEE, do MMM")} \u2013 ${(0,h.GP)(p,"do MMM")}`}),i=(0,I.f)(i,7).valueOf()}else{if("month"!==s)break;{const p=(0,I.f)((0,y.P)(i,1),-1).valueOf();n.push({id:i,start:i,end:p,display:`${(0,h.GP)(i,"MMMM yyyy")}`}),i=(0,y.P)(i,1).valueOf()}}t.period_list=n}))}_initPeriod(){this.timeout("update",()=>{if(this.period_list.length){let t=this.period_list.findIndex(n=>n.start<=Date.now()&&n.end>=Date.now());t<0&&(t=0),this.setPeriod(this.period_list[t].id),this.selected_range=this.period_list[t].id}},350)}static#e=this.\u0275fac=function(n){return new(n||o)(e.rXU(d.h$),e.rXU(E),e.rXU(v.Ix),e.rXU(v.nX))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-event-list"]],features:[e.Vt3],decls:38,vars:14,consts:[[1,"absolute","inset-0","flex","flex-col"],[1,"flex","items-center","justify-between","p-8"],[1,"text-2xl","font-medium"],["btn","","matRipple","",3,"routerLink"],[1,"ml-2"],[1,"text-2xl"],["filters","",1,"flex","items-center","px-8","space-x-2","pb-4"],["btn","","matRipple","",1,"rounded-3xl",3,"click"],[1,"flex","items-center","space-x-2"],[1,"text-xl"],[1,"pr-2"],[1,"h-full","px-2"],[1,"w-px","h-full","bg-base-300"],["appearance","outline",1,"w-32","no-subscript"],[3,"ngModelChange","ngModel"],["value","week"],["value","month"],["appearance","outline",1,"w-64","no-subscript"],[3,"value",4,"ngFor","ngForOf"],[1,"h-1/2","flex-1","w-full","px-8","overflow-y-auto","relative"],["class","w-full min-h-full overflow-x-auto",4,"ngIf"],[3,"period",4,"ngIf"],["class","absolute inset-0 flex items-center justify-center z-50",4,"ngIf"],[3,"value"],[1,"w-full","min-h-full","overflow-x-auto"],[1,"block"],[3,"period"],[1,"absolute","inset-0","flex","items-center","justify-center","z-50"],[1,"absolute","inset-0","bg-base-100","opacity-80"],[1,"opacity-60","text-lg","max-w-[32rem]"]],template:function(n,s){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3,"Events"),e.k0s(),e.j41(4,"a",3)(5,"div",4),e.EFF(6,"Create Event"),e.k0s(),e.j41(7,"app-icon",5),e.EFF(8,"chevron_right"),e.k0s()()(),e.j41(9,"div",6)(10,"button",7),e.bIt("click",function(){return s.setView("list")}),e.j41(11,"div",8)(12,"app-icon",9),e.EFF(13,"list"),e.k0s(),e.j41(14,"div",10),e.EFF(15,"List"),e.k0s()()(),e.j41(16,"button",7),e.bIt("click",function(){return s.setView("calendar")}),e.j41(17,"div",8)(18,"app-icon",9),e.EFF(19,"event"),e.k0s(),e.j41(20,"div",10),e.EFF(21,"Calendar"),e.k0s()()(),e.j41(22,"div",11),e.nrm(23,"div",12),e.k0s(),e.j41(24,"mat-form-field",13)(25,"mat-select",14),e.nI1(26,"async"),e.bIt("ngModelChange",function(l){return s.setPeriodType(l)}),e.j41(27,"mat-option",15),e.EFF(28,"Week"),e.k0s(),e.j41(29,"mat-option",16),e.EFF(30,"Month"),e.k0s()()(),e.j41(31,"mat-form-field",17)(32,"mat-select",14),e.mxI("ngModelChange",function(l){return e.DH7(s.selected_range,l)||(s.selected_range=l),l}),e.bIt("ngModelChange",function(l){return s.setPeriod(l)}),e.DNE(33,ft,2,2,"mat-option",18),e.k0s()()(),e.j41(34,"div",19),e.DNE(35,_t,2,0,"div",20)(36,ht,2,3,"event-calendar",21),e.k0s()(),e.DNE(37,gt,4,0,"div",22)),2&n&&(e.R7$(4),e.Y8G("routerLink",e.lJ4(13,vt)),e.R7$(6),e.AVh("inverse","list"!==s.view),e.R7$(6),e.AVh("inverse","calendar"!==s.view),e.R7$(9),e.Y8G("ngModel",e.bMT(26,11,s.period)),e.R7$(7),e.R50("ngModel",s.selected_range),e.R7$(),e.Y8G("ngForOf",s.period_list),e.R7$(2),e.Y8G("ngIf","list"===s.view),e.R7$(),e.Y8G("ngIf","calendar"===s.view),e.R7$(),e.Y8G("ngIf",!s.has_calendar))},dependencies:[m.Sq,m.bT,_.BC,_.vS,X.rl,ie.VO,x.wT,x.r6,U.R,v.Wk,Ue,ut,m.Jj],styles:["[_nghost-%COMP%]{flex:1}\n\n/*# sourceMappingURL=events-list.component.ts-angular-inline--146.css.map*/"]})}return o})();var ne=a(4879),Et=a(7871),yt=a(1874),xt=a(9134),kt=a(8390),A=a(2168),Ft=a(7984),Mt=a(7024),jt=a(1134),le=a(9771),Tt=a(9608),It=a(1413),Ct=a(8e3),wt=a(9391),Rt=a(6864),B=a(2772),$t=a(597);const de=()=>["/entertainment","events"],w=()=>({standalone:!0});function Gt(o,r){if(1&o){const t=e.RV6();e.j41(0,"mat-chip-row",47),e.bIt("removed",function(){const s=e.eBV(t).$implicit,i=e.XpG(2);return e.Njj(i.removeTag(s))}),e.EFF(1),e.j41(2,"app-icon",48),e.EFF(3,"close"),e.k0s()()}if(2&o){const t=r.$implicit;e.Y8G("selectable",!0)("removable",!0),e.R7$(),e.SpI(" ",t," ")}}function Ot(o,r){if(1&o){const t=e.RV6();e.j41(0,"div",49)(1,"div",50)(2,"label",51),e.EFF(3),e.nI1(4,"translate"),e.j41(5,"span"),e.EFF(6,"*"),e.k0s()(),e.j41(7,"a-time-field",52),e.bIt("ngModelChange",function(s){e.eBV(t);const i=e.XpG(2);return e.Njj(i.form.patchValue({date:s}))}),e.k0s()(),e.j41(8,"div",50)(9,"label",53),e.EFF(10),e.nI1(11,"translate"),e.j41(12,"span"),e.EFF(13,"*"),e.k0s()(),e.j41(14,"a-time-field",54),e.bIt("ngModelChange",function(s){e.eBV(t);const i=e.XpG(2);return e.Njj(i.form.patchValue({date_end:s}))}),e.k0s()()()}if(2&o){let t;const n=e.XpG(2);e.R7$(3),e.SpI(" ",e.bMT(4,11,"FORM.START_TIME")," "),e.R7$(4),e.Y8G("ngModel",n.form.getRawValue().date)("disabled",n.form.controls.date.disabled)("ngModelOptions",e.lJ4(15,w))("use_24hr",n.use_24hr),e.R7$(3),e.SpI(" ",e.bMT(11,13,"FORM.END_TIME"),""),e.R7$(4),e.Y8G("ngModel",n.form.value.date_end||n.form.value.date+60*n.form.value.duration*1e3)("ngModelOptions",e.lJ4(16,w))("from",(null==n.form||null==(t=n.form.getRawValue())?null:t.date)+18e5)("use_24hr",n.use_24hr)("extra_info_fn",n.duration_info)}}function Dt(o,r){if(1&o&&(e.j41(0,"mat-option",55),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function Vt(o,r){1&o&&(e.j41(0,"mat-option",56),e.EFF(1," No matching timezones "),e.k0s()),2&o&&e.Y8G("disabled",!0)}function St(o,r){if(1&o&&(e.j41(0,"mat-option",55),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t.display_name||t.name," ")}}function Nt(o,r){if(1&o&&(e.j41(0,"mat-option",55),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t.display_name||t.name," ")}}function Pt(o,r){if(1&o&&(e.j41(0,"mat-option",55),e.EFF(1),e.k0s()),2&o){const t=r.$implicit;e.Y8G("value",t.email),e.R7$(),e.SpI(" ",t.display_name||t.name," ")}}function Lt(o,r){if(1&o){const t=e.RV6();e.qex(0),e.j41(1,"label",57),e.EFF(2,"Building Location"),e.k0s(),e.j41(3,"mat-form-field",32)(4,"mat-select",58),e.bIt("ngModelChange",function(s){e.eBV(t);const i=e.XpG(2);return e.Njj(i.setBuilding(s))}),e.DNE(5,St,2,2,"mat-option",35),e.nI1(6,"async"),e.k0s()(),e.j41(7,"div",59)(8,"div",60)(9,"label",61),e.EFF(10,"Level"),e.k0s(),e.j41(11,"mat-form-field",32)(12,"mat-select",62),e.bIt("ngModelChange",function(s){e.eBV(t);const i=e.XpG(2);return e.Njj(i.setLevel(s))}),e.DNE(13,Nt,2,2,"mat-option",35),e.nI1(14,"async"),e.k0s()()(),e.j41(15,"div",63)(16,"label",61),e.EFF(17,"Room"),e.k0s(),e.j41(18,"mat-form-field",32)(19,"mat-select",64),e.nI1(20,"async"),e.mxI("ngModelChange",function(s){e.eBV(t);const i=e.XpG(2);return e.DH7(i.resource,s)||(i.resource=s),e.Njj(s)}),e.j41(21,"mat-option")(22,"i"),e.EFF(23,"None"),e.k0s()(),e.DNE(24,Pt,2,2,"mat-option",35),e.nI1(25,"async"),e.k0s()()()(),e.bVm()}if(2&o){let t;const n=e.XpG(2);e.R7$(4),e.Y8G("ngModel",n.building_zone)("ngModelOptions",e.lJ4(18,w)),e.R7$(),e.Y8G("ngForOf",e.bMT(6,10,n.building_list)),e.R7$(7),e.Y8G("ngModel",n.level_zone)("ngModelOptions",e.lJ4(19,w)),e.R7$(),e.Y8G("ngForOf",e.bMT(14,12,n.active_levels)),e.R7$(6),e.R50("ngModel",n.resource),e.Y8G("ngModelOptions",e.lJ4(20,w))("disabled",0===(null==(t=e.bMT(20,14,n.available_spaces))?null:t.length)),e.R7$(5),e.Y8G("ngForOf",e.bMT(25,16,n.available_spaces))}}function Yt(o,r){if(1&o){const t=e.RV6();e.j41(0,"div",5)(1,"a",6)(2,"app-icon"),e.EFF(3,"close"),e.k0s()(),e.j41(4,"form",7)(5,"h3",8),e.EFF(6),e.k0s(),e.j41(7,"section",9)(8,"label",10),e.EFF(9,"Event Title"),e.j41(10,"span"),e.EFF(11,"*"),e.k0s()(),e.qex(12),e.j41(13,"mat-form-field",11),e.nrm(14,"input",12),e.j41(15,"mat-error"),e.EFF(16),e.nI1(17,"translate"),e.k0s()(),e.j41(18,"label",13),e.EFF(19,"Organiser"),e.j41(20,"span"),e.EFF(21,"*"),e.k0s()(),e.nrm(22,"a-user-search-field",14),e.j41(23,"label",15),e.EFF(24,"Tags"),e.k0s(),e.j41(25,"mat-form-field",16)(26,"mat-chip-grid",17,1),e.DNE(28,Gt,4,3,"mat-chip-row",18),e.j41(29,"input",19),e.bIt("matChipInputTokenEnd",function(s){e.eBV(t);const i=e.XpG();return e.Njj(i.addTag(s))}),e.k0s()()(),e.j41(30,"div",20)(31,"mat-checkbox",21),e.EFF(32," Featured "),e.k0s(),e.j41(33,"mat-checkbox",22),e.bIt("ngModelChange",function(s){e.eBV(t);const i=e.XpG();return e.Njj(i.form.patchValue({view_access:s?"OPEN":"PRIVATE"}))}),e.EFF(34," Publish "),e.k0s()(),e.bVm(),e.nrm(35,"div",23),e.j41(36,"h3",8),e.EFF(37,"Date and Time"),e.k0s(),e.qex(38),e.j41(39,"div",24)(40,"div",25)(41,"label",26),e.EFF(42),e.nI1(43,"translate"),e.j41(44,"span"),e.EFF(45,"*"),e.k0s()(),e.j41(46,"a-date-field",27),e.EFF(47),e.nI1(48,"translate"),e.k0s()(),e.j41(49,"div",25)(50,"label",26),e.EFF(51),e.nI1(52,"translate"),e.j41(53,"span"),e.EFF(54,"*"),e.k0s()(),e.j41(55,"a-date-field",28),e.EFF(56),e.nI1(57,"translate"),e.k0s()()(),e.DNE(58,Ot,15,17,"div",29),e.j41(59,"div",30)(60,"label",31),e.pXf(61,3),e.k0s(),e.j41(62,"mat-form-field",32)(63,"app-icon",33),e.EFF(64," search "),e.k0s(),e.nrm(65,"input",34),e.k0s(),e.j41(66,"mat-autocomplete",null,2),e.DNE(68,Dt,2,2,"mat-option",35)(69,Vt,2,1,"mat-option",36),e.k0s()(),e.bVm(),e.nrm(70,"div",23),e.j41(71,"h3",8),e.EFF(72,"Location"),e.k0s(),e.qex(73),e.j41(74,"div",37)(75,"button",38),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.form.patchValue({attendance_type:"ONSITE"}))}),e.j41(76,"app-icon",39),e.EFF(77,"domain"),e.k0s(),e.j41(78,"div",40),e.EFF(79,"On Premise"),e.k0s()(),e.j41(80,"button",38),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.form.patchValue({attendance_type:"ONLINE"}))}),e.j41(81,"app-icon",39),e.EFF(82,"laptop_mac"),e.k0s(),e.j41(83,"div",40),e.EFF(84,"Online Only"),e.k0s()(),e.j41(85,"button",38),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.form.patchValue({attendance_type:"ANY"}))}),e.j41(86,"app-icon",39),e.EFF(87,"add"),e.k0s(),e.j41(88,"div",40),e.EFF(89,"Both"),e.k0s()()(),e.DNE(90,Lt,26,21,"ng-container",41),e.bVm(),e.nrm(91,"div",23),e.j41(92,"h3",8),e.EFF(93,"Event Information"),e.k0s(),e.qex(94),e.j41(95,"label",10),e.EFF(96,"Event Description"),e.k0s(),e.nrm(97,"rich-text-input",42),e.j41(98,"label",15),e.EFF(99,"Images"),e.k0s(),e.nrm(100,"image-list-field",43),e.bVm(),e.k0s(),e.j41(101,"div",44)(102,"a",45),e.EFF(103," Cancel "),e.k0s(),e.j41(104,"button",46),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.save())}),e.EFF(105," Save "),e.k0s()()()()}if(2&o){const t=e.sdS(27),n=e.sdS(67),s=e.XpG();e.R7$(),e.Y8G("routerLink",e.lJ4(41,de)),e.R7$(3),e.Y8G("formGroup",s.form),e.R7$(2),e.SpI(" ",s.form.value.id?"Edit":"New"," Group Event "),e.R7$(10),e.SpI(" ",e.bMT(17,31,"FORM.TITLE_ERROR")," "),e.R7$(12),e.Y8G("ngForOf",s.tag_list),e.R7$(),e.Y8G("matChipInputFor",t)("matChipInputSeparatorKeyCodes",s.separators)("matChipInputAddOnBlur",!0),e.R7$(4),e.Y8G("ngModel","OPEN"===s.form.value.view_access)("ngModelOptions",e.lJ4(42,w)),e.R7$(9),e.SpI(" ",e.bMT(43,33,"FORM.DATE"),""),e.R7$(4),e.Y8G("to",s.end_date),e.R7$(),e.SpI(" ",e.bMT(48,35,"FORM.DATE_ERROR")," "),e.R7$(4),e.SpI(" ",e.bMT(52,37,"FORM.END_DATE"),""),e.R7$(4),e.Y8G("from",s.start_date)("to",s.end_date),e.R7$(),e.SpI(" ",e.bMT(57,39,"FORM.DATE_ERROR")," "),e.R7$(2),e.Y8G("ngIf",!s.form.value.all_day),e.R7$(7),e.Y8G("matAutocomplete",n),e.R7$(3),e.Y8G("ngForOf",s.filtered_timezones),e.R7$(),e.Y8G("ngIf",!s.timezones.length),e.R7$(6),e.AVh("inverse",!1)("inverse","ONSITE"!==s.form.value.attendance_type),e.R7$(5),e.AVh("inverse","ONLINE"!==s.form.value.attendance_type),e.R7$(5),e.AVh("inverse","ANY"!==s.form.value.attendance_type),e.R7$(5),e.Y8G("ngIf","ONLINE"!==s.form.value.attendance_type),e.R7$(12),e.Y8G("routerLink",e.lJ4(43,de))}}function Xt(o,r){1&o&&(e.j41(0,"div",65),e.nrm(1,"mat-spinner",66),e.j41(2,"p"),e.EFF(3,"Saving event..."),e.k0s()())}const Ut=[];let ce=(()=>{class o extends d.Tv{get tag_list(){return this.form.getRawValue().tags||Ut}get max_duration(){return this._settings.get("app.events.max_duration")||480}get use_24hr(){return this._settings.get("app.use_24_hour_time")}get building_zone(){const t=this.level_zone;return this._org.buildings.find(s=>s.id===t?.parent_id)||this._org.building}get level_zone(){return this._org.levelWithID(this._form_state.options_value.zone_ids||[])}constructor(t,n,s,i,l,c){super(),this._form_state=t,this._state=n,this._route=s,this._router=i,this._org=l,this._settings=c,this.loading=!1,this.timezones=[],this.filtered_timezones=[],this.form=this._form_state.form,this.separators=[ne.Fm,ne.KE,ne.t6],this.building_list=this._org.building_list,this.active_levels=this._org.active_levels,this.available_spaces=this._form_state.available_spaces,this.duration_info=p=>{const f=this.form.getRawValue().date;if((0,h.GP)(f,"yyyy-MM-dd")!==(0,h.GP)(p,"yyyy-MM-dd"))return"";const F=(0,yt.o)(p,f);return` (${(0,xt.a)({hours:Math.floor(F/60),minutes:F%60})})`}}ngOnInit(){var t=this;return(0,g.A)(function*(){yield t._org.initialised.pipe((0,Et.$)(n=>n)).toPromise(),t.form.patchValue({location:t._org.building.address||t._org.building.display_name,organiser:(0,d.Ny)(),attendance_type:"ONSITE",shared_event:!0}),t.subscription("route.params",t._route.paramMap.subscribe(function(){var n=(0,g.A)(function*(s){if(s.has("id")){const i=yield(0,k.ue)(s.get("id"),{calendar:t._state.calendar}).toPromise();if(!i)return t._router.navigate(["/entertainment","events"]);t._form_state.newForm(i),console.log("Event:",i.extension_data?.tags),t.resource=i.resources.find(l=>l.email!==t._state.calendar)?.email,console.log("Resource:",t.resource),t.form.patchValue({tags:i.extension_data?.tags||[],organiser:new kt.Gp({id:i.organiser?.id,email:i.host,name:i.organiser?.name}),resources:i.resources.filter(l=>l.email!==t._state.calendar)})}});return function(s){return n.apply(this,arguments)}}())),t._updateTimezoneList(),t.subscription("tz-change",t.form.valueChanges.subscribe(()=>t._updateTimezoneList()))})()}setBuilding(t){this._org.building=t}setLevel(t){(0,d.Am)([this._org.organisation.id,this._org.building.parent_id,this._org.building.id,t.id]),this._form_state.setOptions({zone_ids:[t.id]})}addTag(t){if(!this.form||!this.form.controls.tags)return;const n=t.chipInput.inputElement,s=t.value,i=this.tag_list;(s||"").trim()&&(i.push(s),this.form.controls.tags.setValue(i)),n&&(n.value="")}removeTag(t){if(!this.form||!this.form.controls.tags)return;const n=this.tag_list,s=n.indexOf(t);s>=0&&(n.splice(s,1),this.form.controls.tags.setValue(n))}save(){var t=this;return(0,g.A)(function*(){if(t.form.markAllAsTouched(),!t.form.valid)return(0,d.UG)(`Some form fields are invalid. [${(0,d.F7)(t.form)}]`);t.loading=!0;let n=t.form.getRawValue().resources;const s=yield(new A.Jm).transform(t._state.calendar);if(n.push(s||new A.$x({id:t._state.calendar,email:t._state.calendar})),t.resource){const c=yield(new A.Jm).transform(t.resource);n.push(c)}console.log("Resources:",n),n=(0,d.Am)(n,"email"),t.form.patchValue({resources:n,host:t._state.calendar});const i=t.form.getRawValue().date,l=yield t._form_state.postForm(!1,[t._state.calendar],!0).catch(c=>(0,d.UG)(c));t._state.changed(),t.loading=!1,l&&t._router.navigate(["/entertainment","events"],{queryParams:{range:(0,L.o)(i).valueOf()}})})()}_updateTimezoneList(){const t=this.form?.value?.timezone||"";this.timezones=d.Rd,this.filtered_timezones=this.timezones.filter(n=>n.toLowerCase().includes(t.toLowerCase()))}static#e=this.\u0275fac=function(n){return new(n||o)(e.rXU(k.Ws),e.rXU(E),e.rXU(v.nX),e.rXU(v.Ix),e.rXU(J.yb),e.rXU(d.h$))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-event-manage"]],features:[e.Vt3],decls:3,vars:2,consts:()=>{let t;return t=$localize`:@@displayNameLabel␟23ba0a48c17b76008ce17f71f2ab2243ed7d8026␟3213117795366291168: Timezone: `,[["load_state",""],["chipList",""],["auto","matAutocomplete"],t,["class","absolute inset-0 bg-base-100 overflow-auto",4,"ngIf","ngIfElse"],[1,"absolute","inset-0","bg-base-100","overflow-auto"],["icon","","matRipple","",1,"sticky","top-2","right-2","ml-auto",3,"routerLink"],[1,"flex","flex-col","w-[40rem]","max-w-full","mx-auto","px-4",3,"formGroup"],[1,"py-4","text-2xl","font-medium"],[1,"flex","flex-col","space-y-2"],["for","title"],["appearance","outline",1,"w-full"],["matInput","","name","title","formControlName","title","placeholder","e.g. Team Meeting"],["for","host"],["name","host","formControlName","organiser",1,"block","mb-4"],["for","tags"],["appearance","outline",1,"no-subscript"],["aria-label","Event Tags"],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","Add new tags relevant to this event...",3,"matChipInputTokenEnd","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur"],[1,"py-4","flex","items-center","space-x-8"],["formControlName","featured"],[3,"ngModelChange","ngModel","ngModelOptions"],[1,"w-full","h-px","bg-base-200"],[1,"flex","items-center","flex-wrap","sm:space-x-2"],[1,"flex-1","min-w-[256px]","relative"],["for","date"],["name","date","formControlName","date",3,"to"],["name","date","formControlName","date_end",3,"from","to"],["class","flex items-center space-x-2",4,"ngIf"],[1,"flex","flex-col"],["for","display-name"],["appearance","outline"],["matPrefix","",1,"text-2xl"],["matInput","","formControlName","timezone","placeholder","Timezone",3,"matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"disabled",4,"ngIf"],[1,"flex","items-center","space-x-2","pb-2"],["btn","","matRipple","",1,"flex-1",3,"click"],[1,"text-2xl"],[1,"mx-2"],[4,"ngIf"],["formControlName","body"],["formControlName","images"],[1,"flex","justify-end","space-x-2","sticky","bottom-0","w-full","bg-base-100","py-4"],["btn","","matRipple","",1,"inverse","w-32",3,"routerLink"],["btn","","matRipple","",1,"w-32",3,"click"],[3,"removed","selectable","removable"],["matChipRemove",""],[1,"flex","items-center","space-x-2"],[1,"flex-1","w-1/3"],["for","start-time"],["name","start-time",3,"ngModelChange","ngModel","disabled","ngModelOptions","use_24hr"],["for","end-time"],["name","end-time",3,"ngModelChange","ngModel","ngModelOptions","from","use_24hr","extra_info_fn"],[3,"value"],[3,"disabled"],["for","location"],["placeholder","Select Building",3,"ngModelChange","ngModel","ngModelOptions"],[1,"flex","space-x-2"],[1,"flex","flex-col","flex-[2]"],["for","level"],["placeholder","Select Level",3,"ngModelChange","ngModel","ngModelOptions"],[1,"flex","flex-col","flex-[3]"],["placeholder","Select Room",3,"ngModelChange","ngModel","ngModelOptions","disabled"],[1,"absolute","inset-0","bg-base-100","flex","flex-col","items-center","justify-center","space-y-4"],["diameter","48"]]},template:function(n,s){if(1&n&&e.DNE(0,Yt,106,44,"div",4)(1,Xt,4,0,"ng-template",null,0,e.C5r),2&n){const i=e.sdS(2);e.Y8G("ngIf",!s.loading)("ngIfElse",i)}},dependencies:[m.Sq,m.bT,_.qT,_.me,_.BC,_.cb,_.vS,X.rl,X.TL,X.JW,Ft.fg,ie.VO,x.wT,Mt.So,jt.LG,le.$3,le.pN,x.r6,_.j4,_.JD,Tt.G,It.t,Ct.$,wt.d,Rt.$,U.R,B.HW,B.D7,B.Zv,B.jH,v.Wk,m.Jj,$t.D9]})}return o})();var zt=a(3046),At=a(7915);const Bt=[{path:"",component:$,children:[{path:"",component:bt}]},{path:"manage",component:ce},{path:"manage/:id",component:ce},{path:"**",redirectTo:""}];let Jt=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.$C({type:o});static#n=this.\u0275inj=e.G2t({imports:[m.MD,_.YN,G.r,A.lx,At.SG,k.jX,zt.cQ,v.iI.forChild(Bt)]})}return o})()},7915:(oe,M,a)=>{a.d(M,{Qr:()=>R.Q,nx:()=>P.n,WS:()=>R.W,SG:()=>e.S,DD:()=>u.DD,wk:()=>u.wk,Z$:()=>u.Z$,eW:()=>u.eW,u3:()=>u.u3,tj:()=>u.tj,WE:()=>u.WE,vB:()=>u.vB,U:()=>u.U,UN:()=>u.UN,X0:()=>u.X0,DO:()=>u.DO,vq:()=>u.vq,MV:()=>u.MV});var e=a(9478),P=a(8379),R=a(3857),u=(a(7141),a(8026));a(7375),a(5762),a(3367),a(7254),a(8796),a(1781),a(7547),a(7642),a(1593)},8390:(oe,M,a)=>{a.d(M,{g8:()=>u,kR:()=>e.k,Gp:()=>$.Gp,KJ:()=>$.KJ,N8:()=>G.N8,SZ:()=>G.SZ,is:()=>_.is});var e=a(1081),v=(a(3924),a(4621),a(9908));class u{constructor(d={}){this.type=d.type||d.location||"other",this.position=d.position||d.map_id||d.asset_id||{x:d.x/d.map_width||0,y:d.y/d.map_height||0},this.variance=d.variance||0,this.last_seen=d.last_seen||(0,v._)(new Date),this.level=d.level,this.building=d.building,this.at_location=!!d.at_location,this.coordinates_from=d.coordinates_from||"top-left"}}var $=a(3693),_=(a(4129),a(6039)),G=a(2372)}}]);
//# sourceMappingURL=apps_concierge_src_app_events_events_module_ts.js.map