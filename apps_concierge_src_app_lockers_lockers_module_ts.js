"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_lockers_lockers_module_ts"],{79746:(Oe,R,i)=>{i.r(R),i.d(R,{LockersModule:()=>De});var u=i(60316),_=i(34456),d=i(26842),Y=i(53804),j=i(38223),O=i(18823),z=i(40363),p=i(82333),m=i(89204),M=i(90521),I=i(33119),E=i(42175),P=i(71536),J=i(19803),w=i(66e3),Z=i(6109),H=i(71963),k=i(35443),Q=i(22508),W=i(7841),G=i(67450),K=i(27419),q=i(13264),V=i(83866),g=i(57915),x=i(12185),e=(i(83259),i(47990),i(68559)),y=i(12587);let b=(()=>{class s extends p.Tv{nextPage(){this._call_next_page.next(`NEXT_${Date.now()}`)}constructor(t,o){super(),this._org=t,this._dialog=o,this._filters=new M.t({}),this._locker_bookings=[],this._loading=new M.t(!1),this.loading=this._loading.asObservable(),this.filters=this._filters.asObservable(),this._next_page=new I.B7,this._call_next_page=new I.B7,this._all_zones_keys=["All",-1,"-1"],this.setup_paging=(0,E.zV)([this._filters,this._org.initialised]).pipe((0,J.B)(500),(0,w.M)(([n,r])=>{if(!r)return;const a=n.date||Date.now(),c=!n.zones||n.zones.some(h=>this._all_zones_keys.includes(h))?[this._org.building.id]:n.zones;this._next_page.next(()=>(0,g.WE)({period_start:(0,G.A)((0,K.A)(a)),period_end:(0,G.A)((0,q.A)(a)),type:"locker",zones:c.join(","),include_checked_out:!0})),this._call_next_page.next(`RESET_${Date.now()}`)})),this.paged_bookings=(0,E.zV)([this._next_page,this._call_next_page]).pipe((0,Z.F)((n,r)=>n[1]===r[1]),(0,H.n)(([n,r])=>(this._loading.next(!0),n?r.includes("RESET")?n().pipe((0,k.T)(a=>({...a,reset:!0}))):n().pipe((0,k.T)(a=>({...a,reset:!1}))):(0,P.of)({data:[],total:0,next:null,reset:r.includes("RESET")}))),(0,Q.S)((n,{data:r,total:a,next:c,reset:h})=>{const f=r;return this._next_page.next(c),h?{list:f,total:a}:{list:[...n.list,...f],total:a}},{list:[],total:0}),(0,w.M)(n=>this._loading.next(!1)),(0,W.t)(1)),this.has_more_pages=this.paged_bookings.pipe((0,k.T)(n=>n.list.length<n.total)),this.bookings=this.paged_bookings.pipe((0,k.T)(n=>n.list)),this.setup_paging.subscribe()}setFilters(t){t.zones?.includes("All")?t.zones=["All",...this._org.levelsForBuilding(this._org.building).map(o=>o.id)]:t.zones&&this._filters.getValue()?.zones?.includes("All")&&(t.zones=[]),this._filters.next({...this._filters.getValue(),...t})}refresh(){this._loading.next(!0),this.timeout("poll",()=>this.setFilters(this._filters.getValue()))}checkinLocker(t,o=!0){return(0,m.A)(function*(){console.log("Check-in:",t);const n=yield(0,g.Z$)(t.id,o??!0).toPromise().catch(r=>({failed:!0,error:r}));if(n.failed)throw(0,p.UG)(n.error?`Error: ${n.error}`:`Error checking ${o?"in":"out"} locker booking`),n.error;(0,p.VX)(`Checked ${o?"in":"out"} ${t.user_name}.`)})()}approveLocker(t){return(0,m.A)(function*(){if("failed"===(yield(0,g.DD)(t.id).toPromise().catch(n=>"failed")))return(0,p.UG)("Error approving in locker booking");(0,p.VX)(`Approved locker booking for ${t.user_name} on ${(0,V.A)(t.date,"MMM do")}.`),t.approved=!0,t.rejected=!1})()}rejectLocker(t){return(0,m.A)(function*(){if("failed"===(yield(0,g.vB)(t.id).toPromise().catch(n=>"failed")))return(0,p.UG)("Error rejecting in locker booking");(0,p.VX)(`Rejected locker booking for ${t.user_name} on ${(0,V.A)(t.date,"MMM do")}.`),t.approved=!1,t.rejected=!0})()}giveAccess(t){var o=this;return(0,m.A)(function*(){const n=yield(0,g.X0)(new g.Qr({...t,access:!0})).toPromise().catch(r=>"failed");if("failed"===n)return(0,p.UG)("Error giving building access booking host");(0,p.VX)(`Successfully gave building access to ${t.user_name} for locker booking.`),o._locker_bookings=[...o._locker_bookings,n]})()}rejectAllLockers(){var t=this;return(0,m.A)(function*(){const o=t._locker_bookings||[];if(o.length<=0)return(0,p.uA)("No lockers to reject for the selected date");const n=yield(0,p.GE)({title:"Cancel all locker bookings",content:"Are you sure you want to cancel all bookings for the selected date?",icon:{type:"icon",class:"material-icons",content:"delete"}},t._dialog);"done"===n.reason&&(n.loading("Rejecting all lockers for selected date..."),yield Promise.all(o.map(r=>(0,g.vB)(r.id).toPromise())),(0,p.VX)("Successfully rejected all locker bookings for selected date."),n.close())})()}static#e=this.\u0275fac=function(o){return new(o||s)(e.KVO(x.yb),e.KVO(y.bZ))};static#t=this.\u0275prov=e.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var ee=i(74605),$=i(26354),te=i(57871),B=i(33602),A=i(46864),N=i(94584),X=i(12236),T=i(24950),D=i(25175),v=i(85060),F=i(80640),C=i(69434);function ne(s,l){1&s&&(e.j41(0,"mat-option",9),e.EFF(1,"All Levels"),e.k0s())}function oe(s,l){if(1&s&&(e.j41(0,"mat-option",10),e.EFF(1),e.k0s()),2&s){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.display_name||t.name," ")}}function se(s,l){if(1&s){const t=e.RV6();e.j41(0,"button",11),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.manageRestrictions())}),e.j41(1,"app-icon"),e.EFF(2,"lock_open"),e.k0s()()}}let re=(()=>{class s extends p.Tv{constructor(t,o,n,r,a){super(),this._lockers=t,this._org=o,this._route=n,this._router=r,this._dialog=a,this.levels=this._org.active_levels,this.filters=this._lockers.filters,this.manage=!1,this.is_map=!1,this.setDate=c=>this._lockers.setFilters({date:c}),this.setFilters=c=>this._lockers.setFilters(c),this.updateZones=c=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:c.join(",")},queryParamsHandling:"merge"}),this._lockers.setFilters({zones:c})}}ngOnInit(){var t=this;return(0,m.A)(function*(){yield t._org.initialised.pipe((0,te.$)(o=>o)).toPromise(),t.subscription("route.query",t._route.queryParamMap.subscribe(o=>{if(o.has("zone_ids")){const n=o.get("zone_ids").split(",");if(n.length){t.updateZones(n);const r=t._org.levelWithID(n);if(!r)return;t._org.building=t._org.buildings.find(a=>a.id===r.parent_id)}}o.has("date")&&t.setDate(new Date(+o.get("date"))),o.has("approve")?t.approve(o.get("approve")):o.has("reject")&&t.reject(o.get("reject")),t.manage=t._router.url?.includes("manage"),t.is_map=t._router.url?.includes("map")})),t.subscription("router.events",t._router.events.subscribe(()=>{t.manage=t._router.url?.includes("manage"),t.is_map=t._router.url?.includes("map")})),t.subscription("levels",t._org.active_levels.subscribe(function(){var o=(0,m.A)(function*(n){const a=(yield t.filters.pipe((0,B.s)(1)).toPromise())?.zones?.filter(c=>n.find(h=>h.id===c)||"All"===c)||[];!a.length&&n.length&&a.push(n[0].id),t.updateZones(a)});return function(n){return o.apply(this,arguments)}}())),t.manage=t._router.url?.includes("manage"),t.is_map=t._router.url?.includes("map")})()}manageRestrictions(){this._dialog.open(A.F,{data:{type:"locker"}})}approve(t){var o=this;return(0,m.A)(function*(){const n=yield(0,g.DO)(t).toPromise();n&&o._lockers.approveLocker(n)})()}reject(t){var o=this;return(0,m.A)(function*(){const n=yield(0,g.DO)(t).toPromise();n&&o._lockers.rejectLocker(n)})()}static#e=this.\u0275fac=function(o){return new(o||s)(e.rXU(b),e.rXU(x.yb),e.rXU(d.nX),e.rXU(d.Ix),e.rXU(y.bZ))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["lockers-topbar"]],features:[e.Vt3],decls:13,vars:13,consts:[[1,"flex","items-center","bg-base-100","h-20","px-4","border-b","border-base-200","space-x-2"],["appearance","outline"],["placeholder","All Levels",3,"ngModelChange","ngModel"],["value","All",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["btn","","icon","","matRipple","","class","bg-primary mx-2 text-white rounded","matTooltip","Locker Restrictions",3,"click",4,"ngIf"],[1,"flex-1","w-2"],[1,"mr-2",3,"modelChange","model"],[3,"dateChange"],["value","All"],[3,"value"],["btn","","icon","","matRipple","","matTooltip","Locker Restrictions",1,"bg-primary","mx-2","text-white","rounded",3,"click"]],template:function(o,n){if(1&o&&(e.j41(0,"div",0)(1,"mat-form-field",1)(2,"mat-select",2),e.nI1(3,"async"),e.nI1(4,"async"),e.bIt("ngModelChange",function(a){return n.updateZones([a])}),e.DNE(5,ne,2,0,"mat-option",3)(6,oe,2,2,"mat-option",4),e.nI1(7,"async"),e.k0s()(),e.DNE(8,se,3,0,"button",5),e.nrm(9,"div",6),e.j41(10,"searchbar",7),e.nI1(11,"async"),e.bIt("modelChange",function(a){return n.setFilters({search:a})}),e.k0s(),e.j41(12,"date-options",8),e.bIt("dateChange",function(a){return n.setDate(a)}),e.k0s()()),2&o){let r;e.R7$(2),e.Y8G("ngModel",e.bMT(3,5,n.filters).zones?e.bMT(4,7,n.filters).zones[0]:"All"),e.R7$(3),e.Y8G("ngIf",!n.is_map),e.R7$(),e.Y8G("ngForOf",e.bMT(7,9,n.levels)),e.R7$(2),e.Y8G("ngIf",n.manage),e.R7$(2),e.Y8G("model",null==(r=e.bMT(11,11,n.filters))?null:r.search)}},dependencies:[u.Sq,u.bT,_.BC,_.vS,N.o,X.x,T.rl,D.VO,v.wT,F.oV,v.r6,C.R,u.Jj],styles:["mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em}\n\n/*# sourceMappingURL=locker-topbar.component.ts-angular-inline--130.css.map*/"]})}return s})();const ie=["app-lockers",""],ae=()=>["/book","lockers","events"],le=()=>["/book","lockers","map"],ce=()=>["/book","lockers","manage"];function pe(s,l){1&s&&e.nrm(0,"mat-progress-bar",7)}let me=(()=>{class s extends p.Tv{constructor(t,o){super(),this._state=t,this._router=o,this.loading=this._state.loading}ngOnInit(){this._state.refresh(),this.subscription("router.events",this._router.events.subscribe(o=>{if(o instanceof d.wF){const n=this._router.url?.split("/")||[""];this.path=n[t.length-1].split("?")[0]}}));const t=this._router.url?.split("/")||[""];this.path=t[t.length-1].split("?")[0]}ngOnDestroy(){super.ngOnDestroy()}static#e=this.\u0275fac=function(o){return new(o||s)(e.rXU(b),e.rXU(d.Ix))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["","app-lockers",""]],features:[e.Vt3],attrs:ie,decls:15,vars:12,consts:[[1,"flex-1","relative","w-1/2","flex","flex-col","bg-base-200","overflow-hidden"],[1,"w-full"],[1,"dark"],["mat-tab-nav-bar",""],["mat-tab-link","","queryParamsHandling","merge",3,"routerLink","active"],[1,"flex-1","h-1/2","w-full","relative","overflow-auto"],["class","w-full","mode","indeterminate",4,"ngIf"],["mode","indeterminate",1,"w-full"]],template:function(o,n){1&o&&(e.nrm(0,"sidebar"),e.j41(1,"main",0),e.nrm(2,"lockers-topbar",1),e.j41(3,"div",2)(4,"nav",3)(5,"a",4),e.EFF(6," Bookings "),e.k0s(),e.j41(7,"a",4),e.EFF(8," Map View "),e.k0s(),e.j41(9,"a",4),e.EFF(10," Manage Lockers "),e.k0s()()(),e.j41(11,"div",5),e.nrm(12,"router-outlet"),e.k0s(),e.DNE(13,pe,1,0,"mat-progress-bar",6),e.nI1(14,"async"),e.k0s()),2&o&&(e.R7$(5),e.Y8G("routerLink",e.lJ4(9,ae))("active","events"===n.path),e.R7$(2),e.Y8G("routerLink",e.lJ4(10,le))("active","map"===n.path),e.R7$(2),e.Y8G("routerLink",e.lJ4(11,ce))("active","manage"===n.path),e.R7$(4),e.Y8G("ngIf",e.bMT(14,7,n.loading)))},dependencies:[u.bT,j.Bu,j.Ql,ee.k,$.HM,d.n3,d.Wk,re,u.Jj],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%}\n\n/*# sourceMappingURL=lockers.component.ts-angular-inline--128.css.map*/"]})}return s})();var L=i(31034),ue=i(12993);const de=()=>["date","period","user_name","group","asset_name","approver_name","status","checked_in"],ge=()=>["Date","Period","Person","Group","Locker","Approver","Status","Checked In"],he=()=>["4r","10r","flex","10r","10r","10r","8r","7r"],_e=(s,l,t,o,n,r,a)=>({user_name:s,asset_name:l,date:t,period:o,status:n,checked_in:r,access:a});function fe(s,l){if(1&s&&(e.j41(0,"div",15)(1,"div",16),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.j41(4,"div",17),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&s){const t=l.data;e.R7$(2),e.JRh(e.i5U(3,2,t,"MMM")),e.R7$(3),e.JRh(e.i5U(6,5,t,"dd"))}}function ke(s,l){if(1&s&&(e.qex(0),e.EFF(1),e.nI1(2,"date"),e.nI1(3,"date"),e.bVm()),2&s){const t=e.XpG(2).row,o=e.XpG();e.R7$(),e.Lme(" ",e.i5U(2,2,t.date,o.time_format)," \u2013 ",e.i5U(3,5,t.end,o.time_format)," ")}}function ve(s,l){1&s&&(e.qex(0),e.EFF(1,"All Day"),e.bVm())}function be(s,l){if(1&s&&(e.qex(0),e.DNE(1,ke,4,8,"ng-container",18)(2,ve,2,0,"ng-container",18),e.bVm()),2&s){const t=e.XpG().row;e.R7$(),e.Y8G("ngIf",!t.all_day),e.R7$(),e.Y8G("ngIf",t.all_day)}}function je(s,l){1&s&&(e.qex(0),e.j41(1,"div",19),e.EFF(2," Expired "),e.k0s(),e.bVm())}function xe(s,l){if(1&s&&e.DNE(0,be,3,2,"ng-container",18)(1,je,3,0,"ng-container",18),2&s){const t=l.row;e.Y8G("ngIf","declined"!==t.status&&!t.deleted),e.R7$(),e.Y8G("ngIf","declined"===t.status||t.deleted)}}function ye(s,l){if(1&s&&e.EFF(0),2&s){const t=l.row;e.SpI(" ",t.asset_name||t.asset_id," ")}}function Te(s,l){if(1&s&&(e.j41(0,"div",23),e.EFF(1),e.k0s()),2&s){const t=e.XpG().row;e.R7$(),e.SpI(" ",t.user_email," ")}}function Fe(s,l){if(1&s&&(e.j41(0,"div",20)(1,"div",21),e.EFF(2),e.k0s(),e.DNE(3,Te,2,1,"div",22),e.k0s()),2&s){const t=l.row;e.R7$(2),e.SpI(" ",t.user_name||t.user_email||t.booked_by_name||t.booked_by_email," "),e.R7$(),e.Y8G("ngIf",t.user_name)}}function Ce(s,l){if(1&s){const t=e.RV6();e.j41(0,"button",24)(1,"div",25),e.EFF(2),e.k0s(),e.j41(3,"app-icon",17),e.EFF(4,"arrow_drop_down"),e.k0s()(),e.j41(5,"mat-menu",null,7)(7,"button",14),e.bIt("click",function(){const n=e.eBV(t).row,r=e.XpG();return e.Njj(r.approve(n))}),e.j41(8,"div",26)(9,"app-icon",27),e.EFF(10,"event_available"),e.k0s(),e.j41(11,"div"),e.EFF(12,"Approve Locker"),e.k0s()()(),e.j41(13,"button",14),e.bIt("click",function(){const n=e.eBV(t).row,r=e.XpG();return e.Njj(r.reject(n))}),e.j41(14,"div",26)(15,"app-icon",27),e.EFF(16,"event_busy"),e.k0s(),e.j41(17,"div"),e.EFF(18,"Decline Locker"),e.k0s()()()()}if(2&s){const t=l.row,o=e.sdS(6);e.AVh("bg-success",t.approved)("text-white",t.approved||t.rejected)("bg-warning",!t.approved&&!t.rejected)("text-black",!t.approved&&!t.rejected)("bg-error",t.rejected),e.Y8G("matMenuTriggerFor",o),e.R7$(2),e.SpI(" ",t.approved?"Approved":t.rejected?"Declined":"Tentative"," ")}}function Le(s,l){if(1&s){const t=e.RV6();e.j41(0,"button",28)(1,"div",25),e.EFF(2),e.k0s(),e.j41(3,"app-icon",17),e.EFF(4,"arrow_drop_down"),e.k0s()(),e.j41(5,"mat-menu",null,8)(7,"button",14),e.bIt("click",function(){const n=e.eBV(t).row,r=e.XpG();return e.Njj(r.checkin(n,!0))}),e.j41(8,"div",26)(9,"app-icon",27),e.EFF(10,"check"),e.k0s(),e.j41(11,"div"),e.EFF(12,"Check-in"),e.k0s()()(),e.j41(13,"button",14),e.bIt("click",function(){const n=e.eBV(t).row,r=e.XpG();return e.Njj(r.checkin(n,!1))}),e.j41(14,"div",26)(15,"app-icon",27),e.EFF(16,"cancel"),e.k0s(),e.j41(17,"div"),e.EFF(18,"Check-out"),e.k0s()()()()}if(2&s){const t=l.data,o=l.row,n=e.sdS(6);e.AVh("bg-neutral-600",!t)("bg-success",t)("opacity-30","ended"===o.status),e.Y8G("matMenuTriggerFor",n)("disabled","ended"===o.status)("matTooltip","ended"===o.status?"Locker booking has ended":"Check-in or check-out locker"),e.R7$(2),e.JRh(t?"Yes":"No")}}function Re(s,l){if(1&s){const t=e.RV6();e.j41(0,"button",29),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadMore())}),e.EFF(1," Load More "),e.k0s()}}let S=(()=>{class s{get time_format(){return this._settings.time_format}constructor(t,o){var n=this;this._state=t,this._settings=o,this.filters=this._state.filters,this.has_more_pages=this._state.has_more_pages,this.bookings=this._state.bookings.pipe((0,k.T)(r=>r.map(a=>({...a,end:a.date+60*a.duration*1e3})))),this.rejectAll=()=>this._state.rejectAllLockers(),this.loadMore=()=>this._state.nextPage(),this.checkin=(r,a)=>this.runMethod("checkin",(0,m.A)(function*(){yield n._state.checkinLocker(r,a),r.checked_in=a??!0})),this.approve=r=>this.runMethod("approve",(0,m.A)(function*(){return n._state.approveLocker(r)})),this.reject=r=>this.runMethod("reject",(0,m.A)(function*(){return n._state.rejectLocker(r)}))}runMethod(t,o){var n=this;return(0,m.A)(function*(){n.loading=t,yield o().catch(r=>null),n.loading=""})()}static#e=this.\u0275fac=function(o){return new(o||s)(e.rXU(b),e.rXU(p.h$))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["locker-bookings"]],decls:26,vars:26,consts:[["date_template",""],["period_template",""],["locker_template",""],["user_template",""],["status_template",""],["option_template",""],["menu","matMenu"],["statusMenu","matMenu"],["checkinMenu","matMenu"],[1,"w-full","h-4"],[1,"overflow-auto","h-full","w-full","px-4","pb-4"],[1,"min-w-[76rem]","block",3,"dataSource","filter","columns","display_column","column_size","template","empty"],["btn","","matRipple","","class","absolute bottom-2 left-2 w-32 mx-auto my-4",3,"click",4,"ngIf"],["icon","","matRipple","",1,"absolute","bottom-2","right-2","bg-base-100","shadow",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"flex","flex-col","items-center","justify-center","w-full"],[1,"opacity-60"],[1,"text-xl"],[4,"ngIf"],[1,"text-xs","py-1","px-2","bg-error","rounded-2xl","text-white"],[1,"flex","flex-col","justify-center"],[1,"select-all"],["class","text-xs opacity-30 select-all",4,"ngIf"],[1,"text-xs","opacity-30","select-all"],["matRipple","",1,"rounded-3xl","px-2","py-1","flex","items-center","space-x-2","capitalize",3,"matMenuTriggerFor"],[1,"ml-2"],[1,"flex","items-center","space-x-2"],[1,"text-2xl"],["matRipple","",1,"rounded-3xl","px-2","py-1","text-white","flex","items-center","space-x-2",3,"matMenuTriggerFor","disabled","matTooltip"],["btn","","matRipple","",1,"absolute","bottom-2","left-2","w-32","mx-auto","my-4",3,"click"]],template:function(o,n){if(1&o){const r=e.RV6();e.nrm(0,"div",9),e.j41(1,"div",10),e.nrm(2,"custom-table",11),e.nI1(3,"async"),e.nI1(4,"async"),e.DNE(5,fe,7,8,"ng-template",null,0,e.C5r)(7,xe,2,2,"ng-template",null,1,e.C5r)(9,ye,1,1,"ng-template",null,2,e.C5r)(11,Fe,4,2,"ng-template",null,3,e.C5r)(13,Ce,19,12,"ng-template",null,4,e.C5r)(15,Le,19,10,"ng-template",null,5,e.C5r),e.k0s(),e.DNE(17,Re,2,0,"button",12),e.nI1(18,"async"),e.j41(19,"button",13)(20,"app-icon"),e.EFF(21,"more_vert"),e.k0s()(),e.j41(22,"mat-menu",null,6)(24,"button",14),e.bIt("click",function(){return e.eBV(r),e.Njj(n.rejectAll())}),e.EFF(25,"Reject All"),e.k0s()()}if(2&o){let r,a;const c=e.sdS(6),h=e.sdS(8),f=e.sdS(10),Se=e.sdS(12),Ue=e.sdS(14),U=e.sdS(16),Ye=e.sdS(23);e.R7$(2),e.Y8G("dataSource",n.bookings)("filter",null==(r=e.bMT(3,9,n.filters))?null:r.search)("columns",e.lJ4(15,de))("display_column",e.lJ4(16,ge))("column_size",e.lJ4(17,he))("template",e.sGs(18,_e,Se,f,c,h,Ue,U,U))("empty",null!=(a=e.bMT(4,11,n.filters))&&a.search?"No matching locker bookings":"There are no locker booking for the currently selected date."),e.R7$(15),e.Y8G("ngIf",!n.loading&&e.bMT(18,13,n.has_more_pages)),e.R7$(2),e.Y8G("matMenuTriggerFor",Ye)}},dependencies:[u.bT,L.kk,L.fb,L.Cp,F.oV,v.r6,C.R,ue.r,u.Jj,u.vh],styles:["[_nghost-%COMP%]{position:relative;display:flex;flex-direction:column;height:100%;width:100%}\n\n/*# sourceMappingURL=locker-bookings.component.ts-angular-inline--129.css.map*/"]})}return s})();var Me=i(97024),Ie=i(87984),Ee=i(63046),we=i(45189),Ge=i(96843);const Ve=["app-new-lockers",""];function $e(s,l){if(1&s&&(e.j41(0,"mat-option",15),e.EFF(1),e.k0s()),2&s){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.display_name||t.name," ")}}function Be(s,l){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"date-options",16),e.bIt("dateChange",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.setDate(n))}),e.k0s(),e.j41(2,"button",17),e.nI1(3,"async"),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.refresh())}),e.j41(4,"app-icon"),e.EFF(5,"refresh"),e.k0s()(),e.bVm()}if(2&s){const t=e.XpG();e.R7$(2),e.Y8G("disabled",e.bMT(3,1,t.loading))}}function Ae(s,l){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"button",18),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.manageRestrictions())}),e.j41(2,"app-icon"),e.EFF(3,"lock_open"),e.k0s()(),e.bVm()}}function Ne(s,l){1&s&&e.nrm(0,"mat-progress-bar",19)}const Xe=[{path:"new",component:(()=>{class s extends p.Tv{constructor(t,o,n,r,a){super(),this._state=t,this._router=o,this._route=n,this._dialog=r,this._org=a,this.loading=this._state.loading,this.filters=this._state.filters,this.levels=this._org.active_levels,this.setDate=c=>this._state.setFilters({date:c}),this.setFilters=c=>this._state.setFilters(c),this.refresh=()=>this._state.refresh(),this.updateZones=c=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:c.join(",")},queryParamsHandling:"merge"}),this._state.setFilters({zones:c})}}ngOnInit(){var t=this;this._state.refresh(),this.subscription("router.events",this._router.events.subscribe(n=>{if(n instanceof d.wF){const r=this._router.url?.split("/")||[""];this.path=r[o.length-1].split("?")[0]}})),this.subscription("levels",this._org.active_levels.subscribe(function(){var n=(0,m.A)(function*(r){const c=(yield t.filters.pipe((0,B.s)(1)).toPromise())?.zones?.filter(h=>r.find(f=>f.id===h)||"All"===h)||[];!c.length&&r.length&&c.push(r[0].id),t.updateZones(c)});return function(r){return n.apply(this,arguments)}}()));const o=this._router.url?.split("/")||[""];this.path=o[o.length-1].split("?")[0]}ngOnDestroy(){super.ngOnDestroy()}manageRestrictions(){this._dialog.open(A.F,{data:{type:"locker"}})}static#e=this.\u0275fac=function(o){return new(o||s)(e.rXU(b),e.rXU(d.Ix),e.rXU(d.nX),e.rXU(y.bZ),e.rXU(x.yb))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["","app-new-lockers",""]],features:[e.Vt3],attrs:Ve,decls:24,vars:14,consts:[[1,"print:hidden"],[1,"flex","flex-1","h-px","print:hidden"],[1,"flex","flex-col","flex-1","w-1/2","h-full"],[1,"flex","items-center","w-full","py-4","px-8","space-x-2"],[1,"text-2xl","font-medium"],[1,"flex-1","w-px"],[1,"mr-2",3,"modelChange","model"],[1,"w-full","flex","items-center","px-8","space-x-2"],["appearance","outline",1,"h-[3.5rem]"],["multiple","","placeholder","All Levels",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"border-l","h-full","!ml-8","!mr-4"],[4,"ngIf"],[1,"flex-1","h-1/2","w-full","relative","overflow-auto","px-4"],["class","w-full","mode","indeterminate",4,"ngIf"],[3,"value"],[3,"dateChange"],["btn","","icon","","matRipple","","matTooltip","Refresh List",1,"ml-2","rounded","border","border-base-200",3,"click","disabled"],["btn","","icon","","matRipple","","matTooltip","Locker Restrictions",1,"bg-primary","text-white","rounded",3,"click"],["mode","indeterminate",1,"w-full"]],template:function(o,n){if(1&o&&(e.nrm(0,"app-topbar",0),e.j41(1,"div",1),e.nrm(2,"app-sidebar"),e.j41(3,"main",2)(4,"div",3)(5,"h2",4),e.EFF(6,"Locker Bookings"),e.k0s(),e.nrm(7,"div",5),e.j41(8,"searchbar",6),e.nI1(9,"async"),e.bIt("modelChange",function(a){return n.setFilters({search:a})}),e.k0s()(),e.j41(10,"div",7)(11,"mat-form-field",8)(12,"mat-select",9),e.nI1(13,"async"),e.bIt("ngModelChange",function(a){return n.updateZones(a)}),e.DNE(14,$e,2,2,"mat-option",10),e.nI1(15,"async"),e.k0s()(),e.nrm(16,"div",11)(17,"div",5),e.DNE(18,Be,6,3,"ng-container",12)(19,Ae,4,0,"ng-container",12),e.k0s(),e.j41(20,"div",13),e.nrm(21,"router-outlet"),e.k0s(),e.DNE(22,Ne,1,0,"mat-progress-bar",14),e.nI1(23,"async"),e.k0s()()),2&o){let r,a;e.R7$(8),e.Y8G("model",null==(r=e.bMT(9,6,n.filters))?null:r.search),e.R7$(4),e.Y8G("ngModel",null==(a=e.bMT(13,8,n.filters))?null:a.zones),e.R7$(2),e.Y8G("ngForOf",e.bMT(15,10,n.levels)),e.R7$(4),e.Y8G("ngIf","events"===n.path),e.R7$(),e.Y8G("ngIf","manage"===n.path),e.R7$(3),e.Y8G("ngIf",e.bMT(23,12,n.loading)&&"events"===n.path)}},dependencies:[u.Sq,u.bT,_.BC,_.vS,N.o,X.x,we.S,Ge.c,T.rl,D.VO,v.wT,F.oV,$.HM,v.r6,C.R,d.n3,u.Jj],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}\n\n/*# sourceMappingURL=new-lockers.component.ts-angular-inline--131.css.map*/"]})}return s})(),children:[{path:"events",component:S},{path:"**",redirectTo:"events"}]},{path:"",component:me,children:[{path:"events",component:S},{path:"**",redirectTo:"events"}]}];let De=(()=>{class s{static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275mod=e.$C({type:s});static#n=this.\u0275inj=e.G2t({imports:[u.MD,_.YN,j.RI,_.X1,z.r,O.Rp,g.SG,Ee.cQ,Y.Wk,T.RG,Me.g7,Ie.fS,d.iI.forChild(Xe)]})}return s})()}}]);
//# sourceMappingURL=apps_concierge_src_app_lockers_lockers_module_ts.js.map