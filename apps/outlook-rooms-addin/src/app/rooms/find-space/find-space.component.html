<div class="w-full bg-white">
    <div class="flex flex-col mx-6">
        <div class="flex flex-row border-b mr-auto mt-3 w-full">
            <button (click)="this.closeModal()">
                <mat-icon class="text-3xl text-gray-700">close</mat-icon>
            </button>

            <div class="flex w-full justify-center">
                <span class="flex items-center text-xl font-bold">
                    Find Space</span
                >
            </div>
        </div>

        <div class="flex flex-row">
            <button mat-flat-button class="block mt-3 bg-gray-200 w-[350px]">
                Filter
            </button>
            <button
                mat-flat-button
                class="block mt-3 bg-gray-200 w-[100px] ml-3"
            >
                Map
            </button>
        </div>

        <section class="flex flex-row">
            <mat-chip-list class="mt-3">
                <mat-chip class="text-gray-700">
                    {{ this.data.controls.date.value | date: 'dd MMMM yyyy' }}
                </mat-chip>

                <div *ngIf="this.data.controls.attendees.value.length > 0">
                    <mat-chip class="text-gray-700">
                        {{ this.data.controls.attendees.value.length }}
                        People
                    </mat-chip>
                </div>

                <mat-chip class="text-gray-700">
                    {{ this.startTime }} - {{ this.endTime }}
                </mat-chip>
            </mat-chip-list>
        </section>

        <section class="flex flex-row mt-6 border-t">
            <div class="flex flex-col">
                <span class="text-xl font-bold"> Results</span>
                <span class="text-sm text-gray-500">
                    {{ form.get('resources')?.value?.length }} results
                    found</span
                >
            </div>
        </section>

        <div class="flex-1 w-full bg-gray-100 overflow-auto">
            <ng-container *ngIf="!(loading | async); else load_state">
                <ng-container
                    *ngIf="(spaces | async)?.length > 0; else empty_state"
                >
                    <find-space-item
                        *ngFor="let space of spaces | async"
                        class="w-[640px] max-w-[calc(100%-2rem)] mx-auto"
                        [space]="space"
                        [multiple]="multiple"
                        [(book)]="book_space[space.id]"
                        (bookChange)="handleBookEvent(space, $event)"
                    ></find-space-item>
                    <p class="p-4 text-center opacity-60">
                        End of available spaces list
                    </p>
                </ng-container>
            </ng-container>
        </div>

        <ng-template #load_state>
            <div
                class="h-full w-full flex flex-col items-center justify-center space-y-2"
            >
                <mat-spinner [diameter]="32"></mat-spinner>
                <p>Retrieving available spaces...</p>
            </div>
        </ng-template>
        <ng-template #empty_state>
            <div
                class="h-full w-full flex flex-col items-center justify-center space-y-2 p-8 text-center"
            >
                <p>
                    No available spaces for selected time, capacity or level(s)
                </p>
            </div>
        </ng-template>
    </div>
</div>
