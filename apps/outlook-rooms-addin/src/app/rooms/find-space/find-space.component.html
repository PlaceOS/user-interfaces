<div class="w-full h-full flex flex-1 flex-col z-0 bg-gray-50 overflow-hidden">
    <section class="flex flex-col border border-gray-300 py-5">
        <div class="w-[calc(100%-4rem)] max-w-[768px] mx-auto">
            <div class="flex flex-row items-center">
                <button (click)="this.closeModal()">
                    <mat-icon class="text-3xl text-gray-700">close</mat-icon>
                </button>

                <span class="flex items-center text-xl font-bold ml-6">
                    Find Space</span
                >
            </div>

            <div class="flex flex-row mt-3">
                <button
                    mat-flat-button
                    (click)="openFilter()"
                    class="mt-3 bg-gray-300 w-7/12"
                >
                    Filter
                </button>
                <button mat-flat-button class="mt-3 bg-gray-300 w-4/12 ml-auto">
                    Map
                </button>
            </div>

            <section class="flex flex-row">
                <mat-chip-list class="mt-3">
                    <mat-chip class="text-gray-700">
                        {{
                            this.form?.controls?.date?.value
                                | date: 'dd MMMM yyyy'
                        }}
                    </mat-chip>

                    <div *ngIf="this.form?.controls.attendees.value.length > 0">
                        <mat-chip class="text-gray-700">
                            {{ this.form?.controls?.attendees?.value.length }}
                            People
                        </mat-chip>
                    </div>

                    <mat-chip class="text-gray-700">
                        <span>{{ this.startTime$ | async }}</span>
                        -
                        <span> {{ this.endTime$ | async }}</span>
                    </mat-chip>
                </mat-chip-list>
            </section>

            <section class="flex flex-row my-6 border-t">
                <div class="flex flex-col">
                    <span class="text-xl font-bold mt-3"> Results</span>
                    <span class="text-sm text-gray-500 mt-3">
                        {{ (spaces$ | async)?.length }} results found</span
                    >
                </div>
            </section>

            <div class="flex-1 w-full bg-gray-100 overflow-auto">
                <ng-container *ngIf="!(loading | async); else load_state">
                    <ng-container
                        *ngIf="(spaces$ | async)?.length > 0; else empty_state"
                    >
                        <mat-button-toggle-group
                            name="selectSpace"
                            #group="matButtonToggleGroup"
                            aria-label="Space selection"
                            class="flex flex-col"
                        >
                            <find-space-item
                                *ngFor="let space of spaces$ | async"
                                [space]="space"
                                [multiple]="multiple"
                                [(book)]="book_space[space.id]"
                                (bookChange)="handleBookEvent(space, $event)"
                            >
                            </find-space-item>
                        </mat-button-toggle-group>
                        <p class="p-4 text-center opacity-60">
                            End of available spaces list
                        </p>
                    </ng-container>
                </ng-container>

                <ng-template #load_state>
                    <div
                        class="h-full w-full flex flex-col items-center justify-center space-y-2"
                    >
                        <mat-spinner [diameter]="32"></mat-spinner>
                        <p>Retrieving available spaces...</p>
                    </div>
                </ng-template>
                <ng-template #empty_state>
                    <div
                        class="h-full w-full flex flex-col items-center justify-center space-y-2 p-8 text-center"
                    >
                        <p>
                            No available spaces for selected time, capacity or
                            level(s)
                        </p>
                    </div>
                </ng-template>
            </div>
        </div>
        <section
            class="flex flex-col py-3 border-t border-gray-300 top-box-shadow items-center justify-center"
        >
            <div *ngIf="this.showConfirm$ | async">
                <button
                    mat-button
                    type="submit"
                    (click)="confirm()"
                    class="bg-secondary border-secondary w-[460px] my-3"
                >
                    <span class="">Confirm</span>
                </button>
            </div>
        </section>
    </section>
</div>
