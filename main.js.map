{"version":3,"file":"main.js","mappings":"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E,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAIlC,GAAUqB,KAAK,CAAC,IAAI,EAAE,EAAE,GAAG,EAAE,GAAG,GAAG,IAAI,EAAE,IAAI,GAAG,IAAI,GAAG,IAAI,IAAI,GAAG,EAAE,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,EAAE,IAAI,GAAG,IAAI,IAAI,IAAI,EAAE,IAAI,IAAI,GAAG,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,EAAE,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,GAAG,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,KAAKrB,GAAUoB,KAAK,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,IAAI,IAAI,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","names":["AsyncHandler","constructor","this","_timers","_intervals","_subscriptions","_initialised","BehaviorSubject","initialised","asObservable","is_initialised","getValue","ngOnDestroy","destroy","key","clearTimeout","clearInterval","unsub","timeout","name","fn","delay","Function","Error","setTimeout","interval","setInterval","subscription","hasSubscription","Subscription","unsubscribe","unsubWith","contains","subs","Object","keys","filter","k","includes","static","__ngFactoryType__","core","jDH","factory","fac","providedIn","SafePipe","sanitizer","transform","value","type","bypassSecurityTrustResourceUrl","bypassSecurityTrustUrl","bypassSecurityTrustScript","bypassSecurityTrustStyle","bypassSecurityTrustHtml","i0","i1","EJ8","pure","ctx_r0","icon","class","className","content","src","IconComponent","VBU","selectors","inputs","ngContentSelectors","_c0","decls","vars","consts","template","rf","ctx","IconComponent_i_1_Template","IconComponent_img_2_Template","_r2","onConfirm","cancel_text","confirm_text","loading","CONFIRM_METADATA","height","width","maxHeight","maxWidth","ConfirmModalComponent","_dialog_ref","_data","super","event","EventEmitter","title","disableClose","enableClose","ngOnInit","close_delay","close","emit","reason","MAT_DIALOG_DATA","outputs","features","ConfirmModalComponent_main_3_Template","ConfirmModalComponent_footer_4_Template","ConfirmModalComponent_ng_template_5_Template","load_state_r3","_app_name","setAppName","log","msg","args","stream","force","app_name","window","jest","debug","colors","console","getItemWithKeys","map","length","slice","unique","array","el","id","exists","push","randomInt","ceil","floor","Math","random","padString","str","randomString","chars","i","openConfirmModal","_x","_x2","_openConfirmModal","apply","arguments","_asyncToGenerator","data","dialog","ref","open","Promise","race","componentInstance","pipe","first","_","toPromise","afterClosed","s","flatten","an_array","stack","res","next","pop","Array","isArray","reverse","timePeriodsIntersect","s1","e1","s2","e2","rand","sfc32","a","b","c","d","t","xmur3","h","imul","charCodeAt","seed","predictableRandomInt","getInvalidFields","form","prefix","invalid","controls","FormGroup","valid","removeEmptyFields","obj","capitalizeFirstLetter","word","toUpperCase","substring","degreesToRadians","degrees","PI","GoogleAnalyticsService","enabled","timers","init","tracking_id","gtag","dataLayer","w","l","Date","getTime","f","getElementsByTagName","j","createElement","async","parentNode","insertBefore","document","service","load","page","setUser","send","category","action","label","screen","appName","screenName","route","origin","last_route","url","location","timing","variable","INVALID_STANDALONE_KEYS","HotkeysService","keydown_states","keydown_observers","combo_end","registered_combos","counter","addEventListener","code","mapKey","toLowerCase","last_down","indexOf","preventDefault","listen","combo","combination","split","validCombination","last_key","updateCombinationEndList","subscribe","count","presses","state","reduce","v","replace","non_meta","DEFAULT_SETTINGS","composer","domain","protocol","port","use_domain","local_login","dont_load_metadata","app","description","short_name","logo","logo_dark","general","prevent_space_init","VERSION","dirty","raw","hash","distance","tag","semver","suffix","semverString","version","time","USER_DOMAIN","generateUserForm","user","fields","FormControl","Validators","required","email","organisation","phone","pattern","assistance_required","visit_expected","User","first_name","last_name","notes","photo","username","organizer","checked_in","resource","response_status","groups","department","sys_admin","support","extension_data","is_external","endsWith","GuestUser","preferred_beverage","accepted_terms_conditions","attachments","status","booking","approved","rejected","event_metadata","StaffUser","location_time","now","work_preference","datetime","date","day","getDay","date_string","format","work_overrides","blocks","block","end","end_time","start_time","getHours","getMinutes","pref","work_preferences","day_of_week","location_name","location_name_time","in_hours","in_hours_time","outsideHours","location_icon","card_number","staff_id","is_logged_in","EMPTY_USER","_current_user","_change","current_user","reloadUserData","showUser","currentUser","combineLatest","retry","SettingsService","overrides","_overrides","_applyCssVariables","_observables","_subjects","post","_title","getTitle","setTitle","get","_analytics","_user_settings","_pending_settings","built","isSameDay","_this","pathname","trim","join","application","settings","_applyUserSettings","showMetadata","details","_initDarkMode","_applyTheme","_setFontSize","time_format","override_settings","override","saveUserSetting","setTheme","_savePendingChanges","overrideCssVariable","important","element","getElementById","head","appendChild","innerText","theme","variable_map","css_string","_this2","updateMetadata","class_list","body","classList","item","startsWith","remove","add","i2","Organisation","raw_data","tags","capacity","bindings","_settings","setting","_service","_disable_logging","notify","message","on_action","config","warn","snackbar_ref","panelClass","duration","dismiss","onAction","notifySuccess","notifyError","error","notifyWarn","notifyInfo","BuildingLevel","parent_id","display_name","map_id","locations","images","parts","number","Building","disc_info","discovery_info","zone_id","zone","extras","extra_id","extra_name","loan_items","levels","building_id","_roles","roles","_lockers","lockers","locker_structure","_systems","systems","_phone_numbers","phone_numbers","room_configurations","attributes","searchables","neighbourhoods","lvl","lvl_features","feature","level_id","timezone","catering_hours","start","visitor_space","holding_bay","address","orientations","booking_details","catering_restricted_from","currency","role","role_names","featuresForLevel","Region","OrganisationService","region_settings","_region_settings","building_settings","_building_settings","regionSettings","region","_active_region","buildingSettings","bld_id","building","buildings","_organisation","regions","_regions","setRegion","loadRegionData","_setBuildingFromTimezone","buildingsForRegion","_updateSettingOverrides","_buildings","_active_building","bld","loadBuildingData","then","find","Intl","DateTimeFormat","resolvedOptions","timeZone","currency_code","binding","_levels","_router","_loaded_data","app_key","region_list","building_list","level_list","active_region","active_building","active_buildings","active_levels","levelsForBuilding","shareReplay","onlineState","debounceTime","levelWithID","id_list","levelsForRegion","bld_list","addZone","sort","localeCompare","removeZone","tries","catch","err","min","orgs","_this3","loadOrganisation","loadRegions","blds","loadBuildings","loadSettings","loadLevels","_this4","org_list","queryZones","auth","authority","org","list","isMock","org_zone","of","navigate","_this5","limit","catchError","_this6","load_metadata","settings_request","PlaceMetadata","bindings_request","all","_this7","booking_rules","driver_settings","querySettings","yaml","encryption_level","EncryptionLevel","None","settings_string","_this8","authority_id","available_room_configs","m","prev","curr","concat","_this9","app_settings","global_settings","_initialiseActiveBuilding","saveBuilding","region_id","sessionStorage","setItem","resolve","getItem","navigator","geolocation","getCurrentPosition","position","latitude","longitude","coords","closest_bld","c_lat","c_long","b_lat","b_long","sqrt","pow","_setDefaultBuilding","_this10","_setRegionFromTimezone","_this11","tz_start","MapService","GoogleMaps","Mapbox","MapsPeopleService","map_keys","use_service","map_service","_map_service","map_token","_map_token","is_ready","_ready","_org","_injected","_custom_zone","available$","tap","_injectMapsApiKeys","mapsindoors","setCustomZone","google","mapbox","script","undefined","styles","rel","href","ANIMATION_SHOW_ENTER_LEAVE","trigger","transition","style","opacity","animate","ANIMATION_SHOW_CONTRACT_EXPAND","IGNORE_VALUES","toQueryString","encodeURIComponent","_timer","_new_version","hasNewVersion","setupCache","cache","isEnabled","activateUpdate","_activateUpdate","checkForUpdate","reload","_setupPlace","host","hostname","mock","localStorage","auth_type","scope","auth_uri","token_uri","redirect_uri","handle_login","use_iframe","setup","abbr","offset","isdst","text","utc","uploadFile","file","pub","permissions","Observable","observer","fileReader","FileReader","e","blob","blobUtil","target","result","upload","uploadFiles","file_name","public","upload_details","progress","link","formatted_size","humanReadableByteCount","size","takeWhile","access_url","complete","readAsArrayBuffer","hookMethod","rootObject","functionToHook","hookingFunction","previousFunction","call","DEVICE_ID","RemoteLoggingService","setMetadata","metadata","_disable_handling","_system_id","_events","Subject","_event_history","_metadata","_logging_bindings","switchMap","_bindTo","_ref","getModule","execute","history","_patchConsoleMethods","setSystem","types","_handleEvent","event_type","device_id","subtype","timestamp","mod","module","bind","LOCAL_TIMEZONE","DURATION_MAP","month","months","week","weeks","days","hour","hours","minute","minutes","DEFAULT_RULES","auto_approve","hidden","stringToMinutes","addToDate","addMinutes","filterResourcesFromRules","resources","ruleset_list","rulesForResource","ruleset","zones","checkRulesMatch","rules","date_obj","matches","conditions","every","is_before","isBefore","is_after","isAfter","min_length","is_between","is_period","max_length","resource_ids","$event","_r1","ctx_r1","UploadPermissionsModalComponent","is_public","UploadPermissionsModalComponent_div_15_Template","UploadsService","_dialog","_upload_list","upload_list","JSON","parse","clearList","in_progress_list","uploadFileWithPermissions","reject","resolved","update_fn","_updateUploadHistory","done_list","forEach","stringify","_wake_lock","_requestScreenWakeLock","release","wakeLock","request","visibilityState","BindingDirective","_element","_renderer","sys","index","exec","on_event","params","ignore","model","modelChange","_binding","_old_model","bindVariable","ngOnChanges","changes","nativeElement","FsC","initials","UserAvatarComponent_div_0_div_1_Template","image_state_r2","UserAvatarComponent","UserAvatarComponent_div_0_Template","UserAvatarComponent_ng_template_1_Template","Space","feature_list","bookable","support_url","configurations","level","availability","inUseAt","SPACE_LIST","ATTEMPT_COUNT","EMPTY_SPACE","updateSpaceList","space_list","space","SPACE_PIPE","SpacePipe","space_id","is_email","system","showSystem","querySystemsWithEmails","in","SpacesService","_list","_compare","_init","loadSpaces","predicate","loadSpace","valid_spaces","querySystems","ExploreStateService","positions","_positions","active_level","_level","_spaces","zoom","center","x","y","_styles","_features","_actions","_labels","_options","disable","_message","spaces","map_url","map_positions","map_features","options","disable_features","map_actions","actions","disable_actions","map_labels","labels","disable_labels","map_styles","style_mappings","display","disable_styles","setLevel","setOptions","old_options","reset","setPositions","setStyles","style_map","setFeatures","feature_map","setActions","actions_map","setLabels","labels_map","has","exclude","styles_map","group","i3","zoomChange","mapInfo","_r3","onLevelChange","focus","_r4","MAP_FEATURE_DATA","InjectionToken","InteractiveMapComponent","_mapspeople","_explore","centerChange","use_mapsindoors$","InteractiveMapComponent_ng_container_0_Template","InteractiveMapComponent_ng_template_2_Template","InteractiveMapComponent_div_4_Template","mapsindoors_template_r5","fill","stroke","MapPinComponent","_details","show","show_message","attrs","MapPinComponent_div_0_Template","MapPinComponent__svg_svg_1_Template","SecurityContext","NONE","HTML","STYLE","SCRIPT","URL","RESOURCE_URL","SanitizePipe","sanitize","CustomTooltipComponent_ng_template_1_ng_container_1_ng_container_1_Template","injector","CustomTooltipComponent_ng_template_1_ng_container_3_ng_container_1_Template","CustomTooltipComponent_ng_template_1_ng_container_1_Template","CustomTooltipComponent_ng_template_1_ng_container_2_Template","CustomTooltipComponent_ng_template_1_ng_container_3_Template","CustomTooltipData","CustomTooltipComponent","_overlay","_injector","backdrop","hover","_overlay_ref","onClick","onTouch","onEnter","onLeave","_updateInjector","x_pos","y_pos","_updateType","_portal","getBoundingClientRect","create","hasBackdrop","positionStrategy","flexibleConnectedTo","withPositions","originX","originY","overlayX","overlayY","attach","backdropClick","dispose","TemplateRef","Injector","providers","provide","useValue","parent","viewQuery","CdkPortal","CustomTooltipComponent_ng_template_1_Template","focusInput","key_r3","$implicit","handleKeyPress","VirtualKeyboardComponent_ng_template_1_div_1_ng_container_1_div_3_Template","VirtualKeyboardComponent_ng_template_1_div_1_ng_container_1_Template","row_r4","VirtualKeyboardComponent_ng_template_1_div_1_Template","keyset","DEFAULT_KEYS","VirtualKeyboardComponent","onFocus","onBlur","blur","global","bottom","centerHorizontally","cursor_pos","selectionStart","substr","max","dispatchEvent","InputEvent","updateKeyState","selectionEnd","VirtualKeyboardComponent_ng_template_1_Template","GlobalLoadingComponent","online","isOnline","token","GlobalLoadingComponent_div_0_Template","GlobalLoadingComponent_div_1_Template","banner","GlobalBannerComponent","has_viewed","GlobalBannerComponent_div_0_Template","MapLocateModalComponent","processFeature","processStyles","track_id","z_index","MapLocateModalComponent_div_6_Template","image_r1","ImageCarouselComponent_div_1_img_1_Template","i_r5","ImageCarouselComponent_div_5_button_1_Template","ImageCarouselComponent","ImageCarouselComponent_div_1_Template","ImageCarouselComponent_div_2_Template","ImageCarouselComponent_button_3_Template","ImageCarouselComponent_button_4_Template","ImageCarouselComponent_div_5_Template","DurationPipe","shorten","formatDuration","JsonDisplayComponent","json","_updateFormatting","formatted_json","obj_r3","json_tooltip","DebugConsoleComponent_div_0_cdk_virtual_scroll_viewport_7_div_1_div_8_ng_container_2_Template","DebugConsoleComponent_div_0_cdk_virtual_scroll_viewport_7_div_1_div_8_ng_container_3_Template","DebugConsoleComponent_div_0_cdk_virtual_scroll_viewport_7_div_1_div_8_ng_container_4_Template","DebugConsoleComponent_div_0_cdk_virtual_scroll_viewport_7_div_1_div_8_Template","log_r4","DebugConsoleComponent_div_0_cdk_virtual_scroll_viewport_7_div_1_Template","filtered_logs","trackByFn","tmp_4_0","DebugConsoleComponent_div_0_cdk_virtual_scroll_viewport_7_Template","DebugConsoleComponent_div_0_span_16_Template","tmp_3_0","empty_state_r5","tmp_6_0","tmp_7_0","logs","_r6","onStart","onEnd","COLOR_MAP","network","dom","info","URL_STARTS","DebugConsoleComponent","can_activate","_logs","_hotkey","splice","i4","DebugConsoleComponent_div_0_Template","DebugConsoleComponent_button_1_Template","DebugConsoleComponent_ng_template_2_Template","changelog","ChangelogModalComponent","marked","ChangelogModalComponent_main_6_Template","ChangelogModalComponent_ng_template_7_Template","empty_state_r2","BuildingPipe","MapRendererComponent_ng_container_2_mat_spinner_1_Template","viewer","MapRendererComponent_div_3_ng_container_1_div_1_ng_container_3_ng_container_1_Template","element_r3","injectors","i_r4","MapRendererComponent_div_3_ng_container_1_div_1_ng_container_5_ng_container_1_Template","MapRendererComponent_div_3_ng_container_1_div_1_ng_container_3_Template","MapRendererComponent_div_3_ng_container_1_div_1_ng_container_4_Template","MapRendererComponent_div_3_ng_container_1_div_1_ng_container_5_Template","MapRendererComponent_div_3_ng_container_1_div_1_Template","MapRendererComponent_div_3_ng_container_1_Template","MapRendererComponent","onResize","updateDisplay","_on_changes","_extra_data","ratio$","ratio","svg_ratio$","svg_ratio","zoom$","applyGlobalStyles","removeViewer","createView","updateInjectors","focusOn","previousValue","currentValue","isSamePoint","p1","p2","updateView","ngAfterViewInit","getViewer","updateFeatureList","updateViewer","desired_zoom","desired_center","simp_url","_outlet_el","tkn","cookie","apiKey","createViewer","listenToViewerChanges","mappings","rect","idx","_feature_list","toArray","old_injectors","MapRendererComponent_ng_container_2_Template","MapRendererComponent_div_3_Template","MapRendererComponent_ng_template_4_Template","toggleDirections","MapsIndoorsComponent_button_2_mat_spinner_5_Template","viewing_directions","loading_directions","DEFAULT_ZOOM","RESOURCE_MAP","MapsIndoorsComponent","_maps_people","zoneChange","show_directions","ignore_zoom","_floor_list","_added_floor_selector","hasOwnProperty","_initialiseServices","_centerOnZone","_focusOnLocation","_updateMapStyling","_services","setZoom","_addFloorSelector","_setResource","lat","long","view_options","_container","parseFloat","lng","maxZoom","view_instance","mapView","GoogleMapsView","accessToken","MapboxView","provider","directions","GoogleMapsProvider","MapboxProvider","maps_indoors","MapsIndoors","view","getMap","services","DirectionsService","directions_renderer","DirectionsRenderer","mapsIndoors","addListener","_handleBuildingChange","_handleLevelChange","_handleZoomChange","_handleUserClick","Event","clearDirections","setRoute","items","_search","d_lng","d_lat","properties","anchor","coordinates","_last_position","setDirectionsFromLocation","enableHighAccuracy","from","to","calculateDistance","lat1","lon1","lat2","lon2","dLat","dLon","sin","cos","atan2","radius","routeParameters","destination","travelMode","getRoute","origin_error","TypeError","externalId","floors","_setFloorFromZone","defaultFloor","_last_building","take","new_level","roomId","ignore_actions","callback","query","LocationsService","getLocations","q","id_simple","setDisplayRule","extrusionHeight","extrusionVisible","polygonVisible","polygonFillColor","setCenter","setFloor","highlight","FloorSelector","maps","ControlPosition","RIGHT_TOP","addControl","onAdd","onRemove","MapsIndoorsComponent_button_2_Template","SPACE_LIST_REQUESTS","SPACE_COUNT","day_r2","ctx_r2","weekdays_enabled","initialiseDay","type_r7","block_r5","day_r6","setStartTime","setEndTime","WFHSettingsModalComponent_main_4_ng_container_7_ng_container_1_ng_container_1_div_6_mat_option_5_Template","i_r8","addBlock","removeBlock","timeFrom","tmp_11_0","WFHSettingsModalComponent_main_4_ng_container_7_ng_container_1_ng_container_1_div_6_Template","WFHSettingsModalComponent_main_4_ng_container_7_ng_container_1_ng_container_1_Template","WFHSettingsModalComponent_main_4_ng_container_7_ng_container_1_Template","WFHSettingsModalComponent_main_4_mat_checkbox_4_Template","WFHSettingsModalComponent_main_4_ng_container_7_Template","WFHSettingsModalComponent_main_4_ng_template_8_Template","has_working_days","empty_state_r9","_r10","saveChanges","WFHSettingsModalComponent","some","option_name","option","startOfMinute","changed","available_weekdays","addDays","startOfWeek","set","fromTime","cleanupBlocks","new_settings","updateUser","WFHSettingsModalComponent_button_3_Template","WFHSettingsModalComponent_main_4_Template","WFHSettingsModalComponent_footer_5_Template","WFHSettingsModalComponent_ng_template_6_Template","load_state_r11","setDarkMode","dark_mode","applySetting","font_size","AccessibilityTooltipComponent","can_change_dark_mode","accessible","n","i18n_0","$localize","AccessibilityTooltipComponent_div_6_Template","AccessibilityTooltipComponent_ng_container_14_Template","bld_r2","setBuilding","BuildingSelectComponent","BuildingSelectComponent_mat_radio_button_12_Template","tmp_0_0","tmp_1_0","tile_r1","HelpTooltipComponent","tiles","HelpTooltipComponent_a_6_Template","lang_r2","setLocale","flag","LanguageSelectComponent","locales","_translation","use","LanguageSelectComponent_button_10_Template","item_r2","RegionSelectComponent","RegionSelectComponent_mat_radio_button_12_Template","bld_r1","type_r2","SupportTicketModalComponent_main_6_div_26_mat_option_5_Template","support_request_types","SupportTicketModalComponent_main_6_mat_option_24_Template","SupportTicketModalComponent_main_6_div_26_Template","SupportTicketModalComponent_main_6_mat_error_32_Template","SupportTicketModalComponent_main_6_div_33_Template","desc_error","allow_images","submit","SupportTicketModalComponent","touched","support_email","issue_type","patchValue","markAllAsTouched","updateValueAndValidity","stmp_system","SupportTicketModalComponent_main_6_Template","SupportTicketModalComponent_footer_7_Template","SupportTicketModalComponent_ng_template_8_Template","load_state_r5","loc_r3","ctx_r4","setLocation","WorkLocationTooltipComponent_div_10_div_1_button_12_Template","WorkLocationTooltipComponent_div_10_div_1_div_17_Template","block_r6","menu_r7","WorkLocationTooltipComponent_div_10_div_1_Template","active_preference","WorkLocationTooltipComponent","seconds","milliseconds","editSettings","new_overrides","key_date","startOfDay","WorkLocationTooltipComponent_div_10_Template","WorkLocationTooltipComponent_ng_template_11_Template","empty_state_r8","region_select","building_select","help_tooltip","work_location_tooltip","desk_height_tooltip_r3","language_tooltip","newSupportTicket","_r5","reloadPage","UserControlsComponent","desk_height","use_region","disable_building_select","has_new_version","accessibility_tooltip","logout","openWfhModal","viewChangelog","fetch","saveSetting","formatLabel","toFixed","UserControlsComponent_div_7_Template","UserControlsComponent_div_9_Template","UserControlsComponent_div_10_Template","UserControlsComponent_div_11_Template","UserControlsComponent_div_22_Template","UserControlsComponent_ng_template_23_Template","UserControlsComponent_div_25_Template","UserControlsComponent_button_26_Template","UserControlsComponent_button_31_Template","IMAGE_STORE","Map","AuthenticatedImageDirective","_image_el","source","_loadImage","response","ok","createObjectURL","ChatService","connected","_socket","_chat_messages","_progress_message","_chat_system","biniding","_chat_id","chat_hint","_chat_pipe","webSocket","serializer","deserializer","return_value","_onMessage","_cleanup","messages","setBinding","system_id","startChat","endChat","sendMessage","chat_id","user_id","_timeoutSocket","msg_list","function","task_id","DateFromPipe","diff","differenceInMinutes","direction","abs","hint","message_r5","show_time","ChatComponent_div_0_div_4_div_18_div_3_Template","waiting","show_info","ChatComponent_div_0_div_4_div_20_div_12_Template","icons","toggleChat","ChatComponent_div_0_div_4_div_16_Template","ChatComponent_div_0_div_4_div_18_Template","ChatComponent_div_0_div_4_div_20_Template","ChatComponent_div_0_div_4_div_22_Template","resizeInput","ChatComponent_div_0_div_4_Template","ChatComponent","can_show","_chat","list_function_schemas","call_function","task_complete","scrollToBottom","_input_el","scrollHeight","_container_el","scrollTop","ChatComponent_div_0_Template","StatusPillComponent","StatusPillComponent_ng_container_3_Template","StatusPillComponent_ng_container_4_Template","StatusPillComponent_ng_container_5_Template","StatusPillComponent_ng_container_6_Template","StatusPillComponent_ng_container_7_Template","ImageViewerComponent","onClose","DeskHeightPresetsComponent","show_close","not_set","desk_sitting_height","desk_standing_height","DeskHeightPresetsComponent_div_5_Template","DeskHeightPresetsComponent_button_23_Template","PlaceZone","MAT_MODULES","MatAutocompleteModule","MatMenuModule","MatFormFieldModule","MatSelectModule","MatRippleModule","MatDialogModule","MatDatepickerModule","MatInputModule","ClipboardModule","MatProgressSpinnerModule","MatChipsModule","MatPaginatorModule","CdkTableModule","PortalModule","MatSortModule","ScrollingModule","MatTooltipModule","MatCheckboxModule","MatRadioModule","MatSliderModule","MatSlideToggleModule","MatButtonToggleModule","ComponentsModule","$C","G2t","provideHttpClient","withInterceptorsFromDi","imports","CommonModule","FormsModule","ReactiveFormsModule","TranslateModule","forChild","i5","i6","i7","i8","short","setValue","until","week_start","DateFieldComponent","has_error","_control","from_date","valueOf","to_date","addYears","endOfDay","NgControl","new_value","old_date","new_date","_onChange","_tooltip","writeValue","registerOnChange","registerOnTouched","_onTouch","setDisabledState","disabled","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","DateFieldComponent_Conditional_2_Template","DateFieldComponent_Conditional_3_Template","DateFieldComponent_span_8_Template","DateFieldComponent_ng_template_9_Template","calendar_picker_r3","option_r2","use_24hr","DurationFieldComponent_mat_option_4_ng_container_1_Template","DurationFieldComponent","step","custom_options","duration_options","generateDurationOptions","_updateOption","zero","findIndex","DurationFieldComponent_mat_option_4_Template","force_time","option_r3","extra_info_fn","TimeFieldComponent","no_past_times","show_select","_time_options","generateAvailableTimes","time_options","roundToNearestMinutes","nearestTo","showSelect","select_field","openedChange","datestamp","show_past","TimeFieldComponent_mat_option_3_Template","TimeFieldComponent_mat_option_4_Template","hasError","UserFormComponent_form_0_div_1_Template","UserFormComponent_form_0_div_2_Template","UserFormComponent_form_0_div_3_Template","UserFormComponent_form_0_div_4_Template","UserFormComponent_form_0_div_5_Template","UserFormComponent_form_0_div_6_Template","UserFormComponent","UserFormComponent_form_0_Template","NewUserModalComponent","new_user","NewUserModalComponent_main_7_Template","NewUserModalComponent_footer_8_Template","NewUserModalComponent_ng_template_9_Template","CateringItem","custom_id","option_list","in_order","unit_price","quantity","discount_cap","accept_points","has_options","active","hide_for_zones","unit_price_with_options","total_cost","options_string","deliverAtTime","order","_time","deliver_time","deliver_day_offset","all_day","deliver_offset","CateringOrder","deliver_at","_status","event_id","item_count","amount","charge_code","invoice_number","deliver_at_time","DAYS_OF_WEEK","getFreeTimeSlots","min_size","slots","bkn_start","setup_time","bkn_end","breakdown_time","isSameMinute","getNextFreeTimeSlot","addSeconds","AssetRequest","conflict","_changed","asset_ids","linked_bookings","request_id","_booking","ref_id","toJSON","category_id","item_ids","_default_user","CalendarEvent","is_all_day","view_access","ext","_valid_asset_cache","_valid_cache_expiry","event_start","getUnixTime","event_end","calendar","creator","host_email","attendees","u","private","date_end","match","associated_id","meeting_url","online_meeting_url","meeting_id","online_meeting_id","meeting_provider","online_meeting_provider","recurring","recurring_event_id","organiser","from_bookings","master","mailbox","ical_uid","update_master","recurrence","range_start","range_end","occurrences","days_of_week","old_system","is_system_event","eventStatus","simple_event","catering","linked_assets","booking_type","asset_requests","assets","guests","is_today","valid_catering","valid_assets","_pattern","parseRecurrence","addWeeks","addMonths","all_day_date","can_check_in","searchGuests","searchStaff","item_r3","ctx_r3","tmp_8_0","removeUser","UserListFieldComponent_mat_chip_row_6_app_icon_4_Template","addUserFromEmail","search$","user_r7","addUser","_r8","openNewUserModal","addUsersFromFile","downloadCSVTemplate","download","validateEmail","test","ACCEPTED_FILE_TYPES","DENIED_FILE_TYPES","UserListFieldComponent","queryUsers","search_valid_email","guests_only","hide_actions","custom_template","separatorKeysCodes","ENTER","COMMA","user_list$","staff","visitors_list","visitors","company","active_list","validFn","emptyClick","updateSearch","visitor_details","old_visitors","_search_el","a_user","files","reader","readAsText","evt","processCsvData","srcElement","csvToJson","csv","objPattern","RegExp","arrMatches","arrData","headers","row","internal_emails","downloadFile","filename","contents","setAttribute","click","removeChild","displayFn","UserListFieldComponent_mat_chip_row_6_Template","UserListFieldComponent_mat_spinner_10_Template","UserListFieldComponent_mat_option_13_Template","UserListFieldComponent_mat_option_14_Template","UserListFieldComponent_div_16_Template","auto_r10","chipList_r9","blurInput","stopPropagation","search_str","empty_fn","UserSearchFieldComponent","query_fn","search_results$","distinctUntilChanged","forkJoin","search","cancelReset","user_list","resetSearchString","active_user","ElementRef","validate","UserSearchFieldComponent_mat_spinner_5_Template","UserSearchFieldComponent_mat_option_8_Template","UserSearchFieldComponent_mat_option_9_Template","UserSearchFieldComponent_mat_option_10_Template","placeholder","auto_r7","ItemListFieldComponent","separators","addChipItem","control","input","item_list","removeChipItem","ItemListFieldComponent_mat_chip_row_3_Template","chipList_r5","IGNORE_EXT_KEYS","Booking","asset_id","asset_name","booking_start","booking_end","user_email","user_name","deleted","booked_by_id","booked_by_name","booked_by_email","approver_id","approver_email","approver_name","access","permission","members","induction","checked_out_at","checked_in_at","linked_event","process_state","recurrence_type","recurrence_days","recurrence_nth_of_month","recurrence_interval","recurrence_end","instance","is_done","addHours","checked_out","BOOKINGS_ENDPOINT","queryBookings","createBooking","removeBooking","removeBookingInstance","del","response_type","queryResourceAvailability","ignore_period","period_start","period_end","_createBookingsForEvent","bookings","location_id","Calendar","primary","summary","can_edit","starts_at","ends_at","CALENDAR_ENDPOINT","queryCalendarAvailability","calendarsToSpaces","cal","querySpaceFreeBusy","EVENTS_ENDPOINT","showEvent","addEventGuest","guest","querySpaceAvailability","system_ids","ignore_check","short_list","endInFuture","BOOKING_DATE","setMinutes","setHours","validateCateringField","catering_control","catering_field","PaymentModalComponent_div_0_ng_container_1_ng_container_8_Template","card_details","processPayment","resource_name","PaymentModalComponent_div_0_ng_container_1_Template","success","success_state_r3","transaction_id","PaymentModalComponent","_validCardDetails","makePayment","cardholder","cvv","PaymentModalComponent_div_0_Template","PaymentModalComponent_ng_template_2_Template","PaymentModalComponent_ng_template_4_Template","load_state_r4","STRIPE_MODULE","PaymentsService","payment_module","_loading","_active_card","payment_sources","cost","period","_getCostOfProduct","customer_id","_newCustomerID","_processPayment","rate","_addPaymentMethod","card","payment_method","price","product_list","invoice_id","created_at","updated_at","formatUTC","utc_date","localToTimezone","tz","offset_diff","getTimezoneOffset","addMilliseconds","formatAllDay","formatCalFileText","EventLinkModalComponent","_event","outlook_link","generateMicrosoftCalendarLink","path","rru","startdt","toISOString","enddt","subject","allday","emails","google_link","generateGoogleCalendarLink","fmt","trp","dates","ical_link","generateCalendarFileLink","chunks","has_actioned","BASE_ENDPOINT","groups_cache","queryAssetGroupsExtended","queryAssets","type_id","delete","queryGroupAvailability","products","product","asset","validateAssetRequestsForResource","_x3","_validateAssetRequestsForResource","from_booking","reset_state","new_assets","force_create","requests","booking_id","booking_list","differenceBetweenAssetRequests","old_assets","r","has_state","unchanged","changed_requests","changed_assets","used_ids","req","available_groups","processed_requests","asset_data","ASSET_GROUP_LIST","AssetGroup","assign","RULE_REQUESTS","AssetStateService","_category","getAssetRulesForZone","fresh","asset_list","asset_bookings","endOfMinute","updateAssetGroupList","assetgroup_list","assetgroup","category_list","queryAssetCategories","filtered_assets","assetAvailable","current_date","event_date","isRuleMatch","rule","countMatches","condition","subHours","disabled_rooms","setSearch","toggleCategory","categories","getOptions","BOOKING_URLS","EventFormService","options_value","is_multiday","_view","_form","favorite_spaces","has_calendar","_payments","_assets","zone_ids","generateEventForm","catering_notes","catering_charge_code","visitor_type","needs_space","needs_parking","attendance_type","shared_event","featured","valueChanges","o","setCateringTime","getRawValue","emitEvent","enable","roundingMethod","setValidators","clearValidators","setErrors","_date","last_success","building_rules","mapping","distinctUntilKeyChanged","requestSpacesForZone","filtered_spaces","show_fav","limit_map","limited_zones","zone_limit","_space_bookings","obs","current_available_spaces","merge","timer","periodInFreeTimeSlot","blk","future_available_spaces","startWith","available_spaces","differenceInDays","cancelPostForm","_space_pipe","events","NavigationEnd","clearForm","previous","storeForm","listenForStatusChanges","setView","newForm","resetForm","has_catering","removeItem","loadForm","form_data","openEventLinkModal","postForm","ignore_space_check","ignore_owner","changed_times","changed_spaces","checkSelectedSpacesAreAvailable","is_owner","receipt","invoice","breakdown","overflow","processed_assets","_makeBooking","host_override","creating_assets","on_error","_ref2","removeEvent","createBookingsForEvent","_x4","_x5","_x6","_updateVisitorList","saveEvent","updateEvent","method","patch","put","createEvent","saveBooking","updateBookingInstance","updateBooking","newBookingFromCalendarEvent","newCalendarEventFromBooking","toggleFavourite","displayed","selected_ids","favorites","NewSpaceSelectModalComponent","selected","_event_form","multiday","isSelected","setSelected","fav_list","NewSpaceSelectModalComponent_space_list_16_Template","NewSpaceSelectModalComponent_button_19_Template","NewSpaceSelectModalComponent_ng_template_37_Template","map_view_r6","space_r2","SpaceListFieldComponent_div_15_img_2_Template","SpaceListFieldComponent_div_15_ng_template_3_Template","changeSpaces","removeSpace","placeholder_r4","EMPTY_FAVS","SpaceListFieldComponent","room_size","i18n_5","SpaceListFieldComponent_div_15_Template","RichTextInputComponent","readonly","images_allowed","_updateFn","_editor","root","innerHTML","_initialiseEditor","delta","clipboard","convert","html","setContents","_editor_el","toolbarOptions","font","header","align","Quill","bounds","modules","toolbar","container","handlers","image","_embedImage","_embedAttachment","readOnly","on","off","range","getSelection","file_input","onchange","insertEmbed","insertText","setSelection","url_r3","copyLink","viewImage","removeImage","item_r6","retryUpload","ImageListFieldComponent_div_10_mat_progress_spinner_1_Template","ImageListFieldComponent_div_10_app_icon_2_Template","ImageListFieldComponent_div_10_div_3_Template","_r7","view_space","item_r10","_r9","ImageListFieldComponent","_clipboard","_uploads","upload_ids","uploads","ids","box","_list_el","addImageUrl","copy","addImage","chipInput","inputElement","resume","uploadImages","_file_input","new_list","ImageListFieldComponent_div_9_Template","ImageListFieldComponent_div_10_Template","ImageListFieldComponent_button_12_Template","ImageListFieldComponent_button_13_Template","ImageListFieldComponent_mat_chip_row_17_Template","chipList_r11","toggleDayOfWeek","RecurrenceModalComponent","ends_key","RecurrenceModalComponent_h2_20_Template","RecurrenceModalComponent_div_21_Template","day_r1","day_r3","DateCalendarComponent_button_16_div_3_Template","active_date","is_month","today","DateCalendarComponent","offset_weekday","date_list","generateDates","getDate","getMonth","year","getFullYear","changeMonth","change","startOfMonth","weekStartsOn","is_past","isSameMonth","DateCalendarComponent_div_13_Template","DateCalendarComponent_button_16_Template","zone_r1","BookingRulesFormComponent_div_59_div_1_Template","BookingRulesFormComponent_div_59_div_2_Template","available_conditions","time_r3","BookingRulesFormComponent_div_60_mat_option_5_Template","duration_blocks","time_r4","BookingRulesFormComponent_div_61_mat_option_5_Template","setIsPeriod","time_r7","time_r8","BookingRulesFormComponent_div_63_ng_container_9_mat_option_1_Template","setIsBetween","BookingRulesFormComponent_div_63_mat_option_6_Template","BookingRulesFormComponent_div_63_ng_container_9_Template","time_blocks","BookingRulesFormComponent","save","rulesetChange","building_zones","firstChange","condition_keys","BookingRulesFormComponent_mat_option_12_Template","BookingRulesFormComponent_mat_checkbox_31_Template","BookingRulesFormComponent_div_57_Template","BookingRulesFormComponent_div_58_Template","BookingRulesFormComponent_div_59_Template","BookingRulesFormComponent_div_60_Template","BookingRulesFormComponent_div_61_Template","BookingRulesFormComponent_div_62_Template","BookingRulesFormComponent_div_63_Template","BookingRulesFormComponent_div_64_Template","USER_LIST","PlaceUserPipe","setStartDate","setEndDate","start_date","DateRangeFieldComponent","end_date","contentQueries","dirIndex","DateRangeFieldComponent_ng_template_14_Template","weekday_r1","selectDate","setHoveredDate","DateRangeCalendarComponent_button_14_div_1_Template","DateRangeCalendarComponent_button_14_div_2_Template","DateRangeCalendarComponent_button_14_div_3_Template","DateRangeCalendarComponent_button_14_div_4_Template","DateRangeCalendarComponent_button_14_div_8_Template","is_start","is_end","is_selected","end_after_start","DateRangeCalendarComponent","startChange","endChange","hovered_date","weekdays","month_days","_setWeekdays","_setMonthDays","nextMonth","previousMonth","DateRangeCalendarComponent_div_13_Template","DateRangeCalendarComponent_button_14_Template","FormFieldsModule","i9","i10","i11","i12","i13","i14","i15","i16","i17","feature_r3","SpaceDetailsComponent_ng_container_0_section_33_div_3_Template","SpaceDetailsComponent_ng_container_0_image_carousel_2_Template","toggleFav","SpaceDetailsComponent_ng_container_0_section_33_Template","SpaceDetailsComponent_ng_container_0_section_34_Template","activeChange","fav","hide_map","SpaceDetailsComponent","_updateFeature","SpaceDetailsComponent_ng_container_0_Template","SpaceDetailsComponent_ng_template_1_Template","empty_state_r4","selectSpace","SpaceListComponent_ng_container_5_ul_1_li_1_div_3_Template","SpaceListComponent_ng_container_5_ul_1_li_1_img_4_Template","SpaceListComponent_ng_container_5_ul_1_li_1_ng_template_5_Template","space_placeholder_r4","tmp_12_0","isFavourite","SpaceListComponent_ng_container_5_ul_1_li_1_Template","SpaceListComponent_ng_container_5_ul_1_Template","SpaceListComponent","onSelect","SpaceListComponent_ng_container_5_Template","SpaceListComponent_ng_template_7_Template","SpaceListComponent_ng_template_9_Template","tmp_2_0","load_state_r6","reg_r4","SpaceFiltersComponent_mat_form_field_13_mat_option_2_Template","bld_r6","SpaceFiltersComponent_mat_form_field_15_mat_option_5_Template","lvl_r8","SpaceFiltersComponent_mat_form_field_17_mat_option_3_div_2_Template","SpaceFiltersComponent_mat_form_field_17_mat_option_3_Template","_r11","tmp_5_0","max_duration","SpaceFiltersComponent_div_28_div_6_Template","SpaceFiltersComponent_div_28_div_7_Template","_r12","_r13","feat_r14","toggleFeature","feature_display","SpaceFiltersComponent_section_31_ng_container_3_div_1_Template","hide_features","SpaceFiltersComponent_section_31_ng_container_3_Template","_r15","SpaceFiltersComponent","allow_all_day","_bsheet_ref","can_close","using_mapspeople","feat","hide_levels","viewing_map","SpaceFiltersComponent_button_2_Template","SpaceFiltersComponent_mat_form_field_13_Template","SpaceFiltersComponent_mat_form_field_15_Template","SpaceFiltersComponent_mat_form_field_17_Template","SpaceFiltersComponent_div_26_Template","SpaceFiltersComponent_div_27_Template","SpaceFiltersComponent_div_28_Template","SpaceFiltersComponent_section_29_Template","SpaceFiltersComponent_section_31_Template","SpaceFiltersComponent_div_34_Template","tmp_15_0","removeAllFeatures","feat_r4","removeFeature","SpaceFiltersDisplayComponent","_bsheet","viewChange","editFilters","_updateLocation","SpaceFiltersDisplayComponent_button_9_Template","SpaceFiltersDisplayComponent_div_11_Template","SpaceFiltersDisplayComponent_ng_container_16_Template","SpaceFiltersDisplayComponent_ng_container_17_Template","SpaceFiltersDisplayComponent_div_21_Template","tmp_9_0","available_until","ExploreSpaceInfoComponent_ng_template_2_ul_16_li_1_Template","ExploreSpaceInfoComponent_ng_template_2_img_4_Template","ExploreSpaceInfoComponent_ng_template_2_div_5_Template","ExploreSpaceInfoComponent_ng_template_2_div_11_Template","ExploreSpaceInfoComponent_ng_template_2_div_15_Template","ExploreSpaceInfoComponent_ng_template_2_ul_16_Template","show_features","ExploreSpaceInfoComponent","updateOffset","pos","clientWidth","clientHeight","ExploreSpaceInfoComponent_ng_template_2_Template","space_tooltip_r4","use_24hr_time","ExploreBookingModalComponent_ng_container_6_main_1_div_11_Template","ExploreBookingModalComponent_ng_container_6_main_1_div_18_Template","ExploreBookingModalComponent_ng_container_6_main_1_div_19_Template","can_book_for_others","ExploreBookingModalComponent_ng_container_6_main_1_Template","ExploreBookingModalComponent","ExploreBookingModalComponent_button_4_Template","ExploreBookingModalComponent_ng_container_6_Template","ExploreBookingModalComponent_ng_template_8_Template","VanillaQR","revision","imageTypes","bmp","gif","jpeg","jpg","png","tiff","webp","toTable","domElement","qrc","colorLight","colorDark","ecclevel","noBorder","borderSize","g","p","gexp","glog","R","Q","V","N1","N3","N2","N4","genframe","C","E","N","T","eccblocks","z","adelta","vpat","fmtword","tableWrite","canvasWrite","generateQRCode","toImage","prototype","getContext","lineWidth","round","canvas","clearRect","fillStyle","fillRect","cssText","cloneNode","firstChild","Image","toDataURL","DEFAULT_COLOURS","free","pending","reserved","busy","unknown","SpaceLocationPinComponent","color","SpaceLocationPinComponent_div_15_Template","SpaceLocationPinComponent_app_icon_16_Template","lvl_r3","SpaceSelectMapComponent_mat_form_field_1_mat_option_2_div_2_Template","SpaceSelectMapComponent_mat_form_field_1_mat_option_2_Template","_c1","SpaceSelectMapComponent","is_displayed","_seletedSpace","free_spaces","colours","new_zoom","resetMap","SpaceSelectMapComponent_mat_form_field_1_Template","SharedSpacesModule","MatBottomSheetModule","system_id$","BootstrapComponent_ng_container_4_mat_spinner_10_Template","BootstrapComponent_ng_container_4_mat_option_13_Template","BootstrapComponent_ng_container_4_mat_option_15_Template","bootstrap","auto_r4","BootstrapComponent","system_list","filtered_list","selected_system","configure","clearBootstrap","queryParamMap","checkBootstrapped","queryParamsHandling","BootstrapComponent_ng_container_4_Template","BootstrapComponent_ng_template_5_Template","AttendeeListComponent_ng_container_7_div_1_div_5_Template","user_r3","AttendeeListComponent_ng_container_7_div_1_Template","show_host","AttendeeListComponent","hide_close","custom_title","AttendeeListComponent_button_2_Template","AttendeeListComponent_div_5_Template","AttendeeListComponent_ng_container_7_Template","checkin","room_status","menu_r4","EventDetailsModalComponent_div_11_button_1_Template","EventDetailsModalComponent_div_11_button_2_Template","allow_edit","optionList","item_r7","EventDetailsModalComponent_ng_container_65_div_5_div_13_span_4_Template","order_r6","show_order","EventDetailsModalComponent_ng_container_65_div_5_div_13_Template","EventDetailsModalComponent_ng_container_65_div_5_Template","EventDetailsModalComponent_div_68_div_3_Template","request_r9","show_request","EventDetailsModalComponent_ng_container_69_div_5_div_13_Template","EventDetailsModalComponent_ng_container_69_div_5_Template","show_attendees","edit","no_edit_message","act_r15","_r14","EMPTY_ACTIONS","EventDetailsModalComponent","custom_actions","event_status","hide_edit","has_assets","accept_count","declined_count","pending_count","_load","dur","getEventMetadata","viewLocation","EventDetailsModalComponent_div_3_Template","EventDetailsModalComponent_div_4_Template","EventDetailsModalComponent_div_11_Template","EventDetailsModalComponent_ng_container_31_Template","EventDetailsModalComponent_div_33_Template","EventDetailsModalComponent_ng_container_65_Template","EventDetailsModalComponent_ng_container_67_Template","EventDetailsModalComponent_div_68_Template","EventDetailsModalComponent_ng_container_69_Template","EventDetailsModalComponent_div_73_Template","EventDetailsModalComponent_button_76_Template","EventDetailsModalComponent_button_83_Template","EventDetailsModalComponent_button_84_Template","is_interested","is_going","is_onsite","GroupEventDetailsModalComponent_div_99_interactive_map_3_Template","GroupEventDetailsModalComponent_div_99_div_5_Template","GroupEventDetailsModalComponent_div_99_div_6_Template","GroupEventDetailsModalComponent_div_99_span_8_Template","GroupEventDetailsModalComponent_div_99_span_9_Template","GroupEventDetailsModalComponent_div_99_a_10_Template","showing_map","has_space","is_online","GroupEventDetailsModalComponent","remove_blocks","last","lastIndexOf","attendance","guest_details","group_event_calendar","concierge","locate","raw_description","space_pipe","removeHtmlTags","DOMParser","parseFromString","textContent","toggleInterest","removeEventGuest","toggleAttendance","checkinEventGuest","guest_id","GroupEventDetailsModalComponent_img_2_Template","GroupEventDetailsModalComponent_div_3_Template","GroupEventDetailsModalComponent_ng_container_12_Template","GroupEventDetailsModalComponent_div_83_Template","GroupEventDetailsModalComponent_div_84_Template","GroupEventDetailsModalComponent_div_85_Template","GroupEventDetailsModalComponent_span_97_Template","GroupEventDetailsModalComponent_div_99_Template","GroupEventDetailsModalComponent_div_100_Template","concierge_menu_r5","menu_r6","EventCardComponent_h4_0_span_1_Template","show_day","EventCardComponent_a_1_div_26_div_1_Template","EventCardComponent_a_1_div_26_div_3_Template","viewDetails","EventCardComponent_a_1_div_18_Template","EventCardComponent_a_1_div_26_Template","EventCardComponent","_route","getLocationString","zone_list","EventCardComponent_h4_0_Template","EventCardComponent_a_1_Template","GroupEventCardComponent_button_0_img_2_Template","GroupEventCardComponent_button_0_p_13_Template","GroupEventCardComponent_button_0_div_17_Template","GroupEventCardComponent_button_0_div_18_Template","GroupEventCardComponent_button_0_div_19_Template","GroupEventCardComponent_ng_template_1_img_2_Template","GroupEventCardComponent_ng_template_1_p_27_Template","GroupEventCardComponent_ng_template_1_div_31_Template","GroupEventCardComponent_ng_template_1_div_32_Template","GroupEventCardComponent_ng_template_1_div_33_Template","GroupEventCardComponent","GroupEventCardComponent_button_0_Template","GroupEventCardComponent_ng_template_1_Template","featured_card_r4","SharedEventsModule","setDefaultCreator","MatButtonModule","min_duration","BookingModalComponent_form_3_div_1_Template","BookingModalComponent_form_3_div_3_Template","BookingModalComponent_form_3_div_4_Template","BookingModalComponent_form_3_div_5_Template","hide_host","future","_openBookingModal","BookingModalComponent","autoFocus","room_ids","disable_book_now_host","BookingModalComponent_form_3_Template","BookingModalComponent_footer_4_Template","BookingModalComponent_ng_template_5_Template","EmbeddedControlModalComponent","control_url","countdown","tick","PanelStateService","_system","_app_settings","_poll","PlaceSystem","_listenToModuleBinding","_current","current","_next","pending_check","pending_period","endCurrent","bindTo","connectionState","newBooking","force_api","openBookingModal","makeBooking","confirmBookNow","use_as_host","confirmStart","startMeeting","meeting","updateProperty","confirmEnd","viewControl","control_ui","confirmWaiter","callWaiter","_this12","on_change","mod_name","panel_module","PanelTopbarComponent","newEvent","PanelDetailsComponent_div_6_button_1_Template","PanelDetailsComponent_div_6_button_3_Template","PanelDetailsComponent_div_6_button_5_Template","disable_book_now","catering_ui","PanelDetailsComponent","_state","PanelDetailsComponent_p_4_Template","PanelDetailsComponent_div_6_Template","PanelDetailsComponent_ng_template_8_Template","PanelStatusComponent","starting_in","PanelBookingListComponent_h2_0_span_2_Template","PanelBookingListComponent_h2_0_span_5_Template","PanelBookingListComponent_h2_0_span_8_Template","started","PanelBookingListComponent_div_2_div_6_Template","PanelBookingListComponent_div_2_div_8_Template","event_r2","PanelBookingListComponent_ul_6_li_1_Template","PanelBookingListComponent_ul_6_li_4_Template","upcoming","PanelBookingListComponent","differenceInSeconds","PanelBookingListComponent_h2_0_Template","PanelBookingListComponent_div_2_Template","PanelBookingListComponent_h2_4_Template","PanelBookingListComponent_ul_6_Template","PanelBookingListComponent_ng_template_8_Template","empty_state_r3","BookingPanelComponent","topbar","paramMap","BookingPanelComponent_panel_topbar_1_Template","id_r1","BookingPanelArrayComponent_ng_container_3_div_1_app_booking_panel_1_Template","BookingPanelArrayComponent_ng_container_3_div_1_Template","BookingPanelArrayComponent","BookingPanelArrayComponent_ng_container_3_Template","BookingPanelArrayComponent_ng_template_4_Template","none_r3","id_r3","system_name","system_icon","system_status","showPanel","BookingPanelSelectComponent_ng_container_2_button_1_div_1_Template","BookingPanelSelectComponent_ng_container_2_button_1_img_3_Template","BookingPanelSelectComponent_ng_container_2_button_1_mat_spinner_4_Template","BookingPanelSelectComponent_ng_container_2_button_1_Template","active_system","BookingPanelSelectComponent","updateStatus","currentBooking","bkn","BookingPanelSelectComponent_ng_container_2_Template","BookingPanelSelectComponent_div_3_Template","BookingPanelSelectComponent_ng_template_4_Template","none_r7","PanelViewDetailsComponent_div_7_div_2_Template","qr_code","custom_qr","PanelViewDetailsComponent","hide_meeting_details","hide_meeting_title","room_image","custom_qr_url","custom_qr_color","PanelViewDetailsComponent_div_7_Template","PanelViewDetailsComponent_div_8_Template","PanelViewDetailsComponent_p_15_Template","nextPeriod","next_diff","currentPeriod","slot","current_diff","event_state","PanelViewStatusComponent_ng_container_16_ng_container_1_ng_container_1_Template","PanelViewStatusComponent_ng_container_16_ng_container_1_ng_container_3_Template","PanelViewStatusComponent_ng_container_16_ng_container_1_ng_container_6_Template","PanelViewStatusComponent_ng_container_16_ng_template_3_ng_container_2_ng_container_1_Template","PanelViewStatusComponent_ng_container_16_ng_template_3_ng_container_2_ng_container_3_Template","PanelViewStatusComponent_ng_container_16_ng_template_3_ng_container_2_ng_container_6_Template","PanelViewStatusComponent_ng_container_16_ng_template_3_ng_container_0_Template","PanelViewStatusComponent_ng_container_16_ng_template_3_ng_container_2_Template","PanelViewStatusComponent_ng_container_16_ng_container_1_Template","PanelViewStatusComponent_ng_container_16_ng_template_3_Template","free_for_state_r2","PanelViewStatusComponent","can_book","can_end","free_svg","in_use_svg","pending_svg","PanelViewStatusComponent_ng_container_16_Template","PanelViewStatusComponent_ng_template_18_Template","PanelViewStatusComponent_div_20_Template","PanelViewStatusComponent_div_22_Template","PanelViewStatusComponent_div_24_Template","no_current_state_r3","tmp_14_0","tmp_16_0","offline_color","offline_image","PanelViewComponent","show_offline","endMeeting","book","_logger","parentElement","PanelViewComponent_div_3_Template","blk_r2","CheckinTimetableComponent_button_1_div_1_Template","CheckinTimetableComponent_button_1_div_2_Template","blk_r4","CheckinTimetableComponent_ng_container_2_div_1_Template","CheckinTimetableComponent","current_time","event_blocks","_generateTimeBlocks","_updateCurrentTime","_processEvents","subMinutes","CheckinTimetableComponent_button_1_Template","CheckinTimetableComponent_ng_container_2_Template","CheckinViewComponent_ng_container_21_ng_container_1_ng_container_1_Template","CheckinViewComponent_ng_container_21_ng_container_1_ng_container_3_Template","CheckinViewComponent_ng_container_21_ng_container_1_ng_container_5_Template","CheckinViewComponent_ng_container_21_ng_template_3_ng_container_0_Template","CheckinViewComponent_ng_container_21_ng_template_3_ng_container_2_Template","CheckinViewComponent_ng_container_21_ng_template_3_ng_container_4_Template","CheckinViewComponent_ng_container_21_ng_container_1_Template","CheckinViewComponent_ng_container_21_ng_template_3_Template","free_for_state_r3","checkInCurrent","toggleQRShow","show_qr","routes","component","CheckinViewComponent","has_user","next_available","CheckinViewComponent_ng_container_21_Template","CheckinViewComponent_ng_template_23_Template","CheckinViewComponent_button_25_Template","CheckinViewComponent_button_27_Template","CheckinViewComponent_button_40_Template","CheckinViewComponent_h3_48_Template","CheckinViewComponent_div_49_Template","no_current_state_r7","tmp_13_0","EventPanelComponent","text_color","background_color","background_image","room_name","hide_qr","space_name","asCalendarEvent","EventPanelComponent_ng_container_16_Template","EventPanelComponent_ng_template_17_Template","EventPanelComponent_ng_container_23_Template","EventPanelComponent_ng_template_24_Template","EventPanelComponent_div_35_Template","alt","current_empty_state_r4","next_empty_state_r5","redirectTo","AppRoutingModule","RouterModule","forRoot","useHash","SharedOverlaysModule","MOCK_MENU","generateCateringOrder","mx","DOMAIN","PREDEF_USERS","ACTIVE_USER","MOCK_STAFF","MOCK_GUESTS","vaccination_proof","id_data","MOCK_ORGS","triggers","MOCK_BUILDINGS","MOCK_ZONES","MOCK_LEVELS","mockLevel","num","MOCK_METADATA","contacts","PARKING_SPACES","LOCKERS","ZONE_MOCKS","registerMocks","registerMockEndpoint","query_params","area_management","location_services","contact_tracing","route_params","generateParkingSpaces","generateLockers","generateMockDeskMetadata","charge_codes","map_regions","areas","label_location","geometry","DESK_FEATURES","desks","assignee","assigned_to","assigned_name","idx2","randomSpaceFeatures","numFeatures","MOCK_SPACES","generateMockSpace","linked","long_name","searchable","controlable","cost_hour","linked_rooms","EVENT_TIME","dayjs","startOf","nextEventTime","unix","randomStatus","rnd","MOCK_EVENTS","PEOPLE","unshift","event_spaces","USER_MOCKS","person","decodeURIComponent","generateLocation","LOCATION_TYPES","level_spaces","last_seen","geo","lon","RoomModule","help","tabs","volume","input_list","output_list","env_sources","available_outputs","$power","$share","$route","output","$updateState","following","$unroute","$connect","$disconnect","$link","$merge","$split","$notify","$preset","$volume","$mute","mute","$unmute","$environment","$lock","locked","$unlock","Mic1","Mic2","Mic3","PC1","PC2","PC3","PC4","HDMI","VGA","Camera1","Camera2","Camera3","Camera4","TV1","VC1","Display1","Display2","Display5","states","createSystemModule","MockBookingModule","time_zone","disable_end_meeting","pending_before","last_booking_started","current_booking","next_booking","_space","$start_meeting","$end_meeting","$book_now","len","$poll_bookings","updateBookings","subSeconds","createBookingsModule","MockAreaManagementModule","overview","emergency_contacts","$locate_user","$update","updateLocations","area","MAC_LOOKUP","MockLocationServicesModule","$check_ownership_of","mac_address","priority","padZero","no","createAreaManagementModule","desk_count","desk_usage","device_capacity","device_count","estimated_people","percentage_use","recommendation","area_id","users","fixed","usr","at_location","mac","Md5","hashStr","coordinates_from","s2_cell_id","variance","map_width","map_height","CameraModule","presets","$pan","dir","$tilt","tilt","$recall","$save_preset","DisplayModule","MicrophoneModule","CaptureModule","live","remaining","$start","$pause","$resume","$stop","createCaptureModule","MeetingPushModule","supported_meeting_url","$econtrol","createMeetingPushModule","VideoConferenceModule","$show_camera_pip","visible","selfview","$mic_mute","mic_mute","$presentation_mode","presentation_mode","$hangup","$call_place_on_hold","calls","Status","$call_resume","$video_layout","layout","video_layout","$dtmf_send","digit","$dial","dial_number","createVideoConferenceModule","CONTACT_EVENTS","filterFn","itm","contact_time","ContactTracingModule","$close_contacts","beginning","ending","createContactTracingModule","PaymentsModule","$list_payment_methods","$add_payment_method","$get_product_prices","$create_payment_intent","$confirm_payment_intent","$cancel_payment_intent","$create_customer","createPaymentsModule","LockerLocationsModule","$lockers_allocated_to_me","bank_id","locker_id","locker_name","allocated","group_id","createLockerLocationsModule","SYSTEM_MOCKS","createSystem","registerSystem","System","Bookings","ContactTracing","AreaManagement","LocationServices","Camera","createCameraModule","Display","createDisplayModule","Microphone","createMicrophoneModule","Capture","MeetingPush","VidConf","Payment","LockerLocations","mockSystem","EVENT_MOCKS","new_event","CALENDAR_MOCKS","user2","user3","handleSpaceAvailability","MOCK_CATEGORIES","MOCK_PRODUCTS","brand","barcode","MOCK_ASSETS","model_number","serial_number","identifier","other_data","purchase_order_id","MOCK_PURCHASE_ORDERS","order_number","purchase_date","expected_service_start_date","expected_service_end_date","subDays","TYPES","TRACKING","MOCK_BOOKINGS","lvls","lvl_spaces","approver","asset_count","plate_number","tracking","BOOKING_MOCKS","BASE_PATH","ASSET_MOCKS","update","dataset","SURVEY_MOCKS","MOCK_SURVEYS","survey_id","MOCK_SURVEY_ANSWERS","MOCK_SURVEY_QUESTIONS","survey","createMockSurvey","pages","createMockSurveyQuestion","choices","createMockSurveyAnswer","question_id","answer_json","mocks","START_QUERY","AppComponent","has_chat","_cache","_snackbar","_maps","_translate","MOCKS","refreshToken","readText","_pasteToken","pasteToken","locale","setAPI_Key","setNotifyOutlet","snackbar","disable_logging","convertPairStringToMap","relativeTo","queryParams","setupPlace","onInitError","_initLocale","setInternalUserDomain","_initAnalytics","initSentry","dsn","sample_rate","Sentry","integrations","maskAllText","blockAllMedia","tracesSampleRate","tracePropagationTargets","replaysSessionSampleRate","replaysOnErrorSampleRate","isMobileSafari","platform","userAgent","setCustomHeaders","Authorization","initialiseUploadService","auto_start","endpoint","worker_url","Amazon","Azure","Google","OpenStack","isFixedDevice","_checkReload","requestScreenWakeLock","invalidateToken","addLangs","languages","lang","clientId","AppComponent_global_chat_3_Template","AppComponent_debug_console_5_Template","AppPanelViewModule","AppCheckinModule","card_type","item_r4","BLANK_CARD","DATE_PIPE","DatePipe","CardInputFieldComponent","exp_month","exp_year","minLength","maxLength","setMonth","years","digits","_index","is_amex","card_display","card_focused","activeElement","onInput","_focusChange","CardInputFieldComponent_img_9_Template","CardInputFieldComponent_mat_option_23_Template","CardInputFieldComponent_mat_option_31_Template","AssetsModule","offset_x","hour_r2","user_r5","offset_y","FindAvailabilityModalComponent","current_hour","selection_left","selection_width","queryUserFreeBusy","calendars","availability_list","availability_map","fromUnixTime","defaultIfEmpty","move_time","_start_time","_move_last","_move_size","closeAndUpdate","querySelector","el_rect","scrollTo","left","onScroll","scrollLeft","startMovePeriod","MouseEvent","clientX","touches","_onMovePeriod","_onMoveEnd","startMoveDuration","_onMoveDuration","change_px","change_min","FindAvailabilityModalComponent_div_12_Template","FindAvailabilityModalComponent_div_18_Template","FindAvailabilityModalComponent_div_22_Template","FindAvailabilityModalComponent_div_30_Template","FindAvailabilityModalComponent_user_availability_list_36_Template","event_r1","UserAvailabilityComponent","UserAvailabilityComponent_div_1_Template","SharedUsersModule","SharedBookingsModule","SharedExploreModule","OverlayModule","HttpLoaderFactory","http","TranslateHttpLoader","AppModule","ErrorHandler","showDialog","deps","Router","APP_INITIALIZER","useFactory","BrowserModule","BrowserAnimationsModule","MatSnackBarModule","defaultLanguage","loader","TranslateLoader","HttpClient","ServiceWorkerModule","register","production","enableProdMode","__NgCli_bootstrap_1","bootstrapModule"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./libs/common/src/lib/async-handler.class.ts","./libs/components/src/lib/safe.pipe.ts","./libs/components/src/lib/icon.component.ts","./libs/components/src/lib/confirm-modal.component.ts","./libs/common/src/lib/general.ts","./libs/common/src/lib/google-analytics.service.ts","./libs/common/src/lib/hotkeys.service.ts","./apps/booking-panel/src/environments/settings.ts","./libs/common/src/lib/version.ts","./libs/users/src/lib/user.utilities.ts","./libs/users/src/lib/user.class.ts","./libs/common/src/lib/user-state.ts","./libs/common/src/lib/settings.service.ts","./libs/organisation/src/lib/organisation.class.ts","./libs/common/src/lib/notifications.ts","./libs/organisation/src/lib/level.class.ts","./libs/organisation/src/lib/building.class.ts","./libs/organisation/src/lib/region.class.ts","./libs/organisation/src/lib/organisation.service.ts","./libs/common/src/lib/mapspeople.service.ts","./libs/common/src/lib/angular-animations.ts","./libs/common/src/lib/api.ts","./libs/common/src/lib/application.ts","./libs/common/src/lib/placeos.ts","./libs/common/src/lib/timezones.ts","./libs/common/src/lib/uploads.ts","./libs/common/src/lib/remote-logging.service.ts","./libs/common/src/lib/timezone-helpers.ts","./libs/common/src/lib/booking-rules.ts","./libs/components/src/lib/upload-permissions-modal.component.ts","./libs/common/src/lib/uploads.service.ts","./libs/common/src/lib/fixed-device-helpers.ts","./libs/components/src/lib/binding.directive.ts","./libs/components/src/lib/user-avatar.component.ts","./libs/spaces/src/lib/space.class.ts","./libs/spaces/src/lib/space.pipe.ts","./libs/spaces/src/lib/spaces.service.ts","./libs/explore/src/lib/explore-state.service.ts","./libs/components/src/lib/interactive-map.component.ts","./libs/components/src/lib/map-pin.component.ts","./libs/components/src/lib/sanitise.pipe.ts","./libs/components/src/lib/custom-tooltip.component.ts","./libs/components/src/lib/virtual-keyboard.component.ts","./libs/components/src/lib/global-loading.component.ts","./libs/components/src/lib/global-banner.component.ts","./libs/components/src/lib/map-locate-modal.component.ts","./libs/components/src/lib/image-carousel.component.ts","./libs/components/src/lib/duration.pipe.ts","./libs/components/src/lib/json-display.component.ts","./libs/components/src/lib/debug-console.component.ts","./libs/components/src/lib/changelog-modal.component.ts","./libs/components/src/lib/building.pipe.ts","./libs/components/src/lib/map-renderer.component.ts","./libs/components/src/lib/maps-indoors.component.ts","./libs/spaces/src/lib/space.utilities.ts","./libs/users/src/lib/wfh-settings-modal.component.ts","./libs/components/src/lib/accessibility-tooltip.component.ts","./libs/components/src/lib/building-select.component.ts","./libs/components/src/lib/help-tooltip.component.ts","./libs/components/src/lib/language-tooltip.component.ts","./libs/components/src/lib/region-select.component.ts","./libs/form-fields/src/lib/support-ticket-modal.component.ts","./libs/components/src/lib/work-location-tooltip.component.ts","./libs/components/src/lib/user-controls.component.ts","./libs/components/src/lib/authenticated-image.directive.ts","./libs/components/src/lib/chat/chat.service.ts","./libs/components/src/lib/date-from.pipe.ts","./libs/components/src/lib/chat/chat.component.ts","./libs/components/src/lib/status-pill.component.ts","./libs/components/src/lib/image-viewer.component.ts","./libs/components/src/lib/desk-height-presets.component.ts","./libs/components/src/lib/limit-input.directive.ts","./libs/components/src/lib/zone.pipe.ts","./libs/components/src/lib/components.module.ts","./libs/form-fields/src/lib/date-field.component.ts","./libs/form-fields/src/lib/duration-field.component.ts","./libs/form-fields/src/lib/time-field.component.ts","./libs/users/src/lib/user-form.component.ts","./libs/users/src/lib/new-user-modal.component.ts","./libs/catering/src/lib/catering-item.class.ts","./libs/catering/src/lib/catering-order.class.ts","./libs/events/src/lib/helpers.ts","./libs/assets/src/lib/asset-request.class.ts","./libs/events/src/lib/event.class.ts","./libs/users/src/lib/guests.fn.ts","./libs/users/src/lib/staff.fn.ts","./libs/form-fields/src/lib/user-list-field.component.ts","./libs/form-fields/src/lib/user-search-field.component.ts","./libs/form-fields/src/lib/item-list-field.component.ts","./libs/bookings/src/lib/booking.class.ts","./libs/bookings/src/lib/bookings.fn.ts","./libs/calendar/src/lib/calendar.class.ts","./libs/calendar/src/lib/calendar.fn.ts","./libs/events/src/lib/events.fn.ts","./libs/events/src/lib/validators.ts","./libs/events/src/lib/utilities.ts","./libs/payments/src/lib/payment-modal.component.ts","./libs/payments/src/lib/payments.service.ts","./libs/common/src/lib/calendar-links.ts","./libs/events/src/lib/event-link-modal.component.ts","./libs/assets/src/lib/assets.fn.ts","./libs/assets/src/lib/asset-group.pipe.ts","./libs/assets/src/lib/asset.class.ts","./libs/assets/src/lib/asset.utilities.ts","./libs/assets/src/lib/asset-state.service.ts","./libs/events/src/lib/event-form.service.ts","./libs/bookings/src/lib/booking.utilities.ts","./libs/spaces/src/lib/space-select-modal/new-space-select-modal.component.ts","./libs/form-fields/src/lib/space-list-field.component.ts","./libs/form-fields/src/lib/rich-text-input.component.ts","./libs/form-fields/src/lib/image-list-field.component.ts","./libs/form-fields/src/lib/recurrence-modal.component.ts","./libs/form-fields/src/lib/date-calendar.component.ts","./libs/form-fields/src/lib/booking-rules-form.component.ts","./libs/form-fields/src/lib/place-user.pipe.ts","./libs/form-fields/src/lib/date-range-field.component.ts","./libs/form-fields/src/lib/date-range-calendar.component.ts","./libs/form-fields/src/lib/form-fields.module.ts","./libs/spaces/src/lib/space-select-modal/space-details.component.ts","./libs/spaces/src/lib/space-select-modal/space-list.component.ts","./libs/spaces/src/lib/space-select-modal/space-filters.component.ts","./libs/spaces/src/lib/space-select-modal/space-filters-display.component.ts","./libs/explore/src/lib/explore-space-info.component.ts","./libs/explore/src/lib/explore-booking-modal.component.ts","./libs/common/src/lib/vanillaqr.min.ts","./libs/common/src/lib/qr-code.ts","./libs/explore/src/lib/explore-spaces.service.ts","./libs/spaces/src/lib/space-select-modal/space-location-pin.component.ts","./libs/spaces/src/lib/space-select-modal/space-map.component.ts","./libs/spaces/src/lib/spaces.module.ts","./apps/booking-panel/src/app/bootstrap.component.ts","./libs/events/src/lib/attendee-list.component.ts","./libs/events/src/lib/event-details-modal.component.ts","./libs/events/src/lib/group-event-details-modal.component.ts","./libs/events/src/lib/event-card.component.ts","./libs/events/src/lib/group-event-card.component.ts","./libs/events/src/lib/events.module.ts","./apps/booking-panel/src/app/overlays/booking-modal.component.ts","./apps/booking-panel/src/app/overlays/embedded-control-modal.component.ts","./apps/booking-panel/src/app/panel-state.service.ts","./apps/booking-panel/src/app/panel/topbar.component.ts","./apps/booking-panel/src/app/panel/panel-details.component.ts","./apps/booking-panel/src/app/panel/panel-status.component.ts","./apps/booking-panel/src/app/panel/panel-booking-list.component.ts","./apps/booking-panel/src/app/panel/panel.component.ts","./apps/booking-panel/src/app/panel-array.component.ts","./apps/booking-panel/src/app/panel-select.component.ts","./apps/booking-panel/src/app/new-panel/panel-view-details.component.ts","./apps/booking-panel/src/app/new-panel/helpers.ts","./apps/booking-panel/src/app/new-panel/panel-view-status.component.ts","./apps/booking-panel/src/app/new-panel/panel-view.component.ts","./apps/booking-panel/src/app/checkin/checkin-timetable.component.ts","./apps/booking-panel/src/app/checkin/checkin-view.component.ts","./apps/booking-panel/src/app/event-panel.component.ts","./apps/booking-panel/src/app/app-routing.module.ts","./apps/booking-panel/src/app/overlays/overlays.module.ts","./libs/mocks/src/lib/api/catering.data.ts","./libs/mocks/src/lib/api/common.mock.ts","./libs/mocks/src/lib/api/users.data.ts","./libs/mocks/src/lib/api/zone.data.ts","./libs/mocks/src/lib/api/zones.mock.ts","./libs/mocks/src/lib/api/spaces.data.ts","./libs/mocks/src/lib/api/events.data.ts","./libs/mocks/src/lib/api/users.mock.ts","./libs/mocks/src/lib/realtime/control.ts","./libs/mocks/src/lib/realtime/events.ts","./libs/mocks/src/lib/realtime/desks.ts","./libs/mocks/src/lib/realtime/camera.ts","./libs/mocks/src/lib/realtime/display.ts","./libs/mocks/src/lib/realtime/microphone.ts","./libs/mocks/src/lib/realtime/capture.ts","./libs/mocks/src/lib/realtime/meeting.ts","./libs/mocks/src/lib/realtime/video-conference.ts","./libs/mocks/src/lib/realtime/contact-tracing.ts","./libs/mocks/src/lib/realtime/payments.ts","./libs/mocks/src/lib/realtime/locker-locations.ts","./libs/mocks/src/lib/api/systems.mock.ts","./libs/mocks/src/lib/systems-bindings.mock.ts","./libs/mocks/src/lib/api/events.mock.ts","./libs/mocks/src/lib/api/calendars.mock.ts","./libs/mocks/src/lib/api/assets.data.ts","./libs/mocks/src/lib/api/bookings.data.ts","./libs/mocks/src/lib/api/bookings.mock.ts","./libs/mocks/src/lib/api/assets.mock.ts","./libs/mocks/src/lib/api/surveys.mock.ts","./libs/mocks/src/mocks.ts","./libs/components/src/lib/app.component.ts","./apps/booking-panel/src/app/new-panel/panel-view.module.ts","./apps/booking-panel/src/app/checkin/checkin.module.ts","./libs/payments/src/lib/card-input-field.component.ts","./libs/payments/src/lib/payments.module.ts","./libs/assets/src/lib/assets.module.ts","./libs/users/src/lib/user.pipe.ts","./libs/users/src/lib/find-availability-modal/find-availability-modal.component.ts","./libs/users/src/lib/find-availability-modal/user-availability.component.ts","./libs/users/src/lib/users.module.ts","./libs/bookings/src/lib/bookings.module.ts","./libs/explore/src/lib/explore.module.ts","./apps/booking-panel/src/app/app.module.ts","./apps/booking-panel/src/environments/environment.prod.ts","./apps/booking-panel/src/main.ts"],"sourcesContent":["import { Injectable, OnDestroy } from '@angular/core';\nimport { Subscription, BehaviorSubject } from 'rxjs';\n\ntype VoidFn = () => void;\n\n/**\n * Class for handling cleanup of async methods when components are destroyed.\n * Async methods include Subscriptions, Timeouts and Intervals\n */\n@Injectable({\n    providedIn: 'root',\n})\nexport class AsyncHandler implements OnDestroy {\n    /** Store for named timers */\n    protected _timers: { [name: string]: number } = {};\n    /** Store for named intervals */\n    protected _intervals: { [name: string]: number } = {};\n    /** Store for named subscription unsub callbacks */\n    protected _subscriptions: {\n        [name: string]: Subscription | VoidFn;\n    } = {};\n    /** Subject which stores the initialised state of the object */\n    protected readonly _initialised = new BehaviorSubject<boolean>(false);\n    /** Observable of the initialised state of the object */\n    public readonly initialised = this._initialised.asObservable();\n\n    /** Whether the object has been initialised */\n    public get is_initialised(): boolean {\n        return this._initialised.getValue();\n    }\n\n    public ngOnDestroy(): void {\n        this.destroy();\n    }\n\n    protected destroy() {\n        for (const key in this._timers) {\n            if (key in this._timers) {\n                this.clearTimeout(key);\n            }\n        }\n        for (const key in this._intervals) {\n            if (key in this._intervals) {\n                this.clearInterval(key);\n            }\n        }\n        for (const key in this._subscriptions) {\n            if (key in this._subscriptions) {\n                this.unsub(key);\n            }\n        }\n    }\n\n    /**\n     * Creates a named timer\n     * @param name Name of the timer\n     * @param fn Callback function for the timer\n     * @param delay Callback delay\n     */\n    protected timeout(name: string, fn: () => void, delay: number = 300) {\n        if (name && fn && fn instanceof Function) {\n            this.clearTimeout(name);\n            this._timers[name] = <any>setTimeout(() => {\n                fn();\n                delete this._timers[name];\n            }, delay);\n        } else {\n            throw new Error(\n                name\n                    ? 'Cannot create named timeout without a name'\n                    : 'Cannot create a timeout without a callback'\n            );\n        }\n    }\n\n    /**\n     * Clears the named timer\n     * @param name Timer name\n     */\n    protected clearTimeout(name: string) {\n        if (this._timers[name]) {\n            clearTimeout(this._timers[name]);\n            delete this._timers[name];\n        }\n    }\n\n    /**\n     * Creates a named interval\n     * @param name Name of the interval\n     * @param fn Callback function for the interval\n     * @param delay Callback delay\n     */\n    protected interval(name: string, fn: () => void, delay: number = 300) {\n        if (name && fn && fn instanceof Function) {\n            this.clearInterval(name);\n            this._intervals[name] = <any>setInterval(() => fn(), delay);\n        } else {\n            throw new Error(\n                name\n                    ? 'Cannot create named interval without a name'\n                    : 'Cannot create a interval without a callback'\n            );\n        }\n    }\n\n    /**\n     * Clears the named interval\n     * @param name Timer name\n     */\n    protected clearInterval(name: string) {\n        if (this._intervals[name]) {\n            clearInterval(this._intervals[name]);\n            delete this._intervals[name];\n        }\n    }\n\n    /**\n     * Store named subscription\n     * @param name Name of the subscription\n     * @param unsub Unsubscribe callback or Subscription object\n     */\n    protected subscription(name: string, unsub: Subscription | VoidFn) {\n        this.unsub(name);\n        this._subscriptions[name] = unsub;\n    }\n\n    protected hasSubscription(name: string) {\n        return (\n            this._subscriptions[name] instanceof Subscription ||\n            !!this._subscriptions[name]\n        );\n    }\n\n    /**\n     * Call unsubscribe callback with the given name\n     * @param name\n     */\n    protected unsub(name: string) {\n        if (name in this._subscriptions) {\n            if (this._subscriptions[name] instanceof Subscription) {\n                (this._subscriptions[name] as any).unsubscribe();\n            } else if (this._subscriptions[name]) {\n                (this._subscriptions[name] as any)();\n            }\n            delete this._subscriptions[name];\n        }\n    }\n\n    /** Unsubscribe to the items with names containing the given string */\n    protected unsubWith(contains: string) {\n        const subs = Object.keys(this._subscriptions).filter((k) =>\n            k.includes(contains)\n        );\n        for (const key of subs) {\n            this.unsub(key);\n        }\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer, SafeHtml, SafeResourceUrl, SafeScript, SafeStyle } from '@angular/platform-browser';\n\n@Pipe({\n    name: 'safe'\n})\nexport class SafePipe implements PipeTransform {\n    constructor(private sanitizer: DomSanitizer) {}\n\n    /**\n     * Sanitizes the string allowing it to be injected into a template\n     * @param value String to sanitize\n     * @param type Type of value to sanitise. `resource`, `url`, `script`, `style` or `html`\n     */\n    public transform(\n        value: string,\n        type: 'resource' | 'url' | 'script' | 'style' | 'html' = 'html'\n    ): SafeHtml | SafeResourceUrl | SafeScript | SafeStyle {\n        switch (type) {\n            case 'resource':\n                return this.sanitizer.bypassSecurityTrustResourceUrl(value);\n            case 'url':\n                return this.sanitizer.bypassSecurityTrustUrl(value);\n            case 'script':\n                return this.sanitizer.bypassSecurityTrustScript(value);\n            case 'style':\n                return this.sanitizer.bypassSecurityTrustStyle(value);\n            default:\n                return this.sanitizer.bypassSecurityTrustHtml(value);\n        }\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { ApplicationIcon } from 'libs/common/src/lib/types';\n\n@Component({\n    selector: 'app-icon,icon',\n    template: `\n        <div class=\"flex items-center justify-center h-[1.25em] w-[1.25em]\">\n            <i\n                *ngIf=\"!icon || icon.type !== 'img'\"\n                [class]=\"icon?.class || className\"\n            >\n                {{ icon?.content }}\n                <ng-content></ng-content>\n            </i>\n            <img\n                class=\"h-[1em] w-[1em]\"\n                *ngIf=\"icon && icon.type === 'img'\"\n                [src]=\"icon.src | safe: 'resource'\"\n            />\n        </div>\n    `,\n    styles: [\n        `\n            i {\n                font-size: 1em;\n            }\n        `,\n    ],\n})\nexport class IconComponent {\n    @Input() public className: string = 'material-icons';\n    /** Icon details */\n    @Input() public icon: ApplicationIcon;\n}\n","import { Component, Output, EventEmitter, Inject } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { AsyncHandler } from 'libs/common/src/lib/async-handler.class';\nimport { ApplicationIcon, DialogEvent } from 'libs/common/src/lib/types';\n\nexport interface ConfirmModalData {\n    /** Title of the modal */\n    title: string;\n    /** Contents of the modal */\n    content: string;\n    /** Text displaed on the confirmation button */\n    confirm_text?: string;\n    /** Text displaed on the confirmation button */\n    cancel_text?: string;\n    /** Icon to display on the modal */\n    icon: ApplicationIcon;\n    /** Delay before closing the modal */\n    close_delay?: number;\n}\n\nexport const CONFIRM_METADATA = {\n    height: 'auto',\n    width: '28em',\n    maxHeight: 'calc(100vh - 2em)',\n    maxWidth: 'calc(100vw - 2em)',\n};\n\n@Component({\n    selector: 'confirm-modal',\n    template: `\n        <header class=\"px-4 py-3\">\n            <h3 class=\"font-medium text-xl\">{{ title }}</h3>\n        </header>\n        <main\n            *ngIf=\"!loading; else load_state\"\n            class=\"flex flex-col items-center space-y-4 p-4 max-w-[80vw]\"\n        >\n            <app-icon [icon]=\"icon\" class=\"text-5xl\"></app-icon>\n            <p content class=\"text-center\" [innerHTML]=\"content\"></p>\n        </main>\n        <footer\n            class=\"flex items-center justify-center p-4 space-x-4\"\n            *ngIf=\"!loading\"\n        >\n            <button btn matRipple class=\"inverse flex-1\" mat-dialog-close>\n                {{ cancel_text }}\n            </button>\n            <button\n                btn\n                matRipple\n                name=\"accept\"\n                class=\"flex-1\"\n                (click)=\"onConfirm()\"\n            >\n                {{ confirm_text }}\n            </button>\n        </footer>\n        <ng-template #load_state>\n            <main loading>\n                <div\n                    class=\"w-full h-48 flex flex-col items-center justify-center space-y-4\"\n                >\n                    <mat-spinner diameter=\"32\"></mat-spinner>\n                    <p>{{ loading }}</p>\n                </div>\n            </main>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class ConfirmModalComponent extends AsyncHandler {\n    /** Loading state */\n    public loading: string;\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Title of the confirm modal */\n    public readonly title: string = this._data.title || 'Confirm';\n    /** Body of the confirm modal */\n    public readonly content: string = this._data.content || 'Are you sure?';\n    /** Display text on the confirm button */\n    public readonly confirm_text: string = this._data.confirm_text || 'Accept';\n    /** Display text on the cancel button */\n    public readonly cancel_text: string = this._data.cancel_text || 'Cancel';\n    /** Display icon properties */\n    public readonly icon: ApplicationIcon = this._data.icon || {\n        class: 'material-icons',\n        content: 'done',\n    };\n    /** Prevent user from closing the modal */\n    public readonly disableClose = () => (this._dialog_ref.disableClose = true);\n    /** Allow the user to close the modal */\n    public readonly enableClose = () => (this._dialog_ref.disableClose = false);\n\n    constructor(\n        private _dialog_ref: MatDialogRef<ConfirmModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: ConfirmModalData,\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        if (this._data.close_delay) {\n            this.timeout(\n                'close',\n                () => this._dialog_ref.close(),\n                this._data.close_delay,\n            );\n        }\n    }\n\n    /** User confirmation of the content of the modal */\n    public onConfirm() {\n        this.event.emit({ reason: 'done' });\n    }\n}\n","import { FormGroup } from '@angular/forms';\nimport { MatDialog } from '@angular/material/dialog';\nimport { first } from 'rxjs/operators';\nimport {\n    ConfirmModalComponent,\n    ConfirmModalData,\n    CONFIRM_METADATA,\n} from '../../../components/src/lib/confirm-modal.component';\nimport { HashMap } from './types';\n\n/** Available console output streams. */\nexport type ConsoleStream = 'debug' | 'warn' | 'log' | 'error';\n\ndeclare global {\n    interface Window {\n        debug: boolean;\n        jest: any;\n    }\n}\n\nlet _app_name = 'APP';\n\nexport function setAppName(name: string) {\n    _app_name = name;\n}\n\n/**\n * Log data to the browser console\n * @param type Type of message\n * @param msg Message body\n * @param args array of argments to log to the console\n * @param stream Stream to emit the console on. 'debug', 'log', 'warn' or 'error'\n * @param force Whether to force message to be emitted when debug is disabled\n */\nexport function log(\n    type: string,\n    msg: string,\n    args?: any,\n    stream: ConsoleStream = 'debug',\n    force: boolean = false,\n    app_name: string = _app_name,\n) {\n    if (window.jest) return;\n    if (window.debug || force) {\n        const colors: string[] = [\n            'color: #E91E63',\n            'color: #3F51B5',\n            'color: default',\n        ];\n        if (args) {\n            console[stream](\n                `%c[${app_name}]%c[${type}] %c${msg}`,\n                ...colors,\n                args,\n            );\n        } else {\n            console[stream](`%c[${app_name}]%c[${type}] %c${msg}`, ...colors);\n        }\n    }\n}\n\n/**\n * Get item from the nested object\n * @param keys List of sub-keys to search for\n * @param map Object to search\n */\nexport function getItemWithKeys(keys: string[], map: HashMap) {\n    const key = keys[0];\n    if (map && key in map) {\n        return keys.length > 1\n            ? getItemWithKeys(keys.slice(1), map[key] || {})\n            : map[key];\n    }\n    return null;\n}\n\n/**\n * Remove duplicates from the given array\n * @param array List of items to remove duplicates from\n * @param key Key on array objects to compare for uniqueness\n */\nexport function unique<T = any>(array: T[] = [], key: string = ''): T[] {\n    const keys = [];\n    return array.filter((el) => {\n        const id = key ? el[key] : el;\n        const exists = keys.includes(id);\n        if (!exists) keys.push(id);\n        return !exists;\n    });\n}\n\n/**\n * Generate a random number\n * @param ceil Biggest value to generate not inclusive\n * @param floor Smallest value to generate. Defaults to 0\n */\nexport function randomInt(ceil: number, floor: number = 0) {\n    return Math.floor(Math.random() * (ceil - floor)) + floor;\n}\n\n/**\n * Pad string to the given length\n * @param str Base string\n * @param length Length to pad the string\n */\nexport function padString(str: string | number, length: number = 5) {\n    str = `${str}`;\n    while (str.length < length) str = `0${str}`;\n    return str;\n}\n\n/**\n * Generate a random string\n * @param length Length of the string\n * @param chars Available characters to use in the string\n */\nexport function randomString(\n    length: number,\n    chars: string = 'abcdefghijklmnopqrstwvxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789',\n) {\n    let str = '';\n    for (let i = 0; i < length; i++) {\n        str += chars[randomInt(chars.length)];\n    }\n    return str;\n}\n\nexport interface ConfirmRepsonse {\n    reason: 'done' | '' | null;\n    loading: (_: string) => void;\n    close: () => void;\n}\n\nexport async function openConfirmModal(\n    data: ConfirmModalData,\n    dialog: MatDialog,\n): Promise<ConfirmRepsonse> {\n    const ref = dialog.open<ConfirmModalComponent, ConfirmModalData>(\n        ConfirmModalComponent,\n        {\n            ...CONFIRM_METADATA,\n            data,\n        },\n    );\n    return {\n        ...(await Promise.race([\n            ref.componentInstance.event\n                .pipe(first((_) => _.reason === 'done'))\n                .toPromise(),\n            ref.afterClosed().toPromise(),\n        ])),\n        loading: (s) => (ref.componentInstance.loading = s),\n        close: () => ref.close(),\n    };\n}\n\n/**\n * Parse raw CSV data into a JSON object\n * @param csv CSV data to parse\n */\nexport function csvToJson(csv: string, delimiter: string = ','): HashMap[] {\n    const objPattern = new RegExp(\n        '(\\\\,|\\\\r?\\\\n|\\\\r|^)(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|([^\\\\,\\\\r\\\\n]*))',\n        'gi',\n    );\n    let arrMatches = null;\n    const arrData = [[]];\n    while ((arrMatches = objPattern.exec(csv))) {\n        if (arrMatches[1].length && arrMatches[1] !== ',') arrData.push([]);\n        arrData[arrData.length - 1].push(\n            arrMatches[2]\n                ? arrMatches[2]?.replace(new RegExp('\"\"', 'g'), '\"')\n                : arrMatches[3],\n        );\n    }\n    const headers: string[] = arrData.splice(0, 1)[0];\n    const elements = arrData.map((row) => {\n        const element = {};\n        for (let i = 0; i < row.length; i++) {\n            const key = (headers[i] || '').split(' ').join('_').toLowerCase();\n            try {\n                element[key] = JSON.parse(row[i]?.replace('|', ','));\n            } catch (e) {\n                element[key] = row[i] || '';\n            }\n            if (element[key] === 'TRUE' || element[key] === 'FALSE')\n                element[key] = element[key] === 'TRUE';\n        }\n        return element;\n    });\n    return elements;\n}\n\nexport function loadTextFileFromInputEvent(event: InputEvent) {\n    return new Promise<string>((resolve, reject) => {\n        /* istanbul ignore else */\n        if (event.target) {\n            const element = event.target as HTMLInputElement;\n            const file = element.files[0];\n            /* istanbul ignore else */\n            if (file) {\n                const reader = new FileReader();\n                reader.readAsText(file, 'UTF-8');\n                reader.addEventListener('load', (evt) => {\n                    resolve((evt.srcElement as any).result);\n                    element.value = '';\n                });\n                reader.addEventListener('error', (_) => {\n                    this.loading = '';\n                    reject(['Error loading file', _]);\n                });\n            }\n        }\n    });\n}\n\n/**\n * Convert javascript array to CSV string\n * @param json Javascript array to convert\n */\nexport function jsonToCsv(json: HashMap[], seperator = ',') {\n    if (json instanceof Array && json.length > 0) {\n        const keys = Object.keys(json[0]);\n        const valid_keys = keys.filter((key) => key in json[0]);\n        return `${valid_keys.join(seperator)}\\n${json\n            .map((item) =>\n                valid_keys\n                    .map((key) =>\n                        (JSON.stringify(item[key]) || '')?.replace(',', '|'),\n                    )\n                    .join(seperator),\n            )\n            .join('\\n')}`;\n    }\n    return '';\n}\n\n/**\n * Downloads a file to the users computer with the given filename and contents\n * @param filename Name of the file to download\n * @param contents Contents of the file to download\n */\nexport function downloadFile(filename: string, contents: string) {\n    const element = document.createElement('a');\n    element.setAttribute(\n        'href',\n        'data:text/plain;charset=utf-8,' + encodeURIComponent(contents),\n    );\n    element.setAttribute('download', filename);\n\n    element.style.display = 'none';\n    document.body.appendChild(element);\n\n    element.click();\n\n    document.body.removeChild(element);\n}\n\nexport function parseJWT(token: string) {\n    const base64Url = token.split('.')[1];\n    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n    const jsonPayload = decodeURIComponent(\n        atob(base64)\n            .split('')\n            .map((c) => {\n                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n            })\n            .join(''),\n    );\n    return JSON.parse(jsonPayload);\n}\n\n/* istanbul ignore next */\n/**\n * Flatten nested array\n * @param an_array Array to flatten\n */\nexport function flatten<T = any>(an_array: any[]): T[] {\n    const stack = [...an_array];\n    const res = [];\n    while (stack.length) {\n        // pop value from stack\n        const next = stack.pop();\n        if (Array.isArray(next)) {\n            // push back array items, won't modify the original input\n            stack.push(...next);\n        } else {\n            res.push(next);\n        }\n    }\n    // reverse to restore input order\n    return res.reverse();\n}\n\n/**\n * Check whether two time periods intersect with each other\n * @param start1 Unix epoch in ms of the first period's start time\n * @param end1 Unix epoch in ms of the first period's end time\n * @param start2 Unix epoch in ms of the second period's start time\n * @param end2 Unix epoch in ms of the second period's end time\n */\nexport function timePeriodsIntersect(\n    s1: number,\n    e1: number,\n    s2: number,\n    e2: number,\n) {\n    return (\n        (s1 >= s2 && s1 < e2) ||\n        (s2 >= s1 && s2 < e1) || // Check start time\n        (e1 > s2 && e1 <= e2) ||\n        (e2 > s1 && e2 <= e1) // Check end time\n    );\n}\n\nconst seed = xmur3('PlaceOS');\nconst rand = sfc32(0x9e3779b9, 0x243f6a88, 0xb7e15162, seed());\n\nexport function predictableRandomInt(ceil: number = 100, floor: number = 0) {\n    return Math.floor(rand() * (ceil - floor)) + floor;\n}\n\n// https://stackoverflow.com/questions/521295/seeding-the-random-number-generator-in-javascript\nfunction xmur3(str) {\n    let h = 1779033703 ^ str.length;\n    for (let i = 0; i < str.length; i++)\n        (h = Math.imul(h ^ str.charCodeAt(i), 3432918353)),\n            (h = (h << 13) | (h >>> 19));\n    return function () {\n        h = Math.imul(h ^ (h >>> 16), 2246822507);\n        h = Math.imul(h ^ (h >>> 13), 3266489909);\n        return (h ^= h >>> 16) >>> 0;\n    };\n}\n\nfunction sfc32(a, b, c, d) {\n    return function () {\n        a >>>= 0;\n        b >>>= 0;\n        c >>>= 0;\n        d >>>= 0;\n        let t = (a + b) | 0;\n        a = b ^ (b >>> 9);\n        b = (c + (c << 3)) | 0;\n        c = (c << 21) | (c >>> 11);\n        d = (d + 1) | 0;\n        t = (t + d) | 0;\n        c = (c + t) | 0;\n        return (t >>> 0) / 4294967296;\n    };\n}\n\n/** Get time format string for locale */\nexport function timeFormatString(): string {\n    return is24HourTime() ? 'HH:mm' : 'h:mm a';\n}\n\n/** Whether locale string is displayed in 24 hour time */\nexport function is24HourTime(): boolean {\n    const date = new Date();\n    const localeString = date\n        .toLocaleTimeString(\n            document.querySelector('html').getAttribute('lang') ||\n                navigator.language,\n        )\n        .toLowerCase();\n    return localeString.indexOf('am') < 0 && localeString.indexOf('pm') < 0;\n}\n\nexport function getInvalidFields(form: FormGroup, prefix: string = '') {\n    let invalid = [];\n    for (const key in form.controls) {\n        if (form.controls[key] instanceof FormGroup) {\n            invalid = [\n                ...invalid,\n                ...getInvalidFields(form.controls[key] as FormGroup, `${key}.`),\n            ];\n        } else if (!form.controls[key].valid) {\n            invalid.push(`${prefix}${key}`);\n        }\n    }\n    return invalid;\n}\n\nexport function removeEmptyFields(obj: Record<string, any>) {\n    for (const key in obj) {\n        if (obj[key] === undefined || obj[key] === null || obj[key] === '') {\n            delete obj[key];\n        }\n    }\n}\n\nexport function capitalizeFirstLetter(word: string): string {\n    return `${word[0].toUpperCase()}${word.substring(1)}`;\n}\n\nexport function cleanArray(\n    array: any[],\n    removal_items: any[] = [undefined, null, ''],\n) {\n    return array.filter((_) => !removal_items.includes(_));\n}\n\nexport function isMobileSafari() {\n    return (\n        [\n            'iPad Simulator',\n            'iPhone Simulator',\n            'iPod Simulator',\n            'iPad',\n            'iPhone',\n            'iPod',\n        ].includes(navigator.platform) ||\n        // iPad on iOS 13 detection\n        (navigator.userAgent.includes('Mac') && 'ontouchend' in document)\n    );\n}\n\nexport function isNestedFrame() {\n    return window.location !== window.parent.location;\n}\n\n// Calculate the distance between geographical cooridinates\nexport function calculateDistance(\n    lat1: number,\n    lon1: number,\n    lat2: number,\n    lon2: number,\n): number {\n    const radius = 6371; // Earth's radius in kilometers\n\n    const dLat = degreesToRadians(lat2 - lat1);\n    const dLon = degreesToRadians(lon2 - lon1);\n\n    lat1 = degreesToRadians(lat1);\n    lat2 = degreesToRadians(lat2);\n\n    const a =\n        Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n        Math.sin(dLon / 2) *\n            Math.sin(dLon / 2) *\n            Math.cos(lat1) *\n            Math.cos(lat2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return radius * c;\n}\n\nfunction degreesToRadians(degrees: number): number {\n    return degrees * (Math.PI / 180);\n}\n\n//////////////////////////////////////////\n//////   Colour Conversion Utils   ///////\n//////////////////////////////////////////\n\nexport function hexToRgb(hex: string): RGB {\n    let r = parseInt(hex.slice(1, 3), 16);\n    let g = parseInt(hex.slice(3, 5), 16);\n    let b = parseInt(hex.slice(5, 7), 16);\n    return [r, g, b];\n}\n\nexport type RGB = [number, number, number];\n\nexport function interpolateColors(rgb1: RGB, rgb2: RGB, fraction: number): RGB {\n    let r = rgb1[0] + (rgb2[0] - rgb1[0]) * fraction;\n    let g = rgb1[1] + (rgb2[1] - rgb1[1]) * fraction;\n    let b = rgb1[2] + (rgb2[2] - rgb1[2]) * fraction;\n    return [Math.round(r), Math.round(g), Math.round(b)];\n}\n\nexport function rgbToHex(r: number, g: number, b: number): string {\n    function componentToHex(c) {\n        const hex = c.toString(16);\n        return hex.length == 1 ? '0' + hex : hex;\n    }\n    return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b);\n}\n\nexport function shiftColorTowards(\n    hex1: string,\n    hex2: string,\n    fraction: number,\n) {\n    const rgb1 = hexToRgb(hex1);\n    const rgb2 = hexToRgb(hex2);\n    const resultRgb = interpolateColors(rgb1, rgb2, fraction);\n    return rgbToHex(resultRgb[0], resultRgb[1], resultRgb[2]);\n}\n\nexport function extractTextFromHTML(html_string: string) {\n    // Create a temporary DOM element\n    const temp_element = document.createElement('div');\n\n    // Set the innerHTML to our HTML string\n    temp_element.innerHTML = html_string;\n\n    // Extract and return the text content\n    return temp_element.textContent || temp_element.innerText || '';\n}\n\n/**\n * Shuffle the items in array into random order\n * @param array List of items to shuffle\n */\nexport function shuffleArray(array: any[]) {\n    for (let i = array.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [array[i], array[j]] = [array[j], array[i]];\n    }\n    return array;\n}\n\n/**\n * Shuffle the items in array into random order with a specific item as the first\n * @param array List of items to shuffle\n * @param first_index Index of the item in the list to set as first\n */\nexport function shuffleArrayWithFirstItem(array: any[], first_index: number) {\n    // Move the specified item to the beginning\n    const firstItem = array.splice(first_index, 1)[0];\n    array.unshift(firstItem);\n\n    // Shuffle the rest of the array (starting from index 1)\n    for (let i = array.length - 1; i > 1; i--) {\n        const j = Math.floor(Math.random() * (i - 1)) + 1;\n        [array[i], array[j]] = [array[j], array[i]];\n    }\n\n    return array;\n}\n","import { Injectable } from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport { log } from './general';\n\ndeclare global {\n    interface Window {\n        ga: any;\n        gtag: any;\n        dataLayer: any[];\n        debug: boolean;\n    }\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class GoogleAnalyticsService {\n    /** Google Analytics API object */\n    private service: any;\n    /** Application prefix to add to event categories */\n    public app_prefix: string;\n    /** Whether posting analytics events is enabled */\n    public enabled = true;\n    /** Name of the application */\n    public app_name = 'GA_APP';\n\n    /** Last route posted to the API */\n    private last_route: string;\n    /** Store for timer ids */\n    private timers: { [name: string]: number } = {};\n\n    constructor(private title: Title) {}\n\n    public init(tracking_id: string = '') {\n        if (!window.gtag) {\n            window.dataLayer = window.dataLayer || [];\n            (function (w, d, s, l, i) {\n                w[l] = w[l] || [];\n                w[l].push({\n                    'gtm.start': new Date().getTime(),\n                    event: 'gtm.js',\n                });\n                var f = d.getElementsByTagName(s)[0],\n                    j = d.createElement(s) as any,\n                    dl = l != 'dataLayer' ? '&l=' + l : '';\n                j.async = true;\n                j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;\n                f.parentNode.insertBefore(j, f);\n            })(window, document, 'script', 'dataLayer', tracking_id);\n            log('Analytics', 'Service', 'Injected Google Analytics into page');\n        }\n        this.service = window.gtag;\n    }\n\n    public push(obj: Record<string, any>) {\n        window.dataLayer.push(obj);\n    }\n\n    /**\n     * Initialise Google Analytics\n     * @param tracking_id GA Tracking ID\n     */\n    public load(tracking_id: string) {\n        if (!this.enabled) {\n            throw new Error(\n                'Google Analytics needs to be enabled before being initialised'\n            );\n        }\n        if (!this.service) {\n            throw new Error(\n                \"Google Analytics hasn't been installed on this page\"\n            );\n        }\n        log('Analytics', 'Service', `Setup with tracking ID: ${tracking_id}`);\n        this.page('');\n    }\n    /**\n     * Set User ID for the Google Analytics session\n     * @param id Identifier of the User\n     */\n    public setUser(id: string) {\n        if (!this.service) {\n            throw new Error(\n                \"Google Analytics hasn't been installed on this page\"\n            );\n        }\n        if (this.enabled) {\n            this.timeout(\n                `user|${id}`,\n                () => {\n                    log('Analytics', 'Service', `Set user ID: ${id}`);\n                    this.service('set', 'userId', id);\n                    this.event('authentication', 'user-id available');\n                },\n                100\n            );\n        }\n    }\n\n    public send(type: string, value: Record<string, any>) {\n        if (!this.service) {\n            throw new Error(\n                \"Google Analytics hasn't been installed on this page\"\n            );\n        }\n        if (this.enabled) {\n            this.timeout(`end|${type}`, () => {\n                this.push({\n                    ...value,\n                    event: 'event',\n                });\n            });\n        }\n    }\n\n    /**\n     * Post event to Google Analytics API\n     * @param category Event Category\n     * @param action Event Action\n     * @param label Event Label\n     * @param value Event Value\n     */\n    public event(\n        category: string,\n        action: string,\n        label?: string,\n        value?: string\n    ) {\n        if (!this.service) {\n            throw new Error(\n                \"Google Analytics hasn't been installed on this page\"\n            );\n        }\n        if (this.enabled) {\n            this.timeout(\n                `event|${category}|${action}|${label}|${value}`,\n                () => {\n                    const l = label ? ', ' + label : '';\n                    log(\n                        'Analytics',\n                        'Service',\n                        `Event: ${category}, ${action}${l}${\n                            value ? ', ' + value : ''\n                        }`\n                    );\n                    const prefix = this.app_prefix ? this.app_prefix + '_' : '';\n                    this.push({\n                        event: 'event',\n                        category: category,\n                        action: action,\n                        label: label,\n                    });\n                },\n                100\n            );\n        }\n    }\n\n    /**\n     * Post screen change event to Google Analytics API\n     * @param name\n     * @param app_name\n     */\n    public screen(name: string, app_name?: string) {\n        if (!this.service) {\n            throw new Error(\n                \"Google Analytics hasn't been installed on this page\"\n            );\n        }\n        if (name && this.enabled) {\n            this.timeout(\n                `event|${name}|${app_name || this.app_name}`,\n                () => {\n                    log(\n                        'Analytics',\n                        'Service',\n                        `Screen: ${name}${app_name ? ', ' + app_name : ''}`\n                    );\n                    this.push({\n                        event: 'screenview',\n                        appName: app_name || this.app_name,\n                        screenName: name,\n                    });\n                },\n                100\n            );\n        }\n    }\n\n    /**\n     * Post routing event to Google Analytics API\n     * @param route Activated route\n     * @param origin Add origin to routh path\n     */\n    public page(route: string, origin: boolean = false) {\n        if (!this.service) {\n            throw new Error(\n                \"Google Analytics hasn't been installed on this page\"\n            );\n        }\n        if (this.enabled) {\n            this.last_route = route || '/';\n            this.timeout(\n                `page|${route}`,\n                () => {\n                    log('Analytics', 'Service', `Page: ${route}`);\n                    this.push({\n                        event: 'pageview',\n                        url: `${origin ? location.origin : ''}${route}`,\n                    });\n                },\n                100\n            );\n        }\n    }\n\n    /**\n     * Post timing event to Google Analytics API\n     * @param category\n     * @param variable\n     * @param value\n     * @param label\n     */\n    public timing(\n        category: string,\n        variable: string,\n        value: string,\n        label?: string\n    ) {\n        if (!this.service) {\n            throw new Error(\n                \"Google Analytics hasn't been installed on this page\"\n            );\n        }\n        if (this.enabled) {\n            this.timeout(\n                `page|${category}|${variable}|${value}|${label}`,\n                () => {\n                    log(\n                        'Analytics',\n                        'Service',\n                        `Timing: ${category}, ${variable}, ${value}${\n                            label ? ', ' + label : ''\n                        }`\n                    );\n                    this.push({\n                        event: 'timing',\n                        category,\n                        variable,\n                        value,\n                        label,\n                    });\n                },\n                100\n            );\n        }\n    }\n\n    /**\n     * Creates a timeout for the given name used for preventing duplicate events in quick succession\n     * @param name Name of timer\n     * @param fn Timer callback\n     * @param delay Timer delay\n     */\n    private timeout(name: string, fn: () => void, delay: number = 300) {\n        if (this.timers[name]) {\n            clearTimeout(this.timers[name]);\n            delete this.timers[name];\n        }\n        this.timers[name] = <any>setTimeout(() => {\n            if (fn instanceof Function) {\n                fn();\n            }\n            delete this.timers[name];\n        }, delay);\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, Subscription } from 'rxjs';\n\nimport { HashMap } from './types';\nimport { unique } from './general';\n\n/** List of keys that cannot be in a combination by themselves or with each other */\nconst INVALID_STANDALONE_KEYS: string[] = [\n    'control',\n    'shift',\n    'alt',\n    'meta',\n    'os',\n];\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class HotkeysService {\n    /** Map of subjects which store press states of keys */\n    private keydown_states: HashMap<BehaviorSubject<number>> = {};\n    /** Map of obserers for key state subjects */\n    private keydown_observers: HashMap<Observable<number>> = {};\n    /** List of keys at the end of a combination */\n    private combo_end: string[] = [];\n    /** List of registered hotkey combinations */\n    private registered_combos: string[][] = [];\n    /** Counter for the number of keydown events. Used for checking order of key presses */\n    private counter: number = 0;\n    /** Last key code to be pressed */\n    private last_down: string;\n\n    constructor() {\n        window.addEventListener('keydown', (event: KeyboardEvent) => {\n            const code = this.mapKey((event.code || '').toLowerCase());\n            if (this.last_down !== code) {\n                if (!this.keydown_states[code]) {\n                    this.keydown_states[code] = new BehaviorSubject(null);\n                    this.keydown_observers[code] =\n                        this.keydown_states[code].asObservable();\n                }\n                this.keydown_states[code].next(++this.counter);\n                if (this.combo_end.indexOf(code) >= 0) {\n                    event.preventDefault();\n                }\n                this.last_down = code;\n            }\n        });\n\n        window.addEventListener('keyup', (event: KeyboardEvent) => {\n            const code = this.mapKey((event.code || '').toLowerCase());\n            this.keydown_states[code]?.next(null);\n            if (this.last_down === code) {\n                this.last_down = null;\n            }\n        });\n    }\n\n    /**\n     * Listen to the given key combination\n     * @param combo Array of key codes to listen to or a hotkey string e.g. `Alt+Shift+KeyK`\n     * @param next Callback for combination presses\n     */\n    public listen(combo: string | string[], next: () => void): Subscription {\n        combo = combo instanceof Array ? combo : combo.split('+');\n        const combination: string[] = combo.map((i) =>\n            this.mapKey(i.toLowerCase())\n        );\n        if (combination.length > 0 && this.validCombination(combination)) {\n            this.registered_combos.push(combination);\n            const last_key = combination[combination.length - 1];\n            if (!this.keydown_states[last_key]) {\n                this.keydown_states[last_key] = new BehaviorSubject(null);\n                this.keydown_observers[last_key] =\n                    this.keydown_states[last_key].asObservable();\n            }\n            this.updateCombinationEndList();\n            return this.keydown_observers[last_key].subscribe((count) => {\n                if (count) {\n                    const presses: number[] = [];\n                    if (combination.length > 0) {\n                        // Check that keys are pressed\n                        for (const key of combination) {\n                            const state = this.keydown_states[key];\n                            presses.push(state ? state.getValue() || -1 : -1);\n                        }\n                        // Check that keys are pressed in the correct order\n                        for (let i = 0; i < combination.length - 1; i++) {\n                            if (presses[i] > presses[i + 1]) {\n                                return;\n                            }\n                        }\n                    }\n                    const total = presses.reduce(\n                        (a, v) => a + (v > 0 ? 1 : -1),\n                        0\n                    );\n                    if (total >= combination.length) {\n                        next();\n                    }\n                }\n            });\n        }\n        return null;\n    }\n\n    /**\n     * Map key codes with multiple versions to simple form\n     * @param code Code to transform\n     */\n    private mapKey(code: string): string {\n        if (\n            code.indexOf('alt') >= 0 ||\n            code.indexOf('shift') >= 0 ||\n            code.indexOf('control') >= 0\n        ) {\n            return code.replace('left', '').replace('right', '');\n        }\n        return code;\n    }\n\n    /**\n     * Update the list of the last keys in combinations to allow for prevent default actions on pre-existing hotkeys\n     */\n    private updateCombinationEndList(): void {\n        const key_list = [];\n        for (const combo of this.registered_combos) {\n            this.combo_end.push(combo[combo.length - 1]);\n        }\n        this.combo_end = unique(key_list);\n    }\n\n    /**\n     * Checks if the given hotkey combination is allowed and valid\n     * @param combo Array of key codes\n     */\n    private validCombination(combo: string[]): boolean {\n        let non_meta = 0;\n        for (const key of combo) {\n            if (INVALID_STANDALONE_KEYS.indexOf(key) < 0) {\n                non_meta++;\n            }\n        }\n        return non_meta > 0;\n    }\n}\n","const general = {};\n\nconst app = {\n    name: 'Bookings',\n    title: 'PlaceOS',\n    description: 'Bookings UI',\n    short_name: 'PlaceOS',\n    logo: {\n        type: 'img',\n        src: 'assets/logo-light.svg',\n    },\n    logo_dark: {\n        type: 'img',\n        src: 'assets/logo-dark.svg',\n    },\n    general,\n    prevent_space_init: true,\n};\n\n/**\n * ROOT SETTIGNS\n */\nexport const DEFAULT_SETTINGS = {\n    debug: true,\n    composer: {\n        domain: '',\n        route: '/bookings',\n        protocol: '',\n        port: '',\n        use_domain: false,\n        local_login: false,\n    },\n    dont_load_metadata: true,\n    app,\n};\n","// IMPORTANT: THIS FILE IS AUTO GENERATED! DO NOT MANUALLY EDIT OR CHECKIN!\n/* tslint:disable */\nexport const VERSION = {\n    \"dirty\": false,\n    \"raw\": \"8a7c26c\",\n    \"hash\": \"8a7c26c\",\n    \"distance\": null,\n    \"tag\": null,\n    \"semver\": null,\n    \"suffix\": \"8a7c26c\",\n    \"semverString\": null,\n    \"version\": \"1.12.0\",\n    \"time\": 1727776381994\n};\n/* tslint:enable */\n","import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { predictableRandomInt, unique } from '../../../common/src/lib/general';\n\nimport { GuestUser, User } from './user.class';\n\nlet USER_COUNT = 0;\n\ntype HashMap<T = any> = Record<string, T>;\n\nexport let USER_DOMAIN = '@place.tech';\n\nexport function setInternalUserDomain(domain: string) {\n    USER_DOMAIN = domain;\n}\n\nconst USER_EMAILS: string[] = [];\n/* istanbul ignore next */\n/**\n * Generate raw mock data for a user\n * @param id Forced ID for the mock\n * @param name Forced name for the user\n * @param external Whether user is external of the organisation\n */\nexport function generateMockUser(\n    id?: string,\n    name?: string,\n    external?: boolean\n): HashMap {\n    if (!id) {\n        id = `user-${USER_COUNT++}`;\n    }\n    if (!name) {\n        name = `User ${USER_COUNT}`;\n    }\n    if (external === undefined) {\n        external = !(predictableRandomInt(99999) % 2);\n    }\n    const organisation = external ? `Fake Co.` : USER_DOMAIN.split('.')[0];\n    let delegates: string[] = [];\n    const delegate_count = Math.min(\n        predictableRandomInt(4) + 1,\n        USER_EMAILS.length\n    );\n    for (let i = 0; i < delegate_count; i++) {\n        delegates.push(USER_EMAILS[predictableRandomInt(USER_EMAILS.length)]);\n    }\n    delegates = unique(delegates);\n    const email = `${name.split(' ').join('.').toLowerCase()}@${\n        external ? 'not-' : ''\n    }${USER_DOMAIN}`;\n    USER_EMAILS.push(email);\n    return {\n        id,\n        name,\n        first_name: name.split(' ')[0],\n        last_name: name.split(' ')[1],\n        email,\n        phone: `(02) 4567 8901`,\n        visitor: external,\n        organisation: {\n            id: organisation.split(' ').join('.').toLowerCase(),\n            name: organisation,\n        },\n        department: `Department ${predictableRandomInt(10)}`,\n        staff_code: predictableRandomInt(999_999),\n        delegates,\n        image: `${id}.png`,\n    };\n}\n\n/**\n * Generate form fields for the given user\n * @param user User to generate form for\n */\nexport function generateUserForm(user?: User) {\n    if (!user) {\n        throw Error('No user passed');\n    }\n\n    const fields = {\n        name: new FormControl(user.name || '', [Validators.required]),\n        email: new FormControl(user.email || '', [\n            Validators.email,\n            Validators.required,\n        ]),\n        organisation: new FormControl(\n            user.organisation || '',\n            Validators.required\n        ),\n        phone: new FormControl(\n            user.phone || '',\n            Validators.pattern(/^\\+?(\\d[\\d\\s\\-\\(\\)]{5,13}\\d)$/)\n        ),\n        assistance_required: new FormControl(user.assistance_required || false),\n        visit_expected: new FormControl(user.visit_expected ?? true),\n    };\n\n    // Generate form group for the user\n    const form = new FormGroup(fields);\n    return form;\n}\n\nexport function generateGuestForm(\n    user: GuestUser = new GuestUser(),\n    host: string = ''\n) {\n    const fields = {\n        name: new FormControl(user.name || ''),\n        email: new FormControl(user.email || '', [\n            Validators.email,\n            Validators.required,\n        ]),\n        organisation: new FormControl(\n            user.organisation || '',\n            Validators.required\n        ),\n        phone: new FormControl(user.phone || ''),\n        host: new FormControl(host || '', [Validators.required]),\n    };\n    // Generate form group for the guest\n    const form = new FormGroup(fields);\n    return form;\n}\n","import { randomString } from 'libs/common/src/lib/general';\nimport { MapLocation } from './location.class';\nimport { USER_DOMAIN } from './user.utilities';\nimport { Booking } from 'libs/bookings/src/lib/booking.class';\nimport { format, isSameDay } from 'date-fns';\n\nexport interface Attachment {\n    id?: string;\n    name: string;\n    url: string;\n    size?: number;\n    created_at?: number;\n    progress?: number;\n}\n\nexport interface UserComplete extends User {\n    sys_admin?: boolean;\n    support?: boolean;\n}\n\nexport type EventResponseStatus =\n    | 'needsAction'\n    | 'declined'\n    | 'tentative'\n    | 'accepted'\n    | '';\n\nexport class User {\n    /** ID of the user */\n    public readonly id: string;\n    /** Display name of the user */\n    public readonly name: string;\n    /** Email address of the user */\n    public readonly email: string;\n    /** First name of the user */\n    public readonly first_name: string;\n    /** Last name of the user */\n    public readonly last_name: string;\n    /** Username of the user */\n    public readonly username: string;\n    /** Phone number of the user */\n    public readonly phone: string;\n    /** Organisation associated with the user */\n    public readonly organisation: string;\n    /** Details about the user */\n    public readonly notes: string;\n    /** Organisation department of the user */\n    public readonly department: string;\n    /** URL to the user's photo */\n    public readonly photo: string;\n    /** Whether user attendance is required */\n    public readonly required: boolean;\n    /** Whether user is the event organiser */\n    public readonly organizer: boolean;\n    /** Whether the users is expected for an event */\n    public readonly response_status: EventResponseStatus;\n    /** Whether the users is expected for an event */\n    public visit_expected: boolean;\n    /** Whether user has been checked in */\n    public readonly checked_in: boolean;\n    /** Organisational groups that the user belongs */\n    public readonly groups: string[];\n    /** Extra metadata associated with the user */\n    public readonly extension_data: Record<string, any>;\n    /** Whether user is external from the organisation */\n    public readonly is_external: boolean;\n    /** Whether user needs assistance when attending an event */\n    public readonly assistance_required: boolean;\n    /** Whether user is a resource */\n    public readonly resource: boolean;\n\n    constructor(data: Partial<UserComplete> = {}) {\n        this.id = data.id || data.email || `USER::${randomString(8)}`;\n        this.name = data.name || '';\n        this.email = data.email || '';\n        this.first_name = data.first_name || data.name || '';\n        this.last_name = data.last_name || '';\n        this.phone = data.phone || '';\n        this.organisation = data.organisation || '';\n        this.notes = data.notes || '';\n        this.photo = data.photo || '';\n        this.username = data.username || '';\n        this.organizer = !!data.organizer;\n        this.checked_in = !!data.checked_in;\n        this.required = data.required ?? true;\n        this.resource = data.resource ?? false;\n        this.response_status = data.response_status || '';\n        const groups = data.groups || [];\n        this.department = data.department ?? '';\n        if (data.sys_admin) groups.push('placeos_admin');\n        if (data.support) groups.push('placeos_support');\n        if (data.department) groups.push(data.department);\n        this.groups = groups;\n        this.extension_data = data.extension_data || {};\n        this.extension_data.assistance_required =\n            data.assistance_required || this.extension_data.assistance_required;\n        this.is_external = !this.email?.endsWith(`${USER_DOMAIN}`);\n        this.visit_expected = data.visit_expected ?? true;\n        this.assistance_required = !!this.extension_data?.assistance_required;\n        for (const key in data) {\n            if (!(key in this)) this.extension_data[key] = data[key] as any;\n        }\n    }\n}\n\nexport class GuestUser extends User {\n    /** Preferred beverage of the guest */\n    public readonly preferred_beverage: string;\n    /** Whether guest has accepted the terms and conditions */\n    public readonly accepted_terms_conditions: boolean;\n    /** List of links to associated attachments */\n    public readonly attachments: Attachment[];\n    /** Status of the guest attendance */\n    public readonly status: 'pending' | 'approved' | 'declined';\n    /** Booking Associated with the guest */\n    public readonly booking?: Booking;\n\n    constructor(data: Partial<GuestUser> = {}) {\n        super(data);\n        this.preferred_beverage = data.preferred_beverage || '';\n        this.accepted_terms_conditions =\n            data.accepted_terms_conditions || false;\n        this.attachments =\n            data.extension_data?.attachments || data.attachments || [];\n        this.status = data.booking?.approved\n            ? 'approved'\n            : data.booking?.rejected\n              ? 'declined'\n              : data.extension_data?.status || data.status || 'pending';\n        this.booking = data.booking;\n        this.extension_data.event = (data as any).event_metadata;\n    }\n}\n\nexport interface WorktimePreference {\n    /* Index of the day of the week. `0` being Sunday */\n    day_of_week: 0 | 1 | 2 | 3 | 4 | 5 | 6;\n    blocks: WorktimeBlock[];\n}\n\nexport interface WorktimeBlock {\n    /* Start time of work hours. e.g. `7.5` being 7:30AM */\n    start_time: number;\n    /* End time of work hours. e.g. `18.5` being 6:30PM */\n    end_time: number;\n    /** Name of the location the work is being performed at */\n    location?: string;\n}\n\nexport class StaffUser extends User {\n    /** Number associated with the user's access card */\n    public readonly card_number: string;\n    /** ID of the user */\n    public readonly staff_id: string;\n    /** Whether user is logged in */\n    public readonly is_logged_in: boolean;\n    /** Default worktime preferences for the user */\n    public readonly work_preferences: WorktimePreference[];\n    /** Overrides of the worktime preferences for the user */\n    public readonly work_overrides: Record<string, WorktimePreference>;\n\n    public get location() {\n        return this.location_time(Date.now());\n    }\n\n    public work_preference(datetime: number) {\n        if (!datetime) datetime = Date.now();\n        const date = new Date(datetime);\n        const day = date.getDay();\n        const date_string = format(date, 'yyyy-MM-dd');\n        if (this.work_overrides[date_string]?.blocks?.length) {\n            for (const block of this.work_overrides[date_string].blocks) {\n                const start = block.start_time;\n                const end = block.end_time;\n                if (\n                    start <= date.getHours() + date.getMinutes() / 60 &&\n                    end >= date.getHours() + date.getMinutes() / 60\n                ) {\n                    return block;\n                }\n            }\n        }\n        for (const pref of this.work_preferences) {\n            if (pref.day_of_week === day && pref.blocks?.length) {\n                for (const block of pref.blocks) {\n                    if (\n                        block.start_time <=\n                            date.getHours() + date.getMinutes() / 60 &&\n                        block.end_time >=\n                            date.getHours() + date.getMinutes() / 60\n                    ) {\n                        return block;\n                    }\n                }\n            }\n        }\n    }\n\n    public location_time(datetime: number = Date.now()) {\n        return this.work_preference(datetime)?.location || 'wfo';\n    }\n\n    public get location_name() {\n        return this.location_name_time();\n    }\n\n    public location_name_time(datetime: number = Date.now()) {\n        if (!datetime) datetime = Date.now();\n        const location = this.location_time(datetime);\n        const in_hours = this.in_hours_time(datetime);\n        if (location.includes('w') && !in_hours) {\n            return 'Outside working hours';\n        }\n        switch (location) {\n            case 'wfh':\n                return 'Working from Home';\n            case 'wfo':\n                return 'Working from Office';\n            case 'ooo':\n                return 'Out of Office';\n            case 'aol':\n                return 'Away on Leave';\n            default:\n                return 'Unknown';\n        }\n    }\n\n    public outsideHours(datetime: number = Date.now()) {\n        const location = this.location_time(datetime);\n        const in_hours = this.in_hours_time(datetime);\n        return location.includes('w') && !in_hours;\n    }\n\n    public get in_hours() {\n        return this.in_hours_time(Date.now());\n    }\n\n    public location_icon(datetime: number) {\n        if (!datetime) datetime = Date.now();\n        const location = this.location_time(datetime);\n        const in_hours = this.in_hours_time(datetime);\n        if (location === 'wfh' && in_hours) return 'home';\n        if (location === 'wfo' && in_hours) return 'business';\n        return 'event_busy';\n    }\n\n    public in_hours_time(datetime: number = Date.now()) {\n        const block = this.work_preference(datetime);\n        return !!block;\n    }\n\n    constructor(data: Partial<StaffUser> = {}) {\n        super(data);\n        this.card_number = data.card_number || '';\n        this.staff_id = data.staff_id || '';\n        this.is_logged_in = !!data.is_logged_in;\n        this.work_preferences = data.work_preferences || [];\n        this.work_overrides = data.work_overrides || ({} as any);\n    }\n}\n","import { showUser } from '@placeos/ts-client';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { delay, map, retry } from 'rxjs/operators';\n\nimport { StaffUser } from '../../../users/src/lib/user.class';\n\nconst EMPTY_USER = new StaffUser();\n\nconst _current_user = new BehaviorSubject<StaffUser>(null);\nconst _change = new BehaviorSubject(0);\n\nexport const current_user = _current_user.asObservable();\n\ndeclare let jest;\n\nsetTimeout(() => {\n    try {\n        if (jest) return;\n    } catch {}\n    combineLatest([showUser('current'), _change])\n        .pipe(\n            delay(1000),\n            retry(10),\n            map(([i]) => new StaffUser(i as any)),\n        )\n        .subscribe((user) => _current_user.next(user));\n}, 300);\n\nexport function reloadUserData() {\n    setTimeout(async () => {\n        const user = await showUser('current').toPromise();\n        _current_user.next(new StaffUser(user as any));\n    }, 300);\n}\n\n/** Get the current user details */\nexport function currentUser() {\n    return _current_user.getValue() || EMPTY_USER;\n}\n","import { Injectable, Optional } from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { showMetadata, updateMetadata } from '@placeos/ts-client';\nimport { format, isSameDay } from 'date-fns';\nimport { first } from 'rxjs/operators';\n\nimport { log, getItemWithKeys, setAppName } from './general';\nimport { DEFAULT_SETTINGS } from './settings';\nimport { HashMap } from './types';\nimport { AsyncHandler } from './async-handler.class';\n\nimport { VERSION } from './version';\nimport { currentUser, current_user } from './user-state';\nimport { GoogleAnalyticsService } from './google-analytics.service';\n\ndeclare global {\n    interface Window {\n        debug: boolean;\n        application: HashMap;\n    }\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class SettingsService extends AsyncHandler {\n    /** Name of the application */\n    private _app_name = 'PlaceOS';\n    /** List of override settings in order of priority */\n    private _overrides = new BehaviorSubject<HashMap[]>([]);\n    /** User's personal settings */\n    private _user_settings = new BehaviorSubject<HashMap>({});\n    /** Mapping of behaviour subjects */\n    private _subjects: HashMap<BehaviorSubject<any>> = {};\n    /** Mapping of observables */\n    private _observables: HashMap<Observable<any>> = {};\n    /** Mapping of pending settings */\n    private _pending_settings: HashMap = {};\n\n    /**\n     * @hidden\n     */\n    public set overrides(value: HashMap[]) {\n        this._overrides.next(value);\n        this._applyCssVariables();\n    }\n\n    /** Get observable for key */\n    public listen<T = any>(name: string): Observable<T> {\n        if (!this._observables[name]) {\n            this._subjects[name] = new BehaviorSubject<T>(null);\n            this._observables[name] = this._subjects[name].asObservable();\n        }\n        return this._observables[name];\n    }\n\n    /** Update observable value for key */\n    public post<T>(name: string, value: T): void {\n        if (!this._observables[name]) {\n            this._subjects[name] = new BehaviorSubject<T>(null);\n            this._observables[name] = this._subjects[name].asObservable();\n        }\n        this._subjects[name].next(value);\n    }\n\n    public value<T = any>(name: string): T {\n        return !this._observables[name]\n            ? null\n            : this._subjects[name].getValue();\n    }\n\n    /** Page title */\n    public get title() {\n        return this._title.getTitle();\n    }\n    public set title(value: string) {\n        this._title.setTitle(\n            `${value} | ${this.get('app.name') || this._app_name}`\n        );\n        const tracking_id = this.get('app.analytics.tracking_id');\n        if (!tracking_id) return;\n        this._analytics?.send('pagename', { title: value });\n    }\n\n    constructor(\n        private _title: Title,\n        @Optional() private _analytics: GoogleAnalyticsService\n    ) {\n        super();\n        const now = new Date();\n        const time = new Date(VERSION.time);\n        const built = isSameDay(now, time)\n            ? `Today at ${format(time, 'h:mma')}`\n            : format(time, 'do MMM yyyy, h:mma');\n        log('CORE', `${VERSION.semver}`, null, 'debug', true);\n        log('APP', `${VERSION.hash} | Built: ${built}`, null, 'debug', true);\n        this.init();\n    }\n\n    /**\n     * Initialise the settings\n     */\n    public async init() {\n        if (this.get('debug')) window.debug = true;\n        if (this.get('app')?.name) {\n            this._app_name = this.get('app').name;\n        }\n        this._app_name =\n            location.pathname.replace(/[\\\\\\/]/g, '').trim() || this._app_name;\n        setAppName(this._app_name.split('-').join('_').toUpperCase());\n        log('Settings', 'Successfully loaded settings');\n        this._initialised.next(true);\n        if (window.debug) {\n            if (!window.application) window.application = {};\n            window.application.settings = this;\n        }\n        this.subscription(\n            'user_settings',\n            this._user_settings.subscribe((_) => this._applyUserSettings(_))\n        );\n        const user = await current_user.pipe(first((_) => !!_)).toPromise();\n        const data = await showMetadata(user.id, 'settings').toPromise();\n        this._user_settings.next(data.details || {});\n        this._initDarkMode();\n        this._applyTheme();\n        this._setFontSize();\n    }\n\n    /** Whether settings service has initialised */\n    public get app_name() {\n        return this._app_name;\n    }\n\n    public get time_format(): string {\n        return this.get('app.use_24_hour_time') ? 'HH:mm' : 'h:mm a';\n    }\n\n    /**\n     * Get a setting\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public get<T = any>(key: string): T {\n        const keys = key.split('.');\n        if (keys[0] !== 'app') {\n            return (\n                getItemWithKeys(keys, this._pending_settings) ??\n                getItemWithKeys(keys, this._user_settings.getValue()) ??\n                getItemWithKeys(keys, DEFAULT_SETTINGS)\n            );\n        }\n        const override_settings = [...this._overrides.getValue()];\n        for (const override of override_settings) {\n            const value = getItemWithKeys(keys.slice(1), override);\n            if (value != null) {\n                return value;\n            }\n        }\n        return getItemWithKeys(keys, DEFAULT_SETTINGS);\n    }\n\n    public saveUserSetting<T>(name: string, value: T) {\n        this._pending_settings[name] = value;\n        if (name === 'dark_mode') this.setTheme(value ? 'dark' : '');\n        if (name === 'font_size') this._setFontSize();\n        this.timeout('save_settings', () => this._savePendingChanges(), 5000);\n    }\n\n    public overrideCssVariable(\n        key: string,\n        value: string,\n        important: boolean = false\n    ) {\n        let element = document.getElementById(`css-var-overrides+${key}`);\n        if (!element) {\n            element = document.createElement('style');\n            element.id = `css-var-overrides+${key}`;\n            document.head.appendChild(element);\n        }\n        element.innerText = `html, body { --${key}: ${value} ${\n            important ? '!important' : ''\n        }}`;\n    }\n\n    public setTheme(theme: string) {\n        const current_theme = this.get('theme');\n        if (current_theme === theme) return;\n        this.saveUserSetting('theme', theme);\n        this._applyTheme();\n    }\n\n    private _applyCssVariables() {\n        const variable_map = this.get('app.css_variables') || {};\n        let css_string = 'body { ';\n        for (const key in variable_map) {\n            css_string += `--${key}: ${variable_map[key]}; `;\n        }\n        css_string += '}';\n        let element = document.getElementById('css-var-overrides');\n        if (!element) {\n            element = document.createElement('style');\n            element.id = 'css-var-overrides';\n            document.head.appendChild(element);\n        }\n        element.innerText = css_string;\n    }\n\n    private async _savePendingChanges() {\n        const user = currentUser();\n        if (!user?.id || !Object.keys(this._pending_settings).length) return;\n        await updateMetadata(user.id, {\n            name: 'settings',\n            description: '',\n            details: {\n                ...this._user_settings.getValue(),\n                ...this._pending_settings,\n            },\n        }).toPromise();\n        this._user_settings.next({\n            ...this._user_settings.getValue(),\n            ...this._pending_settings,\n        });\n        this._pending_settings = {};\n    }\n\n    private async _applyUserSettings(settings: HashMap) {\n        if (settings.font_size) {\n        }\n    }\n\n    private _setFontSize() {\n        if (!this.get('font_size')) return;\n        this.overrideCssVariable('font-size', `${this.get('font_size')}px`);\n    }\n\n    private _applyTheme() {\n        const theme = this.get('theme');\n        const class_list = document.body.classList.value.split(' ');\n        for (const item of class_list) {\n            if (item.startsWith('theme-')) {\n                document.body.classList.remove(item);\n            }\n        }\n        if (theme) {\n            document.body.classList.add(`theme-${theme}`);\n        } else {\n            document.body.classList.remove(`theme-${theme}`);\n        }\n    }\n\n    private _initDarkMode() {\n        if (this.get('theme') || true) return;\n        const os_dark = window?.matchMedia\n            ? window?.matchMedia('(prefers-color-scheme: dark)')?.matches\n            : false;\n        this.setTheme(os_dark ? 'dark' : '');\n    }\n}\n","import { getItemWithKeys } from 'libs/common/src/lib/general';\n\nexport interface OrganisationComplete extends Organisation {\n    settings?: Record<string, any>;\n}\n\nexport class Organisation {\n    /** PlaceOS zone id of the building */\n    public readonly id: string;\n    /** Name of the building zone */\n    public readonly name: string;\n    /** Description for the Organisation */\n    public readonly description: string;\n    /** Tags for the Organisation */\n    public readonly tags: string[];\n    /** Count for the Organisation */\n    public readonly count: number;\n    /** Capacity for the Organisation */\n    public readonly capacity: number;\n    /** PlaceOS bindings for applications */\n    public readonly bindings: Record<string, string>;\n    /** Map of custom settings for the building */\n    private _settings: Record<string, any>;\n\n    constructor(raw_data: Partial<OrganisationComplete> = {}) {\n        this.id = raw_data.id || '';\n        this.name = raw_data.name || '';\n        this.description = raw_data.description || '';\n        this.tags = raw_data.tags || [];\n        this.count = raw_data.count || 0;\n        this.capacity = raw_data.capacity || 0;\n        this.bindings = raw_data.bindings || {};\n        this._settings = raw_data.settings || {};\n    }\n\n    /**\n     * Get a custom organisation setting\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public setting(key: string): any {\n        const keys = key.split('.');\n        const value = getItemWithKeys(keys, this._settings);\n        return value;\n    }\n}\n","import { MatSnackBar, MatSnackBarConfig } from '@angular/material/snack-bar';\n\nlet _service: MatSnackBar;\nlet _disable_logging = false;\n\ndeclare let jest: any;\n\nexport function setNotifyOutlet(\n    snackbar: MatSnackBar,\n    disable_logging = false\n) {\n    _service = snackbar;\n    _disable_logging = disable_logging;\n}\n\n/**\n * Create notification popup\n * @param type CSS Class to add to the notification\n * @param message Message to display on the notificaiton\n * @param action Display text for the callback action\n * @param on_action Callback of action on the notification\n * @param config Configuration details to pass to the snackbar\n */\nexport function notify(\n    type: string,\n    message: string,\n    action: string = 'OK',\n    on_action?: () => void,\n    config: Partial<MatSnackBarConfig> = {}\n): void {\n    if (!_service) {\n        return (\n            !_disable_logging &&\n            console.warn(\"Snackbar service hasn't been initialised\")\n        );\n    }\n    const snackbar_ref = _service.open(message, action, {\n        panelClass: [type],\n        duration: 5000,\n        ...config,\n    });\n    if (action) {\n        on_action = on_action || (() => snackbar_ref.dismiss());\n        snackbar_ref.onAction().subscribe(() => on_action());\n    }\n}\n\n/**\n * Create success notification popup\n * @param msg Message to display on the notificaiton\n * @param action Display text for the callback action\n * @param on_action Callback of action on the notification\n * @param config Configuration details to pass to the snackbar\n */\nexport function notifySuccess(\n    msg: string,\n    action?: string,\n    on_action?: () => void,\n    config: Partial<MatSnackBarConfig> = {}\n): void {\n    !_disable_logging && console.debug(msg);\n    if (typeof msg !== 'string') msg = 'Success';\n    notify('success', msg, action, on_action, config);\n}\n\n/**\n * Create error notification popup\n * @param msg Message to display on the notificaiton\n * @param action Display text for the callback action\n * @param on_action Callback of action on the notification\n * @param config Configuration details to pass to the snackbar\n */\nexport function notifyError(\n    msg: string,\n    action?: string,\n    on_action?: () => void,\n    config: Partial<MatSnackBarConfig> = {}\n): void {\n    !_disable_logging && console.debug(msg);\n    if (typeof msg !== 'string')\n        msg =\n            (msg as any)?.error || (msg as any)?.message || 'An error occurred';\n    notify('error', msg, action, on_action, config);\n}\n\n/**\n * Create warning notification popup\n * @param msg Message to display on the notificaiton\n * @param action Display text for the callback action\n * @param on_action Callback of action on the notification\n * @param config Configuration details to pass to the snackbar\n */\nexport function notifyWarn(\n    msg: string,\n    action?: string,\n    on_action?: () => void,\n    config: Partial<MatSnackBarConfig> = {}\n): void {\n    !_disable_logging && console.debug(msg);\n    notify('warn', msg, action, on_action, config);\n}\n\n/**\n * Create info notification popup\n * @param msg Message to display on the notificaiton\n * @param action Display text for the callback action\n * @param on_action Callback of action on the notification\n * @param config Configuration details to pass to the snackbar\n */\nexport function notifyInfo(\n    msg: string,\n    action?: string,\n    on_action?: () => void,\n    config: Partial<MatSnackBarConfig> = {}\n): void {\n    !_disable_logging && console.debug(msg);\n    notify('info', msg, action, on_action, config);\n}\n","/** Building Level data */\nexport class BuildingLevel {\n    /** ID of the building level zone */\n    public readonly id: string;\n    /** ID of the building zone associated with the level */\n    public readonly parent_id: string;\n    /** Name of the level */\n    public readonly name: string;\n    /** Display name */\n    public readonly display_name: string;\n    /** Capacity for the level */\n    public readonly capacity: number;\n    /** Number or letter representing the level */\n    public readonly number: string;\n    /** URL of the map associated with the level */\n    public readonly map_id: string;\n    /** URL of the map associated with the level */\n    public readonly tags: string[];\n    /** Settings overrides associated with the level */\n    public readonly settings: Record<string, any> = {};\n    /** List of image URLs for the level */\n    public readonly images: string[];\n    public readonly location: string;\n    /** List of points of interest for the level */\n    public readonly locations: readonly { id: string; name: string }[];\n\n    constructor(_data: Partial<BuildingLevel> = {}) {\n        this.id = _data.id || '';\n        this.parent_id = _data.parent_id || '';\n        this.name = _data.name || '';\n        this.display_name = _data.display_name || '';\n        this.map_id = _data.map_id || '';\n        this.capacity = _data.capacity || 0;\n        this.location = _data.location || '';\n        this.locations = _data.locations || [];\n        this.tags = _data.tags || [];\n        this.images = _data.images || [];\n        const parts = this.display_name.split(' ');\n        this.number = (\n            (parts.length >= 2\n                ? parts[parts.length - 1]\n                : this.display_name[0]\n            )?.toUpperCase() || ''\n        ).substring(0, 2);\n    }\n}\n","import { BuildingLevel } from './level.class';\n\ninterface Identity {\n    id: string;\n    name: string;\n}\ninterface RoomConfiguration {\n    id: string;\n    name?: string;\n    description?: string;\n    capacity?: number;\n}\n\nexport interface IBuildingRoleUser {\n    name: string;\n    email: string;\n    phone: string;\n}\n\nexport interface LockerMap {\n    [zone: string]: {\n        [area: string]: {\n            [type: string]: (string | boolean)[][];\n        };\n    };\n}\n\nexport interface ICoordinates {\n    longitude: number;\n    latitude: number;\n}\n\nexport interface LevelFeature {\n    id: string;\n    level_id: string;\n    name: string;\n}\n\nexport interface BookingRuleDetails {\n    /** List of booking rules details for the building */\n    readonly rules: readonly string[];\n    /** Custom booking rules for the map */\n    readonly map_rules?: readonly string[];\n    /** Contact email address for the building */\n    readonly contact?: string;\n    /** Information string to display before the rule listings */\n    readonly info?: string;\n}\n\nexport interface BuildingComplete extends Building {\n    settings: Record<string, any>;\n    locker_structure: Record<string, any>;\n    roles: Record<string, any>;\n    zone: string;\n    location: string;\n    neighbourhoods: Record<string, any>;\n}\n\nexport class Building {\n    /** PlaceOS zone id of the building */\n    public readonly id: string;\n    /** PlaceOS zone id of the building */\n    public readonly parent_id: string;\n    /** Name of the building zone */\n    public readonly name: string;\n    /** Name to display */\n    public readonly display_name: string;\n    /** Engine Zone ID for the building */\n    public readonly zone_id: string;\n    /** Organisation Code for the building */\n    public readonly code: string;\n    /** Geographical address of the building */\n    public readonly address: string;\n    /** IANA timezone string for building */\n    public readonly timezone: string;\n    /** ID of space that temporarily holds new meetings */\n    public readonly holding_bay: string;\n    /** ID of the space for assigning new visitor bookings to */\n    public readonly visitor_space: string;\n    /** Details about the booking rules for the building */\n    public readonly booking_details: BookingRuleDetails;\n    /** Number of hour before a booking catering is restricted */\n    public readonly catering_restricted_from: number;\n    /** Currency code for the country assoicated with the building */\n    public readonly currency: string;\n    /** List of available extras for the building */\n    public readonly extras: readonly Identity[];\n    /** List of available extra equipment for loan at the building */\n    public readonly loan_items: readonly Identity[];\n    /** List of available levels for the building */\n    public readonly levels: readonly BuildingLevel[];\n    /** List of zones associated with the building */\n    public readonly zones: readonly string[];\n    /** Searchable map features */\n    public readonly searchables: readonly LevelFeature[];\n    /** List of available room configurations for the building */\n    public readonly room_configurations: readonly RoomConfiguration[];\n    /** Start and end hours catering can be delivered */\n    public readonly catering_hours: { start: number; end: number };\n    /** PlaceOS bindings for applications */\n    public readonly bindings: Record<string, string>;\n    /** List of image URLs for the building */\n    public readonly images: string[];\n    /** Identifier of building in relation to mapping */\n    public readonly map_id: string;\n\n    public readonly orientations: Record<string, number>;\n    public readonly attributes: readonly Identity[];\n    /** Globe coordiates for the build */\n    public location: string;\n    /** Map of roles and list of the associated users */\n    private _roles: Record<string, IBuildingRoleUser[]>;\n    /** Map of the locker ID arrays */\n    private _lockers: LockerMap;\n    /** Map of important system ids for the building */\n    private _systems: Record<string, string>;\n    /** Map of important phone numbers for the building */\n    private _phone_numbers: Record<string, string>;\n\n    constructor(raw_data: Partial<BuildingComplete> = {}) {\n        this.id = raw_data.id || '';\n        this.parent_id = raw_data.parent_id || '';\n        this.name = raw_data.name || '';\n        const settings = raw_data.settings || {};\n        this.display_name = raw_data.display_name;\n        this.images = this.images || [];\n        const disc_info = settings.discovery_info || settings;\n        this.zone_id = raw_data.zone_id || raw_data.zone;\n        this.extras = (raw_data.extras || disc_info.extras || []).map((i) => ({\n            id: i.extra_id || i.id,\n            name: i.extra_name || i.name,\n        }));\n        this.loan_items = (\n            raw_data.loan_items ||\n            disc_info.loan_items ||\n            []\n        ).map((i) => ({\n            id: i.extra_id || i.id,\n            name: i.extra_name || i.name,\n        }));\n        this.levels = (raw_data.levels || disc_info.levels || []).map(\n            (i) => new BuildingLevel({ ...i, building_id: this.id })\n        );\n        this._roles = raw_data.roles || disc_info.roles || {};\n        this._lockers =\n            raw_data.lockers ||\n            raw_data.locker_structure ||\n            disc_info.locker_structure ||\n            {};\n        this._systems = raw_data.systems || disc_info.systems || {};\n        this._phone_numbers =\n            raw_data.phone_numbers || disc_info.phone_numbers || {};\n        this.location = raw_data.location || disc_info.location || '0,0';\n        this.room_configurations =\n            raw_data.room_configurations || disc_info.room_configurations || [];\n        this.attributes = raw_data.attributes || disc_info.attributes || [];\n        const searchables = [];\n        if (raw_data.neighbourhoods) {\n            for (const lvl in raw_data.neighbourhoods) {\n                if (lvl in raw_data.neighbourhoods) {\n                    const lvl_features = raw_data.neighbourhoods[lvl] || {};\n                    for (const feature in lvl_features) {\n                        if (feature in lvl_features) {\n                            searchables.push({\n                                id: lvl_features[feature],\n                                name: feature,\n                                level_id: lvl,\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        this.bindings = raw_data.bindings || {};\n        this.searchables = searchables;\n        this.map_id = raw_data.map_id || '';\n        this.timezone =\n            raw_data.timezone || disc_info.timezone || settings.timezone || '';\n        this.catering_hours = raw_data.catering_hours ||\n            disc_info.catering_hours ||\n            settings.catering_hours || { start: 7, end: 20 };\n        this.visitor_space =\n            raw_data.visitor_space ||\n            disc_info.visitor_space ||\n            settings.visitor_space ||\n            '';\n        this.holding_bay =\n            raw_data.holding_bay ||\n            disc_info.holding_bay ||\n            settings.holding_bay ||\n            '';\n        this.code = raw_data.code || disc_info.code || settings.code || '';\n        this.address =\n            raw_data.address || disc_info.address || settings.address || '';\n        this.orientations =\n            raw_data.orientations ||\n            disc_info.orientations ||\n            settings.orientations ||\n            {};\n        this.booking_details =\n            raw_data.booking_details ||\n            disc_info.booking_details ||\n            settings.booking_details ||\n            null;\n        this.catering_restricted_from =\n            raw_data.catering_restricted_from ||\n            disc_info.catering_restricted_from ||\n            settings.catering_restricted_from ||\n            -1440;\n        this.currency =\n            raw_data.currency ||\n            disc_info.currency ||\n            settings.currency ||\n            'USD';\n    }\n\n    /**\n     * Get list of users with the associated role\n     * @param name Role to find users for\n     */\n    public role(name: string): IBuildingRoleUser[] {\n        return [...(this._roles[name] || [])];\n    }\n    /**\n     * Get list of the names of available user role lists\n     */\n    public get role_names(): string[] {\n        return Object.keys(this._roles).filter((i) => i in this._roles);\n    }\n    /** Map of the locker ID arrays */\n    public get lockers(): LockerMap {\n        return { ...(this._lockers || {}) };\n    }\n    /** Map of important system ids for the building */\n    public get systems(): Record<string, string> {\n        return { ...(this._systems || {}) };\n    }\n    /** Map of important phone numbers for the building */\n    public get phone_numbers(): Record<string, string> {\n        return { ...(this._phone_numbers || {}) };\n    }\n\n    /**\n     * Get search map feature for the given level ID\n     * @param level_id ID of level to grab features for\n     */\n    public featuresForLevel(level_id: string): LevelFeature[] {\n        return (this.searchables || []).filter((i) => i.level_id === level_id);\n    }\n}\n","export class Region {\n    /** PlaceOS zone id of the building */\n    public readonly id: string;\n    /** Name of the building zone */\n    public readonly name: string;\n    /** Name to display */\n    public readonly display_name: string;\n    /** IANA timezone string for building */\n    public readonly timezone: string;\n    /** List of image URLs for the building */\n    public readonly images: string[];\n    /** PlaceOS bindings for applications */\n    public readonly bindings: Record<string, string>;\n    /** Address of the region */\n    public readonly address: string;\n\n    constructor(_data: Partial<Region>) {\n        this.id = _data.id || '';\n        this.name = _data.name || '';\n        this.display_name = _data.display_name || '';\n        this.timezone = _data.timezone || '';\n        this.images = _data.images || [];\n        this.bindings = _data.bindings || {};\n        this.address = _data.address || '';\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\nimport {\n    EncryptionLevel,\n    PlaceMetadata,\n    PlaceZone,\n    authority,\n    isFixedDevice,\n    isMock,\n    onlineState,\n    querySettings,\n    queryZones,\n    showMetadata,\n} from '@placeos/ts-client';\nimport { BehaviorSubject, combineLatest, of } from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    filter,\n    first,\n    map,\n    shareReplay,\n} from 'rxjs/operators';\n\nimport { notifyError } from 'libs/common/src/lib/notifications';\nimport { SettingsService } from 'libs/common/src/lib/settings.service';\nimport { RoomConfiguration } from 'libs/common/src/lib/room-configuration.interface';\n\nimport { Building } from './building.class';\nimport { BuildingLevel } from './level.class';\nimport { Organisation } from './organisation.class';\nimport { Region } from './region.class';\nimport { AsyncHandler, log, unique } from '@placeos/common';\n\nimport * as yaml from 'js-yaml';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class OrganisationService {\n    /** Subject which stores the initialised state of the object */\n    protected readonly _initialised = new BehaviorSubject<boolean>(false);\n    /** Observable of the initialised state of the object */\n    public readonly initialised = this._initialised.asObservable();\n    private readonly _regions = new BehaviorSubject<Region[]>([]);\n    private readonly _active_region = new BehaviorSubject<Region>(null);\n    private readonly _buildings = new BehaviorSubject<Building[]>([]);\n    private readonly _active_building = new BehaviorSubject<Building>(null);\n    private readonly _levels = new BehaviorSubject<BuildingLevel[]>([]);\n    private readonly _loaded_data: string[] = [];\n\n    public readonly app_key = `${(\n        this._service.app_name || 'workplace'\n    ).toLowerCase()}_app`;\n    /** Observable for the list of regions */\n    public readonly region_list = this._regions.asObservable();\n    /** Observable for the list of buildings */\n    public readonly building_list = this._buildings.asObservable();\n    /** Observable for the list of levels */\n    public readonly level_list = this._levels.asObservable();\n    /** Observable for the currently active region */\n    public readonly active_region = this._active_region.asObservable();\n    /** Observable for the currently active building */\n    public readonly active_building = this._active_building.asObservable();\n    /** Observable for the buildings associated with the currently active region */\n    public readonly active_buildings = combineLatest([\n        this._buildings,\n        this._active_region,\n    ]).pipe(\n        map(([_, region]) =>\n            region ? this.buildingsForRegion(region) : this.buildings,\n        ),\n    );\n    /** Observable for the levels associated with the currently active building */\n    public readonly active_levels = combineLatest([\n        this._levels,\n        this._active_building,\n    ]).pipe(\n        map(([_, bld]) => (bld ? this.levelsForBuilding(bld) : [])),\n        shareReplay(1),\n    );\n    /** Organisation data for the application */\n    private _organisation: Organisation;\n    /** Mapping of organisation settings overrides */\n    private _settings: Record<string, any>[] = [];\n    /** Mapping of regions to settings overrides */\n    private _region_settings: Record<string, Record<string, any>> = {};\n    /** Mapping of buildings to settings overrides */\n    private _building_settings: Record<string, Record<string, any>> = {};\n\n    /** Mapping of organisation settings overrides */\n    public get settings() {\n        return this._settings;\n    }\n\n    /** Mapping of regions to settings overrides */\n    public get region_settings() {\n        return this._region_settings;\n    }\n\n    /** Mapping of buildings to settings overrides */\n    public get building_settings() {\n        return this._building_settings;\n    }\n\n    /** Mapping region settings overrides */\n    public regionSettings(id: string = ''): Record<string, any> {\n        const region = this._active_region.getValue();\n        if (!id && region) id = region?.id;\n        return this._region_settings ? this._region_settings[id] || {} : {};\n    }\n\n    /** Mapping building settings overrides */\n    public buildingSettings(bld_id: string = ''): Record<string, any> {\n        if (!bld_id && this.building) {\n            bld_id = this.building?.id || this.buildings[0]?.id;\n        }\n        return this._building_settings\n            ? this._building_settings[bld_id] || {}\n            : {};\n    }\n\n    /** Organisation data for the application */\n    public get organisation(): Organisation {\n        return this._organisation;\n    }\n\n    /** List of available regions */\n    public get regions(): Region[] {\n        return this._regions.getValue();\n    }\n\n    /** Currently active region */\n    public get region(): Region {\n        return this._active_region.getValue();\n    }\n    public set region(item: Region) {\n        this.setRegion(item);\n    }\n\n    public async setRegion(item: Region) {\n        if (!item) return;\n        this._active_region.next(item);\n        await this.loadRegionData(item);\n        this._setBuildingFromTimezone();\n        if (\n            this.building?.parent_id !== item.id &&\n            this.buildingsForRegion(item).length\n        ) {\n            this.building = this.buildingsForRegion(item)[0];\n        } else this._updateSettingOverrides();\n    }\n\n    /** List of available buildings */\n    public get buildings(): Building[] {\n        return this._buildings.getValue() || [];\n    }\n\n    /** Currently active building */\n    public get building(): Building {\n        return this._active_building.getValue();\n    }\n    public set building(bld: Building) {\n        if (!bld) return;\n        this._active_building.next(bld);\n        if (!this._service.get('dont_load_metadata')) {\n            this.loadBuildingData(bld).then(() =>\n                this._updateSettingOverrides(),\n            );\n        }\n        if (this.regions.length && this.region?.id !== bld.parent_id) {\n            this.region = this.regions.find(\n                (_) => _.id === this.building.parent_id,\n            );\n        }\n    }\n\n    public get timezone() {\n        return Intl.DateTimeFormat().resolvedOptions().timeZone;\n    }\n\n    public get currency_code(): string {\n        return (\n            this._service.get('app.currency') ||\n            this.building?.currency ||\n            'USD'\n        );\n    }\n\n    /** Get binding value from the building/organisation */\n    public binding(name: string) {\n        return (\n            this.building?.bindings[name] || this._organisation?.bindings[name]\n        );\n    }\n\n    /** Get building by id */\n    public find(id: string) {\n        return this.buildings.find((i) => i.id === id);\n    }\n\n    /** List of available levels */\n    public get levels(): BuildingLevel[] {\n        return this._levels.getValue();\n    }\n\n    constructor(\n        private _service: SettingsService,\n        private _router: Router,\n    ) {\n        onlineState()\n            .pipe(first((_) => _))\n            .subscribe(() => setTimeout(() => this.init(), 1000));\n        combineLatest([this.active_region, this.active_building])\n            .pipe(\n                filter(([_, bld]) => !!bld),\n                debounceTime(300),\n            )\n            .subscribe(() => this._updateSettingOverrides());\n    }\n\n    /**\n     * Get level with a matching ID\n     * @param id_list List of IDs to find a match\n     */\n    public levelWithID(id_list: string[]): BuildingLevel {\n        return this.levels.find((lvl) => id_list?.includes(lvl.id));\n    }\n\n    /**\n     * Get list of levels for the given building\n     * @param bld Building to list levels for\n     */\n    public levelsForBuilding(bld: Building = this.building): BuildingLevel[] {\n        return this.levels.filter(\n            (lvl) => lvl.parent_id && lvl.parent_id === bld?.id,\n        );\n    }\n\n    /**\n     * Get list of buildings for the given region\n     * @param region Region to list buildings for\n     */\n    public buildingsForRegion(region: Region = this.region): Building[] {\n        return this.buildings.filter((bld) => bld.parent_id === region?.id);\n    }\n\n    /**\n     * Get list of levels for the given region\n     * @param region Region to list levels for\n     */\n    public levelsForRegion(region: Region = this.region): BuildingLevel[] {\n        const bld_list = this.buildingsForRegion(region);\n        return this.levels.filter(\n            (lvl) =>\n                lvl.parent_id &&\n                bld_list.find((bld) => bld.id === lvl.parent_id),\n        );\n    }\n\n    public addZone(zone: PlaceZone) {\n        if (zone.tags.includes('region')) {\n            const region = new Region(zone);\n            const regions = this._regions\n                .getValue()\n                .filter((_) => _.id !== region.id);\n            regions.push(region);\n            this._regions.next(regions);\n        } else if (zone.tags.includes('building')) {\n            const bld = new Building(zone);\n            let buildings = this._buildings\n                .getValue()\n                .filter((_) => _.id !== bld.id);\n            buildings.push(bld);\n            buildings = buildings.sort((a, b) =>\n                (a.name || '').localeCompare(b.name || ''),\n            );\n            this._buildings.next(buildings);\n        } else if (zone.tags.includes('level')) {\n            const lvl = new BuildingLevel(zone);\n            let levels = this._levels.getValue().filter((_) => _.id !== lvl.id);\n            levels.push(lvl);\n            levels = levels.sort((a, b) =>\n                (a.name || '').localeCompare(b.name || ''),\n            );\n            this._levels.next(levels);\n        } else {\n            console.warn(\n                'Unable to add zone as it is missing the required tag.',\n                zone.id,\n            );\n        }\n    }\n\n    public removeZone(zone: PlaceZone) {\n        if (zone.tags.includes('region')) {\n            const regions = this._regions\n                .getValue()\n                .filter((_) => _.id !== zone.id);\n            this._regions.next(regions);\n        } else if (zone.tags.includes('building')) {\n            const buildings = this._buildings\n\n                .getValue()\n                .filter((_) => _.id !== zone.id);\n            this._buildings.next(buildings);\n        } else if (zone.tags.includes('level')) {\n            const levels = this._levels\n                .getValue()\n                .filter((_) => _.id !== zone.id);\n            this._levels.next(levels);\n        } else {\n            console.warn(\n                'Unable to remove zone as it is missing the required tag.',\n                zone.id,\n            );\n        }\n    }\n\n    private async init(tries: number = 0) {\n        this._initialised.next(false);\n        await this.load().catch((err) => {\n            notifyError('Error loading organisation data. Retrying...');\n            setTimeout(() => this.init(tries), Math.min(10_000, 300 * ++tries));\n            throw err;\n        });\n        this._initialised.next(true);\n        if (window.debug) {\n            if (!window.application) window.application = {};\n            window.application.orgs = this;\n        }\n    }\n\n    /**\n     * Initialise service data\n     */\n    private async load(): Promise<void> {\n        await this.loadOrganisation();\n        await this.loadRegions();\n        if (!this._regions.getValue().length) {\n            this._buildings.next(await this.loadBuildings());\n        } else {\n            for (const region of this._regions.getValue()) {\n                const blds = await this.loadBuildings(region.id);\n                if (blds.length) {\n                    this._buildings.next(blds);\n                    break;\n                }\n            }\n        }\n        await this.loadSettings();\n        if (!this._buildings.getValue()?.length) {\n            log('ORG', 'Unable to find any building zones');\n        }\n        await this.loadLevels();\n        this._updateSettingOverrides();\n    }\n\n    /**\n     * Load organisation data for application\n     */\n    public async loadOrganisation(): Promise<void> {\n        const org_list = await queryZones({ tags: 'org' })\n            .pipe(map((i) => i.data))\n            .toPromise();\n        if (org_list.length) {\n            const auth = authority();\n            const org =\n                org_list.find(\n                    (list) => isMock() || list.id === auth?.config?.org_zone,\n                ) || org_list[0];\n\n            const load_metadata = !this._service.get('dont_load_metadata');\n            const bindings: Record<string, any> = (\n                await (\n                    load_metadata\n                        ? showMetadata(org.id, 'bindings')\n                        : of({ details: {} })\n                ).toPromise()\n            )?.details;\n            this._organisation = new Organisation({ ...org, bindings });\n        } else {\n            log('ORG', 'Unable to find organisation');\n            this._router.navigate(['/misconfigured']);\n        }\n    }\n\n    /**\n     * Load region data for the organisation\n     */\n    public async loadRegions(): Promise<void> {\n        const list = await queryZones({\n            tags: 'region',\n            parent_id: this._organisation?.id || '',\n            limit: 500,\n        } as any)\n            .pipe(\n                map((i) => i.data.map((_) => new Region(_))),\n                catchError(() => of([])),\n            )\n            .toPromise();\n        this._regions.next(list);\n    }\n\n    public async loadRegionData(region: Region): Promise<void> {\n        if (this._loaded_data[region.id]) return;\n        const load_metadata = !this._service.get('dont_load_metadata');\n        const settings_request = load_metadata\n            ? showMetadata(region.id, this.app_key)\n            : of(new PlaceMetadata());\n        const bindings_request = load_metadata\n            ? showMetadata(region.id, 'bindings')\n            : of(new PlaceMetadata());\n        const [settings, bindings, buildings]: any = await Promise.all([\n            settings_request.pipe(map((_) => _?.details)).toPromise(),\n            bindings_request.pipe(map((_) => _?.details)).toPromise(),\n            this.loadBuildings(region.id),\n        ]);\n        this._buildings.next(\n            unique([...this._buildings.getValue(), ...buildings], 'id'),\n        );\n        this._loaded_data[region.id] = true;\n        (region as any).bindings = bindings;\n        this._region_settings[region.id] = settings;\n    }\n\n    /**\n     * Load buildings data for the organisation\n     */\n    public async loadBuildings(\n        parent_id: string = this._organisation?.id,\n    ): Promise<Building[]> {\n        const building_list = await queryZones({\n            tags: 'building',\n            parent_id,\n            limit: 500,\n        } as any)\n            .pipe(map((i) => i.data.map((_) => new Building(_))))\n            .toPromise();\n        return building_list;\n    }\n\n    public async loadBuildingData(bld: Building) {\n        if (!bld || this._loaded_data[bld.id]) return;\n        const [settings, bindings, booking_rules, driver_settings]: any =\n            await Promise.all([\n                showMetadata(bld.id, this.app_key)\n                    .pipe(\n                        map((_) => _?.details),\n                        catchError(() => of({})),\n                    )\n                    .toPromise(),\n                showMetadata(bld.id, 'bindings')\n                    .pipe(\n                        map((_) => _?.details),\n                        catchError(() => of({})),\n                    )\n                    .toPromise(),\n                showMetadata(bld.id, 'booking_rules')\n                    .pipe(\n                        map((_) => _?.details),\n                        catchError(() => of({})),\n                    )\n                    .toPromise(),\n                querySettings({ parent_id: bld.id })\n                    .pipe(\n                        catchError(() => of({ data: {} as any })),\n                        map((_) => {\n                            try {\n                                return yaml.load(\n                                    _?.data.find(\n                                        (_) =>\n                                            _.encryption_level ===\n                                            EncryptionLevel.None,\n                                    ) || { settings_string: '' },\n                                );\n                            } catch {\n                                return {};\n                            }\n                        }),\n                    )\n                    .toPromise(),\n            ]);\n        this._building_settings[bld.id] = {\n            ...(driver_settings || {}),\n            ...(settings || {}),\n        };\n        (bld as any).bindings = bindings;\n        (bld as any).booking_rules = booking_rules;\n        this._loaded_data[bld.id] = true;\n        this._updateSettingOverrides();\n    }\n\n    /**\n     * Load levels data for the buildings\n     */\n    public async loadLevels(): Promise<void> {\n        let level_list = await queryZones({\n            tags: 'level',\n            authority_id: authority().id,\n            limit: 2500,\n        } as any)\n            .pipe(map((i) => i.data))\n            .toPromise();\n        level_list = level_list.filter((_) => _.parent_id);\n        if (!level_list?.length) {\n            this._router.navigate(['/misconfigured']);\n        }\n        let levels = level_list.map((lvl) => new BuildingLevel(lvl));\n        levels = levels.sort((a, b) =>\n            (a.name || '').localeCompare(b.name || ''),\n        );\n        this._levels.next(levels);\n    }\n\n    public get available_room_configs(): RoomConfiguration[] {\n        return this.buildings\n            .map((m) => [...m.room_configurations])\n            .reduce((prev, curr) => prev.concat(curr), [])\n            .sort((a, b) => a.name.localeCompare(b.name));\n    }\n\n    public async loadSettings() {\n        if (!this._organisation) return;\n        const load_metadata = !this._service.get('dont_load_metadata');\n        if (load_metadata) {\n            const app_settings = (\n                await showMetadata(\n                    this._organisation?.id,\n                    this.app_key,\n                ).toPromise()\n            )?.details;\n            const global_settings = (\n                await showMetadata(\n                    this._organisation?.id,\n                    'settings',\n                ).toPromise()\n            )?.details;\n            this._settings = [global_settings, app_settings];\n        }\n        this._service.overrides = [...this._settings];\n        await this._initialiseActiveBuilding();\n        this._updateSettingOverrides();\n    }\n\n    /** Save building selection */\n    public saveBuilding(id: string) {\n        const region_id = this._buildings\n            .getValue()\n            .find((bld) => bld.id === id)?.parent_id;\n        if (region_id && region_id !== this._organisation.id) {\n            sessionStorage.setItem(`PLACEOS.region`, region_id);\n        }\n        sessionStorage.setItem(`PLACEOS.building`, id);\n    }\n\n    private _initialiseActiveBuilding() {\n        return new Promise<void>((resolve) => {\n            const id = sessionStorage.getItem(`PLACEOS.building`);\n            if (id && this.buildings.find((bld) => bld.id === id)) {\n                this.building = this.buildings.find((bld) => bld.id === id);\n                return resolve();\n            }\n            const use_location = !!this._service.get('app.use_geolocation');\n            if (use_location && 'geolocation' in navigator) {\n                navigator.geolocation.getCurrentPosition(\n                    (position) => {\n                        const { latitude, longitude } = position.coords;\n                        let closest_bld = null;\n                        for (const bld of this.buildings) {\n                            if (!bld.location || bld.location === '0,0')\n                                continue;\n                            if (!closest_bld) closest_bld = bld;\n                            else {\n                                const [c_lat, c_long] = (\n                                    closest_bld.location || '0,0'\n                                ).split(',');\n                                const [b_lat, b_long] = (\n                                    bld.location || '0,0'\n                                ).split(',');\n                                const b_dist = Math.sqrt(\n                                    Math.pow(latitude - +b_lat, 2) +\n                                        Math.pow(longitude - +b_long, 2),\n                                );\n                                const c_dist = Math.sqrt(\n                                    Math.pow(latitude - +c_lat, 2) +\n                                        Math.pow(longitude - +c_long, 2),\n                                );\n                                if (b_dist < c_dist) closest_bld = bld;\n                            }\n                        }\n                        if (closest_bld) this.building = closest_bld;\n                        if (!this.building?.id) this._setDefaultBuilding();\n                        resolve();\n                    },\n                    () => {\n                        if (!this.building?.id) this._setDefaultBuilding();\n                        resolve();\n                    },\n                );\n            } else if (!this.building?.id) {\n                this._setDefaultBuilding();\n                resolve();\n            }\n        });\n    }\n\n    private async _setDefaultBuilding() {\n        if (!this.buildings.length) return;\n        const region_id = sessionStorage.getItem(`PLACEOS.region`);\n        await (region_id\n            ? this.setRegion(\n                  this._regions.getValue().find((_) => _.id === region_id),\n              )\n            : this._setRegionFromTimezone());\n        this._setBuildingFromTimezone();\n        if (this.building) return;\n        const bld_id = this._service.get('app.default_building');\n        if (bld_id) {\n            this.building = this.buildings.find(({ id }) => id === bld_id);\n        }\n        if (!this.building) this.building = this.buildings[0];\n    }\n\n    private async _setRegionFromTimezone() {\n        const region_list = this.regions;\n        const timezone = this.timezone;\n        for (const region of region_list) {\n            if (region.timezone === timezone) {\n                return await this.setRegion(region);\n            }\n        }\n        const tz_start = timezone.split('/')[0];\n        for (const region of region_list) {\n            if (region.timezone.startsWith(tz_start)) {\n                return await this.setRegion(region);\n            }\n        }\n    }\n\n    private _setBuildingFromTimezone() {\n        const bld_list = this.buildings.filter(\n            (bld) => !this.region || bld.parent_id === this.region?.id,\n        );\n        const timezone = this.timezone;\n        for (const bld of bld_list) {\n            if (bld.timezone === timezone) {\n                this.building = bld;\n                return;\n            }\n        }\n        const tz_start = timezone.split('/')[0];\n        for (const bld of bld_list) {\n            if (bld.timezone.startsWith(tz_start)) {\n                this.building = bld;\n                return;\n            }\n        }\n    }\n\n    private _updateSettingOverrides() {\n        setTimeout(\n            () =>\n                (this._service.overrides = [\n                    this.buildingSettings(this.building?.id),\n                    this.regionSettings(this.region?.id),\n                    ...this._settings,\n                ]),\n            300,\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { SettingsService } from './settings.service';\nimport { OrganisationService } from '@placeos/organisation';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport {\n    map,\n    tap,\n    filter,\n    debounce,\n    debounceTime,\n    shareReplay,\n} from 'rxjs/operators';\nimport { AsyncHandler } from './async-handler.class';\nimport { log } from './general';\n\nexport enum MapService {\n    GoogleMaps,\n    Mapbox,\n}\n\nexport interface MapsPeopleKeys {\n    mapsindoors?: string;\n    google?: string;\n    mapbox?: string;\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class MapsPeopleService extends AsyncHandler {\n    private _map_service = new BehaviorSubject<MapService>(null);\n    private _map_token = new BehaviorSubject<string>('');\n    private _ready = new BehaviorSubject(false);\n    private _injected: Record<string, boolean> = {};\n    private _custom_zone = new BehaviorSubject<string>('');\n\n    public readonly available$ = combineLatest([\n        this._org.active_building,\n        this._custom_zone,\n        this._org.initialised,\n    ]).pipe(\n        filter(([_]) => !!_),\n        debounceTime(300),\n        tap(() => this._injectMapsApiKeys()),\n        map(\n            ([bld, zone]) =>\n                this.map_keys.mapsindoors &&\n                (this.use_service.includes(zone || bld.id) ||\n                    this.use_service.includes('*'))\n        ),\n        shareReplay(1)\n    );\n\n    public get map_keys(): MapsPeopleKeys {\n        return this._settings.get('app.maps_people.keys') || {};\n    }\n\n    public get use_service(): string[] {\n        return this._settings.get('app.maps_people.use_zones') || [];\n    }\n\n    public get map_service(): MapService {\n        return this._map_service.getValue();\n    }\n\n    public get map_token(): string {\n        return this._map_token.getValue();\n    }\n\n    public get is_ready(): boolean {\n        return this._ready.getValue();\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public setCustomZone(zone_id: string) {\n        this._custom_zone.next(zone_id);\n    }\n\n    private _injectMapsApiKeys() {\n        log('MapsPeople', 'Initializing Maps API Keys');\n        this._ready.next(false);\n        const { mapsindoors, google, mapbox } = this.map_keys;\n        if (!mapsindoors) return;\n        if (mapsindoors && !this._injected.mapsindoors) {\n            const script = document.createElement('script');\n            script.src = `https://app.mapsindoors.com/mapsindoors/js/sdk/4.35.0/mapsindoors-4.35.0.js.gz?apikey=${mapsindoors}`;\n            document.body.appendChild(script);\n            this._injected.mapsindoors = true;\n        }\n        if (google && mapbox) {\n            log(\n                'MapsPeople',\n                'Both Google and Mapbox keys provided',\n                undefined,\n                'error'\n            );\n            return;\n        }\n        if (google && !this._injected.google) {\n            const script = document.createElement('script');\n            script.src = `https://maps.googleapis.com/maps/api/js?libraries=geometry&key=${google}`;\n            document.body.appendChild(script);\n            this._map_service.next(MapService.GoogleMaps);\n            this._injected.google = true;\n        } else if (mapbox && !this._injected.mapbox) {\n            const script = document.createElement('script');\n            script.src = `https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js`;\n            document.body.appendChild(script);\n            const styles = document.createElement('link');\n            styles.rel = 'stylesheet';\n            styles.href = `https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css`;\n            document.head.appendChild(styles);\n            this._map_service.next(MapService.Mapbox);\n            this._map_token.next(mapbox);\n            this._injected.mapbox = true;\n        }\n\n        if (google || mapbox) {\n            log(\n                'MapsPeople',\n                `Initialized Maps API Keys for ${\n                    google ? 'Google Maps' : 'Mapbox'\n                }`\n            );\n            this.timeout('ready', () => this._ready.next(true), 300);\n        }\n    }\n}\n","import { trigger, transition, style, animate, state } from '@angular/animations';\n\nexport const ANIMATION_SHOW_ENTER_LEAVE = trigger('show', [\n    transition(':enter', [\n        style({ opacity: 0, height: 0 }),\n        animate(300, style({ opacity: 1, height: '*' }))\n    ]),\n    transition(':leave', [\n        style({ opacity: 1, height: '*' }),\n        animate(300, style({ opacity: 0, height: 0 }))\n    ])\n]);\n\nexport const ANIMATION_SHOW_CONTRACT_EXPAND = trigger('show', [\n    state('show', style({ opacity: 1, height: '*' })),\n    state('hide', style({ opacity: 0, height: 0, 'pointer-events': 'none' })),\n    transition('show <=> hide', animate('200ms ease-in'))\n]);\n","import { HashMap } from './types';\n\nconst IGNORE_VALUES = [undefined, null, ''];\n\n/**\n * Convert map into a query string\n * @param map Key value pairs to convert\n */\nexport function toQueryString(map: HashMap) {\n    let str = '';\n    if (map) {\n        for (const key in map) {\n            if (key in map && !IGNORE_VALUES.includes(map[key])) {\n                str += `${str ? '&' : ''}${key}=${encodeURIComponent(\n                    map[key]\n                )}`;\n            }\n        }\n    }\n    return str;\n}\n","import { SwUpdate } from '@angular/service-worker';\n\nimport { log } from './general';\nimport { notifyInfo } from './notifications';\n\nlet _timer: number;\nlet _new_version = false;\n\nexport function hasNewVersion() {\n    return _new_version;\n}\n\n/**\n * Setup handler for cache change events\n * @param cache Angular Service worker service\n * @param notify Function to call on changes to the cache\n * @param interval Time interval to check the cache for changes\n */\nexport function setupCache(cache: SwUpdate, interval: number = 5 * 60 * 1000) {\n    if (cache.isEnabled) {\n        if (_timer) clearInterval(_timer);\n        _timer = <any>setInterval(() => {\n            log('CACHE', `Checking for updates...`);\n            activateUpdate(cache);\n        }, interval);\n    }\n}\n\nexport function clearCacheCheck() {\n    if (_timer) clearInterval(_timer);\n}\n\n/**\n * Update the cache and reload the page\n *\n */\nasync function activateUpdate(cache: SwUpdate) {\n    if (cache.isEnabled && (await cache.checkForUpdate())) {\n        log('CACHE', `Activating changes to the cache...`);\n        if (!(await cache.activateUpdate())) return;\n        _new_version = true;\n        notifyInfo(\n            'Newer version of the application is available',\n            'Refresh',\n            () => location.reload()\n        );\n    }\n}\n","import { PlaceAuthOptions, setup } from '@placeos/ts-client';\nimport { notifyInfo } from './notifications';\n\nexport interface PlaceSettings {\n    /** Protocol used by the application server */\n    protocol: 'http:' | 'https:';\n    /** Domain that the API server lies  */\n    domain: string;\n    /** Port number of the API server */\n    port: number;\n    /** Route on domain application rests */\n    route: string;\n    /** Whether to use the settings domain for auth */\n    use_domain: boolean;\n    /** Whether login is handled locally by the application */\n    local_login: boolean;\n    /** Whether application should mock out API requests */\n    mock: boolean;\n\n    storage?: 'session' | 'local';\n}\n\n/**\n * Initialise the PlaceOS API library\n */\nexport async function setupPlace(settings: PlaceSettings): Promise<void> {\n    const protocol = settings.protocol || location.protocol;\n    const host = settings.domain || location.hostname;\n    const port = settings.port || location.port;\n    const url = settings.use_domain\n        ? `${protocol}//${host}:${port}`\n        : location.origin;\n    const route = (location.pathname + '/').replace('//', '/');\n    const mock =\n        settings.mock ||\n        location.href.includes('mock=true') ||\n        localStorage.getItem('mock') === 'true';\n    // Generate configuration object\n    const config: PlaceAuthOptions = {\n        auth_type: 'auth_code',\n        scope: 'public',\n        host: `${host}${port ? ':' + port : ''}`,\n        auth_uri: `${url}/auth/oauth/authorize`,\n        token_uri: `${url}/auth/oauth/token`,\n        redirect_uri: `${location.origin}${route}oauth-resp.html`,\n        handle_login: !settings.local_login,\n        use_iframe: true,\n        mock,\n    };\n    if (localStorage) {\n        localStorage.setItem(\n            'mock',\n            `${!!mock && !location.href.includes('mock=false')}`\n        );\n    }\n    if (mock) {\n        notifyInfo('Application in mock mode.');\n    }\n    return setup(config);\n}\n","import { flatten, unique } from \"./general\";\n\nexport const TIMEZONES = [\n    {\n      \"value\": \"Dateline Standard Time\",\n      \"abbr\": \"DST\",\n      \"offset\": -12,\n      \"isdst\": false,\n      \"text\": \"(UTC-12:00) International Date Line West\",\n      \"utc\": [\n        \"Etc/GMT+12\"\n      ]\n    },\n    {\n      \"value\": \"UTC-11\",\n      \"abbr\": \"U\",\n      \"offset\": -11,\n      \"isdst\": false,\n      \"text\": \"(UTC-11:00) Coordinated Universal Time-11\",\n      \"utc\": [\n        \"Etc/GMT+11\",\n        \"Pacific/Midway\",\n        \"Pacific/Niue\",\n        \"Pacific/Pago_Pago\"\n      ]\n    },\n    {\n      \"value\": \"Hawaiian Standard Time\",\n      \"abbr\": \"HST\",\n      \"offset\": -10,\n      \"isdst\": false,\n      \"text\": \"(UTC-10:00) Hawaii\",\n      \"utc\": [\n        \"Etc/GMT+10\",\n        \"Pacific/Honolulu\",\n        \"Pacific/Johnston\",\n        \"Pacific/Rarotonga\",\n        \"Pacific/Tahiti\"\n      ]\n    },\n    {\n      \"value\": \"Alaskan Standard Time\",\n      \"abbr\": \"AKDT\",\n      \"offset\": -8,\n      \"isdst\": true,\n      \"text\": \"(UTC-09:00) Alaska\",\n      \"utc\": [\n        \"America/Anchorage\",\n        \"America/Juneau\",\n        \"America/Nome\",\n        \"America/Sitka\",\n        \"America/Yakutat\"\n      ]\n    },\n    {\n      \"value\": \"Pacific Standard Time (Mexico)\",\n      \"abbr\": \"PDT\",\n      \"offset\": -7,\n      \"isdst\": true,\n      \"text\": \"(UTC-08:00) Baja California\",\n      \"utc\": [\n        \"America/Santa_Isabel\"\n      ]\n    },\n    {\n      \"value\": \"Pacific Daylight Time\",\n      \"abbr\": \"PDT\",\n      \"offset\": -7,\n      \"isdst\": true,\n      \"text\": \"(UTC-07:00) Pacific Time (US & Canada)\",\n      \"utc\": [\n        \"America/Dawson\",\n        \"America/Los_Angeles\",\n        \"America/Tijuana\",\n        \"America/Vancouver\",\n        \"America/Whitehorse\"\n      ]\n    },\n    {\n      \"value\": \"Pacific Standard Time\",\n      \"abbr\": \"PST\",\n      \"offset\": -8,\n      \"isdst\": false,\n      \"text\": \"(UTC-08:00) Pacific Time (US & Canada)\",\n      \"utc\": [\n        \"America/Dawson\",\n        \"America/Los_Angeles\",\n        \"America/Tijuana\",\n        \"America/Vancouver\",\n        \"America/Whitehorse\",\n        \"PST8PDT\"\n      ]\n    },\n    {\n      \"value\": \"US Mountain Standard Time\",\n      \"abbr\": \"UMST\",\n      \"offset\": -7,\n      \"isdst\": false,\n      \"text\": \"(UTC-07:00) Arizona\",\n      \"utc\": [\n        \"America/Creston\",\n        \"America/Dawson_Creek\",\n        \"America/Hermosillo\",\n        \"America/Phoenix\",\n        \"Etc/GMT+7\"\n      ]\n    },\n    {\n      \"value\": \"Mountain Standard Time (Mexico)\",\n      \"abbr\": \"MDT\",\n      \"offset\": -6,\n      \"isdst\": true,\n      \"text\": \"(UTC-07:00) Chihuahua, La Paz, Mazatlan\",\n      \"utc\": [\n        \"America/Chihuahua\",\n        \"America/Mazatlan\"\n      ]\n    },\n    {\n      \"value\": \"Mountain Standard Time\",\n      \"abbr\": \"MDT\",\n      \"offset\": -6,\n      \"isdst\": true,\n      \"text\": \"(UTC-07:00) Mountain Time (US & Canada)\",\n      \"utc\": [\n        \"America/Boise\",\n        \"America/Cambridge_Bay\",\n        \"America/Denver\",\n        \"America/Edmonton\",\n        \"America/Inuvik\",\n        \"America/Ojinaga\",\n        \"America/Yellowknife\",\n        \"MST7MDT\"\n      ]\n    },\n    {\n      \"value\": \"Central America Standard Time\",\n      \"abbr\": \"CAST\",\n      \"offset\": -6,\n      \"isdst\": false,\n      \"text\": \"(UTC-06:00) Central America\",\n      \"utc\": [\n        \"America/Belize\",\n        \"America/Costa_Rica\",\n        \"America/El_Salvador\",\n        \"America/Guatemala\",\n        \"America/Managua\",\n        \"America/Tegucigalpa\",\n        \"Etc/GMT+6\",\n        \"Pacific/Galapagos\"\n      ]\n    },\n    {\n      \"value\": \"Central Standard Time\",\n      \"abbr\": \"CDT\",\n      \"offset\": -5,\n      \"isdst\": true,\n      \"text\": \"(UTC-06:00) Central Time (US & Canada)\",\n      \"utc\": [\n        \"America/Chicago\",\n        \"America/Indiana/Knox\",\n        \"America/Indiana/Tell_City\",\n        \"America/Matamoros\",\n        \"America/Menominee\",\n        \"America/North_Dakota/Beulah\",\n        \"America/North_Dakota/Center\",\n        \"America/North_Dakota/New_Salem\",\n        \"America/Rainy_River\",\n        \"America/Rankin_Inlet\",\n        \"America/Resolute\",\n        \"America/Winnipeg\",\n        \"CST6CDT\"\n      ]\n    },\n    {\n      \"value\": \"Central Standard Time (Mexico)\",\n      \"abbr\": \"CDT\",\n      \"offset\": -5,\n      \"isdst\": true,\n      \"text\": \"(UTC-06:00) Guadalajara, Mexico City, Monterrey\",\n      \"utc\": [\n        \"America/Bahia_Banderas\",\n        \"America/Cancun\",\n        \"America/Merida\",\n        \"America/Mexico_City\",\n        \"America/Monterrey\"\n      ]\n    },\n    {\n      \"value\": \"Canada Central Standard Time\",\n      \"abbr\": \"CCST\",\n      \"offset\": -6,\n      \"isdst\": false,\n      \"text\": \"(UTC-06:00) Saskatchewan\",\n      \"utc\": [\n        \"America/Regina\",\n        \"America/Swift_Current\"\n      ]\n    },\n    {\n      \"value\": \"SA Pacific Standard Time\",\n      \"abbr\": \"SPST\",\n      \"offset\": -5,\n      \"isdst\": false,\n      \"text\": \"(UTC-05:00) Bogota, Lima, Quito\",\n      \"utc\": [\n        \"America/Bogota\",\n        \"America/Cayman\",\n        \"America/Coral_Harbour\",\n        \"America/Eirunepe\",\n        \"America/Guayaquil\",\n        \"America/Jamaica\",\n        \"America/Lima\",\n        \"America/Panama\",\n        \"America/Rio_Branco\",\n        \"Etc/GMT+5\"\n      ]\n    },\n    {\n      \"value\": \"Eastern Standard Time\",\n      \"abbr\": \"EDT\",\n      \"offset\": -4,\n      \"isdst\": true,\n      \"text\": \"(UTC-05:00) Eastern Time (US & Canada)\",\n      \"utc\": [\n        \"America/Detroit\",\n        \"America/Havana\",\n        \"America/Indiana/Petersburg\",\n        \"America/Indiana/Vincennes\",\n        \"America/Indiana/Winamac\",\n        \"America/Iqaluit\",\n        \"America/Kentucky/Monticello\",\n        \"America/Louisville\",\n        \"America/Montreal\",\n        \"America/Nassau\",\n        \"America/New_York\",\n        \"America/Nipigon\",\n        \"America/Pangnirtung\",\n        \"America/Port-au-Prince\",\n        \"America/Thunder_Bay\",\n        \"America/Toronto\",\n        \"EST5EDT\"\n      ]\n    },\n    {\n      \"value\": \"US Eastern Standard Time\",\n      \"abbr\": \"UEDT\",\n      \"offset\": -4,\n      \"isdst\": true,\n      \"text\": \"(UTC-05:00) Indiana (East)\",\n      \"utc\": [\n        \"America/Indiana/Marengo\",\n        \"America/Indiana/Vevay\",\n        \"America/Indianapolis\"\n      ]\n    },\n    {\n      \"value\": \"Venezuela Standard Time\",\n      \"abbr\": \"VST\",\n      \"offset\": -4.5,\n      \"isdst\": false,\n      \"text\": \"(UTC-04:30) Caracas\",\n      \"utc\": [\n        \"America/Caracas\"\n      ]\n    },\n    {\n      \"value\": \"Paraguay Standard Time\",\n      \"abbr\": \"PYT\",\n      \"offset\": -4,\n      \"isdst\": false,\n      \"text\": \"(UTC-04:00) Asuncion\",\n      \"utc\": [\n        \"America/Asuncion\"\n      ]\n    },\n    {\n      \"value\": \"Atlantic Standard Time\",\n      \"abbr\": \"ADT\",\n      \"offset\": -3,\n      \"isdst\": true,\n      \"text\": \"(UTC-04:00) Atlantic Time (Canada)\",\n      \"utc\": [\n        \"America/Glace_Bay\",\n        \"America/Goose_Bay\",\n        \"America/Halifax\",\n        \"America/Moncton\",\n        \"America/Thule\",\n        \"Atlantic/Bermuda\"\n      ]\n    },\n    {\n      \"value\": \"Central Brazilian Standard Time\",\n      \"abbr\": \"CBST\",\n      \"offset\": -4,\n      \"isdst\": false,\n      \"text\": \"(UTC-04:00) Cuiaba\",\n      \"utc\": [\n        \"America/Campo_Grande\",\n        \"America/Cuiaba\"\n      ]\n    },\n    {\n      \"value\": \"SA Western Standard Time\",\n      \"abbr\": \"SWST\",\n      \"offset\": -4,\n      \"isdst\": false,\n      \"text\": \"(UTC-04:00) Georgetown, La Paz, Manaus, San Juan\",\n      \"utc\": [\n        \"America/Anguilla\",\n        \"America/Antigua\",\n        \"America/Aruba\",\n        \"America/Barbados\",\n        \"America/Blanc-Sablon\",\n        \"America/Boa_Vista\",\n        \"America/Curacao\",\n        \"America/Dominica\",\n        \"America/Grand_Turk\",\n        \"America/Grenada\",\n        \"America/Guadeloupe\",\n        \"America/Guyana\",\n        \"America/Kralendijk\",\n        \"America/La_Paz\",\n        \"America/Lower_Princes\",\n        \"America/Manaus\",\n        \"America/Marigot\",\n        \"America/Martinique\",\n        \"America/Montserrat\",\n        \"America/Port_of_Spain\",\n        \"America/Porto_Velho\",\n        \"America/Puerto_Rico\",\n        \"America/Santo_Domingo\",\n        \"America/St_Barthelemy\",\n        \"America/St_Kitts\",\n        \"America/St_Lucia\",\n        \"America/St_Thomas\",\n        \"America/St_Vincent\",\n        \"America/Tortola\",\n        \"Etc/GMT+4\"\n      ]\n    },\n    {\n      \"value\": \"Pacific SA Standard Time\",\n      \"abbr\": \"PSST\",\n      \"offset\": -4,\n      \"isdst\": false,\n      \"text\": \"(UTC-04:00) Santiago\",\n      \"utc\": [\n        \"America/Santiago\",\n        \"Antarctica/Palmer\"\n      ]\n    },\n    {\n      \"value\": \"Newfoundland Standard Time\",\n      \"abbr\": \"NDT\",\n      \"offset\": -2.5,\n      \"isdst\": true,\n      \"text\": \"(UTC-03:30) Newfoundland\",\n      \"utc\": [\n        \"America/St_Johns\"\n      ]\n    },\n    {\n      \"value\": \"E. South America Standard Time\",\n      \"abbr\": \"ESAST\",\n      \"offset\": -3,\n      \"isdst\": false,\n      \"text\": \"(UTC-03:00) Brasilia\",\n      \"utc\": [\n        \"America/Sao_Paulo\"\n      ]\n    },\n    {\n      \"value\": \"Argentina Standard Time\",\n      \"abbr\": \"AST\",\n      \"offset\": -3,\n      \"isdst\": false,\n      \"text\": \"(UTC-03:00) Buenos Aires\",\n      \"utc\": [\n        \"America/Argentina/La_Rioja\",\n        \"America/Argentina/Rio_Gallegos\",\n        \"America/Argentina/Salta\",\n        \"America/Argentina/San_Juan\",\n        \"America/Argentina/San_Luis\",\n        \"America/Argentina/Tucuman\",\n        \"America/Argentina/Ushuaia\",\n        \"America/Buenos_Aires\",\n        \"America/Catamarca\",\n        \"America/Cordoba\",\n        \"America/Jujuy\",\n        \"America/Mendoza\"\n      ]\n    },\n    {\n      \"value\": \"SA Eastern Standard Time\",\n      \"abbr\": \"SEST\",\n      \"offset\": -3,\n      \"isdst\": false,\n      \"text\": \"(UTC-03:00) Cayenne, Fortaleza\",\n      \"utc\": [\n        \"America/Araguaina\",\n        \"America/Belem\",\n        \"America/Cayenne\",\n        \"America/Fortaleza\",\n        \"America/Maceio\",\n        \"America/Paramaribo\",\n        \"America/Recife\",\n        \"America/Santarem\",\n        \"Antarctica/Rothera\",\n        \"Atlantic/Stanley\",\n        \"Etc/GMT+3\"\n      ]\n    },\n    {\n      \"value\": \"Greenland Standard Time\",\n      \"abbr\": \"GDT\",\n      \"offset\": -3,\n      \"isdst\": true,\n      \"text\": \"(UTC-03:00) Greenland\",\n      \"utc\": [\n        \"America/Godthab\"\n      ]\n    },\n    {\n      \"value\": \"Montevideo Standard Time\",\n      \"abbr\": \"MST\",\n      \"offset\": -3,\n      \"isdst\": false,\n      \"text\": \"(UTC-03:00) Montevideo\",\n      \"utc\": [\n        \"America/Montevideo\"\n      ]\n    },\n    {\n      \"value\": \"Bahia Standard Time\",\n      \"abbr\": \"BST\",\n      \"offset\": -3,\n      \"isdst\": false,\n      \"text\": \"(UTC-03:00) Salvador\",\n      \"utc\": [\n        \"America/Bahia\"\n      ]\n    },\n    {\n      \"value\": \"UTC-02\",\n      \"abbr\": \"U\",\n      \"offset\": -2,\n      \"isdst\": false,\n      \"text\": \"(UTC-02:00) Coordinated Universal Time-02\",\n      \"utc\": [\n        \"America/Noronha\",\n        \"Atlantic/South_Georgia\",\n        \"Etc/GMT+2\"\n      ]\n    },\n    {\n      \"value\": \"Mid-Atlantic Standard Time\",\n      \"abbr\": \"MDT\",\n      \"offset\": -1,\n      \"isdst\": true,\n      \"text\": \"(UTC-02:00) Mid-Atlantic - Old\",\n      \"utc\": []\n    },\n    {\n      \"value\": \"Azores Standard Time\",\n      \"abbr\": \"ADT\",\n      \"offset\": 0,\n      \"isdst\": true,\n      \"text\": \"(UTC-01:00) Azores\",\n      \"utc\": [\n        \"America/Scoresbysund\",\n        \"Atlantic/Azores\"\n      ]\n    },\n    {\n      \"value\": \"Cape Verde Standard Time\",\n      \"abbr\": \"CVST\",\n      \"offset\": -1,\n      \"isdst\": false,\n      \"text\": \"(UTC-01:00) Cape Verde Is.\",\n      \"utc\": [\n        \"Atlantic/Cape_Verde\",\n        \"Etc/GMT+1\"\n      ]\n    },\n    {\n      \"value\": \"Morocco Standard Time\",\n      \"abbr\": \"MDT\",\n      \"offset\": 1,\n      \"isdst\": true,\n      \"text\": \"(UTC) Casablanca\",\n      \"utc\": [\n        \"Africa/Casablanca\",\n        \"Africa/El_Aaiun\"\n      ]\n    },\n    {\n      \"value\": \"UTC\",\n      \"abbr\": \"UTC\",\n      \"offset\": 0,\n      \"isdst\": false,\n      \"text\": \"(UTC) Coordinated Universal Time\",\n      \"utc\": [\n        \"America/Danmarkshavn\",\n        \"Etc/GMT\"\n      ]\n    },\n    {\n      \"value\": \"GMT Standard Time\",\n      \"abbr\": \"GMT\",\n      \"offset\": 0,\n      \"isdst\": false,\n      \"text\": \"(UTC) Edinburgh, London\",\n      \"utc\": [\n        \"Europe/Isle_of_Man\",\n        \"Europe/Guernsey\",\n        \"Europe/Jersey\",\n        \"Europe/London\"\n      ]\n    },\n    {\n      \"value\": \"British Summer Time\",\n      \"abbr\": \"BST\",\n      \"offset\": 1,\n      \"isdst\": true,\n      \"text\": \"(UTC+01:00) Edinburgh, London\",\n      \"utc\": [\n        \"Europe/Isle_of_Man\",\n        \"Europe/Guernsey\",\n        \"Europe/Jersey\",\n        \"Europe/London\"\n      ]\n    },\n    {\n      \"value\": \"GMT Standard Time\",\n      \"abbr\": \"GDT\",\n      \"offset\": 1,\n      \"isdst\": true,\n      \"text\": \"(UTC) Dublin, Lisbon\",\n      \"utc\": [\n        \"Atlantic/Canary\",\n        \"Atlantic/Faeroe\",\n        \"Atlantic/Madeira\",\n        \"Europe/Dublin\",\n        \"Europe/Lisbon\"\n      ]\n    },\n    {\n      \"value\": \"Greenwich Standard Time\",\n      \"abbr\": \"GST\",\n      \"offset\": 0,\n      \"isdst\": false,\n      \"text\": \"(UTC) Monrovia, Reykjavik\",\n      \"utc\": [\n        \"Africa/Abidjan\",\n        \"Africa/Accra\",\n        \"Africa/Bamako\",\n        \"Africa/Banjul\",\n        \"Africa/Bissau\",\n        \"Africa/Conakry\",\n        \"Africa/Dakar\",\n        \"Africa/Freetown\",\n        \"Africa/Lome\",\n        \"Africa/Monrovia\",\n        \"Africa/Nouakchott\",\n        \"Africa/Ouagadougou\",\n        \"Africa/Sao_Tome\",\n        \"Atlantic/Reykjavik\",\n        \"Atlantic/St_Helena\"\n      ]\n    },\n    {\n      \"value\": \"W. Europe Standard Time\",\n      \"abbr\": \"WEDT\",\n      \"offset\": 2,\n      \"isdst\": true,\n      \"text\": \"(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna\",\n      \"utc\": [\n        \"Arctic/Longyearbyen\",\n        \"Europe/Amsterdam\",\n        \"Europe/Andorra\",\n        \"Europe/Berlin\",\n        \"Europe/Busingen\",\n        \"Europe/Gibraltar\",\n        \"Europe/Luxembourg\",\n        \"Europe/Malta\",\n        \"Europe/Monaco\",\n        \"Europe/Oslo\",\n        \"Europe/Rome\",\n        \"Europe/San_Marino\",\n        \"Europe/Stockholm\",\n        \"Europe/Vaduz\",\n        \"Europe/Vatican\",\n        \"Europe/Vienna\",\n        \"Europe/Zurich\"\n      ]\n    },\n    {\n      \"value\": \"Central Europe Standard Time\",\n      \"abbr\": \"CEDT\",\n      \"offset\": 2,\n      \"isdst\": true,\n      \"text\": \"(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague\",\n      \"utc\": [\n        \"Europe/Belgrade\",\n        \"Europe/Bratislava\",\n        \"Europe/Budapest\",\n        \"Europe/Ljubljana\",\n        \"Europe/Podgorica\",\n        \"Europe/Prague\",\n        \"Europe/Tirane\"\n      ]\n    },\n    {\n      \"value\": \"Romance Standard Time\",\n      \"abbr\": \"RDT\",\n      \"offset\": 2,\n      \"isdst\": true,\n      \"text\": \"(UTC+01:00) Brussels, Copenhagen, Madrid, Paris\",\n      \"utc\": [\n        \"Africa/Ceuta\",\n        \"Europe/Brussels\",\n        \"Europe/Copenhagen\",\n        \"Europe/Madrid\",\n        \"Europe/Paris\"\n      ]\n    },\n    {\n      \"value\": \"Central European Standard Time\",\n      \"abbr\": \"CEDT\",\n      \"offset\": 2,\n      \"isdst\": true,\n      \"text\": \"(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb\",\n      \"utc\": [\n        \"Europe/Sarajevo\",\n        \"Europe/Skopje\",\n        \"Europe/Warsaw\",\n        \"Europe/Zagreb\"\n      ]\n    },\n    {\n      \"value\": \"W. Central Africa Standard Time\",\n      \"abbr\": \"WCAST\",\n      \"offset\": 1,\n      \"isdst\": false,\n      \"text\": \"(UTC+01:00) West Central Africa\",\n      \"utc\": [\n        \"Africa/Algiers\",\n        \"Africa/Bangui\",\n        \"Africa/Brazzaville\",\n        \"Africa/Douala\",\n        \"Africa/Kinshasa\",\n        \"Africa/Lagos\",\n        \"Africa/Libreville\",\n        \"Africa/Luanda\",\n        \"Africa/Malabo\",\n        \"Africa/Ndjamena\",\n        \"Africa/Niamey\",\n        \"Africa/Porto-Novo\",\n        \"Africa/Tunis\",\n        \"Etc/GMT-1\"\n      ]\n    },\n    {\n      \"value\": \"Namibia Standard Time\",\n      \"abbr\": \"NST\",\n      \"offset\": 1,\n      \"isdst\": false,\n      \"text\": \"(UTC+01:00) Windhoek\",\n      \"utc\": [\n        \"Africa/Windhoek\"\n      ]\n    },\n    {\n      \"value\": \"GTB Standard Time\",\n      \"abbr\": \"GDT\",\n      \"offset\": 3,\n      \"isdst\": true,\n      \"text\": \"(UTC+02:00) Athens, Bucharest\",\n      \"utc\": [\n        \"Asia/Nicosia\",\n        \"Europe/Athens\",\n        \"Europe/Bucharest\",\n        \"Europe/Chisinau\"\n      ]\n    },\n    {\n      \"value\": \"Middle East Standard Time\",\n      \"abbr\": \"MEDT\",\n      \"offset\": 3,\n      \"isdst\": true,\n      \"text\": \"(UTC+02:00) Beirut\",\n      \"utc\": [\n        \"Asia/Beirut\"\n      ]\n    },\n    {\n      \"value\": \"Egypt Standard Time\",\n      \"abbr\": \"EST\",\n      \"offset\": 2,\n      \"isdst\": false,\n      \"text\": \"(UTC+02:00) Cairo\",\n      \"utc\": [\n        \"Africa/Cairo\"\n      ]\n    },\n    {\n      \"value\": \"Syria Standard Time\",\n      \"abbr\": \"SDT\",\n      \"offset\": 3,\n      \"isdst\": true,\n      \"text\": \"(UTC+02:00) Damascus\",\n      \"utc\": [\n        \"Asia/Damascus\"\n      ]\n    },\n    {\n      \"value\": \"E. Europe Standard Time\",\n      \"abbr\": \"EEDT\",\n      \"offset\": 3,\n      \"isdst\": true,\n      \"text\": \"(UTC+02:00) E. Europe\",\n      \"utc\": [\n        \"Asia/Nicosia\",\n        \"Europe/Athens\",\n        \"Europe/Bucharest\",\n        \"Europe/Chisinau\",\n        \"Europe/Helsinki\",\n        \"Europe/Kiev\",\n        \"Europe/Mariehamn\",\n        \"Europe/Nicosia\",\n        \"Europe/Riga\",\n        \"Europe/Sofia\",\n        \"Europe/Tallinn\",\n        \"Europe/Uzhgorod\",\n        \"Europe/Vilnius\",\n        \"Europe/Zaporozhye\"\n\n      ]\n    },\n    {\n      \"value\": \"South Africa Standard Time\",\n      \"abbr\": \"SAST\",\n      \"offset\": 2,\n      \"isdst\": false,\n      \"text\": \"(UTC+02:00) Harare, Pretoria\",\n      \"utc\": [\n        \"Africa/Blantyre\",\n        \"Africa/Bujumbura\",\n        \"Africa/Gaborone\",\n        \"Africa/Harare\",\n        \"Africa/Johannesburg\",\n        \"Africa/Kigali\",\n        \"Africa/Lubumbashi\",\n        \"Africa/Lusaka\",\n        \"Africa/Maputo\",\n        \"Africa/Maseru\",\n        \"Africa/Mbabane\",\n        \"Etc/GMT-2\"\n      ]\n    },\n    {\n      \"value\": \"FLE Standard Time\",\n      \"abbr\": \"FDT\",\n      \"offset\": 3,\n      \"isdst\": true,\n      \"text\": \"(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius\",\n      \"utc\": [\n        \"Europe/Helsinki\",\n        \"Europe/Kiev\",\n        \"Europe/Mariehamn\",\n        \"Europe/Riga\",\n        \"Europe/Sofia\",\n        \"Europe/Tallinn\",\n        \"Europe/Uzhgorod\",\n        \"Europe/Vilnius\",\n        \"Europe/Zaporozhye\"\n      ]\n    },\n    {\n      \"value\": \"Turkey Standard Time\",\n      \"abbr\": \"TDT\",\n      \"offset\": 3,\n      \"isdst\": false,\n      \"text\": \"(UTC+03:00) Istanbul\",\n      \"utc\": [\n        \"Europe/Istanbul\"\n      ]\n    },\n    {\n      \"value\": \"Israel Standard Time\",\n      \"abbr\": \"JDT\",\n      \"offset\": 3,\n      \"isdst\": true,\n      \"text\": \"(UTC+02:00) Jerusalem\",\n      \"utc\": [\n        \"Asia/Jerusalem\"\n      ]\n    },\n    {\n      \"value\": \"Libya Standard Time\",\n      \"abbr\": \"LST\",\n      \"offset\": 2,\n      \"isdst\": false,\n      \"text\": \"(UTC+02:00) Tripoli\",\n      \"utc\": [\n        \"Africa/Tripoli\"\n      ]\n    },\n    {\n      \"value\": \"Jordan Standard Time\",\n      \"abbr\": \"JST\",\n      \"offset\": 3,\n      \"isdst\": false,\n      \"text\": \"(UTC+03:00) Amman\",\n      \"utc\": [\n        \"Asia/Amman\"\n      ]\n    },\n    {\n      \"value\": \"Arabic Standard Time\",\n      \"abbr\": \"AST\",\n      \"offset\": 3,\n      \"isdst\": false,\n      \"text\": \"(UTC+03:00) Baghdad\",\n      \"utc\": [\n        \"Asia/Baghdad\"\n      ]\n    },\n    {\n      \"value\": \"Kaliningrad Standard Time\",\n      \"abbr\": \"KST\",\n      \"offset\": 3,\n      \"isdst\": false,\n      \"text\": \"(UTC+02:00) Kaliningrad\",\n      \"utc\": [\n        \"Europe/Kaliningrad\"\n      ]\n    },\n    {\n      \"value\": \"Arab Standard Time\",\n      \"abbr\": \"AST\",\n      \"offset\": 3,\n      \"isdst\": false,\n      \"text\": \"(UTC+03:00) Kuwait, Riyadh\",\n      \"utc\": [\n        \"Asia/Aden\",\n        \"Asia/Bahrain\",\n        \"Asia/Kuwait\",\n        \"Asia/Qatar\",\n        \"Asia/Riyadh\"\n      ]\n    },\n    {\n      \"value\": \"E. Africa Standard Time\",\n      \"abbr\": \"EAST\",\n      \"offset\": 3,\n      \"isdst\": false,\n      \"text\": \"(UTC+03:00) Nairobi\",\n      \"utc\": [\n        \"Africa/Addis_Ababa\",\n        \"Africa/Asmera\",\n        \"Africa/Dar_es_Salaam\",\n        \"Africa/Djibouti\",\n        \"Africa/Juba\",\n        \"Africa/Kampala\",\n        \"Africa/Khartoum\",\n        \"Africa/Mogadishu\",\n        \"Africa/Nairobi\",\n        \"Antarctica/Syowa\",\n        \"Etc/GMT-3\",\n        \"Indian/Antananarivo\",\n        \"Indian/Comoro\",\n        \"Indian/Mayotte\"\n      ]\n    },\n    {\n      \"value\": \"Moscow Standard Time\",\n      \"abbr\": \"MSK\",\n      \"offset\": 3,\n      \"isdst\": false,\n      \"text\": \"(UTC+03:00) Moscow, St. Petersburg, Volgograd, Minsk\",\n      \"utc\": [\n          \"Europe/Kirov\",\n        \"Europe/Moscow\",\n        \"Europe/Simferopol\",\n        \"Europe/Volgograd\",\n        \"Europe/Minsk\"\n      ]\n    },\n    {\n      \"value\": \"Samara Time\",\n      \"abbr\": \"SAMT\",\n      \"offset\": 4,\n      \"isdst\": false,\n      \"text\": \"(UTC+04:00) Samara, Ulyanovsk, Saratov\",\n      \"utc\": [\n          \"Europe/Astrakhan\",\n        \"Europe/Samara\",\n          \"Europe/Ulyanovsk\"\n      ]\n    },\n    {\n      \"value\": \"Iran Standard Time\",\n      \"abbr\": \"IDT\",\n      \"offset\": 4.5,\n      \"isdst\": true,\n      \"text\": \"(UTC+03:30) Tehran\",\n      \"utc\": [\n        \"Asia/Tehran\"\n      ]\n    },\n    {\n      \"value\": \"Arabian Standard Time\",\n      \"abbr\": \"AST\",\n      \"offset\": 4,\n      \"isdst\": false,\n      \"text\": \"(UTC+04:00) Abu Dhabi, Muscat\",\n      \"utc\": [\n        \"Asia/Dubai\",\n        \"Asia/Muscat\",\n        \"Etc/GMT-4\"\n      ]\n    },\n    {\n      \"value\": \"Azerbaijan Standard Time\",\n      \"abbr\": \"ADT\",\n      \"offset\": 5,\n      \"isdst\": true,\n      \"text\": \"(UTC+04:00) Baku\",\n      \"utc\": [\n        \"Asia/Baku\"\n      ]\n    },\n    {\n      \"value\": \"Mauritius Standard Time\",\n      \"abbr\": \"MST\",\n      \"offset\": 4,\n      \"isdst\": false,\n      \"text\": \"(UTC+04:00) Port Louis\",\n      \"utc\": [\n        \"Indian/Mahe\",\n        \"Indian/Mauritius\",\n        \"Indian/Reunion\"\n      ]\n    },\n    {\n      \"value\": \"Georgian Standard Time\",\n      \"abbr\": \"GET\",\n      \"offset\": 4,\n      \"isdst\": false,\n      \"text\": \"(UTC+04:00) Tbilisi\",\n      \"utc\": [\n        \"Asia/Tbilisi\"\n      ]\n    },\n    {\n      \"value\": \"Caucasus Standard Time\",\n      \"abbr\": \"CST\",\n      \"offset\": 4,\n      \"isdst\": false,\n      \"text\": \"(UTC+04:00) Yerevan\",\n      \"utc\": [\n        \"Asia/Yerevan\"\n      ]\n    },\n    {\n      \"value\": \"Afghanistan Standard Time\",\n      \"abbr\": \"AST\",\n      \"offset\": 4.5,\n      \"isdst\": false,\n      \"text\": \"(UTC+04:30) Kabul\",\n      \"utc\": [\n        \"Asia/Kabul\"\n      ]\n    },\n    {\n      \"value\": \"West Asia Standard Time\",\n      \"abbr\": \"WAST\",\n      \"offset\": 5,\n      \"isdst\": false,\n      \"text\": \"(UTC+05:00) Ashgabat, Tashkent\",\n      \"utc\": [\n        \"Antarctica/Mawson\",\n        \"Asia/Aqtau\",\n        \"Asia/Aqtobe\",\n        \"Asia/Ashgabat\",\n        \"Asia/Dushanbe\",\n        \"Asia/Oral\",\n        \"Asia/Samarkand\",\n        \"Asia/Tashkent\",\n        \"Etc/GMT-5\",\n        \"Indian/Kerguelen\",\n        \"Indian/Maldives\"\n      ]\n    },\n    {\n      \"value\": \"Yekaterinburg Time\",\n      \"abbr\": \"YEKT\",\n      \"offset\": 5,\n      \"isdst\": false,\n      \"text\": \"(UTC+05:00) Yekaterinburg\",\n      \"utc\": [\n        \"Asia/Yekaterinburg\"\n      ]\n    },\n    {\n      \"value\": \"Pakistan Standard Time\",\n      \"abbr\": \"PKT\",\n      \"offset\": 5,\n      \"isdst\": false,\n      \"text\": \"(UTC+05:00) Islamabad, Karachi\",\n      \"utc\": [\n        \"Asia/Karachi\"\n      ]\n    },\n    {\n      \"value\": \"India Standard Time\",\n      \"abbr\": \"IST\",\n      \"offset\": 5.5,\n      \"isdst\": false,\n      \"text\": \"(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi\",\n      \"utc\": [\n        \"Asia/Kolkata\"\n      ]\n    },\n    {\n      \"value\": \"Sri Lanka Standard Time\",\n      \"abbr\": \"SLST\",\n      \"offset\": 5.5,\n      \"isdst\": false,\n      \"text\": \"(UTC+05:30) Sri Jayawardenepura\",\n      \"utc\": [\n        \"Asia/Colombo\"\n      ]\n    },\n    {\n      \"value\": \"Nepal Standard Time\",\n      \"abbr\": \"NST\",\n      \"offset\": 5.75,\n      \"isdst\": false,\n      \"text\": \"(UTC+05:45) Kathmandu\",\n      \"utc\": [\n        \"Asia/Kathmandu\"\n      ]\n    },\n    {\n      \"value\": \"Central Asia Standard Time\",\n      \"abbr\": \"CAST\",\n      \"offset\": 6,\n      \"isdst\": false,\n      \"text\": \"(UTC+06:00) Nur-Sultan (Astana)\",\n      \"utc\": [\n        \"Antarctica/Vostok\",\n        \"Asia/Almaty\",\n        \"Asia/Bishkek\",\n        \"Asia/Qyzylorda\",\n        \"Asia/Urumqi\",\n        \"Etc/GMT-6\",\n        \"Indian/Chagos\"\n      ]\n    },\n    {\n      \"value\": \"Bangladesh Standard Time\",\n      \"abbr\": \"BST\",\n      \"offset\": 6,\n      \"isdst\": false,\n      \"text\": \"(UTC+06:00) Dhaka\",\n      \"utc\": [\n        \"Asia/Dhaka\",\n        \"Asia/Thimphu\"\n      ]\n    },\n    {\n      \"value\": \"Myanmar Standard Time\",\n      \"abbr\": \"MST\",\n      \"offset\": 6.5,\n      \"isdst\": false,\n      \"text\": \"(UTC+06:30) Yangon (Rangoon)\",\n      \"utc\": [\n        \"Asia/Rangoon\",\n        \"Indian/Cocos\"\n      ]\n    },\n    {\n      \"value\": \"SE Asia Standard Time\",\n      \"abbr\": \"SAST\",\n      \"offset\": 7,\n      \"isdst\": false,\n      \"text\": \"(UTC+07:00) Bangkok, Hanoi, Jakarta\",\n      \"utc\": [\n        \"Antarctica/Davis\",\n        \"Asia/Bangkok\",\n        \"Asia/Hovd\",\n        \"Asia/Jakarta\",\n        \"Asia/Phnom_Penh\",\n        \"Asia/Pontianak\",\n        \"Asia/Saigon\",\n        \"Asia/Vientiane\",\n        \"Etc/GMT-7\",\n        \"Indian/Christmas\"\n      ]\n    },\n    {\n      \"value\": \"N. Central Asia Standard Time\",\n      \"abbr\": \"NCAST\",\n      \"offset\": 7,\n      \"isdst\": false,\n      \"text\": \"(UTC+07:00) Novosibirsk\",\n      \"utc\": [\n        \"Asia/Novokuznetsk\",\n        \"Asia/Novosibirsk\",\n        \"Asia/Omsk\"\n      ]\n    },\n    {\n      \"value\": \"China Standard Time\",\n      \"abbr\": \"CST\",\n      \"offset\": 8,\n      \"isdst\": false,\n      \"text\": \"(UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi\",\n      \"utc\": [\n        \"Asia/Hong_Kong\",\n        \"Asia/Macau\",\n        \"Asia/Shanghai\"\n      ]\n    },\n    {\n      \"value\": \"North Asia Standard Time\",\n      \"abbr\": \"NAST\",\n      \"offset\": 8,\n      \"isdst\": false,\n      \"text\": \"(UTC+08:00) Krasnoyarsk\",\n      \"utc\": [\n        \"Asia/Krasnoyarsk\"\n      ]\n    },\n    {\n      \"value\": \"Singapore Standard Time\",\n      \"abbr\": \"MPST\",\n      \"offset\": 8,\n      \"isdst\": false,\n      \"text\": \"(UTC+08:00) Kuala Lumpur, Singapore\",\n      \"utc\": [\n        \"Asia/Brunei\",\n        \"Asia/Kuala_Lumpur\",\n        \"Asia/Kuching\",\n        \"Asia/Makassar\",\n        \"Asia/Manila\",\n        \"Asia/Singapore\",\n        \"Etc/GMT-8\"\n      ]\n    },\n    {\n      \"value\": \"W. Australia Standard Time\",\n      \"abbr\": \"WAST\",\n      \"offset\": 8,\n      \"isdst\": false,\n      \"text\": \"(UTC+08:00) Perth\",\n      \"utc\": [\n        \"Antarctica/Casey\",\n        \"Australia/Perth\"\n      ]\n    },\n    {\n      \"value\": \"Taipei Standard Time\",\n      \"abbr\": \"TST\",\n      \"offset\": 8,\n      \"isdst\": false,\n      \"text\": \"(UTC+08:00) Taipei\",\n      \"utc\": [\n        \"Asia/Taipei\"\n      ]\n    },\n    {\n      \"value\": \"Ulaanbaatar Standard Time\",\n      \"abbr\": \"UST\",\n      \"offset\": 8,\n      \"isdst\": false,\n      \"text\": \"(UTC+08:00) Ulaanbaatar\",\n      \"utc\": [\n        \"Asia/Choibalsan\",\n        \"Asia/Ulaanbaatar\"\n      ]\n    },\n    {\n      \"value\": \"North Asia East Standard Time\",\n      \"abbr\": \"NAEST\",\n      \"offset\": 8,\n      \"isdst\": false,\n      \"text\": \"(UTC+08:00) Irkutsk\",\n      \"utc\": [\n        \"Asia/Irkutsk\"\n      ]\n    },\n    {\n      \"value\": \"Japan Standard Time\",\n      \"abbr\": \"JST\",\n      \"offset\": 9,\n      \"isdst\": false,\n      \"text\": \"(UTC+09:00) Osaka, Sapporo, Tokyo\",\n      \"utc\": [\n        \"Asia/Dili\",\n        \"Asia/Jayapura\",\n        \"Asia/Tokyo\",\n        \"Etc/GMT-9\",\n        \"Pacific/Palau\"\n      ]\n    },\n    {\n      \"value\": \"Korea Standard Time\",\n      \"abbr\": \"KST\",\n      \"offset\": 9,\n      \"isdst\": false,\n      \"text\": \"(UTC+09:00) Seoul\",\n      \"utc\": [\n        \"Asia/Pyongyang\",\n        \"Asia/Seoul\"\n      ]\n    },\n    {\n      \"value\": \"Cen. Australia Standard Time\",\n      \"abbr\": \"CAST\",\n      \"offset\": 9.5,\n      \"isdst\": false,\n      \"text\": \"(UTC+09:30) Adelaide\",\n      \"utc\": [\n        \"Australia/Adelaide\",\n        \"Australia/Broken_Hill\"\n      ]\n    },\n    {\n      \"value\": \"AUS Central Standard Time\",\n      \"abbr\": \"ACST\",\n      \"offset\": 9.5,\n      \"isdst\": false,\n      \"text\": \"(UTC+09:30) Darwin\",\n      \"utc\": [\n        \"Australia/Darwin\"\n      ]\n    },\n    {\n      \"value\": \"E. Australia Standard Time\",\n      \"abbr\": \"EAST\",\n      \"offset\": 10,\n      \"isdst\": false,\n      \"text\": \"(UTC+10:00) Brisbane\",\n      \"utc\": [\n        \"Australia/Brisbane\",\n        \"Australia/Lindeman\"\n      ]\n    },\n    {\n      \"value\": \"AUS Eastern Standard Time\",\n      \"abbr\": \"AEST\",\n      \"offset\": 10,\n      \"isdst\": false,\n      \"text\": \"(UTC+10:00) Canberra, Melbourne, Sydney\",\n      \"utc\": [\n        \"Australia/Melbourne\",\n        \"Australia/Sydney\"\n      ]\n    },\n    {\n      \"value\": \"West Pacific Standard Time\",\n      \"abbr\": \"WPST\",\n      \"offset\": 10,\n      \"isdst\": false,\n      \"text\": \"(UTC+10:00) Guam, Port Moresby\",\n      \"utc\": [\n        \"Antarctica/DumontDUrville\",\n        \"Etc/GMT-10\",\n        \"Pacific/Guam\",\n        \"Pacific/Port_Moresby\",\n        \"Pacific/Saipan\",\n        \"Pacific/Truk\"\n      ]\n    },\n    {\n      \"value\": \"Tasmania Standard Time\",\n      \"abbr\": \"TST\",\n      \"offset\": 10,\n      \"isdst\": false,\n      \"text\": \"(UTC+10:00) Hobart\",\n      \"utc\": [\n        \"Australia/Currie\",\n        \"Australia/Hobart\"\n      ]\n    },\n    {\n      \"value\": \"Yakutsk Standard Time\",\n      \"abbr\": \"YST\",\n      \"offset\": 9,\n      \"isdst\": false,\n      \"text\": \"(UTC+09:00) Yakutsk\",\n      \"utc\": [\n        \"Asia/Chita\",\n        \"Asia/Khandyga\",\n        \"Asia/Yakutsk\"\n      ]\n    },\n    {\n      \"value\": \"Central Pacific Standard Time\",\n      \"abbr\": \"CPST\",\n      \"offset\": 11,\n      \"isdst\": false,\n      \"text\": \"(UTC+11:00) Solomon Is., New Caledonia\",\n      \"utc\": [\n        \"Antarctica/Macquarie\",\n        \"Etc/GMT-11\",\n        \"Pacific/Efate\",\n        \"Pacific/Guadalcanal\",\n        \"Pacific/Kosrae\",\n        \"Pacific/Noumea\",\n        \"Pacific/Ponape\"\n      ]\n    },\n    {\n      \"value\": \"Vladivostok Standard Time\",\n      \"abbr\": \"VST\",\n      \"offset\": 11,\n      \"isdst\": false,\n      \"text\": \"(UTC+11:00) Vladivostok\",\n      \"utc\": [\n        \"Asia/Sakhalin\",\n        \"Asia/Ust-Nera\",\n        \"Asia/Vladivostok\"\n      ]\n    },\n    {\n      \"value\": \"New Zealand Standard Time\",\n      \"abbr\": \"NZST\",\n      \"offset\": 12,\n      \"isdst\": false,\n      \"text\": \"(UTC+12:00) Auckland, Wellington\",\n      \"utc\": [\n        \"Antarctica/McMurdo\",\n        \"Pacific/Auckland\"\n      ]\n    },\n    {\n      \"value\": \"UTC+12\",\n      \"abbr\": \"U\",\n      \"offset\": 12,\n      \"isdst\": false,\n      \"text\": \"(UTC+12:00) Coordinated Universal Time+12\",\n      \"utc\": [\n        \"Etc/GMT-12\",\n        \"Pacific/Funafuti\",\n        \"Pacific/Kwajalein\",\n        \"Pacific/Majuro\",\n        \"Pacific/Nauru\",\n        \"Pacific/Tarawa\",\n        \"Pacific/Wake\",\n        \"Pacific/Wallis\"\n      ]\n    },\n    {\n      \"value\": \"Fiji Standard Time\",\n      \"abbr\": \"FST\",\n      \"offset\": 12,\n      \"isdst\": false,\n      \"text\": \"(UTC+12:00) Fiji\",\n      \"utc\": [\n        \"Pacific/Fiji\"\n      ]\n    },\n    {\n      \"value\": \"Magadan Standard Time\",\n      \"abbr\": \"MST\",\n      \"offset\": 12,\n      \"isdst\": false,\n      \"text\": \"(UTC+12:00) Magadan\",\n      \"utc\": [\n        \"Asia/Anadyr\",\n        \"Asia/Kamchatka\",\n        \"Asia/Magadan\",\n        \"Asia/Srednekolymsk\"\n      ]\n    },\n    {\n      \"value\": \"Kamchatka Standard Time\",\n      \"abbr\": \"KDT\",\n      \"offset\": 13,\n      \"isdst\": true,\n      \"text\": \"(UTC+12:00) Petropavlovsk-Kamchatsky - Old\",\n      \"utc\": [\n        \"Asia/Kamchatka\"\n      ]\n    },\n    {\n      \"value\": \"Tonga Standard Time\",\n      \"abbr\": \"TST\",\n      \"offset\": 13,\n      \"isdst\": false,\n      \"text\": \"(UTC+13:00) Nuku'alofa\",\n      \"utc\": [\n        \"Etc/GMT-13\",\n        \"Pacific/Enderbury\",\n        \"Pacific/Fakaofo\",\n        \"Pacific/Tongatapu\"\n      ]\n    },\n    {\n      \"value\": \"Samoa Standard Time\",\n      \"abbr\": \"SST\",\n      \"offset\": 13,\n      \"isdst\": false,\n      \"text\": \"(UTC+13:00) Samoa\",\n      \"utc\": [\n        \"Pacific/Apia\"\n      ]\n    }\n  ];\n\nexport const TIMEZONES_IANA = unique(flatten(TIMEZONES.map(_ => _.utc))).sort();\n","import {\n    uploadFiles,\n    Upload,\n    humanReadableByteCount,\n} from '@placeos/cloud-uploads';\nimport { Observable } from 'rxjs';\nimport { takeWhile } from 'rxjs/operators';\n\nimport { randomInt } from './general';\n\nimport * as blobUtil from 'blob-util';\n\nexport interface UploadDetails {\n    /** Unique ID for the upload */\n    id: number;\n    /** Name of the file uploaded */\n    name: string;\n    /** Progress of the file upload */\n    progress: number;\n    /** Link to the uploaded file */\n    link: string;\n    /** Formatted file size */\n    formatted_size: string;\n    /** Size of the file being uploaded */\n    size: number;\n    /** Error with upload request */\n    error?: string;\n    /** Upload object associated with the file */\n    upload: Upload;\n}\n\nexport type UploadPermissions = 'none' | 'support' | 'admin';\n\n/**\n * Upload the given file to the cloud\n * @param file File to upload\n */\nexport function uploadFile(\n    file: File,\n    pub: boolean = true,\n    permissions: UploadPermissions = 'none'\n): Observable<UploadDetails> {\n    return new Observable((observer) => {\n        const fileReader = new FileReader();\n        fileReader.addEventListener('loadend', (e: any) => {\n            const arrayBuffer = e.target.result;\n            const blob = blobUtil.arrayBufferToBlob(arrayBuffer, file.type);\n            const upload_list = uploadFiles([blob], {\n                file_name: file.name,\n                permissions,\n                public: pub,\n            } as any);\n            const upload = upload_list[0];\n            const upload_details: UploadDetails = {\n                id: randomInt(9999_9999_9999),\n                name: file.name,\n                progress: 0,\n                link: '',\n                formatted_size: humanReadableByteCount(file.size),\n                size: file.size,\n                upload,\n            };\n            upload.status\n                .pipe(takeWhile((_) => _.status !== 'complete', true))\n                .subscribe((state) => {\n                    if (upload.access_url) {\n                        upload_details.link = !pub\n                            ? `${\n                                  location.origin\n                              }/api/engine/v2/uploads/${encodeURIComponent(\n                                  upload.id\n                              )}/url`\n                            : upload.access_url;\n                    }\n                    upload_details.progress = state.progress;\n                    observer.next(upload_details);\n                    if (state.status === 'error')\n                        observer.error({\n                            ...upload_details,\n                            error: state.error,\n                        });\n                    if (state.status === 'complete') observer.complete();\n                });\n            observer.next(upload_details);\n        });\n        fileReader.readAsArrayBuffer(file);\n    });\n}\n","import { Injectable } from '@angular/core';\nimport { getModule } from '@placeos/ts-client';\nimport { BehaviorSubject, combineLatest, of, Subject } from 'rxjs';\nimport { filter, map, shareReplay, switchMap } from 'rxjs/operators';\n\nimport { AsyncHandler } from './async-handler.class';\nimport { log, randomInt, randomString } from './general';\n\nexport interface ClientEvent {\n    id: string;\n    device_id: string;\n    type: 'network' | 'console' | 'dom';\n    subtype: string;\n    timestamp: number;\n    raw: any;\n    data: any;\n    metadata: any;\n}\n\nfunction hookMethod<T, K extends keyof T>(\n    rootObject: T,\n    functionToHook: K,\n    hookingFunction: (...args: any[]) => void\n): T[K] {\n    var previousFunction = rootObject[functionToHook];\n    (rootObject as any)[functionToHook] = (...args: any[]) => {\n        hookingFunction(args);\n        (previousFunction as any).call(rootObject, ...args);\n    };\n    return previousFunction;\n}\n\nlet DEVICE_ID =\n    localStorage.getItem('PLACEOS.DEVICE_ID') || `DEV-${randomString(8)}`;\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class RemoteLoggingService extends AsyncHandler {\n    private _disable_handling: boolean = false;\n    private _system_id = new BehaviorSubject<string>('');\n    private _events = new Subject<ClientEvent>();\n\n    private _event_history = this._events.pipe(shareReplay(20000));\n    private _metadata = null;\n\n    private _logging_bindings = this._system_id.pipe(\n        filter((_) => !!_),\n        switchMap((id) => combineLatest([of(id), this._bindTo(id, 'enabled')])),\n        filter(([_, enabled]) => !!enabled),\n        map(([id]) =>\n            this.subscription(\n                'post_events',\n                this._event_history.subscribe(async (d) => {\n                    this._disable_handling = true;\n                    await getModule(id, 'Logger')\n                        .execute('post_event', [d])\n                        .catch();\n                    this._disable_handling = false;\n                })\n            )\n        )\n    );\n\n    public readonly history = this._event_history;\n\n    public setMetadata(metadata: any) {}\n\n    constructor() {\n        super();\n        localStorage.setItem('PLACEOS.DEVICE_ID', DEVICE_ID);\n        this._patchConsoleMethods();\n        this._logging_bindings.subscribe();\n        log('Logger', 'Remote logging initialised...');\n    }\n\n    public setSystem(id: string) {\n        this._system_id.next(id);\n    }\n\n    private _patchConsoleMethods() {\n        const types: (keyof Console)[] = [\n            'log',\n            'debug',\n            'info',\n            'warn',\n            'error',\n        ];\n        for (const key of types) {\n            hookMethod(console, key, (...args) => this._handleEvent(key, args));\n        }\n    }\n\n    private _handleEvent(type: string, data: any, event_type: any = 'console') {\n        if (data.includes('\"Logger\"') || this._disable_handling) return;\n        const blob = [...data[0]];\n        blob[0] =\n            typeof blob[0] === 'string' ? blob[0].replace(/\\%c/g, '') : blob[0];\n        this._events.next({\n            id: `${event_type}-${randomInt(99999_99999)}`,\n            device_id: DEVICE_ID,\n            type: event_type,\n            subtype: type,\n            timestamp: Date.now(),\n            raw: data,\n            data: blob.filter(\n                (_) => typeof _ !== 'string' || !_.startsWith('color:')\n            ),\n            metadata: this._metadata || null,\n        });\n    }\n\n    /** List to binding */\n    private _bindTo(id: string, name: string, mod: string = 'Logger') {\n        const module = getModule(id, mod).binding(name);\n        this.subscription(`bind:${name}`, module.bind());\n        return module.listen();\n    }\n}\n","import { addMilliseconds } from 'date-fns';\nimport { getTimezoneOffset } from 'date-fns-tz';\n\nexport const LOCAL_TIMEZONE =\n    Intl?.DateTimeFormat()?.resolvedOptions()?.timeZone || 'Australia/Sydney';\n\nexport function localToTimezone(\n    date: Date | number,\n    tz: string = LOCAL_TIMEZONE,\n) {\n    const offset_diff =\n        getTimezoneOffset(tz) - getTimezoneOffset(LOCAL_TIMEZONE);\n    return addMilliseconds(date, offset_diff).valueOf();\n}\n\nexport function timezoneToLocal(\n    date: Date | number,\n    tz: string = LOCAL_TIMEZONE,\n) {\n    const offset_diff =\n        getTimezoneOffset(LOCAL_TIMEZONE) - getTimezoneOffset(tz);\n    return addMilliseconds(date, offset_diff).valueOf();\n}\nexport function getTimezoneOffsetInMinutes(timeZone, date = new Date()) {\n    const options: Intl.DateTimeFormatOptions = {\n        timeZone,\n        hour12: false,\n        timeZoneName: 'short',\n    };\n    const formatter = new Intl.DateTimeFormat([], options);\n    const parts = formatter.formatToParts(date);\n\n    // Find the timeZoneName part which contains the GMT offset\n    const tzOffsetPart = parts.find((part) => part.type === 'timeZoneName');\n    const tzOffsetString = tzOffsetPart ? tzOffsetPart.value : 'GMT';\n\n    // Match the offset from the string (e.g., \"GMT+0530\")\n    const offsetMatch = tzOffsetString.match(/GMT([+-])(\\d{1,2})(\\d{2})?/);\n    if (!offsetMatch) {\n        return 0; // If no match, assume UTC (offset 0)\n    }\n\n    const sign = offsetMatch[1] === '+' ? 1 : -1;\n    const hours = parseInt(offsetMatch[2], 10);\n    const minutes = offsetMatch[3] ? parseInt(offsetMatch[3], 10) : 0;\n\n    return sign * (hours * 60 + minutes);\n}\n\nexport function getTimezoneDifferenceInHours(\n    src_tz: string,\n    dest_tz: string = LOCAL_TIMEZONE,\n    date: Date = new Date(),\n) {\n    const offset1 = getTimezoneOffsetInMinutes(src_tz, date);\n    const offset2 = getTimezoneOffsetInMinutes(dest_tz, date);\n\n    // Calculate the difference in hours\n    return (offset1 - offset2) / 60;\n}\n","import { addMinutes, isAfter, isBefore } from 'date-fns';\nimport { User } from 'libs/users/src/lib/user.class';\n\nexport interface BookingRuleset {\n    id?: string;\n    name?: string;\n    zone: string;\n    rules: BookingRules;\n    conditions: BookingRuleConditions;\n}\n\nexport interface BookingRules {\n    auto_approve?: boolean;\n    hidden?: boolean;\n}\n\nexport interface BookableResource extends Record<string, any> {\n    id: string;\n    zones?: string[];\n    zone?: { id: string; name: string };\n}\n\nexport interface BookingRuleDetails {\n    resource: BookableResource;\n    date: number;\n    duration: number;\n    host: User;\n}\n\nexport interface BookingRuleConditions {\n    /** List of user groups that the host must be in */\n    groups?: string[];\n    /** List of locations that the host must be */\n    locations?: string[];\n    /** Minimum length of a booking */\n    min_length?: number;\n    /** Maximum length of a booking */\n    max_length?: number;\n    /** How far in the future this bookings are allowed */\n    is_before?: string;\n    /** How far in the future this bookings must be */\n    is_after?: string;\n    /** How far in the future this bookings must be */\n    is_between?: [number, number];\n    /** Between the selected date/times */\n    is_period?: [number, number];\n    /** List of resources that this rule applies to */\n    resource_ids?: string[];\n}\n\nconst MINUTE = 1;\nconst HOUR = 60;\nconst DAY = 24 * HOUR;\nconst WEEK = 7 * DAY;\nconst MONTH = 30 * DAY;\n\nconst DURATION_MAP: { [duration: string]: number } = {\n    month: MONTH,\n    months: MONTH,\n    week: WEEK,\n    weeks: WEEK,\n    day: DAY,\n    days: DAY,\n    hour: HOUR,\n    hours: HOUR,\n    minute: MINUTE,\n    minutes: MINUTE,\n};\n\nconst DEFAULT_RULES: BookingRules = {\n    auto_approve: true,\n    hidden: false,\n};\n\n/**\n * Conver time string into minutes\n * @param str timestring e.g. `'1 day'`, `'15 minutes'`, `'2 weeks'`\n */\nexport function stringToMinutes(str: string): number {\n    const parts = (str || '').split(' ');\n    return parts.length > 1\n        ? +parts[0] * DURATION_MAP[parts[1].toLowerCase()]\n        : 0;\n}\n\nexport function addToDate(add: string, date: Date | number = new Date()) {\n    return addMinutes(date, stringToMinutes(add));\n}\n\nexport function filterResourcesFromRules(\n    resources: BookableResource[],\n    details: BookingRuleDetails,\n    ruleset_list: BookingRuleset[]\n) {\n    return resources.filter(\n        (_) =>\n            !rulesForResource({ ...details, resource: _ }, ruleset_list)?.hidden\n    );\n}\n\nexport function rulesForResource(\n    details: BookingRuleDetails,\n    ruleset_list: BookingRuleset[]\n): BookingRules {\n    if (!(ruleset_list instanceof Array)) return DEFAULT_RULES;\n    for (const ruleset of ruleset_list) {\n        if (\n            ruleset.zone === '*' ||\n            ruleset.zone === details.resource.zone?.id ||\n            details.resource.zones?.includes(ruleset.zone)\n        ) {\n            if (checkRulesMatch(details, ruleset)) {\n                // console.log(\n                //     'Matched Ruleset:',\n                //     details.resource.id,\n                //     details,\n                //     ruleset\n                // );\n                return ruleset.rules;\n            }\n        }\n    }\n    // console.log(\n    //     'No Matched Ruleset:',\n    //     details.resource.id,\n    //     details,\n    //     DEFAULT_RULES\n    // );\n    return DEFAULT_RULES;\n}\n\nexport function checkRulesMatch(\n    { date, duration, host, resource }: BookingRuleDetails,\n    ruleset: BookingRuleset\n): boolean {\n    const date_obj = new Date(date);\n    let matches = 0;\n    const { conditions } = ruleset;\n    if (!conditions) return true;\n    if (\n        conditions.groups instanceof Array &&\n        conditions.groups.every((_) => host?.groups?.includes(_))\n    )\n        matches += 1;\n    if (\n        conditions.is_before &&\n        isBefore(addMinutes(date, duration), addToDate(conditions.is_before))\n    )\n        matches += 1;\n    if (conditions.is_after && isAfter(date, addToDate(conditions.is_after)))\n        matches += 1;\n    if (conditions.min_length && conditions.min_length <= duration)\n        matches += 1;\n    if (\n        conditions.is_between &&\n        date_obj.getHours() + date_obj.getMinutes() / 60 >=\n            conditions.is_between[0] &&\n        date_obj.getHours() + date_obj.getMinutes() / 60 <\n            conditions.is_between[1]\n    )\n        matches += 1;\n    if (\n        conditions.is_period &&\n        date >= conditions.is_period[0] &&\n        date < conditions.is_period[1]\n    )\n        matches += 1;\n    if (conditions.max_length && conditions.max_length >= duration)\n        matches += 1;\n    if (\n        conditions.resource_ids &&\n        conditions.resource_ids.includes(resource.id)\n    )\n        matches += 1;\n    if (conditions.locations && conditions.locations.includes(resource.name))\n        matches += 1;\n    return matches >= Object.keys(conditions).length;\n}\n","import { Component, Inject } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { UploadPermissions } from '@placeos/common';\n\n@Component({\n    selector: 'upload-permissions-modal',\n    template: `\n        <header>\n            <h2>Upload File</h2>\n            <button btn icon mat-dialog-close>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main class=\"p-4 min-w-[20rem]\">\n            <div class=\"flex flex-col space-y-2\">\n                <label>File Name</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        [ngModel]=\"file.name\"\n                        disabled=\"true\"\n                        placeholder=\"File Name\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"pb-4\">\n                <mat-checkbox [(ngModel)]=\"is_public\">Public</mat-checkbox>\n            </div>\n            <div class=\"flex flex-col space-y-2\" *ngIf=\"!is_public\">\n                <label>Permissions</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"permissions\">\n                        <mat-option value=\"none\">None</mat-option>\n                        <mat-option value=\"support\">Support</mat-option>\n                        <mat-option value=\"admin\">Admin</mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n        </main>\n        <footer\n            class=\"flex items-center justify-end space-x-2 px-4 py-2 border-t border-base-200\"\n        >\n            <button btn class=\"inverse w-32\" mat-dialog-close>Cancel</button>\n            <button\n                btn\n                class=\"w-32\"\n                [mat-dialog-close]=\"{ file, is_public, permissions }\"\n            >\n                Upload\n            </button>\n        </footer>\n    `,\n    styles: [``],\n})\nexport class UploadPermissionsModalComponent {\n    /** File to upload */\n    public readonly file: File = this._data.file;\n    /** Whether file should be public */\n    public is_public: boolean = true;\n    /** Permissions for file */\n    public permissions: UploadPermissions = 'none';\n\n    constructor(\n        private _dialog_ref: MatDialogRef<UploadPermissionsModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: { file: File }\n    ) {\n        this.file = this._data.file;\n    }\n\n    public close() {\n        this._dialog_ref.close();\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { UploadDetails, UploadPermissions, uploadFile } from './uploads';\nimport { MatDialog } from '@angular/material/dialog';\nimport { UploadPermissionsModalComponent } from 'libs/components/src/lib/upload-permissions-modal.component';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class UploadsService {\n    private _upload_list = new BehaviorSubject<UploadDetails[]>([]);\n\n    public readonly upload_list = this._upload_list.asObservable();\n\n    constructor(private _dialog: MatDialog) {\n        if (localStorage) {\n            this._upload_list.next(\n                JSON.parse(localStorage.getItem('BACKOFFICE.uploads') || '[]')\n            );\n        }\n    }\n\n    public clearList() {\n        const in_progress_list = this._upload_list\n            .getValue()\n            .filter((file) => file.progress < 100 && !file.error);\n        this._upload_list.next(in_progress_list);\n    }\n\n    public uploadFileWithPermissions(file: File) {\n        return new Promise<number>((resolve, reject) => {\n            const ref = this._dialog.open(UploadPermissionsModalComponent, {\n                data: { file },\n            });\n            ref.afterClosed().subscribe(async (details) => {\n                if (details) {\n                    const id = await this.uploadFile(\n                        details.file,\n                        details.is_public,\n                        details.permissions\n                    ).catch((e) => {\n                        reject(e);\n                        throw e;\n                    });\n                    resolve(id);\n                } else reject();\n            });\n        });\n    }\n\n    public uploadFile(\n        file: File,\n        pub: boolean = true,\n        permissions: UploadPermissions = 'none'\n    ) {\n        return new Promise<number>((resolve) => {\n            let resolved = false;\n            const update_fn = (details) => {\n                if (!resolved) {\n                    resolve(details.id);\n                    resolved = true;\n                }\n                this._upload_list.next([\n                    ...this._upload_list\n                        .getValue()\n                        .filter((_) => _.id !== details.id),\n                    details,\n                ]);\n            };\n            uploadFile(file, pub, permissions).subscribe(\n                update_fn,\n                update_fn,\n                () => this._updateUploadHistory()\n            );\n        });\n    }\n\n    private _updateUploadHistory() {\n        const done_list = this._upload_list\n            .getValue()\n            .filter((file) => file.progress >= 100);\n        done_list.forEach((i) => delete i.upload);\n        if (localStorage) {\n            localStorage.setItem('PLACEOS.uploads', JSON.stringify(done_list));\n        }\n    }\n}\n","let _wake_lock: WakeLockSentinel | null = null;\n\nexport async function requestScreenWakeLock() {\n    if (_wake_lock) {\n        await _wake_lock.release();\n    }\n    // create an async function to request a wake lock\n    try {\n        _wake_lock = await navigator.wakeLock.request('screen');\n    } catch (err) {\n        throw err;\n    }\n}\n\ndocument.addEventListener('visibilitychange', async () => {\n    if (_wake_lock !== null && document.visibilityState === 'visible') {\n        _wake_lock = await navigator.wakeLock.request('screen');\n    }\n});\n","import {\n    Directive,\n    Input,\n    SimpleChanges,\n    OnInit,\n    OnChanges,\n    OnDestroy,\n    ElementRef,\n    Renderer2,\n    EventEmitter,\n    Output,\n} from '@angular/core';\nimport { onlineState, authority, getModule } from '@placeos/ts-client';\n\nimport { AsyncHandler } from '@placeos/common';\nimport { filter, first } from 'rxjs/operators';\n\n@Directive({\n    selector: 'i[bind], [binding], co-bind',\n})\nexport class BindingDirective<T = any>\n    extends AsyncHandler\n    implements OnInit, OnChanges, OnDestroy\n{\n    /** ID of the system to bind */\n    @Input() public sys: string = '';\n    /** Class name of the module to bind */\n    @Input() public mod: string = '';\n    /** Index of the system to bind */\n    @Input() public index = 1;\n    /** Status variable to bind to */\n    @Input() public bind: string = '';\n    /** Method to execute */\n    @Input() public exec: string = '';\n    /** Method to execute */\n    @Input() public delay: number = 100;\n    /** Event to listen for on the parent */\n    @Input('onEvent') public on_event: string = '';\n    /** ID of the system to bind to */\n    @Input() public params: any[] = null;\n    @Input() public ignore: boolean = false;\n    /** Current value of the binding */\n    @Input() public model: T | null = null;\n    /** Emitter for changes to the value of the binding */\n    @Output() public modelChange = new EventEmitter<T | null>();\n\n    private _binding = false;\n    private _old_model: T | null = null;\n\n    constructor(\n        private _element: ElementRef<HTMLElement>,\n        private _renderer: Renderer2\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        onlineState()\n            ?.pipe(first((_) => _))\n            .subscribe((_) => this.bindVariable());\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.sys || changes.mod || changes.bind) {\n            this.bindVariable();\n        }\n        if (\n            changes.model &&\n            this._old_model !== this.model &&\n            this.model != null\n        ) {\n            this._old_model = this.model;\n            this.execute();\n        }\n        if (changes.on_event && this.on_event) {\n            this.subscription(\n                'on_event',\n                this._renderer.listen(\n                    this._element.nativeElement,\n                    this.on_event,\n                    () => this.execute()\n                )\n            );\n        }\n    }\n\n    /** Bind to set status variable */\n    private bindVariable() {\n        if (\n            authority() &&\n            this.bind &&\n            this.sys &&\n            this.mod &&\n            !this._binding\n        ) {\n            this.timeout(\n                'bind',\n                () => {\n                    const module = getModule(this.sys, this.mod, this.index);\n                    const binding = module.binding(this.bind);\n                    this._binding = true;\n                    this.subscription('binding', binding.bind());\n                    this.subscription(\n                        'on_changes',\n                        binding\n                            .listen()\n                            .pipe(filter((_) => _ != null))\n                            .subscribe((value) => {\n                                setTimeout(() => {\n                                    this._binding = false;\n                                    this.clearTimeout('bound');\n                                    if (this.ignore) return;\n                                    this.model = value;\n                                    this._old_model = this.model;\n                                    this.modelChange.emit(this.model);\n                                }, 10);\n                            })\n                    );\n                    this.timeout('bound', () => (this._binding = false), 200);\n                },\n                20\n            );\n        }\n    }\n\n    /** Excute the set method on the module */\n    private execute() {\n        if (\n            authority() &&\n            this.exec &&\n            this.sys &&\n            this.mod &&\n            !this._timers['execute']\n        ) {\n            this.timeout(\n                'execute',\n                () => {\n                    const module = getModule(this.sys, this.mod, this.index);\n                    let params = this.params;\n                    if (this.bind) params = this.params || [this.model];\n                    module.execute(this.exec, params || []).then((result) => {\n                        // Emit exec result if not bound to status variable\n                        if (!this.bind) {\n                            this.model = result;\n                            this._old_model = this.model;\n                            this.modelChange.emit(this.model);\n                        }\n                    });\n                },\n                this.delay\n            );\n        }\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { User } from 'libs/users/src/lib/user.class';\n\n@Component({\n    selector: 'a-user-avatar',\n    template: `\n        <div\n            class=\"flex items-center justify-center rounded-full overflow-hidden\"\n            *ngIf=\"user\"\n            [attr.user-id]=\"user.id\"\n        >\n            <div\n                initials\n                class=\"text-base-content text-opacity-80 uppercase\"\n                *ngIf=\"!user.photo; else image_state\"\n            >\n                {{ initials }}\n            </div>\n        </div>\n        <ng-template #image_state>\n            <img auth class=\"h-full w-full\" [source]=\"user.photo\" />\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host > div {\n                height: 2.5em;\n                width: 2.5em;\n                background-color: var(--b2);\n                overflow: hidden;\n                border: 2px solid var(--b1);\n            }\n\n            .initials {\n                font-size: 1em;\n            }\n        `,\n    ],\n})\nexport class UserAvatarComponent {\n    /** User to display avatar for */\n    @Input() public user: User;\n\n    public get initials(): string {\n        if (!this.user) return 'NA';\n        const name = this.user.name || '';\n        const parts = name.replace(/[()[\\]\\-+=\\\\/]+/gi, '').split(' ');\n        return parts.length > 1\n            ? `${parts[0][0]}${parts[parts.length - 1][0]}`\n            : name.slice(0, 2);\n    }\n}\n","import { RoomConfiguration } from '@placeos/common';\nimport { BuildingLevel } from 'libs/organisation/src/lib/level.class';\n\nimport { CalendarAvailability } from 'libs/calendar/src/lib/calendar.interfaces';\n\nexport type ResourceResponseStatus =\n    | 'needsAction'\n    | 'declined'\n    | 'tentative'\n    | 'accepted';\n\nexport class Space {\n    /** ID of the space resource */\n    public readonly id: string;\n    /** Display name of the space resource */\n    public readonly name: string;\n    /** Name to display */\n    public readonly display_name: string;\n    /** Email address of the resource associated with space */\n    public readonly email: string;\n    /** Capacity of the space resource */\n    public readonly capacity: number;\n    /** List of features available at the space resource  */\n    public readonly feature_list: string[];\n    /** URL to a supporting site for space */\n    public readonly support_url: string;\n    /** ID of the space on the associated map */\n    public readonly map_id: string;\n    /** Whether resource is bookable */\n    public readonly bookable: boolean;\n    /** List of zones the spaces is associated with */\n    public readonly zones: string[];\n    /** List of available room configurations for this room */\n    public readonly configurations: readonly RoomConfiguration[];\n    /** Image url */\n    public readonly images: string[];\n    /** Status of the resource */\n    public readonly response_status: ResourceResponseStatus;\n    /** Level Assoicated with the space */\n    public readonly level: BuildingLevel;\n    /** List of features associated with the space */\n    public readonly features: string[];\n\n    public readonly availability: CalendarAvailability[];\n\n    constructor(data: Partial<Space> = {}) {\n        this.id = data.id || '';\n        this.name = data.name || '';\n        this.display_name = data.display_name || '';\n        this.email = (data.email || '').toLowerCase();\n        this.capacity = data.capacity || -1;\n        this.feature_list = data.feature_list || (data.features as any) || [];\n        this.bookable = !!data.bookable;\n        this.zones = data.zones || [];\n        this.support_url = data.support_url || '';\n        this.map_id = data.map_id || '';\n        this.images = data.images || [];\n        this.configurations = data.configurations || [];\n        this.features = data.features || [];\n        this.response_status = data.response_status;\n        this.level = data.level || new BuildingLevel();\n        this.availability = data.availability || [];\n    }\n\n    public inUseAt(start: number, duration: number): boolean {\n        const end = start + duration * 60 * 1000;\n        return (\n            this.availability.filter(\n                (i) =>\n                    i.date == start &&\n                    i.date + i.duration * 60 * 1000 == end &&\n                    i.status !== 'free'\n            ).length > 0\n        );\n    }\n}\n","import { Optional, Pipe } from '@angular/core';\nimport { showSystem, querySystemsWithEmails } from '@placeos/ts-client';\n\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { Space } from './space.class';\nimport { first } from 'rxjs/operators';\n\nconst SPACE_LIST: Space[] = [];\nconst ATTEMPT_COUNT: Record<string, number> = {};\n\nconst EMPTY_SPACE = new Space({ email: 'empty.space@place.os' });\n\nexport function updateSpaceList(space_list: Space[]) {\n    for (const space of space_list) {\n        if (!SPACE_LIST.find(({ id }) => id === space.id)) {\n            SPACE_LIST.push(space);\n        }\n    }\n}\n\nsetInterval(() => {\n    for (const id in ATTEMPT_COUNT) {\n        ATTEMPT_COUNT[id] = ATTEMPT_COUNT[id] - 1;\n        if (ATTEMPT_COUNT[id] <= 0) {\n            delete ATTEMPT_COUNT[id];\n        }\n    }\n}, 10 * 1000);\n\n@Pipe({\n    name: 'space',\n})\nexport class SpacePipe {\n    constructor(@Optional() private _org?: OrganisationService) {}\n    /**\n     * Get details of the space with the given ID\n     * @param space_id ID or Email of the space\n     */\n    public async transform(space_id: string): Promise<Space> {\n        if (this._org) {\n            await this._org.initialised.pipe(first((_) => _)).toPromise();\n        }\n        const is_email = space_id?.includes('@');\n        if (!space_id) return EMPTY_SPACE;\n        let space = SPACE_LIST.find(\n            ({ id, email }) => id === space_id || email === space_id\n        );\n        if (space) return space;\n        if (ATTEMPT_COUNT[space_id]) return EMPTY_SPACE;\n        if (!is_email) {\n            const system = await showSystem(space_id)\n                .toPromise()\n                .catch((_) => null);\n            if (system) {\n                space = new Space({\n                    ...(system as any),\n                    level: this._org?.levelWithID([...system.zones]),\n                });\n                SPACE_LIST.push(space);\n                return space;\n            }\n        }\n        const systems = (\n            await querySystemsWithEmails({\n                in: space_id,\n                zone_id: this._org?.organisation.id,\n            }).toPromise()\n        ).data;\n        if (systems.length === 1) {\n            space = new Space({\n                ...(systems[0] as any),\n                level: this._org?.levelWithID([...systems[0].zones]),\n            });\n            SPACE_LIST.push(space);\n            return space;\n        }\n        return EMPTY_SPACE;\n    }\n\n    public updateSpaceList(space_list: Space[]) {\n        updateSpaceList(space_list);\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { querySystems, showSystem } from '@placeos/ts-client';\nimport { first, map } from 'rxjs/operators';\nimport { BehaviorSubject } from 'rxjs';\n\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\n\nimport { Space } from './space.class';\nimport { flatten, SettingsService, unique } from '@placeos/common';\nimport { SpacePipe } from './space.pipe';\n\nlet SPACE_PIPE: SpacePipe;\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class SpacesService {\n    /** Subject to store list of spaces */\n    private _list = new BehaviorSubject<Space[]>([]);\n    /** Subject which stores the initialised state of the object */\n    protected readonly _initialised = new BehaviorSubject<boolean>(false);\n    /** Observable of the initialised state of the object */\n    public readonly initialised = this._initialised.asObservable();\n    /** Observable for list of spaces */\n    public readonly list = this._list.asObservable();\n    /** List of available features */\n    public readonly features = this.list.pipe(\n        map((_) => unique(flatten(_.map((i) => i.features))))\n    );\n    /** Default predicate for filter method */\n    protected _compare = (space: Space) =>\n        space.zones.includes(this._org.building.id);\n\n    /** List of available spaces */\n    public get space_list(): Space[] {\n        return this._list.getValue();\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _settings: SettingsService\n    ) {\n        SPACE_PIPE = new SpacePipe(_org);\n        this._init();\n    }\n\n    private async _init() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        if (!this._settings.get('app.prevent_space_init')) this.loadSpaces();\n        else this._initialised.next(true);\n    }\n\n    /**\n     * Get a filtered list of the available spaces\n     * @param predicate Predicate for filtering spaces\n     */\n    public filter(predicate: (_: Space) => boolean = this._compare) {\n        return this._list.getValue().filter((_) => predicate(_));\n    }\n\n    public async loadSpace(space_id: string) {\n        const system = await showSystem(space_id).toPromise();\n        const space = new Space({\n            ...(system as any),\n            level: this._org.levelWithID([...system.zones]),\n        });\n        SPACE_PIPE.updateSpaceList([space]);\n    }\n\n    /**\n     * Find space with given id/email\n     * @param space_id ID/Email address associated with the space\n     */\n    public find(space_id: string) {\n        return this._list.getValue().find(({ id }) => space_id === id);\n    }\n\n    private async loadSpaces(): Promise<void> {\n        const systems = await querySystems({\n            zone_id: this._org.organisation.id,\n            limit: 5000,\n        })\n            .pipe(map((i) => i.data))\n            .toPromise();\n        const space_list = systems.map(\n            (sys) =>\n                new Space({\n                    ...(sys as any),\n                    level: this._org.levelWithID([...sys.zones]),\n                })\n        );\n        // Remove spaces without a map ID\n        const valid_spaces = space_list.filter((space) => space.map_id);\n        this._list.next(valid_spaces);\n        SPACE_PIPE.updateSpaceList(valid_spaces);\n        this._initialised.next(true);\n    }\n}\n","import { Injectable } from '@angular/core';\nimport {\n    Point,\n    ViewAction,\n    ViewerFeature,\n    ViewerLabel,\n    ViewerStyles,\n} from '@placeos/svg-viewer';\nimport { querySystems } from '@placeos/ts-client';\nimport { BehaviorSubject, combineLatest, of } from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    filter,\n    first,\n    map,\n    shareReplay,\n    switchMap,\n} from 'rxjs/operators';\n\nimport {\n    AsyncHandler,\n    HashMap,\n    SettingsService,\n    unique,\n} from '@placeos/common';\nimport { BuildingLevel } from 'libs/organisation/src/lib/level.class';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport { SpacesService } from 'libs/spaces/src/lib/spaces.service';\n\nexport interface MapOptions {\n    is_public: boolean;\n    /** List of keys to ignore for any map resource */\n    disable?: string[];\n    /** List of keys to ignore for map labels */\n    disable_labels?: string[];\n    /** List of keys to ignore for map actions */\n    disable_actions?: string[];\n    /** List of keys to ignore for map features */\n    disable_features?: string[];\n    /** List of keys to ignore for map styles */\n    disable_styles?: string[];\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class ExploreStateService extends AsyncHandler {\n    /** Currently active level */\n    private _level = new BehaviorSubject<BuildingLevel>(null);\n    /** Currently active level */\n    private _positions = new BehaviorSubject<{ zoom: number; center: Point }>({\n        zoom: 1,\n        center: { x: 0.5, y: 0.5 },\n    });\n    /** Mapping of groups to their styles */\n    private _styles = new BehaviorSubject<HashMap<ViewerStyles>>({});\n    /** Mapping of groups to their features */\n    private _features = new BehaviorSubject<HashMap<ViewerFeature[]>>({});\n    /** Mapping of groups to their actions */\n    private _actions = new BehaviorSubject<HashMap<ViewAction[]>>({});\n    /** Mapping of groups to their actions */\n    private _labels = new BehaviorSubject<HashMap<ViewerLabel[]>>({});\n\n    private _options = new BehaviorSubject<MapOptions>({\n        is_public: false,\n        disable: ['zones', 'devices'],\n    });\n\n    private _message = new BehaviorSubject<string>('');\n\n    /** Currently active level */\n    public readonly level = this._level.asObservable();\n    /** Currently active level */\n    public readonly message = this._message.asObservable();\n    /** Spaces associated with the active level */\n    public readonly spaces = combineLatest([\n        this._level,\n        this._org.initialised,\n    ]).pipe(\n        filter(([_, initialised]) => initialised),\n        switchMap(([level]) =>\n            querySystems({\n                zone_id: level?.id || this._org.organisation.id,\n                limit: 50,\n            }).pipe(\n                map(({ data }) => data.map((_) => new Space(_ as any))),\n                catchError((_) => of([] as Space[])),\n            ),\n        ),\n        shareReplay(1),\n    );\n    /** Currently shown space's map URL */\n    public readonly map_url = this._level.pipe(\n        map((lvl) => (lvl ? lvl.map_id : '') || ''),\n    );\n    /** Currently center and zoom positions for map */\n    public readonly map_positions = this._positions.asObservable();\n    /** Currently center and zoom positions for map */\n    public readonly map_features = combineLatest([\n        this._features,\n        this._options,\n    ]).pipe(\n        debounceTime(200),\n        map(([features, options]) => {\n            let list = [];\n            for (const key in features) {\n                if (\n                    options.disable?.includes(key) ||\n                    options.disable_features?.includes(key) ||\n                    (key === 'zones-canvas' &&\n                        options.disable?.includes('zones'))\n                )\n                    continue;\n                list = list.concat(features[key]);\n            }\n            return list;\n        }),\n    );\n    /** Currently center and zoom positions for map */\n    public readonly map_actions = combineLatest([\n        this._actions,\n        this._options,\n    ]).pipe(\n        debounceTime(200),\n        map(([actions, options]) => {\n            let list = [];\n            for (const key in actions) {\n                if (\n                    options.disable?.includes(key) ||\n                    options.disable_actions?.includes(key)\n                )\n                    continue;\n                list = list.concat(actions[key]);\n            }\n            return list;\n        }),\n    );\n    /** Currently center and zoom positions for map */\n    public readonly map_labels = combineLatest([\n        this._labels,\n        this._options,\n    ]).pipe(\n        debounceTime(200),\n        map(([labels, options]) => {\n            let list = [];\n            for (const key in labels) {\n                if (\n                    options.disable?.includes(key) ||\n                    options.disable_labels?.includes(key)\n                )\n                    continue;\n                list = list.concat(labels[key]);\n            }\n            return list;\n        }),\n    );\n    /** Current map styles */\n    public readonly map_styles = combineLatest([\n        this._styles,\n        this._options,\n    ]).pipe(\n        debounceTime(200),\n        map(([styles, options]) => {\n            let style_mappings = { text: { display: 'none' } };\n            for (const key in styles) {\n                if (\n                    options.disable?.includes(key) ||\n                    options.disable_styles?.includes(key)\n                )\n                    continue;\n                style_mappings = { ...style_mappings, ...styles[key] };\n            }\n            if (options.disable?.includes('zones')) {\n                style_mappings['#zones'] = { display: 'none' };\n                style_mappings['#Zones'] = { display: 'none' };\n            }\n            return style_mappings;\n        }),\n    );\n\n    public readonly options = this._options.asObservable();\n\n    public get positions() {\n        return this._positions.getValue();\n    }\n\n    public get active_level() {\n        return this._level.getValue();\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private _settings: SettingsService,\n    ) {\n        super();\n        this.init();\n    }\n\n    public async init() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this._org.active_levels\n            .pipe(filter((_) => !!_))\n            .subscribe((level_list) => {\n                const level = this._level.getValue();\n                const has_level = level_list.find(\n                    (lvl) => level?.id === lvl.id,\n                );\n                if (!has_level && level_list.length) {\n                    this.setLevel(level_list[0].id);\n                }\n                if (this._settings.get('app.explore.disable_actions')) {\n                    this.setOptions({\n                        disable_actions: this._settings.get(\n                            'app.explore.disable_actions',\n                        ),\n                    });\n                }\n                if (this._settings.get('app.explore.disable_labels')) {\n                    this.setOptions({\n                        disable_labels: this._settings.get(\n                            'app.explore.disable_labels',\n                        ),\n                    });\n                }\n                if (this._settings.get('app.explore.disable_features')) {\n                    this.setOptions({\n                        disable_features: this._settings.get(\n                            'app.explore.disable_features',\n                        ),\n                    });\n                }\n                if (this._settings.get('app.explore.disable_styles')) {\n                    this.setOptions({\n                        disable_styles: this._settings.get(\n                            'app.explore.disable_styles',\n                        ),\n                    });\n                }\n            });\n    }\n\n    public setOptions(options: Partial<MapOptions>) {\n        const old_options = this._options.getValue();\n        const disable = unique([\n            ...(options.disable || old_options.disable),\n            ...(this._settings.get('app.explore.disable') || []),\n        ]);\n        this._options.next({\n            ...this._options.getValue(),\n            ...options,\n            disable,\n        });\n    }\n\n    public reset() {\n        this._styles.next({});\n        this._features.next({});\n        this._labels.next({});\n        this._actions.next({});\n        this._options.next({\n            is_public: false,\n            disable: ['zones', 'devices'],\n        });\n        this.setPositions(1, { x: 0.5, y: 0.5 });\n    }\n\n    public setLevel(zone_id: string) {\n        const lvl = this._org.levelWithID([zone_id]);\n        if (lvl) this._level.next(lvl);\n    }\n\n    public setStyles(name: string, styles: ViewerStyles) {\n        const style_map = this._styles.getValue();\n        style_map[name] = styles;\n        this._styles.next(style_map);\n    }\n\n    public setFeatures(name: string, features: ViewerFeature[]) {\n        const feature_map = this._features.getValue();\n        feature_map[name] = features;\n        this._features.next(feature_map);\n    }\n\n    public setActions(name: string, actions: ViewAction[]) {\n        const actions_map = this._actions.getValue();\n        actions_map[name] = actions;\n        this._actions.next(actions_map);\n    }\n\n    public setLabels(name: string, labels: ViewerLabel[]) {\n        const labels_map = this._labels.getValue();\n        labels_map[name] = labels;\n        this._labels.next(labels_map);\n    }\n\n    public setPositions(zoom: number, center: Point) {\n        this._positions.next({ zoom, center });\n    }\n\n    public has(\n        type: 'style' | 'feature' | 'action' | 'label',\n        id: string,\n        exclude: string[] = [],\n    ): boolean {\n        if (type === 'style') {\n            const styles_map = this._styles.getValue();\n            for (const group in styles_map) {\n                if (exclude.includes(group)) continue;\n                const styles = styles_map[group];\n                if (id in styles || `#${id}` in styles) return true;\n            }\n        } else if (type === 'feature') {\n            const feature_map = this._features.getValue();\n            for (const group in feature_map) {\n                if (exclude.includes(group)) continue;\n                for (const feature of feature_map[group]) {\n                    if (feature.location === id) return true;\n                }\n            }\n        } else if (type === 'action') {\n            const actions_map = this._actions.getValue();\n            for (const group in actions_map) {\n                if (exclude.includes(group)) continue;\n                for (const feature of actions_map[group]) {\n                    if (feature.id === id) return true;\n                }\n            }\n        } else if (type === 'label') {\n            const labels_map = this._labels.getValue();\n            for (const group in labels_map) {\n                if (exclude.includes(group)) continue;\n                for (const feature of labels_map[group]) {\n                    if (feature.location === id) return true;\n                }\n            }\n        }\n        return false;\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    InjectionToken,\n    Input,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { AsyncHandler, MapsPeopleService, log } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport {\n    ViewAction,\n    ViewerFeature,\n    ViewerLabel,\n    ViewerStyles,\n} from '@placeos/svg-viewer';\nimport { ExploreStateService } from 'libs/explore/src/lib/explore-state.service';\n\nexport const MAP_FEATURE_DATA = new InjectionToken<any>(\n    'Data for Map Features'\n);\n\nexport interface MapOptions {\n    disable_zoom?: boolean;\n    disable_pan?: boolean;\n    controls?: boolean;\n}\n\nexport interface MapMetadata {\n    styles?: ViewerStyles;\n    features?: ViewerFeature[];\n    labels?: ViewerLabel[];\n    actions?: ViewAction[];\n}\n\n@Component({\n    selector: 'interactive-map',\n    template: `\n        <ng-container\n            *ngIf=\"!(use_mapsindoors$ | async); else mapsindoors_template\"\n        >\n            <map-renderer\n                [src]=\"src\"\n                [(zoom)]=\"zoom\"\n                (zoomChange)=\"zoomChange.next($event)\"\n                [reset]=\"reset\"\n                [styles]=\"styles || metadata?.styles\"\n                [features]=\"features || metadata?.features\"\n                [actions]=\"actions || metadata?.actions\"\n                [labels]=\"labels || metadata?.labels\"\n                (mapInfo)=\"mapInfo.next($event)\"\n            >\n                <ng-content></ng-content>\n            </map-renderer>\n        </ng-container>\n        <ng-template #mapsindoors_template>\n            <maps-indoors\n                [zone]=\"location\"\n                (zoneChange)=\"onLevelChange($event)\"\n                [(zoom)]=\"zoom\"\n                (zoomChange)=\"zoomChange.next($event)\"\n                [options]=\"options\"\n                [reset]=\"reset\"\n                [focus]=\"focus\"\n                [metadata]=\"metadata\"\n            >\n                <ng-content></ng-content>\n            </maps-indoors>\n        </ng-template>\n        <div\n            zoom\n            *ngIf=\"options?.controls\"\n            class=\"absolute bottom-16 right-1 border border-base-200 divide-y divide-base-200 shadow flex flex-col bg-base-100 text-base-content rounded overflow-hidden\"\n        >\n            <button\n                icon\n                matRipple\n                matTooltip=\"Zoom In\"\n                matTooltipPosition=\"left\"\n                class=\"rounded-none\"\n                (click)=\"zoom = zoom * 1.1\"\n            >\n                <app-icon>add</app-icon>\n            </button>\n            <button\n                icon\n                matRipple\n                matTooltip=\"Zoom Out\"\n                matTooltipPosition=\"left\"\n                class=\"rounded-none\"\n                (click)=\"zoom = zoom * (10 / 11)\"\n            >\n                <app-icon>remove</app-icon>\n            </button>\n            <button\n                icon\n                matRipple\n                matTooltip=\"Reset Zoom and Position\"\n                matTooltipPosition=\"left\"\n                class=\"rounded-none\"\n                (click)=\"reset = reset + 1\"\n            >\n                <app-icon>refresh</app-icon>\n            </button>\n        </div>\n    `,\n    styles: [``],\n})\nexport class InteractiveMapComponent extends AsyncHandler {\n    @Input() public src: string;\n    @Input() public zoom = 1;\n    @Input() public center: any = { x: 0.5, y: 0.5 };\n    @Input() public reset = 0;\n    @Input() public metadata: MapMetadata = {};\n    @Input() public styles: any;\n    @Input() public features: any[];\n    @Input() public labels: any[];\n    @Input() public actions: any[];\n    @Input() public options: MapOptions = {};\n    @Input() public focus: string;\n    @Output() public zoomChange = new EventEmitter<number>();\n    @Output() public centerChange = new EventEmitter<any>();\n    @Output() public mapInfo = new EventEmitter<any>();\n\n    public readonly use_mapsindoors$ = this._mapspeople.available$;\n\n    public get location() {\n        return this._org.levels.find((_) => _.map_id === this.src);\n    }\n\n    constructor(\n        private _mapspeople: MapsPeopleService,\n        private _org: OrganisationService,\n        private _explore: ExploreStateService\n    ) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (\n            changes.actions ||\n            changes.labels ||\n            changes.styles ||\n            changes.features\n        ) {\n            this.metadata = {\n                actions: this.actions || [],\n                labels: this.labels || [],\n                styles: this.styles || {},\n                features: this.features || [],\n            };\n        }\n    }\n\n    public onLevelChange(zone: any) {\n        log(\n            'Map',\n            'Level changed to:',\n            zone?.display_name || zone?.name || zone\n        );\n        this._explore.setLevel(zone.id);\n    }\n}\n","import { Component, Inject, OnInit } from '@angular/core';\nimport { MAP_FEATURE_DATA } from './interactive-map.component';\n\nexport interface MapPinData {\n    message: string;\n    fill: string;\n    stroke: string;\n    action?: () => void;\n}\n\n@Component({\n    selector: '[map-pin]',\n    template: `\n        <div\n            name=\"message\"\n            *ngIf=\"message && show_message\"\n            class=\"p-2 m-2 rounded bg-base-100 text-gray-700 shadow\"\n        >\n            {{ message }}\n        </div>\n        <svg\n            *ngIf=\"show\"\n            name=\"pin\"\n            viewBox=\"0 0 380 560\"\n            [class.action]=\"action\"\n            (click)=\"action()\"\n        >\n            <g>\n                <path\n                    [style.fill]=\"fill\"\n                    [style.stroke]=\"stroke\"\n                    stroke-width=\"25\"\n                    d=\"M182.9,551.7c0,0.1,0.2,0.3,0.2,0.3S358.3,283,358.3,194.6c0-130.1-88.8-186.7-175.4-186.9\n            C96.3,7.9,7.5,64.5,7.5,194.6c0,88.4,175.3,357.4,175.3,357.4S182.9,551.7,182.9,551.7z M122.2,187.2c0-33.6,27.2-60.8,60.8-60.8\n            c33.6,0,60.8,27.2,60.8,60.8S216.5,248,182.9,248C149.4,248,122.2,220.8,122.2,187.2z\"\n                />\n            </g>\n        </svg>\n    `,\n    styles: [\n        `\n            :host {\n                position: absolute;\n                bottom: 50%;\n                left: 50%;\n                width: 24rem;\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                transform: translateX(-50%);\n                z-index: -1;\n            }\n\n            div {\n                animation: fade-in-top 1s;\n            }\n\n            .action {\n                pointer-events: auto;\n            }\n\n            svg {\n                width: 2rem;\n                animation: fade-in-top 1s;\n            }\n\n            @keyframes fade-in-top {\n                0% {\n                    opacity: 0;\n                    transform: translateY(-100%);\n                }\n                100% {\n                    opacity: 1;\n                    transform: translateY(0%);\n                }\n            }\n        `,\n    ],\n})\nexport class MapPinComponent implements OnInit {\n    /** Message to display above the pin */\n    public readonly message = this._details.message;\n    /** Fill colour for the pin SVG */\n    public readonly fill = this._details.fill || '#e53935';\n    /** Stroke colour for the pin SVG */\n    public readonly stroke = this._details.stroke || '#fff';\n    /** Action to perform when clicking pin */\n    public readonly action = this._details.action || null;\n\n    public show: boolean;\n    public show_message: boolean;\n\n    constructor(@Inject(MAP_FEATURE_DATA) private _details: MapPinData) {}\n\n    public ngOnInit() {\n        setTimeout(() => (this.show = true), 300);\n        setTimeout(() => (this.show_message = true), 1000);\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer, SafeHtml, SafeResourceUrl, SafeScript, SafeStyle } from '@angular/platform-browser';\n\nenum SecurityContext {\n    NONE = 0,\n    HTML = 1,\n    STYLE = 2,\n    SCRIPT = 3,\n    URL = 4,\n    RESOURCE_URL = 5\n}\n\n@Pipe({\n    name: 'sanitize'\n})\nexport class SanitizePipe implements PipeTransform {\n    constructor(private sanitizer: DomSanitizer) {}\n\n    transform(\n        value: any,\n        type: 'resource' | 'url' | 'script' | 'style' | 'html' = 'html'\n    ): SafeHtml | SafeResourceUrl | SafeScript | SafeStyle {\n        switch (type) {\n            case 'resource':\n                return this.sanitizer.sanitize(SecurityContext.RESOURCE_URL, value);\n            case 'url':\n                return this.sanitizer.sanitize(SecurityContext.URL, value);\n            case 'script':\n                return this.sanitizer.sanitize(SecurityContext.SCRIPT, value);\n            case 'style':\n                return this.sanitizer.sanitize(SecurityContext.STYLE, value);\n            default:\n                return this.sanitizer.sanitize(SecurityContext.HTML, value);\n        }\n    }\n}\n","import { Overlay, OverlayRef } from '@angular/cdk/overlay';\nimport { CdkPortal } from '@angular/cdk/portal';\nimport {\n    Component,\n    ElementRef,\n    HostListener,\n    Injectable,\n    Injector,\n    Input,\n    OnChanges,\n    OnDestroy,\n    SimpleChanges,\n    TemplateRef,\n    Type,\n    ViewChild,\n} from '@angular/core';\nimport { AsyncHandler } from '@placeos/common';\n\n@Injectable()\nexport class CustomTooltipData<T = any> {\n    data: T;\n    close: () => void;\n    constructor(d) {\n        this.data = d.data;\n        this.close = d.close || (() => null);\n    }\n}\n\n@Component({\n    selector: '[customTooltip]',\n    template: `\n        <ng-content></ng-content>\n\n        <ng-template cdk-portal>\n            <div custom-tooltip class=\"relative print:hidden\" [ngSwitch]=\"type\">\n                <ng-container *ngSwitchCase=\"'component'\">\n                    <ng-container\n                        *ngComponentOutlet=\"content; injector: injector\"\n                    ></ng-container>\n                </ng-container>\n                <ng-container *ngSwitchCase=\"'html'\">\n                    <div [innerHTML]=\"content | sanitize\"></div>\n                </ng-container>\n                <ng-container *ngSwitchDefault>\n                    <ng-container\n                        *ngTemplateOutlet=\"content; context: data\"\n                    ></ng-container>\n                </ng-container>\n            </div>\n        </ng-template>\n    `,\n})\nexport class CustomTooltipComponent<T = any>\n    extends AsyncHandler\n    implements OnChanges, OnDestroy\n{\n    /** Horizontal position of the rendered overlay */\n    @Input('xPosition') public x_pos: 'start' | 'center' | 'end';\n    /** Vertical position of the rendered overlay */\n    @Input('yPosition') public y_pos: 'top' | 'center' | 'bottom';\n    /** Content to render in the tooltip */\n    @Input() public content: TemplateRef<any> | Type<any> | string;\n    /** Data associated with the tooltip content */\n    @Input() public data: T;\n    /** Whether tooltip has a backdrop */\n    @Input() public backdrop = true;\n    /** Whether tooltip has a backdrop */\n    @Input() public hover = false;\n    /** Delay time in milliseconds to close after hover */\n    @Input() public delay = 0;\n    /** Type of content to render */\n    public type: 'template' | 'component' | 'html' = 'template';\n\n    public injector: Injector;\n\n    private _overlay_ref: OverlayRef = null;\n\n    @ViewChild(CdkPortal) private _portal: CdkPortal;\n\n    @HostListener('click') public readonly onClick = () => this.open();\n    @HostListener('touchend') public readonly onTouch = () => this.open();\n    @HostListener('mouseenter') public readonly onEnter = () =>\n        this.hover ? this.open() : '';\n    @HostListener('mouseleave') public readonly onLeave = () =>\n        this.hover ? this.close() : '';\n\n    constructor(\n        private _element: ElementRef<HTMLElement>,\n        private _overlay: Overlay,\n        private _injector: Injector\n    ) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        this._updateInjector();\n        if (\n            this._overlay_ref &&\n            (changes.x_pos || changes.y_pos || changes.content)\n        ) {\n            this.open();\n        }\n    }\n\n    public ngOnDestroy() {\n        super.ngOnDestroy();\n        this.close();\n    }\n\n    public open() {\n        if (!this.content) return;\n        this.timeout(\n            'open',\n            () => {\n                if (this.hover && this.delay) {\n                    this.timeout('onclose', () => this.close(), this.delay);\n                }\n                this._updateType();\n                if (this._overlay_ref) this.close();\n                if (!this._portal) return;\n                const pos = this._element.nativeElement.getBoundingClientRect();\n                const default_x = 'end';\n                const default_y = 'top';\n                this._overlay_ref = this._overlay.create({\n                    hasBackdrop: !!this.backdrop && !this.hover,\n                    positionStrategy: this._overlay\n                        .position()\n                        .flexibleConnectedTo(this._element)\n                        .withPositions([\n                            {\n                                originX: this.x_pos || default_x,\n                                originY:\n                                    (this.y_pos === 'top'\n                                        ? 'bottom'\n                                        : this.y_pos == 'bottom'\n                                        ? 'top'\n                                        : this.y_pos) || default_y,\n                                overlayX: this.x_pos || default_x,\n                                overlayY: this.y_pos || default_y,\n                            },\n                        ]),\n                });\n                this._overlay_ref.attach(this._portal);\n                if (this.backdrop) {\n                    this.subscription(\n                        'backdrop',\n                        this._overlay_ref\n                            .backdropClick()\n                            .subscribe(() => this.close())\n                    );\n                }\n            },\n            50\n        );\n    }\n\n    public close() {\n        this.clearTimeout('open');\n        if (this._overlay_ref) {\n            this._overlay_ref.dispose();\n            this._overlay_ref = null;\n        }\n    }\n\n    private _updateType() {\n        this.type =\n            typeof this.content === 'string'\n                ? 'html'\n                : this.content instanceof TemplateRef\n                ? 'template'\n                : 'component';\n    }\n\n    private _updateInjector() {\n        this.injector = Injector.create({\n            providers: [\n                {\n                    provide: CustomTooltipData,\n                    useValue: { data: this.data, close: () => this.close() },\n                },\n            ],\n            parent: this._injector,\n        });\n    }\n}\n","import { Overlay, OverlayRef } from '@angular/cdk/overlay';\nimport { CdkPortal } from '@angular/cdk/portal';\nimport {\n    Component,\n    ElementRef,\n    HostListener,\n    Input,\n    OnDestroy,\n    SimpleChanges,\n    ViewChild,\n} from '@angular/core';\nimport { AsyncHandler } from '@placeos/common';\n\nconst DEFAULT_KEYS = [\n    '0123456789'.split(''),\n    'qwertyuiop'.split(''),\n    'asdfghjkl'.split(''),\n    'zxcvbnm'.split(''),\n    ['{caps}', '{space}', '{backspace}'],\n];\n\n@Component({\n    selector: 'input[keyboard],textarea[keyboard]',\n    template: `\n        <ng-content></ng-content>\n        <ng-template cdk-portal>\n            <div\n                keyboard-view\n                class=\"w-screen flex flex-col space-y-4 bg-base-200 p-2 border-t border-base-200\"\n            >\n                <div\n                    row\n                    class=\"flex items-center justify-center space-x-2\"\n                    *ngFor=\"let row of keyset\"\n                >\n                    <ng-container *ngFor=\"let key of row\">\n                        <div\n                            [attr.key]=\"key\"\n                            tabindex=\"0\"\n                            class=\"rounded-xl p-2 border border-base-200 relative cursor-pointer bg-base-100\"\n                            [class.special]=\"key[0] === '{' && key.length > 1\"\n                            [class.space]=\"key === '{space}'\"\n                            (focus)=\"focusInput()\"\n                            (click)=\"handleKeyPress(key)\"\n                        >\n                            {{\n                                key === '{space}'\n                                    ? 'Space'\n                                    : key === '{caps}'\n                                    ? 'Caps Lock'\n                                    : key === '{backspace}'\n                                    ? 'Backspace'\n                                    : key\n                            }}\n                            <div\n                                *ngIf=\"key === '{caps}'\"\n                                dot\n                                class=\"absolute top-2 right-2 h-2 w-2 rounded-full bg-base-200\"\n                                [class.bg-success]=\"state === 'shift'\"\n                            ></div>\n                        </div>\n                    </ng-container>\n                </div>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            [key] {\n                height: 3.5rem;\n                width: 4rem;\n                transition: box-shadow 200ms, top 200ms;\n                box-shadow: 0 4px 0 0.04px rgba(0, 0, 0, 0.1);\n            }\n\n            [key].special {\n                width: 10rem;\n            }\n\n            [key].space {\n                flex: 1;\n                min-width: 10rem;\n                max-width: 25rem;\n            }\n\n            [key]:hover {\n                top: 2px;\n                box-shadow: 0 2px 0 0.04px rgba(0, 0, 0, 0.1);\n            }\n\n            [key]:active {\n                top: 4px;\n                box-shadow: 0 0 0 0.04px rgba(0, 0, 0, 0.1);\n            }\n        `,\n    ],\n})\nexport class VirtualKeyboardComponent\n    extends AsyncHandler\n    implements OnDestroy\n{\n    /** Whether virtual keyboard should activate */\n    public static enabled: boolean;\n    /** List of rows of keys to display on the keyboard */\n    @Input() public keyset = DEFAULT_KEYS;\n    /** Current state of the displayed keyset */\n    public state: 'normal' | 'caps' | 'shift' = 'normal';\n    /** References to the overlay containing the keyboard */\n    private _overlay_ref: OverlayRef = null;\n    /** Portal with the keyboard contents */\n    @ViewChild(CdkPortal) private _portal: CdkPortal;\n\n    @HostListener('focus') public onFocus = () => {\n        if (!VirtualKeyboardComponent.enabled) return;\n        this.open();\n        this.clearTimeout('blur');\n    };\n    @HostListener('blur') public onBlur = () =>\n        this.timeout('blur', () => this.close());\n\n    constructor(\n        private _element: ElementRef<HTMLInputElement | HTMLTextAreaElement>,\n        private _overlay: Overlay\n    ) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.keyset) {\n            if (!this.keyset) this.keyset = DEFAULT_KEYS;\n        }\n    }\n\n    public ngOnDestroy() {\n        super.ngOnDestroy();\n        this.close();\n    }\n\n    public focusInput() {\n        this._element?.nativeElement?.blur();\n        this._element?.nativeElement?.focus();\n    }\n\n    public open() {\n        if (this._overlay_ref) return;\n        if (!this._portal) return;\n        this._overlay_ref = this._overlay.create({\n            positionStrategy: this._overlay\n                .position()\n                .global()\n                .bottom()\n                .centerHorizontally(),\n        });\n        this._overlay_ref.attach(this._portal);\n    }\n\n    public close() {\n        if (this._overlay_ref) {\n            this._overlay_ref.dispose();\n            this._overlay_ref = null;\n        }\n    }\n\n    public handleKeyPress(key: string) {\n        let cursor_pos = this._element.nativeElement.selectionStart;\n        const str = this._element.nativeElement.value || '';\n        switch (key.toLowerCase()) {\n            case '{caps}':\n            case '{shift}':\n                this.state = 'shift';\n                break;\n            case '{backspace}':\n                this._element.nativeElement.value = `${str.substr(\n                    0,\n                    cursor_pos - 1\n                )}${str.substr(cursor_pos, str.length)}`;\n                cursor_pos = Math.max(0, cursor_pos - 1);\n                break;\n            case '{space}':\n                this._element.nativeElement.value = `${str.substr(\n                    0,\n                    cursor_pos\n                )}${' '}${str.substr(cursor_pos, str.length)}`;\n                cursor_pos += 1;\n                break;\n            default:\n                if (this.state === 'shift') this.state = 'normal';\n                this._element.nativeElement.value = `${str.substr(\n                    0,\n                    cursor_pos\n                )}${key}${str.substr(cursor_pos, str.length)}`;\n                cursor_pos += 1;\n        }\n        this._element.nativeElement.dispatchEvent(new InputEvent('input'));\n        this.updateKeyState();\n        this.timeout(\n            'focus',\n            () => {\n                this.focusInput();\n                this._element.nativeElement.selectionStart = cursor_pos;\n                this._element.nativeElement.selectionEnd = cursor_pos;\n            },\n            50\n        );\n    }\n\n    public updateKeyState() {\n        this.keyset = this.keyset.map((_) =>\n            _.map((k) =>\n                k.length > 1\n                    ? k\n                    : k[\n                          this.state !== 'normal'\n                              ? 'toUpperCase'\n                              : 'toLowerCase'\n                      ]()\n            )\n        );\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { first } from 'rxjs/operators';\nimport { authority, isOnline, token } from '@placeos/ts-client';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\n\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\n\n@Component({\n    selector: 'global-loading',\n    template: `\n        <div\n            *ngIf=\"!online\"\n            class=\"fixed bottom-2 left-1/2 -translate-x-1/2 shadow rounded-3xl px-4 py-2 bg-error text-white text-xs\"\n        >\n            Unable to reach server... Some features may not work.\n        </div>\n        <div\n            *ngIf=\"loading\"\n            loader\n            class=\"fixed inset-0 flex items-center justify-center pointer-events-auto bg-base-100\"\n        >\n            <mat-spinner [diameter]=\"64\"></mat-spinner>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                pointer-events: none;\n            }\n\n            :host > [loader] {\n                z-index: 997;\n                background-image: url(\"data:image/svg+xml,%3Csvg width='36' height='36' viewBox='0 0 36 36' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M36 0H0v36h36V0zM15.126 2H2v13.126c.367.094.714.24 1.032.428L15.554 3.032c-.188-.318-.334-.665-.428-1.032zM18 4.874V18H4.874c-.094-.367-.24-.714-.428-1.032L16.968 4.446c.318.188.665.334 1.032.428zM22.874 2h11.712L20 16.586V4.874c1.406-.362 2.512-1.468 2.874-2.874zm10.252 18H20v13.126c.367.094.714.24 1.032.428l12.522-12.522c-.188-.318-.334-.665-.428-1.032zM36 22.874V36H22.874c-.094-.367-.24-.714-.428-1.032l12.522-12.522c.318.188.665.334 1.032.428zm0-7.748V3.414L21.414 18h11.712c.362-1.406 1.468-2.512 2.874-2.874zm-18 18V21.414L3.414 36h11.712c.362-1.406 1.468-2.512 2.874-2.874zM4.874 20h11.712L2 34.586V22.874c1.406-.362 2.512-1.468 2.874-2.874z' fill='%23000000' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E\");\n            }\n        `,\n    ],\n})\nexport class GlobalLoadingComponent extends AsyncHandler implements OnInit {\n    public loading: boolean;\n\n    public get online() {\n        return isOnline();\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _settings: SettingsService\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        this.loading = true;\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        await this._settings.initialised.pipe(first((_) => _)).toPromise();\n        this.interval(\n            'has_token',\n            () => {\n                if (!authority() || !token()) return;\n                this.loading = false;\n                this.clearInterval('has_token');\n            },\n            1000\n        );\n    }\n}\n","import { Component } from '@angular/core';\nimport { SettingsService } from '@placeos/common';\n\nexport interface BannerDetails {\n    id: string;\n    type?: 'info' | 'warn' | 'error';\n    content: string;\n}\n\n@Component({\n    selector: 'global-banner',\n    template: `\n        <div\n            class=\"flex items-center w-full p-4 space-x-4\"\n            [class.bg-info]=\"banner.type === 'info' || !banner.type\"\n            [class.text-info-content]=\"banner.type === 'info' || !banner.type\"\n            [class.bg-warning]=\"banner.type === 'warn'\"\n            [class.text-warning-content]=\"banner.type === 'warn'\"\n            [class.bg-error]=\"banner.type === 'error'\"\n            [class.text-error-content]=\"banner.type === 'error'\"\n            *ngIf=\"!has_viewed\"\n        >\n            <div class=\"flex-1\">{{ banner?.content }}</div>\n            <button icon (click)=\"close()\">\n                <app-icon>close</app-icon>\n            </button>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class GlobalBannerComponent {\n    public get has_viewed() {\n        return (\n            !this.banner?.content ||\n            localStorage.getItem('PLACE.last_banner') === this.banner.id\n        );\n    }\n\n    public get banner(): BannerDetails {\n        return this._settings.get('app.general.banner');\n    }\n\n    constructor(private _settings: SettingsService) {}\n\n    public close() {\n        localStorage.setItem('PLACE.last_banner', this.banner?.id || '');\n    }\n}\n","import { Component, OnInit, Output, EventEmitter, Inject } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { ViewerFeature, ViewerStyles } from '@placeos/svg-viewer';\n\nimport { AsyncHandler, MapsPeopleService } from '@placeos/common';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { BuildingLevel } from 'libs/organisation/src/lib/level.class';\nimport { MapPinComponent } from './map-pin.component';\n\nexport interface Locatable {\n    id: string;\n    name: string;\n    display_name?: string;\n    map_id: string;\n    level: BuildingLevel;\n    zones?: string[];\n}\n\n@Component({\n    selector: 'map-locate-modal',\n    template: `\n        <div class=\"h-[calc(100vh-4rem)] w-screen sm:h-auto sm:w-auto\">\n            <header class=\"p-4\">\n                <app-icon class=\"text-2xl\">place</app-icon>\n                <h1 class=\"ml-2 text-xl font-medium\">\n                    {{ item.display_name || item.name }}\n                </h1>\n            </header>\n            <div\n                body\n                class=\"relative overflow-hidden h-[65vh] w-full sm:max-h-[65vh]\"\n                *ngIf=\"level\"\n            >\n                <interactive-map\n                    class=\"pointer-events-none\"\n                    [src]=\"level?.map_id\"\n                    [focus]=\"item?.map_id\"\n                    [features]=\"features\"\n                    [options]=\"{\n                        disable_pan: true,\n                        disable_zoom: true\n                    }\"\n                >\n                    <mat-spinner diameter=\"64\"></mat-spinner\n                ></interactive-map>\n                <div\n                    class=\"absolute top-2 right-2 py-2 px-4 bg-base-100 rounded-3xl shadow border border-base-200\"\n                >\n                    {{ level?.display_name || level?.name }}\n                </div>\n            </div>\n            <footer\n                class=\"w-full border-t border-base-200 flex items-center justify-center p-2\"\n            >\n                <button btn matRipple class=\"inverse w-32\" mat-dialog-close>\n                    Close\n                </button>\n            </footer>\n        </div>\n    `,\n    styles: [\n        `\n            [body] {\n                min-width: 80vw !important;\n            }\n        `,\n    ],\n})\nexport class MapLocateModalComponent extends AsyncHandler implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter();\n    /** Space to show the location of on the map */\n    public item: Locatable = this._data.item;\n    /** Features of the map */\n    public features: ViewerFeature[];\n    /** Mapping of elements to CSS styles */\n    public style_map: ViewerStyles = {};\n\n    public get level(): BuildingLevel {\n        return this.item.level || this._org.levelWithID(this.item.zones || []);\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: { item: Locatable },\n        private _org: OrganisationService\n    ) {\n        super();\n        if (!this.item.level?.id) {\n            delete this.item.level;\n        }\n    }\n\n    public ngOnInit(): void {\n        this.timeout(\n            'init',\n            () => {\n                this.processFeature();\n                this.processStyles();\n            },\n            1000\n        );\n    }\n\n    public processStyles(): void {\n        const styles: ViewerStyles = {};\n        if (this.item?.map_id) {\n            styles[`#zones`] = { display: 'none' };\n            styles[`#Zones`] = { display: 'none' };\n        }\n        this.style_map = styles;\n    }\n\n    /** Point on map to focus on */\n    public processFeature(): void {\n        if (!this.item) return null;\n        const focus = {\n            location: this.item.map_id,\n            track_id: `focus_item`,\n            content: MapPinComponent,\n            data: {\n                name: this.item.name,\n            },\n            z_index: 99,\n            zoom: 100,\n        };\n        this.features = [focus];\n    }\n}\n","import { Component, Input } from '@angular/core';\n\n@Component({\n    selector: 'image-carousel',\n    template: `\n        <div class=\"h-full w-full relative overflow-hidden flex\">\n            <div\n                image\n                class=\"h-full min-w-full relative flex items-center justify-center overflow-hidden\"\n                *ngFor=\"let image of images\"\n                [style.transform]=\"'translateX(-' + offset * 100 + '%)'\"\n            >\n                <img\n                    auth\n                    class=\"h-full object-contain\"\n                    *ngIf=\"image\"\n                    [source]=\"image.url || image\"\n                />\n            </div>\n            <div\n                class=\"h-full w-full relative flex flex-col items-center justify-center opacity-30 space-y-2\"\n                *ngIf=\"!images?.length\"\n            >\n                <app-icon class=\"text-5xl\">image_not_supported</app-icon>\n                <p>No images</p>\n            </div>\n            <button\n                matRipple\n                *ngIf=\"images?.length\"\n                class=\"opacity-0 hover:opacity-30 flex items-center justify-center absolute left-0 inset-y-0 w-1/3 bg-neutral text-white\"\n                [disabled]=\"offset === 0\"\n                (click)=\"offset = offset - 1\"\n            >\n                <app-icon class=\"text-4xl\">chevron_left</app-icon>\n            </button>\n            <button\n                matRipple\n                *ngIf=\"images?.length\"\n                class=\"opacity-0 hover:opacity-30 flex items-center justify-center absolute right-0 inset-y-0 w-1/3 bg-neutral text-white\"\n                [disabled]=\"offset >= images?.length - 1\"\n                (click)=\"offset = offset + 1\"\n            >\n                <app-icon class=\"text-4xl\">chevron_right</app-icon>\n            </button>\n            <div\n                class=\"absolute bottom-1 left-1/2 -translate-x-1/2 text-sm opacity-30 space-x-2\"\n                *ngIf=\"images?.length\"\n            >\n                <button\n                    matRipple\n                    [class.!bg-base-100]=\"offset === i\"\n                    *ngFor=\"let img of images; let i = index\"\n                    class=\"h-4 w-4 rounded-full bg-base-300 shadow\"\n                ></button>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n                height: 100%;\n                width: 100%;\n            }\n\n            [image] {\n                transition: transform 300ms;\n            }\n        `,\n    ],\n})\nexport class ImageCarouselComponent {\n    @Input() public images: string[] = [];\n\n    public offset = 0;\n}\n","import { Pipe } from \"@angular/core\";\nimport { formatDuration } from \"date-fns\";\n\n@Pipe({\n    name: 'duration'\n})\nexport class DurationPipe {\n\n    /**\n     * Format the duration value\n     * @param length Duration to format in minutes\n     * @param shorten Whether to shorten the period names e.g. `hours` as `h`\n     */\n    public transform(length: number, shorten: boolean = false): string {\n        let duration = formatDuration({ hours: Math.floor(length / 60), minutes: length % 60 });\n        if (shorten) {\n            duration = duration.replace('hour', 'h').replace('minute', 'm').replace(/s/gi, '');\n        }\n        return duration;\n    }\n}","import { Component, Input, Optional, SimpleChanges } from '@angular/core';\nimport { CustomTooltipData } from './custom-tooltip.component';\n\n@Component({\n    selector: 'json-display',\n    template: `\n        <div\n            class=\"bg-base-100 shadow rounded overflow-auto max-w-[80vw] max-h-[80vh] p-2 border border-base-300\"\n        >\n            <pre\n                class=\"font-mono text-sm bg-base-200 p-2 rounded break-all w-full\"\n                >{{ formatted_json }}</pre\n            >\n        </div>\n    `,\n    styles: [\n        `\n            pre {\n                white-space: pre-wrap; /* Since CSS 2.1 */\n                white-space: -moz-pre-wrap; /* Mozilla, since 1999 */\n                white-space: -pre-wrap; /* Opera 4-6 */\n                white-space: -o-pre-wrap; /* Opera 7 */\n                word-wrap: break-word; /* Internet Explorer 5.5+ */\n            }\n        `,\n    ],\n})\nexport class JsonDisplayComponent {\n    @Input() public json: Object;\n\n    public formatted_json: string;\n\n    constructor(@Optional() _data: CustomTooltipData) {\n        this.json = _data?.data || '';\n        this._updateFormatting();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.json) {\n            this._updateFormatting();\n        }\n    }\n\n    private _updateFormatting() {\n        this.formatted_json = JSON.stringify(this.json, undefined, 4);\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { first, map } from 'rxjs/operators';\n\nimport { HotkeysService } from 'libs/common/src/lib/hotkeys.service';\nimport { AsyncHandler } from 'libs/common/src/lib/async-handler.class';\nimport {\n    ClientEvent,\n    RemoteLoggingService,\n} from 'libs/common/src/lib/remote-logging.service';\nimport { JsonDisplayComponent } from './json-display.component';\nimport { OrganisationService } from '@placeos/organisation';\nimport { SettingsService } from '@placeos/common';\n\nconst COLOR_MAP = {\n    console: 'bg-success-light text-black',\n    network: 'bg-success text-success-content',\n    dom: 'bg-warning-light text-black',\n\n    log: `bg-info-light text-black`,\n    info: `bg-info text-info-content`,\n    warn: `bg-warning text-warning-content`,\n    debug: `bg-base-300 text-base-content`,\n    error: `bg-error text-error-content`,\n};\n\nconst URL_STARTS = [\n    'tel:',\n    'mailto:',\n    'http:',\n    'https:',\n    'ftp:',\n    'ws:',\n    'wss:',\n];\n\n@Component({\n    selector: `debug-console`,\n    template: `\n        <div\n            class=\"absolute bottom-2 left-2 max-w-[80vw] w-[40rem] border border-base-300 bg-base-200 text-base-content shadow rounded overflow-hidden h-[24rem] max-h-[65vh] flex flex-col z-[998]\"\n            *ngIf=\"show\"\n        >\n            <div\n                class=\"flex items-center justify-between bg-base-100 border-b border-base-300\"\n            >\n                <div class=\"p-2\">Console</div>\n                <button icon matRipple (click)=\"show = false\">\n                    <app-icon>close</app-icon>\n                </button>\n            </div>\n            <cdk-virtual-scroll-viewport\n                itemSize=\"32\"\n                *ngIf=\"(filtered_logs | async)?.length; else empty_state\"\n                class=\"flex-1 h-[30rem] max-h-full w-full\"\n            >\n                <div\n                    class=\"font-mono h-8 truncate p-2 text-sm flex items-center max-w-full hover:bg-base-100 space-x-1\"\n                    *cdkVirtualFor=\"\n                        let log of filtered_logs | async;\n                        trackBy: trackByFn\n                    \"\n                >\n                    <div\n                        class=\"uppercase text-xs p-1 bg-base-100/10 rounded font-mono\"\n                    >\n                        {{ log.timestamp | date: 'MMM d HH:mm:ss' }}\n                    </div>\n                    <div\n                        [class]=\"\n                            'uppercase text-xs p-1 ' +\n                            colors[log.type] +\n                            ' rounded font-mono'\n                        \"\n                    >\n                        {{ log.type }}\n                    </div>\n                    <div\n                        [class]=\"\n                            'capitalize text-xs p-1 ' +\n                            colors[log.subtype] +\n                            ' rounded font-mono w-16 text-center'\n                        \"\n                    >\n                        {{ log.subtype }}\n                    </div>\n                    <div\n                        class=\"font-mono pl-1\"\n                        *ngFor=\"let obj of log.data\"\n                        [attr.data-type]=\"type(obj)\"\n                    >\n                        <ng-container [ngSwitch]=\"type(obj)\">\n                            <ng-container *ngSwitchCase=\"'link'\">\n                                <a\n                                    class=\"font-mono\"\n                                    [href]=\"obj | sanitize\"\n                                    target=\"_blank\"\n                                    rel=\"noopener noreferer\"\n                                    >{{ obj }}</a\n                                >\n                            </ng-container>\n                            <ng-container *ngSwitchCase=\"'object'\">\n                                [<span\n                                    class=\"underline font-mono hover:text-info\"\n                                    customTooltip\n                                    xPosition=\"center\"\n                                    yPosition=\"bottom\"\n                                    [content]=\"json_tooltip\"\n                                    [data]=\"obj\"\n                                    [hover]=\"true\"\n                                    [backdrop]=\"false\"\n                                    >Object</span\n                                >]\n                            </ng-container>\n                            <ng-container *ngSwitchDefault>{{\n                                obj\n                            }}</ng-container>\n                        </ng-container>\n                    </div>\n                </div>\n                <div class=\"h-8 w-full\"></div>\n            </cdk-virtual-scroll-viewport>\n            <div\n                class=\"absolute bottom-1 right-1 rounded-lg p-1 flex items-center w-[20rem] overflow-hidden\"\n            >\n                <div\n                    class=\"absolute inset-0 bg-base-content opacity-60 z-0\"\n                ></div>\n                <div\n                    class=\"absolute inset-1 bg-base-content opacity-90 rounded z-0\"\n                ></div>\n                <input\n                    #search_input\n                    name=\"log-filter\"\n                    [ngModel]=\"filter | async\"\n                    (ngModelChange)=\"filter.next($event)\"\n                    placeholder=\"Filter logs...\"\n                    class=\"relative border-none flex-1 text-sm px-2 py-1 font-mono rounded text-base-100\"\n                />\n                <div\n                    class=\"relative font-mono text-xs px-2 text-center text-base-100\"\n                >\n                    <span class=\"font-mono\" *ngIf=\"(filter | async)?.length\">\n                        {{ (filtered_logs | async)?.length || '0' }} of\n                    </span>\n                    {{ (logs | async)?.length }}\n                </div>\n            </div>\n        </div>\n        <button\n            activation\n            *ngIf=\"can_activate\"\n            class=\"absolute bottom-0 right-0 h-12 w-12\"\n            (mousedown)=\"onStart()\"\n            (touchstart)=\"onStart()\"\n            (mouseup)=\"onEnd()\"\n            (touchend)=\"onEnd()\"\n        ></button>\n        <ng-template #empty_state>\n            <div\n                class=\"flex-1 flex flex-col items-center justify-center h-[30rem] w-full\"\n            >\n                <div class=\"text-2xl opacity-30\">\n                    No {{ filter.getValue() ? 'matching' : '' }} logs\n                </div>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class DebugConsoleComponent extends AsyncHandler {\n    @Input() public show = false;\n    public readonly colors = COLOR_MAP;\n    public readonly json_tooltip = JsonDisplayComponent;\n    public readonly filter = new BehaviorSubject<string>('');\n    public readonly logs = new BehaviorSubject<ClientEvent[]>([]);\n    public readonly filtered_logs = combineLatest([\n        this.filter,\n        this.logs,\n    ]).pipe(\n        map(([s, logs]) =>\n            logs.filter(\n                (_) =>\n                    _.type.toLowerCase().includes(s.toLowerCase()) ||\n                    _.subtype.toLowerCase().includes(s.toLowerCase()) ||\n                    `${_.data}`.toLowerCase().includes(s.toLowerCase()),\n            ),\n        ),\n    );\n\n    public readonly onStart = () =>\n        this.timeout('show', () => (this.show = true), 5000);\n    public readonly onEnd = () => this.clearTimeout('show');\n\n    public get can_activate() {\n        return !!this._settings.get('app.debug_console');\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _logs: RemoteLoggingService,\n        private _hotkey: HotkeysService,\n        private _settings: SettingsService,\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this.subscription(\n            'binding',\n            this._org.active_building.subscribe(() => {\n                this._logs.setSystem(this._org.binding('remote_logger'));\n            }),\n        );\n        this.subscription(\n            'logs',\n            this._logs.history.subscribe((event) => {\n                let logs = this.logs.getValue();\n                if (\n                    logs.length >\n                    (this._settings.get('app.log_limits') || 20000)\n                )\n                    logs.splice(0, 1);\n                this.logs.next([...logs, event]);\n            }),\n        );\n        this.subscription(\n            'toggle',\n            this._hotkey.listen(\n                ['Control', 'Backquote'],\n                () => (this.show = !this.show),\n            ),\n        );\n        this._logs.setSystem(this._org.binding('remote_logger'));\n    }\n\n    public type(item: any) {\n        if (\n            typeof item === 'string' &&\n            URL_STARTS.find((start) => item.startsWith(start))\n        ) {\n            return 'link';\n        } else if (item instanceof Object) {\n            return 'object';\n        }\n        return 'string';\n    }\n\n    public trackByFn(_: number, item: ClientEvent) {\n        return item?.timestamp;\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { marked } from 'marked';\n\nexport interface ChangelogModalData {\n    changelog: string;\n}\n\n@Component({\n    selector: 'changelog-modal',\n    template: `\n        <header>\n            <h3 mat-dialog-title>Changelog</h3>\n            <button icon mat-dialog-close>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            class=\"p-4 markdown max-h-[65vh] max-w-[80vw] overflow-auto\"\n            *ngIf=\"changelog; else empty_state\"\n            [innerHTML]=\"changelog | safe: 'html'\"\n        ></main>\n        <ng-template #empty_state>\n            <div class=\"flex items-center justify-center flex-col space-y-2\">\n                <app-icon class=\"text-3xl\">close</app-icon>\n                <div class=\"text\">No changelog</div>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class ChangelogModalComponent {\n    /** Whether the changelog is loading */\n    public loading: boolean;\n\n    constructor(@Inject(MAT_DIALOG_DATA) private _data: ChangelogModalData) {}\n\n    /** HTML string for rendering the change log */\n    public get changelog(): string {\n        return marked(this._data.changelog || '', { async: false }) as any;\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { Building, OrganisationService } from '@placeos/organisation';\n\n@Pipe({\n    name: 'building',\n})\nexport class BuildingPipe implements PipeTransform {\n    constructor(private _org: OrganisationService) {}\n\n    public transform(id: string | string[]): Building {\n        return this._org.buildings.find((bld) =>\n            id instanceof Array ? id.includes(bld.id) : bld.id === id\n        );\n    }\n}\n","import {\n    AfterViewInit,\n    Component,\n    ElementRef,\n    EventEmitter,\n    HostListener,\n    Injector,\n    Input,\n    OnChanges,\n    OnDestroy,\n    OnInit,\n    Output,\n    QueryList,\n    SimpleChanges,\n    TemplateRef,\n    Type,\n    ViewChild,\n    ViewChildren,\n} from '@angular/core';\nimport { AsyncHandler } from '@placeos/common';\n\nimport {\n    applyGlobalStyles,\n    createViewer,\n    getViewer,\n    Point,\n    Viewer,\n    removeViewer,\n    updateViewer,\n    ViewAction,\n    ViewerFeature,\n    ViewerLabel,\n    ViewerStyles,\n    listenToViewerChanges,\n} from '@placeos/svg-viewer';\nimport { apiKey, authority, token } from '@placeos/ts-client';\nimport { BehaviorSubject } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { MAP_FEATURE_DATA } from './interactive-map.component';\nimport { get } from 'http';\n\nfunction isSamePoint(p1: Point, p2: Point): boolean {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n@Component({\n    selector: `map-renderer`,\n    template: `\n        <div\n            #outlet\n            tabindex=\"0\"\n            role=\"map\"\n            class=\"absolute inset-0\"\n            [class.hidden]=\"!src\"\n        ></div>\n        <ng-container *ngIf=\"src; else empty_state\">\n            <mat-spinner\n                *ngIf=\"!viewer || loading\"\n                class=\"absolute\"\n                [diameter]=\"48\"\n            ></mat-spinner>\n        </ng-container>\n        <div hidden *ngIf=\"injectors?.length\">\n            <ng-container\n                *ngFor=\"\n                    let element of features;\n                    let i = index;\n                    trackBy: trackByFn\n                \"\n            >\n                <div *ngIf=\"element\">\n                    <div\n                        #feature\n                        class=\"pointer-events-none\"\n                        [attr.no-scale]=\"element.no_scale\"\n                        [attr.el-id]=\"element.location\"\n                        [attr.track-id]=\"element.track_id\"\n                        [attr.view-id]=\"viewer\"\n                        [ngSwitch]=\"type(element.content)\"\n                    >\n                        <ng-container *ngSwitchCase=\"'component'\">\n                            <ng-container\n                                *ngComponentOutlet=\"\n                                    element.content;\n                                    injector: injectors[i]\n                                \"\n                            ></ng-container>\n                        </ng-container>\n                        <ng-container *ngSwitchCase=\"'html'\">\n                            <div [innerHTML]=\"element.content | sanitize\"></div>\n                        </ng-container>\n                        <ng-container *ngSwitchDefault>\n                            <ng-container\n                                *ngTemplateOutlet=\"\n                                    element.content;\n                                    context: element.data\n                                \"\n                            ></ng-container>\n                        </ng-container>\n                    </div>\n                </div>\n            </ng-container>\n        </div>\n        <ng-template #empty_state>\n            <div class=\"absolute inset-0 flex items-center justify-center\">\n                <div class=\"opacity-30\">No map</div>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n            }\n\n            mat-spinner {\n                top: 50%;\n                left: 50%;\n                transform: translate(-50%, -50%);\n            }\n        `,\n    ],\n})\nexport class MapRendererComponent\n    extends AsyncHandler\n    implements AfterViewInit, OnChanges, OnInit, OnDestroy\n{\n    /** URL to the SVG file */\n    @Input() public src: string;\n    /** Custom CSS styles to apply to the SVG file */\n    @Input() public styles: ViewerStyles;\n    /** Zoom level to apply to the SVG */\n    @Input() public zoom = 1;\n    /** Zoom level to apply to the SVG */\n    @Input() public center: Point = { x: 0.5, y: 0.5 };\n    /** List of features to renderer over the SVG */\n    @Input() public features: ViewerFeature[];\n    /** List of labels to renderer over the SVG */\n    @Input() public labels: ViewerLabel[];\n    /** List of available user actions for the SVG */\n    @Input() public actions: ViewAction[];\n    /** Number of times to reset the map */\n    @Input() public reset = 0;\n\n    @Input() public options: any;\n\n    @Input() public focus: string;\n\n    @Output() public zoomChange = new EventEmitter<number>();\n\n    @Output() public centerChange = new EventEmitter<Point>();\n\n    @Output() public mapInfo = new EventEmitter<any>();\n\n    public loading: boolean;\n\n    public injectors: Injector[] = [];\n\n    public feature_list: ViewerFeature[] = [];\n\n    /** ID of the active SVG Viewer */\n    public viewer: string;\n    /** Observable for changes on the SVG viewer */\n    private _on_changes: BehaviorSubject<Viewer> = new BehaviorSubject(null);\n\n    private _extra_data = {\n        ratio$: this._on_changes.pipe(map((_) => _.ratio)),\n        svg_ratio$: this._on_changes.pipe(map((_) => _.svg_ratio)),\n        zoom$: this._on_changes.pipe(map((_) => _.zoom)),\n        position: this._on_changes.pipe(map((_) => _.center)),\n    };\n\n    @ViewChild('outlet') private _outlet_el: ElementRef<HTMLDivElement>;\n    @ViewChildren('feature') private _feature_list: QueryList<\n        ElementRef<HTMLDivElement>\n    >;\n\n    @HostListener('window:resize') public onResize() {\n        this.zoom = 1;\n        this.center = { x: 0.5, y: 0.5 };\n        this.updateDisplay();\n    }\n\n    public type(\n        content: string | TemplateRef<any> | Type<any>,\n    ): 'html' | 'template' | 'component' {\n        return typeof content === 'string'\n            ? 'html'\n            : content instanceof TemplateRef\n              ? 'template'\n              : 'component';\n    }\n\n    constructor(private _injector: Injector) {\n        super();\n    }\n\n    public ngOnInit() {\n        applyGlobalStyles();\n    }\n\n    public ngOnDestroy(): void {\n        if (this.viewer) {\n            removeViewer(this.viewer);\n        }\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.src && this.src) {\n            this.createView().catch((e) => console.warn(e));\n        }\n        if (changes.features) {\n            this.updateInjectors();\n        }\n        if (this.viewer) {\n            if (changes.focus && this.focus) {\n                this.focusOn(this.focus);\n            } else if (\n                (changes.zoom &&\n                    changes.zoom.previousValue != changes.zoom.currentValue) ||\n                (changes.center &&\n                    !isSamePoint(\n                        changes.center.previousValue,\n                        changes.center.currentValue,\n                    ))\n            ) {\n                this.updateDisplay();\n            }\n            if (\n                changes.styles ||\n                changes.features ||\n                changes.labels ||\n                changes.actions\n            ) {\n                this.timeout('update_view', () => this.updateView());\n            }\n        }\n        if (\n            changes.reset &&\n            changes.reset.currentValue !== changes.reset.previousValue\n        ) {\n            this.zoom = 1;\n            this.center = { x: 0.5, y: 0.5 };\n            this.updateDisplay();\n        }\n    }\n\n    public ngAfterViewInit() {\n        this.createView().catch((e) => console.warn(e));\n    }\n\n    /** Update overlays, styles and actions of viewer */\n    private updateView() {\n        try {\n            if (!getViewer(this.viewer) || this.loading) {\n                return this.timeout('update_view', () => this.updateView());\n            }\n            this.updateFeatureList();\n            updateViewer(this.viewer, {\n                styles: this.styles,\n                features: this.feature_list,\n                labels: this.labels,\n                actions: this.actions,\n                options: this.options,\n            });\n        } catch (e) {}\n    }\n\n    /** Update zoom and center position of viewer */\n    private updateDisplay() {\n        try {\n            updateViewer(this.viewer, {\n                zoom: this.zoom,\n                desired_zoom: this.zoom,\n                center: this.center,\n                desired_center: this.center,\n                options: this.options,\n            });\n        } catch (e) {}\n    }\n\n    private async createView() {\n        if (!authority()) {\n            return this.timeout(\n                'create_view',\n                () => this.createView().catch((e) => console.warn(e)),\n                300,\n            );\n        }\n        const simp_url = this.src?.toLowerCase() || '';\n        if (!simp_url.includes('svg') && !simp_url.includes('upload')) return;\n        if (this.src && this._outlet_el?.nativeElement && !this.loading) {\n            this.loading = true;\n            if (this.viewer) {\n                try {\n                    updateViewer(this.viewer, {\n                        styles: this.styles,\n                        features: [],\n                        labels: this.labels,\n                        actions: this.actions,\n                        options: this.options,\n                    });\n                    removeViewer(this.viewer);\n                } catch (e) {\n                    console.warn(e);\n                    return;\n                }\n            }\n            this.updateFeatureList();\n            const tkn = token();\n            document.cookie = `${\n                tkn === 'x-api-key'\n                    ? 'api-key=' + encodeURIComponent(apiKey())\n                    : 'bearer_token=' + encodeURIComponent(tkn)\n            };max-age=30;path=/api/engine/v2/uploads;samesite=strict;${\n                location.protocol === 'https:' ? 'secure;' : ''\n            }`;\n            this.viewer = await createViewer({\n                element: this._outlet_el?.nativeElement,\n                url: this.src,\n                styles: this.styles,\n                zoom: this.zoom,\n                desired_zoom: this.zoom,\n                center: this.center,\n                features: this.feature_list,\n                labels: this.labels,\n                actions: this.actions,\n                options: this.options,\n            }).catch((e) => {\n                console.warn(e);\n                return '';\n            });\n            this.loading = false;\n            if (!this.viewer) return;\n            this.loading = false;\n            this.subscription(\n                'view_changes',\n                listenToViewerChanges(this.viewer)?.subscribe((v) => {\n                    const box =\n                        this._outlet_el.nativeElement.getBoundingClientRect();\n                    this._on_changes.next({ ...v } as any);\n                    this.zoomChange.emit(v.zoom);\n                    this.centerChange.emit(v.center);\n                }),\n            );\n            const viewer = getViewer(this.viewer);\n            this.mapInfo.emit(viewer.mappings);\n            if (this.focus) this.focusOn(this.focus);\n        } else if (\n            (this.src && !this._outlet_el?.nativeElement) ||\n            this.loading\n        ) {\n            this.timeout('create_view', () =>\n                this.createView().catch((e) => console.warn(e)),\n            );\n        }\n    }\n\n    private focusOn(id: string) {\n        if (!id || !this.viewer) return;\n        const viewer: Viewer = getViewer(this.viewer);\n        if (!viewer) return;\n        const rect = viewer.mappings[id];\n        if (!rect) return;\n        this.center = {\n            x: 1 - (rect.x + rect.w / 2),\n            y: 1 - (rect.y + rect.h / 4),\n        };\n        this.updateDisplay();\n    }\n\n    /* istanbul ignore next */\n    public trackByFn(index: number, feature: ViewerFeature) {\n        return feature?.track_id;\n    }\n\n    private updateFeatureList() {\n        this.feature_list = (this.features || [])\n            .map((f, idx) => ({\n                ...f,\n                content: this._feature_list.toArray()[idx]?.nativeElement,\n            }))\n            .filter((f) => f.content);\n    }\n\n    private updateInjectors() {\n        const old_injectors = this.injectors || [];\n        this.injectors = (this.features || []).map(\n            (f: any) =>\n                old_injectors.find(\n                    (_) =>\n                        _.get(MAP_FEATURE_DATA)?.track_id &&\n                        _.get(MAP_FEATURE_DATA)?.track_id === f.track_id,\n                ) ||\n                Injector.create({\n                    providers: [\n                        {\n                            provide: MAP_FEATURE_DATA,\n                            useValue: {\n                                track_id: f.track_id,\n                                ...f.data,\n                                ...this._extra_data,\n                            },\n                        },\n                    ],\n                    parent: this._injector,\n                }),\n        );\n    }\n}\n","import {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output,\n    SimpleChanges,\n    ViewChild,\n} from '@angular/core';\nimport { BuildingLevel, OrganisationService } from '@placeos/organisation';\nimport { MapMetadata } from './interactive-map.component';\nimport {\n    AsyncHandler,\n    MapsPeopleService,\n    calculateDistance,\n    log,\n    notifyError,\n    notifyWarn,\n    randomString,\n} from '@placeos/common';\nimport { MapService } from 'libs/common/src/lib/mapspeople.service';\nimport { take } from 'rxjs/operators';\n\ndeclare let mapsindoors: any;\ndeclare let google: any;\ndeclare let mapboxgl: any;\n\nconst DEFAULT_ZOOM = 18.5;\n\ninterface MapsIndoorServices {\n    mapsindoors: any;\n    view: any;\n    map: any;\n    directions: any;\n    directions_renderer: any;\n}\n\nconst RESOURCE_MAP: Record<string, any> = {};\n\n@Component({\n    selector: 'maps-indoors',\n    template: `\n        <div #map_container class=\"absolute inset-0 z-0\"></div>\n        <button\n            *ngIf=\"focus && !show_directions && options?.controls\"\n            btn\n            matRipple\n            class=\"absolute bottom-2 left-2 bg-base-100 text-base-content shadow z-10 border-base-200 space-x-2\"\n            (click)=\"toggleDirections()\"\n        >\n            <app-icon>place</app-icon>\n            <div class=\"pr-2\">\n                {{ viewing_directions ? 'Hide' : 'Show' }} Directions\n            </div>\n            <mat-spinner diameter=\"24\" *ngIf=\"loading_directions\"></mat-spinner>\n        </button>\n    `,\n    styles: [``],\n})\nexport class MapsIndoorsComponent extends AsyncHandler implements OnInit {\n    @Input() public zone: BuildingLevel;\n    @Input() public metadata: MapMetadata;\n    @Input() public options: any;\n    @Input() public focus: string;\n    @Input() public zoom = DEFAULT_ZOOM;\n    @Input() public reset: number;\n    @Output() public zoomChange = new EventEmitter<number>();\n    @Output() public zoneChange = new EventEmitter<BuildingLevel>();\n\n    public id: string;\n    public show_directions = false;\n    public viewing_directions = false;\n    public loading_directions = false;\n    public ignore_zoom = false;\n\n    private _services: MapsIndoorServices;\n    private _floor_list: any[] = [];\n    private _last_building: string;\n\n    @ViewChild('map_container', { static: true })\n    private _container: ElementRef<HTMLDivElement>;\n\n    constructor(\n        private _maps_people: MapsPeopleService,\n        private _org: OrganisationService,\n    ) {\n        super();\n        const data =\n            sessionStorage.getItem('PLACEOS.mapsindoors.resources') || '{}';\n        const value = JSON.parse(data);\n        for (const key in value) {\n            if (value.hasOwnProperty(key)) {\n                RESOURCE_MAP[key] = value[key];\n            }\n        }\n    }\n\n    public ngOnInit() {\n        this.id = randomString(8);\n        this._initialised.next(false);\n        this._initialiseServices();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (!this.is_initialised) {\n            return this.timeout('on_changes', () => this.ngOnChanges(changes));\n        }\n        if (changes.zone && this.zone) {\n            this._centerOnZone();\n        }\n        if (changes.focus && this.focus) {\n            this._focusOnLocation();\n        }\n        if (changes.metadata) {\n            this._updateMapStyling();\n        }\n        if (changes.zoom && this.zoom && !this.ignore_zoom) {\n            this._services?.map?.setZoom(this.zoom);\n        }\n        if (changes.reset) {\n            this._services?.map?.setZoom(DEFAULT_ZOOM);\n            this._centerOnZone();\n        }\n        if (changes.options) {\n            this._addFloorSelector();\n        }\n    }\n\n    private _setResource(id: string, resource: any) {\n        RESOURCE_MAP[id] = resource;\n        this.timeout('set_resource', () => {\n            sessionStorage.setItem(\n                'PLACEOS.mapsindoors.resources',\n                JSON.stringify(RESOURCE_MAP),\n            );\n        });\n    }\n\n    private _initialiseServices() {\n        if (!this._maps_people.is_ready || !(window as any).mapsindoors) {\n            this.timeout('init', () => this._initialiseServices(), 1000);\n            return;\n        }\n        const [lat, long] = (\n            this._org.building?.location || `-33.8567844,151.2152967`\n        ).split(',');\n        const view_options: Record<string, any> = {\n            element: this._container.nativeElement,\n            center: { lat: parseFloat(lat), lng: parseFloat(long) },\n            zoom: DEFAULT_ZOOM,\n            maxZoom: 24,\n        };\n        let view_instance = null;\n        switch (this._maps_people.map_service) {\n            case MapService.GoogleMaps:\n                log('MapsIndoors', 'Using Google Maps API');\n                view_instance = new mapsindoors.mapView.GoogleMapsView(\n                    view_options,\n                );\n                break;\n            case MapService.Mapbox:\n                view_options.accessToken = this._maps_people.map_token;\n                log('MapsIndoors', 'Using Mapbox API');\n                view_instance = new mapsindoors.mapView.MapboxView(\n                    view_options,\n                );\n                break;\n        }\n        if (!view_instance) {\n            notifyWarn('Failed to initialise map view.');\n            return;\n        }\n        const provider =\n            this._maps_people.map_service === MapService.GoogleMaps\n                ? new mapsindoors.directions.GoogleMapsProvider()\n                : new mapsindoors.directions.MapboxProvider(\n                      this._maps_people.map_token,\n                  );\n        const maps_indoors = new mapsindoors.MapsIndoors({\n            mapView: view_instance,\n        });\n        this._services = {\n            mapsindoors: maps_indoors,\n            view: view_instance,\n            map: view_instance.getMap(),\n            directions: new mapsindoors.services.DirectionsService(provider),\n            directions_renderer: new mapsindoors.directions.DirectionsRenderer({\n                mapsIndoors: maps_indoors,\n            }),\n        };\n        this._initialised.next(true);\n        if (this.zone) {\n            this._services.map.setZoom(DEFAULT_ZOOM);\n            this._centerOnZone();\n        }\n        this._addFloorSelector();\n        // Add Events listenders\n        this._services.mapsindoors.addListener('building_changed', (e) =>\n            this._handleBuildingChange(e),\n        );\n        this._services.mapsindoors.addListener('floor_changed', (e) =>\n            this._handleLevelChange(e),\n        );\n        this._services.mapsindoors.addListener('zoom_changed', (e) =>\n            this._handleZoomChange(e),\n        );\n        this._services.mapsindoors.addListener('click', (e) =>\n            this._handleUserClick(e),\n        );\n        this.timeout(\n            'resize',\n            () => window.dispatchEvent(new Event('resize')),\n            100,\n        );\n        (window as any).maps_indoors = this._services;\n        this.timeout('focus', () => this._focusOnLocation());\n        this.timeout('init_zoom', () => this._handleZoomChange(DEFAULT_ZOOM));\n    }\n\n    public clearDirections() {\n        this._services.directions_renderer.setRoute(null);\n        this.viewing_directions = false;\n    }\n\n    private _last_position: GeolocationPosition;\n\n    public async toggleDirections() {\n        if (this.viewing_directions) {\n            this.clearDirections();\n            this._focusOnLocation();\n            return;\n        }\n        if (!this.focus) return;\n        const items = await this._search(this.focus);\n        if (!items?.length) {\n            notifyError(`Unable to find location \"${this.focus}\".`);\n            return;\n        }\n        this.loading_directions = true;\n        const item = items[0];\n        const bld = this._org.buildings.find(\n            (bld) => bld.id === this.zone.parent_id,\n        );\n        const [d_lng, d_lat] = item.properties?.anchor?.coordinates ||\n            bld?.location.split(',') || [37.8136, 144.9631];\n        const options = { timeout: 10000, enableHighAccuracy: true };\n        navigator.geolocation.getCurrentPosition(\n            async (position: GeolocationPosition) => {\n                this._last_position = position;\n                this.setDirectionsFromLocation(\n                    {\n                        lat: position.coords.latitude,\n                        lng: position.coords.longitude,\n                    },\n                    { lat: d_lat, lng: d_lng },\n                );\n            },\n            () => {\n                if (this._last_position) {\n                    this.setDirectionsFromLocation(\n                        {\n                            lat: this._last_position.coords.latitude,\n                            lng: this._last_position.coords.longitude,\n                        },\n                        { lat: d_lat, lng: d_lng },\n                    );\n                } else notifyError('Failed to get your current location.');\n            },\n            options,\n        );\n    }\n\n    public async setDirectionsFromLocation(\n        from: { lat: number; lng: number },\n        to: { lat: number; lng: number },\n    ) {\n        const distance = calculateDistance(to.lat, to.lng, from.lat, from.lng);\n        const routeParameters = {\n            origin: {\n                lat: from.lat,\n                lng: from.lng,\n            },\n            destination: { lat: to.lat, lng: to.lng },\n            travelMode: distance < 2 ? 'WALKING' : 'DRIVING',\n        };\n        const result = await this._services.directions\n            .getRoute(routeParameters)\n            .catch((e) => {\n                log(\n                    'MapsIndoors',\n                    'Error fetching route: ',\n                    e.message || e,\n                    'warn',\n                );\n                const origin_error =\n                    e instanceof TypeError && e.message?.includes('origin');\n                this.loading_directions = false;\n                if (!origin_error) return;\n                notifyError('Error: Origin location is outside of map area.');\n            });\n        if (!result) return;\n        this._services.directions_renderer.setRoute(result);\n        this.viewing_directions = true;\n        this.loading_directions = false;\n    }\n\n    private _handleZoomChange(level: number) {\n        this.timeout(\n            'zoom_change',\n            () => {\n                this.ignore_zoom = true;\n                this.zoom = level;\n                this.zoomChange.emit(level);\n                this.timeout(\n                    'reset_ignore_zoom',\n                    () => (this.ignore_zoom = false),\n                    50,\n                );\n            },\n            100,\n        );\n    }\n\n    private _handleBuildingChange(building: any) {\n        const id = building.externalId || building.id;\n        log('MapsIndoors', `Building switched to \"${id}\"`);\n        const floors = building.floors || {};\n        this._floor_list = Object.keys(floors).map((key) => ({\n            index: key,\n            ...floors[key],\n        }));\n        log('MapsIndoors', 'Floor List:', this._floor_list);\n        if (!this._services) return;\n        const bld = this._org.buildings.find(\n            (_) => _.id === id || _.map_id === id,\n        );\n        this.timeout('set_floor', () => {\n            const has_set_floor = this._setFloorFromZone();\n            if (!has_set_floor && building.defaultFloor) {\n                this._handleLevelChange(building.defaultFloor);\n            }\n        });\n        if (!bld) return;\n        this._org.building = bld;\n        this._last_building = bld.id;\n    }\n\n    private async _handleLevelChange(index: any) {\n        log('MapsIndoors', `Level switched to \"${index}\"`);\n        const floor = this._floor_list.find((_) => _.index === index);\n        const id = floor?.externalId || floor?.id;\n        if (!this._services) return;\n        const levels = await this._org.active_levels.pipe(take(1)).toPromise();\n        if (!levels) return;\n        const new_level = levels.find((_) => _.map_id === id || _.id === id);\n        if (!new_level) return;\n        this.zone = new_level;\n        this.zoneChange.emit(new_level);\n    }\n\n    private _handleUserClick(event: any) {\n        log('MapsIndoors', `Click occurred`, event);\n        const id =\n            event.properties?.externalId ||\n            event.properties?.roomId ||\n            event.id;\n        const actions = this.metadata?.actions || [];\n        log('MapsIndoors', `Registered Actions`, actions);\n        const ignore_actions = ['mousedown', 'touchstart', 'enter', 'leave'];\n        for (const action of actions) {\n            if (\n                (action.id === id || action.id === '*') &&\n                !ignore_actions.includes(action.action as any)\n            ) {\n                action.callback(event);\n                break;\n            }\n        }\n    }\n\n    private async _search(query: string): Promise<any[]> {\n        if (!this._services) return;\n        return mapsindoors?.services.LocationsService.getLocations({\n            q: query,\n        });\n    }\n\n    private async _updateMapStyling() {\n        if (!this._services) return;\n        const styles = this.metadata?.styles || {};\n        for (const id in styles) {\n            if (!styles[id].fill) continue;\n            let resource = RESOURCE_MAP[id];\n            if (!resource) {\n                const id_simple = id.replace(/#/, '');\n                const list = await this._search(id_simple);\n                if (!list.length) continue;\n                resource = list.find(\n                    (_) =>\n                        _.properties?.externalId === id_simple ||\n                        _.properties?.roomId === id_simple ||\n                        _.id === id_simple,\n                );\n                if (resource) this._setResource(id, resource);\n            }\n            if (!resource) continue;\n            const value = {\n                extrusionHeight: 0,\n                extrusionVisible: false,\n                polygonVisible: true,\n                polygonFillColor: styles[id].fill,\n            };\n            this._services.mapsindoors.setDisplayRule(resource.id, value);\n        }\n    }\n\n    private async _focusOnLocation() {\n        if (!this.focus) return;\n        const items = await this._search(this.focus);\n        this.clearDirections();\n        if (!items?.length) {\n            notifyError(`Unable to find location ${this.focus}.`);\n            return;\n        }\n        const item =\n            items.find((_) => _.properties?.externalId === this.focus) ||\n            items[0];\n        const bld = this._org.buildings.find(\n            (bld) => bld.id === this.zone.parent_id,\n        );\n        const [lng, lat] = item.properties?.anchor?.coordinates ||\n            bld?.location.split(',') || [37.8136, 144.9631];\n        this._services.map.setZoom(DEFAULT_ZOOM);\n        this._services.map.setCenter({ lat, lng });\n        this._services.mapsindoors.setFloor(item.properties?.floor);\n        this._services.mapsindoors.highlight([item.id]);\n    }\n\n    private _centerOnZone() {\n        if (\n            !this._services ||\n            !this.zone ||\n            this.zone.parent_id === this._last_building ||\n            this.zone.id === this._last_building\n        )\n            return;\n        this.timeout('set_center', () => {\n            const bld = this._org.buildings.find(\n                (bld) => bld.id === this.zone.parent_id,\n            );\n            if (!bld) return;\n            const [lat, long] = bld?.location.split(',');\n            if (!this.focus) {\n                this._services.map.setCenter({\n                    lat: parseFloat(lat),\n                    lng: parseFloat(long),\n                });\n            }\n            this._setFloorFromZone();\n            this._last_building = this.zone.id;\n        });\n    }\n\n    private _setFloorFromZone() {\n        if (!this.zone.map_id || !this._services) return false;\n        const map_id = this.zone.map_id;\n        const floor = this._floor_list.find(\n            (_) =>\n                _.index === map_id ||\n                _.externalId === map_id ||\n                _.id === map_id,\n        );\n        if (!floor) return false;\n        this._services.mapsindoors.setFloor(floor.index);\n        return true;\n    }\n\n    private _added_floor_selector = false;\n\n    private _addFloorSelector() {\n        if (!this.options?.controls || this._added_floor_selector) return;\n        const element = document.createElement('div');\n        new mapsindoors.FloorSelector(element, this._services.mapsindoors);\n        if (this._maps_people.map_service === MapService.GoogleMaps) {\n            this._services.map.controls[\n                google.maps.ControlPosition.RIGHT_TOP\n            ].push(element);\n        } else {\n            this._services.map.addControl({\n                onAdd: () => element,\n                onRemove: () => {},\n            });\n        }\n        this._added_floor_selector = true;\n    }\n}\n","import { HashMap, predictableRandomInt } from '@placeos/common';\nimport { PlaceSystem, PlaceZone, querySystems } from '@placeos/ts-client';\nimport { Observable, of } from 'rxjs';\nimport { map, shareReplay, tap } from 'rxjs/operators';\nimport { USER_DOMAIN } from '../../../users/src/lib/user.utilities';\nimport { Space } from './space.class';\nimport { updateSpaceList } from './space.pipe';\nimport {\n    AbstractControl,\n    FormControl,\n    FormGroup,\n    Validators,\n} from '@angular/forms';\n\nconst SPACE_LIST_REQUESTS: Record<string, Observable<Space[]>> = {};\n\nexport const isValidUrl = (url) => {\n    if (!url) return true;\n    try {\n        new URL(url);\n    } catch (e) {\n        return false;\n    }\n    return true;\n};\n\nexport const validateURL = (ctrl: AbstractControl) =>\n    isValidUrl(ctrl?.value) ? null : { url: 'invalid' };\n\nexport function generateSystemsFormFields(system?: PlaceSystem) {\n    const fields = {\n        id: new FormControl(system?.id || ''),\n        name: new FormControl(system.name || '', [Validators.required]),\n        display_name: new FormControl(system.display_name || ''),\n        email: new FormControl(system.email || '', [Validators.email]),\n        code: new FormControl(system.code || ''),\n        support_url: new FormControl(system.support_url || '', [validateURL]),\n        installed_ui_devices: new FormControl(\n            system.installed_ui_devices || 0,\n            [Validators.pattern('[0-9]*')]\n        ),\n        features: new FormControl(\n            (typeof system.features === 'string'\n                ? (system.features as any).split(' ')\n                : system.features) || []\n        ),\n        capacity: new FormControl(system.capacity || 0, [\n            Validators.pattern('[0-9]*'),\n        ]),\n        bookable: new FormControl(system.bookable || false),\n        public: new FormControl(system.public || false),\n        description: new FormControl(system.description || ''),\n        images: new FormControl(system.images || []),\n        map_id: new FormControl(system.map_id || ''),\n        timezone: new FormControl(system.timezone || ''),\n        zone: new FormControl<PlaceZone | null>(null, [Validators.required]),\n        zones: new FormControl(system.zones, [Validators.required]),\n        version: new FormControl(system.version),\n    };\n    if (!system.id) {\n        fields.zone.valueChanges.subscribe((value: PlaceZone) =>\n            fields.zones.setValue([value.id])\n        );\n    } else delete fields.zone;\n    return new FormGroup(fields);\n}\n\nexport function requestSpacesForZone(id: string): Observable<Space[]> {\n    if (!id) return of([]);\n    if (SPACE_LIST_REQUESTS[id]) return SPACE_LIST_REQUESTS[id];\n    SPACE_LIST_REQUESTS[id] = querySystems({ zone_id: id, limit: 500 }).pipe(\n        map((_) => (_.data || []).map((_) => new Space(_ as any))),\n        tap((_) => updateSpaceList(_)),\n        shareReplay(1)\n    );\n    return SPACE_LIST_REQUESTS[id];\n}\n\nlet SPACE_COUNT: number = 0;\n/* istanbul ignore next */\nexport function generateMockSpace(overrides: HashMap = {}): HashMap {\n    const id = `space-${SPACE_COUNT++}`;\n    const name = `Test Space ${SPACE_COUNT}`;\n    const linked = predictableRandomInt(99999) % 2 === 0 && SPACE_COUNT > 1;\n    const space = {\n        id,\n        name,\n        long_name: `${name} with an long name`,\n        map_id: `${SPACE_COUNT}`,\n        capacity: predictableRandomInt(21, 1) * 2,\n        email: `${name.toLowerCase().split(' ').join('.')}@${USER_DOMAIN}`,\n        type: '',\n        searchable: predictableRandomInt(99999) % 2 === 0,\n        controlable: predictableRandomInt(99999) % 2 === 0,\n        bookable: predictableRandomInt(99999) % 2 === 0,\n        cost_hour: predictableRandomInt(300) * 100,\n        setup: predictableRandomInt(6) * 5,\n        breakdown: predictableRandomInt(6) * 5,\n        zones: ['zone_lvl-0'],\n        support_url: `/control/#/panel/${id}`,\n        bookings: [], //Array(10).fill(0).map(i => generateMockBooking()),\n        linked_rooms: linked\n            ? [`space-${predictableRandomInt(SPACE_COUNT - 1)}`]\n            : [],\n        image: '',\n        ...overrides,\n    };\n    if (space['configurations'] && space['configurations'].length > 0) {\n        space['configurations'].forEach(\n            (config) =>\n                (config.capacity = predictableRandomInt(space.capacity) + 1)\n        );\n        space['configurations'][0].capacity = space.capacity;\n    }\n    return space;\n}\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport { currentUser, notifyError, reloadUserData } from '@placeos/common';\nimport { addDays, set, startOfMinute, startOfWeek } from 'date-fns';\nimport { WorktimeBlock, WorktimePreference } from './user.class';\nimport { showUser, updateUser } from '@placeos/ts-client';\n\n@Component({\n    selector: `wfh-settings-modal`,\n    template: `\n        <header class=\"relative flex items-center justify-between\">\n            <h2 class=\"font-medium text-xl\">Working Location Settings</h2>\n            <button\n                icon\n                matRipple\n                mat-dialog-close\n                class=\"bg-base-200\"\n                *ngIf=\"!loading\"\n            >\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            class=\"relative flex flex-col rounded w-[40rem] max-w-full p-4 space-y-2 max-h-[65vh] overflow-auto\"\n            *ngIf=\"!loading; else load_state\"\n        >\n            <h3>Working Days</h3>\n            <div\n                class=\"flex items-center justify-between w-full pb-4 space-x-2\"\n            >\n                <mat-checkbox\n                    *ngFor=\"let day of days\"\n                    [(ngModel)]=\"weekdays_enabled[day.getDay()]\"\n                    (ngModelChange)=\"$event && initialiseDay(day.getDay())\"\n                >\n                    {{ day | date: 'EEE' }}\n                </mat-checkbox>\n            </div>\n            <h3>Work Hours</h3>\n            <ng-container *ngIf=\"has_working_days; else empty_state\">\n                <ng-container *ngFor=\"let day of days\">\n                    <ng-container *ngIf=\"weekdays_enabled[day.getDay()]\">\n                        <div\n                            class=\"flex w-full space-x-2 hover:bg-base-200 rounded px-2 pt-1\"\n                        >\n                            <label class=\"w-12 min-w-0 px-2 pt-3\">\n                                {{ day | date: 'EEE' }}\n                            </label>\n                            <div class=\"flex-1 w-1/2\">\n                                <div\n                                    class=\"flex items-center space-x-2\"\n                                    *ngFor=\"\n                                        let block of settings[day.getDay()]\n                                            .blocks;\n                                        let i = index\n                                    \"\n                                >\n                                    <a-time-field\n                                        [ngModel]=\"timeFrom(block.start_time)\"\n                                        (ngModelChange)=\"\n                                            setStartTime(\n                                                block,\n                                                day.getDay(),\n                                                $event\n                                            )\n                                        \"\n                                        [from]=\"\n                                            timeFrom(\n                                                (i > 0\n                                                    ? settings[day.getDay()]\n                                                          .blocks[i - 1]\n                                                          ?.end_time\n                                                    : 0) || 0\n                                            )\n                                        \"\n                                        class=\"flex-1 w-1/4 h-[3.25rem]\"\n                                    ></a-time-field>\n                                    <a-time-field\n                                        [ngModel]=\"timeFrom(block.end_time)\"\n                                        (ngModelChange)=\"\n                                            setEndTime(\n                                                block,\n                                                day.getDay(),\n                                                $event\n                                            )\n                                        \"\n                                        [from]=\"\n                                            timeFrom(block.start_time + 0.25)\n                                        \"\n                                        class=\"flex-1 w-1/4 h-[3.25rem]\"\n                                    ></a-time-field>\n                                    <mat-form-field\n                                        appearance=\"outline\"\n                                        class=\"flex-1 w-1/4 h-[3.25rem]\"\n                                    >\n                                        <mat-select\n                                            [(ngModel)]=\"block.location\"\n                                        >\n                                            <mat-option\n                                                *ngFor=\"let type of options\"\n                                                [value]=\"type.id\"\n                                            >\n                                                {{ type.name }}\n                                            </mat-option>\n                                        </mat-select>\n                                    </mat-form-field>\n                                    <button\n                                        icon\n                                        matRipple\n                                        [disabled]=\"\n                                            settings[day.getDay()].blocks\n                                                .length > 2\n                                        \"\n                                        (click)=\"\n                                            addBlock(settings[day.getDay()], i)\n                                        \"\n                                    >\n                                        <app-icon>add</app-icon>\n                                    </button>\n                                    <button\n                                        icon\n                                        matRipple\n                                        class=\"text-error\"\n                                        [class.opacity-0]=\"i === 0\"\n                                        [class.pointer-events-none]=\"i === 0\"\n                                        (click)=\"\n                                            removeBlock(\n                                                settings[day.getDay()],\n                                                i\n                                            )\n                                        \"\n                                    >\n                                        <app-icon>delete</app-icon>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </ng-container>\n                </ng-container>\n            </ng-container>\n            <ng-template #empty_state>\n                <div\n                    class=\"flex flex-col items-center justify-center px-8 py-16 space-y-4\"\n                >\n                    <img src=\"assets/icons/no-results.svg\" class=\"m-auto\" />\n                    <p class=\"opacity-30\">\n                        No work days are currently set for this user\n                    </p>\n                </div>\n            </ng-template>\n        </main>\n        <footer\n            class=\"flex justify-end px-4 py-2 border-t border-base-200\"\n            *ngIf=\"!loading\"\n        >\n            <button btn matRipple class=\"w-48\" (click)=\"saveChanges()\">\n                Save\n            </button>\n        </footer>\n        <ng-template #load_state>\n            <div\n                loading\n                class=\"relative bg-base-100 flex flex-col justify-center items-center rounded overflow-hidden w-[24rem] h-[18rem] text-center space-y-2\"\n            >\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p class=\"opacity-30\">\n                    Saving changes to work location settings...\n                </p>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class WFHSettingsModalComponent implements OnInit {\n    public readonly options = [\n        { id: 'wfo', name: 'Office' },\n        { id: 'wfh', name: 'Home' },\n        { id: 'aol', name: 'Leave' },\n    ];\n    public option = this.options[0].id;\n    public settings: WorktimePreference[] = [];\n    public weekdays_enabled: Record<number, boolean> = {};\n    public changed = false;\n    public loading = false;\n    public readonly available_weekdays = [];\n    public readonly days = new Array(7)\n        .fill(0)\n        .map((_, idx) => addDays(startOfWeek(addDays(Date.now(), 30)), idx));\n\n    public get has_working_days() {\n        return Object.keys(this.weekdays_enabled).some(\n            (day) => this.weekdays_enabled[day],\n        );\n    }\n\n    public get option_name() {\n        return this.options.find((_) => _.id === this.option)?.name || '';\n    }\n\n    public get now() {\n        return startOfMinute(Date.now()).getTime();\n    }\n\n    constructor(private _dialog_ref: MatDialogRef<WFHSettingsModalComponent>) {}\n\n    public ngOnInit() {\n        const user = currentUser();\n        this.settings = [\n            ...(user.work_preferences || []).map((_) => ({\n                ..._,\n                blocks: [...(_?.blocks || [])],\n            })),\n        ];\n        for (const day of this.settings) {\n            if (day.blocks.length)\n                this.weekdays_enabled[day.day_of_week] = true;\n        }\n    }\n\n    public timeFrom(hours: number) {\n        return startOfMinute(\n            set(addDays(new Date(), 1), {\n                hours: Math.floor(hours),\n                minutes: (hours * 60) % 60,\n            }),\n        ).getTime();\n    }\n\n    public fromTime(time: number) {\n        const date = new Date(time);\n        return date.getHours() + date.getMinutes() / 60;\n    }\n\n    public initialiseDay(day: number) {\n        if (!this.settings[day])\n            this.settings[day] = { day_of_week: day as any, blocks: [] };\n        if (!this.settings[day].blocks) this.settings[day].blocks = [];\n        if (this.settings[day].blocks.length === 0) {\n            this.addBlock(this.settings[day], 0);\n        }\n    }\n\n    public addBlock(pref: WorktimePreference, index: number) {\n        pref.blocks.splice(index + 1, 0, {\n            start_time: 9,\n            end_time: 17,\n            location: 'wfo',\n        });\n        this.cleanupBlocks(pref);\n    }\n\n    public removeBlock(pref: WorktimePreference, index: number) {\n        if (pref.blocks.length <= 1) return;\n        pref.blocks.splice(index, 1);\n    }\n\n    public setEndTime(block: WorktimeBlock, day: number, time: number) {\n        setTimeout(() => {\n            block.end_time = this.fromTime(time);\n            this.cleanupBlocks(this.settings[day]);\n        }, 50);\n    }\n\n    public setStartTime(block: WorktimeBlock, day: number, time: number) {\n        setTimeout(() => {\n            block.start_time = this.fromTime(time);\n            this.cleanupBlocks(this.settings[day]);\n        }, 50);\n    }\n\n    public cleanupBlocks(pref: WorktimePreference) {\n        if (!pref?.blocks?.length) return;\n        for (let i = 0; i < pref.blocks.length; i++) {\n            const block = pref.blocks[i];\n            if (i > 0) {\n                if (block.start_time < pref.blocks[i - 1].end_time) {\n                    block.start_time = pref.blocks[i - 1].end_time;\n                }\n            }\n            if (block.end_time <= block.start_time) {\n                block.end_time = block.start_time + 1;\n            }\n        }\n    }\n\n    public async saveChanges(close = true) {\n        this.loading = true;\n        this._dialog_ref.disableClose = true;\n        const user = await showUser('current').toPromise();\n        const new_settings = new Array(7)\n            .fill(0)\n            .map((_, idx) => ({ day_of_week: idx, blocks: [] }));\n        for (const day of this.days) {\n            const day_of_week = day.getDay();\n            if (this.weekdays_enabled[day_of_week]) {\n                new_settings[day_of_week] = {\n                    day_of_week: day_of_week,\n                    blocks: this.settings[day_of_week].blocks,\n                };\n            }\n        }\n        console.log('Update user...');\n        await updateUser(user.id, {\n            ...user,\n            groups: user.groups.filter((_) => !_.startsWith('placeos_')),\n            work_preferences: new_settings,\n        } as any)\n            .toPromise()\n            .catch((e) => {\n                this.loading = false;\n                this._dialog_ref.disableClose = false;\n                notifyError('Unable to save user work preferences.');\n                throw e;\n            });\n        console.log('Updated user');\n        this.loading = false;\n        this._dialog_ref.disableClose = false;\n        if (close) {\n            reloadUserData();\n            console.log('Close WFH Modal');\n            this._dialog_ref.close();\n        }\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport { CustomTooltipData } from '@placeos/components';\n\n@Component({\n    selector: 'accessibility-tooltip',\n    template: `\n        <div\n            class=\"flex flex-col w-[18.5rem] rounded bg-base-100 shadow relative -top-12 -right-1 overflow-hidden\"\n        >\n            <div class=\"flex items-center space-x-2 p-2\" (click)=\"close()\">\n                <app-icon class=\"text-2xl\">arrow_back</app-icon>\n                <div class=\"\" i18n>Display & Accessibility</div>\n            </div>\n            <div\n                action\n                *ngIf=\"can_change_dark_mode\"\n                class=\"flex items-center space-x-2 w-full text-left h-auto px-4\"\n            >\n                <div\n                    class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200 my-2\"\n                >\n                    <app-icon class=\"text-xl\">mode_night</app-icon>\n                </div>\n                <div class=\"flex-1 text-sm\" i18n>Dark Mode</div>\n                <mat-slide-toggle\n                    [ngModel]=\"dark_mode\"\n                    (ngModelChange)=\"setDarkMode($event)\"\n                ></mat-slide-toggle>\n            </div>\n            <div\n                action\n                class=\"flex items-center space-x-2 w-full text-left h-auto px-4\"\n            >\n                <div\n                    class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200 my-2\"\n                >\n                    <app-icon class=\"text-xl\">playlist_add</app-icon>\n                </div>\n                <div class=\"flex-1 text-sm\" i18n>Large Accessibility Sizes</div>\n                <mat-slide-toggle\n                    [ngModel]=\"accessible\"\n                    (ngModelChange)=\"applySetting('accessible', $event)\"\n                ></mat-slide-toggle>\n            </div>\n            <ng-container *ngIf=\"accessible\">\n                <div class=\"px-8 py-4 bg-base-200 text-center\" i18n>\n                    Adjust your preferred reading size below.\n                </div>\n                <div class=\"flex items-center px-4 space-x-4\">\n                    <span class=\"text-sm\">A</span>\n                    <mat-slider\n                        class=\"flex-1 w-1/2 text-[16px]\"\n                        [min]=\"10\"\n                        [max]=\"24\"\n                        [step]=\"2\"\n                    >\n                        <input\n                            matSliderThumb\n                            class=\"text-[16px]\"\n                            [ngModel]=\"font_size\"\n                            (ngModelChange)=\"applySetting('font_size', $event)\"\n                        />\n                    </mat-slider>\n                    <span class=\"text-2xl\">A</span>\n                    <span\n                        class=\"text-base py-1 px-2 rounded bg-base-300 text-white my-2\"\n                    >\n                        {{ font_size }}px\n                    </span>\n                </div>\n            </ng-container>\n        </div>\n    `,\n    styles: [\n        `\n            :host > div > [action] {\n                border-top: 1px solid #ccc;\n            }\n        `,\n    ],\n})\nexport class AccessibilityTooltipComponent extends AsyncHandler {\n    public get dark_mode() {\n        return this._settings.get('theme') === 'dark';\n    }\n\n    public get can_change_dark_mode() {\n        return !!this._settings.get('app.general.dark_mode');\n    }\n\n    public get accessible() {\n        return !!this._settings.get('accessible');\n    }\n\n    public get font_size() {\n        return this._settings.get('font_size') || 16;\n    }\n\n    public readonly applySetting = (n, v) =>\n        this.timeout(\n            'apply_setting',\n            () => this._settings.saveUserSetting(n, v),\n            1000\n        );\n\n    public readonly close = () => this._data?.close();\n\n    constructor(\n        @Inject(CustomTooltipData) private _data: any,\n        private _settings: SettingsService\n    ) {\n        super();\n    }\n\n    public setDarkMode(state: boolean) {\n        const theme = this._settings.get('theme');\n        if (state && theme !== 'dark') this._settings.setTheme('dark');\n        else if (!state && theme === 'dark') this._settings.setTheme('light');\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { CustomTooltipData } from '@placeos/components';\nimport { OrganisationService } from '@placeos/organisation';\n\n@Component({\n    selector: 'building-select',\n    template: `\n        <div\n            class=\"flex flex-col w-[18.5rem] rounded bg-base-100 shadow p-2 relative -top-12 -right-1 overflow-auto max-h-[65vh]\"\n            (click)=\"close()\"\n        >\n            <div class=\"flex items-center space-x-2\">\n                <app-icon class=\"text-2xl\">arrow_back</app-icon>\n                <div class=\"\">\n                    {{\n                        (building | async)?.display_name ||\n                            (building | async)?.name\n                    }}\n                </div>\n            </div>\n            <div class=\"text-xs opacity-60 mb-4 px-2\" i18n>\n                Select a building location\n            </div>\n            <mat-radio-group\n                [ngModel]=\"(building | async)?.id\"\n                class=\"flex flex-col space-y-2 px-2\"\n            >\n                <mat-radio-button\n                    *ngFor=\"let bld of buildings | async\"\n                    [value]=\"bld.id\"\n                    (click)=\"setBuilding(bld)\"\n                >\n                    {{ bld.display_name || bld.name }}\n                </mat-radio-button>\n            </mat-radio-group>\n        </div>\n    `,\n    styles: [``],\n})\nexport class BuildingSelectComponent {\n    public readonly buildings = this._org.active_buildings;\n    public readonly building = this._org.active_building;\n\n    public readonly setBuilding = (b) => {\n        this._org.building = b;\n        this._org.saveBuilding(b.id);\n        this._data?.close();\n    };\n\n    public readonly close = () => this._data?.close();\n\n    constructor(\n        @Inject(CustomTooltipData) private _data: any,\n        private _org: OrganisationService\n    ) {}\n}\n","import { Component, Inject } from '@angular/core';\nimport { ApplicationLink, SettingsService } from '@placeos/common';\nimport { CustomTooltipData } from '@placeos/components';\n\n@Component({\n    selector: 'help-tooltip',\n    template: `\n        <div\n            class=\"flex flex-col w-[18.5rem] rounded bg-base-100 shadow relative -top-12 -right-1 divide-y divide-base-200\"\n            (click)=\"close()\"\n        >\n            <div class=\"flex items-center space-x-2 p-2 border-b\">\n                <app-icon class=\"text-2xl\">arrow_back</app-icon>\n                <div class=\"\" i18n>Help & Support</div>\n            </div>\n            <a\n                btn\n                matRipple\n                *ngFor=\"let tile of tiles\"\n                class=\"clear w-full text-left h-auto\"\n                target=\"_blank\"\n                ref=\"noreferer noopener\"\n                [href]=\"tile.link\"\n            >\n                <div class=\"flex items-center space-x-2 py-2 w-full\">\n                    <div\n                        class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200\"\n                    >\n                        <app-icon class=\"text-xl\" [icon]=\"tile.icon\"></app-icon>\n                    </div>\n                    <div class=\"flex-1\">{{ tile.name }}</div>\n                </div>\n            </a>\n        </div>\n    `,\n    styles: [\n        `\n            a:not(:last-child) {\n                border-bottom-width: 1px !important;\n                border-bottom-style: solid !important;\n                border-radius: 0;\n            }\n        `,\n    ],\n})\nexport class HelpTooltipComponent {\n    /** Tiles to display on the help page */\n    public get tiles(): ApplicationLink[] {\n        return this._settings.get('app.help') || [];\n    }\n\n    public readonly close = () => {\n        this._data?.close();\n    };\n\n    constructor(\n        @Inject(CustomTooltipData) private _data: any,\n        private _settings: SettingsService\n    ) {}\n}\n","import { Component, Inject } from '@angular/core';\nimport { TranslateService } from '@ngx-translate/core';\nimport { SettingsService } from '@placeos/common';\nimport { CustomTooltipData } from '@placeos/components';\n\n@Component({\n    selector: 'language-select',\n    template: `\n        <div\n            class=\"flex flex-col w-[18.5rem] rounded bg-base-100 shadow relative -top-12 -right-1\"\n            (click)=\"close()\"\n        >\n            <div class=\"flex items-center space-x-2  p-2\">\n                <app-icon class=\"text-2xl\">arrow_back</app-icon>\n                <div class=\"\">{{ 'COMMON.LANGUAGE' | translate }}</div>\n            </div>\n            <div class=\"text-xs opacity-60 mb-4 px-2 p-4\">\n                {{ 'COMMON.LANGUAGE_SELECT' | translate }}\n            </div>\n            <button\n                *ngFor=\"let lang of locales\"\n                class=\"w-full p-4 border-t border-base-200 text-left\"\n                (click)=\"setLocale(lang.id)\"\n            >\n                {{ lang.name }} - {{ lang.flag }}\n            </button>\n        </div>\n    `,\n    styles: [``],\n})\nexport class LanguageSelectComponent {\n    public readonly setLocale = (code: string) => {\n        this._translation.use(code);\n        localStorage.setItem('PLACEOS.locale', code);\n    };\n\n    public get locales() {\n        return this._settings.get('app.locales') || [];\n    }\n\n    public readonly close = () => this._data?.close();\n\n    constructor(\n        @Inject(CustomTooltipData) private _data: any,\n        private _settings: SettingsService,\n        private _translation: TranslateService\n    ) {}\n}\n","import { Component, Inject } from '@angular/core';\nimport { CustomTooltipData } from '@placeos/components';\nimport { OrganisationService } from '@placeos/organisation';\n\n@Component({\n    selector: 'region-select',\n    template: `\n        <div\n            class=\"flex flex-col w-[18.5rem] rounded bg-base-100 shadow p-2 relative -top-12 -right-1 overflow-auto max-h-[65vh]\"\n            (click)=\"close()\"\n        >\n            <div class=\"flex items-center space-x-2\">\n                <app-icon class=\"text-2xl\">arrow_back</app-icon>\n                <div class=\"\">\n                    {{\n                        (region | async)?.display_name || (region | async)?.name\n                    }}\n                </div>\n            </div>\n            <div class=\"text-xs opacity-60 mb-4 px-2\" i18n>Select a region</div>\n            <mat-radio-group\n                [ngModel]=\"(region | async)?.id\"\n                class=\"flex flex-col space-y-2 px-2\"\n            >\n                <mat-radio-button\n                    *ngFor=\"let item of regions | async\"\n                    [value]=\"item.id\"\n                    (click)=\"setRegion(item)\"\n                >\n                    {{ item.display_name || item.name }}\n                </mat-radio-button>\n            </mat-radio-group>\n        </div>\n    `,\n    styles: [``],\n})\nexport class RegionSelectComponent {\n    public readonly regions = this._org.region_list;\n    public readonly region = this._org.active_region;\n\n    public readonly setRegion = async (i) => {\n        await this._org.setRegion(i);\n        this._org.saveBuilding(this._org.building.id);\n        this._data?.close();\n    };\n\n    public readonly close = () => this._data?.close();\n\n    constructor(\n        @Inject(CustomTooltipData) private _data: any,\n        private _org: OrganisationService\n    ) {}\n}\n","import { Component } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport {\n    currentUser,\n    notifyError,\n    notifySuccess,\n    SettingsService,\n} from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { getModule } from '@placeos/ts-client';\n\nexport interface SupportRequestType {\n    name: string;\n    email: string;\n}\n\n@Component({\n    selector: 'support-ticket-modal',\n    template: `\n        <header class=\"flex items-center justify-between\">\n            <h2 i18n>Raise a support ticket</h2>\n            <button icon mat-dialog-close>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main class=\"w-[32rem] max-w-[85vw]\" *ngIf=\"!loading; else load_state\">\n            <form class=\"p-2\" [formGroup]=\"form\">\n                <div class=\"flex items-center sm:space-x-2 flex-wrap\">\n                    <div class=\"flex flex-col flex-1\">\n                        <label i18n>Name<span>*</span></label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                placeholder=\"Name\"\n                                formControlName=\"name\"\n                            />\n                            <mat-error i18n>Name is required</mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div class=\"flex flex-col flex-1\">\n                        <label i18n>Email<span>*</span></label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                placeholder=\"Email\"\n                                formControlName=\"email\"\n                            />\n                            <mat-error i18n>Email is required</mat-error>\n                        </mat-form-field>\n                    </div>\n                </div>\n                <div class=\"flex flex-col\">\n                    <label i18n>Location</label>\n                    <mat-form-field appearance=\"outline\" class=\"w-full\">\n                        <mat-select\n                            placeholder=\"Location\"\n                            formControlName=\"location\"\n                        >\n                            <mat-option\n                                *ngFor=\"let bld of buildings | async\"\n                                [value]=\"bld.display_name || bld.name\"\n                            >\n                                {{ bld.display_name || bld.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <div\n                    class=\"flex flex-col\"\n                    *ngIf=\"support_request_types?.length\"\n                >\n                    <label i18n>Issue Type</label>\n                    <mat-form-field appearance=\"outline\" class=\"w-full\">\n                        <mat-select\n                            placeholder=\"Issue Type\"\n                            formControlName=\"issue_type\"\n                        >\n                            <mat-option\n                                *ngFor=\"let type of support_request_types\"\n                                [value]=\"type?.name || type\"\n                            >\n                                {{ type.name || type }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <div>\n                    <label class=\"mb-4\" i18n>\n                        Issue Description<span>*</span>\n                    </label>\n                    <rich-text-input\n                        placeholder=\"Issue Description\"\n                        formControlName=\"description\"\n                    ></rich-text-input>\n                    <mat-error class=\"text-xs my-2\" *ngIf=\"desc_error\" i18n>\n                        Description is required\n                    </mat-error>\n                </div>\n                <div *ngIf=\"allow_images\">\n                    <label class=\"mb-4\" i18n>Images</label>\n                    <image-list-field\n                        formControlName=\"images\"\n                    ></image-list-field>\n                </div>\n            </form>\n            <div class=\"italic text-center text-xs mb-2\" i18n>\n                Completing this form will raise an incident in your support\n                management platform\n            </div>\n        </main>\n        <footer\n            class=\"p-2 border-t border-base-200 flex items-center justify-center\"\n            *ngIf=\"!loading\"\n        >\n            <button btn matRipple class=\"w-32\" (click)=\"submit()\" i18n>\n                Submit\n            </button>\n        </footer>\n        <ng-template #load_state>\n            <main\n                class=\"w-[32rem] min-h-[24rem] max-w-[100vw] flex flex-col items-center justify-center space-y-2\"\n            >\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p>Sending support ticket...</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [\n        `\n            mat-form-field {\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class SupportTicketModalComponent {\n    public loading = false;\n    public readonly form = new FormGroup({\n        name: new FormControl('', [Validators.required]),\n        email: new FormControl('', [Validators.required]),\n        location: new FormControl(''),\n        description: new FormControl('', [Validators.required]),\n        issue_type: new FormControl(''),\n        images: new FormControl([]),\n    });\n\n    public get desc_error() {\n        return (\n            !this.form.controls.description.valid &&\n            this.form.controls.description.touched\n        );\n    }\n\n    public get support_email() {\n        return this._settings.get('app.support_email') || 'support@place.tech';\n    }\n\n    public get support_request_types(): SupportRequestType[] {\n        return this._settings.get('app.support_issue_types') || [];\n    }\n\n    public get allow_images() {\n        return this._settings.get('app.allow_support_ticket_images');\n    }\n\n    public readonly buildings = this._org.building_list;\n\n    constructor(\n        private _dialog_ref: MatDialogRef<SupportTicketModalComponent>,\n        private _org: OrganisationService,\n        private _settings: SettingsService,\n    ) {}\n\n    public ngOnInit() {\n        const user = currentUser();\n        if (user) {\n            this.form.patchValue({\n                name: user.name,\n                email: user.email,\n            });\n        }\n        if (this._org.building) {\n            this.form.patchValue({\n                location:\n                    this._org.building.display_name || this._org.building.name,\n            });\n        }\n    }\n\n    public async submit() {\n        this.loading = true;\n        this.form.markAllAsTouched();\n        this.form.updateValueAndValidity();\n        if (this.form.valid) {\n            const stmp_system = this._org.binding('smtp');\n            if (!stmp_system) {\n                return notifyError(\n                    'Mailing system not configured for application.',\n                );\n            }\n            const mod = getModule(stmp_system, 'Mailer');\n            const { name, email, location, description, images, issue_type } =\n                this.form.value;\n            const support_email =\n                this.support_request_types.find(\n                    (type) => type.name === issue_type,\n                )?.email || this.support_email;\n            await mod.execute('send_mail', [\n                support_email,\n                `Support Ticket from Workplace Application${\n                    issue_type ? ' - ' + issue_type : ''\n                }`,\n                `${name}\\n${email}\\n\\n${location}\\n\\n${description.replace(\n                    /<[^>]+>/g,\n                    '',\n                )}\\n\\n${images.join('\\n')}`,\n                `<p>${name}</p><p>${email}</p><p>${location}</p><p>${description}</p>${images.join(\n                    '<br>',\n                )}`,\n                [],\n                [],\n                [],\n                [],\n                null,\n                `${email}`,\n            ]);\n            this._dialog_ref.close();\n            this.loading = false;\n            notifySuccess('Successfully submitted support ticket');\n        }\n    }\n}\n","import { Component } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { currentUser, reloadUserData } from '@placeos/common';\nimport { updateUser } from '@placeos/ts-client';\nimport { WorktimePreference } from '@placeos/users';\nimport {\n    format,\n    parse,\n    set,\n    startOfMinute,\n    isBefore,\n    addDays,\n    startOfDay,\n} from 'date-fns';\n\nimport { WFHSettingsModalComponent } from 'libs/users/src/lib/wfh-settings-modal.component';\n\n@Component({\n    selector: 'work-location-tooltip',\n    template: `\n        <div\n            class=\"flex flex-col w-[18.5rem] rounded bg-base-100 shadow relative -top-12 -right-1 overflow-hidden\"\n        >\n            <div class=\"flex items-center justify-between px-2\">\n                <h3 class=\"px-2 py-4 font-medium\">Work Location</h3>\n                <button\n                    icon\n                    matRipple\n                    matTooltip=\"Edit Work Location Preferences\"\n                    matTooltipPosition=\"left\"\n                    class=\"hover:bg-base-200\"\n                    (click)=\"editSettings()\"\n                >\n                    <app-icon>edit_note</app-icon>\n                </button>\n            </div>\n\n            <h3 class=\"px-4 font-medium text-sm\">\n                {{ now | date: 'fullDate' }}\n            </h3>\n            <div\n                class=\"pb-2\"\n                *ngIf=\"active_preference?.blocks?.length; else empty_state\"\n            >\n                <div\n                    class=\"relative flex items-center px-4 py-2\"\n                    *ngFor=\"\n                        let block of active_preference?.blocks;\n                        let i = index\n                    \"\n                    [class.opacity-30]=\"now > timeFrom(block.end_time)\"\n                >\n                    <div\n                        class=\"rounded-full h-10 w-10 flex items-center justify-center bg-base-200 z-20\"\n                        [class.bg-base-200]=\"\n                            now < timeFrom(block.start_time) ||\n                            now > timeFrom(block.end_time)\n                        \"\n                        [class.bg-info]=\"\n                            now >= timeFrom(block.start_time) &&\n                            now <= timeFrom(block.end_time)\n                        \"\n                        [class.text-info-content]=\"\n                            now >= timeFrom(block.start_time) &&\n                            now <= timeFrom(block.end_time)\n                        \"\n                    >\n                        <app-icon class=\"text-2xl\">{{\n                            location_icon(timeFrom(block.start_time))\n                        }}</app-icon>\n                    </div>\n                    <div class=\"flex-1 ml-2\">\n                        <button\n                            matRipple\n                            class=\"font-medium flex items-center space-x-2 rounded hover:bg-base-200 px-2 py-1\"\n                            [matMenuTriggerFor]=\"menu\"\n                        >\n                            <div>\n                                {{ location(timeFrom(block.start_time)) }}\n                            </div>\n                            <app-icon>expand_more</app-icon>\n                        </button>\n                        <mat-menu #menu=\"matMenu\">\n                            <button\n                                mat-menu-item\n                                *ngFor=\"let loc of locations\"\n                                (click)=\"setLocation(i, loc.id)\"\n                            >\n                                <div class=\"flex items-center space-x-2\">\n                                    <app-icon class=\"text-2xl\">{{\n                                        loc.icon\n                                    }}</app-icon>\n                                    <div class=\"pr-8\">{{ loc.name }}</div>\n                                </div>\n                            </button>\n                        </mat-menu>\n                        <div class=\"text-xs opacity-60 px-2\">\n                            {{ timeFrom(block.start_time) | date: 'shortTime' }}\n                            &ndash;\n                            {{ timeFrom(block.end_time) | date: 'shortTime' }}\n                        </div>\n                    </div>\n                    <div\n                        *ngIf=\"i > 0\"\n                        class=\"absolute -top-2 left-7 h-4 w-0 border-l-2 border-dashed border-base-200 -translate-x-px\"\n                    ></div>\n                </div>\n            </div>\n        </div>\n        <ng-template #empty_state>\n            <div\n                class=\"flex flex-col items-center justify-center p-8 space-y-2 w-full opacity-30\"\n            >\n                <app-icon class=\"text-6xl\">event_busy</app-icon>\n                <p class=\"text-center text-sm\">No work location for today.</p>\n                <p class=\"text-center text-sm\">\n                    Click the edit button on the top right to edit your work\n                    location preferences.\n                </p>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class WorkLocationTooltipComponent {\n    public readonly locations = [\n        { id: 'wfo', name: 'Office', icon: 'business' },\n        { id: 'wfh', name: 'Home', icon: 'home' },\n        { id: 'aol', name: 'Leave', icon: 'event_busy' },\n    ];\n    public settings: WorktimePreference[];\n    public overrides: Record<string, WorktimePreference>;\n\n    public get active_preference() {\n        const date = format(new Date(), 'yyyy-MM-dd');\n        if (this.overrides[date]) return this.overrides[date];\n        return this.settings.find(\n            (pref) => pref.day_of_week === new Date().getDay(),\n        );\n    }\n\n    public get now() {\n        return startOfMinute(Date.now()).getTime();\n    }\n\n    constructor(private _dialog: MatDialog) {}\n\n    public ngOnInit() {\n        const user = currentUser();\n        this.settings = user.work_preferences;\n        this.overrides = user.work_overrides;\n    }\n\n    public location_icon(time: number) {\n        const user = currentUser();\n        return user.location_icon(time + 1 * 60 * 1000);\n    }\n\n    public location(time: number) {\n        const user = currentUser();\n        return user.location_name_time(time + 1 * 60 * 1000);\n    }\n\n    public timeFrom(hours: number) {\n        return startOfMinute(\n            set(new Date(), {\n                hours: Math.floor(hours),\n                minutes: (hours * 60) % 60,\n                seconds: 0,\n                milliseconds: 0,\n            }),\n        ).getTime();\n    }\n\n    public editSettings() {\n        this._dialog.open(WFHSettingsModalComponent);\n    }\n\n    public async setLocation(index: number, location: string) {\n        const user = currentUser();\n        const active_preference = this.active_preference;\n        const date = format(Date.now(), 'yyyy-MM-dd');\n        const new_overrides = {\n            ...user.work_overrides,\n            [date]: {\n                ...active_preference,\n                blocks: [\n                    ...active_preference.blocks.slice(0, index),\n                    {\n                        ...active_preference.blocks[index],\n                        location,\n                    },\n                    ...active_preference.blocks.slice(index + 1),\n                ],\n            },\n        };\n        for (const key in new_overrides) {\n            const key_date = parse(key, 'yyyy-MM-dd', new Date());\n            if (\n                !new_overrides[key].blocks.length ||\n                isBefore(key_date, addDays(startOfDay(Date.now()), -1))\n            ) {\n                delete new_overrides[key];\n            }\n        }\n        this.overrides = new_overrides;\n        await updateUser(user.id, {\n            ...user,\n            work_overrides: new_overrides,\n        } as any).toPromise();\n        reloadUserData();\n    }\n}\n","import { Component } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    currentUser,\n    hasNewVersion,\n    SettingsService,\n    VERSION,\n} from '@placeos/common';\nimport { ChangelogModalComponent } from '@placeos/components';\nimport { OrganisationService } from '@placeos/organisation';\nimport { logout } from '@placeos/ts-client';\nimport { WFHSettingsModalComponent } from 'libs/users/src/lib/wfh-settings-modal.component';\nimport { AccessibilityTooltipComponent } from './accessibility-tooltip.component';\nimport { BuildingSelectComponent } from './building-select.component';\nimport { HelpTooltipComponent } from './help-tooltip.component';\nimport { LanguageSelectComponent } from './language-tooltip.component';\nimport { RegionSelectComponent } from './region-select.component';\nimport { SupportTicketModalComponent } from 'libs/form-fields/src/lib/support-ticket-modal.component';\nimport { first } from 'rxjs/operators';\nimport { WorkLocationTooltipComponent } from './work-location-tooltip.component';\n\nexport interface AppLocale {\n    id: string;\n    name: string;\n    flag: string;\n}\n\n@Component({\n    selector: 'user-controls',\n    template: `\n        <div\n            class=\"rounded bg-base-100 shadow mt-1 flex flex-col relative divide-y divide-base-200\"\n        >\n            <div avatar class=\"flex flex-col items-center p-2 w-[18rem]\">\n                <a-user-avatar\n                    class=\"text-2xl\"\n                    [user]=\"user\"\n                    [matTooltip]=\"groups\"\n                ></a-user-avatar>\n                <div class=\"\">{{ user?.name }}</div>\n                <div class=\"text-xs opacity-60 truncate\">{{ user?.email }}</div>\n            </div>\n            <div\n                customTooltip\n                *ngIf=\"(regions | async).length\"\n                [content]=\"region_select\"\n                class=\"relative\"\n            >\n                <button btn matRipple class=\"clear w-full text-left h-[3.5rem]\">\n                    <div class=\"w-full flex items-center space-x-2\">\n                        <div\n                            class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200\"\n                        >\n                            <app-icon>layers</app-icon>\n                        </div>\n                        <div class=\"flex-1 truncate w-px\">\n                            {{\n                                (region | async)?.display_name ||\n                                    (region | async)?.name\n                            }}\n                        </div>\n                        <app-icon class=\"opacity-60 text-2xl\">\n                            chevron_right\n                        </app-icon>\n                    </div>\n                </button>\n            </div>\n            <div\n                customTooltip\n                [content]=\"building_select\"\n                class=\"relative\"\n                *ngIf=\"!disable_building_select && !use_region\"\n            >\n                <button btn matRipple class=\"clear w-full text-left h-[3.5rem]\">\n                    <div class=\"w-full flex items-center space-x-2\">\n                        <div\n                            class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200\"\n                        >\n                            <app-icon>business</app-icon>\n                        </div>\n                        <div class=\"flex-1 truncate w-px\">\n                            {{\n                                (building | async)?.display_name ||\n                                    (building | async)?.name\n                            }}\n                        </div>\n                        <app-icon class=\"opacity-60 text-2xl\">\n                            chevron_right\n                        </app-icon>\n                    </div>\n                </button>\n            </div>\n            <div\n                customTooltip\n                [content]=\"help_tooltip\"\n                *ngIf=\"features.includes('help')\"\n            >\n                <button btn matRipple class=\"clear w-full text-left h-[3.5rem]\">\n                    <div class=\"w-full flex items-center space-x-2\">\n                        <div\n                            class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200\"\n                        >\n                            <app-icon>help</app-icon>\n                        </div>\n                        <div class=\"flex-1\" i18n>Help & Support</div>\n                        <app-icon class=\"opacity-60 text-2xl\"\n                            >chevron_right</app-icon\n                        >\n                    </div>\n                </button>\n            </div>\n            <div\n                *ngIf=\"features.includes('wfh')\"\n                customTooltip\n                [content]=\"work_location_tooltip\"\n            >\n                <button btn matRipple class=\"clear w-full text-left h-[3.5rem]\">\n                    <div class=\"w-full flex items-center space-x-2\">\n                        <div\n                            class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200\"\n                        >\n                            <app-icon>share_location</app-icon>\n                        </div>\n                        <div class=\"flex-1\" i18n>Work Location</div>\n                        <app-icon class=\"opacity-60 text-2xl\"\n                            >chevron_right</app-icon\n                        >\n                    </div>\n                </button>\n            </div>\n            <div\n                customTooltip\n                [content]=\"accessibility_tooltip\"\n                [class.!border-b]=\"!locales?.length || !desk_height\"\n            >\n                <button btn matRipple class=\"clear w-full text-left h-[3.5rem]\">\n                    <div class=\"w-full flex items-center space-x-2\">\n                        <div\n                            class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200\"\n                        >\n                            <app-icon>mode_night</app-icon>\n                        </div>\n                        <div class=\"flex-1\" i18n>Display & Accessibility</div>\n                        <app-icon class=\"opacity-60 text-2xl\"\n                            >chevron_right</app-icon\n                        >\n                    </div>\n                </button>\n            </div>\n            <div\n                customTooltip\n                [content]=\"desk_height_tooltip\"\n                [class.!border-b]=\"!locales?.length\"\n                *ngIf=\"desk_height\"\n            >\n                <button btn matRipple class=\"clear w-full text-left h-[3.5rem]\">\n                    <div class=\"w-full flex items-center space-x-2\">\n                        <div\n                            class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200\"\n                        >\n                            <app-icon>desk</app-icon>\n                        </div>\n                        <div class=\"flex-1\" i18n>Desk Settings</div>\n                        <app-icon class=\"opacity-60 text-2xl\"\n                            >chevron_right</app-icon\n                        >\n                    </div>\n                </button>\n            </div>\n            <ng-template #desk_height_tooltip>\n                <desk-height-presets></desk-height-presets>\n            </ng-template>\n            <div\n                customTooltip\n                [content]=\"language_tooltip\"\n                *ngIf=\"locales?.length\"\n                class=\"!border-b\"\n            >\n                <button btn matRipple class=\"clear w-full text-left h-[3.5rem]\">\n                    <div class=\"w-full flex items-center space-x-2\">\n                        <div\n                            class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200\"\n                        >\n                            <app-icon>mode_night</app-icon>\n                        </div>\n                        <div class=\"flex-1\" i18n>\n                            {{ 'COMMON.LANGUAGE_LABEL' | translate }}:\n                            {{ 'COMMON.LANGUAGE' | translate }}\n                        </div>\n                        <app-icon class=\"opacity-60 text-2xl\"\n                            >chevron_right</app-icon\n                        >\n                    </div>\n                </button>\n            </div>\n            <button\n                btn\n                matRipple\n                class=\"clear w-full text-left h-[3.5rem]\"\n                *ngIf=\"features.includes('support-ticket')\"\n                (click)=\"newSupportTicket()\"\n            >\n                <div class=\"w-full flex items-center space-x-2\">\n                    <div\n                        class=\"flex items-center justify-center rounded-full w-8 h-8 bg-base-200\"\n                    >\n                        <app-icon>support_agent</app-icon>\n                    </div>\n                    <div class=\"flex-1\" i18n>Raise a support ticket</div>\n                </div>\n            </button>\n            <div class=\"flex flex-col items-center p-4\">\n                <div class=\"flex items-center justify-center space-x-2 mb-4\">\n                    <button\n                        btn\n                        matRipple\n                        i18n\n                        class=\"inverse\"\n                        (click)=\"logout()\"\n                    >\n                        Sign Out\n                    </button>\n                    <button\n                        btn\n                        matRipple\n                        *ngIf=\"has_new_version\"\n                        (click)=\"reloadPage()\"\n                    >\n                        New Version\n                    </button>\n                </div>\n                <div class=\"text-xs opacity-60 w-full\">\n                    <ng-container i18n>Version: </ng-container>\n                    <button\n                        class=\"underline p-0 m-0 bg-none border-none text-xs\"\n                        (click)=\"viewChangelog()\"\n                    >\n                        {{ version.hash }}\n                    </button>\n                </div>\n                <div class=\"text-xs opacity-60 w-full\">\n                    {{ version.time | date: 'longDate' }}\n                    ({{ version.time | date: 'shortTime' }})\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class UserControlsComponent {\n    public readonly building = this._org.active_building;\n    public readonly region = this._org.active_region;\n    public readonly regions = this._org.region_list;\n\n    public readonly region_select = RegionSelectComponent;\n    public readonly building_select = BuildingSelectComponent;\n    public readonly help_tooltip = HelpTooltipComponent;\n    public readonly accessibility_tooltip = AccessibilityTooltipComponent;\n    public readonly language_tooltip = LanguageSelectComponent;\n    public readonly work_location_tooltip = WorkLocationTooltipComponent;\n\n    public get user() {\n        return currentUser();\n    }\n\n    public get groups() {\n        return this.user.groups.join('\\n');\n    }\n\n    public get version() {\n        return VERSION;\n    }\n\n    public get features(): string[] {\n        return this._settings.get('app.features') || [];\n    }\n\n    public get locales(): [] {\n        return this._settings.get('app.locales') || [];\n    }\n\n    public get desk_height() {\n        return this._settings.get('app.desks.height_enabled');\n    }\n\n    public get use_region(): boolean {\n        return this._settings.get('app.use_region');\n    }\n\n    public get disable_building_select() {\n        return this._settings.get('app.disable_building_select');\n    }\n\n    public get has_new_version() {\n        return hasNewVersion();\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _org: OrganisationService,\n        private _dialog: MatDialog,\n    ) {}\n\n    public logout() {\n        logout();\n    }\n\n    public reloadPage() {\n        location.reload();\n    }\n\n    public newSupportTicket() {\n        if (this._settings.get('app.external_support_url')) {\n            window.open(\n                this._settings.get('app.external_support_url'),\n                '_blank',\n            );\n        } else {\n            this._dialog.open(SupportTicketModalComponent);\n        }\n    }\n\n    public openWfhModal() {\n        this._dialog.open(WFHSettingsModalComponent);\n    }\n\n    public async viewChangelog() {\n        const changelog = await (\n            await fetch(\n                'https://raw.githubusercontent.com/PlaceOS/user-interfaces/develop/CHANGELOG.md',\n            )\n        ).text();\n        this._dialog.open(ChangelogModalComponent, { data: { changelog } });\n    }\n\n    public saveSetting(name: string, value: any) {\n        this._settings.saveUserSetting(name, value);\n    }\n\n    public formatLabel(value: number) {\n        return `${value.toFixed(1)}cm`;\n    }\n}\n","import {\n    Directive,\n    ElementRef,\n    Host,\n    Input,\n    SimpleChanges,\n} from '@angular/core';\nimport { AsyncHandler } from '@placeos/common';\nimport { apiKey, authority, token } from '@placeos/ts-client';\n\nconst IMAGE_STORE = new Map<string, string>();\n\n@Directive({\n    selector: 'img [auth], video [auth]',\n})\nexport class AuthenticatedImageDirective extends AsyncHandler {\n    @Input() public source: string;\n\n    constructor(private _image_el: ElementRef<HTMLImageElement>) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.source && this.source) this._loadImage();\n    }\n\n    private async _loadImage() {\n        if (!this._image_el || !authority()) {\n            return this.timeout('load', () => this._loadImage(), 300);\n        }\n        // If not an API call, just load the image\n        if (!this.source.includes('/api/engine/v2/uploads')) {\n            this._image_el.nativeElement.src = this.source;\n            return;\n        }\n        // If image has already been loaded, just use the cached version\n        if (IMAGE_STORE.has(this.source)) {\n            this._image_el.nativeElement.src = IMAGE_STORE.get(this.source);\n            return;\n        }\n        const tkn = token();\n        document.cookie = `${\n            tkn === 'x-api-key'\n                ? 'api-key=' + encodeURIComponent(apiKey())\n                : 'bearer_token=' + encodeURIComponent(tkn)\n        };max-age=30;path=/api/engine/v2/uploads;samesite=strict;${\n            location.protocol === 'https:' ? 'secure;' : ''\n        }`;\n        let response = null;\n        try {\n            response = await fetch(this.source).catch((_) => null);\n        } catch {}\n        if (!response || !response.ok) {\n            console.info('Failed to load image:', this.source);\n            return;\n        }\n        const blob = await response.blob();\n        const url = URL.createObjectURL(blob);\n        IMAGE_STORE.set(this.source, url);\n        this._image_el.nativeElement.src = url;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport {\n    AsyncHandler,\n    SettingsService,\n    currentUser,\n    log,\n    randomString,\n} from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { apiKey, getModule, token } from '@placeos/ts-client';\nimport { BehaviorSubject, Observable, combineLatest } from 'rxjs';\nimport { filter, map, shareReplay, switchMap } from 'rxjs/operators';\nimport { webSocket, WebSocketSubject } from 'rxjs/webSocket';\n\nimport * as marked from 'marked';\n\nexport interface ChatMessage {\n    id: string;\n    chat_id: string;\n    user_id: string;\n    message: string;\n    content: string;\n    function?: string;\n    timestamp: number;\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class ChatService extends AsyncHandler {\n    private _binding = new BehaviorSubject('');\n    private _chat_messages = new BehaviorSubject<ChatMessage[]>([]);\n    private _progress_message = new BehaviorSubject<ChatMessage | null>(null);\n    private _chat_system = combineLatest([\n        this._org.active_building,\n        this._binding,\n    ]).pipe(\n        filter(([b]) => !!b),\n        map(([_, biniding]) => biniding || this._org.binding('chat_room')),\n    );\n    private _chat_id = '';\n\n    public chat_hint: Observable<string> = this._chat_system.pipe(\n        filter((_) => !!_),\n        switchMap((id) => {\n            const mod = getModule(id, 'LLM');\n            const binding = mod.binding('user_hint');\n            this.subscription(`binding:LLM:user_hint`, binding.bind());\n            return binding.listen();\n        }),\n        shareReplay(1),\n    );\n    private _change = new BehaviorSubject(0);\n    private _socket?: WebSocketSubject<any>;\n    private _chat_pipe = combineLatest([this._chat_system, this._change]).pipe(\n        switchMap(([id]) => {\n            const auth =\n                token() !== 'x-api-key'\n                    ? `bearer_token=${encodeURIComponent(token())}`\n                    : `x-api-key=${apiKey()}`;\n            const url = `ws${location.origin.replace(\n                'http',\n                '',\n            )}/api/engine/v2/chatgpt/chat/${encodeURIComponent(id)}?${auth}${\n                this._chat_id\n                    ? '&resume=' + encodeURIComponent(this._chat_id)\n                    : ''\n            }`;\n            this._socket = webSocket<any>({\n                url,\n                serializer: (data) =>\n                    typeof data === 'object' ? JSON.stringify(data) : data,\n                deserializer: (data) => {\n                    let return_value = data.data;\n                    try {\n                        const obj = JSON.parse(data.data);\n                        return_value = obj;\n                    } catch (e) {\n                        return_value = return_value;\n                    }\n                    return return_value;\n                },\n            });\n            this.subscription(\n                'chat-ws',\n                this._socket.subscribe(\n                    (_) => this._onMessage(_),\n                    (e) => {\n                        log('CHAT', 'Connection error:', [e], 'error');\n                        this._cleanup();\n                    },\n                    () => this._cleanup(),\n                ),\n            );\n            return this._socket;\n        }),\n        shareReplay(1),\n    );\n\n    public readonly messages = this._chat_messages.asObservable();\n    public readonly progress = this._progress_message.asObservable();\n\n    public get connected() {\n        return !!this._socket;\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _settings: SettingsService,\n    ) {\n        super();\n    }\n\n    public setBinding(system_id: string) {\n        this._binding.next(system_id);\n    }\n\n    public startChat() {\n        if (this._socket) return;\n        this._change.next(Date.now());\n        log('CHAT', 'Starting chat connection.');\n        this.subscription('chat', this._chat_pipe.subscribe());\n        return () => this.endChat();\n    }\n\n    public endChat() {\n        log('CHAT', 'Dropping chat connection.');\n        this._socket?.complete();\n        this._cleanup();\n    }\n\n    public close() {\n        this.endChat();\n        this._chat_id = '';\n        this._chat_messages.next([]);\n    }\n\n    public sendMessage(message: string) {\n        if (!message) return;\n\n        this._onMessage({ chat_id: '', message, user_id: currentUser().id });\n        this._socket?.next(message);\n    }\n\n    private _timeoutSocket(delay = 55 * 1000) {\n        this.timeout(\n            'socket',\n            () => {\n                const msg_list = this._chat_messages.getValue();\n                if (\n                    msg_list.length > 0 &&\n                    msg_list[msg_list.length - 1].user_id !== 'assistant'\n                ) {\n                    return this._timeoutSocket(delay);\n                }\n                this.endChat();\n            },\n            delay,\n        );\n    }\n\n    private _cleanup() {\n        this._socket = null;\n        this.unsubWith('chat');\n    }\n\n    private _onMessage(msg) {\n        if (msg.chat_id) this._chat_id = msg.chat_id;\n        if (msg.type === 'progress') {\n            this._progress_message.next({\n                id: `msg-${randomString(6)}`,\n                chat_id: msg.chat_id,\n                message: msg.message,\n                content: marked.parse(msg.message, { async: false }) as any,\n                user_id: msg.user_id || 'assistant',\n                function: msg.function,\n                timestamp: Date.now(),\n            });\n            if (msg.function === 'task_complete') {\n                this._settings.post('CHAT:task_complete', msg.task_id);\n            }\n        } else {\n            this._chat_messages.next([\n                ...this._chat_messages.getValue(),\n                {\n                    id: `msg-${randomString(6)}`,\n                    chat_id: msg.chat_id,\n                    message: msg.message,\n                    content: marked.parse(msg.message, { async: false }) as any,\n                    user_id: msg.user_id || 'assistant',\n                    timestamp: Date.now(),\n                },\n            ]);\n            if (msg.type === 'response') {\n                this._progress_message.next(null);\n            }\n        }\n        this._timeoutSocket();\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { differenceInMinutes, format } from 'date-fns';\n\n@Pipe({\n    name: 'dateFrom',\n})\nexport class DateFromPipe implements PipeTransform {\n    public transform(date: number): string {\n        const now = Date.now();\n        let diff = differenceInMinutes(now, date);\n        const direction = diff < 0;\n        diff = Math.abs(diff);\n        if (diff < 1) {\n            // Less than a minute\n            return direction ? 'Soon' : 'Now';\n        } else if (diff === 1) {\n            // 1 minute\n            return direction ? 'In 1 min' : '1 min';\n        } else if (diff < 60) {\n            // Minutes\n            return direction ? `In ${diff} min` : `${diff} min`;\n        } else if (diff < 24 * 60) {\n            // Hours\n            const hours = Math.floor(diff / 60);\n            return direction\n                ? `In ${hours} hour${hours === 1 ? '' : 's'}`\n                : format(date, 'H:mm');\n        } else if (diff < 7 * 24 * 60) {\n            // Days\n            const days = Math.floor(diff / (24 * 60));\n            return direction\n                ? format(date, 'dd MMM yyyy')\n                : format(date, 'E H:mm');\n        } else if (diff < 365 * 24 * 60) {\n            // Days\n            const days = Math.floor(diff / (24 * 60));\n            return direction\n                ? format(date, 'dd MMM yyyy')\n                : format(date, 'LLL d H:mm');\n        }\n        return 'Just now';\n    }\n}\n","import { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\nimport { AsyncHandler, SettingsService, current_user } from '@placeos/common';\nimport { ChatService } from './chat.service';\nimport { StaffUser } from '@placeos/users';\nimport { map } from 'rxjs/operators';\n\n@Component({\n    selector: 'global-chat',\n    template: `\n        <div class=\"absolute bottom-0 right-0 p-2\" *ngIf=\"can_show\">\n            <button\n                icon\n                matRipple\n                class=\"bg-base-100 rounded-full border border-base-300 shadow\"\n                (click)=\"toggleChat()\"\n            >\n                <app-icon>chat</app-icon>\n            </button>\n            <div\n                class=\"absolute bottom-2 right-2 bg-base-200 rounded-xl border border-base-300 shadow overflow-hidden w-[40rem] max-w-[calc(100vw-1rem)]\"\n                *ngIf=\"show\"\n            >\n                <div\n                    class=\"flex items-center justify-between bg-base-100 w-full p-2 border-b border-base-300\"\n                >\n                    <h3 class=\"pl-4\">Virtual Assistant</h3>\n                    <button icon matRipple (click)=\"toggleChat()\">\n                        <app-icon>close</app-icon>\n                    </button>\n                </div>\n                <div class=\"h-[32rem] max-h-[60vh] overflow-auto\" #container>\n                    <div\n                        class=\"w-full flex flex-col items-center justify-center p-8 space-y-2\"\n                    >\n                        <app-icon class=\"text-8xl\">forum</app-icon>\n                        <p class=\"text-center text-xl\">\n                            Hi {{ user.name }}. <br />\n                            Welcome to the virtual assistant.\n                        </p>\n                    </div>\n                    <div\n                        class=\"m-2 bg-base-100 border-base-300 p-4 rounded shadow text-sm\"\n                        *ngIf=\"hint | async\"\n                    >\n                        {{ hint | async }}\n                    </div>\n                    <div\n                        class=\"flex flex-col m-2\"\n                        *ngFor=\"let message of messages | async\"\n                        [class.pr-4]=\"message.user_id !== user.id\"\n                        [class.pl-4]=\"message.user_id === user.id\"\n                        [class.items-left]=\"message.user_id !== user.id\"\n                        [class.items-end]=\"message.user_id === user.id\"\n                        (click)=\"show_time[message.id] = !show_time[message.id]\"\n                        [class.waiting-margin]=\"waiting | async\"\n                    >\n                        <div class=\"flex items-center space-x-2\">\n                            <div\n                                class=\"text-sm text-base-content opacity-60 px-2 py-1\"\n                                *ngIf=\"message.user_id !== user.id\"\n                            >\n                                Assistant\n                            </div>\n                            <div\n                                class=\"text-xs  text-base-content opacity-40 px-2 py-1\"\n                            >\n                                {{ message.timestamp + offset | dateFrom }}\n                            </div>\n                        </div>\n                        <div\n                            message\n                            class=\"bg-base-100 border-base-300 p-4 rounded shadow text-sm markdown selectable\"\n                            [innerHTML]=\"message.content | sanitize\"\n                        ></div>\n                    </div>\n                    <div class=\"p-4\" *ngIf=\"progress | async\">\n                        <button\n                            class=\"block p-2 rounded border-base-300 bg-info text-info-content w-full\"\n                            (click)=\"show_info = !show_info\"\n                        >\n                            <div class=\" flex items-center space-x-2\">\n                                <app-icon class=\"text-2xl\">{{\n                                    icons[(progress | async).function] || 'info'\n                                }}</app-icon>\n                                <p class=\"text-sm\">\n                                    {{\n                                        (progress | async).message ||\n                                            (progress | async).function\n                                    }}\n                                </p>\n                            </div>\n                            <div\n                                class=\"relative overflow-hidden w-full rounded\"\n                            >\n                                <div\n                                    class=\"absolute inset-0 bg-base-100 opacity-10\"\n                                ></div>\n                                <div\n                                    class=\"text-xs text-mono text-left p-2 break-words\"\n                                    *ngIf=\"show_info\"\n                                    [innerHTML]=\"\n                                        (progress | async).content | sanitize\n                                    \"\n                                ></div>\n                            </div>\n                        </button>\n                    </div>\n                </div>\n                <div\n                    class=\"absolute right-2 flex items-center justify-center space-x-2 p-1 rounded-2xl bg-base-100 border border-neutral\"\n                    [style.bottom]=\"height + 8 + 'px'\"\n                    *ngIf=\"waiting | async\"\n                >\n                    <div\n                        class=\"h-2 w-2 bg-neutral rounded-full animate-bounce\"\n                    ></div>\n                    <div\n                        class=\"h-2 w-2 bg-neutral rounded-full animate-bounce anim-delay-1\"\n                    ></div>\n                    <div\n                        class=\"h-2 w-2 bg-neutral rounded-full animate-bounce anim-delay-2\"\n                    ></div>\n                    <span class=\"sr-only\">Waiting for reply...</span>\n                </div>\n                <div\n                    class=\"flex bg-base-100 focus-within:outline outline-info border-t border-base-300 max-h-[10rem] overflow-y-auto\"\n                >\n                    <textarea\n                        #input\n                        placeholder=\"New message...\"\n                        class=\"p-4 flex-1 w-1/2 focus:outline-none resize-none overflow-hidden\"\n                        [style.height]=\"height + 'px'\"\n                        [(ngModel)]=\"message\"\n                        (ngModelChange)=\"resizeInput()\"\n                        (keyup.enter)=\"sendMessage()\"\n                    ></textarea>\n                    <button\n                        icon\n                        matRipple\n                        [disabled]=\"!message\"\n                        class=\"mt-2\"\n                        (click)=\"sendMessage()\"\n                    >\n                        <app-icon>send</app-icon>\n                    </button>\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            .anim-delay-1 {\n                animation-delay: 0.25s;\n            }\n            .anim-delay-2 {\n                animation-delay: 0.5s;\n            }\n\n            .waiting-margin:last-child {\n                padding-bottom: 2rem;\n            }\n        `,\n    ],\n})\nexport class ChatComponent extends AsyncHandler implements OnInit {\n    public show = false;\n    public show_info = false;\n    public message = '';\n    public user: StaffUser;\n    public show_time: Record<string, boolean> = {};\n    public offset = 0;\n    public height = 56;\n\n    public readonly icons = {\n        list_function_schemas: 'help',\n        call_function: 'settings',\n        task_complete: 'check_circle',\n    };\n    public readonly hint = this._chat.chat_hint;\n    public readonly messages = this._chat.messages;\n    public readonly progress = this._chat.progress;\n    public readonly waiting = this._chat.messages.pipe(\n        map((_) => _.length !== 0 && _[_.length - 1]?.user_id === this.user?.id)\n    );\n\n    public get can_show() {\n        return this._settings.get('app.chat.enabled');\n    }\n\n    @ViewChild('input') private _input_el: ElementRef<HTMLTextAreaElement>;\n    @ViewChild('container') private _container_el: ElementRef<HTMLDivElement>;\n\n    public toggleChat() {\n        this.show = !this.show;\n        if (!this.show) this._chat.close();\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _chat: ChatService\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'current_user',\n            current_user.subscribe((user) => (this.user = user))\n        );\n        this.subscription(\n            'hint',\n            this.hint.subscribe(() => this.scrollToBottom(500))\n        );\n        this.subscription(\n            'messages',\n            this.messages.subscribe(() => this.scrollToBottom())\n        );\n        this.subscription(\n            'progress',\n            this.progress.subscribe((i) =>\n                i ? this.scrollToBottom() : (this.show_info = false)\n            )\n        );\n        this.interval(\n            'offset',\n            () => (this.offset = this.offset ? 0 : 1),\n            20 * 1000\n        );\n    }\n\n    public resizeInput() {\n        const el = this._input_el.nativeElement;\n        this.height = Math.max(el.scrollHeight, 56);\n    }\n\n    public sendMessage() {\n        if (!this.message) return;\n        if (!this._chat.connected) {\n            this._chat.startChat();\n            return this.timeout('send', () => this.sendMessage(), 100);\n        }\n        this._chat.sendMessage(this.message);\n        this.message = '';\n        this.height = 56;\n        setTimeout(() => this._input_el.nativeElement.focus(), 100);\n    }\n\n    public scrollToBottom(delay = 300) {\n        this.timeout(\n            'scroll',\n            () => {\n                if (this._container_el?.nativeElement) {\n                    this._container_el.nativeElement.scrollTop =\n                        this._container_el.nativeElement.scrollHeight;\n                }\n            },\n            delay\n        );\n    }\n}\n","import { Component, Input } from '@angular/core';\n\nexport type StatusValue = 'success' | 'warning' | 'error' | 'info' | 'neutral';\n\n@Component({\n    selector: 'status-pill',\n    template: `\n        <div\n            class=\"flex items-center bg-opacity-30 rounded-2xl px-2 py-1 text-base space-x-2 font-medium text-black\"\n            [class.bg-success-light]=\"status === 'success'\"\n            [class.bg-warning-light]=\"status === 'warning'\"\n            [class.bg-error-light]=\"status === 'error'\"\n            [class.bg-info-light]=\"status === 'info'\"\n            [class.bg-base-200]=\"status === 'neutral'\"\n        >\n            <div\n                class=\"rounded-full h-5 w-5 flex items-center justify-center\"\n                [class.text-success]=\"status === 'success'\"\n                [class.text-warning]=\"status === 'warning'\"\n                [class.text-error]=\"status === 'error'\"\n                [class.text-info]=\"status === 'info'\"\n                [class.text-base-content]=\"status === 'neutral'\"\n                [class.opacity-40]=\"status === 'neutral'\"\n            >\n                <app-icon class=\"text-2xl\" [ngSwitch]=\"status\">\n                    <ng-container *ngSwitchCase=\"'success'\">\n                        check_circle\n                    </ng-container>\n                    <ng-container *ngSwitchCase=\"'error'\">cancel</ng-container>\n                    <ng-container *ngSwitchCase=\"'neutral'\">block</ng-container>\n                    <ng-container *ngSwitchCase=\"'info'\">info</ng-container>\n                    <ng-container *ngSwitchDefault>warning</ng-container>\n                </app-icon>\n            </div>\n            <div\n                [class.opacity-40]=\"status === 'neutral'\"\n                [class.text-base-content]=\"status === 'neutral'\"\n            >\n                <ng-content></ng-content>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class StatusPillComponent {\n    @Input() public status: string;\n}\n","import { Component, Inject } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\n@Component({\n    selector: 'image-viewer',\n    template: `\n        <div class=\"h-screen w-screen bg-base-200\">\n            <img\n                class=\"object-contain object-center w-full h-full\"\n                [src]=\"url\"\n            />\n            <button\n                class=\"absolute top-1 right-1 bg-base-100\"\n                icon\n                matRipple\n                mat-dialog-close\n            >\n                <app-icon>close</app-icon>\n            </button>\n        </div>\n    `,\n    styles: [``],\n})\nexport class ImageViewerComponent {\n    constructor(@Inject(MAT_DIALOG_DATA) public url: string) {}\n}\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { SettingsService } from '@placeos/common';\n\n@Component({\n    selector: 'desk-height-presets',\n    template: `\n        <div class=\"relative p-4 bg-base-100 rounded shadow w-[20rem]\">\n            <div class=\"text-lg mb-2\" i18n>Desk Height Presets</div>\n            <div class=\"text-xs opacity-60 mb-4\" i18n>\n                Desk height presets allow you to store and recall your preferred\n                desk height when checking into a booked desk that supports\n                height adjustment.\n            </div>\n            <div\n                class=\"text-xs mb-4 -mx-2 p-2 rounded bg-warning text-warning-content\"\n                *ngIf=\"not_set && show_close\"\n            >\n                Before you can set a desk height, presets must be set\n            </div>\n            <div class=\"text-xs opacity-60 mb-4\" i18n>\n                Set your desk height for the best experience.\n            </div>\n            <div class=\"flex flex-col mt-2\">\n                <label>Sitting Height</label>\n                <div class=\"flex items-center space-x-2\">\n                    <mat-slider\n                        min=\"60\"\n                        max=\"80\"\n                        step=\"0.5\"\n                        discrete\n                        class=\"flex-1\"\n                        [displayWith]=\"formatLabel\"\n                    >\n                        <input\n                            matSliderThumb\n                            [(ngModel)]=\"desk_sitting_height\"\n                            (ngModelChange)=\"\n                                saveSetting('desk_sitting_height', $event)\n                            \"\n                        />\n                    </mat-slider>\n                    <div class=\"text-sm w-12 text-right\">\n                        {{ desk_sitting_height.toFixed(1) }}cm\n                    </div>\n                </div>\n                <label>Standing Height</label>\n                <div class=\"flex items-center space-x-2  mr-2\">\n                    <mat-slider\n                        min=\"90\"\n                        max=\"120\"\n                        step=\"0.5\"\n                        discrete\n                        class=\"flex-1\"\n                        [displayWith]=\"formatLabel\"\n                    >\n                        <input\n                            matSliderThumb\n                            [(ngModel)]=\"desk_standing_height\"\n                            (ngModelChange)=\"\n                                saveSetting('desk_standing_height', $event)\n                            \"\n                        />\n                    </mat-slider>\n                    <div class=\"text-sm w-12 text-right mr-2\">\n                        {{ desk_standing_height.toFixed(1) }}cm\n                    </div>\n                </div>\n            </div>\n            <button\n                btn\n                matRipple\n                (click)=\"onClose()\"\n                class=\"w-full mt-2\"\n                *ngIf=\"show_close\"\n            >\n                Save Presets\n            </button>\n        </div>\n    `,\n    styles: [``],\n})\nexport class DeskHeightPresetsComponent {\n    @Input() public show_close = false;\n    @Output() public close = new EventEmitter<void>();\n    public not_set = false;\n    public desk_sitting_height = 71;\n    public desk_standing_height = 101;\n\n    constructor(private _settings: SettingsService) {}\n\n    public ngOnInit() {\n        this.not_set =\n            !this._settings.get('desk_sitting_height') &&\n            !this._settings.get('desk_standing_height');\n        this.desk_sitting_height =\n            this._settings.get('desk_sitting_height') || 71;\n        this.desk_standing_height =\n            this._settings.get('desk_standing_height') || 101;\n    }\n\n    public onClose() {\n        this.saveSetting('desk_sitting_height', this.desk_sitting_height);\n        this.saveSetting('desk_standing_height', this.desk_standing_height);\n        this.close.emit();\n    }\n\n    public formatLabel(value: number) {\n        return `${value.toFixed(1)}cm`;\n    }\n\n    public saveSetting(name: string, value: any) {\n        this._settings.saveUserSetting(name, value);\n    }\n}\n","import { Directive, ElementRef, HostListener, Input } from '@angular/core';\n\nconst ALLOWED_NUMBERS = '0123456789'.split('');\nconst ALLOWED_DECIMALS = '0123456789.'.split('');\nconst ALLOWED_LETTERS = 'abcdefghijklmnopqrstuvwxyz'.split('');\nconst ALLOWED_ALPHANUMERIC = 'abcdefghijklmnopqrstuvwxyz0123456789'.split('');\n\n@Directive({\n    selector: '[limitInput]',\n})\nexport class LimitInputDirective {\n    @Input() restriction:\n        | 'number'\n        | 'decimals'\n        | 'letters'\n        | 'alphanumeric'\n        | 'custom' = 'decimals';\n    @Input() custom_list: string[] = [];\n\n    constructor(private _el: ElementRef) {}\n\n    @HostListener('keydown', ['$event']) onKeyDown(event) {\n        const e: KeyboardEvent = event;\n        const key = e.key;\n        if (\n            ['ArrowLeft', 'ArrowRight', 'Tab', 'Backspace', 'Home'].indexOf(\n                key\n            ) !== -1 ||\n            // Allow: Ctrl+A\n            (e.key === 'a' && (e.ctrlKey || e.metaKey)) ||\n            // Allow: Ctrl+C\n            (e.key === 'c' && (e.ctrlKey || e.metaKey)) ||\n            // Allow: Ctrl+V\n            (e.key === 'v' && (e.ctrlKey || e.metaKey)) ||\n            // Allow: Ctrl+X\n            (e.key === 'x' && (e.ctrlKey || e.metaKey))\n        ) {\n            // let it happen, don't do anything\n            return;\n        }\n        switch (this.restriction) {\n            case 'letters':\n                if (ALLOWED_LETTERS.indexOf(key) === -1) {\n                    e.preventDefault();\n                }\n                break;\n            case 'alphanumeric':\n                if (ALLOWED_ALPHANUMERIC.indexOf(key) === -1) {\n                    e.preventDefault();\n                }\n                break;\n            case 'custom':\n                if (this.custom_list.indexOf(key) === -1) {\n                    e.preventDefault();\n                }\n                break;\n            case 'decimals':\n                if (ALLOWED_DECIMALS.indexOf(key) === -1) {\n                    e.preventDefault();\n                }\n                break;\n            case 'number':\n            default:\n                if (ALLOWED_NUMBERS.indexOf(key) === -1) {\n                    e.preventDefault();\n                }\n                break;\n        }\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { PlaceZone, showZone } from '@placeos/ts-client';\n\nconst ZONE_LIST: Record<string, PlaceZone> = {};\nconst EMPTY_ZONE = new PlaceZone();\n\n@Pipe({\n    name: 'zone',\n})\nexport class ZonePipe implements PipeTransform {\n    public async transform(id: string): Promise<PlaceZone> {\n        if (ZONE_LIST[id]) return ZONE_LIST[id];\n        const zone = await showZone(id)\n            .toPromise()\n            .catch((_) => null);\n        if (!zone) return EMPTY_ZONE;\n        ZONE_LIST[id] = zone;\n        return zone;\n    }\n}\n","import { NgModule, Type } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatDatepickerModule } from '@angular/material/datepicker';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { ClipboardModule } from '@angular/cdk/clipboard';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatPaginatorModule } from '@angular/material/paginator';\nimport { CdkTableModule } from '@angular/cdk/table';\nimport { PortalModule } from '@angular/cdk/portal';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatSliderModule } from '@angular/material/slider';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { MatButtonToggleModule } from '@angular/material/button-toggle';\n\nimport {\n    provideHttpClient,\n    withInterceptorsFromDi,\n} from '@angular/common/http';\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { BindingDirective } from './binding.directive';\nimport { ActionIconComponent } from './action-icon.component';\nimport { IconComponent } from './icon.component';\nimport { PopoutMenuComponent } from './popout-menu.component';\nimport { UserAvatarComponent } from './user-avatar.component';\n\nimport { ConfirmModalComponent } from './confirm-modal.component';\nimport {\n    InteractiveMapComponent,\n    MAP_FEATURE_DATA,\n} from './interactive-map.component';\nimport { MapPinComponent } from './map-pin.component';\nimport { MapRadiusComponent } from './map-radius.component';\nimport { StatusOverlayComponent } from './status-overlay.component';\nimport { FixedPipe } from './fixed.pipe';\nimport { SafePipe } from './safe.pipe';\nimport { SanitizePipe } from './sanitise.pipe';\nimport { CustomTableComponent } from './custom-table.component';\nimport { CustomTooltipComponent } from './custom-tooltip.component';\nimport { VirtualKeyboardComponent } from './virtual-keyboard.component';\nimport { GlobalLoadingComponent } from './global-loading.component';\nimport { MatSortModule } from '@angular/material/sort';\nimport { MapPolygonComponent } from './map-polygon.component';\nimport { GlobalBannerComponent } from './global-banner.component';\nimport { MapLocateModalComponent } from './map-locate-modal.component';\nimport { ImageCarouselComponent } from './image-carousel.component';\nimport { DurationPipe } from './duration.pipe';\nimport { RedirectComponent } from './redirect.component';\nimport { DebugConsoleComponent } from './debug-console.component';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { JsonDisplayComponent } from './json-display.component';\nimport { ChangelogModalComponent } from './changelog-modal.component';\nimport { LevelPipe } from './level.pipe';\nimport { BuildingPipe } from './building.pipe';\nimport { UserControlsComponent } from './user-controls.component';\nimport { BuildingSelectComponent } from './building-select.component';\nimport { RegionSelectComponent } from './region-select.component';\nimport { HelpTooltipComponent } from './help-tooltip.component';\nimport { AccessibilityTooltipComponent } from './accessibility-tooltip.component';\nimport { LanguageSelectComponent } from './language-tooltip.component';\nimport { AuthenticatedImageDirective } from './authenticated-image.directive';\nimport { UploadPermissionsModalComponent } from './upload-permissions-modal.component';\nimport { IndoorMapsComponent } from './indoor-maps.component';\nimport { PrintableComponent } from './printable.component';\nimport { ChatComponent } from './chat/chat.component';\nimport { DateFromPipe } from './date-from.pipe';\nimport { AttachedResourceConfigModalComponent } from './attached-resource-config-modal.component';\nimport { StatusPillComponent } from './status-pill.component';\nimport { AvailableRoomsStateModalComponent } from './available-rooms-state-modal.component';\nimport { MediaDurationPipe } from './media-duration.pipe';\nimport { ThumbnailPipe } from './thumbnail.pipe';\nimport { MapRendererComponent } from './map-renderer.component';\nimport { MapsIndoorsComponent } from './maps-indoors.component';\nimport { MapCanvasComponent } from './map-canvas.component';\nimport { ImageViewerComponent } from './image-viewer.component';\nimport { SimpleTableComponent } from './simple-table.component';\nimport { LimitInputDirective } from './limit-input.directive';\nimport { DeskHeightPresetsComponent } from './desk-height-presets.component';\nimport { WorkLocationTooltipComponent } from './work-location-tooltip.component';\nimport { ZonePipe } from './zone.pipe';\n\nconst MAT_MODULES: any[] = [\n    MatAutocompleteModule,\n    MatMenuModule,\n    MatFormFieldModule,\n    MatSelectModule,\n    MatRippleModule,\n    MatAutocompleteModule,\n    MatSelectModule,\n    MatDialogModule,\n    MatDatepickerModule,\n    MatInputModule,\n    ClipboardModule,\n    MatProgressSpinnerModule,\n    MatChipsModule,\n    MatPaginatorModule,\n    CdkTableModule,\n    PortalModule,\n    MatSortModule,\n    ScrollingModule,\n    MatTooltipModule,\n    MatCheckboxModule,\n    MatRadioModule,\n    MatSliderModule,\n    MatSlideToggleModule,\n    MatButtonToggleModule,\n];\n\nconst COMPONENTS: Type<any>[] = [\n    ActionIconComponent,\n    IconComponent,\n    PopoutMenuComponent,\n    UserAvatarComponent,\n\n    ConfirmModalComponent,\n    InteractiveMapComponent,\n    MapRendererComponent,\n    MapsIndoorsComponent,\n    MapPinComponent,\n    MapRadiusComponent,\n    MapPolygonComponent,\n    MapCanvasComponent,\n    IndoorMapsComponent,\n    StatusOverlayComponent,\n    CustomTableComponent,\n    CustomTooltipComponent,\n    VirtualKeyboardComponent,\n    GlobalLoadingComponent,\n    GlobalBannerComponent,\n    MapLocateModalComponent,\n    ImageCarouselComponent,\n    RedirectComponent,\n    DebugConsoleComponent,\n    JsonDisplayComponent,\n    ChangelogModalComponent,\n    StatusPillComponent,\n    ImageViewerComponent,\n    SimpleTableComponent,\n    WorkLocationTooltipComponent,\n\n    FixedPipe,\n    SafePipe,\n    SanitizePipe,\n    DurationPipe,\n    LevelPipe,\n    BuildingPipe,\n    DateFromPipe,\n    MediaDurationPipe,\n    ThumbnailPipe,\n    ZonePipe,\n\n    UserControlsComponent,\n    BuildingSelectComponent,\n    RegionSelectComponent,\n    HelpTooltipComponent,\n    AccessibilityTooltipComponent,\n    LanguageSelectComponent,\n    UploadPermissionsModalComponent,\n    PrintableComponent,\n    ChatComponent,\n    AttachedResourceConfigModalComponent,\n    AvailableRoomsStateModalComponent,\n    DeskHeightPresetsComponent,\n];\n\nconst DIRECTIVES: Type<any>[] = [\n    BindingDirective,\n    AuthenticatedImageDirective,\n    LimitInputDirective,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS, ...DIRECTIVES],\n    exports: [...COMPONENTS, ...DIRECTIVES, ...MAT_MODULES, TranslateModule],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        TranslateModule.forChild(),\n        ...MAT_MODULES,\n    ],\n    providers: [\n        { provide: MAP_FEATURE_DATA, useValue: {} },\n        provideHttpClient(withInterceptorsFromDi()),\n    ],\n})\nexport class ComponentsModule {}\n","import {\n    Component,\n    forwardRef,\n    Injector,\n    Input,\n    OnInit,\n    ViewChild,\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR,\n    NgControl,\n} from '@angular/forms';\nimport { CustomTooltipComponent } from 'libs/components/src/lib/custom-tooltip.component';\nimport { addYears, endOfDay, set, startOfDay } from 'date-fns';\nimport { AsyncHandler } from 'libs/common/src/lib/async-handler.class';\n\n@Component({\n    selector: 'a-date-field',\n    template: `\n        <button\n            class=\"flex items-center justify-between border border-neutral rounded h-12 w-full\"\n            customTooltip\n            [content]=\"calendar_picker\"\n            yPosition=\"top\"\n            [disabled]=\"disabled\"\n            [class.opacity-30]=\"disabled\"\n            matRipple\n        >\n            <p class=\"px-4 py-2 flex-1 truncate w-1/2 text-left font-normal\">\n                @if (date) {\n                    {{ date | date: (short ? 'MMM d, yyyy' : 'MMMM d, yyyy') }}\n                } @else {\n                    <span class=\"opacity-30\">No Date Selected</span>\n                }\n            </p>\n            <div class=\"h-10 w-10 flex items-center justify-center text-2xl\">\n                <app-icon>today</app-icon>\n            </div>\n        </button>\n        <div class=\"error h-5 p-1 text-xs text-error\">\n            <span *ngIf=\"has_error\"><ng-content></ng-content></span>\n        </div>\n        <ng-template #calendar_picker>\n            <div class=\"relative w-[18rem] rounded bg-base-100 px-2 py-4\">\n                <date-calendar\n                    [ngModel]=\"date || now\"\n                    [from]=\"from\"\n                    [to]=\"until\"\n                    [offset_weekday]=\"week_start\"\n                    (ngModelChange)=\"setValue($event)\"\n                ></date-calendar>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class DateFieldComponent\n    extends AsyncHandler\n    implements OnInit, ControlValueAccessor\n{\n    /** Earliest date available the user is allowed to pick */\n    @Input('from') public from_date: number = startOfDay(Date.now()).valueOf();\n    /** Latest date available the user is allowed to pick */\n    @Input('to') public to_date: number;\n    /** Index of the day to start the week on when displaying the calendar */\n    @Input() public week_start: number = 0;\n    /** Whether form control is disabled */\n    @Input() public disabled: boolean;\n    @Input() public short = false;\n    /** Currently selected date */\n    public date: number;\n\n    public readonly now = Date.now();\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n    private _control?: NgControl;\n\n    public get has_error(): boolean {\n        return this._control?.invalid && this._control?.touched;\n    }\n\n    @ViewChild(CustomTooltipComponent) private _tooltip: CustomTooltipComponent;\n\n    constructor(private _injector: Injector) {\n        super();\n    }\n\n    /** First allowed date on the calendar */\n    public get from(): Date {\n        return new Date(this.from_date) || startOfDay(new Date());\n    }\n    /** Current date value */\n    public get until(): Date {\n        return new Date(this.to_date) || addYears(endOfDay(new Date()), 1);\n    }\n\n    public ngOnInit() {\n        this._control = this._injector.get(NgControl);\n        this.date = Date.now();\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number) {\n        // Keep hours and minutes of the old date\n        const old_date = new Date(this.date);\n        let new_date = set(new_value, {\n            hours: old_date.getHours(),\n            minutes: old_date.getMinutes(),\n        }).valueOf();\n        // Check that new date is before from\n        if (new_date < this.from.valueOf()) {\n            new_date = this.from.valueOf();\n        }\n        this.date = new_date;\n        if (this._onChange) {\n            this._onChange(new_date);\n        }\n        this._tooltip?.close();\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.date = value;\n        this._tooltip?.close();\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { addMinutes, formatDuration } from 'date-fns';\n\nexport interface DurationOption {\n    id: number;\n    name: string;\n    date?: number;\n}\n\n@Component({\n    selector: 'a-duration-field',\n    template: `\n        <div class=\"duration-field\" [attr.disabled]=\"disabled\">\n            <mat-form-field appearance=\"outline\">\n                <mat-select\n                    #select\n                    [value]=\"duration\"\n                    [disabled]=\"disabled\"\n                    [placeholder]=\"duration + ' minutes'\"\n                    (valueChange)=\"setValue($event)\"\n                >\n                    <mat-option\n                        *ngFor=\"let option of duration_options\"\n                        [value]=\"option.id\"\n                    >\n                        <ng-container *ngIf=\"!force\">\n                            {{\n                                option.date\n                                    ? (option.date\n                                          | date\n                                              : (option.id >= 24 * 60\n                                                    ? 'mediumDate'\n                                                    : use_24hr\n                                                    ? 'HH : mm'\n                                                    : 'h : mm a')) + ' ('\n                                    : ''\n                            }}{{ option.name }}{{ option.date ? ')' : '' }}\n                        </ng-container>\n                        {{ force }}\n                    </mat-option>\n                </mat-select>\n                <mat-error><ng-content></ng-content></mat-error>\n            </mat-form-field>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                width: 100%;\n            }\n\n            mat-form-field {\n                width: 100%;\n            }\n        `,\n    ],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DurationFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class DurationFieldComponent\n    implements OnInit, OnChanges, ControlValueAccessor\n{\n    /** Maximum duration option available */\n    @Input() public max = 240;\n    /** Minimum duration option available */\n    @Input() public min = 30;\n    /** Step value between options */\n    @Input() public step = 15;\n    /** Reference time for displaying next to durations */\n    @Input() public time: number;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Special case prepopulation i.e. out of step options */\n    @Input() public custom_options: number[] = [];\n\n    @Input() public force: string;\n\n    @Input() public use_24hr = false;\n\n    public duration = 60;\n    /** List of available duration options */\n    public duration_options: DurationOption[] = [];\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    public ngOnInit(): void {\n        this.duration_options = this.generateDurationOptions(\n            this.max,\n            this.min,\n            this.step\n        );\n        this._updateOption();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (\n            changes.max ||\n            changes.min ||\n            changes.step ||\n            changes.time ||\n            changes.custom_options\n        ) {\n            this.duration_options = this.generateDurationOptions(\n                this.max,\n                this.min,\n                this.step\n            );\n            this._updateOption();\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.duration = new_value;\n        /* istanbul ignore else */\n        if (this._onChange) {\n            this._onChange(+new_value);\n        }\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.duration = value;\n        this._updateOption();\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    private generateDurationOptions(max: number, min: number, step: number) {\n        const blocks: DurationOption[] = [];\n        let time = min;\n        const date = this.time ? this.time : null;\n\n        // Add special cases\n        for (const option of this.custom_options) {\n            blocks.push({\n                id: option,\n                date: date ? addMinutes(date, option).valueOf() : undefined,\n                name:\n                    option >= 24 * 60\n                        ? `${formatDuration({\n                              days: Math.floor(option / (24 * 60)),\n                          })}`\n                        : `${formatDuration({\n                              hours: Math.floor(option / 60),\n                              minutes: option % 60,\n                          })}`,\n            });\n        }\n\n        while (time <= max) {\n            blocks.push({\n                id: time,\n                date: date ? addMinutes(date, time).valueOf() : undefined,\n                name:\n                    time === 0\n                        ? formatDuration({ minutes: 0 }, { zero: true })\n                        : time >= 24 * 60\n                        ? `${formatDuration({\n                              days: Math.floor(time / (24 * 60)),\n                          })}`\n                        : `${formatDuration({\n                              hours: Math.floor(time / 60),\n                              minutes: time % 60,\n                          })}`,\n            });\n            time += step;\n        }\n        blocks.sort((a, b) => a.id - b.id);\n        return blocks;\n    }\n\n    private _updateOption() {\n        if (!this.duration_options?.length) return;\n        const idx = this.duration_options.findIndex(\n            (_) => _.id === this.duration\n        );\n        if (idx < 0) this.setValue(this.min);\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { MatSelect } from '@angular/material/select';\nimport { AsyncHandler, Identity } from '@placeos/common';\nimport {\n    addMinutes,\n    endOfDay,\n    format,\n    isAfter,\n    isSameDay,\n    roundToNearestMinutes,\n    set,\n    startOfDay,\n    startOfMinute,\n} from 'date-fns';\n\n@Component({\n    selector: 'a-time-field',\n    template: `\n        <mat-form-field appearance=\"outline\">\n            <mat-select\n                #select\n                [ngModel]=\"force_time || time\"\n                [disabled]=\"disabled\"\n                (ngModelChange)=\"setValue($event)\"\n            >\n                <mat-option *ngIf=\"force_time\" [value]=\"force_time\">\n                    {{ force_time | date: (use_24hr ? 'HH : mm' : 'h : mm a') }}\n                </mat-option>\n                <mat-option\n                    *ngFor=\"let option of time_options\"\n                    [value]=\"option.id\"\n                >\n                    {{\n                        option.date | date: (use_24hr ? 'HH : mm' : 'h : mm a')\n                    }}\n                    {{ extra_info_fn(option.date) }}\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n    `,\n    styles: [\n        `\n            mat-form-field {\n                width: 100%;\n            }\n        `,\n    ],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => TimeFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class TimeFieldComponent\n    extends AsyncHandler\n    implements OnInit, OnChanges, ControlValueAccessor\n{\n    /** Time step between each allowed time option */\n    @Input() public step = 15;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Whether past times are allowed */\n    @Input() public no_past_times = true;\n    @Input() public use_24hr = false;\n    @Input() public force_time: number;\n    @Input() public extra_info_fn = (t?: number) => '';\n    /** Prevent times before */\n    @Input() public from: number = startOfDay(Date.now()).valueOf();\n    /** String representing the currently set time */\n    public date: number = new Date().valueOf();\n    /** String representing the currently set time */\n    public time: string = format(new Date(), 'HH:mm');\n    /** Available time blocks for the selected date */\n    public _time_options: any[];\n    /** Whether select field should be shown */\n    public show_select: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    public ngOnInit(): void {\n        this.show_select = true;\n        this._time_options = this.generateAvailableTimes(\n            this.date,\n            !this.no_past_times,\n            this.step,\n        );\n        this.timeout('hide', () => (this.show_select = false));\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.no_past_times || changes.step || changes.from) {\n            this._time_options = this.generateAvailableTimes(\n                this.date,\n                !this.no_past_times,\n                this.step,\n            );\n        }\n    }\n\n    /** Available time blocks for the selected date */\n    public get time_options() {\n        const time = (this.time || '00:00').split(':');\n        const date = set(this.date, { hours: +time[0], minutes: +time[1] });\n        if (\n            date.getMinutes() % 15 !== 0 &&\n            !this._time_options.find(\n                (time) => time.id === format(date, 'HH:mm'),\n            )\n        ) {\n            this._time_options.push({\n                date,\n                id: format(date, 'HH:mm'),\n            });\n            this._time_options.sort((a, b) =>\n                `${a.id}`.localeCompare(`${b.id}`),\n            );\n        }\n        return this._time_options;\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        this.time = new_value;\n        if (this._onChange) {\n            const time = (this.time || '00:00').split(':');\n            const date = startOfMinute(\n                set(this.date, { hours: +time[0], minutes: +time[1] }),\n            );\n            this._onChange(date.valueOf());\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.date = value || this.date;\n        let date = startOfMinute(this.date);\n        date = roundToNearestMinutes(date, { nearestTo: 5 });\n        this.time = format(date, 'HH:mm');\n        this._time_options = this.generateAvailableTimes(\n            this.date,\n            !this.no_past_times,\n            this.step,\n        );\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n        this._time_options = this.generateAvailableTimes(\n            this.date,\n            !this.no_past_times || disabled,\n            this.step,\n        );\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    /**\n     * Show select field for time options\n     */\n    public showSelect() {\n        this.show_select = true;\n        this.timeout('on_shown', () => {\n            if (this.select_field) {\n                this.select_field.focus();\n                this.select_field.open();\n                this.subscription(\n                    'listen_close',\n                    this.select_field.openedChange.subscribe((state) => {\n                        if (!state) {\n                            this.show_select = false;\n                        }\n                    }),\n                );\n            }\n        });\n    }\n\n    /**\n     * Generate a list of time options for the given date\n     * @param datestamp Date to generate options for\n     * @param show_past Whether past times should be options\n     */\n    private generateAvailableTimes(\n        datestamp: number,\n        show_past: boolean,\n        step: number = 15,\n    ): Identity[] {\n        const now = new Date(Math.max(this.from, Date.now()));\n        let date = new Date(datestamp);\n        const blocks = [];\n        if (show_past || (!isSameDay(date, now) && isAfter(date, now))) {\n            date = startOfDay(date);\n        } else if (isAfter(date, now)) {\n            date = new Date(now);\n        }\n        date = roundToNearestMinutes(date, { nearestTo: step as any });\n        const end = endOfDay(date);\n        // Add options for the rest of the day\n        while (isAfter(end, date)) {\n            blocks.push({\n                date: date.valueOf(),\n                id: format(date, 'HH:mm'),\n            });\n            date = addMinutes(date, step);\n        }\n        return blocks;\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\n@Component({\n    selector: 'user-form',\n    template: `\n        <form user-form *ngIf=\"form\" [formGroup]=\"form\" class=\"w-full\">\n            <div class=\"flex flex-col w-full\" *ngIf=\"form.controls.name\">\n                <label for=\"name\" [class.error]=\"hasError('name')\">\n                    Name<span>*</span>:\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"name\"\n                        placeholder=\"Name\"\n                        formControlName=\"name\"\n                    />\n                    <mat-error>Name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col w-full\" *ngIf=\"form.controls.email\">\n                <label for=\"email\" [class.error]=\"hasError('email')\">\n                    Email<span>*</span>:\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"email\"\n                        placeholder=\"Email Address\"\n                        formControlName=\"email\"\n                    />\n                    <mat-error>A valid email is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div\n                class=\"flex flex-col w-full\"\n                *ngIf=\"form.controls.organisation\"\n            >\n                <label for=\"org\" [class.error]=\"hasError('organisation')\">\n                    {{ 'COMMON.ORGANISATION' | translate }}<span>*</span>:\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"org\"\n                        placeholder=\"e.g. Conteso\"\n                        formControlName=\"organisation\"\n                    />\n                    <mat-error>\n                        {{ 'COMMON.ORGANISATION' | translate }} is required\n                    </mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col w-full\" *ngIf=\"form.controls.phone\">\n                <label for=\"phone\" [class.error]=\"hasError('phone')\">\n                    Phone:\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"phone\"\n                        type=\"tel\"\n                        placeholder=\"Phone\"\n                        formControlName=\"phone\"\n                    />\n                    <mat-error>Phone format is invalid</mat-error>\n                </mat-form-field>\n            </div>\n            <div\n                class=\"flex flex-col w-full\"\n                *ngIf=\"form.controls.assistance_required\"\n            >\n                <mat-checkbox\n                    name=\"assistance-required\"\n                    color=\"primary\"\n                    formControlName=\"assistance_required\"\n                >\n                    Assistance required\n                </mat-checkbox>\n            </div>\n            <div\n                class=\"flex flex-col w-full\"\n                *ngIf=\"form.controls.visit_expected\"\n            >\n                <mat-checkbox\n                    name=\"visit-expected\"\n                    color=\"primary\"\n                    formControlName=\"visit_expected\"\n                >\n                    Visit expected\n                </mat-checkbox>\n            </div>\n        </form>\n    `,\n    styles: [\n        `\n            :host,\n            mat-form-field {\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class UserFormComponent {\n    /** Group of form fields used for creating the system */\n    @Input() public form?: FormGroup;\n\n    public hasError(name: string) {\n        const { invalid, touched } = this.form?.controls[name] || {};\n        return invalid && touched;\n    }\n}\n","import { Component, OnInit, Output, EventEmitter, Inject } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { AsyncHandler, DialogEvent } from '@placeos/common';\n\nimport { User } from './user.class';\nimport { generateUserForm } from './user.utilities';\n\n@Component({\n    selector: 'new-user-modal',\n    template: `\n        <header>\n            <div class=\"heading\" mat-dialog-title>\n                {{ user?.id ? 'Edit' : 'Add' }} External Attendee\n            </div>\n            <div class=\"flex-1\"></div>\n            <button icon mat-dialog-close>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            class=\"flex flex-col items-center w-full p-2\"\n            *ngIf=\"!loading; else load_state\"\n        >\n            <user-form [form]=\"form\"></user-form>\n        </main>\n        <footer\n            class=\"flex items-center justify-center w-full p-2 border-t border-base-200 space-x-2\"\n            *ngIf=\"!loading\"\n        >\n            <button btn matRipple class=\"inverse\" mat-dialog-close>\n                Cancel\n            </button>\n            <button btn matRipple (click)=\"saveChanges()\">Save</button>\n        </footer>\n        <ng-template #load_state>\n            <main class=\"flex flex-col items-center w-full p-2 space-y-2\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>Saving attendee...</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [\n        `\n            main {\n                min-height: 20em !important;\n                width: 100%;\n            }\n\n            footer button {\n                min-width: 8em;\n            }\n        `,\n    ],\n})\nexport class NewUserModalComponent extends AsyncHandler implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form fields for the new user */\n    public form = generateUserForm(this.user || new User());\n    /** New user data store */\n    public user?: User;\n    /** Whether user details are being saved */\n    public loading = false;\n\n    constructor(@Inject(MAT_DIALOG_DATA) private _data: any) {\n        super();\n        this.user = this._data.user || {};\n        this.form = generateUserForm(this.user);\n    }\n\n    public ngOnInit(): void {}\n\n    public saveChanges() {\n        if (!this.form) return;\n        this.form.markAllAsTouched();\n        if (this.form.valid) {\n            const new_user = new User({\n                ...this.form.value,\n                is_external: true,\n            });\n            this.event.emit({ reason: 'done', metadata: new_user });\n        }\n    }\n}\n","import { CateringOption } from './catering.interfaces';\n\nexport class CateringItem {\n    /** ID of the catering item */\n    public readonly id: string;\n    /** Display name for the catering item */\n    public readonly name: string;\n    /** Category that this item is associated */\n    public readonly category: string;\n    /** Description of the contents of the catering item */\n    public readonly description: string;\n    /** Unit price in cents for the catering item */\n    public readonly unit_price: number;\n    /** Number of item in the associated order */\n    public readonly quantity: number;\n    /** List of options for the catering item */\n    public readonly options: CateringOption[];\n    /** List of attributes assoicated with the catering item */\n    public readonly tags: string[];\n    /** Whether catering items can be purchased using points */\n    public readonly accept_points: boolean;\n    /** Max percentage of the cost that can be covered using points */\n    public readonly discount_cap: number;\n    /** Total cost for the item */\n    public readonly total_cost: number;\n    /** String list of available options */\n    public readonly options_string: string;\n    /** List of images for the catering item */\n    public readonly images: string[];\n    /** List of active options for the item */\n    public readonly option_list: CateringOption[];\n    /** Price per unit with selected options */\n    public readonly unit_price_with_options: number;\n    /** Zones in which this item is not allow to be ordered in */\n    public readonly hide_for_zones: string[];\n    /** Whether item in part of an order */\n    public readonly in_order: boolean;\n\n    public get custom_id() {\n        const options = this.option_list.map((_) => _.id).join('+');\n        return `${this.id}[${options}]${!this.in_order ? 'menu' : ''}`;\n    }\n\n    constructor(data: Partial<CateringItem> = {}) {\n        this.id = data.id || '';\n        this.name = data.name || data.id || '';\n        this.category = data.category || '';\n        this.unit_price = data.unit_price || 0;\n        this.description = data.description || '';\n        this.quantity = data.quantity || 0;\n        this.discount_cap = data.discount_cap || 0;\n        this.accept_points = !!data.accept_points;\n        this.tags = data.tags || [];\n        this.images = data.images || [];\n        this.options = data.options || [];\n        const has_options = this.options.some((_) => _.active === true);\n        this.option_list =\n            (has_options\n                ? this.options.filter((_) => _.active === true)\n                : data.option_list) || [];\n        this.hide_for_zones = data.hide_for_zones || [];\n        this.unit_price_with_options =\n            this.unit_price +\n            this.option_list\n                .map((i) => i.unit_price || 0)\n                .reduce((c, a) => c + a, 0);\n        this.total_cost = this.unit_price_with_options * this.quantity;\n        this.options_string =\n            this.options\n                ?.map((_) => _.id || '')\n                .sort((a, b) => a.localeCompare(b))\n                .join(',') || '';\n        this.in_order = data.in_order ?? false;\n    }\n}\n","import { randomInt } from '@placeos/common';\nimport { CalendarEvent } from '@placeos/events';\n\nimport { CateringItem } from './catering-item.class';\nimport { CateringOrderStatus } from './catering.interfaces';\nimport { addDays, addMinutes, set, startOfDay, startOfMinute } from 'date-fns';\n\nfunction deliverAtTime(order: CateringOrder) {\n    let date = order.event?.date || (order as any)._time;\n    if (order.deliver_time) {\n        date = set(date, {\n            hours: Math.floor(order.deliver_time),\n            minutes: (order.deliver_time % 1) * 60,\n        }).valueOf();\n    }\n    if (order.deliver_day_offset > 0 || order.event?.all_day) {\n        date = addDays(startOfDay(date), order.deliver_day_offset).valueOf();\n    }\n    return addMinutes(date, order.deliver_offset).valueOf();\n}\n\nexport class CateringOrder {\n    /** ID of the order */\n    public readonly id: string;\n    /** ID of the space the order is associated */\n    public readonly system_id: string;\n    /** ID of the event the order is associated */\n    public readonly event_id: string;\n    /** List of items associated with the order */\n    public readonly items: readonly CateringItem[];\n    /** Number of items in the order */\n    public readonly item_count: number;\n    /** Total cost of order */\n    public readonly total_cost: number;\n    /** Invoice number associated with the order */\n    public readonly invoice_number: string;\n    /** Charge code for the order */\n    public readonly charge_code: string;\n    /** Minutes from set time to deliver item */\n    public readonly deliver_day_offset: number;\n    /** Minutes from set time to deliver item */\n    public readonly deliver_offset: number;\n    /** Hour to from set time to deliver item */\n    public readonly deliver_time?: number;\n    /** Notes associated with the order */\n    public readonly notes: string;\n    /** Event associated with the order */\n    public readonly event: CalendarEvent | null;\n    public readonly deliver_at_time: number;\n    /** Current status of the order */\n    private _status: CateringOrderStatus;\n    private _time = startOfMinute(Date.now()).valueOf();\n\n    public get deliver_at() {\n        return deliverAtTime(this);\n    }\n\n    public get status() {\n        return this._status;\n    }\n\n    public set status(value: CateringOrderStatus) {\n        this._status = value;\n        this[`${this.event_id}_status`] = value;\n    }\n\n    constructor(data: Partial<CateringOrder> = {}) {\n        this.id = data.id || `order-${randomInt(9_999_999, 1_000_000)}`;\n        this.system_id = data.system_id || '';\n        this.event_id = data.event_id || data.event?.id || '';\n        this.items = (data.items || []).map((i) =>\n            i instanceof CateringItem ? i : new CateringItem(i)\n        );\n        this.item_count = this.items.reduce(\n            (amount, item) => amount + item.quantity,\n            0\n        );\n        this.total_cost = this.items.reduce(\n            (amount, item) => amount + (item.total_cost || 0),\n            0\n        );\n        this.charge_code = data.charge_code || '';\n        this.status =\n            data[`${this.event_id}_status`] || data.status || 'accepted';\n        this.invoice_number = data.invoice_number || '';\n        this.event = data.event || null;\n        this.notes = data.notes || '';\n        this.deliver_time = data.deliver_time || undefined;\n        this.deliver_offset = data.deliver_offset || 0;\n        this.deliver_day_offset = data.deliver_day_offset || 0;\n        this.deliver_at_time = deliverAtTime(this);\n    }\n}\n","import { HashMap } from '@placeos/common';\nimport {\n    addDays,\n    addMinutes,\n    addMonths,\n    addSeconds,\n    addWeeks,\n    addYears,\n    differenceInMinutes,\n    endOfDay,\n    format,\n    getUnixTime,\n    isAfter,\n    isBefore,\n    isSameMinute,\n    startOfDay,\n    startOfMinute,\n} from 'date-fns';\nimport { RecurrenceDetails, TimeBlock, TimePeriod } from './event.interfaces';\n\nconst DAYS_OF_WEEK = [\n    'sunday',\n    'monday',\n    'tuesday',\n    'wednesday',\n    'thursday',\n    'friday',\n    'saturday',\n];\n\nexport function eventStatus(\n    details: HashMap\n): 'approved' | 'tentative' | 'declined' {\n    if (details.status === 'cancelled') return 'declined';\n    if (details.resources?.length) {\n        if (\n            details.resources.every(\n                (i) => i.response_status === 'accepted' || details.approved\n            )\n        ) {\n            return 'approved';\n        } else if (\n            details.resources.some(\n                (i) =>\n                    i.response_status === 'tentative' ||\n                    i.response_status === 'needsAction'\n            )\n        ) {\n            return 'tentative';\n        }\n        return 'declined';\n    }\n    return 'approved';\n}\n\nexport function parseRecurrence(data: RecurrenceDetails) {\n    let start = data.start || (data as any).range_start * 1000;\n    let end = data.end || (data as any).range_end;\n    if (data.occurrences > 1) {\n        switch (data.pattern) {\n            case 'daily':\n                end = addDays(\n                    start || Date.now(),\n                    (data.occurrences - 1) * data.interval\n                ).valueOf();\n                break;\n            case 'weekly':\n                end = addWeeks(\n                    start || Date.now(),\n                    (data.occurrences - 1) * data.interval\n                ).valueOf();\n                break;\n            case 'month_day':\n            case 'monthly':\n                end = addMonths(\n                    start || Date.now(),\n                    (data.occurrences - 1) * data.interval\n                ).valueOf();\n                end = addDays(end, 7).valueOf();\n                break;\n            case 'yearly':\n                end = addYears(\n                    start || Date.now(),\n                    (data.occurrences - 1) * data.interval\n                ).valueOf();\n                break;\n        }\n    }\n    return {\n        range_start: getUnixTime(startOfDay(start)),\n        range_end: getUnixTime(endOfDay(end)),\n        interval: data.interval,\n        pattern: data.pattern,\n        days_of_week:\n            data.days_of_week?.map((_) =>\n                typeof _ === 'number' ? DAYS_OF_WEEK[_] : _\n            ) || [],\n    };\n}\n\nexport function formatRecurrence({\n    interval,\n    pattern,\n    start,\n    end,\n    occurrences,\n}: RecurrenceDetails) {\n    let details = '';\n\n    if (interval) {\n        switch (pattern) {\n            case 'daily':\n                details = details.concat(\n                    interval > 1 ? `Every ${interval} days` : 'Daily'\n                );\n                if (occurrences > 1)\n                    end = addDays(\n                        start || Date.now(),\n                        (occurrences - 1) * interval\n                    ).valueOf();\n                break;\n            case 'weekly':\n                details = details.concat(\n                    interval > 1 ? `Every ${interval} weeks` : 'Weekly'\n                );\n                if (occurrences > 1)\n                    end = addWeeks(\n                        start || Date.now(),\n                        (occurrences - 1) * interval\n                    ).valueOf();\n                break;\n            case 'month_day':\n            case 'monthly':\n                details = details.concat(\n                    interval > 1 ? `Every ${interval} months` : 'Monthly'\n                );\n                if (occurrences > 1)\n                    end = addMonths(\n                        start || Date.now(),\n                        (occurrences - 1) * interval\n                    ).valueOf();\n                break;\n            case 'yearly':\n                details = details.concat(\n                    interval > 1 ? `Every ${interval} yeats` : 'Yearly'\n                );\n                if (occurrences > 1)\n                    end = addYears(\n                        start || Date.now(),\n                        (occurrences - 1) * interval\n                    ).valueOf();\n                break;\n        }\n        if (occurrences >= 1) {\n            details = details.concat(`, until ${format(end, 'MMM do, yyyy')}`);\n        }\n    }\n    return details;\n}\n\n/**\n * Generate a list of free time slots between the given bookings\n * @param list List of bookings to find slots between\n * @param min_size Minimum length of a free slot in minutes\n */\nexport function getFreeTimeSlots(\n    list: TimePeriod[],\n    min_size: number = 29\n): TimeBlock[] {\n    let start = new Date(0);\n    const slots: TimeBlock[] = [];\n    list.sort((a, b) => a.date - b.date);\n    for (const booking of list) {\n        const bkn_start = new Date(\n            addMinutes(booking.date, -booking.extension_data?.setup_time || 0)\n        );\n        const bkn_end = addMinutes(\n            booking.date,\n            booking.duration + (booking.extension_data?.breakdown_time || 0)\n        );\n        if (isAfter(booking.date, start)) {\n            const diff = Math.abs(differenceInMinutes(bkn_start, start));\n            if (diff >= min_size) {\n                slots.push({\n                    start: start.valueOf(),\n                    end: booking.date,\n                });\n            }\n            start = bkn_end;\n        } else if (isSameMinute(start, booking.date)) {\n            start = bkn_end;\n        }\n    }\n    const s = start.valueOf();\n    slots.push({\n        start: s,\n        end: (s ? s : Date.now()) * 10,\n    });\n    return slots;\n}\n\nexport function periodInFreeTimeSlot(\n    start: number,\n    end: number,\n    list: TimePeriod[],\n    min_size: number = 29\n) {\n    const blocks = getFreeTimeSlots(list, min_size);\n    for (const blk of blocks) {\n        if (\n            start >= blk.start &&\n            start < blk.end &&\n            end > blk.start &&\n            end <= blk.end\n        ) {\n            return true;\n        }\n    }\n    return false;\n}\n\n/**\n * Get the next free time slot from the given bookings\n * @param list List of bookings to find the next slot\n * @param date Date to find next slot after in ms since UTC epoch\n * @param min_size Minimum length of the free slot in minutes\n */\nexport function getNextFreeTimeSlot(\n    list: TimePeriod[],\n    date: number = new Date().valueOf(),\n    min_size: number = 29\n): TimeBlock {\n    const slots = getFreeTimeSlots(list, min_size);\n    const time = addSeconds(startOfMinute(date), 1);\n    for (const block of slots) {\n        if (isAfter(block.start, time)) {\n            return block;\n        } else if (isBefore(time, block.end)) {\n            const duration = differenceInMinutes(block.end, time);\n            if (duration >= min_size) return block;\n        }\n    }\n    return slots[slots.length - 1];\n}\n","import { randomInt } from '@placeos/common';\n\nimport { addDays, addMinutes, set, startOfDay, startOfMinute } from 'date-fns';\nimport { Booking } from 'libs/bookings/src/lib/booking.class';\n\nexport type AssetStatus =\n    | 'in_storage'\n    | 'in_transit'\n    | 'delivered'\n    | 'returned'\n    | 'cancelled';\n\nexport interface AssetItem {\n    id: string; // ID of the group\n    name: string; // Name of the group\n    quantity: number; // Number of items from the group\n    item_ids: string[]; // List of physical item IDs\n}\n\nfunction deliverAtTime(request: AssetRequest) {\n    let date = request.event?.date || (request as any)._time;\n    if (request.deliver_time) {\n        date = set(date, {\n            hours: Math.floor(request.deliver_time),\n            minutes: (request.deliver_time % 1) * 60,\n        }).valueOf();\n    }\n    if (request.deliver_day_offset > 0 || request.event?.all_day) {\n        date = addDays(startOfDay(date), request.deliver_day_offset).valueOf();\n    }\n    return addMinutes(date, request.deliver_offset).valueOf();\n}\n\nexport class AssetRequest {\n    /** ID of the order */\n    public readonly id: string;\n    /** ID of the space the order is associated */\n    public readonly system_id: string;\n    /** ID of the event the order is associated */\n    public readonly event_id: string;\n    /** List of items associated with the order */\n    public readonly items: readonly AssetItem[];\n    /** Number of items in the order */\n    public readonly item_count: number;\n    /** Total cost of order */\n    public readonly total_cost: number;\n    /** Invoice number associated with the order */\n    public readonly invoice_number: string;\n    /** Charge code for the order */\n    public readonly charge_code: string;\n    /** Minutes from set time to deliver item */\n    public readonly deliver_day_offset: number;\n    /** Minutes from set time to deliver item */\n    public readonly deliver_offset: number;\n    /** Hour to from set time to deliver item */\n    public readonly deliver_time?: number;\n    /** Notes associated with the order */\n    public readonly notes: string;\n    /** Event associated with the order */\n    public readonly event: Booking | null;\n    public readonly deliver_at_time: number;\n    public readonly ref_id: string;\n    public readonly state: string;\n    public conflict = false;\n    public _changed = false;\n    public _booking: Booking | null;\n    /** Current status of the order */\n    private _status: AssetStatus;\n    private _time = startOfMinute(Date.now()).valueOf();\n\n    public get deliver_at() {\n        return deliverAtTime(this);\n    }\n\n    public get status() {\n        return this._status;\n    }\n\n    public set status(value: AssetStatus) {\n        this._status = value;\n        this[`${this.event_id}_status`] = value;\n    }\n\n    constructor(data: any = {} as any) {\n        this.id = data.id || `order-${randomInt(9_999_999, 1_000_000)}`;\n        this.event_id = data.event_id || data.parent_id || '';\n        this.items =\n            data.items ||\n            data.asset_ids?.map((_) => ({ id: _, quantity: 1 })) ||\n            [];\n        this.item_count = this.items.reduce(\n            (amount, item) => amount + item.quantity,\n            0\n        );\n        this._status =\n            data[`${this.event_id}_status`] ||\n            data.status ||\n            (data.extension_data || {})[`${this.event_id}_status`] ||\n            data.extension_data?.status ||\n            'in_storage';\n        this.event = data.event || data || null;\n        const booking = this.event?.linked_bookings?.find(\n            (_) => _.extension_data.request_id === this.id\n        );\n        this._booking = booking || data.booking || null;\n        this._changed = !!data._changed || !booking;\n        this.notes = data.notes || data.description || '';\n        this.deliver_time =\n            data.deliver_time || data.extension_data?.deliver_time || undefined;\n        this.deliver_offset =\n            data.deliver_offset || data.extension_data?.deliver_offset || 0;\n        this.deliver_day_offset =\n            data.deliver_day_offset ||\n            data.extension_data?.deliver_day_offset ||\n            0;\n        this.deliver_at_time = deliverAtTime(this);\n        this.conflict = !!data.conflict;\n        this.ref_id = `${this.deliver_at_time}|${this.items\n            .map((_) => `${_.id}:${_.quantity}`)\n            .join('|')}`;\n    }\n\n    public toJSON() {\n        const blob = { ...this } as any;\n        delete blob.event;\n        delete blob._changed;\n        delete blob._status;\n        delete blob._time;\n        delete blob.deliver_at_time;\n        delete blob.deliver_at;\n        blob.items = blob.items.map((_) => ({\n            id: _.id,\n            category_id: _.category_id,\n            quantity: _.quantity,\n            name: _.name,\n            item_ids: _.item_ids,\n        }));\n        return blob;\n    }\n}\n","import {\n    Identity,\n    LinkedBooking,\n    removeEmptyFields,\n    unique,\n} from '@placeos/common';\nimport { PlaceSystem } from '@placeos/ts-client';\nimport {\n    add,\n    addMinutes,\n    differenceInMinutes,\n    endOfDay,\n    format,\n    getUnixTime,\n    isAfter,\n    isBefore,\n    isSameDay,\n    roundToNearestMinutes,\n    startOfDay,\n} from 'date-fns';\nimport { CateringOrder } from 'libs/catering/src/lib/catering-order.class';\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport { GuestUser, User } from 'libs/users/src/lib/user.class';\nimport {\n    EventExtensionData,\n    FileDetails,\n    RecurrenceDetails,\n} from './event.interfaces';\nimport { eventStatus, parseRecurrence } from './helpers';\nimport { AssetRequest } from 'libs/assets/src/lib/asset-request.class';\n\nlet _default_user: Identity = { id: 'default', name: 'Default User' };\n\nexport function setDefaultCreator(user: Identity) {\n    if (user) _default_user = user;\n}\n\nconst DAYS_OF_WEEK = [\n    'sunday',\n    'monday',\n    'tuesday',\n    'wednesday',\n    'thursday',\n    'friday',\n    'saturday',\n];\n\ntype CalendarEventExtended = CalendarEvent & EventExtensionData;\n\n/** User's calendar event/booking */\nexport class CalendarEvent {\n    /** ID of the calendar event */\n    public readonly id: string;\n    /** Status of the event */\n    public readonly status: 'approved' | 'tentative' | 'declined' | 'none';\n    /** Email address of the host */\n    public readonly host: string;\n    /** ID of the calendar associated with the event */\n    public readonly calendar: string;\n    /** Email address of the event creator */\n    public readonly creator: string;\n    /** List of attendees of the event */\n    public readonly attendees: User[];\n    /** List of attendees of the event */\n    public readonly resources: Space[];\n    /** Summary of the event details */\n    public readonly title: string;\n    /** Extended details of the event */\n    public readonly body: string;\n    /** Unix epoch in seconds of the start time of the event */\n    public readonly event_start: number;\n    /** Unix epoch in seconds of the end time of the event */\n    public readonly event_end: number;\n    /** Whether event occurs over the full day */\n    public readonly all_day: boolean;\n    /** Unix epoch of the start time of the event */\n    public readonly date: number;\n    /** Duration of the event in minutes */\n    public readonly duration: number;\n    /** IANA timezone string for the event location */\n    public readonly timezone: string;\n    /** Location details for the event */\n    public readonly location: string;\n    /** URL of the associated meeting */\n    public readonly meeting_url: string;\n    /** URL of the associated meeting */\n    public readonly meeting_id: string;\n    /** URL of the associated meeting */\n    public readonly meeting_provider: string;\n    /** Whether this event is recurring */\n    public readonly recurring: boolean;\n    /** Details about the event's recurrence */\n    public readonly recurrence: RecurrenceDetails;\n    /** ID of the parent recurring event */\n    public readonly recurring_event_id: string;\n    /** Whether event details should be private */\n    public readonly private: boolean;\n    /** File attachements for the event */\n    public readonly attachments: FileDetails[];\n    /** Extra data associated with the event */\n    public readonly extension_data: Partial<EventExtensionData>;\n    /** System associated with the event */\n    public readonly system: PlaceSystem;\n    /** Previous system associated with the event */\n    public readonly old_system: PlaceSystem;\n    /** Host user details of the event */\n    public readonly organiser: User;\n    /** Type of event */\n    public readonly type: 'cancelled' | 'external' | 'internal';\n    /** Whether this event was from a PlaceOS booking instead of a user calendar */\n    public readonly from_bookings: boolean;\n    /** Master event */\n    public master?: CalendarEvent;\n    /** Unique identifier of the event */\n    public readonly ical_uid: string;\n    /** Mailbox email address of the event */\n    public readonly mailbox: string;\n    /** Setup in seconds */\n    public readonly setup_time?: number;\n    /** Breakdown in seconds */\n    public readonly breakdown_time?: number;\n    /** Bookings that a linked to this event */\n    public readonly linked_bookings: LinkedBooking[];\n    /** Whether changes to this event should update the parent event */\n    public readonly update_master: boolean;\n    /**  */\n    public readonly date_end: number;\n\n    public readonly is_system_event: boolean;\n\n    public get images() {\n        return this.extension_data.images || [];\n    }\n\n    public get is_all_day() {\n        return this.all_day || this.duration >= 12 * 60;\n    }\n\n    public get view_access() {\n        return this.extension_data.view_access || 'PRIVATE';\n    }\n\n    /** Get field from extension data */\n    public ext<K extends keyof EventExtensionData>(key: K) {\n        return this.extension_data[key];\n    }\n\n    constructor(data: Partial<CalendarEventExtended> = {}) {\n        this.id = data.event_id || data.id || '';\n        this.event_start =\n            data.event_start ||\n            getUnixTime(\n                data.date ||\n                    roundToNearestMinutes(addMinutes(new Date(), 3), {\n                        nearestTo: 5,\n                    }),\n            );\n        this.event_end =\n            data.event_end ||\n            getUnixTime(\n                addMinutes(this.event_start * 1000, data.duration || 30),\n            );\n        this.calendar = data.calendar || '';\n        this.creator =\n            (data.creator || _default_user.email)?.toLowerCase() || '';\n        this.host = (\n            data.host ||\n            this.creator ||\n            (data as any).host_email ||\n            _default_user.email ||\n            ''\n        ).toLowerCase();\n        const attendees = data.attendees || [];\n        this.attendees = attendees\n            .filter((user: any) => !user.resource)\n            .map((u) => new User(u));\n        this.resources =\n            unique(\n                data.resources ||\n                    attendees\n                        .filter((user) => (user as any).resource)\n                        .map((s) => new Space(s as any)),\n                'email',\n            ) || [];\n        this.title = data.title;\n        this.body = data.body || '';\n        this.private = !!data.private;\n        this.all_day = !!data.all_day;\n        this.date = this.event_start * 1000 || this.date;\n        this.date_end = this.event_end * 1000 || this.date_end;\n        this.duration = differenceInMinutes(this.date_end, this.date);\n        if (this.all_day) {\n            (this as any).date = startOfDay(this.date).getTime();\n            (this as any).duration = Math.max(24 * 60 - 1, this.duration - 1);\n            (this as any).date_end = endOfDay(\n                addMinutes(this.date, this.duration).valueOf() - 1,\n            ).getTime();\n        }\n        const matches = this.body.match(/\\[ID\\|([^\\]]+)\\]/);\n        const associated_id = matches ? matches[1] : null;\n        this.timezone =\n            data.timezone || Intl.DateTimeFormat().resolvedOptions().timeZone;\n        this.meeting_url = data.meeting_url || data.online_meeting_url || '';\n        this.meeting_id =\n            associated_id || data.meeting_id || data.online_meeting_id || '';\n        this.meeting_provider =\n            data.meeting_provider || data.online_meeting_provider || '';\n        this.recurring = !!data.recurring;\n        this.recurring_event_id = data.recurring_event_id || '';\n        this.organiser = this.attendees.find(\n            (user) => user.email === this.host,\n        );\n        this.from_bookings = data.from_bookings ?? false;\n        this.master = data.master ? new CalendarEvent(data.master) : null;\n        this.mailbox = data.mailbox || '';\n        this.ical_uid = data.ical_uid;\n        this.linked_bookings = data.linked_bookings || [];\n        this.update_master = data.update_master ?? false;\n        if (data.recurring) {\n            this.recurrence = {\n                start:\n                    this.event_start * 1000 ||\n                    new Date(\n                        (data.recurrence as any).range_start * 1000,\n                    ).valueOf(),\n                end:\n                    data.recurrence.end ||\n                    new Date(\n                        (data.recurrence as any).range_end * 1000,\n                    ).valueOf(),\n                interval: data.recurrence.interval,\n                pattern: data.recurrence.pattern,\n                occurrences: data.recurrence.occurrences,\n                days_of_week:\n                    data.recurrence.days_of_week?.map((_) =>\n                        typeof _ === 'number' ? _ : DAYS_OF_WEEK.indexOf(_),\n                    ) || [],\n            };\n        } else {\n            this.recurrence = {} as any;\n        }\n        const system = data.system;\n        if (\n            system?.email &&\n            !this.resources.find((_) => _.email === system.email)\n        ) {\n            this.resources.push(new Space(system as any));\n        }\n        this.system = system || (this.resources[0] as any) || null;\n        if (!system && data.system_id) {\n            this.system = { id: data.system_id } as any;\n        }\n        this.old_system = data.old_system || data.system;\n        this.is_system_event = this.body.includes('main_event_id');\n        this.attachments = data.attachments || [];\n        this.extension_data = data.extension_data || {};\n        this.status = eventStatus({ ...data, ...this }) || 'none';\n        this.location =\n            data.location || this.space?.display_name || this.space?.name || '';\n        this.setup_time = data.setup_time || 0;\n        this.breakdown_time = data.breakdown_time || 0;\n        this.type =\n            this.status === 'declined'\n                ? 'cancelled'\n                : this.attendees.find((_) => _.is_external)\n                  ? 'external'\n                  : 'internal';\n        for (const key in data) {\n            if (!(key in this)) {\n                this.extension_data[key] =\n                    data[key] || this.extension_data[key];\n            }\n        }\n        const simple_event = {\n            date: this.date,\n            duration: this.duration,\n            date_end: this.date_end,\n            all_day: this.all_day,\n            space: this.space,\n            organiser: this.organiser,\n        };\n        this.extension_data.catering = (this.extension_data.catering || []).map(\n            (i) => new CateringOrder({ ...i, event: simple_event } as any),\n        );\n        const linked_assets = this.linked_bookings\n            .filter((_) => _.booking_type === 'asset-request')\n            .map((_) => _.extension_data?.request)\n            .filter((_) => !!_);\n        const asset_requests =\n            (linked_assets.length\n                ? linked_assets\n                : this.extension_data.assets) || [];\n        this.extension_data.images =\n            this.extension_data.images || data.images || [];\n        this.extension_data.assets = asset_requests.map(\n            (i) => new AssetRequest({ ...i, event: simple_event } as any),\n        );\n    }\n\n    /** List of external attendees associated with the event */\n    public get guests() {\n        return this.attendees.filter((f) => !!f.is_external) as GuestUser[];\n    }\n    /** Primary space associated with the booking */\n    public get space() {\n        return this.resources[0] || null;\n    }\n    public get is_today(): boolean {\n        return isSameDay(this.date, Date.now());\n    }\n\n    public get valid_catering() {\n        return (this.ext('catering') || []).filter(\n            (order) => order.deliver_at < this.date_end,\n        );\n    }\n\n    _valid_asset_cache = [];\n    _valid_cache_expiry = 0;\n\n    public get valid_assets() {\n        if (\n            this._valid_cache_expiry > Date.now() &&\n            this._valid_asset_cache.length\n        ) {\n            return this._valid_asset_cache;\n        }\n        const list = this.linked_bookings;\n        this._valid_asset_cache = (this.ext('assets') || [])\n            .map((request) => new AssetRequest({ ...request, event: this }))\n            .filter((request) => request.deliver_at < this.date_end)\n            .map((request) => {\n                const booking = list.find(\n                    (_: any) => _.extension_data.request_id === request.id,\n                );\n                if (booking) {\n                    (request as any).state = booking.approved\n                        ? 'approved'\n                        : booking.rejected\n                          ? 'rejected'\n                          : 'pending';\n                }\n                return request;\n            });\n        this._valid_cache_expiry = addMinutes(Date.now(), 5).valueOf();\n        return this._valid_asset_cache;\n    }\n\n    /**\n     * Convert class data to simple JSON object\n     */\n    public toJSON(): Record<string, any> {\n        const obj: Record<string, any> = { ...this };\n        const date = this.all_day ? startOfDay(this.date) : this.date;\n        const end = this.all_day\n            ? endOfDay(this.date_end).valueOf() + 1\n            : this.date_end;\n        obj.event_start = getUnixTime(date);\n        obj.event_end = getUnixTime(end);\n        const attendees = this.attendees;\n        (this as any).recurring =\n            this.recurrence?.pattern && this.recurrence._pattern !== 'none';\n        if (this.recurring) {\n            obj.recurrence = parseRecurrence({\n                ...this.recurrence,\n                start: this.date,\n            });\n            delete obj.recurrence.start;\n            delete obj.recurrence.end;\n        }\n        obj.recurrence = obj.recurrence\n            ? Object.keys(obj.recurrence).length\n                ? obj.recurrence\n                : null\n            : null;\n        obj.attendees = unique(\n            [\n                ...attendees,\n                ...this.resources.map((_) => ({ ..._, resource: true })),\n            ],\n            'email',\n        );\n        if (this.all_day) {\n            obj.setup_time = 0;\n            obj.breakdown_time = 0;\n            obj.extension_data.all_day_date = format(date, 'yyyy-MM-dd');\n        }\n        obj.extension_data.catering = obj.extension_data.catering.map(\n            (i) => new CateringOrder({ ...i, event: null }),\n        );\n        obj.extension_data.assets = obj.extension_data.assets.map(\n            (i) => new AssetRequest({ ...i, event: null }),\n        );\n        obj.system_id = this.system?.id;\n        for (const key of [\n            'catering',\n            'date',\n            'date_end',\n            'duration',\n            'status',\n            'linked_bookings',\n            '_valid_asset_cache',\n            '_valid_cache_expiry',\n            'type',\n        ]) {\n            if (key in obj) delete obj[key];\n        }\n        if (!obj.update_master) delete obj.recurring_event_id;\n        removeEmptyFields(obj);\n        return obj;\n    }\n\n    /** Status of the booking */\n    public get state():\n        | 'future'\n        | 'upcoming'\n        | 'done'\n        | 'started'\n        | 'in_progress' {\n        const now = new Date();\n        const date = this.date;\n        if (isBefore(now, add(date, { minutes: -15 }))) return 'future';\n        if (isBefore(now, date)) return 'upcoming';\n        if (isBefore(now, add(date, { minutes: 15 }))) return 'started';\n        if (isBefore(now, add(date, { minutes: this.duration })))\n            return 'in_progress';\n        return 'done';\n    }\n\n    public get can_check_in(): boolean {\n        const now = new Date();\n        return (\n            this.is_today ||\n            (isAfter(now, addMinutes(this.date, -5)) &&\n                isBefore(now, addMinutes(this.date, this.duration)))\n        );\n    }\n}\n","import { del, get, patch } from '@placeos/ts-client';\nimport { map } from 'rxjs/operators';\n\nimport { CalendarEvent } from '../../../events/src/lib/event.class';\nimport { toQueryString } from 'libs/common/src/lib/api';\nimport { GuestUser } from './user.class';\nimport { Observable } from 'rxjs';\n\nconst GUEST_ENDPOINT = '/api/staff/v1/guests';\n\nexport interface GuestsQueryParams {\n    /** Comma seperated list of zone ids to check availability */\n    zone_ids?: string;\n    /** Comma seperated list of system(space) ids to check availability */\n    system_ids?: string;\n    /** Epoch in seconds for the start of the availability period */\n    period_start: number;\n    /** Epoch in seconds for the end of the availability period */\n    period_end: number;\n}\n\n/**\n * Search guests\n * @param q Search string for filtering guests\n */\nexport function searchGuests(q: string): Observable<GuestUser[]> {\n    const query = toQueryString({ q });\n    return get(`${GUEST_ENDPOINT}${q ? '?' + query : ''}`).pipe(\n        map((list) => list.map((item) => new GuestUser(item)))\n    );\n}\n\n/**\n * List guests\n * @param q Parameters to pass to the API request\n */\nexport function queryGuests(q: GuestsQueryParams): Observable<GuestUser[]> {\n    const query = toQueryString({ ...q });\n    return get(`${GUEST_ENDPOINT}${query ? '?' + query : ''}`).pipe(\n        map((list) => list.map((item) => new GuestUser(item)))\n    );\n}\n\n/**\n * Get guest details\n * @param id ID of the guest\n */\nexport function showGuest(id: string) {\n    return get(`${GUEST_ENDPOINT}/${encodeURIComponent(id)}`).pipe(\n        map((item) => new GuestUser(item))\n    );\n}\n\n/**\n * Update guest metadata\n * @param id ID of the guest\n * @param data New metadata state\n */\nexport function updateGuest(id: string, data: Partial<GuestUser>) {\n    return patch(`${GUEST_ENDPOINT}/${encodeURIComponent(id)}`, data).pipe(\n        map((item) => new GuestUser(item))\n    );\n}\n\n/**\n * Remove a guest\n * @param id ID of the guest to remove\n */\nexport function removeGuest(id: string) {\n    return del(`${GUEST_ENDPOINT}/${encodeURIComponent(id)}`, {\n        response_type: 'void',\n    });\n}\n\n/**\n * List upcoming meetings for a guest\n * @param id ID of the guest\n */\nexport function listGuestMeetings(id: string) {\n    return get(`${GUEST_ENDPOINT}/${encodeURIComponent(id)}/meetings`).pipe(\n        map((list) => list.map((item) => new CalendarEvent(item)))\n    );\n}\n","import { get } from '@placeos/ts-client';\nimport { toQueryString } from 'libs/common/src/lib/api';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { StaffUser } from './user.class';\n\nconst STAFF_ENDPOINT = '/api/staff/v1/people';\n\n/**\n * Search staff members\n * @param q Search string for filtering staff\n */\nexport function searchStaff(q: string): Observable<StaffUser[]> {\n    const query = toQueryString({\n        q,\n        fields: [\n            'id',\n            'name',\n            'email',\n            'username',\n            'organisation',\n            'department',\n        ].join(','),\n    });\n    return get(`${STAFF_ENDPOINT}${q ? '?' + query : ''}`).pipe(\n        map((list) =>\n            list.map((item: Record<string, any>) => new StaffUser(item))\n        )\n    );\n}\n\n/**\n * Get user details\n * @param id User ID or email\n */\nexport function showStaff(id: string) {\n    return get(`${STAFF_ENDPOINT}/${encodeURIComponent(id)}`).pipe(\n        map((item) => new StaffUser(item))\n    );\n}\n\n/**\n * Get user with their location details\n * @param email User email\n */\nexport function locateStaff(email: string) {\n    return get(`${STAFF_ENDPOINT}/${email}`).pipe(\n        map((item) => new StaffUser(item))\n    );\n}\n","import {\n    Component,\n    forwardRef,\n    Output,\n    EventEmitter,\n    Input,\n    ViewChild,\n    ElementRef,\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport {\n    AsyncHandler,\n    csvToJson,\n    currentUser,\n    downloadFile,\n    notifyError,\n    SettingsService,\n    unique,\n} from '@placeos/common';\nimport {\n    catchError,\n    debounceTime,\n    first,\n    map,\n    switchMap,\n    tap,\n} from 'rxjs/operators';\nimport { MatDialog } from '@angular/material/dialog';\nimport { COMMA, ENTER } from '@angular/cdk/keycodes';\nimport { BehaviorSubject, combineLatest, of, zip } from 'rxjs';\n\nimport { NewUserModalComponent } from 'libs/users/src/lib/new-user-modal.component';\nimport { searchGuests } from 'libs/users/src/lib/guests.fn';\nimport { searchStaff } from 'libs/users/src/lib/staff.fn';\nimport { User } from 'libs/users/src/lib/user.class';\nimport { USER_DOMAIN } from 'libs/users/src/lib/user.utilities';\nimport { authority, queryUsers } from '@placeos/ts-client';\n\nfunction validateEmail(email) {\n    const re =\n        /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(email);\n}\n\nconst ACCEPTED_FILE_TYPES = ['text/csv', 'text/plain'];\nconst DENIED_FILE_TYPES = [\n    'application/vnd.ms-excel',\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n];\n\n@Component({\n    selector: 'a-user-list-field',\n    template: `\n        <div class=\"mb-4\" form-field [attr.disabled]=\"disabled\">\n            <div search>\n                <mat-form-field\n                    class=\"w-full\"\n                    appearance=\"outline\"\n                    matAutocompleteOrigin\n                    #origin=\"matAutocompleteOrigin\"\n                >\n                    <mat-chip-grid #chipList aria-label=\"User Seleciom\">\n                        <mat-chip-row\n                            user\n                            *ngFor=\"let item of active_list\"\n                            [class.bg-warning]=\"item.is_external\"\n                            (removed)=\"removeUser(item)\"\n                        >\n                            <div class=\"flex items-center space-x-2\">\n                                <div>{{ item.name || item.email }}</div>\n                                <app-icon\n                                    *ngIf=\"!item.is_external\"\n                                    [matTooltip]=\"\n                                        (\n                                            item?.email\n                                            | placeuser\n                                            | async\n                                        )?.location_name_time(time)\n                                    \"\n                                >\n                                    {{\n                                        (\n                                            item?.email\n                                            | placeuser\n                                            | async\n                                        )?.location_icon(time)\n                                    }}\n                                </app-icon>\n                            </div>\n                            <button\n                                matChipRemove\n                                remove\n                                [attr.aria-label]=\"\n                                    'Remove ' + (item.name || item.email)\n                                \"\n                            >\n                                <app-icon>cancel</app-icon>\n                            </button>\n                        </mat-chip-row>\n                    </mat-chip-grid>\n                    <input\n                        #search_field\n                        placeholder=\"Type a name or email\"\n                        i18n-placeholder\n                        name=\"user_email\"\n                        [ngModel]=\"search$ | async\"\n                        (ngModelChange)=\"updateSearch($event)\"\n                        [matAutocomplete]=\"auto\"\n                        [matChipInputFor]=\"chipList\"\n                        [matChipInputSeparatorKeyCodes]=\"separatorKeysCodes\"\n                        (matChipInputTokenEnd)=\"addUserFromEmail($event.value)\"\n                    />\n                    <mat-spinner\n                        *ngIf=\"loading\"\n                        diameter=\"24\"\n                        matSuffix\n                    ></mat-spinner>\n                </mat-form-field>\n                <mat-autocomplete #auto=\"matAutocomplete\">\n                    <mat-option\n                        *ngIf=\"search_valid_email\"\n                        (click)=\"addUserFromEmail()\"\n                        i18n\n                    >\n                        Add external user with email \"{{ search$.getValue() }}\"\n                    </mat-option>\n                    <mat-option\n                        *ngFor=\"let user of user_list$ | async\"\n                        (click)=\"addUser(user)\"\n                        class=\"leading-tight\"\n                    >\n                        {{ user.name }}<br />\n                        <span class=\"text-xs\">{{ user.email }}</span>\n                    </mat-option>\n                </mat-autocomplete>\n            </div>\n            <div\n                class=\"flex items-center space-x-2 -mt-4\"\n                actions\n                *ngIf=\"!hide_actions\"\n            >\n                <button\n                    btn\n                    matRipple\n                    type=\"button\"\n                    name=\"new-contact\"\n                    class=\"inverse flex-1 sm:flex-none\"\n                    (click)=\"openNewUserModal()\"\n                    i18n=\"Add new external attendee\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        Add&nbsp;<span class=\"hidden sm:inline\">External</span>\n                    </div>\n                </button>\n                <button\n                    btn\n                    matRipple\n                    type=\"button\"\n                    name=\"upload-csv\"\n                    class=\"relative inverse flex-1 sm:flex-none\"\n                    i18n=\"Upload attendee list from CSV file\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        Upload&nbsp;<span class=\"hidden sm:inline\">CSV</span>\n                    </div>\n                    <input\n                        class=\"opacity-0 absolute inset-0\"\n                        type=\"file\"\n                        (change)=\"addUsersFromFile($event)\"\n                    />\n                </button>\n                <button\n                    btn\n                    matRipple\n                    type=\"button\"\n                    name=\"download-template\"\n                    class=\"inverse flex-1 sm:flex-none\"\n                    (click)=\"downloadCSVTemplate(); download.emit()\"\n                    i18n=\"Download template CSV file\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        <span class=\"hidden sm:inline\">CSV</span>&nbsp;Template\n                    </div>\n                </button>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            [search] {\n            }\n        `,\n    ],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => UserListFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class UserListFieldComponent\n    extends AsyncHandler\n    implements ControlValueAccessor\n{\n    @Input() public time = Date.now();\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Number of characters needed before a search will start */\n    @Input() public limit = 3;\n    /** Whether guests should also show when searching for users */\n    @Input() public guests = false;\n    /** Whether guests should also show when searching for users */\n    @Input() public guests_only = false;\n    /** Whether optional actions should be shown */\n    @Input() public hide_actions = false;\n    /** Whether as custom template will be provided outside the component */\n    @Input() public custom_template = false;\n    /** Function for filtering the results of the user list */\n    @Input() public filter: (_: any) => boolean;\n    /** Emitter for action to make a new user */\n    @Output() public new_user = new EventEmitter<void>();\n    /** Whether user should download the CSV template */\n    @Output() public download = new EventEmitter<void>();\n\n    readonly separatorKeysCodes = [ENTER, COMMA] as const;\n\n    /** Whether user list is loading */\n    public loading = false;\n    public readonly search$ = new BehaviorSubject('');\n\n    @ViewChild('search_field') private _search_el: ElementRef<HTMLInputElement>;\n\n    private searchStaff(q: string) {\n        return this._settings.get('app.basic_user_search')\n            ? queryUsers({ q, authority_id: authority()?.id }).pipe(\n                  map((_) => _.data.map((u) => new User(u)))\n              )\n            : searchStaff(q);\n    }\n\n    /** User list to display */\n    public user_list$ = this.search$.pipe(\n        debounceTime(300),\n        switchMap((_) => {\n            this.loading = true;\n            return (\n                _\n                    ? this.guests\n                        ? combineLatest([\n                              this.searchStaff(_),\n                              searchGuests(_),\n                          ]).pipe(\n                              map(([staff, guests]) => {\n                                  if (this.guests_only) staff = [];\n                                  const visitors_list = [];\n                                  const visitors =\n                                      this._settings.get('visitor-invitees') ||\n                                      [];\n                                  for (const item of visitors) {\n                                      const [email, name, company] =\n                                          item.split('|');\n                                      visitors_list.push({\n                                          email,\n                                          name,\n                                          company,\n                                      });\n                                  }\n                                  return unique(\n                                      (staff as any)\n                                          .concat(guests)\n                                          .concat(visitors_list),\n                                      'email'\n                                  );\n                              })\n                          )\n                        : this.searchStaff(_)\n                    : of([])\n            ).pipe(catchError((_) => of([])));\n        }),\n        tap((_) => (this.loading = false))\n    );\n    /** List of active selected users on the list */\n    public active_list: User[] = [];\n\n    /** Form control on change handler */\n    private _onChange: (_: User[]) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: User[]) => void;\n\n    public readonly validFn = (s) => validateEmail(s);\n    public readonly emptyClick = () => this.openNewUserModal(new User());\n\n    public get search_valid_email() {\n        return validateEmail(this.search$.getValue());\n    }\n\n    constructor(\n        private _dialog: MatDialog,\n        private _settings: SettingsService\n    ) {\n        super();\n    }\n\n    public updateSearch(new_value: string = '') {\n        this.timeout('search', () => this.search$.next(new_value));\n    }\n\n    public addUserFromEmail(email: string = '') {\n        if (!email) email = this.search$.getValue();\n        if (!validateEmail(email)) return;\n        const user = new User({ id: email, email, name: email.split('@')[0] });\n        this.addUser(user);\n        const { name, organisation } = user;\n        const visitor_details = `${email}|${name}|${organisation}`;\n        const old_visitors = this._settings.get('visitor-invitees') || [];\n        this._settings.saveUserSetting('visitor-invitees', [\n            ...old_visitors.filter((_) => !_.includes(email)),\n            visitor_details,\n        ]);\n        this.timeout(\n            'clear_search',\n            () => {\n                this.search$.next('');\n                this._search_el.nativeElement.value = '';\n            },\n            100\n        );\n    }\n\n    /**\n     * Add user to the user list\n     * @param user\n     */\n    public addUser(user: User) {\n        const list = this.active_list?.filter((_) => _.id !== user.id) || [];\n        this.setValue([\n            ...list,\n            new User({\n                ...user,\n                id: user.id || user.email,\n                visit_expected:\n                    (!user.id && user.is_external !== true\n                        ? user.visit_expected\n                        : null) ?? true,\n            }),\n        ]);\n        this.timeout(\n            'clear_search',\n            () => {\n                this.search$.next('');\n                this._search_el.nativeElement.value = '';\n            },\n            100\n        );\n    }\n\n    /**\n     * Remove user from the user list\n     * @param user\n     */\n    public removeUser(user: User) {\n        const list = this.active_list.filter((a_user) => a_user.id !== user.id);\n        this.setValue(list);\n    }\n\n    /**\n     * Load CSV file and populate the user list with the contents\n     * @param event File input field event\n     */\n    public addUsersFromFile(event) {\n        /* istanbul ignore else */\n        if (event.target) {\n            const file: File = event.target.files[0];\n            /* istanbul ignore else */\n            if (file) {\n                if (\n                    !ACCEPTED_FILE_TYPES.includes(file.type) ||\n                    DENIED_FILE_TYPES.includes(file.type)\n                ) {\n                    notifyError('Only CSV files are supported');\n                    return;\n                }\n                const reader = new FileReader();\n                reader.readAsText(file, 'UTF-8');\n                reader.addEventListener('load', (evt) => {\n                    this.processCsvData((evt.srcElement as any).result);\n                    event.target.value = '';\n                });\n                reader.addEventListener('error', (_) =>\n                    notifyError('Error reading file.')\n                );\n            }\n        }\n    }\n\n    /**\n     * Process raw CSV data and save user data to attendee list\n     * @param data CSV data\n     */\n    private processCsvData(data: string) {\n        const list = csvToJson(data) || [];\n        const id = currentUser()?.staff_id || 'unknown';\n        for (const el of list) {\n            el.name = el.name || `${el.first_name} ${el.last_name}`;\n            const display = (\n                el.name || `${Math.floor(Math.random() * 9999_9999)}`\n            )\n                .split(' ')\n                .join('_')\n                .toLowerCase();\n            /* istanbul ignore else */\n            if (!el.email) {\n                el.email = `${display}+${id}@guest.${USER_DOMAIN}`;\n            }\n            const internal_emails = this._settings.get(\n                'app.bookings.internal_emails'\n            ) || ['place.tech'];\n            el.visit_expected =\n                el.visit_expected ??\n                !internal_emails.find((_) => el.email.endsWith(_));\n\n            /** Convert phone to string. PWCME-544 */\n            el.phone = '' + el.phone;\n\n            this.addUser(new User(el));\n        }\n    }\n\n    /* istanbul ignore next */\n    /** Download template CSV file */\n    public downloadCSVTemplate() {\n        if (this.custom_template) return;\n        const template = `Organisation,First Name,Last Name,Email,Phone,Assistance Required,Visit Expected\\nFake Org,John,Smith,john.smith@example.com,01234567898,false,true`;\n        downloadFile('template.csv', template);\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: User[]): void {\n        this.active_list = new_value;\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: User[]) {\n        this.active_list = value;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: User[]) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: User[]) => void): void {\n        this._onTouch = fn;\n    }\n\n    public displayFn(item): string {\n        return item?.name || '';\n    }\n\n    /**\n     * Open modal to add or update user details\n     */\n    public openNewUserModal(user: User = new User()) {\n        const ref = this._dialog.open<NewUserModalComponent>(\n            NewUserModalComponent,\n            {\n                width: 'auto',\n                height: 'auto',\n                data: { user },\n            }\n        );\n        ref.componentInstance?.event\n            .pipe(first((_) => _.reason === 'done'))\n            .subscribe((event) => {\n                this.addUser(event.metadata);\n                ref.close();\n            });\n    }\n}\n","/* eslint-disable @typescript-eslint/member-ordering */\nimport {\n    Component,\n    OnInit,\n    forwardRef,\n    Input,\n    ViewChild,\n    ElementRef,\n} from '@angular/core';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\nimport { Subject, Observable, of, forkJoin } from 'rxjs';\nimport {\n    switchMap,\n    debounceTime,\n    distinctUntilChanged,\n    map,\n    catchError,\n} from 'rxjs/operators';\n\nimport { AsyncHandler, flatten, SettingsService } from '@placeos/common';\nimport { searchGuests } from 'libs/users/src/lib/guests.fn';\nimport { searchStaff } from 'libs/users/src/lib/staff.fn';\nimport { User } from 'libs/users/src/lib/user.class';\nimport { authority, queryUsers } from '@placeos/ts-client';\n\n@Component({\n    selector: 'a-user-search-field',\n    template: `\n        <mat-form-field appearance=\"outline\" class=\"w-full no-subscript\">\n            <input\n                #input\n                matInput\n                keyboard\n                name=\"user-search\"\n                [(ngModel)]=\"search_str\"\n                (ngModelChange)=\"search$.next($event || '')\"\n                [disabled]=\"disabled\"\n                [placeholder]=\"placeholder || 'Search for user...'\"\n                [matAutocomplete]=\"auto\"\n                (keyup.enter)=\"\n                    validate && validate(search_str) ? setValue(search_str) : ''\n                \"\n                (blur)=\"resetSearchString()\"\n                (focus)=\"cancelReset()\"\n            />\n            <app-icon matPrefix class=\"text-2xl relative\">search</app-icon>\n            <mat-spinner *ngIf=\"loading\" matSuffix diameter=\"16\"></mat-spinner>\n        </mat-form-field>\n        <mat-autocomplete\n            #auto=\"matAutocomplete\"\n            (optionSelected)=\"setValue($event.option.value)\"\n        >\n            <mat-option\n                *ngFor=\"let option of user_list\"\n                (click)=\"setValue(option); blurInput()\"\n            >\n                <div class=\"leading-tight\">{{ option.name }}</div>\n                <div class=\"text-xs opacity-60\">\n                    {{ option.email }}\n                </div>\n            </mat-option>\n            <mat-option\n                *ngIf=\"search_str && validate && validate(search_str)\"\n                class=\"relative pointer-events-none\"\n            >\n                <div\n                    class=\"absolute inset-0 px-4 pointer-events-auto\"\n                    (mousedown)=\"\n                        $event.stopPropagation(); $event.preventDefault()\n                    \"\n                    (touchstart)=\"\n                        $event.stopPropagation(); $event.preventDefault()\n                    \"\n                    (click)=\"\n                        setValue(search_str);\n                        $event.stopPropagation();\n                        $event.preventDefault()\n                    \"\n                >\n                    <div class=\"pointer-events-none\" i18n>\n                        Add external attendee \"{{ search_str }}\"\n                    </div>\n                </div>\n            </mat-option>\n            <mat-option\n                *ngIf=\"!user_list?.length && (search_str || error)\"\n                [disabled]=\"!empty_fn\"\n                (click)=\"empty_fn()\"\n            >\n                {{ search_str ? 'No users found.' : '' }} {{ error }}\n            </mat-option>\n        </mat-autocomplete>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n            }\n            app-icon {\n                top: 0.15em;\n                left: -0.15em;\n            }\n        `,\n    ],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => UserSearchFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class UserSearchFieldComponent\n    extends AsyncHandler\n    implements OnInit, ControlValueAccessor\n{\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Placeholder text to display */\n    @Input() public placeholder: string;\n    /** Limit available options to these */\n    @Input() public options: User[];\n    /** Whether guests should also show when searching for users */\n    @Input() public guests: boolean;\n    /** Message to display when no user matches have been found */\n    @Input() public error = '';\n    /** Function to validate the search string */\n    @Input() public validate: (s: string) => boolean;\n    /** Function to call when empty list option is clicked */\n    @Input() public empty_fn: () => void;\n    /** Function for filtering the results of the user list */\n    @Input() public filter: (_: any, s?: string) => boolean;\n\n    @Input() public query_fn: (_: string) => Observable<User[]> = (q) =>\n        this._settings.get('app.basic_user_search')\n            ? queryUsers({ q, authority_id: authority()?.id }).pipe(\n                  map((_) => _.data.map((_) => new User(_)))\n              )\n            : searchStaff(q);\n    /** Currently selected user */\n    public active_user: User;\n    /** User list to display */\n    public user_list: User[];\n    /** Whether user list is loading */\n    public loading: boolean;\n    /** Current display value of the search input field  */\n    public search_str: string;\n    /** Subject holding the value of the search */\n    public search$ = new Subject<string>();\n    /** List of users from an API search */\n    public search_results$: Observable<User[]> = this.search$.pipe(\n        debounceTime(400),\n        distinctUntilChanged(),\n        switchMap((query) => {\n            this.loading = true;\n            return this.options && this.options.length > 0\n                ? of(this.options)\n                : query.length >= 3\n                ? !this.guests\n                    ? this.query_fn(query)\n                    : forkJoin([searchStaff(query), searchGuests(query)])\n                : of([]);\n        }),\n        catchError((_) => of([])),\n        map((list: User[]) => {\n            this.loading = false;\n            list = flatten(list);\n            const search = (this.search_str || '').toLowerCase();\n            return list.filter(\n                (item) => !this.filter || this.filter(item, search)\n            );\n        })\n    );\n\n    constructor(private _settings: SettingsService) {\n        super();\n    }\n\n    /** Form control on change handler */\n    private _onChange: (_: User) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: User) => void;\n\n    @ViewChild('input', { read: ElementRef })\n    private _input_el: ElementRef<HTMLInputElement>;\n\n    public cancelReset = () => this.clearTimeout('reset');\n\n    public blurInput = () => {\n        this.timeout('blur', () => this._input_el?.nativeElement?.blur());\n    };\n\n    public ngOnInit(): void {\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.search_results$.subscribe((list) => (this.user_list = list))\n        );\n        this.resetSearchString();\n    }\n\n    /**\n     * Reset the search string back to the name of the active user\n     */\n    public resetSearchString() {\n        this.timeout(\n            'reset',\n            () => (this.search_str = this.active_user?.name || ''),\n            100\n        );\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: User | string, email?: string): void {\n        if (!new_value) return;\n        if (\n            typeof new_value === 'string' &&\n            (new_value as any) === this.search_str\n        ) {\n            new_value = new User({\n                name: (this.search_str || email || '').split('@')[0],\n                email: this.search_str || email || '',\n            });\n        }\n        const user = new_value as any;\n        if (!('name' in user) && !('email' in user)) return;\n        this.active_user = user;\n        if (this._onChange) this._onChange(user);\n        this.resetSearchString();\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: User) {\n        this.active_user = value;\n        this.resetSearchString();\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: User) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: User) => void): void {\n        this._onTouch = fn;\n    }\n}\n","import { Component, forwardRef, Input } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { FormControl } from '@angular/forms';\nimport { MatChipInputEvent } from '@angular/material/chips';\nimport { COMMA, ENTER } from '@angular/cdk/keycodes';\n\n/**\n * Add a tag to the list of tags for the item\n * @param event Input event\n */\nexport function addChipItem<T = string>(\n    control: FormControl<T[]>,\n    event: MatChipInputEvent\n): void {\n    if (!control) return;\n    const input = event.input;\n    const value = event.value as any;\n    const item_list = control.value;\n    if (value.includes(',')) {\n        const list = value.split(',');\n        for (const item of list) {\n            if ((item || '').trim()) {\n                item_list.push(item.trim());\n                control.setValue(item_list);\n            }\n        }\n    } else {\n        if ((value || '').trim()) {\n            item_list.push(value.trim());\n            control.setValue(item_list);\n        }\n    }\n\n    // Reset the input value\n    if (input) {\n        input.value = '';\n    }\n}\n\n/**\n * Remove tag from the list\n * @param existing_tag Tag to remove\n */\nexport function removeChipItem<T = string>(\n    control: FormControl<T[]>,\n    item: T\n): void {\n    if (!control) {\n        return;\n    }\n    const item_list = control.value;\n    const index = item_list.indexOf(item);\n\n    if (index >= 0) {\n        item_list.splice(index, 1);\n        control.setValue(item_list);\n    }\n}\n\n@Component({\n    selector: 'item-list-field',\n    template: `\n        <mat-form-field appearance=\"outline\" class=\"w-full\">\n            <mat-chip-grid #chipList aria-label=\"Zone Tags\">\n                <mat-chip-row\n                    *ngFor=\"let item of value\"\n                    (removed)=\"remove(item)\"\n                >\n                    <span class=\"truncate max-w-md\">{{ item }}</span>\n                    <button matChipRemove [attr.aria-label]=\"'Remove ' + item\">\n                        <app-icon>cancel</app-icon>\n                    </button>\n                </mat-chip-row>\n            </mat-chip-grid>\n            <input\n                [placeholder]=\"placeholder || 'User groups...'\"\n                i18n-placeholder=\"@@userGroupsPlaceholder\"\n                [matChipInputFor]=\"chipList\"\n                [matChipInputSeparatorKeyCodes]=\"separators\"\n                [matChipInputAddOnBlur]=\"true\"\n                (matChipInputTokenEnd)=\"add($event)\"\n            />\n        </mat-form-field>\n    `,\n    styles: [``],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            /* istanbul ignore next */\n            useExisting: forwardRef(() => ItemListFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class ItemListFieldComponent<T = any> implements ControlValueAccessor {\n    @Input() public separators: number[] = [ENTER, COMMA];\n\n    @Input() public placeholder = '';\n    /** List of items stored */\n    public value: T[] = [];\n\n    /** Form control on change handler */\n    private _onChange: (_: T[]) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: T[]) => void;\n\n    /**\n     * Add the `step` to the current value\n     */\n    public readonly add = (e: MatChipInputEvent) =>\n        addChipItem(\n            { value: this.value, setValue: (i) => this.setValue(i) } as any,\n            e\n        );\n\n    /** Remove the `step` from the current value */\n    public readonly remove = (item: T) =>\n        removeChipItem(\n            { value: this.value, setValue: (i) => this.setValue(i) } as any,\n            item\n        );\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: T[]): void {\n        this.value = new_value;\n        /* istanbul ignore else */\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: T[]) {\n        this.value = value;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: T[]) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: T[]) => void): void {\n        this._onTouch = fn;\n    }\n}\n","import {\n    LinkedBooking,\n    capitalizeFirstLetter,\n    removeEmptyFields,\n} from '@placeos/common';\nimport { User } from 'libs/users/src/lib/user.class';\nimport {\n    add,\n    addHours,\n    addMinutes,\n    differenceInMinutes,\n    endOfDay,\n    getUnixTime,\n    isAfter,\n    isBefore,\n    isSameDay,\n    roundToNearestMinutes,\n    startOfDay,\n} from 'date-fns';\nimport { AssetRequest } from 'libs/assets/src/lib/asset-request.class';\n\nexport type BookingType =\n    | 'desk'\n    | 'parking'\n    | 'locker'\n    | 'room'\n    | 'visitor'\n    | 'asset-request'\n    | 'staff'\n    | 'group-event'\n    | ' ';\nconst IGNORE_EXT_KEYS = ['user', 'booked_by', 'resources', 'assets', 'members'];\n\nexport interface BookingComplete extends Booking {\n    members?: User[];\n    guests?: User[];\n}\n\nexport enum RecurrenceDays {\n    SUNDAY = 1 << 6,\n    MONDAY = 1 << 5,\n    TUESDAY = 1 << 4,\n    WEDNESDAY = 1 << 3,\n    THURSDAY = 1 << 2,\n    FRIDAY = 1 << 1,\n    SATURDAY = 1 << 0,\n}\n\nexport interface LinkedCalendarEvent {\n    id?: string;\n    date: number;\n    duration: number;\n    date_end: number;\n    system_id: string;\n    resource_calendar: string;\n    event_id: string;\n    host_email: string;\n}\n\nexport enum WeekOfMonth {\n    First = 1,\n    Second = 2,\n    Third = 3,\n    Fourth = 4,\n    Fifth = 5,\n    Last = -1,\n    SecondLast = -2,\n    ThirdLast = -3,\n    FourthLast = -4,\n    FifthLast = -5,\n}\n\n/** General purpose booking class */\nexport class Booking {\n    /** Unique Identifier of the object */\n    public readonly id: string;\n    /** Identifier of the parent booking */\n    public readonly parent_id: string;\n    /** Unix epoch for the start time of the booking in seconds */\n    public readonly booking_start: number;\n    /** Unix epoch for the start time of the booking in seconds */\n    public readonly booking_end: number;\n    /** ID of the user who owns the booking */\n    public readonly booked_by_id: string;\n    /** Email of the user who owns the booking */\n    public readonly booked_by_email: string;\n    /** Display name of the user who owns the booking */\n    public readonly booked_by_name: string;\n    /** ID of the user who owns the booking */\n    public readonly user_id: string;\n    /** Email of the user who owns the booking */\n    public readonly user_email: string;\n    /** Display name of the user who owns the booking */\n    public readonly user_name: string;\n    /** ID of an associated calendar event */\n    public readonly event_id?: string;\n    /** Identifier of the physical asset assocated with the booking */\n    public readonly asset_id: string;\n    /** List of identifier of the physical assets assocated with the booking */\n    public readonly asset_ids: string[];\n    /** Name of the physical asset assocated with the booking */\n    public readonly asset_name: string;\n    /** Zones associated with the asset ID */\n    public readonly zones: string[];\n    /** Type of booking */\n    public readonly booking_type: BookingType;\n    /** Start time of booking in ms */\n    public readonly date: number;\n    /** End time of booking in ms */\n    public readonly date_end: number;\n    /** Duration of the event in minutes */\n    public readonly duration: number;\n    /** Whether it is an all day booking */\n    public readonly all_day: boolean;\n    /** Timezone of the booking */\n    public readonly timezone: string;\n    /** Title of the booking */\n    public readonly title: string;\n    /** Description */\n    public readonly description: string;\n    /** Whether user checked in */\n    public readonly checked_in: boolean;\n    /** Whether booking is rejected */\n    public readonly rejected: boolean;\n    /** Whether booking is approved */\n    public readonly approved: boolean;\n    /** Id of the approver */\n    public readonly approver_id: string;\n    /** Email of the approver */\n    public readonly approver_email: string;\n    /** Name of the approver */\n    public readonly approver_name: string;\n    /** Extra non-standard metadata associated with the booking */\n    public readonly extension_data: Record<string, any>;\n    /** Default type */\n    public readonly type: string;\n    /** List of URLs for associated booking images */\n    public readonly images: string[];\n    /** List of user defined tags associated with the booking */\n    public readonly tags: string[];\n\n    public readonly permission: 'PRIVATE' | 'OPEN' | 'PUBLIC';\n    /** Default type */\n    public readonly access: boolean;\n    /** Whether asset has been inducted */\n    public readonly induction?: 'tentative' | 'accepted' | 'declined';\n    /** Status of the booking */\n    public readonly status:\n        | 'declined'\n        | 'cancelled'\n        | 'approved'\n        | 'tentative'\n        | 'ended';\n    /** New deleted field */\n    public readonly deleted: boolean;\n    /** List of attendees for the booking */\n    public readonly attendees: User[];\n    /** Time  */\n    public readonly checked_out_at?: number;\n    /** Time  */\n    public readonly checked_in_at?: number;\n\n    public readonly linked_event?: LinkedCalendarEvent;\n\n    public readonly linked_bookings: LinkedBooking[];\n\n    public readonly process_state: string;\n    /** Unix epoch for the start time of the reccurence instance in seconds */\n    public readonly instance?: number;\n    /** Type of recurrence instance */\n    public readonly recurrence_type: 'none' | 'daily' | 'weekly' | 'monthly';\n    /** Bit flags for the recurrence days of the week */\n    public readonly recurrence_days?: number;\n    /** Week of the month to recur on */\n    public readonly recurrence_nth_of_month?: WeekOfMonth;\n    /** How often to recur */\n    public readonly recurrence_interval?: number;\n    /** Unix epoch for the end time of the recurrence in seconds */\n    public readonly recurrence_end?: number;\n\n    public get group() {\n        return this.extension_data.group || '';\n    }\n\n    public get is_all_day() {\n        return this.all_day || this.duration >= 12 * 60;\n    }\n\n    _valid_asset_cache = [];\n    _valid_cache_expiry = 0;\n\n    public get valid_assets() {\n        if (\n            this._valid_cache_expiry > Date.now() &&\n            this._valid_asset_cache.length\n        ) {\n            return this._valid_asset_cache;\n        }\n        const list = this.linked_bookings;\n        this._valid_asset_cache = (this.extension_data.assets || [])\n            .map((request) => new AssetRequest({ ...request, event: this }))\n            .filter((request) => request.deliver_at < this.date_end)\n            .map((request) => {\n                const booking = list.find(\n                    (_: any) => _.extension_data.request_id === request.id,\n                );\n                if (booking) {\n                    (request as any).state = booking.approved\n                        ? 'approved'\n                        : booking.rejected\n                          ? 'rejected'\n                          : 'pending';\n                }\n                return request;\n            });\n        this._valid_cache_expiry = addMinutes(Date.now(), 5).valueOf();\n        return this._valid_asset_cache;\n    }\n\n    constructor(data: Partial<BookingComplete> = {}) {\n        this.id = data.id || '';\n        this.parent_id = data.parent_id || '';\n        this.asset_id = data.asset_id || '';\n        this.asset_ids = data.asset_ids || [data.asset_id].filter((_) => _);\n        this.asset_name =\n            data.asset_name ||\n            data.extension_data?.asset_name ||\n            data.description ||\n            data.asset_id ||\n            '';\n        this.zones = data.zones || [];\n        this.booking_start =\n            Math.floor(data.date / 1000) ||\n            data.booking_start ||\n            getUnixTime(\n                roundToNearestMinutes(addMinutes(Date.now(), 5), {\n                    nearestTo: 5,\n                }),\n            );\n        this.booking_end =\n            Math.floor(data.date / 1000) + data.duration * 60 ||\n            data.booking_end ||\n            getUnixTime(\n                addMinutes(this.booking_start * 1000, data.duration || 60),\n            );\n        this.booking_type = data.booking_type || ' ';\n        this.type = data.type || data.booking_type || 'booking';\n        this.date = data.date || this.booking_start * 1000 || Date.now();\n        this.duration =\n            data.duration ||\n            Math.abs(\n                differenceInMinutes(\n                    this.booking_start * 1000,\n                    this.booking_end * 1000,\n                ),\n            ) ||\n            60;\n        this.date_end =\n            this.booking_end * 1000 || this.date + this.duration * 60 * 1000;\n        this.timezone =\n            data.timezone || Intl.DateTimeFormat().resolvedOptions().timeZone;\n        this.user_email = data.user_email || '';\n        this.user_id = data.user_id || '';\n        this.user_name = data.user_name || '';\n        this.title =\n            data.title ??\n            (this.booking_type\n                ? `${capitalizeFirstLetter(this.booking_type)} Booking`.trim()\n                : '');\n        this.description = data.description || '';\n        this.checked_in = !!data.checked_in;\n        this.rejected = !!data.rejected;\n        this.approved = !!data.approved;\n        this.deleted = !!data.deleted;\n        this.booked_by_id = data.booked_by_id || '';\n        this.booked_by_name = data.booked_by_name || '';\n        this.booked_by_email = data.booked_by_email || '';\n        this.approver_id = data.approver_id || '';\n        this.approver_email = data.approver_email || '';\n        this.approver_name = data.approver_name || '';\n        this.extension_data = data.extension_data || {};\n        this.access = !!data.extension_data?.access;\n        this.event_id = data.event_id;\n        this.permission = (data.permission || 'PRIVATE').toUpperCase() as any;\n        this.attendees = data.attendees || data.guests || data.members || [];\n        this.tags = data.tags || data.extension_data?.tags || [];\n        this.images = data.images || [];\n        this.all_day = data.all_day || this.duration >= 24 * 60;\n        this.induction = data.induction || undefined;\n        if (this.all_day) {\n            (this as any).date = startOfDay(this.date).getTime();\n            (this as any).duration = Math.max(\n                24 * 60 - 1,\n                this.duration - ((this.duration % 24) * 60 === 0 ? 1 : 0),\n            );\n            (this as any).date_end = endOfDay(\n                addMinutes(this.date, this.duration - 1).valueOf(),\n            ).getTime();\n        }\n        this.checked_out_at = data.checked_out_at;\n        this.checked_in_at = data.checked_in_at;\n        this.linked_event = data.linked_event || null;\n        this.linked_bookings = data.linked_bookings || [];\n        this.images = data.images || [];\n        this.status =\n            this.checked_out_at > 0\n                ? 'ended'\n                : this.rejected || this.deleted\n                  ? 'declined'\n                  : this.approved\n                    ? 'approved'\n                    : 'tentative';\n        this.process_state = data.process_state || 'pending';\n\n        this.recurrence_type = data.recurrence_type || 'none';\n        this.recurrence_days = data.recurrence_days;\n        this.recurrence_nth_of_month = data.recurrence_nth_of_month;\n        this.recurrence_interval = data.recurrence_interval;\n        this.recurrence_end = data.recurrence_end;\n        this.instance = data.instance;\n\n        for (const key in data) {\n            if (!(key in this) && !IGNORE_EXT_KEYS.includes(key) && data[key]) {\n                this.extension_data[key] =\n                    data[key] || this.extension_data[key];\n            }\n        }\n        this.extension_data.assets = (this.extension_data.assets || []).map(\n            (i) =>\n                new AssetRequest({ ...i, event: this, date: this.date } as any),\n        );\n        this.extension_data.tags = data.tags || [];\n        if (this.extension_data.request) {\n            this.extension_data.request = new AssetRequest({\n                ...this.extension_data.request,\n                event: this,\n                date: this.date,\n            } as any);\n        }\n    }\n\n    public toJSON(this: Booking): Partial<Booking> {\n        const data = { ...this };\n        if (!this.id) delete data.id;\n        data.extension_data.assets = data.extension_data.assets.map(\n            (i) => new AssetRequest({ ...i, event: null }),\n        );\n        if (data.extension_data.request) {\n            data.extension_data.request = new AssetRequest({\n                ...data.extension_data.request,\n                event: null,\n            });\n        }\n        if (!data.parent_id) delete data.parent_id;\n        data.zones = data.zones.filter((_) => _);\n        delete data.date;\n        delete data.duration;\n        removeEmptyFields(data);\n        return data;\n    }\n\n    public get location(): string {\n        return this.extension_data?.location || this.description;\n    }\n\n    /** Whether the booking occurs today */\n    public get is_today(): boolean {\n        return isSameDay(this.date, new Date());\n    }\n\n    /** Whether booking is done */\n    public get is_done(): boolean {\n        const start = new Date();\n        const end = this.all_day\n            ? addHours(this.date, 24)\n            : addMinutes(this.date, this.duration);\n        const checked_out =\n            (this.checked_out_at || this.extension_data.checked_out_at || 0) *\n            1000;\n        let end_time = end.getTime();\n        if (checked_out && Date.now() > checked_out) return true;\n        return isAfter(start, new Date(end_time));\n    }\n\n    /** Status of the booking */\n    public get state():\n        | 'future'\n        | 'upcoming'\n        | 'done'\n        | 'started'\n        | 'in_progress' {\n        const now = new Date();\n        const date = this.date;\n        if (isBefore(now, add(date, { minutes: -15 }))) return 'future';\n        if (isBefore(now, date)) return 'upcoming';\n        if (isBefore(now, add(date, { minutes: 15 }))) return 'started';\n        if (isBefore(now, add(date, { minutes: this.duration })))\n            return 'in_progress';\n        return 'done';\n    }\n}\n","import { del, get, patch, post, put, query } from '@placeos/ts-client';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\n\nimport { toQueryString } from 'libs/common/src/lib/api';\nimport { Booking, BookingType } from './booking.class';\nimport { GuestUser } from 'libs/users/src/lib/user.class';\nimport { addMinutes, getUnixTime } from 'date-fns';\nimport { CalendarEvent } from '@placeos/events';\nimport { BookableResource, flatten, unique } from '@placeos/common';\n\nexport interface BookingsQueryParams {\n    /** Comma seperated list of zone ids to check availability */\n    zones?: string;\n    /** User ID to filter bookings */\n    user?: string;\n    /** Email address to filter bookings */\n    email?: string;\n    /** Epoch in seconds for the start of the availability period */\n    period_start: number;\n    /** Epoch in seconds for the end of the availability period */\n    period_end: number;\n    /** Category of booking */\n    type: BookingType;\n    /** Include checked out bookings in the response */\n    include_checked_out?: boolean;\n    /** Include deleted bookings in the response (can be set to apply to only recurring bookings) */\n    include_deleted?: 'all' | 'recurring';\n    /** Include deleted bookings in the response */\n    deleted?: boolean;\n    /**  */\n    event_id?: string;\n    /**  */\n    booking_id?: string;\n    /**  */\n    ical_uid?: string;\n    /** Set the size of the page */\n    limit?: number;\n    /** Whether to also query rejected bookings */\n    rejected?: boolean;\n}\n\nconst BOOKINGS_ENDPOINT = `/api/staff/v1/bookings`;\n\n/**\n * Get a single page of bookings\n * @param q Parameters to pass to the API request\n */\nexport function queryBookings(q: BookingsQueryParams): Observable<Booking[]> {\n    const query = toQueryString(q);\n    return get(`${BOOKINGS_ENDPOINT}${query ? '?' + query : ''}`).pipe(\n        map((list) => list.map((item) => new Booking(item))),\n        catchError((_) => of([])),\n    );\n}\n\n/**\n * List resources that are booked within the given parameters\n * @param q Parameters to pass to the API request\n */\nexport function bookedResourceList(\n    q: BookingsQueryParams,\n): Observable<string[]> {\n    const query = toQueryString(q);\n    return get(`${BOOKINGS_ENDPOINT}/booked${query ? '?' + query : ''}`).pipe(\n        map((list) => list as string[]),\n        catchError((_) => of([])),\n    );\n}\n\n/**\n * List bookings with link to next page of bookings\n * @param q Parameters to pass to the API request\n */\nexport function queryPagedBookings(q: BookingsQueryParams) {\n    return query<Booking>({\n        query_params: q,\n        fn: (item) => new Booking(item),\n        endpoint: BOOKINGS_ENDPOINT,\n        path: '',\n    });\n}\n\n/**\n * List all bookings\n * @param q Parameters to pass to the API request\n */\nexport function queryAllBookings(\n    q: BookingsQueryParams,\n): Observable<Booking[]> {\n    return query<Booking>({\n        query_params: q,\n        fn: (item) => new Booking(item),\n        endpoint: BOOKINGS_ENDPOINT,\n        path: '',\n    }).pipe(\n        switchMap(async ({ data, next }) => {\n            let list = [...data];\n            while (next) {\n                const resp = await next().toPromise();\n                data = resp.data;\n                next = resp.next;\n                list = [...list, ...data];\n            }\n            return list;\n        }),\n        catchError((_) => of([])),\n    );\n}\n\n/**\n * Get booking details\n * @param id ID of the booking to grab\n * @param q Parameters to pass to the API request\n */\nexport function showBooking(id: string) {\n    return get(`${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}`).pipe(\n        map((item) => new Booking(item)),\n    );\n}\n\n/**\n * Create new booking and add it to the database\n * @param data New booking fields\n */\nexport function createBooking(\n    data: Partial<Booking>,\n    q?: { event_id?: string; ical_uid?: string },\n) {\n    const query = toQueryString(q);\n    return post(`${BOOKINGS_ENDPOINT}${query ? '?' + query : ''}`, data).pipe(\n        map((item) => new Booking(item)),\n    );\n}\n\n/**\n * Update an existing booking\n * @param id ID of the booking to update\n * @param data New values for booking fields\n * @param method HTTP verb to use with API request\n */\nexport function updateBooking(\n    id: string,\n    data: Partial<Booking>,\n    method: 'put' | 'patch' = 'patch',\n) {\n    return (method === 'patch' ? patch : put)(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}`,\n        data,\n    ).pipe(map((item) => new Booking(item)));\n}\n\n/**\n * Update the induction status of an existing booking\n * @param id ID of the booking to update\n * @param status New induction status of the booking\n */\nexport function updateBookingInductionStatus(\n    id: string,\n    status: 'tentative' | 'accepted' | 'declined',\n) {\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/update_induction?induction=${encodeURIComponent(status)}`,\n        {},\n    ).pipe(map((item) => new Booking(item)));\n}\n\n/**\n * Update instance of an existing booking series\n * @param id ID of the booking to update\n * @param start_time Unix seconds of the start time of the booking\n * @param data New values for booking fields\n * @param method HTTP verb to use with API request\n */\nexport function updateBookingInstance(\n    id: string,\n    start_time: number,\n    data: Partial<Booking>,\n    method: 'put' | 'patch' = 'patch',\n) {\n    return (method === 'patch' ? patch : put)(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/instance/${start_time}`,\n        data,\n    ).pipe(map((item) => new Booking(item)));\n}\n\n/**\n * Save changes to or create a booking\n * @param data State of the booking\n * @param q Parameters to pass to the API request\n */\nexport const saveBooking = (\n    data: Partial<Booking>,\n    q?: {\n        booking_id?: string;\n        event_id?: string;\n        ical_uid?: string;\n        instance?: number;\n    },\n) => {\n    const id = data.id;\n    delete (data as any).id;\n    const instance = q?.instance;\n    if (q) delete (q as any).instance;\n    return id\n        ? instance\n            ? updateBookingInstance(id, data.instance, data)\n            : updateBooking(id, data)\n        : createBooking(data, q);\n};\n\n/**\n * Remove booking from the database\n * @param id ID of the booking to remove\n */\nexport function removeBooking(id: string, q: any = {}) {\n    if (q.instance) {\n        return removeBookingInstance(id, q.start_time);\n    }\n    return del(`${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}`, {\n        response_type: 'void',\n    });\n}\n\n/**\n * Remove instance of an existing booking series\n * @param id ID of the booking to update\n * @param start_time Unix seconds of the start time of the booking\n */\nexport function removeBookingInstance(id: string, start_time: number) {\n    return del(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/instance/${start_time}`,\n        {\n            response_type: 'void',\n        },\n    );\n}\n\n/**\n * Set the approval state of the booking to `approved`\n * @param id ID of the booking to approve\n * @param system_id Associated system to approve\n */\nexport function approveBooking(id: string) {\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/approve`,\n        '',\n    ).pipe(map((item) => new Booking(item)));\n}\n\n/**\n * Set the approval state of the booking instance to `approved`\n * @param id ID of the booking to reject\n * @param start_time Start time of the booking instance\n */\nexport function approveBookingInstance(id: string, start_time: number) {\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/approve`,\n        '',\n    ).pipe(map((item) => new Booking(item)));\n}\n\n/**\n * Set the approval state of the booking to `rejected`\n * @param id ID of the booking to reject\n * @param system_id Associated system to reject\n */\nexport function rejectBooking(id: string) {\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/reject`,\n        '',\n    ).pipe(map((item) => new Booking(item)));\n}\n\n/**\n * Set the approval state of the booking instance to `rejected`\n * @param id ID of the booking to reject\n * @param start_time Start time of the booking instance\n */\nexport function rejectBookingInstance(id: string, start_time: number) {\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/reject`,\n        '',\n    ).pipe(map((item) => new Booking(item)));\n}\n\nexport function setBookingState(\n    id: string,\n    state: string,\n    utm_source?: string,\n) {\n    const query = toQueryString({ state, utm_source });\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/update_state${\n            query ? '?' + query : ''\n        }`,\n        {},\n    ).pipe(map((item) => new Booking(item)));\n}\n\n/**\n * List the guests in a booking\n * @param id ID of the booking to reject\n */\nexport function queryBookingGuests(id: string) {\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/guests`,\n        '',\n    ).pipe(map((item) => new GuestUser(item)));\n}\n\n/**\n * Set the checkin state of a guest in a booking\n * @param id ID of the booking to reject\n * @param guest_id ID of the guest to check in\n */\nexport function checkinBookingGuest(\n    id: string,\n    guest_id: string,\n    state: boolean = true,\n) {\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(\n            id,\n        )}/guests/${encodeURIComponent(guest_id)}/check_in?state=${state}`,\n        '',\n    ).pipe(map((item) => new GuestUser(item)));\n}\n\n/**\n * Add a guest to a booking\n * @param id ID of the booking\n * @param guest Guest to add to the booking\n */\nexport function bookingAddGuest(id: string, guest: GuestUser) {\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/attendee`,\n        guest,\n    ).pipe(map((item) => new GuestUser(item)));\n}\n\n/**\n * Remove an attendee from a booking\n * @param id ID of the booking\n * @param guest Guest to remove from the booking\n */\nexport function bookingRemoveGuest(id: string, guest: GuestUser) {\n    return del(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(\n            id,\n        )}/attendee/${encodeURIComponent(guest.email)}`,\n    ).pipe(map((item) => new GuestUser(item)));\n}\n\n/**\n * Set the checkin state of a booking\n * @param id ID of the booking to grab\n * @param state New checkin state of the booking\n */\nexport function checkinBooking(id: string, state: boolean) {\n    const query = toQueryString({ state });\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/check_in?${query}`,\n        '',\n    ).pipe(\n        map((item) => new Booking(item)),\n        catchError(async (e) => {\n            const body = await e.json();\n            throw body.error || body.message || body;\n        }),\n    );\n}\n\n/**\n * Set the checkin state of a booking instance\n * @param id ID of the booking to grab\n * @param start_time Start time of the booking instance\n * @param state New checkin state of the booking instance\n */\nexport function checkinBookingInstance(\n    id: string,\n    start_time: number,\n    state: boolean,\n) {\n    const query = toQueryString({ state });\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(id)}/check_in/${start_time}?${query}`,\n        '',\n    ).pipe(\n        map((item) => new Booking(item)),\n        catchError(async (e) => {\n            const body = await e.json();\n            throw body.error || body.message || body;\n        }),\n    );\n}\n\n/**\n * Set the checkin state of a booking\n * @param id ID of the booking to grab\n * @param state New checkin state of the booking\n */\nexport function checkinBookingAttendee(\n    id: string,\n    email: string,\n    state: boolean,\n) {\n    const query = toQueryString({ state });\n    return post(\n        `${BOOKINGS_ENDPOINT}/${encodeURIComponent(\n            id,\n        )}/guests/${encodeURIComponent(email)}/check_in?${query}`,\n        '',\n    ).pipe(map((item) => new GuestUser(item)));\n}\n\n/**\n * Filter list of resources based of the bookings found in the given query\n * @param asset_id_list List of resource IDs\n * @param query Booking query\n */\nexport function queryResourceAvailability(\n    id_list: string[],\n    start: number,\n    duration: number,\n    ignore?: string,\n    type: BookingType = 'room',\n    ignore_period: [number, number] = [0, 0],\n): Observable<boolean[]> {\n    return queryBookings({\n        type,\n        period_start: getUnixTime(start),\n        period_end: getUnixTime(addMinutes(start, duration)),\n    }).pipe(\n        map((_) =>\n            id_list.map(\n                (id) =>\n                    !_.find(\n                        (b) =>\n                            b.asset_id === id && (!ignore || ignore !== b.id),\n                    ),\n            ),\n        ),\n    );\n}\n\nexport function isResourceAvailable(\n    id: string,\n    start: number,\n    duration: number,\n    ignore?: string,\n    type: BookingType = 'room',\n) {\n    return queryBookings({\n        type,\n        period_start: getUnixTime(start),\n        period_end: getUnixTime(addMinutes(start, duration)),\n    }).pipe(\n        map(\n            (_) =>\n                _.filter((_) => _.asset_id === id && _.id !== ignore).length ===\n                0,\n        ),\n    );\n}\n\n/**\n *\n * @param event\n * @param type\n * @param resources\n */\nexport async function createBookingsForEvent(\n    event: CalendarEvent,\n    type: BookingType,\n    resources: BookableResource,\n) {\n    const bookings = await queryBookings({\n        type,\n        period_start: getUnixTime(event.date),\n        period_end: getUnixTime(addMinutes(event.date, event.duration)),\n    })\n        .pipe(map((_) => _.filter((_) => _.parent_id === event.id)))\n        .toPromise();\n    await Promise.all(bookings.map((_) => removeBooking(_.id).toPromise()));\n    await Promise.all(\n        event.linked_bookings\n            .filter((_) => _.booking_type === type)\n            .map((_) => removeBooking(_.id).toPromise()),\n    );\n    const zones =\n        (event.system?.zones as any) ||\n        unique(flatten(event.resources.map((_) => _.zones))) ||\n        [];\n    await Promise.all(\n        resources.map((item) => {\n            const booking = bookings.find((_) =>\n                _.asset_ids.find((id) =>\n                    item.items?.find((i) => i.item_ids.includes(id)),\n                ),\n            );\n            return createBooking(\n                new Booking({\n                    type,\n                    booking_type: type,\n                    date: event.date,\n                    duration: event.duration,\n                    description: event.title,\n                    user_email: event.host,\n                    asset_id: item.email,\n                    asset_name: (item as any).name,\n                    title: (item as any).name,\n                    attendees: [item],\n                    approved: booking?.approved && !item._changed,\n                    rejected: booking?.rejected && !item._changed,\n                    extension_data: {\n                        parent_id: event.id,\n                        name: (item as any).name,\n                        location_id: event.location,\n                    },\n                    zones,\n                }),\n                { ical_uid: event.ical_uid, event_id: event.id },\n            ).toPromise();\n        }),\n    );\n}\n","import { differenceInMinutes } from 'date-fns';\n\nimport { Space } from 'libs/spaces/src/lib/space.class';\n\nimport { CalendarAvailability } from './calendar.interfaces';\n\nexport class Calendar {\n    /** ID of the calendar */\n    public readonly id: string;\n    /** Name of the calendar */\n    public readonly name: string;\n    /** System associated with the calendar */\n    public readonly resource: Space;\n    /** Primary calendar of the user */\n    public readonly primary: boolean;\n    /** Summary */\n    public readonly summary: string;\n    /** Whether the user can edit events associated to this calendar */\n    public readonly can_edit: boolean;\n    /** Availability */\n    public readonly availability: CalendarAvailability[];\n    /** Whether calendar should be hidden from the user */\n    public readonly hidden: boolean;\n\n    constructor(data: Partial<Calendar> = {}) {\n        this.id = data.id || '';\n        this.name = data.name || '';\n        this.primary = !!data.primary;\n        this.summary = data.summary || '';\n        this.can_edit = !!data.can_edit;\n        this.resource = new Space(data.resource || (data as any).system);\n        this.availability = (data.availability || []).map(\n            ({ starts_at, ends_at, date, duration, status }: any) => {\n                return {\n                    date: new Date(date || starts_at * 1000).valueOf(),\n                    duration:\n                        duration ||\n                        differenceInMinutes(ends_at * 1000, starts_at * 1000),\n                    status: status,\n                };\n            }\n        );\n        this.hidden = !!data.hidden;\n    }\n}\n","import { get } from '@placeos/ts-client';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { toQueryString } from '@placeos/common';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\n\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport { Calendar } from './calendar.class';\nimport { CalendarAvailabilityQueryParams } from './calendar.interfaces';\n\nconst CALENDAR_ENDPOINT = '/api/staff/v1/calendars';\n\n/** List calendars associated with the logged in user */\nexport function queryCalendars(): Observable<Calendar[]> {\n    return get(CALENDAR_ENDPOINT).pipe(\n        map((i) => i.map((c) => new Calendar(c)))\n    );\n}\n\n/** List room calendars for available spaces based on the given query */\nexport function queryCalendarAvailability(\n    q: CalendarAvailabilityQueryParams\n): Observable<Calendar[]> {\n    const query = toQueryString(q);\n    return get(\n        `${CALENDAR_ENDPOINT}/availability${query ? '?' + query : ''}`\n    ).pipe(map((i) => i.map((c) => new Calendar(c))));\n}\n\nconst calendarsToSpaces = (org?) =>\n    map((list: Calendar[]) =>\n        list\n            .filter((cal) => !!cal.resource)\n            .map(\n                (cal) =>\n                    new Space({\n                        ...cal.resource,\n                        level: org?.levelWithID(cal.resource.zones),\n                        availability: cal.availability,\n                    })\n            )\n            .filter((space) => space.bookable)\n    );\n\n/** List available spaces based on the given query */\nexport function querySpaceCalendarAvailability(\n    q: CalendarAvailabilityQueryParams,\n    org?: OrganisationService\n): Observable<Space[]> {\n    return queryCalendarAvailability(q).pipe(calendarsToSpaces(org));\n}\n\nexport function queryUserFreeBusy(q: CalendarAvailabilityQueryParams) {\n    const query = toQueryString(q);\n    return get(\n        `${CALENDAR_ENDPOINT}/free_busy${query ? '?' + query : ''}`\n    ).pipe(map((i) => i as Calendar[]));\n}\n\n/** List room calendars for available spaces based on the given query */\nexport function querySpaceFreeBusy(\n    q: CalendarAvailabilityQueryParams,\n    org?: OrganisationService\n): Observable<Space[]> {\n    const query = toQueryString(q);\n    return get(\n        `${CALENDAR_ENDPOINT}/free_busy${query ? '?' + query : ''}`\n    ).pipe(\n        map((i) => i.map((c) => new Calendar(c))),\n        calendarsToSpaces(org)\n    );\n}\n","import { del, get, patch, post, put, query } from '@placeos/ts-client';\nimport { Observable, combineLatest, of } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\n\nimport { toQueryString } from 'libs/common/src/lib/api';\nimport { GuestUser } from 'libs/users/src/lib/user.class';\n\nimport { CalendarEvent } from './event.class';\nimport { addMinutes, getUnixTime } from 'date-fns';\nimport {\n    queryCalendarAvailability,\n    querySpaceFreeBusy,\n} from 'libs/calendar/src/lib/calendar.fn';\nimport { EventExtensionData } from './event.interfaces';\n\nexport interface CalendarEventQueryParams {\n    /** Comma seperated list of zone ids to check availability */\n    zone_ids?: string;\n    /** Comma seperated list of system(space) ids to check availability */\n    system_ids?: string;\n    /** Comma seperated list of calendar ids to check availability */\n    calendars?: string;\n    /** Epoch in seconds for the start of the availability period */\n    period_start: number;\n    /** Epoch in seconds for the end of the availability period */\n    period_end: number;\n    /** Whether to include cancelled events in the returned list */\n    include_cancelled?: boolean;\n    /** ical UID associated with the booking */\n    ical_uid?: string;\n    limit?: number;\n    strict?: 'limit' | 'all' | 'notify';\n}\n\nexport interface CalendarEventShowParams {\n    /** ID of the personal calendar to grab the events details from */\n    calendar?: string;\n    /** ID of the system/space to get the associated calendar ID */\n    system_id?: string;\n}\n\nconst EVENTS_ENDPOINT = `/api/staff/v1/events`;\n\n/**\n * List events\n * @param q Parameters to pass to the API request\n */\nexport function queryEvents(\n    q: CalendarEventQueryParams,\n): Observable<CalendarEvent[]> {\n    const query = toQueryString(q);\n    return get(`${EVENTS_ENDPOINT}${query ? '?' + query : ''}`).pipe(\n        map((list) => list.map((e) => new CalendarEvent(e))),\n        catchError((_) => of([])),\n    );\n}\n\nexport function queryAllEvents(\n    q: CalendarEventQueryParams,\n): Observable<CalendarEvent[]> {\n    return query<CalendarEvent>({\n        query_params: q,\n        fn: (item) => new CalendarEvent(item),\n        endpoint: EVENTS_ENDPOINT,\n        path: '',\n    }).pipe(\n        switchMap(async ({ data, next }) => {\n            let list = [...data];\n            while (next) {\n                const resp = await next().toPromise();\n                data = resp.data;\n                next = resp.next;\n                list = [...list, ...data];\n            }\n            return list;\n        }),\n        catchError((_) => of([])),\n    );\n}\n\n/**\n * Get event details\n * @param id ID of the event to grab\n * @param q Parameters to pass to the API request\n */\nexport function showEvent(id: string, q: CalendarEventShowParams = {}) {\n    const query = toQueryString(q);\n    return get(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(id)}${\n            query ? '?' + query : ''\n        }`,\n    ).pipe(map((item) => new CalendarEvent(item)));\n}\n\n/**\n * Create new calendar event and add it to the database\n * @param data New calendar event fields\n */\nexport function createEvent(data: Partial<CalendarEvent>) {\n    return post(`${EVENTS_ENDPOINT}`, new CalendarEvent(data).toJSON()).pipe(\n        map((item) => new CalendarEvent(item)),\n    );\n}\n\n/**\n * Update an existing calendar event\n * @param id ID of the event to update\n * @param data New values for event fields\n * @param q Parameters to pass to the API request\n * @param method HTTP verb to use with API request\n */\nexport function updateEvent(\n    id: string,\n    data: Partial<CalendarEvent>,\n    q: CalendarEventShowParams = {},\n    method: 'put' | 'patch' = 'patch',\n) {\n    const query = toQueryString(q);\n    return (method === 'patch' ? patch : put)(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(id)}${\n            query ? '?' + query : ''\n        }`,\n        new CalendarEvent(data).toJSON(),\n    ).pipe(map((item) => new CalendarEvent(item)));\n}\n\n/**\n * Save changes to or create a calendar event\n * @param data State of the calendar event\n * @param q Parameters to pass to the API request\n */\nexport const saveEvent = (\n    data: Partial<CalendarEvent>,\n    q?: CalendarEventShowParams,\n) => {\n    const id = data.update_master\n        ? data.recurring_event_id || data.id\n        : data.id;\n    delete (data as any)?.status;\n    return id ? updateEvent(id, { ...data, id }, q) : createEvent(data);\n};\n\n/**\n * Remove calendar event from the database\n * @param id ID of the event to remove\n * @param q Parameters to pass to the API request\n */\nexport function removeEvent(id: string, q: CalendarEventShowParams = {}) {\n    const query = toQueryString(q);\n    return del(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(id)}${\n            query ? '?' + query : ''\n        }`,\n        {\n            response_type: 'void',\n        },\n    );\n}\n\n/**\n * Set the approval state of the event to approved\n * @param id ID of the event to approve\n * @param system_id Associated system to approve\n */\nexport function approveEvent(id: string, system_id: string) {\n    return post(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(\n            id,\n        )}/approve?system_id=${encodeURIComponent(system_id)}`,\n        '',\n    ).pipe(map((item) => new CalendarEvent(item)));\n}\n\n/**\n * Set the approval state of the event to rejected\n * @param id ID of the event to reject\n * @param system_id Associated system to reject\n */\nexport function rejectEvent(id: string, system_id: string) {\n    return post(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(\n            id,\n        )}/reject?system_id=${encodeURIComponent(system_id)}`,\n        '',\n    ).pipe(map((item) => new CalendarEvent(item)));\n}\n\n/**\n * Decline the given event\n * @param id ID of the event to decline\n * @returns\n */\nexport function declineEvent(id: string, query: CalendarEventShowParams = {}) {\n    const q = toQueryString(query);\n    return post(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(id)}/decline${\n            q ? '?' + q : ''\n        }`,\n        '',\n    ).pipe(map((item) => new CalendarEvent(item)));\n}\n\n/**\n * List guests for event\n * @param id ID of the event to grab\n * @param q Parameters to pass to the API request\n */\nexport function queryEventGuests(\n    id: string,\n    q: CalendarEventShowParams = {},\n): Observable<GuestUser[]> {\n    const query = toQueryString(q);\n    return get(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(id)}/guests${\n            query ? '?' + query : ''\n        }`,\n    ).pipe(map((list) => list.map((item) => new GuestUser(item))));\n}\n\n/**\n * Set the checkin state of an event guest\n * @param id ID of the event to grab\n * @param guest_id ID of the guest to update\n * @param state New checkin state of the guest\n * @param q Parameters to pass to the API request\n */\nexport function checkinEventGuest(\n    id: string,\n    guest_id: string,\n    state: boolean,\n    q: CalendarEventShowParams = {},\n) {\n    const query = toQueryString({ ...q, state });\n    return post(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(\n            id,\n        )}/guests/${guest_id}/checkin${query ? '?' + query : ''}`,\n        '',\n    ).pipe(map((item) => new GuestUser(item)));\n}\n\n/**\n * Add a guest to a booking\n * @param id ID of the booking\n * @param guest Guest to add to the booking\n */\nexport function addEventGuest(\n    id: string,\n    guest: GuestUser,\n    q: CalendarEventShowParams = {},\n) {\n    const query = toQueryString(q);\n    return post(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(id)}/attendee${query ? '?' + query : ''}`,\n        guest,\n    ).pipe(map((item) => new GuestUser(item)));\n}\n\n/**\n * Remove an attendee from a booking\n * @param id ID of the booking\n * @param guest Guest to remove from the booking\n */\nexport function removeEventGuest(\n    id: string,\n    guest: GuestUser,\n    q: CalendarEventShowParams = {},\n) {\n    const query = toQueryString(q);\n    return del(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(\n            id,\n        )}/attendee/${encodeURIComponent(guest.email)}${query ? '?' + query : ''}`,\n    ).pipe(map((item) => new GuestUser(item)));\n}\n\n/**\n * Get the extension data for an event\n * @param id ID of the event\n * @param system_id  ID of the system associated with the event\n * @param query Extra query parameters to pass to the API request\n */\nexport function getEventMetadata(\n    id: string,\n    system_id: string,\n    query: { ical_uid?: string } = {},\n) {\n    const q = toQueryString({ ...query });\n    return get(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(\n            id,\n        )}/metadata/${encodeURIComponent(system_id)}${q ? '?' + q : ''}`,\n    ).pipe(map((item) => item as EventExtensionData));\n}\n\n/**\n * Update the extension data for an event\n * @param id ID of the event\n * @param system_id ID of the system associated with the event\n * @param metadata New metadata value to merge to exisiting\n * @param query Extra query parameters to pass to the API request\n */\nexport function updateEventMetadata(\n    id: string,\n    system_id: string,\n    metadata: Partial<EventExtensionData>,\n    query: { ical_uid?: string } = {},\n) {\n    const q = toQueryString({ ...query });\n    return patch(\n        `${EVENTS_ENDPOINT}/${encodeURIComponent(\n            id,\n        )}/metadata/${encodeURIComponent(system_id)}${q ? '?' + q : ''}`,\n        metadata,\n    ).pipe(map((item) => item as EventExtensionData));\n}\n\n/**\n * Check whether a selected space is available\n * @param id ID of the space to check\n * @param start Start of the availability period to check\n * @param duration Duration of the availability block in minutes\n * @param ignore ID of a booking to ignore when checking availability\n */\nexport function isSpaceAvailable(\n    id: string,\n    start: number,\n    duration: number,\n    ignore?: string,\n) {\n    return queryEvents({\n        system_ids: id,\n        period_start: getUnixTime(start),\n        period_end: getUnixTime(addMinutes(start, duration)),\n    }).pipe(map((_) => _.filter((_) => _.id !== ignore).length === 0));\n}\n\n/**\n * Check whether a list of spaces are available\n * @param id_list List of space IDs to check\n * @param start Start of the availability period to check\n * @param duration Duration of the availability block in minutes\n * @param ignore ID of a booking to ignore when checking availability\n */\nexport function querySpaceAvailability(\n    id_list: string[],\n    start: number,\n    duration: number,\n    ignore?: string,\n    type?: any,\n    ignore_period: [number, number] = [0, 0],\n) {\n    const end = addMinutes(start, duration).valueOf();\n    return combineLatest([\n        queryCalendarAvailability({\n            system_ids: id_list.join(),\n            period_start: getUnixTime(start),\n            period_end: getUnixTime(end),\n        }).pipe(catchError((_) => of([]))),\n        ignore && id_list.includes(ignore)\n            ? querySpaceFreeBusy({\n                  period_start: getUnixTime(start),\n                  period_end: getUnixTime(end),\n                  system_ids: ignore,\n              })\n            : of([]),\n    ]).pipe(\n        map(([spaces, ignore_check]) => {\n            const short_list = id_list.map(\n                (id) =>\n                    !!spaces.find(\n                        (s) => s.id === id || (s as any).resource?.id === id,\n                    ),\n            );\n            for (const space of ignore_check) {\n                if (!id_list.includes(space.id)) continue;\n                const availability = space.availability.filter(\n                    (i) =>\n                        !(\n                            i.date === ignore_period[0] &&\n                            i.duration === ignore_period[1]\n                        ),\n                );\n                short_list[id_list.indexOf(space.id)] = !availability.find(\n                    (i) => i.status !== 'free',\n                );\n            }\n            return short_list;\n        }),\n    );\n}\n","import { AbstractControl } from '@angular/forms';\nimport { addMinutes, isAfter, isBefore } from 'date-fns';\n\nexport const endInFuture = (control: AbstractControl) => {\n    const date = control.parent?.get('date');\n    if (date && isAfter(Date.now(), addMinutes(date.value, control.value))) {\n        return { duration: true };\n    }\n    return null;\n};\n\n/** Check that date in unix ms is in the future */\nexport function isFuture(\n    control: AbstractControl\n): { [key: string]: boolean } | null {\n    return control.value && isBefore(control.value, new Date())\n        ? { is_future: true }\n        : null;\n}\n","import {\n    FormGroup,\n    FormControl,\n    Validators,\n    AbstractControl,\n} from '@angular/forms';\nimport {\n    add,\n    formatDuration,\n    differenceInMinutes,\n    getTime,\n    isSameDay,\n    format,\n    startOfMinute,\n    setHours,\n    setMinutes,\n    addMinutes,\n    roundToNearestMinutes,\n    startOfDay,\n} from 'date-fns';\nimport {\n    LOCAL_TIMEZONE,\n    SettingsService,\n    currentUser,\n    timePeriodsIntersect,\n    unique,\n} from '@placeos/common';\n\nimport { CalendarEvent } from './event.class';\nimport { endInFuture } from './validators';\nimport { getNextFreeTimeSlot } from './helpers';\nimport { User } from 'libs/users/src/lib/user.class';\nimport { Booking } from 'libs/bookings/src/lib/booking.class';\nimport { time } from 'console';\nimport { share } from 'rxjs/operators';\n\nlet BOOKING_DATE = add(setMinutes(setHours(new Date(), 6), 0), { days: -1 });\n\nconst validateCateringField =\n    (catering_control: AbstractControl) => (control: AbstractControl) => {\n        if (catering_control.value?.length && !control.value) {\n            return { catering_field: 'Catering sub-fields are required' };\n        }\n        return null;\n    };\n\nexport function generateEventForm(\n    event: CalendarEvent = new CalendarEvent(),\n    settings?: SettingsService,\n) {\n    if (!event) event = new CalendarEvent();\n    const form = new FormGroup({\n        id: new FormControl(event.id),\n        ical_uid: new FormControl(event.ical_uid),\n        host: new FormControl(\n            event.host || event.organiser?.email || currentUser()?.email || '',\n            [Validators.required],\n        ),\n        organiser: new FormControl(\n            event.organiser || new User({ email: event.host || '' }),\n        ),\n        creator: new FormControl(event.creator || currentUser()?.email),\n        calendar: new FormControl(event.calendar),\n        attendees: new FormControl(event.attendees || []),\n        resources: new FormControl(event.resources || []),\n        title: new FormControl(event.title),\n        body: new FormControl(event.body),\n        private: new FormControl(event.private),\n        date: new FormControl(event.date, [Validators.required]),\n        duration: new FormControl(event.duration, [endInFuture]),\n        all_day: new FormControl(event.all_day),\n        date_end: new FormControl(event.date_end),\n        recurring: new FormControl(event.recurring),\n        recurrence: new FormControl(event.recurrence),\n        recurring_event_id: new FormControl(event.recurring_event_id),\n        master: new FormControl(event.master),\n        attachments: new FormControl(event.attachments),\n        catering: new FormControl(event.extension_data?.catering as any),\n        catering_notes: new FormControl(\n            event.extension_data?.catering[0]?.notes || '',\n        ),\n        catering_charge_code: new FormControl(\n            event.extension_data?.catering[0]?.charge_code || '',\n        ),\n        setup_time: new FormControl(event.setup_time || 0),\n        breakdown_time: new FormControl(event.breakdown_time || 0),\n        assets: new FormControl(event.extension_data?.assets),\n        // has_catering: new FormControl(event.has_catering || false),\n        visitor_type: new FormControl(event.extension_data?.visitor_type),\n        location: new FormControl(event.location),\n        needs_space: new FormControl(true),\n        needs_parking: new FormControl(\n            event.extension_data?.needs_parking || false,\n        ),\n        event_type: new FormControl(event.extension_data?.event_type || ''),\n        category: new FormControl(event.extension_data?.category || ''),\n        tags: new FormControl(event.extension_data?.tags || []),\n        update_master: new FormControl(false),\n        system: new FormControl<any>(event.system),\n        attendance_type: new FormControl(\n            event.extension_data?.attendance_type || 'ONSITE',\n        ),\n        timezone: new FormControl(event.timezone || LOCAL_TIMEZONE),\n        shared_event: new FormControl(\n            event.extension_data?.shared_event || false,\n        ),\n        view_access: new FormControl(\n            event.extension_data?.view_access || 'PRIVATE',\n        ),\n        images: new FormControl(event.extension_data?.images || []),\n        featured: new FormControl(event.extension_data?.featured || false),\n    });\n    form.get('organiser').valueChanges.subscribe((o) =>\n        form.controls.host.setValue(o?.email),\n    );\n    form.get('resources').valueChanges.subscribe((l) => {\n        form.controls.system.setValue(l?.length ? (l[0] as any) : null);\n        form.controls.assets[l?.length ? 'enable' : 'disable']();\n    });\n    const setCateringTime = () => {\n        if (!form.value.catering?.length || !form.getRawValue().date) return;\n        form.patchValue(\n            {\n                catering: form.value.catering.map((order: any) => ({\n                    ...order,\n                    event: {\n                        date: form.value.all_day\n                            ? startOfDay(form.getRawValue().date)\n                            : form.getRawValue().date,\n                        duration: form.value.all_day\n                            ? 24 * 60\n                            : form.value.duration,\n                    },\n                })),\n            },\n            { emitEvent: false },\n        );\n    };\n    form.valueChanges.subscribe((v) => {\n        if (form.getRawValue().date < Date.now() && form.value.id) {\n            form.get('date')?.disable({ emitEvent: false });\n        } else {\n            form.get('date')?.enable({ emitEvent: false });\n        }\n        if (v.date || v.duration || v.all_day) setCateringTime();\n    });\n    form.controls.duration.valueChanges.subscribe((duration) => {\n        form.patchValue(\n            {\n                date_end: roundToNearestMinutes(\n                    addMinutes(form.getRawValue().date, duration),\n                    { nearestTo: 5, roundingMethod: 'ceil' },\n                ).valueOf(),\n            },\n            { emitEvent: false },\n        );\n        setCateringTime();\n    });\n    form.controls.date_end.valueChanges.subscribe((date) => {\n        if (date < addMinutes(form.getRawValue().date, 30).valueOf()) {\n            form.patchValue(\n                {\n                    date_end: roundToNearestMinutes(\n                        addMinutes(form.getRawValue().date, 30),\n                        { nearestTo: 5, roundingMethod: 'ceil' },\n                    ).valueOf(),\n                    duration: 30,\n                },\n                { emitEvent: false },\n            );\n        } else {\n            form.patchValue(\n                {\n                    duration: differenceInMinutes(\n                        date,\n                        form.getRawValue().date,\n                    ),\n                },\n                { emitEvent: false },\n            );\n        }\n        setCateringTime();\n    });\n    form.controls.date.valueChanges.subscribe((date) => {\n        form.patchValue(\n            {\n                date_end: roundToNearestMinutes(\n                    addMinutes(date, form.value.duration),\n                    { nearestTo: 5, roundingMethod: 'ceil' },\n                ).valueOf(),\n            },\n            { emitEvent: false },\n        );\n        if (date < Date.now() && !form.value.id) {\n            form.patchValue(\n                {\n                    date: roundToNearestMinutes(Date.now(), {\n                        nearestTo: 5,\n                        roundingMethod: 'ceil',\n                    }).valueOf(),\n                },\n                { emitEvent: false },\n            );\n        }\n        if (\n            form.value.recurrence?._pattern !== 'custom_display' &&\n            form.value.recurrence?._pattern !== 'none'\n        ) {\n            form.patchValue({\n                recurrence: {\n                    ...form.value.recurrence,\n                    days_of_week: [new Date(date).getDay()],\n                },\n            });\n        }\n        setCateringTime();\n    });\n    form.controls.catering.valueChanges.subscribe((_) => {\n        const catering = form.getRawValue().catering || [];\n        if (\n            catering?.length &&\n            (settings?.get('app.events.catering_notes_required') ||\n                settings.value('require_catering_notes'))\n        ) {\n            form.get('catering_notes')?.setValidators([Validators.required]);\n            form.get('catering_notes').patchValue(form.value.catering_notes);\n        } else {\n            form.get('catering_notes')?.clearValidators();\n            form.get('catering_notes').setErrors(null);\n        }\n        form.updateValueAndValidity();\n    });\n    form.get('catering_charge_code').setValidators([\n        validateCateringField(form.get('catering')),\n    ]);\n    if (event.id) {\n        form.get('host').disable();\n        form.get('organiser').disable();\n    }\n    if (event.state === 'started') form.get('date').disable();\n    return form;\n}\n\n/**\n * Set the initial time used for generating mock bookings\n * @param time New initial time as ms from UTC epoch\n */\nexport function setMockBookingStartDatetime(time: number) {\n    BOOKING_DATE = startOfMinute(new Date(time));\n}\n\n/**\n * Get current status within bookings\n * @param bookings List of bookings\n * @param host Host of the new event\n * @param date Datetime of the new event\n */\nexport function statusFromBookings(\n    bookings: CalendarEvent[],\n    bookable: boolean,\n    requestable: boolean,\n    date: number = getTime(new Date()),\n) {\n    const now = new Date(date);\n    const next_free_slot = getNextFreeTimeSlot(bookings, date, 5);\n    const start = new Date(next_free_slot.start);\n    const end = new Date(next_free_slot.end);\n    const currently_free = timePeriodsIntersect(\n        date,\n        date,\n        next_free_slot.start,\n        next_free_slot.end,\n    );\n    const time_until_next_block = formatDuration({\n        minutes: currently_free\n            ? differenceInMinutes(end, now)\n            : differenceInMinutes(start, now),\n    });\n    const free_tomorrow = !currently_free && !isSameDay(start, now);\n    const free_today = currently_free && !isSameDay(end, now);\n    return {\n        status: !bookable\n            ? 'Not Bookable'\n            : currently_free\n              ? requestable\n                  ? 'Available by Request'\n                  : 'Available'\n              : 'Meeting in Progress',\n        available_until: free_today\n            ? 'No meetings today'\n            : currently_free\n              ? `Free until ${format(end, 'h:mm B')}(${time_until_next_block})`\n              : free_tomorrow\n                ? 'Unavailable today'\n                : `Free at ${format(start, 'h:mm B')}(${time_until_next_block})`,\n    };\n}\n\nexport function replaceBookings(\n    list: CalendarEvent[],\n    new_bookings: CalendarEvent[],\n    filter_options: { space: string; from: number; to: number },\n) {\n    const from = filter_options.from;\n    const to = filter_options.to;\n    const filtered_list = list.filter((booking) => {\n        const start = new Date(booking.date);\n        const end = addMinutes(start, booking.duration);\n        return (\n            !booking.resources?.find(\n                (space) => space.email === filter_options.space,\n            ) || !timePeriodsIntersect(from, to, start.valueOf(), end.valueOf())\n        );\n    });\n    const updated_list = filtered_list.concat(new_bookings);\n    updated_list.sort((a, b) => a.date - b.date);\n    return unique(updated_list, 'id');\n}\n\nexport function newCalendarEventFromBooking(booking: Booking) {\n    let attendees = [\n        {\n            id: booking.user_id,\n            name: booking.user_name,\n            email: booking.user_email,\n            organizer: true,\n        },\n    ];\n    if (booking.booking_type === 'visitor') {\n        attendees.push(\n            new User({\n                name: booking.asset_name || booking.description,\n                email: booking.asset_id,\n                checked_in: booking.checked_in,\n            }),\n        );\n    }\n    attendees = attendees.concat(booking.attendees);\n    return new CalendarEvent({\n        ...booking,\n        ...booking.extension_data,\n        attendees,\n        id: booking.id || booking.extension_data.id,\n        host: booking.user_email,\n        from_bookings: true,\n    } as any);\n}\n","import { Component, EventEmitter, Inject, Output } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { Observable } from 'rxjs';\n\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { PaymentCardDetails } from './card-input-field.component';\n\nexport interface PaymentData {\n    type: string; // Resource Type\n    resource_name: string;\n    date: number;\n    duration: number;\n    all_day: boolean;\n    has_payment_method: boolean;\n    rate: string;\n    amount: number; // Number in cents\n    loading: Observable<string>;\n    makePayment: (_?: PaymentCardDetails) => Promise<void>;\n}\n\n@Component({\n    selector: 'payment-modal',\n    template: `\n        <div\n            class=\"relative max-h-[100vh] overflow-auto\"\n            *ngIf=\"!(loading | async); else load_state\"\n        >\n            <ng-container *ngIf=\"!success; else success_state\">\n                <main\n                    class=\"px-4 pt-8 w-[24rem] space-y-2 flex flex-col items-center relative\"\n                >\n                    <h2 class=\"text-2xl font-medium\" i18n>Booking Payment</h2>\n                    <img src=\"assets/icons/cost.svg\" class=\"w-1/2\" />\n                    <p class=\"text-sm text-center pb-2\" i18n>\n                        You are requesting a {{ details.type }} booking in\n                        {{ details.resource_name }} for\n                        {{ details.date | date: 'mediumDate' }}\n                        <ng-container *ngIf=\"!details.all_day\">\n                            between {{ details.date | date: 'shortTime' }} and\n                            {{\n                                details.date + details.duration * 60 * 1000\n                                    | date: 'shortTime'\n                            }}\n                        </ng-container>\n                    </p>\n                    <p class=\"text-sm\" i18n>You booking will cost:</p>\n                    <p class=\"text-lg font-medium text-center\">\n                        <strong>{{\n                            details.amount / 100 | currency: code\n                        }}</strong>\n                    </p>\n                    <card-input-field\n                        class=\"w-full\"\n                        [(ngModel)]=\"card_details\"\n                    ></card-input-field>\n                </main>\n                <footer class=\"p-4\">\n                    <button\n                        matRipple\n                        class=\"w-full\"\n                        (click)=\"processPayment()\"\n                        i18n\n                    >\n                        Make Payment\n                    </button>\n                </footer>\n                <button\n                    icon\n                    matRipple\n                    mat-dialog-close\n                    class=\"absolute top-1 left-1\"\n                >\n                    <i class=\"material-icons text-2xl\">close</i>\n                </button>\n            </ng-container>\n        </div>\n        <ng-template #load_state>\n            <div\n                class=\"w-full h-full flex flex-col items-center justify-center p-8\"\n            >\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p>{{ loading | async }}</p>\n            </div>\n        </ng-template>\n        <ng-template #success_state>\n            <main class=\"px-8 pt-8 w-[24rem] flex flex-col relative\">\n                <h2 class=\"text-2xl font-medium\" i18n>Payment Successful</h2>\n                <h3 class=\"text-xl font-medium mb-2\">\n                    Ref #{{ transaction_id }}\n                </h3>\n                <p i18n>{{ details.amount / 100 | currency: code }} paid.</p>\n                <p i18n>{{ details.resource_name }} booked.</p>\n                <p>{{ details.date | date: 'mediumDate' }}</p>\n                <p i18n>\n                    {{ details.date | date: 'shortTime' }} and\n                    {{\n                        details.date + details.duration * 60 * 1000\n                            | date: 'shortTime'\n                    }}\n                </p>\n            </main>\n            <img src=\"assets/icons/payment-confirmed.svg\" class=\"w-full\" />\n            <footer class=\"p-4 border-t border-base-200\">\n                <button btn matRipple mat-dialog-close class=\"w-full\" i18n>\n                    Great, thanks.\n                </button>\n            </footer>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class PaymentModalComponent {\n    @Output() public readonly event = new EventEmitter();\n    public readonly details = this._data;\n    public readonly loading = this._data.loading;\n    public card_details?: PaymentCardDetails;\n    public success = false;\n    public transaction_id = '12345678';\n\n    public get code() {\n        return this._org.currency_code;\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: PaymentData,\n        private _org: OrganisationService\n    ) {}\n\n    public async processPayment() {\n        if (!this.card_details || !this._validCardDetails()) return;\n        this.event.emit(this.card_details);\n        await this._data.makePayment(this.card_details);\n        this.success = true;\n    }\n\n    private _validCardDetails() {\n        return (\n            (this.card_details?.cardholder.length || 0) > 0 &&\n            (this.card_details?.cvv.length || 0) >= 3\n        );\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { getModule } from '@placeos/ts-client';\nimport { BehaviorSubject, of } from 'rxjs';\nimport { shareReplay, switchMap, tap } from 'rxjs/operators';\n\nimport { SettingsService } from 'libs/common/src/lib/settings.service';\nimport { currentUser } from 'libs/common/src/lib/user-state';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { PaymentCardDetails } from './card-input-field.component';\nimport { PaymentModalComponent } from './payment-modal.component';\n\nexport interface PaymentDetails {\n    type: string; // Resource Type\n    resource_name: string;\n    date: number;\n    duration: number;\n    all_day: boolean;\n}\n\nexport interface PaymentResult {\n    success: boolean;\n    state: 'processing' | 'pending' | 'approved';\n    invoice_id: string;\n    amount: number;\n    created_at: number;\n    updated_at: number;\n}\n\nexport const STRIPE_ID_TOKEN = 'STRIPE+customer_id';\nconst STRIPE_MODULE = 'Payment';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class PaymentsService {\n    private _loading = new BehaviorSubject('');\n    private _active_card = new BehaviorSubject('');\n\n    public readonly loading = this._loading.asObservable();\n\n    public readonly payment_sources = of(1).pipe(\n        switchMap(() => {\n            const mod = getModule(this.payment_module, STRIPE_MODULE);\n            if (!mod) return of([]);\n            return mod.execute('list_payment_methods', ['card']);\n        }),\n        tap((_) => (_[0] ? this._active_card.next(_[0].id) : '')),\n        shareReplay(1)\n    );\n\n    public get payment_module() {\n        return this._org.binding('payments');\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _settings: SettingsService,\n        private _dialog: MatDialog\n    ) {}\n\n    public async makePayment(\n        details: PaymentDetails\n    ): Promise<PaymentResult | undefined> {\n        if (!this.payment_module) throw 'Payments not enabled';\n        const [cost, period] = await this._getCostOfProduct(\n            details?.type\n        ).catch((_) => [0, 60]);\n        console.log('Cost:', cost, period);\n        if (cost <= 0) return;\n        let customer_id = this._settings.get('STRIPE_Customer_ID');\n        if (!customer_id) customer_id = await this._newCustomerID();\n        this._settings.saveUserSetting('STRIPE_Customer_ID', customer_id);\n        const amount = cost * (details.duration / period);\n        let result = undefined;\n        const makePayment = async (c: any) => {\n            result = await this._processPayment(amount, customer_id, c).catch(\n                (e) => {\n                    this._loading.next('');\n                    throw e;\n                }\n            );\n        };\n        const data = {\n            ...details,\n            rate: `$${(cost / 100).toFixed(2)} per hour`,\n            amount,\n            makePayment,\n            loading: this.loading,\n        };\n        const ref = this._dialog.open(PaymentModalComponent, { data });\n        await ref.afterClosed().toPromise();\n        return result;\n    }\n\n    private async _addPaymentMethod(card: PaymentCardDetails): Promise<string> {\n        const mod = getModule(this.payment_module, STRIPE_MODULE);\n        if (!mod) throw 'Unable to load module';\n        const payment_method = await mod.execute('add_payment_method', [\n            'card',\n            null,\n            null,\n            null,\n            null,\n            null,\n            null,\n            null,\n            null,\n            null,\n            null,\n            null,\n            card,\n        ]);\n        return payment_method.id || payment_method;\n    }\n\n    private async _getCostOfProduct(type: string) {\n        let price: [number, number] = [0, 60];\n        const mod = getModule(this.payment_module, STRIPE_MODULE);\n        if (!mod) return price;\n        const product_list = await mod.execute('get_product_prices', [\n            null,\n            null,\n            type,\n        ]);\n        if (!product_list.length) return price;\n        return product_list;\n    }\n\n    private async _processPayment(\n        amount: number,\n        customer_id: string,\n        card_details?: PaymentCardDetails\n    ) {\n        this._loading.next('Checking payment method...');\n        console.log('Getting payment method...');\n        const source = card_details\n            ? await this._addPaymentMethod(card_details)\n            : this._active_card.getValue();\n        if (!source) throw 'No payment source selected';\n        this._loading.next('Processing payment...');\n        console.log('Processing payment...');\n        const mod = getModule(this.payment_module, STRIPE_MODULE);\n        if (!mod) throw 'Unable to load module';\n        const id = await mod.execute<string>('create_payment_intent', [\n            amount,\n            this._org.building.currency || 'USD',\n            null,\n            null,\n            customer_id,\n            null,\n            null,\n            null,\n            currentUser()?.email,\n        ]);\n        if (!id) throw 'Failed to create payment';\n        console.log('Confirming payment...');\n        await mod.execute('confirm_payment_intent', [id, source]);\n        this._loading.next('');\n        return {\n            success: true,\n            state: 'approved',\n            invoice_id: id,\n            amount: amount,\n            created_at: Date.now(),\n            updated_at: Date.now(),\n        };\n    }\n\n    private async _newCustomerID() {\n        const mod = getModule(this.payment_module, STRIPE_MODULE);\n        if (!mod) throw 'Unable to load module';\n        const user = currentUser();\n        const id = await mod.execute<string>('create_customer', [\n            0,\n            null,\n            null,\n            null,\n            `${user.id}|${user.name}|FromPlaceOS`,\n            user.email,\n        ]);\n        return id;\n    }\n}\n","import { User } from 'libs/users/src/lib/user.class';\nimport { addMinutes, format, set, startOfMinute } from 'date-fns';\nimport { toQueryString } from './api';\nimport { localToTimezone } from './timezone-helpers';\nimport { unique } from './general';\nimport { PlaceSystem } from '@placeos/ts-client';\n\nexport interface CalEvent {\n    id?: string;\n    title: string;\n    date: number;\n    duration: number;\n    all_day: boolean;\n    body: string;\n    location: string;\n    host: string;\n    organiser: User;\n    user_name?: string;\n    user_email?: string;\n    attendees: string[];\n    resources?: string[];\n    meeting_url?: string;\n    system?: PlaceSystem;\n}\n\nfunction formatUTC(date: Date | number) {\n    const utc_date = localToTimezone(date, 'UTC');\n    return `${format(utc_date, 'yyyyMMdd')}T${format(utc_date, 'HHmmss')}Z`;\n}\n\nfunction formatAllDay(date: Date | number) {\n    return `${format(date, 'yyyyMMdd')}`;\n}\n\nexport function generateCalendarFileLink(event: CalEvent): string {\n    const chunks: [string, any][] = [];\n    const description = formatCalFileText(\n        `${event.body || ''}${event.id ? '\\n\\n[ID|' + event.id + ']' : ''}`\n    );\n    const location = formatCalFileText(`${event.location}`);\n    chunks.push(['BEGIN', 'VCALENDAR']);\n    chunks.push(['VERSION', '2.0']);\n    chunks.push(['BEGIN', 'VEVENT']);\n    chunks.push(['URL', `${event.meeting_url}`]);\n    chunks.push([\n        'DTSTART',\n        `${new Date(\n            event.all_day\n                ? startOfMinute(set(event.date, { hours: 6, minutes: 0 }))\n                : event.date\n        ).toISOString()}`,\n    ]);\n    chunks.push([\n        'DTEND',\n        `${\n            event.all_day\n                ? startOfMinute(\n                      set(event.date, { hours: 18, minutes: 0 })\n                  ).toISOString()\n                : addMinutes(event.date, event.duration ?? 60).toISOString()\n        }`,\n    ]);\n    chunks.push(['SUMMARY', `${event.title}`]);\n    chunks.push(['DESCRIPTION', description]);\n    chunks.push(['LOCATION', location]);\n    const host =\n        event.organiser?.name ||\n        event.host?.split('@') ||\n        event.user_name ||\n        'User';\n    chunks.push([\n        'ORGANIZER',\n        `CN=${host}:MAILTO:${event.host || event.user_email}`,\n    ]);\n    const url_data = chunks\n        .map(([key, value]) => `${key}:${encodeURIComponent(value)}`)\n        .join('\\n');\n    return `data:text/calendar;charset=utf8,${url_data}`;\n}\n\nexport function generateGoogleCalendarLink(event: CalEvent): string {\n    const fmt = event.all_day ? formatAllDay : formatUTC;\n    const details: any = {\n        action: 'TEMPLATE',\n        text: event.title,\n        details: `${event.body || ''}${\n            event.id ? '\\n\\n[ID|' + event.id + ']' : ''\n        }`,\n        location: event.location,\n        trp: false,\n        dates: `${fmt(event.date)}/${fmt(\n            addMinutes(event.date, event.duration ?? 60)\n        )}`,\n    };\n    const emails = (event.attendees || []).map((_: any) => _.email || _);\n    const resources = (\n        (event.resources?.length ? event.resources : null) || [event.system]\n    ).map((_: any) => _?.email || _);\n    if (emails.length || resources.length)\n        details.add = unique([...emails, ...resources]).join();\n    return `https://calendar.google.com/calendar/render?${toQueryString(\n        details\n    )}`;\n}\n\nexport function generateMicrosoftCalendarLink(\n    event: CalEvent,\n    type: 'outlook' | 'office' = 'office'\n): string {\n    if (!event.date) event.date = Date.now();\n    const data: any = {\n        path: '/calendar/action/compose',\n        rru: 'addevent',\n        startdt: new Date(event.date).toISOString(),\n        enddt: addMinutes(event.date, event.duration ?? 60).toISOString(),\n        subject: event.title,\n        body: `${event.body || ''}${\n            event.id ? '\\n\\n[ID|' + event.id + ']' : ''\n        }`,\n        location: event.location,\n        allday: event.all_day ?? false,\n    };\n    if (event.all_day) delete data.enddt;\n    const emails = (event.attendees || []).map((_: any) => _.email || _);\n    const resources = (\n        (event.resources?.length ? event.resources : null) || [event.system]\n    ).map((_: any) => _?.email || _);\n    if (emails.length || resources.length)\n        data.to = unique([...emails, ...resources]).join();\n    return type === 'office'\n        ? `https://outlook.office.com/calendar/0/action/compose?${toQueryString(\n              data\n          )}`\n        : `https://outlook.live.com/calendar/0/action/compose?${toQueryString(\n              data\n          )}`;\n}\n\nfunction formatCalFileText(str: string) {\n    return str\n        .replace(/,/gm, ',')\n        .replace(/;/gm, ';')\n        .replace(/\\r\\n/gm, '\\n')\n        .replace(/\\n/gm, '\\\\n')\n        .replace(/(\\\\n)[\\s\\t]+/gm, '\\\\n');\n}\n","import { Component, Inject } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { SettingsService } from 'libs/common/src/lib/settings.service';\nimport {\n    generateCalendarFileLink,\n    generateGoogleCalendarLink,\n    generateMicrosoftCalendarLink,\n} from 'libs/common/src/lib/calendar-links';\nimport { CalendarEvent } from './event.class';\nimport { notifyError } from '@placeos/common';\n\n@Component({\n    selector: 'event-link-modal',\n    template: `\n        <div class=\"p-4 w-full pb-2\" i18n>Add event to your calendar</div>\n        <div class=\"flex flex-col items-center space-y-4 p-4 relative\">\n            <a\n                btn\n                matRipple\n                class=\"flex items-center p-2 space-x-2 pr-4 w-64 rounded inverse\"\n                [href]=\"outlook_link | sanitize: 'url'\"\n                target=\"_blank\"\n                rel=\"noopener noreferer\"\n                (click)=\"has_actioned = true\"\n            >\n                <img src=\"assets/icons/outlook.svg\" class=\"w-6\" />\n                <span i18n>Create in Outlook</span>\n            </a>\n            <a\n                btn\n                matRipple\n                class=\"flex items-center p-2 space-x-2 pr-4 w-64 rounded inverse\"\n                [href]=\"google_link | sanitize: 'url'\"\n                target=\"_blank\"\n                rel=\"noopener noreferer\"\n                (click)=\"has_actioned = true\"\n            >\n                <img src=\"assets/icons/gcal.svg\" class=\"w-6\" />\n                <span i18n>Create in Google Calendar</span>\n            </a>\n            <a\n                btn\n                matRipple\n                class=\"flex items-center p-2 space-x-2 pr-4 w-64 rounded inverse\"\n                [href]=\"ical_link | safe: 'url'\"\n                target=\"_blank\"\n                rel=\"noopener noreferer\"\n                (click)=\"has_actioned = true\"\n            >\n                <app-icon class=\"text-xl\">download</app-icon>\n                <span i18n>Download iCal File</span>\n            </a>\n            <button class=\"w-64\" btn matRipple (click)=\"close()\" i18n>\n                Close\n            </button>\n        </div>\n        <button\n            icon\n            matRipple\n            [mat-dialog-close]=\"has_actioned\"\n            class=\"absolute top-2 right-0\"\n        >\n            <app-icon>close</app-icon>\n        </button>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n            }\n        `,\n    ],\n})\nexport class EventLinkModalComponent {\n    public readonly outlook_link = generateMicrosoftCalendarLink(\n        this._event as any\n    );\n    public readonly google_link = generateGoogleCalendarLink(\n        this._event as any\n    );\n    public readonly ical_link = generateCalendarFileLink(this._event as any);\n\n    public has_actioned = false;\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _event: CalendarEvent,\n        private _dialog: MatDialogRef<EventLinkModalComponent>\n    ) {}\n\n    public close() {\n        if (!this.has_actioned) {\n            return notifyError(\n                'You need to select a calendar option to finish creating this booking'\n            );\n        }\n        this._dialog.close(true);\n    }\n}\n","import { cleanObject, del, get, post, put } from '@placeos/ts-client';\nimport { toQueryString } from 'libs/common/src/lib/api';\nimport { map, switchMap, tap } from 'rxjs/operators';\nimport {\n    Asset,\n    AssetCategory,\n    AssetGroup,\n    AssetPurchaseOrder,\n} from './asset.class';\nimport { combineLatest, forkJoin, of } from 'rxjs';\nimport { addMinutes, endOfDay, getUnixTime, startOfDay } from 'date-fns';\nimport {\n    BookingsQueryParams,\n    createBooking,\n    queryBookings,\n    removeBooking,\n} from 'libs/bookings/src/lib/bookings.fn';\nimport { Booking } from 'libs/bookings/src/lib/booking.class';\nimport { flatten, unique } from '@placeos/common';\nimport { AssetRequest } from './asset-request.class';\n\nconst BASE_ENDPOINT = '/api/engine/v2';\n\n////////////////////////////////\n////    Asset Categories    ////\n////////////////////////////////\n\nexport function queryAssetCategories(query: any = {}) {\n    const q = toQueryString(query);\n    return get(`${BASE_ENDPOINT}/asset_categories${q ? '?' + q : ''}`).pipe(\n        map((_) => _ as AssetCategory[]),\n    );\n}\n\nexport function addAssetCategory(category: AssetCategory) {\n    return post(\n        `${BASE_ENDPOINT}/asset_categories`,\n        cleanObject(category, [undefined, null, '']),\n    ).pipe(map((_) => _ as AssetCategory));\n}\n\nexport function updateAssetCategory(\n    id: string,\n    category: Partial<AssetCategory>,\n) {\n    return put(\n        `${BASE_ENDPOINT}/asset_categories/${id}`,\n        cleanObject(category, [undefined, null, '']),\n    ).pipe(map((_) => _ as AssetCategory));\n}\n\nexport function saveAssetCategory(category: AssetCategory) {\n    return category.id\n        ? updateAssetCategory(category.id, category)\n        : addAssetCategory(category);\n}\n\nexport function showAssetCategory(id: string) {\n    return get(`${BASE_ENDPOINT}/asset_categories/${id}`).pipe(\n        map((_) => _ as AssetCategory),\n    );\n}\n\nexport function deleteAssetCategory(id: string) {\n    return del(`${BASE_ENDPOINT}/asset_categories/${id}`);\n}\n\n//////////////////////////////\n////     Asset Groups     ////\n//////////////////////////////\n\nexport function queryAssetGroups(query: any = {}) {\n    const q = toQueryString(query);\n    return get(`${BASE_ENDPOINT}/asset_types${q ? '?' + q : ''}`).pipe(\n        map((_) => _ as AssetGroup[]),\n    );\n}\n\nconst groups_cache = new Map<string, AssetGroup[]>();\n\nexport function queryAssetGroupsExtended(query: any = {}) {\n    const q = toQueryString(query);\n    if (groups_cache.has(query.zones)) {\n        return of(groups_cache.get(query.zones));\n    }\n    return get(`${BASE_ENDPOINT}/asset_types${q ? '?' + q : ''}`).pipe(\n        map((_) => _ as AssetGroup[]),\n        switchMap((list) =>\n            forkJoin(\n                list.map((group) =>\n                    queryAssets({\n                        limit: 200,\n                        ...query,\n                        type_id: group.id,\n                    }).pipe(\n                        map((assets) => ({ ...group, assets }) as AssetGroup),\n                    ),\n                ),\n            ),\n        ),\n        tap((_) => {\n            groups_cache.set(query.zones, _);\n            // Clear cache after 5 minutes\n            setTimeout(() => groups_cache.delete(query.zones), 5 * 60 * 1000);\n        }),\n    );\n}\n\nexport function addAssetGroup(product: AssetGroup) {\n    return post(\n        `${BASE_ENDPOINT}/asset_types`,\n        cleanObject(product, [undefined, null, '']),\n    ).pipe(map((_) => _ as AssetGroup));\n}\n\nexport function updateAssetGroup(id: string, product: Partial<AssetGroup>) {\n    return put(\n        `${BASE_ENDPOINT}/asset_types/${id}`,\n        cleanObject(product, [undefined, null, '']),\n    ).pipe(map((_) => _ as AssetGroup));\n}\n\nexport function saveAssetGroup(product: AssetGroup) {\n    return product.id\n        ? updateAssetGroup(product.id, product)\n        : addAssetGroup(product);\n}\n\nexport function showAssetGroup(id: string) {\n    return get(`${BASE_ENDPOINT}/asset_types/${id}`).pipe(\n        map((_) => _ as AssetGroup),\n    );\n}\n\nexport function deleteAssetGroup(id: string) {\n    return del(`${BASE_ENDPOINT}/asset_types/${id}`);\n}\n\n////////////////////////////////\n////          Assets        ////\n////////////////////////////////\n\nexport function queryAssets(query: any = {}) {\n    const q = toQueryString(query);\n    return get(`${BASE_ENDPOINT}/assets${q ? '?' + q : ''}`).pipe(\n        map((_) => _ as Asset[]),\n    );\n}\n\nexport function addAsset(asset: Asset) {\n    return post(\n        `${BASE_ENDPOINT}/assets`,\n        cleanObject(asset, [undefined, null, '']),\n    ).pipe(map((_) => _ as Asset));\n}\n\nexport function updateAsset(id: string, asset: Partial<Asset>) {\n    return put(\n        `${BASE_ENDPOINT}/assets/${id}`,\n        cleanObject(asset, [undefined, null, '']),\n    ).pipe(map((_) => _ as Asset));\n}\n\nexport function saveAsset(asset: Asset) {\n    return asset.id\n        ? updateAsset(asset.id, {\n              ...asset,\n              asset_type_id: asset.type_id,\n          } as any)\n        : addAsset({ ...asset, asset_type_id: asset.type_id } as any);\n}\n\nexport function showAsset(id: string) {\n    return get(`${BASE_ENDPOINT}/assets/${id}`).pipe(map((_) => _ as Asset));\n}\n\nexport function deleteAsset(id: string) {\n    return del(`${BASE_ENDPOINT}/assets/${id}`);\n}\n\n////////////////////////////////\n////      Assets (Bulk)     ////\n////////////////////////////////\n\nexport function addAssetsInBulk(assets: Asset[]) {\n    assets.map((_: any) => (_.asset_type_id = _.type_id));\n    return post(\n        `${BASE_ENDPOINT}/assets/bulk`,\n        assets.map((_) => cleanObject(_, [undefined, null, ''])),\n    ).pipe(map((_) => _ as Asset[]));\n}\n\nexport function updateAssetsInBulk(assets: Partial<Asset>[]) {\n    assets.map((_: any) => (_.asset_type_id = _.type_id));\n    return put(\n        `${BASE_ENDPOINT}/assets/bulk`,\n        assets.map((_) => cleanObject(_, [undefined, null, ''])),\n    ).pipe(map((_) => _ as Asset[]));\n}\n\nexport function saveAssetsInBulk(assets: Asset[]) {\n    if (!assets?.length) return of([]);\n    return assets.every((item) => item?.id)\n        ? updateAssetsInBulk(assets)\n        : addAssetsInBulk(assets);\n}\n\nexport function deleteAssetsInBulk(id_list: string[]) {\n    return del(`${BASE_ENDPOINT}/assets/bulk`, { body: { id_list } });\n}\n\n/////////////////////////////////\n////  Asset Purchase Orders  ////\n/////////////////////////////////\n\nexport function queryAssetPurchaseOrders(query: any = {}) {\n    const q = toQueryString(query);\n    return get(\n        `${BASE_ENDPOINT}/asset_purchase_orders${q ? '?' + q : ''}`,\n    ).pipe(map((_) => _ as AssetPurchaseOrder[]));\n}\n\nexport function addAssetPurchaseOrder(order: AssetPurchaseOrder) {\n    return post(\n        `${BASE_ENDPOINT}/asset_purchase_orders`,\n        cleanObject(order, [undefined, null, '']),\n    ).pipe(map((_) => _ as AssetPurchaseOrder));\n}\n\nexport function updateAssetPurchaseOrder(\n    id: string,\n    order: Partial<AssetPurchaseOrder>,\n) {\n    return put(\n        `${BASE_ENDPOINT}/asset_purchase_orders/${id}`,\n        cleanObject(order, [undefined, null, '']),\n    ).pipe(map((_) => _ as AssetPurchaseOrder));\n}\n\nexport function saveAssetPurchaseOrder(order: AssetPurchaseOrder) {\n    return order.id\n        ? updateAssetPurchaseOrder(order.id, {\n              ...order,\n              purchase_order_number: order.order_number,\n          } as any)\n        : addAssetPurchaseOrder({\n              ...order,\n              purchase_order_number: order.order_number,\n          } as any);\n}\n\nexport function showAssetPurchaseOrder(id: string) {\n    return get(`${BASE_ENDPOINT}/asset_purchase_orders/${id}`).pipe(\n        map((_) => _ as AssetPurchaseOrder),\n    );\n}\n\nexport function deleteAssetPurchaseOrder(id: string) {\n    return del(`${BASE_ENDPOINT}/asset_purchase_orders/${id}`);\n}\n\n//////////////////////////////////////\n////     Asset Helper Methods     ////\n//////////////////////////////////////\n\nexport function getGroupsWithAssets(query: any = {}) {\n    return combineLatest([queryAssetGroups(query)]).pipe(\n        map(([products]) => products),\n    );\n}\n\nexport function showGroupFull(id: string, query: any = {}) {\n    return combineLatest([\n        showAssetGroup(id),\n        queryAssetCategories(),\n        queryAssets({ ...query, type_id: id, limit: 2000 }),\n        queryAssetPurchaseOrders(),\n    ]).pipe(\n        map(([product, categories, assets, purchase_orders]) => {\n            product.category = categories.find(\n                (category) => category.id === product.category_id,\n            );\n            product.assets = assets.filter(\n                (asset) =>\n                    asset.type_id === product.id ||\n                    (asset as any).asset_type_id === product.id,\n            );\n            for (const asset of product.assets) {\n                (asset as any).order_number = (purchase_orders as any).find(\n                    (_) => _.id === asset.purchase_order_id,\n                )?.purchase_order_number;\n            }\n            product.purchase_orders = purchase_orders.filter((order) =>\n                product.assets.find(\n                    (asset) => asset.purchase_order_id === order.id,\n                ),\n            );\n            return product;\n        }),\n    );\n}\n\nexport function queryAvailableAssets(\n    query: BookingsQueryParams,\n    ignore?: string[],\n) {\n    query.type = 'asset-request';\n    return combineLatest([queryAssets(query), queryBookings(query)]).pipe(\n        map(([assets, bookings]) =>\n            assets.filter(\n                (asset) =>\n                    ignore?.includes(asset.id) ||\n                    !bookings.find(\n                        (booking) =>\n                            booking.asset_id === asset.id ||\n                            booking.asset_ids?.includes(asset.id),\n                    ),\n            ),\n        ),\n    );\n}\n\nexport function queryGroupAvailability(\n    query: BookingsQueryParams,\n    ignore?: string[],\n) {\n    query.type = 'asset-request';\n    return combineLatest([\n        queryAssetGroupsExtended(query),\n        queryBookings(query),\n    ]).pipe(\n        map(([products, bookings]) => {\n            bookings = bookings.filter(\n                (_) => _.status !== 'declined' && _.status !== 'cancelled',\n            );\n            return products.map((product) => ({\n                ...product,\n                assets: product.assets.filter(\n                    (asset) =>\n                        ignore?.includes(asset.id) ||\n                        !bookings.find(\n                            (booking) =>\n                                !ignore.includes(booking.id) &&\n                                (booking.asset_id === asset.id ||\n                                    booking.asset_ids?.includes(asset.id)),\n                        ),\n                ),\n            }));\n        }),\n    );\n}\n\nexport async function removeAssetRequests(id: string) {\n    const requests = await queryBookings({\n        period_start: getUnixTime(startOfDay(new Date())),\n        period_end: getUnixTime(endOfDay(new Date())),\n        type: 'asset-request',\n    }).toPromise();\n    return Promise.all(\n        requests\n            .filter((_) => _.asset_id === id || _.asset_ids?.includes(id))\n            .map((request) => removeBooking(request.id).toPromise()),\n    );\n}\n\nexport function differenceBetweenAssetRequests(\n    new_assets: AssetRequest[],\n    old_assets: AssetRequest[],\n    reset_state: boolean = false,\n): string[] {\n    if ((!new_assets || new_assets?.length <= 0) && old_assets?.length)\n        return [];\n    if (!old_assets) return [];\n    const changed: string[] = [];\n    for (const request of new_assets) {\n        const match = old_assets.find((_) => _.id === request.id);\n        if (!match || match.ref_id !== request.ref_id) {\n            changed.push(request.id);\n        }\n    }\n    return changed;\n}\n\nexport async function validateAssetRequestsForResource(\n    { id, ical_uid, from_booking }: any,\n    {\n        date,\n        duration,\n        all_day,\n        host,\n        location_name,\n        location_id,\n        zones,\n        reset_state,\n    }: {\n        date: number;\n        duration: number;\n        all_day: boolean;\n        host: string;\n        location_name?: string;\n        location_id?: string;\n        zones?: string[];\n        reset_state?: boolean;\n    },\n    new_assets: AssetRequest[] = [],\n    force_create = false,\n): Promise<() => Promise<void>> {\n    const requests = await queryBookings({\n        period_start: getUnixTime(all_day ? startOfDay(date) : date),\n        period_end: getUnixTime(\n            all_day\n                ? endOfDay(addMinutes(date, duration))\n                : addMinutes(date, duration),\n        ),\n        type: 'asset-request',\n        zones: zones.join(','),\n    }).toPromise();\n    const bookings =\n        id && ical_uid\n            ? await queryBookings({\n                  period_start: getUnixTime(startOfDay(date)),\n                  period_end: getUnixTime(endOfDay(date)),\n                  type: 'asset-request',\n                  email: host,\n                  event_id: from_booking ? '' : id,\n                  booking_id: from_booking ? id : '',\n                  ical_uid,\n              }).toPromise()\n            : [];\n    const booking_list: [string, AssetRequest][] = bookings.map((_) => [\n        _.id,\n        new AssetRequest(_.extension_data.request),\n    ]);\n    new_assets?.forEach((_) => (_.conflict = false));\n    let changed = force_create\n        ? new_assets.map((_) => _.id)\n        : differenceBetweenAssetRequests(\n              new_assets,\n              booking_list.map(([_, r]) => r),\n              reset_state,\n          );\n    if (reset_state) {\n        const has_state = bookings.filter((_) => _.approved || _.rejected);\n        changed = unique([\n            ...changed,\n            ...has_state.map((_) => _.extension_data.request_id),\n        ]);\n    }\n    const unchanged = booking_list.filter(\n        ([_, request]) => !changed.includes(request.id),\n    );\n    const changed_requests = booking_list.filter(([_, { id }]) =>\n        changed.includes(id),\n    );\n    const changed_assets = new_assets.filter(({ id }) => changed.includes(id));\n    const filtered = requests.filter(\n        (req) =>\n            !req.rejected &&\n            (!bookings.find((b) => b.id === req.id) ||\n                unchanged.find(([id]) => req.event_id === id)),\n    );\n    let used_ids: string[] = flatten(filtered.map((_) => _.asset_ids));\n    for (const [_, request] of unchanged) {\n        used_ids = [\n            ...used_ids,\n            ...flatten(request.items.map((_) => _.item_ids)),\n        ];\n    }\n    const available_groups = await queryGroupAvailability(\n        {\n            period_start: getUnixTime(all_day ? startOfDay(date) : date),\n            period_end: getUnixTime(\n                all_day\n                    ? endOfDay(addMinutes(date, duration))\n                    : addMinutes(date, duration),\n            ),\n            type: 'asset-request',\n        },\n        bookings.map((_) => _.id),\n    ).toPromise();\n    const processed_requests = changed_assets.map((request) => {\n        // Handle duplicate asset ids\n        let asset_ids = flatten(\n            (request.items as any).map(({ id, item_ids, quantity }) => {\n                const assets = available_groups.find(\n                    (_) => _.id === id,\n                )?.assets;\n                if (!assets) return item_ids;\n                const list = [];\n                return new Array(quantity).fill(0).map((_, idx) => {\n                    const item =\n                        used_ids.includes(item_ids[idx]) ||\n                        list.includes(item_ids[idx]) ||\n                        !item_ids[idx]\n                            ? assets?.find(({ id }) => {\n                                  return (\n                                      !used_ids.includes(id) &&\n                                      !list.includes(id)\n                                  );\n                              })?.id\n                            : item_ids[idx];\n                    if (!item) {\n                        request.conflict = true;\n                        throw 'Unable to find available asset for request';\n                    }\n                    list.push(item);\n                    return item;\n                });\n            }),\n        );\n        // Grab any existing bookings for the asset for the parent event/booking\n        const booking = bookings.find((_) =>\n            _.asset_ids.find((id) =>\n                request.items?.find((i) => i.item_ids.includes(id)),\n            ),\n        );\n        used_ids = [...used_ids, ...asset_ids];\n        const asset_data: Partial<Booking> = {\n            type: 'asset-request',\n            booking_type: 'asset-request',\n            date,\n            duration,\n            all_day,\n            description: location_name,\n            user_email: host,\n            asset_id: asset_ids[0],\n            asset_ids,\n            asset_name: request.items.map((_) => _.name).join(', '),\n            title: request.items.map((_) => _.name).join(', '),\n            approved: !reset_state && booking?.approved && !request._changed,\n            rejected: !reset_state && booking?.rejected && !request._changed,\n            extension_data: {\n                parent_id: id,\n                request_id: request.id,\n                location_id,\n                request: new AssetRequest({ ...request, event: null }),\n            },\n            zones: zones || [],\n        };\n        if (from_booking) (asset_data as any).parent_id = id;\n        return createBooking(new Booking(asset_data), {\n            ical_uid,\n            event_id: from_booking ? '' : id,\n        });\n    });\n    return async () => {\n        await Promise.all(\n            changed_requests.map(([id]) => removeBooking(id).toPromise()),\n        );\n        await Promise.all(processed_requests.map((r) => r.toPromise()));\n    };\n}\n","import { Pipe } from '@angular/core';\n\nimport { AssetGroup } from './asset.class';\nimport { showAssetGroup } from './assets.fn';\n\nconst ASSET_GROUP_LIST: AssetGroup[] = [];\n\nconst EMPTY_ASSET_GROUP = new AssetGroup();\n\nexport function updateAssetGroupList(assetgroup_list: AssetGroup[]) {\n    for (const assetgroup of assetgroup_list) {\n        if (!ASSET_GROUP_LIST.find(({ id }) => id === assetgroup.id)) {\n            ASSET_GROUP_LIST.push(assetgroup);\n        }\n    }\n}\n\n@Pipe({\n    name: 'assetgroup',\n})\nexport class AssetGroupPipe {\n    /**\n     * Get details of the assetgroup with the given ID\n     * @param assetgroup_id ID or Email of the assetgroup\n     */\n    public async transform(group_id: string): Promise<AssetGroup> {\n        if (!group_id) return EMPTY_ASSET_GROUP;\n        let asset_group = ASSET_GROUP_LIST.find(({ id }) => id === group_id);\n        if (asset_group) return asset_group;\n        const group = await showAssetGroup(group_id)\n            .toPromise()\n            .catch((_) => null);\n        if (group) {\n            asset_group = { ...group };\n            ASSET_GROUP_LIST.push(asset_group);\n            return asset_group;\n        }\n        return EMPTY_ASSET_GROUP;\n    }\n\n    public updateAssetGroupList(assetgroup_list: AssetGroup[]) {\n        updateAssetGroupList(assetgroup_list);\n    }\n}\n","export class AssetCategory {\n    id: string = '';\n    name: string = '';\n    description: string = '';\n    parent_category_id?: string = '';\n    created_at: number = Date.now();\n    updated_at: number = Date.now();\n\n    constructor(data?: Partial<AssetCategory>) {\n        Object.assign(this, data);\n    }\n}\n\nexport class AssetPurchaseOrder {\n    id: string;\n    order_number: string;\n    invoice_number: string;\n    purchase_date: number;\n    unit_price: number;\n    expected_service_start_date: number;\n    expected_service_end_date: number;\n    created_at: number;\n    updated_at: number;\n\n    constructor(data?: Partial<AssetPurchaseOrder>) {\n        Object.assign(this, data);\n    }\n}\n\nexport class AssetGroup {\n    id: string;\n    category_id: string;\n    brand: string;\n    name: string;\n    in_use: number;\n    description: string;\n    asset_count: number;\n    category?: AssetCategory;\n    assets?: Asset[];\n    images: string[] = [];\n    purchase_orders?: AssetPurchaseOrder[];\n    quantity?: number;\n    zone_id: string;\n    created_at: number;\n    updated_at: number;\n\n    constructor(data?: Partial<AssetGroup>) {\n        Object.assign(this, data);\n    }\n}\n\nexport class Asset {\n    id: string = '';\n    type_id: string = '';\n    description: string = '';\n    serial_number: string = '';\n    barcode: string = '';\n    identifier: string = '';\n    other_data: Record<string, any> = {};\n    purchase_order_id: string = '';\n    created_at: number = Date.now();\n    updated_at: number = Date.now();\n\n    constructor(data?: Partial<Asset>) {\n        Object.assign(this, data);\n    }\n}\n","import { FormGroup, FormControl, Validators } from '@angular/forms';\nimport {\n    Asset,\n    AssetCategory,\n    AssetGroup,\n    AssetPurchaseOrder,\n} from './asset.class';\nimport { flatten, stringToMinutes } from '@placeos/common';\nimport { AttachedResourceRuleset } from '@placeos/components';\nimport { CalendarEvent } from '@placeos/events';\nimport { isAfter, isBefore, setHours, subHours } from 'date-fns';\nimport { catchError, map } from 'rxjs/operators';\nimport { showMetadata } from '@placeos/ts-client';\nimport { Observable, of } from 'rxjs';\nimport { AssetRequest } from './asset-request.class';\n\nexport function generateAssetCategoryForm(category: AssetCategory = {} as any) {\n    return new FormGroup({\n        id: new FormControl(category.id),\n        name: new FormControl(category.name || '', [Validators.required]),\n        parent_category_id: new FormControl(category.parent_category_id),\n    });\n}\n\nexport function generateAssetPurchaseOrderForm(\n    order: AssetPurchaseOrder = {} as any\n) {\n    return new FormGroup({\n        id: new FormControl(order.id),\n        order_number: new FormControl(\n            order.order_number || (order as any).purchase_order_number || '',\n            [Validators.required]\n        ),\n        invoice_number: new FormControl(order.invoice_number || ''),\n        unit_price: new FormControl(order.unit_price || 0),\n        purchase_date: new FormControl(order.purchase_date * 1000 || null),\n        expected_service_start_date: new FormControl(\n            order.expected_service_start_date * 1000 ||\n                (order as any).depreciation_start_date ||\n                null\n        ),\n        expected_service_end_date: new FormControl(\n            order.expected_service_end_date * 1000 ||\n                (order as any).depreciation_end_date ||\n                null\n        ),\n    });\n}\n\nexport function generateAssetGroupForm(group: AssetGroup = new AssetGroup()) {\n    return new FormGroup({\n        id: new FormControl(group.id),\n        category_id: new FormControl(group.category_id || '', [\n            Validators.required,\n        ]),\n        images: new FormControl(group.images || []),\n        brand: new FormControl(group.brand || ''),\n        name: new FormControl(group.name || '', [Validators.required]),\n        description: new FormControl(group.description || ''),\n    });\n}\n\nexport function generateAssetForm(asset: Asset = new Asset()) {\n    return new FormGroup({\n        id: new FormControl(asset.id),\n        type_id: new FormControl(asset.type_id || '', [Validators.required]),\n        description: new FormControl(asset.description || ''),\n        serial_number: new FormControl(asset.serial_number || ''),\n        barcode: new FormControl(asset.barcode || ''),\n        identifier: new FormControl(asset.identifier || ''),\n        other_data: new FormControl(asset.other_data || {}),\n        purchase_order_id: new FormControl(asset.purchase_order_id),\n    });\n}\n\nconst RULE_REQUESTS: Record<string, Observable<AttachedResourceRuleset[]>> = {};\n\nexport function getAssetRulesForZone(zone_id: string, fresh: boolean = false) {\n    if (!zone_id) return of([] as AttachedResourceRuleset[]);\n    if (!RULE_REQUESTS[zone_id] || fresh)\n        RULE_REQUESTS[zone_id] = showMetadata(zone_id, 'assets_config').pipe(\n            map(\n                (_) =>\n                    (_.details instanceof Array\n                        ? _.details\n                        : []) as AttachedResourceRuleset[]\n            ),\n            catchError((e) => of([] as AttachedResourceRuleset[]))\n        );\n    return RULE_REQUESTS[zone_id];\n}\n\nexport function assetAvailable(\n    item: AssetGroup,\n    rules: AttachedResourceRuleset[],\n    event: CalendarEvent\n): boolean {\n    const current_date = Date.now();\n    const event_date = new Date(event.date);\n\n    const isRuleMatch = (rule: AttachedResourceRuleset): boolean =>\n        item.name === rule.name ||\n        item.category.name.includes(rule.name) ||\n        event.resources.some((resource) =>\n            resource.zones.includes(rule.name)\n        ) ||\n        event.space?.zones.includes(rule.name) ||\n        rule.name === '*';\n\n    const countMatches = (rule: AttachedResourceRuleset): number =>\n        rule.rules.reduce((matches, condition) => {\n            switch (condition[0]) {\n                case 'is_before':\n                    return (\n                        matches +\n                        (isBefore(\n                            current_date,\n                            subHours(event_date, condition[1])\n                        )\n                            ? 1\n                            : 0)\n                    );\n                case 'within_hours':\n                    return (\n                        matches +\n                        (isAfter(\n                            current_date,\n                            subHours(event_date, condition[1])\n                        )\n                            ? 1\n                            : 0)\n                    );\n                case 'after_hour':\n                    return (\n                        matches +\n                        (isAfter(event_date, setHours(event_date, condition[1]))\n                            ? 1\n                            : 0)\n                    );\n                case 'before_hour':\n                    return (\n                        matches +\n                        (isBefore(\n                            event_date,\n                            setHours(event_date, condition[1])\n                        )\n                            ? 1\n                            : 0)\n                    );\n                case 'min_length':\n                    return (\n                        matches +\n                        (event.duration >= stringToMinutes(condition[1])\n                            ? 1\n                            : 0)\n                    );\n                case 'max_length':\n                    return (\n                        matches +\n                        (event.duration <= stringToMinutes(condition[1])\n                            ? 1\n                            : 0)\n                    );\n                case 'visitor_type':\n                    return (\n                        matches +\n                        (event.ext('visitor_type') === condition[1] ? 1 : 0)\n                    );\n                default:\n                    return matches + 1;\n            }\n        }, 0);\n\n    for (const rule of rules) {\n        if (isRuleMatch(rule)) {\n            if (countMatches(rule) < rule.rules.length) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, combineLatest, of } from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    filter,\n    map,\n    shareReplay,\n    switchMap,\n    tap,\n} from 'rxjs/operators';\nimport {\n    queryAssetCategories,\n    queryAssets,\n    queryGroupAvailability,\n} from './assets.fn';\nimport { queryBookings } from 'libs/bookings/src/lib/bookings.fn';\nimport {\n    addMinutes,\n    endOfDay,\n    endOfMinute,\n    getUnixTime,\n    startOfDay,\n    startOfMinute,\n} from 'date-fns';\nimport { AssetGroup } from './asset.class';\nimport { updateAssetGroupList } from './asset-group.pipe';\nimport { OrganisationService } from '@placeos/organisation';\nimport { assetAvailable, getAssetRulesForZone } from './asset.utilities';\nimport { PlaceMetadata, showMetadata } from '@placeos/ts-client';\nimport { unique } from '@placeos/common';\n\nexport interface AssetOptions {\n    zone?: string;\n    date: number;\n    duration?: number;\n    ignore?: string[];\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class AssetStateService {\n    private _options = new BehaviorSubject<AssetOptions>({ date: Date.now() });\n    private _search = new BehaviorSubject<string>('');\n    private _category = new BehaviorSubject<string[]>([]);\n    private _loading = new BehaviorSubject<string>('');\n\n    public readonly search = this._search.asObservable();\n    public readonly category = this._category.asObservable();\n    public readonly options = this._options.asObservable();\n    public readonly loading = this._loading.asObservable();\n\n    public readonly rules = combineLatest([\n        this._options,\n        this._org.active_building,\n    ]).pipe(\n        filter(([_, bld]) => !!bld),\n        debounceTime(300),\n        switchMap(([options, bld]) => {\n            this._loading.next(this._loading.getValue() + '[Rules]');\n            return getAssetRulesForZone(bld.id || options.zone || '');\n        }),\n        tap((_) =>\n            this._loading.next(\n                this._loading.getValue().replace(/\\[Rules\\]/g, '')\n            )\n        ),\n        shareReplay(1)\n    );\n\n    public readonly asset_list = of(0).pipe(\n        switchMap(() => {\n            this._loading.next(this._loading.getValue() + '[Assets]');\n            return queryAssets();\n        }),\n        tap((_) =>\n            this._loading.next(\n                this._loading.getValue().replace(/\\[Assets\\]/g, '')\n            )\n        ),\n        shareReplay(1)\n    );\n\n    public readonly asset_bookings = this._options.pipe(\n        debounceTime(300),\n        switchMap(({ zone, date }) => {\n            this._loading.next(this._loading.getValue() + '[Bookings]');\n            return queryBookings({\n                zones: zone || '',\n                period_start: getUnixTime(startOfDay(date)),\n                period_end: getUnixTime(endOfDay(date)),\n                type: 'asset-request',\n            });\n        }),\n        tap((_) =>\n            this._loading.next(\n                this._loading.getValue().replace(/\\[Bookings\\]/g, '')\n            )\n        ),\n        shareReplay(1)\n    );\n\n    public readonly available_groups = combineLatest([\n        this._options,\n        this._org.active_building,\n    ]).pipe(\n        debounceTime(300),\n        switchMap(([{ zone, date, duration, ignore }, bld]) => {\n            return queryGroupAvailability(\n                {\n                    zones: bld.id || zone || '',\n                    period_start: getUnixTime(startOfMinute(date)),\n                    period_end: getUnixTime(\n                        endOfMinute(addMinutes(date, duration || 30))\n                    ),\n                    type: 'asset-request',\n                    rejected: false,\n                } as any,\n                ignore\n            ).pipe(catchError(() => of([] as AssetGroup[])));\n        }),\n        map((list) => list.sort((a, b) => a.name.localeCompare(b.name))),\n        tap((_) => updateAssetGroupList(_)),\n        shareReplay(1)\n    );\n\n    public readonly category_list = this._org.active_building.pipe(\n        switchMap((bld) => queryAssetCategories({ zone_id: bld.id })),\n        map((_) => _.sort((a, b) => a.name.localeCompare(b.name))),\n        shareReplay(1)\n    );\n\n    public readonly filtered_assets = combineLatest([\n        this._search,\n        this._category,\n        this.available_groups,\n        this.rules,\n    ]).pipe(\n        map(([search, category, assets, rules]) => {\n            const s = search.toLowerCase();\n            let list = assets.filter(\n                (_) =>\n                    _.assets?.length &&\n                    (!category.length || category.includes(_.category_id)) &&\n                    (_.name.toLowerCase().includes(s) ||\n                        _.description.toLowerCase().includes(s)) &&\n                    assetAvailable(_, rules, this._options.getValue() as any)\n            );\n            return list;\n        }),\n        shareReplay(1)\n    );\n\n    public readonly settings = combineLatest([this._org.active_building]).pipe(\n        filter(([_]) => !!_),\n        switchMap(([_]) =>\n            showMetadata(_.id, 'assets-settings').pipe(\n                catchError((_) => of({} as PlaceMetadata))\n            )\n        ),\n        map((_) => (_.details as Record<string, any>) || {}),\n        shareReplay(1)\n    );\n    public readonly disabled_rooms = this.settings.pipe(\n        map((_) => _.disabled_rooms || [])\n    );\n\n    constructor(private _org: OrganisationService) {}\n\n    public setSearch(value: string) {\n        this._search.next(`${value}`);\n    }\n\n    public toggleCategory(value: string) {\n        const categories = this._category.getValue();\n        if (categories.includes(value)) {\n            this._category.next(categories.filter((_) => _ !== value));\n        } else {\n            this._category.next([...categories, value]);\n        }\n    }\n\n    public getOptions() {\n        return this._options.getValue();\n    }\n\n    public setOptions(options: Partial<AssetOptions>) {\n        this._options.next({ ...this._options.value, ...options });\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Event, NavigationEnd, Router } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { getModule, showMetadata } from '@placeos/ts-client';\nimport {\n    BehaviorSubject,\n    combineLatest,\n    forkJoin,\n    merge,\n    Observable,\n    of,\n    timer,\n} from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    distinctUntilChanged,\n    distinctUntilKeyChanged,\n    filter,\n    map,\n    shareReplay,\n    startWith,\n    switchMap,\n    tap,\n} from 'rxjs/operators';\nimport { differenceInDays, startOfDay } from 'date-fns';\nimport {\n    AsyncHandler,\n    BookingRuleset,\n    currentUser,\n    filterResourcesFromRules,\n    flatten,\n    getInvalidFields,\n    notifyError,\n    unique,\n} from '@placeos/common';\nimport { SettingsService } from 'libs/common/src/lib/settings.service';\n\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport {\n    createBookingsForEvent,\n    queryResourceAvailability,\n    saveBooking,\n} from 'libs/bookings/src/lib/bookings.fn';\nimport { CalendarEvent } from './event.class';\nimport { querySpaceAvailability, saveEvent, showEvent } from './events.fn';\nimport { generateEventForm, newCalendarEventFromBooking } from './utilities';\nimport { newBookingFromCalendarEvent } from 'libs/bookings/src/lib/booking.utilities';\nimport { PaymentsService } from 'libs/payments/src/lib/payments.service';\nimport { EventLinkModalComponent } from './event-link-modal.component';\nimport { requestSpacesForZone } from 'libs/spaces/src/lib/space.utilities';\nimport { periodInFreeTimeSlot } from './helpers';\nimport { SpacePipe } from 'libs/spaces/src/lib/space.pipe';\nimport { validateAssetRequestsForResource } from 'libs/assets/src/lib/assets.fn';\nimport { User } from 'libs/users/src/lib/user.class';\nimport { AssetStateService } from 'libs/assets/src/lib/asset-state.service';\nimport { removeEvent } from './events.fn';\nimport { AssetRequest } from 'libs/assets/src/lib/asset-request.class';\n\nconst BOOKING_URLS = [\n    'book/rooms',\n    'book/spaces',\n    'book/meeting',\n    'schedule/view',\n    'confirm/success',\n    'upcoming',\n];\n\nconst MINUTES = 60 * 1000;\n\nexport type EventFlowView =\n    | 'form'\n    | 'find'\n    | 'catering'\n    | 'confirm'\n    | 'success';\n\nexport interface EventFlowOptions {\n    /** Calendar to associate event with */\n    calendar_id?: string;\n    /** List of features to filter spaces on */\n    features: string[];\n    /** List of zones to filter spaces on */\n    zone_ids?: string[];\n    /** Minimum number of attendees to filter space on */\n    capacity?: number;\n    /** Whether to only show favourite rooms */\n    show_fav?: boolean;\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class EventFormService extends AsyncHandler {\n    private _view = new BehaviorSubject<EventFlowView>('form');\n    private _options = new BehaviorSubject<EventFlowOptions>({\n        zone_ids: [],\n        features: [],\n    });\n    private _form = generateEventForm(undefined, this._settings);\n    private _date = new BehaviorSubject(Date.now());\n    private _event = new BehaviorSubject<CalendarEvent>(null);\n    private _loading = new BehaviorSubject<string>('');\n    private _changed = new BehaviorSubject<number>(0);\n    private _space_pipe: SpacePipe;\n\n    public last_success: CalendarEvent = new CalendarEvent(\n        JSON.parse(sessionStorage.getItem('PLACEOS.last_booked_event') || '{}'),\n    );\n    public readonly loading = this._loading.asObservable();\n    public readonly options = this._options.asObservable();\n\n    public get options_value() {\n        return this._options.getValue();\n    }\n\n    public get is_multiday() {\n        return this._event.getValue()?.duration > 24 * 60;\n    }\n\n    public readonly booking_rules: Observable<\n        Record<string, BookingRuleset[]>\n    > = this._org.building_list.pipe(\n        switchMap((list) =>\n            Promise.all(\n                list.map((bld) =>\n                    showMetadata(bld.id, 'room_booking_rules').toPromise(),\n                ),\n            ),\n        ),\n        map((building_rules) => {\n            const mapping = {};\n            for (const rules of building_rules) {\n                mapping[rules.id] =\n                    rules.details instanceof Array ? rules.details : [];\n            }\n            return mapping;\n        }),\n        shareReplay(1),\n    );\n\n    public readonly spaces: Observable<Space[]> = combineLatest([\n        this._options.pipe(distinctUntilKeyChanged('zone_ids')),\n        this._org.active_region.pipe(\n            filter((_) => !!_),\n            distinctUntilKeyChanged('id'),\n        ),\n        this._org.active_building.pipe(\n            filter((_) => !!_),\n            distinctUntilKeyChanged('id'),\n        ),\n    ]).pipe(\n        debounceTime(300),\n        tap((_) => this.unsubWith('bind:')),\n        switchMap(([{ zone_ids }]) => {\n            this._loading.next('Loading space list for location...');\n            const use_region = this._settings.get('app.use_region');\n            if (!zone_ids?.length) {\n                zone_ids = [\n                    (use_region\n                        ? this._org.region?.id\n                        : this._org.building?.id) || this._org.building?.id,\n                ];\n            }\n            return forkJoin(\n                zone_ids.map((id) =>\n                    requestSpacesForZone(id).pipe(catchError(() => of([]))),\n                ),\n            );\n        }),\n        map((l) => flatten(l)),\n        tap((_) => this._loading.next('')),\n        shareReplay(1),\n    );\n\n    public readonly features = this.spaces.pipe(\n        map((l) => unique(flatten(l.map((_) => _.features)))),\n    );\n\n    public readonly filtered_spaces = combineLatest([\n        this.spaces,\n        this.options,\n    ]).pipe(\n        map(([spaces, { show_fav, features, capacity }]) =>\n            spaces\n                .filter((s: Space) => {\n                    const domain = (currentUser()?.email || '@').split('@')[1];\n                    const zone = (this._settings.get(\n                        'app.events.restrict_spaces',\n                    ) || {})[domain];\n                    const limit_map =\n                        this._settings.get('app.events.limit_spaces') || {};\n                    const limited_zones = Object.keys(limit_map);\n                    const zone_limit = s.zones.find((_) =>\n                        limited_zones.includes(_),\n                    );\n                    return (\n                        s.bookable &&\n                        (!zone || s.zones.includes(zone)) &&\n                        (!zone_limit || limit_map[zone_limit] === domain) &&\n                        (!show_fav || this.favorite_spaces.includes(s.id)) &&\n                        features.every((f) => s.features.includes(f)) &&\n                        s.capacity >= Math.max(0, capacity || 0)\n                    );\n                })\n                .slice(0, Math.min(100, spaces.length)),\n        ),\n        shareReplay(1),\n    );\n\n    private _space_bookings = combineLatest([\n        this.spaces,\n        this.filtered_spaces,\n    ]).pipe(\n        distinctUntilChanged(([s1], [s2]) => s1 !== s2),\n        switchMap(([_, list]) => {\n            return combineLatest(\n                (list || []).map((_) => {\n                    const binding = getModule(_.id, 'Bookings').binding(\n                        'bookings',\n                    );\n                    const obs = binding\n                        .listen()\n                        .pipe(\n                            map((_) =>\n                                (_ || []).map((i) => new CalendarEvent(i)),\n                            ),\n                        );\n                    if (!this.hasSubscription(`bind:${_.id}`)) {\n                        this.subscription(`bind:${_.id}`, binding.bind());\n                    }\n                    return obs;\n                }),\n            );\n        }),\n        shareReplay(1),\n    );\n\n    public readonly current_available_spaces = combineLatest([\n        this.filtered_spaces,\n        this._space_bookings,\n        this.booking_rules,\n        merge(this.form.valueChanges, timer(1000)),\n        this._changed,\n    ]).pipe(\n        debounceTime(300),\n        map(([list, bookings, booking_rules]) => {\n            this._loading.next('Updating available spaces...');\n            let { ical_uid, date, duration, all_day } =\n                this._form.getRawValue();\n            list = filterResourcesFromRules(\n                list,\n                { date, duration, resource: null, host: currentUser() },\n                booking_rules[this._org.building?.id] || [],\n            ) as any;\n            return (list || [])\n                .filter((_, idx) => {\n                    const start = all_day ? startOfDay(date).valueOf() : date;\n                    const end =\n                        start +\n                        (all_day ? Math.max(24 * 60, duration) : duration) *\n                            MINUTES;\n                    let booking_list = bookings[idx] || [];\n                    if (this.last_success?.system?.id === _.id) {\n                        booking_list = [...booking_list, this.last_success];\n                    }\n                    return periodInFreeTimeSlot(\n                        start,\n                        end,\n                        booking_list.filter((_) => _.ical_uid !== ical_uid),\n                    );\n                })\n                .sort((a, b) => a.capacity - b.capacity);\n        }),\n        tap((_) => this._loading.next('')),\n        shareReplay(1),\n    );\n\n    public readonly future_available_spaces: Observable<Space[]> =\n        combineLatest([\n            this.filtered_spaces,\n            this.booking_rules,\n            this.form.valueChanges.pipe(debounceTime(400), startWith({})),\n        ]).pipe(\n            filter(() => !this._loading.getValue()),\n            debounceTime(500),\n            switchMap(([spaces, booking_rules]) => {\n                if (!spaces.length) return of([]);\n                this._loading.next('Retrieving available spaces...');\n                let { date, duration, all_day } = this._form.getRawValue();\n                const availability_method = this.has_calendar\n                    ? querySpaceAvailability\n                    : queryResourceAvailability;\n                spaces = filterResourcesFromRules(\n                    spaces,\n                    { date, duration, resource: null, host: currentUser() },\n                    booking_rules[this._org.building?.id] || [],\n                ) as any;\n                return availability_method(\n                    spaces.map(({ id }) => id),\n                    all_day ? startOfDay(date).valueOf() : date,\n                    all_day ? Math.max(24 * 60, duration) : duration,\n                    this?.event?.resources[0]?.id ||\n                        this.event?.system?.id ||\n                        this.event?.id ||\n                        undefined,\n                    undefined,\n                    [this.event?.date, this.event?.duration],\n                ).pipe(\n                    map((availability) => {\n                        var list = spaces.filter((_, i) => availability[i]);\n                        list = filterResourcesFromRules(\n                            list,\n                            {\n                                date,\n                                duration,\n                                resource: null,\n                                host: currentUser(),\n                            },\n                            booking_rules[this._org.building?.id] || [],\n                        ) as any;\n                        return list;\n                    }),\n                    catchError((_) => []),\n                );\n            }),\n            tap((_) => this._loading.next('')),\n            shareReplay(1),\n        );\n\n    public readonly available_spaces = this._date.pipe(\n        switchMap((d) => {\n            const diff = Math.abs(differenceInDays(d, Date.now()));\n            const cache_length =\n                this._settings.get('app.events.cache_duration_in_days') || 14;\n            return diff < cache_length\n                ? this.current_available_spaces\n                : this.future_available_spaces;\n        }),\n        shareReplay(1),\n    );\n\n    public get view() {\n        return this._view.getValue();\n    }\n    public get form() {\n        return this._form;\n    }\n    public get event() {\n        return this._event.getValue();\n    }\n\n    public get favorite_spaces() {\n        return this._settings.get<string[]>('favourite_spaces') || [];\n    }\n\n    public get has_calendar() {\n        return this._settings.get('app.events.use_bookings') !== true;\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _router: Router,\n        private _payments: PaymentsService,\n        private _settings: SettingsService,\n        private _assets: AssetStateService,\n        private _dialog: MatDialog,\n    ) {\n        super();\n        this._space_pipe = new SpacePipe(this._org);\n        this.subscription(\n            'router.events',\n            this._router.events.subscribe((event: Event) => {\n                if (\n                    event instanceof NavigationEnd &&\n                    !BOOKING_URLS.some((_) => event.url.includes(_))\n                ) {\n                    this.clearForm();\n                }\n            }),\n        );\n        const previous = {};\n        this.subscription(\n            'form_change',\n            this._form.valueChanges.subscribe(({ date, duration, assets }) => {\n                if (\n                    (date && date !== previous['date']) ||\n                    (duration && duration !== previous['duration'])\n                ) {\n                    this._assets.setOptions({\n                        date: this.form.value.date,\n                        duration: this.form.value.duration,\n                    });\n                    previous['date'] = date;\n                    previous['duration'] = duration;\n                }\n                if (date && date !== this._date.getValue()) {\n                    this._date.next(date);\n                }\n                this.storeForm();\n            }),\n        );\n    }\n\n    public listenForStatusChanges() {\n        this.subscription('status:rooms', this.available_spaces.subscribe());\n    }\n\n    public setView(value: EventFlowView) {\n        this.timeout('set_view', () => this._view.next(value), 50);\n    }\n\n    public setOptions(value: Partial<EventFlowOptions>) {\n        this._options.next({ ...this._options.getValue(), ...value });\n    }\n\n    public async newForm(\n        event: CalendarEvent = new CalendarEvent({\n            all_day: this._settings.get('app.events.all_day_default'),\n        }),\n    ) {\n        this._event.next(event);\n        if (event.recurring_event_id) {\n            const master = await showEvent(event.recurring_event_id)\n                .toPromise()\n                .catch((_) => null);\n            if (master) {\n                (this._event.getValue() as any).recurrence = {\n                    ...master.recurrence,\n                    _pattern: master.recurrence.pattern,\n                };\n            }\n        }\n        this._assets.setOptions({\n            ignore: flatten(\n                event.linked_bookings?.map(\n                    (_) => _.asset_ids || [_.asset_id],\n                ) || [],\n            ),\n        });\n        for (const idx in event.resources) {\n            const space = event.resources[idx];\n            event.resources[idx] = await this._space_pipe.transform(\n                space.id || space.email,\n            );\n        }\n        this._date.next(event.date);\n        this.timeout(\n            'post-event-form',\n            () => {\n                this._form.patchValue({\n                    date: event.date || this._form.value.date,\n                });\n            },\n            1000,\n        );\n        this.resetForm();\n    }\n\n    public resetForm() {\n        this._form.reset();\n        const event =\n            this._event.getValue() ||\n            ({ extension_data: {} } as Partial<CalendarEvent>);\n\n        this._assets.setOptions({\n            ignore: flatten(\n                event.linked_bookings?.map(\n                    (_) => _.asset_ids || [_.asset_id],\n                ) || [],\n            ),\n        });\n        const has_catering = !!event.extension_data.catering[0];\n        this._form.patchValue({\n            ...event.extension_data,\n            ...event,\n            duration: event.duration >= 12 * 60 ? 30 : event.duration,\n            organiser:\n                event?.organiser ||\n                currentUser() ||\n                new User({ email: event?.host }),\n            catering_charge_code:\n                event.extension_data.catering[0]?.charge_code ||\n                (event.id && has_catering ? ' ' : ''),\n            assets: (event.extension_data.assets || []).map(\n                (_) => new AssetRequest({ ..._, event }),\n            ),\n        });\n        this._form.patchValue({\n            date: event.date || this._form.value.date,\n            date_end: event.date_end || this._form.value.date_end,\n        });\n        this._options.next({ features: [] });\n        this.storeForm();\n    }\n\n    public clearForm() {\n        sessionStorage.removeItem('PLACEOS.event_form');\n        this.unsubWith('status:');\n        this.unsubWith('bind:');\n        this.newForm();\n    }\n\n    public storeForm() {\n        sessionStorage.setItem(\n            'PLACEOS.event_form',\n            JSON.stringify(this._form.getRawValue() || {}),\n        );\n    }\n\n    public loadForm() {\n        if (!sessionStorage.getItem('PLACEOS.event_form')) {\n            return this.newForm();\n        }\n        const form_data = JSON.parse(\n            sessionStorage.getItem('PLACEOS.event_form') || '{}',\n        );\n        if (form_data.id && form_data.id !== this._event.getValue()?.id) {\n            showEvent(form_data.id).subscribe((event) => {\n                this._event.next(event);\n                this._assets.setOptions({\n                    ignore: flatten(\n                        event.linked_bookings?.map(\n                            (_) => _.asset_ids || [_.asset_id],\n                        ) || [],\n                    ),\n                });\n            });\n        }\n        this._form.patchValue({ ...form_data });\n    }\n\n    public readonly cancelPostForm = () => this.unsub('post-event-form');\n\n    public openEventLinkModal(force: boolean = false) {\n        const form = this._form;\n        form.markAllAsTouched();\n        if (!form.valid && !force) return;\n        const event = new CalendarEvent({ ...form.getRawValue(), assets: [] });\n        const ref = this._dialog.open(EventLinkModalComponent, { data: event });\n        ref.afterClosed().subscribe((d) =>\n            d ? this._router.navigate(['/']) : '',\n        );\n    }\n\n    public postForm(\n        force: boolean = false,\n        ignore_space_check: string[] = [],\n        ignore_owner: boolean = false,\n    ) {\n        return new Promise<CalendarEvent>(async (resolve, reject) => {\n            this._loading.next('Creating event...');\n            const form = this._form;\n            form.markAllAsTouched();\n            const event = this.event || new CalendarEvent();\n            if (!form.valid && !force) {\n                this._loading.next('');\n                return reject(\n                    `Some form fields are invalid. [${getInvalidFields(\n                        form,\n                    ).join(', ')}]`,\n                );\n            }\n            const ical_uid = this.event?.ical_uid;\n            let value = this._form.getRawValue();\n            let {\n                id,\n                host,\n                date,\n                duration,\n                creator,\n                all_day,\n                assets,\n                recurrence,\n            } = value;\n            let spaces = form.get('resources')?.value || [];\n            if (ignore_space_check.length) {\n                spaces = spaces.filter(\n                    (_) =>\n                        !ignore_space_check.includes(_.email) &&\n                        !ignore_space_check.includes(_.id),\n                );\n            }\n            let catering = form.get('catering')?.value || [];\n            if (recurrence?._pattern && recurrence?._pattern !== 'none') {\n                this.form.patchValue({ recurring: true });\n                value = this._form.getRawValue();\n            }\n            let changed_times = false;\n            let changed_spaces = spaces.some(\n                (s) => !event.resources?.find((_) => _.id === s.id),\n            );\n            if (\n                (!id || date !== event.date || duration !== event.duration) &&\n                spaces.length\n            ) {\n                changed_times = true;\n                await this.checkSelectedSpacesAreAvailable(\n                    spaces,\n                    all_day ? startOfDay(date).valueOf() : date,\n                    all_day ? Math.max(24 * 60, duration) : duration,\n                    ical_uid || id || '',\n                ).catch((_) => {\n                    this._loading.next('');\n                    reject(_);\n                    throw _;\n                });\n            }\n            spaces = form.get('resources')?.value || [];\n            const is_owner =\n                host === currentUser()?.email ||\n                creator === currentUser()?.email;\n            if (\n                !spaces.length &&\n                this._settings.get('app.events.no_space_resource')\n            ) {\n                const space = await this._space_pipe.transform(\n                    this._settings.get('app.events.no_space_resource'),\n                );\n                spaces.push(space);\n            }\n            const attendees = unique(\n                [...value.attendees, value.organiser || currentUser()],\n                'email',\n            );\n            if (!spaces.length && attendees.find((_) => _.is_external)) {\n                this._loading.next('');\n                const message =\n                    'External attendees require a space to be booked';\n                reject(message);\n                throw message;\n            }\n            const space_id = spaces[0]?.id;\n            const query: any = id\n                ? {\n                      system_id:\n                          this.event?.resources[0]?.id ||\n                          this.event?.system?.id ||\n                          space_id,\n                  }\n                : {};\n            if (is_owner && !ignore_owner) query.calendar = host || creator;\n            if (this._payments.payment_module && spaces.length) {\n                const receipt = await this._payments.makePayment({\n                    type: 'space',\n                    resource_name: spaces[0].display_name || spaces[0].name,\n                    date,\n                    duration,\n                    all_day,\n                });\n                if (!receipt?.success) return this._loading.next('');\n                (value as any).extension_data = {\n                    invoice: receipt,\n                    invoice_id: receipt.invoice_id,\n                };\n            }\n            const d = value.date;\n            for (const order of catering) {\n                order.notes = value.catering_notes;\n                order.charge_code = value.catering_charge_code;\n            }\n            if (spaces.length) {\n                let [setup, breakdown] = [0, 0];\n                for (const space of spaces) {\n                    const overflow = this._settings.get(\n                        `app.events.overflow.${space.id}`,\n                    );\n                    if (overflow?.setup) {\n                        setup = Math.max(setup, overflow.setup);\n                    }\n                    if (overflow?.breakdown) {\n                        breakdown = Math.max(breakdown, overflow.breakdown);\n                    }\n                }\n                (value as any).setup = value.setup_time || setup;\n                (value as any).breakdown = value.breakdown_time || breakdown;\n                (value as any).setup_time = value.setup_time || setup;\n                (value as any).breakdown_time =\n                    value.breakdown_time || breakdown;\n            }\n            const processed_assets = (assets || []).map((_) =>\n                new AssetRequest(_).toJSON(),\n            );\n            const result = await this._makeBooking(\n                new CalendarEvent({\n                    ...value,\n                    old_system: this.event?.system,\n                    host:\n                        this._settings.get('app.events.force_host') ||\n                        (this._settings.get('app.events.room_as_host')\n                            ? value.resources[0].email\n                            : '') ||\n                        value.host,\n                    title: value.title || 'Space Booking',\n                    attendees: attendees.map((_) => {\n                        const v = { ..._ };\n                        delete v.visit_expected;\n                        return v;\n                    }),\n                    date: d,\n                    catering,\n                    assets: processed_assets,\n                    extension_data:\n                        this._settings.get('app.events.force_host') ||\n                        this._settings.get('app.events.room_as_host')\n                            ? {\n                                  host_override: value.host,\n                                  department:\n                                      value.organiser?.department ||\n                                      currentUser()?.department,\n                              }\n                            : {\n                                  department:\n                                      value.organiser?.department ||\n                                      currentUser()?.department,\n                              },\n                }),\n                query,\n            ).catch((e) => {\n                reject(e);\n                this._loading.next('');\n                throw e;\n            });\n            const domain = (currentUser()?.email || '@').split('@')[1];\n            const visitors = attendees.filter(\n                (user) =>\n                    user.is_external &&\n                    user.email !== event.host &&\n                    !user.email.includes(domain) &&\n                    user.visit_expected,\n            );\n            let creating_assets = false;\n            const on_error = async (e) => {\n                if (!this.form.value.id) {\n                    await removeEvent(\n                        result.id,\n                        spaces.length\n                            ? {\n                                  calendar:\n                                      this.form.value.host ||\n                                      currentUser()?.email,\n                                  system_id: spaces[0].id,\n                              }\n                            : {},\n                    ).toPromise();\n                    console.warn(\"Couldn't update asset requests\", e);\n                    if (e?.status === 409) {\n                        notifyError(\n                            'Some assets are already booked for the selected time',\n                        );\n                    } else notifyError('Unable to book the selected assets.');\n                } else if (creating_assets) {\n                    notifyError(\n                        `Unable to update all asset requests for event.\\n${e}`,\n                    );\n                    return;\n                }\n                this._loading.next('');\n                throw e;\n            };\n            if (visitors.length) {\n                await createBookingsForEvent(\n                    result,\n                    'visitor',\n                    visitors as any,\n                ).catch(on_error);\n            }\n\n            if (assets?.length || event.extension_data.assets?.length) {\n                creating_assets = true;\n                const requests = await validateAssetRequestsForResource(\n                    result,\n                    {\n                        date,\n                        duration,\n                        host,\n                        all_day,\n                        location_name:\n                            spaces[0]?.display_name || spaces[0]?.name || '',\n                        location_id: spaces[0]?.id || '',\n                        zones: unique([\n                            this._org.organisation.id,\n                            this._org.region?.id,\n                            this._org.building?.id,\n                            ...spaces[0]?.zones,\n                        ]).filter((_) => !!_),\n                        reset_state: changed_times,\n                    },\n                    assets,\n                    changed_spaces || changed_times,\n                ).catch(on_error);\n                if (!requests) throw 'Unable to validate asset requests';\n                await requests();\n                creating_assets = false;\n            }\n            this.clearForm();\n            this.last_success = result;\n            sessionStorage.setItem(\n                'PLACEOS.last_booked_event',\n                JSON.stringify(result),\n            );\n            this.setView('success');\n            this.timeout('post_finshed', () => this._changed.next(Date.now()));\n            resolve(result);\n            this._loading.next('');\n        });\n    }\n\n    private async _makeBooking(\n        event: CalendarEvent,\n        query: Record<string, any>,\n    ) {\n        this._updateVisitorList(event.attendees);\n        return (\n            !this.has_calendar\n                ? saveBooking(\n                      newBookingFromCalendarEvent({\n                          ...event.toJSON(),\n                          status: this._settings.get('app.bookings.no_approval')\n                              ? 'approved'\n                              : 'tentative',\n                      } as any),\n                  ).pipe(map((_) => newCalendarEventFromBooking(_)))\n                : saveEvent(event, query)\n        ).toPromise();\n    }\n\n    private async checkSelectedSpacesAreAvailable(\n        spaces: Space[],\n        date: number,\n        duration: number,\n        ignore?: string,\n    ) {\n        if (!spaces?.length) return true;\n        if (this.has_calendar) {\n            const response = await querySpaceAvailability(\n                spaces.map(({ id }) => id),\n                date,\n                duration,\n                this?.event?.resources[0]?.id ||\n                    this.event?.system?.id ||\n                    this.event?.id ||\n                    undefined,\n                undefined,\n                [this.event?.date, this.event?.duration],\n            ).toPromise();\n            if (!response.every((_) => _)) {\n                throw `${\n                    spaces.length > 1\n                        ? 'The selected space'\n                        : 'Some of the selected spaces'\n                } is not available at the selected time`;\n            }\n        } else {\n            const availability = await queryResourceAvailability(\n                spaces.map((_) => _.id),\n                date,\n                duration,\n                ignore,\n            ).toPromise();\n            if (!availability.every((_) => _))\n                throw `${\n                    spaces.length > 1\n                        ? 'The selected space'\n                        : 'Some of the selected spaces'\n                } are not available at the selected time`;\n        }\n        return true;\n    }\n\n    private _updateVisitorList(attendees: User[]) {\n        const visitors = attendees.filter((user) => user.is_external);\n        if (!visitors?.length) return;\n        const old_visitors = this._settings.get('visitor-invitees') || [];\n        this._settings.saveUserSetting(\n            'visitor-invitees',\n            unique([\n                ...old_visitors.filter((_) => !_.includes(_.email)),\n                ...visitors.map(\n                    (_) => `${_.email}|${_.name}|${_.organisation}`,\n                ),\n            ]),\n        );\n    }\n}\n","import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { current_user, currentUser } from '@placeos/common';\nimport { CalendarEvent } from 'libs/events/src/lib/event.class';\nimport { endInFuture } from 'libs/events/src/lib/validators';\nimport {\n    createViewer,\n    getViewer,\n    Point,\n    removeViewer,\n} from '@placeos/svg-viewer';\nimport { Booking } from './booking.class';\nimport {\n    addMinutes,\n    differenceInMinutes,\n    roundToNearestMinutes,\n} from 'date-fns';\n\nfunction setBookingAsset(form: FormGroup, resource: any) {\n    if (!resource) return form.patchValue({ asset_id: undefined });\n    form.patchValue(\n        {\n            asset_id: resource.id,\n            asset_name: resource.name,\n            map_id: resource.map_id || resource.id,\n            description: resource.name,\n            zones: resource.zone\n                ? [resource.zone?.parent_id, resource.zone?.id]\n                : [],\n            booking_asset: resource,\n        },\n        { emitEvent: false },\n    );\n}\n\nexport function generateBookingForm(booking: Booking = new Booking()) {\n    const form = new FormGroup({\n        id: new FormControl(booking.id || ''),\n        parent_id: new FormControl(booking.parent_id || ''),\n        event_id: new FormControl(booking.event_id || ''),\n        ical_uid: new FormControl(booking.extension_data.ical_uid || ''),\n        date: new FormControl(booking.date, [Validators.required]),\n        date_end: new FormControl(booking.date_end),\n        all_day: new FormControl(booking.all_day ?? false),\n        name: new FormControl(\n            booking.extension_data.name || booking.asset_name || '',\n        ),\n        duration: new FormControl(booking.duration, [endInFuture]),\n        booking_type: new FormControl(booking.booking_type),\n        zones: new FormControl(booking.zones),\n        title: new FormControl(booking.title),\n        description: new FormControl(booking.description),\n        booking_asset: new FormControl(null),\n        resources: new FormControl([]),\n        company: new FormControl(''),\n        asset_id: new FormControl(booking.asset_id, [Validators.required]),\n        asset_name: new FormControl(booking.description),\n        assets: new FormControl(booking.extension_data?.assets || []),\n        attendees: new FormControl(booking.attendees || []),\n        map_id: new FormControl(booking.extension_data?.map_id),\n        featured: new FormControl(booking.extension_data?.featured || false),\n        user: new FormControl(currentUser()),\n        user_id: new FormControl(booking.user_id),\n        group: new FormControl(booking.group),\n        user_email: new FormControl(booking.user_email),\n        user_name: new FormControl(booking.user_name),\n        timezone: new FormControl(booking.timezone || ''),\n        booked_by: new FormControl(currentUser()),\n        booked_by_id: new FormControl(booking.booked_by_id),\n        booked_by_email: new FormControl(booking.booked_by_email),\n        secondary_resource: new FormControl(\n            booking.extension_data?.other_asset_type ||\n                booking.extension_data?.secondary_resource,\n        ),\n        location: new FormControl(booking.extension_data.location || ''),\n        attendance_type: new FormControl(\n            booking.extension_data.attendance_type || 'ANY',\n        ),\n        phone: new FormControl(booking.extension_data.phone || ''),\n        permission: new FormControl(booking.permission || 'PRIVATE'),\n        images: new FormControl(booking.images || []),\n        tags: new FormControl(booking.tags || []),\n        plate_number: new FormControl(\n            booking.extension_data.plate_number || '',\n        ),\n        recurrence_type: new FormControl(booking.recurrence_type || 'none'),\n        recurrence_days: new FormControl(booking.recurrence_days),\n        recurrence_nth_of_month: new FormControl(\n            booking.recurrence_nth_of_month,\n        ),\n        recurrence_interval: new FormControl(booking.recurrence_interval),\n        recurrence_end: new FormControl(booking.recurrence_end),\n        notes: new FormControl(booking.extension_data.notes || ''),\n        update_master: new FormControl(false),\n        self_registered: new FormControl(false),\n    });\n    form.valueChanges.subscribe((v) => {\n        if (form.getRawValue().date < Date.now() && form.value.id) {\n            form.get('date')?.disable({ emitEvent: false });\n        } else {\n            form.get('date')?.enable({ emitEvent: false });\n        }\n    });\n    form.controls.user.valueChanges.subscribe((user) => {\n        if (!user) return;\n        form.patchValue(\n            {\n                user: user,\n                user_id: user?.id,\n                user_email: user?.email,\n                user_name: user?.name,\n            },\n            { emitEvent: false },\n        );\n    });\n    current_user.subscribe((user) => {\n        if (!user) return;\n        form.patchValue(\n            {\n                booked_by: user,\n                booked_by_id: user?.id,\n                booked_by_email: user?.email,\n                name: user?.name,\n            },\n            { emitEvent: false },\n        );\n    });\n    form.controls.resources.valueChanges.subscribe((resources) =>\n        setBookingAsset(form, (resources || [])[0]),\n    );\n    form.controls.duration.valueChanges.subscribe((duration) => {\n        form.patchValue(\n            {\n                date_end: roundToNearestMinutes(\n                    addMinutes(form.getRawValue().date, duration),\n                    { nearestTo: 5, roundingMethod: 'ceil' },\n                ).valueOf(),\n            },\n            { emitEvent: false },\n        );\n    });\n    form.controls.date_end.valueChanges.subscribe((date) => {\n        if (date < addMinutes(form.getRawValue().date, 30).valueOf()) {\n            form.patchValue(\n                {\n                    date_end: roundToNearestMinutes(\n                        addMinutes(form.getRawValue().date, 30),\n                        { nearestTo: 5, roundingMethod: 'ceil' },\n                    ).valueOf(),\n                    duration: 30,\n                },\n                { emitEvent: false },\n            );\n        } else {\n            form.patchValue(\n                {\n                    duration: differenceInMinutes(\n                        date,\n                        form.getRawValue().date,\n                    ),\n                },\n                { emitEvent: false },\n            );\n        }\n    });\n    form.controls.date.valueChanges.subscribe((date) => {\n        form.patchValue(\n            {\n                date_end: roundToNearestMinutes(\n                    addMinutes(date, form.value.duration),\n                    { nearestTo: 5, roundingMethod: 'ceil' },\n                ).valueOf(),\n            },\n            { emitEvent: false },\n        );\n        if (date < Date.now() && !form.value.id) {\n            form.patchValue(\n                {\n                    date: roundToNearestMinutes(Date.now(), {\n                        nearestTo: 5,\n                        roundingMethod: 'ceil',\n                    }).valueOf(),\n                },\n                { emitEvent: false },\n            );\n        }\n    });\n    if (booking.state === 'started') form.get('date').disable();\n    return form;\n}\n\nexport async function findNearbyFeature(\n    map_url: string,\n    centered_at: Point | string,\n    desk_ids: string[] = [],\n): Promise<string> {\n    const element = document.createElement('div');\n    element.style.position = 'absolute';\n    element.style.top = '-9999px';\n    element.style.width = '1000px';\n    element.style.height = '1000px';\n    document.body.appendChild(element);\n    const id = await createViewer({\n        url: map_url,\n        element,\n    });\n    const viewer = getViewer(id);\n    const point = (typeof centered_at === 'string'\n        ? viewer.mappings[centered_at]\n        : centered_at) || { x: 0.5, y: 0.5 };\n    let dist = 10;\n    let closest = '';\n    for (const desk of desk_ids) {\n        const { x, y } = viewer.mappings[desk] || { x: 2, y: 2 };\n        const d = Math.sqrt(\n            (x - point.x) * (x - point.x) + (y - point.y) * (y - point.y),\n        );\n        if (d < dist) {\n            dist = d;\n            closest = desk;\n        }\n    }\n    document.body.removeChild(element);\n    removeViewer(id);\n    return closest;\n}\n\nexport function newBookingFromCalendarEvent(event: CalendarEvent) {\n    return new Booking({\n        id: event.id,\n        user_email: event.host,\n        asset_id: event.system?.id,\n        asset_name: event.system?.display_name || event.system?.name,\n        booking_type: 'room',\n        approved: event.status === 'approved',\n        extension_data: {\n            ...event,\n        },\n    });\n}\n","import { Component, Inject } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { SettingsService } from '@placeos/common';\nimport {\n    EventFlowOptions,\n    EventFormService,\n} from 'libs/events/src/lib/event-form.service';\nimport { Space } from '../space.class';\n\n@Component({\n    selector: 'new-space-select-modal',\n    template: `\n        <div\n            class=\"w-[100vw] h-[100vh] sm:relative sm:w-auto sm:h-auto flex flex-col bg-base-100\"\n        >\n            <header class=\"flex items-center space-x-4 w-full\">\n                <button icon matRipple mat-dialog-close class=\"bg-base-200\">\n                    <app-icon>close</app-icon>\n                </button>\n                <h3 i18n>Find Space</h3>\n                <div class=\"hidden sm:flex items-center justify-end flex-1\">\n                    <button\n                        btn\n                        matRipple\n                        map\n                        class=\"rounded-l rounded-r-none\"\n                        [class.inverse]=\"view !== 'map'\"\n                        (click)=\"view = 'map'\"\n                    >\n                        Map\n                    </button>\n                    <button\n                        btn\n                        matRipple\n                        list\n                        class=\"rounded-r rounded-l-none\"\n                        [class.inverse]=\"view !== 'list'\"\n                        (click)=\"view = 'list'\"\n                    >\n                        List\n                    </button>\n                </div>\n            </header>\n            <main\n                class=\"flex-1 flex items-center divide-x divide-base-200 min-h-[65vh] h-[65vh] sm:max-h-[65vh] sm:max-w-[95vw] w-full overflow-hidden\"\n            >\n                <space-filters\n                    class=\"h-full hidden sm:flex max-w-[20rem] sm:h-[65vh] sm:max-h-full\"\n                    [multiday]=\"multiday\"\n                    [hide_levels]=\"view !== 'list'\"\n                    [viewing_map]=\"view === 'map'\"\n                ></space-filters>\n                <div\n                    class=\"flex flex-col items-center flex-1 w-1/2 h-full sm:h-[65vh]\"\n                >\n                    <space-filters-display\n                        class=\"w-full border-b border-base-200\"\n                        [(view)]=\"view\"\n                    ></space-filters-display>\n                    <space-list\n                        *ngIf=\"view === 'list'; else map_view\"\n                        [active]=\"displayed?.id\"\n                        [selected]=\"selected_ids\"\n                        [favorites]=\"favorites\"\n                        (toggleFav)=\"toggleFavourite($event)\"\n                        (onSelect)=\"displayed = $event\"\n                        class=\"flex-1 h-1/2 bg-base-200\"\n                    ></space-list>\n                </div>\n                <space-details\n                    [space]=\"displayed\"\n                    class=\"h-full w-full sm:h-[65vh] absolute sm:relative flex sm:flex-col sm:max-w-[20rem] z-20 bg-base-100\"\n                    [class.hidden]=\"!displayed\"\n                    [class.inset-0]=\"displayed\"\n                    [hide_map]=\"view === 'map'\"\n                    [active]=\"selected_ids.includes(displayed?.id)\"\n                    (activeChange)=\"setSelected(displayed, $event)\"\n                    [fav]=\"displayed && this.favorites.includes(displayed?.id)\"\n                    (toggleFav)=\"toggleFavourite(displayed)\"\n                    (close)=\"displayed = null\"\n                ></space-details>\n            </main>\n            <footer\n                class=\"flex sm:hidden flex-col-reverse items-center justify-end px-2 pt-2 pb-[5.5rem] border-t border-base-200 w-full\"\n            >\n                <button\n                    btn\n                    matRipple\n                    name=\"spaces-return\"\n                    class=\"inverse sm:hidden w-full\"\n                    *ngIf=\"displayed\"\n                    (click)=\"displayed = null\"\n                    i18n\n                >\n                    Back\n                </button>\n                <button\n                    btn\n                    matRipple\n                    name=\"save-spaces\"\n                    [mat-dialog-close]=\"selected\"\n                    [class.mb-2]=\"displayed\"\n                    class=\"w-full sm:w-32 sm:mb-0\"\n                    i18n\n                >\n                    View List\n                </button>\n            </footer>\n            <footer\n                class=\"hidden sm:flex items-center justify-between p-2 border-t border-base-200 w-full\"\n            >\n                <button\n                    btn\n                    matRipple\n                    name=\"spaces-return\"\n                    [mat-dialog-close]=\"selected\"\n                    class=\"clear text-secondary\"\n                >\n                    <div class=\"flex items-center\">\n                        <app-icon class=\"text-xl\">arrow_back</app-icon>\n                        <div class=\"mr-1 underline\" i18n>Back to form</div>\n                    </div>\n                </button>\n                <p class=\"opacity-60 text-sm\" i18n>\n                    {{ selected.length }} room(s) added\n                </p>\n                <button\n                    btn\n                    matRipple\n                    name=\"toggle-space\"\n                    [disabled]=\"!displayed\"\n                    [class.inverse]=\"isSelected(displayed?.id)\"\n                    (click)=\"setSelected(displayed, !isSelected(displayed?.id))\"\n                >\n                    <div class=\"flex items-center\">\n                        <app-icon class=\"text-xl\">{{\n                            isSelected(displayed?.id) ? 'remove' : 'add'\n                        }}</app-icon>\n                        <div class=\"mr-1\">\n                            {{\n                                isSelected(displayed?.id)\n                                    ? 'Remove from Booking'\n                                    : 'Add to booking'\n                            }}\n                        </div>\n                    </div>\n                </button>\n            </footer>\n        </div>\n        <ng-template #map_view>\n            <space-map\n                class=\"flex-1 h-1/2 w-full\"\n                [selected]=\"selected_ids\"\n                [is_displayed]=\"!!displayed\"\n                [active]=\"displayed?.id\"\n                (onSelect)=\"displayed = $event\"\n            >\n            </space-map>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class NewSpaceSelectModalComponent {\n    public displayed?: Space;\n    public selected: Space[] = [];\n    public view = 'list';\n    public readonly multiday = !!this._data.multiday;\n\n    public get selected_ids() {\n        return this.selected.map((_) => _.id).join(',');\n    }\n\n    public get favorites() {\n        return this._settings.get<string[]>('favourite_spaces') || [];\n    }\n\n    constructor(\n        private _dialog_ref: MatDialogRef<NewSpaceSelectModalComponent>,\n        private _settings: SettingsService,\n        private _event_form: EventFormService,\n        @Inject(MAT_DIALOG_DATA)\n        private _data: {\n            spaces: Space[];\n            options: Partial<EventFlowOptions>;\n            multiday?: boolean;\n        }\n    ) {\n        this.selected = [...(_data.spaces || [])];\n        this._event_form.setOptions(_data.options);\n    }\n\n    public isSelected(id: string) {\n        return id && this.selected_ids.includes(id);\n    }\n\n    public setSelected(item: Space, state: boolean) {\n        const list = this.selected.filter((_) => _.id !== item.id);\n        if (state) list.push(item);\n        this.selected = list;\n        if (!this._settings.get('app.events.allow_multiple_spaces') && state) {\n            this.selected = [item];\n            this._dialog_ref.close([item]);\n        }\n    }\n\n    public toggleFavourite(item: Space) {\n        const fav_list = this.favorites;\n        const new_state = !fav_list.includes(item.id);\n        if (new_state) {\n            this._settings.saveUserSetting('favourite_spaces', [\n                ...fav_list,\n                item.id,\n            ]);\n        } else {\n            this._settings.saveUserSetting(\n                'favourite_spaces',\n                fav_list.filter((_) => _ !== item.id)\n            );\n        }\n    }\n}\n","import { ChangeDetectorRef, Component, Input, forwardRef } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\n\nimport { SettingsService } from 'libs/common/src/lib/settings.service';\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport { NewSpaceSelectModalComponent } from 'libs/spaces/src/lib/space-select-modal/new-space-select-modal.component';\nimport { OrganisationService } from '@placeos/organisation';\nimport { BehaviorSubject } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\n\nconst EMPTY_FAVS: string[] = [];\n\n@Component({\n    selector: `space-list-field`,\n    template: `\n        <div>\n            <div class=\"flex items-center flex-wrap sm:space-x-2 mb-2\">\n                <div class=\"flex-1 min-w-[256px] space-y-2\">\n                    <label i18n>Select Room Size<span>*</span></label>\n                    <div class=\"flex items-center\">\n                        <mat-radio-group\n                            aria-label=\"Select Room Size\"\n                            class=\"space-x-4\"\n                            [(ngModel)]=\"room_size\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                        >\n                            <mat-radio-button [value]=\"1\" i18n>\n                                Min. 2 People\n                            </mat-radio-button>\n                            <mat-radio-button [value]=\"4\" i18n>\n                                Min. 4 People\n                            </mat-radio-button>\n                            <mat-radio-button [value]=\"10\" i18n>\n                                Min. 10 People\n                            </mat-radio-button>\n                        </mat-radio-group>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div list class=\"space-y-2\">\n            <div\n                space\n                class=\"relative p-2 rounded-lg w-full flex items-center shadow border border-base-200\"\n                *ngFor=\"let space of space_list | async\"\n            >\n                <div\n                    class=\"w-24 h-24 rounded-xl bg-base-200 mr-4 overflow-hidden flex items-center justify-center\"\n                >\n                    <img\n                        auth\n                        *ngIf=\"space.images?.length; else placeholder\"\n                        [source]=\"space.images[0]\"\n                        class=\"min-h-full object-cover\"\n                    />\n                    <ng-template #placeholder>\n                        <img\n                            class=\"m-auto\"\n                            src=\"assets/icons/room-placeholder.svg\"\n                        />\n                    </ng-template>\n                </div>\n                <div class=\"sm:space-y-2 pb-4\">\n                    <div class=\"font-medium\">\n                        {{\n                            space.display_name || space.name || 'Meeting Space'\n                        }}\n                    </div>\n                    <div class=\"flex items-center text-sm space-x-2\">\n                        <app-icon class=\"text-blue-500\">place</app-icon>\n                        <p>\n                            {{\n                                space.location ||\n                                    level(space.zones)?.display_name ||\n                                    level(space.zones)?.name\n                            }}\n                        </p>\n                    </div>\n                    <div class=\"flex items-center text-sm space-x-2\">\n                        <app-icon class=\"text-blue-500\">people</app-icon>\n                        <p i18n>\n                            {{ space.capacity < 1 ? 2 : space.capacity }} {\n                            space.capacity, plural, =1 { Person } other { People\n                            } }\n                        </p>\n                    </div>\n                    <div\n                        class=\"absolute bottom-0 right-0 flex items-center justify-end text-xs\"\n                    >\n                        <button\n                            btn\n                            matRipple\n                            name=\"edit-space\"\n                            class=\"clear\"\n                            (click)=\"changeSpaces(space)\"\n                        >\n                            <div class=\"flex items-center space-x-2\" i18n>\n                                <app-icon>edit</app-icon>\n                                Change\n                            </div>\n                        </button>\n                        <button\n                            btn\n                            matRipple\n                            name=\"remove-space\"\n                            class=\"clear\"\n                            (click)=\"removeSpace(space)\"\n                        >\n                            <div class=\"flex items-center space-x-2\" i18n>\n                                <app-icon>close</app-icon>\n                                Remove\n                            </div>\n                        </button>\n                    </div>\n                </div>\n                <button\n                    icon\n                    matRipple\n                    name=\"toggle-space-favourite\"\n                    class=\"absolute top-1 right-1\"\n                    [class.text-blue-400]=\"favorites.includes(space?.id)\"\n                    (click)=\"toggleFavourite(space)\"\n                >\n                    <app-icon>{{\n                        favorites.includes(space?.id)\n                            ? 'favorite'\n                            : 'favorite_border'\n                    }}</app-icon>\n                </button>\n            </div>\n        </div>\n        <button\n            btn\n            matRipple\n            name=\"add-space\"\n            class=\"w-full inverse mt-2\"\n            (click)=\"changeSpaces()\"\n        >\n            <div class=\"flex items-center justify-center space-x-2\">\n                <app-icon>search</app-icon>\n                <span i18n>Add Space</span>\n            </div>\n        </button>\n    `,\n    styles: [``],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => SpaceListFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class SpaceListFieldComponent implements ControlValueAccessor {\n    @Input() multiday = false;\n    public room_size = 4;\n    public spaces = new BehaviorSubject<Space[]>([]);\n    public space_list = this.spaces.pipe(debounceTime(300));\n    public disabled = false;\n    public _dialog_ref?: MatDialogRef<NewSpaceSelectModalComponent>;\n\n    private _onChange: (_: Space[]) => void;\n    private _onTouch: (_: Space[]) => void;\n\n    public get favorites() {\n        return this._settings.get<string[]>('favourite_spaces') || EMPTY_FAVS;\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _org: OrganisationService,\n        private _dialog: MatDialog\n    ) {}\n\n    public ngOnDestroy() {\n        if (this._dialog_ref) this._dialog_ref.close();\n    }\n\n    public level(zones: string[]) {\n        return this._org.levelWithID(zones);\n    }\n\n    /** Add or edit selected spaces */\n    public changeSpaces() {\n        this._dialog_ref = this._dialog.open(NewSpaceSelectModalComponent, {\n            data: {\n                spaces: this.spaces.getValue(),\n                options: { capacity: this.room_size },\n                multiday: this.multiday,\n            },\n        });\n        this._dialog_ref.afterClosed().subscribe(() => {\n            this.setValue(this._dialog_ref?.componentInstance?.selected);\n            this._dialog_ref = undefined;\n        });\n    }\n\n    /** Remove the selected space from the list */\n    public removeSpace(space: Space) {\n        this.setValue(this.spaces.getValue().filter((_) => _.id !== space.id));\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: Space[]) {\n        this.spaces.next(new_value || []);\n        if (this._onChange) this._onChange(new_value || []);\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value?: Space[]) {\n        this.spaces.next(value || []);\n    }\n\n    /* istanbul ignore next */\n    public readonly registerOnChange = (fn: (_: Space[]) => void) =>\n        (this._onChange = fn);\n    /* istanbul ignore next */\n    public readonly registerOnTouched = (fn: (_: Space[]) => void) =>\n        (this._onTouch = fn);\n    public readonly setDisabledState = (s: boolean) => (this.disabled = s);\n\n    public toggleFavourite(space: Space) {\n        if (!space?.id) return;\n        const fav_list = this.favorites;\n        const new_state = !fav_list.includes(space.id);\n        if (new_state) {\n            this._settings.saveUserSetting('favourite_spaces', [\n                ...fav_list,\n                space.id,\n            ]);\n        } else {\n            this._settings.saveUserSetting(\n                'favourite_spaces',\n                fav_list.filter((_) => _ !== space.id)\n            );\n        }\n    }\n}\n","import {\n    AfterViewInit,\n    Component,\n    ElementRef,\n    forwardRef,\n    Input,\n    OnChanges,\n    SimpleChanges,\n    ViewChild,\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { AsyncHandler, uploadFile } from '@placeos/common';\nimport Quill from 'quill';\n\n@Component({\n    selector: 'rich-text-input',\n    template: `\n        <div #container class=\"absolute inset-0\">\n            <div #editor class=\"h-full\"></div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n                position: relative;\n                min-height: 8rem;\n                margin-bottom: 4rem;\n            }\n        `,\n    ],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            /* istanbul ignore next */\n            useExisting: forwardRef(() => RichTextInputComponent),\n            multi: true,\n        },\n    ],\n})\nexport class RichTextInputComponent\n    extends AsyncHandler\n    implements ControlValueAccessor, OnChanges, AfterViewInit\n{\n    @Input() public placeholder = '';\n    @Input() public readonly = false;\n    @Input() public images_allowed = false;\n\n    @ViewChild('container') private _container_el: ElementRef<HTMLDivElement>;\n    @ViewChild('editor') private _editor_el: ElementRef<HTMLDivElement>;\n\n    private _editor: Quill;\n    private _updateFn = () => this.setValue(this._editor.root.innerHTML);\n\n    private _onChange: (\n        _: string,\n    ) => void; /** Form control on change handler */\n    private _onTouch: (\n        _: string,\n    ) => void; /** Form control on touched handler */\n\n    public readonly registerOnChange = (fn: (_: string) => void) =>\n        (this._onChange = fn);\n    public readonly registerOnTouched = (fn: (_: string) => void) =>\n        (this._onTouch = fn);\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.images_allowed) {\n            this.timeout('init', () => this._initialiseEditor());\n        }\n    }\n\n    public ngAfterViewInit() {\n        this.timeout('init', () => this._initialiseEditor());\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        /* istanbul ignore else */\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: string) {\n        this.timeout('write', () => {\n            if (this._editor) {\n                const delta = this._editor.clipboard.convert({ html: value });\n                this._editor.setContents(delta, 'silent');\n            } else {\n                this.timeout('write', () => this.writeValue(value));\n            }\n        });\n    }\n\n    private _initialiseEditor() {\n        if (\n            !this._editor_el?.nativeElement ||\n            !this._container_el?.nativeElement\n        ) {\n            return this.timeout('init', () => this._initialiseEditor());\n        }\n        const toolbarOptions = [\n            [{ font: [] }],\n            [{ header: [1, 2, 3, 4, 5, 6, false] }],\n            ['bold', 'italic', 'underline'], // toggled buttons\n\n            [{ list: 'ordered' }, { list: 'bullet' }, { list: 'check' }],\n            [{ align: [] }],\n        ];\n        if (this.images_allowed) {\n            toolbarOptions.push(['image', 'link']);\n        }\n        if (this._editor) {\n            this.unsub('changes');\n            this._editor_el.nativeElement.innerHTML = '';\n            delete this._editor;\n        }\n        this._editor = new Quill(this._editor_el.nativeElement, {\n            bounds: this._container_el.nativeElement,\n            placeholder: this.placeholder,\n            modules: {\n                toolbar: {\n                    container: toolbarOptions,\n                    handlers: {\n                        image: () => this._embedImage(),\n                        link: () => this._embedAttachment(),\n                    },\n                },\n            },\n            readOnly: this.readonly,\n            theme: 'snow',\n        });\n        this._editor.on('text-change', this._updateFn);\n        this.subscription('changes', () =>\n            this._editor.off('text-change', this._updateFn),\n        );\n    }\n\n    private _embedImage() {\n        if (!this._editor) return;\n        const range = this._editor.getSelection();\n        if (!range) return;\n        const { index } = range;\n        // Create a File input element\n        var file_input = document.createElement('input');\n        file_input.setAttribute('type', 'file');\n        file_input.setAttribute('accept', 'image/*');\n        file_input.click();\n\n        file_input.onchange = () => {\n            var file = file_input.files[0];\n            uploadFile(file, true).subscribe(({ link, progress }) => {\n                if (!link || progress !== 100) return;\n                this._editor.insertEmbed(index, 'image', link);\n            });\n        };\n    }\n\n    private _embedAttachment() {\n        if (!this._editor) return;\n        const range = this._editor.getSelection();\n        if (!range) return;\n        const { index } = range;\n        // Create a File input element\n        var file_input = document.createElement('input');\n        file_input.setAttribute('type', 'file');\n        file_input.click();\n\n        file_input.onchange = () => {\n            var file = file_input.files[0];\n            uploadFile(file, true).subscribe(({ link, progress }) => {\n                if (!link || progress !== 100) return;\n                this._editor.insertText(range.index, file.name, 'link', link);\n                this._editor.setSelection(range.index + file.name.length);\n            });\n        };\n    }\n}\n","import { COMMA, ENTER } from '@angular/cdk/keycodes';\nimport { Component, ElementRef, forwardRef, ViewChild } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { MatChipInputEvent } from '@angular/material/chips';\nimport { Clipboard } from '@angular/cdk/clipboard';\nimport { Upload } from '@placeos/cloud-uploads';\n\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\n\nimport {\n    AsyncHandler,\n    notifyInfo,\n    unique,\n    UploadsService,\n} from '@placeos/common';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ImageViewerComponent } from 'libs/components/src/lib/image-viewer.component';\n\nexport interface UploadDetails {\n    /** Unique ID for the upload */\n    id: number;\n    /** Name of the file uploaded */\n    name: string;\n    /** Progress of the file upload */\n    progress: number;\n    /** Link to the uploaded file */\n    link: string;\n    /** Formatted file size */\n    formatted_size: string;\n    /** Size of the file being uploaded */\n    size: number;\n    /** Error with upload request */\n    error?: string;\n    /** Upload object associated with the file */\n    upload: Upload;\n}\n\n@Component({\n    selector: 'image-list-field',\n    template: `\n        <div\n            images\n            #image_list\n            class=\"space-x-2 py-2 overflow-hidden mb-2 w-full flex items-center relative\"\n            (window:resize)=\"ngAfterViewInit()\"\n        >\n            <div\n                image\n                class=\"relative rounded border-2 border-base-200  border-dashed flex-shrink-0 flex flex-col items-center justify-center h-32 w-36 hover:bg-base-content/10 :bg-base-100/10 cursor-pointer\"\n                [style.transform]=\"'translate(-' + offset + '00%)'\"\n            >\n                <app-icon class=\"text-4xl opacity-60\">add</app-icon>\n                <p class=\"opacity-60\" i18n>Upload Image(s)</p>\n                <input\n                    #file_input\n                    type=\"file\"\n                    class=\"absolute inset-0 opacity-0 h-32 w-32 cursor-pointer\"\n                    (change)=\"uploadImages($event)\"\n                />\n            </div>\n            <div\n                image\n                *ngFor=\"let url of list; let i = index\"\n                class=\"bg-center bg-cover h-32 w-36 relative rounded overflow-hidden flex-shrink-0 bg-base-200\"\n                [style.transform]=\"'translate(-' + offset + '00%)'\"\n            >\n                <img\n                    auth\n                    [source]=\"url\"\n                    class=\"object-contain absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 pointer-events-none\"\n                />\n                <div overlay class=\"absolute inset-0 text-base-100 z-20\">\n                    <div bg class=\"absolute inset-0 opacity-0 bg-black\"></div>\n                    <div\n                        actions\n                        class=\"absolute top-0 left-0 right-0 flex items-center justify-center space-x-2 opacity-0\"\n                    >\n                        <button icon (click)=\"copyLink(url)\">\n                            <app-icon>link</app-icon>\n                        </button>\n                        <button icon (click)=\"viewImage(url)\">\n                            <app-icon>visibility</app-icon>\n                        </button>\n                        <button icon (click)=\"removeImage(url)\">\n                            <app-icon>close</app-icon>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <div\n                image\n                *ngFor=\"let item of uploads | async; let i = index\"\n                class=\"bg-center bg-cover h-32 w-36 rounded border border-base-content/10 /5 bg-base-200  flex items-center justify-center flex-shrink-0\"\n                [style.transform]=\"'translate(-' + offset + '00%)'\"\n                [matTooltip]=\"item.error\"\n                (click)=\"retryUpload(item)\"\n            >\n                <mat-progress-spinner\n                    *ngIf=\"!item.error\"\n                    [value]=\"item.progress\"\n                    [diameter]=\"64\"\n                    mode=\"determinate\"\n                ></mat-progress-spinner>\n                <app-icon *ngIf=\"item.error\" class=\"text-error text-6xl\"\n                    >warning</app-icon\n                >\n                <div\n                    overlay\n                    *ngIf=\"item.error\"\n                    class=\"absolute inset-0 hover:bg-base-content hover:bg-opacity-50 text-base-100 flex items-center justify-center\"\n                >\n                    <app-icon class=\"text-3xl opacity-0\">refresh</app-icon>\n                </div>\n            </div>\n            <button\n                icon\n                matRipple\n                *ngIf=\"length > view_space\"\n                [disabled]=\"offset === 0\"\n                class=\"absolute top-1/2 left-0 transform -translate-y-1/2 bg-base-100\"\n                (click)=\"offset = offset - 1\"\n            >\n                <app-icon>chevron_left</app-icon>\n            </button>\n            <button\n                icon\n                matRipple\n                *ngIf=\"length > view_space\"\n                [disabled]=\"offset >= length - view_space\"\n                class=\"absolute top-1/2 right-0 transform -translate-y-1/2 bg-base-100\"\n                (click)=\"offset = offset + 1\"\n            >\n                <app-icon>chevron_right</app-icon>\n            </button>\n        </div>\n        <mat-form-field appearance=\"outline\" class=\"w-full\">\n            <mat-chip-grid #chipList aria-label=\"Image List\">\n                <mat-chip-row\n                    *ngFor=\"let item of list\"\n                    (removed)=\"removeImage(item)\"\n                >\n                    <div class=\"truncate max-w-md\">{{ item }}</div>\n                    <button matChipRemove [attr.aria-label]=\"'Remove ' + item\">\n                        <app-icon>cancel</app-icon>\n                    </button>\n                </mat-chip-row>\n            </mat-chip-grid>\n            <input\n                placeholder=\"Add image via URL\"\n                i18n-placeholder\n                [matChipInputFor]=\"chipList\"\n                [matChipInputSeparatorKeyCodes]=\"separators\"\n                [matChipInputAddOnBlur]=\"true\"\n                (matChipInputTokenEnd)=\"addImage($event)\"\n            />\n        </mat-form-field>\n    `,\n    styles: [\n        `\n            :host {\n                width: 100%;\n            }\n\n            [overlay] {\n                transition: background 200ms;\n            }\n\n            [image]:hover [actions],\n            [image]:hover > app-icon {\n                opacity: 1 !important;\n            }\n\n            [image]:hover [bg] {\n                opacity: 0.4 !important;\n            }\n\n            [actions],\n            [image] > app-icon {\n                transition: opacity 200ms;\n            }\n\n            [image] {\n                transition: transform 200ms;\n            }\n        `,\n    ],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => ImageListFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class ImageListFieldComponent extends AsyncHandler {\n    /** List of images */\n    public list: string[] = [];\n    /** List of images */\n    public upload_ids = new BehaviorSubject<number[]>([]);\n    private _upload_list = new BehaviorSubject<UploadDetails[]>([]);\n    public readonly upload_list = this._upload_list.asObservable();\n    public offset: number = 0;\n\n    public view_space: number = 0;\n\n    public readonly separators = [COMMA, ENTER];\n\n    public readonly uploads = combineLatest([\n        this.upload_list,\n        this.upload_ids,\n    ]).pipe(map(([list, ids]) => list.filter((i) => ids.includes(i.id))));\n\n    public get length() {\n        return this.list.length + this._upload_list.getValue().length + 1;\n    }\n\n    @ViewChild('image_list') private _list_el: ElementRef<HTMLDivElement>;\n    @ViewChild('file_input') private _file_input: ElementRef<HTMLInputElement>;\n\n    constructor(\n        private _clipboard: Clipboard,\n        private _uploads: UploadsService,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    /** Form control on change handler */\n    private _onChange: (_: string[]) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: string[]) => void;\n\n    public ngAfterViewInit() {\n        this.timeout(\n            'init_view_space',\n            () => {\n                const box = this._list_el.nativeElement.getBoundingClientRect();\n                this.view_space = Math.floor(box.width / 152);\n            },\n            100\n        );\n        this.subscription(\n            'upload_changes',\n            this.upload_list.subscribe((list) => {\n                const id_list = this.upload_ids.getValue();\n                for (const id of id_list) {\n                    const item = list.find((_) => _.id === id);\n                    if (item && item.progress >= 100) {\n                        this.addImageUrl(item.link);\n                        this.upload_ids.next(\n                            this.upload_ids.getValue().filter((_) => _ !== id)\n                        );\n                    }\n                }\n            })\n        );\n    }\n\n    public copyLink(url: string) {\n        this._clipboard.copy(url);\n        notifyInfo('Copied image URL to clipboard');\n    }\n\n    public viewImage(url: string) {\n        this._dialog.open(ImageViewerComponent, { data: url });\n    }\n\n    public removeImage(url: string) {\n        this.setValue(this.list.filter((_) => _ !== url));\n    }\n\n    public addImage(event: MatChipInputEvent) {\n        if (!event.value) return;\n        this.setValue(unique([...this.list, event.value]));\n        event.chipInput.inputElement.value = '';\n    }\n\n    public addImageUrl(url: string) {\n        this.setValue(unique([...this.list, url]));\n    }\n\n    public retryUpload(item: UploadDetails) {\n        if (item.error) {\n            item.error = null;\n            item.upload.resume();\n        }\n    }\n\n    public async uploadImages(event) {\n        const element: HTMLInputElement = event.target as any;\n        /* istanbul ignore else */\n        if (element?.files) {\n            const files: FileList = element.files;\n            /* istanbul ignore else */\n            if (files.length) {\n                this.interval('update_status', () =>\n                    this._updateUploadHistory()\n                );\n                for (let i = 0; i < files.length; i++) {\n                    const id = await this._uploads.uploadFileWithPermissions(\n                        files[i]\n                    );\n                    this.upload_ids.next([...this.upload_ids.getValue(), id]);\n                    this._file_input.nativeElement.value = '';\n                }\n            }\n        }\n    }\n\n    public setValue(value: string[]) {\n        this.list = value;\n        if (this._onChange) this._onChange(value);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value?: string[]) {\n        this.list = value || [];\n    }\n\n    public readonly registerOnChange = (fn: (_: string[]) => void) =>\n        (this._onChange = fn);\n    public readonly registerOnTouched = (fn: (_: string[]) => void) =>\n        (this._onTouch = fn);\n\n    private async _updateUploadHistory() {\n        const list = this.upload_ids.getValue();\n        if (list.length === 0) return;\n        const global_list = await this._uploads.upload_list\n            .pipe(take(1))\n            .toPromise();\n        const new_list = global_list.filter((_) =>\n            list.find((i) => i === _.id)\n        );\n        const done_list = new_list.filter((file) => file.progress >= 100);\n        this._upload_list.next(new_list);\n        done_list.forEach((i) => delete i.upload);\n        if (done_list.length >= list.length)\n            this.clearInterval('update_status');\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { addDays } from 'date-fns';\n\nimport { RecurrenceDetails } from 'libs/events/src/lib/event.interfaces';\n\n@Component({\n    selector: 'recurrence-modal',\n    template: `\n        <header>\n            <h2>Custom Recurrence</h2>\n            <button btn icon mat-dialog-close matRipple>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main class=\"p-4\">\n            <div class=\"flex items-center space-x-2 mb-4\">\n                <div>Repeat every</div>\n                <mat-form-field appearance=\"outline\" class=\"w-16\">\n                    <input matInput type=\"number\" [(ngModel)]=\"data.interval\" />\n                </mat-form-field>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"data.pattern\">\n                        <mat-option value=\"daily\">\n                            day{{ data.interval === 1 ? '' : 's' }}\n                        </mat-option>\n                        <mat-option value=\"weekly\">\n                            week{{ data.interval === 1 ? '' : 's' }}\n                        </mat-option>\n                        <mat-option value=\"month_day\">\n                            month{{ data.interval === 1 ? '' : 's' }}\n                        </mat-option>\n                        <!-- <mat-option value=\"yearly\">\n                            year{{ data.interval === 1 ? '' : 's' }}\n                        </mat-option> -->\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <h2 for=\"repeat-on\" class=\"mb-2\" *ngIf=\"data.pattern === 'weekly'\">\n                Repeat on\n            </h2>\n            <div\n                class=\"flex items-center space-x-2 mb-4\"\n                name=\"repeat-on\"\n                *ngIf=\"data.pattern === 'weekly'\"\n            >\n                <button\n                    btn\n                    matRipple\n                    class=\"w-12\"\n                    [class.inverse]=\"!data.days_of_week?.includes(0)\"\n                    (click)=\"toggleDayOfWeek(0)\"\n                >\n                    S\n                </button>\n                <button\n                    btn\n                    matRipple\n                    class=\"w-12\"\n                    [class.inverse]=\"!data.days_of_week?.includes(1)\"\n                    (click)=\"toggleDayOfWeek(1)\"\n                >\n                    M\n                </button>\n                <button\n                    btn\n                    matRipple\n                    class=\"w-12\"\n                    [class.inverse]=\"!data.days_of_week?.includes(2)\"\n                    (click)=\"toggleDayOfWeek(2)\"\n                >\n                    T\n                </button>\n                <button\n                    btn\n                    matRipple\n                    class=\"w-12\"\n                    [class.inverse]=\"!data.days_of_week?.includes(3)\"\n                    (click)=\"toggleDayOfWeek(3)\"\n                >\n                    W\n                </button>\n                <button\n                    btn\n                    matRipple\n                    class=\"w-12\"\n                    [class.inverse]=\"!data.days_of_week?.includes(4)\"\n                    (click)=\"toggleDayOfWeek(4)\"\n                >\n                    T\n                </button>\n                <button\n                    btn\n                    matRipple\n                    class=\"w-12\"\n                    [class.inverse]=\"!data.days_of_week?.includes(5)\"\n                    (click)=\"toggleDayOfWeek(5)\"\n                >\n                    F\n                </button>\n                <button\n                    btn\n                    matRipple\n                    class=\"w-12\"\n                    [class.inverse]=\"!data.days_of_week?.includes(6)\"\n                    (click)=\"toggleDayOfWeek(6)\"\n                >\n                    S\n                </button>\n            </div>\n            <h2 for=\"ends-at\">Ends</h2>\n            <mat-radio-group name=\"ends-at\" [(ngModel)]=\"ends_key\">\n                <div class=\"flex items-center\">\n                    <mat-radio-button\n                        value=\"never\"\n                        (click)=\"data.occurrences = 0\"\n                    >\n                        Never\n                    </mat-radio-button>\n                </div>\n                <div class=\"flex items-center space-x-2\">\n                    <mat-radio-button value=\"on\">On</mat-radio-button>\n                    <a-date-field\n                        [(ngModel)]=\"data.end\"\n                        [disabled]=\"ends_key !== 'on'\"\n                    ></a-date-field>\n                </div>\n                <div class=\"flex items-center space-x-2\">\n                    <mat-radio-button value=\"after\">After</mat-radio-button>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            type=\"number\"\n                            [(ngModel)]=\"data.occurrences\"\n                            [disabled]=\"ends_key !== 'after'\"\n                        />\n                        <span matSuffix>occurences</span>\n                    </mat-form-field>\n                </div>\n            </mat-radio-group>\n        </main>\n        <footer\n            class=\"px-4 py-2 flex items-center justify-end border-t border-base-200\"\n        >\n            <button\n                btn\n                class=\"w-32\"\n                matRipple\n                (click)=\"\n                    data.occurrences =\n                        ends_key === 'never' ? 0 : data.occurrences\n                \"\n                [mat-dialog-close]=\"data\"\n            >\n                Save\n            </button>\n        </footer>\n    `,\n    styles: [\n        `\n            mat-form-field,\n            a-date-field {\n                height: 3.25rem;\n            }\n\n            mat-radio-button {\n                width: 8rem;\n            }\n        `,\n    ],\n})\nexport class RecurrenceModalComponent {\n    public data: RecurrenceDetails = {\n        ...this._data.value,\n        end: this._data.value.end || addDays(new Date(), 7).valueOf(),\n        interval: this._data.value.interval || 1,\n        pattern: this._data.value.pattern ? this._data.value.pattern : 'weekly',\n        occurrences: this._data.value.occurrences || 1,\n    };\n    public ends_key = 'never';\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: { value: RecurrenceDetails }\n    ) {}\n\n    public toggleDayOfWeek(day: number) {\n        if (!this.data.days_of_week) this.data.days_of_week = [];\n        if (this.data.days_of_week.includes(day)) {\n            this.data.days_of_week = this.data.days_of_week.filter(\n                (d) => d !== day\n            );\n        } else this.data.days_of_week.push(day);\n    }\n}\n","import {\n    Component,\n    Input,\n    SimpleChanges,\n    forwardRef,\n    OnChanges,\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport {\n    addDays,\n    addMonths,\n    isBefore,\n    isSameMonth,\n    set,\n    startOfDay,\n    startOfMonth,\n    startOfWeek,\n} from 'date-fns';\n\ninterface DateItem {\n    id: number;\n    is_past: boolean;\n    is_month: boolean;\n}\n\n@Component({\n    selector: 'date-calendar',\n    template: `\n        <div class=\"p-2\">\n            <div class=\"flex items-center justify-between\">\n                <div class=\"pl-1.5 pr-2 font-medium\">\n                    {{ date_list[6]?.id || date | date: 'LLLL YYYY' }}\n                </div>\n                <div class=\"flex items-center\">\n                    <button\n                        icon\n                        matRipple\n                        name=\"schedule-next-month\"\n                        [disabled]=\"date_list[0]?.id < from\"\n                        (click)=\"changeMonth(-1)\"\n                    >\n                        <app-icon>chevron_left</app-icon>\n                    </button>\n                    <button\n                        icon\n                        matRipple\n                        name=\"schedule-previous-month\"\n                        [disabled]=\"date_list[34]?.id > to\"\n                        (click)=\"changeMonth(1)\"\n                    >\n                        <app-icon>chevron_right</app-icon>\n                    </button>\n                </div>\n            </div>\n            <div\n                class=\"flex items-center text-sm mb-2 pb-2 border-b border-base-200\"\n            >\n                <div\n                    class=\"flex-1 opacity-60 text-center\"\n                    *ngFor=\"let day of date_list | slice: 0:7\"\n                >\n                    {{ day?.id | date: 'EE' }}\n                </div>\n            </div>\n            <div class=\"flex items-center justify-between flex-wrap\">\n                <button\n                    icon\n                    name=\"schedule-set-date\"\n                    class=\"min-w-[14%] w-9 h-9 relative overflow-visible my-0.5\"\n                    *ngFor=\"let day of date_list\"\n                    [class.hover:bg-base-100]=\"day.id !== active_date\"\n                    [class.!text-base-300]=\"!day.is_month\"\n                    [class.text-secondary-content]=\"day.id === active_date\"\n                    [class.text-base-content]=\"day.id !== active_date\"\n                    [class.bg-secondary]=\"day.id === active_date\"\n                    [class.font-normal]=\"day.id !== active_date\"\n                    (click)=\"setValue(day.id)\"\n                    [disabled]=\"day.id < from || day.id > to\"\n                >\n                    {{ day.id | date: 'd' }}\n                    <div\n                        class=\"absolute -inset-[2px] border border-secondary rounded-full overflow-hidden\"\n                        matRipple\n                        *ngIf=\"today === day.id\"\n                    ></div>\n                    <div\n                        class=\"absolute inset-0 overflow-hidden rounded-full\"\n                        matRipple\n                    ></div>\n                </button>\n            </div>\n        </div>\n    `,\n    styles: [``],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateCalendarComponent),\n            multi: true,\n        },\n    ],\n})\nexport class DateCalendarComponent\n    extends AsyncHandler\n    implements ControlValueAccessor, OnChanges\n{\n    @Input() public from = 0;\n    @Input() public to = Date.now() * 10;\n    @Input() public offset_weekday = 0;\n    public readonly today = startOfDay(Date.now()).valueOf();\n    public date: number = Date.now();\n    public active_date: number = startOfDay(Date.now()).valueOf();\n    public offset = 0;\n    public date_list: DateItem[] = [];\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    constructor(private _settings: SettingsService) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.generateDates();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.offset_weekday) {\n            this.generateDates();\n        }\n    }\n\n    public setValue(new_value: number) {\n        if (new_value < this.from || new_value >= this.to) return;\n        const date = new Date(new_value);\n        this.date = set(this.date, {\n            date: date.getDate(),\n            month: date.getMonth(),\n            year: date.getFullYear(),\n        }).valueOf();\n        this.active_date = startOfDay(this.date).valueOf();\n        if (this._onChange) this._onChange(new_value);\n    }\n\n    public writeValue(value: number) {\n        this.date = value;\n        this.active_date = startOfDay(value).valueOf();\n        this.offset = 0;\n        this.generateDates();\n    }\n\n    public changeMonth(change: number) {\n        this.offset += change;\n        this.generateDates();\n    }\n\n    public readonly registerOnChange = (fn) => (this._onChange = fn);\n    public readonly registerOnTouched = (fn) => (this._onTouch = fn);\n\n    public generateDates() {\n        const offset =\n            this._settings.get('app.week_start') || this.offset_weekday;\n        const date = addMonths(this.date, this.offset);\n        let start = startOfWeek(startOfMonth(date), {\n            weekStartsOn: offset as any,\n        });\n        const now = startOfDay(Date.now());\n        const list = [];\n        while (list.length < 42) {\n            list.push({\n                id: start.valueOf(),\n                is_past: isBefore(start, now),\n                is_month: isSameMonth(start, date),\n            });\n            start = addDays(start, 1);\n        }\n        this.date_list = list;\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport {\n    BookingRuleset,\n    SettingsService,\n    getInvalidFields,\n    notifyError,\n    randomString,\n} from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { queryZones } from '@placeos/ts-client';\nimport { endOfDay, set, startOfDay } from 'date-fns';\nimport { of } from 'rxjs';\nimport {\n    catchError,\n    filter,\n    map,\n    shareReplay,\n    switchMap,\n} from 'rxjs/operators';\n\n@Component({\n    selector: 'booking-rules-form',\n    template: `\n        <div class=\"flex flex-col space-y-2\" [formGroup]=\"form\">\n            <div class=\"flex items-center space-x-2\">\n                <div class=\"flex flex-col flex-1\">\n                    <label for=\"zone\">Zone<span>*</span>:</label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select name=\"zone\" formControlName=\"zone\">\n                            <mat-option value=\"*\">Any Zone</mat-option>\n                            <mat-option\n                                *ngFor=\"let zone of building_zones | async\"\n                                [value]=\"zone.id\"\n                            >\n                                {{ zone.display_name || zone.name }}\n                            </mat-option>\n                        </mat-select>\n                        <mat-error>A valid zone is required</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col flex-1\">\n                    <label for=\"name\">Name<span>*</span>:</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"name\"\n                            formControlName=\"name\"\n                            placeholder=\"Ruleset Name\"\n                        />\n                        <mat-error>A valid name is required</mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n            <div class=\"flex items-center space-x-2\" formGroupName=\"rules\">\n                <div class=\"flex flex-col flex-1\">\n                    <mat-checkbox\n                        name=\"hidden\"\n                        formControlName=\"hidden\"\n                        matTooltip=\"Prevent user from booking the resource if the conditions match\"\n                    >\n                        Prevent Bookings\n                    </mat-checkbox>\n                </div>\n                <div class=\"flex flex-col flex-1\">\n                    <mat-checkbox\n                        name=\"auto_approve\"\n                        formControlName=\"auto_approve\"\n                        *ngIf=\"!form.value.rules.hidden\"\n                        matTooltip=\"Whether resource should be auto-approved when booking if the conditions match\"\n                    >\n                        Auto Approve Bookings\n                    </mat-checkbox>\n                </div>\n            </div>\n            <div class=\"flex flex-col\">\n                <label for=\"zone\">Rule Conditions:</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        name=\"zone\"\n                        multiple\n                        [(ngModel)]=\"available_conditions\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                        placeholder=\"No Conditions. Match all resources in zone\"\n                    >\n                        <mat-option value=\"groups\">Groups</mat-option>\n                        <mat-option value=\"locations\">Locations</mat-option>\n                        <mat-option value=\"min_length\">\n                            Minimum Length\n                        </mat-option>\n                        <mat-option value=\"max_length\">\n                            Maximum Length\n                        </mat-option>\n                        <mat-option value=\"is_before\">\n                            Is Within Days\n                        </mat-option>\n                        <mat-option value=\"is_after\">\n                            Is After Days\n                        </mat-option>\n                        <mat-option value=\"is_between\">\n                            Is Between Hours\n                        </mat-option>\n                        <mat-option value=\"is_period\">\n                            Between Dates\n                        </mat-option>\n                        <mat-option value=\"resource_ids\">Resources</mat-option>\n                    </mat-select>\n                    <mat-error>A valid zone is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div\n                class=\"flex flex-col\"\n                *ngIf=\"available_conditions.includes('groups')\"\n                formGroupName=\"conditions\"\n            >\n                <label for=\"groups\"\n                    >{{ form.value.rules.hidden ? 'Prevent' : 'Allow' }} Booking\n                    for Groups:</label\n                >\n                <item-list-field\n                    name=\"groups\"\n                    formControlName=\"groups\"\n                    placeholder=\"User groups\"\n                ></item-list-field>\n            </div>\n            <div\n                class=\"flex flex-col\"\n                *ngIf=\"available_conditions.includes('locations')\"\n                formGroupName=\"conditions\"\n            >\n                <label for=\"locations\">Locations:</label>\n                <item-list-field\n                    name=\"locations\"\n                    formControlName=\"locations\"\n                    placeholder=\"Locations\"\n                ></item-list-field>\n            </div>\n            <div\n                class=\"flex items-center space-x-2\"\n                *ngIf=\"\n                    available_conditions.includes('min_length') ||\n                    available_conditions.includes('max_length')\n                \"\n                formGroupName=\"conditions\"\n            >\n                <div\n                    class=\"flex flex-col flex-1\"\n                    *ngIf=\"available_conditions.includes('min_length')\"\n                >\n                    <label for=\"min_length\"\n                        >{{\n                            form.value.rules.hidden ? 'Prevent' : 'Allow'\n                        }}\n                        booking with a minimum length of:</label\n                    >\n                    <a-duration-field\n                        name=\"min_length\"\n                        [min]=\"15\"\n                        [max]=\"1440\"\n                        [step]=\"15\"\n                        formControlName=\"min_length\"\n                    ></a-duration-field>\n                </div>\n                <div\n                    class=\"flex flex-col flex-1\"\n                    *ngIf=\"available_conditions.includes('max_length')\"\n                >\n                    <label for=\"max_length\"\n                        >{{\n                            form.value.rules.hidden ? 'Prevent' : 'Allow'\n                        }}\n                        booking with a maximum length up to:</label\n                    >\n                    <a-duration-field\n                        name=\"max_length\"\n                        [min]=\"form.value.conditions.min_length || 15\"\n                        [max]=\"1440\"\n                        [step]=\"15\"\n                        formControlName=\"max_length\"\n                    ></a-duration-field>\n                </div>\n            </div>\n            <div\n                class=\"flex flex-col\"\n                *ngIf=\"available_conditions.includes('is_before')\"\n                formGroupName=\"conditions\"\n            >\n                <label for=\"is-before\"\n                    >{{ form.value.rules.hidden ? 'Prevent' : 'Allow' }} booking\n                    before:</label\n                >\n                <mat-form-field appearance=\"outline\" class=\"flex-1\">\n                    <mat-select name=\"is-before\" formControlName=\"is_before\">\n                        <mat-option\n                            *ngFor=\"let time of duration_blocks\"\n                            [value]=\"time\"\n                        >\n                            {{ time }}\n                        </mat-option>\n                    </mat-select>\n                    <mat-error>A valid time is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div\n                class=\"flex flex-col\"\n                *ngIf=\"available_conditions.includes('is_after')\"\n                formGroupName=\"conditions\"\n            >\n                <label for=\"is-after\"\n                    >{{ form.value.rules.hidden ? 'Prevent' : 'Allow' }} booking\n                    after:</label\n                >\n                <mat-form-field appearance=\"outline\" class=\"flex-1\">\n                    <mat-select name=\"is-after\" formControlName=\"is_after\">\n                        <mat-option\n                            *ngFor=\"let time of duration_blocks\"\n                            [value]=\"time\"\n                        >\n                            {{ time }}\n                        </mat-option>\n                    </mat-select>\n                    <mat-error>A valid time is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div\n                class=\"flex flex-col\"\n                *ngIf=\"available_conditions.includes('is_period')\"\n                formGroupName=\"conditions\"\n            >\n                <label for=\"is-after\"\n                    >{{ form.value.rules.hidden ? 'Prevent' : 'Allow' }} booking\n                    between dates:</label\n                >\n                <div class=\"flex items-center space-x-2\">\n                    <a-date-field\n                        class=\"flex-1\"\n                        [ngModel]=\"form.value.conditions.is_period[0]\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                        (ngModelChange)=\"\n                            setIsPeriod(\n                                $event,\n                                form.value.conditions.is_period[1]\n                            )\n                        \"\n                    >\n                    </a-date-field>\n                    <a-date-field\n                        class=\"flex-1\"\n                        [from]=\"form.value.conditions.is_period[0]\"\n                        [ngModel]=\"form.value.conditions.is_period[1]\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                        (ngModelChange)=\"\n                            setIsPeriod(\n                                form.value.conditions.is_period[0],\n                                $event\n                            )\n                        \"\n                    >\n                    </a-date-field>\n                </div>\n            </div>\n            <div\n                class=\"flex flex-col\"\n                *ngIf=\"available_conditions.includes('is_between')\"\n                formGroupName=\"conditions\"\n            >\n                <label for=\"is_between\"\n                    >{{ form.value.rules.hidden ? 'Prevent' : 'Allow' }} booking\n                    between:</label\n                >\n                <div class=\"flex items-center space-x-2 w-full\">\n                    <mat-form-field appearance=\"outline\" class=\"flex-1\">\n                        <mat-select\n                            name=\"start-time\"\n                            [ngModel]=\"form.value.conditions.is_between[0] || 6\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            (ngModelChange)=\"\n                                setIsBetween(\n                                    $event,\n                                    form.value.conditions.is_between[1]\n                                )\n                            \"\n                        >\n                            <mat-option\n                                *ngFor=\"let time of time_blocks\"\n                                [value]=\"time.id\"\n                            >\n                                {{ time.value | date: time_format }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n\n                    <mat-form-field appearance=\"outline\" class=\"flex-1\">\n                        <mat-select\n                            name=\"end-time\"\n                            [ngModel]=\"\n                                form.value.conditions.is_between[1] || 18\n                            \"\n                            (ngModelChange)=\"\n                                setIsBetween(\n                                    form.value.conditions.is_between[0],\n                                    $event\n                                )\n                            \"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                        >\n                            <ng-container *ngFor=\"let time of time_blocks\">\n                                <mat-option\n                                    [value]=\"time.id\"\n                                    *ngIf=\"\n                                        time.id >\n                                        (form.value.conditions.is_between[0] ||\n                                            6)\n                                    \"\n                                >\n                                    {{ time.value | date: time_format }}\n                                </mat-option>\n                            </ng-container>\n                        </mat-select>\n                        <mat-error>A valid end time is required</mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n            <div\n                class=\"flex flex-col\"\n                *ngIf=\"available_conditions.includes('resource_ids')\"\n                formGroupName=\"conditions\"\n            >\n                <label for=\"resource_ids\">\n                    {{ form.value.rules.hidden ? 'Prevent' : 'Allow' }} booking\n                    these resources:\n                </label>\n                <item-list-field\n                    name=\"resource_ids\"\n                    formControlName=\"resource_ids\"\n                    placeholder=\"Resource IDs\"\n                ></item-list-field>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n                padding: 0.5rem;\n            }\n        `,\n    ],\n})\nexport class BookingRulesFormComponent {\n    @Input() public ruleset?: BookingRuleset;\n    @Input() public save = false;\n    @Output() public rulesetChange = new EventEmitter<BookingRuleset>();\n\n    public available_conditions: string[] = [];\n\n    public readonly building_zones = this._org.active_building.pipe(\n        filter((_) => !!_),\n        switchMap((bld) =>\n            queryZones({ parent_id: bld.id }).pipe(\n                catchError(() => of({ data: [] }))\n            )\n        ),\n        map((res) => res.data),\n        shareReplay(1)\n    );\n\n    public readonly time_blocks = new Array(24 * 4).fill(0).map((_, idx) => {\n        const hour = Math.floor(idx / 4);\n        const minutes = (idx % 4) * 15;\n        return {\n            id: hour + minutes / 60,\n            value: set(new Date(), { hours: hour, minutes }),\n        };\n    });\n\n    public duration_blocks = [\n        '1 Day',\n        '2 Days',\n        '3 Days',\n        '4 Days',\n        '5 Days',\n        '1 Week',\n        '2 Weeks',\n        '3 Weeks',\n        '4 Weeks',\n        '1 Month',\n        '2 Months',\n        '3 Months',\n        '4 Months',\n        '5 Months',\n        '6 Months',\n    ];\n\n    public readonly form = new FormGroup({\n        id: new FormControl(`ruleset-${randomString(8)}`),\n        zone: new FormControl('*', Validators.required),\n        name: new FormControl('', Validators.required),\n        rules: new FormGroup({\n            auto_approve: new FormControl(false),\n            hidden: new FormControl(false),\n        }),\n        conditions: new FormGroup({\n            groups: new FormControl([]),\n            locations: new FormControl([]),\n            min_length: new FormControl(0),\n            max_length: new FormControl(24 * 60),\n            is_before: new FormControl('1 Week'),\n            is_after: new FormControl('1 Day'),\n            is_between: new FormControl([6, 18]),\n            is_period: new FormControl([\n                startOfDay(Date.now()).valueOf(),\n                endOfDay(Date.now()).valueOf(),\n            ]),\n            resource_ids: new FormControl([]),\n        }),\n    });\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _settings: SettingsService\n    ) {}\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.ruleset && this.ruleset) {\n            this.available_conditions = Object.keys(\n                this.ruleset.conditions || {}\n            );\n            this.form.patchValue(this.ruleset);\n        }\n        if (\n            changes.save &&\n            this.save !== changes.save.previousValue &&\n            !changes.save.firstChange\n        ) {\n            this.post();\n        }\n    }\n\n    public setIsBetween(start: number, end: number) {\n        if (!start || !end) return;\n        if (start > end) end = start + 0.25;\n        this.form.patchValue({ conditions: { is_between: [start, end] } });\n    }\n\n    public setIsPeriod(start: number, end: number) {\n        if (!start || !end) return;\n        if (start > end) end = start;\n        this.form.patchValue({\n            conditions: {\n                is_period: [\n                    startOfDay(start).valueOf(),\n                    endOfDay(end).valueOf(),\n                ],\n            },\n        });\n    }\n\n    public post(): void {\n        if (!this.form.valid) {\n            return notifyError(\n                `Some form fields are invalid. [${getInvalidFields(\n                    this.form\n                ).join(', ')}]`\n            );\n        }\n        const value = this.form.getRawValue();\n        const condition_keys = Object.keys(value.conditions);\n        for (const key of condition_keys) {\n            if (!this.available_conditions.includes(key)) {\n                delete value.conditions[key];\n            }\n        }\n        this.rulesetChange.emit(value as any);\n    }\n}\n","import { Pipe } from '@angular/core';\nimport { StaffUser, User } from '../../../users/src/lib/user.class';\nimport { showUser } from '@placeos/ts-client';\n\nconst USER_LIST: User[] = [];\n\nconst EMPTY_USER = new StaffUser();\n\n@Pipe({\n    name: 'placeuser',\n})\nexport class PlaceUserPipe {\n    /**\n     * Get details of the user with the given ID\n     * @param user_id ID or Email of the user\n     */\n    public async transform(user_id: string): Promise<User> {\n        if (!user_id) return EMPTY_USER;\n        let user = USER_LIST.find(\n            ({ id, email }) => id === user_id || email === user_id,\n        );\n        if (user) return user;\n        user = await showUser(user_id)\n            .toPromise()\n            .catch(() => null);\n        if (user) {\n            user = new StaffUser(user);\n            USER_LIST.push(user);\n            return user;\n        }\n        return EMPTY_USER;\n    }\n}\n","import { Component, ContentChild, Input, ViewChild } from '@angular/core';\nimport { NgControl } from '@angular/forms';\nimport { AsyncHandler } from '@placeos/common';\nimport { CustomTooltipComponent } from '@placeos/components';\nimport { startOfDay } from 'date-fns';\n\n@Component({\n    selector: 'date-range-field',\n    template: `\n        <button\n            matRipple\n            class=\"flex items-center rounded px-4 py-2 border border-neutral hover:border-base-content focus:outline-2 outline-base-content space-x-2 min-w-max\"\n            type=\"button\"\n            role=\"date-picker\"\n            customTooltip\n            [content]=\"calendar_picker\"\n            yPosition=\"top\"\n            [disabled]=\"disabled\"\n            [class.opacity-30]=\"disabled\"\n        >\n            <div class=\"flex-1 whitespace-nowrap\">\n                {{ start_date?.value || now | date: 'MMM d, yyyy' }}\n            </div>\n            <div>&ndash;</div>\n            <div class=\"flex-1 whitespace-nowrap\">\n                {{ end_date?.value || now | date: 'MMM d, yyyy' }}\n            </div>\n            <app-icon class=\"text-2xl\">today</app-icon>\n        </button>\n        <div class=\"hidden\">\n            <ng-content select=\"input[startDate]\"></ng-content>\n            <ng-content select=\"input[endDate]\"></ng-content>\n        </div>\n        <ng-template #calendar_picker>\n            <div class=\"relative w-[18.25rem] rounded bg-base-100 px-2 py-4\">\n                <date-range-calendar\n                    [month]=\"start_date?.control?.value || now\"\n                    [from]=\"from\"\n                    [to]=\"until\"\n                    [offset_weekday]=\"week_start\"\n                    (startChange)=\"setStartDate($event)\"\n                    (endChange)=\"setEndDate($event)\"\n                ></date-range-calendar>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class DateRangeFieldComponent extends AsyncHandler {\n    /** Earliest date available the user is allowed to pick */\n    @Input('from') public from_date: number = startOfDay(Date.now()).valueOf();\n    /** Latest date available the user is allowed to pick */\n    @Input('to') public to_date: number;\n    /** Index of the day to start the week on when displaying the calendar */\n    @Input() public week_start: number = 0;\n    /** Whether form control is disabled */\n    @Input() public disabled: boolean = false;\n    @Input() public short = false;\n\n    public readonly now = Date.now();\n\n    @ContentChild('startDate', { read: NgControl })\n    public start_date?: NgControl;\n    @ContentChild('endDate', { read: NgControl }) public end_date?: NgControl;\n\n    @ViewChild(CustomTooltipComponent) private _tooltip: CustomTooltipComponent;\n\n    public setStartDate(date: number) {\n        if (!this.start_date) return;\n        this.start_date.control.setValue(date);\n    }\n\n    public setEndDate(date: number) {\n        this._tooltip?.close();\n        if (!this.end_date) return;\n        this.end_date.control.setValue(date);\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport {\n    addDays,\n    addMonths,\n    endOfDay,\n    isAfter,\n    isBefore,\n    isSameDay,\n    isSameMonth,\n    startOfDay,\n    startOfMonth,\n    startOfWeek,\n} from 'date-fns';\n\n@Component({\n    selector: `date-range-calendar`,\n    template: `\n        <div class=\"flex items-center justify-between\">\n            <div month class=\"font-medium px-2\">\n                {{ month | date: 'MMMM yyyy' }}\n            </div>\n            <div class=\"flex items-center space-x-2\">\n                <button icon matRipple (click)=\"previousMonth()\">\n                    <app-icon>chevron_left</app-icon>\n                </button>\n                <button icon matRipple (click)=\"nextMonth()\">\n                    <app-icon>chevron_right</app-icon>\n                </button>\n            </div>\n        </div>\n        <div\n            class=\"grid grid-cols-7 grid-rows-7 gap-1 w-[17.25rem] h-[17.25rem]\"\n        >\n            <div\n                class=\"col-span-full grid grid-cols-7 border-b border-base-200\"\n            >\n                <div\n                    weekday\n                    *ngFor=\"let weekday of weekdays\"\n                    class=\"relative flex items-center justify-center text-sm opacity-60\"\n                >\n                    {{ weekday | date: 'EEE' }}\n                </div>\n            </div>\n            <button\n                *ngFor=\"let day of month_days; trackBy: trackByFn\"\n                class=\"relative h-9 w-9 hover:bg-base-200 rounded-full\"\n                [class.text-secondary-content]=\"day.is_start || day.is_end\"\n                [disabled]=\"day.disabled\"\n                (click)=\"selectDate(day.id)\"\n                (mouseenter)=\"setHoveredDate(day.id)\"\n            >\n                <div\n                    *ngIf=\"day.is_selected && !day.is_start && !day.is_end\"\n                    class=\"absolute inset-y-0 -inset-x-0.5 border-y border-base-content border-dashed bg-base-200\"\n                ></div>\n                <div\n                    *ngIf=\"day.is_start && end_after_start\"\n                    class=\"absolute inset-y-0 -right-0.5 w-[calc(50%+2px)] border-y border-base-content border-dashed bg-base-200\"\n                ></div>\n                <div\n                    *ngIf=\"day.is_end && end_after_start\"\n                    class=\"absolute inset-y-0 -left-0.5 w-[calc(50%+2px)] border-y border-base-content border-dashed bg-base-200\"\n                ></div>\n                <div\n                    *ngIf=\"day.is_start || day.is_end\"\n                    class=\"absolute inset-0 flex items-center justify-center bg-secondary rounded-full z-10\"\n                ></div>\n                <div\n                    matRipple\n                    class=\"absolute inset-0 flex items-center justify-center rounded-full z-20\"\n                    [class.opacity-30]=\"!day.is_month\"\n                >\n                    {{ day.id | date: 'd' }}\n                </div>\n                <div\n                    *ngIf=\"day.is_today\"\n                    class=\"absolute -inset-[3px] flex items-center justify-center border border-secondary rounded-full z-10\"\n                ></div>\n            </button>\n        </div>\n    `,\n    styles: [``],\n})\nexport class DateRangeCalendarComponent {\n    /** Earliest date available the user is allowed to pick */\n    @Input('from') public from_date: number = startOfDay(Date.now()).valueOf();\n    /** Latest date available the user is allowed to pick */\n    @Input('to') public to_date: number;\n    /** Index of the day to start the week on when displaying the calendar */\n    @Input() public offset_weekday: number = 0;\n    /** Start date of the selected range */\n    @Input() public start: number;\n    /** End date of the selected range */\n    @Input() public end: number;\n    /** Month to display the calendar for */\n    @Input() public month = startOfDay(Date.now()).valueOf();\n    /** Emitter for when the start date changes */\n    @Output() public startChange = new EventEmitter<number>();\n    /** Emitter for when the end date changes */\n    @Output() public endChange = new EventEmitter<number>();\n\n    public hovered_date = null;\n\n    public weekdays = [];\n    public month_days = [];\n\n    public get end_after_start() {\n        return (\n            this.end &&\n            this.end > this.start &&\n            !isSameDay(this.end, this.start)\n        );\n    }\n\n    public ngOnInit() {\n        this._setWeekdays();\n        this._setMonthDays();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.offset_weekday) {\n            this._setWeekdays();\n            this._setMonthDays();\n        }\n        if (changes.start) {\n            this._setMonthDays();\n            this.month = this.start || Date.now();\n        }\n        if (changes.month) {\n            this._setMonthDays();\n        }\n        if (changes.end) this._setMonthDays();\n    }\n\n    public selectDate(date: number) {\n        if (!this.start || date < this.start) {\n            this.start = date;\n            this.startChange.emit(date);\n        } else {\n            this.end = date;\n            this.endChange.emit(date);\n        }\n        this._setMonthDays();\n    }\n\n    public setHoveredDate(date: number) {\n        if (!this.start) return;\n        this.end = date;\n        this._setMonthDays();\n    }\n\n    public trackByFn(index: number, day: any) {\n        return day.id;\n    }\n\n    public nextMonth() {\n        this.month = addMonths(this.month, 1).valueOf();\n        this._setMonthDays();\n    }\n\n    public previousMonth() {\n        this.month = addMonths(this.month, -1).valueOf();\n        this._setMonthDays();\n    }\n\n    private _setMonthDays() {\n        const start = startOfWeek(startOfMonth(this.month), {\n            weekStartsOn: this.offset_weekday as any,\n        });\n        this.month_days = Array.from(Array(7 * 6).keys()).map((i) => {\n            const date = addDays(start, i).valueOf();\n            return {\n                id: date,\n                disabled:\n                    (this.from_date && isBefore(date, this.from_date)) ||\n                    (this.to_date && isAfter(date, this.to_date)),\n                is_today: isSameDay(date, Date.now()),\n                is_start: isSameDay(date, this.start),\n                is_end: isSameDay(date, this.end),\n                is_month: isSameMonth(date, this.month),\n                is_selected:\n                    this.end &&\n                    date >= startOfDay(this.start).valueOf() &&\n                    date <= endOfDay(this.end).valueOf(),\n            };\n        });\n    }\n\n    private _setWeekdays() {\n        const start = startOfWeek(Date.now(), {\n            weekStartsOn: this.offset_weekday as any,\n        });\n        this.weekdays = Array.from(Array(7).keys()).map((i) =>\n            addDays(start, i)\n        );\n    }\n}\n","import { NgModule, Type } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { ClipboardModule } from '@angular/cdk/clipboard';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatRadioModule } from '@angular/material/radio';\n\nimport { ComponentsModule } from 'libs/components/src/lib/components.module';\n\nimport { ActionFieldComponent } from './action-field.component';\nimport { CounterComponent } from './counter.component';\nimport { DateFieldComponent } from './date-field.component';\nimport { DurationFieldComponent } from './duration-field.component';\nimport { TimeFieldComponent } from './time-field.component';\nimport { UserListFieldComponent } from './user-list-field.component';\nimport { UserSearchFieldComponent } from './user-search-field.component';\nimport { ItemListFieldComponent } from './item-list-field.component';\nimport { UploadListFieldComponent } from './upload-list-field.component';\nimport { UploadFileFieldComponent } from './upload-file-field.component';\nimport { SpaceListFieldComponent } from './space-list-field.component';\nimport { RichTextInputComponent } from './rich-text-input.component';\nimport { HostSelectFieldComponent } from './host-select-field.component';\nimport { ImageListFieldComponent } from './image-list-field.component';\nimport { RecurrenceFieldComponent } from './recurrence-field.component';\nimport { RecurrenceModalComponent } from './recurrence-modal.component';\nimport { SupportTicketModalComponent } from './support-ticket-modal.component';\nimport { DateCalendarComponent } from './date-calendar.component';\nimport { BookingRulesFormComponent } from './booking-rules-form.component';\nimport { PlaceUserPipe } from './place-user.pipe';\nimport { DateRangeFieldComponent } from './date-range-field.component';\nimport { DateRangeCalendarComponent } from './date-range-calendar.component';\n\nconst COMPONENTS: Type<any>[] = [\n    ActionFieldComponent,\n    CounterComponent,\n    DateFieldComponent,\n    DateRangeFieldComponent,\n    DateRangeCalendarComponent,\n    DurationFieldComponent,\n    TimeFieldComponent,\n    UserListFieldComponent,\n    UserSearchFieldComponent,\n    ItemListFieldComponent,\n    UploadListFieldComponent,\n    UploadFileFieldComponent,\n    SpaceListFieldComponent,\n    RichTextInputComponent,\n    HostSelectFieldComponent,\n    ImageListFieldComponent,\n    SupportTicketModalComponent,\n\n    RecurrenceFieldComponent,\n    RecurrenceModalComponent,\n    DateCalendarComponent,\n    BookingRulesFormComponent,\n\n    PlaceUserPipe,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        MatRippleModule,\n        ReactiveFormsModule,\n        MatFormFieldModule,\n        MatInputModule,\n        MatSelectModule,\n        MatAutocompleteModule,\n        MatTooltipModule,\n        MatCheckboxModule,\n        MatRadioModule,\n        MatChipsModule,\n        ClipboardModule,\n        ComponentsModule,\n    ],\n    exports: [...COMPONENTS],\n})\nexport class FormFieldsModule {}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { MapPinComponent } from 'libs/components/src/lib/map-pin.component';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { ViewerFeature } from '@placeos/svg-viewer';\nimport { Space } from '../space.class';\n\n@Component({\n    selector: `space-details`,\n    template: `\n        <ng-container *ngIf=\"space; else empty_state\">\n            <section\n                image\n                class=\"relative w-full bg-neutral\"\n                [class.sm:h-64]=\"space.images?.length\"\n                [class.h-40]=\"space.images?.length\"\n                [class.sm:h-0]=\"!space.images?.length\"\n                [class.h-12]=\"!space.images?.length\"\n                [class.!bg-transparent]=\"!space.images?.length\"\n            >\n                <image-carousel\n                    [images]=\"space.images\"\n                    *ngIf=\"space.images?.length\"\n                    class=\"absolute inset-0\"\n                ></image-carousel>\n                <button\n                    icon\n                    matRipple\n                    name=\"close-space-details\"\n                    (click)=\"close.emit()\"\n                    class=\"absolute top-2 left-2 bg-neutral sm:hidden text-white\"\n                >\n                    <app-icon>arrow_back</app-icon>\n                </button>\n                <button\n                    icon\n                    matRipple\n                    name=\"toggle-space-favourite-details\"\n                    [class.text-white]=\"!fav\"\n                    [class.text-blue-400]=\"fav\"\n                    (click)=\"toggleFav.emit()\"\n                    class=\"absolute top-2 right-2 bg-neutral\"\n                >\n                    <app-icon>{{\n                        fav ? 'favorite' : 'favorite_border'\n                    }}</app-icon>\n                </button>\n            </section>\n            <div class=\"p-2 space-y-2 flex-1 h-1/2 overflow-auto\">\n                <section actions class=\"z-0\">\n                    <h2 class=\"text-xl font-medium mb-2 mt-4\">\n                        {{ space.display_name || space.name }}\n                    </h2>\n                </section>\n                <hr />\n                <section details class=\"space-y-2\">\n                    <h2 class=\"text-xl font-medium\" i18n>Details</h2>\n                    <div class=\"flex items-center space-x-2\">\n                        <app-icon>people</app-icon>\n                        <p i18n>{{ space.capacity }} People</p>\n                    </div>\n                    <div class=\"flex items-center space-x-2\">\n                        <app-icon>meeting_room</app-icon>\n                        <p>\n                            {{ level?.display_name || level?.name }}\n                        </p>\n                    </div>\n                    <div class=\"flex items-center space-x-2\">\n                        <app-icon>place</app-icon>\n                        <p>\n                            {{\n                                building?.address ||\n                                    building?.display_name ||\n                                    building?.name\n                            }}\n                        </p>\n                    </div>\n                </section>\n                <hr />\n                <section\n                    facilities\n                    class=\"space-y-2\"\n                    *ngIf=\"space.features?.length\"\n                >\n                    <h2 class=\"text-xl font-medium\" i18n>Room Facilities</h2>\n                    <div\n                        class=\"flex items-center space-x-2\"\n                        *ngFor=\"let feature of space.features\"\n                    >\n                        <!-- <app-icon>people</app-icon> -->\n                        <p i18n>{{ feature }}</p>\n                    </div>\n                </section>\n                <section\n                    map\n                    class=\"w-full mx-auto h-64 sm:h-48 relative border border-base-200 overflow-hidden rounded\"\n                    *ngIf=\"!hide_map\"\n                >\n                    <interactive-map\n                        class=\"pointer-events-none\"\n                        [src]=\"map_url\"\n                        [focus]=\"space.map_id\"\n                        [features]=\"features\"\n                        [options]=\"{ disable_pan: true, disable_zoom: true }\"\n                    ></interactive-map>\n                </section>\n            </div>\n            <div\n                class=\"px-2 pt-2 pb-[5.5rem] border-t border-base-200 shadow sm:hidden\"\n            >\n                <button\n                    btn\n                    matRipple\n                    name=\"toggle-space-details\"\n                    [class.inverse]=\"active\"\n                    class=\"w-full\"\n                    (click)=\"active = !active; activeChange.emit(active)\"\n                >\n                    <div class=\"flex items-center justify-center\">\n                        <app-icon class=\"text-2xl\">{{\n                            active ? 'remove' : 'add'\n                        }}</app-icon>\n                        <p>\n                            {{ active ? 'Remove this room' : 'Add this room' }}\n                        </p>\n                    </div>\n                </button>\n            </div>\n        </ng-container>\n        <ng-template #empty_state>\n            <div\n                empty\n                class=\"p-16 flex flex-col items-center justify-center space-y-2\"\n            >\n                <p class=\"opacity-30 text-center\" i18n>\n                    Select a room to view it's details\n                </p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                display: flex;\n                flex-direction: column;\n                width: 30%;\n                min-width: 20rem;\n                height: 100%;\n                min-height: 65vh;\n            }\n        `,\n    ],\n})\nexport class SpaceDetailsComponent {\n    @Input() public space?: Space;\n    @Input() public fav: boolean = false;\n    @Input() public active: boolean = false;\n    @Input() public hide_map: boolean = false;\n\n    @Output() public activeChange = new EventEmitter<boolean>();\n    @Output() public close = new EventEmitter<void>();\n    @Output() public toggleFav = new EventEmitter<void>();\n\n    public map_url = '';\n    public features: ViewerFeature[] = [];\n\n    public get level() {\n        return this._org.levelWithID(this.space?.zones) || this.space?.level;\n    }\n\n    public get building() {\n        return this._org.buildings.find((_) =>\n            this.space?.zones.includes(_.id)\n        );\n    }\n\n    constructor(private _org: OrganisationService) {}\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.space && this.space) {\n            this._updateFeature();\n        }\n    }\n\n    private _updateFeature() {\n        this.map_url = this.level?.map_id;\n        this.features = [\n            {\n                location: this.space?.map_id,\n                content: MapPinComponent,\n            },\n        ];\n    }\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { EventFormService } from 'libs/events/src/lib/event-form.service';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\n\nimport { Space } from '../space.class';\n\n@Component({\n    selector: `space-list`,\n    template: `\n        <h3 class=\"font-bold\">Results</h3>\n        <p count class=\"text-sm opacity-60 mb-4\" i18n>\n            {{ (available_spaces | async)?.length || 0 }} result(s) found\n        </p>\n        <ng-container *ngIf=\"!(loading | async); else load_state\">\n            <ul\n                class=\"list-style-none space-y-2\"\n                *ngIf=\"(available_spaces | async)?.length; else empty_state\"\n            >\n                <li\n                    space\n                    *ngFor=\"let space of available_spaces | async\"\n                    [class.!border-info]=\"active === space.id\"\n                    class=\"relative p-2 rounded-lg w-full shadow border bg-base-100 border-base-200\"\n                >\n                    <button\n                        matRipple\n                        name=\"select-space\"\n                        class=\"w-full h-full flex items-center\"\n                        (click)=\"selectSpace(space)\"\n                    >\n                        <div\n                            class=\"relative min-w-[5rem] w-20 h-20 rounded-xl bg-base-200 mr-4 overflow-hidden flex items-center justify-center\"\n                        >\n                            <div\n                                class=\"absolute top-1 left-1 border border-neutral bg-base-200 rounded-full h-6 w-6 flex items-center justify-center text-white\"\n                                *ngIf=\"selected.includes(space.id)\"\n                            >\n                                <app-icon>done</app-icon>\n                            </div>\n                            <img\n                                auth\n                                *ngIf=\"\n                                    space.images?.length;\n                                    else space_placeholder\n                                \"\n                                class=\"object-cover h-full\"\n                                [source]=\"space.images[0]\"\n                            />\n                            <ng-template #space_placeholder>\n                                <img\n                                    class=\"m-auto\"\n                                    src=\"assets/icons/room-placeholder.svg\"\n                                />\n                            </ng-template>\n                        </div>\n                        <div class=\"space-y-2\">\n                            <div class=\"font-medium truncate mr-10\">\n                                {{\n                                    space.display_name ||\n                                        space.name ||\n                                        'Meeting Space'\n                                }}\n                            </div>\n                            <div class=\"flex items-center text-sm space-x-2\">\n                                <app-icon class=\"text-info\">place</app-icon>\n                                <p class=\"truncate\">\n                                    {{\n                                        space.location ||\n                                            level(space.zones)?.display_name ||\n                                            level(space.zones)?.name\n                                    }}\n                                </p>\n                            </div>\n                            <div class=\"flex items-center text-sm space-x-2\">\n                                <app-icon class=\"text-info\">people</app-icon>\n                                <p i18n>\n                                    {{\n                                        space.capacity < 1 ? 2 : space.capacity\n                                    }}\n                                    People\n                                </p>\n                            </div>\n                        </div>\n                    </button>\n                    <button\n                        icon\n                        matRipple\n                        name=\"toggle-space-favourite\"\n                        class=\"absolute top-1 right-1\"\n                        [class.text-info]=\"isFavourite(space.id)\"\n                        (click)=\"toggleFav.emit(space)\"\n                    >\n                        <app-icon>{{\n                            isFavourite(space.id)\n                                ? 'favorite'\n                                : 'favorite_border'\n                        }}</app-icon>\n                    </button>\n                </li>\n            </ul>\n        </ng-container>\n        <ng-template #empty_state>\n            <div\n                empty\n                class=\"p-16 flex flex-col items-center justify-center space-y-2\"\n            >\n                <p class=\"opacity-30 text-center\" i18n>\n                    No available spaces for selected time and/or filters\n                </p>\n            </div>\n        </ng-template>\n        <ng-template #load_state>\n            <div\n                loading\n                class=\"p-16 flex flex-col items-center justify-center space-y-2\"\n            >\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p class=\"opacity-30\" i18n>Finding available spaces...</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                width: 100%;\n                height: 100%;\n                padding: 0.5rem;\n                overflow: auto;\n            }\n        `,\n    ],\n})\nexport class SpaceListComponent {\n    @Input() public active: string = '';\n    @Input() public selected: string = '';\n    @Input() public favorites: string[] = [];\n    @Output() public onSelect = new EventEmitter<Space>();\n    @Output() public toggleFav = new EventEmitter<Space>();\n    public readonly loading = this._event_form.loading;\n\n    public readonly available_spaces = this._event_form.available_spaces;\n\n    constructor(\n        private _event_form: EventFormService,\n        private _org: OrganisationService\n    ) {}\n\n    public level(zones: string[]) {\n        return this._org.levelWithID(zones);\n    }\n\n    public ngOnInit() {\n        this._event_form.setView('find');\n    }\n\n    public isFavourite(space_id: string) {\n        return this.favorites.includes(space_id);\n    }\n\n    public selectSpace(space: Space) {\n        this.onSelect.emit(space);\n    }\n}\n","import { Component, Input, Optional } from '@angular/core';\nimport { MatBottomSheetRef } from '@angular/material/bottom-sheet';\nimport {\n    flatten,\n    MapsPeopleService,\n    SettingsService,\n    unique,\n} from '@placeos/common';\nimport { addDays, endOfDay, startOfDay } from 'date-fns';\nimport { combineLatest } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\n\nimport { EventFormService } from 'libs/events/src/lib/event-form.service';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { Building } from 'libs/organisation/src/lib/building.class';\nimport { SpacesService } from '../spaces.service';\nimport { Region } from '@placeos/organisation';\n\n@Component({\n    selector: `space-filters`,\n    template: `\n        <div class=\"flex items-center border-b border-base-200 pb-2 sm:hidden\">\n            <div class=\"flex-1 pl-2\">\n                <button\n                    icon\n                    matRipple\n                    name=\"close-space-filters\"\n                    *ngIf=\"can_close\"\n                    (click)=\"close()\"\n                >\n                    <app-icon>keyboard_arrow_left</app-icon>\n                </button>\n            </div>\n            <h3 class=\"font-medium flex-2 text-center\" i18n>Space Filters</h3>\n            <div class=\"flex-1\"></div>\n        </div>\n        <form\n            class=\"max-h-[65vh] p-2 overflow-y-auto overflow-x-hidden divide-y divide-base-200 w-full max-w-[100vw]\"\n            [formGroup]=\"form\"\n        >\n            <section details>\n                <h2 class=\"text-lg font-medium mb-1\" i18n>Details</h2>\n                <div class=\"flex-1 min-w-[8rem] flex flex-col\">\n                    <label for=\"location\" i18n>Location</label>\n                    <mat-form-field\n                        appearance=\"outline\"\n                        class=\"w-full\"\n                        *ngIf=\"use_region && (regions | async)?.length\"\n                    >\n                        <mat-select\n                            name=\"region\"\n                            [ngModel]=\"region\"\n                            (ngModelChange)=\"setRegion($event)\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            placeholder=\"Any Region\"\n                            i18n-placeholder\n                        >\n                            <mat-option\n                                *ngFor=\"let reg of regions | async\"\n                                [value]=\"reg\"\n                            >\n                                {{ reg.display_name || reg.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                    <mat-form-field\n                        appearance=\"outline\"\n                        class=\"w-full\"\n                        *ngIf=\"!use_region && (buildings | async)?.length > 1\"\n                    >\n                        <mat-select\n                            name=\"building\"\n                            [ngModel]=\"building | async\"\n                            (ngModelChange)=\"setBuilding($event)\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            [placeholder]=\"\n                                (building | async)?.display_name ||\n                                (building | async)?.name\n                            \"\n                        >\n                            <mat-option\n                                *ngFor=\"let bld of buildings | async\"\n                                [value]=\"bld\"\n                            >\n                                {{ bld.display_name || bld.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                    <mat-form-field\n                        appearance=\"outline\"\n                        class=\"w-full\"\n                        *ngIf=\"!hide_levels\"\n                    >\n                        <mat-select\n                            name=\"location\"\n                            [ngModel]=\"(options | async)?.zone_ids\"\n                            (ngModelChange)=\"setOptions({ zone_ids: $event })\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            placeholder=\"Any Level\"\n                            i18n-placeholder\n                            [multiple]=\"true\"\n                        >\n                            <mat-option\n                                *ngFor=\"let lvl of levels | async\"\n                                [value]=\"lvl.id\"\n                            >\n                                <div class=\"flex flex-col-reverse\">\n                                    <div\n                                        class=\"opacity-30 text-xs\"\n                                        *ngIf=\"use_region\"\n                                    >\n                                        {{\n                                            (lvl.parent_id | building)\n                                                ?.display_name\n                                        }}\n                                        <span class=\"opacity-0\"> - </span>\n                                    </div>\n                                    <div>\n                                        {{ lvl.display_name || lvl.name }}\n                                    </div>\n                                </div>\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex items-center flex-wrap sm:space-x-2\">\n                    <div class=\"flex-1 min-w-[8rem]\">\n                        <label for=\"date\" i18n>Date<span>*</span></label>\n                        <a-date-field\n                            name=\"date\"\n                            [ngModel]=\"form.getRawValue().date\"\n                            (ngModelChange)=\"form.patchValue({ date: $event })\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            i18n\n                            [to]=\"end_date\"\n                            [short]=\"true\"\n                        >\n                            {{ 'FORM.DATE_ERROR' | translate }}\n                        </a-date-field>\n                    </div>\n                    <div class=\"flex-1 min-w-[8rem] relative\" *ngIf=\"multiday\">\n                        <label for=\"date\">\n                            {{ 'FORM.END_DATE' | translate }}<span>*</span>\n                        </label>\n                        <a-date-field\n                            name=\"date\"\n                            [ngModel]=\"form.getRawValue().date_end\"\n                            (ngModelChange)=\"\n                                form.patchValue({ date_end: $event })\n                            \"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            [from]=\"start_date\"\n                            [to]=\"end_date\"\n                            [short]=\"true\"\n                        >\n                            {{ 'FORM.DATE_ERROR' | translate }}\n                        </a-date-field>\n                    </div>\n                </div>\n                <!-- All Day -->\n                <div *ngIf=\"allow_all_day\" class=\"flex justify-end -mt-2 mb-2\">\n                    <mat-checkbox formControlName=\"all_day\" i18n>\n                        All Day\n                    </mat-checkbox>\n                </div>\n                <div\n                    class=\"flex items-center space-x-2\"\n                    *ngIf=\"!form.value.all_day\"\n                >\n                    <div class=\"flex-1 w-1/3\">\n                        <label for=\"start-time\" i18n>\n                            Start Time<span>*</span>\n                        </label>\n                        <a-time-field\n                            name=\"start-time\"\n                            [ngModel]=\"form.getRawValue().date\"\n                            (ngModelChange)=\"form.patchValue({ date: $event })\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            [use_24hr]=\"use_24hr\"\n                        ></a-time-field>\n                    </div>\n                    <div class=\"flex-1 w-1/3\" *ngIf=\"multiday\">\n                        <label for=\"end-time\">\n                            {{ 'FORM.END_TIME' | translate }}<span>*</span>\n                        </label>\n                        <a-time-field\n                            name=\"end-time\"\n                            [ngModel]=\"form.value.date_end\"\n                            (ngModelChange)=\"\n                                form.patchValue({ date_end: $event })\n                            \"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            [from]=\"form?.getRawValue()?.date\"\n                            [use_24hr]=\"use_24hr\"\n                        ></a-time-field>\n                    </div>\n                    <div class=\"flex-1 w-1/3\" *ngIf=\"!multiday\">\n                        <label for=\"end-time\">\n                            {{ 'FORM.END_TIME' | translate }}<span>*</span>\n                        </label>\n                        <a-duration-field\n                            name=\"end-time\"\n                            formControlName=\"duration\"\n                            [time]=\"form?.getRawValue()?.date\"\n                            [max]=\"max_duration\"\n                            [use_24hr]=\"use_24hr\"\n                        ></a-duration-field>\n                    </div>\n                </div>\n            </section>\n            <section\n                favs\n                class=\"space-y-2 pb-4\"\n                *ngIf=\"!viewing_map || !(using_mapspeople | async)\"\n            >\n                <h2 class=\"text-lg font-medium\" i18n>\n                    {{ 'COMMON.FAVOURITES' | translate }}\n                </h2>\n                <div class=\"flex items-center\">\n                    <div for=\"fav\" class=\"flex-1 w-1/2\" i18n>\n                        {{ 'ROOMS.SHOW_FAVOURITES' | translate }}\n                    </div>\n                    <mat-checkbox\n                        name=\"fav\"\n                        [ngModel]=\"(options | async)?.show_fav\"\n                        (ngModelChange)=\"setOptions({ show_fav: $event })\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                    >\n                    </mat-checkbox>\n                </div>\n            </section>\n            <section\n                features\n                class=\"space-y-2\"\n                *ngIf=\"\n                    (features | async)?.length &&\n                    (!viewing_map || !(using_mapspeople | async))\n                \"\n            >\n                <h2 class=\"text-lg font-medium\" i18n>Facilities</h2>\n                <ng-container *ngFor=\"let feat of features | async\">\n                    <div\n                        class=\"flex items-center\"\n                        *ngIf=\"!hide_features.includes(feat)\"\n                    >\n                        <div for=\"feat\" class=\"flex-1 w-1/2\">\n                            {{ feature_display[feat] || feat }}\n                        </div>\n                        <mat-checkbox\n                            name=\"feat\"\n                            [ngModel]=\"\n                                (options | async)?.features?.includes(feat)\n                            \"\n                            (ngModelChange)=\"toggleFeature(feat, $event)\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                        ></mat-checkbox>\n                    </div>\n                </ng-container>\n            </section>\n        </form>\n        <div\n            class=\"px-2 pt-2 w-full border-t border-base-200\"\n            *ngIf=\"can_close\"\n        >\n            <button\n                btn\n                matRipple\n                class=\"w-full\"\n                name=\"apply-space-filters\"\n                (click)=\"close()\"\n                i18n\n            >\n                Apply Filters\n            </button>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                width: 100%;\n                max-width: 100vw;\n            }\n        `,\n    ],\n})\nexport class SpaceFiltersComponent {\n    @Input() public multiday: boolean;\n    @Input() public hide_levels: boolean;\n    @Input() public viewing_map: boolean;\n    public can_close = false;\n    public readonly options = this._event_form.options;\n\n    public readonly building = this._org.active_building;\n    public readonly buildings = this._org.active_buildings;\n\n    public readonly levels = combineLatest([\n        this._org.active_region,\n        this._org.active_building,\n    ]).pipe(\n        map(([region, bld]) => {\n            const level_list = this.use_region\n                ? this._org.levelsForRegion(region)\n                : this._org.levelsForBuilding(bld);\n            const viewable_levels = level_list.filter(\n                (lvl) => !lvl.tags.includes('parking')\n            );\n            return viewable_levels.sort(\n                (a, b) =>\n                    a.parent_id.localeCompare(b.parent_id) ||\n                    (a.display_name || '').localeCompare(b.display_name || '')\n            );\n        })\n    );\n\n    public readonly regions = this._org.region_list;\n\n    public readonly using_mapspeople = this._mapspeople.available$;\n\n    public readonly features = combineLatest([\n        this._spaces.features,\n        this._event_form.available_spaces,\n    ]).pipe(\n        map(([features, spaces]) =>\n            unique(features.concat(flatten(spaces.map((_) => _.features))))\n        )\n    );\n\n    public get allow_all_day() {\n        return !!this._settings.get('app.events.allow_all_day');\n    }\n\n    public get use_region() {\n        return !!this._settings.get('app.use_region');\n    }\n\n    public readonly close = () => this._bsheet_ref.dismiss();\n    public readonly setOptions = (o) => this._event_form.setOptions(o);\n\n    public get bld() {\n        return this._org.building;\n    }\n\n    public get region() {\n        return this._org.region;\n    }\n\n    public get form() {\n        return this._event_form.form;\n    }\n\n    public get max_duration() {\n        return this._settings.get('app.events.max_duration') || 480;\n    }\n\n    public get feature_display() {\n        return this._settings.get('app.events.feature_decriptions') || {};\n    }\n\n    public get hide_features() {\n        return this._settings.get('app.events.hide_features') || [];\n    }\n\n    public get use_24hr() {\n        return this._settings.get('app.use_24_hour_time');\n    }\n\n    public get start_date() {\n        return startOfDay(this.form.getRawValue().date).valueOf();\n    }\n\n    public get end_date() {\n        return endOfDay(\n            addDays(\n                Date.now(),\n                this._settings.get('app.events.allowed_future_days') || 180\n            )\n        );\n    }\n\n    constructor(\n        @Optional()\n        private _bsheet_ref: MatBottomSheetRef<SpaceFiltersComponent>,\n        private _settings: SettingsService,\n        private _event_form: EventFormService,\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private _mapspeople: MapsPeopleService\n    ) {\n        this.can_close = !!this._bsheet_ref;\n    }\n\n    public setBuilding(bld: Building) {\n        this._org.building = bld;\n    }\n\n    public setRegion(region: Region) {\n        this._org.region = region;\n    }\n\n    public async toggleFeature(feat: string, state: boolean) {\n        const { features } = await this.options.pipe(take(1)).toPromise();\n        const new_list = (features || []).filter((_) => feat !== _);\n        if (state) new_list.push(feat);\n        this.setOptions({ features: new_list });\n    }\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { MatBottomSheet } from '@angular/material/bottom-sheet';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport { EventFormService } from 'libs/events/src/lib/event-form.service';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { take } from 'rxjs/operators';\nimport { SpaceFiltersComponent } from './space-filters.component';\n\n@Component({\n    selector: `space-filters-display`,\n    template: `\n        <section actions class=\"sm:hidden space-x-2 flex items-center p-2\">\n            <button\n                btn\n                matRipple\n                name=\"edit-space-filters\"\n                class=\"flex-1 w-1/2\"\n                (click)=\"editFilters()\"\n                i18n\n            >\n                Filters\n            </button>\n            <div class=\"flex items-center\">\n                <button\n                    btn\n                    matRipple\n                    name=\"view-space-map\"\n                    class=\"rounded-l rounded-r-none\"\n                    [class.inverse]=\"view !== 'map'\"\n                    (click)=\"view = 'map'; viewChange.emit(view)\"\n                    i18n\n                >\n                    Map\n                </button>\n                <button\n                    btn\n                    matRipple\n                    name=\"view-space-list\"\n                    class=\"rounded-r rounded-l-none\"\n                    [class.inverse]=\"view !== 'list'\"\n                    (click)=\"view = 'list'; viewChange.emit(view)\"\n                    i18n\n                >\n                    List\n                </button>\n            </div>\n        </section>\n        <section\n            filters\n            class=\"flex items-center flex-wrap p-2 w-[35rem] max-w-full sm:max-w-[35rem]\"\n        >\n            <button\n                btn\n                matRipple\n                name=\"clear-space-filters\"\n                class=\"min-h-[2rem] mb-2 mr-2\"\n                *ngIf=\"(options | async)?.features?.length > 1\"\n                (click)=\"removeAllFeatures()\"\n            >\n                Clear Filters\n            </button>\n            <div\n                filter-item\n                zone\n                class=\"dark:border-base-200-500\"\n                *ngIf=\"location\"\n            >\n                {{ location }}\n            </div>\n            <div filter-item date class=\"dark:border-base-200-500\">\n                {{ start | date: 'mediumDate' }}\n            </div>\n            <div filter-item time class=\"dark:border-base-200-500\">\n                <ng-container *ngIf=\"!all_day\">\n                    {{ start | date: time_format }} &mdash;\n                    {{ end | date: time_format }}\n                </ng-container>\n                <ng-container *ngIf=\"all_day\">All Day</ng-container>\n            </div>\n            <div filter-item count class=\"dark:border-base-200-500\" i18n>\n                Min. {{ (options | async)?.capacity || 2 }} People\n            </div>\n            <div filter-item *ngFor=\"let feat of (options | async)?.features\">\n                <p class=\"truncate\">{{ feat }}</p>\n                <button\n                    icon\n                    matRipple\n                    name=\"remove-space-filter\"\n                    class=\"-mr-4\"\n                    (click)=\"removeFeature(feat)\"\n                >\n                    <app-icon>close</app-icon>\n                </button>\n            </div>\n        </section>\n    `,\n    styles: [\n        `\n            [filter-item] {\n                display: flex;\n                align-items: center;\n                padding: 0 1rem;\n                min-height: 2rem;\n                font-size: 0.875rem;\n                border: 1px solid rgba(0, 0, 0, 0.2);\n                border-radius: 1.25rem;\n                margin-right: 0.5rem;\n                margin-bottom: 0.5rem;\n                max-width: 100%;\n                text-align: center;\n            }\n\n            [filter-item]:hover {\n                background: rgba(0, 0, 0, 0.1);\n            }\n\n            [filter-item] > * + * {\n                margin-left: 0.5rem;\n            }\n        `,\n    ],\n})\nexport class SpaceFiltersDisplayComponent extends AsyncHandler {\n    @Input() public view: 'map' | 'list' = 'list';\n    @Output() public viewChange = new EventEmitter<'map' | 'list'>();\n    public readonly options = this._event_form.options;\n    public location: string = '';\n\n    public get all_day() {\n        return this._event_form.form.value.all_day;\n    }\n\n    public get start() {\n        return this._event_form.form.value.date;\n    }\n\n    public get end() {\n        const { date, duration } = this._event_form.form.value;\n        return date + duration * 60 * 1000;\n    }\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    public readonly editFilters = () =>\n        this._bsheet.open(SpaceFiltersComponent);\n\n    constructor(\n        private _bsheet: MatBottomSheet,\n        private _event_form: EventFormService,\n        private _org: OrganisationService,\n        private _settings: SettingsService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'opts',\n            this.options.subscribe(({ zone_ids }) =>\n                this._updateLocation(zone_ids)\n            )\n        );\n    }\n\n    public async removeFeature(feat: string) {\n        const value = await this._event_form.options.pipe(take(1)).toPromise();\n        this._event_form.setOptions({\n            ...value,\n            features: (value.features || []).filter((_) => _ !== feat),\n        });\n    }\n\n    public async removeAllFeatures() {\n        const value = await this._event_form.options.pipe(take(1)).toPromise();\n        this._event_form.setOptions({\n            ...value,\n            features: [],\n        });\n    }\n\n    private _updateLocation(zone_ids: string[] = []) {\n        const level = this._org.levelWithID(zone_ids);\n        const item = level || this._org.building;\n        this.location = item?.display_name || item?.name || '';\n    }\n}\n","import { Component, ElementRef, Inject, OnInit } from '@angular/core';\nimport { MAP_FEATURE_DATA } from '@placeos/components';\nimport { SettingsService } from 'libs/common/src/lib/settings.service';\nimport { CalendarEvent } from 'libs/events/src/lib/event.class';\nimport { Space } from 'libs/spaces/src/lib/space.class';\n\nexport interface SpaceInfoData {\n    space: Space;\n    events: CalendarEvent[];\n    status:\n        | 'free'\n        | 'busy'\n        | 'pending'\n        | 'reserved'\n        | 'not-bookable'\n        | 'unknown'\n        | '';\n}\n\n@Component({\n    selector: 'explore-space-info',\n    template: `\n        <div\n            #tooltip\n            customTooltip\n            [content]=\"space_tooltip\"\n            [backdrop]=\"false\"\n            [xPosition]=\"'center'\"\n            [yPosition]=\"'center'\"\n            [hover]=\"true\"\n            [delay]=\"3000\"\n            [attr.id]=\"space?.map_id || space?.id\"\n            (mouseenter)=\"updateOffset()\"\n            class=\"h-full w-full pointer-events-auto relative hidden sm:block cursor-pointer\"\n        ></div>\n        <ng-template #space_tooltip>\n            <div\n                name=\"space-info\"\n                [id]=\"space?.id\"\n                class=\"\n                    absolute rounded bg-base-100 top-0 left-0 transform shadow pointer-events-none overflow-hidden\n                \"\n                [class.-translate-x-full]=\"x_pos === 'end'\"\n                [class.-translate-y-full]=\"y_pos === 'bottom'\"\n            >\n                <div class=\"arrow\"></div>\n                <div class=\"relative\">\n                    <div\n                        class=\"w-full overflow-hidden flex items-center justify-center relative bg-opacity-20\"\n                        [class.bg-neutral]=\"space.images[0]\"\n                        [class.h-32]=\"space.images[0]\"\n                        [class.h-8]=\"!space.images[0]\"\n                    >\n                        <img\n                            auth\n                            *ngIf=\"space.images[0]\"\n                            [source]=\"space.images[0]\"\n                            class=\"object-cover min-h-full min-w-full\"\n                        />\n                        <div\n                            class=\"absolute inset-0 bg-neutral\"\n                            *ngIf=\"space.images[0]\"\n                        ></div>\n                    </div>\n                    <div class=\"absolute top-2 left-2 flex flex-wrap text-sm \">\n                        <div\n                            status\n                            [class]=\"\n                                'capitalize rounded p-1 px-2 text-light border border-white shadow ' +\n                                status\n                            \"\n                        >\n                            { status, select, free { Free } busy { Busy }\n                            pending { Pending } reserved { Reserved } other {\n                            Not Bookable } }\n                        </div>\n                        <div available-until *ngIf=\"status !== 'not-bookable'\">\n                            {{ available_until }}\n                        </div>\n                    </div>\n                    <div class=\"flex flex-col py-4 px-2\">\n                        <h4 class=\"font-medium text-xl mb-2 px-2\">\n                            {{ space.display_name || space.name }}\n                        </h4>\n                        <div\n                            capacity\n                            class=\"text-base px-2 mb-2\"\n                            *ngIf=\"space.capacity >= 0\"\n                        >\n                            <span i18n>Capacity: </span>{{ space.capacity }}\n                            {{ space.capacity === 1 ? 'person' : 'people' }}\n                        </div>\n                        <ul\n                            class=\"flex flex-wrap\"\n                            *ngIf=\"space.features?.length > 0 && show_features\"\n                        >\n                            <li\n                                class=\"text-xs px-2 py-1 m-1 rounded-2xl bg-base-200 font-medium\"\n                                *ngFor=\"let feature of space.features\"\n                            >\n                                {{ feature }}\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            [name='space-info'] {\n                width: 16rem;\n            }\n\n            [status] {\n                background-color: #43a047;\n                font-weight: 500;\n            }\n\n            [status].busy {\n                background-color: #e53935;\n            }\n\n            [status].pending {\n                background-color: #ffb300;\n            }\n\n            [status].not-bookable {\n                background-color: #757575;\n            }\n        `,\n    ],\n})\nexport class ExploreSpaceInfoComponent implements OnInit {\n    /** Space to display details for */\n    public readonly space = this._details.space;\n    /** List of upcoming events for space */\n    public readonly events = this._details.events;\n    /** Current status of the space */\n    public readonly status = this._details.status;\n\n    public y_pos: 'top' | 'bottom';\n\n    public x_pos: 'start' | 'end';\n\n    public get show_features() {\n        return !this._settings.get('app.spaces.hide_features');\n    }\n\n    constructor(\n        @Inject(MAP_FEATURE_DATA) private _details: SpaceInfoData,\n        private _settings: SettingsService,\n        private _element: ElementRef<HTMLElement>\n    ) {}\n\n    public ngOnInit() {\n        setTimeout(() => this.updateOffset(), 200);\n    }\n\n    public updateOffset() {\n        const pos = this._element.nativeElement.getBoundingClientRect();\n        this.x_pos = pos.x < document.body.clientWidth / 2 ? 'start' : 'end';\n        this.y_pos = pos.y < document.body.clientHeight / 2 ? 'top' : 'bottom';\n    }\n\n    public get available_until() {\n        return '';\n    }\n}\n","import { Component, Inject, OnInit } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport {\n    currentUser,\n    notifyError,\n    notifySuccess,\n    SettingsService,\n} from '@placeos/common';\n\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport { EventFormService } from 'libs/events/src/lib/event-form.service';\nimport { Router } from '@angular/router';\n\nexport interface ExploreBookingModalData {\n    space: Space;\n}\n\n@Component({\n    selector: 'explore-booking-modal',\n    template: `\n        <header>\n            <h2 i18n>New Booking</h2>\n            <div class=\"flex-1\"></div>\n            <button *ngIf=\"!(loading | async)\" icon matRipple mat-dialog-close>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <ng-container *ngIf=\"!(loading | async); else load_state\">\n            <main *ngIf=\"form\" [formGroup]=\"form\" class=\"p-4 max-w-[85vw]\">\n                <div class=\"flex flex-col\">\n                    <label for=\"title\">Title<span>*</span>:</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"title\"\n                            formControlName=\"title\"\n                            placeholder=\"Booking Title\"\n                            i18n-placeholder\n                        />\n                        <mat-error i18n>Booking title is required</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col\" *ngIf=\"can_book_for_others\">\n                    <label for=\"host\">Host<span>*</span>:</label>\n                    <a-user-search-field\n                        name=\"host\"\n                        formControlName=\"organiser\"\n                        class=\"mb-4\"\n                    ></a-user-search-field>\n                </div>\n                <div class=\"flex flex-col\">\n                    <label i18n>Space:</label>\n                    <div\n                        name=\"space\"\n                        class=\"px-4 py-3 border border-base-200 rounded w-full mb-4\"\n                    >\n                        {{\n                            form.controls.resources?.value[0]?.display_name ||\n                                form.controls.resources?.value[0]?.name\n                        }}\n                    </div>\n                </div>\n                <div class=\"flex sm:space-x-4 flex-wrap\">\n                    <div\n                        class=\"flex flex-col flex-1 w-full sm:w-auto\"\n                        *ngIf=\"form.controls.date\"\n                    >\n                        <label i18n>Date:</label>\n                        <div\n                            class=\"px-4 py-3 border border-base-200 rounded w-full mb-4\"\n                        >\n                            {{ form.value.date | date: 'mediumDate' }} at\n                            {{ form.value.date | date: time_format }}\n                        </div>\n                    </div>\n                    <div\n                        class=\"flex flex-col w-full sm:w-auto\"\n                        *ngIf=\"form.controls.duration\"\n                    >\n                        <label i18n>Duration:</label>\n                        <a-duration-field\n                            formControlName=\"duration\"\n                            [time]=\"form.value.date\"\n                            [max]=\"max_duration\"\n                            class=\"w-full\"\n                            [use_24hr]=\"use_24hr_time\"\n                        ></a-duration-field>\n                    </div>\n                </div>\n            </main>\n            <footer class=\"flex justify-center p-2 border-t border-base-200\">\n                <button btn matRipple class=\"w-32\" (click)=\"save()\" i18n>\n                    Save\n                </button>\n            </footer>\n        </ng-container>\n        <ng-template #load_state>\n            <div load class=\"h-64 flex flex-col items-center justify-center\">\n                <mat-spinner class=\"m-4\" [diameter]=\"48\"></mat-spinner>\n                <p>{{ loading | async }}</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            header {\n                max-width: calc(100vw + 100%);\n            }\n\n            [load] {\n                width: 32rem;\n                max-width: calc(100vw - 2rem);\n            }\n        `,\n    ],\n})\nexport class ExploreBookingModalComponent implements OnInit {\n    public readonly loading = this._event_form.loading;\n\n    public get form() {\n        return this._event_form.form;\n    }\n\n    public get max_duration() {\n        return this._settings.get('app.events.max_duration') || 4 * 60;\n    }\n\n    public get can_book_for_others() {\n        return this._settings.get('app.events.can_book_for_others');\n    }\n\n    public get use_24hr_time() {\n        return this._settings.get('app.use_24_hour_time');\n    }\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: ExploreBookingModalData,\n        private _settings: SettingsService,\n        private _event_form: EventFormService,\n        private _dialog_ref: MatDialogRef<ExploreBookingModalComponent>,\n        private _router: Router\n    ) {}\n\n    public ngOnInit() {\n        this._event_form.newForm();\n        this.form.patchValue({\n            resources: [this._data.space],\n            host: currentUser().email,\n            organiser: currentUser(),\n        });\n    }\n\n    public async save() {\n        await this._event_form.postForm().catch((_) => {\n            notifyError(_);\n            throw _;\n        });\n        if (this._settings.app_name.toLowerCase().includes('workplace')) {\n            this._router.navigate(['/book', 'meeting', 'success']);\n        } else {\n            notifySuccess('Successfully booked room.');\n        }\n        this._dialog_ref.close();\n    }\n}\n","// @ts-nocheck\n/** From https://github.com/chuckfairy/VanillaQR.js */\nexport function VanillaQR(r){var e=this;r=\"object\"==typeof r?r:{},e.revision=3,e.imageTypes={bmp:\"image/bmp\",gif:\"image/gif\",jpeg:\"image/jpeg\",jpg:\"image/jpg\",png:\"image/png\",\"svg+xml\":\"image/svg+xml\",tiff:\"image/tiff\",webp:\"image/webp\",\"x-icon\":\"image/x-icon\"},e.toTable=r.toTable,e.domElement=e.toTable?document.createElement(\"div\"):document.createElement(\"canvas\"),e.url=r.url||\"\",e.size=r.size||280,e.qrc=!1,e.colorLight=r.colorLight||\"#fff\",e.colorDark=r.colorDark||\"#000\",e.ecclevel=r.ecclevel||1,e.noBorder=r.noBorder,e.borderSize=r.borderSize||4;var o,a,t,i,n,l,f,c=[],s=[],d=[],g=[],h=[],v=[],m=function(r,e){var o;r>e&&(o=r,r=e,e=o),o=e,o*=e,o+=e,o>>=1,g[o+=r]=1},u=function(r,e){var o;for(d[r+t*e]=1,o=-2;o<2;o++)d[r+o+t*(e-2)]=1,d[r-2+t*(e+o+1)]=1,d[r+2+t*(e+o)]=1,d[r+o+1+t*(e+2)]=1;for(o=0;o<2;o++)m(r-1,e+o),m(r+1,e-o),m(r-o,e-1),m(r+o,e+1)},p=function(r){for(;r>=255;)r=((r-=255)>>8)+(255&r);return r},b=function(r,e,o,a){var t,i,n,l=VanillaQR.gexp,f=VanillaQR.glog;for(t=0;t<a;t++)c[o+t]=0;for(t=0;t<e;t++){if(255!=(n=f[c[r+t]^c[o]]))for(i=1;i<a;i++)c[o+i-1]=c[o+i]^l[p(n+v[a-i])];else for(i=o;i<o+a;i++)c[i]=c[i+1];c[o+a-1]=255==n?0:l[p(n+v[0])]}},R=function(r,e){var o;return r>e&&(o=r,r=e,e=o),o=e,o+=e*e,o>>=1,g[o+=r]},Q=function(r){var e,o,a,i;switch(r){case 0:for(o=0;o<t;o++)for(e=0;e<t;e++)e+o&1||R(e,o)||(d[e+o*t]^=1);break;case 1:for(o=0;o<t;o++)for(e=0;e<t;e++)1&o||R(e,o)||(d[e+o*t]^=1);break;case 2:for(o=0;o<t;o++)for(a=0,e=0;e<t;e++,a++)3==a&&(a=0),a||R(e,o)||(d[e+o*t]^=1);break;case 3:for(i=0,o=0;o<t;o++,i++)for(3==i&&(i=0),a=i,e=0;e<t;e++,a++)3==a&&(a=0),a||R(e,o)||(d[e+o*t]^=1);break;case 4:for(o=0;o<t;o++)for(a=0,i=o>>1&1,e=0;e<t;e++,a++)3==a&&(a=0,i=!i),i||R(e,o)||(d[e+o*t]^=1);break;case 5:for(i=0,o=0;o<t;o++,i++)for(3==i&&(i=0),a=0,e=0;e<t;e++,a++)3==a&&(a=0),(e&o&1)+!(!a|!i)||R(e,o)||(d[e+o*t]^=1);break;case 6:for(i=0,o=0;o<t;o++,i++)for(3==i&&(i=0),a=0,e=0;e<t;e++,a++)3==a&&(a=0),(e&o&1)+(a&&a==i)&1||R(e,o)||(d[e+o*t]^=1);break;case 7:for(i=0,o=0;o<t;o++,i++)for(3==i&&(i=0),a=0,e=0;e<t;e++,a++)3==a&&(a=0),(a&&a==i)+(e+o&1)&1||R(e,o)||(d[e+o*t]^=1)}},V=function(r){var e,o=0;for(e=0;e<=r;e++)h[e]>=5&&(o+=VanillaQR.N1+h[e]-5);for(e=3;e<r-1;e+=2)h[e-2]==h[e+2]&&h[e+2]==h[e-1]&&h[e-1]==h[e+1]&&3*h[e-1]==h[e]&&(0==h[e-3]||e+3>r||3*h[e-3]>=4*h[e]||3*h[e+3]>=4*h[e])&&(o+=VanillaQR.N3);return o},k=function(){var r,e,o,a,i,n=0,l=0;for(e=0;e<t-1;e++)for(r=0;r<t-1;r++)(d[r+t*e]&&d[r+1+t*e]&&d[r+t*(e+1)]&&d[r+1+t*(e+1)]||!(d[r+t*e]||d[r+1+t*e]||d[r+t*(e+1)]||d[r+1+t*(e+1)]))&&(n+=VanillaQR.N2);for(e=0;e<t;e++){for(h[0]=0,o=a=r=0;r<t;r++)(i=d[r+t*e])==a?h[o]++:h[++o]=1,l+=(a=i)?1:-1;n+=V(o)}l<0&&(l=-l);var f=l,c=0;for(f+=f<<2,f<<=1;f>t*t;)f-=t*t,c++;for(n+=c*VanillaQR.N4,r=0;r<t;r++){for(h[0]=0,o=a=e=0;e<t;e++)(i=d[r+t*e])==a?h[o]++:h[++o]=1,a=i;n+=V(o)}return n};e.genframe=function(r){var e,h,V,x,C,w,E,N,T=VanillaQR.eccblocks,y=VanillaQR.gexp,z=VanillaQR.glog;x=r.length,a=0;do{if(a++,V=4*(o-1)+16*(a-1),i=T[V++],n=T[V++],l=T[V++],f=T[V],x<=(V=l*(i+n)+n-3+(a<=9)))break}while(a<40);for(t=17+4*a,C=l+(l+f)*(i+n)+n,x=0;x<C;x++)s[x]=0;for(c=r.slice(0),x=0;x<t*t;x++)d[x]=0;for(x=0;x<(t*(t+1)+1)/2;x++)g[x]=0;for(x=0;x<3;x++){for(V=0,h=0,1==x&&(V=t-7),2==x&&(h=t-7),d[h+3+t*(V+3)]=1,e=0;e<6;e++)d[h+e+t*V]=1,d[h+t*(V+e+1)]=1,d[h+6+t*(V+e)]=1,d[h+e+1+t*(V+6)]=1;for(e=1;e<5;e++)m(h+e,V+1),m(h+1,V+e+1),m(h+5,V+e),m(h+e+1,V+5);for(e=2;e<4;e++)d[h+e+t*(V+2)]=1,d[h+2+t*(V+e+1)]=1,d[h+4+t*(V+e)]=1,d[h+e+1+t*(V+4)]=1}if(a>1)for(x=VanillaQR.adelta[a],h=t-7;;){for(e=t-7;e>x-3&&(u(e,h),!(e<x));)e-=x;if(h<=x+9)break;u(6,h-=x),u(h,6)}for(d[8+t*(t-8)]=1,h=0;h<7;h++)m(7,h),m(t-8,h),m(7,h+t-7);for(e=0;e<8;e++)m(e,7),m(e+t-8,7),m(e,t-8);for(e=0;e<9;e++)m(e,8);for(e=0;e<8;e++)m(e+t-8,8),m(8,e);for(h=0;h<7;h++)m(8,h+t-7);for(e=0;e<t-14;e++)1&e?(m(8+e,6),m(6,8+e)):(d[8+e+6*t]=1,d[6+t*(8+e)]=1);if(a>6)for(x=VanillaQR.vpat[a-7],V=17,e=0;e<6;e++)for(h=0;h<3;h++,V--)1&(V>11?a>>V-12:x>>V)?(d[5-e+t*(2-h+t-11)]=1,d[2-h+t-11+t*(5-e)]=1):(m(5-e,2-h+t-11),m(2-h+t-11,5-e));for(h=0;h<t;h++)for(e=0;e<=h;e++)d[e+t*h]&&m(e,h);for(C=c.length,w=0;w<C;w++)s[w]=c.charCodeAt(w);if(c=s.slice(0),C>=(e=l*(i+n)+n)-2&&(C=e-2,a>9&&C--),w=C,a>9){for(c[w+2]=0,c[w+3]=0;w--;)x=c[w],c[w+3]|=255&x<<4,c[w+2]=x>>4;c[2]|=255&C<<4,c[1]=C>>4,c[0]=64|C>>12}else{for(c[w+1]=0,c[w+2]=0;w--;)x=c[w],c[w+2]|=255&x<<4,c[w+1]=x>>4;c[1]|=255&C<<4,c[0]=64|C>>4}for(w=C+3-(a<10);w<e;)c[w++]=236,c[w++]=17;for(v[0]=1,w=0;w<f;w++){for(v[w+1]=1,E=w;E>0;E--)v[E]=v[E]?v[E-1]^y[p(z[v[E]]+w)]:v[E-1];v[0]=y[p(z[v[0]]+w)]}for(w=0;w<=f;w++)v[w]=z[v[w]];for(V=e,h=0,w=0;w<i;w++)b(h,l,V,f),h+=l,V+=f;for(w=0;w<n;w++)b(h,l+1,V,f),h+=l+1,V+=f;for(h=0,w=0;w<l;w++){for(E=0;E<i;E++)s[h++]=c[w+E*l];for(E=0;E<n;E++)s[h++]=c[i*l+w+E*(l+1)]}for(E=0;E<n;E++)s[h++]=c[i*l+w+E*(l+1)];for(w=0;w<f;w++)for(E=0;E<i+n;E++)s[h++]=c[e+w+E*f];for(c=s,e=h=t-1,V=C=1,N=(l+f)*(i+n)+n,w=0;w<N;w++)for(x=c[w],E=0;E<8;E++,x<<=1){128&x&&(d[e+t*h]=1);do{C?e--:(e++,V?0!=h?h--:(V=!V,6==(e-=2)&&(e--,h=9)):h!=t-1?h++:(V=!V,6==(e-=2)&&(e--,h-=8))),C=!C}while(R(e,h))}for(c=d.slice(0),x=0,h=3e4,V=0;V<8&&(Q(V),(e=k())<h&&(h=e,x=V),7!=x);V++)d=c.slice(0);for(x!=V&&Q(x),h=VanillaQR.fmtword[x+(o-1<<3)],V=0;V<8;V++,h>>=1)1&h&&(d[t-1-V+8*t]=1,V<6?d[8+t*V]=1:d[8+t*(V+1)]=1);for(V=0;V<7;V++,h>>=1)1&h&&(d[8+t*(t-7+V)]=1,V?d[6-V+8*t]=1:d[7+8*t]=1);return d},e.init=function(){o=e.ecclevel;var r=e.genframe(e.url);e.toTable?e.tableWrite(r,t):e.canvasWrite(r,t)},e.init()}VanillaQR.prototype={canvasWrite:function(r,e){if(!this.qrc&&(this.qrc=this.getContext(this.domElement),!this.qrc))return this.toTable=!0,this.domElement=document.createElement(\"div\"),void this.tableWrite(r,e);var o=this.size,a=this.qrc;a.lineWidth=1;var t=o;t/=e+10,t=Math.round(t-.5);var i=4;this.noBorder?(a.canvas.width=a.canvas.height=t*e,i=0):a.canvas.width=a.canvas.height=o,a.clearRect(0,0,o,o),a.fillStyle=this.colorLight,a.fillRect(0,0,t*(e+8),t*(e+8)),a.fillStyle=this.colorDark;for(var n=0;n<e;n++)for(var l=0;l<e;l++)r[l*e+n]&&a.fillRect(t*(i+n),t*(i+l),t,t)},tableWrite:function(r,e){var o=this,a=Math.round(this.size/e-3.5)+\"px\",t=e+(o.noBorder?0:2*o.borderSize),i=o.borderSize,n=\"width:\"+a+\";height:\"+a+\";\",l=o.colorLight,f=o.colorDark,c=document.createElement(\"table\");c.style.cssText=\"border:0;border-collapse:collapse;\";for(var s,d=document.createElement(\"tr\"),g=document.createElement(\"td\"),h=function(){return g.cloneNode()},v=function(){var r=h();return r.style.cssText=n+\"background:\"+l,r},m=function(r){for(var e=r.firstChild,o=0;o<i;o++)r.insertBefore(v(),e),r.appendChild(v())},u=0;u<e;u++){var p=d.cloneNode();c.appendChild(p);for(var b=0;b<e;b++)if(1===r[u*e+b]){var R=(s=void 0,(s=h()).style.cssText=n+\"background:\"+f,s);p.appendChild(R)}else{var Q=v();p.appendChild(Q)}o.noBorder||m(p)}o.noBorder||function(r){for(var e=r.firstChild,a=0;a<o.borderSize;a++){for(var i=d.cloneNode(),n=0;n<t;n++){var l=v();i.appendChild(l)}r.appendChild(i),r.insertBefore(i.cloneNode(!0),e)}}(c),o.domElement.innerHTML=\"\",o.domElement.appendChild(c)},getContext:function(r){return r.getContext&&r.getContext(\"2d\")?r.getContext(\"2d\"):(console.log(\"Browser does not have 2d Canvas support\"),!1)},toImage:function(r){if(this.qrc){var e=this.imageTypes[r];if(!e)throw new Error(r+\" is not a valid image type \");var o=new Image;return o.src=this.domElement.toDataURL(e),o}}},VanillaQR.adelta=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],VanillaQR.vpat=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],VanillaQR.fmtword=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],VanillaQR.eccblocks=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],VanillaQR.glog=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],VanillaQR.gexp=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],VanillaQR.N1=3,VanillaQR.N2=3,VanillaQR.N3=40,VanillaQR.N4=10;\n","import { VanillaQR } from './vanillaqr.min';\n\n/** Generates a DataURL for QR code image */\nexport function generateQRCode(code: string, colorLight = '#fff0', colorDark = '#000') {\n    const qr = new VanillaQR({\n        url: code || 'Hello',\n        size: 360,\n        colorLight,\n        colorDark,\n        toTable: false,\n        ecclevel: 1,\n        noBorder: true,\n        borderSize: 0,\n    });\n    return qr?.toImage('svg+xml')?.src;\n}\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { getModule, showMetadata } from '@placeos/ts-client';\nimport { ViewAction, ViewerFeature } from '@placeos/svg-viewer';\nimport {\n    catchError,\n    filter,\n    map,\n    shareReplay,\n    switchMap,\n    take,\n} from 'rxjs/operators';\nimport { combineLatest, Observable, of } from 'rxjs';\n\nimport {\n    AsyncHandler,\n    BookingRuleset,\n    currentUser,\n    HashMap,\n    rulesForResource,\n    SettingsService,\n} from '@placeos/common';\nimport { notifyError } from 'libs/common/src/lib/notifications';\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport { CalendarEvent } from 'libs/events/src/lib/event.class';\nimport { EventFormService } from 'libs/events/src/lib/event-form.service';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\n\nimport { ExploreStateService } from './explore-state.service';\nimport { ExploreSpaceInfoComponent } from './explore-space-info.component';\nimport { ExploreBookingModalComponent } from './explore-booking-modal.component';\nimport { ExploreBookQrComponent } from './explore-book-qr.component';\nimport { ExploreIconComponent } from './explore-icon.component';\n\nexport const DEFAULT_COLOURS = {\n    free: '#43a047',\n    pending: '#ffb300',\n    reserved: '#e65100',\n    busy: '#e53935',\n    'signs-of-life': '#1565c0',\n    'not-bookable': '#757575',\n    unknown: '#757575',\n};\n\n@Injectable()\nexport class ExploreSpacesService extends AsyncHandler implements OnDestroy {\n    private _bookings: Record<string, CalendarEvent[]> = {};\n    private _statuses: Record<string, string> = {};\n    private _presence: Record<string, boolean> = {};\n    private _panning = true;\n    private _last_action = '';\n\n    public readonly booking_rules: Observable<BookingRuleset[]> =\n        this._org.active_building.pipe(\n            filter((bld) => !!bld),\n            switchMap((bld) =>\n                showMetadata(bld.id, `room_booking_rules`).pipe(\n                    catchError(() => of({ details: [] })),\n                ),\n            ),\n            map((_) => (_?.details instanceof Array ? _.details : [])),\n            shareReplay(1),\n        );\n\n    private _bind = combineLatest([\n        this._state.spaces,\n        this._state.options,\n    ]).pipe(\n        filter(([_, { is_public }]) => !is_public),\n        map(([list]) => {\n            this.unsubWith('b-');\n            this.unsubWith('s-');\n            this.unsubWith('c-');\n            this._statuses = {};\n            if (!list?.length) return;\n            for (const space of list) {\n                const mod = getModule(space.id, 'Bookings');\n                let binding = mod.binding('bookings');\n                this.subscription(\n                    `b-${space.id}`,\n                    binding\n                        .listen()\n                        .subscribe((d) =>\n                            this.handleBookingsChange(list, space, d),\n                        ),\n                );\n                this.subscription(`b-bind-${space.id}`, binding.bind());\n                binding = mod.binding('status');\n                this.subscription(\n                    `s-${space.id}`,\n                    binding\n                        .listen()\n                        .subscribe((d) =>\n                            this.handleStatusChange(list, space, d),\n                        ),\n                );\n                this.subscription(`s-bind-${space.id}`, binding.bind());\n                binding = mod.binding('presence');\n                this.subscription(\n                    `c-${space.id}`,\n                    binding\n                        .listen()\n                        .subscribe((d) =>\n                            this.handlePresenceChange(list, space, d),\n                        ),\n                );\n                this.subscription(`c-bind-${space.id}`, binding.bind());\n            }\n            this.updateActions(list);\n            this._updateHoverElements(list);\n        }),\n    );\n\n    constructor(\n        private _state: ExploreStateService,\n        private _settings: SettingsService,\n        private _event_form: EventFormService,\n        private _dialog: MatDialog,\n        private _org: OrganisationService,\n    ) {\n        super();\n        this.subscription('spaces', this._bind.subscribe());\n    }\n\n    public async bookSpace(space: Space, force: boolean = false) {\n        if (this._panning && this._last_action === 'down') return;\n        const booking_rules = await this.booking_rules\n            .pipe(take(1))\n            .toPromise();\n        const { hidden } =\n            rulesForResource(\n                {\n                    date: Date.now(),\n                    duration: 60,\n                    resource: space,\n                    host: currentUser(),\n                },\n                booking_rules,\n            ) || {};\n        if (hidden) {\n            return notifyError(\n                'You do not have permission to book this space at this time.',\n            );\n        }\n        if (\n            (this._statuses[space.id] !== 'free' && !force) ||\n            !space.bookable\n        ) {\n            return notifyError(\n                `${\n                    space.display_name || space.name\n                } is unavailable for the selected time and duration`,\n            );\n        }\n        this._event_form.newForm();\n        this._event_form.form.patchValue({\n            host: currentUser()?.email,\n            resources: [space],\n        });\n        if (this._settings.get('app.events.booking_unavailable')) {\n            return this._event_form.openEventLinkModal();\n        }\n        this._dialog.open(\n            (this._settings.get('app.explore.show_booking_qr')\n                ? ExploreBookQrComponent\n                : ExploreBookingModalComponent) as any,\n            {\n                data: { space },\n            },\n        );\n    }\n\n    public handleBookingsChange(\n        spaces: Space[],\n        space: Space,\n        bookings: HashMap[],\n    ) {\n        if (!bookings) return;\n        this._bookings[space.id] = bookings.map((i) => new CalendarEvent(i));\n        this.timeout(\n            'update_hover_els',\n            () => this._updateHoverElements(spaces),\n            100,\n        );\n    }\n\n    public handleStatusChange(spaces: Space[], space: Space, status: string) {\n        if (space.bookable) this._statuses[space.id] = status || 'free';\n        else delete this._statuses[space.id];\n        this.timeout(\n            'update_statuses',\n            () => {\n                this.clearTimeout('update_hover_els');\n                this._updateStatus(spaces);\n                this._updateHoverElements(spaces);\n            },\n            100,\n        );\n    }\n\n    public handlePresenceChange(\n        spaces: Space[],\n        space: Space,\n        presence: boolean,\n    ) {\n        this._presence[space.id] = presence;\n        this.timeout('update_icons', () => this._updateIcons(spaces), 100);\n    }\n\n    private async _updateStatus(spaces: Space[]) {\n        const style_map = {};\n        const colours = this._settings.get('app.explore.colors') || {};\n        for (const space of spaces) {\n            if (!this._statuses[space.id]) continue;\n            const status = this._statuses[space.id];\n            style_map[`#${space.map_id}`] = {\n                fill:\n                    colours[`space-${status}`] ||\n                    colours[`${status}`] ||\n                    DEFAULT_COLOURS[`${status}`],\n                opacity: 0.6,\n            };\n        }\n        this._state.setStyles('spaces', style_map);\n    }\n\n    private _updateHoverElements(spaces: Space[]) {\n        const features: ViewerFeature[] = [];\n        for (const space of spaces) {\n            if (!space.map_id) continue;\n            features.push({\n                location: space.map_id,\n                full_size: true,\n                no_scale: true,\n                content: ExploreSpaceInfoComponent,\n                z_index: 10,\n                data: {\n                    space: new Space(space),\n                    events: this._bookings[space.id],\n                    status: this._statuses[space.id] || 'not-bookable',\n                },\n            } as any);\n        }\n        this._state.setFeatures('spaces', features);\n    }\n\n    private _updateIcons(spaces: Space[]) {\n        if (!this._settings.get('app.show_presence_indicators')) return;\n        const features: ViewerFeature[] = [];\n        for (const space of spaces) {\n            if (!space.map_id) continue;\n            features.push({\n                location: space.map_id,\n                content: ExploreIconComponent,\n                data: {\n                    icon: {\n                        class: 'material-symbols-rounded',\n                        content: 'sensor_occupied',\n                    },\n                    color: this._presence[space.id] ? 'var(--su)' : 'var(--bc)',\n                    text_color: this._presence[space.id]\n                        ? 'var(--suc)'\n                        : 'var(--b1)',\n                },\n                z_index: 98,\n            } as ViewerFeature);\n        }\n        this._state.setFeatures('spaces-presence', features);\n    }\n\n    private updateActions(spaces: Space[]) {\n        const actions: ViewAction[] = [];\n        for (const space of spaces) {\n            if (!space.map_id) continue;\n            for (const action of ['mousedown', 'touchstart']) {\n                actions.push({\n                    id: space.map_id,\n                    action: action as any,\n                    priority: 5,\n                    callback: () => {\n                        this._panning = false;\n                        this.timeout(\n                            'panning',\n                            () => (this._panning = true),\n                            300,\n                        );\n                        this._last_action = 'down';\n                    },\n                });\n            }\n            for (const action of ['mouseup', 'touchend']) {\n                actions.push({\n                    id: space.map_id,\n                    action: action as any,\n                    priority: 5,\n                    callback: () => {\n                        this.bookSpace(space);\n                        this._last_action = 'up';\n                    },\n                });\n            }\n        }\n        this.timeout(\n            'set-actions',\n            () => this._state.setActions('spaces', actions),\n            50,\n        );\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { MAP_FEATURE_DATA } from '@placeos/components';\n\n@Component({\n    selector: 'space-location-pin',\n    template: `\n        <div class=\"absolute bottom-0 left-1/2 -translate-x-1/2\">\n            <svg\n                width=\"44\"\n                height=\"60\"\n                viewBox=\"0 0 66 80\"\n                fill=\"none\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n            >\n                <g filter=\"url(#filter0_d_1065_10313)\">\n                    <path\n                        d=\"M19.724 53.0408C25.0871 60.3435 30.5582 65.8583 31.0184 66.3178C31.4558 66.755 32.0489 67.0007 32.6674 67.0008H32.6678C33.2863 67.0007 33.8795 66.755 34.3169 66.3178C34.7771 65.8583 40.2481 60.3435 45.6112 53.0408C48.2928 49.3894 50.963 45.2701 52.9663 41.0957C54.9629 36.935 56.3331 32.6459 56.3342 28.6724C56.364 25.5564 55.7725 22.4657 54.5941 19.5809C53.415 16.6946 51.6722 14.0724 49.4675 11.8677C47.2629 9.66308 44.6407 7.92024 41.7544 6.74121C38.8711 5.5634 35.782 4.97184 32.6676 5.00103C29.5533 4.97184 26.4642 5.5634 23.5809 6.74121C20.6946 7.92024 18.0724 9.66308 15.8677 11.8677C13.6631 14.0724 11.9202 16.6946 10.7412 19.5809C9.56278 22.4657 8.97122 25.5565 9.00108 28.6726C9.0022 32.646 10.3724 36.9351 12.369 41.0957C14.3723 45.2701 17.0425 49.3894 19.724 53.0408Z\"\n                        [attr.fill]=\"color\"\n                        stroke=\"#0B421D\"\n                        stroke-width=\"2\"\n                    />\n                </g>\n                <defs>\n                    <filter\n                        id=\"filter0_d_1065_10313\"\n                        x=\"0\"\n                        y=\"0\"\n                        width=\"65.3353\"\n                        height=\"80.001\"\n                        filterUnits=\"userSpaceOnUse\"\n                        color-interpolation-filters=\"sRGB\"\n                    >\n                        <feFlood\n                            flood-opacity=\"0\"\n                            result=\"BackgroundImageFix\"\n                        />\n                        <feColorMatrix\n                            in=\"SourceAlpha\"\n                            type=\"matrix\"\n                            values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\"\n                            result=\"hardAlpha\"\n                        />\n                        <feOffset dy=\"4\" />\n                        <feGaussianBlur stdDeviation=\"4\" />\n                        <feComposite in2=\"hardAlpha\" operator=\"out\" />\n                        <feColorMatrix\n                            type=\"matrix\"\n                            values=\"0 0 0 0 0.0196078 0 0 0 0 0.109804 0 0 0 0 0.172549 0 0 0 0.2 0\"\n                        />\n                        <feBlend\n                            mode=\"normal\"\n                            in2=\"BackgroundImageFix\"\n                            result=\"effect1_dropShadow_1065_10313\"\n                        />\n                        <feBlend\n                            mode=\"normal\"\n                            in=\"SourceGraphic\"\n                            in2=\"effect1_dropShadow_1065_10313\"\n                            result=\"shape\"\n                        />\n                    </filter>\n                </defs>\n            </svg>\n            <div\n                class=\"absolute top-0 left-0 w-full h-3/4 flex items-center justify-center\"\n            >\n                <div\n                    class=\"relative z-10 h-4 w-4 rounded-full bg-base-100 border-2 border-[#0B421D]\"\n                    *ngIf=\"!selected\"\n                ></div>\n                <app-icon\n                    class=\"relative text-white z-10 text-2xl\"\n                    *ngIf=\"selected\"\n                >\n                    done\n                </app-icon>\n            </div>\n        </div>\n    `,\n    styles: [],\n})\nexport class SpaceLocationPinComponent {\n    public readonly selected = this._data.selected === true;\n    public readonly active = this._data.active === true;\n\n    public get color() {\n        return this.active ? '#F4511E' : this.selected ? '#D32F2F' : '#309251';\n    }\n    constructor(@Inject(MAP_FEATURE_DATA) private _data: any) {}\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { AsyncHandler, SettingsService, unique } from '@placeos/common';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { debounceTime, map, tap } from 'rxjs/operators';\n\nimport { DEFAULT_COLOURS } from 'libs/explore/src/lib/explore-spaces.service';\nimport { EventFormService } from 'libs/events/src/lib/event-form.service';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { BuildingLevel } from 'libs/organisation/src/lib/level.class';\nimport { SpaceLocationPinComponent } from './space-location-pin.component';\nimport { Space } from '../space.class';\n\n@Component({\n    selector: `space-map`,\n    template: `\n        <div class=\"bg-base-100 p-2 border-b border-base-200 w-full\">\n            <mat-form-field\n                appearance=\"outline\"\n                class=\"w-full\"\n                *ngIf=\"(levels | async)?.length\"\n            >\n                <mat-select\n                    name=\"location\"\n                    [(ngModel)]=\"level\"\n                    (ngModelChange)=\"setOptions({ zone_ids: [$event.id] })\"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                    placeholder=\"Any Level\"\n                    i18n-placeholder\n                >\n                    <mat-option\n                        *ngFor=\"let lvl of levels | async\"\n                        [value]=\"lvl\"\n                    >\n                        <div class=\"flex flex-col-reverse\">\n                            <div class=\"opacity-30 text-xs\" *ngIf=\"use_region\">\n                                {{ (lvl.parent_id | building)?.display_name }}\n                                <span class=\"opacity-0\"> - </span>\n                            </div>\n                            <div>\n                                {{ lvl.display_name || lvl.name }}\n                            </div>\n                        </div>\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n        </div>\n        <div class=\"relative flex-1 w-full\">\n            <interactive-map\n                [src]=\"map_url\"\n                [(zoom)]=\"zoom\"\n                [(center)]=\"center\"\n                [styles]=\"styles | async\"\n                [features]=\"features | async\"\n                [actions]=\"actions | async\"\n                [options]=\"{ controls: true }\"\n            ></interactive-map>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                background: rgba(0, 0, 0, 0.05);\n                display: flex;\n                flex-direction: column;\n            }\n\n            button {\n                border-radius: 0;\n            }\n        `,\n    ],\n})\nexport class SpaceSelectMapComponent extends AsyncHandler {\n    @Input() public selected: string[] = [];\n    @Input() public active: string;\n    @Input() public is_displayed: boolean = false;\n    @Output() public onSelect = new EventEmitter<Space>();\n\n    public zoom = 1;\n    public center = { x: 0.5, y: 0.5 };\n    public coordinates = undefined;\n\n    private _seletedSpace = (s) => () => {\n        this.onSelect.emit(s);\n        this._change.next(Date.now());\n    };\n    public level: BuildingLevel = null;\n    private _change = new BehaviorSubject(0);\n\n    public get map_url() {\n        return this.level?.map_id || '';\n    }\n\n    public readonly levels = combineLatest([\n        this._org.active_region,\n        this._org.active_building,\n    ]).pipe(\n        map(([region, bld]) => {\n            const level_list = this.use_region\n                ? this._org.levelsForRegion(region)\n                : this._org.levelsForBuilding(bld);\n            const viewable_levels = level_list.filter(\n                (lvl) => !lvl.tags.includes('parking'),\n            );\n            return viewable_levels.sort(\n                (a, b) =>\n                    a.parent_id.localeCompare(b.parent_id) ||\n                    (a.display_name || '').localeCompare(b.display_name || ''),\n            );\n        }),\n    );\n\n    public readonly setOptions = (o) => this._event_form.setOptions(o);\n\n    public readonly features = combineLatest([\n        this._event_form.available_spaces,\n        this._change,\n    ]).pipe(\n        debounceTime(300),\n        map(([l]) =>\n            l.map((space) => ({\n                location: space.map_id,\n                content: SpaceLocationPinComponent,\n                data: {\n                    ...space,\n                    active: this.active === space.id,\n                    selected: this.selected.includes(space.id),\n                },\n            })),\n        ),\n    );\n\n    public readonly actions = this._event_form.available_spaces.pipe(\n        map((l) =>\n            l.map((space) => ({\n                id: space.map_id,\n                action: ['touchend', 'mouseup'],\n                callback: this._seletedSpace(space),\n            })),\n        ),\n    );\n\n    public readonly styles = combineLatest([\n        this._event_form.spaces,\n        this._event_form.available_spaces,\n    ]).pipe(\n        map(([spaces, free_spaces]) =>\n            spaces.reduce((styles, space) => {\n                const colours = this._settings.get('app.explore.colors') || {};\n                const status = free_spaces.find((_) => _.id === space.id)\n                    ? 'free'\n                    : 'busy';\n                styles[`#${space.map_id || space.id}`] = {\n                    fill:\n                        colours[`space-${status}`] ||\n                        colours[`${status}`] ||\n                        DEFAULT_COLOURS[`${status}`],\n                };\n                return styles;\n            }, {}),\n        ),\n    );\n\n    public get use_region() {\n        return !!this._settings.get('app.use_region');\n    }\n\n    constructor(\n        private _event_form: EventFormService,\n        private _org: OrganisationService,\n        private _settings: SettingsService,\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'levels_update',\n            this._event_form.options.subscribe(({ zone_ids }) => {\n                const level = this._org.levelWithID(zone_ids);\n                if (level) this.level = level;\n            }),\n        );\n    }\n\n    public setLevel(level: BuildingLevel) {\n        this.setOptions({ zone_ids: [level?.id] });\n        const bld = this._org.buildings.find((_) => _.id === level?.parent_id);\n        if (bld) {\n            const [latitude, longitude] = (level.location || bld.location)\n                .split(',')\n                .map((_) => parseFloat(_));\n            this.coordinates = { latitude, longitude };\n        }\n        this.level = level;\n    }\n\n    public setZoom(new_zoom: number) {\n        this.zoom = Math.max(0.5, Math.min(10, new_zoom));\n    }\n\n    public resetMap() {\n        this.zoom = 1;\n        this.center = { x: 0.5, y: 0.5 };\n    }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule, Type } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatBottomSheetModule } from '@angular/material/bottom-sheet';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\n\nimport { ComponentsModule } from 'libs/components/src/lib/components.module';\nimport { FormFieldsModule } from 'libs/form-fields/src/lib/form-fields.module';\nimport { NewSpaceSelectModalComponent } from './space-select-modal/new-space-select-modal.component';\n\nimport { SpaceDetailsComponent } from './space-select-modal/space-details.component';\nimport { SpaceListComponent } from './space-select-modal/space-list.component';\nimport { SpaceFiltersComponent } from './space-select-modal/space-filters.component';\nimport { SpaceFiltersDisplayComponent } from './space-select-modal/space-filters-display.component';\nimport { SpaceSelectMapComponent } from './space-select-modal/space-map.component';\n\nimport { SpaceLocationPinComponent } from './space-select-modal/space-location-pin.component';\nimport { SpacePipe } from './space.pipe';\n\nconst COMPONENTS: Type<any>[] = [\n    NewSpaceSelectModalComponent,\n\n    SpaceDetailsComponent,\n    SpaceListComponent,\n    SpaceFiltersComponent,\n    SpaceFiltersDisplayComponent,\n    SpaceSelectMapComponent,\n    SpaceLocationPinComponent,\n\n    SpacePipe,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [\n        CommonModule,\n        MatDialogModule,\n        ComponentsModule,\n        FormFieldsModule,\n        MatBottomSheetModule,\n        MatCheckboxModule,\n        FormsModule,\n        ReactiveFormsModule,\n    ],\n    providers: [],\n    exports: [...COMPONENTS],\n})\nexport class SharedSpacesModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport {\n    debounceTime,\n    first,\n    map,\n    shareReplay,\n    switchMap,\n    tap,\n} from 'rxjs/operators';\n\nimport { AsyncHandler } from '@placeos/common';\nimport { Space } from '@placeos/spaces';\nimport { BehaviorSubject, combineLatest, of } from 'rxjs';\nimport { querySystems } from '@placeos/ts-client';\nimport { OrganisationService } from '@placeos/organisation';\n\n@Component({\n    selector: '[app-bootstrap]',\n    template: `\n        <div\n            class=\"rounded shadow m-4 bg-base-100 border border-base-200 overflow-hidden mx-auto text-center flex flex-col items-center\"\n        >\n            <h2 class=\"bg-error text-white py-2 px-4 m-0 w-full text-2xl\">\n                {{ 'PANEL.BOOTSTRAP_TITLE' | translate }}\n            </h2>\n            <ng-container\n                *ngIf=\"!loading || loading === 'search'; else load_state\"\n            >\n                <p class=\"description py-4\">\n                    {{ 'PANEL.BOOTSTRAP_DESCRIPTION' | translate }}\n                </p>\n                <mat-form-field appearance=\"outline\">\n                    <mat-label>{{\n                        'PANEL.BOOTSTRAP_LABEL' | translate\n                    }}</mat-label>\n                    <input\n                        matInput\n                        [ngModel]=\"system_id$ | async\"\n                        [matAutocomplete]=\"auto\"\n                        placeholder=\"System ID\"\n                        (ngModelChange)=\"system_id$.next($event)\"\n                    />\n                    <mat-spinner\n                        [diameter]=\"32\"\n                        matSuffix\n                        *ngIf=\"loading === 'search'\"\n                    ></mat-spinner>\n                </mat-form-field>\n                <mat-autocomplete #auto=\"matAutocomplete\">\n                    <mat-option\n                        *ngFor=\"let option of space_list | async\"\n                        [value]=\"option.id\"\n                    >\n                        <div class=\"leading-tight\">\n                            <div class=\"name\">{{ option.name }}</div>\n                            <div class=\"text-xs text-dark-fade\">\n                                {{ option.id }}\n                            </div>\n                        </div>\n                    </mat-option>\n                    <mat-option\n                        class=\"pointer-events-none opacity-60\"\n                        *ngIf=\"\n                            system_id$.getValue()?.length < 2 &&\n                            !(space_list | async)?.length\n                        \"\n                    >\n                        {{ 'PANEL.BOOTSTRAP_INPUT_PLACEHOLDER' | translate }}\n                    </mat-option>\n                </mat-autocomplete>\n                <button\n                    btn\n                    matRipple\n                    [disabled]=\"!system_id$.getValue()\"\n                    (click)=\"bootstrap()\"\n                    i18n\n                >\n                    {{ 'COMMON.CONTINUE' | translate }}\n                </button>\n            </ng-container>\n        </div>\n        <ng-template #load_state>\n            <div load class=\"my-16 flex flex-col items-center\">\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <div class=\"m-4\" i18n>\n                    {{ 'PANEL.LOADING_SYSTEM' | translate }} {{ loading }}\n                </div>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                background-color: #f0f0f0;\n                background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%230002' fill-opacity='1' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\");\n            }\n\n            :host > div {\n                width: 32rem;\n                max-width: calc(100vw - 2rem);\n            }\n\n            mat-form-field {\n                width: calc(100% - 2rem);\n            }\n\n            button {\n                width: 8rem;\n                margin: 0.5rem;\n                margin-top: 0;\n            }\n        `,\n    ],\n})\nexport class BootstrapComponent extends AsyncHandler implements OnInit {\n    /** List of available systems */\n    public system_list: Space[] = [];\n    /** List of available systems */\n    public filtered_list: Space[] = [];\n    /** Whether application data is loading */\n    public loading: string;\n    /** ID of the system to bootstrap */\n    public system_id$ = new BehaviorSubject('');\n    /** Selected system to bootstrap */\n    public selected_system: Space = null;\n    /** Whether input field is focused */\n    public input_focus: boolean;\n\n    public readonly space_list = combineLatest([\n        this.system_id$,\n        this._org.initialised,\n    ]).pipe(\n        debounceTime(300),\n        switchMap(([search]) => {\n            this.loading = 'search';\n            return search.length < 2\n                ? of({ data: [] })\n                : querySystems({\n                      q: search,\n                      limit: 20,\n                      zone_id: this._org.organisation.id,\n                  });\n        }),\n        map((_) => _.data.map((_) => new Space(_ as any))),\n        tap((_) => (this.loading = '')),\n        shareReplay(1)\n    );\n\n    private _event = false;\n\n    constructor(\n        private route: ActivatedRoute,\n        private _router: Router,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        this.subscription(\n            'route.query',\n            this.route.queryParamMap.subscribe((params) => {\n                if (params.has('clear') && !!params.get('clear')) {\n                    this.clearBootstrap();\n                }\n                if (params.has('event')) this._event = true;\n                if (params.has('system_id') || params.has('sys_id')) {\n                    this.system_id$.next(\n                        params.get('system_id') || params.get('sys_id')\n                    );\n                    this.bootstrap();\n                }\n            })\n        );\n        this.checkBootstrapped();\n    }\n\n    /**\n     * Setup the default system for the application to bind to\n     */\n    public readonly bootstrap = () =>\n        this.configure(this.system_id$.getValue());\n\n    /**\n     * Check if the application has previously been bootstrapped\n     */\n    private checkBootstrapped(): void {\n        this.loading = 'Checks';\n        if (localStorage) {\n            const system_id = localStorage.getItem('PLACEOS.BOOKINGS.system');\n            if (system_id) {\n                this._router.navigate(\n                    [this._event ? 'events' : 'panel', system_id],\n                    {\n                        queryParamsHandling: 'preserve',\n                    }\n                );\n                return;\n            }\n        }\n        this.loading = '';\n    }\n\n    /**\n     * Save the bootstrapped ID and redirect to the panel for that ID\n     * @param system_id System to bootstrap\n     */\n    private configure(system_id: string): void {\n        this.loading = 'Setup';\n        if (localStorage) {\n            localStorage.setItem('PLACEOS.BOOKINGS.system', system_id);\n            localStorage.setItem('trust', 'true');\n            localStorage.setItem('fixed_device', 'true');\n        }\n        this._router.navigate([this._event ? 'events' : 'panel', system_id], {\n            queryParamsHandling: 'preserve',\n        });\n        this.loading = '';\n    }\n\n    /**\n     * Remove any previously set bootstrapping details\n     */\n    private readonly clearBootstrap = () =>\n        localStorage.removeItem('PLACEOS.BOOKINGS.system');\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { User } from 'libs/users/src/lib/user.class';\n\n@Component({\n    selector: 'attendee-list',\n    template: `\n        <div class=\"w-full h-full overflow-hidden flex flex-col bg-base-100\">\n            <div\n                class=\"flex items-center border-b border-base-200 p-2 min-h-12\"\n            >\n                <button\n                    close\n                    icon\n                    matRipple\n                    *ngIf=\"!hide_close\"\n                    (click)=\"close.emit()\"\n                >\n                    <app-icon>arrow_back</app-icon>\n                </button>\n                <div class=\"flex-1 text-center font-medium\" i18n>\n                    {{ list.length }}\n                    {{\n                        custom_title\n                            ? custom_title\n                            : list.length === 1\n                              ? 'Attendee'\n                              : 'Attendees'\n                    }}\n                </div>\n                <div class=\"w-12\" *ngIf=\"!hide_close\"></div>\n            </div>\n            <div class=\"flex-1 w-full overflow-auto\">\n                <ng-container *ngFor=\"let user of list\">\n                    <div\n                        attendee\n                        class=\"flex items-center p-2 space-x-2 hover:bg-base-200\"\n                        *ngIf=\"\n                            !user.resource && (host !== user.email || show_host)\n                        \"\n                    >\n                        <a-user-avatar [user]=\"user\"></a-user-avatar>\n                        <div class=\"flex-1 w-1/2\">\n                            <div class=\"truncate\">{{ user.name }}</div>\n                            <div\n                                class=\"opacity-60 text-sm\"\n                                *ngIf=\"host === user.email\"\n                            >\n                                Host\n                            </div>\n                        </div>\n                        <div class=\"p-2\">\n                            <div\n                                class=\"h-3 w-3 rounded-full\"\n                                [class.bg-success]=\"user.checked_in\"\n                                [class.bg-pending]=\"!user.checked_in\"\n                                [matTooltip]=\"\n                                    user.checked_in\n                                        ? 'Checked in'\n                                        : 'Not checked in'\n                                \"\n                            ></div>\n                        </div>\n                    </div>\n                </ng-container>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class AttendeeListComponent {\n    @Input() public host: string = '';\n    @Input() public show_host = true;\n    @Input() public list: User[] = [];\n    @Input() public hide_close = false;\n    @Input() public custom_title = '';\n    @Output() public close = new EventEmitter();\n}\n","import { Component, EventEmitter, Inject, Output } from '@angular/core';\nimport { MatDialog, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { addMinutes, format, formatDuration, getUnixTime } from 'date-fns';\n\nimport { CalendarEvent } from './event.class';\nimport { MapPinComponent } from 'libs/components/src/lib/map-pin.component';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { SpacePipe } from 'libs/spaces/src/lib/space.pipe';\nimport { Building } from 'libs/organisation/src/lib/building.class';\nimport { BuildingLevel } from 'libs/organisation/src/lib/level.class';\nimport {\n    ANIMATION_SHOW_CONTRACT_EXPAND,\n    notifyError,\n    SettingsService,\n    MapsPeopleService,\n} from '@placeos/common';\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport { getModule } from '@placeos/ts-client';\nimport { MapLocateModalComponent } from 'libs/components/src/lib/map-locate-modal.component';\nimport { CateringItem } from 'libs/catering/src/lib/catering-item.class';\nimport { getEventMetadata } from './events.fn';\n\nconst EMPTY_ACTIONS = [];\n\n@Component({\n    selector: 'event-details-modal',\n    template: `\n        <div\n            class=\"w-[100vw] h-[100vh] sm:relative sm:inset-auto sm:w-[51rem] sm:h-auto sm:max-h-[80vh] bg-base-100 sm:bg-base-200 sm:dark:bg-neutral-600 sm:rounded overflow-auto space-y-2 pb-2\"\n        >\n            <div\n                class=\"sm:flex flex-col items-center pb-4 max-h-screen sm:max-h-[80vh] sm:px-16 sm:border-b bg-base-100 border-base-200\"\n            >\n                <i\n                    binding\n                    [(model)]=\"room_status\"\n                    [sys]=\"space?.id\"\n                    mod=\"Bookings\"\n                    bind=\"status\"\n                ></i>\n                <div\n                    class=\"h-8 w-full sm:hidden block\"\n                    *ngIf=\"!event?.system?.images?.length\"\n                ></div>\n                <div\n                    class=\"bg-neutral w-full h-64 sm:rounded-b overflow-hidden\"\n                    *ngIf=\"event?.system?.images?.length\"\n                >\n                    <image-carousel\n                        [images]=\"event?.system?.images\"\n                        class=\"w-full h-64\"\n                    ></image-carousel>\n                </div>\n                <h3\n                    title\n                    class=\"px-3 mt-2 text-xl font-medium w-full\"\n                    [class.pt-4]=\"!event?.system?.images?.length\"\n                >\n                    {{ event.title }}\n                </h3>\n                <div class=\"sm:flex items-center justify-between w-full\">\n                    <div class=\"flex m-2\">\n                        <status-pill [status]=\"event_status\">\n                            {{ period }}\n                        </status-pill>\n                    </div>\n                    <div\n                        actions\n                        class=\"flex items-center space-x-2 px-2\"\n                        *ngIf=\"event.state !== 'done'\"\n                    >\n                        <button\n                            btn\n                            matRipple\n                            class=\"flex-1 h-10\"\n                            *ngIf=\"\n                                room_status &&\n                                event?.can_check_in &&\n                                room_status !== 'free'\n                            \"\n                            [class.bg-success]=\"room_status !== 'pending'\"\n                            [class.border-none]=\"room_status !== 'pending'\"\n                            [class.pointer-events-none]=\"\n                                room_status !== 'pending'\n                            \"\n                            (click)=\"checkin()\"\n                        >\n                            <div\n                                class=\"flex items-center space-x-2 justify-center\"\n                            >\n                                <app-icon class=\"text-2xl\">{{\n                                    room_status === 'pending'\n                                        ? 'arrow_back'\n                                        : 'done'\n                                }}</app-icon>\n                                <div class=\"pr-4\" i18n>\n                                    {{\n                                        room_status === 'pending'\n                                            ? 'Check in'\n                                            : 'Checked in'\n                                    }}\n                                </div>\n                            </div>\n                        </button>\n                        <button\n                            icon\n                            matRipple\n                            [matMenuTriggerFor]=\"menu\"\n                            class=\"bg-secondary rounded text-white h-12 w-12\"\n                            *ngIf=\"allow_edit\"\n                        >\n                            <app-icon>more_horiz</app-icon>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <div class=\"sm:flex flex-wrap sm:px-12\">\n                <div\n                    class=\"sm:p-4 sm:bg-base-100 sm:dark:bg-neutral-700 rounded sm:m-2 sm:border border-base-200 flex-grow-[3] min-w-1/3 sm:w-[16rem] space-y-2\"\n                >\n                    <h3 class=\"px-3 mt-2 text-lg font-medium mb-2\" i18n>\n                        Details\n                    </h3>\n                    <div class=\"flex items-center px-2 space-x-2\">\n                        <app-icon>event</app-icon>\n                        <div>{{ event.date | date: 'EEEE, dd LLLL y' }}</div>\n                    </div>\n                    <div class=\"flex items-center px-2 space-x-2\">\n                        <app-icon>schedule</app-icon>\n                        <div>{{ period }}</div>\n                    </div>\n                    <div class=\"flex items-center px-2 space-x-2\">\n                        <app-icon>map</app-icon>\n                        <div>\n                            <ng-container *ngIf=\"level\">\n                                {{ level?.display_name || level?.name }},\n                            </ng-container>\n                            {{\n                                event?.system?.display_name ||\n                                    event?.system?.name ||\n                                    event?.location\n                            }}\n                        </div>\n                    </div>\n                    <div\n                        class=\"flex items-center px-2 space-x-2\"\n                        *ngIf=\"building\"\n                    >\n                        <app-icon>place</app-icon>\n                        <div>\n                            {{ building?.display_name || building?.name }},\n                            {{ building?.address }}\n                        </div>\n                    </div>\n                </div>\n                <div\n                    class=\"mt-4 sm:p-4 sm:bg-base-100 sm:dark:bg-neutral-700 rounded sm:m-2 sm:border border-base-200 flex-grow-[3] min-w-1/3 sm:w-[16rem]\"\n                >\n                    <div\n                        class=\"mx-3 border-t border-base-200 sm:border-none flex items-center justify-between\"\n                    >\n                        <h3 class=\"text-lg font-medium\" i18n>Attendees</h3>\n                        <button\n                            matRipple\n                            show-attendees\n                            class=\"clear text-xs underline\"\n                            (click)=\"show_attendees = true\"\n                            i18n\n                        >\n                            See All\n                        </button>\n                    </div>\n                    <div class=\"flex items-center p-1\">\n                        <div\n                            class=\"flex flex-col flex-1 items-center justify-center space-y-1\"\n                        >\n                            <div class=\"text-lg\">{{ accept_count || 0 }}</div>\n                            <div class=\"text-sm uppercase\" i18n>Yes</div>\n                        </div>\n                        <div\n                            class=\"flex flex-col flex-1 items-center justify-center space-y-1\"\n                        >\n                            <div class=\"text-lg\">{{ declined_count || 0 }}</div>\n                            <div class=\"text-sm uppercase\" i18n>No</div>\n                        </div>\n                        <div\n                            class=\"flex flex-col flex-1 items-center justify-center space-y-1\"\n                        >\n                            <div class=\"text-lg\">{{ pending_count || 0 }}</div>\n                            <div class=\"text-sm uppercase\" i18n>Pending</div>\n                        </div>\n                    </div>\n                    <h3\n                        class=\"mx-3 mt-2 pt-2 text-lg font-medium border-t border-base-200\"\n                        i18n\n                    >\n                        Host\n                    </h3>\n                    <div class=\"px-2 flex items-center space-x-2\" host>\n                        <a-user-avatar [user]=\"event.organiser\"></a-user-avatar>\n                        <div class=\"text-sm flex-1 w-px\">\n                            <div>{{ event.organiser?.name }}</div>\n                            <div\n                                class=\"opacity-60 truncate w-full\"\n                                [title]=\"event.host\"\n                            >\n                                {{ event.host }}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <ng-container *ngIf=\"has_catering\">\n                    <div\n                        class=\"mt-4 sm:p-4 sm:bg-base-100 sm:dark:bg-neutral-700 rounded sm:m-2 sm:border border-base-200 flex-grow-[3] min-w-1/3 sm:w-[16rem]\"\n                    >\n                        <h3 class=\"mx-3 my-2 text-lg font-medium\" i18n>\n                            Catering\n                        </h3>\n                        <div class=\"flex flex-col space-y-2\">\n                            <div\n                                order\n                                *ngFor=\"let order of event.valid_catering\"\n                                class=\"border border-base-300 bg-base-100 rounded-xl overflow-hidden\"\n                            >\n                                <div class=\"flex items-center space-x-2 p-3\">\n                                    <div class=\"flex-1\">\n                                        <div class=\"text-sm\">\n                                            Order at\n                                            {{\n                                                order.deliver_at\n                                                    | date\n                                                        : 'MMM d, ' +\n                                                              time_format\n                                            }}\n                                        </div>\n                                        <div class=\"text-xs opacity-60\">\n                                            {{ order.item_count }} item(s) for\n                                            {{\n                                                order.total_cost / 100\n                                                    | currency: currency_code\n                                            }}\n                                        </div>\n                                    </div>\n                                    <button\n                                        icon\n                                        matRipple\n                                        [matTooltip]=\"\n                                            show_order[order.id]\n                                                ? 'Hide order items'\n                                                : 'Show order items'\n                                        \"\n                                        (click)=\"\n                                            show_order[order.id] =\n                                                !show_order[order.id]\n                                        \"\n                                    >\n                                        <app-icon>\n                                            {{\n                                                show_order[order.id]\n                                                    ? 'expand_less'\n                                                    : 'expand_more'\n                                            }}\n                                        </app-icon>\n                                    </button>\n                                </div>\n                                <div\n                                    class=\"flex flex-col bg-base-200 divide-y divide-base-100\"\n                                    [@show]=\"\n                                        show_order[order.id] ? 'show' : 'hide'\n                                    \"\n                                >\n                                    <div\n                                        class=\"flex items-center px-3 py-1 space-x-2 hover:opacity-90\"\n                                        *ngFor=\"let item of order.items\"\n                                    >\n                                        <div class=\"flex items-center flex-1\">\n                                            <span class=\"text-sm\">{{\n                                                item.name || 'Item'\n                                            }}</span>\n                                            <span\n                                                class=\"text-xs opacity-60 ml-4 font-normal\"\n                                                *ngIf=\"item.option_list?.length\"\n                                                [matTooltip]=\"optionList(item)\"\n                                            >\n                                                {{\n                                                    item.option_list?.length ||\n                                                        '0'\n                                                }}\n                                                option(s)\n                                            </span>\n                                        </div>\n                                        <div\n                                            class=\"rounded bg-success text-success-content text-xs px-2 py-1\"\n                                        >\n                                            x{{ item.quantity }}\n                                        </div>\n                                        <div\n                                            class=\"rounded bg-info text-info-content text-xs px-2 py-1\"\n                                        >\n                                            {{\n                                                item.unit_price_with_options /\n                                                    100\n                                                    | currency: currency_code\n                                            }}\n                                            ea\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </ng-container>\n                <button\n                    map\n                    class=\"mt-4 sm:mt-2 h-64 sm:h-48 relative border border-base-200 overflow-hidden rounded sm:bg-base-100 sm:dark:bg-neutral-700 m-2 flex-grow-[3] min-w-1/3 p-2 w-[calc(100%-1rem)] sm:w-[16rem]\"\n                    (click)=\"viewLocation()\"\n                >\n                    <ng-container *ngIf=\"!hide_map\">\n                        <interactive-map\n                            class=\"pointer-events-none\"\n                            [src]=\"level?.map_id\"\n                            [features]=\"features\"\n                            [options]=\"{\n                                disable_pan: true,\n                                disable_zoom: true,\n                            }\"\n                        ></interactive-map>\n                    </ng-container>\n                </button>\n                <div\n                    class=\"mt-4 sm:p-4 sm:bg-base-100 sm:dark:bg-neutral-700 rounded sm:m-2 sm:border border-base-200 flex-grow-[3] min-w-1/3 sm:w-[16rem]\"\n                    *ngIf=\"body\"\n                >\n                    <h3\n                        class=\"mx-3 text-lg font-medium border-t sm:border-none border-base-200\"\n                        i18n\n                    >\n                        Notes\n                    </h3>\n                    <div\n                        notes\n                        class=\"mx-4 overflow-hidden max-w-full\"\n                        *ngIf=\"body\"\n                        [innerHTML]=\"\n                            (body | sanitize) ||\n                            'Unable to sanitize notes contents'\n                        \"\n                    ></div>\n                </div>\n                <ng-container *ngIf=\"has_assets\">\n                    <div\n                        class=\"mt-4 sm:p-4 sm:bg-base-100 sm:dark:bg-neutral-700 rounded sm:m-2 sm:border border-base-200 flex-grow-[3] min-w-1/3 sm:w-[16rem]\"\n                    >\n                        <h3 class=\"mx-3 pt-2 text-lg font-medium\" i18n>\n                            Assets ({{ event.valid_assets?.length || 0 }})\n                        </h3>\n                        <div class=\"flex flex-col space-y-2\">\n                            <div\n                                request\n                                *ngFor=\"let request of event.valid_assets\"\n                                class=\"border border-base-300 bg-base-100 rounded-xl overflow-hidden\"\n                            >\n                                <button\n                                    matRipple\n                                    class=\"flex items-center space-x-2 p-3 w-full\"\n                                    (click)=\"\n                                        show_request[request.id] =\n                                            !show_request[request.id]\n                                    \"\n                                >\n                                    <div class=\"flex-1 text-left\">\n                                        <div class=\"text-sm\">\n                                            Requested for\n                                            {{\n                                                request.deliver_at\n                                                    | date\n                                                        : 'MMM d, ' +\n                                                              time_format\n                                            }}\n                                        </div>\n                                    </div>\n                                    <div\n                                        class=\"flex items-center justify-center rounded-full w-8 h-8\"\n                                        [class.bg-success]=\"\n                                            request.state === 'approved'\n                                        \"\n                                        [class.text-success-content]=\"\n                                            request.state === 'approved'\n                                        \"\n                                        [class.bg-warning]=\"\n                                            request.state !== 'approved' &&\n                                            request.state !== 'rejected'\n                                        \"\n                                        [class.text-warning-content]=\"\n                                            request.state !== 'approved' &&\n                                            request.state !== 'rejected'\n                                        \"\n                                        [class.bg-error]=\"\n                                            request.state === 'rejected'\n                                        \"\n                                        [class.text-error-content]=\"\n                                            request.state === 'rejected'\n                                        \"\n                                        [matTooltip]=\"\n                                            request.state || 'Tentative'\n                                        \"\n                                    >\n                                        <app-icon>\n                                            {{\n                                                request.state === 'approved'\n                                                    ? 'done'\n                                                    : request.state ===\n                                                        'rejected'\n                                                      ? 'close'\n                                                      : 'schedule'\n                                            }}\n                                        </app-icon>\n                                    </div>\n                                    <div\n                                        class=\"flex items-center justify-center rounded-full w-8 h-8\"\n                                    >\n                                        <app-icon class=\"text-2xl\">\n                                            {{\n                                                show_request[request.id]\n                                                    ? 'expand_less'\n                                                    : 'expand_more'\n                                            }}\n                                        </app-icon>\n                                    </div>\n                                </button>\n                                <div\n                                    class=\"flex flex-col bg-base-200 divide-y divide-base-100\"\n                                    [@show]=\"\n                                        show_request[request.id]\n                                            ? 'show'\n                                            : 'hide'\n                                    \"\n                                >\n                                    <div\n                                        class=\"flex items-center px-3 py-1 space-x-2 hover:opacity-90\"\n                                        *ngFor=\"let item of request.items\"\n                                    >\n                                        <div class=\"flex items-center flex-1\">\n                                            <span class=\"text-sm\">{{\n                                                item.name || 'Item'\n                                            }}</span>\n                                        </div>\n                                        <div\n                                            class=\"rounded bg-success text-success-content text-xs px-2 py-1\"\n                                        >\n                                            x{{ item.quantity }}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </ng-container>\n                <button\n                    icon\n                    matRipple\n                    mat-dialog-close\n                    class=\"absolute top-2 left-2 bg-neutral text-white\"\n                >\n                    <app-icon>close</app-icon>\n                </button>\n                <div class=\"absolute inset-0 z-50\" *ngIf=\"show_attendees\">\n                    <attendee-list\n                        [list]=\"event.attendees\"\n                        [host]=\"event.host\"\n                        (click)=\"show_attendees = false\"\n                    ></attendee-list>\n                </div>\n            </div>\n            <mat-menu #menu=\"matMenu\" xPosition=\"before\">\n                <button\n                    mat-menu-item\n                    mat-dialog-close\n                    (click)=\"edit.emit(space)\"\n                    [matTooltip]=\"!can_edit ? no_edit_message : ''\"\n                    [disabled]=\"!can_edit\"\n                    *ngIf=\"!hide_edit\"\n                >\n                    <div class=\"flex items-center space-x-2 text-base pr-2\">\n                        <app-icon class=\"text-2xl\">edit</app-icon>\n                        <div i18n>Edit event</div>\n                    </div>\n                </button>\n                <button mat-menu-item (click)=\"remove.emit()\">\n                    <div class=\"flex items-center space-x-2 text-base pr-2\">\n                        <app-icon class=\"text-2xl text-error\">delete</app-icon>\n                        <div i18n>Delete event</div>\n                    </div>\n                </button>\n                <button\n                    mat-menu-item\n                    *ngIf=\"event.recurring_event_id\"\n                    (click)=\"remove.emit(true)\"\n                >\n                    <div class=\"flex items-center space-x-2 text-base pr-2\">\n                        <app-icon class=\"text-2xl text-error\">delete</app-icon>\n                        <div i18n>Delete Series</div>\n                    </div>\n                </button>\n                <button\n                    mat-menu-item\n                    *ngFor=\"let act of custom_actions\"\n                    (click)=\"action.emit(act.id)\"\n                >\n                    <div class=\"flex items-center space-x-2 text-base pr-2\">\n                        <app-icon class=\"text-2xl\">{{ act.icon }}</app-icon>\n                        <div i18n>{{ act.name }}</div>\n                    </div>\n                </button>\n            </mat-menu>\n        </div>\n    `,\n    styles: [``],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n    providers: [SpacePipe],\n})\nexport class EventDetailsModalComponent {\n    @Output() public action = new EventEmitter();\n    @Output() public edit = new EventEmitter();\n    @Output() public remove = new EventEmitter();\n\n    public show_order = {};\n    public show_request = {};\n    public room_status = '';\n    public hide_map = false;\n    public hide_edit = false;\n    public show_attendees: boolean = false;\n    public readonly event = this._event;\n    public readonly no_edit_message =\n        'Editing bookings long than \\n a day is not available';\n    public features = [\n        {\n            location: this.event?.system?.map_id,\n            content: MapPinComponent,\n        },\n    ];\n\n    public readonly has_catering = this.event?.ext('catering')?.length > 0;\n    public readonly has_assets = !!this.event?.linked_bookings?.find(\n        (_) => _.booking_type === 'asset-request',\n    );\n\n    public get can_edit() {\n        return true;\n        // return (\n        //     this.event.duration <= 24 * 60 ||\n        //     this._settings.get('app.events.allow_multiday')\n        // );\n    }\n\n    public level: BuildingLevel = new BuildingLevel();\n    public building: Building = new Building();\n    public space: Space = new Space();\n\n    public accept_count = this._event.attendees.reduce(\n        (count, user) => (count += user.response_status === 'accepted' ? 1 : 0),\n        0,\n    );\n    public declined_count = this._event.attendees.reduce(\n        (count, user) => (count += user.response_status === 'declined' ? 1 : 0),\n        0,\n    );\n    public pending_count = this._event.attendees.reduce(\n        (count, user) =>\n            (count +=\n                user.response_status === 'tentative' ||\n                user.response_status === 'needsAction'\n                    ? 1\n                    : 0),\n        0,\n    );\n\n    public get body() {\n        return this.event.body.replace(/\\\\n\\\\n\\[ID\\|.*\\]/gm, '');\n    }\n\n    public get allow_edit() {\n        return !this._settings.get('app.events.booking_unavailable');\n    }\n\n    public get custom_actions(): [string, string][] {\n        return this._settings.get('app.events.custom_actions') || EMPTY_ACTIONS;\n    }\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    public get event_status() {\n        if (this.event?.state === 'done') return 'neutral';\n        if (this.event?.status === 'approved') return 'success';\n        if (this.event?.status === 'tentative') return 'warning';\n        if (this.event?.status === 'declined') return 'error';\n        return 'warning';\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _event: CalendarEvent,\n        private _org: OrganisationService,\n        private _space_pipe: SpacePipe,\n        private _settings: SettingsService,\n        private _dialog: MatDialog,\n    ) {\n        this._load().then();\n    }\n\n    public get period() {\n        if (this.event?.all_day) return 'All Day';\n        const start = this.event?.date || Date.now();\n        const duration = this.event?.duration || 60;\n        const end = addMinutes(start, duration);\n        const is_multiday = this.event?.duration > 24 * 60;\n        const dur = formatDuration({\n            hours: Math.floor(duration / 60),\n            minutes: duration % 60,\n        })\n            .replace(' hour', 'hr')\n            .replace(' minute', 'min');\n        return `${format(\n            start,\n            (is_multiday ? `MMM d, ` : '') + this.time_format,\n        )} - ${format(\n            end,\n            (is_multiday ? `MMM d, ` : '') + this.time_format,\n        )} ${duration < 24 * 60 ? '(' + dur + ')' : ''}`;\n    }\n\n    public optionList(item: CateringItem) {\n        return item.option_list?.map((_) => _.name).join('\\n');\n    }\n\n    public async checkin() {\n        const mod = getModule(this.space?.id, 'Bookings');\n        if (!mod) return;\n        await mod\n            .execute('checkin', [getUnixTime(this.event.date)])\n            .catch((e) => notifyError(`Error checking in booking. ${e}`));\n        this.room_status = 'busy';\n    }\n\n    private async _load() {\n        this.space = await this._space_pipe.transform(\n            this._event.system?.id || this._event.system?.email,\n        );\n        this.level = this._org.levelWithID(this.space.zones);\n        this.building = this._org.buildings.find((bld) =>\n            this.space.zones.includes(bld.id),\n        );\n        this.features = [\n            {\n                location: this.space.map_id,\n                content: MapPinComponent,\n            },\n        ];\n        if (\n            this.event.extension_data.catering?.length ||\n            this.event.extension_data.assets?.length\n        ) {\n            return;\n        }\n        const metadata = await getEventMetadata(\n            this._event.id,\n            this.space.id,\n        ).toPromise();\n        if (metadata) {\n            this._event = new CalendarEvent({\n                ...this._event,\n                extension_data: {\n                    ...this._event.extension_data,\n                    ...metadata,\n                },\n            });\n        }\n    }\n\n    public status(id: string): string {\n        const booking = this.event.linked_bookings.find(\n            (_) => _.asset_id === id,\n        );\n        if (booking.status) return booking.status;\n        return booking\n            ? booking.approved\n                ? 'approved'\n                : booking.rejected\n                  ? 'rejected'\n                  : 'pending'\n            : 'pending';\n    }\n\n    public viewLocation() {\n        this.hide_map = true;\n        const ref = this._dialog.open(MapLocateModalComponent, {\n            maxWidth: '95vw',\n            maxHeight: '95vh',\n            data: { item: this.space },\n        });\n        ref.afterClosed().subscribe(() => {\n            this.hide_map = false;\n        });\n    }\n}\n","import { Component, Inject, Output, EventEmitter } from '@angular/core';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialog,\n    MatDialogRef,\n} from '@angular/material/dialog';\nimport {\n    SettingsService,\n    currentUser,\n    notifyInfo,\n    unique,\n} from '@placeos/common';\nimport { MapLocateModalComponent, MapPinComponent } from '@placeos/components';\nimport {\n    Building,\n    BuildingLevel,\n    OrganisationService,\n} from '@placeos/organisation';\nimport { ViewerFeature } from '@placeos/svg-viewer';\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport { SpacePipe } from 'libs/spaces/src/lib/space.pipe';\nimport { CalendarEvent } from './event.class';\nimport {\n    addEventGuest,\n    checkinEventGuest,\n    removeEventGuest,\n} from './events.fn';\n\n@Component({\n    selector: `group-event-details-modal`,\n    template: `\n        <div\n            class=\"relative w-[48rem] max-w-[calc(100vw-1rem)] max-h-[80vh] overflow-hidden\"\n        >\n            <div\n                class=\"relative flex items-center justify-between h-52 w-full bg-base-200 overflow-hidden\"\n            >\n                <img\n                    *ngIf=\"event.extension_data?.images?.length\"\n                    auth\n                    [source]=\"event.extension_data?.images[0]\"\n                    class=\"absolute top-1/2 left-1/2 min-h-full min-w-full object-cover -translate-x-1/2 -translate-y-1/2\"\n                />\n            </div>\n\n            <div\n                class=\"absolute top-0 left-0 rounded-br py-2 pl-2 pr-4 space-x-2 bg-info text-info-content flex items-center text-sm\"\n                *ngIf=\"featured\"\n            >\n                <app-icon class=\"text-base\">star</app-icon>\n                <div class=\"uppercase\">Featured</div>\n            </div>\n            <button\n                icon\n                mat-dialog-close\n                class=\"absolute top-1 right-1 overflow-hidden\"\n            >\n                <div class=\"absolute inset-0 bg-base-100 opacity-30 z-0\"></div>\n                <app-icon class=\"z-10\">close</app-icon>\n            </button>\n            <div\n                class=\"flex items-center justify-between py-4 px-8 border-b border-base-200\"\n            >\n                <h3 class=\"text-left text-xl\">\n                    {{ event.title }}\n                </h3>\n                <div class=\"flex items-center space-x-2\">\n                    <ng-container *ngIf=\"!concierge\">\n                        <div\n                            btn\n                            class=\"flex items-center px-4 h-10 rounded space-x-2\"\n                            [class.bg-base-200]=\"!is_interested\"\n                            [class.text-base-content]=\"!is_interested\"\n                            [class.opacity-30]=\"!is_interested\"\n                            [class.bg-success]=\"is_interested\"\n                            [class.text-success-content]=\"is_interested\"\n                            [class.opacity-100]=\"is_interested\"\n                        >\n                            <app-icon>star</app-icon>\n                            <div class=\"pr-2\">\n                                {{ is_interested ? '' : 'Not ' }}Interested\n                            </div>\n                        </div>\n                        <div\n                            btn\n                            class=\"flex items-center px-4 h-10 rounded space-x-2\"\n                            [class.bg-base-200]=\"!is_going\"\n                            [class.text-base-content]=\"!is_going\"\n                            [class.opacity-30]=\"!is_going\"\n                            [class.bg-success]=\"is_going\"\n                            [class.text-success-content]=\"is_going\"\n                            [class.opacity-100]=\"is_going\"\n                        >\n                            <app-icon>help</app-icon>\n                            <div class=\"pr-2\">\n                                {{ is_going ? '' : 'Not ' }}Going\n                            </div>\n                        </div>\n                    </ng-container>\n                    <button\n                        btn\n                        matRipple\n                        class=\"clear bg-base-200 text-base-content w-[2.75rem]\"\n                        [disabled]=\"event.state === 'done'\"\n                        [matMenuTriggerFor]=\"concierge ? concierge_menu : menu\"\n                    >\n                        <app-icon class=\"text-2xl\">more_horiz</app-icon>\n                    </button>\n                    <mat-menu #concierge_menu=\"matMenu\">\n                        <button mat-menu-item [disabled]=\"true\">\n                            <div class=\"flex items-center space-x-2\">\n                                <app-icon class=\"text-2xl\">\n                                    confirmation_number\n                                </app-icon>\n                                <div class=\"mr-2\">Promote Event</div>\n                            </div>\n                        </button>\n                        <button\n                            mat-menu-item\n                            (click)=\"edit.emit()\"\n                            mat-dialog-close\n                        >\n                            <div class=\"flex items-center space-x-2\">\n                                <app-icon class=\"text-2xl\">edit</app-icon>\n                                <div class=\"mr-2\">Edit Event</div>\n                            </div>\n                        </button>\n                        <button mat-menu-item [disabled]=\"true\">\n                            <div class=\"flex items-center space-x-2\">\n                                <app-icon class=\"text-2xl\"\n                                    >content_copy</app-icon\n                                >\n                                <div class=\"mr-2\">Copy URL</div>\n                            </div>\n                        </button>\n                        <button mat-menu-item (click)=\"remove.emit()\">\n                            <div class=\"flex items-center space-x-2\">\n                                <app-icon class=\"text-2xl text-error\">\n                                    delete\n                                </app-icon>\n                                <div class=\"mr-2\">Delete Event</div>\n                            </div>\n                        </button>\n                    </mat-menu>\n                    <mat-menu #menu=\"matMenu\">\n                        <button\n                            mat-menu-item\n                            class=\"flex items-center space-x-2\"\n                            (click)=\"toggleInterest()\"\n                        >\n                            <div class=\"flex items-center space-x-2\">\n                                <app-icon [class.text-error]=\"is_interested\">\n                                    star\n                                </app-icon>\n                                <span>\n                                    {{ is_interested ? 'Revoke' : 'Indicate' }}\n                                    Interest\n                                </span>\n                            </div>\n                        </button>\n                        <button mat-menu-item (click)=\"toggleAttendance()\">\n                            <div class=\"flex items-center space-x-2\">\n                                <app-icon [class.text-error]=\"is_going\">\n                                    help\n                                </app-icon>\n                                <span>\n                                    {{ is_going ? 'Revoke' : 'Indicate' }}\n                                    Going\n                                </span>\n                            </div>\n                        </button>\n                    </mat-menu>\n                </div>\n            </div>\n            <div\n                class=\"flex flex-1 max-h-[calc(80vh-18rem)] overflow-y-auto overflow-x-hidden p-8 space-x-6\"\n            >\n                <div class=\"flex flex-1 flex-col space-y-2 w-1/3\">\n                    <div class=\"flex items-center space-x-4\">\n                        <div\n                            class=\"flex items-center justify-center w-10 h-10 bg-base-200 rounded-full\"\n                        >\n                            <app-icon>person</app-icon>\n                        </div>\n                        <div>\n                            Event by\n                            {{ event.organiser?.name || event.host }}\n                        </div>\n                    </div>\n                    <h3 class=\"font-medium pt-4\">When and where</h3>\n                    <div class=\"flex items-center space-x-4\">\n                        <div\n                            class=\"flex items-center justify-center w-10 h-10 bg-base-200 rounded-full\"\n                        >\n                            <app-icon>calendar_today</app-icon>\n                        </div>\n                        <div class=\"flex flex-col\">\n                            <div class=\"text-sm\">Date and Time</div>\n                            <div class=\"text-sm opacity-30\">\n                                {{ event.date | date: 'EEEE, d MMMM, yyyy' }}\n                                . {{ event.date | date: time_format }} -\n                                {{\n                                    event.date + event.duration * 60 * 1000\n                                        | date: time_format\n                                }}\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"flex items-center space-x-4\">\n                        <div\n                            class=\"flex items-center justify-center w-10 h-10 bg-base-200 rounded-full\"\n                        >\n                            <app-icon>place</app-icon>\n                        </div>\n                        <div class=\"flex flex-col text-sm\">\n                            <div *ngIf=\"is_onsite && has_space\">\n                                {{ (system_id | space | async)?.display_name }}\n                            </div>\n                            <div\n                                *ngIf=\"is_onsite && !has_space\"\n                                class=\"opacity-30\"\n                            >\n                                Room to be confirmed\n                            </div>\n                            <div *ngIf=\"is_online\" class=\"opacity-30\">\n                                {{\n                                    is_onsite\n                                        ? 'Can be attended online'\n                                        : 'Remote Event'\n                                }}\n                            </div>\n                        </div>\n                    </div>\n                    <button\n                        matRipple\n                        (click)=\"show_attendees = true\"\n                        class=\"flex items-center space-x-4 rounded min-h-12\"\n                    >\n                        <div\n                            class=\"flex items-center justify-center w-10 h-10 bg-base-200 rounded-full\"\n                        >\n                            <app-icon>person</app-icon>\n                        </div>\n                        <div>\n                            {{ attendance }} going,\n                            {{ event.attendees?.length }}\n                            interested\n                        </div>\n                    </button>\n                    <h3 class=\"font-medium pt-4\">About this event</h3>\n                    <div class=\"text-sm pb-4\">\n                        <span\n                            event-details\n                            [innerHTML]=\"body | sanitize\"\n                        ></span>\n                        <span\n                            *ngIf=\"!raw_description.trim()\"\n                            class=\"opacity-30\"\n                        >\n                            No description\n                        </span>\n                    </div>\n                </div>\n                <div>\n                    <div class=\"flex w-[20rem]\" *ngIf=\"level\">\n                        <div class=\"border border-base-300 w-full\">\n                            <button\n                                matRipple\n                                class=\"relative w-full h-40 bg-base-200\"\n                                (click)=\"viewLocation()\"\n                            >\n                                <interactive-map\n                                    *ngIf=\"!showing_map\"\n                                    [src]=\"level?.map_id\"\n                                    [features]=\"features\"\n                                    [styles]=\"styles\"\n                                ></interactive-map>\n                            </button>\n                            <div class=\"p-4 space-y-2\">\n                                <div *ngIf=\"is_onsite && has_space\">\n                                    {{\n                                        (system_id | space | async)\n                                            ?.display_name\n                                    }}\n                                </div>\n                                <div\n                                    *ngIf=\"is_onsite && !has_space\"\n                                    class=\"opacity-30\"\n                                >\n                                    Room to be confirmed\n                                </div>\n                                <div class=\"opacity-30 text-sm !mt-0\">\n                                    <span *ngIf=\"building && level\">\n                                        {{\n                                            building.display_name ||\n                                                building.name\n                                        }},\n                                        {{ level?.display_name || level?.name }}\n                                    </span>\n                                    <span\n                                        *ngIf=\"!building || !level\"\n                                        class=\"opacity-30\"\n                                    >\n                                        No location set for this event\n                                    </span>\n                                </div>\n                                <a\n                                    *ngIf=\"is_online\"\n                                    class=\"opacity-30 mt-4\"\n                                    [class.underline]=\"event.meeting_url\"\n                                    [href]=\"event.meeting_url\"\n                                    target=\"_blank\"\n                                    rel=\"noopener noreferrer\"\n                                >\n                                    {{\n                                        is_onsite\n                                            ? 'Can be attended online'\n                                            : 'Remote Event'\n                                    }}\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"absolute inset-0 z-50\" *ngIf=\"show_attendees\">\n            <button\n                class=\"absolute inset-0 bg-base-content opacity-60\"\n                (click)=\"show_attendees = false\"\n            ></button>\n            <div\n                class=\"absolute left-1/2 -translate-x-1/2 w-[24rem] inset-y-8 rounded shadow overflow-hidden\"\n            >\n                <attendee-list\n                    [show_host]=\"false\"\n                    [list]=\"event.attendees\"\n                    [host]=\"event.user_email\"\n                    (click)=\"show_attendees = false\"\n                ></attendee-list>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class GroupEventDetailsModalComponent {\n    @Output() public edit = new EventEmitter();\n    @Output() public remove = new EventEmitter();\n    public space: Space;\n    public event: CalendarEvent = this._data.event;\n    public concierge = this._data.concierge;\n    public building: Building;\n    public level: BuildingLevel;\n    public features: ViewerFeature[] = [];\n    public locate = '';\n    public showing_map = false;\n    public show_attendees: boolean = false;\n    public styles = {};\n    public raw_description = '';\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    public get featured() {\n        return (\n            (this.event as any).featured || this.event.extension_data?.featured\n        );\n    }\n\n    public get is_onsite() {\n        return this.event.extension_data.attendance_type !== 'ONLINE';\n    }\n\n    public get has_space() {\n        return !!this.space?.id;\n    }\n\n    public get is_online() {\n        return (\n            !this.is_onsite ||\n            this.event.extension_data.attendance_type === 'ANY'\n        );\n    }\n\n    public get body() {\n        if (this.is_online) return this.event.body;\n        let body = this.event.body;\n        const remove_blocks = [\n            `<div style=\"margin-bottom:24px; overflow:hidden; white-space:nowrap\">________________________________________________________________________________</div>`,\n            `<p>________________________________________________________________________________</p>`,\n        ];\n        for (const block of remove_blocks) {\n            const first = body.indexOf(block);\n            const last = body.lastIndexOf(block);\n            body = body.substring(0, first) + body.substring(last);\n        }\n        for (const block of remove_blocks) {\n            body = body.replace(block, '');\n        }\n        return body;\n    }\n\n    public get attendance() {\n        return (\n            this.event.attendees?.filter((_: any) => _.checked_in)?.length || 0\n        );\n    }\n\n    public get is_interested() {\n        return !!this.guest_details;\n    }\n\n    public get is_going() {\n        return this.guest_details?.checked_in;\n    }\n\n    public get system_id() {\n        return this.space?.id;\n    }\n\n    public get guest_details() {\n        const user = currentUser();\n        return this.event.attendees?.find((_) => _.email === user.email);\n    }\n\n    public get group_event_calendar() {\n        return this._settings.get('app.group_events_calendar');\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA)\n        private _data: { event: CalendarEvent; concierge: boolean },\n        private _org: OrganisationService,\n        private _settings: SettingsService,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<GroupEventDetailsModalComponent>,\n    ) {}\n\n    public async ngOnInit() {\n        const space_pipe = new SpacePipe(this._org);\n        const resource = this.event.resources.find(\n            (_) => _.email !== this.group_event_calendar,\n        );\n        this.space = await space_pipe.transform(\n            resource?.id || resource?.email,\n        );\n        const map_id = (this.event.extension_data as any)?.map_id;\n        const id = this.space?.map_id || map_id;\n        if (id) {\n            this.styles[`#${id}`] = { fill: 'green' };\n            this.features = [\n                {\n                    location: id,\n                    content: MapPinComponent,\n                    data: {},\n                },\n            ];\n        }\n        const zones = (this.space?.zones as any) || [];\n        this.level = this._org.levelWithID(zones);\n        this.building =\n            this._org.buildings.find((_) => zones.includes(_.id)) ||\n            this._org.building;\n        this.locate = map_id || '';\n        this.raw_description = this.removeHtmlTags(this.event.body);\n    }\n\n    public removeHtmlTags(html: string) {\n        const doc = new DOMParser().parseFromString(html, 'text/html');\n        return (doc.body.textContent || '').trim();\n    }\n    public viewLocation() {\n        if (!this.space?.map_id) {\n            return notifyInfo('Unable to locate space on map.');\n        }\n        this.showing_map = true;\n        const ref = this._dialog.open(MapLocateModalComponent, {\n            maxWidth: '95vw',\n            maxHeight: '95vh',\n            data: { item: this.space },\n        });\n        ref.afterClosed().subscribe(() => {\n            this.showing_map = false;\n        });\n    }\n\n    public async toggleInterest() {\n        let user = this.guest_details;\n        if (this.is_interested && user) {\n            await removeEventGuest(this.event.id, currentUser() as any, {\n                system_id: this.event.system?.id,\n            }).toPromise();\n            (this.event as any).attendees = (this.event.attendees || []).filter(\n                (_: any) => _.email !== user.email,\n            );\n        } else {\n            user = await addEventGuest(this.event.id, currentUser() as any, {\n                system_id: this.event.system?.id,\n            }).toPromise();\n            (this.event as any).attendees = unique(\n                [...(this.event.attendees || []), user],\n                'email',\n            );\n        }\n    }\n\n    public async toggleAttendance() {\n        let user = this.guest_details;\n        if (!user) {\n            user = await addEventGuest(this.event.id, currentUser() as any, {\n                system_id: this.event.system?.id,\n            }).toPromise();\n            (this.event as any).attendees = unique(\n                [...(this.event.attendees || []), user],\n                'email',\n            );\n        }\n        user = { ...currentUser(), ...(user || {}) };\n        if (!user.email) return;\n        await checkinEventGuest(this.event.id, user.email, !this.is_going, {\n            system_id: this.event.system?.id,\n        }).toPromise();\n        const guest = this.event.attendees.find((_) => _.email === user.email);\n        if (!guest) return;\n        (guest as any).checked_in = !this.is_going;\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ActivatedRoute } from '@angular/router';\nimport { addMinutes, format, formatDuration, isSameDay } from 'date-fns';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\n\nimport { CalendarEvent } from './event.class';\nimport { EventDetailsModalComponent } from './event-details-modal.component';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { SpacePipe } from 'libs/spaces/src/lib/space.pipe';\nimport { GroupEventDetailsModalComponent } from './group-event-details-modal.component';\n\n@Component({\n    selector: 'event-card',\n    template: `\n        <h4 class=\"mb-2 flex items-center\" *ngIf=\"event\" date>\n            <span *ngIf=\"show_day\" day>{{ day }},&nbsp;</span>\n            {{ event?.date | date: time_format }}\n            <span class=\"text-xs px-2\">({{ event?.date | date: 'z' }})</span>\n        </h4>\n        <a\n            name=\"view-event-details\"\n            class=\"w-full cursor-pointer relative\"\n            [routerLink]=\"['./']\"\n            [queryParams]=\"{ event: event?.id }\"\n            (click)=\"viewDetails()\"\n            *ngIf=\"event\"\n        >\n            <div\n                class=\"w-full bg-base-100 border border-base-300 rounded-xl shadow py-4 relative\"\n            >\n                <h4 class=\"px-4 text-lg\">{{ event?.title }}</h4>\n                <div class=\"flex mx-4 my-2\">\n                    <status-pill [status]=\"status\">{{ period }}</status-pill>\n                </div>\n                <div\n                    class=\"flex flex-wrap flex-col sm:flex-row sm:divide-x divide-base-200-500 py-2 space-y-2 sm:space-y-0\"\n                >\n                    <div class=\"flex items-center px-4\">\n                        <app-icon>meeting_room</app-icon>\n                        <div class=\"mx-2 truncate\">\n                            {{ location }}\n                        </div>\n                    </div>\n                    <div class=\"flex items-center px-4\">\n                        <app-icon>person_outline</app-icon>\n                        <div class=\"mx-2\">\n                            {{\n                                event?.organiser?.name ||\n                                    event?.organiser?.email\n                            }}\n                        </div>\n                    </div>\n                    <div\n                        class=\"flex items-center px-4\"\n                        *ngIf=\"event?.ext('catering')?.length\"\n                    >\n                        <app-icon>restaurant</app-icon>\n                        <div class=\"mx-2\">Catered</div>\n                    </div>\n                    <div class=\"flex items-center px-4\">\n                        <app-icon>people</app-icon>\n                        <div class=\"mx-2\">\n                            {{ event?.attendees?.length }}\n                            {{\n                                event?.attendees?.length === 1\n                                    ? 'Person'\n                                    : 'People'\n                            }}\n                        </div>\n                    </div>\n                </div>\n                <app-icon\n                    class=\"absolute top-1/2 right-1 text-4xl -translate-y-1/2\"\n                >\n                    chevron_right\n                </app-icon>\n                <div\n                    class=\"absolute bottom-2 right-2 sm:bottom-auto sm:top-2 text-sm sm:text-base flex items-center pr-4\"\n                    *ngIf=\"event?.attendees?.length\"\n                >\n                    <div\n                        class=\"h-10 w-6\"\n                        *ngFor=\"\n                            let user of event?.attendees\n                                | slice\n                                    : 0\n                                    : (event?.attendees?.length === 6 ? 6 : 5)\n                        \"\n                    >\n                        <a-user-avatar [user]=\"user\"></a-user-avatar>\n                    </div>\n                    <div class=\"h-10 w-6\" *ngIf=\"event?.attendees?.length > 6\">\n                        <div\n                            class=\"bg-secondary rounded-full h-10 w-10 border-2 border-base-100 flex items-center justify-center text-secondary-content\"\n                        >\n                            +{{ event?.attendees?.length - 5 }}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </a>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n                width: 100%;\n            }\n        `,\n    ],\n    providers: [SpacePipe],\n})\nexport class EventCardComponent extends AsyncHandler {\n    @Input() public event: CalendarEvent;\n    @Input() public show_day: boolean = false;\n    @Output() public edit = new EventEmitter();\n    @Output() public remove = new EventEmitter();\n\n    public location = '';\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    public get status() {\n        if (this.event?.state === 'done') return 'neutral';\n        if (this.event?.status === 'approved') return 'success';\n        if (this.event?.status === 'tentative') return 'warning';\n        if (this.event?.status === 'declined') return 'error';\n        return 'warning';\n    }\n\n    constructor(\n        private _dialog: MatDialog,\n        private _route: ActivatedRoute,\n        private _org: OrganisationService,\n        private _space_pipe: SpacePipe,\n        private _settings: SettingsService,\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) =>\n                params.has('event') && this.event?.id === params.get('event')\n                    ? this.viewDetails()\n                    : '',\n            ),\n        );\n        this.location = await this.getLocationString();\n    }\n\n    public async ngOnChanges(changes: SimpleChanges) {\n        if (changes.event && this.event) {\n            this.location = await this.getLocationString();\n        }\n    }\n\n    public get day() {\n        const date = this.event?.date || Date.now();\n        const is_today = isSameDay(Date.now(), date);\n        return `${is_today ? 'Today' : format(date, 'EEEE')}`;\n    }\n\n    public async getLocationString() {\n        const system =\n            this.event?.resources[0] ||\n            this.event?.system ||\n            this.event?.space ||\n            ({} as any);\n        const space = await this._space_pipe.transform(\n            system.id || system.email,\n        );\n        const zone_list = space?.zones || [];\n        const zone =\n            this._org.levelWithID(zone_list) ||\n            this._org.buildings.find((_) => zone_list.includes(_.id));\n        return `${zone ? (zone.display_name || zone.name) + ', ' : ''} ${\n            space?.display_name || space?.name\n        }`;\n    }\n\n    public get period() {\n        if (this.event?.all_day) return 'All Day';\n        const start = this.event?.date || Date.now();\n        const duration = this.event?.duration || 60;\n        const end = addMinutes(start, duration);\n        const is_multiday = this.event?.duration > 24 * 60;\n        const dur = formatDuration({\n            hours: Math.floor(duration / 60),\n            minutes: duration % 60,\n        })\n            .replace(' hour', 'hr')\n            .replace(' minute', 'min');\n        return `${format(\n            start,\n            (is_multiday ? `MMM d, ` : '') + this.time_format,\n        )} - ${format(\n            end,\n            (is_multiday ? `MMM d, ` : '') + this.time_format,\n        )} ${duration < 24 * 60 ? '(' + dur + ')' : ''}`;\n    }\n\n    public viewDetails() {\n        if (!this.event) return;\n        this.timeout('open', () => {\n            if (this.event.extension_data?.shared_event) {\n                this._dialog.open(GroupEventDetailsModalComponent, {\n                    data: { event: this.event, concierge: false },\n                });\n                return;\n            }\n            const ref = this._dialog.open(EventDetailsModalComponent, {\n                data: this.event,\n            });\n            this.subscription(\n                'edit',\n                ref.componentInstance.edit.subscribe(() => this.edit.emit()),\n            );\n            this.subscription(\n                'remove',\n                ref.componentInstance.remove.subscribe((_) =>\n                    this.remove.emit(_),\n                ),\n            );\n        });\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { SettingsService } from '@placeos/common';\n\nimport { GroupEventDetailsModalComponent } from './group-event-details-modal.component';\nimport { Space } from 'libs/spaces/src/lib/space.class';\nimport { SpacePipe } from 'libs/spaces/src/lib/space.pipe';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { CalendarEvent } from './event.class';\n\n@Component({\n    selector: 'group-event-card',\n    template: `\n        <button\n            matRipple\n            (click)=\"viewDetails()\"\n            *ngIf=\"!featured; else featured_card\"\n            class=\"border border-base-300 hover:border-info flex flex-col bg-base-100 rounded-xl shadow hover:shadow-2xl overflow-hidden w-60 h-[20rem]\"\n        >\n            <div\n                class=\"relative flex items-center justify-between h-28 min-h-28 w-full bg-base-200 overflow-hidden border-b border-base-200\"\n            >\n                <img\n                    *ngIf=\"event.images?.length\"\n                    auth\n                    [source]=\"event.images[0]\"\n                    class=\"absolute top-0 left-0 h-full w-full object-center object-cover\"\n                />\n            </div>\n            <div class=\"p-4 flex-1 h-1/2 w-full\">\n                <div class=\"opacity-60 text-sm text-left\">\n                    {{ event.date | date: 'EEE d MMM' }},\n                    {{ event.date | date: time_format }}\n                </div>\n                <h2\n                    class=\"text-xl mb-2 text-left truncate w-full\"\n                    [title]=\"event.title\"\n                >\n                    {{ event.title }}\n                </h2>\n                <div\n                    class=\"opacity-60 text-xs flex-1 overflow-hidden h-[4.5rem] mb-2 text-left\"\n                >\n                    <p class=\"line-clamp-4\">{{ raw_description }}</p>\n                    <p *ngIf=\"!raw_description.trim()\" class=\"opacity-30\">\n                        No description\n                    </p>\n                </div>\n                <div class=\"flex items-center space-x-2 text-sm\">\n                    <app-icon class=\"text-info\">place</app-icon>\n                    <div *ngIf=\"is_onsite && has_space\">\n                        {{ space.display_name || space.name || '' }}\n                    </div>\n                    <div *ngIf=\"is_onsite && !has_space\" class=\"opacity-30\">\n                        Room to be confirmed\n                    </div>\n                    <div class=\"opacity-30\" *ngIf=\"!is_onsite\">\n                        Remote event\n                    </div>\n                </div>\n                <div class=\"flex items-center space-x-2 text-sm\">\n                    <app-icon class=\"text-info\">people</app-icon>\n                    <div class=\"\">\n                        {{ event.attendees?.length || '0' }} attending\n                    </div>\n                </div>\n            </div>\n        </button>\n        <ng-template #featured_card>\n            <button\n                matRipple\n                (click)=\"viewDetails()\"\n                class=\"border border-base-300 hover:border-info flex bg-base-100 rounded-xl shadow hover:shadow-2xl overflow-hidden w-[63rem] max-w-full h-56 mx-auto\"\n            >\n                <div\n                    class=\"relative flex items-center justify-between h-full min-w-56 w-1/2 max-w-[20rem] bg-base-200 overflow-hidden border-r border-base-200\"\n                >\n                    <img\n                        *ngIf=\"event.images?.length\"\n                        auth\n                        [source]=\"event.images[0]\"\n                        class=\"absolute top-0 left-0 h-full w-full object-center object-cover\"\n                    />\n                </div>\n                <div\n                    class=\"absolute top-0 left-0 rounded-br-xl py-2 pl-2 pr-4 space-x-2 bg-info text-info-content flex items-center text-sm\"\n                >\n                    <app-icon class=\"text-base\">star</app-icon>\n                    <div class=\"uppercase\">Featured</div>\n                </div>\n                <div details class=\"flex px-8 py-4 space-x-4\">\n                    <div class=\"flex flex-col items-center\">\n                        <div class=\"text-sm opacity-30 \">\n                            {{ event.date | date: 'MMM' }}\n                        </div>\n                        <div class=\"text-lg\">{{ event.date | date: 'd' }}</div>\n                    </div>\n                    <div class=\"flex flex-col space-y-2\">\n                        <h3 class=\"text-left\">{{ event.title }}</h3>\n                        <div time class=\"text-sm opacity-30 text-left\">\n                            {{ event.date | date: 'EEEE' }}\n                            {{ event.date | date: time_format }} -\n                            {{\n                                event.date + event.duration * 60 * 1000\n                                    | date: time_format\n                            }}\n                        </div>\n                        <div class=\"h-20 overflow-hidden text-left\">\n                            <p class=\"line-clamp-3\">{{ raw_description }}</p>\n                            <p\n                                *ngIf=\"!raw_description.trim()\"\n                                class=\"opacity-30\"\n                            >\n                                No description\n                            </p>\n                        </div>\n                        <div class=\"flex items-center space-x-2 text-sm\">\n                            <app-icon class=\"text-info\">place</app-icon>\n                            <div *ngIf=\"is_onsite && has_space\">\n                                {{ space.display_name || space.name || '' }}\n                            </div>\n                            <div\n                                *ngIf=\"is_onsite && !has_space\"\n                                class=\"opacity-30\"\n                            >\n                                Room to be confirmed\n                            </div>\n                            <div class=\"opacity-30\" *ngIf=\"!is_onsite\">\n                                Remote event\n                            </div>\n                        </div>\n                        <div class=\"flex items-center space-x-2 text-sm\">\n                            <app-icon class=\"text-info\">people</app-icon>\n                            <div class=\"\">\n                                {{ event.attendees?.length || '0' }} attending\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div\n                    class=\"absolute top-4 right-4 bg-secondary text-secondary-content rounded px-4 py-2 w-32 text-center truncate\"\n                >\n                    View Details\n                </div>\n            </button>\n        </ng-template>\n    `,\n    styles: [\n        `\n            button {\n                transition:\n                    box-shadow 300ms,\n                    border 200ms;\n            }\n        `,\n    ],\n})\nexport class GroupEventCardComponent {\n    @Input() public event: CalendarEvent;\n    @Input() public featured: boolean;\n    public space: Space;\n    public raw_description = '';\n\n    public get time_format(): string {\n        return this._settings.time_format;\n    }\n\n    public get is_onsite() {\n        return this.event?.extension_data.attendance_type !== 'ONLINE';\n    }\n\n    public get has_space() {\n        return !!this.space?.id;\n    }\n\n    public get is_online() {\n        return (\n            !this.is_onsite ||\n            this.event?.extension_data.attendance_type === 'ANY'\n        );\n    }\n\n    public get group_event_calendar() {\n        return this._settings.get('app.group_events_calendar');\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _dialog: MatDialog,\n        private _org: OrganisationService,\n    ) {}\n\n    public async ngOnInit() {\n        const space_pipe = new SpacePipe(this._org);\n        const resource = this.event.resources.find(\n            (_) => _.email !== this.group_event_calendar,\n        );\n        this.space = await space_pipe.transform(\n            resource?.id || resource?.email,\n        );\n        this.raw_description = this.removeHtmlTags(this.event.body);\n    }\n\n    public removeHtmlTags(html: string) {\n        const doc = new DOMParser().parseFromString(html, 'text/html');\n        return doc.body.textContent || '';\n    }\n\n    public viewDetails(): void {\n        this._dialog.open(GroupEventDetailsModalComponent, {\n            data: { event: this.event, concierge: false },\n        });\n    }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatDatepickerModule } from '@angular/material/datepicker';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatRadioModule } from '@angular/material/radio';\n\nimport { FormFieldsModule } from 'libs/form-fields/src/lib/form-fields.module';\nimport { ComponentsModule } from 'libs/components/src/lib/components.module';\nimport { SharedSpacesModule } from 'libs/spaces/src/lib/spaces.module';\n\nimport { AttendeeListComponent } from './attendee-list.component';\nimport { EventCardComponent } from './event-card.component';\nimport { EventDetailsModalComponent } from './event-details-modal.component';\nimport { EventLinkModalComponent } from './event-link-modal.component';\nimport { SetupBreakdownModalComponent } from './setup-breakdown-modal.component';\nimport { GroupEventCardComponent } from './group-event-card.component';\nimport { GroupEventDetailsModalComponent } from './group-event-details-modal.component';\n\nimport { setDefaultCreator } from './event.class';\nimport { currentUser, current_user } from 'libs/common/src/lib/user-state';\nimport { first } from 'rxjs/operators';\n\nconst COMPONENTS = [\n    EventDetailsModalComponent,\n    AttendeeListComponent,\n    EventCardComponent,\n    EventLinkModalComponent,\n    SetupBreakdownModalComponent,\n    GroupEventDetailsModalComponent,\n    GroupEventCardComponent,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        MatRadioModule,\n        MatInputModule,\n        MatFormFieldModule,\n        MatDatepickerModule,\n        MatButtonModule,\n        MatDialogModule,\n        MatProgressSpinnerModule,\n        FormFieldsModule,\n        ComponentsModule,\n        MatRippleModule,\n        SharedSpacesModule,\n    ],\n    providers: [ReactiveFormsModule],\n    exports: [...COMPONENTS],\n})\nexport class SharedEventsModule {\n    public async ngOnInit() {\n        await current_user.pipe(first((_) => !!_)).toPromise();\n        setDefaultCreator(currentUser());\n    }\n}\n","import { Component, EventEmitter, Output, Inject } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialog } from '@angular/material/dialog';\n\nimport { DialogEvent, HashMap, AsyncHandler } from '@placeos/common';\nimport { Space } from '@placeos/spaces';\nimport { first, shareReplay, switchMap } from 'rxjs/operators';\nimport { User } from '@placeos/users';\nimport { of } from 'rxjs';\nimport { getModule } from '@placeos/ts-client';\n\nexport interface BookingModalData extends HashMap {\n    title?: string;\n    space?: Space;\n    date?: number;\n    disable_book_now_host?: boolean;\n    min_duration?: number;\n    max_duration?: number;\n}\n\nexport async function openBookingModal(\n    data: BookingModalData,\n    dialog: MatDialog,\n) {\n    const ref = dialog.open(BookingModalComponent, {\n        data,\n        autoFocus: false,\n    });\n    const result = await Promise.race([\n        ref.componentInstance.event\n            .pipe(first((_) => _.reason === 'done'))\n            .toPromise(),\n        ref.afterClosed().toPromise(),\n    ]).catch((_) => ({}));\n    return {\n        ...result,\n        close: () => ref.close(),\n    };\n}\n\n@Component({\n    selector: 'booking-modal',\n    template: `\n        <header class=\"p-4\">\n            <h3>New Booking</h3>\n        </header>\n        <form\n            *ngIf=\"form && !loading; else load_state\"\n            [formGroup]=\"form\"\n            class=\"px-4 pt-4\"\n        >\n            <div class=\"field\" *ngIf=\"!hide_host && form.controls.organiser\">\n                <label for=\"host\">Booked by<span>*</span>:</label>\n                <a-user-search-field\n                    name=\"host\"\n                    [query_fn]=\"searchStaff\"\n                    formControlName=\"organiser\"\n                    class=\"mb-2\"\n                ></a-user-search-field>\n            </div>\n            <div class=\"flex space-x-2\">\n                <div class=\"flex-1\" *ngIf=\"form.controls.date && future\">\n                    <label for=\"start-time\">Start Time:</label>\n                    <a-time-field\n                        name=\"start-time\"\n                        formControlName=\"date\"\n                    ></a-time-field>\n                </div>\n                <div class=\"flex-1\" *ngIf=\"form.controls.duration\">\n                    <label for=\"duration\">Duration:</label>\n                    <a-duration-field\n                        [min]=\"min_duration\"\n                        [max]=\"max_duration\"\n                        [step]=\"max_duration < 120 ? 5 : 15\"\n                        name=\"duration\"\n                        formControlName=\"duration\"\n                    ></a-duration-field>\n                </div>\n            </div>\n            <div class=\"flex flex-col\" *ngIf=\"form.controls.title\">\n                <label for=\"title\">Title:</label>\n                <mat-form-field appearance=\"outline\" class=\"w-full\">\n                    <input\n                        matInput\n                        name=\"title\"\n                        placeholder=\"Meeting Title\"\n                        formControlName=\"title\"\n                    />\n                </mat-form-field>\n            </div>\n        </form>\n        <footer\n            *ngIf=\"!loading\"\n            class=\"flex items-center justify-center p-2 w-full border-t border-base-200 space-x-2\"\n        >\n            <button\n                btn\n                matRipple\n                name=\"close\"\n                class=\"inverse w-32\"\n                mat-dialog-close\n            >\n                Cancel\n            </button>\n            <button btn matRipple name=\"save\" class=\"w-32\" (click)=\"save()\">\n                Save\n            </button>\n        </footer>\n        <ng-template #load_state>\n            <div class=\"flex flex-col items-center p-8\">\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p>Processing request...</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            form {\n                width: 32rem;\n                max-width: calc(100vw - 2rem);\n            }\n        `,\n    ],\n    animations: [],\n})\nexport class BookingModalComponent extends AsyncHandler {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Whether modal is closing */\n    public closing: boolean;\n    /** Whether the modal is processing a booking request */\n    public loading: boolean;\n\n    public hide_host = false;\n    public future = this._data.future;\n    public min_duration = this._data.min_duration || 15;\n    public max_duration = this._data.max_duration || 480;\n    /** Form */\n    public form: FormGroup = new FormGroup({\n        organiser: new FormControl<User>(this._data.user || null, [\n            Validators.required,\n        ]),\n        room_ids: new FormControl<string[]>([this._data.space?.email || '']),\n        date: new FormControl(this._data.date || new Date().valueOf()),\n        duration: new FormControl(Math.min(this._data.min_duration || 15, 30)),\n        title: new FormControl(`${this._data.title || ''}`),\n    });\n\n    constructor(@Inject(MAT_DIALOG_DATA) private _data: BookingModalData) {\n        super();\n        if (this._data.disable_book_now_host) {\n            this.form.controls.organiser.setValidators([]);\n            this.hide_host = true;\n        }\n        console.log('Data:', this._data);\n    }\n\n    public searchStaff = (q: string) =>\n        of(q).pipe(\n            switchMap((_) => {\n                const mod = getModule(this._data.space?.id, 'Bookings');\n                if (!mod) return of([]);\n                return mod.execute('list_users', [q]).catch((_) => []);\n            }),\n            shareReplay(1),\n        );\n\n    /**\n     * Post form data\n     */\n    public save() {\n        this.form.markAllAsTouched();\n        if (!this.form.valid) {\n            return console.log('Invalid form fields. Valid states:', this.form);\n        }\n        if (!this.future) this.form.patchValue({ date: new Date().valueOf() });\n        this.loading = true;\n        this.event.emit({\n            reason: 'done',\n            metadata: {\n                ...this.form.value,\n                user: this.form.value.organiser,\n                title: this.form.value.title || 'Ad-Hoc Panel Booking',\n            },\n        });\n    }\n}\n","import { Component, OnInit, Inject } from '@angular/core';\nimport { animate, style, transition, trigger } from '@angular/animations';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { AsyncHandler } from '@placeos/common';\n\nexport interface EmbeddedControlModalData {\n    control_url: string;\n}\n\n@Component({\n    selector: 'embedded-control-modal',\n    template: `\n        <div class=\"absolute inset-0 bg-base-100\"></div>\n        <div\n            class=\"absolute w-screen overflow-hidden bg-secondary\"\n            modal\n            [@show]\n            (window:click)=\"reset()\"\n        >\n            <div class=\"h-full w-full border-none\">\n                <iframe\n                    class=\"h-full w-full border-none\"\n                    [src]=\"control_url | safe: 'resource'\"\n                ></iframe>\n            </div>\n        </div>\n        <div class=\"absolute top-0 left-0 flex items-center h-12\">\n            <div countdown class=\"text-2xl mx-2\">{{ countdown }}</div>\n            <button\n                icon\n                matRipple\n                class=\"close\"\n                (click)=\"close()\"\n                (contextmenu)=\"$event.preventDefault()\"\n            >\n                <app-icon class=\"text-2xl mx-2\">close</app-icon>\n            </button>\n        </div>\n    `,\n    styles: [\n        `\n            [modal] {\n                height: calc(100vh - 3em);\n                box-sizing: content-box;\n                border: 2px solid #fff;\n                border-top: 1px solid #ccc;\n                transform: translate(-50%, calc(-50% + 1.75em));\n            }\n\n            .overlay {\n                position: absolute;\n                top: 0;\n                right: 0;\n                display: flex;\n                align-items: center;\n                height: 3em;\n            }\n        `,\n    ],\n    animations: [\n        trigger('show', [\n            transition(':enter', [\n                style({ opacity: 0 }),\n                animate(500, style({ opacity: 1 })),\n            ]),\n            transition(':leave', [\n                style({ opacity: 1 }),\n                animate(1000, style({ opacity: 0 })),\n            ]),\n        ]),\n    ],\n})\nexport class EmbeddedControlModalComponent\n    extends AsyncHandler\n    implements OnInit\n{\n    /** Control URL to embed into the modal */\n    public readonly control_url: string = this._data.control_url;\n    /** Display value for the time remain until the modal automatically closes */\n    public countdown: number;\n\n    constructor(\n        private _dialog_ref: MatDialogRef<EmbeddedControlModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: EmbeddedControlModalData\n    ) {\n        super();\n        this.countdown = 30;\n    }\n\n    public ngOnInit(): void {\n        this.countdown = 30;\n        this.interval('countdown', () => this.tick(), 1000);\n    }\n\n    /**\n     * Close the modal\n     */\n    public close() {\n        this._dialog_ref.close();\n        this.countdown = 30;\n    }\n\n    /**\n     * User confirmation of the content of the modal\n     */\n    public reset() {\n        this.countdown = 30;\n        this.interval('countdown', () => this.tick(), 1000);\n    }\n\n    /**\n     * Decrement countdown and close if 0\n     */\n    public tick() {\n        if (this.countdown <= 0) {\n            this.close();\n        }\n        this.countdown--;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    connectionState,\n    getModule,\n    PlaceModuleBinding,\n    PlaceSystem,\n    showSystem,\n} from '@placeos/ts-client';\nimport { Router } from '@angular/router';\nimport { OrganisationService } from '@placeos/organisation';\nimport { BehaviorSubject, combineLatest, interval, Observable, of } from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    filter,\n    first,\n    map,\n    shareReplay,\n    startWith,\n    switchMap,\n    take,\n    tap,\n} from 'rxjs/operators';\n\nimport { CalendarEvent, EventFormService } from '@placeos/events';\nimport { Space, SpacesService } from '@placeos/spaces';\nimport {\n    AsyncHandler,\n    currentUser,\n    log,\n    notifyError,\n    notifySuccess,\n    notifyWarn,\n    openConfirmModal,\n    SettingsService,\n    timePeriodsIntersect,\n} from '@placeos/common';\n\nimport { openBookingModal } from './overlays/booking-modal.component';\nimport { EmbeddedControlModalComponent } from './overlays/embedded-control-modal.component';\nimport {\n    addMinutes,\n    differenceInMinutes,\n    getUnixTime,\n    isAfter,\n    isBefore,\n    startOfMinute,\n} from 'date-fns';\nimport { SpacePipe } from 'libs/spaces/src/lib/space.pipe';\n\nexport interface PanelSettings {\n    /** Name of the room */\n    room_name?: string;\n    /** URL for the image to display when system is not bookable */\n    offline_image?: string;\n    /** Background color to display when system is not bookable */\n    offline_color?: string;\n    /** Custom URL for the QR code */\n    custom_qr_url?: string;\n    /** Custom color for the display QR code */\n    custom_qr_color?: string;\n    /**  */\n    status?: 'free' | 'pending' | 'busy' | 'not-bookable';\n    /** Whether booking has a pending state */\n    pending?: boolean;\n    /** Default title for Ad-hoc bookings */\n    default_title?: string;\n    /** Minimum duration for a booking */\n    min_duration?: number;\n    /** Maximum duration for a booking */\n    max_duration?: number;\n    /** Duration in seconds after the start with which to cancel pending bookings */\n    pending_period?: number;\n    /** Whether user is allowed to interact with the interface */\n    disable_book_now?: boolean;\n    /** URL to the control UI for this space */\n    control_ui?: string;\n    /** URI to the catering UI for this space */\n    catering_ui?: string;\n    /** Whether the QR code should be shown */\n    show_qr_code?: boolean;\n    /** URL of the image to display for the space */\n    room_image?: string;\n    /** Whether sensors detect presence in the space */\n    presence?: boolean;\n    /** Capacity for the space */\n    room_capacity?: number;\n    /** Whether meeting details should not be displayed on the UI */\n    hide_meeting_details?: boolean;\n    /** Whether the meeting title should not be display on the UI */\n    hide_meeting_title?: boolean;\n\n    disable_book_now_host?: boolean;\n    /** Whether meeting should be able to be ended early */\n    disable_end_meeting?: boolean;\n    /** Whether user is able to end their meeting early */\n    enable_end_meeting_button?: boolean;\n}\n\nexport function currentBooking(\n    list: CalendarEvent[],\n    date: number = new Date().valueOf(),\n) {\n    return list.find((bkn) =>\n        timePeriodsIntersect(\n            date,\n            date,\n            bkn.date,\n            bkn.date + bkn.duration * 1000,\n        ),\n    );\n}\n\nexport type CalendarEventStatus =\n    | 'available'\n    | 'pending'\n    | 'busy'\n    | 'not-bookable';\n\ndeclare global {\n    interface Window {\n        panel_module?: PlaceModuleBinding;\n    }\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class PanelStateService extends AsyncHandler {\n    private _space_pipe: SpacePipe = new SpacePipe(this._org);\n    /** Polling observable */\n    private _poll = interval(1000);\n    /** Mapping of current settings for the active system */\n    private _settings = new BehaviorSubject<PanelSettings>({});\n    /** Active system */\n    private _system = new BehaviorSubject<string>('');\n    /** Mapping of current settings for the active system */\n    public readonly settings = this._settings.asObservable();\n    /** List of current bookings for active system */\n    public readonly space = this._system.pipe(\n        debounceTime(1000),\n        tap((id) => log('Panel', `Loading system \"${id}\"...`)),\n        switchMap((id) =>\n            showSystem(id).pipe(\n                catchError(({ status, message }) => {\n                    log(\n                        'Panel',\n                        'Error loading system details:',\n                        [status, message],\n                        'error',\n                    );\n                    status === 404 ? this._router.navigate(['/bootstrap']) : '';\n                    return of(new PlaceSystem());\n                }),\n            ),\n        ),\n        map((_) => new Space(_ as any)),\n        shareReplay(1),\n    );\n    /** Active system */\n    public get system() {\n        return this._system.getValue();\n    }\n    public set system(value: string) {\n        this._system.next(value);\n        this._spaces.loadSpace(value);\n    }\n\n    public setting<K extends keyof PanelSettings>(name: K): PanelSettings[K] {\n        return this._settings.getValue()[name];\n    }\n    /** List of current bookings for active system */\n    public readonly bookings: Observable<CalendarEvent[]> = this._system.pipe(\n        filter((_) => !!_),\n        switchMap((id) => this._listenToModuleBinding(id, 'bookings')),\n        map((_) => (_?.length ? _.map((_) => new CalendarEvent(_)) : [])),\n        shareReplay(1),\n    );\n    /** Currently active booking */\n    public readonly _current: Observable<CalendarEvent> = this._system.pipe(\n        filter((_) => !!_),\n        switchMap((id) => this._listenToModuleBinding(id, 'current_booking')),\n        map((_) => (_ ? new CalendarEvent(_) : null)),\n        shareReplay(1),\n    );\n    public readonly current = combineLatest([\n        this._current,\n        interval(3 * 60 * 1000).pipe(startWith(0)),\n    ]).pipe(map(([e]) => (!e || e.state === 'done' ? null : e)));\n    /** Upcoming booking */\n    public readonly _next: Observable<CalendarEvent> = this._system.pipe(\n        filter((_) => !!_),\n        switchMap((id) => this._listenToModuleBinding(id, 'next_booking')),\n        map((_) => (_ ? new CalendarEvent(_) : null)),\n        shareReplay(1),\n    );\n    public readonly next = combineLatest([\n        this._next,\n        interval(3 * 60 * 1000).pipe(startWith(0)),\n    ]).pipe(map(([e]) => (!e || Date.now() > e.date ? null : e)));\n\n    public readonly status: Observable<string> = combineLatest([\n        this._settings,\n        this._current,\n    ]).pipe(\n        map(([{ status }, booking]) => status || (booking ? 'busy' : 'free')),\n        shareReplay(1),\n    );\n    public readonly pending_check = combineLatest([\n        this._current,\n        this.status,\n        interval(15 * 1000),\n    ]).pipe(\n        tap(([current, status]) => {\n            if (\n                !current ||\n                status !== 'pending' ||\n                current.body.includes('main_event_id') ||\n                this.setting('disable_end_meeting') === true\n            ) {\n                return;\n            }\n            const pending_period = this.setting('pending_period');\n            if (!pending_period || pending_period < 1) return;\n            const diff = differenceInMinutes(Date.now(), current.date);\n            if (diff <= pending_period) return;\n            this.endCurrent('Pending period expired.');\n        }),\n    );\n\n    constructor(\n        private _spaces: SpacesService,\n        private _dialog: MatDialog,\n        private _events: EventFormService,\n        private _app_settings: SettingsService,\n        private _org: OrganisationService,\n        private _router: Router,\n    ) {\n        super();\n        this._init();\n    }\n\n    private async _init() {\n        await this._org.initialised.pipe(first((_) => !!_)).toPromise();\n        this._system.pipe(filter((_) => !!_)).subscribe((id) => {\n            const settings: any[] = [\n                'room_name',\n                'custom_qr_url',\n                'custom_qr_color',\n                'disable_book_now',\n                'hide_meeting_details',\n                'hide_meeting_title',\n                'disable_book_now_host',\n                'disable_end_meeting',\n                'enable_end_meeting_button',\n                'min_duration',\n                'max_duration',\n                'pending',\n                'status',\n                'control_ui',\n                'catering_ui',\n                'pending_period',\n                'pending_before',\n                'room_image',\n                'offline_image',\n                'show_qr_code',\n                'presence',\n                'room_capacity',\n            ];\n            settings.forEach((k) => this.bindTo(id, k));\n        });\n        this.subscription('pending_check', this.pending_check.subscribe());\n        if (this._app_settings.get('app.refresh_when_websocket_unstable')) {\n            let count = 0;\n            this.subscription(\n                'stability-check',\n                connectionState().subscribe(([_, time]) => {\n                    if (time >= 30 * 1000) count = 0;\n                    else count += 1;\n                    if (count > 10) return location.reload();\n                }),\n            );\n        }\n    }\n\n    /**\n     * Open modal to create new booking\n     * @param date Start time of the new booking\n     */\n    public async newBooking(\n        date: number = Date.now(),\n        user: boolean = false,\n        future: boolean = false,\n        force_api: boolean = false,\n    ) {\n        // if (date <= Date.now() && !user) {\n        //     return this.confirmBookNow();\n        // }\n        const current = await this._current.pipe(take(1)).toPromise();\n        if (\n            current &&\n            isAfter(date, current!.date) &&\n            isBefore(date, addMinutes(current!.date, current!.duration))\n        )\n            return notifyError('Booking already exists for this time');\n\n        var max_duration = this._settings.getValue().max_duration;\n        const next = await this.next.pipe(take(1)).toPromise();\n        if (next && date <= Date.now()) {\n            const diff = Math.abs(differenceInMinutes(next.date, date));\n            const max = this._settings.getValue().max_duration || 480;\n            max_duration = diff < max ? diff : max;\n        }\n        if (max_duration != null && max_duration < 15) {\n            return notifyError(\n                'Unable to make bookings as the time available before the next meeting is less than 15 minutes',\n            );\n        }\n        const space = await this._space_pipe.transform(this.system);\n        const details = await openBookingModal(\n            {\n                ...this._settings.getValue(),\n                space,\n                date: future\n                    ? date\n                    : startOfMinute(Date.now()).getTime() + 1000,\n                future,\n                max_duration,\n            },\n            this._dialog,\n        );\n        if (details.reason !== 'done') return details.close();\n        this._events.newForm();\n        this._events.form.patchValue({\n            ...details.metadata,\n            host: details.metadata.organiser?.email,\n            resources: [space],\n            system: space,\n        });\n        await this.makeBooking(\n            this._events.form.getRawValue(),\n            force_api,\n        ).catch((e) => {\n            notifyError(`Error creating meeting. ${e}`);\n            this._events.clearForm();\n            details.close();\n            throw e;\n        });\n        this._events.clearForm();\n        details.close();\n    }\n\n    public async confirmBookNow() {\n        const date = Date.now();\n        const current = await this._current.pipe(take(1)).toPromise();\n        if (\n            current &&\n            isAfter(date, current!.date) &&\n            isBefore(date, addMinutes(current!.date, current!.duration))\n        ) {\n            return notifyError('Booking already exists for this time');\n        }\n        var max_duration = undefined;\n        const next = await this._next.pipe(take(1)).toPromise();\n        if (next && date <= Date.now()) {\n            const diff = Math.abs(differenceInMinutes(next.date, date));\n            const max = this._settings.getValue().max_duration || 480;\n            max_duration = diff < max ? diff : max;\n        }\n        if (max_duration != null && max_duration < 15) {\n            return notifyError(\n                'Unable to make bookings as the time available before the next meeting is less than 15 minutes',\n            );\n        }\n        const ref = await openConfirmModal(\n            {\n                title: 'Book Meeting',\n                content: `Do you wish to book a meeting in this room for ${Math.min(\n                    max_duration || 180,\n                    30,\n                )} minutes?`,\n                icon: { content: 'event' },\n            },\n            this._dialog,\n        );\n        if (ref.reason !== 'done') return;\n        ref.loading('Creating Meeting...');\n        try {\n            const module = getModule(this.system, 'Bookings');\n            if (!module) throw 'Unable to find module';\n            await module.execute('book_now', [\n                Math.min(max_duration || 180, 30) * 60,\n                'Ad-hoc Panel Booking',\n            ]);\n            notifySuccess('Successfully created meeting.');\n        } catch (e) {\n            notifyError(`Error creating meeting. ${e}`);\n        }\n        ref.close();\n    }\n\n    /**\n     * Create new booking with the given details\n     * @param details\n     */\n    public async makeBooking(\n        details: Partial<CalendarEvent>,\n        force_api = false,\n    ) {\n        if (isAfter(details.date, addMinutes(Date.now(), 5)) || force_api) {\n            await this._events.postForm();\n        } else {\n            const module = getModule(this.system, 'Bookings');\n            if (!details || !module) return;\n            const use_as_host = this._app_settings.get(\n                'app.user_as_default_host',\n            );\n            await module\n                .execute('book_now', [\n                    details.duration * 60,\n                    details.title,\n                    details.host || (use_as_host ? currentUser().email : null),\n                ])\n                .catch((e) => notifyError(`Error creating meeting. ${e}`));\n        }\n    }\n\n    /**\n     * Open confirmation modal for starting the meeting\n     */\n    public async confirmStart() {\n        const details = await openConfirmModal(\n            {\n                title: 'Do you wish to start your meeting?',\n                content: `If you don't start your meeting it will be cancelled ${\n                    this._settings.getValue().pending_period / 60\n                } minutes after the start time.`,\n                icon: { class: 'material-icons', content: 'play_arrow' },\n            },\n            this._dialog,\n        );\n        if (details.reason !== 'done') return;\n        this.startMeeting();\n    }\n\n    /**\n     * Execute the logic on the engine driver to start the current or upcoming meeting\n     */\n    public async startMeeting() {\n        if (!this.system || this.setting('status') !== 'pending') {\n            return notifyWarn(\n                'Current or upcoming meeting is not in a pending state.',\n            );\n        }\n        const meeting =\n            (await this._current.pipe(take(1)).toPromise()) ||\n            (await this._next.pipe(take(1)).toPromise());\n        const mod = getModule(this.system, 'Bookings');\n        if (!meeting || !mod) return;\n        await mod\n            .execute('start_meeting', [getUnixTime(meeting.date)])\n            .catch((e) => notifyError(`Error starting meeting. ${e}`));\n        this.updateProperty('status', 'busy');\n    }\n\n    /**\n     * Open confirmation modal for ending the meeting\n     */\n    public async confirmEnd() {\n        const details = await openConfirmModal(\n            {\n                title: 'Are you sure want to end your meeting?',\n                content:\n                    'Ending your meeting early will free up this room for others to use',\n                icon: { class: 'material-icons', content: 'event_busy' },\n            },\n            this._dialog,\n        );\n        if (details.reason !== 'done') return;\n        details.loading('Ending Meeting...');\n        await this.endCurrent().catch();\n        details.close();\n    }\n\n    /**\n     * End the current meeting\n     * @param reason Reason for ending the meeting early\n     */\n    public async endCurrent(reason: string = 'user_input') {\n        const current = await this._current.pipe(take(1)).toPromise();\n        const module = getModule(this.system, 'Bookings');\n        if (current && module) {\n            await module\n                .execute('end_meeting', [\n                    getUnixTime(current.date),\n                    true,\n                    reason,\n                ])\n                .catch((e) => {\n                    // notifyError(\n                    //     `Error ending meeting. ${e.message || e.error || e}`\n                    // )\n                });\n        }\n    }\n    /**\n     * Open confirmation modal for calling waiter\n     */\n    public async viewControl() {\n        const control_url = this._settings.getValue().control_ui;\n        if (!control_url) return;\n        this._dialog.open(EmbeddedControlModalComponent, {\n            data: { control_url },\n        });\n    }\n\n    /**\n     * Execute the logic on the engine driver to call waiting staff\n     */\n    public async checkin() {\n        const module = getModule(this.system, 'Bookings');\n        if (!module) return;\n        const time = startOfMinute(Date.now()).valueOf();\n        await module.execute('checkin', [time]).catch((e) => {\n            notifyError(`Error checking in booking. ${e}`);\n            throw e;\n        });\n        notifySuccess('Successfully checked in booking.');\n    }\n\n    /**\n     * Open confirmation modal for calling waiter\n     */\n    public async confirmWaiter() {\n        const details = await openConfirmModal(\n            {\n                title: 'Do you wish to call a waiter?',\n                content: `Note that it can take up to 15 minutes for them to turn up.`,\n                icon: { class: 'material-icons', content: 'room_service' },\n            },\n            this._dialog,\n        );\n        if (details.reason !== 'done') return;\n        this.callWaiter();\n    }\n\n    /**\n     * Execute the logic on the engine driver to call waiting staff\n     */\n    public async callWaiter() {\n        const module = getModule(this.system, 'Bookings');\n        if (module) {\n            await module\n                .execute('waiter_call', [Date.now()])\n                .catch((e) => notifyError(`Error calling waiter. ${e}`));\n        }\n    }\n\n    /** List to binding */\n    private bindTo<K extends keyof PanelSettings>(\n        id: string,\n        name: K,\n        mod: string = 'Bookings',\n        on_change: (v: PanelSettings[K]) => void = (v) =>\n            this.updateProperty(name, v),\n    ) {\n        const binding = getModule(id, mod).binding(name);\n        this.subscription(\n            `listen:${name}`,\n            binding.listen().subscribe(on_change),\n        );\n        this.subscription(`bind:${name}`, binding.bind());\n    }\n\n    /** Update properties of the system data */\n    private updateProperty<K extends keyof PanelSettings>(\n        name: K,\n        value: PanelSettings[K],\n    ) {\n        const item = { ...this._settings.getValue() };\n        item[name] = value;\n        this._settings.next(item);\n    }\n\n    private _listenToModuleBinding(\n        id: string,\n        name: string,\n        mod_name = 'Bookings',\n    ) {\n        const mod = getModule(id, mod_name);\n        if (window.debug) window.panel_module = mod;\n        const binding = mod.binding(name);\n        this.subscription(`binding:${mod_name}:${name}`, binding.bind());\n        return binding.listen();\n    }\n}\n","import { Component } from '@angular/core';\nimport { SettingsService } from '@placeos/common';\nimport { getUnixTime } from 'date-fns';\n\n@Component({\n    selector: 'panel-topbar',\n    template: `\n        <div\n            class=\"w-full flex items-center justify-between h-16 border-b border-base-200 bg-secondary text-white\"\n        >\n            <img [src]=\"logo.src\" alt=\"Logo\" class=\"h-12 mx-2\" />\n            <div time class=\"flex items-center space-x-2 mx-4 text-xl\">\n                <span>{{ time | date: 'shortTime' }}</span>\n                <span>  </span>\n                <span>{{ time | date: 'mediumDate' }}</span>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class PanelTopbarComponent {\n    public get logo() {\n        return this._settings.get('app.logo_dark') || {};\n    }\n\n    public get time() {\n        return getUnixTime(new Date()) * 1000;\n    }\n\n    constructor(private _settings: SettingsService) {}\n}\n","import { Component } from '@angular/core';\n\nimport { PanelStateService } from '../panel-state.service';\n\n@Component({\n    selector: 'panel-details',\n    template: `\n        <h1 class=\"text-4xl font-medium mb-8\">\n            {{\n                (space | async)?.display_name ||\n                    (space | async)?.name ||\n                    '&lt;Unknown Space&gt;'\n            }}\n        </h1>\n        <p *ngIf=\"(space | async)?.description\">\n            {{ (space | async)?.description }}\n        </p>\n        <div\n            class=\"flex flex-col items-center space-y-2\"\n            *ngIf=\"!(options | async)?.hide_actions; else empty_state\"\n        >\n            <button\n                event\n                btn\n                matRipple\n                class=\"w-48\"\n                *ngIf=\"!(options | async)?.disable_book_now\"\n                (click)=\"newEvent()\"\n            >\n                <div class=\"flex items-center justify-center\">\n                    <app-icon class=\"text-xl\">add_circle_outline</app-icon>\n                    <span class=\"mx-2\">New Event</span>\n                </div>\n            </button>\n            <button\n                control\n                btn\n                matRipple\n                class=\"w-48\"\n                *ngIf=\"(options | async)?.control_ui\"\n                (click)=\"viewControl()\"\n            >\n                <div class=\"flex items-center justify-center\">\n                    <app-icon class=\"text-xl\">settings_remote</app-icon>\n                    <span class=\"mx-2\">View Control</span>\n                </div>\n            </button>\n            <button\n                waiter\n                btn\n                matRipple\n                class=\"w-48\"\n                *ngIf=\"(options | async)?.catering_ui\"\n                (click)=\"callWaiter()\"\n            >\n                <div class=\"flex items-center justify-center\">\n                    <app-icon class=\"text-xl\">room_service</app-icon>\n                    <span class=\"mx-2\">Call Waiter</span>\n                </div>\n            </button>\n        </div>\n        <ng-template #empty_state>\n            <div class=\"flex flex-col items-center\">\n                <p>No available actions for this space</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                align-items: center;\n            }\n        `,\n    ],\n})\nexport class PanelDetailsComponent {\n    public readonly space = this._state.space;\n    public readonly options = this._state.settings;\n\n    public readonly newEvent = () => this._state.newBooking();\n\n    public readonly callWaiter = () => this._state.confirmWaiter();\n\n    public readonly viewControl = () => this._state.viewControl();\n\n    constructor(private _state: PanelStateService) {}\n}\n","import { Component } from '@angular/core';\nimport { PanelStateService } from '../panel-state.service';\n\n@Component({\n    selector: 'panel-status',\n    template: `\n        <div\n            status\n            class=\"h-12 w-[calc(100% - 2rem)] m-2 rounded shadow\"\n            [class.bg-base-200]=\"(settings | async)?.status === 'not-bookable'\"\n            [class.bg-warning]=\"(settings | async)?.status === 'pending'\"\n            [class.bg-success]=\"(settings | async)?.status === 'free'\"\n            [class.bg-error]=\"(settings | async)?.status === 'busy'\"\n        ></div>\n    `,\n    styles: [``],\n})\nexport class PanelStatusComponent {\n    public readonly settings = this._state.settings;\n\n    constructor(private _state: PanelStateService) {}\n}\n","import { Component } from '@angular/core';\nimport {\n    differenceInSeconds,\n    formatDuration,\n    isAfter,\n    isSameDay,\n} from 'date-fns';\nimport { combineLatest, interval } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { PanelStateService } from '../panel-state.service';\n\n@Component({\n    selector: 'panel-booking-list',\n    template: `\n        <h2 class=\"w-full px-4 py-2 mb-2 font-medium\" *ngIf=\"current | async\">\n            Current\n            <span\n                class=\"text-xs shadow px-2 py-1 ml-8 rounded bg-base-200\"\n                *ngIf=\"!(started | async) && (starting_in | async)\"\n            >\n                Starting in {{ starting_in | async }}\n            </span>\n            <span\n                class=\"text-xs shadow px-2 py-1 ml-8 rounded bg-error text-white\"\n                *ngIf=\"(started | async) && !(pending | async)\"\n            >\n                In Progress\n            </span>\n            <span\n                class=\"text-xs shadow px-2 py-1 ml-8 rounded bg-warning text-white\"\n                *ngIf=\"\n                    ((current | async)?.state === 'upcoming' ||\n                        (current | async)?.state === 'in_progress') &&\n                    (pending | async)\n                \"\n            >\n                Waiting to start\n            </span>\n        </h2>\n        <div class=\"mb-4 w-full\" *ngIf=\"current | async; else empty_state\">\n            <div\n                current\n                class=\"flex items-center bg-base-100 rounded-lg px-4 h-24 text-lg shadow-md w-full border border-base-200 relative max-w-full\"\n                [class.text-white]=\"started | async\"\n            >\n                <div\n                    color\n                    class=\"absolute -left-2 -right-2 top-2 bottom-2 bg-primary rounded z-0\"\n                    [class.opacity-100]=\"started | async\"\n                    [class.opacity-0]=\"!(started | async)\"\n                ></div>\n                <div\n                    class=\"relative opacity-80 w-24 text-base z-10\"\n                    *ngIf=\"!(started | async)\"\n                >\n                    <span [class.opacity-60]=\"started | async\">{{\n                        (current | async)?.event_start * 1000\n                            | date: 'shortTime'\n                    }}</span\n                    ><br />\n                    <span [class.opacity-60]=\"!(started | async)\">{{\n                        (current | async)?.event_end * 1000 | date: 'shortTime'\n                    }}</span>\n                </div>\n                <div\n                    class=\"relative opacity-80 w-24 text-base z-10 flex flex-col\"\n                    *ngIf=\"started | async\"\n                >\n                    <div class=\"text-xs\">Ends at:</div>\n                    <div>\n                        {{\n                            (current | async)?.date +\n                                (current | async)?.duration * 60 * 1000\n                                | date: 'shortTime'\n                        }}\n                    </div>\n                </div>\n                <div class=\"relative truncate z-10\">\n                    {{ (current | async)?.title || '&lt;Private Event&gt;' }}\n                </div>\n            </div>\n        </div>\n        <h2\n            class=\"w-full px-4 py-2 mb-2 font-medium\"\n            *ngIf=\"(upcoming | async)?.length\"\n        >\n            Upcoming\n        </h2>\n        <ul\n            class=\"list-style-none p-0 m-0 bg-base-100 rounded text-base shadow divide-y divide-base-200 w-full border border-base-200 max-w-full\"\n            *ngIf=\"(upcoming | async)?.length\"\n        >\n            <li\n                upcoming\n                class=\"flex items-center w-full p-4\"\n                *ngFor=\"let event of upcoming | async | slice: 0:2\"\n            >\n                <div class=\"opacity-60 w-24\">\n                    {{ event?.date | date: 'shortTime' }}\n                </div>\n                <div class=\"truncate\">\n                    {{ event?.title || '&lt;Private Event&gt;' }}\n                </div>\n            </li>\n            <li\n                upcoming\n                class=\"flex items-center w-full p-4\"\n                *ngIf=\"(upcoming | async)?.length > 2\"\n            ></li>\n        </ul>\n        <ng-template #empty_state>\n            <div\n                class=\"flex items-center justify-center bg-base-100 rounded px-4 py-8 shadow-md w-full border border-base-200\"\n            >\n                <p class=\"opacity-50\">No upcoming events for today</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                color: #000;\n            }\n\n            [current] {\n                transition: color 200ms;\n            }\n\n            [current] [color] {\n                transition: opacity 200ms;\n            }\n        `,\n    ],\n})\nexport class PanelBookingListComponent {\n    /** List of current and future events for the current day */\n    public readonly bookings = this._state.bookings.pipe(\n        map((l) =>\n            l.filter((e) => e.state !== 'done' && isSameDay(e.date, new Date()))\n        )\n    );\n    /** In progress or next event */\n    public readonly current = this.bookings.pipe(\n        map((list) => list.sort((a, b) => a.date - b.date)[0])\n    );\n    /** Whether current event has started */\n    public readonly started = combineLatest([this.current, interval(600)]).pipe(\n        map(([c]) => isAfter(Date.now(), c?.date))\n    );\n    /** Display string for time until current event's start */\n    public readonly starting_in = combineLatest([\n        this.current,\n        interval(600),\n    ]).pipe(\n        map(([_]) => {\n            const diff = _ ? differenceInSeconds(_.date, new Date()) : 0;\n            return diff && diff < 60 * 60\n                ? `${formatDuration({\n                      hours: Math.floor(diff / 60 / 60),\n                      minutes: Math.floor(diff / 60) % 60,\n                      seconds: diff < 60 ? diff : 0,\n                  })}`\n                : '';\n        })\n    );\n    /** Whether current event is waiting for the attendees to begin the evnt */\n    public readonly pending = combineLatest([\n        this.current,\n        this._state.settings,\n        interval(600),\n    ]).pipe(\n        map(([i, settings]) => i && settings.pending_period && settings.pending)\n    );\n    /** List of events excluding the current/next event */\n    public readonly upcoming = this.bookings.pipe(\n        map((list) => list.sort((a, b) => a.date - b.date).slice(1))\n    );\n\n    constructor(private _state: PanelStateService) {}\n}\n","import {\n    Component,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n} from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\n\nimport { AsyncHandler } from '@placeos/common';\n\nimport { PanelStateService } from '../panel-state.service';\n\n@Component({\n    selector: 'app-booking-panel',\n    template: `\n        <div class=\"flex flex-col absolute inset-0 bg-base-200\">\n            <panel-topbar *ngIf=\"topbar\"></panel-topbar>\n            <div\n                content\n                class=\"flex flex-1 items-center h-1/2 space-x-2\"\n                [class.p-8]=\"topbar\"\n                [class.p-4]=\"!topbar\"\n            >\n                <panel-details\n                    class=\"flex-1 h-full max-w-[50%]\"\n                    [class.p-4]=\"topbar\"\n                    [class.p-2]=\"!topbar\"\n                ></panel-details>\n                <panel-booking-list\n                    class=\"flex-1 h-full max-w-[50%]\"\n                    [class.p-4]=\"topbar\"\n                    [class.p-2]=\"!topbar\"\n                ></panel-booking-list>\n            </div>\n            <panel-status></panel-status>\n            <!-- <panel-timeline></panel-timeline> -->\n        </div>\n    `,\n    styles: [``],\n    providers: [PanelStateService],\n})\nexport class BookingPanelComponent\n    extends AsyncHandler\n    implements OnInit, OnChanges\n{\n    @Input() public system_id: string = localStorage.getItem(\n        'PLACEOS.BOOKINGS.system'\n    );\n\n    @Input() public topbar = true;\n\n    constructor(\n        private _state: PanelStateService,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.system = this.system_id || '';\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((params) => {\n                if (params.has('system_id')) {\n                    this._state.system = params.get('system_id');\n                }\n            })\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.system_id) {\n            this._state.system = this.system_id;\n        }\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\n\nimport { AsyncHandler } from '@placeos/common';\n\n@Component({\n    selector: 'app-booking-panel-array',\n    template: `\n        <div class=\"absolute inset-0 flex flex-col\">\n            <panel-topbar class=\"w-full\"></panel-topbar>\n            <div\n                class=\"flex items-center justify-center flex-wrap w-full flex-1 h-1/2\"\n            >\n                <ng-container *ngIf=\"systems?.length > 0; else none\">\n                    <div\n                        panel\n                        class=\"relative flex-1 border border-base-200 overflow-hidden\"\n                        *ngFor=\"let id of systems | slice: 0:4; let i = index\"\n                        [style.height]=\"systems.length >= 2 ? '50%' : '100%'\"\n                    >\n                        <app-booking-panel\n                            *ngIf=\"id\"\n                            [system_id]=\"id\"\n                            [topbar]=\"false\"\n                            classs=\"transform scale-75\"\n                        ></app-booking-panel>\n                    </div>\n                </ng-container>\n            </div>\n        </div>\n        <ng-template #none>\n            <div\n                class=\"absolute inset-0 flex flex-col items-center justify-center\"\n            >\n                <p>No systems are set for displaying on the panel array</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            [panel] {\n                min-width: 40%;\n            }\n\n            .container {\n                background-color: var(--bg-dark);\n                background-image: url(\"data:image/svg+xml,%3Csvg width='24' height='20' viewBox='0 0 24 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 18c0-1.105.887-2 1.998-2 1.104 0 2-.895 2.002-1.994V14v6h-4v-2zM0 13.998C0 12.895.888 12 2 12c1.105 0 2 .888 2 2 0 1.105.888 2 2 2 1.105 0 2 .888 2 2v2H0v-6.002zm16 4.004A1.994 1.994 0 0 1 14 20c-1.105 0-2-.887-2-1.998v-4.004A1.994 1.994 0 0 0 10 12c-1.105 0-2-.888-2-2 0-1.105-.888-2-2-2-1.105 0-2-.887-2-1.998V1.998A1.994 1.994 0 0 0 2 0a2 2 0 0 0-2 2V0h8v2c0 1.105.888 2 2 2 1.105 0 2 .888 2 2 0 1.105.888 2 2 2 1.105 0 2-.888 2-2 0-1.105.888-2 2-2 1.105 0 2-.888 2-2V0h4v6.002A1.994 1.994 0 0 1 22 8c-1.105 0-2 .888-2 2 0 1.105-.888 2-2 2-1.105 0-2 .887-2 1.998v4.004z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E\");\n                color: var(--font-light);\n            }\n\n            img {\n                max-width: 12em;\n            }\n        `,\n    ],\n})\nexport class BookingPanelArrayComponent extends AsyncHandler implements OnInit {\n    /** List of systems to show panels for */\n    public systems: string[];\n\n    constructor(private route: ActivatedRoute) {\n        super();\n    }\n\n    public async ngOnInit() {\n        this.subscription(\n            'route.query',\n            this.route.queryParamMap.subscribe((params) => {\n                if (params.has('system_ids')) {\n                    this.systems = (params.get('system_ids') || '')\n                        .split(',')\n                        .filter((_) => !!_);\n                }\n            })\n        );\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\n\nimport { AsyncHandler, HashMap } from '@placeos/common';\nimport { CalendarEvent } from '@placeos/events';\nimport { currentBooking } from './panel-state.service';\n\n@Component({\n    selector: 'app-booking-panel-select',\n    template: `\n        <div\n            class=\"absolute inset-0 flex items-center justify-center flex-wrap bg-base-300\"\n            (window:mousedown)=\"reset()\"\n            (window:touchstart)=\"reset()\"\n        >\n            <div\n                class=\"flex items-center justify-center flex-wrap w-full h-full p-8\"\n            >\n                <ng-container *ngIf=\"systems && systems.length > 0; else none\">\n                    <button\n                        matRipple\n                        class=\"item text-white flex flex-col items-center justify-center rounded m-2 p-2\"\n                        *ngFor=\"let id of systems | slice: 0:8; let i = index\"\n                        (click)=\"showPanel(id)\"\n                    >\n                        <div class=\"bindings\" *ngIf=\"id\">\n                            <i\n                                binding\n                                [sys]=\"id\"\n                                mod=\"Bookings\"\n                                bind=\"room_name\"\n                                [(model)]=\"system_name[id]\"\n                            ></i>\n                            <i\n                                binding\n                                [sys]=\"id\"\n                                mod=\"Bookings\"\n                                bind=\"icon\"\n                                [(model)]=\"system_icon[id]\"\n                            ></i>\n                            <i\n                                binding\n                                [sys]=\"id\"\n                                mod=\"Bookings\"\n                                bind=\"status\"\n                                (modelChange)=\"system_status[id] = $event\"\n                            ></i>\n                        </div>\n                        <div\n                            state\n                            [class]=\"\n                                'h-36 w-36 flex items-center justify-center text-6xl bg-base-100 bg-opacity-10 rounded' +\n                                (system_status[id]\n                                    ? ' ' + system_status[id]\n                                    : '')\n                            \"\n                        >\n                            <img\n                                *ngIf=\"system_name[id]\"\n                                [src]=\"system_icon[id]\"\n                            />\n                            <mat-spinner\n                                *ngIf=\"!system_name[id]\"\n                                [diameter]=\"32\"\n                            ></mat-spinner>\n                        </div>\n                        <div\n                            class=\"truncate text-sm p-3 text-white w-full text\"\n                        >\n                            {{ system_name[id] || id + ' connecting...' }}\n                        </div>\n                    </button>\n                </ng-container>\n            </div>\n            <div\n                class=\"absolute inset-0 border border-white\"\n                *ngIf=\"active_system\"\n            >\n                <app-booking-panel\n                    [system_id]=\"active_system\"\n                ></app-booking-panel>\n                <div\n                    class=\"absolute top-0 left-1/2 transform -translate-x-1/2 flex items-center bg-base-100 rounded-b p-2\"\n                >\n                    <button\n                        icon\n                        matRipple\n                        class=\"action close\"\n                        (click)=\"close()\"\n                        (contextmenu)=\"$event.preventDefault()\"\n                    >\n                        <app-icon>close</app-icon>\n                    </button>\n                    <button\n                        widget\n                        class=\"action countdown w-12 h-10\"\n                        (contextmenu)=\"$event.preventDefault()\"\n                    >\n                        {{ countdown }}\n                    </button>\n                </div>\n            </div>\n            <ng-template #none>\n                <div class=\"absolute inset-0 flex items-center justify-center\">\n                    <p>\n                        No systems are set for displaying on the panel select\n                        list\n                    </p>\n                </div>\n            </ng-template>\n        </div>\n    `,\n    styles: [\n        `\n            .item {\n                height: 11.5em;\n                width: 10em;\n                background-color: var(--bg-dark);\n                box-shadow: 0 1px 3px 0 rgba(#000, 0.2),\n                    0 1px 1px 0 rgba(#000, 0.14),\n                    0 2px 1px -1px rgba(#000, 0.12);\n            }\n\n            .free {\n                background-color: rgba(var(--success), 0.6);\n            }\n\n            .busy {\n                background-color: rgba(var(--error), 0.6);\n            }\n\n            img {\n                max-width: 1em;\n                max-height: 1em;\n            }\n        `,\n    ],\n})\nexport class BookingPanelSelectComponent\n    extends AsyncHandler\n    implements OnInit\n{\n    /** List of systems to show panels for */\n    public systems: string[];\n    /** Names for the list of systems */\n    public system_name: HashMap<string> = {};\n    /** Icons for the list of systems */\n    public system_icon: HashMap<string> = {};\n    /** Status for the list of systems */\n    public system_status: HashMap<string> = {};\n    /** Active Panel system */\n    public active_system: string;\n    /** Countdown counter */\n    public countdown: number;\n\n    constructor(private route: ActivatedRoute) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'route.query',\n            this.route.queryParamMap.subscribe((params) => {\n                if (params.has('system_ids')) {\n                    this.systems = (params.get('system_ids') || '').split(',');\n                }\n            })\n        );\n    }\n\n    /**\n     * Show booking panel for the given system ID\n     * @param id ID of the system to show\n     */\n    public showPanel(id: string) {\n        this.active_system = id;\n        this.reset();\n    }\n\n    /**\n     * Update the status value for the given system ID\n     * @param id ID of the system to update\n     * @param bookings List of current bookings for the system\n     */\n    public updateStatus(id: string, bookings: HashMap[]) {\n        const current = currentBooking(\n            (bookings || []).map((i) => new CalendarEvent(i))\n        );\n        this.system_status[id] = current ? 'unavailable' : 'available';\n    }\n\n    /**\n     * Close the modal\n     */\n    public close() {\n        this.active_system = null;\n        this.clearInterval('countdown');\n    }\n\n    /**\n     * User confirmation of the content of the modal\n     */\n    public reset() {\n        if (this.active_system) {\n            this.countdown = 30;\n            this.interval('countdown', () => this.tick(), 1000);\n        }\n    }\n\n    /**\n     * Decrement countdown and close if 0\n     */\n    public tick() {\n        if (this.countdown <= 0) {\n            this.close();\n        }\n        this.countdown--;\n    }\n}\n","import { Component } from '@angular/core';\nimport { startOfMinute } from 'date-fns';\n\nimport { generateQRCode } from 'libs/common/src/lib/qr-code';\n\nimport { PanelStateService } from '../panel-state.service';\n\n@Component({\n    selector: 'panel-view-details',\n    template: `\n        <div class=\"h-full w-full bg-black relative text-white\">\n            <div\n                class=\"bg-cover bg-center absolute inset-0\"\n                [style.background-image]=\"'url(' + room_image + ')'\"\n            ></div>\n            <div class=\"absolute inset-0 bg-black opacity-50\"></div>\n            <div name class=\"absolute top-4 left-4 text-4xl font-medium\">\n                {{\n                    (system | async)?.display_name ||\n                        (system | async)?.name ||\n                        '&lt;Unknown Space&gt;'\n                }}\n            </div>\n            <div\n                qr-checkin\n                *ngIf=\"checkin\"\n                class=\"absolute top-4 right-4 text-xl w-40 space-y-4 z-50\"\n            >\n                <img class=\"w-full\" [src]=\"qr_code\" />\n                <div class=\"w-full text-lg\" *ngIf=\"!custom_qr\">\n                    {{ 'PANEL.SCAN_QR_CODE' | translate }}\n                </div>\n            </div>\n            <div\n                *ngIf=\"\n                    (current | async) &&\n                    !hide_meeting_details &&\n                    !hide_meeting_title\n                \"\n                class=\"absolute bottom-0 inset-x-0 text-white p-4 text-center text-3xl\"\n            >\n                <div class=\"absolute inset-0 bg-neutral opacity-30\"></div>\n                <div class=\"relative\">\n                    {{ (current | async)?.title }}\n                    <span class=\"font-light\">{{\n                        'PANEL.MEETING_IN_PROGRESS' | translate\n                    }}</span>\n                </div>\n            </div>\n            <div\n                class=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 font-normal space-y-4 text-center\"\n                [class.pb-8]=\"\n                    (current | async) &&\n                    !hide_meeting_details &&\n                    !hide_meeting_title\n                \"\n            >\n                <p class=\"text-3xl\">\n                    {{ time | date: 'EEE, MMM d, y h:mm a' }}\n                </p>\n                <p\n                    class=\"text-4xl\"\n                    *ngIf=\"(current | async) && !hide_meeting_details\"\n                >\n                    {{ 'PANEL.HOST' | translate }}\n                    {{\n                        (current | async)?.organiser?.name ||\n                            (current | async)?.host\n                    }}\n                </p>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n            }\n        `,\n    ],\n})\nexport class PanelViewDetailsComponent {\n    public readonly system = this._state.space;\n    public readonly current = this._state.current;\n    public qr_code: any;\n\n    public get time() {\n        return startOfMinute(Date.now());\n    }\n\n    public get hide_meeting_details() {\n        return this._state.setting('hide_meeting_details');\n    }\n\n    public get hide_meeting_title() {\n        return this._state.setting('hide_meeting_title');\n    }\n\n    public get room_image() {\n        return this._state.setting('room_image');\n    }\n\n    public get checkin() {\n        return this._state.setting('show_qr_code') !== false;\n    }\n\n    public get custom_qr() {\n        return !!this._state.setting('custom_qr_url');\n    }\n\n    constructor(private _state: PanelStateService) {}\n\n    public async ngOnInit() {\n        this._state.current.subscribe();\n        this._state.settings.subscribe(({ custom_qr_url, custom_qr_color }) => {\n            if (custom_qr_url) {\n                this.qr_code = generateQRCode(\n                    custom_qr_url,\n                    '#fff0',\n                    custom_qr_color || '#fff'\n                );\n            } else if (!this.qr_code) {\n                const url = `${location.origin}${location.pathname}#/checkin/${this._state.system}?user=true`;\n                this.qr_code = generateQRCode(\n                    url,\n                    '#fff0',\n                    custom_qr_color || '#fff'\n                );\n            }\n        });\n    }\n}\n","import { CalendarEvent, getNextFreeTimeSlot } from '@placeos/events';\nimport {\n    addMinutes,\n    differenceInMinutes,\n    differenceInSeconds,\n    format,\n    formatDuration,\n} from 'date-fns';\n\nexport function nextPeriod(next: CalendarEvent) {\n    const next_diff = Math.ceil(\n        differenceInSeconds(next?.date, Date.now()) / 60\n    );\n    return next && next_diff < 24 * 60\n        ? `${format(next.date, 'h:mm a')} - ${format(\n              addMinutes(next.date, next.duration),\n              'h:mm a'\n          )}`\n        : '';\n}\n\nexport function currentPeriod(\n    bookings: CalendarEvent[],\n    current: CalendarEvent,\n    next: CalendarEvent\n) {\n    const slot = getNextFreeTimeSlot(bookings);\n    const next_diff = Math.ceil(\n        differenceInSeconds(next?.date, Date.now()) / 60\n    );\n    if (!current)\n        return next && next_diff < 24 * 60\n            ? [false, Math.floor(next_diff / 60), next_diff % 60]\n            : [];\n    const checked_in = true;\n    const current_diff = Math.ceil(\n        differenceInSeconds(slot.start, Date.now()) / 60\n    );\n    return checked_in\n        ? [true, Math.floor(current_diff / 60), current_diff % 60]\n        : [];\n}\n","import { Component } from '@angular/core';\nimport { combineLatest, interval } from 'rxjs';\nimport { map, shareReplay, take } from 'rxjs/operators';\nimport { PanelStateService } from '../panel-state.service';\nimport { currentPeriod, nextPeriod } from './helpers';\n\n@Component({\n    selector: 'panel-view-status',\n    template: `\n        <div class=\"flex items-center justify-center h-full w-full\">\n            <div\n                class=\"flex-1 h-full text-white flex flex-col items-center justify-center relative\"\n                [class.bg-error]=\"(state | async) === 'busy'\"\n                [class.bg-success]=\"(state | async) === 'free'\"\n                [class.bg-warning]=\"(state | async) === 'pending'\"\n                [class.text-error-content]=\"(state | async) === 'busy'\"\n                [class.text-success-content]=\"(state | async) === 'free'\"\n                [class.text-warning-content]=\"(state | async) === 'pending'\"\n            >\n                <div\n                    [innerHTML]=\"\n                        ((state | async) === 'busy'\n                            ? in_use_svg\n                            : (state | async) === 'pending'\n                            ? pending_svg\n                            : free_svg\n                        ) | safe\n                    \"\n                ></div>\n                <h3 class=\"text-4xl uppercase font-medium mt-4\">\n                    {{ 'PANEL.NOW' | translate }}\n                </h3>\n                <p class=\"text-2xl font-light mt-4\">\n                    <ng-container\n                        *ngIf=\"\n                            (event_state | async)?.current?.length;\n                            else no_current_state\n                        \"\n                    >\n                        <ng-container\n                            *ngIf=\"\n                                (event_state | async)?.current[0];\n                                else free_for_state\n                            \"\n                        >\n                            <ng-container\n                                *ngIf=\"(event_state | async)?.current[1] > 0\"\n                            >\n                                {{\n                                    'PANEL.FREE_IN_HOURS_AND_MINUTES'\n                                        | translate\n                                            : {\n                                                  hour: (event_state | async)\n                                                      ?.current[1],\n                                                  minute: (event_state | async)\n                                                      ?.current[2]\n                                              }\n                                }}\n                            </ng-container>\n                            <ng-container\n                                *ngIf=\"\n                                    (event_state | async)?.current[1] <= 0 &&\n                                    (event_state | async)?.current[2] > 1\n                                \"\n                            >\n                                {{\n                                    'PANEL.FREE_IN_MINUTES'\n                                        | translate\n                                            : {\n                                                  minute: (event_state | async)\n                                                      ?.current[2]\n                                              }\n                                }}\n                            </ng-container>\n                            <ng-container\n                                *ngIf=\"\n                                    (event_state | async)?.current[1] <= 0 &&\n                                    (event_state | async)?.current[2] <= 1\n                                \"\n                            >\n                                {{\n                                    'PANEL.FREE_IN_LESS_THAN_MINUTE' | translate\n                                }}\n                            </ng-container>\n                        </ng-container>\n                        <ng-template #free_for_state>\n                            <ng-container *ngIf=\"(state | async) === 'busy'\">\n                                {{ 'PANEL.EARLY_CHECKIN' | translate }}\n                            </ng-container>\n                            <ng-container *ngIf=\"(state | async) !== 'busy'\">\n                                <ng-container\n                                    *ngIf=\"\n                                        (event_state | async)?.current[1] > 0\n                                    \"\n                                >\n                                    {{\n                                        'PANEL.FREE_FOR_HOURS_AND_MINUTES'\n                                            | translate\n                                                : {\n                                                      hour: (\n                                                          event_state | async\n                                                      )?.current[1],\n                                                      minute: (\n                                                          event_state | async\n                                                      )?.current[2]\n                                                  }\n                                    }}\n                                </ng-container>\n                                <ng-container\n                                    *ngIf=\"\n                                        (event_state | async)?.current[1] <=\n                                            0 &&\n                                        (event_state | async)?.current[2] > 1\n                                    \"\n                                >\n                                    {{\n                                        'PANEL.FREE_FOR_MINUTES'\n                                            | translate\n                                                : {\n                                                      minute: (\n                                                          event_state | async\n                                                      )?.current[2]\n                                                  }\n                                    }}\n                                </ng-container>\n                                <ng-container\n                                    *ngIf=\"\n                                        (event_state | async)?.current[1] <=\n                                            0 &&\n                                        (event_state | async)?.current[2] <= 1\n                                    \"\n                                >\n                                    {{\n                                        'PANEL.FREE_FOR_LESS_THAN_MINUTE'\n                                            | translate\n                                    }}\n                                </ng-container>\n                            </ng-container>\n                        </ng-template>\n                    </ng-container>\n                    <ng-template #no_current_state>\n                        {{ 'PANEL.NO_CURRENT' | translate }}\n                    </ng-template>\n                </p>\n                <div\n                    class=\"absolute top-0 inset-x-0 flex items-center justify-center text-2xl bg-[#0008] p-4 space-x-4\"\n                    *ngIf=\"(state | async) === 'pending' && can_book\"\n                >\n                    <p class=\"uppercase\">\n                        {{ 'PANEL.CHECKIN_INPUT' | translate }}\n                    </p>\n                    <app-icon>arrow_forward</app-icon>\n                </div>\n                <div\n                    class=\"absolute top-0 inset-x-0 flex items-center justify-center text-2xl bg-[#0008] p-4 space-x-4\"\n                    *ngIf=\"(state | async) === 'free' && can_book\"\n                >\n                    <p class=\"uppercase\">\n                        {{ 'PANEL.BOOKING_INPUT' | translate }}\n                    </p>\n                    <app-icon>arrow_forward</app-icon>\n                </div>\n                <div\n                    class=\"absolute top-0 inset-x-0 flex items-center justify-center text-2xl bg-[#0008] p-4 space-x-4\"\n                    *ngIf=\"(state | async) === 'busy' && can_end\"\n                >\n                    <p class=\"uppercase\">\n                        {{ 'PANEL.END_INPUT' | translate }}\n                    </p>\n                    <app-icon>arrow_forward</app-icon>\n                </div>\n            </div>\n            <div\n                class=\"flex-1 h-full bg-base-100 text-base-content flex flex-col items-center justify-center space-y-4\"\n            >\n                <div\n                    [innerHTML]=\"\n                        (!(event_state | async)?.next ? free_svg : in_use_svg)\n                            | safe\n                    \"\n                ></div>\n                <h3 class=\"text-4xl uppercase font-medium\">\n                    {{ 'PANEL.NEXT' | translate }}\n                </h3>\n                <p class=\"text-2xl font-light\">\n                    {{\n                        (event_state | async)?.next ||\n                            ('PANEL.NO_UPCOMING' | translate)\n                    }}\n                </p>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host > div > div {\n                background-color: #424242;\n            }\n        `,\n    ],\n})\nexport class PanelViewStatusComponent {\n    public readonly state = this._state.status;\n    public readonly current = this._state.current;\n    public readonly next = this._state.next;\n    public readonly bookings = this._state.bookings;\n\n    public get can_book() {\n        return this._state.setting('disable_book_now') !== true;\n    }\n\n    public get can_end() {\n        return this._state.setting('enable_end_meeting_button') === true;\n    }\n\n    public readonly event_state = combineLatest([\n        this.current,\n        this.next,\n        this.bookings,\n        interval(5000),\n    ]).pipe(\n        map(([c, n, l]) => ({\n            current: currentPeriod(l, c, n),\n            next: nextPeriod(n),\n        })),\n        shareReplay(1)\n    );\n\n    public readonly free_svg = `\n    <svg width=\"129\" height=\"117\" viewBox=\"0 0 129 117\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clip-path=\"url(#clip0)\">\n    <path d=\"M32.9422 90.8456H10.1503L6.37414 54.8238C6.34123 54.4031 6.22286 53.9934 6.02626 53.62C5.82966 53.2465 5.55897 52.9171 5.23075 52.6519C4.90253 52.3867 4.52368 52.1913 4.11737 52.0776C3.71106 51.9639 3.28583 51.9343 2.8677 51.9907C2.44708 52.0236 2.03759 52.142 1.66428 52.3387C1.29098 52.5353 0.961708 52.8061 0.696607 53.1345C0.431506 53.4628 0.236151 53.8418 0.12249 54.2483C0.00882954 54.6547 -0.0207468 55.0801 0.0355704 55.4984L4.21633 94.3534C4.312 95.1416 4.69529 95.8668 5.29265 96.3896C5.89001 96.9125 6.65936 97.1963 7.45305 97.1865H17.4329V109.059L10.0155 111.892C9.68401 112.004 9.37812 112.181 9.1155 112.412C8.85287 112.644 8.63873 112.925 8.48549 113.239C8.33225 113.554 8.24295 113.896 8.22276 114.246C8.20257 114.595 8.2519 114.945 8.36788 115.275C8.48387 115.605 8.6642 115.909 8.89844 116.169C9.13268 116.429 9.41617 116.64 9.73249 116.79C10.0488 116.94 10.3916 117.025 10.7412 117.041C11.0907 117.057 11.4399 117.004 11.7687 116.884L19.8605 113.916L27.9523 116.884H28.8963C29.4326 116.879 29.9541 116.707 30.3889 116.393C30.8236 116.079 31.1503 115.638 31.3238 115.13C31.5533 114.468 31.512 113.742 31.2089 113.11C30.9058 112.478 30.3654 111.992 29.7055 111.757L22.4229 109.194V97.3214H32.9422C33.7971 97.3099 34.6137 96.9651 35.2182 96.3603C35.8227 95.7556 36.1674 94.9387 36.1789 94.0835C36.1845 93.6568 36.1047 93.2332 35.944 92.8378C35.7833 92.4424 35.5451 92.0833 35.2434 91.7815C34.9417 91.4797 34.5827 91.2414 34.1875 91.0806C33.7922 90.9199 33.3688 90.84 32.9422 90.8456Z\" fill=\"currentColor\"/>\n    <path d=\"M125.189 51.9907C124.348 51.9019 123.507 52.1503 122.85 52.6816C122.192 53.2128 121.772 53.9833 121.682 54.8239L117.906 90.7107H94.9794C94.121 90.7107 93.2977 91.0519 92.6907 91.6591C92.0837 92.2663 91.7427 93.0899 91.7427 93.9487C91.7427 94.8074 92.0837 95.631 92.6907 96.2382C93.2977 96.8454 94.121 97.1866 94.9794 97.1866H105.499V109.059L98.2161 111.622C97.5749 111.882 97.0536 112.371 96.7542 112.995C96.4549 113.619 96.3991 114.332 96.5978 114.995C96.7713 115.503 97.098 115.944 97.5327 116.258C97.9675 116.572 98.489 116.744 99.0253 116.749C99.302 116.77 99.5797 116.724 99.8345 116.614L107.926 113.646L116.018 116.614C116.347 116.734 116.696 116.787 117.046 116.771C117.395 116.755 117.738 116.67 118.054 116.52C118.371 116.37 118.654 116.16 118.888 115.9C119.123 115.64 119.303 115.336 119.419 115.005C119.535 114.675 119.584 114.325 119.564 113.976C119.544 113.626 119.455 113.284 119.301 112.97C119.148 112.655 118.934 112.374 118.671 112.143C118.409 111.911 118.103 111.734 117.771 111.622L110.489 109.059V97.1866H120.603C121.397 97.1963 122.166 96.9126 122.764 96.3897C123.361 95.8668 123.744 95.1416 123.84 94.3534L128.021 55.4984C128.11 54.6577 127.861 53.8161 127.33 53.1584C126.799 52.5007 126.029 52.0807 125.189 51.9907Z\" fill=\"currentColor\"/>\n    <path d=\"M95.5186 74.1164V69.7992C95.5241 69.7091 95.5104 69.619 95.4785 69.5346C95.4465 69.4503 95.3971 69.3737 95.3333 69.3099C95.2696 69.2462 95.193 69.1967 95.1087 69.1647C95.0244 69.1328 94.9342 69.1191 94.8443 69.1246H33.0769C32.9869 69.1191 32.8968 69.1328 32.8124 69.1647C32.7281 69.1967 32.6516 69.2462 32.5878 69.3099C32.5241 69.3737 32.4746 69.4503 32.4426 69.5346C32.4107 69.619 32.397 69.7091 32.4026 69.7992V74.1164C32.397 74.2064 32.4107 74.2966 32.4426 74.3809C32.4746 74.4653 32.5241 74.5419 32.5878 74.6056C32.6516 74.6694 32.7281 74.7189 32.8124 74.7509C32.8968 74.7828 32.9869 74.7965 33.0769 74.791H55.1945V115.67C55.1889 115.76 55.2026 115.85 55.2345 115.934C55.2665 116.018 55.3159 116.095 55.3797 116.159C55.4435 116.223 55.52 116.272 55.6043 116.304C55.6886 116.336 55.7788 116.35 55.8688 116.344H72.0524C72.1423 116.35 72.2325 116.336 72.3168 116.304C72.4011 116.272 72.4777 116.223 72.5414 116.159C72.6052 116.095 72.6547 116.018 72.6866 115.934C72.7185 115.85 72.7322 115.76 72.7267 115.67V74.9259H94.8443C95.0399 74.9054 95.2198 74.8093 95.3458 74.6581C95.4717 74.507 95.5337 74.3126 95.5186 74.1164Z\" fill=\"currentColor\"/>\n    </g>\n    <defs>\n    <clipPath id=\"clip0\">\n    <rect width=\"128.03\" height=\"116.141\" fill=\"currentColor\" transform=\"translate(0.000488281 0.858643)\"/>\n    </clipPath>\n    </defs>\n    </svg>\n    `;\n\n    public readonly in_use_svg = `\n    <svg width=\"129\" height=\"117\" viewBox=\"0 0 129 117\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clip-path=\"url(#clip0)\">\n    <path d=\"M29.7316 77.5781C29.1922 71.6419 28.6527 64.7613 28.2481 60.8489C28.6527 61.2536 29.1922 61.6583 29.5968 62.0631C32.9684 65.0312 38.9023 65.5708 42.9482 65.5708C44.8363 65.5708 46.3198 65.4359 46.9941 65.4359C48.0088 65.3405 48.9445 64.8473 49.597 64.0641C50.2494 63.2809 50.5656 62.2713 50.4766 61.2557C50.3875 60.2401 49.9004 59.301 49.1216 58.6434C48.3428 57.9858 47.3356 57.6631 46.3198 57.7459C42.6785 58.1506 36.6097 57.7459 34.8564 56.2618C30.5021 52.1921 24.7668 49.926 18.8077 49.9209C12.4691 49.9209 11.2554 52.7541 11.2554 56.1269C11.2554 60.7139 12.7389 80.5462 13.6829 84.8634C14.627 88.641 24.0674 87.9664 28.6527 87.8315C32.711 87.6529 36.7769 87.8789 40.7904 88.506C40.9217 96.0702 40.6516 103.636 39.9812 111.171C39.8928 112.491 40.3224 113.793 41.1786 114.801C42.0349 115.809 43.2504 116.443 44.5666 116.568H44.9712C46.2268 116.57 47.4371 116.099 48.3616 115.249C49.2862 114.399 49.8572 113.233 49.9611 111.981C51.1749 95.9263 51.1749 86.2125 49.8263 83.2444C47.8033 79.0621 42.5437 77.8479 29.7316 77.5781Z\" fill=\"currentColor\" fill-opacity=\"0.61\"/>\n    <path d=\"M18.6731 47.8973C24.1104 47.8973 28.5182 43.4879 28.5182 38.0486C28.5182 32.6093 24.1104 28.2 18.6731 28.2C13.2359 28.2 8.82812 32.6093 8.82812 38.0486C8.82812 43.4879 13.2359 47.8973 18.6731 47.8973Z\" fill=\"currentColor\" fill-opacity=\"0.61\"/>\n    <path d=\"M33.9124 90.5297H11.1205L7.34436 54.5079C7.31145 54.0871 7.19307 53.6775 6.99647 53.3041C6.79987 52.9306 6.52919 52.6012 6.20097 52.336C5.87275 52.0708 5.49389 51.8754 5.08758 51.7617C4.68127 51.648 4.25605 51.6184 3.83791 51.6747C3.41729 51.7077 3.0078 51.8261 2.6345 52.0228C2.2612 52.2194 1.93192 52.4902 1.66682 52.8186C1.40172 53.1469 1.20637 53.5259 1.0927 53.9323C0.979044 54.3388 0.949468 54.7642 1.00579 55.1825L5.18655 94.0374C5.28222 94.8257 5.66551 95.5508 6.26287 96.0737C6.86023 96.5966 7.62957 96.8804 8.42327 96.8706H18.4031V108.743L10.9857 111.576C10.6542 111.688 10.3483 111.865 10.0857 112.096C9.82309 112.328 9.60895 112.609 9.45571 112.924C9.30246 113.238 9.21316 113.58 9.19297 113.93C9.17278 114.279 9.22211 114.629 9.3381 114.959C9.45408 115.289 9.63442 115.593 9.86866 115.853C10.1029 116.113 10.3864 116.324 10.7027 116.474C11.019 116.624 11.3619 116.709 11.7114 116.725C12.0609 116.741 12.4102 116.688 12.7389 116.568L20.8307 113.6L28.9225 116.568H29.8665C30.4028 116.563 30.9243 116.391 31.3591 116.077C31.7938 115.763 32.1205 115.322 32.2941 114.814C32.5235 114.152 32.4822 113.426 32.1791 112.794C31.876 112.163 31.3356 111.676 30.6757 111.441L23.3931 108.878V97.0055H33.9124C34.7673 96.994 35.5839 96.6492 36.1884 96.0444C36.7929 95.4397 37.1376 94.6228 37.1491 93.7676C37.1548 93.3408 37.0749 92.9173 36.9142 92.5219C36.7535 92.1265 36.5153 91.7673 36.2136 91.4655C35.912 91.1637 35.5529 90.9254 35.1577 90.7647C34.7624 90.604 34.339 90.5241 33.9124 90.5297Z\" fill=\"currentColor\" fill-opacity=\"0.61\"/>\n    <path d=\"M89.206 88.5061C93.2205 87.8881 97.2855 87.6622 101.344 87.8315C105.929 87.9664 115.37 88.641 116.314 84.8634C117.392 80.5462 118.741 60.714 118.741 56.1269C118.741 52.7541 117.662 49.9209 111.189 49.9209C105.213 49.8372 99.4458 52.1159 95.14 56.2618C93.3868 57.7459 87.4528 58.0157 83.6766 57.7459C83.1702 57.6982 82.6592 57.7513 82.1733 57.9019C81.6874 58.0526 81.236 58.2978 80.8452 58.6237C80.4544 58.9495 80.1319 59.3494 79.8961 59.8004C79.6604 60.2514 79.5162 60.7445 79.4717 61.2515C79.4273 61.7585 79.4835 62.2692 79.6371 62.7544C79.7907 63.2396 80.0388 63.6895 80.3669 64.0784C80.695 64.4673 81.0968 64.7875 81.5491 65.0205C82.0014 65.2534 82.4953 65.3946 83.0023 65.4359C83.6766 65.4359 85.1601 65.5709 87.0482 65.5709C91.0941 65.5709 97.0281 65.0312 100.4 62.0631C100.879 61.6925 101.33 61.2867 101.748 60.8489C101.344 64.7614 100.804 71.507 100.265 77.5781C87.4528 77.8479 82.1932 79.0622 80.3051 83.2445C78.9564 86.2126 78.8216 95.9263 80.1702 111.981C80.2956 113.224 80.8731 114.378 81.793 115.224C82.7128 116.07 83.911 116.548 85.1601 116.568H85.5647C86.8809 116.443 88.0964 115.809 88.9527 114.801C89.809 113.793 90.2385 112.491 90.1501 111.171C89.3797 103.642 89.0644 96.0733 89.206 88.5061Z\" fill=\"currentColor\" fill-opacity=\"0.61\"/>\n    <path d=\"M111.216 47.9107C116.653 47.9107 121.061 43.5013 121.061 38.062C121.061 32.6228 116.653 28.2134 111.216 28.2134C105.779 28.2134 101.371 32.6228 101.371 38.062C101.371 43.5013 105.779 47.9107 111.216 47.9107Z\" fill=\"currentColor\" fill-opacity=\"0.61\"/>\n    <path d=\"M126.159 51.6748C125.319 51.586 124.477 51.8344 123.82 52.3656C123.162 52.8968 122.743 53.6673 122.653 54.5079L118.876 90.3948H95.9496C95.0912 90.3948 94.2679 90.736 93.6609 91.3432C93.0539 91.9504 92.7129 92.774 92.7129 93.6327C92.7129 94.4915 93.0539 95.3151 93.6609 95.9223C94.2679 96.5295 95.0912 96.8706 95.9496 96.8706H106.469V108.743L99.1863 111.306C98.5451 111.566 98.0238 112.056 97.7245 112.679C97.4251 113.303 97.3693 114.016 97.568 114.679C97.7415 115.187 98.0682 115.628 98.503 115.942C98.9377 116.256 99.4592 116.428 99.9955 116.433C100.272 116.454 100.55 116.408 100.805 116.298L108.896 113.33L116.988 116.298C117.317 116.418 117.666 116.471 118.016 116.455C118.365 116.439 118.708 116.354 119.024 116.204C119.341 116.055 119.624 115.844 119.859 115.584C120.093 115.324 120.273 115.02 120.389 114.689C120.505 114.359 120.554 114.009 120.534 113.66C120.514 113.31 120.425 112.968 120.271 112.654C120.118 112.339 119.904 112.058 119.641 111.827C119.379 111.595 119.073 111.419 118.742 111.306L111.459 108.743V96.8706H121.574C122.367 96.8804 123.137 96.5966 123.734 96.0738C124.331 95.5509 124.715 94.8257 124.81 94.0375L128.991 55.1825C129.08 54.3418 128.832 53.5002 128.301 52.8425C127.77 52.1848 126.999 51.7648 126.159 51.6748Z\" fill=\"currentColor\" fill-opacity=\"0.61\"/>\n    <path d=\"M96.4888 73.8005V69.4833C96.4943 69.3932 96.4806 69.3031 96.4487 69.2187C96.4168 69.1344 96.3673 69.0578 96.3035 68.994C96.2398 68.9302 96.1632 68.8807 96.0789 68.8488C95.9946 68.8168 95.9045 68.8032 95.8145 68.8087H34.0471C33.9571 68.8032 33.867 68.8168 33.7827 68.8488C33.6983 68.8807 33.6218 68.9302 33.558 68.994C33.4943 69.0578 33.4448 69.1344 33.4129 69.2187C33.3809 69.3031 33.3673 69.3932 33.3728 69.4833V73.8005C33.3673 73.8905 33.3809 73.9807 33.4129 74.065C33.4448 74.1494 33.4943 74.2259 33.558 74.2897C33.6218 74.3535 33.6983 74.403 33.7827 74.4349C33.867 74.4669 33.9571 74.4806 34.0471 74.475H56.1647V115.354C56.1592 115.444 56.1728 115.534 56.2048 115.618C56.2367 115.703 56.2862 115.779 56.3499 115.843C56.4137 115.907 56.4902 115.956 56.5745 115.988C56.6589 116.02 56.749 116.034 56.839 116.028H73.0226C73.1126 116.034 73.2027 116.02 73.287 115.988C73.3713 115.956 73.4479 115.907 73.5116 115.843C73.5754 115.779 73.6249 115.703 73.6568 115.618C73.6887 115.534 73.7024 115.444 73.6969 115.354V74.61H95.8145C96.0101 74.5895 96.19 74.4934 96.316 74.3422C96.4419 74.191 96.5039 73.9967 96.4888 73.8005Z\" fill=\"currentColor\" fill-opacity=\"0.61\"/>\n    </g>\n    <defs>\n    <clipPath id=\"clip0\">\n    <rect width=\"128.03\" height=\"116.141\" fill=\"currentColor\" transform=\"translate(0.970703 0.542725)\"/>\n    </clipPath>\n    </defs>\n    </svg>\n    `;\n\n    public readonly pending_svg = `\n    <svg width=\"129\" height=\"117\" viewBox=\"0 0 129 117\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clip-path=\"url(#clip0)\">\n    <path d=\"M32.9412 90.8456H10.1493L6.37317 54.8238C6.34026 54.4031 6.22188 53.9934 6.02528 53.62C5.82868 53.2465 5.558 52.9171 5.22978 52.6519C4.90156 52.3867 4.5227 52.1913 4.11639 52.0776C3.71008 51.9639 3.28486 51.9343 2.86672 51.9907C2.4461 52.0236 2.03661 52.142 1.66331 52.3387C1.29 52.5353 0.960731 52.8061 0.695631 53.1345C0.43053 53.4628 0.235174 53.8418 0.121514 54.2483C0.00785298 54.6547 -0.0217234 55.0801 0.0345939 55.4984L4.21535 94.3534C4.31102 95.1416 4.69432 95.8668 5.29168 96.3896C5.88904 96.9125 6.65838 97.1963 7.45207 97.1865H17.432V109.059L10.0145 111.892C9.68304 112.004 9.37714 112.181 9.11452 112.412C8.8519 112.644 8.63776 112.925 8.48452 113.239C8.33127 113.554 8.24197 113.896 8.22178 114.246C8.20159 114.595 8.25092 114.945 8.3669 115.275C8.48289 115.605 8.66323 115.909 8.89747 116.169C9.13171 116.429 9.4152 116.64 9.73151 116.79C10.0478 116.94 10.3907 117.025 10.7402 117.041C11.0897 117.057 11.439 117.004 11.7677 116.884L19.8595 113.916L27.9513 116.884H28.8953C29.4316 116.879 29.9531 116.707 30.3879 116.393C30.8227 116.079 31.1493 115.638 31.3229 115.13C31.5523 114.468 31.511 113.742 31.2079 113.11C30.9048 112.478 30.3644 111.992 29.7045 111.757L22.4219 109.194V97.3214H32.9412C33.7961 97.3099 34.6127 96.9651 35.2172 96.3603C35.8217 95.7556 36.1664 94.9387 36.1779 94.0835C36.1836 93.6568 36.1037 93.2332 35.943 92.8378C35.7823 92.4424 35.5441 92.0833 35.2425 91.7815C34.9408 91.4797 34.5817 91.2414 34.1865 91.0806C33.7913 90.9199 33.3678 90.84 32.9412 90.8456Z\" fill=\"currentColor\"/>\n    <path d=\"M125.188 51.9907C124.348 51.9019 123.507 52.1503 122.849 52.6816C122.192 53.2128 121.772 53.9833 121.682 54.8239L117.906 90.7107H94.9789C94.1205 90.7107 93.2972 91.0519 92.6902 91.6591C92.0832 92.2663 91.7422 93.0899 91.7422 93.9487C91.7422 94.8074 92.0832 95.631 92.6902 96.2382C93.2972 96.8454 94.1205 97.1866 94.9789 97.1866H105.498V109.059L98.2156 111.622C97.5744 111.882 97.0531 112.371 96.7538 112.995C96.4544 113.619 96.3986 114.332 96.5973 114.995C96.7708 115.503 97.0975 115.944 97.5323 116.258C97.967 116.572 98.4885 116.744 99.0248 116.749C99.3015 116.77 99.5792 116.724 99.834 116.614L107.926 113.646L116.018 116.614C116.346 116.734 116.696 116.787 117.045 116.771C117.395 116.755 117.737 116.67 118.054 116.52C118.37 116.37 118.654 116.16 118.888 115.9C119.122 115.64 119.302 115.336 119.418 115.005C119.534 114.675 119.584 114.325 119.564 113.976C119.543 113.626 119.454 113.284 119.301 112.97C119.148 112.655 118.933 112.374 118.671 112.143C118.408 111.911 118.102 111.734 117.771 111.622L110.488 109.059V97.1866H120.603C121.397 97.1963 122.166 96.9126 122.763 96.3897C123.361 95.8668 123.744 95.1416 123.84 94.3534L128.02 55.4984C128.109 54.6577 127.861 53.8161 127.33 53.1584C126.799 52.5007 126.029 52.0807 125.188 51.9907Z\" fill=\"currentColor\"/>\n    <path d=\"M95.5186 74.1164V69.7992C95.5241 69.7091 95.5104 69.619 95.4785 69.5346C95.4465 69.4503 95.3971 69.3737 95.3333 69.3099C95.2696 69.2462 95.193 69.1967 95.1087 69.1647C95.0244 69.1328 94.9342 69.1191 94.8443 69.1246H33.0769C32.9869 69.1191 32.8968 69.1328 32.8124 69.1647C32.7281 69.1967 32.6516 69.2462 32.5878 69.3099C32.5241 69.3737 32.4746 69.4503 32.4426 69.5346C32.4107 69.619 32.397 69.7091 32.4026 69.7992V74.1164C32.397 74.2064 32.4107 74.2966 32.4426 74.3809C32.4746 74.4653 32.5241 74.5419 32.5878 74.6056C32.6516 74.6694 32.7281 74.7189 32.8124 74.7509C32.8968 74.7828 32.9869 74.7965 33.0769 74.791H55.1945V115.67C55.1889 115.76 55.2026 115.85 55.2345 115.934C55.2665 116.018 55.3159 116.095 55.3797 116.159C55.4435 116.223 55.52 116.272 55.6043 116.304C55.6886 116.336 55.7788 116.35 55.8688 116.344H72.0524C72.1423 116.35 72.2325 116.336 72.3168 116.304C72.4011 116.272 72.4777 116.223 72.5414 116.159C72.6052 116.095 72.6547 116.018 72.6866 115.934C72.7185 115.85 72.7322 115.76 72.7267 115.67V74.9259H94.8443C95.0399 74.9054 95.2198 74.8093 95.3458 74.6581C95.4717 74.507 95.5337 74.3126 95.5186 74.1164Z\" fill=\"currentColor\"/>\n    <path d=\"M41.042 58.875H85.9587L63.5003 20.0834L41.042 58.875ZM65.542 52.75H61.4587V48.6667H65.542V52.75ZM65.542 44.5834H61.4587V36.4167H65.542V44.5834Z\" fill=\"currentColor\"/>\n    </g>\n    <defs>\n    <clipPath id=\"clip0\">\n    <rect width=\"128.03\" height=\"116.141\" fill=\"currentColor\" transform=\"translate(0 0.858643)\"/>\n    </clipPath>\n    </defs>\n    </svg>\n    `;\n\n    constructor(private _state: PanelStateService) {}\n}\n","import { Component } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AsyncHandler, RemoteLoggingService, VERSION } from '@placeos/common';\nimport { PanelStateService } from '../panel-state.service';\n\n@Component({\n    selector: 'panel-view',\n    template: `\n        <button\n            class=\"flex flex-col items-center h-full w-full overflow-hidden\"\n            (click)=\"action()\"\n        >\n            <panel-view-details class=\"flex-1 w-full\"></panel-view-details>\n            <panel-view-status class=\"flex-1 w-full\"></panel-view-status>\n            <div\n                *ngIf=\"show_offline\"\n                class=\"absolute inset-0 bg-contain bg-center bg-no-repeat z-40\"\n                [style.background-color]=\"offline_color\"\n                [style.background-image]=\"\n                    'url(' + offline_image + ')' | safe: 'resource'\n                \"\n            >\n                <div\n                    class=\"absolute top-4 left-4 w-1/2 flex items-center justify-center p-4 text-5xl bg-warning rounded shadow text-white font-medium\"\n                >\n                    {{\n                        name ||\n                            (system | async)?.display_name ||\n                            (system | async)?.name ||\n                            '&lt;Unknown Space&gt;'\n                    }}\n                </div>\n                <div\n                    class=\"absolute bottom-4 right-4 flex items-center flex-col max-w-[25%] text-center\"\n                >\n                    <div class=\"text-8xl\">{{ capacity }}</div>\n                    <div class=\"text-3xl\">\n                        {{ 'PANEL.ROOM_CAPACITY' | translate }}\n                    </div>\n                </div>\n            </div>\n            <div class=\"absolute bottom-0 right-0 p-2\">\n                <div class=\"text-xs opacity-40 w-full\">\n                    <ng-container i18n>Version: </ng-container>\n                    {{ version.hash }}\n                </div>\n                <div class=\"text-xs opacity-40 w-full\">\n                    {{ version.time | date: 'longDate' }}\n                    ({{ version.time | date: 'shortTime' }})\n                </div>\n            </div>\n        </button>\n    `,\n    styles: [``],\n    providers: [PanelStateService],\n})\nexport class PanelViewComponent extends AsyncHandler {\n    public readonly system = this._state.space;\n\n    public get version() {\n        return VERSION;\n    }\n\n    public get name() {\n        return this._state.setting('room_name');\n    }\n\n    public get show_offline() {\n        return (\n            this._state.setting('disable_book_now') &&\n            this._state.setting('offline_image')\n        );\n    }\n\n    public get offline_image() {\n        return (\n            this._state.setting('offline_image') ||\n            this._state.setting('room_image')\n        );\n    }\n\n    public get offline_color() {\n        return this._state.setting('offline_color') || '#FFFFFF';\n    }\n\n    public get capacity() {\n        return this._state.setting('room_capacity');\n    }\n\n    public get can_book() {\n        return this._state.setting('disable_book_now') !== true;\n    }\n\n    public readonly book = () =>\n        this._state.newBooking(\n            Date.now(),\n            this._state.setting('disable_book_now_host') === false\n        );\n    public readonly checkin = () => this._state.checkin();\n    public readonly endMeeting = () => this._state.confirmEnd();\n\n    public action() {\n        this.timeout('action', () => {\n            const status = this._state.setting('status');\n            if (status === 'busy') {\n                if (this._state.setting('enable_end_meeting_button') === true) {\n                    this.endMeeting();\n                }\n            } else if (this.can_book) {\n                status === 'pending' ? this.checkin() : this.book();\n            }\n        });\n    }\n\n    constructor(\n        private _state: PanelStateService,\n        private _route: ActivatedRoute,\n        private _logger: RemoteLoggingService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.system = '';\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((params) => {\n                if (params.has('system_id')) {\n                    this._state.system = params.get('system_id');\n                    this._logger.setMetadata(params.get('system_id'));\n                }\n            })\n        );\n        document.body.parentElement.classList.add('showing-panel');\n    }\n\n    public ngOnDestroy(): void {\n        super.ngOnDestroy();\n        document.body.parentElement.classList.remove('showing-panel');\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { AsyncHandler } from '@placeos/common';\nimport { CalendarEvent } from '@placeos/events';\nimport {\n    addHours,\n    addMinutes,\n    differenceInMinutes,\n    format,\n    roundToNearestMinutes,\n    subHours,\n    subMinutes,\n} from 'date-fns';\n\ninterface TimeBlock {\n    id: number;\n    minutes: number;\n    hour: string;\n}\n\ninterface EventBlock {\n    start: number;\n    length: number;\n}\n\n@Component({\n    selector: 'checkin-timetable',\n    template: `\n        <div class=\"flex items-center relative h-20 px-2\">\n            <button\n                *ngFor=\"let blk of blocks\"\n                class=\"h-full relative\"\n                [style.min-width]=\"1 * step + 'px'\"\n                (click)=\"event.emit(blk.id)\"\n            >\n                <div\n                    *ngIf=\"blk.minutes % 60 === 0\"\n                    class=\"absolute top-1 left-0 text-xs whitespace-nowrap\"\n                >\n                    {{ blk.hour }}\n                </div>\n                <div\n                    *ngIf=\"blk.minutes % 15 === 0\"\n                    class=\"absolute w-px bottom-0 left-0 bg-neutral\"\n                    [style.height]=\"height(blk.minutes)\"\n                ></div>\n            </button>\n            <ng-container *ngFor=\"let blk of event_blocks\">\n                <div\n                    event\n                    *ngIf=\"blk.start + blk.length >= 0 && blk.start < 24 * 60\"\n                    class=\"absolute bottom-0 h-[3.5rem] bg-base-200 opacity-40\"\n                    [style.left]=\"8 + blk.start + 'px'\"\n                    [style.width]=\"blk.length + 'px'\"\n                ></div>\n            </ng-container>\n            <div\n                current\n                class=\"absolute bottom-0 h-[3.5rem] w-0.5 bg-primary pointer-events-none\"\n                [style.left]=\"8 + current_time + 'px'\"\n            >\n                <div\n                    class=\"h-2 w-2 rounded-full bg-primary absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2\"\n                ></div>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            [event] {\n                --color1: #969696;\n                --color2: #424242;\n                background: repeating-linear-gradient(\n                    -45deg,\n                    var(--color1),\n                    var(--color1) 6px,\n                    var(--color2) 6px,\n                    var(--color2) 8px\n                );\n            }\n        `,\n    ],\n})\nexport class CheckinTimetableComponent extends AsyncHandler {\n    @Input() public events: CalendarEvent[] = [];\n    @Input() public step = 15;\n    @Output() public event = new EventEmitter<number>();\n\n    public current_time = 0;\n\n    public blocks: TimeBlock[] = [];\n    public event_blocks: EventBlock[] = [];\n\n    public ngOnInit() {\n        this._generateTimeBlocks();\n        this._updateCurrentTime();\n        this.interval(\n            'gen-blocks',\n            () => this._generateTimeBlocks(),\n            1 * 60 * 1000\n        );\n        this.interval(\n            'update-current',\n            () => this._updateCurrentTime(),\n            30 * 1000\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.events) {\n            this._processEvents();\n        }\n    }\n\n    public height(minutes: number) {\n        switch (minutes) {\n            case 0:\n                return '3.5rem';\n            case 15:\n            case 45:\n                return '1rem';\n            case 30:\n                return '2rem';\n        }\n        return '';\n    }\n\n    private _generateTimeBlocks() {\n        const blocks: TimeBlock[] = [];\n        const start = roundToNearestMinutes(\n            subMinutes(subHours(Date.now(), 1), this.step / 2),\n            {\n                nearestTo: this.step as any,\n            }\n        );\n        let date = start;\n        const end = addHours(start, 24);\n        while (date < end) {\n            blocks.push({\n                id: date.valueOf(),\n                minutes: date.getMinutes(),\n                hour: format(date, 'h a'),\n            });\n            date = addMinutes(date, this.step);\n        }\n        this.blocks = blocks;\n    }\n\n    private _processEvents() {\n        if (!this.blocks.length) return;\n        this.event_blocks = (this.events || []).map((_) => ({\n            start: differenceInMinutes(_.date, this.blocks[0].id),\n            length: _.duration,\n        }));\n    }\n\n    private _updateCurrentTime() {\n        if (!this.blocks.length) return;\n        const time = differenceInMinutes(Date.now(), this.blocks[0].id);\n        this.current_time = time;\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AsyncHandler } from '@placeos/common';\nimport { startOfMinute } from 'date-fns';\nimport { combineLatest } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { currentPeriod, nextPeriod } from '../new-panel/helpers';\nimport { PanelStateService } from '../panel-state.service';\nimport { getNextFreeTimeSlot } from '@placeos/events';\n\n@Component({\n    selector: 'checkin-view',\n    template: `\n        <div class=\"bg-black relative text-white p-4 h-32\">\n            <div\n                class=\"bg-cover bg-center absolute inset-0\"\n                [style.background-image]=\"'url(' + room_image + ')'\"\n            ></div>\n            <div class=\"absolute inset-0 bg-black opacity-50\"></div>\n            <div\n                name\n                class=\"absolute bottom-4 left-4 text-3xl font-medium z-10\"\n            >\n                {{\n                    (system | async)?.display_name ||\n                        (system | async)?.name ||\n                        '&lt;Unknown Space&gt;'\n                }}\n            </div>\n        </div>\n        <h3 class=\"p-4 text-xl font-medium\">\n            {{ 'PANEL.UPCOMING' | translate }}\n        </h3>\n        <div class=\"bg-base-100 divide-y divide-base-200\">\n            <div class=\"flex items-center p-2\">\n                <div\n                    class=\"w-2 h-full min-h-[3rem] rounded\"\n                    [class.bg-error]=\"(state | async) === 'busy'\"\n                    [class.bg-success]=\"(state | async) === 'free'\"\n                    [class.bg-warning]=\"(state | async) === 'pending'\"\n                ></div>\n                <div class=\"text-sm  flex-1 px-2\">\n                    <div class=\"font-medium uppercase\">\n                        {{ 'PANEL.NOW' | translate }}\n                    </div>\n                    <div class=\"\">\n                        <ng-container\n                            *ngIf=\"\n                                (event_state | async)?.current?.length;\n                                else no_current_state\n                            \"\n                        >\n                            <ng-container\n                                *ngIf=\"\n                                    (event_state | async)?.current[0];\n                                    else free_for_state\n                                \"\n                            >\n                                <ng-container\n                                    *ngIf=\"\n                                        (event_state | async)?.current[1] > 0\n                                    \"\n                                >\n                                    {{\n                                        'PANEL.FREE_IN_HOURS_AND_MINUTES'\n                                            | translate\n                                                : {\n                                                      hour: (\n                                                          event_state | async\n                                                      )?.current[1],\n                                                      minute: (\n                                                          event_state | async\n                                                      )?.current[2]\n                                                  }\n                                    }}\n                                </ng-container>\n                                <ng-container\n                                    *ngIf=\"\n                                        (event_state | async)?.current[1] <= 0\n                                    \"\n                                >\n                                    {{\n                                        'PANEL.FREE_IN_MINUTES'\n                                            | translate\n                                                : {\n                                                      minute: (\n                                                          event_state | async\n                                                      )?.current[2]\n                                                  }\n                                    }}\n                                </ng-container>\n                                <ng-container\n                                    *ngIf=\"\n                                        (event_state | async)?.current[1] <=\n                                            0 &&\n                                        (event_state | async)?.current[2] <= 1\n                                    \"\n                                >\n                                    {{\n                                        'PANEL.FREE_IN_LESS_THAN_MINUTE'\n                                            | translate\n                                    }}\n                                </ng-container>\n                            </ng-container>\n                            <ng-template #free_for_state>\n                                <ng-container\n                                    *ngIf=\"(event_state | async)?.current[1]\"\n                                >\n                                    {{\n                                        'PANEL.FREE_FOR_HOURS_AND_MINUTES'\n                                            | translate\n                                                : {\n                                                      hour: (\n                                                          event_state | async\n                                                      )?.current[1],\n                                                      minute: (\n                                                          event_state | async\n                                                      )?.current[2]\n                                                  }\n                                    }}\n                                </ng-container>\n                                <ng-container\n                                    *ngIf=\"!(event_state | async)?.current[1]\"\n                                >\n                                    {{\n                                        'PANEL.FREE_FOR_MINUTES'\n                                            | translate\n                                                : {\n                                                      minute: (\n                                                          event_state | async\n                                                      )?.current[2]\n                                                  }\n                                    }}\n                                </ng-container>\n                                <ng-container\n                                    *ngIf=\"\n                                        !(event_state | async)?.current[1] &&\n                                        (event_state | async)?.current[2] < 1\n                                    \"\n                                >\n                                    {{\n                                        'PANEL.FREE_FOR_LESS_THAN_MINUTE'\n                                            | translate\n                                    }}\n                                </ng-container>\n                            </ng-template>\n                        </ng-container>\n                        <ng-template #no_current_state>\n                            {{ 'PANEL.NO_CURRENT' | translate }}\n                        </ng-template>\n                    </div>\n                </div>\n                <button\n                    btn\n                    matRipple\n                    class=\"w-24\"\n                    *ngIf=\"(state | async) === 'pending'\"\n                    (click)=\"checkInCurrent()\"\n                >\n                    {{ 'PANEL.CHECKIN' | translate }}\n                </button>\n                <button\n                    btn\n                    matRipple\n                    class=\"w-24\"\n                    *ngIf=\"(state | async) === 'free'\"\n                    (click)=\"newBooking()\"\n                >\n                    {{ 'PANEL.BOOK' | translate }}\n                </button>\n            </div>\n            <div class=\"flex items-center p-2\">\n                <div\n                    class=\"w-2 h-full min-h-[3rem] rounded bg-error\"\n                    [class.bg-error]=\"(event_state | async)?.next\"\n                    [class.bg-success]=\"!(event_state | async)?.next\"\n                ></div>\n                <div class=\"text-sm flex-1 px-2\">\n                    <div class=\"font-medium uppercase\">\n                        {{ 'PANEL.NEXT' | translate }}\n                    </div>\n                    <div class=\"\">\n                        {{ (event_state | async)?.next || 'No upcoming event' }}\n                    </div>\n                </div>\n                <button\n                    btn\n                    matRipple\n                    class=\"w-24\"\n                    *ngIf=\"!(event_state | async)?.next\"\n                    (click)=\"newBooking(start, true)\"\n                >\n                    {{ 'PANEL.BOOK' | translate }}\n                </button>\n            </div>\n        </div>\n        <h3 class=\"p-4 text-xl font-medium\">\n            {{ 'PANEL.SCHEDULE' | translate }}\n        </h3>\n        <div class=\"bg-base-100 overflow-auto\">\n            <checkin-timetable\n                [events]=\"bookings | async\"\n                (event)=\"newBooking($event)\"\n            ></checkin-timetable>\n        </div>\n        <h3 class=\"p-4 text-xl font-medium\" *ngIf=\"false\">\n            {{ 'PANEL.FEATURES' | translate }}\n        </h3>\n        <div\n            class=\"bg-base-100 overflow-auto flex-1 h-px divide-y divide-base-200\"\n            *ngIf=\"false\"\n        >\n            <button btn matRipple class=\"flex items-center p-4 w-full\">\n                <div class=\"text-black/40 bg-neutral rounded-full p-2 text-2xl\">\n                    <app-icon>lightbulb</app-icon>\n                </div>\n                <div class=\"flex-1 px-4 font-medium text-left\">\n                    {{ 'PANEL.LIGHTS_BLINDS' | translate }}\n                </div>\n                <app-icon class=\"text-2xl opacity-40\">chevron_right</app-icon>\n            </button>\n            <button btn matRipple class=\"flex items-center p-4 w-full\">\n                <div class=\"text-black/40 bg-neutral rounded-full p-2 text-2xl\">\n                    <app-icon>add_to_queue</app-icon>\n                </div>\n                <div class=\"flex-1 px-4 font-medium text-left\">\n                    {{ 'PANEL.TV' | translate }}\n                </div>\n                <app-icon class=\"text-2xl opacity-40\">chevron_right</app-icon>\n            </button>\n            <button btn matRipple class=\"flex items-center p-4 w-full\">\n                <div class=\"text-black/40 bg-neutral rounded-full p-2 text-2xl\">\n                    <app-icon>restaurant</app-icon>\n                </div>\n                <div class=\"flex-1 px-4 font-medium text-left\">\n                    {{ 'PANEL.CATERING' | translate }}\n                </div>\n                <app-icon class=\"text-2xl opacity-40\">chevron_right</app-icon>\n            </button>\n            <button btn matRipple class=\"flex items-center p-4 w-full\">\n                <div class=\"text-black/40 bg-neutral rounded-full p-2 text-2xl\">\n                    <app-icon>help</app-icon>\n                </div>\n                <div class=\"flex-1 px-4 font-medium text-left\">\n                    {{ 'PANEL.HELP' | translate }}\n                </div>\n                <app-icon class=\"text-2xl opacity-40\">chevron_right</app-icon>\n            </button>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                background-color: #f8f8fa;\n                height: 100%;\n                width: 100%;\n                overflow: hidden;\n            }\n        `,\n    ],\n    providers: [PanelStateService],\n})\nexport class CheckinViewComponent extends AsyncHandler implements OnInit {\n    public readonly state = this._state.status;\n    public readonly system = this._state.space;\n    public readonly bookings = this._state.bookings;\n    public start = Date.now();\n\n    public readonly checkInCurrent = () => this._state.startMeeting();\n    public readonly newBooking = (d = Date.now(), f = false) =>\n        this._state.newBooking(d, this.has_user, f, true);\n\n    public has_user = false;\n\n    public readonly event_state = combineLatest([\n        this._state.current,\n        this._state.next,\n        this._state.bookings,\n    ]).pipe(\n        map(([c, n, l]) => ({\n            current: currentPeriod(l, c, n),\n            next: nextPeriod(n),\n        }))\n    );\n\n    public readonly next_available = this._state.bookings.pipe(\n        map((_) => getNextFreeTimeSlot(_).start)\n    );\n\n    public get time() {\n        return startOfMinute(Date.now());\n    }\n\n    public get room_image() {\n        return this._state.setting('room_image');\n    }\n\n    constructor(\n        private _state: PanelStateService,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.system = '';\n        this.subscription(\n            'next-available',\n            this.next_available.subscribe((_) => (this.start = _))\n        );\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((params) => {\n                if (params.has('system_id')) {\n                    this._state.system = params.get('system_id');\n                }\n            })\n        );\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('user')) {\n                    this.has_user = true;\n                }\n            })\n        );\n    }\n}\n","import { Component } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport { CalendarEvent } from '@placeos/events';\nimport { OrganisationService } from '@placeos/organisation';\nimport {\n    addHours,\n    endOfHour,\n    getUnixTime,\n    startOfHour,\n    startOfMinute,\n} from 'date-fns';\nimport { first, map } from 'rxjs/operators';\nimport { PanelStateService } from './panel-state.service';\nimport { generateQRCode } from 'libs/common/src/lib/qr-code';\n\n@Component({\n    selector: 'event-panel',\n    template: `\n        <div class=\"absolute inset-0 flex flex-col items-center bg-base-100\">\n            <header class=\"w-full flex justify-between items-center p-8\">\n                <h1 class=\"text-3xl font-medium\">{{ space_name | async }}</h1>\n                <div class=\"portrait:hidden flex space-x-4 items-center\">\n                    <p class=\"text-2xl\">\n                        {{ time | date: 'shortTime' }}\n                    </p>\n                    <img\n                        [src]=\"logo?.src | safe: 'resource'\"\n                        [alt]=\"logo?.alt\"\n                        class=\"h-10\"\n                    />\n                </div>\n            </header>\n            <main\n                class=\"w-full flex-1 h-1/2 overflow-hidden p-8 flex bg-cover portrait:flex-col justify-between space-x-8 portrait:space-y-4 portrait:space-x-0 relative\"\n                [style.background-color]=\"background_color | safe\"\n                [style.color]=\"text_color | safe\"\n                [style.background-image]=\"\n                    'url(' + background_image + ')' | safe\n                \"\n            >\n                <div class=\"overflow-hidden\">\n                    <ng-container *ngIf=\"current; else current_empty_state\">\n                        <h2 class=\"text-2xl font-medium\">\n                            {{ current?.title }}\n                        </h2>\n                        <p class=\"text-2xl mb-4 lowercase\">\n                            ending &#64;\n                            {{ current?.event_end * 1000 | date: 'h:mma' }}\n                        </p>\n                        <p class=\"text-base line-clamp-6 portrait:line-clamp-8\">\n                            {{ current?.body }}\n                        </p>\n                    </ng-container>\n                    <ng-template #current_empty_state>\n                        <p class=\"opacity-60 text-2xl font-medium\">\n                            No event currently in progress\n                        </p>\n                    </ng-template>\n                </div>\n                <div class=\"min-w-[40%]\">\n                    <h2 class=\"text-2xl font-medium uppercase\">Next</h2>\n                    <hr class=\"mb-8\" />\n                    <ng-container *ngIf=\"next; else next_empty_state\">\n                        <h2 class=\"text-2xl font-medium\">{{ next?.title }}</h2>\n                        <p class=\"text-2xl lowercase\">\n                            starting &#64;\n                            {{ next?.event_start * 1000 | date: 'h:mma' }}\n                        </p>\n                    </ng-container>\n                    <ng-template #next_empty_state>\n                        <p class=\"opacity-60 text-2xl font-medium\">\n                            No upcoming events\n                        </p>\n                    </ng-template>\n                </div>\n            </main>\n            <footer\n                class=\"w-full landscape:hidden bg-base-100 px-8 py-3 flex justify-between items-center\"\n            >\n                <img\n                    [src]=\"logo?.src | safe: 'resource'\"\n                    [alt]=\"logo?.alt\"\n                    class=\"h-10\"\n                />\n                <p class=\"text-2xl\">\n                    {{ time | date: 'shortTime' }}\n                </p>\n            </footer>\n            <div hidden bindings>\n                <i\n                    binding\n                    [sys]=\"system_id\"\n                    mod=\"Bookings\"\n                    bind=\"current_booking\"\n                    (modelChange)=\"current = asCalendarEvent($event)\"\n                ></i>\n                <i\n                    binding\n                    [sys]=\"system_id\"\n                    mod=\"Bookings\"\n                    bind=\"next_booking\"\n                    (modelChange)=\"next = asCalendarEvent($event)\"\n                ></i>\n            </div>\n            <div\n                class=\"absolute top-1/2 -right-[2px] -translate-y-1/2\"\n                *ngIf=\"!hide_qr && checkin\"\n            >\n                <button\n                    book-tag\n                    matRipple\n                    (click)=\"toggleQRShow()\"\n                    class=\"absolute top-1/2 left-px -translate-y-1/2 -translate-x-full bg-base-100 border-l border-y border-base-300 px-1 py-4 rounded-l-lg z-20 uppercase\"\n                >\n                    Book\n                </button>\n                <div\n                    qr-code-out\n                    class=\"overflow-hidden bg-base-100 shadow border border-base-300 rounded-l-lg z-10\"\n                    [class.w-0]=\"!show_qr\"\n                    [class.w-56]=\"show_qr\"\n                >\n                    <div qr-checkin class=\"w-56 z-50 p-3\">\n                        <img class=\"w-full\" [src]=\"qr_code\" />\n                    </div>\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            [book-tag] {\n                writing-mode: vertical-rl;\n                text-orientation: upright;\n            }\n\n            [qr-code-out] {\n                transition: width 300ms;\n            }\n        `,\n    ],\n})\nexport class EventPanelComponent extends AsyncHandler {\n    public system_id = '';\n    public show_qr = false;\n    public room_name: string | null = '';\n    public current: CalendarEvent | null = null;\n    public next: CalendarEvent | null = null;\n    public qr_code: any;\n    public hide_qr = false;\n    public readonly space_name = this._state.space.pipe(\n        map((_) => _?.display_name || _?.name || ''),\n    );\n\n    public get time() {\n        return startOfMinute(Date.now());\n    }\n\n    public get text_color() {\n        return this._settings.get('app.text_color') || '#FFFFFF';\n    }\n\n    public get background_color() {\n        return this._settings.get('app.background_color') || '#483285';\n    }\n\n    public get background_image() {\n        return this._settings.get('app.background_image');\n    }\n\n    public get logo() {\n        return (\n            this._settings.get('app.logo_light') ||\n            this._settings.get('app.logo')\n        );\n    }\n\n    public get checkin() {\n        return this._state.setting('show_qr_code') !== false;\n    }\n\n    public get custom_qr() {\n        return !!this._state.setting('custom_qr_url');\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _route: ActivatedRoute,\n        private _state: PanelStateService,\n        private _org: OrganisationService,\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((params) => {\n                this.system_id = params.get('system_id') || '';\n                this._state.system = this.system_id;\n            }),\n        );\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                this.hide_qr = !!params.get('hide_qr_code');\n            }),\n        );\n        this.timeout(\n            'size',\n            () =>\n                this._settings.overrideCssVariable(\n                    'font-size',\n                    '3.5vmin',\n                    true,\n                ),\n            1000,\n        );\n        this._state.current.subscribe();\n        this._state.settings.subscribe(({ custom_qr_url, custom_qr_color }) => {\n            if (custom_qr_url) {\n                this.qr_code = generateQRCode(\n                    custom_qr_url,\n                    '#0000',\n                    custom_qr_color || '#000',\n                );\n            } else if (!this.qr_code) {\n                const url = `${location.origin}${location.pathname}#/checkin/${this._state.system}?user=true`;\n                this.qr_code = generateQRCode(\n                    url,\n                    '#0000',\n                    custom_qr_color || '#000',\n                );\n            }\n        });\n    }\n\n    public toggleQRShow() {\n        this.show_qr = !this.show_qr;\n        this.timeout('close', () => (this.show_qr = false), 60 * 1000);\n    }\n\n    public asCalendarEvent(data: any) {\n        return data ? new CalendarEvent(data) : null;\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { BootstrapComponent } from './bootstrap.component';\nimport { BookingPanelComponent } from './panel/panel.component';\nimport { BookingPanelArrayComponent } from './panel-array.component';\nimport { BookingPanelSelectComponent } from './panel-select.component';\nimport { PanelViewComponent } from './new-panel/panel-view.component';\nimport { CheckinViewComponent } from './checkin/checkin-view.component';\nimport { EventPanelComponent } from './event-panel.component';\n\nconst routes: Routes = [\n    { path: 'bootstrap', component: BootstrapComponent },\n    { path: 'panel/:system_id', component: PanelViewComponent },\n    { path: 'checkin/:system_id', component: CheckinViewComponent },\n    { path: 'panel-old/:system_id', component: BookingPanelComponent },\n    { path: 'events/:system_id', component: EventPanelComponent },\n    { path: 'panel-array', component: BookingPanelArrayComponent },\n    { path: 'panel-select', component: BookingPanelSelectComponent },\n    { path: '**', redirectTo: 'bootstrap' },\n];\n\n@NgModule({\n    imports: [RouterModule.forRoot(routes, { useHash: true })],\n    exports: [RouterModule],\n})\nexport class AppRoutingModule {}\n","import { NgModule, Type } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatDialogModule } from '@angular/material/dialog';\n\nimport { ComponentsModule } from '@placeos/components';\nimport { FormFieldsModule } from '@placeos/form-fields';\nimport { EmbeddedControlModalComponent } from './embedded-control-modal.component';\nimport { BookingModalComponent } from './booking-modal.component';\n\nconst OVERLAYS: Type<any>[] = [\n    EmbeddedControlModalComponent,\n    BookingModalComponent,\n];\n\n@NgModule({\n    declarations: [...OVERLAYS],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        ComponentsModule,\n        FormFieldsModule,\n        MatDialogModule,\n    ],\n    exports: [...OVERLAYS],\n})\nexport class SharedOverlaysModule {}\n","import { HashMap, predictableRandomInt } from '@placeos/common';\nimport { addMinutes, differenceInMinutes } from 'date-fns';\n\nexport const MOCK_MENU = [\n    {\n        id: 'item-1',\n        name: 'Coffee',\n        unit_price: 200,\n        category: 'Drinks',\n        tags: ['drink', 'Contains Nuts', 'Contains Dairy'],\n        options: [\n            { id: 'opt-1', name: 'Cappacino', group: 'type' },\n            { id: 'opt-2', name: 'Latte', group: 'type' },\n            { id: 'opt-3', name: '1 Sugar', group: 'sugars', unit_price: 20 },\n            { id: 'opt-4', name: '2 Sugar', group: 'sugars', unit_price: 20 },\n            { id: 'opt-5', name: '3 Sugar', group: 'sugars', unit_price: 20 },\n            { id: 'opt-6', name: '4 Sugar', group: 'sugars', unit_price: 20 },\n        ],\n    },\n    {\n        id: 'item-2',\n        name: 'Soda',\n        unit_price: 160,\n        category: 'Drinks',\n        tags: ['drink'],\n        options: [\n            { id: 'opt-1', name: 'Pepsi', group: 'type' },\n            { id: 'opt-2', name: 'Sunkist', group: 'type' },\n            { id: 'opt-3', name: 'Solo', group: 'type' },\n            { id: 'opt-4', name: 'Dr Pepper', group: 'type' },\n        ],\n    },\n    { id: 'item-3', name: 'Water', unit_price: 100, category: 'Drinks' },\n    {\n        id: 'item-4',\n        name: 'Muffin',\n        unit_price: 160,\n        category: 'Snacks',\n        options: [\n            { id: 'opt-1', name: 'Choc Chip', group: 'type' },\n            { id: 'opt-2', name: 'Banana', group: 'type' },\n            { id: 'opt-3', name: 'Blueberry', group: 'type' },\n        ],\n    },\n    {\n        id: 'item-5',\n        name: 'Cookies',\n        unit_price: 400,\n        category: 'Snacks',\n        options: [\n            { id: 'opt-1', name: 'Choc Chip', group: 'type' },\n            { id: 'opt-2', name: 'Macadamia', group: 'type' },\n            { id: 'opt-3', name: 'Dark Choc', group: 'type' },\n        ],\n    },\n    {\n        id: 'item-6',\n        name: 'Fish & Chips',\n        unit_price: 250,\n        category: 'Simple Meals',\n        options: [\n            {\n                id: 'opt-1',\n                name: 'Tomato Sauce',\n                group: 'sauce',\n                unit_price: 30,\n            },\n            { id: 'opt-2', name: 'BBQ Sauce', group: 'sauce', unit_price: 35 },\n            {\n                id: 'opt-3',\n                name: 'Tartare Sause',\n                group: 'sauce',\n                unit_price: 40,\n            },\n            {\n                id: 'opt-4',\n                name: 'Garlic Aoili Sauce',\n                group: 'sauce',\n                unit_price: 50,\n            },\n        ],\n    },\n    {\n        id: 'item-7',\n        name: 'Sandwich',\n        unit_price: 300,\n        category: 'Simple Meals',\n        options: [\n            { id: 'opt-1', name: 'Ham & Cheese', group: 'type' },\n            { id: 'opt-2', name: 'Chicken', group: 'type' },\n            { id: 'opt-3', name: 'Fairy Bread', group: 'type' },\n        ],\n    },\n];\n\nexport function generateCateringOrder(event: HashMap) {\n    const duration = differenceInMinutes(event.event_start, event.event_end);\n    const mx = predictableRandomInt(MOCK_MENU.length);\n    return {\n        id: `order-${predictableRandomInt(999_999)}`,\n        event_id: event.id,\n        invoice_number: `I${predictableRandomInt(999_999)}`,\n        charge_code: `C${predictableRandomInt(9_999)}`,\n        deliver_at: addMinutes(\n            event.event_start * 1000,\n            predictableRandomInt(Math.floor(duration / 5)) * 5\n        ),\n        notes: predictableRandomInt(9999_9999) % 2 === 0 ? 'Test notes' : '',\n        items: new Array(3).fill(0).map((_, idx) => ({\n            ...MOCK_MENU[(mx * idx) % MOCK_MENU.length],\n            options: [],\n            quantity: predictableRandomInt(10, 1),\n        })),\n    };\n}\n","/** Domain of the organisation */\nexport const DOMAIN = 'place.tech';\n/** Endpoint where the staff API is located */\nexport const API = '/api/staff/v1';\n","import { predictableRandomInt } from '@placeos/common';\nimport { DOMAIN } from './common.mock';\n\nconst PREDEF_USERS = [\n    'Jonathan McFarlane',\n    'Alex Sorafumo',\n    'Jim Doe',\n    'Cristina Boston',\n    'Jeremy West',\n    'Viv Briffa',\n    'Candy Russo',\n    'Jeff Wiz',\n    'Sravani Kotha',\n    'Kim Burgess',\n    'Caspian Baska',\n    'Stephen Von Takach',\n    'Cameron Reeves',\n    'Shane Boseley',\n];\n\nexport const ACTIVE_USER = {\n    id: 'current',\n    name: 'PlaceOS - Demo User',\n    email: 'dev@place.tech',\n    groups: ['deals', 'user'],\n    sys_admin: true,\n};\n\nexport const MOCK_STAFF = PREDEF_USERS.map((name, i) => ({\n    id: `user-${i + 1}`,\n    name: `${name} (PlaceOS)`,\n    email: `${name.split(' ').join('.').toLowerCase()}@${DOMAIN}`,\n})).concat([ACTIVE_USER]);\n\nexport const MOCK_GUESTS = PREDEF_USERS.map((name, i) => ({\n    id: `guest-${i + 1}`,\n    name: `${name} (External)`,\n    email: `${name.split(' ').join('.').toLowerCase()}@guest.${DOMAIN}`,\n    visit_expected: predictableRandomInt(99999) % 2 === 0,\n    extension_data:\n        predictableRandomInt(99999) % 3 === 0\n            ? {\n                  vaccination_proof: {\n                      url: 'https://fonts.gstatic.com/s/i/materialicons/verified/v11/24px.svg',\n                  },\n                  id_data: {\n                      url: 'https://fonts.gstatic.com/s/i/materialicons/fingerprint/v12/24px.svg',\n                  },\n              }\n            : {},\n}));\n","export const MOCK_ORGS = [\n    {\n        created_at: 1587057070,\n        updated_at: 1587692680,\n        name: 'PlaceOS',\n        description: '',\n        tags: ['org'],\n        count: 0,\n        capacity: 0,\n        parent_id: '',\n        triggers: [],\n        id: 'zone-EmWFTjuYExK',\n    },\n];\n\nexport const MOCK_BUILDINGS = [\n    {\n        name: 'Sydney',\n        description: '',\n        tags: ['building'],\n        count: 0,\n        capacity: 0,\n        parent_id: 'zone-EmWFTjuYExK',\n        triggers: [],\n        id: 'bld-01',\n        levels: ['lvl-G', 'lvl-1'],\n    },\n    {\n        name: 'Brisbane',\n        description: '',\n        tags: ['building'],\n        count: 0,\n        capacity: 0,\n        parent_id: 'zone-EmWFTjuYExK',\n        triggers: [],\n        id: 'bld-02',\n        levels: ['lvl-2', 'lvl-3'],\n    },\n];\n\nexport const MOCK_ZONES = [];\n\nconst mockLevel = (\n    id: string,\n    idx: number,\n    building: any,\n    num: string = '10'\n): any => {\n    let map_id = id.substr(4);\n    map_id = `assets/maps/level_${num}.svg`;\n    return {\n        id: `${building.id}_${id}`,\n        name: `Level ${id.endsWith('00') ? 'G' : id.split('-')[1]}`,\n        parent_id: building.id,\n        description: '',\n        tags: ['level'],\n        map_id,\n        code: 'level code 12',\n        type: 'staff floor',\n        count: 5,\n        capacity: 30,\n        location: 'optional lat,long',\n        display_name: '',\n    };\n};\n\nexport const MOCK_LEVELS = MOCK_BUILDINGS.map((bld) =>\n    bld.levels.map((level, idx) =>\n        mockLevel(level, idx, bld, level.split('-')[1])\n    )\n).reduce(\n    (p, c) => p.concat(c),\n    [\n        // {\n        //     id: 'test',\n        //     parent_id: 'bld-01',\n        //     name: 'Test',\n        //     map_id: 'assets/maps/test.svg',\n        // },\n        {\n            id: 'level-p1',\n            parent_id: 'bld-01',\n            name: 'Level P1',\n            tags: ['level', 'parking'],\n            map_id: 'assets/maps/level_P1.svg',\n        },\n    ]\n);\n","import { padString, predictableRandomInt } from '@placeos/common';\nimport { registerMockEndpoint } from '@placeos/ts-client';\nimport { MOCK_MENU } from './catering.data';\nimport { MOCK_STAFF } from './users.data';\nimport {\n    MOCK_ORGS,\n    MOCK_LEVELS,\n    MOCK_BUILDINGS,\n    MOCK_ZONES,\n} from './zone.data';\n\nconst MOCK_METADATA = {\n    current: {\n        contacts: {\n            name: 'contacts',\n            description: '',\n            details: [\n                {\n                    id: 'user-1',\n                    name: 'Jonathan McFarlane (PlaceOS)',\n                    email: 'jon@place.tech',\n                    first_name: 'Jonathan',\n                    last_name: 'McFarlane',\n                },\n                {\n                    id: 'user-1',\n                    name: 'Alex Sorafumo (PlaceOS)',\n                    email: 'alex@place.tech',\n                    first_name: 'Alex',\n                    last_name: 'Sorafumo',\n                },\n            ],\n        },\n    },\n};\n\nexport const PARKING_SPACES = {};\nexport const LOCKERS = {};\n\nexport const ZONE_MOCKS = registerMocks();\n\nfunction registerMocks() {\n    registerMockEndpoint({\n        path: '/api/engine/v2/zones',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            if (request.query_params.tags === 'org') {\n                return MOCK_ORGS;\n            } else if (request.query_params.tags === 'region') {\n                return [];\n            } else if (request.query_params.tags === 'building') {\n                return MOCK_BUILDINGS;\n            } else if (request.query_params.tags === 'level') {\n                return MOCK_LEVELS;\n            } else if (request.query_params.tags) {\n                return MOCK_ZONES.filter((_) =>\n                    _.tags.includes(request.query_params.tags)\n                );\n            }\n            throw { status: 404, message: 'Zones not found' };\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/engine/v2/settings',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => [],\n    });\n\n    registerMockEndpoint({\n        path: '/api/engine/v2/settings/:id',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => ({}),\n    });\n\n    registerMockEndpoint({\n        path: '/api/engine/v2/metadata/:id',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            if (request.query_params.name === 'bindings') {\n                return {\n                    bindings: {\n                        details: {\n                            area_management: 'space-0',\n                            location_services: 'space-0',\n                            contact_tracing: 'space-0',\n                            lockers: 'space-0',\n                            // payments: 'space-0',\n                        },\n                    },\n                };\n            }\n            if (request.query_params.name === 'catering') {\n                return {\n                    catering: {\n                        details: MOCK_MENU,\n                    },\n                };\n            }\n            if (request.query_params.name === 'parking-spaces') {\n                const parts = request.route_params.id.split('-');\n                const id = parts[parts.length - 1];\n                return generateParkingSpaces(id);\n            }\n            if (request.query_params.name === 'lockers') {\n                const parts = request.route_params.id.split('-');\n                const id = parts[parts.length - 1];\n                return generateLockers(id);\n            }\n            if (request.query_params.name === 'desks') {\n                const parts = request.route_params.id.split('-');\n                const id = parts[parts.length - 1];\n                return generateMockDeskMetadata(id);\n            }\n            if (request.query_params.name === 'charge_codes') {\n                const parts = request.route_params.id.split('-');\n                const id = parts[parts.length - 1];\n                return {\n                    charge_codes: {\n                        details: new Array(30)\n                            .fill(0)\n                            .map((_, idx) => `C-${idx}`),\n                    },\n                };\n            }\n            if (request.query_params.name === 'map_regions') {\n                return {\n                    map_regions: {\n                        details: {\n                            areas: [\n                                {\n                                    id: 'zone-10.A',\n                                    properties: {\n                                        capacity: 100,\n                                        label_location: { x: 0.36, y: 0.33 },\n                                        // draw_polygon: true\n                                    },\n                                    geometry: {\n                                        coordinates: [\n                                            [0.0, 0.0],\n                                            [0.0, 0.5],\n                                            [0.5, 0.5],\n                                            [0.5, 0.0],\n                                        ],\n                                    },\n                                },\n                                {\n                                    id: 'zone-10.B',\n                                    properties: {\n                                        capacity: 100,\n                                        label_location: { x: 0.76, y: 0.33 },\n                                    },\n                                },\n                                {\n                                    id: 'zone-10.C',\n                                    properties: {\n                                        capacity: 100,\n                                        label_location: { x: 0.63, y: 0.77 },\n                                    },\n                                },\n                            ],\n                        },\n                    },\n                };\n            }\n            if (\n                MOCK_METADATA[request.route_params.id] &&\n                MOCK_METADATA[request.route_params.id][\n                    request.query_params.name\n                ]\n            ) {\n                return MOCK_METADATA[request.route_params.id];\n            } else if (\n                MOCK_METADATA[request.route_params.id] &&\n                !request.query_params.name\n            ) {\n                return MOCK_METADATA[request.route_params.id] || {};\n            }\n            return {};\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/engine/v2/metadata/:id',\n        metadata: {},\n        method: 'PATCH',\n        callback: (request) => {\n            if (!MOCK_METADATA[request.route_params.id])\n                MOCK_METADATA[request.route_params.id] = {};\n            MOCK_METADATA[request.route_params.id][request.body.name] =\n                request.body;\n            return request.body;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/engine/v2/metadata/:id',\n        metadata: {},\n        method: 'PUT',\n        callback: (request) => {\n            if (!MOCK_METADATA[request.route_params.id])\n                MOCK_METADATA[request.route_params.id] = {};\n            MOCK_METADATA[request.route_params.id][request.body.name] =\n                request.body;\n            return request.body;\n        },\n    });\n\n    const DESK_FEATURES = ['sit_to_stand', 'single_monitor', 'dual_monitor'];\n\n    function generateMockDeskMetadata(id: string) {\n        return {\n            desks: {\n                details: new Array(30).fill(0).map((_, idx) => ({\n                    id: `table-${padString(id, 2)}.${padString(idx + 1, 3)}`,\n                    name: `Desk ${id}.${padString(idx + 1, 3)}`,\n                    bookable: predictableRandomInt(9999) % 4 !== 0,\n                    groups:\n                        predictableRandomInt(9999) % 4 === 0 ? ['test-1'] : [],\n                    features: DESK_FEATURES.filter(\n                        (_) => predictableRandomInt(99999) % 3 === 0\n                    ),\n                })),\n            },\n        };\n    }\n\n    function generateParkingSpaces(id: string) {\n        if (!PARKING_SPACES[id]) {\n            PARKING_SPACES[id] = {\n                'parking-spaces': {\n                    details: new Array(18 * 6).fill(0).map((_, idx) => {\n                        const position = padString(\n                            (idx % 18) + Math.floor(idx / 18) * 100,\n                            3\n                        );\n                        const assignee =\n                            predictableRandomInt(9999) % 4 === 0\n                                ? MOCK_STAFF[\n                                      predictableRandomInt(MOCK_STAFF.length)\n                                  ]\n                                : ({} as any);\n                        return {\n                            id: `park-${position}`,\n                            map_id: `park-${position}`,\n                            name: `${position}`,\n                            bookable: predictableRandomInt(9999) % 4 !== 0,\n                            assigned_to: assignee.email || '',\n                            assigned_name: assignee.name || '',\n                        };\n                    }),\n                },\n            };\n        }\n        return PARKING_SPACES[id];\n    }\n\n    function generateLockers(id: string) {\n        if (!LOCKERS[id]) {\n            LOCKERS[id] = {\n                lockers: {\n                    details: new Array(6).fill(0).map((_, idx) => {\n                        const position = padString(idx + 1, 2);\n                        const assignee =\n                            predictableRandomInt(9999) % 4 === 0\n                                ? MOCK_STAFF[\n                                      predictableRandomInt(MOCK_STAFF.length)\n                                  ]\n                                : ({} as any);\n                        return {\n                            id: `locker-bank-${id}.${position}`,\n                            map_id: `bank-${id}.${position}`,\n                            level_id: `lvl-02`,\n                            name: `Bank ${position}`,\n                            height: 3,\n                            lockers: new Array(18).fill(0).map((_, idx2) => ({\n                                id: `locker-${position}.${padString(\n                                    idx2 + 1,\n                                    3\n                                )}`,\n                                name: `Locker ${idx2 + 1}`,\n                                accessible:\n                                    predictableRandomInt(9999) % 2 !== 0,\n                                bookable: predictableRandomInt(9999) % 4 !== 0,\n                                position: [idx2 % 6, Math.floor(idx2 / 6)],\n                                size: [1, 1],\n                            })),\n                        };\n                    }),\n                },\n            };\n        }\n        return LOCKERS[id];\n    }\n\n    registerMockEndpoint({\n        path: '/api/engine/v2/metadata/:id/children',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            const zone = MOCK_BUILDINGS.find(\n                (_) => _.id === request.route_params.id\n            );\n            if (!zone)\n                throw {\n                    status: 404,\n                    message: `Unable to find zone with id \"${request.route_params.id}\"`,\n                };\n            return MOCK_LEVELS.filter((_) => _.parent_id === zone.id).map(\n                (lvl) => {\n                    const parts = lvl.id.split('-');\n                    const id = parts[parts.length - 1];\n                    return {\n                        zone: lvl,\n                        metadata:\n                            request.query_params.name === 'parking-spaces'\n                                ? generateParkingSpaces(id)\n                                : request.query_params.name === 'lockers'\n                                ? generateLockers(id)\n                                : generateMockDeskMetadata(id),\n                    };\n                }\n            );\n        },\n    });\n}\n","import { predictableRandomInt } from '@placeos/common';\nimport { generateMockSpace } from '@placeos/spaces';\n\nconst randomSpaceFeatures = () => {\n    const f = ['Whiteboard', 'VidConf', 'Projector', 'Views'];\n    const numFeatures = predictableRandomInt(f.length + 1);\n    const res = [];\n    for (let i = 0; i < numFeatures; i++) {\n        res.push(f[predictableRandomInt(f.length)]);\n    }\n    return res.filter((el, i, r) => r.indexOf(el) === i);\n};\n\nexport const MOCK_SPACES = [\n    {\n        name: '1.01 Operations Room',\n        map_id: 'area-1.01-status',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: '1.03 Sydney Boardroom',\n        map_id: 'area-1.03-status',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: '1.04 The Studio',\n        map_id: 'area-1.04-status',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Jam Board',\n        map_id: 'area-1.02-status',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'G.01 Cisco Room',\n        map_id: 'area-G.01-status',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'G.02 The Lab',\n        map_id: 'area-G.02-status',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Conference Room 2.01',\n        map_id: 'area-2.01-status',\n        zones: ['bld-02', 'bld-02_lvl-2', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Conference Room 2.02',\n        map_id: 'area-2.02-status',\n        zones: ['bld-02', 'bld-02_lvl-2', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Conference Room 3.01',\n        map_id: 'area-3.01-status',\n        zones: ['bld-02', 'bld-02_lvl-3', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Conference Room 3.02',\n        map_id: 'area-3.02-status',\n        zones: ['bld-02', 'bld-02_lvl-3', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Conference Room 3.03',\n        map_id: 'area-3.03-status',\n        zones: ['bld-02', 'bld-02_lvl-3', 'zone-EmWFTjuYExK'],\n    },\n    //MapsIndoors mock spaces\n    {\n        name: 'Boardroom 1',\n        map_id: '12beee0d06a1475293aadd9f',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n        level: {\n            id: 'bld-01_lvl-1',\n            parent_id: 'bld-01',\n            name: 'Level 1',\n            display_name: 'Level 1',\n            capacity: 5,\n            number: '',\n            map_id: '12beee0d06a1475293aadd9f',\n            tags: [''],\n            setting: {},\n            images: [''],\n            locations: { id: '', name: '' },\n        },\n    },\n    {\n        name: 'Boardroom 2',\n        map_id: 'dd2dec8c291a4fb7995bff3c',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n        level: {\n            id: 'bld-01_lvl-1',\n            parent_id: 'bld-01',\n            name: 'Level 1',\n            display_name: 'Level 1',\n            capacity: 5,\n            number: '',\n            map_id: 'dd2dec8c291a4fb7995bff3c',\n            tags: [''],\n            setting: {},\n            images: [''],\n            locations: { id: '', name: '' },\n        },\n    },\n    {\n        name: 'Boardroom 3',\n        map_id: '23bc6cf392c842d69abc71bf',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n        level: {\n            id: 'bld-01_lvl-1',\n            parent_id: 'bld-01',\n            name: 'Level 1',\n            display_name: 'Level 1',\n            capacity: 5,\n            number: '',\n            map_id: '23bc6cf392c842d69abc71bf',\n            tags: [''],\n            setting: {},\n            images: [''],\n            locations: { id: '', name: '' },\n        },\n    },\n    {\n        name: 'Boardroom 4',\n        map_id: '696971dbc50a4c66a7f5356a',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n        level: {\n            id: 'bld-01_lvl-1',\n            parent_id: 'bld-01',\n            name: 'Level 1',\n            display_name: 'Level 1',\n            capacity: 5,\n            number: '',\n            map_id: '23bc6cf392c842d69abc71bf',\n            tags: [''],\n            setting: {},\n            images: [''],\n            locations: { id: '', name: '' },\n        },\n    },\n    {\n        name: 'Boardroom 5',\n        map_id: '58cc74c5dd4249148674a191',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n        level: {\n            id: 'bld-01_lvl-1',\n            parent_id: 'bld-01',\n            name: 'Level 1',\n            display_name: 'Level 1',\n            capacity: 5,\n            number: '',\n            map_id: '23bc6cf392c842d69abc71bf',\n            tags: [''],\n            setting: {},\n            images: [''],\n            locations: { id: '', name: '' },\n        },\n    },\n    {\n        name: 'Boardroom 6',\n        map_id: 'a4c02df953f34e5dad26c95f',\n        zones: ['bld-01', 'bld-01_lvl-1', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Boardroom 7',\n        map_id: '23bc6cf392c842d69abc71bf',\n        zones: ['bld-02', 'bld-02_lvl-3', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Boardroom 8',\n        map_id: '21a49f92c5924d2f9b39934b',\n        zones: ['bld-02', 'bld-02_lvl-3', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Boardroom 9',\n        map_id: '0d3f964712ec4d36b9776449',\n        zones: ['bld-02', 'bld-02_lvl-3', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Boardroom 10',\n        map_id: '7c01d7766a38488b8813347c',\n        zones: ['bld-02', 'bld-02_lvl-3', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Boardroom 11',\n        map_id: '9e9efbe702bb4d91a2615c06',\n        zones: ['bld-02', 'bld-02_lvl-3', 'zone-EmWFTjuYExK'],\n    },\n    {\n        name: 'Boardroom 12',\n        map_id: '66161113fff74d8780daeb2e',\n        zones: ['bld-02', 'bld-02_lvl-3', 'zone-EmWFTjuYExK'],\n    },\n].map((d) =>\n    generateMockSpace({\n        ...d,\n        features: randomSpaceFeatures(),\n        images: [\n            'https://webcdn.executivecentre.com/wp-content/uploads/sites/39/2020/10/img-meetingroomrental_hire.jpg',\n        ],\n    }),\n);\n","import { predictableRandomInt, unique } from '@placeos/common';\nimport * as dayjs from 'dayjs';\nimport { generateCateringOrder } from './catering.data';\nimport { MOCK_SPACES } from './spaces.data';\nimport { ACTIVE_USER, MOCK_GUESTS, MOCK_STAFF } from './users.data';\n\nlet EVENT_TIME = dayjs().startOf('d').hour(7);\n\nconst nextEventTime = (save = false): number => {\n    const next = EVENT_TIME.add((predictableRandomInt(8) + 1) * 15, 'm');\n    if (save) {\n        EVENT_TIME = next;\n    }\n    return next.unix();\n};\n\nconst event_status = ['tentative', 'confirmed', 'cancelled'];\nconst randomStatus = (): string => {\n    const rnd = predictableRandomInt(10);\n    return rnd < 2\n        ? event_status[2]\n        : rnd < 5\n        ? event_status[0]\n        : event_status[1];\n};\n\nexport const MOCK_EVENTS = new Array(200).fill(0).map((_, index) => {\n    const PEOPLE = MOCK_STAFF.concat(MOCK_GUESTS);\n    let attendees: any[] = new Array(predictableRandomInt(8, 1))\n        .fill(0)\n        .map(() => PEOPLE[predictableRandomInt(PEOPLE.length)]);\n    attendees.sort(\n        (a, b) => (a.visit_expected ? 0 : -1) - (b.visit_expected ? 0 : -1)\n    );\n    const space = MOCK_SPACES[predictableRandomInt(MOCK_SPACES.length)];\n    attendees = attendees.concat({ ...space, resource: true });\n    if (predictableRandomInt(9999) % 2 === 0) attendees.unshift(ACTIVE_USER);\n    else attendees.unshift(MOCK_STAFF[predictableRandomInt(MOCK_STAFF.length)]);\n    attendees = unique(attendees, 'email') || [{}];\n    const event_start = nextEventTime(true);\n    const event_end = nextEventTime();\n    const meeting_url =\n        predictableRandomInt(9999) % 3 === 0 ? 'https://meet.place.tech' : '';\n    return {\n        id: `cal-event-${index}`,\n        status: randomStatus(),\n        host: attendees[0].email,\n        calendar: 'calendar_id',\n        creator: 'optional@fake.com',\n        attendees: (unique(attendees, 'email') || []).map((_, idx) => ({\n            ..._,\n            organizer: idx === 0,\n            checked_in: predictableRandomInt(99999) % 2 === 0,\n            response_status:\n                predictableRandomInt(99999) % 2 === 0\n                    ? 'accepted'\n                    : predictableRandomInt(99999) % 6 === 0\n                    ? 'declined'\n                    : 'tentative',\n        })),\n        title: `Some Meeting ${index}`,\n        body: `A Description`,\n        private: false,\n        event_start,\n        event_end,\n        timezone: 'Australia/Sydney',\n        all_day: false,\n        location: `${space?.name}`,\n        recurring: false,\n        recurrence: {},\n        attachments: {},\n        system: space,\n        meeting_url,\n        meeting_id: meeting_url ? `m${predictableRandomInt(9999)}` : '',\n        meeting_provider: meeting_url ? 'PlaceOS' : '',\n        extension_data: {\n            catering:\n                predictableRandomInt(99999) % 4 === 0\n                    ? [\n                          generateCateringOrder({\n                              id: `cal-event-${index}`,\n                              event_start,\n                              event_end,\n                          }),\n                      ]\n                    : [],\n            setup: predictableRandomInt(4) * 5,\n            breakdown: predictableRandomInt(4) * 5,\n        },\n    };\n});\n\nconst event_spaces = {};\nMOCK_EVENTS.forEach((event) => {\n    if (!event_spaces[event.system?.id]) {\n        event_spaces[event.system?.id] = [];\n    }\n    event_spaces[event.system?.id].push(event);\n});\n","import { registerMockEndpoint } from '@placeos/ts-client';\n\nimport { HashMap, predictableRandomInt } from '@placeos/common';\nimport { ACTIVE_USER, MOCK_GUESTS, MOCK_STAFF } from './users.data';\nimport { MOCK_LEVELS } from './zone.data';\nimport { MOCK_SPACES } from './spaces.data';\n\nimport { MOCK_EVENTS } from './events.data';\nimport { getUnixTime, subMinutes } from 'date-fns';\n\nexport const USER_MOCKS = registerMocks();\n\nfunction registerMocks() {\n    registerMockEndpoint({\n        path: '/api/engine/v2/users/:id',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            if (request.route_params.id === 'current') {\n                return ACTIVE_USER;\n            }\n            const person = MOCK_STAFF.find(\n                (user) => user.email === request.route_params.id\n            );\n            if (person) {\n                return person;\n            }\n            throw { status: 404, message: 'User not found' };\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/people',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            if (request.query_params.q) {\n                const search = request.query_params.q.toLowerCase();\n                return MOCK_STAFF.filter(({ name, email }) => {\n                    return (\n                        name.toLowerCase().includes(search) ||\n                        email.toLowerCase().includes(search)\n                    );\n                });\n            }\n            return MOCK_STAFF;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/people/:id',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            const id = decodeURIComponent(request.route_params.id);\n            const person = MOCK_STAFF.find((user) => user.email === id);\n            if (person) {\n                return {\n                    ...person,\n                    location: generateLocation(),\n                };\n            }\n            throw { status: 404, message: 'User not found' };\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/guests',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            if (request.query_params.q) {\n                const search = request.query_params.q.toLowerCase();\n                return MOCK_GUESTS.filter(\n                    (user) =>\n                        user.name.toLowerCase().includes(search) ||\n                        user.email.toLowerCase().includes(search)\n                );\n            }\n            return MOCK_STAFF;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/guests/:email',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            const email = decodeURIComponent(request.route_params.email);\n            const person = MOCK_GUESTS.find((user) => user.email === email);\n            if (person) return person;\n            throw { status: 404, message: 'Guest not found' };\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/guests/:email/meetings',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            if (request.route_params.email) {\n                const email = request.route_params.email.toLowerCase();\n                const events = MOCK_EVENTS.filter((event) =>\n                    event.attendees.find(\n                        (user) => user.email.toLowerCase() === email\n                    )\n                );\n                return events;\n            }\n            throw {\n                status: 404,\n                message: `Unable to find meetings with guest with email ${request.route_params.email}`,\n            };\n        },\n    });\n\n    const LOCATION_TYPES = [\n        'meeting',\n        'desk_id',\n        'laptop',\n        'mobile',\n        'geo',\n        'none',\n    ];\n\n    function generateLocation() {\n        const type =\n            LOCATION_TYPES[predictableRandomInt(LOCATION_TYPES.length)];\n        const level = MOCK_LEVELS[predictableRandomInt(MOCK_LEVELS.length)];\n        const level_spaces = MOCK_SPACES.filter((s) =>\n            s.zones.includes(level.id)\n        );\n        const space =\n            level_spaces[predictableRandomInt(level_spaces.length)] || {};\n        const location: HashMap = {};\n        switch (type) {\n            case 'meeting':\n                location.meeting = {\n                    building: level.parent_id,\n                    level: level.id,\n                    system: space.id,\n                    map_id: space.map_id,\n                    event_id: '',\n                };\n                break;\n            case 'desk_id':\n                location.meeting = {\n                    building: level.parent_id,\n                    level: level.id,\n                    map_id: space.map_id,\n                    checked_in: getUnixTime(Date.now()),\n                };\n                break;\n            case 'laptop':\n            case 'mobile':\n                location[type] = {\n                    building: level.parent_id,\n                    level: level.id,\n                    x: +predictableRandomInt(10000),\n                    y: +predictableRandomInt(5000),\n                    last_seen: getUnixTime(\n                        subMinutes(Date.now(), predictableRandomInt(60))\n                    ),\n                };\n                break;\n            case 'geo':\n                location.geo = {\n                    lat: predictableRandomInt(180) - 90,\n                    lon: predictableRandomInt(360) - 180,\n                    last_seen: getUnixTime(\n                        subMinutes(Date.now(), predictableRandomInt(60))\n                    ),\n                };\n                break;\n        }\n        return location;\n    }\n}\n","import { HashMap, unique } from '@placeos/common';\n\nexport interface EnvironmentSource {\n    id?: string;\n    name: string;\n    type?: 'lights' | 'blinds' | 'screen';\n    state: string | number;\n    states: string[];\n}\n\nexport interface RoomInput {\n    id?: string;\n    ref: string;\n    name: string;\n    type: string;\n    mod: string;\n    mute: boolean;\n    locked: boolean;\n    routes: string[];\n    outputs: string[];\n}\n\nexport interface RoomOutput {\n    id?: string;\n    ref: string;\n    name: string;\n    type: string;\n    mod: string;\n    mute: boolean;\n    locked: boolean;\n    source: string;\n    inputs: string[];\n    following: string;\n}\n\nclass RoomModule {\n    public readonly name: string;\n    public readonly connected: boolean;\n    public active: boolean;\n\n    public readonly input_list: HashMap<RoomInput>;\n    public readonly output_list: HashMap<RoomOutput>;\n    public readonly env_sources: EnvironmentSource[];\n\n    public readonly inputs;\n    public readonly outputs;\n    public readonly available_outputs;\n    public readonly environment;\n\n    public readonly help = {\n        help: {\n            title: 'Help',\n            content: `\n# Using the asset browser\n\n## Activating the menu\nThe 5 finger touch can be actvated by placing 4 fingers and your thumb on the screen, or quickly double-tapping the screen. Activation through double tap will leave the menu on-screen. To close tap the X.\n\n## Selecting a menu item\nLeaving at least one finger on the screen, drag your finger to the icon to select.\n\n## Home Menu\nThe home menu allows you to access files and navigate to content and presentations via the Launcher.\n\n## Connect and stream your laptop or access the CMS to add files\nPlug your laptop into the HDMI to stream it to the screen, or access the CMS to add your own content and create custom presentations.\n\n<video></video>\n\n1. Test1\n2. Test2\n3. Test3\n            `,\n        },\n        'laptop-help': {\n            icon: 'web_asset',\n            title: 'Asset Browser',\n            content: `# Test 2`,\n        },\n    };\n\n    public tabs = [\n        {\n            icon: 'laptop',\n            name: 'Laptop',\n            type: 'Laptop',\n        },\n        {\n            icon: 'call',\n            name: 'VC',\n            inputs: ['VidConf_1'],\n            help: 'vidconf-help',\n            controls: 'vidconf-controls',\n        },\n    ];\n\n    public volume = 0;\n\n    constructor(_data: Partial<RoomModule>) {\n        this.name = _data.name || 'Test Module';\n        this.connected = _data.connected ?? true;\n        this.active = _data.active || false;\n        this.input_list = _data.input_list;\n        this.output_list = _data.output_list;\n        this.env_sources = _data.env_sources || [];\n        this.inputs = Object.keys(this.input_list || {}) || [];\n        this.outputs = Object.keys(this.output_list || {}) || [];\n        this.available_outputs = this.outputs;\n        const types = unique(this.env_sources.map((_) => _.type)) || [];\n        types.forEach(\n            (t) =>\n                (this[`${t}`] = this.env_sources\n                    .filter((_) => _.type === t)\n                    .map((_) => _.id))\n        );\n        this.env_sources.forEach(\n            (source) => (this[`${source.type}/${source.id}`] = source)\n        );\n        this.inputs.forEach(\n            (key) => (this[`input/${key}`] = this.input_list[key])\n        );\n        this.outputs.forEach(\n            (key) => (this[`output/${key}`] = this.output_list[key])\n        );\n    }\n\n    $power(state = true) {\n        this.active = state;\n    }\n    /** Shares a signal source with the room and any connected remote participants. */\n    $share() {}\n    /**\n     * Connect a signal source to a signal output, or set of outputs. Any intermediate\n     * device interactions are handled internally. For example, on a system using a small\n     * presentation switcher and a display, routing a laptop input will select the\n     * appropriate input on the switcher, and select the appropriate input on the display.\n     *\n     * This includes all routable signal types - in addition to the above example, this may\n     * be interacting with an audio DSP to add a microphone feed to an output zone, or\n     * connecting a USB HID input device with a specific output.\n     **/\n    $route(input: string, output: string) {\n        if (this.inputs.includes(input) && this.outputs.includes(output)) {\n            this.$updateState(input, {\n                routes: unique([\n                    ...(this.input_list[input].routes || []),\n                    output,\n                ]),\n            });\n            this.$updateState(output, {\n                source: input,\n                following: input,\n            });\n        }\n    }\n    /**\n     * Remove a signal source from a signal output.\n     * Predominantly intended for outputs that support more than one simultaneous input source\n     * (mixed audio zone, or display capable of compositing multiple video sources).\n     **/\n    $unroute() {}\n    /**\n     * Establish a call (either phone or video) with a remote participant.\n     * This may be a peer-to-peer connection or a wider group via an external bridging service.\n     **/\n    $connect() {}\n    /** End a call with a remote participant. */\n    $disconnect() {}\n    /**\n     * Bind the current system to another PlaceOS controlled space, relinquishing local control.\n     * This may be used for an education pod that pairs with a wider classroom or a room being\n     * used as an overflow from a primary event space.\n     **/\n    $link() {}\n    /**\n     * Join the current system with another PlaceOS controlled space, sharing control and signal IO.\n     * Examples of usage would be a set of rooms with moveable walls. N-way merges supported.\n     **/\n    $merge() {}\n    /** Separate from a linked or merged system. */\n    $split() {}\n    /**\n     * Display an alert visible to participants in the space. This may occur as a screen overlay,\n     * on a control interface, a bot post in a chat space associated with the current meeting or\n     * other modalities depending on hardware capability.\n     **/\n    $notify() {}\n    /**\n     * Place the room into a predefined operation mode. This may include executing an arbitrary\n     * set of device interactions, changing metadata associated with the system itself (changing\n     * available input or output nodes), or other configurable actions designed to transition\n     * the space to a specific state.\n     **/\n    $preset() {}\n    /**\n     * Set the volume for a signal node in the space. This can include outputs as well as inputs\n     * where supported (e.g. microphone). If unspecified, default is to interact with a primary\n     * output node.\n     **/\n    $volume(value: number, source: string = 'all') {\n        if (source === 'all') {\n            this.volume = value;\n        }\n    }\n    /** Interact with audio muting on supporting signal nodes within the space. */\n    $mute(state: boolean = true, source: string = 'all') {\n        this.$updateState(source, { mute: state });\n    }\n    /**\n     * Activates or deactivates a signal mute for the associated IO. If this is not possible,\n     * (e.g. unsupported by the device) an error is returned.\n     **/\n    $unmute(source: string = 'all') {\n        this.$mute(false, source);\n    }\n    /**\n     * Wrapper for an arbitrary set of control points defined in system configuration.\n     * Each of these may map to control options available on a sibling module and take one of two forms:\n     *  - Continuous value within a range (temperature set point 16.0...28.0 degrees, lighting level 0...100)\n     *  - Set of possible states (lighting high/med/low, blind up/down, electrochromic glass clear/opaque)\n     *\n     * System state provides the ability to introspect configured points for both control limits and current value.\n     **/\n    $environment(id: string, state: string | number) {\n        const source = this.env_sources.find((_) => _.id === id);\n        if (source) {\n            this[`${source.type}/${source.id}`] = { ...source, state };\n        }\n    }\n    /** Locks an IO node. Prevents any route changes that include this until unlocked. */\n    $lock(source: string) {\n        this.$updateState(source, { locked: true });\n    }\n    /** Unlocks an IO node. */\n    $unlock(source: string) {\n        this.$updateState(source, { locked: false });\n    }\n\n    $updateState(source: string, data: HashMap) {\n        if (this[`input/${source}`]) {\n            this[`input/${source}`] = { ...this[`input/${source}`], ...data };\n            this.input_list[source] = { ...this[`input/${source}`], ...data };\n        } else if (this[`output/${source}`]) {\n            this[`output/${source}`] = { ...this[`output/${source}`], ...data };\n            this.output_list[source] = { ...this[`output/${source}`], ...data };\n        }\n    }\n}\n\nconst input_list: HashMap = {\n    Mic1: {\n        name: 'Lectern Mic',\n        type: 'Microphone',\n        mod: 'Microphone_1',\n    },\n    Mic2: {\n        name: 'Lapel Mic',\n        type: 'Microphone',\n        mod: 'Microphone_2',\n    },\n    Mic3: {\n        name: 'Handheld Mic',\n        type: 'Microphone',\n        mod: 'Microphone_3',\n    },\n    PC1: {\n        name: 'PC-1',\n        type: 'PC',\n    },\n    PC2: {\n        name: 'PC-2',\n        type: 'PC',\n    },\n    PC3: {\n        name: 'PC-3',\n        type: 'PC',\n    },\n    PC4: {\n        name: 'PC-4',\n        type: 'PC',\n    },\n    HDMI: {\n        name: 'Laptop HDMI',\n        type: 'Laptop',\n    },\n    VGA: {\n        name: 'Laptop VGA',\n        type: 'Laptop',\n    },\n    Camera1: {\n        name: 'Camera Rear',\n        type: 'Camera',\n        mod: 'Camera_1',\n    },\n    Camera2: {\n        name: 'Camera Front',\n        type: 'Camera',\n        mod: 'Camera_2',\n    },\n    Camera3: {\n        name: 'Camera Rear 2',\n        type: 'Camera',\n        mod: 'Camera_3',\n    },\n    Camera4: {\n        name: 'Camera Front 2',\n        type: 'Camera',\n        mod: 'Camera_4',\n    },\n    TV1: {\n        name: 'IPTV 1',\n        type: 'TV',\n        mod: 'IPTV_1',\n    },\n    VC1: {\n        name: 'Video Conference 1',\n        type: 'VC',\n        mod: 'VidConf_1',\n    },\n};\n\nconst output_list: HashMap = {\n    Display1: {\n        name: 'Screen 1',\n        type: 'Display',\n        source: 'PC1',\n        mod: 'Display_1',\n    },\n    Display2: {\n        name: 'Screen 2',\n        type: 'Display',\n        mod: 'Display_2',\n    },\n    Display5: {\n        name: 'TV 1',\n        type: 'Display',\n        mod: 'Display_5',\n        source: 'TV1',\n    },\n};\n\nconst env_sources: any[] = [\n    {\n        id: 'light1',\n        name: 'Lighting',\n        type: 'lights',\n        states: ['Off', 'Presentation', 'Meeting', 'Full'],\n        state: 'Off',\n    },\n    {\n        id: 'blind1',\n        name: 'Blinds',\n        type: 'blinds',\n        states: ['Off', 'Presentation', 'Meeting'],\n        state: 'Off',\n    },\n    {\n        id: 'screen1',\n        name: 'Screen',\n        type: 'screen',\n        states: ['Up', 'Down'],\n        state: 'Down',\n    },\n];\n\nexport const createSystemModule = (space: HashMap, overrides: HashMap = {}) =>\n    new RoomModule({\n        ...space,\n        input_list,\n        output_list,\n        env_sources,\n        ...overrides,\n    });\n","import { addSeconds, format, isBefore, subSeconds } from 'date-fns';\n\nimport { HashMap, timePeriodsIntersect } from '@placeos/common';\nimport { MOCK_EVENTS } from '../api/events.data';\n\nexport class MockBookingModule {\n    /** Timezone the associated space resided */\n    time_zone = 'Australia/Sydney';\n    /** Whether booking is disabled */\n    disable_book_now = false;\n    /** Whether ending current meeting is disabled */\n    disable_end_meeting = false;\n    /** List of current and upcoming bookings for space */\n    bookings: HashMap[] = [];\n    pending_period = 0;\n    pending_before = 0;\n    /** Control UI associated with the space */\n    control_ui = '';\n    /** Catering UI associated with the space */\n    catering_ui = '';\n    /** Time of the last booking started by a user */\n    last_booking_started = 0;\n    current_booking = null;\n    next_booking = null;\n    /** Current status of the space */\n    room_image = 'assets/boardroom.jpg'\n    status = 'free';\n    _space = null;\n\n    constructor(space, _data: Partial<MockBookingModule>) { this._space = space }\n\n    /** Start the meeting at the given time */\n    $start_meeting(t: number) {\n        this.last_booking_started = t;\n    }\n    /** End the meeting at the given time */\n    $end_meeting(t: number) {}\n    /** Book meeting for the current time */\n    $book_now(len: number, t?: string, o?: string) {}\n\n    $poll_bookings() {\n        updateBookings(this._space, this);\n    }\n}\n\nexport const createBookingsModule = (\n    space: HashMap,\n    overrides: Partial<MockBookingModule> = {}\n) => new MockBookingModule(space, overrides);\n\nfunction updateBookings(space: HashMap, mod: HashMap) {\n    const bookings =\n        MOCK_EVENTS.filter((event) =>\n            event.attendees?.find(\n                (u) =>\n                    u.email === space.email ||\n                    u.id === space.id ||\n                    event.system?.id === space.id\n            )\n        ) || [];\n    bookings.sort((a, b) => a.event_start - b.event_start);\n    mod.bookings = bookings;\n    mod.current_booking = bookings.find((_) =>\n        timePeriodsIntersect(\n            Date.now(),\n            Date.now(),\n            _.event_start * 1000,\n            _.event_end * 1000\n        )\n    );\n    mod.next_booking = bookings.find((_) => _.event_start * 1000 > Date.now());\n    const date = new Date();\n    const { current_booking, next_booking } = mod;\n    const start = new Date((current_booking || next_booking)?.event_start);\n    const pending = timePeriodsIntersect(\n        date.valueOf(),\n        date.valueOf(),\n        subSeconds(start, mod.pending_before).valueOf(),\n        addSeconds(start, mod.pending_period).valueOf()\n    );\n    mod.status = space?.bookable\n        ? current_booking\n            ? 'busy'\n            : pending\n            ? 'pending'\n            : 'free'\n        : 'not-bookable';\n}\n","import { Md5 } from 'ts-md5';\nimport { HashMap, predictableRandomInt, randomInt } from '@placeos/common';\nimport { MOCK_LEVELS } from '../api/zone.data';\nimport { MOCK_STAFF } from '../api/users.data';\n\nexport interface ZoneOverview {\n    /** Desk count based on `desks` metadata in the zone\n     falls back to the zone.count field otherwise */\n    desk_count: number;\n\n    desk_usage: number;\n    /** Capacity of the space, set in zone.capacity field */\n    device_capacity: number;\n    /** Raw device count */\n    device_count: number;\n    /** This is the adjusted count based on the duplication factor */\n    estimated_people: number;\n\n    percentage_use: number;\n    /** The higher the recommendation number the better for recommending */\n    recommendation: number;\n}\n\nexport class MockAreaManagementModule implements HashMap {\n    /** Overview of the zones */\n    overview: HashMap<ZoneOverview> = {};\n\n    emergency_contacts = {\n        'First Aid': MOCK_STAFF.filter(\n            (_) => predictableRandomInt(9999) % 5 === 0\n        ),\n        'Fire Warden': MOCK_STAFF.filter(\n            (_) => predictableRandomInt(9999) % 5 === 0\n        ),\n    };\n\n    $locate_user(email: string, username: string) {}\n\n    $update() {\n        updateLocations(this, MOCK_LEVELS);\n    }\n}\n\nconst MAC_LOOKUP = {};\n\nexport class MockLocationServicesModule implements HashMap {\n    $check_ownership_of(mac_address: string) {\n        if (!MAC_LOOKUP[mac_address]) {\n            const staff =\n                randomInt(999_999) % 3 === 0\n                    ? MOCK_STAFF[randomInt(MOCK_STAFF.length)]\n                    : { name: '' };\n            MAC_LOOKUP[mac_address] = { assigned_to: staff.name };\n        }\n        return MAC_LOOKUP[mac_address];\n    }\n\n    $locate_user(email: string, username: string) {\n        return [{\n            type: 'wireless',\n            position: { x: 0.5, y: 0.5 },\n            level: MOCK_LEVELS[randomInt(MOCK_LEVELS.length)].id,\n            priority: 0\n        }]\n    }\n}\n\nfunction padZero(no: number, len: number = 3) {\n    let str = `${no}`;\n    while (str.length < len) {\n        str = '0' + str;\n    }\n    return str;\n}\n\nexport function createAreaManagementModule(\n    space: HashMap,\n    overrides: HashMap = {}\n) {\n    const mod = new MockAreaManagementModule();\n    for (const lvl of MOCK_LEVELS) {\n        mod.overview[lvl.id] = {\n            desk_count: 100,\n            desk_usage: 0,\n            device_capacity: 100,\n            device_count: 0,\n            estimated_people: 0,\n            percentage_use: 0,\n            recommendation: 10000,\n        };\n        mod[`${lvl.id}:desk_ids`] = new Array(mod.overview[lvl.id].desk_count)\n            .fill(0)\n            .map((_, idx) => `table-${lvl.number}.${padZero(idx)}`);\n        mod[`${lvl.id}`] = { value: [] };\n        mod[`${lvl.id}:areas`] = {\n            value: [\n                {\n                    area_id: 'zone-10.B',\n                    count: randomInt(100),\n                    name: '.L1 IFS IT',\n                },\n                {\n                    area_id: 'zone-10.A',\n                    count: randomInt(100),\n                    name: '.L1 IFS IT',\n                },\n                {\n                    area_id: 'zone-10.C',\n                    count: randomInt(50),\n                    name: '.L1 IFS IT',\n                },\n                {\n                    area_id: 'zone-02.D',\n                    count: randomInt(100),\n                    name: 'Quite Work',\n                },\n                {\n                    area_id: 'zone-02.B',\n                    count: randomInt(100),\n                    name: 'Meeting Area A',\n                },\n                {\n                    area_id: 'zone-02.A',\n                    count: randomInt(100),\n                    name: 'Meeting Area B',\n                },\n                {\n                    area_id: 'zone-02.C',\n                    count: randomInt(50),\n                    name: 'Casual Work',\n                },\n            ],\n        };\n    }\n    return mod;\n}\n\nexport function updateLocations(\n    mod: MockAreaManagementModule,\n    levels: HashMap[]\n) {\n    for (const lvl of levels) {\n        mod[lvl.id] = {\n            value: new Array(predictableRandomInt(20))\n                .fill(0)\n                .map(() => generateLocation(lvl, mod[`${lvl.id}:desk_ids`])),\n        };\n        for (const area of mod[`${lvl.id}:areas`].value) {\n            area.count = randomInt(100);\n        }\n        mod[`${lvl.id}:areas`] = { ...mod[`${lvl.id}:areas`] };\n    }\n}\n\nexport function generateLocation(\n    lvl: HashMap,\n    desks: string[],\n    users = MOCK_STAFF\n) {\n    const fixed = predictableRandomInt(9999) % 3 === 0;\n    const usr = (users || [])[predictableRandomInt((users || [])?.length)]?.email;\n    return fixed\n        ? {\n              location: 'desk',\n              at_location: predictableRandomInt(9999) % 2 !== 0,\n              map_id: desks[predictableRandomInt(desks.length)],\n              mac: Md5?.hashStr(usr || ''),\n              level: lvl.id,\n              building: lvl.parent_id,\n          }\n        : {\n              location: 'wireless',\n              coordinates_from: 'bottom-left',\n              x: predictableRandomInt(1000) / 10,\n              y: predictableRandomInt(1000) / 10,\n              lon: 55.27476066828535,\n              lat: 25.20106100633537,\n              s2_cell_id: '3e5f4281459c',\n              mac: Md5?.hashStr(usr || ''),\n              variance: 9.62534032222287,\n              last_seen: Math.floor(new Date().valueOf() / 1000),\n              map_width: 100,\n              map_height: 100,\n          };\n}\n","import { HashMap } from '@placeos/common';\n\nexport enum CameraTilt {\n    Down,\n    Up,\n    Stop,\n}\n\nexport enum CameraPan {\n    Left,\n    Right,\n    Stop,\n}\n\nclass CameraModule {\n    pan: number;\n    tilt: number;\n    zoom: number;\n\n    pan_speed: number;\n    tilt_speed: number;\n    zoom_speed: number;\n\n    presets: string[];\n\n    constructor(_) {\n        this.presets = ['Preset One', 'Preset 2', 'Preset Three'];\n    }\n\n    $pan(dir: CameraPan) {}\n\n    $tilt(tilt: CameraTilt) {}\n\n    $recall(name: string) {}\n\n    $save_preset(name: string) {}\n}\n\nexport const createCameraModule = (space: HashMap, overrides: HashMap = {}) =>\n    new CameraModule({ ...space, ...overrides });\n","import { HashMap, randomInt } from '@placeos/common';\n\nclass DisplayModule {\n    mute: boolean;\n    volume: number;\n\n    $mute(state: boolean = true) {\n        this.mute = state;\n    }\n\n    $volume(value: number) {\n        this.volume = value;\n    }\n\n    constructor(_) {\n        this.volume = randomInt(100);\n    }\n}\n\nexport const createDisplayModule = (space: HashMap, overrides: HashMap = {}) =>\n    new DisplayModule({ ...space, ...overrides });\n","import { HashMap, randomInt } from '@placeos/common';\n\nclass MicrophoneModule {\n    mute: boolean;\n    volume: number;\n\n    $mute(state: boolean = true) {\n        this.mute = state;\n    }\n\n    $volume(value: number) {\n        this.volume = value;\n    }\n\n    constructor(_) {\n        this.volume = randomInt(100);\n    }\n}\n\nexport const createMicrophoneModule = (\n    space: HashMap,\n    overrides: HashMap = {}\n) => new MicrophoneModule({ ...space, ...overrides });\n","import { HashMap, randomInt } from \"@placeos/common\";\n\nlet interval;\n\nexport class CaptureModule {\n\n    status: 'playing' | 'stopped' | 'paused' = 'stopped';\n    title: string;\n    live: boolean = false;\n    remaining: number;\n    current: number;\n    next: number;\n\n    constructor(_) {\n        this.remaining = randomInt(24 * 60 * 60);\n    }\n\n    $start() {\n        this.status = 'playing';\n        interval = setInterval(() => {\n            if (this.remaining < 1) clearInterval(interval);\n            this.remaining = this.remaining - 1;\n            this.current = this.current + 1;\n        }, 3000);\n    }\n\n    $pause() {\n        this.status = 'paused';\n        clearInterval(interval);\n    }\n\n    $resume() {\n        this.$start();\n    }\n\n    $stop() {\n        this.status = 'stopped';\n        this.current = 0;\n        clearInterval(interval);\n    }\n\n}\n\nexport const createCaptureModule = (space: HashMap, overrides: HashMap = {}) =>\n    new CaptureModule({ ...space, ...overrides });\n","import { HashMap } from '@placeos/common';\n\nclass MeetingPushModule {\n    public supported_meeting_url = 'https://meet.';\n\n    constructor(data: any) {}\n\n    $econtrol(...args: any[]) {}\n}\n\nexport const createMeetingPushModule = (\n    details?: HashMap,\n    overrides: HashMap = {}\n) =>\n    new MeetingPushModule({\n        ...details,\n        ...overrides,\n    });\n","import { HashMap } from '@placeos/common';\n\nexport type VideoLayout = 'Auto' | 'Equal' | 'Overlay' | 'Prominent' | 'Single';\nexport type CallStatus =\n    | 'Idle'\n    | 'Dialling'\n    | 'Ringing'\n    | 'Connecting'\n    | 'Connected'\n    | 'Disconnecting'\n    | 'OnHold'\n    | 'EarlyMedia'\n    | 'Preserved'\n    | 'RemotePreserved';\n\nexport interface VideoCallDetails {\n    AnswerState: string;\n    CallType: string;\n    CallbackNumber: string;\n    DeviceType: string;\n    Direction: string;\n    DisplayName: number;\n    Duration: number;\n    'Encryption/Type': string;\n    FacilityServiceId: number;\n    HoldReason: string;\n    PlacedOnHold: boolean;\n    Protocol: string;\n    ReceiveCallRate: number;\n    RemoteNumber: string;\n    Status: CallStatus;\n    TransmitCallRate: number;\n    Ice: string;\n}\n\nclass VideoConferenceModule {\n    mic_mute: boolean = false;\n    selfview: boolean = false;\n    video_layout: VideoLayout = 'Auto';\n    presentation_mode: 'None' | 'Local' | 'Remote' = 'None';\n    presentation: false | 'Sending';\n    calls: Record<string, VideoCallDetails> = {\n        test: {\n            Status: 'Connected',\n        },\n    } as any;\n\n    $show_camera_pip(visible: boolean) {\n        this.selfview = visible;\n    }\n\n    $mic_mute(visible: boolean) {\n        this.mic_mute = visible;\n    }\n    $presentation_mode(state: 'None' | 'Local' | 'Remote') {\n        this.presentation_mode = state;\n    }\n    $hangup() {}\n    $call_place_on_hold() {\n        for (const key in this.calls) {\n            if (this.calls[key].Status) {\n                this.calls[key].Status = 'OnHold';\n                this.calls = { ...this.calls };\n                return;\n            }\n        }\n    }\n    $call_resume() {\n        for (const key in this.calls) {\n            if (this.calls[key].Status) {\n                this.calls[key].Status = 'Idle';\n                this.calls = { ...this.calls };\n                return;\n            }\n        }\n    }\n    $video_layout(layout: VideoLayout) {\n        this.video_layout = layout;\n    }\n    $dtmf_send(digit: string) {}\n    $dial(dial_number: string) {\n        return new Promise<void>((r) => setTimeout(() => r(), 1000));\n    }\n\n    constructor(_) {}\n}\n\nexport const createVideoConferenceModule = (\n    space: HashMap = {},\n    overrides: HashMap = {}\n) => new VideoConferenceModule({ ...space, ...overrides });\n","import {\n    HashMap,\n    randomInt,\n    randomString,\n    timePeriodsIntersect,\n} from '@placeos/common';\nimport { addDays, getUnixTime, isBefore, setHours } from 'date-fns';\nimport { MOCK_STAFF } from '../api/users.data';\n\nconst CONTACT_EVENTS = {};\n\nconst filterFn = (start, end) => (itm) => {\n    return timePeriodsIntersect(start, end, itm.contact_time, itm.contact_time);\n};\n\nclass ContactTracingModule {\n    constructor(_) {}\n\n    $close_contacts(email: string, user: string, start: number, end: number) {\n        if (!CONTACT_EVENTS[email]) CONTACT_EVENTS[email] = [];\n        if (CONTACT_EVENTS[email].length)\n            return CONTACT_EVENTS[email].filter(filterFn(start, end));\n        const events = [];\n        const beginning = addDays(start * 1000, -10);\n        const ending = addDays(end * 1000, 10);\n        let date = new Date(beginning);\n        while (isBefore(date, ending)) {\n            new Array(randomInt(4))\n                .fill(0)\n                .map((_) => ({\n                    mac_address: randomString(10),\n                    contact_time: getUnixTime(\n                        setHours(date, randomInt(11) + 7)\n                    ),\n                    duration: randomInt(60) * 60,\n                    username: MOCK_STAFF[randomInt(MOCK_STAFF.length)].email,\n                }))\n                .forEach((e) => events.push(e));\n            date = addDays(date, 1);\n        }\n        CONTACT_EVENTS[email] = events;\n        return CONTACT_EVENTS[email].filter(filterFn(start, end));\n    }\n}\n\nexport const createContactTracingModule = (\n    space: HashMap,\n    overrides: HashMap = {}\n) => new ContactTracingModule({ ...space, ...overrides });\n","import { HashMap, randomInt, randomString } from '@placeos/common';\n\nclass PaymentsModule {\n    \n    $list_payment_methods(type: string) {\n        \n    }\n\n    $add_payment_method(type: string, details: any) {\n\n    }\n\n    $get_product_prices(id: string, period) {\n        return [12000, 60];\n    }\n\n    $create_payment_intent(amount: number, source: string) {\n        return randomString(12);\n    }\n\n    $confirm_payment_intent(id: string) {\n\n    }\n\n    $cancel_payment_intent(id: string) {\n    }\n\n    $create_customer(...args: any) {\n        return `stripe-${randomInt(9_999_999, 1_000_000)}`;\n    }\n\n    constructor(_) {}\n}\n\nexport const createPaymentsModule = (space: HashMap, overrides: HashMap = {}) =>\n    new PaymentsModule({ ...space, ...overrides });\n","import { HashMap } from '@placeos/common';\n\nclass LockerLocationsModule {\n    constructor(data: any) {}\n\n    $lockers_allocated_to_me(...args: any[]) {\n        return [\n            {\n                location: 'locker',\n                bank_id: '977cb758-4e42-4292-848a-4821f2fb4d74',\n                locker_id: 'adda7802-dfd7-467c-b369-d73394ad7084',\n                locker_name: '0.105',\n                allocated: true,\n                group_id: '6c246e35-4a73-475a-8725-0676d78167f4',\n            },\n        ];\n    }\n}\n\nexport const createLockerLocationsModule = (\n    details?: HashMap,\n    overrides: HashMap = {}\n) =>\n    new LockerLocationsModule({\n        ...details,\n        ...overrides,\n    });\n","import { registerMockEndpoint } from '@placeos/ts-client';\n\nimport { createSystem } from '../systems-bindings.mock';\nimport { MOCK_SPACES } from './spaces.data';\n\nexport const SYSTEM_MOCKS = registerMocks();\n\nfunction registerMocks() {\n    MOCK_SPACES.forEach((space: any, index) => createSystem(space));\n\n    registerMockEndpoint({\n        path: '/api/engine/v2/systems',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            return request.query_params?.zone_id\n                ? MOCK_SPACES.filter((_) =>\n                      _.zones.includes(request.query_params.zone_id)\n                  )\n                : MOCK_SPACES;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/engine/v2/systems/:id',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            const space = MOCK_SPACES.find(_ => _.id === request.route_params.id);\n            if (!space) throw { status: 404 };\n            return space;\n        },\n    });\n}\n","import { mockSystem, registerSystem } from '@placeos/ts-client';\nimport { HashMap } from '@placeos/common';\n\nimport { createSystemModule } from './realtime/control';\nimport { createBookingsModule } from './realtime/events';\nimport {\n    createAreaManagementModule,\n    MockLocationServicesModule,\n} from './realtime/desks';\nimport { createCameraModule } from './realtime/camera';\nimport { createDisplayModule } from './realtime/display';\nimport { createMicrophoneModule } from './realtime/microphone';\nimport { createCaptureModule } from './realtime/capture';\nimport { createMeetingPushModule } from './realtime/meeting';\nimport { createVideoConferenceModule } from './realtime/video-conference';\nimport { createContactTracingModule } from './realtime/contact-tracing';\nimport { createPaymentsModule } from './realtime/payments';\nimport { createLockerLocationsModule } from './realtime/locker-locations';\n\nexport function createSystem(space: HashMap) {\n    registerSystem(space.id, {\n        System: [createSystemModule(space)],\n        Bookings: [createBookingsModule(space)],\n        ContactTracing: [createContactTracingModule(space)],\n        AreaManagement: [createAreaManagementModule(space)],\n        LocationServices: [new MockLocationServicesModule()],\n        Camera: new Array(10).fill(0).map((_) => createCameraModule(space)),\n        Display: new Array(10).fill(0).map((_) => createDisplayModule(space)),\n        Microphone: new Array(10)\n            .fill(0)\n            .map((_) => createMicrophoneModule(space)),\n        Capture: [createCaptureModule(space)],\n        MeetingPush: [createMeetingPushModule()],\n        VidConf: [createVideoConferenceModule()],\n        Payment: [createPaymentsModule(space)],\n        LockerLocations: [createLockerLocationsModule()],\n    });\n\n    const system = mockSystem(space.id);\n\n    system.Bookings[0].$poll_bookings();\n    setInterval(() => system.Bookings[0].$poll_bookings(), 30 * 1000);\n\n    system.AreaManagement[0].$update();\n    setInterval(() => system.AreaManagement[0].$update(), 30 * 1000);\n}\n","import { predictableRandomInt, timePeriodsIntersect } from '@placeos/common';\nimport { mockSystem, registerMockEndpoint } from '@placeos/ts-client';\nimport { MOCK_EVENTS } from './events.data';\nimport { ACTIVE_USER, MOCK_STAFF } from './users.data';\n\nexport const EVENT_MOCKS = registerMocks();\n\nfunction registerMocks() {\n    registerMockEndpoint({\n        path: '/api/staff/v1/events',\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            let events = MOCK_EVENTS;\n            if (!_.query_params.zone_ids) {\n                events = events.filter(\n                    (event) =>\n                        !!event.attendees.find(\n                            (user) => user.email === ACTIVE_USER.email\n                        )\n                );\n            }\n            if (_.query_params.period_start) {\n                events = events.filter((e) =>\n                    timePeriodsIntersect(\n                        +_.query_params.period_start,\n                        +_.query_params.period_end,\n                        e.event_start,\n                        e.event_end\n                    )\n                );\n            }\n            return events;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/events',\n        metadata: {},\n        method: 'POST',\n        callback: (request) => {\n            const new_event = {\n                ...request.body,\n                id: `-cal-event-${predictableRandomInt(999)}`,\n            };\n            new_event.attendees = [\n                MOCK_STAFF.find((_) => _.email === new_event.host),\n                ...(new_event.attendees || []),\n            ];\n            new_event.attendees.forEach((user) => {\n                if (user.zones) user.resource = true;\n            });\n\n            if (new_event.system) {\n                new_event.attendees = [\n                    ...(new_event.attendees || []),\n                    { ...new_event.system, resource: true },\n                ];\n            }\n            MOCK_EVENTS.push(new_event);\n\n            const system = mockSystem(new_event.system?.id);\n            system?.Bookings[0]?.$poll_bookings();\n            return new_event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/events/:id',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            const item = MOCK_EVENTS.find(\n                (event) => event.id === request.route_params.id\n            );\n            if (item) {\n                return item;\n            }\n            throw { status: 404, message: 'Event not found' };\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/events/:id',\n        metadata: {},\n        method: 'DELETE',\n        callback: (request) => {\n            const index = MOCK_EVENTS.findIndex(\n                (event) => event.id === request.route_params.id\n            );\n            if (index > 0) {\n                if (MOCK_EVENTS[index].host === ACTIVE_USER.email) {\n                    MOCK_EVENTS.splice(index, 1);\n                } else {\n                    const user = MOCK_EVENTS[index].attendees.find(\n                        (_) => _.email === ACTIVE_USER.email\n                    );\n                    user.response_status = 'declined';\n                }\n                return;\n            }\n            throw { status: 404, message: 'Event not found' };\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/events/:id',\n        metadata: {},\n        method: 'PATCH',\n        callback: (request) => {\n            const index = MOCK_EVENTS.findIndex(\n                (event) => event.id === request.route_params.id\n            );\n            if (index >= 0) {\n                return MOCK_EVENTS.splice(index, 1, request.body);\n            }\n            throw { status: 404, message: 'Event not found' };\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/events/:id/guests/:email/checkin',\n        metadata: {},\n        method: 'POST',\n        callback: (request) => {\n            const event = MOCK_EVENTS.find(\n                (event) => event.id === request.route_params.id\n            );\n            if (event) {\n                const checked_in =\n                    (event.extension_data as any).checked_in || [];\n                (event.extension_data as any).checked_in = checked_in.concat([\n                    request.route_params.email,\n                ]);\n                return event;\n            }\n            throw { status: 404, message: 'Guest not found' };\n        },\n    });\n}\n","import { registerMockEndpoint } from '@placeos/ts-client';\n\nimport { MOCK_EVENTS } from './events.data';\nimport { MOCK_SPACES } from './spaces.data';\n\nimport { predictableRandomInt, timePeriodsIntersect } from '@placeos/common';\nimport { ACTIVE_USER, MOCK_STAFF } from './users.data';\n\nexport const CALENDAR_MOCKS = registerMocks();\n\nfunction registerMocks() {\n    registerMockEndpoint({\n        path: '/api/staff/v1/calendars',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            const user = MOCK_STAFF[predictableRandomInt(MOCK_STAFF.length)];\n            const user2 = MOCK_STAFF[predictableRandomInt(MOCK_STAFF.length)];\n            const user3 = MOCK_STAFF[predictableRandomInt(MOCK_STAFF.length)];\n            return [\n                {\n                    id: ACTIVE_USER.email,\n                    summary: ACTIVE_USER.name,\n                    primary: true,\n                    can_edit: true,\n                    hidden: false,\n                },\n                {\n                    id: user.email,\n                    summary: user.name,\n                    primary: false,\n                    can_edit: true,\n                    hidden: false,\n                },\n                {\n                    id: user2.email,\n                    summary: user2.name,\n                    primary: false,\n                    can_edit: false,\n                    hidden: false,\n                },\n                {\n                    id: user3.email,\n                    summary: user3.name,\n                    primary: false,\n                    can_edit: false,\n                    hidden: true,\n                },\n            ];\n        },\n    });\n\n    const handleSpaceAvailability = (request) => {\n        const start = +request.query_params.period_start;\n        const end = +request.query_params.period_end;\n        const zones = (request.query_params.zone_ids || '')\n            .split(',')\n            .filter((i) => !!i);\n        const systems = (request.query_params.system_ids || '')\n            .split(',')\n            .filter((i) => !!i);\n\n        const spaces = MOCK_SPACES.filter((space) =>\n            zones.length\n                ? zones.reduce(\n                      (has, zone) => has && space.zones.includes(zone),\n                      true\n                  )\n                : systems.length\n                ? systems.includes(space.id)\n                : true\n        ).filter((space) => {\n            const bookings = MOCK_EVENTS.filter((event) =>\n                event.attendees.find((user) => user.id === space.id)\n            );\n            for (const event of bookings) {\n                if (\n                    timePeriodsIntersect(\n                        start,\n                        end,\n                        event.event_start,\n                        event.event_end\n                    )\n                )\n                    return false;\n            }\n            return true;\n        });\n        return spaces;\n    };\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/calendars/availability',\n        metadata: {},\n        method: 'GET',\n        callback: (request) =>\n            handleSpaceAvailability(request).map((_) => ({\n                resource: _,\n            })),\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/calendars/free_busy',\n        metadata: {},\n        method: 'GET',\n        callback: (request) =>\n            handleSpaceAvailability(request).map((_) => ({\n                resource: _,\n            })),\n    });\n}\n","import { getUnixTime } from 'date-fns';\nimport { Asset } from 'libs/assets/src/lib/asset.class';\n\nexport const MOCK_CATEGORIES = [\n    { id: '1', name: 'Technology' },\n    { id: '2', name: 'Furniture' },\n    { id: '3', name: 'Stationary' },\n    { id: '4', name: 'Other' },\n];\n\nexport const MOCK_PRODUCTS = [\n    { id: '1', name: 'iPad', category_id: '1', brand: 'Apple', barcode: '123' },\n    {\n        id: '2',\n        name: 'iPhone',\n        category_id: '1',\n        brand: 'Apple',\n        barcode: '456',\n        images: [],\n    },\n    {\n        id: '3',\n        name: 'iWatch',\n        category_id: '1',\n        brand: 'Apple',\n        barcode: '789',\n    },\n    {\n        id: '4',\n        name: 'Chair',\n        category_id: '2',\n        brand: 'Herman Miller',\n        barcode: '101',\n    },\n    {\n        id: '5',\n        name: 'Lounge',\n        category_id: '2',\n        brand: 'Ikea',\n        barcode: '102',\n    },\n    { id: '6', name: 'Table', category_id: '2', brand: 'Ikea', barcode: '103' },\n    { id: '7', name: 'Couch', category_id: '2', brand: 'Ikea', barcode: '104' },\n    {\n        id: '8',\n        name: 'Test Item',\n        category_id: '4',\n        brand: 'Test Brand',\n        barcode: '105',\n    },\n    {\n        id: '9',\n        name: 'Notepad',\n        category_id: '3',\n        brand: 'J.Burrows',\n        barcode: '106',\n    },\n    {\n        id: '10',\n        name: 'Whiteboard Markers',\n        category_id: '3',\n        brand: 'Artline',\n        barcode: '107',\n    },\n    {\n        id: '11',\n        name: 'Whiteboard',\n        category_id: '2',\n        brand: 'Ikea',\n        barcode: '108',\n    },\n];\n\nexport const MOCK_ASSETS: Partial<Asset>[] = Array(100)\n    .fill(null)\n    .map((_, i) => ({\n        id: `asset-${i}`,\n        name: `Asset ${i}`,\n        type_id: MOCK_PRODUCTS[i % MOCK_PRODUCTS.length].id,\n        description: `This is asset ${i}`,\n        model_number: `Model ${i}`,\n        serial_number: `Serial ${i}`,\n        identifier: `Identifier ${i}`,\n        other_data: {},\n        purchase_order_id: `purchase-order-${i}`,\n    }));\n\nexport const MOCK_PURCHASE_ORDERS = Array(100)\n    .fill(null)\n    .map((_, i) => ({\n        id: `purchase-order-${i}`,\n        order_number: `Order ${i}`,\n        invoice_number: `Invoice ${i}`,\n        purchase_date: getUnixTime(Date.now()),\n        expected_service_start_date: getUnixTime(Date.now()),\n        expected_service_end_date: getUnixTime(Date.now() + 1000000000),\n    }));\n","import {\n    capitalizeFirstLetter,\n    padString,\n    predictableRandomInt,\n    randomString,\n} from '@placeos/common';\nimport { addMinutes, getUnixTime, set, subDays } from 'date-fns';\nimport { MOCK_ASSETS } from './assets.data';\nimport { MOCK_SPACES } from './spaces.data';\n\nimport { MOCK_GUESTS, MOCK_STAFF } from './users.data';\nimport { MOCK_BUILDINGS, MOCK_LEVELS } from './zone.data';\nimport { PARKING_SPACES } from './zones.mock';\n\nlet EVENT_TIME = set(subDays(Date.now(), 3), {\n    hours: 7,\n    minutes: 0,\n    seconds: 0,\n    milliseconds: 0,\n});\n\nconst nextEventTime = (save = false): number => {\n    const next = addMinutes(EVENT_TIME, (predictableRandomInt(8) + 1) * 15);\n    if (save) EVENT_TIME = addMinutes(next, 60);\n    return getUnixTime(next);\n};\n\nconst TYPES = [\n    'desk',\n    'parking',\n    'asset-request',\n    'visitor',\n    'locker',\n    'group-event',\n];\nconst TRACKING = ['in_storage', 'in_transit', 'at_location'];\n\nexport const MOCK_BOOKINGS = new Array(300).fill(0).map((_, index) => {\n    const throw_away = predictableRandomInt(999999) % 3 === 0;\n    const user =\n        MOCK_STAFF[predictableRandomInt(MOCK_STAFF.length)] || ({} as any);\n    const type = TYPES[predictableRandomInt(TYPES.length)];\n    const bld = MOCK_BUILDINGS[predictableRandomInt(MOCK_BUILDINGS.length)];\n    const lvls = MOCK_LEVELS.filter((_) => _.parent_id === bld?.id);\n    const lvl = lvls[predictableRandomInt(lvls.length)];\n    const lvl_spaces =\n        MOCK_SPACES.filter((_) => _.zones.includes(lvl?.id)) || [];\n    const approved = predictableRandomInt(999999) % 4;\n    const approver = MOCK_STAFF[predictableRandomInt(MOCK_STAFF.length)];\n    const guest = MOCK_GUESTS[predictableRandomInt(MOCK_GUESTS.length)];\n    const asset_count = predictableRandomInt(3, 1);\n    const position = padString(\n        (index % 18) + 1 + Math.floor(index / 18) * 100,\n        3\n    );\n    return {\n        id: `booking-${index}`,\n        booking_start: nextEventTime(true),\n        booking_end: nextEventTime(),\n        user_id: user.id,\n        user_name: user.name,\n        user_email: user.email,\n        booked_by_name: user.name,\n        booked_by_email: user.email,\n        asset_id:\n            type === 'visitor'\n                ? guest.email\n                : type === 'parking'\n                ? `park-${position}`\n                : `desk-${lvl?.id}-${index}`,\n        asset_name:\n            type === 'visitor'\n                ? guest.name\n                : type === 'parking'\n                ? position\n                : `${lvl?.id}-${index}`,\n        description:\n            type === 'visitor'\n                ? guest.name\n                : type === 'parking'\n                ? position\n                : `Desk ${index}`,\n        title: `${capitalizeFirstLetter(type)} Booking ${index}`,\n        type,\n        booking_type: type,\n        attendees: [],\n        checked_in: predictableRandomInt(999999) % 3 === 0,\n        access: predictableRandomInt(999999) % 3 === 0,\n        approved: approved === 0,\n        rejected: approved === 1,\n        permission: type === 'group-event' ? 'OPEN' : 'PRIVATE',\n        approver_id: approved === 0 ? approver.id : '',\n        approver_name: approved === 0 ? approver.name : '',\n        approver_email: approved === 0 ? approver.email : '',\n        zones: [bld?.id, type === 'parking' ? 'level-p1' : lvl?.id],\n        extension_data: {\n            map_id: `table-10.00${index}`,\n            plate_number: randomString(\n                8,\n                'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'\n            ),\n            assets: new Array(asset_count).fill(0).map((_) => ({\n                ...MOCK_ASSETS[predictableRandomInt(asset_count)],\n                amount: predictableRandomInt(5, 1),\n            })),\n            tracking:\n                approved === 0\n                    ? TRACKING[predictableRandomInt(TRACKING.length)]\n                    : 'in_storage',\n            space_id: lvl_spaces[predictableRandomInt(lvl_spaces.length)]?.id,\n        },\n    };\n});\n","import { predictableRandomInt, timePeriodsIntersect } from '@placeos/common';\nimport { registerMockEndpoint } from '@placeos/ts-client';\n\nimport { MOCK_BOOKINGS } from './bookings.data';\n\nexport const BOOKING_MOCKS = registerMocks();\n\nfunction registerMocks() {\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings',\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const events = MOCK_BOOKINGS.filter(\n                (event) =>\n                    timePeriodsIntersect(\n                        +_.query_params.period_start,\n                        +_.query_params.period_end,\n                        event.booking_start,\n                        event.booking_end\n                    ) &&\n                    (event.type === _.query_params.type ||\n                        event.booking_type === _.query_params.type)\n            );\n            return events;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id',\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const event = MOCK_BOOKINGS.find((e) => e.id === _.route_params.id);\n            if (!event)\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${_.route_params.id}`,\n                };\n            return event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id/attendee',\n        metadata: {},\n        method: 'POST',\n        callback: (_) => {\n            const event = MOCK_BOOKINGS.find((e) => e.id === _.route_params.id);\n            if (!event) {\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${_.route_params.id}`,\n                };\n            }\n            const user = {\n                id: _.body.id,\n                name: _.body.name,\n                email: _.body.email,\n                checked_in: false,\n            };\n            event.attendees.push(user);\n            return user;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id/guests/:email/check_in',\n        metadata: {},\n        method: 'POST',\n        callback: (_) => {\n            const { id, email } = _.route_params;\n            const event = MOCK_BOOKINGS.find((e) => e.id === id);\n            if (!event) {\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${id}`,\n                };\n            }\n            const guest = event.attendees.find(\n                (_) => _.email === decodeURIComponent(email)\n            );\n            if (!guest) {\n                throw {\n                    status: 404,\n                    message: `Unable to find guest with email ${email}`,\n                };\n            }\n            guest.checked_in = _.query_params.state === 'true';\n            return guest;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id/attendee/:email',\n        metadata: {},\n        method: 'DELETE',\n        callback: (_) => {\n            const { id, email } = _.route_params;\n            const event = MOCK_BOOKINGS.find((e) => e.id === id);\n            if (!event) {\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${id}`,\n                };\n            }\n            event.attendees = event.attendees.filter(\n                (_) => _.email !== decodeURIComponent(email)\n            );\n            return event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings',\n        metadata: {},\n        method: 'POST',\n        callback: (request) => {\n            const new_event = {\n                ...request.body,\n                id: `-booking-${predictableRandomInt(999)}`,\n            };\n            MOCK_BOOKINGS.push(new_event);\n            return new_event;\n        },\n    });\n\n    const updateBooking = (id, data) => {\n        const index = MOCK_BOOKINGS.findIndex((e) => e.id === id);\n        if (index < 0)\n            throw {\n                status: 404,\n                message: `Unable to find booking with ID ${id}`,\n            };\n        const new_event = { ...data };\n        MOCK_BOOKINGS.splice(index, 1, new_event);\n        return new_event;\n    };\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id',\n        metadata: {},\n        method: 'PUT',\n        callback: (req) => updateBooking(req.route_params.id, { ...req.body }),\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id',\n        metadata: {},\n        method: 'PATCH',\n        callback: (req) => updateBooking(req.route_params.id, { ...req.body }),\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id/approve',\n        metadata: {},\n        method: 'POST',\n        callback: (req) =>\n            updateBooking(req.route_params.id, {\n                ...req.body,\n                approved: true,\n                rejected: false,\n            }),\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id/reject',\n        metadata: {},\n        method: 'POST',\n        callback: (req) =>\n            updateBooking(req.route_params.id, {\n                ...req.body,\n                approved: false,\n                rejected: true,\n            }),\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id/check_in',\n        metadata: {},\n        method: 'POST',\n        callback: (req) =>\n            updateBooking(req.route_params.id, {\n                ...req.body,\n                checked_in: req.query_params.state === 'true',\n            }),\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/bookings/:id',\n        metadata: {},\n        method: 'DELETE',\n        callback: (req) => {\n            const index = MOCK_BOOKINGS.findIndex(\n                (e) => e.id === req.route_params.id\n            );\n            if (index < 0)\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${req.route_params.id}`,\n                };\n            MOCK_BOOKINGS.splice(index, 1);\n            return;\n        },\n    });\n}\n","import { predictableRandomInt } from '@placeos/common';\nimport { registerMockEndpoint } from '@placeos/ts-client';\nimport {\n    MOCK_ASSETS,\n    MOCK_CATEGORIES,\n    MOCK_PRODUCTS,\n    MOCK_PURCHASE_ORDERS,\n} from './assets.data';\n\nconst BASE_PATH = '/api/engine/v2';\n\nexport const ASSET_MOCKS = registerMocks();\n\nconst update = (dataset) => (id, data) => {\n    const index = dataset.findIndex((e) => e.id === id);\n    if (index < 0)\n        throw {\n            status: 404,\n            message: `Unable to find booking with ID ${id}`,\n        };\n    const new_event = { ...data };\n    dataset.splice(index, 1, new_event);\n    return new_event;\n};\n\nfunction registerMocks() {\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_categories`,\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const events = MOCK_CATEGORIES;\n            return events;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_categories/:id`,\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const event = MOCK_CATEGORIES.find(\n                (e) => e.id === _.route_params.id\n            );\n            if (!event)\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${_.route_params.id}`,\n                };\n            return event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_categories`,\n        metadata: {},\n        method: 'POST',\n        callback: (request) => {\n            const new_event = {\n                ...request.body,\n                id: `-category-${predictableRandomInt(999)}`,\n            };\n            MOCK_CATEGORIES.push(new_event);\n            return new_event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_categories/:id`,\n        metadata: {},\n        method: 'PUT',\n        callback: (req) =>\n            update(MOCK_CATEGORIES)(req.route_params.id, { ...req.body }),\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_categories/:id`,\n        metadata: {},\n        method: 'DELETE',\n        callback: (req) => {\n            const index = MOCK_CATEGORIES.findIndex(\n                (e) => e.id === req.route_params.id\n            );\n            if (index < 0)\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${req.route_params.id}`,\n                };\n            MOCK_CATEGORIES.splice(index, 1);\n            return;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_types`,\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const events = MOCK_PRODUCTS;\n            return events;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_types/:id`,\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const event = MOCK_PRODUCTS.find((e) => e.id === _.route_params.id);\n            if (!event)\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${_.route_params.id}`,\n                };\n            return event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_types`,\n        metadata: {},\n        method: 'POST',\n        callback: (request) => {\n            const new_event = {\n                ...request.body,\n                id: `-product-${predictableRandomInt(999)}`,\n            };\n            MOCK_PRODUCTS.push(new_event);\n            return new_event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_types/:id`,\n        metadata: {},\n        method: 'PUT',\n        callback: (req) =>\n            update(MOCK_PRODUCTS)(req.route_params.id, { ...req.body }),\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_types/:id`,\n        metadata: {},\n        method: 'DELETE',\n        callback: (req) => {\n            const index = MOCK_PRODUCTS.findIndex(\n                (e) => e.id === req.route_params.id\n            );\n            if (index < 0)\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${req.route_params.id}`,\n                };\n            MOCK_PRODUCTS.splice(index, 1);\n            return;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_purchase_orders`,\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const events = MOCK_PURCHASE_ORDERS;\n            return events;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_purchase_orders/:id`,\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const event = MOCK_PURCHASE_ORDERS.find(\n                (e) => e.id === _.route_params.id\n            );\n            if (!event)\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${_.route_params.id}`,\n                };\n            return event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_purchase_orders`,\n        metadata: {},\n        method: 'POST',\n        callback: (request) => {\n            const new_event = {\n                ...request.body,\n                id: `-purchase-order-${predictableRandomInt(999)}`,\n            };\n            MOCK_PURCHASE_ORDERS.push(new_event);\n            return new_event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_purchase_orders/:id`,\n        metadata: {},\n        method: 'PUT',\n        callback: (req) =>\n            update(MOCK_PURCHASE_ORDERS)(req.route_params.id, { ...req.body }),\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/asset_purchase_orders/:id`,\n        metadata: {},\n        method: 'DELETE',\n        callback: (req) => {\n            const index = MOCK_PURCHASE_ORDERS.findIndex(\n                (e) => e.id === req.route_params.id\n            );\n            if (index < 0)\n                throw {\n                    status: 404,\n                    message: `Unable to find purchase order with ID ${req.route_params.id}`,\n                };\n            MOCK_PURCHASE_ORDERS.splice(index, 1);\n            return;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/assets`,\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const events = MOCK_ASSETS;\n            return events;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/assets/:id`,\n        metadata: {},\n        method: 'GET',\n        callback: (_) => {\n            const event = MOCK_ASSETS.find((e) => e.id === _.route_params.id);\n            if (!event)\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${_.route_params.id}`,\n                };\n            return event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/assets`,\n        metadata: {},\n        method: 'POST',\n        callback: (request) => {\n            const new_event = {\n                ...request.body,\n                id: `-asset-${predictableRandomInt(999)}`,\n            };\n            MOCK_ASSETS.push(new_event);\n            return new_event;\n        },\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/assets/:id`,\n        metadata: {},\n        method: 'PUT',\n        callback: (req) =>\n            update(MOCK_ASSETS)(req.route_params.id, { ...req.body }),\n    });\n\n    registerMockEndpoint({\n        path: `${BASE_PATH}/assets/:id`,\n        metadata: {},\n        method: 'DELETE',\n        callback: (req) => {\n            const index = MOCK_ASSETS.findIndex(\n                (e) => e.id === req.route_params.id\n            );\n            if (index < 0)\n                throw {\n                    status: 404,\n                    message: `Unable to find booking with ID ${req.route_params.id}`,\n                };\n            MOCK_ASSETS.splice(index, 1);\n            return;\n        },\n    });\n}\n","import { flatten, predictableRandomInt } from '@placeos/common';\nimport { registerMockEndpoint } from '@placeos/ts-client';\nimport { MOCK_BUILDINGS } from './zone.data';\nimport { getUnixTime } from 'date-fns';\n\nexport const SURVEY_MOCKS = registerMocks();\n\nconst MOCK_SURVEYS = new Array(20).fill(0).map(() => createMockSurvey());\nconst MOCK_SURVEY_QUESTIONS = new Array(20)\n    .fill(0)\n    .map(() => createMockSurveyQuestion());\nconst MOCK_SURVEY_ANSWERS = flatten(\n    MOCK_SURVEYS.map((_) =>\n        new Array(20).fill(0).map(() => createMockSurveyAnswer(_))\n    )\n);\n\nfunction createMockSurvey(survey?: any) {\n    const id = predictableRandomInt(999_999, 0);\n    const bld = MOCK_BUILDINGS[predictableRandomInt(MOCK_BUILDINGS.length, 0)];\n    return {\n        id,\n        title: `Survey ${id}`,\n        description: '',\n        trigger: 'none',\n        pages: [],\n        zone_id: bld?.id,\n        building_id: bld?.id,\n        created_at: getUnixTime(Date.now()),\n        updated_at: getUnixTime(Date.now()),\n        ...(survey || {}),\n    };\n}\n\nfunction createMockSurveyAnswer(survey: any) {\n    const id = predictableRandomInt(999_999, 0);\n    return {\n        id,\n        survey_id: survey.id,\n        question_id: predictableRandomInt(999_999, 0),\n        answer_json: predictableRandomInt(10, 0),\n        type: 'rating',\n        created_at: getUnixTime(Date.now()),\n        updated_at: getUnixTime(Date.now()),\n    };\n}\n\nfunction createMockSurveyQuestion() {\n    const id = predictableRandomInt(999_999, 0);\n    return {\n        id,\n        type: 'text',\n        title: `Question ${id}`,\n        options: {},\n        required: false,\n        choices: {},\n        tags: [],\n        deleted: false,\n        created_at: getUnixTime(Date.now()),\n        updated_at: getUnixTime(Date.now()),\n    };\n}\n\nfunction registerMocks() {\n    registerMockEndpoint({\n        path: '/api/staff/v1/surveys',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            return request.query_params?.building_id\n                ? MOCK_SURVEYS.filter(\n                      (_) => _.zone_id === request.query_params.building_id\n                  )\n                : MOCK_SURVEYS;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/surveys/answers',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            return request.query_params?.survey_id\n                ? MOCK_SURVEY_ANSWERS.filter(\n                      (_) => _.survey_id === request.query_params.survey_id\n                  )\n                : MOCK_SURVEY_ANSWERS;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/surveys/questions',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            return request.query_params?.id\n                ? MOCK_SURVEY_QUESTIONS.filter(\n                      (_) => _.id === +request.query_params.id\n                  )\n                : MOCK_SURVEY_QUESTIONS;\n        },\n    });\n\n    registerMockEndpoint({\n        path: '/api/staff/v1/surveys/:id',\n        metadata: {},\n        method: 'GET',\n        callback: (request) => {\n            console.log('Surveys:', MOCK_SURVEYS);\n            const survey = MOCK_SURVEYS.find(\n                (_) => _.id === +request.route_params.id\n            );\n            if (!survey) throw { status: 404 };\n            return survey;\n        },\n    });\n}\n","import { log } from '@placeos/common';\n\nimport { ZONE_MOCKS } from './lib/api/zones.mock';\nimport { USER_MOCKS } from './lib/api/users.mock';\nimport { SYSTEM_MOCKS } from './lib/api/systems.mock';\nimport { EVENT_MOCKS } from './lib/api/events.mock';\nimport { CALENDAR_MOCKS } from './lib/api/calendars.mock';\nimport { BOOKING_MOCKS } from './lib/api/bookings.mock';\nimport { ASSET_MOCKS } from './lib/api/assets.mock';\nimport { SURVEY_MOCKS } from './lib/api/surveys.mock';\n\nexport default {\n    ZONE_MOCKS,\n    USER_MOCKS,\n    SYSTEM_MOCKS,\n    EVENT_MOCKS,\n    CALENDAR_MOCKS,\n    BOOKING_MOCKS,\n    ASSET_MOCKS,\n    SURVEY_MOCKS,\n};\n\nlog('MOCKS', 'Mocks included with application.');\n","import { Component, OnInit, Optional } from '@angular/core';\nimport { SwUpdate } from '@angular/service-worker';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { Clipboard } from '@angular/cdk/clipboard';\nimport { first } from 'rxjs/operators';\nimport {\n    apiKey,\n    clientId,\n    convertPairStringToMap,\n    invalidateToken,\n    isFixedDevice,\n    isMock,\n    refreshToken,\n    setAPI_Key,\n    token,\n} from '@placeos/ts-client';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { addHours } from 'date-fns';\n\nimport {\n    AsyncHandler,\n    current_user,\n    currentUser,\n    HotkeysService,\n    notifySuccess,\n    setAppName,\n    setNotifyOutlet,\n    SettingsService,\n    setupCache,\n    setupPlace,\n    log,\n    GoogleAnalyticsService,\n    isMobileSafari,\n    hasNewVersion,\n    requestScreenWakeLock,\n} from '@placeos/common';\nimport { MapsPeopleService } from 'libs/common/src/lib/mapspeople.service';\nimport { OrganisationService } from 'libs/organisation/src/lib/organisation.service';\nimport { setInternalUserDomain } from 'libs/users/src/lib/user.utilities';\n\nimport * as Sentry from '@sentry/angular';\nimport { MOCKS } from '@placeos/mocks';\nimport {\n    Amazon,\n    Azure,\n    Google,\n    initialiseUploadService,\n    OpenStack,\n} from '@placeos/cloud-uploads';\nimport { setCustomHeaders } from '@placeos/svg-viewer';\nimport { TranslateService } from '@ngx-translate/core';\n\nconst START_QUERY = location.search;\n\nexport function initSentry(dsn: string, sample_rate = 0.1) {\n    if (!dsn) return;\n    Sentry.init({\n        dsn,\n        integrations: [\n            Sentry.browserTracingIntegration(),\n            Sentry.replayIntegration({\n                maskAllText: false,\n                blockAllMedia: false,\n            }),\n        ],\n        // Performance Monitoring\n        tracesSampleRate: 1.0, //  Capture 100% of the transactions\n        // Set 'tracePropagationTargets' to control for which URLs distributed tracing should be enabled\n        tracePropagationTargets: [\n            'localhost',\n            /^https:\\/\\/[a-zA-Z0-9_\\-]*\\.[a-zA-Z0-9]*\\/api/,\n            /^https:\\/\\/[a-zA-Z0-9_\\-]*\\.placeos\\.run*\\/api/,\n        ],\n        // Session Replay\n        replaysSessionSampleRate: sample_rate, // This sets the sample rate at 10%. You may want to change it to 100% while in development and then sample at a lower rate in production.\n        replaysOnErrorSampleRate: 1.0, // If you're not already sampling the entire session, change the sample rate to 100% when sampling sessions where errors occur.\n    });\n}\n\n(window as any).global = window;\n\n@Component({\n    selector: 'app-root',\n    template: `\n        <global-banner></global-banner>\n        <div class=\"flex-1 w-full relative h-1/2\">\n            <router-outlet></router-outlet>\n        </div>\n        <global-chat *ngIf=\"has_chat\"></global-chat>\n        <global-loading></global-loading>\n        <debug-console *ngIf=\"debug\"></debug-console>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class AppComponent extends AsyncHandler implements OnInit {\n    public get debug() {\n        return (\n            window.debug && this._settings.get('app.allow_debugging') === true\n        );\n    }\n\n    public get has_chat() {\n        return this._settings.get('app.chat.enabled');\n    }\n\n    constructor(\n        private _analytics: GoogleAnalyticsService,\n        private _settings: SettingsService,\n        private _org: OrganisationService, // For init\n        private _cache: SwUpdate,\n        private _snackbar: MatSnackBar,\n        private _hotkey: HotkeysService,\n        private _clipboard: Clipboard,\n        private _route: ActivatedRoute,\n        private _router: Router,\n        private _maps: MapsPeopleService,\n        @Optional() private _translate: TranslateService,\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        log('APP', 'MOCKS:', MOCKS);\n        this._hotkey.listen(['Control', 'Alt', 'Shift', 'KeyM'], () => {\n            localStorage.setItem(\n                'mock',\n                `${localStorage.getItem('mock') !== 'true'}`,\n            );\n            location.reload();\n        });\n        this._hotkey.listen(['Control', 'Alt', 'Shift', 'KeyD'], () => {\n            this._settings.saveUserSetting(\n                'dark_mode',\n                !this._settings.get('dark_mode'),\n            );\n            notifySuccess('Toggled dark mode.');\n        });\n        this._hotkey.listen(['Control', 'Alt', 'Shift', 'KeyC'], () => {\n            this._clipboard.copy(`${token()}|${refreshToken()}`);\n            notifySuccess('Successfully copied token.');\n        });\n        this._hotkey.listen(['Control', 'Alt', 'Shift', 'KeyV'], () => {\n            navigator.clipboard\n                ?.readText()\n                .then((tkn) => this._pasteToken(tkn));\n        });\n        (window as any).pasteToken = (t) => this._pasteToken(t);\n        this._route.queryParamMap.subscribe((params) => {\n            if (params.has('hide_nav'))\n                localStorage.setItem('PlaceOS.hide_nav', 'true');\n            if (params.has('lang')) {\n                const locale = params.get('lang');\n                this._translate?.use(locale);\n                localStorage.setItem('PLACEOS.locale', locale);\n            }\n            if (params.has('x-api-key')) {\n                setAPI_Key(params.get('x-api-key'));\n            }\n        });\n        setNotifyOutlet(this._snackbar);\n        /** Wait for settings to initialise */\n        await this._settings.initialised.pipe(first((_) => _)).toPromise();\n        setAppName(this._settings.get('app.short_name'));\n        const settings = this._settings.get('composer') || {};\n        settings.mock =\n            !!this._settings.get('mock') ||\n            location.origin.includes('demo.place.tech');\n        /** Add query parameters if removed due to hash routing */\n        if (START_QUERY) {\n            const query = convertPairStringToMap(START_QUERY.substring(1));\n            this._router.navigate([], {\n                relativeTo: this._route,\n                queryParams: query,\n            });\n        }\n        /** Wait for authentication details to load */\n        await setupPlace(settings).catch((_) => console.error(_));\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        setupCache(this._cache);\n        if (!settings.local_login) {\n            this.timeout('wait_for_user', () => this.onInitError(), 30 * 1000);\n        }\n        await current_user.pipe(first((_) => !!_)).toPromise();\n        this.clearTimeout('wait_for_user');\n        this._initLocale();\n        setInternalUserDomain(\n            this._settings.get('app.general.internal_user_domain') ||\n                `@${currentUser()?.email?.split('@')[1]}`,\n        );\n        this._initAnalytics();\n        initSentry(this._settings.get('app.sentry_dsn'));\n        try {\n            const tkn = token();\n            if (isMobileSafari()) {\n                setCustomHeaders(\n                    tkn === 'x-api-key'\n                        ? { 'x-api-key': apiKey() }\n                        : { Authorization: `Bearer ${tkn}` },\n                );\n            }\n            if (this._settings.get('app.has_uploads')) {\n                this.timeout('init_uploads', () => {\n                    initialiseUploadService({\n                        auto_start: true,\n                        token: token(),\n                        endpoint: '/api/engine/v2/uploads',\n                        worker_url: 'assets/md5_worker.js',\n                        providers: [Amazon, Azure, Google, OpenStack] as any,\n                    });\n                });\n            }\n            if (isFixedDevice()) {\n                this.interval(\n                    'auto-update-version',\n                    () => this._checkReload(),\n                    15 * 1000,\n                );\n                await requestScreenWakeLock();\n            }\n        } catch {}\n    }\n\n    private onInitError() {\n        if (isMock() || currentUser()?.is_logged_in) return;\n        invalidateToken();\n        location.reload();\n    }\n\n    private _initAnalytics() {\n        const tracking_id = this._settings.get('app.analytics.tracking_id');\n        if (!tracking_id) return;\n        this._analytics.init(tracking_id);\n        this._analytics.load(tracking_id);\n        this._analytics.setUser(currentUser().id);\n    }\n\n    private _initLocale() {\n        try {\n            let locale = localStorage.getItem('PLACEOS.locale');\n            const locales = this._settings.get('app.locales') || [];\n            this._translate?.addLangs(locales.map((_) => _.id));\n            if (locale) {\n                this._translate?.use(locale);\n            } else {\n                const list = navigator.languages;\n                for (const lang of list) {\n                    locale = locales.find((_) => _.id === lang);\n                    if (!locale)\n                        locale = locales.find((_) => lang.includes(_.id));\n                    if (locale) {\n                        this._translate?.use(lang);\n                        localStorage.setItem('PLACEOS.locale', lang);\n                        break;\n                    }\n                }\n            }\n        } catch {}\n    }\n\n    private _pasteToken(tkn: string) {\n        const parts = tkn.split('|');\n        const id = clientId();\n        localStorage.setItem(`${id}_access_token`, `${parts[0]}`);\n        localStorage.setItem(`${id}_refresh_token`, `${parts[1]}`);\n        localStorage.setItem(\n            `${id}_expires_at`,\n            `${addHours(new Date(), 6).valueOf()}`,\n        );\n\n        notifySuccess('Successfully pasted token.');\n        setTimeout(() => location.reload(), 2000);\n    }\n\n    private _checkReload() {\n        if (!hasNewVersion()) return;\n        location.reload();\n\n        this.timeout(\n            'reload',\n            () => (location.href = `${location.origin}${location.pathname}`),\n        );\n    }\n}\n","import { CommonModule } from \"@angular/common\";\nimport { NgModule } from \"@angular/core\";\nimport { ComponentsModule } from \"@placeos/components\";\nimport { PanelViewDetailsComponent } from \"./panel-view-details.component\";\nimport { PanelViewStatusComponent } from \"./panel-view-status.component\";\nimport { PanelViewComponent } from \"./panel-view.component\";\n\nconst COMPONENTS = [\n    PanelViewComponent,\n    PanelViewDetailsComponent,\n    PanelViewStatusComponent\n];\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [CommonModule, ComponentsModule],\n    exports: [...COMPONENTS]\n})\nexport class AppPanelViewModule {}","import { CommonModule } from \"@angular/common\";\nimport { NgModule } from \"@angular/core\";\nimport { MatRippleModule } from \"@angular/material/core\";\nimport { ComponentsModule } from \"@placeos/components\";\n\nimport { CheckinTimetableComponent } from \"./checkin-timetable.component\";\nimport { CheckinViewComponent } from \"./checkin-view.component\";\n\nconst COMPONENTS = [\n    CheckinViewComponent,\n    CheckinTimetableComponent\n]\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [CommonModule, ComponentsModule, MatRippleModule],\n    exports: [...COMPONENTS]\n})\nexport class AppCheckinModule {}","import { DatePipe } from '@angular/common';\nimport { Component, ElementRef, forwardRef, ViewChild } from '@angular/core';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    FormGroup,\n    NG_VALUE_ACCESSOR,\n    Validators,\n} from '@angular/forms';\nimport { AsyncHandler } from '@placeos/common';\nimport { addYears, setMonth } from 'date-fns';\n\nexport interface PaymentCardDetails {\n    card_number: string;\n    cardholder: string;\n    cvv: string;\n    exp_month: string;\n    exp_year: string;\n}\n\nconst BLANK_CARD = { card_number: '                ', cardholder: '', cvv: '' };\nconst DATE_PIPE = new DatePipe('en-us', '');\n\n@Component({\n    selector: 'card-input-field',\n    template: `\n        <form [formGroup]=\"details\" (window:keyup)=\"onInput($event)\">\n            <div class=\"flex flex-col\">\n                <label for=\"card-number\" i18n>Card Number</label>\n                <div\n                    tabindex=\"0\"\n                    class=\"border border-base-200 p-2 h-12 mb-4 focus-within:shadow focus-within:border-base-200 flex items-center font-mono w-full rounded relative\"\n                    (focus)=\"focusInput()\"\n                >\n                    <pre class=\"flex-1\">{{ card_display }}</pre>\n                    <input\n                        #input\n                        class=\"hidden absolute\"\n                        type=\"tel\"\n                        [value]=\"details.value.card_number?.trim()\"\n                        (keydown)=\"(false)\"\n                        maxlength=\"17\"\n                    />\n                    <img\n                        *ngIf=\"card_type\"\n                        [src]=\"'assets/icons/' + card_type + '.svg'\"\n                        class=\"h-8\"\n                    />\n                </div>\n            </div>\n            <div class=\"flex flex-col flex-1\">\n                <label for=\"cardholder\" i18n>Name on Card</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        name=\"cardholder\"\n                        matInput\n                        placeholder=\"Mr John Smith\"\n                        formControlName=\"cardholder\"\n                    />\n                    <mat-error i18n>Cardholder name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"flex items-center space-x-2\">\n                <div class=\"flex flex-col flex-1 w-1/4\">\n                    <label for=\"cardholder\" i18n>Expiry Month</label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            placeholder=\"MM\"\n                            formControlName=\"exp_month\"\n                        >\n                            <mat-option\n                                *ngFor=\"let item of months\"\n                                [value]=\"item[0]\"\n                            >\n                                {{ item[1] }} ({{ item[0] }})\n                            </mat-option>\n                        </mat-select>\n                        <mat-error i18n>Expiry month is required</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col flex-1 w-1/4\">\n                    <label for=\"cardholder\">Expiry Year</label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            placeholder=\"YYYY\"\n                            formControlName=\"exp_year\"\n                        >\n                            <mat-option\n                                *ngFor=\"let item of years\"\n                                [value]=\"item\"\n                                >{{ item }}</mat-option\n                            >\n                        </mat-select>\n                        <mat-error i18n>Expiry year is required</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col\">\n                    <label for=\"cvv\">CVV</label>\n                    <mat-form-field appearance=\"outline\" class=\"w-20\">\n                        <input\n                            name=\"cvv\"\n                            matInput\n                            formControlName=\"cvv\"\n                            maxlength=\"4\"\n                        />\n                        <mat-error i18n>Invalid security code</mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n        </form>\n    `,\n    styles: [\n        `\n            mat-form-field {\n                height: 3.25rem;\n            }\n        `,\n    ],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            /* istanbul ignore next */\n            useExisting: forwardRef(() => CardInputFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class CardInputFieldComponent\n    extends AsyncHandler\n    implements ControlValueAccessor\n{\n    public details = new FormGroup({\n        card_number: new FormControl(Array(16).fill('X').join()),\n        cardholder: new FormControl(''),\n        exp_month: new FormControl(''),\n        exp_year: new FormControl(''),\n        cvv: new FormControl('', [\n            Validators.minLength(3),\n            Validators.maxLength(4),\n        ]),\n    });\n    public disabled = false;\n\n    public readonly months = Array(12)\n        .fill(0)\n        .map((_, idx) => [\n            DATE_PIPE.transform(setMonth(Date.now(), idx), 'MM'),\n            DATE_PIPE.transform(setMonth(Date.now(), idx), 'MMM'),\n        ]);\n    public readonly years = Array(12)\n        .fill(0)\n        .map((_, idx) =>\n            DATE_PIPE.transform(addYears(Date.now(), idx), 'yyyy')\n        );\n    public readonly digits = Array(16).fill(0);\n    private _index = 0;\n\n    @ViewChild('input', { static: true })\n    private _input_el!: ElementRef<HTMLInputElement>;\n\n    private _onChange?: (_: PaymentCardDetails) => void;\n    private _onTouch?: (_: PaymentCardDetails) => void;\n\n    public get is_amex() {\n        const no = this.details.value?.card_number || '';\n        return no.startsWith('3');\n    }\n\n    public get card_type() {\n        const no = this.details.value?.card_number || '';\n        if (no.startsWith('3')) return 'amex';\n        if (no.startsWith('4')) return 'visa';\n        if (no.startsWith('5')) return 'mastercard';\n        return '';\n    }\n\n    public get card_display() {\n        let no = this.details.value?.card_number || '';\n        if (this.card_focused)\n            no =\n                no.substring(0, this._index) +\n                '' +\n                no.substring(this._index + 1);\n        return this.is_amex\n            ? `${no.substring(0, 4)}-${no.substring(4, 10)}-${no.substring(10)}`\n            : `${no.substring(0, 4)}-${no.substring(4, 8)}-${no.substring(\n                  8,\n                  12\n              )}-${no.substring(12)}`;\n    }\n\n    public get card_focused() {\n        return (\n            document.activeElement === this._input_el.nativeElement ||\n            document.activeElement ===\n                this._input_el.nativeElement.parentElement\n        );\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'changes',\n            this.details.valueChanges.subscribe((v) =>\n                this.timeout('update', () =>\n                    this.setValue(this.details.getRawValue())\n                )\n            )\n        );\n    }\n\n    public focusInput() {\n        this._input_el.nativeElement.focus();\n        this._index = this._input_el.nativeElement.selectionStart || 0;\n    }\n\n    public onInput(event: KeyboardEvent) {\n        if (!event || !this.card_focused) return;\n        const idx = this._index;\n        if (idx < 0 || idx > 16) return;\n        let card_number = this.details.value.card_number!;\n        if (\n            (event.code.startsWith('Digit') ||\n                event.code.startsWith('Numpad')) &&\n            idx < (this.is_amex ? 15 : 16)\n        ) {\n            card_number =\n                card_number.substring(0, idx) +\n                event.key +\n                card_number.substring(idx + 1);\n            this.details.patchValue({ card_number });\n            this._focusChange(idx, 1);\n        } else if (event.code === 'Backspace' && idx > 0) {\n            let card_number = this.details.value.card_number!;\n            card_number =\n                card_number.substring(0, idx) +\n                ' ' +\n                card_number.substring(idx + 1);\n            this.details.patchValue({ card_number });\n            this._focusChange(idx, -1);\n        } else if (event.code === 'ArrowLeft') {\n            this._focusChange(idx, -1);\n        } else if (event.code === 'ArrowRight' && card_number[idx] !== ' ') {\n            this._focusChange(idx, 1);\n        }\n    }\n\n    private _focusChange(idx: number, dir: 1 | -1) {\n        this._index = Math.min(16, Math.max(0, idx + dir));\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: PaymentCardDetails) {\n        if (this._onChange) this._onChange(new_value);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value?: PaymentCardDetails) {\n        this.details.patchValue(value || BLANK_CARD);\n    }\n\n    public readonly registerOnChange = (fn: (_: PaymentCardDetails) => void) =>\n        (this._onChange = fn);\n    public readonly registerOnTouched = (fn: (_: PaymentCardDetails) => void) =>\n        (this._onTouch = fn);\n    public readonly setDisabledState = (s: boolean) => (this.disabled = s);\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\n\nimport { PaymentModalComponent } from './payment-modal.component';\nimport { CardInputFieldComponent } from './card-input-field.component';\n\nconst COMPONENTS = [PaymentModalComponent, CardInputFieldComponent];\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        MatFormFieldModule,\n        MatInputModule,\n        MatDialogModule,\n        MatButtonModule,\n        MatSelectModule,\n        MatProgressSpinnerModule,\n    ],\n    exports: [...COMPONENTS],\n})\nexport class PaymentsModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ComponentsModule } from '@placeos/components';\nimport { FormFieldsModule } from '@placeos/form-fields';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { AssetSelectModalComponent } from './asset-select-modal/asset-select-modal.component';\nimport { AssetDetailsComponent } from './asset-select-modal/asset-details.component';\nimport { AssetFiltersComponent } from './asset-select-modal/asset-filters.component';\nimport { AssetFiltersDisplayComponent } from './asset-select-modal/asset-filters-display.component';\nimport { AssetListComponent } from './asset-select-modal/asset-list.component';\nimport { AssetGroupPipe } from './asset-group.pipe';\nimport { AssetListFieldComponent } from './asset-list-field.component';\n\nexport * from './asset-select-modal/asset-select-modal.component';\n\nconst COMPONENTS = [AssetSelectModalComponent, AssetListFieldComponent];\n\nconst MODULE_COMPONENTS = [\n    AssetDetailsComponent,\n    AssetFiltersComponent,\n    AssetFiltersDisplayComponent,\n    AssetListComponent,\n    AssetGroupPipe,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS, ...MODULE_COMPONENTS],\n    imports: [\n        CommonModule,\n        FormFieldsModule,\n        FormsModule,\n        ReactiveFormsModule,\n        ComponentsModule,\n    ],\n    exports: [...COMPONENTS],\n})\nexport class AssetsModule {}\n","import { Pipe } from '@angular/core';\nimport { showGuest } from './guests.fn';\nimport { showStaff } from './staff.fn';\nimport { User } from './user.class';\n\nconst USER_LIST: User[] = [];\n\nconst EMPTY_USER = new User();\n\n@Pipe({\n    name: 'user',\n})\nexport class UserPipe {\n    /**\n     * Get details of the user with the given ID\n     * @param user_id ID or Email of the user\n     */\n    public async transform(user_id: string): Promise<User> {\n        if (!user_id) return EMPTY_USER;\n        let user = USER_LIST.find(\n            ({ id, email }) => id === user_id || email === user_id\n        );\n        if (user) return user;\n        user = await showStaff(user_id)\n            .toPromise()\n            .catch(() => null);\n        if (user) {\n            USER_LIST.push(user);\n            return user;\n        }\n        user = await showGuest(user_id)\n            .toPromise()\n            .catch(() => null);\n        if (user) {\n            USER_LIST.push(user);\n            return user;\n        }\n        return EMPTY_USER;\n    }\n}\n","import {\n    Component,\n    ElementRef,\n    Inject,\n    Renderer2,\n    ViewChild,\n} from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { AsyncHandler } from '@placeos/common';\nimport {\n    addMinutes,\n    differenceInMinutes,\n    endOfDay,\n    fromUnixTime,\n    getUnixTime,\n    isSameDay,\n    startOfDay,\n} from 'date-fns';\nimport { queryUserFreeBusy } from 'libs/calendar/src/lib/calendar.fn';\nimport { BehaviorSubject, combineLatest, of } from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    defaultIfEmpty,\n    map,\n    shareReplay,\n    switchMap,\n} from 'rxjs/operators';\nimport { User } from '../user.class';\nimport { AvailabilityBlock } from './user-availability.component';\n\nexport interface FindAvailabilityData {\n    host: User;\n    users: User[];\n    date: number;\n    duration: number;\n}\n\n@Component({\n    selector: 'find-availability-modal',\n    template: `\n        <header class=\"relative flex items-center justify-center p-4\">\n            <h2 class=\"text-center\">Find Availability</h2>\n            <button\n                icon\n                matRipple\n                mat-dialog-close\n                class=\"absolute top-1/2 left-1 -translate-y-1/2\"\n            >\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            class=\"flex flex-col h-[calc(100vh-7rem)] sm:h-[65vh] overflow-hidden\"\n        >\n            <div\n                class=\"w-full flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 p-2\"\n            >\n                <a-date-field\n                    [(ngModel)]=\"date\"\n                    class=\"max-h-[3.25rem] flex-1\"\n                    (ngModelChange)=\"on_change.next(on_change.getValue() + 1)\"\n                ></a-date-field>\n                <a-user-search-field\n                    [(ngModel)]=\"user\"\n                    (ngModelChange)=\"addUser($event)\"\n                    class=\"max-h-[3.25rem] flex-1\"\n                ></a-user-search-field>\n            </div>\n            <div\n                class=\"grid flex-1 h-1/2 w-full border-t border-base-200 relative overflow-hidden divide-x divide-y divide-base-200 max-w-[100vw] sm:max-w-[80vw]\"\n            >\n                <div\n                    times\n                    class=\"col-start-2 h-10 flex overflow-hidden border-l border-base-200\"\n                >\n                    <div\n                        hour\n                        *ngFor=\"let _ of hours; let hour = index\"\n                        class=\"relative border-r border-base-200 h-10 min-w-[5rem] p-2\"\n                        [attr.disabled]=\"today && current_hour > hour\"\n                        [style.left]=\"-offset_x + 'px'\"\n                    >\n                        {{ hour % 12 === 0 ? '12' : hour % 12\n                        }}{{ hour >= 12 ? 'pm' : 'am' }}\n                    </div>\n                </div>\n                <div users class=\"row-start-2 w-24 overflow-hidden\">\n                    <div\n                        host\n                        class=\"flex flex-col items-center justify-center h-32 w-24 relative border-b border-base-200 py-2\"\n                        [style.top]=\"-offset_y + 'px'\"\n                    >\n                        <a-user-avatar\n                            class=\"text-2xl\"\n                            [user]=\"host\"\n                        ></a-user-avatar>\n                        <div\n                            class=\"text-xs break-words overflow-hidden max-w-full px-2 text-center\"\n                        >\n                            {{ host.name || host.email }}\n                        </div>\n                    </div>\n                    <div\n                        person\n                        class=\"flex flex-col items-center justify-center h-32 w-24 relative border-b border-base-200 py-2\"\n                        [style.top]=\"-offset_y + 'px'\"\n                        *ngFor=\"let user of users | async\"\n                    >\n                        <a-user-avatar\n                            class=\"text-2xl\"\n                            [user]=\"user\"\n                        ></a-user-avatar>\n                        <div\n                            class=\"text-xs break-words max-w-full px-2 text-center\"\n                        >\n                            {{ user.name || host.email }}\n                        </div>\n                        <button\n                            icon\n                            class=\"absolute -top-1 -left-1\"\n                            (click)=\"removeUser(user)\"\n                        >\n                            <app-icon>close</app-icon>\n                        </button>\n                    </div>\n                </div>\n                <div blocks class=\"relative row-start-2 overflow-hidden\">\n                    <div fixed class=\"absolute inset-0 flex overflow-hidden\">\n                        <div\n                            divider\n                            class=\"relative h-full min-w-[5rem] border-l border-base-200\"\n                            [style.left]=\"-(offset_x + 1) + 'px'\"\n                            [attr.disabled]=\"today && current_hour > h\"\n                            *ngFor=\"let _ of hours; let h = index\"\n                        ></div>\n                        <div\n                            selection\n                            class=\"absolute inset-y-0 !border-x-2 !border-info z-20 cursor-grab active:cursor-grabbing\"\n                            [style.left]=\"\n                                'calc(' +\n                                selection_left +\n                                'rem - ' +\n                                offset_x +\n                                'px)'\n                            \"\n                            [style.width]=\"selection_width + 'rem'\"\n                            (mousedown)=\"startMovePeriod($event)\"\n                            (touchstart)=\"startMovePeriod($event)\"\n                        >\n                            <div\n                                class=\"absolute inset-0 bg-info opacity-30\"\n                            ></div>\n                            <div\n                                handle\n                                class=\"absolute top-1/2 -left-px -translate-x-1/2 -translate-y-1/2 h-3 w-3 rounded-full bg-info\"\n                            ></div>\n                            <div\n                                handle\n                                class=\"absolute top-1/2 -right-px translate-x-1/2 -translate-y-1/2 h-3 w-3 rounded-full bg-info hover:h-4 hover:w-4 active:bg-secondary\"\n                                (mousedown)=\"startMoveDuration($event)\"\n                                (touchstart)=\"startMoveDuration($event)\"\n                            ></div>\n                            <div\n                                class=\"bg-base-100 border border-base-200 p-2 absolute top-2 left-1/2 -translate-x-1/2 shadow text-xs whitespace-nowrap rounded\"\n                            >\n                                {{ duration | duration }}\n                            </div>\n                            <div\n                                *ngIf=\"move_time\"\n                                class=\"bg-base-100 border border-base-200 p-2 absolute top-12 left-1/2 -translate-x-1/2 shadow text-xs whitespace-nowrap rounded\"\n                            >\n                                {{ date | date: 'shortTime' }}\n                            </div>\n                        </div>\n                    </div>\n                    <div\n                        scroll\n                        #container\n                        class=\"absolute inset-0 overflow-auto\"\n                        (scroll)=\"onScroll()\"\n                    >\n                        <user-availability-list\n                            class=\"pointer-events-none\"\n                            [user]=\"host\"\n                            [date]=\"date\"\n                            [availability]=\"\n                                (availability | async)\n                                    ? (availability | async)[host.email]\n                                    : []\n                            \"\n                        ></user-availability-list>\n                        <user-availability-list\n                            class=\"pointer-events-none\"\n                            *ngFor=\"let user of users | async\"\n                            [user]=\"user\"\n                            [date]=\"date\"\n                            [availability]=\"\n                                (availability | async)\n                                    ? (availability | async)[\n                                          user.email.toLowerCase()\n                                      ]\n                                    : []\n                            \"\n                        ></user-availability-list>\n                    </div>\n                </div>\n            </div>\n        </main>\n        <footer\n            class=\"flex items-center justify-between p-2 border-t border-base-200 w-full\"\n        >\n            <button\n                btn\n                matRipple\n                [mat-dialog-close]=\"true\"\n                class=\"clear text-secondary\"\n            >\n                <div class=\"flex items-center\">\n                    <app-icon class=\"text-xl\">arrow_back</app-icon>\n                    <div class=\"mr-1 underline\">Back to form</div>\n                </div>\n            </button>\n        </footer>\n    `,\n    styles: [\n        `\n            .grid {\n                grid-template-columns: 6rem 1fr;\n                grid-template-rows: 2.5rem minmax(0, 1fr);\n            }\n            [disabled='true'],\n            [disabled='true'] [header] {\n                background: var(--b3) !important;\n                pointer-events: none;\n            }\n            [disabled='true'] > * {\n                opacity: 0.3;\n            }\n        `,\n    ],\n})\nexport class FindAvailabilityModalComponent extends AsyncHandler {\n    public readonly users = new BehaviorSubject([]);\n    public search = '';\n    public date = this._data.date || Date.now();\n    public duration = this._data.duration || 60;\n    public user?: User;\n    public offset_y = 0;\n    public offset_x = 0;\n\n    public readonly host = this._data.host;\n    public readonly hours = new Array(24).fill(0);\n    public readonly on_change = new BehaviorSubject(0);\n\n    public readonly availability = combineLatest([\n        this.users,\n        this.on_change,\n    ]).pipe(\n        debounceTime(300),\n        switchMap(([users]) => {\n            return queryUserFreeBusy({\n                calendars: [\n                    this.host.email,\n                    ...users.map((_) => _.email.toLowerCase()),\n                ].join(','),\n                period_start: getUnixTime(startOfDay(this.date)),\n                period_end: getUnixTime(endOfDay(this.date)),\n            }).pipe(catchError(() => of([])));\n        }),\n        map((availability_list) => {\n            const availability_map: Record<string, AvailabilityBlock[]> = {};\n            for (const item of availability_list) {\n                availability_map[item.id.toLowerCase()] = item.availability\n                    .filter((_) => _.status === 'busy')\n                    .map((block) => {\n                        const date = fromUnixTime(block.starts_at);\n                        const duration = differenceInMinutes(\n                            fromUnixTime(block.ends_at),\n                            fromUnixTime(block.starts_at)\n                        );\n                        return {\n                            date,\n                            duration,\n                            start:\n                                ((date.getHours() + date.getMinutes() / 60) /\n                                    24) *\n                                100,\n                            size: (duration / 60 / 24) * 100,\n                        };\n                    });\n            }\n            return availability_map;\n        }),\n        defaultIfEmpty({}),\n        shareReplay(1)\n    );\n\n    @ViewChild('container', { static: true })\n    private _container_el!: ElementRef<HTMLDivElement>;\n\n    public get today() {\n        return isSameDay(this.date, Date.now());\n    }\n\n    public get current_hour() {\n        return new Date().getHours();\n    }\n\n    public get selection_left() {\n        const date = new Date(this.date);\n        return (date.getHours() + date.getMinutes() / 60) * 5;\n    }\n\n    public get selection_width() {\n        return (this.duration / 60) * 5;\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: FindAvailabilityData,\n        private _renderer: Renderer2,\n        private _dialog_ref: MatDialogRef<FindAvailabilityModalComponent>\n    ) {\n        super();\n        this.users.next([...this._data.users]);\n    }\n\n    public addUser(user: User) {\n        this.users.next([\n            ...this.users.getValue().filter((u) => u.email !== user.email),\n            user,\n        ]);\n        this.user = null;\n    }\n\n    public removeUser(user: User) {\n        this.users.next(\n            this.users.getValue().filter((u) => u.email !== user.email)\n        );\n        this.user = null;\n    }\n\n    public closeAndUpdate() {\n        this._dialog_ref.close(true);\n    }\n\n    public ngAfterViewInit() {\n        const date = new Date(this.date);\n        this.timeout(\n            'init',\n            () => {\n                const el = this._container_el.nativeElement.querySelector(\n                    `[hour=\"${date.getHours()}\"]`\n                );\n                if (el) {\n                    const rect =\n                        this._container_el.nativeElement.getBoundingClientRect();\n                    const el_rect = el.getBoundingClientRect();\n                    this._container_el.nativeElement.scrollTo(\n                        el_rect.left - 128 - rect.left,\n                        0\n                    );\n                }\n                this.onScroll();\n            },\n            300\n        );\n    }\n\n    public onScroll() {\n        this.offset_x = this._container_el.nativeElement.scrollLeft;\n        this.offset_y = this._container_el.nativeElement.scrollTop;\n    }\n\n    public move_time = false;\n    private _start_time = 0;\n    private _move_last = 0;\n    private _move_size = 80 * 24;\n\n    public startMovePeriod(event: MouseEvent | TouchEvent) {\n        event.preventDefault();\n        event.stopPropagation();\n        this._move_last =\n            event instanceof MouseEvent\n                ? event.clientX\n                : event.touches[0].clientX;\n        this.move_time = true;\n        this._start_time = this.date;\n        event instanceof MouseEvent\n            ? this.subscription(\n                  'on_move',\n                  this._renderer.listen('window', 'mousemove', (e) =>\n                      this._onMovePeriod(e)\n                  )\n              )\n            : this.subscription(\n                  'on_move',\n                  this._renderer.listen('window', 'touchmove', (e) =>\n                      this._onMovePeriod(e)\n                  )\n              );\n        event instanceof MouseEvent\n            ? this.subscription(\n                  'on_move_end',\n                  this._renderer.listen('window', 'mouseup', () =>\n                      this._onMoveEnd()\n                  )\n              )\n            : this.subscription(\n                  'on_move_end',\n                  this._renderer.listen('window', 'touchend', () =>\n                      this._onMoveEnd()\n                  )\n              );\n    }\n\n    public startMoveDuration(event: MouseEvent | TouchEvent) {\n        event.preventDefault();\n        event.stopPropagation();\n        this._move_last =\n            event instanceof MouseEvent\n                ? event.clientX\n                : event.touches[0].clientX;\n        this._start_time = this.duration;\n        event instanceof MouseEvent\n            ? this.subscription(\n                  'on_move',\n                  this._renderer.listen('window', 'mousemove', (e) =>\n                      this._onMoveDuration(e)\n                  )\n              )\n            : this.subscription(\n                  'on_move',\n                  this._renderer.listen('window', 'touchmove', (e) =>\n                      this._onMoveDuration(e)\n                  )\n              );\n        event instanceof MouseEvent\n            ? this.subscription(\n                  'on_move_end',\n                  this._renderer.listen('window', 'mouseup', () =>\n                      this._onMoveEnd()\n                  )\n              )\n            : this.subscription(\n                  'on_move_end',\n                  this._renderer.listen('window', 'touchend', () =>\n                      this._onMoveEnd()\n                  )\n              );\n    }\n\n    private _onMovePeriod(event: MouseEvent | TouchEvent) {\n        const change_px =\n            this._move_last -\n            (event instanceof MouseEvent\n                ? event.clientX\n                : event.touches[0].clientX);\n        const dir = change_px > 0 ? -1 : 1;\n        const change_min =\n            dir *\n            Math.floor(Math.abs((change_px / this._move_size) * 24 * 60) / 5) *\n            5;\n        if (change_min) {\n            const old_date = this.date;\n            this.date = addMinutes(this._start_time, change_min).valueOf();\n            if (this.date < Date.now()) this.date = old_date;\n        }\n    }\n\n    private _onMoveDuration(event: MouseEvent | TouchEvent) {\n        const change_px =\n            this._move_last -\n            (event instanceof MouseEvent\n                ? event.clientX\n                : event.touches[0].clientX);\n        const dir = change_px > 0 ? -1 : 1;\n        const change_min =\n            dir *\n            Math.floor(Math.abs((change_px / this._move_size) * 24 * 60) / 5) *\n            5;\n        if (change_min) {\n            this.duration = Math.max(30, this._start_time + change_min);\n        }\n    }\n\n    private _onMoveEnd() {\n        this.unsub('on_move');\n        this.unsub('on_move_end');\n        this._move_last = 0;\n        this.move_time = false;\n    }\n}\n","import { Component, Input } from '@angular/core';\n\nimport { User } from '../user.class';\n\nexport interface AvailabilityBlock {\n    date: number;\n    duration: number;\n    start: number;\n    size: number;\n}\n\n@Component({\n    selector: 'user-availability-list',\n    template: `\n        <div\n            class=\"relative w-[120rem] h-32 inset-y-0 border-b border-base-200 \"\n        >\n            <div\n                event\n                *ngFor=\"let event of availability\"\n                class=\"absolute inset-y-0 bg-error text-white p-2 overflow-hidden border border-red-700 rounded\"\n                [style.left]=\"event.start + '%'\"\n                [style.width]=\"event.size + '%'\"\n            >\n                <div class=\"text-xs max-w-full\">\n                    {{ event.date | date: 'shortTime' }} -\n                    {{\n                        event.date.valueOf() + event.duration * 60 * 1000\n                            | date: 'shortTime'\n                    }}\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n            }\n        `,\n    ],\n})\nexport class UserAvailabilityComponent {\n    @Input() public user: User;\n    @Input() public availability: AvailabilityBlock[] = [];\n    @Input() public date: number = Date.now();\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\n\nimport { ComponentsModule } from 'libs/components/src/lib/components.module';\nimport { FormFieldsModule } from 'libs/form-fields/src/lib/form-fields.module';\n\nimport { NewUserModalComponent } from './new-user-modal.component';\nimport { UserFormComponent } from './user-form.component';\nimport { UserPipe } from './user.pipe';\nimport { WFHSettingsModalComponent } from './wfh-settings-modal.component';\nimport { FindAvailabilityModalComponent } from './find-availability-modal/find-availability-modal.component';\nimport { UserAvailabilityComponent } from './find-availability-modal/user-availability.component';\n\nconst COMPONENTS = [\n    NewUserModalComponent,\n    UserFormComponent,\n    WFHSettingsModalComponent,\n    UserPipe,\n    FindAvailabilityModalComponent,\n    UserAvailabilityComponent,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        MatDialogModule,\n        FormFieldsModule,\n        ComponentsModule,\n        MatCheckboxModule,\n        MatProgressSpinnerModule,\n        MatMenuModule,\n    ],\n    exports: [...COMPONENTS],\n})\nexport class SharedUsersModule {}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\n\nimport { MatDatepickerModule } from '@angular/material/datepicker';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatRadioModule } from '@angular/material/radio';\n\nimport { ComponentsModule } from 'libs/components/src/lib/components.module';\nimport { FormFieldsModule } from 'libs/form-fields/src/lib/form-fields.module';\nimport { SharedEventsModule } from 'libs/events/src/lib/events.module';\nimport { SharedSpacesModule } from 'libs/spaces/src/lib/spaces.module';\nimport { SharedUsersModule } from 'libs/users/src/lib/users.module';\n\nimport { BookingCardComponent } from './booking-card.component';\nimport { BookingDetailsModalComponent } from './booking-details-modal.component';\n\nimport { DeskConfirmModalComponent } from './desk-confirm-modal.component';\nimport { DeskQuestionsModalComponent } from './desk-questions-modal.component';\nimport { DeskDetailsComponent } from './desk-select-modal/desk-details.component';\nimport { DeskFiltersDisplayComponent } from './desk-select-modal/desk-filters-display.component';\nimport { DeskFiltersComponent } from './desk-select-modal/desk-filters.component';\nimport { DeskListComponent } from './desk-select-modal/desk-list.component';\nimport { DeskMapComponent } from './desk-select-modal/desk-map.component';\nimport { DeskSelectModalComponent } from './desk-select-modal/desk-select-modal.component';\nimport { InviteVisitorFormComponent } from './invite-visitor-form.component';\nimport { ParkingSpaceDetailsComponent } from './parking-select-modal/parking-details.component';\nimport { ParkingSpaceFiltersDisplayComponent } from './parking-select-modal/parking-filters-display.component';\nimport { ParkingSpaceFiltersComponent } from './parking-select-modal/parking-filters.component';\nimport { ParkingSpaceListComponent } from './parking-select-modal/parking-list.component';\nimport { ParkingSpaceLocationPinComponent } from './parking-select-modal/parking-location-pin.component';\nimport { ParkingSpaceSelectMapComponent } from './parking-select-modal/parking-map.component';\nimport { ParkingSpaceSelectModalComponent } from './parking-select-modal/parking-select-modal.component';\nimport { ParkingSpaceListFieldComponent } from './parking-space-list-field.component';\nimport { DeskListFieldComponent } from './desk-list-field.component';\nimport { BookingLinkModalComponent } from './booking-link-modal.component';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatRippleModule } from '@angular/material/core';\nimport { LockerGridComponent } from './locker-grid.component';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { LockerSelectModalComponent } from './locker-select-modal/locker-select-modal.component';\nimport { LockerListFieldComponent } from './locker-list-field.component';\nimport { LockerFiltersComponent } from './locker-select-modal/locker-filters.component';\nimport { LockerFiltersDisplayComponent } from './locker-select-modal/locker-filters-display.component';\nimport { LockerBankListComponent } from './locker-select-modal/locker-bank-list.component';\nimport { LockerMapComponent } from './locker-select-modal/locker-map.component';\nimport { DeskSettingsModalComponent } from './desk-settings-modal.component';\n\nconst COMPONENTS = [\n    DeskQuestionsModalComponent,\n    DeskConfirmModalComponent,\n    InviteVisitorFormComponent,\n    BookingDetailsModalComponent,\n    BookingCardComponent,\n    BookingLinkModalComponent,\n\n    ParkingSpaceSelectModalComponent,\n    ParkingSpaceFiltersComponent,\n    ParkingSpaceFiltersDisplayComponent,\n    ParkingSpaceListComponent,\n    ParkingSpaceLocationPinComponent,\n    ParkingSpaceSelectMapComponent,\n    ParkingSpaceDetailsComponent,\n    ParkingSpaceListFieldComponent,\n\n    DeskSelectModalComponent,\n    DeskDetailsComponent,\n    DeskFiltersComponent,\n    DeskFiltersDisplayComponent,\n    DeskListComponent,\n    DeskMapComponent,\n    DeskListFieldComponent,\n    DeskSettingsModalComponent,\n\n    LockerGridComponent,\n    LockerListFieldComponent,\n    LockerSelectModalComponent,\n    LockerFiltersComponent,\n    LockerFiltersDisplayComponent,\n    LockerBankListComponent,\n    LockerMapComponent,\n];\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        MatRadioModule,\n        MatInputModule,\n        MatFormFieldModule,\n        MatDatepickerModule,\n        MatButtonModule,\n        MatDialogModule,\n        MatProgressSpinnerModule,\n        MatCheckboxModule,\n        MatAutocompleteModule,\n        FormFieldsModule,\n        ComponentsModule,\n        MatRippleModule,\n        MatTooltipModule,\n        SharedSpacesModule,\n        SharedEventsModule,\n        SharedUsersModule,\n    ],\n    providers: [ReactiveFormsModule],\n    exports: [...COMPONENTS],\n})\nexport class SharedBookingsModule {}\n","import { CommonModule } from '@angular/common';\nimport { NgModule, Type } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { ComponentsModule } from '@placeos/components';\n\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { OverlayModule } from '@angular/cdk/overlay';\nimport { PortalModule } from '@angular/cdk/portal';\n\nimport { FormFieldsModule } from 'libs/form-fields/src/lib/form-fields.module';\nimport { SharedBookingsModule } from 'libs/bookings/src/lib/bookings.module';\n\nimport { ExploreMapControlComponent } from './explore-map-control.component';\nimport { ExploreMapViewComponent } from './explore-map-view.component';\nimport { ExploreSearchComponent } from './explore-search.component';\nimport { ExploreSpaceInfoComponent } from './explore-space-info.component';\nimport { ExploreZoomControlComponent } from './explore-zoom-control.component';\nimport { ExploreDeviceInfoComponent } from './explore-device-info.component';\nimport { ExploreBookingModalComponent } from './explore-booking-modal.component';\nimport { ExploreDeskInfoComponent } from './explore-desk-info.component';\nimport { SetDatetimeModalComponent } from './set-datetime-modal.component';\nimport { ExploreBookQrComponent } from './explore-book-qr.component';\nimport { ExploreSensorInfoComponent } from './explore-sensor-info.component';\nimport { ExploreLockerBankInfoComponent } from './explore-locker-bank-info.component';\nimport { ExploreLockerBankModalComponent } from './explore-locker-bank-modal.component';\nimport { ExploreParkingInfoComponent } from './explore-parking-info.component';\nimport { ExploreIconComponent } from './explore-icon.component';\n\nconst COMPONENTS: Type<any>[] = [\n    ExploreMapControlComponent,\n    ExploreMapViewComponent,\n    ExploreSearchComponent,\n    ExploreSpaceInfoComponent,\n    ExploreDeviceInfoComponent,\n    ExploreDeskInfoComponent,\n    ExploreZoomControlComponent,\n    ExploreBookingModalComponent,\n    SetDatetimeModalComponent,\n    ExploreBookQrComponent,\n    ExploreSensorInfoComponent,\n    ExploreLockerBankInfoComponent,\n    ExploreLockerBankModalComponent,\n    ExploreParkingInfoComponent,\n    ExploreIconComponent,\n];\n\n@NgModule({\n    declarations: [...COMPONENTS],\n    imports: [\n        CommonModule,\n        ComponentsModule,\n        FormsModule,\n        ReactiveFormsModule,\n        MatSlideToggleModule,\n        OverlayModule,\n        PortalModule,\n        FormFieldsModule,\n        SharedBookingsModule,\n    ],\n    exports: [...COMPONENTS],\n})\nexport class SharedExploreModule {}\n","import { BrowserModule } from '@angular/platform-browser';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { APP_INITIALIZER, ErrorHandler, NgModule } from '@angular/core';\nimport { provideHttpClient, withInterceptorsFromDi } from '@angular/common/http';\nimport { FormsModule } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { ServiceWorkerModule } from '@angular/service-worker';\n\nimport { HttpClient } from '@angular/common/http';\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\n\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { ComponentsModule } from '@placeos/components';\nimport { UnauthorisedComponent } from '@placeos/components';\n\nimport { environment } from '../environments/environment';\nimport { SharedOverlaysModule } from './overlays/overlays.module';\nimport { AppComponent } from 'libs/components/src/lib/app.component';\n\nimport { BootstrapComponent } from './bootstrap.component';\nimport { BookingPanelComponent } from './panel/panel.component';\nimport { BookingPanelArrayComponent } from './panel-array.component';\nimport { BookingPanelSelectComponent } from './panel-select.component';\nimport { PanelTopbarComponent } from './panel/topbar.component';\nimport { PanelDetailsComponent } from './panel/panel-details.component';\nimport { PanelBookingListComponent } from './panel/panel-booking-list.component';\n\nimport * as Sentry from '@sentry/angular';\nimport { PanelStatusComponent } from './panel/panel-status.component';\nimport { MatRippleModule } from '@angular/material/core';\nimport { PanelTimelineComponent } from './panel/timeline.component';\nimport { AppPanelViewModule } from './new-panel/panel-view.module';\nimport { AppCheckinModule } from './checkin/checkin.module';\nimport { PaymentsModule } from '@placeos/payments';\nimport { AssetsModule } from '@placeos/assets';\nimport { SharedExploreModule } from '@placeos/explore';\nimport { EventPanelComponent } from './event-panel.component';\n\n// AoT requires an exported function for factories\nexport function HttpLoaderFactory(http: HttpClient) {\n    return new TranslateHttpLoader(http, './assets/locale/', '.json');\n}\n\nconst MAT_MODULES: any[] = [\n    MatFormFieldModule,\n    MatInputModule,\n    MatAutocompleteModule,\n];\n\n@NgModule({ declarations: [\n        AppComponent,\n        UnauthorisedComponent,\n        BootstrapComponent,\n        BookingPanelComponent,\n        PanelTopbarComponent,\n        PanelDetailsComponent,\n        PanelStatusComponent,\n        PanelBookingListComponent,\n        PanelTimelineComponent,\n        BookingPanelArrayComponent,\n        BookingPanelSelectComponent,\n        EventPanelComponent,\n    ],\n    bootstrap: [AppComponent], imports: [BrowserModule,\n        BrowserAnimationsModule,\n        AppRoutingModule,\n        FormsModule,\n        MatSnackBarModule,\n        MatRippleModule,\n        SharedOverlaysModule,\n        AppPanelViewModule,\n        AppCheckinModule,\n        ComponentsModule,\n        PaymentsModule,\n        AssetsModule,\n        SharedExploreModule,\n        ...MAT_MODULES,\n        TranslateModule.forRoot({\n            defaultLanguage: 'en',\n            loader: {\n                provide: TranslateLoader,\n                useFactory: HttpLoaderFactory,\n                deps: [HttpClient],\n            },\n        }),\n        ServiceWorkerModule.register('ngsw-worker.js', {\n            enabled: environment.production,\n        })], providers: [\n        {\n            provide: ErrorHandler,\n            useValue: Sentry.createErrorHandler({\n                showDialog: false,\n            }),\n        },\n        {\n            provide: Sentry.TraceService,\n            deps: [Router],\n        },\n        {\n            provide: APP_INITIALIZER,\n            useFactory: () => () => { },\n            deps: [Sentry.TraceService],\n            multi: true,\n        },\n        provideHttpClient(withInterceptorsFromDi()),\n    ] })\nexport class AppModule {\n    constructor() {\n        console.log('Production:', !!environment.production);\n    }\n}\n","export const environment = {\n    production: true,\n};\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic()\n  .bootstrapModule(AppModule)\n  .catch((err) => console.error(err));\n"],"x_google_ignoreList":[]}