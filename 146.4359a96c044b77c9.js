"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([[146],{2084:(Q,w,n)=>{n.d(w,{f:()=>Y});var i=n(5861),K=n(3007),o=n(9112),d=n(8186),e=n(9972),L=n(9756),s=n(9925),B=n(3337),P=n(591),M=n(1086),N=n(3426),u=n(6787),R=n(8723),l=n(5154),I=n(13),c=n(9184),g=n(7545),S=n(2994),x=n(4850),T=n(2198),D=n(7224),O=n(2986),C=n(565),f=n(6962),A=n(1980),r=n(354),_=n(4282),t=n(8871),a=n(4367),E=n(1562),b=n(4650),p=n(5938);const y=["book/desks","book/parking","book/new-desks","book/new-parking"];class Y extends o.cx{get view(){return this._view.getValue()}get booking(){return this._booking.getValue()}newForm(m=new f.$){this.form.reset(),this.form.patchValue((0,d.sWL)({...m,...m.extension_data},[null,void 0,""])),this.subscription("form_change",this.form.valueChanges.subscribe(()=>this.storeForm())),this._booking.next(m),this._options.next({type:this._options.getValue().type})}constructor(m,h,v,k,$){super(),this._router=m,this._settings=h,this._org=v,this._dialog=k,this._payments=$,this._view=new P.X("form"),this._options=new P.X({type:"desk"}),this._booking=new P.X(null),this._loading=new P.X(""),this.last_success=new f.$(JSON.parse(sessionStorage.getItem("PLACEOS.last_booked_booking")||"{}")),this.loading=this._loading.asObservable(),this.options=this._options.pipe((0,l.d)(1)),this.form=(0,A.PR)(),this.resource=this.options.pipe((0,I.b)(300),(0,c.g)("type"),(0,g.w)(({type:U})=>{if(!this._org.building)return(0,M.of)([]);switch(U){case"desk":return this._loading.next("Loading desks..."),this.loadResourceList("desks");case"parking":return this._loading.next("Loading parking spaces..."),this.loadResourceList("parking_spaces")}return(0,M.of)([])}),(0,S.b)(()=>this._loading.next("")),(0,l.d)(1)),this.features=this.resource.pipe((0,x.U)(U=>{const W=[];for(const{features:Z}of U)Z instanceof Array&&Z.forEach(F=>W.push(F));return(0,o.Tw)(W).sort((Z,F)=>Z.localeCompare(F))}),(0,l.d)(1)),this.available_resources=(0,N.aj)([this.options,this.resource,(0,u.T)(this.form.valueChanges,(0,R.H)(1e3))]).pipe((0,T.h)(()=>this.form.getRawValue().date>0&&this.form.getRawValue().duration>0),(0,I.b)(500),(0,S.b)(([{type:U}])=>this._loading.next(`Checking ${U} availability...`)),(0,g.w)(([U,W])=>(0,r.F2)({period_start:(0,e.Z)(this.form.getRawValue().date),period_end:(0,e.Z)((0,L.Z)(this.form.getRawValue().date,this.form.getRawValue().duration||1440)),type:U.type,zones:U.zone_id}).pipe((0,x.U)(Z=>W.filter(F=>(!F.groups?.length||F.groups.some(G=>(0,o.ar)().groups.includes(G)))&&!1!==F.bookable&&(!U.features||U.features?.every(G=>F.features.includes(G)))&&(!U.zone_id||U.zone_id===F.zone?.id||U.zone_id===F.zone?.parent_id)&&!Z.find(G=>G.asset_id===F.id&&"declined"!==G.status))))),(0,S.b)(()=>this._loading.next("")),(0,l.d)(1)),this.grouped_availability=(0,N.aj)([this.options,this.available_resources]).pipe((0,x.U)(([U,W])=>{const Z=[],F=[...W].sort((j,X)=>j.zone?.id?.localeCompare(X.zone?.id)),G=U.members?.length?U.members:[(0,o.ar)()];for(;F.length;){const j=[];let X=F.pop();for(;j.length<G.length&&(!j.length||j.find(z=>z.zone?.id===X.zone?.id));)j.push(X),X=F.pop();j.length<G.length||Z.push(j)}return Z})),this.subscription("router.bookings",this._router.events.subscribe(U=>{U instanceof K.m2&&!y.find(W=>U.url.includes(W))&&this.clearForm()})),this._org.initialised.pipe((0,D.P)(U=>U)).subscribe(()=>this.setOptions({}))}setView(m){this._view.next(m)}setOptions(m){this._options.next({...this._options.getValue(),...m})}setFeature(m,h){if(!m?.length)return;const v=this._options.getValue()?.features||[];h&&!v.includes(m)&&v.push(m),!h&&v.includes(m)&&v.splice(v.findIndex(k=>k===m),1),this.setOptions({features:v})}resetForm(){const m=this._booking.getValue();this.form.reset({user:(0,o.ar)(),booked_by:(0,o.ar)()}),this.form.patchValue((0,d.sWL)({...m||{},...m?.extension_data||{}},[null,void 0,""])),this._options.next({type:this._options.getValue().type})}clearForm(){sessionStorage.removeItem("PLACEOS.booking_form"),sessionStorage.removeItem("PLACEOS.booking_form_options"),this.newForm()}storeForm(){sessionStorage.setItem("PLACEOS.booking_form",JSON.stringify(this.form.getRawValue()||{})),sessionStorage.setItem("PLACEOS.booking_form_filters",JSON.stringify(this._options.getValue()||{}))}loadForm(){this.form.reset({user:(0,o.ar)(),booked_by:(0,o.ar)()});const m=JSON.parse(sessionStorage.getItem("PLACEOS.booking_form")||"{}"),h=new f.$(m);this._booking.next(h);const v=(0,d.sWL)({...m,...h||{},...h?.extension_data||{}},[null,void 0,""]);this.form.patchValue(v),this.setOptions({zone_id:this._org.building?.id,...JSON.parse(sessionStorage.getItem("PLACEOS.booking_form_filters")||"{}")})}clearOldState(){sessionStorage.removeItem("PLACEOS.last_booked_booking"),this.last_success=new f.$}openBookingLinkModal(m=!1){if(this.form.markAllAsTouched(),!this.form.valid&&!m)return;const h=new f.$({...this.booking,...this.form.getRawValue()});this._dialog.open(a.w,{data:h})}confirmPost(){var m=this;return(0,i.Z)(function*(){yield m.checkQuestions();const h=m._options.getValue(),v=m.form.getRawValue();let k=`Would you like to book the ${h.type} ${v.asset_name} for ${(0,s.Z)(v.date,"dd MMM yyyy")}${v.duration<720?" at "+(0,s.Z)(v.date,"h:mm a"):""}`;h.group&&(k=`${k}.<br>You group members will be assigned desks nearby your selected desk.`);const $=yield(0,o._5)({title:`Book ${h.type}`,content:k,icon:{content:"event_available"}},m._dialog);if("done"!==$?.reason)throw"User cancelled";$.loading("Performing booking request..."),h.group?yield m.postFormForGroup().catch(U=>{throw(0,o.cB)(JSON.stringify(U)),$.close(),U}):yield m.postForm().catch(U=>{throw(0,o.cB)(JSON.stringify(U)),$.close(),U}),$.close()})()}postForm(m=!1){var h=this;return(0,i.Z)(function*(){if(!h.form)throw"No form for booking";if(!h.form.valid)throw`Some form fields are invalid. [${(0,o.RD)(h.form).join(", ")}]`;h.form.patchValue({booking_type:h.form.getRawValue().booking_type||h._options.getValue().type});let v=h.form.getRawValue(),k=h._booking.getValue()||new f.$;if(m||(yield h.checkResourceAvailable(v,h._options.getValue().type)),(v.duration>=720||v.all_day)&&(h.form.patchValue({date:(0,B.Z)(v.date,{hours:11,minutes:59}).valueOf(),duration:720}),v=h.form.getRawValue()),h._payments.payment_module){const W=yield h._payments.makePayment({type:h._options.getValue().type,resource_name:v.asset_name,date:v.date,duration:v.duration,all_day:v.all_day});if(!W?.success)return;v.extension_data={invoice:W,invoice_id:W.invoice_id}}(v.assets?.length||k.extension_data.assets?.length)&&(yield(0,E.cd)(`${v.booked_by_email}|${v.date}`,{date:v.date,duration:v.duration,host:v.booked_by_email},v.assets,k.extension_data.assets)),h._loading.next("Saving booking");const $=yield(0,r.km)(new f.$({...h._options.getValue(),...v,description:v.asset_name||v.description,user_name:v.user?.name,user_id:(v.user?.id?.includes("@")?"":v?.user?.id)||(0,o.ar)()?.id,extension_data:{...v.extension_data||{},department:v.user?.department||(0,o.ar)()?.department},approved:!!h._settings.get("app.bookings.no_approval")})).toPromise().catch(W=>{throw h._loading.next(""),W});h._loading.next("");const{booking_type:U}=v;return h.clearForm(),h.form?.patchValue({booking_type:U}),h.last_success=$,sessionStorage.setItem("PLACEOS.last_booked_booking",JSON.stringify($)),h.setView("success"),$})()}postFormForGroup(){var m=this;return(0,i.Z)(function*(){const{members:h,group:v,type:k}=m._options.getValue();if(!v)throw"No group available to book for";const $=h.filter(X=>X.email!==(0,o.ar)().email);if($.length<=0)throw"No members in your group to book for.";const U=m.form.value,W=yield m.available_resources.pipe((0,O.q)(1)).toPromise(),Z=W.find(X=>X.id===U.asset_id||X.map_id===U.asset_id),F=m._org.levelWithID([Z.zone?.id]),G=[Z,...yield m._getNearbyResources(F.map_id,U.asset_id,W,$.length)],j=(0,o.Tw)([(0,o.ar)(),...$],"email");yield Promise.all(j.map((X,z)=>m.checkResourceAvailable({...U,asset_id:G[z].map_id||G[z].id,user_email:X.email},k)));for(let X=0;X<j.length;X++){const z=j[X],V=G[X];m.form.patchValue({...U,user:z,user_email:z.email,user_id:z.id,asset_id:V?.id,asset_name:V.name,description:V.name,map_id:V?.map_id||V?.id,zones:V.zone?(0,o.Tw)([m._org.organisation.id,V.zone?.parent_id,V.zone?.id]):[m._org.organisation.id]}),m.postForm(!0)}})()}checkQuestions(){var m=this;return(0,i.Z)(function*(){if(!1!==m._settings.get("app.desks.ignore_questions"))return;const h=m._dialog.open(_.I);if("done"!==(yield Promise.race([h.componentInstance.event.pipe((0,D.P)($=>"done"===$.reason)).toPromise(),h.afterClosed().toPromise()]))?.reason)throw"User cancelled";const k=h.componentInstance.form.getRawValue();for(const $ in k)if(k[$])throw"User failed questionaire";h.close()})()}checkResourceAvailable({asset_id:m,date:h,duration:v,user_email:k,all_day:$},U){var W=this;return(0,i.Z)(function*(){v=$?720:v||60;const Z=yield(0,r.F2)({period_start:(0,e.Z)(h),period_end:(0,e.Z)(h+60*v*1e3),type:U}).toPromise();if(Z.find(G=>G.asset_id===m))throw m.includes("@")?`${m} already has an invite for the selected time`:`${m} is not available at the selected time`;const F=W._settings.get(`app.booking.allowed_daily_${U}_count`)??1;if(F>0&&Z.filter(G=>G.user_email===(k||(0,o.ar)()?.email)&&"declined"!==G.status).length>=F){const G=k===(0,o.ar)()?.email;throw`${G?"You":k} already ${G?"have":"has"} a ${U} booked`}return!0})()}loadResourceList(m){return(0,d.BW_)(this._org.building.id,{name:m}).pipe((0,x.U)(h=>(0,o.xH)(h.map(v=>(v.metadata[m]?.details instanceof Array?v.metadata[m]?.details:[]).map(k=>({...k,zone:v.zone}))))))}_getNearbyResources(m,h,v,k){return(0,i.Z)(function*(){const $=[];let U=v.filter(W=>W.id!==h&&W.map_id!==h);for(let W=0;W<k;W++){const Z=yield(0,A.gV)(m,h,U.map(F=>F.map_id||F.id));Z&&($.push(v.find(F=>F.id===Z||F.map_id===Z)),U=U.filter(F=>F.id!==Z&&F.map_id!==Z))}return $})()}}Y.\u0275fac=function(m){return new(m||Y)(b.LFG(K.F0),b.LFG(o.gb),b.LFG(C.w),b.LFG(p.uw),b.LFG(t.c))},Y.\u0275prov=b.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"})},4367:(Q,w,n)=>{n.d(w,{w:()=>M});var i=n(5938),K=n(719),o=n(9497),e=(n(6962),n(4650)),L=n(5306),s=n(3238),B=n(158),P=n(7202);class M{constructor(u,R){this._event=u,this._settings=R,this.outlook_link=(0,o.Y$)(this._event),this.google_link=(0,o.T$)(this._event),this.ical_link=(0,o.KS)(this._event)}}M.\u0275fac=function(u){return new(u||M)(e.Y36(i.WI),e.Y36(K.g))},M.\u0275cmp=e.Xpm({type:M,selectors:[["booking-link-modal"]],decls:22,vars:12,consts:function(){let N,u,R;return N=$localize`:␟34c16b14ad0e33db574c8bea543e66e766aa3a01␟4015832758698516701:Create in Outlook`,u=$localize`:␟f745484670e6b6bbb8a1c327c222e665fb25b863␟3788591245559456526:Create in Google Calendar`,R=$localize`:␟1af54061e7f4bcfb1048ffaa05c9b8f7c4b41679␟4894641609416495396:Download iCal File`,[[1,"p-4","w-full","pb-2"],[1,"flex","flex-col","items-center","space-y-4","p-4","relative"],["button","","matRipple","","target","_blank","rel","noopener noreferer",1,"flex","items-center","p-2","space-x-2","pr-4","w-64","rounded","inverse",3,"href"],["src","assets/icons/outlook.svg",1,"w-6"],N,["src","assets/icons/gcal.svg",1,"w-6"],u,[1,"text-xl"],R,["icon","","mat-dialog-close","",1,"absolute","top-2","right-0"]]},template:function(u,R){1&u&&(e.TgZ(0,"div",0),e._uU(1,"Add event to your calendar"),e.qZA(),e.TgZ(2,"div",1)(3,"a",2),e.ALo(4,"sanitize"),e._UZ(5,"img",3),e.TgZ(6,"span"),e.SDv(7,4),e.qZA()(),e.TgZ(8,"a",2),e.ALo(9,"sanitize"),e._UZ(10,"img",5),e.TgZ(11,"span"),e.SDv(12,6),e.qZA()(),e.TgZ(13,"a",2),e.ALo(14,"safe"),e.TgZ(15,"app-icon",7),e._uU(16,"download"),e.qZA(),e.TgZ(17,"span"),e.SDv(18,8),e.qZA()()(),e.TgZ(19,"button",9)(20,"app-icon"),e._uU(21,"close"),e.qZA()()),2&u&&(e.xp6(3),e.Q6J("href",e.xi3(4,3,R.outlook_link,"url"),e.LSH),e.xp6(5),e.Q6J("href",e.xi3(9,6,R.google_link,"url"),e.LSH),e.xp6(5),e.Q6J("href",e.xi3(14,9,R.ical_link,"url"),e.LSH))},dependencies:[i.ZT,L.o,s.wG,B.y,P.n],styles:["[_nghost-%COMP%]{position:relative}"]})},4282:(Q,w,n)=>{n.d(w,{I:()=>M});var i=n(4650),K=n(4006),d=(n(9112),n(6895)),e=n(1948),L=n(5938),s=n(3238);function B(N,u){if(1&N){const R=i.EpF();i.TgZ(0,"div",2)(1,"h2",3),i.SDv(2,4),i.qZA(),i.TgZ(3,"main",5)(4,"div",6)(5,"label"),i.tHW(6,7),i._UZ(7,"span"),i.N_p(),i.qZA(),i.TgZ(8,"mat-radio-group",8)(9,"mat-radio-button",9),i._uU(10,"Yes"),i.qZA(),i.TgZ(11,"mat-radio-button",9),i._uU(12,"No"),i.qZA()()(),i.TgZ(13,"div",6)(14,"label"),i.tHW(15,10),i._UZ(16,"span"),i.N_p(),i.qZA(),i.TgZ(17,"mat-radio-group",11)(18,"mat-radio-button",9),i._uU(19,"Yes"),i.qZA(),i.TgZ(20,"mat-radio-button",9),i._uU(21,"No"),i.qZA()()(),i.TgZ(22,"div",12)(23,"label"),i.tHW(24,13),i._UZ(25,"span"),i.N_p(),i.qZA(),i.TgZ(26,"mat-radio-group",14)(27,"mat-radio-button",9),i._uU(28,"Yes"),i.qZA(),i.TgZ(29,"mat-radio-button",9),i._uU(30,"No"),i.qZA()()()(),i.TgZ(31,"footer",15)(32,"button",16),i.NdJ("click",function(){i.CHM(R);const I=i.oxw();return i.KtG(I.submit())}),i.SDv(33,17),i.qZA()(),i.TgZ(34,"button",18)(35,"i",19),i._uU(36,"close"),i.qZA()()()}if(2&N){const R=i.oxw();i.xp6(3),i.Q6J("formGroup",R.form),i.xp6(6),i.Q6J("value",!0),i.xp6(2),i.Q6J("value",!1),i.xp6(7),i.Q6J("value",!0),i.xp6(2),i.Q6J("value",!1),i.xp6(7),i.Q6J("value",!0),i.xp6(2),i.Q6J("value",!1)}}function P(N,u){1&N&&(i.TgZ(0,"main",20)(1,"p",21),i.SDv(2,22),i.qZA(),i.TgZ(3,"button",18)(4,"i",19),i._uU(5,"close"),i.qZA()()())}class M{constructor(){this.event=new i.vpe,this.form=new K.cw({travelled:new K.NI(!1),unwell:new K.NI(!1),contact:new K.NI(!1)})}submit(){this.form.markAllAsTouched(),Object.keys(this.form.value).find(u=>!0===this.form.value[u]||"true"===this.form.value[u])?this.failure=!0:this.event.emit({reason:"done"})}}M.\u0275fac=function(u){return new(u||M)},M.\u0275cmp=i.Xpm({type:M,selectors:[["desk-question-modal"]],outputs:{event:"event"},decls:3,vars:2,consts:function(){let N,u,R,l,I,c;return N=$localize`:␟02006a13b8e6aacb7a6e15bafd8004ed529f5d81␟877348132538805077:COVID-19 Questionnaire`,u=$localize`:␟dad7efbd2320e5ea935aef911f18cbcb24690133␟1650520403092579087: Have you travelled overseas within the last 14 days?${"\ufffd#7\ufffd"}:START_TAG_SPAN:*${"\ufffd/#7\ufffd"}:CLOSE_TAG_SPAN:`,R=$localize`:␟cf50bf8de6c6db836da440c89a375631f7ba3fb0␟1182497320820036810: Are you unwell or experiencing any cold or flu-like symptoms?${"\ufffd#16\ufffd"}:START_TAG_SPAN:*${"\ufffd/#16\ufffd"}:CLOSE_TAG_SPAN:`,l=$localize`:␟273153c91358de15d124ff2966859d9949080f4c␟737527639567676154: Have you had contact with anyone with suspected COVID-19?${"\ufffd#25\ufffd"}:START_TAG_SPAN:*${"\ufffd/#25\ufffd"}:CLOSE_TAG_SPAN:`,I=$localize`:␟71c77bb8cecdf11ec3eead24dd1ba506573fa9cd␟935187492052582731:Submit`,c=$localize`:␟17d62f424c2c025579e1ec0e3f5ad971f57681df␟4401678084033805848: Your request to work from the office has been rejected based on your response to the compulsory Covid-19 questions. Please feel free to submit a new request when circumstances change in a way that changes your answer to the questions. `,[["class","relative",4,"ngIf","ngIfElse"],["fail_state",""],[1,"relative"],[1,"p-4","text-xl"],N,[1,"p-4",3,"formGroup"],[1,"flex","flex-col","mb-4"],u,["formControlName","travelled",1,"space-x-2"],[3,"value"],R,["formControlName","unwell",1,"space-x-2"],[1,"flex","flex-col"],l,["formControlName","contact",1,"space-x-2"],[1,"flex","justify-center","items-center","p-2"],["btn","","matRipple","",3,"click"],I,["close","","icon","","matRipple","","mat-dialog-close",""],[1,"material-icons"],["failure","",1,"pt-8","relative"],[1,"p-4"],c]},template:function(u,R){if(1&u&&(i.YNc(0,B,37,7,"div",0),i.YNc(1,P,6,0,"ng-template",null,1,i.W1O)),2&u){const l=i.MAs(2);i.Q6J("ngIf",!R.failure)("ngIfElse",l)}},dependencies:[d.O5,K.JJ,K.JL,K.sg,K.u,e.VQ,e.U0,L.ZT,s.wG],styles:["main[_ngcontent-%COMP%]{width:24rem;max-width:calc(100vw - 4.5rem)}[close][_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem}"]})},7121:(Q,w,n)=>{n.d(w,{A:()=>R});var i=n(5861),K=n(6221),o=n(8186),d=n(591),e=n(3426),L=n(1086),s=n(2198),B=n(7545),P=n(7221),M=n(4850),N=n(5154),u=n(4650);class R{setLevel(I){this._level.next(I)}constructor(I){this._org=I,this._level=new d.X(""),this._change=new d.X(0),this.lockers_banks$=(0,e.aj)([this._org.active_building,this._change]).pipe((0,s.h)(([c])=>!!c),(0,B.w)(([c])=>(0,o.rlq)(c.id,"lockers").pipe((0,P.K)(()=>(0,L.of)(new o.k44)))),(0,M.U)(c=>c.details||[]),(0,N.d)(1)),this.lockers$=this.lockers_banks$.pipe((0,M.U)(c=>{const g=[];for(const S of c)g.push(...S.lockers.map(x=>({...x,bank_id:S.id})));return g})),this.filtered_lockers$=(0,e.aj)([this._level,this.lockers$]).pipe((0,M.U)(([c,g])=>g.filter(S=>(!c||S.level_id===c)&&S.bookable)))}saveLockers(I){var c=this;return(0,i.Z)(function*(){yield(0,o.Ymr)(c._org.building.id,{name:"lockers",description:"",details:I}),c._change.next(Date.now())})()}}R.\u0275fac=function(I){return new(I||R)(u.LFG(K.w7))},R.\u0275prov=u.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"})},6168:(Q,w,n)=>{function i(o){var d=this;o="object"==typeof o?o:{},d.revision=3,d.imageTypes={bmp:"image/bmp",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpg",png:"image/png","svg+xml":"image/svg+xml",tiff:"image/tiff",webp:"image/webp","x-icon":"image/x-icon"},d.toTable=o.toTable,d.domElement=d.toTable?document.createElement("div"):document.createElement("canvas"),d.url=o.url||"",d.size=o.size||280,d.qrc=!1,d.colorLight=o.colorLight||"#fff",d.colorDark=o.colorDark||"#000",d.ecclevel=o.ecclevel||1,d.noBorder=o.noBorder,d.borderSize=o.borderSize||4;var e,L,s,B,P,M,N,u=[],R=[],l=[],I=[],c=[],g=[],S=function(r,_){var t;r>_&&(t=r,r=_,_=t),t=_,t*=_,t+=_,t>>=1,I[t+=r]=1},x=function(r,_){var t;for(l[r+s*_]=1,t=-2;t<2;t++)l[r+t+s*(_-2)]=1,l[r-2+s*(_+t+1)]=1,l[r+2+s*(_+t)]=1,l[r+t+1+s*(_+2)]=1;for(t=0;t<2;t++)S(r-1,_+t),S(r+1,_-t),S(r-t,_-1),S(r+t,_+1)},T=function(r){for(;r>=255;)r=((r-=255)>>8)+(255&r);return r},D=function(r,_,t,a){var E,b,p,y=i.gexp,Y=i.glog;for(E=0;E<a;E++)u[t+E]=0;for(E=0;E<_;E++){if(255!=(p=Y[u[r+E]^u[t]]))for(b=1;b<a;b++)u[t+b-1]=u[t+b]^y[T(p+g[a-b])];else for(b=t;b<t+a;b++)u[b]=u[b+1];u[t+a-1]=255==p?0:y[T(p+g[0])]}},O=function(r,_){var t;return r>_&&(t=r,r=_,_=t),t=_,t+=_*_,t>>=1,I[t+=r]},C=function(r){var _,t,a,E;switch(r){case 0:for(t=0;t<s;t++)for(_=0;_<s;_++)_+t&1||O(_,t)||(l[_+t*s]^=1);break;case 1:for(t=0;t<s;t++)for(_=0;_<s;_++)1&t||O(_,t)||(l[_+t*s]^=1);break;case 2:for(t=0;t<s;t++)for(a=0,_=0;_<s;_++,a++)3==a&&(a=0),a||O(_,t)||(l[_+t*s]^=1);break;case 3:for(E=0,t=0;t<s;t++,E++)for(3==E&&(E=0),a=E,_=0;_<s;_++,a++)3==a&&(a=0),a||O(_,t)||(l[_+t*s]^=1);break;case 4:for(t=0;t<s;t++)for(a=0,E=t>>1&1,_=0;_<s;_++,a++)3==a&&(a=0,E=!E),E||O(_,t)||(l[_+t*s]^=1);break;case 5:for(E=0,t=0;t<s;t++,E++)for(3==E&&(E=0),a=0,_=0;_<s;_++,a++)3==a&&(a=0),(_&t&1)+!(!a|!E)||O(_,t)||(l[_+t*s]^=1);break;case 6:for(E=0,t=0;t<s;t++,E++)for(3==E&&(E=0),a=0,_=0;_<s;_++,a++)3==a&&(a=0),(_&t&1)+(a&&a==E)&1||O(_,t)||(l[_+t*s]^=1);break;case 7:for(E=0,t=0;t<s;t++,E++)for(3==E&&(E=0),a=0,_=0;_<s;_++,a++)3==a&&(a=0),(a&&a==E)+(_+t&1)&1||O(_,t)||(l[_+t*s]^=1)}},f=function(r){var _,t=0;for(_=0;_<=r;_++)c[_]>=5&&(t+=i.N1+c[_]-5);for(_=3;_<r-1;_+=2)c[_-2]==c[_+2]&&c[_+2]==c[_-1]&&c[_-1]==c[_+1]&&3*c[_-1]==c[_]&&(0==c[_-3]||_+3>r||3*c[_-3]>=4*c[_]||3*c[_+3]>=4*c[_])&&(t+=i.N3);return t},A=function(){var r,_,t,a,E,b=0,p=0;for(_=0;_<s-1;_++)for(r=0;r<s-1;r++)(l[r+s*_]&&l[r+1+s*_]&&l[r+s*(_+1)]&&l[r+1+s*(_+1)]||!(l[r+s*_]||l[r+1+s*_]||l[r+s*(_+1)]||l[r+1+s*(_+1)]))&&(b+=i.N2);for(_=0;_<s;_++){for(c[0]=0,t=a=r=0;r<s;r++)(E=l[r+s*_])==a?c[t]++:c[++t]=1,p+=(a=E)?1:-1;b+=f(t)}p<0&&(p=-p);var y=p,Y=0;for(y+=y<<2,y<<=1;y>s*s;)y-=s*s,Y++;for(b+=Y*i.N4,r=0;r<s;r++){for(c[0]=0,t=a=_=0;_<s;_++)(E=l[r+s*_])==a?c[t]++:c[++t]=1,a=E;b+=f(t)}return b};d.genframe=function(r){var _,t,a,E,b,p,y,Y,J=i.eccblocks,m=i.gexp,h=i.glog;E=r.length,L=0;do{if(L++,a=4*(e-1)+16*(L-1),B=J[a++],P=J[a++],M=J[a++],N=J[a],E<=(a=M*(B+P)+P-3+(L<=9)))break}while(L<40);for(s=17+4*L,b=M+(M+N)*(B+P)+P,E=0;E<b;E++)R[E]=0;for(u=r.slice(0),E=0;E<s*s;E++)l[E]=0;for(E=0;E<(s*(s+1)+1)/2;E++)I[E]=0;for(E=0;E<3;E++){for(a=0,t=0,1==E&&(a=s-7),2==E&&(t=s-7),l[t+3+s*(a+3)]=1,_=0;_<6;_++)l[t+_+s*a]=1,l[t+s*(a+_+1)]=1,l[t+6+s*(a+_)]=1,l[t+_+1+s*(a+6)]=1;for(_=1;_<5;_++)S(t+_,a+1),S(t+1,a+_+1),S(t+5,a+_),S(t+_+1,a+5);for(_=2;_<4;_++)l[t+_+s*(a+2)]=1,l[t+2+s*(a+_+1)]=1,l[t+4+s*(a+_)]=1,l[t+_+1+s*(a+4)]=1}if(L>1)for(E=i.adelta[L],t=s-7;;){for(_=s-7;_>E-3&&(x(_,t),!(_<E));)_-=E;if(t<=E+9)break;x(6,t-=E),x(t,6)}for(l[8+s*(s-8)]=1,t=0;t<7;t++)S(7,t),S(s-8,t),S(7,t+s-7);for(_=0;_<8;_++)S(_,7),S(_+s-8,7),S(_,s-8);for(_=0;_<9;_++)S(_,8);for(_=0;_<8;_++)S(_+s-8,8),S(8,_);for(t=0;t<7;t++)S(8,t+s-7);for(_=0;_<s-14;_++)1&_?(S(8+_,6),S(6,8+_)):(l[8+_+6*s]=1,l[6+s*(8+_)]=1);if(L>6)for(E=i.vpat[L-7],a=17,_=0;_<6;_++)for(t=0;t<3;t++,a--)1&(a>11?L>>a-12:E>>a)?(l[5-_+s*(2-t+s-11)]=1,l[2-t+s-11+s*(5-_)]=1):(S(5-_,2-t+s-11),S(2-t+s-11,5-_));for(t=0;t<s;t++)for(_=0;_<=t;_++)l[_+s*t]&&S(_,t);for(b=u.length,p=0;p<b;p++)R[p]=u.charCodeAt(p);if(u=R.slice(0),b>=(_=M*(B+P)+P)-2&&(b=_-2,L>9&&b--),p=b,L>9){for(u[p+2]=0,u[p+3]=0;p--;)u[p+3]|=255&(E=u[p])<<4,u[p+2]=E>>4;u[2]|=255&b<<4,u[1]=b>>4,u[0]=64|b>>12}else{for(u[p+1]=0,u[p+2]=0;p--;)u[p+2]|=255&(E=u[p])<<4,u[p+1]=E>>4;u[1]|=255&b<<4,u[0]=64|b>>4}for(p=b+3-(L<10);p<_;)u[p++]=236,u[p++]=17;for(g[0]=1,p=0;p<N;p++){for(g[p+1]=1,y=p;y>0;y--)g[y]=g[y]?g[y-1]^m[T(h[g[y]]+p)]:g[y-1];g[0]=m[T(h[g[0]]+p)]}for(p=0;p<=N;p++)g[p]=h[g[p]];for(a=_,t=0,p=0;p<B;p++)D(t,M,a,N),t+=M,a+=N;for(p=0;p<P;p++)D(t,M+1,a,N),t+=M+1,a+=N;for(t=0,p=0;p<M;p++){for(y=0;y<B;y++)R[t++]=u[p+y*M];for(y=0;y<P;y++)R[t++]=u[B*M+p+y*(M+1)]}for(y=0;y<P;y++)R[t++]=u[B*M+p+y*(M+1)];for(p=0;p<N;p++)for(y=0;y<B+P;y++)R[t++]=u[_+p+y*N];for(u=R,_=t=s-1,a=b=1,Y=(M+N)*(B+P)+P,p=0;p<Y;p++)for(E=u[p],y=0;y<8;y++,E<<=1){128&E&&(l[_+s*t]=1);do{b?_--:(_++,a?0!=t?t--:(a=!a,6==(_-=2)&&(_--,t=9)):t!=s-1?t++:(a=!a,6==(_-=2)&&(_--,t-=8))),b=!b}while(O(_,t))}for(u=l.slice(0),E=0,t=3e4,a=0;a<8&&(C(a),(_=A())<t&&(t=_,E=a),7!=E);a++)l=u.slice(0);for(E!=a&&C(E),t=i.fmtword[E+(e-1<<3)],a=0;a<8;a++,t>>=1)1&t&&(l[s-1-a+8*s]=1,a<6?l[8+s*a]=1:l[8+s*(a+1)]=1);for(a=0;a<7;a++,t>>=1)1&t&&(l[8+s*(s-7+a)]=1,a?l[6-a+8*s]=1:l[7+8*s]=1);return l},d.init=function(){e=d.ecclevel;var r=d.genframe(d.url);d.toTable?d.tableWrite(r,s):d.canvasWrite(r,s)},d.init()}function K(o,d="#fff0",e="#000"){return new i({url:o||"Hello",size:360,colorLight:d,colorDark:e,toTable:!1,ecclevel:1,noBorder:!0,borderSize:0})?.toImage("svg+xml")?.src}n.d(w,{w:()=>K}),i.prototype={canvasWrite:function(o,d){if(!this.qrc&&(this.qrc=this.getContext(this.domElement),!this.qrc))return this.toTable=!0,this.domElement=document.createElement("div"),void this.tableWrite(o,d);var e=this.size,L=this.qrc;L.lineWidth=1;var s=e;s/=d+10,s=Math.round(s-.5);var B=4;this.noBorder?(L.canvas.width=L.canvas.height=s*d,B=0):L.canvas.width=L.canvas.height=e,L.clearRect(0,0,e,e),L.fillStyle=this.colorLight,L.fillRect(0,0,s*(d+8),s*(d+8)),L.fillStyle=this.colorDark;for(var P=0;P<d;P++)for(var M=0;M<d;M++)o[M*d+P]&&L.fillRect(s*(B+P),s*(B+M),s,s)},tableWrite:function(o,d){var e=this,L=Math.round(this.size/d-3.5)+"px",s=d+(e.noBorder?0:2*e.borderSize),B=e.borderSize,P="width:"+L+";height:"+L+";",M=e.colorLight,N=e.colorDark,u=document.createElement("table");u.style.cssText="border:0;border-collapse:collapse;";for(var R,l=document.createElement("tr"),I=document.createElement("td"),c=function(){return I.cloneNode()},g=function(){var f=c();return f.style.cssText=P+"background:"+M,f},S=function(f){for(var A=f.firstChild,r=0;r<B;r++)f.insertBefore(g(),A),f.appendChild(g())},x=0;x<d;x++){var T=l.cloneNode();u.appendChild(T);for(var D=0;D<d;D++)if(1===o[x*d+D]){var O=(R=void 0,(R=c()).style.cssText=P+"background:"+N,R);T.appendChild(O)}else{var C=g();T.appendChild(C)}e.noBorder||S(T)}e.noBorder||function(f){for(var A=f.firstChild,r=0;r<e.borderSize;r++){for(var _=l.cloneNode(),t=0;t<s;t++){var a=g();_.appendChild(a)}f.appendChild(_),f.insertBefore(_.cloneNode(!0),A)}}(u),e.domElement.innerHTML="",e.domElement.appendChild(u)},getContext:function(o){return o.getContext&&o.getContext("2d")?o.getContext("2d"):(console.log("Browser does not have 2d Canvas support"),!1)},toImage:function(o){if(this.qrc){var d=this.imageTypes[o];if(!d)throw new Error(o+" is not a valid image type ");var e=new Image;return e.src=this.domElement.toDataURL(d),e}}},i.adelta=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],i.vpat=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],i.fmtword=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],i.eccblocks=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],i.glog=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],i.gexp=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],i.N1=3,i.N2=3,i.N3=40,i.N4=10},3496:(Q,w,n)=>{n.d(w,{m:()=>s});var i=n(5938),K=n(719),o=n(6168),d=n(4650),e=n(5306);class s{constructor(P,M){this._data=P,this._settings=M,this.space=this._data.space,this.qr_code=(0,o.w)(`${location.origin}${(this._settings.get("app.booking_qr_path")||"workplace/#/explore?space={{id}}").replace("{{id}}",this._data.space?.email)}`)}}s.\u0275fac=function(P){return new(P||s)(d.Y36(i.WI),d.Y36(K.g))},s.\u0275cmp=d.Xpm({type:s,selectors:[["explore-book-qr"]],decls:9,vars:2,consts:function(){let B;return B=$localize`:␟cbd43c9fe40f6bb5fd5497b1436b4dce15539dfb␟381017318285325317:Book - ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[1,"truncate"],B,[1,"flex-1"],["icon","","mat-dialog-close",""],[1,"p-4"],[1,"w-64","h-64","m-auto",3,"src"]]},template:function(P,M){1&P&&(d.TgZ(0,"header")(1,"h2",0),d.SDv(2,1),d.qZA(),d._UZ(3,"div",2),d.TgZ(4,"button",3)(5,"app-icon"),d._uU(6,"close"),d.qZA()()(),d.TgZ(7,"main",4),d._UZ(8,"img",5),d.qZA()),2&P&&(d.xp6(2),d.pQV(null==M.space?null:M.space.name),d.QtT(2),d.xp6(6),d.Q6J("src",M.qr_code,d.LSH))},dependencies:[e.o,i.ZT]})},1718:(Q,w,n)=>{n.d(w,{w:()=>D});var i=n(5861),K=n(5938),o=n(9112),d=n(8943),e=n(4650),L=n(3007),s=n(6895),B=n(5306),P=n(9549),M=n(3238),N=n(4144),u=n(1572),R=n(4006),l=n(1022);function I(O,C){1&O&&(e.TgZ(0,"button",5)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function c(O,C){if(1&O&&(e.TgZ(0,"div",11)(1,"label"),e.SDv(2,21),e.qZA(),e.TgZ(3,"div",22),e._uU(4),e.ALo(5,"date"),e.qZA()()),2&O){const f=e.oxw(3);e.xp6(4),e.hij(" ",e.xi3(5,1,null==f.form.controls.date?null:f.form.controls.date.value,"medium")," ")}}function g(O,C){if(1&O&&(e.TgZ(0,"div",23)(1,"label"),e.SDv(2,24),e.qZA(),e._UZ(3,"a-duration-field",25),e.qZA()),2&O){const f=e.oxw(3);e.xp6(3),e.Q6J("time",f.form.value.date)("max",f.max_duration)}}function S(O,C){if(1&O&&(e.TgZ(0,"main",10)(1,"div",11)(2,"label",12),e._uU(3,"Title"),e.TgZ(4,"span"),e._uU(5,"*"),e.qZA(),e._uU(6,":"),e.qZA(),e.TgZ(7,"mat-form-field",13),e._UZ(8,"input",14),e.TgZ(9,"mat-error"),e.SDv(10,15),e.qZA()()(),e.TgZ(11,"div",11)(12,"label"),e.SDv(13,16),e.qZA(),e.TgZ(14,"div",17),e._uU(15),e.qZA()(),e.TgZ(16,"div",18),e.YNc(17,c,6,4,"div",19),e.YNc(18,g,4,2,"div",20),e.qZA()()),2&O){const f=e.oxw(2);e.Q6J("formGroup",f.form),e.xp6(15),e.hij(" ",(null==f.form.controls.resources||null==f.form.controls.resources.value[0]?null:f.form.controls.resources.value[0].display_name)||(null==f.form.controls.resources||null==f.form.controls.resources.value[0]?null:f.form.controls.resources.value[0].name)," "),e.xp6(2),e.Q6J("ngIf",f.form.controls.date),e.xp6(1),e.Q6J("ngIf",f.form.controls.duration)}}function x(O,C){if(1&O){const f=e.EpF();e.ynx(0),e.YNc(1,S,19,4,"main",6),e.TgZ(2,"footer",7)(3,"button",8),e.NdJ("click",function(){e.CHM(f);const r=e.oxw();return e.KtG(r.save())}),e.SDv(4,9),e.qZA()(),e.BQk()}if(2&O){const f=e.oxw();e.xp6(1),e.Q6J("ngIf",f.form)}}function T(O,C){if(1&O&&(e.TgZ(0,"div",26),e._UZ(1,"mat-spinner",27),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"async"),e.qZA()()),2&O){const f=e.oxw();e.xp6(1),e.Q6J("diameter",48),e.xp6(2),e.Oqu(e.lcZ(4,2,f.loading))}}class D{get form(){return this._event_form.form}get max_duration(){return this._settings.get("app.events.max_duration")||240}constructor(C,f,A,r,_){this._data=C,this._settings=f,this._event_form=A,this._dialog_ref=r,this._router=_,this.loading=this._event_form.loading}ngOnInit(){this._event_form.newForm(),this.form.patchValue({resources:[this._data.space],host:(0,o.ar)().email,organiser:(0,o.ar)()})}save(){var C=this;return(0,i.Z)(function*(){yield C._event_form.postForm(),C._settings.app_name.toLowerCase().includes("workplace")?C._router.navigate(["/book","meeting","success"]):(0,o.t5)("Succefully booked room."),C._dialog_ref.close()})()}}D.\u0275fac=function(C){return new(C||D)(e.Y36(K.WI),e.Y36(o.gb),e.Y36(d.M),e.Y36(K.so),e.Y36(L.F0))},D.\u0275cmp=e.Xpm({type:D,selectors:[["explore-booking-modal"]],decls:10,vars:7,consts:function(){let O,C,f,A,r,_,t;return O=$localize`:␟bd532c9813cc0577fcc3ff32640a61afef2bf40a␟6464057252608386690:New Booking`,C=$localize`:␟2fa313c798ad138557539ba3c6a3bfdc426eaaa2␟2367152680379951719: Save `,f=$localize`:␟5cf0071757dd8065e052662e4d191a210c766579␟2997066279074525950:Booking Title`,A=$localize`:␟35a900d9fa8e824539ca4b0d1a10bd2f7f8c1172␟8953173802652113530:Booking title is required`,r=$localize`:␟0f342dcd63b8732a5599eb91ce166b55335dbbc4␟1329943553963489238:Space:`,_=$localize`:␟05fa0bded36de6e73a1fa44838b627349dace044␟6899410641137821757:Date:`,t=$localize`:␟e17a1d75189da843f541f7764f188f2b19a97df2␟4220765745195024064:Duration:`,[O,[1,"flex-1"],["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["icon","","matRipple","","mat-dialog-close",""],["class","p-4 max-w-[85vw]",3,"formGroup",4,"ngIf"],[1,"flex","justify-center","p-2","border-t","border-gray-200"],["btn","","matRipple","",1,"w-32",3,"click"],C,[1,"p-4","max-w-[85vw]",3,"formGroup"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","title","formControlName","title","placeholder",f],A,r,["name","space",1,"sm:mt-4","mb-4"],[1,"flex","sm:space-x-4","flex-wrap"],["class","flex flex-col",4,"ngIf"],["class","flex flex-col w-full sm:w-auto",4,"ngIf"],_,[1,"sm:mt-4","mb-4"],[1,"flex","flex-col","w-full","sm:w-auto"],t,["formControlName","duration",1,"w-full",3,"time","max"],["load","",1,"h-64","flex","flex-col","items-center","justify-center"],[1,"m-4",3,"diameter"]]},template:function(C,f){if(1&C&&(e.TgZ(0,"header")(1,"h2"),e.SDv(2,0),e.qZA(),e._UZ(3,"div",1),e.YNc(4,I,3,0,"button",2),e.ALo(5,"async"),e.qZA(),e.YNc(6,x,5,1,"ng-container",3),e.ALo(7,"async"),e.YNc(8,T,5,4,"ng-template",null,4,e.W1O)),2&C){const A=e.MAs(9);e.xp6(4),e.Q6J("ngIf",!e.lcZ(5,3,f.loading)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(7,5,f.loading))("ngIfElse",A)}},dependencies:[s.O5,B.o,P.KE,P.TO,M.wG,K.ZT,N.Nt,u.Ou,R.Fj,R.JJ,R.JL,R.sg,R.u,l.B,s.Ov,s.uU],styles:["header[_ngcontent-%COMP%]{max-width:calc(100vw + 100%)}[load][_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem)}"]})},9275:(Q,w,n)=>{n.d(w,{i:()=>R});var i=n(719),K=n(9136),o=n(4650),d=n(6895),e=n(3970);function L(l,I){if(1&l&&o._UZ(0,"img",17),2&l){const c=o.oxw(2);o.Q6J("src",c.space.images[0],o.LSH)}}function s(l,I){1&l&&o._UZ(0,"div",18)}function B(l,I){if(1&l&&(o.TgZ(0,"div",19),o._uU(1),o.qZA()),2&l){const c=o.oxw(2);o.xp6(1),o.hij(" ",c.available_until," ")}}function P(l,I){if(1&l&&(o.TgZ(0,"div",20)(1,"span"),o.SDv(2,21),o.qZA(),o._uU(3),o.qZA()),2&l){const c=o.oxw(2);o.xp6(3),o.AsE("",c.space.capacity," ",1===c.space.capacity?"person":"people"," ")}}function M(l,I){if(1&l&&(o.TgZ(0,"li",24),o._uU(1),o.qZA()),2&l){const c=I.$implicit;o.xp6(1),o.hij(" ",c," ")}}function N(l,I){if(1&l&&(o.TgZ(0,"ul",22),o.YNc(1,M,2,1,"li",23),o.qZA()),2&l){const c=o.oxw(2);o.xp6(1),o.Q6J("ngForOf",c.space.features)}}function u(l,I){if(1&l&&(o.TgZ(0,"div",3),o._UZ(1,"div",4),o.TgZ(2,"div",5)(3,"div",6),o.YNc(4,L,1,1,"img",7),o.YNc(5,s,1,0,"div",8),o.qZA(),o.TgZ(6,"div",9)(7,"div",10),o._uU(8," "),o.SDv(9,11),o._uU(10," "),o.qZA(),o.YNc(11,B,2,1,"div",12),o.qZA(),o.TgZ(12,"div",13)(13,"h4",14),o._uU(14),o.qZA(),o.YNc(15,P,4,2,"div",15),o.YNc(16,N,2,1,"ul",16),o.qZA()()()),2&l){const c=o.oxw();o.ekj("-translate-x-full","end"===c.x_pos)("-translate-y-full","bottom"===c.y_pos),o.Q6J("id",null==c.space?null:c.space.id),o.xp6(3),o.ekj("bg-black",c.space.images[0])("h-32",c.space.images[0])("h-8",!c.space.images[0]),o.xp6(1),o.Q6J("ngIf",c.space.images[0]),o.xp6(1),o.Q6J("ngIf",c.space.images[0]),o.xp6(2),o.Tol("capitalize rounded p-1 px-2 text-light border border-white shadow "+c.status),o.xp6(2),o.pQV(c.status),o.QtT(9),o.xp6(2),o.Q6J("ngIf","not-bookable"!==c.status),o.xp6(3),o.hij(" ",c.space.display_name||c.space.name," "),o.xp6(1),o.Q6J("ngIf",c.space.capacity>=0),o.xp6(1),o.Q6J("ngIf",(null==c.space.features?null:c.space.features.length)>0&&c.show_features)}}class R{get show_features(){return!this._settings.get("app.spaces.hide_features")}constructor(I,c,g){this._details=I,this._settings=c,this._element=g,this.space=this._details.space,this.events=this._details.events,this.status=this._details.status}ngOnInit(){setTimeout(()=>this.updateOffset(),200)}updateOffset(){const I=this._element.nativeElement.getBoundingClientRect();this.x_pos=I.x<document.body.clientWidth/2?"start":"end",this.y_pos=I.y<document.body.clientHeight/2?"top":"bottom"}get available_until(){return""}}R.\u0275fac=function(I){return new(I||R)(o.Y36(K.u),o.Y36(i.g),o.Y36(o.SBq))},R.\u0275cmp=o.Xpm({type:R,selectors:[["explore-space-info"]],decls:4,vars:7,consts:function(){let l,I;return l=$localize`:␟86e6b3a473ea3e05830d2aef91c81199de1b9d33␟3658078071800974217:{VAR_SELECT, select, free {Free } busy {Busy } pending {Pending } reserved {Reserved } other {Not Bookable }}`,l=o.Zx4(l,{VAR_SELECT:"\ufffd0\ufffd"}),I=$localize`:␟36c2a5db33c6cfc9e239e589f975f5492bbb0550␟2292396409867038415:Capacity: `,[["customTooltip","",1,"h-full","w-full","pointer-events-auto","relative","hidden","sm:block",3,"content","backdrop","xPosition","yPosition","hover","delay","mouseenter"],["tooltip",""],["space_tooltip",""],["name","space-info",1,"absolute","rounded","bg-white","dark:bg-neutral-800","top-0","left-0","transform","shadow","pointer-events-none","overflow-hidden",3,"id"],[1,"arrow"],[1,"relative"],[1,"w-full","overflow-hidden","flex","items-center","justify-center","relative","bg-opacity-20"],["class","object-cover min-h-full min-w-full",3,"src",4,"ngIf"],["class","absolute inset-0 bg-black/30",4,"ngIf"],[1,"absolute","top-2","left-2","flex","flex-wrap","text-sm"],["status",""],l,["available-until","",4,"ngIf"],[1,"flex","flex-col","py-4","px-2"],[1,"font-medium","text-xl","mb-2","px-2"],["capacity","","class","text-base px-2 mb-2",4,"ngIf"],["class","flex flex-wrap",4,"ngIf"],[1,"object-cover","min-h-full","min-w-full",3,"src"],[1,"absolute","inset-0","bg-black/30"],["available-until",""],["capacity","",1,"text-base","px-2","mb-2"],I,[1,"flex","flex-wrap"],["class","text-xs px-2 py-1 m-1 rounded-2xl bg-gray-200 dark:bg-neutral-600 font-medium",4,"ngFor","ngForOf"],[1,"text-xs","px-2","py-1","m-1","rounded-2xl","bg-gray-200","dark:bg-neutral-600","font-medium"]]},template:function(I,c){if(1&I&&(o.TgZ(0,"div",0,1),o.NdJ("mouseenter",function(){return c.updateOffset()}),o.qZA(),o.YNc(2,u,17,20,"ng-template",null,2,o.W1O)),2&I){const g=o.MAs(3);o.Q6J("content",g)("backdrop",!1)("xPosition","center")("yPosition","center")("hover",!0)("delay",3e3),o.uIk("id",(null==c.space?null:c.space.map_id)||(null==c.space?null:c.space.id))}},dependencies:[d.sg,d.O5,e.X],styles:["[name=space-info][_ngcontent-%COMP%]{width:16rem}[status][_ngcontent-%COMP%]{background-color:#43a047;font-weight:500}[status].busy[_ngcontent-%COMP%]{background-color:#e53935}[status].pending[_ngcontent-%COMP%]{background-color:#ffb300}[status].not-bookable[_ngcontent-%COMP%]{background-color:#757575}"]})},6888:(Q,w,n)=>{n.d(w,{a:()=>I,y:()=>l});var i=n(8186),K=n(4850),o=n(9112),d=n(8296),e=n(656),L=n(3902),s=n(6667),B=n(9275),P=n(1718),M=n(3496),N=n(8943),u=n(4650),R=n(5938);const l={free:"#43a047",pending:"#ffb300",reserved:"#e65100",busy:"#e53935","signs-of-life":"#1565c0","not-bookable":"#757575",unknown:"#757575"};class I extends o.cx{constructor(g,S,x,T){super(),this._state=g,this._settings=S,this._event_form=x,this._dialog=T,this._bookings={},this._statuses={},this._bind=this._state.spaces.pipe((0,K.U)(D=>{if(this.unsubWith("b-"),this.unsubWith("s-"),this._statuses={},D?.length){for(const O of D){const C=(0,i.rTZ)(O.id,"Bookings");let f=C.binding("bookings");this.subscription(`b-${O.id}`,f.listen().subscribe(A=>this.handleBookingsChange(D,O,A))),this.subscription(`b-bind-${O.id}`,f.bind()),f=C.binding("status"),this.subscription(`s-${O.id}`,f.listen().subscribe(A=>this.handleStatusChange(D,O,A))),this.subscription(`s-bind-${O.id}`,f.bind())}this.updateActions(D),this.updateHoverElements(D)}})),this.subscription("spaces",this._bind.subscribe())}bookSpace(g){return"free"===this._statuses[g.id]&&g.bookable?(this._event_form.newForm(),this._event_form.form.patchValue({host:(0,o.ar)()?.email,resources:[g]}),this._settings.get("app.events.booking_unavailable")?this._event_form.openEventLinkModal():void this._dialog.open(this._settings.get("app.explore.show_booking_qr")?M.m:P.w,{data:{space:g}})):(0,d.cB)(`${g.display_name||g.name} is unavailable at the current time`)}handleBookingsChange(g,S,x){x&&(this._bookings[S.id]=x.map(T=>new L.y(T)),this.timeout("update_hover_els",()=>this.updateHoverElements(g),100))}handleStatusChange(g,S,x){this._statuses[S.id]=S.bookable?x||"free":"not-bookable",this.timeout("update_statuses",()=>{this.clearTimeout("update_hover_els"),this.updateStatus(g),this.updateHoverElements(g)},100)}updateStatus(g){const S={},x=this._settings.get("app.explore.colors")||{};for(const T of g){const D=this._statuses[T.id]||"not-bookable";S[`#${T.map_id}`]={fill:x[`space-${D}`]||x[`${D}`]||l[`${D}`],opacity:.6}}this._state.setStyles("spaces",S)}updateHoverElements(g){const S=[];for(const x of g)x.map_id&&S.push({location:x.map_id,full_size:!0,no_scale:!0,content:B.i,data:{space:new e.T(x),events:this._bookings[x.id],status:this._statuses[x.id]}});this._state.setFeatures("spaces",S)}updateActions(g){const S=[];for(const x of g)x.map_id&&(S.push({id:x.map_id,action:"click",callback:()=>this.bookSpace(x)}),S.push({id:x.map_id,action:"touchend",callback:()=>this.bookSpace(x)}));this.timeout("set-actions",()=>this._state.setActions("spaces",S),50)}}I.\u0275fac=function(g){return new(g||I)(u.LFG(s.c),u.LFG(o.gb),u.LFG(N.M),u.LFG(R.uw))},I.\u0275prov=u.Yz7({token:I,factory:I.\u0275fac})},6667:(Q,w,n)=>{n.d(w,{c:()=>S});var i=n(5861),K=n(8186),o=n(591),d=n(1086),e=n(3426),L=n(7545),s=n(4850),B=n(7221),P=n(5154),M=n(13),N=n(7224),u=n(2198),R=n(9112),l=n(565),I=n(656),c=n(73),g=n(4650);class S extends R.cx{get positions(){return this._positions.getValue()}get active_level(){return this._level.getValue()}constructor(T,D,O){super(),this._org=T,this._spaces=D,this._settings=O,this._level=new o.X(null),this._positions=new o.X({zoom:1,center:{x:.5,y:.5}}),this._styles=new o.X({}),this._features=new o.X({}),this._actions=new o.X({}),this._labels=new o.X({}),this._options=new o.X({disable:["zones","devices"]}),this._message=new o.X(""),this.level=this._level.asObservable(),this.message=this._message.asObservable(),this.spaces=this._level.pipe((0,L.w)(C=>(0,K.vIL)({zone_id:C?.id,limit:50}).pipe((0,s.U)(({data:f})=>f.map(A=>new I.T(A))),(0,B.K)(f=>(0,d.of)([])))),(0,P.d)(1)),this.map_url=this._level.pipe((0,s.U)(C=>(C?C.map_id:"")||"")),this.map_positions=this._positions.asObservable(),this.map_features=(0,e.aj)([this._features,this._options]).pipe((0,M.b)(200),(0,s.U)(([C,f])=>{let A=[];for(const r in C)f.disable?.includes(r)||f.disable_features?.includes(r)||(A=A.concat(C[r]));return A})),this.map_actions=(0,e.aj)([this._actions,this._options]).pipe((0,M.b)(200),(0,s.U)(([C,f])=>{let A=[];for(const r in C)f.disable?.includes(r)||f.disable_actions?.includes(r)||(A=A.concat(C[r]));return A})),this.map_labels=(0,e.aj)([this._labels,this._options]).pipe((0,M.b)(200),(0,s.U)(([C,f])=>{let A=[];for(const r in C)f.disable?.includes(r)||f.disable_labels?.includes(r)||(A=A.concat(C[r]));return A})),this.map_styles=(0,e.aj)([this._styles,this._options]).pipe((0,M.b)(200),(0,s.U)(([C,f])=>{let A={text:{display:"none"}};for(const r in C)f.disable?.includes(r)||f.disable_styles?.includes(r)||(A={...A,...C[r]});return f.disable?.includes("zones")&&(A["#zones"]={display:"none"},A["#Zones"]={display:"none"}),A})),this.options=this._options.asObservable(),this.init()}init(){var T=this;return(0,i.Z)(function*(){yield T._org.initialised.pipe((0,N.P)(D=>D)).toPromise(),T._org.active_building.pipe((0,u.h)(D=>!!D)).subscribe(D=>{const O=T._level.getValue(),C=T._org.levelsForBuilding(D);!C.find(A=>O?.id===A.id)&&C.length&&T.setLevel(C[0].id),T._settings.get("app.explore.disable_actions")&&T.setOptions({disable_actions:T._settings.get("app.explore.disable_actions")}),T._settings.get("app.explore.disable_labels")&&T.setOptions({disable_labels:T._settings.get("app.explore.disable_labels")}),T._settings.get("app.explore.disable_features")&&T.setOptions({disable_features:T._settings.get("app.explore.disable_features")}),T._settings.get("app.explore.disable_styles")&&T.setOptions({disable_styles:T._settings.get("app.explore.disable_styles")})})})()}setOptions(T){const D=this._options.getValue(),O=(0,R.Tw)([...T.disable||D.disable,...this._settings.get("app.explore.disable")||[]]);this._options.next({...this._options.getValue(),...T,disable:O})}reset(){this._styles.next({}),this._features.next({}),this._labels.next({}),this._actions.next({}),this.setPositions(1,{x:.5,y:.5})}setLevel(T){const D=this._org.levelWithID([T]);D&&this._level.next(D)}setStyles(T,D){const O=this._styles.getValue();O[T]=D,this._styles.next(O)}setFeatures(T,D){const O=this._features.getValue();O[T]=D,this._features.next(O)}setActions(T,D){const O=this._actions.getValue();O[T]=D,this._actions.next(O)}setLabels(T,D){const O=this._labels.getValue();O[T]=D,this._labels.next(O)}setPositions(T,D){this._positions.next({zoom:T,center:D})}}S.\u0275fac=function(T){return new(T||S)(g.LFG(l.w),g.LFG(c.s),g.LFG(R.gb))},S.\u0275prov=g.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}}]);