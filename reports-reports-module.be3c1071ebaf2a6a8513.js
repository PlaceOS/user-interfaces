(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{uHdG:function(t,e,i){"use strict";i.r(e),i.d(e,"ReportsModule",(function(){return qt}));var n=i("2kYt"),a=i("nIj0"),s=i("sEIs"),o=i("oRDy"),c=i("EM62"),l=i("mFH5"),r=i("PBFl"),b=i("R7+U"),p=i("Y2X+"),d=i("5XID"),g=i("ZTXN"),u=i("29Wa");
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
function h(t,e){if(1&t&&(c.Vb(0,"mat-option",19),c.Lc(1),c.Ub()),2&t){const t=e.$implicit;c.qc("value",t),c.Db(1),c.Nc(" ",t," ")}}function f(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-form-field",16),c.Vb(1,"mat-select",17),c.fc("selectionChange",(function(e){return c.yc(t),c.jc(2)._changePageSize(e.value)})),c.Jc(2,h,2,2,"mat-option",18),c.Ub(),c.Ub()}if(2&t){const t=c.jc(2);c.qc("appearance",t._formFieldAppearance)("color",t.color),c.Db(1),c.qc("value",t.pageSize)("disabled",t.disabled)("aria-label",t._intl.itemsPerPageLabel),c.Db(1),c.qc("ngForOf",t._displayedPageSizeOptions)}}function m(t,e){if(1&t&&(c.Vb(0,"div",20),c.Lc(1),c.Ub()),2&t){const t=c.jc(2);c.Db(1),c.Mc(t.pageSize)}}function v(t,e){if(1&t&&(c.Vb(0,"div",12),c.Vb(1,"div",13),c.Lc(2),c.Ub(),c.Jc(3,f,3,6,"mat-form-field",14),c.Jc(4,m,2,1,"div",15),c.Ub()),2&t){const t=c.jc();c.Db(2),c.Nc(" ",t._intl.itemsPerPageLabel," "),c.Db(1),c.qc("ngIf",t._displayedPageSizeOptions.length>1),c.Db(1),c.qc("ngIf",t._displayedPageSizeOptions.length<=1)}}function _(t,e){if(1&t){const t=c.Wb();c.Vb(0,"button",21),c.fc("click",(function(){return c.yc(t),c.jc().firstPage()})),c.ic(),c.Vb(1,"svg",7),c.Qb(2,"path",22),c.Ub(),c.Ub()}if(2&t){const t=c.jc();c.qc("matTooltip",t._intl.firstPageLabel)("matTooltipDisabled",t._previousButtonsDisabled())("matTooltipPosition","above")("disabled",t._previousButtonsDisabled()),c.Eb("aria-label",t._intl.firstPageLabel)}}function O(t,e){if(1&t){const t=c.Wb();c.ic(),c.hc(),c.Vb(0,"button",23),c.fc("click",(function(){return c.yc(t),c.jc().lastPage()})),c.ic(),c.Vb(1,"svg",7),c.Qb(2,"path",24),c.Ub(),c.Ub()}if(2&t){const t=c.jc();c.qc("matTooltip",t._intl.lastPageLabel)("matTooltipDisabled",t._nextButtonsDisabled())("matTooltipPosition","above")("disabled",t._nextButtonsDisabled()),c.Eb("aria-label",t._intl.lastPageLabel)}}let y=(()=>{class t{constructor(){this.changes=new g.b,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,e,i)=>{if(0==i||0==e)return"0 of "+i;const n=t*e;return`${n+1} \u2013 ${n<(i=Math.max(i,0))?Math.min(n+e,i):n+e} of ${i}`}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Object(c.Lb)({factory:function(){return new t},token:t,providedIn:"root"}),t})();const x={provide:y,deps:[[new c.E,new c.N,y]],useFactory:function(t){return t||new y}},U=new c.t("MAT_PAGINATOR_DEFAULT_OPTIONS");
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */class V{}const P=Object(l.t)(Object(l.v)(V));let D=(()=>{class t extends P{constructor(t,e,i){if(super(),this._intl=t,this._changeDetectorRef=e,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.page=new c.o,this._intlChanges=t.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),i){const{pageSize:t,pageSizeOptions:e,hidePageSize:n,showFirstLastButtons:a}=i;null!=t&&(this._pageSize=t),null!=e&&(this._pageSizeOptions=e),null!=n&&(this._hidePageSize=n),null!=a&&(this._showFirstLastButtons=a)}}get pageIndex(){return this._pageIndex}set pageIndex(t){this._pageIndex=Math.max(Object(d.e)(t),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(t){this._length=Object(d.e)(t),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(t){this._pageSize=Math.max(Object(d.e)(t),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(t){this._pageSizeOptions=(t||[]).map(t=>Object(d.e)(t)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(t){this._hidePageSize=Object(d.b)(t)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(t){this._showFirstLastButtons=Object(d.b)(t)}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex++,this._emitPageEvent(t)}previousPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex--,this._emitPageEvent(t)}firstPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=0,this._emitPageEvent(t)}lastPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(t)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(t){const e=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(e)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._initialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((t,e)=>t-e),this._changeDetectorRef.markForCheck())}_emitPageEvent(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(y),c.Pb(c.h),c.Pb(void 0))},t.\u0275dir=c.Kb({type:t,inputs:{pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",color:"color"},outputs:{page:"page"},features:[c.Ab]}),t})(),w=(()=>{class t extends D{constructor(t,e,i){super(t,e,i),i&&null!=i.formFieldAppearance&&(this._formFieldAppearance=i.formFieldAppearance)}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(y),c.Pb(c.h),c.Pb(U,8))},t.\u0275cmp=c.Jb({type:t,selectors:[["mat-paginator"]],hostAttrs:[1,"mat-paginator"],inputs:{disabled:"disabled"},exportAs:["matPaginator"],features:[c.Ab],decls:14,vars:14,consts:[[1,"mat-paginator-outer-container"],[1,"mat-paginator-container"],["class","mat-paginator-page-size",4,"ngIf"],[1,"mat-paginator-range-actions"],[1,"mat-paginator-range-label"],["mat-icon-button","","type","button","class","mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-paginator-page-size"],[1,"mat-paginator-page-size-label"],["class","mat-paginator-page-size-select",3,"appearance","color",4,"ngIf"],["class","mat-paginator-page-size-value",4,"ngIf"],[1,"mat-paginator-page-size-select",3,"appearance","color"],[3,"value","disabled","aria-label","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(t,e){1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Jc(2,v,5,3,"div",2),c.Vb(3,"div",3),c.Vb(4,"div",4),c.Lc(5),c.Ub(),c.Jc(6,_,3,5,"button",5),c.Vb(7,"button",6),c.fc("click",(function(){return e.previousPage()})),c.ic(),c.Vb(8,"svg",7),c.Qb(9,"path",8),c.Ub(),c.Ub(),c.hc(),c.Vb(10,"button",9),c.fc("click",(function(){return e.nextPage()})),c.ic(),c.Vb(11,"svg",7),c.Qb(12,"path",10),c.Ub(),c.Ub(),c.Jc(13,O,3,5,"button",11),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.Db(2),c.qc("ngIf",!e.hidePageSize),c.Db(3),c.Nc(" ",e._intl.getRangeLabel(e.pageIndex,e.pageSize,e.length)," "),c.Db(1),c.qc("ngIf",e.showFirstLastButtons),c.Db(1),c.qc("matTooltip",e._intl.previousPageLabel)("matTooltipDisabled",e._previousButtonsDisabled())("matTooltipPosition","above")("disabled",e._previousButtonsDisabled()),c.Eb("aria-label",e._intl.previousPageLabel),c.Db(3),c.qc("matTooltip",e._intl.nextPageLabel)("matTooltipDisabled",e._nextButtonsDisabled())("matTooltipPosition","above")("disabled",e._nextButtonsDisabled()),c.Eb("aria-label",e._intl.nextPageLabel),c.Db(3),c.qc("ngIf",e.showFirstLastButtons))},directives:[n.n,r.b,p.a,u.c,b.a,n.m,l.j],styles:[".mat-paginator{display:block}.mat-paginator-outer-container{display:flex}.mat-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap-reverse;width:100%}.mat-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-paginator-page-size{margin-right:0;margin-left:8px}.mat-paginator-page-size-label{margin:0 4px}.mat-paginator-page-size-select{margin:6px 4px 0 4px;width:56px}.mat-paginator-page-size-select.mat-form-field-appearance-outline{width:64px}.mat-paginator-page-size-select.mat-form-field-appearance-fill{width:64px}.mat-paginator-range-label{margin:0 32px 0 24px}.mat-paginator-range-actions{display:flex;align-items:center}.mat-paginator-icon{width:28px;fill:currentColor}[dir=rtl] .mat-paginator-icon{transform:rotate(180deg)}\n"],encapsulation:2,changeDetection:0}),t})(),L=(()=>{class t{}return t.\u0275mod=c.Nb({type:t}),t.\u0275inj=c.Mb({factory:function(e){return new(e||t)},providers:[x],imports:[[n.c,r.c,b.b,p.b,l.h]]}),t})();
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
var j=i("UfDH"),k=i("D57K"),z=i("jOdJ"),S=i("20lr"),M=i("/It1"),I=i("05Mk"),T=i("eZII"),F=i("9MvL"),q=i("KuCG"),E=i("JuBR"),J=i("njY1"),C=i("mrqE"),B=864e5;function R(t,e){Object(C.a)(2,arguments);var i=Object(F.a)(t),n=Object(F.a)(e),a=i.getTime()-Object(J.a)(i),s=n.getTime()-Object(J.a)(n);return Math.round((a-s)/B)}function N(t,e){var i=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return i<0?-1:i>0?1:i}function A(t,e){Object(C.a)(2,arguments);var i=Object(E.a)(t),n=Object(E.a)(e),a=N(i,n),s=Math.abs(R(i,n));i.setDate(i.getDate()-a*s);var o=N(i,n)===-a,c=a*(s-o);return 0===c?0:c}var Q=i("CzDk"),$=i("C05f"),H=i("ROBh"),K=i("HM3f"),W=i("mWib"),Y=i("TLy2"),Z=i("4e/d"),G=i("YtkY"),X=i("wqq/"),tt=i("dJst");let et=(()=>{class t{constructor(t){this._org=t,this._generate=new g.b,this._loading=new $.a(""),this._active_bookings=new $.a([]),this._options=new $.a({start:new Date,end:new Date}),this._bookings_list=this._generate.pipe(Object(W.a)(500),Object(Y.a)(t=>{var e;console.log("Report:",t);const i=this._options.getValue();if(this._loading.next("Loading report details..."),!(null==i?void 0:i.type)&&!(null===(e=null==i?void 0:i.zones)||void 0===e?void 0:e.length))return Object(H.a)([]);const n=Object(F.a)((null==i?void 0:i.start)?new Date(i.start):new Date).valueOf(),a=Object(q.a)((null==i?void 0:i.end)?new Date(i.end):n).valueOf(),s=(null==i?void 0:i.zones)?i.zones.filter(t=>"All"!==t).join(","):"",o={period_start:Math.floor(n/1e3),period_end:Math.floor(a/1e3)};return"desks"===i.type?Object(I.e)(Object.assign(Object.assign({},o),{zones:s,type:"desk"})):Object(T.d)(Object.assign(Object.assign({},o),{zone_ids:s}))}),Object(Z.a)(t=>[]),Object(G.a)(t=>(this._loading.next(""),(null==t?void 0:t.length)||Object(S.m)("No bookings for the selected levels and period"),this._active_bookings.next(t||[]),t)),Object(X.a)()),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.bookings=this._active_bookings.asObservable(),this.counts=this._options.pipe(Object(W.a)(500),Object(Y.a)(t=>{const e=(t.zones||[]).filter(t=>-1!==t&&"All"!==t);return Promise.all(e.map(t=>Object(M.s)(t,{name:"desks"}).pipe(Object(G.a)(e=>[t,e.details.length])).toPromise()))}),Object(Z.a)(t=>[]),Object(G.a)(t=>{const e={};return this._active_bookings.next([]),t.forEach(([t,i])=>e[t]=i),e}),Object(X.a)()),this.stats=Object(K.b)([this.counts,this.bookings]).pipe(Object(G.a)(([t,e])=>e[0]instanceof T.a?function(t,e=8){const i=t.reduce((t,e)=>t+e.attendees.length,0),n=t.reduce((t,e)=>t+e.system.capacity,0),a=t.reduce((t,e)=>t+e.duration,0)/(60*e),s=i/n;return{count:t.length,avg_length:t.reduce((t,e)=>t+e.duration,0)/t.length,efficiency:(a+s)/2,total_users:i,total_capacity:n,occupancy:s,utilisation:a,events:t}}(e,8*this.duration):function(t,e=1,i={}){console.log("Counts:",i);const n=Object.keys(i).reduce((t,e)=>t+(i[e]||0),0);return{total:n,count:t.length,utilisation:t.length/n,events:t}}(e||[],this.duration,t))),this._bookings_list.subscribe(t=>t)}get duration(){const t=this._options.getValue();return Math.abs(A(t.start,t.end))}generateReport(){console.log("Report"),this._generate.next((new Date).valueOf())}setOptions(t){var e,i,n,a,s,o,c;(null===(e=t.zones)||void 0===e?void 0:e.includes("All"))?t.zones=["All",...this._org.levelsForBuilding(this._org.building).map(t=>t.id)]:t.zones&&(null===(n=null===(i=this._options.getValue())||void 0===i?void 0:i.zones)||void 0===n?void 0:n.includes("All"))&&(t.zones=[]),(null===(a=t.start)||void 0===a?void 0:a.valueOf())!==(null===(s=this._options.getValue().start)||void 0===s?void 0:s.valueOf())&&(null===(o=t.end)||void 0===o?void 0:o.valueOf())!==(null===(c=this._options.getValue().end)||void 0===c?void 0:c.valueOf())&&this._options.next(Object.assign(Object.assign({},this._options.getValue()),t))}downloadReport(){const t=this._options.getValue(),e=this._active_bookings.getValue();Object(S.i)(`report+${t.type}+${Object(Q.a)(t.start,"yyyy-MM-dd")}+${Object(Q.a)(t.end,"yyyy-MM-dd")}.csv`,Object(S.l)(e.map(t=>{const e=t.toJSON();return delete e.zones,delete e.server_names,e})))}}return t.\u0275fac=function(e){return new(e||t)(c.cc(tt.c))},t.\u0275prov=c.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var it=i("gcUQ"),nt=i("csyo");function at(t,e){if(1&t&&(c.Vb(0,"mat-option",13),c.Lc(1),c.Ub()),2&t){const t=e.$implicit;c.qc("value",t.id),c.Db(1),c.Nc(" ",t.display_name||t.name," ")}}function st(t,e){1&t&&c.Qb(0,"mat-spinner",14),2&t&&c.qc("diameter",32)}function ot(t,e){1&t&&(c.Vb(0,"p"),c.Lc(1,"Generate Report"),c.Ub())}let ct=(()=>{class t extends S.b{constructor(t,e,i){super(),this._state=t,this._org=e,this._route=i,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(t=>""+t.id),this.levels=this._org.active_levels,this.loading=this._state.loading,this.bookings=this._state.bookings,this.options=this._state.options,this.generateReport=()=>this._state.generateReport(),this.downloadReport=()=>this._state.downloadReport(),this.setStartDate=t=>this._state.setOptions({start:new Date(t)}),this.setEndDate=t=>this._state.setOptions({end:new Date(t)}),this.setZones=t=>this._state.setOptions({zones:t})}ngOnInit(){return Object(k.a)(this,void 0,void 0,(function*(){yield this._org.initialised.pipe(Object(z.a)(t=>t)).toPromise(),this.subscription("route.query",this._route.queryParamMap.subscribe(t=>{if(t.has("zone_ids")){const e=t.get("zone_ids").split(",");if(e.length){const t=this._org.levelWithID(e);if(!t)return;this._org.building=this._org.buildings.find(e=>e.id===t.parent_id),this.setZones(e)}}}))}))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et),c.Pb(tt.c),c.Pb(s.a))},t.\u0275cmp=c.Jb({type:t,selectors:[["reports-options"]],features:[c.Ab],decls:26,vars:26,consts:[["appearance","outline",1,"w-48"],["multiple","","placeholder","Select Levels...",3,"ngModel","ngModelChange"],["value","All"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"w-64"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["mat-button","",1,"ml-4",3,"disabled","click"],[3,"diameter",4,"ngIf"],[4,"ngIf"],[3,"value"],[3,"diameter"]],template:function(t,e){if(1&t&&(c.Vb(0,"mat-form-field",0),c.Vb(1,"mat-select",1),c.fc("ngModelChange",(function(t){return e.setZones(t)})),c.kc(2,"async"),c.Vb(3,"mat-option",2),c.Lc(4,"All Levels"),c.Ub(),c.Jc(5,at,2,2,"mat-option",3),c.kc(6,"async"),c.Ub(),c.Ub(),c.Vb(7,"mat-form-field",4),c.Vb(8,"mat-date-range-input",5),c.Vb(9,"input",6),c.fc("ngModelChange",(function(t){return t?e.setStartDate(t):""})),c.kc(10,"async"),c.Ub(),c.Vb(11,"input",7),c.fc("ngModelChange",(function(t){return t?e.setEndDate(t):""})),c.kc(12,"async"),c.Ub(),c.Ub(),c.Qb(13,"mat-datepicker-toggle",8),c.Qb(14,"mat-date-range-picker",null,9),c.Ub(),c.Vb(16,"button",10),c.fc("click",(function(){return e.generateReport()})),c.kc(17,"async"),c.Jc(18,st,1,1,"mat-spinner",11),c.kc(19,"async"),c.Jc(20,ot,2,0,"p",12),c.kc(21,"async"),c.Ub(),c.Vb(22,"button",10),c.fc("click",(function(){return e.downloadReport()})),c.kc(23,"async"),c.Vb(24,"p"),c.Lc(25,"Download Report"),c.Ub(),c.Ub()),2&t){const t=c.vc(15);let i=null,n=null,a=null,s=null;c.Db(1),c.qc("ngModel",null==(i=c.lc(2,10,e.options))?null:i.zones),c.Db(4),c.qc("ngForOf",c.lc(6,12,e.levels)),c.Db(3),c.qc("rangePicker",t),c.Db(1),c.qc("ngModel",null==(n=c.lc(10,14,e.options))?null:n.start),c.Db(2),c.qc("ngModel",null==(a=c.lc(12,16,e.options))?null:a.end),c.Db(2),c.qc("for",t),c.Db(3),c.qc("disabled",!!c.lc(17,18,e.loading)),c.Db(2),c.qc("ngIf",c.lc(19,20,e.loading)),c.Db(2),c.qc("ngIf",!c.lc(21,22,e.loading)),c.Db(2),c.qc("disabled",!(null!=(s=c.lc(23,24,e.bookings))&&s.length))}},directives:[u.c,b.a,a.l,a.o,l.j,n.m,it.a,it.h,a.c,it.g,it.f,u.g,it.b,r.b,n.n,nt.b],pipes:[n.b],styles:["[_nghost-%COMP%] {\n                display: flex;\n                align-items: center;\n                background-color: #fff;\n                height: 5em;\n                padding: 0 1em;\n            }\n\n            button[_ngcontent-%COMP%] {\n                min-width: 0;\n                padding: 0 0.85rem;\n            }\n\n            mat-form-field[_ngcontent-%COMP%] {\n                height: 3.25em;\n                margin-left: 1em;\n            }\n\n            mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] {\n                width: 5.5em;\n                white-space: initial;\n                line-height: 1.2em;\n            }"]}),t})();var lt=i("0/Ep");const rt=function(){return["/reports","desks"]},bt=function(){return["/reports","spaces"]};let pt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Jb({type:t,selectors:[["reports-menu"],["","reports-menu",""]],decls:20,vars:4,consts:[["matRipple","",1,"h-64","w-64","m-4","p-4","flex","flex-col","items-center","justify-center","bg-white","rounded","shadow","hover:bg-gray-100",3,"routerLink"],[1,"text-8xl"],[1,"text-xl","font-bold","mb-4"],[1,"flex","items-center"],[1,"ml-2"]],template:function(t,e){1&t&&(c.Vb(0,"a",0),c.Vb(1,"app-icon",1),c.Lc(2,"room"),c.Ub(),c.Vb(3,"h3",2),c.Lc(4,"Desks"),c.Ub(),c.Vb(5,"div",3),c.Vb(6,"p"),c.Lc(7,"View Report"),c.Ub(),c.Vb(8,"app-icon",4),c.Lc(9,"chevron_right"),c.Ub(),c.Ub(),c.Ub(),c.Vb(10,"a",0),c.Vb(11,"app-icon",1),c.Lc(12,"meeting_room"),c.Ub(),c.Vb(13,"h3",2),c.Lc(14,"Rooms"),c.Ub(),c.Vb(15,"div",3),c.Vb(16,"p"),c.Lc(17,"View Report"),c.Ub(),c.Vb(18,"app-icon",4),c.Lc(19,"chevron_right"),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.qc("routerLink",c.rc(2,rt)),c.Db(10),c.qc("routerLink",c.rc(3,bt)))},directives:[s.f,l.m,lt.a],styles:["[_nghost-%COMP%] {\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                background: var(--bg);\n            }"]}),t})();const dt=["app-reports",""];function gt(t,e){1&t&&c.Qb(0,"div",4)}let ut=(()=>{class t{constructor(t){this._router=t}get path(){const t=this._router.url.split("/");return t[t.length-1]}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(s.d))},t.\u0275cmp=c.Jb({type:t,selectors:[["","app-reports",""]],attrs:dt,decls:6,vars:1,consts:[[1,"h-full"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full"],[1,"flex-1","h-1/2","w-full","overflow-auto"],["reports-menu","","class","absolute inset-0",4,"ngIf"],["reports-menu","",1,"absolute","inset-0"]],template:function(t,e){1&t&&(c.Qb(0,"sidebar",0),c.Vb(1,"main",1),c.Qb(2,"reports-options"),c.Vb(3,"div",2),c.Qb(4,"router-outlet"),c.Ub(),c.Jc(5,gt,1,0,"div",3),c.Ub()),2&t&&(c.Db(5),c.qc("ngIf","reports"===e.path))},directives:[j.a,ct,s.h,n.n,pt],styles:["[_nghost-%COMP%] {\n                display: flex;\n                height: 100%;\n                width: 100%;\n                background: var(--bg);\n            }"]}),t})();var ht=i("6CBO"),ft=i("mjT4"),mt=i("QHQ3");const vt=["report-spaces",""];function _t(t,e){if(1&t&&(c.Tb(0),c.Vb(1,"div",3),c.Vb(2,"div",4),c.Vb(3,"h3"),c.Lc(4,"Total Bookings"),c.Ub(),c.Vb(5,"p"),c.Lc(6),c.kc(7,"async"),c.Ub(),c.Ub(),c.Vb(8,"div",4),c.Vb(9,"h3"),c.Lc(10,"Average Bookings Length"),c.Ub(),c.Vb(11,"p"),c.Lc(12),c.kc(13,"async"),c.Ub(),c.Ub(),c.Ub(),c.Vb(14,"div",5),c.Vb(15,"div",6),c.Vb(16,"h3"),c.Lc(17,"Overall Efficiency"),c.Ub(),c.Vb(18,"p"),c.Lc(19),c.kc(20,"async"),c.Ub(),c.Ub(),c.Vb(21,"div",7),c.Vb(22,"div",8),c.Vb(23,"div",9),c.Vb(24,"h3"),c.Lc(25,"Total Attendees"),c.Ub(),c.Vb(26,"p"),c.Lc(27),c.kc(28,"async"),c.Ub(),c.Ub(),c.Vb(29,"div",9),c.Vb(30,"h3"),c.Lc(31,"Total Capacity"),c.Ub(),c.Vb(32,"p"),c.Lc(33),c.kc(34,"async"),c.Ub(),c.Ub(),c.Ub(),c.Vb(35,"h3"),c.Lc(36,"Occupancy"),c.Ub(),c.Vb(37,"p"),c.Lc(38),c.kc(39,"async"),c.Ub(),c.Ub(),c.Vb(40,"div",10),c.Vb(41,"h3"),c.Lc(42,"Utilisation"),c.Ub(),c.Vb(43,"p"),c.Lc(44),c.kc(45,"async"),c.Ub(),c.Ub(),c.Ub(),c.Sb()),2&t){const t=c.jc(2);c.Db(6),c.Mc(c.lc(7,7,t.total_count)||0),c.Db(6),c.Mc(c.lc(13,9,t.avg_length)||"None"),c.Db(7),c.Nc("",c.lc(20,11,t.efficiency)||0,"%"),c.Db(8),c.Mc(c.lc(28,13,t.total_users)||0),c.Db(6),c.Mc(c.lc(34,15,t.total_capacity)||0),c.Db(5),c.Nc("",c.lc(39,17,t.occupancy)||0,"%"),c.Db(6),c.Nc("",c.lc(45,19,t.utilisation)||0,"%")}}function Ot(t,e){if(1&t&&(c.Tb(0),c.Jc(1,_t,46,21,"ng-container",0),c.kc(2,"async"),c.Sb()),2&t){const t=c.jc(),e=c.vc(5);c.Db(1),c.qc("ngIf",c.lc(2,2,t.total_count))("ngIfElse",e)}}function yt(t,e){1&t&&(c.Vb(0,"div",11),c.Qb(1,"mat-spinner",12),c.Vb(2,"p",13),c.Lc(3,"Loading report data..."),c.Ub(),c.Ub()),2&t&&(c.Db(1),c.qc("diameter",32))}function xt(t,e){1&t&&(c.Vb(0,"div",11),c.Vb(1,"p",13),c.Lc(2," Select levels and time period to generate a report. "),c.Ub(),c.Ub())}let Ut=(()=>{class t{constructor(t){this._state=t,this.total_count=this._state.stats.pipe(Object(G.a)(t=>t.count||0)),this.avg_length=this._state.stats.pipe(Object(G.a)(t=>Object(mt.a)({minutes:t.avg_length||0}))),this.efficiency=this._state.stats.pipe(Object(G.a)(t=>(100*(t.efficiency||0)).toFixed(1))),this.total_users=this._state.stats.pipe(Object(G.a)(t=>t.total_users||0)),this.total_capacity=this._state.stats.pipe(Object(G.a)(t=>t.total_capacity||0)),this.occupancy=this._state.stats.pipe(Object(G.a)(t=>(100*(t.occupancy||0)).toFixed(1))),this.utilisation=this._state.stats.pipe(Object(G.a)(t=>(100*(t.utilisation||0)).toFixed(1))),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et))},t.\u0275cmp=c.Jb({type:t,selectors:[["","report-spaces",""]],attrs:vt,decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"m-4","p-4","rounded","flex","justify-center","items-center","space-x-4","text-center"],[1,"flex","flex-col","items-center","justify-center","bg-primary","text-white","shadow","rounded","p-4","w-48","h-48"],[1,"flex","flex-col","items-center","bg-primary","text-white","border-4","border-primary","shadow","overflow-hidden","rounded","pb-4","w-48","h-48"],[1,"flex","divide-x-4","divide-primary","mb-4"],[1,"flex","flex-col","items-center","justify-center","flex-1","bg-gray-200","text-black"],[1,"flex","flex-col","items-center","justify-center","bg-primary","text-white","rounded","p-4","w-48","h-48"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(t,e){if(1&t&&(c.Jc(0,Ot,3,4,"ng-container",0),c.kc(1,"async"),c.Jc(2,yt,4,1,"ng-template",null,1,c.Kc),c.Jc(4,xt,3,0,"ng-template",null,2,c.Kc)),2&t){const t=c.vc(3);c.qc("ngIf",!c.lc(1,2,e.loading))("ngIfElse",t)}},directives:[n.n,nt.b],pipes:[n.b],styles:["h3[_ngcontent-%COMP%] {\n                font-weight: 500;\n            }\n\n            p[_ngcontent-%COMP%]:not([simple]) {\n                font-size: 1.75rem;\n            }"]}),t})();var Vt=i("R3DB"),Pt=i("XyEp"),Dt=i("J+dc");function wt(t,e){if(1&t&&(c.Vb(0,"div",11),c.Vb(1,"div",5),c.Lc(2),c.kc(3,"date"),c.Ub(),c.Vb(4,"div",6),c.Lc(5),c.Ub(),c.Vb(6,"div",6),c.Lc(7),c.Ub(),c.Vb(8,"div",6),c.Lc(9),c.Ub(),c.Vb(10,"div",6),c.Lc(11),c.Ub(),c.Ub()),2&t){const t=e.$implicit;c.Db(2),c.Nc(" ",c.mc(3,6,t.date,"MMMM d, y(EEE)")," "),c.Db(3),c.Oc(" ",t.free||0," / ",t.total||0," "),c.Db(2),c.Mc(t.approved||0),c.Db(2),c.Mc(t.count||0),c.Db(2),c.Nc("",t.utilisation,"%")}}let Lt=(()=>{class t{constructor(t){this._state=t,this.page=0,this.day_list=Object(K.b)([this._state.options,this._state.stats]).pipe(Object(G.a)(([t,e])=>{const{start:i,end:n}=t;this.page=0;let a=i;const s=[];for(;Object(Vt.a)(a,n);){const t=Object(F.a)(a).valueOf(),i=Object(q.a)(t).valueOf(),n=e.events.filter(e=>Object(S.w)(t,i,e.date,e.date+60*e.duration*1e3));s.push({date:t,total:e.total,free:e.total-n.length,approved:n.reduce((t,e)=>t+(e.approved?1:0),0),count:n.length,utilisation:(n.length/e.total*100).toFixed(1)}),a=Object(Pt.a)(a,1)}return s}),Object(X.a)(1)),this.download=()=>Object(k.a)(this,void 0,void 0,(function*(){let t=yield this.day_list.pipe(Object(Dt.a)(1)).toPromise();t=t.map(t=>Object.assign(Object.assign({},t),{date:Object(Q.a)(t.date,"MMMM d, y(EEE)")})),Object(S.i)("desks-usage.csv",Object(S.l)(t))}))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et))},t.\u0275cmp=c.Jb({type:t,selectors:[["report-desks-overall-list"]],decls:25,vars:12,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["table-head","",1,"flex","items-center","font-medium","border-b","border-gray-200"],[1,"w-1/3","p-4"],[1,"w-1/6","p-4"],["table-body",""],["table-row","","class","flex items-center border-b border-gray-200",4,"ngFor","ngForOf"],["table-footer",""],[3,"length","pageSize","hidePageSize","page"],["table-row","",1,"flex","items-center","border-b","border-gray-200"]],template:function(t,e){if(1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"h3",2),c.Lc(3,"Daily Utilisation"),c.Ub(),c.Vb(4,"button",3),c.fc("click",(function(){return e.download()})),c.Vb(5,"app-icon"),c.Lc(6,"download"),c.Ub(),c.Ub(),c.Ub(),c.Vb(7,"div",4),c.Vb(8,"div",5),c.Lc(9,"Date"),c.Ub(),c.Vb(10,"div",6),c.Lc(11,"Free Desks"),c.Ub(),c.Vb(12,"div",6),c.Lc(13,"Approved Bookings"),c.Ub(),c.Vb(14,"div",6),c.Lc(15,"Total Requests"),c.Ub(),c.Vb(16,"div",6),c.Lc(17,"Utilisation"),c.Ub(),c.Ub(),c.Vb(18,"div",7),c.Jc(19,wt,12,9,"div",8),c.kc(20,"slice"),c.kc(21,"async"),c.Ub(),c.Vb(22,"div",9),c.Vb(23,"mat-paginator",10),c.fc("page",(function(t){return e.page=t.pageIndex})),c.kc(24,"async"),c.Ub(),c.Ub(),c.Ub()),2&t){let t=null;c.Db(19),c.qc("ngForOf",c.nc(20,4,c.lc(21,8,e.day_list),7*e.page,7*e.page+7)),c.Db(4),c.qc("length",(null==(t=c.lc(24,10,e.day_list))?null:t.length)||0)("pageSize",7)("hidePageSize",!0)}},directives:[r.b,lt.a,n.m,w],pipes:[n.u,n.b,n.f],encapsulation:2}),t})();function jt(t,e){if(1&t&&(c.Vb(0,"div",11),c.Vb(1,"div",5),c.Lc(2),c.Ub(),c.Vb(3,"div",6),c.Lc(4),c.Ub(),c.Vb(5,"div",6),c.Lc(6),c.Ub(),c.Vb(7,"div",6),c.Lc(8),c.Ub(),c.Vb(9,"div",6),c.Lc(10),c.Ub(),c.Ub()),2&t){const t=e.$implicit;c.Db(2),c.Nc(" ",t.name," "),c.Db(2),c.Oc(" ",t.free||0," / ",t.total||0," "),c.Db(2),c.Mc(t.approved||0),c.Db(2),c.Mc(t.count||0),c.Db(2),c.Nc("",t.utilisation,"%")}}let kt=(()=>{class t{constructor(t,e){this._state=t,this._org=e,this.page=0,this.level_list=Object(K.b)([this._state.options,this._state.stats,this._state.counts]).pipe(Object(G.a)(([t,e,i])=>{const{start:n,end:a,zones:s}=t,o=A(a,n);this.page=0;const c=[];console.log("Duration:",o);for(const l of s){if("All"===l)continue;const t=this._org.levelWithID([l]),n=i[l]||0,a=e.events.filter(t=>t.zones.includes(l));console.log("Evnets:",a.length);let s=(n*o-a.length)/o;s%1!=0&&(s=s.toFixed(2)),c.push({name:(null==t?void 0:t.display_name)||(null==t?void 0:t.name),free:s,total:n,count:a.length,utilisation:(a.length/(n*o)*100||0).toFixed(2)})}return c}),Object(X.a)(1)),this.download=()=>Object(k.a)(this,void 0,void 0,(function*(){let t=yield this.level_list.pipe(Object(Dt.a)(1)).toPromise();Object(S.i)("desks-levels-usage.csv",Object(S.l)(t))}))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et),c.Pb(tt.c))},t.\u0275cmp=c.Jb({type:t,selectors:[["report-desks-levels-list"]],decls:25,vars:12,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["table-head","",1,"flex","items-center","font-medium","border-b","border-gray-200"],[1,"w-1/3","p-4"],[1,"w-1/6","p-4"],["table-body",""],["table-row","","class","flex items-center border-b border-gray-200",4,"ngFor","ngForOf"],["table-footer",""],[3,"length","pageSize","hidePageSize","page"],["table-row","",1,"flex","items-center","border-b","border-gray-200"]],template:function(t,e){if(1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"h3",2),c.Lc(3,"Level Utilisation"),c.Ub(),c.Vb(4,"button",3),c.fc("click",(function(){return e.download()})),c.Vb(5,"app-icon"),c.Lc(6,"download"),c.Ub(),c.Ub(),c.Ub(),c.Vb(7,"div",4),c.Vb(8,"div",5),c.Lc(9,"Level"),c.Ub(),c.Vb(10,"div",6),c.Lc(11,"Avg. Free Desks"),c.Ub(),c.Vb(12,"div",6),c.Lc(13,"Approved Bookings"),c.Ub(),c.Vb(14,"div",6),c.Lc(15,"Total Requests"),c.Ub(),c.Vb(16,"div",6),c.Lc(17,"Utilisation"),c.Ub(),c.Ub(),c.Vb(18,"div",7),c.Jc(19,jt,11,6,"div",8),c.kc(20,"slice"),c.kc(21,"async"),c.Ub(),c.Vb(22,"div",9),c.Vb(23,"mat-paginator",10),c.fc("page",(function(t){return e.page=t.pageIndex})),c.kc(24,"async"),c.Ub(),c.Ub(),c.Ub()),2&t){let t=null;c.Db(19),c.qc("ngForOf",c.nc(20,4,c.lc(21,8,e.level_list),7*e.page,7*e.page+7)),c.Db(4),c.qc("length",(null==(t=c.lc(24,10,e.level_list))?null:t.length)||0)("pageSize",7)("hidePageSize",!0)}},directives:[r.b,lt.a,n.m,w],pipes:[n.u,n.b],encapsulation:2}),t})();const zt=["report-desks",""];function St(t,e){if(1&t&&(c.Tb(0),c.Vb(1,"div",3),c.Vb(2,"div",4),c.Vb(3,"h3"),c.Lc(4,"Total Bookings"),c.Ub(),c.Vb(5,"p"),c.Lc(6),c.kc(7,"async"),c.Ub(),c.Ub(),c.Vb(8,"div",4),c.Vb(9,"h3"),c.Lc(10,"Utilisation"),c.Ub(),c.Vb(11,"p"),c.Lc(12),c.kc(13,"async"),c.Ub(),c.Ub(),c.Ub(),c.Qb(14,"report-desks-overall-list"),c.Qb(15,"report-desks-levels-list"),c.Sb()),2&t){const t=c.jc(2);c.Db(6),c.Mc(c.lc(7,2,t.total_count)||0),c.Db(6),c.Nc("",c.lc(13,4,t.utilisation)||0,"%")}}function Mt(t,e){if(1&t&&(c.Tb(0),c.Jc(1,St,16,6,"ng-container",0),c.kc(2,"async"),c.Sb()),2&t){const t=c.jc(),e=c.vc(5);c.Db(1),c.qc("ngIf",c.lc(2,2,t.total_count))("ngIfElse",e)}}function It(t,e){1&t&&(c.Vb(0,"div",5),c.Qb(1,"mat-spinner",6),c.Vb(2,"p",7),c.Lc(3,"Loading report data..."),c.Ub(),c.Ub()),2&t&&(c.Db(1),c.qc("diameter",32))}function Tt(t,e){1&t&&(c.Vb(0,"div",5),c.Vb(1,"p",7),c.Lc(2," Select levels and time period to generate a report. "),c.Ub(),c.Ub())}const Ft=[{path:"",component:ut,children:[{path:""},{path:"spaces",component:Ut},{path:"desks",component:(()=>{class t{constructor(t){this._state=t,this.total_count=this._state.stats.pipe(Object(G.a)(t=>t.count||0)),this.utilisation=this._state.stats.pipe(Object(G.a)(t=>(100*(t.utilisation||0)).toFixed(1))),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"desks"})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et))},t.\u0275cmp=c.Jb({type:t,selectors:[["","report-desks",""]],attrs:zt,decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(t,e){if(1&t&&(c.Jc(0,Mt,3,4,"ng-container",0),c.kc(1,"async"),c.Jc(2,It,4,1,"ng-template",null,1,c.Kc),c.Jc(4,Tt,3,0,"ng-template",null,2,c.Kc)),2&t){const t=c.vc(3);c.qc("ngIf",!c.lc(1,2,e.loading))("ngIfElse",t)}},directives:[n.n,Lt,kt,nt.b],pipes:[n.b],styles:["h3[_ngcontent-%COMP%] {\n                font-weight: 500;\n            }\n\n            p[_ngcontent-%COMP%]:not([simple]) {\n                font-size: 1.75rem;\n            }"]}),t})()},{path:"**",redirectTo:"desks"}]}];let qt=(()=>{class t{}return t.\u0275mod=c.Nb({type:t}),t.\u0275inj=c.Mb({factory:function(e){return new(e||t)},imports:[[n.c,a.h,o.a,ht.a,ft.c,L,s.g.forChild(Ft)]]}),t})()}}]);
//# sourceMappingURL=reports-reports-module.be3c1071ebaf2a6a8513.js.map