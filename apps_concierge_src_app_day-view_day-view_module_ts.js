"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_day-view_day-view_module_ts"],{21452:(se,$,r)=>{r.r($),r.d($,{DayViewModule:()=>Ht});var p=r(60316),_=r(34456),y=r(26842),z=r(40363),d=r(77375),e=r(7404),U=r(74605),v=r(89204),E=r(57871),x=r(12185),u=r(11972),O=r(94584),P=r(24950),X=r(25175),b=r(85060),A=r(8827),j=r(69434);const ae=()=>({class:"material-icons",content:"add"});function le(i,l){if(1&i&&(e.j41(0,"mat-option",12),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.display_name||t.name," ")}}function re(i,l){if(1&i&&(e.j41(0,"mat-option",12),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function ce(i,l){if(1&i){const t=e.RV6();e.j41(0,"mat-slide-toggle",13),e.nI1(1,"async"),e.bIt("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.Njj(a.updateUIOptions({show_overflow:o}))}),e.j41(2,"div",14),e.EFF(3,"Setup / Breakdown"),e.k0s()()}if(2&i){let t;const n=e.XpG();e.Y8G("ngModel",null==(t=e.bMT(1,1,n.ui_options))?null:t.show_overflow)}}let pe=(()=>{class i extends d.Tv{updateUIOptions(t){this._state.setUIOptions(t)}get allow_setup_breakdown(){return this._settings.get("app.events.allow_setup_breakdown")}constructor(t,n,o,a,s){super(),this._state=t,this._org=n,this._route=o,this._router=a,this._settings=s,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(c=>`${c.id}`),this.levels=this._org.active_levels,this.ui_options=this._state.options,this.setDate=c=>this._state.setDate(c),this.newBooking=c=>this._state.newBooking(c),this.updateZones=c=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:c.join(",")}})},this.updateTypes=c=>this._state.setFilters({hide_type:this.types.reduce((m,g)=>(c.includes(g.id)||m.push(g),m),[])})}ngOnInit(){var t=this;return(0,v.A)(function*(){yield t._org.initialised.pipe((0,E.$)(n=>n)).toPromise(),t.subscription("route.query",t._route.queryParamMap.subscribe(n=>{if(n.has("zone_ids")){const o=n.get("zone_ids").split(",");if(o.length){t.zones=o;const a=t._org.levelWithID(o);if(!a)return;t._org.building=t._org.buildings.find(s=>s.id===a.parent_id)}}})),t.updateTypes(t.type_list)})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(u.G),e.rXU(x.yb),e.rXU(y.nX),e.rXU(y.Ix),e.rXU(d.h$))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["dayview-topbar"]],features:[e.Vt3],decls:18,vars:9,consts:[[1,"flex","items-center","px-4","h-20","bg-base-100","border-b","border-base-200"],["btn","","matRipple","","new","",1,"w-12","xl:w-auto","overflow-hidden",3,"click"],[1,"flex","items-center"],[1,"mr-2",3,"icon"],[1,"hidden","xl:block"],["appearance","outline"],["multiple","","placeholder","All Levels",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["multiple","","placeholder","No Events",3,"ngModelChange","ngModel"],["class","m-2",3,"ngModel","ngModelChange",4,"ngIf"],[1,"flex-1","w-0"],[3,"dateChange"],[3,"value"],[1,"m-2",3,"ngModelChange","ngModel"],[1,"text-xs"]],template:function(n,o){1&n&&(e.j41(0,"div",0)(1,"button",1),e.bIt("click",function(){return o.newBooking()}),e.j41(2,"div",2),e.nrm(3,"app-icon",3),e.j41(4,"div",4),e.EFF(5,"New Booking"),e.k0s()()(),e.j41(6,"mat-form-field",5)(7,"mat-select",6),e.mxI("ngModelChange",function(s){return e.DH7(o.zones,s)||(o.zones=s),s}),e.bIt("ngModelChange",function(s){return o.updateZones(s)}),e.DNE(8,le,2,2,"mat-option",7),e.nI1(9,"async"),e.k0s()(),e.j41(10,"mat-form-field",5)(11,"mat-select",8),e.mxI("ngModelChange",function(s){return e.DH7(o.type_list,s)||(o.type_list=s),s}),e.bIt("ngModelChange",function(s){return o.updateTypes(s)}),e.j41(12,"mat-select-trigger"),e.EFF(13,"Legend"),e.k0s(),e.DNE(14,re,2,2,"mat-option",7),e.k0s()(),e.DNE(15,ce,4,3,"mat-slide-toggle",9),e.nrm(16,"div",10),e.j41(17,"date-options",11),e.bIt("dateChange",function(s){return o.setDate(s)}),e.k0s()()),2&n&&(e.R7$(3),e.Y8G("icon",e.lJ4(8,ae)),e.R7$(4),e.R50("ngModel",o.zones),e.R7$(),e.Y8G("ngForOf",e.bMT(9,6,o.levels)),e.R7$(3),e.R50("ngModel",o.type_list),e.R7$(3),e.Y8G("ngForOf",o.types),e.R7$(),e.Y8G("ngIf",o.allow_setup_breakdown))},dependencies:[p.Sq,p.bT,_.BC,_.vS,O.o,P.rl,X.VO,X.$2,b.wT,A.sG,b.r6,j.R,p.Jj],styles:["button[_ngcontent-%COMP%]{min-width:0;padding:0 .85rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em;margin-left:1em}mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:5.5em;white-space:initial;line-height:1.2em}\n\n/*# sourceMappingURL=dayview-topbar.component.ts-angular-inline--65.css.map*/"]})}return i})();var S=r(3998),de=r(71536),w=r(42175),L=r(8627),me=r(71963),ue=r(29314),h=r(35443),N=r(7841),H=r(22168),ge=r(22232),fe=r(26354),R=r(10764),he=r(49675),F=r(33240),W=r(1874),I=r(68113);function _e(i,l){if(1&i&&e.nrm(0,"div"),2&i){const t=e.XpG();e.HbH("overflow-block absolute rounded overflow-hidden w-full "+t.type),e.xc7("top",100*t.overflow_top+"%")("height",100*t.overflow_height+"%")}}function ve(i,l){if(1&i&&(e.j41(0,"div",6)(1,"app-icon",7),e.EFF(2,"title"),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.event.title," ")}}function be(i,l){if(1&i&&(e.j41(0,"div",6)(1,"app-icon",7),e.EFF(2,"schedule"),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.time," ")}}function ye(i,l){if(1&i&&(e.j41(0,"div",6)(1,"app-icon",7),e.EFF(2,"people"),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(2);e.R7$(3),e.Lme(" ",t.event.attendees.length," Attendee",1===t.event.attendees.length?"":"s"," ")}}function xe(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",3),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.view(o.event))}),e.j41(1,"div",4),e.EFF(2),e.k0s(),e.DNE(3,ve,4,1,"div",5)(4,be,4,1,"div",5)(5,ye,4,2,"div",5),e.k0s()}if(2&i){const t=e.XpG();e.HbH("absolute rounded overflow-hidden text-sm border border-base-200 shadow-sm z-10 hover:z-30 "+t.type),e.xc7("top",100*t.top+"%")("height",100*t.height+"%"),e.R7$(2),e.JRh(null==t.event.organiser?null:t.event.organiser.name),e.R7$(),e.Y8G("ngIf",t.event.duration>30),e.R7$(),e.Y8G("ngIf",t.event.duration>60),e.R7$(),e.Y8G("ngIf",t.event.duration>90)}}function we(i,l){if(1&i&&(e.j41(0,"div",8)(1,"div")(2,"app-icon"),e.EFF(3),e.k0s()(),e.j41(4,"div",9),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&i){const t=e.XpG();e.xc7("top",100*t.top+"%")("height",100*t.height+"%"),e.R7$(),e.HbH("icon flex items-center justify-center mr-2 text-3xl rounded h-12 w-12 text-pending "+t.event.ext("cleaning_status")),e.R7$(2),e.JRh("done"===t.event.ext("cleaning_status")?"done":"warning"),e.R7$(2),e.Lme(" ","done"===t.event.ext("cleaning_status")?"Finished":"Scheduled to"," clean at ",e.i5U(6,9,t.event.ext("cleaning_time")||1e3*t.event.event_end,t.time_format)," ")}}const G=1440;let ke=(()=>{class i{get time(){const t=new Date(this.event.date);return(0,R.GP)(t,this.time_format)+" - "+(0,R.GP)((0,he.z)(t,this.event.duration),this.time_format)}get type(){return this.event.guests.length?"external":"declined"===this.event.status?"cancelled":"internal"}get time_format(){return this._settings.time_format}constructor(t,n){this._state=t,this._settings=n,this.top=-999,this.height=0,this.overflow_top=-999,this.overflow_height=0,this.ui_options=this._state.options,this.view=o=>this._state.setEvent(o)}ngOnChanges(t){if(t.event&&this.event){const n=(0,F.o)(new Date(this.event.date)),o=(0,W.o)(new Date(this.event.date),n);this.top=o/G,this.height=this.event.duration/G,this.overflow_top=(o-(this.event.setup_time||0))/G,this.overflow_height=(this.event.duration+(this.event.setup_time||0)+(this.event.breakdown_time||0))/G}}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(u.G),e.rXU(d.h$))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["dayview-event"]],inputs:{event:"event"},features:[e.OA$],decls:5,vars:7,consts:[[3,"class","top","height",4,"ngIf"],["event","","matRipple","",3,"class","top","height","click",4,"ngIf"],["cleaning","","class","absolute rounded overflow-hidden flex w-full shadow p-2 bg-base-100 z-20 hover:!h-48",3,"top","height",4,"ngIf"],["event","","matRipple","",3,"click"],[1,"px-2","py-1","font-medium"],["class","py-1 flex items-center",4,"ngIf"],[1,"py-1","flex","items-center"],[1,"mx-2"],["cleaning","",1,"absolute","rounded","overflow-hidden","flex","w-full","shadow","p-2","bg-base-100","z-20","hover:!h-48"],[1,"flex-1","w-1/2"]],template:function(n,o){if(1&n&&(e.DNE(0,_e,1,6,"div",0),e.nI1(1,"async"),e.DNE(2,xe,6,10,"div",1)(3,we,7,12,"div",2),e.nI1(4,"async")),2&n){let a,s;e.Y8G("ngIf",null==(a=e.bMT(1,3,o.ui_options))?null:a.show_overflow),e.R7$(2),e.Y8G("ngIf",o.event),e.R7$(),e.Y8G("ngIf",o.event&&(null==(s=e.bMT(4,5,o.ui_options))?null:s.show_cleaning))}},dependencies:[p.bT,b.r6,j.R,p.Jj,p.vh],styles:["[event][_ngcontent-%COMP%]{background-color:#ccc;width:12rem;z-index:100;transition:box-shadow .2s}[event][_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 1px #0003,0 1px 1px #00000024,0 2px 1px -1px #0000001f!important;cursor:pointer}.overflow-block[_ngcontent-%COMP%]{opacity:.3;width:12rem}.internal[_ngcontent-%COMP%]{background-color:#1565c0;color:#fff}.icon[_ngcontent-%COMP%]{background-color:#f0f0f0}.icon.done[_ngcontent-%COMP%]{color:#21a453}.external[_ngcontent-%COMP%]{background-color:#ad1457;color:#fff}.cancelled[_ngcontent-%COMP%]{background-color:#ccc}\n\n/*# sourceMappingURL=dayview-event.component.ts-angular-inline--68.css.map*/"]})}return i})();function Te(i,l){1&i&&e.nrm(0,"dayview-event",2),2&i&&e.Y8G("event",l.$implicit)}function Re(i,l){if(1&i&&(e.qex(0),e.DNE(1,Te,1,1,"dayview-event",1),e.nI1(2,"async"),e.bVm()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",e.bMT(2,1,t.events))}}let Fe=(()=>{class i extends d.Tv{constructor(t){super(),this._state=t,this.events=this._state.filtered.pipe((0,h.T)(n=>n.filter(o=>o.resources.find(a=>this.space.email===a.email))))}ngOnInit(){this.subscription("events",this._state.filtered.subscribe())}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(u.G))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["dayview-space"]],inputs:{space:"space"},features:[e.Vt3],decls:1,vars:1,consts:[[4,"ngIf"],[3,"event",4,"ngFor","ngForOf"],[3,"event"]],template:function(n,o){1&n&&e.DNE(0,Re,3,3,"ng-container",0),2&n&&e.Y8G("ngIf",o.space)},dependencies:[p.Sq,p.bT,ke,p.Jj],styles:["[_nghost-%COMP%]{position:relative}\n\n/*# sourceMappingURL=dayview-space.component.ts-angular-inline--67.css.map*/"]})}return i})();function Ie(i,l){if(1&i&&(e.j41(0,"div",15)(1,"div",16),e.EFF(2),e.k0s(),e.nrm(3,"div",17),e.k0s()),2&i){const t=l.$implicit,n=e.XpG();e.xc7("transform","translateY(-"+n.scroll.y+"px)"),e.R7$(2),e.SpI(" ",t," ")}}function Ce(i,l){if(1&i&&(e.j41(0,"div",18),e.nrm(1,"div",19),e.j41(2,"div",20),e.EFF(3),e.k0s()()),2&i){const t=l.$implicit,n=e.XpG();e.xc7("transform","translateX(-"+n.scroll.x+"px)"),e.R7$(3),e.SpI(" ",t.display_name||t.name," ")}}function je(i,l){1&i&&e.nrm(0,"dayview-space",21),2&i&&e.Y8G("space",l.$implicit)}function Me(i,l){if(1&i&&(e.nrm(0,"div",22),e.nI1(1,"async")),2&i){let t;const n=l.index,o=e.XpG();e.xc7("width",12*(null==(t=e.bMT(1,4,o.space_list))?null:t.length)+"rem")("top",4*n+"rem")}}function $e(i,l){1&i&&e.nrm(0,"mat-progress-bar",23)}function Ee(i,l){if(1&i&&(e.nrm(0,"view-event-details",24),e.nI1(1,"async")),2&i){const t=e.XpG();e.Y8G("event",e.bMT(1,1,t.event))}}const Ge=new Array(24).fill(0).map((i,l)=>(l%12==0?12:l%12)+(l>=12?" PM":" AM"));let De=(()=>{class i extends d.Tv{constructor(t,n){super(),this._org=t,this._state=n,this.blocks=Ge,this.scroll={x:0,y:0},this.loading=this._state.loading,this.event=this._state.event,this.spaces=this._org.active_building.pipe((0,L.p)(o=>!!o),(0,me.n)(({id:o})=>(0,S.BbB)({zone_id:o,limit:1e3}).pipe((0,ue.W)(()=>(0,de.of)({data:[]})))),(0,h.T)(({data:o})=>o.map(a=>new H.$x({...a,level:this._org.levelWithID(a.zones)}))),(0,N.t)(1)),this.space_list=(0,w.zV)([this.spaces,this._state.zones]).pipe((0,h.T)(([o,a])=>o.filter(s=>!a?.length||s.zones.find(c=>a.includes(c)))||[]))}ngOnInit(){this._state.startPolling()}ngOnDestroy(){this._state.stopPolling()}onScroll(t){requestAnimationFrame(()=>this.scroll={x:t.srcElement.scrollLeft,y:t.srcElement.scrollTop})}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(x.yb),e.rXU(u.G))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["dayview-timeline"]],features:[e.Vt3],decls:19,vars:14,consts:[["scroll_el",""],[1,"absolute","inset-0","flex"],[1,"time","h-full","w-24","overflow-hidden","bg-base-100","relative"],["header","",1,"relative","h-16","z-50"],[1,"bg-base-100","absolute","top-0","left-0","right-0","bottom-8"],["change-transform","","class","relative h-16 border-r border-base-300 z-10",3,"transform",4,"ngFor","ngForOf"],[1,"absolute","h-8","w-px","top-8","right-0","bg-base-300"],[1,"h-full","flex-1","flex","flex-col","w-1/2"],["header","",1,"flex","relative","overflow-hidden","border-b","border-base-300","border-opacity-50","bg-base-100","h-16","w-full"],["change-transform","","class","relative h-16 w-48 min-w-[12rem]",3,"transform",4,"ngFor","ngForOf"],["content","",1,"relative","flex","flex-1","overflow-auto",3,"scroll"],["class","w-48 min-w-[12rem] h-[96rem] border-r border-base-300",3,"space",4,"ngFor","ngForOf"],["class","absolute bg-base-300 h-px min-w-full left-0",3,"width","top",4,"ngFor","ngForOf"],["mode","indeterminate","class","absolute bottom-0 left-0 right-0",4,"ngIf"],[3,"event",4,"ngIf"],["change-transform","",1,"relative","h-16","border-r","border-base-300","z-10"],[1,"absolute","text-center","w-full","text-xs","top-0","transform","-translate-y-1/2","opacity-40"],[1,"absolute","h-px","w-2","top-0","right-0","bg-base-300"],["change-transform","",1,"relative","h-16","w-48","min-w-[12rem]"],["bar","",1,"absolute","h-8","w-px","bottom-0","-left-px","bg-base-300"],[1,"name","m-2","text-center"],[1,"w-48","min-w-[12rem]","h-[96rem]","border-r","border-base-300",3,"space"],[1,"absolute","bg-base-300","h-px","min-w-full","left-0"],["mode","indeterminate",1,"absolute","bottom-0","left-0","right-0"],[3,"event"]],template:function(n,o){if(1&n){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3),e.nrm(3,"div",4),e.k0s(),e.DNE(4,Ie,4,3,"div",5),e.nrm(5,"div",6),e.k0s(),e.j41(6,"div",7)(7,"div",8),e.DNE(8,Ce,4,3,"div",9),e.nI1(9,"async"),e.k0s(),e.j41(10,"div",10,0),e.bIt("scroll",function(c){return e.eBV(a),e.Njj(o.onScroll(c))}),e.DNE(12,je,1,1,"dayview-space",11),e.nI1(13,"async"),e.DNE(14,Me,2,6,"div",12),e.k0s()(),e.DNE(15,$e,1,0,"mat-progress-bar",13),e.nI1(16,"async"),e.DNE(17,Ee,2,3,"view-event-details",14),e.nI1(18,"async"),e.k0s()}2&n&&(e.R7$(4),e.Y8G("ngForOf",o.blocks),e.R7$(4),e.Y8G("ngForOf",e.bMT(9,6,o.space_list)),e.R7$(4),e.Y8G("ngForOf",e.bMT(13,8,o.space_list)),e.R7$(2),e.Y8G("ngForOf",o.blocks),e.R7$(),e.Y8G("ngIf",e.bMT(16,10,o.loading)),e.R7$(2),e.Y8G("ngIf",e.bMT(18,12,o.event)))},dependencies:[p.Sq,p.bT,ge.x,fe.HM,Fe,p.Jj],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}[change-transform][_ngcontent-%COMP%]{will-change:transform}\n\n/*# sourceMappingURL=dayview-timeline.component.ts-angular-inline--66.css.map*/"]})}return i})();const Be=["app-dayview",""];let ze=(()=>{class i{get links(){return this._settings.get("app.general.menu")||[]}constructor(t,n){this._settings=t,this._router=n}ngOnInit(){this.links.find(t=>t.route.includes("day-view"))||this._router.navigate([`/${this.links[0].route}`])}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(d.h$),e.rXU(y.Ix))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["","app-dayview",""]],attrs:Be,decls:4,vars:0,consts:[[1,"h-full"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full","bg-base-200"]],template:function(n,o){1&n&&(e.nrm(0,"sidebar",0),e.j41(1,"main",1),e.nrm(2,"dayview-topbar")(3,"dayview-timeline"),e.k0s())},dependencies:[U.k,pe,De],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%}\n\n/*# sourceMappingURL=day-view.component.ts-angular-inline--64.css.map*/"]})}return i})();var Oe=r(68390),Xe=r(75566),Se=r(45189),Ne=r(96843),J=r(19803),Z=r(33602),Ve=r(97024),Q=r(31034),K=r(23206),V=r(31257),D=r(29533),k=r(3330),Ye=r(89273),q=r(12587),ee=r(80640),te=r(90521),ne=r(89577);const Ue=["input_el"];function Pe(i,l){1&i&&(e.j41(0,"app-icon",6),e.EFF(1," search "),e.k0s())}function Ae(i,l){if(1&i&&(e.j41(0,"div",13),e.EFF(1),e.nI1(2,"async"),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" ",e.bMT(2,1,t.events).length?"No matching events found.":"No events for the currently selected date and zone"," ")}}function Le(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",14),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.selected.next(o))}),e.nrm(1,"div",15),e.j41(2,"div",16)(3,"div",17),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"div",18),e.EFF(7),e.nI1(8,"date"),e.k0s()(),e.j41(9,"div",19)(10,"div",20)(11,"div",21),e.EFF(12),e.k0s(),e.j41(13,"div",9),e.EFF(14),e.nI1(15,"date"),e.nI1(16,"date"),e.k0s()(),e.j41(17,"div",22),e.EFF(18),e.k0s(),e.j41(19,"div",22),e.EFF(20),e.nI1(21,"user"),e.k0s()()()}if(2&i){let t;const n=l.$implicit,o=e.XpG(2);e.R7$(),e.xc7("background-color",o.typeColor(n)),e.R7$(3),e.SpI(" ",e.i5U(5,11,n.date,"dd")," "),e.R7$(3),e.SpI(" ",e.i5U(8,14,n.date,"MMM")," "),e.R7$(4),e.AVh("line-through","done"===n.state),e.R7$(),e.SpI(" ",n.title," "),e.R7$(2),e.Lme(" ",e.i5U(15,17,n.date,o.time_format)," \u2013 ",e.i5U(16,20,n.date_end,o.time_format)," "),e.R7$(4),e.SpI(" ",null==n.system?null:n.system.display_name," "),e.R7$(2),e.SpI(" ",(null==(t=e.bMT(21,23,n.host))?null:t.name)||n.host," ")}}function He(i,l){if(1&i&&(e.j41(0,"div",7)(1,"div",8)(2,"div",9),e.EFF(3),e.nI1(4,"async"),e.nI1(5,"async"),e.k0s()(),e.DNE(6,Ae,3,3,"div",10),e.nI1(7,"async"),e.j41(8,"div",11),e.DNE(9,Le,22,25,"button",12),e.nI1(10,"async"),e.k0s()()),2&i){let t;const n=e.XpG();e.R7$(3),e.Lme(" ",null==(t=e.bMT(4,4,n.filtered))?null:t.length," of ",null==(t=e.bMT(5,6,n.events))?null:t.length," Event(s) "),e.R7$(3),e.Y8G("ngIf",!e.bMT(7,8,n.filtered).length),e.R7$(3),e.Y8G("ngForOf",e.bMT(10,10,n.filtered))}}let oe=(()=>{class i extends d.Tv{get time_format(){return this._settings.time_format}typeColor(t){return this.types.find(o=>o.id===t.type)?.color||"#EEE"}constructor(t,n){super(),this._state=t,this._settings=n,this.selected=new e.bkB,this.show=!1,this.search=new te.t(""),this.events=this._state.filtered,this.types=[{id:"internal",name:"Internal",color:"#D81B60"},{id:"external",name:"External",color:"#1E88E5"},{id:"cancelled",name:"Cancelled",color:"#eeeeee"}],this.filtered=(0,w.zV)([this.search,this.events]).pipe((0,h.T)(([o,a])=>(o=o.toLowerCase(),a.filter(s=>!s.is_system_event&&(s.title.toLowerCase().includes(o)||s.organiser?.name.toLowerCase().includes(o)||s.host.toLowerCase().includes(o)||s.system?.display_name.toLowerCase().includes(o)||s.system?.name.toLowerCase().includes(o)||s.resources[0]?.display_name.toLowerCase()?.includes(o)||s.resources[0]?.name.toLowerCase()?.includes(o)||s.resources[0]?.email.toLowerCase()?.includes(o))))))}showSearch(){this.show=!0,this._input_element.nativeElement.focus()}hideSearch(){this.show&&this.timeout("hide",()=>this.show=!1)}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(u.G),e.rXU(d.h$))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["room-booking-search"]],viewQuery:function(n,o){if(1&n&&e.GBs(Ue,7),2&n){let a;e.mGM(a=e.lsd())&&(o._input_element=a.first)}},outputs:{selected:"selected"},features:[e.Vt3],decls:8,vars:7,consts:[["input_el",""],[1,"relative"],["icon","","matRipple","",3,"click"],["placeholder","Search day's events...",1,"absolute","top-1/2","-translate-y-1/2","w-[20rem]","right-0","rounded-full","pl-10","pr-4","py-3","border","border-base-300","shadow","bg-base-100",3,"ngModelChange","blur","ngModel"],["class","text-2xl absolute top-1/2 -translate-y-1/2 right-[17.5rem]",4,"ngIf"],["class","absolute top-full translate-y-2 w-[18rem] right-4 rounded border border-base-300 bg-base-100 max-h-[65vh] overflow-auto shadow",4,"ngIf"],[1,"text-2xl","absolute","top-1/2","-translate-y-1/2","right-[17.5rem]"],[1,"absolute","top-full","translate-y-2","w-[18rem]","right-4","rounded","border","border-base-300","bg-base-100","max-h-[65vh]","overflow-auto","shadow"],[1,"sticky","top-0","p-4","bg-base-100","rounded","z-10"],[1,"opacity-60","text-xs"],["class","opacity-30 p-4 flex items-center justify-center text-sm text-center",4,"ngIf"],[1,"px-2","pb-2","-mt-2"],["matRipple","","class","relative flex items-center p-2 hover:bg-base-200 rounded w-full text-left space-x-2 z-0",3,"click",4,"ngFor","ngForOf"],[1,"opacity-30","p-4","flex","items-center","justify-center","text-sm","text-center"],["matRipple","",1,"relative","flex","items-center","p-2","hover:bg-base-200","rounded","w-full","text-left","space-x-2","z-0",3,"click"],[1,"h-10","w-1","rounded-full"],["date","",1,"leading-tight"],[1,"text-2xl","mx-auto"],[1,"font-medium","text-sm","uppercase","mx-auto","-mt-1"],[1,"flex-1","w-1/2"],[1,"flex","items-center","space-x-2","w-full"],[1,"text-sm","flex-1","truncate"],[1,"text-xs","opacity-30","truncate"]],template:function(n,o){if(1&n){const a=e.RV6();e.j41(0,"div",1)(1,"button",2),e.bIt("click",function(){return e.eBV(a),e.Njj(o.showSearch())}),e.j41(2,"app-icon"),e.EFF(3,"search"),e.k0s()(),e.j41(4,"input",3,0),e.bIt("ngModelChange",function(c){return e.eBV(a),e.Njj(o.search.next(c))})("blur",function(){return e.eBV(a),e.Njj(o.hideSearch())}),e.k0s(),e.DNE(6,Pe,2,0,"app-icon",4)(7,He,11,12,"div",5),e.k0s()}2&n&&(e.R7$(4),e.AVh("opacity-0",!o.show)("pointer-events-none",!o.show),e.Y8G("ngModel",o.search.getValue()),e.R7$(2),e.Y8G("ngIf",o.show),e.R7$(),e.Y8G("ngIf",o.show))},dependencies:[p.Sq,p.bT,_.me,_.BC,_.vS,b.r6,j.R,p.Jj,p.vh,ne.a]})}return i})();const We=()=>[];function Je(i,l){1&i&&(e.j41(0,"div",21),e.EFF(1," Timezone of the building is displayed and is different from your local timezone. "),e.k0s())}function Ze(i,l){1&i&&(e.j41(0,"div",22),e.EFF(1," Today "),e.k0s())}function Qe(i,l){if(1&i&&(e.j41(0,"div",23)(1,"div",24),e.EFF(2),e.k0s(),e.nrm(3,"div",25),e.k0s()),2&i){const t=l.$implicit;e.R7$(2),e.SpI(" ",t.display_name||t.name," ")}}function Ke(i,l){if(1&i&&(e.j41(0,"div",29),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit,n=e.XpG();e.R7$(),e.SpI(" ",n.formatHour(t)," ")}}function qe(i,l){if(1&i&&(e.j41(0,"div",26),e.nrm(1,"div",27),e.DNE(2,Ke,2,1,"div",28),e.k0s()),2&i){const t=l.index,n=e.XpG();e.xc7("height",n.block_height+"rem"),e.R7$(2),e.Y8G("ngIf",0!==t)}}function et(i,l){if(1&i&&e.nrm(0,"div",30),2&i){const t=e.XpG();e.xc7("top","calc("+t.timeToOffset(t.now)+"% + 1px)")}}function tt(i,l){if(1&i&&e.nrm(0,"div",31),2&i){const t=e.XpG();e.xc7("height",t.block_height+"rem")}}function nt(i,l){if(1&i&&e.nrm(0,"div",32),2&i){const t=l.index,n=e.XpG();e.xc7("left","calc("+t*n.block_width+"rem - 1px)")}}function ot(i,l){1&i&&(e.qex(0),e.nrm(1,"div",37),e.bVm())}function it(i,l){if(1&i&&(e.qex(0),e.nrm(1,"div",38),e.j41(2,"p",24),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.j41(5,"p",24),e.EFF(6),e.k0s(),e.bVm()),2&i){const t=e.XpG(2).$implicit,n=e.XpG(2);e.R7$(),e.AVh("bg-secondary","cancelled"!==t.status)("bg-error","cancelled"===t.status),e.R7$(),e.AVh("opacity-60","cancelled"===t.status),e.R7$(),e.Lme(" ",t.all_day?"All Day":e.brH(4,11,t.date,n.time_format,n.tz)," \u2013 ",t.title," "),e.R7$(2),e.AVh("opacity-60","cancelled"===t.status),e.R7$(),e.SpI(" ",(null==t.organiser?null:t.organiser.name)||t.host," ")}}function st(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",34),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG().$implicit,s=e.XpG();return e.Njj(s.viewEvent(o,a.id))}),e.j41(1,"div",35),e.DNE(2,ot,2,0,"ng-container",36)(3,it,7,15,"ng-container",36),e.k0s()()}if(2&i){const t=e.XpG().$implicit,n=e.XpG().index,o=e.XpG();e.xc7("left",n*o.block_width+.25+"rem")("top",o.timeToOffset(t.date)+"%")("height",o.endToOffset(t.duration)+"%"),e.Y8G("matTooltip",o.eventTooltip(t)),e.R7$(),e.AVh("opacity-60","done"===t.state)("!rounded-none",t.is_system_event)("!border-secondary",t.is_system_event),e.R7$(),e.Y8G("ngIf",t.is_system_event),e.R7$(),e.Y8G("ngIf",!t.is_system_event)}}function at(i,l){if(1&i&&(e.qex(0),e.DNE(1,st,4,15,"button",33),e.nI1(2,"async"),e.bVm()),2&i){const t=l.$implicit,n=e.XpG(2);e.R7$(),e.Y8G("ngIf",!t.is_system_event||e.bMT(2,1,n.ui_options).show_overflow)}}function lt(i,l){if(1&i&&(e.qex(0),e.DNE(1,at,3,3,"ng-container",19),e.nI1(2,"async"),e.bVm()),2&i){const t=l.$implicit,n=e.XpG();e.R7$(),e.Y8G("ngForOf",e.bMT(2,1,n.events)[t.id]||e.lJ4(3,We))}}function rt(i,l){if(1&i&&e.nrm(0,"div",39),2&i){const t=e.XpG();e.xc7("top",t.timeToOffset(t.now)+"%")}}let ct=(()=>{class i extends d.Tv{get now(){return(0,K.c)(Date.now()).valueOf()}get timezone(){return this._settings.get("app.events.use_building_timezone")?this._org.building.timezone:""}get tz(){const t=this.timezone;if(!t)return"";const n=(0,d.GF)(t);return n===this._local_tz?"":n}get block_start(){return+this._settings.get("app.events.block_start")||0}get block_end(){return+this._settings.get("app.events.block_end")||24}get block_range(){return Math.min(24,Math.max(this.block_end-this.block_start,1))}get block_height(){return+this._settings.get("app.events.block_height")||3}get time_format(){return this._settings.time_format}constructor(t,n,o,a){super(),this._state=t,this._dialog=n,this._settings=o,this._org=a,this.block_width=14,this.ui_options=this._state.options,this.spaces=this._state.spaces,this.date=this._state.date,this.is_today=this.date.pipe((0,h.T)(s=>(0,V.r)(s,Date.now()))),this.show_time=(0,w.zV)([this.date,this._org.active_building]).pipe((0,h.T)(([s])=>{const c=(0,V.r)(s,Date.now()),m=this.timezone?(0,d.Fz)(this.timezone):0,g=(0,D.L)((0,k.a)((0,F.o)(Date.now()),this.block_start),-m).valueOf(),f=(0,D.L)((0,k.a)((0,F.o)(Date.now()),this.block_end),-m).valueOf();return c&&Date.now()>=g&&Date.now()<=f})),this.events=(0,w.zV)([this._state.spaces,this._state.filtered,this.date]).pipe((0,J.B)(300),(0,h.T)(([s,c,m])=>{const g={},f=this.timezone?(0,d.Fz)(this.timezone):0,M=(0,D.L)((0,k.a)((0,F.o)(m),this.block_start),-f).valueOf(),B=(0,D.L)((0,k.a)((0,F.o)(m),this.block_end),-f).valueOf();for(const T of s)g[T.id]=c.filter(C=>C.resources.find(ie=>ie.id===T.id||ie.email===T.email)||C.system?.id===T.id||C.system?.email===T.email).filter(C=>C.date_end>=M&&C.date<=B);return g}),(0,Ye.Z)({}),(0,N.t)(1)),this._hour_list=Array.from({length:24},(s,c)=>c),this.hours=[],this.edit=s=>this._state.newBooking(s),this.setDate=s=>this._state.setDate(s),this._local_tz=(0,d.GF)(Intl.DateTimeFormat().resolvedOptions().timeZone),this._date_pipe=new p.vh("en")}formatHour(t){const n=(0,k.a)(Date.now(),t);return this._settings.get("app.use_24_hour_time")?(0,R.GP)(n,"HH:00"):(0,R.GP)(n,"h a")}eventTooltip(t){return`Start: ${t.all_day?"All Day":this._date_pipe.transform(t.date,this.time_format)}\nTitle:  ${t.title}\nHost:  ${t.organiser?.name||t.host}`}ngOnInit(){this.subscription("poll",this._state.startPolling()),this.subscription("hour_list",this._org.active_building.subscribe(()=>{this.hours=this._hour_list.filter(o=>o>=this.block_start&&o<this.block_end)})),this.hours=this._hour_list.filter(o=>o>=this.block_start&&o<this.block_end);const t=Intl.DateTimeFormat().resolvedOptions().timeZone;this.timezone&&(0,d.Fz)(t,this.timezone)}timeToOffset(t){const n=Intl.DateTimeFormat().resolvedOptions().timeZone,o=this.timezone?(0,d.Fz)(this.timezone,n):0,a=(0,k.a)((0,F.o)(this._state.getDate()),this.block_start-o),s=(0,W.o)(t,a);return Math.max(0,s/60)/this.block_range*100}endToOffset(t){return Math.min(this.block_range,t/60)/this.block_range*100}viewEvent(t,n,o=!1){var a=this;if(t.is_system_event)return;const s=this._dialog.open(I.bQ,{data:t});s.componentInstance.hide_edit=!this._settings.get("app.events.allow_edit"),this.subscription("remove",s.componentInstance.remove.subscribe(()=>this.remove(t,n))),this.subscription("edit",s.componentInstance.edit.subscribe(()=>this.edit(t))),this.subscription("actions",s.componentInstance.action.subscribe(function(){var c=(0,v.A)(function*(m){if(!m.includes("breakdown"))return;const f=yield a._dialog.open(I.Nm,{data:t}).afterClosed().toPromise();f&&a._state.replace(f)});return function(m){return c.apply(this,arguments)}}()))}remove(t,n){var o=this;return(0,v.A)(function*(){const a=`${(0,R.GP)(t.date,"dd MMM yyyy "+o.time_format)}`,c=`Delete the booking for ${t.space?.display_name} at ${a}`,m=yield(0,d.GE)({title:"Delete booking",content:c,icon:{content:"delete"}},o._dialog);"done"===m.reason&&(m.loading("Requesting booking deletion..."),yield(0,I.Dk)(t.id,{calendar:t.calendar||t.mailbox||t.host,system_id:n}).toPromise().catch(g=>{throw(0,d.UG)(`Unable to delete booking. ${g}`),m.close(),g}),(0,d.VX)("Successfully deleted booking."),o._dialog.closeAll())})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(u.G),e.rXU(q.bZ),e.rXU(d.h$),e.rXU(x.yb))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["room-bookings-timeline"]],features:[e.Vt3],decls:32,vars:38,consts:[["class","mx-2 mt-2 p-2 w-[calc(100%-1rem)] bg-info text-info-content rounded-lg text-center text-xs",4,"ngIf"],[1,"relative","flex","items-center","justify-center","p-2","space-x-2","border-b","border-base-200","z-20"],[3,"dateChange","date","is_new"],["class","absolute top-1/2 -translate-y-1/2 left-4 text-info text-sm",4,"ngIf"],[1,"absolute","top-1/2","-translate-y-1/2","right-8"],[3,"selected"],["timeline","",1,"grid","overflow-auto","w-full","h-1/2","flex-1","z-0"],["timezone","",1,"sticky","top-0","left-0","z-30","bg-base-100","flex","items-center","justify-center"],[1,"text-xs","opacity-30"],[1,"absolute","h-2","w-px","right-0","bottom-0","bg-base-300"],[1,"absolute","w-2","h-px","right-0","bottom-0","bg-base-300"],["space-headers","",1,"sticky","top-0","z-20","border-b","border-base-300","flex","items-center","bg-base-100"],["class","relative h-full w-56 flex items-center justify-center",4,"ngFor","ngForOf"],["hour-blocks","",1,"sticky","left-0","z-10","border-r","border-base-300","bg-base-100","overflow-visible"],["class","relative w-full",3,"height",4,"ngFor","ngForOf"],["class","absolute bg-secondary right-0 translate-x-1/2 -translate-y-1/2 h-2 w-2 rounded-full",3,"top",4,"ngIf"],["space-blocks","",1,"relative","overflow-hidden"],["class","relative w-full border-b border-base-200",3,"height",4,"ngFor","ngForOf"],["class","absolute w-px h-full bg-base-200 top-0",3,"left",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","absolute inset-x-0 h-[2px] bg-secondary",3,"top",4,"ngIf"],[1,"mx-2","mt-2","p-2","w-[calc(100%-1rem)]","bg-info","text-info-content","rounded-lg","text-center","text-xs"],[1,"absolute","top-1/2","-translate-y-1/2","left-4","text-info","text-sm"],[1,"relative","h-full","w-56","flex","items-center","justify-center"],[1,"truncate"],[1,"absolute","h-2","w-px","-left-px","bottom-0","bg-base-300"],[1,"relative","w-full"],[1,"absolute","-top-px","right-0","w-2","h-px","bg-base-300"],["class","absolute -top-px right-3 -translate-y-1/2 text-xs opacity-60",4,"ngIf"],[1,"absolute","-top-px","right-3","-translate-y-1/2","text-xs","opacity-60"],[1,"absolute","bg-secondary","right-0","translate-x-1/2","-translate-y-1/2","h-2","w-2","rounded-full"],[1,"relative","w-full","border-b","border-base-200"],[1,"absolute","w-px","h-full","bg-base-200","top-0"],["event","","matRipple","","class","absolute w-52 hover:opacity-90 text-left",3,"left","top","height","matTooltip","click",4,"ngIf"],["event","","matRipple","",1,"absolute","w-52","hover:opacity-90","text-left",3,"click","matTooltip"],[1,"relative","w-full","h-full","shadow","bg-base-100","border","border-base-200","hover:bg-base-200","rounded-lg","overflow-hidden","px-3","py-1","text-xs"],[4,"ngIf"],[1,"absolute","-inset-px","bg-secondary","opacity-30"],[1,"absolute","left-0","inset-y-0","w-1"],[1,"absolute","inset-x-0","h-[2px]","bg-secondary"]],template:function(n,o){if(1&n&&(e.DNE(0,Je,2,0,"div",0),e.j41(1,"div",1)(2,"date-options",2),e.nI1(3,"async"),e.bIt("dateChange",function(s){return o.setDate(s)}),e.k0s(),e.DNE(4,Ze,2,0,"div",3),e.nI1(5,"async"),e.j41(6,"div",4)(7,"room-booking-search",5),e.bIt("selected",function(s){return o.viewEvent(s,null==s.system?null:s.system.id,!0)}),e.k0s()()(),e.j41(8,"div",6)(9,"div",7)(10,"div",8),e.EFF(11),e.nI1(12,"async"),e.nI1(13,"date"),e.k0s(),e.nrm(14,"div",9)(15,"div",10),e.k0s(),e.j41(16,"div",11),e.nI1(17,"async"),e.DNE(18,Qe,4,1,"div",12),e.nI1(19,"async"),e.k0s(),e.j41(20,"div",13),e.DNE(21,qe,3,3,"div",14)(22,et,1,2,"div",15),e.nI1(23,"async"),e.k0s(),e.j41(24,"div",16),e.DNE(25,tt,1,2,"div",17)(26,nt,1,2,"div",18),e.nI1(27,"async"),e.DNE(28,lt,3,4,"ng-container",19),e.nI1(29,"async"),e.DNE(30,rt,1,2,"div",20),e.nI1(31,"async"),e.k0s()()),2&n){let a;e.Y8G("ngIf",o.timezone&&o.tz),e.R7$(2),e.Y8G("date",e.bMT(3,16,o.date))("is_new",!0),e.R7$(2),e.Y8G("ngIf",e.bMT(5,18,o.is_today)),e.R7$(7),e.SpI(" ",e.brH(13,22,e.bMT(12,20,o.date),"z",o.tz)," "),e.R7$(5),e.xc7("width",(null==(a=e.bMT(17,26,o.spaces))?null:a.length)*o.block_width+"rem"),e.R7$(2),e.Y8G("ngForOf",e.bMT(19,28,o.spaces)),e.R7$(2),e.xc7("height",o.block_range*o.block_height+"rem"),e.R7$(),e.Y8G("ngForOf",o.hours),e.R7$(),e.Y8G("ngIf",e.bMT(23,30,o.show_time)&&o.timeToOffset(o.now)<100),e.R7$(3),e.Y8G("ngForOf",o.hours),e.R7$(),e.Y8G("ngForOf",e.bMT(27,32,o.spaces)),e.R7$(2),e.Y8G("ngForOf",e.bMT(29,34,o.spaces)),e.R7$(2),e.Y8G("ngIf",e.bMT(31,36,o.show_time))}},dependencies:[p.Sq,p.bT,O.o,ee.oV,b.r6,oe,p.Jj,p.vh],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;max-width:100%}[timeline][_ngcontent-%COMP%]{grid-template-columns:4rem auto;grid-template-rows:3.5rem auto}\n\n/*# sourceMappingURL=room-timeline.component.ts-angular-inline--75.css.map*/"]})}return i})();var pt=r(41134),dt=r(93208),mt=r(22011);function ut(i,l){1&i&&(e.j41(0,"div",12),e.nrm(1,"img",13),e.j41(2,"p"),e.EFF(3,"No pending requests"),e.k0s()())}function gt(i,l){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&i){const t=e.XpG().$implicit,n=e.XpG();e.R7$(),e.JRh(e.brH(2,1,t.date,"z",n.tz))}}function ft(i,l){if(1&i&&(e.nrm(0,"img",28),e.nI1(1,"space"),e.nI1(2,"async")),2&i){let t;const n=e.XpG().$implicit;e.Y8G("source",null==(t=e.bMT(2,3,e.bMT(1,1,null==n.resources[0]?null:n.resources[0].email)))?null:t.images[0])}}function ht(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",14)(1,"h3"),e.EFF(2),e.k0s(),e.j41(3,"p",15),e.EFF(4),e.nI1(5,"date"),e.nI1(6,"date"),e.DNE(7,gt,3,5,"span",16),e.k0s(),e.j41(8,"div",17),e.DNE(9,ft,3,5,"img",18),e.k0s(),e.j41(10,"div",19)(11,"div",20)(12,"app-icon",21),e.EFF(13,"place"),e.k0s()(),e.j41(14,"div",22),e.EFF(15),e.nI1(16,"space"),e.nI1(17,"async"),e.nI1(18,"space"),e.nI1(19,"async"),e.k0s()(),e.j41(20,"div",19)(21,"div",20)(22,"app-icon",21),e.EFF(23,"person"),e.k0s()(),e.j41(24,"div",22),e.EFF(25),e.k0s()(),e.j41(26,"div",23)(27,"button",24),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.approve(o))}),e.j41(28,"div"),e.EFF(29),e.k0s(),e.j41(30,"app-icon",25),e.EFF(31,"done"),e.k0s()(),e.j41(32,"button",26),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.reject(o))}),e.j41(33,"div"),e.EFF(34),e.k0s(),e.j41(35,"app-icon",27),e.EFF(36,"close"),e.k0s()()()()}if(2&i){let t;const n=l.$implicit,o=e.XpG();e.R7$(2),e.JRh(n.title),e.R7$(2),e.Lme(" ",e.brH(5,11,n.date,"mediumDate",o.tz)," ",e.brH(6,15,n.date,o.time_format,o.tz)," "),e.R7$(3),e.Y8G("ngIf",o.tz),e.R7$(2),e.Y8G("ngIf",n.resources.length),e.R7$(6),e.SpI(" ",(null==(t=n.resources.length&&e.bMT(17,21,e.bMT(16,19,null==n.resources[0]?null:n.resources[0].email)))?null:t.display_name)||(null==(t=e.bMT(19,25,e.bMT(18,23,null==n.resources[0]?null:n.resources[0].email)))?null:t.name)||"No Location"," "),e.R7$(10),e.SpI(" ",(null==n.organiser?null:n.organiser.name)||n.host," "),e.R7$(2),e.Y8G("disabled","accept"===o.status[n.id]),e.R7$(2),e.SpI(" ","accept"===o.status[n.id]?"Approved":"Approve"," "),e.R7$(3),e.Y8G("disabled","decline"===o.status[n.id]),e.R7$(2),e.SpI(" ","decline"===o.status[n.id]?"Declined":"Decline"," ")}}function _t(i,l){1&i&&(e.j41(0,"div",29),e.nrm(1,"div",30)(2,"mat-spinner",31),e.j41(3,"p",32),e.EFF(4,"Processing..."),e.k0s()())}function vt(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",33),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.show=!o.show)}),e.j41(1,"app-icon"),e.EFF(2,"chevron_left"),e.k0s()()}}let bt=(()=>{class i{get time_format(){return this._settings.time_format}get timezone(){return this._settings.get("app.events.use_building_timezone")?this._org.building.timezone:""}get tz(){const t=this.timezone;if(!t)return"";const n=(0,d.GF)(t);return n===this._local_tz?"":n}set show(t){this._show=t,sessionStorage.setItem("PlaceOS.Concierge.show_room_approvals",`${t}`)}get show(){return this._show}constructor(t,n,o){this._state=t,this._org=n,this._settings=o,this._show=!0,this.loading=!1,this.status={},this.search=new te.t(""),this.pending=this._state.pending,this._local_tz=(0,d.GF)(Intl.DateTimeFormat().resolvedOptions().timeZone),this.filtered_pending=(0,w.zV)([this._state.pending,this.search]).pipe((0,h.T)(([a,s])=>a.filter(c=>c.title.toLowerCase().includes(s.toLowerCase())||c.host.toLowerCase().includes(s.toLowerCase())||c.organiser?.name.toLowerCase().includes(s.toLowerCase()))))}ngOnInit(){this._show="false"!==sessionStorage.getItem("PlaceOS.Concierge.show_room_approvals")}approve(t){var n=this;return(0,v.A)(function*(){const o=n._org.binding("approvals");if(!o)return;const a=(0,S.f_4)(o,"RoomBookingApproval",1);a&&(n.loading=!0,yield a.execute("accept_event",[t.mailbox,t.id]).catch(),n.loading=!1,n.status[t.id]="accept")})()}reject(t){var n=this;return(0,v.A)(function*(){const o=n._org.binding("approvals");if(!o)return;const a=(0,S.f_4)(o,"RoomBookingApproval",1);a&&(n.loading=!0,yield a.execute("decline_event",[t.mailbox,t.id]).catch(),n.loading=!1,n.status[t.id]="decline")})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(u.G),e.rXU(x.yb),e.rXU(d.h$))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["room-bookings-approvals"]],decls:21,vars:19,consts:[[1,"flex","flex-col","h-full","overflow-hidden","border-l","border-base-200","w-[20rem]"],[1,"flex","items-center","p-2","justify-center","border-b","border-base-200","space-x-2","relative"],["btn","","icon","","matRipple","","matTooltip","Hide Pending Approvals","matTooltipPosition","left",1,"absolute","top-4","left-2","bg-base-200",3,"click"],[1,"flex-1","py-4","text-center"],[1,"border-b","border-base-200","relative"],["type","text","placeholder","Search...",1,"w-full","py-3","pr-4","pl-10",3,"ngModelChange","ngModel"],[1,"absolute","top-1/2","left-2","-translate-y-1/2","text-2xl","pointer-events-none"],[1,"flex-1","overflow-auto","p-2","space-y-2"],["class","w-full h-full flex flex-col items-center justify-center space-y-2",4,"ngIf"],["class","relative border border-base-200 p-2 w-full rounded",4,"ngFor","ngForOf"],["class","absolute bottom-0 left-0 right-0 top-14 p-2 flex flex-col items-center justify-center space-y-2",4,"ngIf"],["btn","","icon","","matRipple","","class","bg-warning absolute top-2 -left-8 shadow text-warning-content","matTooltip","Show Pending Approvals","matTooltipPosition","left",3,"click",4,"ngIf"],[1,"w-full","h-full","flex","flex-col","items-center","justify-center","space-y-2"],["src","assets/icons/no-pending.svg"],[1,"relative","border","border-base-200","p-2","w-full","rounded"],[1,"opacity-30","text-xs","mb-2"],[4,"ngIf"],[1,"w-64","h-32","overflow-hidden","mb-2","bg-base-200"],["auth","","class","object-cover min-w-full min-h-full",3,"source",4,"ngIf"],[1,"flex","items-center","space-x-2","mb-2"],[1,"h-8","w-8","bg-base-200","rounded-full","flex","items-center","justify-center"],[1,"text-xl"],[1,"flex-1","text-xs"],[1,"flex","items-center","space-x-2"],["btn","","matRipple","",1,"border-success","bg-success-light","text-black","flex","flex-1","items-center","space-x-2",3,"click","disabled"],[1,"text-success"],["btn","","matRipple","",1,"border-error","bg-error-light","text-black","flex","flex-1","items-center","space-x-2",3,"click","disabled"],[1,"text-error"],["auth","",1,"object-cover","min-w-full","min-h-full",3,"source"],[1,"absolute","bottom-0","left-0","right-0","top-14","p-2","flex","flex-col","items-center","justify-center","space-y-2"],[1,"absolute","inset-0","bg-base-100","opacity-80","z-0"],["diameter","32"],[1,"relative","z-10"],["btn","","icon","","matRipple","","matTooltip","Show Pending Approvals","matTooltipPosition","left",1,"bg-warning","absolute","top-2","-left-8","shadow","text-warning-content",3,"click"]],template:function(n,o){if(1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"button",2),e.bIt("click",function(){return o.show=!o.show}),e.j41(3,"app-icon"),e.EFF(4,"chevron_right"),e.k0s()(),e.j41(5,"h3",3),e.EFF(6),e.nI1(7,"async"),e.nI1(8,"async"),e.k0s()(),e.j41(9,"div",4)(10,"input",5),e.nI1(11,"async"),e.bIt("ngModelChange",function(s){return o.search.next(s)}),e.k0s(),e.j41(12,"app-icon",6),e.EFF(13," search "),e.k0s()(),e.j41(14,"div",7),e.DNE(15,ut,4,0,"div",8),e.nI1(16,"async"),e.DNE(17,ht,37,27,"div",9),e.nI1(18,"async"),e.k0s(),e.DNE(19,_t,5,0,"div",10),e.k0s(),e.DNE(20,vt,3,0,"button",11)),2&n){let a,s;e.xc7("width",o.show?"":"0px"),e.R7$(6),e.Lme(" Pending Approval (",(null==(a=e.bMT(7,9,o.filtered_pending))?null:a.length)||"0"," of ",(null==(a=e.bMT(8,11,o.pending))?null:a.length)||"0",") "),e.R7$(4),e.Y8G("ngModel",e.bMT(11,13,o.search)),e.R7$(5),e.Y8G("ngIf",!(null!=(s=e.bMT(16,15,o.filtered_pending))&&s.length)),e.R7$(2),e.Y8G("ngForOf",e.bMT(18,17,o.filtered_pending)),e.R7$(2),e.Y8G("ngIf",o.loading),e.R7$(),e.Y8G("ngIf",!o.show)}},dependencies:[p.Sq,p.bT,_.me,_.BC,_.vS,ee.oV,pt.LG,b.r6,j.R,dt.U,p.Jj,p.vh,mt.J],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}\n\n/*# sourceMappingURL=room-approvals.component.ts-angular-inline--76.css.map*/"]})}return i})();var yt=r(28797),Y=r(90610);const wt=()=>[];function kt(i,l){1&i&&(e.j41(0,"div",16),e.EFF(1," Timezone of the building is displayed and is different from your local timezone. "),e.k0s())}function Tt(i,l){1&i&&(e.j41(0,"div",17),e.EFF(1," This Week "),e.k0s())}function Rt(i,l){1&i&&(e.j41(0,"div",22),e.EFF(1," Today "),e.k0s())}function Ft(i,l){if(1&i&&(e.j41(0,"div",18)(1,"div",19),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.DNE(4,Rt,2,0,"div",20),e.nrm(5,"div",21),e.k0s()),2&i){const t=l.$implicit,n=e.XpG();e.R7$(2),e.SpI(" ",e.brH(3,2,t,"EEE, MMM d",n.tz)," "),e.R7$(2),e.Y8G("ngIf",n.isToday(t))}}function It(i,l){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&i){const t=e.XpG().$implicit,n=e.XpG(2);e.R7$(),e.JRh(e.brH(2,1,t.date_end,"z",n.tz))}}function Ct(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",25),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.viewEvent(o))}),e.nrm(1,"div",26),e.j41(2,"div",27)(3,"div",28),e.EFF(4),e.k0s(),e.j41(5,"div",29),e.EFF(6),e.nI1(7,"date"),e.nI1(8,"date"),e.DNE(9,It,3,5,"span",30),e.k0s(),e.j41(10,"div",31),e.EFF(11),e.k0s(),e.j41(12,"div",31),e.EFF(13),e.nI1(14,"user"),e.k0s()()()}if(2&i){let t;const n=l.$implicit,o=e.XpG(2);e.R7$(),e.xc7("background-color",o.typeColor(n.type)),e.R7$(2),e.AVh("line-through","done"===n.state),e.R7$(),e.SpI(" ",n.title," "),e.R7$(2),e.Lme(" ",e.brH(7,10,n.date,o.time_format,o.tz)," \u2013 ",e.brH(8,14,n.date_end,o.time_format,o.tz)," "),e.R7$(3),e.Y8G("ngIf",o.tz),e.R7$(2),e.SpI(" ",null==n.system?null:n.system.display_name," "),e.R7$(2),e.SpI(" ",(null==(t=e.bMT(14,18,n.host))?null:t.name)||n.host," ")}}function jt(i,l){if(1&i&&(e.j41(0,"div",23),e.DNE(1,Ct,15,20,"button",24),e.nI1(2,"async"),e.k0s()),2&i){const t=l.$implicit,n=e.XpG();e.R7$(),e.Y8G("ngForOf",e.bMT(2,1,n.events)[t]||e.lJ4(3,wt))}}let Mt=(()=>{class i extends d.Tv{get timezone(){return this._settings.get("app.events.use_building_timezone")?this._org.building.timezone:""}get tz(){const t=this.timezone;if(!t)return"";const n=(0,d.GF)(t);return n===this._local_tz?"":n}get timezone_offset(){return(0,d.vb)(this.timezone||Intl.DateTimeFormat().resolvedOptions().timeZone)}get now(){return(0,K.c)(Date.now()).valueOf()}isToday(t){return(0,V.r)(t,Date.now())}get time_format(){return this._settings.time_format}constructor(t,n,o,a){super(),this._state=t,this._dialog=n,this._settings=o,this._org=a,this.hours=Array.from({length:24},(s,c)=>c),this.ui_options=this._state.options,this.date=this._state.date,this.types=[{id:"internal",name:"Internal",color:"#D81B60"},{id:"external",name:"External",color:"#1E88E5"},{id:"cancelled",name:"Cancelled",color:"#eeeeee"}],this.days=this.date.pipe((0,h.T)(s=>new Array(7).fill(0).map((c,m)=>(0,yt.f)((0,k.a)((0,Y.k)(s),12-Math.floor(this.timezone_offset/60)),m).valueOf()))),this.this_week=this.date.pipe((0,h.T)(s=>function xt(i,l,t){return+(0,Y.k)(i,t)==+(0,Y.k)(l,t)}(s,Date.now()))),this._data_pipe=new p.vh("en"),this.events=(0,w.zV)([this.days,this._state.filtered,this._state.zones]).pipe((0,h.T)(([s,c,m])=>{m.length&&(c=c.filter(f=>f.system?.zones.find(M=>m.includes(M))));const g={};for(const f of s){const M=this._data_pipe.transform(f,"yyyy-MM-dd",this.tz);g[f]=c.filter(B=>{const T=this._data_pipe.transform(B.date,"yyyy-MM-dd",this.tz);return M===T&&!B.is_system_event})}return g}),(0,N.t)(1)),this.event_max_count=this.events.pipe((0,h.T)(s=>{let c=0;for(const m in s)s[m].length>c&&(c=s[m].length);return c})),this._local_tz=(0,d.GF)(Intl.DateTimeFormat().resolvedOptions().timeZone),this.edit=s=>this._state.newBooking(s),this.setDate=s=>this._state.setDate(s)}ngOnInit(){this.subscription("poll",this._state.poll())}typeColor(t){return this.types.find(n=>n.id===t)?.color||"#EEE"}viewEvent(t,n,o=!1){var a=this;if(t.is_system_event)return;const s=this._dialog.open(I.bQ,{data:t});s.componentInstance.hide_edit=!this._settings.get("app.events.allow_edit"),this.subscription("remove",s.componentInstance.remove.subscribe(()=>this.remove(t,n))),this.subscription("edit",s.componentInstance.edit.subscribe(()=>this.edit(t))),this.subscription("actions",s.componentInstance.action.subscribe(function(){var c=(0,v.A)(function*(m){if(!m.includes("breakdown"))return;const f=yield a._dialog.open(I.Nm,{data:t}).afterClosed().toPromise();f&&a._state.replace(f)});return function(m){return c.apply(this,arguments)}}()))}remove(t,n){var o=this;return(0,v.A)(function*(){const a=`${(0,R.GP)(t.date,"dd MMM yyyy "+o.time_format)}`,c=`Delete the booking for ${t.space?.display_name} at ${a}`,m=yield(0,d.GE)({title:"Delete booking",content:c,icon:{content:"delete"}},o._dialog);"done"===m.reason&&(m.loading("Requesting booking deletion..."),yield(0,I.Dk)(t.id,{calendar:t.calendar||t.mailbox||t.host,system_id:n}).toPromise().catch(g=>{throw(0,d.UG)(`Unable to delete booking. ${g}`),m.close(),g}),(0,d.VX)("Successfully deleted booking."),o._dialog.closeAll())})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(u.G),e.rXU(q.bZ),e.rXU(d.h$),e.rXU(x.yb))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["room-week-bookings-timeline"]],features:[e.Vt3],decls:27,vars:36,consts:[["class","mx-2 mt-2 p-2 w-[calc(100%-1rem)] bg-info text-info-content rounded-lg text-center text-xs",4,"ngIf"],[1,"relative","flex","items-center","justify-center","p-2","space-x-2","border-b","border-base-200","z-20"],[3,"dateChange","date","step","is_new"],["class","absolute top-1/2 -translate-y-1/2 left-4 text-info text-sm",4,"ngIf"],[1,"absolute","top-1/2","-translate-y-1/2","right-8"],[3,"selected"],["timeline","",1,"grid","overflow-auto","w-full","h-1/2","flex-1","z-0"],["timezone","",1,"sticky","top-0","left-0","z-30","bg-base-100","flex","items-center","justify-center"],[1,"text-xs","opacity-30"],[1,"absolute","h-2","w-px","right-0","bottom-0","bg-base-300"],[1,"absolute","w-2","h-px","right-0","bottom-0","bg-base-300"],["day-headers","",1,"sticky","top-0","z-20","border-b","border-base-300","flex","items-center","bg-base-100","min-w-[calc(100%-3rem)]"],["class","relative flex-1 h-full min-w-48 flex flex-col items-center justify-center leading-tight",4,"ngFor","ngForOf"],["empty-block","",1,"sticky","left-0","z-10","border-r","border-base-300","bg-base-100","min-h-full"],["date-blocks","",1,"relative","overflow-hidden","min-w-[calc(100%-3rem)]","flex"],["class","flex-1 min-w-48 overflow-hidden p-2 border-r border-base-200",4,"ngFor","ngForOf"],[1,"mx-2","mt-2","p-2","w-[calc(100%-1rem)]","bg-info","text-info-content","rounded-lg","text-center","text-xs"],[1,"absolute","top-1/2","-translate-y-1/2","left-4","text-info","text-sm"],[1,"relative","flex-1","h-full","min-w-48","flex","flex-col","items-center","justify-center","leading-tight"],[1,"truncate"],["class","text-info text-xs absolute bottom-1 left-1/2 -translate-x-1/2",4,"ngIf"],[1,"absolute","h-2","w-px","-left-px","bottom-0","bg-base-300"],[1,"text-info","text-xs","absolute","bottom-1","left-1/2","-translate-x-1/2"],[1,"flex-1","min-w-48","overflow-hidden","p-2","border-r","border-base-200"],["matRipple","","class","flex p-2 w-full space-x-2 hover:bg-base-200 rounded text-left",3,"click",4,"ngFor","ngForOf"],["matRipple","",1,"flex","p-2","w-full","space-x-2","hover:bg-base-200","rounded","text-left",3,"click"],[1,"h-2","w-2","rounded-full","my-1.5"],[1,"flex-1","w-1/2"],[1,"text-sm","truncate"],[1,"text-xs","opacity-60","flex-1"],[4,"ngIf"],[1,"text-xs","truncate","opacity-30"]],template:function(n,o){if(1&n&&(e.DNE(0,kt,2,0,"div",0),e.j41(1,"div",1)(2,"date-options",2),e.nI1(3,"async"),e.bIt("dateChange",function(s){return o.setDate(s)}),e.k0s(),e.DNE(4,Tt,2,0,"div",3),e.nI1(5,"async"),e.j41(6,"div",4)(7,"room-booking-search",5),e.bIt("selected",function(s){return o.viewEvent(s,null==s.system?null:s.system.id,!0)}),e.k0s()()(),e.j41(8,"div",6)(9,"div",7)(10,"div",8),e.EFF(11),e.nI1(12,"async"),e.nI1(13,"date"),e.k0s(),e.nrm(14,"div",9)(15,"div",10),e.k0s(),e.j41(16,"div",11),e.nI1(17,"async"),e.DNE(18,Ft,6,6,"div",12),e.nI1(19,"async"),e.k0s(),e.nrm(20,"div",13),e.nI1(21,"async"),e.nI1(22,"async"),e.j41(23,"div",14),e.nI1(24,"async"),e.DNE(25,jt,3,4,"div",15),e.nI1(26,"async"),e.k0s()()),2&n){let a,s;e.Y8G("ngIf",o.timezone&&o.tz),e.R7$(2),e.Y8G("date",e.bMT(3,14,o.date))("step",7)("is_new",!0),e.R7$(2),e.Y8G("ngIf",e.bMT(5,16,o.this_week)),e.R7$(7),e.SpI(" ",e.brH(13,20,e.bMT(12,18,o.date),"z",o.tz)," "),e.R7$(5),e.xc7("width",12*(null==(a=e.bMT(17,24,o.days))?null:a.length)+"rem"),e.R7$(2),e.Y8G("ngForOf",e.bMT(19,26,o.days)),e.R7$(2),e.xc7("height",e.bMT(21,28,o.event_max_count)?5.375*e.bMT(22,30,o.event_max_count)+"rem":""),e.R7$(3),e.xc7("width",12*(null==(s=e.bMT(24,32,o.days))?null:s.length)+"rem"),e.R7$(2),e.Y8G("ngForOf",e.bMT(26,34,o.days))}},dependencies:[p.Sq,p.bT,O.o,b.r6,oe,p.Jj,p.vh,ne.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;max-width:100%}[timeline][_ngcontent-%COMP%]{grid-template-columns:4rem auto;grid-template-rows:3.5rem auto}\n\n/*# sourceMappingURL=room-week-timeline.component.ts-angular-inline--78.css.map*/"]})}return i})();var $t=r(56062);const Et=(i,l)=>l.id;function Gt(i,l){if(1&i&&(e.j41(0,"div",30),e.EFF(1),e.nI1(2,"building"),e.j41(3,"span",31),e.EFF(4," - "),e.k0s()()),2&i){let t;const n=e.XpG().$implicit;e.R7$(),e.SpI(" ",null==(t=e.bMT(2,1,n.parent_id))?null:t.display_name," ")}}function Dt(i,l){if(1&i&&(e.j41(0,"mat-option",27)(1,"div",28),e.DNE(2,Gt,5,3,"div",29),e.j41(3,"div"),e.EFF(4),e.k0s()()()),2&i){const t=l.$implicit,n=e.XpG();e.Y8G("value",t.id),e.R7$(2),e.Y8G("ngIf",n.use_region),e.R7$(2),e.SpI(" ",t.display_name||t.name," ")}}function Bt(i,l){1&i&&e.nrm(0,"div",15)}function zt(i,l){if(1&i){const t=e.RV6();e.qex(0),e.DNE(1,Bt,1,0,"div",32),e.j41(2,"mat-slide-toggle",33),e.nI1(3,"async"),e.bIt("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.Njj(a.updateUIOptions({show_overflow:o}))}),e.j41(4,"div",34),e.EFF(5,"Setup / Breakdown"),e.k0s()(),e.bVm()}if(2&i){let t;const n=e.XpG();e.R7$(),e.Y8G("ngIf",!n.use_region),e.R7$(),e.Y8G("ngModel",null==(t=e.bMT(3,2,n.ui_options))?null:t.show_overflow)}}function Ot(i,l){if(1&i){const t=e.RV6();e.j41(0,"mat-checkbox",6),e.bIt("ngModelChange",function(o){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.setFilter(a.id,!o))}),e.EFF(1),e.k0s()}if(2&i){const t=l.$implicit,n=e.XpG();e.Y8G("ngModel",!n.type_list.includes(t.id)),e.R7$(),e.SpI(" ",t.name," ")}}function Xt(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",23),e.nrm(1,"div",36),e.j41(2,"div"),e.EFF(3),e.k0s(),e.j41(4,"button",37),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG();return e.Njj(a.setFilter(o.id,!0))}),e.j41(5,"app-icon"),e.EFF(6,"close"),e.k0s()()()}if(2&i){const t=e.XpG().$implicit;e.R7$(),e.xc7("background-color",t.color),e.R7$(2),e.JRh(t.name)}}function St(i,l){if(1&i&&e.DNE(0,Xt,7,3,"div",35),2&i){const t=l.$implicit,n=e.XpG();e.Y8G("ngIf",!n.type_list.includes(t.id))}}function Nt(i,l){1&i&&e.nrm(0,"room-bookings-timeline",38)}function Vt(i,l){1&i&&e.nrm(0,"room-week-bookings-timeline",38)}function Yt(i,l){1&i&&e.nrm(0,"room-bookings-approvals",39)}const Ut=[];let Pt=(()=>{class i extends d.Tv{get type_list(){return this._state.filters.hide_type||Ut}get has_approvals(){return this._org.binding("approvals")}get allow_setup_breakdown(){return this._settings.get("app.events.allow_setup_breakdown")}get use_region(){return this._settings.get("app.use_region")}constructor(t,n,o,a,s){super(),this._org=t,this._state=n,this._router=o,this._route=a,this._settings=s,this.zones=this._state.zones,this.period=this._state.period,this.ui_options=this._state.options,this.levels=(0,w.zV)([this._org.active_building,this._org.active_region]).pipe((0,h.T)(([c,m])=>this.use_region?this._org.levelsForRegion(m):this._org.levelsForBuilding(c))),this.updateZones=c=>{console.warn("Update Zones:",c),this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:c.join(",")},queryParamsHandling:"merge"}),this._state.setZones(c)},this.updateUIOptions=c=>this._state.setUIOptions(c),this.setPeriod=c=>{console.warn("Set Period:",c),this._router.navigate([],{relativeTo:this._route,queryParams:{period:c},queryParamsHandling:"merge"}),this._state.setPeriod(c)},this.newBooking=c=>this._state.newBooking(c),this.types=[{id:"internal",name:"Internal",color:"#D81B60"},{id:"external",name:"External",color:"#1E88E5"},{id:"cancelled",name:"Cancelled",color:"#eeeeee"}]}ngOnInit(){var t=this;this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{if(n.has("period")&&this._state.setPeriod("day"===n.get("period")?"day":"week"),!this.use_region&&n.has("zone_ids")){const o=n.get("zone_ids").split(",");if(o.length){const a=this._org.levelWithID(o);if(!a)return;this._org.building=this._org.buildings.find(s=>s.id===a.parent_id),this.updateZones(o)}}})),this.subscription("levels",this._org.active_levels.pipe((0,J.B)(300)).subscribe(function(){var n=(0,v.A)(function*(o){if(t.use_region)return;const a=(yield t.zones.pipe((0,Z.s)(1)).toPromise()).filter(s=>o.find(c=>c.id===s));!a.length&&o.length&&a.push(o[0].id),t.updateZones(a)});return function(o){return n.apply(this,arguments)}}())),this.subscription("region",this._org.active_region.pipe((0,L.p)(n=>!!n)).subscribe(function(){var n=(0,v.A)(function*(o){(yield t.zones.pipe((0,Z.s)(1)).toPromise()).length||t.updateZones([o.id])});return function(o){return n.apply(this,arguments)}}()))}setFilter(t,n){let a=this._state.filters.hide_type||[];a=a.filter(s=>s!==t),n&&a.push(t),this._state.setFilters({hide_type:a})}static#e=this.\u0275fac=function(n){return new(n||i)(e.rXU(x.yb),e.rXU(u.G),e.rXU(y.Ix),e.rXU(y.nX),e.rXU(d.h$))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["room-bookings"]],features:[e.Vt3],decls:44,vars:19,consts:[["menu","matMenu"],[1,"absolute","inset-0","flex","flex-col","overflow-hidden","pl-8"],[1,"flex","items-center","w-full","py-4","pr-8","space-x-4"],[1,"text-2xl","font-medium"],[1,"flex-1","w-px"],["appearance","outline",1,"no-subscript","w-32"],[3,"ngModelChange","ngModel"],["value","day"],["value","week"],["btn","","matRipple","",1,"space-x-2",3,"click"],[1,"w-full","flex","items-center"],["appearance","outline",1,"no-subscript","w-52"],["placeholder","All Levels","multiple","",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"border-l","h-full","ml-8","mr-4"],[1,"flex","items-center","space-x-2","max-w-[calc(100%-16rem)]","flex-1"],["btn","","matRipple","",1,"inverse",3,"matMenuTriggerFor"],[1,"mx-2"],[1,""],[1,"flex","flex-col","space-y-2","overflow-hidden","w-48"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[1,"flex","items-center","overflow-x-auto","flex-1","w-px","space-x-2","px-2"],[1,"flex","items-center","border","border-base-200","rounded-3xl"],[1,"flex","w-full","flex-1","h-px","border-t","mt-4","border-base-200"],["class","relative flex-1 w-1/2 z-0",4,"ngIf"],["class","relative z-10",4,"ngIf"],[3,"value"],[1,"flex","flex-col-reverse"],["class","text-xs opacity-30",4,"ngIf"],[1,"text-xs","opacity-30"],[1,"opacity-0"],["class","border-l h-full ml-8 mr-4",4,"ngIf"],[1,"m-2",3,"ngModelChange","ngModel"],[1,"text-xs"],["class","flex items-center border border-base-200 rounded-3xl",4,"ngIf"],[1,"h-4","w-4","m-2","rounded-full"],["icon","","matRipple","",3,"click"],[1,"relative","flex-1","w-1/2","z-0"],[1,"relative","z-10"]],template:function(n,o){if(1&n){const a=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h2",3),e.EFF(3,"Room Bookings"),e.k0s(),e.nrm(4,"div",4),e.j41(5,"mat-form-field",5)(6,"mat-select",6),e.nI1(7,"async"),e.bIt("ngModelChange",function(c){return e.eBV(a),e.Njj(o.setPeriod(c))}),e.j41(8,"mat-option",7),e.EFF(9,"Day"),e.k0s(),e.j41(10,"mat-option",8),e.EFF(11,"Week"),e.k0s()()(),e.j41(12,"button",9),e.bIt("click",function(){return e.eBV(a),e.Njj(o.newBooking())}),e.j41(13,"div"),e.EFF(14,"New Booking"),e.k0s(),e.j41(15,"app-icon"),e.EFF(16,"add"),e.k0s()()(),e.j41(17,"div",10)(18,"mat-form-field",11)(19,"mat-select",12),e.nI1(20,"async"),e.bIt("ngModelChange",function(c){return e.eBV(a),e.Njj(o.updateZones(c))}),e.DNE(21,Dt,5,3,"mat-option",13),e.nI1(22,"async"),e.k0s()(),e.DNE(23,zt,6,4,"ng-container",14),e.nrm(24,"div",15),e.j41(25,"div",16)(26,"button",17)(27,"app-icon"),e.EFF(28,"filter_list"),e.k0s(),e.j41(29,"div",18),e.EFF(30,"Filters"),e.k0s()(),e.j41(31,"mat-menu",19,0)(33,"div",20),e.DNE(34,Ot,2,2,"mat-checkbox",21),e.k0s()(),e.j41(35,"div",22),e.Z7z(36,St,1,1,"div",23,Et),e.k0s()()(),e.j41(38,"div",24),e.DNE(39,Nt,1,0,"room-bookings-timeline",25),e.nI1(40,"async"),e.DNE(41,Vt,1,0,"room-week-bookings-timeline",25),e.nI1(42,"async"),e.DNE(43,Yt,1,0,"room-bookings-approvals",26),e.k0s()()}if(2&n){const a=e.sdS(32);e.R7$(6),e.Y8G("ngModel",e.bMT(7,9,o.period)),e.R7$(13),e.Y8G("ngModel",e.bMT(20,11,o.zones)),e.R7$(2),e.Y8G("ngForOf",e.bMT(22,13,o.levels)),e.R7$(2),e.Y8G("ngIf",o.allow_setup_breakdown),e.R7$(3),e.Y8G("matMenuTriggerFor",a),e.R7$(8),e.Y8G("ngForOf",o.types),e.R7$(2),e.Dyx(o.types),e.R7$(3),e.Y8G("ngIf","day"===e.bMT(40,15,o.period)),e.R7$(2),e.Y8G("ngIf","week"===e.bMT(42,17,o.period)),e.R7$(2),e.Y8G("ngIf",o.has_approvals)}},dependencies:[p.Sq,p.bT,_.BC,_.vS,P.rl,X.VO,b.wT,Ve.So,A.sG,Q.kk,Q.Cp,b.r6,j.R,ct,bt,Mt,p.Jj,$t.b]})}return i})();const At=["app-new-dayview",""],Lt=[{path:"",component:ze},{path:"new",component:(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["","app-new-dayview",""]],attrs:At,decls:5,vars:0,consts:[[1,"flex","flex-1","h-px"],[1,"relative","flex","flex-col","flex-1","w-1/2","h-full"]],template:function(n,o){1&n&&(e.nrm(0,"app-topbar"),e.j41(1,"div",0),e.nrm(2,"app-sidebar"),e.j41(3,"main",1),e.nrm(4,"room-bookings"),e.k0s()())},dependencies:[Se.S,Ne.c,Pt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}@media print{[_nghost-%COMP%]{display:none}}\n\n/*# sourceMappingURL=new-dayview.component.ts-angular-inline--77.css.map*/"]})}return i})()}];let Ht=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[p.MD,_.YN,z.r,H.lx,Oe.kR,Xe.bR,y.iI.forChild(Lt)]})}return i})()},68390:(se,$,r)=>{r.d($,{g8:()=>d,kR:()=>p.k,Gp:()=>e.Gp,KJ:()=>e.KJ,N8:()=>E.N8,SZ:()=>E.SZ});var p=r(73850),z=(r(11543),r(44621),r(99908));class d{constructor(u={}){this.type=u.type||u.location||"other",this.position=u.position||u.map_id||u.asset_id||{x:u.x/u.map_width||0,y:u.y/u.map_height||0},this.variance=u.variance||0,this.last_seen=u.last_seen||(0,z._)(new Date),this.level=u.level,this.building=u.building,this.at_location=!!u.at_location,this.coordinates_from=u.coordinates_from||"top-left"}}var e=r(93693),E=(r(24129),r(86039),r(2372))}}]);
//# sourceMappingURL=apps_concierge_src_app_day-view_day-view_module_ts.js.map