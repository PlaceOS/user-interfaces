"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_day-view_day-view_module_ts"],{596:(ue,Z,s)=>{s.r(Z),s.d(Z,{DayViewModule:()=>c});var r=s(4666),w=s(2508),h=s(9885),A=s(3045),u=s(9112),e=s(2560),J=s(4945),Y=s(3918),F=s(5670),b=s(6221),f=s(3194),I=s(8441),N=s(5074),C=s(7371),x=s(207),Q=s(4714),D=s(5306);function z(o,n){if(1&o&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}function L(o,n){if(1&o&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}const P=function(){return{class:"material-icons",content:"add"}};class p extends u.KG{constructor(n,t,i,a){super(),this._state=n,this._org=t,this._route=i,this._router=a,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(l=>`${l.id}`),this.levels=this._org.active_levels,this.ui_options=this._state.options,this.setDate=l=>this._state.setDate(l),this.newBooking=l=>this._state.newBooking(l),this.updateZones=l=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:l.join(",")}}),this._state.setZones(l)},this.updateTypes=l=>this._state.setFilters({hide_type:this.types.reduce((y,U)=>(l.includes(U.id)||y.push(U),y),[])})}updateUIOptions(n){this._state.setUIOptions(n)}ngOnInit(){var n=this;return(0,Y.Z)(function*(){yield n._org.initialised.pipe((0,F.P)(t=>t)).toPromise(),n.subscription("route.query",n._route.queryParamMap.subscribe(t=>{if(t.has("zone_ids")){const i=t.get("zone_ids").split(",");if(i.length){n.zones=i;const a=n._org.levelWithID(i);if(!a)return;n._org.building=n._org.buildings.find(l=>l.id===a.parent_id)}}})),n.subscription("levels",n._org.active_levels.subscribe(t=>{n.zones=n.zones.filter(i=>t.find(a=>a.id===i)),!n.zones.length&&t.length&&n.zones.push(t[0].id),n.updateZones(n.zones)})),n.updateTypes(n.type_list)})()}}p.\u0275fac=function(n){return new(n||p)(e.Y36(f.Y),e.Y36(b.w7),e.Y36(h.gz),e.Y36(h.F0))},p.\u0275cmp=e.Xpm({type:p,selectors:[["dayview-topbar"]],features:[e.qOj],decls:25,vars:14,consts:[[1,"flex","items-center","px-4","h-20","bg-white","dark:bg-neutral-700","border-b","border-gray-200","dark:border-neutral-500"],["btn","","matRipple","","new","",1,"w-12","xl:w-auto","overflow-hidden",3,"click"],[1,"flex","items-center"],[1,"mr-2",3,"icon"],[1,"hidden","xl:block"],["appearance","outline"],["multiple","","placeholder","All Levels",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["multiple","","placeholder","No Events",3,"ngModel","ngModelChange"],[1,"m-2",3,"ngModel","ngModelChange"],[1,"text-xs"],[1,"flex-1","w-0"],[3,"dateChange"],[3,"value"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"button",1),e.NdJ("click",function(){return t.newBooking()}),e.TgZ(2,"div",2),e._UZ(3,"app-icon",3),e.TgZ(4,"div",4),e._uU(5,"New Booking"),e.qZA()()(),e.TgZ(6,"mat-form-field",5)(7,"mat-select",6),e.NdJ("ngModelChange",function(a){return t.zones=a})("ngModelChange",function(a){return t.updateZones(a)}),e.YNc(8,z,2,2,"mat-option",7),e.ALo(9,"async"),e.qZA()(),e.TgZ(10,"mat-form-field",5)(11,"mat-select",8),e.NdJ("ngModelChange",function(a){return t.type_list=a})("ngModelChange",function(a){return t.updateTypes(a)}),e.TgZ(12,"mat-select-trigger"),e._uU(13,"Legend"),e.qZA(),e.YNc(14,L,2,2,"mat-option",7),e.qZA()(),e.TgZ(15,"mat-slide-toggle",9),e.NdJ("ngModelChange",function(a){return t.updateUIOptions({show_overflow:a})}),e.ALo(16,"async"),e.TgZ(17,"div",10),e._uU(18,"Setup / Breakdown"),e.qZA()(),e.TgZ(19,"mat-slide-toggle",9),e.NdJ("ngModelChange",function(a){return t.updateUIOptions({show_cleaning:a})}),e.ALo(20,"async"),e.TgZ(21,"div",10),e._uU(22,"Cleaners View"),e.qZA()(),e._UZ(23,"div",11),e.TgZ(24,"date-options",12),e.NdJ("dateChange",function(a){return t.setDate(a)}),e.qZA()()),2&n){let i,a;e.xp6(3),e.Q6J("icon",e.DdM(13,P)),e.xp6(4),e.Q6J("ngModel",t.zones),e.xp6(1),e.Q6J("ngForOf",e.lcZ(9,7,t.levels)),e.xp6(3),e.Q6J("ngModel",t.type_list),e.xp6(3),e.Q6J("ngForOf",t.types),e.xp6(1),e.Q6J("ngModel",null==(i=e.lcZ(16,9,t.ui_options))?null:i.show_overflow),e.xp6(4),e.Q6J("ngModel",null==(a=e.lcZ(20,11,t.ui_options))?null:a.show_cleaning)}},dependencies:[r.sg,w.JJ,w.On,I.E,N.KE,C.gD,C.$L,x.ey,Q.Rr,x.wG,D.o,r.Ov],styles:["button[_ngcontent-%COMP%]{min-width:0;padding:0 .85rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em;margin-left:1em}mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:5.5em;white-space:initial;line-height:1.2em}\n/*# sourceMappingURL=dayview-topbar.component.ts-angular-inline--46.css.map*/"]});var E=s(532),k=s(4139),j=s(7716),R=s(9151),S=s(9095),B=s(7418),T=s(6942),$=s(9128),O=s(2886),G=s(914),K=s(1294),M=s(3861),V=s(2317),X=s(9377),W=s(1361);function q(o,n){if(1&o&&e._UZ(0,"div"),2&o){const t=e.oxw();e.Tol("overflow-block absolute rounded overflow-hidden w-full "+t.type),e.Udp("top",100*t.overflow_top+"%")("height",100*t.overflow_height+"%")}}function H(o,n){if(1&o&&(e.TgZ(0,"div",6)(1,"app-icon",7),e._uU(2,"title"),e.qZA(),e._uU(3),e.qZA()),2&o){const t=e.oxw(2);e.xp6(3),e.hij(" ",t.event.title," ")}}function ee(o,n){if(1&o&&(e.TgZ(0,"div",6)(1,"app-icon",7),e._uU(2,"schedule"),e.qZA(),e._uU(3),e.qZA()),2&o){const t=e.oxw(2);e.xp6(3),e.hij(" ",t.time," ")}}function te(o,n){if(1&o&&(e.TgZ(0,"div",6)(1,"app-icon",7),e._uU(2,"people"),e.qZA(),e._uU(3),e.qZA()),2&o){const t=e.oxw(2);e.xp6(3),e.AsE(" ",t.event.attendees.length," Attendee",1===t.event.attendees.length?"":"s"," ")}}function ne(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.view(a.event))}),e.TgZ(1,"div",4),e._uU(2),e.qZA(),e.YNc(3,H,4,1,"div",5),e.YNc(4,ee,4,1,"div",5),e.YNc(5,te,4,2,"div",5),e.qZA()}if(2&o){const t=e.oxw();e.Tol("absolute rounded overflow-hidden text-sm border border-gray-200 shadow-sm z-10 hover:z-30 "+t.type),e.Udp("top",100*t.top+"%")("height",100*t.height+"%"),e.xp6(2),e.Oqu(null==t.event.organiser?null:t.event.organiser.name),e.xp6(1),e.Q6J("ngIf",t.event.duration>30),e.xp6(1),e.Q6J("ngIf",t.event.duration>60),e.xp6(1),e.Q6J("ngIf",t.event.duration>90)}}function oe(o,n){if(1&o&&(e.TgZ(0,"div",8)(1,"div")(2,"app-icon"),e._uU(3),e.qZA()(),e.TgZ(4,"div",9),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&o){const t=e.oxw();e.Udp("top",100*t.top+"%")("height",100*t.height+"%"),e.xp6(1),e.Tol("icon flex items-center justify-center mr-2 text-3xl rounded h-12 w-12 text-pending "+t.event.ext("cleaning_status")),e.xp6(2),e.Oqu("done"===t.event.ext("cleaning_status")?"done":"warning"),e.xp6(2),e.AsE(" ","done"===t.event.ext("cleaning_status")?"Finished":"Scheduled to"," clean at ",e.xi3(6,9,t.event.ext("cleaning_time")||1e3*t.event.event_end,"shortTime")," ")}}s(9830);const _=1440;class d{constructor(n){this._state=n,this.top=-999,this.height=0,this.overflow_top=-999,this.overflow_height=0,this.ui_options=this._state.options,this.view=t=>this._state.setEvent(t)}get time(){const n=new Date(this.event.date);return(0,M.Z)(n,"h:mm a")+" - "+(0,M.Z)((0,V.Z)(n,this.event.duration),"h:mm a")}get type(){return this.event.guests.length?"external":"declined"===this.event.status?"cancelled":"internal"}ngOnChanges(n){if(n.event&&this.event){const t=(0,X.Z)(new Date(this.event.date)),i=(0,W.Z)(new Date(this.event.date),t);this.top=i/_,this.height=this.event.duration/_,this.overflow_top=(i-this.event.ext("setup"))/_,this.overflow_height=(this.event.duration+this.event.ext("setup")+this.event.ext("breakdown"))/_}}}function ie(o,n){1&o&&e._UZ(0,"dayview-event",2),2&o&&e.Q6J("event",n.$implicit)}function ae(o,n){if(1&o&&(e.ynx(0),e.YNc(1,ie,1,1,"dayview-event",1),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.events))}}d.\u0275fac=function(n){return new(n||d)(e.Y36(f.Y))},d.\u0275cmp=e.Xpm({type:d,selectors:[["dayview-event"]],inputs:{event:"event"},features:[e.TTD],decls:5,vars:7,consts:[[3,"class","top","height",4,"ngIf"],["event","","matRipple","",3,"class","top","height","click",4,"ngIf"],["cleaning","","class","absolute rounded overflow-hidden flex w-full shadow p-2 bg-white z-20",3,"top","height",4,"ngIf"],["event","","matRipple","",3,"click"],[1,"px-2","py-1","font-medium"],["class","py-1 flex items-center",4,"ngIf"],[1,"py-1","flex","items-center"],[1,"mx-2"],["cleaning","",1,"absolute","rounded","overflow-hidden","flex","w-full","shadow","p-2","bg-white","z-20"],[1,"flex-1","w-1/2"]],template:function(n,t){if(1&n&&(e.YNc(0,q,1,6,"div",0),e.ALo(1,"async"),e.YNc(2,ne,6,10,"div",1),e.YNc(3,oe,7,12,"div",2),e.ALo(4,"async")),2&n){let i,a;e.Q6J("ngIf",null==(i=e.lcZ(1,3,t.ui_options))?null:i.show_overflow),e.xp6(2),e.Q6J("ngIf",t.event),e.xp6(1),e.Q6J("ngIf",t.event&&(null==(a=e.lcZ(4,5,t.ui_options))?null:a.show_cleaning))}},dependencies:[r.O5,x.wG,D.o,r.Ov,r.uU],styles:["[event][_ngcontent-%COMP%]{background-color:#ccc;width:12rem;z-index:100;transition:box-shadow .2s}[event][_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 1px #0003,0 1px 1px #00000024,0 2px 1px -1px #0000001f!important;cursor:pointer}.overflow-block[_ngcontent-%COMP%]{opacity:.3;width:12rem}.internal[_ngcontent-%COMP%]{background-color:#1565c0;color:#fff}.icon[_ngcontent-%COMP%]{background-color:#f0f0f0}.icon.done[_ngcontent-%COMP%]{color:#21a453}.external[_ngcontent-%COMP%]{background-color:#ad1457;color:#fff}.cancelled[_ngcontent-%COMP%]{background-color:#ccc}\n/*# sourceMappingURL=dayview-event.component.ts-angular-inline--49.css.map*/"]});class v extends u.KG{constructor(n){super(),this._state=n,this.events=this._state.filtered.pipe((0,T.U)(t=>t.filter(i=>i.resources.find(a=>this.space.email===a.email))))}ngOnInit(){this.subscription("events",this._state.filtered.subscribe())}}function se(o,n){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16),e._uU(2),e.qZA(),e._UZ(3,"div",17),e.qZA()),2&o){const t=n.$implicit,i=e.oxw();e.Udp("transform","translateY(-"+i.scroll.y+"px)"),e.xp6(2),e.hij(" ",t," ")}}function le(o,n){if(1&o&&(e.TgZ(0,"div",18),e._UZ(1,"div",19),e.TgZ(2,"div",20),e._uU(3),e.qZA()()),2&o){const t=n.$implicit,i=e.oxw();e.Udp("transform","translateX(-"+i.scroll.x+"px)"),e.xp6(3),e.hij(" ",t.display_name||t.name," ")}}function re(o,n){1&o&&e._UZ(0,"dayview-space",21),2&o&&e.Q6J("space",n.$implicit)}function ce(o,n){if(1&o&&(e._UZ(0,"div",22),e.ALo(1,"async")),2&o){const t=n.index,i=e.oxw();let a;e.Udp("width",12*(null==(a=e.lcZ(1,4,i.space_list))?null:a.length)+"rem")("top",4*t+"rem")}}function pe(o,n){1&o&&e._UZ(0,"mat-progress-bar",23)}function de(o,n){if(1&o&&(e._UZ(0,"view-event-details",24),e.ALo(1,"async")),2&o){const t=e.oxw();e.Q6J("event",e.lcZ(1,1,t.event))}}v.\u0275fac=function(n){return new(n||v)(e.Y36(f.Y))},v.\u0275cmp=e.Xpm({type:v,selectors:[["dayview-space"]],inputs:{space:"space"},features:[e.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[3,"event",4,"ngFor","ngForOf"],[3,"event"]],template:function(n,t){1&n&&e.YNc(0,ae,3,3,"ng-container",0),2&n&&e.Q6J("ngIf",t.space)},dependencies:[r.sg,r.O5,d,r.Ov],styles:["[_nghost-%COMP%]{position:relative}\n/*# sourceMappingURL=dayview-space.component.ts-angular-inline--48.css.map*/"]});const ve=new Array(24).fill(0).map((o,n)=>(n%12==0?12:n%12)+(n>=12?" PM":" AM"));class g extends u.KG{constructor(n,t){super(),this._org=n,this._state=t,this.blocks=ve,this.scroll={x:0,y:0},this.loading=this._state.loading,this.event=this._state.event,this.spaces=this._org.active_building.pipe((0,R.h)(i=>!!i),(0,S.w)(({id:i})=>(0,E.vIL)({zone_id:i,limit:1e3}).pipe((0,B.K)(()=>(0,k.of)({data:[]})))),(0,T.U)(({data:i})=>i.map(a=>new O.T({...a,level:this._org.levelWithID(a.zones)}))),(0,$.d)(1)),this.space_list=(0,j.aj)([this.spaces,this._state.zones]).pipe((0,T.U)(([i,a])=>i.filter(l=>!a?.length||l.zones.find(y=>a.includes(y)))||[]))}ngOnInit(){this._state.startPolling()}ngOnDestroy(){this._state.stopPolling()}onScroll(n){requestAnimationFrame(()=>this.scroll={x:n.srcElement.scrollLeft,y:n.srcElement.scrollTop})}}g.\u0275fac=function(n){return new(n||g)(e.Y36(b.w7),e.Y36(f.Y))},g.\u0275cmp=e.Xpm({type:g,selectors:[["dayview-timeline"]],features:[e.qOj],decls:19,vars:14,consts:[[1,"absolute","inset-0","flex"],[1,"time","h-full","w-24","overflow-hidden","bg-blue-100/20","dark:bg-neutral-700","relative"],["header","",1,"relative","h-16","z-50"],[1,"bg-blue-100/20","dark:bg-neutral-700","absolute","top-0","left-0","right-0","bottom-8"],["change-transform","","class","relative h-16 border-r border-gray-300 dark:border-neutral-500 z-10",3,"transform",4,"ngFor","ngForOf"],[1,"absolute","h-8","w-px","top-8","right-0","bg-gray-300","dark:bg-neutral-500"],[1,"h-full","flex-1","flex","flex-col","w-1/2"],["header","",1,"flex","relative","overflow-hidden","border-b","border-gray-300","dark:border-neutral-500","border-opacity-50","bg-blue-100/20","dark:bg-neutral-700","h-16","w-full"],["change-transform","","class","relative h-16 w-48 min-w-[12rem]",3,"transform",4,"ngFor","ngForOf"],["content","",1,"relative","flex","flex-1","overflow-auto",3,"scroll"],["scroll_el",""],["class","w-48 min-w-[12rem] h-[96rem] border-r border-gray-300 dark:border-neutral-500",3,"space",4,"ngFor","ngForOf"],["class","absolute bg-gray-300 dark:bg-neutral-500 h-px min-w-full left-0",3,"width","top",4,"ngFor","ngForOf"],["mode","indeterminate","class","absolute bottom-0 left-0 right-0",4,"ngIf"],[3,"event",4,"ngIf"],["change-transform","",1,"relative","h-16","border-r","border-gray-300","dark:border-neutral-500","z-10"],[1,"absolute","text-center","w-full","text-xs","top-0","transform","-translate-y-1/2","opacity-40"],[1,"absolute","h-px","w-2","top-0","right-0","bg-gray-300","dark:bg-neutral-500"],["change-transform","",1,"relative","h-16","w-48","min-w-[12rem]"],["bar","",1,"absolute","h-8","w-px","bottom-0","-left-px","bg-gray-300","dark:bg-neutral-500"],[1,"name","m-2","text-center"],[1,"w-48","min-w-[12rem]","h-[96rem]","border-r","border-gray-300","dark:border-neutral-500",3,"space"],[1,"absolute","bg-gray-300","dark:bg-neutral-500","h-px","min-w-full","left-0"],["mode","indeterminate",1,"absolute","bottom-0","left-0","right-0"],[3,"event"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"div",3),e.qZA(),e.YNc(4,se,4,3,"div",4),e._UZ(5,"div",5),e.qZA(),e.TgZ(6,"div",6)(7,"div",7),e.YNc(8,le,4,3,"div",8),e.ALo(9,"async"),e.qZA(),e.TgZ(10,"div",9,10),e.NdJ("scroll",function(a){return t.onScroll(a)}),e.YNc(12,re,1,1,"dayview-space",11),e.ALo(13,"async"),e.YNc(14,ce,2,6,"div",12),e.qZA()(),e.YNc(15,pe,1,0,"mat-progress-bar",13),e.ALo(16,"async"),e.YNc(17,de,2,3,"view-event-details",14),e.ALo(18,"async"),e.qZA()),2&n&&(e.xp6(4),e.Q6J("ngForOf",t.blocks),e.xp6(4),e.Q6J("ngForOf",e.lcZ(9,6,t.space_list)),e.xp6(4),e.Q6J("ngForOf",e.lcZ(13,8,t.space_list)),e.xp6(2),e.Q6J("ngForOf",t.blocks),e.xp6(1),e.Q6J("ngIf",e.lcZ(16,10,t.loading)),e.xp6(2),e.Q6J("ngIf",e.lcZ(18,12,t.event)))},dependencies:[r.sg,r.O5,G.E,K.pW,v,r.Ov],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}[change-transform][_ngcontent-%COMP%]{will-change:transform}\n/*# sourceMappingURL=dayview-timeline.component.ts-angular-inline--47.css.map*/"]});class m{constructor(n,t){this._settings=n,this._router=t}get links(){return this._settings.get("app.general.menu")||[]}ngOnInit(){this.links.find(n=>n.route.includes("day-view"))||this._router.navigate([`/${this.links[0].route}`])}}m.\u0275fac=function(n){return new(n||m)(e.Y36(u.gb),e.Y36(h.F0))},m.\u0275cmp=e.Xpm({type:m,selectors:[["","app-dayview",""]],attrs:["app-dayview",""],decls:4,vars:0,consts:[[1,"h-full"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full","bg-gray-200","dark:bg-neutral-600"]],template:function(n,t){1&n&&(e._UZ(0,"sidebar",0),e.TgZ(1,"main",1),e._UZ(2,"dayview-topbar")(3,"dayview-timeline"),e.qZA())},dependencies:[J.k,p,g],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%}\n/*# sourceMappingURL=day-view.component.ts-angular-inline--45.css.map*/"]});var me=s(711);const he=[{path:"",component:m}];class c{}c.\u0275fac=function(n){return new(n||c)},c.\u0275mod=e.oAB({type:c}),c.\u0275inj=e.cJS({imports:[r.ez,w.u5,A.v,O.YR,me.PP,h.Bz.forChild(he)]})}}]);
//# sourceMappingURL=apps_concierge_src_app_day-view_day-view_module_ts.js.map