(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([["apps_workplace_src_app_book_book_module_ts"],{6134:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BookModule:()=>ri});var i=n(1511),o=n(6073),s=n(9861),a=n(4230),r=n(2619),l=n(1522),c=n(4621);
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
const u=["button"],d=["*"],g=new r.OlP("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS"),p=new r.OlP("MatButtonToggleGroup"),m={provide:o.JU,useExisting:(0,r.Gpc)(()=>Z),multi:!0};let f=0;class h{constructor(e,t){this.source=e,this.value=t}}let Z=(()=>{class e{constructor(e,t){this._changeDetector=e,this._vertical=!1,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name="mat-button-toggle-group-"+f++,this.valueChange=new r.vpe,this.change=new r.vpe,this.appearance=t&&t.appearance?t.appearance:"standard"}get name(){return this._name}set name(e){this._name=e,this._buttonToggles&&this._buttonToggles.forEach(e=>{e.name=this._name,e._markForCheck()})}get vertical(){return this._vertical}set vertical(e){this._vertical=(0,s.Ig)(e)}get value(){const e=this._selectionModel?this._selectionModel.selected:[];return this.multiple?e.map(e=>e.value):e[0]?e[0].value:void 0}set value(e){this._setSelectionByValue(e),this.valueChange.emit(this.value)}get selected(){const e=this._selectionModel?this._selectionModel.selected:[];return this.multiple?e:e[0]||null}get multiple(){return this._multiple}set multiple(e){this._multiple=(0,s.Ig)(e)}get disabled(){return this._disabled}set disabled(e){this._disabled=(0,s.Ig)(e),this._buttonToggles&&this._buttonToggles.forEach(e=>e._markForCheck())}ngOnInit(){this._selectionModel=new a.Ov(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(e=>e.checked))}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_emitChangeEvent(){const e=this.selected,t=Array.isArray(e)?e[e.length-1]:e,n=new h(t,this.value);this._controlValueAccessorChangeFn(n.value),this.change.emit(n)}_syncButtonToggle(e,t,n=!1,i=!1){this.multiple||!this.selected||e.checked||(this.selected.checked=!1),this._selectionModel?t?this._selectionModel.select(e):this._selectionModel.deselect(e):i=!0,i?Promise.resolve().then(()=>this._updateModelValue(n)):this._updateModelValue(n)}_isSelected(e){return this._selectionModel&&this._selectionModel.isSelected(e)}_isPrechecked(e){return void 0!==this._rawValue&&(this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(t=>null!=e.value&&t===e.value):e.value===this._rawValue)}_setSelectionByValue(e){this._rawValue=e,this._buttonToggles&&(this.multiple&&e?(Array.isArray(e),this._clearSelection(),e.forEach(e=>this._selectValue(e))):(this._clearSelection(),this._selectValue(e)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(e=>e.checked=!1)}_selectValue(e){const t=this._buttonToggles.find(t=>null!=t.value&&t.value===e);t&&(t.checked=!0,this._selectionModel.select(t))}_updateModelValue(e){e&&this._emitChangeEvent(),this.valueChange.emit(this.value)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(g,8))},e.\u0275dir=r.lG2({type:e,selectors:[["mat-button-toggle-group"]],contentQueries:function(e,t,n){if(1&e&&r.Suo(n,x,5),2&e){let e;r.iGM(e=r.CRH())&&(t._buttonToggles=e)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(e,t){2&e&&(r.uIk("aria-disabled",t.disabled),r.ekj("mat-button-toggle-vertical",t.vertical)("mat-button-toggle-group-appearance-standard","standard"===t.appearance))},inputs:{appearance:"appearance",name:"name",vertical:"vertical",value:"value",multiple:"multiple",disabled:"disabled"},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[r._Bn([m,{provide:p,useExisting:e}])]}),e})();class _{}const v=(0,l.Kr)(_);let x=(()=>{class e extends v{constructor(e,t,n,i,o,s){super(),this._changeDetectorRef=t,this._elementRef=n,this._focusMonitor=i,this._isSingleSelector=!1,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new r.vpe;const a=Number(o);this.tabIndex=a||0===a?a:null,this.buttonToggleGroup=e,this.appearance=s&&s.appearance?s.appearance:"standard"}get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(e){this._appearance=e}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(e){const t=(0,s.Ig)(e);t!==this._checked&&(this._checked=t,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(e){this._disabled=(0,s.Ig)(e)}ngOnInit(){const e=this.buttonToggleGroup;this._isSingleSelector=e&&!e.multiple,this.id=this.id||"mat-button-toggle-"+f++,this._isSingleSelector&&(this.name=e.name),e&&(e._isPrechecked(this)?this.checked=!0:e._isSelected(this)!==this._checked&&e._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const e=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),e&&e._isSelected(this)&&e._syncButtonToggle(this,!1,!1,!0)}focus(e){this._buttonElement.nativeElement.focus(e)}_onButtonClick(){const e=!!this._isSingleSelector||!this._checked;e!==this._checked&&(this._checked=e,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new h(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(p,8),r.Y36(r.sBO),r.Y36(r.SBq),r.Y36(c.tE),r.$8M("tabindex"),r.Y36(g,8))},e.\u0275cmp=r.Xpm({type:e,selectors:[["mat-button-toggle"]],viewQuery:function(e,t){if(1&e&&r.Gf(u,5),2&e){let e;r.iGM(e=r.CRH())&&(t._buttonElement=e.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(e,t){1&e&&r.NdJ("focus",function(){return t.focus()}),2&e&&(r.uIk("aria-label",null)("aria-labelledby",null)("id",t.id)("name",null),r.ekj("mat-button-toggle-standalone",!t.buttonToggleGroup)("mat-button-toggle-checked",t.checked)("mat-button-toggle-disabled",t.disabled)("mat-button-toggle-appearance-standard","standard"===t.appearance))},inputs:{disableRipple:"disableRipple",ariaLabelledby:["aria-labelledby","ariaLabelledby"],tabIndex:"tabIndex",appearance:"appearance",checked:"checked",disabled:"disabled",id:"id",name:"name",ariaLabel:["aria-label","ariaLabel"],value:"value"},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[r.qOj],ngContentSelectors:d,decls:6,vars:9,consts:[["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"id","disabled","click"],["button",""],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(e,t){if(1&e&&(r.F$t(),r.TgZ(0,"button",0,1),r.NdJ("click",function(){return t._onButtonClick()}),r.TgZ(2,"span",2),r.Hsn(3),r.qZA(),r.qZA(),r._UZ(4,"span",3),r._UZ(5,"span",4)),2&e){const e=r.MAs(1);r.Q6J("id",t.buttonId)("disabled",t.disabled||null),r.uIk("tabindex",t.disabled?-1:t.tabIndex)("aria-pressed",t.checked)("name",t.name||null)("aria-label",t.ariaLabel)("aria-labelledby",t.ariaLabelledby),r.xp6(5),r.Q6J("matRippleTrigger",e)("matRippleDisabled",t.disableRipple||t.disabled)}},directives:[l.wG],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:transparent}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.cdk-high-contrast-active .mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:.5}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}.cdk-high-contrast-active .mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.5}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{border-radius:inherit;pointer-events:none;opacity:0;top:0;left:0;right:0;bottom:0;position:absolute}.mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 36px}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}\n"],encapsulation:2,changeDetection:0}),e})(),b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[l.BQ,l.si],l.BQ]}),e})();
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
var w=n(6898),A=n(4892),T=n(2142);let y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["placeos-book"]],decls:5,vars:0,consts:[[1,"flex-1","flex","sm:flex-row","flex-col-reverse","h-1/2"],[1,"relative","z-10"],[1,"relative","flex","flex-col","flex-1","h-1/2","sm:h-auto","overflow-hidden"]],template:function(e,t){1&e&&(r._UZ(0,"topbar"),r.TgZ(1,"div",0),r._UZ(2,"nav-menu",1),r.TgZ(3,"main",2),r._UZ(4,"router-outlet"),r.qZA(),r.qZA())},directives:[A.o,T.D,w.lC],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}"]}),e})();class q{static hasCamera(){return navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(e=>e.some(e=>"videoinput"===e.kind)).catch(()=>!1):Promise.resolve(!1)}constructor(e,t,n=this._onDecodeError.bind(this),i=q.DEFAULT_CANVAS_SIZE,o="environment"){this.$video=e,this.$canvas=document.createElement("canvas"),this._onDecode=t,this._preferredFacingMode=o,this._active=!1,this._paused=!1,this._flashOn=!1,"number"==typeof n?(i=n,console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future")):this._onDecodeError=n,this.$canvas.width=i,this.$canvas.height=i,this._sourceRect={x:0,y:0,width:i,height:i},this._updateSourceRect=this._updateSourceRect.bind(this),this._onPlay=this._onPlay.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this.$video.playsInline=!0,this.$video.muted=!0,this.$video.disablePictureInPicture=!0,this.$video.addEventListener("loadedmetadata",this._updateSourceRect),this.$video.addEventListener("play",this._onPlay),document.addEventListener("visibilitychange",this._onVisibilityChange),this._qrEnginePromise=q.createQrEngine()}hasFlash(){if(!("ImageCapture"in window))return Promise.resolve(!1);const e=this.$video.srcObject?this.$video.srcObject.getVideoTracks()[0]:null;return e?new ImageCapture(e).getPhotoCapabilities().then(e=>e.fillLightMode.includes("flash")).catch(e=>(console.warn(e),!1)):Promise.reject("Camera not started or not available")}isFlashOn(){return this._flashOn}toggleFlash(){return this._setFlash(!this._flashOn)}turnFlashOff(){return this._setFlash(!1)}turnFlashOn(){return this._setFlash(!0)}destroy(){this.$video.removeEventListener("loadedmetadata",this._updateSourceRect),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),this.stop(),q._postWorkerMessage(this._qrEnginePromise,"close")}start(){if(this._active&&!this._paused)return Promise.resolve();if("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,this._paused=!1,document.hidden)return Promise.resolve();if(clearTimeout(this._offTimeout),this._offTimeout=null,this.$video.srcObject)return this.$video.play(),Promise.resolve();let e=this._preferredFacingMode;return this._getCameraStream(e,!0).catch(()=>(e="environment"===e?"user":"environment",this._getCameraStream())).then(t=>{e=this._getFacingMode(t)||e,this.$video.srcObject=t,this.$video.play(),this._setVideoMirror(e)}).catch(e=>{throw this._active=!1,e})}stop(){this.pause(),this._active=!1}pause(){this._paused=!0,this._active&&(this.$video.pause(),this._offTimeout||(this._offTimeout=setTimeout(()=>{const e=this.$video.srcObject?this.$video.srcObject.getTracks():[];for(const t of e)t.stop();this.$video.srcObject=null,this._offTimeout=null},300)))}static scanImage(e,t=null,n=null,i=null,o=!1,s=!1){const a=n instanceof Worker;let r=Promise.all([n||q.createQrEngine(),q._loadImage(e)]).then(([e,s])=>{let r;return n=e,[i,r]=this._drawToCanvas(s,t,i,o),n instanceof Worker?(a||n.postMessage({type:"inversionMode",data:"both"}),new Promise((e,t)=>{let o,s,a;s=i=>{"qrResult"===i.data.type&&(n.removeEventListener("message",s),n.removeEventListener("error",a),clearTimeout(o),null!==i.data.data?e(i.data.data):t(q.NO_QR_CODE_FOUND))},a=e=>{n.removeEventListener("message",s),n.removeEventListener("error",a),clearTimeout(o),t("Scanner error: "+(e?e.message||e:"Unknown Error"))},n.addEventListener("message",s),n.addEventListener("error",a),o=setTimeout(()=>a("timeout"),1e4);const l=r.getImageData(0,0,i.width,i.height);n.postMessage({type:"decode",data:l},[l.data.buffer])})):new Promise((e,t)=>{const o=setTimeout(()=>t("Scanner error: timeout"),1e4);n.detect(i).then(n=>{n.length?e(n[0].rawValue):t(q.NO_QR_CODE_FOUND)}).catch(e=>t("Scanner error: "+(e.message||e))).finally(()=>clearTimeout(o))})});return t&&s&&(r=r.catch(()=>q.scanImage(e,null,n,i,o))),r=r.finally(()=>{a||q._postWorkerMessage(n,"close")}),r}setGrayscaleWeights(e,t,n,i=!0){q._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:e,green:t,blue:n,useIntegerApproximation:i})}setInversionMode(e){q._postWorkerMessage(this._qrEnginePromise,"inversionMode",e)}static createQrEngine(e=q.WORKER_PATH){return("BarcodeDetector"in window?BarcodeDetector.getSupportedFormats():Promise.resolve([])).then(t=>-1!==t.indexOf("qr_code")?new BarcodeDetector({formats:["qr_code"]}):new Worker(e))}_onPlay(){this._updateSourceRect(),this._scanFrame()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_updateSourceRect(){const e=Math.min(this.$video.videoWidth,this.$video.videoHeight),t=Math.round(2/3*e);this._sourceRect.width=this._sourceRect.height=t,this._sourceRect.x=(this.$video.videoWidth-t)/2,this._sourceRect.y=(this.$video.videoHeight-t)/2}_scanFrame(){if(!this._active||this.$video.paused||this.$video.ended)return!1;requestAnimationFrame(()=>{this.$video.readyState<=1?this._scanFrame():this._qrEnginePromise.then(e=>q.scanImage(this.$video,this._sourceRect,e,this.$canvas,!0)).then(this._onDecode,e=>{this._active&&(-1!==(e.message||e).indexOf("service unavailable")&&(this._qrEnginePromise=q.createQrEngine()),this._onDecodeError(e))}).then(()=>this._scanFrame())})}_onDecodeError(e){e!==q.NO_QR_CODE_FOUND&&console.log(e)}_getCameraStream(e,t=!1){const n=[{width:{min:1024}},{width:{min:768}},{}];return e&&(t&&(e={exact:e}),n.forEach(t=>t.facingMode=e)),this._getMatchingCameraStream(n)}_getMatchingCameraStream(e){return navigator.mediaDevices&&0!==e.length?navigator.mediaDevices.getUserMedia({video:e.shift()}).catch(()=>this._getMatchingCameraStream(e)):Promise.reject("Camera not found.")}_setFlash(e){return this.hasFlash().then(t=>t?this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:e}]}):Promise.reject("No flash available")).then(()=>this._flashOn=e)}_setVideoMirror(e){this.$video.style.transform="scaleX("+("user"===e?-1:1)+")"}_getFacingMode(e){const t=e.getVideoTracks()[0];return t?/rear|back|environment/i.test(t.label)?"environment":/front|user|face/i.test(t.label)?"user":null:null}static _drawToCanvas(e,t=null,n=null,i=!1){n=n||document.createElement("canvas");const o=t&&t.x?t.x:0,s=t&&t.y?t.y:0,a=t&&t.width?t.width:e.width||e.videoWidth,r=t&&t.height?t.height:e.height||e.videoHeight;i||n.width===a&&n.height===r||(n.width=a,n.height=r);const l=n.getContext("2d",{alpha:!1});return l.imageSmoothingEnabled=!1,l.drawImage(e,o,s,a,r,0,0,n.width,n.height),[n,l]}static _loadImage(e){if(e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||window.ImageBitmap&&e instanceof window.ImageBitmap||window.OffscreenCanvas&&e instanceof window.OffscreenCanvas)return Promise.resolve(e);if(e instanceof Image)return q._awaitImageLoad(e).then(()=>e);if(e instanceof File||e instanceof Blob||e instanceof URL||"string"==typeof e){const t=new Image;return t.src=e instanceof File||e instanceof Blob?URL.createObjectURL(e):e,q._awaitImageLoad(t).then(()=>((e instanceof File||e instanceof Blob)&&URL.revokeObjectURL(t.src),t))}return Promise.reject("Unsupported image type.")}static _awaitImageLoad(e){return new Promise((t,n)=>{if(e.complete&&0!==e.naturalWidth)t();else{let i,o;i=()=>{e.removeEventListener("load",i),e.removeEventListener("error",o),t()},o=()=>{e.removeEventListener("load",i),e.removeEventListener("error",o),n("Image load error")},e.addEventListener("load",i),e.addEventListener("error",o)}})}static _postWorkerMessage(e,t,n){return Promise.resolve(e).then(e=>{e instanceof Worker&&e.postMessage({type:t,data:n})})}}q.DEFAULT_CANVAS_SIZE=400,q.NO_QR_CODE_FOUND="No QR code found",q.WORKER_PATH="qr-scanner-worker.min.js";var k=n(6756),M=n(5980);const O=["video"];function C(e,t){1&e&&(r.TgZ(0,"div",11),r.TgZ(1,"h2",12),r._uU(2," Scan QR Code "),r.qZA(),r.TgZ(3,"span",13),r._uU(4," Scan the QR code outisde a PlaceOS room or space. "),r.qZA(),r.qZA())}function U(e,t){1&e&&(r.TgZ(0,"div",11),r.TgZ(1,"h2",12),r._uU(2," Enter Room ID "),r.qZA(),r.TgZ(3,"span",13),r._uU(4," Enter the room ID number outisde a PlaceOS room or space. "),r.qZA(),r.qZA())}let J=(()=>{class e{constructor(e){this._router=e,this.is_scanning=!0,this.menu=new r.vpe(!1)}ngOnDestroy(){var e;this._video_el.nativeElement.srcObject&&this._video_el.nativeElement.srcObject.getTracks().forEach(e=>null==e?void 0:e.stop()),null===(e=this._qr_scanner)||void 0===e||e.stop()}ngOnInit(){var e;(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia)&&(navigator.mediaDevices.getUserMedia({video:!0}).then(e=>this._video_el.nativeElement.srcObject=e).catch(e=>console.error("Unable to fetch media devices!",e)),this._qr_scanner=new q(this._video_el.nativeElement,e=>this.handleQrCode(e)),this._qr_scanner.start())}handleQrCode(e){const t=e;if(t.indexOf("/#/")>0){const e=/[?&]([^=#]+)=([^&#]*)/g,n={};let i;for(;i=e.exec(t);)n[i[1]]=i[2];this._router.navigate([t.split("/#")[1].split("?")[0]],n)}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(w.F0))},e.\u0275cmp=r.Xpm({type:e,selectors:[["book-code-flow"]],viewQuery:function(e,t){if(1&e&&r.Gf(O,7),2&e){let e;r.iGM(e=r.CRH())&&(t._video_el=e.first)}},outputs:{menu:"menu"},decls:16,vars:9,consts:[[1,"flex-1","overflow-hidden","flex","items-center","justify-center","bg-black","relative"],["id","video",1,"min-w-full","min-h-full","object-cover"],["video",""],[1,"absolute","text-white","text-center","inset-0","flex","flex-col","items-center","justify-center"],["class","flex flex-col z-10 justify-end items-center relative",4,"ngIf"],[1,"flex","items-center","justify-center"],["box","",1,"rounded-2xl","h-64","w-64","transition-all","flex","items-center","justify-center","p-8","m-8","space-x-2"],[1,"uppercase"],["matInput","","name","booking-id","placeholder","e.g. 12102910",1,"border-none","bg-none","w-full","text-3xl","text-left",3,"ngModel","ngModelChange"],[1,"m-4","p-2","flex","items-center","space-x-2","bg-white","bg-opacity-50","rounded"],["mat-button","",3,"click"],[1,"flex","flex-col","z-10","justify-end","items-center","relative"],[1,"text-3xl","mb-1","uppercase","subpixel-antialiased"],[1,"mb-4"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r._UZ(1,"video",1,2),r.TgZ(3,"div",3),r.YNc(4,C,5,0,"div",4),r.YNc(5,U,5,0,"div",4),r.TgZ(6,"div",5),r.TgZ(7,"div",6),r.TgZ(8,"span",7),r._uU(9,"Booking ID"),r.qZA(),r.TgZ(10,"input",8),r.NdJ("ngModelChange",function(e){return t.room_code=e}),r.qZA(),r.qZA(),r.qZA(),r.TgZ(11,"div",9),r.TgZ(12,"button",10),r.NdJ("click",function(){return t.is_scanning=!0}),r._uU(13," Scan Code "),r.qZA(),r.TgZ(14,"button",10),r.NdJ("click",function(){return t.is_scanning=!1}),r._uU(15," Enter Code "),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(4),r.Q6J("ngIf",t.is_scanning),r.xp6(1),r.Q6J("ngIf",!t.is_scanning),r.xp6(2),r.ekj("input",!t.is_scanning),r.xp6(3),r.Q6J("ngModel",t.room_code),r.xp6(2),r.Tol("flex-1 text-black border-none w-40 "+(t.is_scanning?"bg-white":"bg-transparent hover:bg-white bg-opacity-50")),r.xp6(2),r.Tol("flex-1 text-black border-none w-40 "+(t.is_scanning?"bg-transparent hover:bg-white bg-opacity-50":"bg-white")))},directives:[i.O5,k.Nt,o.Fj,o.JJ,o.On,M.lW],styles:["[_nghost-%COMP%]{width:100%;height:100vh;display:flex;flex-direction:column}[box][_ngcontent-%COMP%]{box-shadow:0 0 0 100vw rgba(0,0,0,.5)}[box][_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:none}[box].input[_ngcontent-%COMP%]{width:32rem!important;max-width:calc(100% - 2rem)!important;padding:1rem!important;height:4rem!important;color:#000!important;background:#fff;box-shadow:0 0 0 100vw rgba(0,0,0,.8)}[box].input[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:initial}[box][_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:var(--heading-font);font-weight:500;text-transform:uppercase;letter-spacing:.05em}"]}),e})();var I=n(4762),N=n(9962),Q=n(3530),F=n(1663),j=n(1496),E=n(4441),Y=n(3080),P=n(8512),L=n(6238),D=n(9996),S=n(7701),$=n(859),B=n(1548),G=n(1924),H=n(8055),R=n(8125),V=n(3848),z=n(6762),W=n(6283),X=n(4786),K=n(5089),ee=n(9980),te=n(2222);const ne=function(){return{standalone:!0}};function ie(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",12),r.TgZ(1,"mat-button-toggle-group",13),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).setOptions({group:"group"===t})}),r.ALo(2,"async"),r.TgZ(3,"mat-button-toggle",14),r._uU(4," Single "),r.qZA(),r.TgZ(5,"mat-button-toggle",15),r._uU(6," Group "),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);let t;r.xp6(1),r.Q6J("ngModel",null!=(t=r.lcZ(2,2,e.options))&&t.group?"group":"single")("ngModelOptions",r.DdM(4,ne))}}function oe(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",e.display_name||e.name," ")}}function se(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",4),r.TgZ(1,"label"),r._uU(2,"Building"),r.qZA(),r.TgZ(3,"mat-form-field",16),r.TgZ(4,"mat-select",17),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).building=t})("ngModelChange",function(t){return r.CHM(e),r.oxw(2).setOptions({zone_id:null==t?null:t.id})}),r.YNc(5,oe,2,2,"mat-option",18),r.ALo(6,"async"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(4),r.Q6J("ngModel",e.building)("ngModelOptions",r.DdM(5,ne)),r.xp6(1),r.Q6J("ngForOf",r.lcZ(6,3,e.buildings))}}function ae(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.id),r.xp6(1),r.hij(" ",e.display_name||e.name," ")}}function re(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",4),r.TgZ(1,"label"),r._uU(2,"Level"),r.qZA(),r.TgZ(3,"mat-form-field",16),r.TgZ(4,"mat-select",20),r.NdJ("ngModelChange",function(t){r.CHM(e);const n=r.oxw(2);return n.setOptions({zone_id:t||n.building.id})}),r.YNc(5,ae,2,2,"mat-option",18),r.ALo(6,"async"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(4),r.Q6J("disabled",!e.building)("ngModelOptions",r.DdM(5,ne)),r.xp6(1),r.Q6J("ngForOf",r.lcZ(6,3,e.levels))}}function le(e,t){if(1&e&&(r.TgZ(0,"div",3),r.TgZ(1,"div",21),r.TgZ(2,"label"),r._uU(3,"Start Time"),r.qZA(),r._UZ(4,"a-time-field",22),r.qZA(),r.TgZ(5,"div",21),r.TgZ(6,"label"),r._uU(7,"End Time"),r.qZA(),r._UZ(8,"a-duration-field",23),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);let t;r.xp6(8),r.Q6J("time",null==(t=e.form.get("date"))?null:t.value)("max",1440)("step",60)}}const ce=function(){return[]};function ue(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",8),r.TgZ(1,"label"),r._uU(2,"Group Members"),r.qZA(),r.TgZ(3,"a-user-list-field",24),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).setOptions({members:t})}),r.ALo(4,"async"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);let t;r.xp6(3),r.Q6J("simple",!0)("ngModel",(null==(t=r.lcZ(4,3,e.options))?null:t.members)||r.DdM(5,ce))("ngModelOptions",r.DdM(6,ne))}}function de(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r.TgZ(1,"span",28),r._uU(2),r.qZA(),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(2),r.Oqu(e)}}function ge(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3),r.TgZ(1,"div",21),r.TgZ(2,"label"),r._uU(3,"Recurrence Period"),r.qZA(),r.TgZ(4,"mat-form-field",16),r.TgZ(5,"mat-select",25),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).setOptions({pattern:t})}),r.ALo(6,"async"),r.TgZ(7,"mat-option",26),r._uU(8,"None"),r.qZA(),r.YNc(9,de,3,2,"mat-option",18),r.qZA(),r.qZA(),r.qZA(),r.TgZ(10,"div",21),r.TgZ(11,"label"),r._uU(12,"Recurrence End"),r.qZA(),r.TgZ(13,"a-date-field",27),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).setOptions({recurr_end:t})}),r.ALo(14,"async"),r.ALo(15,"async"),r.ALo(16,"async"),r._uU(17," Date and time must be in the future "),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);let t,n,i;r.xp6(5),r.Q6J("ngModel",null==(t=r.lcZ(6,7,e.options))?null:t.recurrence_pattern)("ngModelOptions",r.DdM(15,ne)),r.xp6(4),r.Q6J("ngForOf",e.recurrence_options),r.xp6(4),r.Q6J("disabled",!(null!=(n=r.lcZ(14,9,e.options))&&n.pattern)||"none"===(null==(n=r.lcZ(15,11,e.options))?null:n.pattern))("ngModel",(null==(i=r.lcZ(16,13,e.options))?null:i.recurr_end)||(null==e.form||null==e.form.value?null:e.form.value.date))("ngModelOptions",r.DdM(16,ne))("to",e.book_until)}}function pe(e,t){if(1&e&&(r.TgZ(0,"mat-option",31),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",e," ")}}function me(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",8),r.TgZ(1,"label"),r._uU(2,"Desk Features"),r.qZA(),r.TgZ(3,"mat-form-field",9),r.TgZ(4,"mat-select",29),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).setOptions({features:t||[]})}),r.ALo(5,"async"),r.YNc(6,pe,2,2,"mat-option",30),r.ALo(7,"async"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);let t;r.xp6(4),r.Q6J("ngModel",(null==(t=r.lcZ(5,3,e.options))?null:t.features)||r.DdM(7,ce))("ngModelOptions",r.DdM(8,ne)),r.xp6(2),r.Q6J("ngForOf",r.lcZ(7,5,e.features))}}function fe(e,t){if(1&e&&(r.TgZ(0,"form",1),r.YNc(1,ie,7,5,"div",2),r.TgZ(2,"div",3),r.TgZ(3,"div",4),r.TgZ(4,"label"),r._uU(5,"Date"),r.qZA(),r.TgZ(6,"a-date-field",5),r._uU(7," Date and time must be in the future "),r.qZA(),r.qZA(),r.YNc(8,se,7,6,"div",6),r.ALo(9,"async"),r.YNc(10,re,7,6,"div",6),r.ALo(11,"async"),r.qZA(),r.YNc(12,le,9,3,"div",7),r.TgZ(13,"div",8),r.TgZ(14,"label"),r._uU(15,"Reason"),r.qZA(),r.TgZ(16,"mat-form-field",9),r._UZ(17,"input",10),r.qZA(),r.qZA(),r.YNc(18,ue,5,7,"div",11),r.ALo(19,"async"),r.YNc(20,ge,18,17,"div",7),r.YNc(21,me,8,9,"div",11),r.ALo(22,"async"),r.qZA()),2&e){const e=r.oxw();let t,n,i,o;r.Q6J("formGroup",e.form),r.xp6(1),r.Q6J("ngIf",e.allow_groups),r.xp6(5),r.Q6J("to",e.book_until),r.xp6(2),r.Q6J("ngIf",(null==(t=r.lcZ(9,9,e.buildings))?null:t.length)>1),r.xp6(2),r.Q6J("ngIf",(null==(n=r.lcZ(11,11,e.levels))?null:n.length)>1),r.xp6(2),r.Q6J("ngIf",e.allow_time_changes),r.xp6(6),r.Q6J("ngIf",null==(i=r.lcZ(19,13,e.options))?null:i.group),r.xp6(2),r.Q6J("ngIf",e.can_recurr),r.xp6(1),r.Q6J("ngIf",null==(o=r.lcZ(22,15,e.features))?null:o.length)}}let he=(()=>{class e{constructor(e,t,n){this._state=e,this._org=t,this._settings=n,this.buildings=this._org.building_list,this.levels=this._org.active_levels,this.options=this._state.options,this.features=this._state.features,this.recurrence_options=["daily","weekly","monthly"],this.setOptions=e=>this._state.setOptions(e)}get building(){return this._org.building}set building(e){this._org.building=e}get can_recurr(){return this._settings.get("app.desks.recurrence_allowed")}get allow_groups(){return this._settings.get("app.desks.allow_groups")}get allow_time_changes(){return!!this._settings.get("app.desks.allow_time_changes")}get book_until(){return(0,R.Z)((0,V.Z)(Date.now(),this._settings.get("app.desks.available_period")||90))}ngOnInit(){console.log("Date:",(0,E.Z)(this.book_until,"dd MMM yyyy"))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(F.fy),r.Y36(j.w7),r.Y36(N.gb))},e.\u0275cmp=r.Xpm({type:e,selectors:[["detailed-book-desks-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4",4,"ngIf"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/4"],["formControlName","date",3,"to"],["class","flex flex-col flex-1 w-full sm:w-1/4",4,"ngIf"],["class","flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],[1,"flex","flex-col","flex-1","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["appearance","outline",1,"w-full"],["matInput","","formControlName","description","placeholder","Reason for booking..."],["class","flex flex-col flex-1 w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],[1,"w-full",3,"ngModel","ngModelOptions","ngModelChange"],["value","single",1,"w-1/2"],["value","group",1,"w-1/2"],["appearance","outline"],["placeholder","Select building",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","Any Level","ngModel","",3,"disabled","ngModelOptions","ngModelChange"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],["formControlName","date"],["formControlName","duration",3,"time","max","step"],[3,"simple","ngModel","ngModelOptions","ngModelChange"],["placeholder","None",3,"ngModel","ngModelOptions","ngModelChange"],["value","none"],[3,"disabled","ngModel","ngModelOptions","to","ngModelChange"],[1,"capitalize"],["multiple","","placeholder","Any Feature",3,"ngModel","ngModelOptions","ngModelChange"],["class","capitalize",3,"value",4,"ngFor","ngForOf"],[1,"capitalize",3,"value"]],template:function(e,t){1&e&&r.YNc(0,fe,23,17,"form",0),2&e&&r.Q6J("ngIf",t.form)},directives:[i.O5,o._Y,o.JL,o.sg,z.Q,o.JJ,o.u,W.KE,k.Nt,o.Fj,Z,o.On,x,X.gD,i.sg,l.ey,K.N,ee.B,te.E],pipes:[i.Ov],styles:[""]}),e})();var Ze=n(7256),_e=n(7806);function ve(e,t){if(1&e&&(r.TgZ(0,"div",27),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",e," ")}}const xe=function(){return[]};function be(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"li",20),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw().setActiveDesk(t)}),r.TgZ(1,"app-icon",21),r._uU(2,"place"),r.qZA(),r.TgZ(3,"div",22),r.TgZ(4,"div",23),r._uU(5),r.qZA(),r.TgZ(6,"div",24),r._uU(7),r.qZA(),r.TgZ(8,"div",25),r.YNc(9,ve,2,1,"div",26),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,n=r.oxw();r.ekj("border-primary",(null==n.active_desk?null:n.active_desk.id)===e.id),r.uIk("desk-id",e.id),r.xp6(5),r.Oqu(e.name),r.xp6(2),r.hij(" ",(null==e.zone?null:e.zone.display_name)||(null==e.zone?null:e.zone.name)||"<No Level>"," "),r.xp6(2),r.Q6J("ngForOf",e.features||r.DdM(6,xe))}}function we(e,t){if(1&e&&(r.TgZ(0,"div",28),r._uU(1),r.ALo(2,"async"),r.ALo(3,"async"),r.qZA()),2&e){const e=r.oxw();let t;r.xp6(1),r.hij(" ",(null==(t=r.lcZ(2,1,e.level))?null:t.display_name)||(null==(t=r.lcZ(3,3,e.level))?null:t.name)," ")}}function Ae(e,t){if(1&e&&(r.TgZ(0,"div",29),r._UZ(1,"mat-spinner",30),r.TgZ(2,"p"),r._uU(3),r.ALo(4,"async"),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("diameter",32),r.xp6(2),r.Oqu(r.lcZ(4,2,e.loading))}}function Te(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",31),r.TgZ(1,"div",32),r.TgZ(2,"div",23),r._uU(3),r.qZA(),r.TgZ(4,"div",24),r._uU(5),r.qZA(),r.qZA(),r.TgZ(6,"div",33),r.TgZ(7,"button",34),r.NdJ("click",function(){return r.CHM(e),r.oxw().setActiveDesk(null)}),r._uU(8," Clear "),r.qZA(),r.TgZ(9,"button",35),r.NdJ("click",function(){return r.CHM(e),r.oxw().makeBooking()}),r._uU(10," Book "),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Oqu(e.active_desk.name),r.xp6(2),r.hij(" ",(null==e.active_desk.zone?null:e.active_desk.zone.display_name)||e.active_desk.zone.name||"<No Level>"," ")}}const ye=function(){return["/book","desks","form"]};let qe=(()=>{class e extends N.KG{constructor(e,t){super(),this._state=e,this._explore=t,this.url=this._explore.map_url,this.styles=this._explore.map_styles,this.positions=this._explore.map_positions,this.features=this._explore.map_features,this.actions=this._explore.map_actions,this.labels=this._explore.map_labels,this.level=this._explore.level,this.desks=this._state.available_assets,this.loading=this._state.loading,this.form=this._state.form,this.option_details=(0,Y.aj)([this._state.options,this.form.valueChanges.pipe((0,L.O)({}))]).pipe((0,D.U)(([e])=>{var t,n;const i=this._state.form,o=(0,N.IO)({pattern:e.pattern,end:e.recurr_end,start:i.value.date,interval:1,days_of_week:-1}),s=`${(0,E.Z)(i.value.date,"dd MMM yyyy")}${e.pattern&&"none"!==e.pattern?", "+o:""}${e.group?", "+e.group:""}, ${(null===(t=e.features)||void 0===t?void 0:t.length)||"Any"} Feature${((null===(n=e.features)||void 0===n?void 0:n.length)||0)<2?"":"s"}`;return e.zone_id&&this._explore.setLevel(e.zone_id),s})),this._active_desk=new P.X(null),this.makeBooking=()=>this._state.confirmPost()}get active_desk(){return this._active_desk.getValue()}ngOnInit(){this.subscription("assets-statue",(0,Y.aj)([this._state.assets,this._state.available_assets,this._active_desk]).pipe((0,S.b)(200)).subscribe(([e,t])=>{const n={},i=[];for(const o of e){const e=o.bookable&&t.find(e=>e.id===o.id);n[`#${o.map_id||o.id}`]={fill:o.bookable?t.find(e=>e.id===o.id)?"#43a047":"#e53935":"#999",opacity:.6},e&&i.push({id:o.map_id||o.id,action:"click",callback:()=>this.setActiveDesk(o)})}this._explore.setStyles("desks",n),this._explore.setActions("desks",i),this._explore.setFeatures("desks",this.active_desk?[{location:this.active_desk.map_id||this.active_desk.id,content:'\n                    <span class="flex h-2 w-2 rounded-full absolute top-1/4 left-1/4 transform -translate-x-1/2 -translate-y-1/2" >\n                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>\n                        <span class="relative inline-flex rounded-full h-2 w-2 bg-primary"></span>\n                    </span>'}]:[])}))}setActiveDesk(e){var t,n,i;this._explore.setLevel(null===(t=null==e?void 0:e.zone)||void 0===t?void 0:t.id),this._active_desk.next(e),this._state.form.patchValue({asset_id:null==e?void 0:e.id,zones:e.zone?[null===(n=e.zone)||void 0===n?void 0:n.parent_id,null===(i=e.zone)||void 0===i?void 0:i.id]:[]})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(F.fy),r.Y36($.ck))},e.\u0275cmp=r.Xpm({type:e,selectors:[["desk-flow-map"]],features:[r.qOj],decls:38,vars:42,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],[1,"flex","flex-col","flex-1","h-1/2","w-full"],[1,"text-2xl","px-4","pt-4","text-center"],[1,"my-4","mx-auto","w-[640px]","max-w-[calc(100vw-2rem)]",3,"matMenuTriggerFor"],["menu","matMenu"],[1,"pt-4","max-h-[65vh]","overflow-auto",3,"click"],[3,"form"],["listing","",1,"flex","flex-1","h-1/2","relative","space-x-2"],[1,"list-style-none","w-full","sm:w-[20rem]","bg-gray-100","p-2","pb-32","overflow-auto","h-full","rounded-tr-lg","space-y-2"],[1,"px-2","sticky","top-0","bg-gray-100","w-full","z-10"],["matRipple","","class","flex items-center p-2 bg-white rounded shadow cursor-pointer space-x-2 min-h-[5rem] border",3,"border-primary","click",4,"ngFor","ngForOf"],[1,"hidden","sm:block","flex-1","bg-gray-200","rounded-tl-lg","border-l","border-t","border-gray-300","relative","overflow-hidden","h-full"],[3,"src","zoom","center","styles","features","actions","labels","focus"],["class","absolute top-2 left-2 bg-white rounded-3xl h-10 px-3 flex items-center border border-gray-300",4,"ngIf"],["class","absolute inset-0 bg-white bg-opacity-60 flex flex-col items-center justify-center space-y-2 !m-0 z-20",4,"ngIf"],["selection","","class","absolute bottom-2 left-1/2 transform -translate-x-1/2 p-2 bg-white shadow rounded w-[24rem] max-w-[calc(100vw-1rem)] space-y-2 !m-0 border border-gray-200",4,"ngIf"],["matRipple","",1,"flex","items-center","p-2","bg-white","rounded","shadow","cursor-pointer","space-x-2","min-h-[5rem]","border",3,"click"],[1,"text-2xl"],[1,"flex","flex-col","w-1/2","flex-1"],["name","",1,""],["level","",1,"text-xs"],["features","",1,"w-full","flex","flex-wrap"],["class","text-xs bg-primary text-white rounded-xl px-2 py-1 mt-1 mr-2",4,"ngFor","ngForOf"],[1,"text-xs","bg-primary","text-white","rounded-xl","px-2","py-1","mt-1","mr-2"],[1,"absolute","top-2","left-2","bg-white","rounded-3xl","h-10","px-3","flex","items-center","border","border-gray-300"],[1,"absolute","inset-0","bg-white","bg-opacity-60","flex","flex-col","items-center","justify-center","space-y-2","!m-0","z-20"],[3,"diameter"],["selection","",1,"absolute","bottom-2","left-1/2","transform","-translate-x-1/2","p-2","bg-white","shadow","rounded","w-[24rem]","max-w-[calc(100vw-1rem)]","space-y-2","!m-0","border","border-gray-200"],[1,""],[1,"flex","items-center","space-x-2"],["mat-button","",1,"inverse","flex-1",3,"click"],["mat-button","",1,"flex-1",3,"click"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"a",1),r.TgZ(2,"div",2),r.TgZ(3,"app-icon",3),r._uU(4,"arrow_back"),r.qZA(),r.TgZ(5,"span",4),r._uU(6,"Back"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(7,"div",5),r.TgZ(8,"h2",6),r._uU(9,"Available Desks"),r.qZA(),r.TgZ(10,"an-action-field",7),r._uU(11),r.ALo(12,"async"),r.qZA(),r.TgZ(13,"mat-menu",null,8),r.TgZ(15,"div",9),r.NdJ("click",function(e){return e.stopPropagation(),e.preventDefault}),r._UZ(16,"detailed-book-desks-form",10),r.qZA(),r.qZA(),r.TgZ(17,"div",11),r.TgZ(18,"ul",12),r.TgZ(19,"div",13),r._uU(20),r.ALo(21,"async"),r.qZA(),r.YNc(22,be,10,7,"li",14),r.ALo(23,"async"),r.qZA(),r.TgZ(24,"div",15),r._UZ(25,"i-map",16),r.ALo(26,"async"),r.ALo(27,"async"),r.ALo(28,"async"),r.ALo(29,"async"),r.ALo(30,"async"),r.ALo(31,"async"),r.ALo(32,"async"),r.YNc(33,we,4,5,"div",17),r.ALo(34,"async"),r.qZA(),r.YNc(35,Ae,5,4,"div",18),r.ALo(36,"async"),r.YNc(37,Te,11,2,"div",19),r.qZA(),r.qZA()),2&e){const e=r.MAs(14);let n,i,o;r.xp6(1),r.Q6J("routerLink",r.DdM(41,ye)),r.xp6(9),r.Q6J("matMenuTriggerFor",e),r.xp6(1),r.hij(" ",r.lcZ(12,17,t.option_details)||"No Filters"," "),r.xp6(5),r.Q6J("form",t.form),r.xp6(4),r.hij(" ",(null==(n=r.lcZ(21,19,t.desks))?null:n.length)||"0"," matches available "),r.xp6(2),r.Q6J("ngForOf",r.lcZ(23,21,t.desks)),r.xp6(3),r.Q6J("src",r.lcZ(26,23,t.url))("zoom",null==(i=r.lcZ(27,25,t.positions))?null:i.zoom)("center",null==(o=r.lcZ(28,27,t.positions))?null:o.center)("styles",r.lcZ(29,29,t.styles))("features",r.lcZ(30,31,t.features))("actions",r.lcZ(31,33,t.actions))("labels",r.lcZ(32,35,t.labels))("focus",(null==t.active_desk?null:t.active_desk.map_id)||(null==t.active_desk?null:t.active_desk.id)),r.xp6(8),r.Q6J("ngIf",r.lcZ(34,37,t.level)),r.xp6(2),r.Q6J("ngIf",r.lcZ(36,39,t.loading)),r.xp6(2),r.Q6J("ngIf",t.active_desk)}},directives:[M.zs,w.yS,B.o,G.s,H.p6,H.VK,he,i.sg,Ze.p,i.O5,l.wG,_e.$g,M.lW],pipes:[i.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}"]}),e})();const ke=function(){return["/book","desks","map"]};let Me=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["desk-flow-confirm"]],decls:7,vars:2,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"a",1),r.TgZ(2,"div",2),r.TgZ(3,"app-icon",3),r._uU(4,"arrow_back"),r.qZA(),r.TgZ(5,"span",4),r._uU(6,"Back"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("routerLink",r.DdM(1,ke)))},directives:[M.zs,w.yS,B.o],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}"]}),e})();const Oe=function(e){return["/book",e]},Ce=function(){return{}},Ue=function(){return["/schedule"]},Je=function(e){return{email:e}};let Ie=(()=>{class e{constructor(){this.route="spaces",this.type="space"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["flow-success"]],inputs:{calendar:"calendar",route:"route",type:"type"},decls:13,vars:11,consts:[["name","success",1,"fixed","inset-0","flex","flex-col","bg-secondary","items-center","justify-center","z-50"],[1,"text-4xl","rounded-full","bg-white","text-success","mb-4"],[1,"text-center","text-lg","text-white","mb-4"],[1,"flex","items-center","space-x-2"],["button","","mat-button","",1,"w-32",3,"routerLink","queryParams"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"app-icon"),r._uU(3,"done"),r.qZA(),r.qZA(),r.TgZ(4,"div",2),r._uU(5),r._UZ(6,"br"),r._uU(7," An event has been added to your calendar "),r.qZA(),r.TgZ(8,"div",3),r.TgZ(9,"a",4),r._uU(10," New Booking "),r.qZA(),r.TgZ(11,"a",4),r._uU(12," My Day "),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(5),r.hij(" Thank you, you ",t.type," booking was successful!"),r.xp6(4),r.Q6J("routerLink",r.VKq(5,Oe,t.route))("queryParams",r.DdM(7,Ce)),r.xp6(2),r.Q6J("routerLink",r.DdM(8,Ue))("queryParams",r.VKq(9,Je,t.calendar)))},directives:[B.o,M.zs,w.yS],styles:[""]}),e})();var Ne=n(847),Qe=n(804),Fe=n(999);function je(e,t){if(1&e&&(r.TgZ(0,"mat-option",23),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.value),r.xp6(1),r.hij(" ",e.name," ")}}function Ee(e,t){if(1&e&&(r.TgZ(0,"mat-option",23),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.id),r.xp6(1),r.hij(" ",e.display_name||e.name," ")}}function Ye(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"section",14),r.TgZ(1,"div",15),r.TgZ(2,"h2",16),r._uU(3," Quick Book Desk "),r.qZA(),r.TgZ(4,"div",17),r.TgZ(5,"mat-form-field",18),r.TgZ(6,"mat-select",19),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().time=t}),r.YNc(7,je,2,2,"mat-option",20),r.qZA(),r.qZA(),r.TgZ(8,"mat-form-field",18),r.TgZ(9,"mat-select",21),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().level=t}),r.YNc(10,Ee,2,2,"mat-option",20),r.qZA(),r.qZA(),r.TgZ(11,"button",22),r.NdJ("click",function(){return r.CHM(e),r.oxw().quickBook()}),r.TgZ(12,"div",10),r.TgZ(13,"app-icon",11),r._uU(14,"search"),r.qZA(),r.TgZ(15,"span",12),r._uU(16,"Find Desk"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(6),r.Q6J("ngModel",e.time),r.xp6(1),r.Q6J("ngForOf",e.quick_times),r.xp6(2),r.Q6J("ngModel",e.level),r.xp6(1),r.Q6J("ngForOf",e.levels)}}let Pe=(()=>{class e{constructor(e,t,n){this._state=e,this._router=t,this._org=n,this.time=0,this.level="",this.quick_times=[{name:"Now",value:0},{name:"Tomorrow",value:(0,Ne.Z)((0,V.Z)(new Date,1),9).valueOf()}],this.levels=[],this.clearForm=()=>{this.time=0,this.level=this._org.building.id,this._state.clearForm()}}get is_edit(){var e,t;return!!(null===(t=null===(e=this.form)||void 0===e?void 0:e.get("id"))||void 0===t?void 0:t.value)}get form(){return this._state.form}ngOnInit(){var e,t;return(0,I.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,Q.P)(e=>e)),yield this._org.active_levels.pipe((0,Q.P)(e=>(null==e?void 0:e.length)>0)),this.level=null===(e=this._org.building)||void 0===e?void 0:e.id,this.levels=[{id:null===(t=this._org.building)||void 0===t?void 0:t.id,name:"Any Level"},...this._org.levelsForBuilding(this._org.building)]})}quickBook(){this.form.patchValue({date:(this.time<1440?(0,Qe.Z)((0,Fe.Z)(new Date,{nearestTo:5}),this.time):(0,Ne.Z)((0,V.Z)(new Date,1),8)).valueOf(),title:"Ad-hoc Desk Booking"}),this.findDesk()}findDesk(){this.form.markAllAsTouched(),this.form.valid&&this._router.navigate(["/book","desks","map"])}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(F.fy),r.Y36(w.F0),r.Y36(j.w7))},e.\u0275cmp=r.Xpm({type:e,selectors:[["desk-flow-form"]],decls:23,vars:5,consts:[["quick","","class","text-white",4,"ngIf"],[1,"bg-gray-300"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"text-xl","uppercase","font-medium","my-4"],["form","",1,"flex-1","min-h-[50%]"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[3,"form"],[1,"mb-4","border-b","border-gray-300","w-full"],[1,"flex","flex-col","sm:flex-row","items-center","justify-center","space-x-0","space-y-2","sm:space-y-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],["mat-button","","clear","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]","inverse",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"ml-2","mx-4"],["find","","mat-button","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"],["quick","",1,"text-white"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","pb-2"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2"],["overlay","","appearance","outline",1,"sm:flex-2","h-[3.25rem]"],["name","time","placeholder","Now",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","level","placeholder","Any Level",3,"ngModel","ngModelChange"],["mat-button","",1,"sm:flex-1","h-[2.75rem]","mt-1","mb-2",3,"click"],[3,"value"]],template:function(e,t){1&e&&(r.YNc(0,Ye,17,4,"section",0),r.TgZ(1,"section",1),r.TgZ(2,"div",2),r.TgZ(3,"h2",3),r._uU(4,"OR"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(5,"section",4),r.TgZ(6,"h2",5),r._uU(7),r.qZA(),r._UZ(8,"detailed-book-desks-form",6),r._UZ(9,"div",7),r.TgZ(10,"div",8),r.TgZ(11,"button",9),r.NdJ("click",function(){return t.clearForm()}),r.TgZ(12,"div",10),r.TgZ(13,"app-icon",11),r._uU(14,"clear"),r.qZA(),r.TgZ(15,"span",12),r._uU(16),r.qZA(),r.qZA(),r.qZA(),r.TgZ(17,"button",13),r.NdJ("click",function(){return t.findDesk()}),r.TgZ(18,"div",10),r.TgZ(19,"app-icon",11),r._uU(20,"search"),r.qZA(),r.TgZ(21,"span",12),r._uU(22),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Q6J("ngIf",!t.is_edit),r.xp6(7),r.hij(" ",t.is_edit?"Edit":"Detailed"," Booking "),r.xp6(1),r.Q6J("form",t.form),r.xp6(8),r.Oqu(t.is_edit?"Cancel Edit":"Clear Form"),r.xp6(6),r.Oqu(t.is_edit?"Update Desk":"Find Desk"))},directives:[i.O5,he,M.lW,B.o,W.KE,X.gD,o.JJ,o.On,i.sg,l.ey],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;overflow:auto}[quick][_ngcontent-%COMP%]{background-color:#007ac8}"]}),e})();function Le(e,t){1&e&&(r.ynx(0),r._UZ(1,"desk-flow-map"),r.BQk())}function De(e,t){1&e&&(r.ynx(0),r._UZ(1,"desk-flow-confirm"),r.BQk())}function Se(e,t){if(1&e&&(r.ynx(0),r._UZ(1,"flow-success",4),r.BQk()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("calendar",null==e.last_success?null:e.last_success.user_email)}}function $e(e,t){1&e&&(r.ynx(0),r._UZ(1,"desk-flow-form"),r.BQk())}let Be=(()=>{class e extends N.KG{constructor(e,t,n){super(),this._state=e,this._route=t,this._org=n}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){return(0,I.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,Q.P)(e=>e)).toPromise(),this._state.loadForm(),this._state.form||this._state.newForm(),this._state.form.patchValue({booking_type:"desk"}),this.subscription("route.params",this._route.paramMap.subscribe(e=>{e.has("step")&&this._state.setView(e.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(e=>{e.has("success")&&this._state.setView(e.get("success"))}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(F.fy),r.Y36(w.gz),r.Y36(j.w7))},e.\u0275cmp=r.Xpm({type:e,selectors:[["placeos-book-desk-flow"]],features:[r.qOj],decls:6,vars:4,consts:[[1,"bg-white","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","desk","route","desks",3,"calendar"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.ynx(1,1),r.YNc(2,Le,2,0,"ng-container",2),r.YNc(3,De,2,0,"ng-container",2),r.YNc(4,Se,2,1,"ng-container",2),r.YNc(5,$e,2,0,"ng-container",3),r.BQk(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngSwitch",t.view),r.xp6(1),r.Q6J("ngSwitchCase","map"),r.xp6(1),r.Q6J("ngSwitchCase","confirm"),r.xp6(1),r.Q6J("ngSwitchCase","success"))},directives:[i.RF,i.n9,i.ED,qe,Me,Ie,Pe],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]}),e})();var Ge=n(4266),He=n(3835),Re=n(611),Ve=n(7209),ze=n(8282),We=n(4608);let Xe=(()=>{class e{constructor(e){this._dialog=e,this.bookChange=new r.vpe}bookSpace(){this.book=!this.book,this.bookChange.emit(this.book)}viewLocation(){this._dialog.open(ze.p,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{item:this.space}})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(We.uw))},e.\u0275cmp=r.Xpm({type:e,selectors:[["space-flow-find-item"]],inputs:{space:"space",multiple:"multiple",book:"book"},outputs:{bookChange:"bookChange"},decls:19,vars:8,consts:[[1,"flex","items-center","bg-white","p-2","my-2","shadow","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","rounded"],[1,"flex","flex-col","flex-1","space-y-2"],[1,"flex","items-center"],[1,"p-2","rounded-full","bg-gray-300","mr-2"],[1,"flex","flex-col","space-y-2","ml-2"],["mat-button","","book","",3,"click"],["locate","","mat-button","",1,"inverse",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"div",3),r.TgZ(4,"app-icon"),r._uU(5,"place"),r.qZA(),r.qZA(),r.TgZ(6,"span"),r._uU(7),r.qZA(),r.qZA(),r.TgZ(8,"div",2),r.TgZ(9,"div",3),r.TgZ(10,"app-icon"),r._uU(11,"group"),r.qZA(),r.qZA(),r.TgZ(12,"span"),r._uU(13),r.qZA(),r.qZA(),r.qZA(),r.TgZ(14,"div",4),r.TgZ(15,"button",5),r.NdJ("click",function(){return t.bookSpace()}),r._uU(16),r.qZA(),r.TgZ(17,"button",6),r.NdJ("click",function(){return t.viewLocation()}),r._uU(18," Map "),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(7),r.AsE("",(null==t.space||null==t.space.level?null:t.space.level.display_name)||(null==t.space||null==t.space.level?null:t.space.level.name),", ",(null==t.space?null:t.space.display_name)||(null==t.space?null:t.space.name),""),r.xp6(6),r.hij("",(null==t.space?null:t.space.capacity)||0," People"),r.xp6(2),r.ekj("bg-pending",t.book)("border-pending",t.book),r.xp6(1),r.hij(" ",t.multiple?t.book?"Remove":"Select":"Book"," "))},directives:[B.o,M.lW],styles:["button[_ngcontent-%COMP%]{width:8rem}"]}),e})();function Ke(e,t){if(1&e&&(r.TgZ(0,"mat-option",21),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",e.display_name||e.name," ")}}function et(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",19),r.TgZ(1,"mat-select",20),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().setBuilding(t)}),r.ALo(2,"async"),r.YNc(3,Ke,2,2,"mat-option",13),r.ALo(4,"async"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngModel",r.lcZ(2,2,e.building)),r.xp6(2),r.Q6J("ngForOf",r.lcZ(4,4,e.buildings))}}function tt(e,t){if(1&e&&(r.TgZ(0,"mat-option",21),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.id),r.xp6(1),r.hij(" ",e.display_name||e.name," ")}}function nt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",22),r.TgZ(1,"mat-select",23),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().setOptions({zone_ids:[t]})}),r.ALo(2,"async"),r.ALo(3,"async"),r.YNc(4,tt,2,2,"mat-option",13),r.ALo(5,"async"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();let t;r.xp6(1),r.Q6J("ngModel",null!=(t=r.lcZ(2,2,e.options))&&null!=t.zone_ids&&t.zone_ids.length?null==(t=r.lcZ(3,4,e.options))?null:t.zone_ids[0]:""),r.xp6(3),r.Q6J("ngForOf",r.lcZ(5,6,e.levels))}}function it(e,t){if(1&e&&(r.TgZ(0,"mat-option",21),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.value),r.xp6(1),r.hij(" ",e.name," ")}}function ot(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"space-flow-find-item",26),r.NdJ("bookChange",function(t){const n=r.CHM(e).$implicit;return r.oxw(3).book_space[n.id]=t})("bookChange",function(t){const n=r.CHM(e).$implicit;return r.oxw(3).handleBookEvent(n,t)}),r.qZA()}if(2&e){const e=t.$implicit,n=r.oxw(3);r.Q6J("space",e)("multiple",n.multiple)("book",n.book_space[e.id])}}function st(e,t){if(1&e&&(r.ynx(0),r.YNc(1,ot,1,3,"space-flow-find-item",24),r.ALo(2,"async"),r.TgZ(3,"p",25),r._uU(4," End of available spaces list "),r.qZA(),r.BQk()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,e.spaces))}}function at(e,t){if(1&e&&(r.ynx(0),r.YNc(1,st,5,3,"ng-container",15),r.ALo(2,"async"),r.BQk()),2&e){const e=r.oxw(),t=r.MAs(27);let n;r.xp6(1),r.Q6J("ngIf",(null==(n=r.lcZ(2,2,e.spaces))?null:n.length)>0)("ngIfElse",t)}}function rt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",35),r.TgZ(1,"div",36),r.TgZ(2,"div"),r._uU(3),r.qZA(),r.TgZ(4,"div",37),r._uU(5),r.qZA(),r.qZA(),r.TgZ(6,"button",38),r.NdJ("click",function(t){const n=r.CHM(e).$implicit;return r.oxw(2).handleBookEvent(n,!1),t.stopPropagation()}),r.TgZ(7,"app-icon"),r._uU(8,"close"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit;r.xp6(3),r.Oqu(e.display_name||e.name),r.xp6(2),r.AsE(" ",(null==e.level?null:e.level.display_name)||(null==e.level?null:e.level.name)," ~ ",e.capacity||"2+"," People ")}}function lt(e,t){1&e&&(r.TgZ(0,"div",39),r._uU(1," No selected spaces "),r.qZA())}function ct(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",27),r.TgZ(1,"div",28),r.TgZ(2,"div",29),r._uU(3),r.qZA(),r.TgZ(4,"button",30),r.NdJ("click",function(){return r.CHM(e),r.oxw().confirmBooking()}),r._uU(5," Book "),r.qZA(),r.qZA(),r.TgZ(6,"mat-menu",31,32),r.YNc(8,rt,9,3,"div",33),r.YNc(9,lt,2,0,"div",34),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(7),t=r.oxw();r.xp6(2),r.Q6J("matMenuTriggerFor",e),r.xp6(1),r.hij(" ",t.space_list.length," space(s) selected "),r.xp6(1),r.Q6J("disabled",!t.space_list.length),r.xp6(4),r.Q6J("ngForOf",t.space_list),r.xp6(1),r.Q6J("ngIf",!(null!=t.space_list&&t.space_list.length))}}function ut(e,t){1&e&&(r.TgZ(0,"div",40),r._UZ(1,"mat-spinner",41),r.TgZ(2,"p"),r._uU(3,"Retrieving available spaces..."),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("diameter",32))}function dt(e,t){1&e&&(r.TgZ(0,"div",42),r.TgZ(1,"p"),r._uU(2," No available spaces for selected time, capacity or level(s) "),r.qZA(),r.qZA())}const gt=function(){return["/book","spaces","form"]};let pt=(()=>{class e{constructor(e,t,n,i,o){this._org=e,this._spaces=t,this._state=n,this._settings=i,this._router=o,this.book_space={},this.quick_capacities=[{name:"Any Capacity",value:0},{name:"Small (1 - 4)",value:1},{name:"Medium (5 - 12)",value:5},{name:"Large (13 - 32)",value:13},{name:"Huge (32+)",value:33}],this.space_list=[],this.buildings=this._org.building_list,this.building=this._org.active_building,this.levels=(0,Y.aj)([this.building,this._state.options]).pipe((0,He.h)(([e])=>!!e),(0,D.U)(([e])=>[{id:this._org.building.id,name:"All Levels"},...this._org.levelsForBuilding(e)])),this.loading=this._state.loading,this.options=this._state.options,this.spaces=this._state.available_spaces,this.setOptions=e=>this._state.setOptions(e)}setBuilding(e){return(0,I.mG)(this,void 0,void 0,function*(){const t=yield this.options.pipe((0,Re.q)(1)).toPromise();e&&(this._org.building=e);const n=this._org.levelsForBuilding(this._org.building);!n.find(e=>{var n;return null===(n=t.zone_ids)||void 0===n?void 0:n.includes(e.id)})&&n.length&&this.setOptions({zone_ids:[n[0].id]})})}get multiple(){var e;return null!==(e=this._settings.get("app.booking.multiple_spaces"))&&void 0!==e&&e}ngOnInit(){var e,t;return(0,I.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,Q.P)(e=>!!e)).toPromise(),yield this._spaces.initialised.pipe((0,Q.P)(e=>!!e)).toPromise(),this.setBuilding(this._org.building),this.book_space={},((null===(t=null===(e=this._state.form)||void 0===e?void 0:e.get("resources"))||void 0===t?void 0:t.value)||[]).forEach(e=>this.book_space[e.id]=!0),this.space_list=this._spaces.filter(e=>this.book_space[e.id])})}handleBookEvent(e,t=!0){this.multiple?this.book_space[e.id]=t:(this.book_space={},this.book_space[e.id]=t,this.confirmBooking()),this.space_list=this._spaces.filter(e=>this.book_space[e.id])}confirmBooking(){const e=this._spaces.filter(e=>this.book_space[e.id]);this._state.form.patchValue({resources:e,system:e[0]}),this._router.navigate(["/book","spaces","confirm"])}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(j.w7),r.Y36(Ve.sK),r.Y36(Ge.MH),r.Y36(N.gb),r.Y36(w.F0))},e.\u0275cmp=r.Xpm({type:e,selectors:[["space-flow-find"]],decls:28,vars:17,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],["filters",""],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","py-4"],[1,"text-xl","uppercase","font-medium","text-white"],[1,"flex","flex-col","items-center","sm:flex-row","space-x-0","sm:space-x-2"],["overlay","","buildings","","class","w-full sm:w-auto sm:flex-1 h-[3.25rem]","appearance","outline",4,"ngIf"],["class","w-full sm:w-auto sm:flex-1 h-[3.25rem]","overlay","","appearance","outline",4,"ngIf"],["overlay","","appearance","outline",1,"w-full","sm:w-auto","sm:flex-1","h-[3.25rem]","hidden","sm:block"],["placeholder","Any Capacity",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-1","w-full","bg-gray-100","overflow-auto"],[4,"ngIf","ngIfElse"],["class","bg-white border-t border-gray-200",4,"ngIf"],["load_state",""],["empty_state",""],["overlay","","buildings","","appearance","outline",1,"w-full","sm:w-auto","sm:flex-1","h-[3.25rem]"],["placeholder","Select Building...",3,"ngModel","ngModelChange"],[3,"value"],["overlay","","appearance","outline",1,"w-full","sm:w-auto","sm:flex-1","h-[3.25rem]"],["placeholder","Level",3,"ngModel","ngModelChange"],["class","w-[640px] max-w-[calc(100%-2rem)] mx-auto ",3,"space","multiple","book","bookChange",4,"ngFor","ngForOf"],[1,"p-4","text-center","opacity-60"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto",3,"space","multiple","book","bookChange"],[1,"bg-white","border-t","border-gray-200"],[1,"flex","items-center","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","p-2"],[1,"flex-1","underline",3,"matMenuTriggerFor"],["mat-button","",1,"w-32",3,"disabled","click"],["yPosition","above"],["menu","matMenu"],["class","flex items-center pointer-events-none leading-tight","mat-menu-item","",4,"ngFor","ngForOf"],["mat-menu-item","","class"," opacity-60",4,"ngIf"],["mat-menu-item","",1,"flex","items-center","pointer-events-none","leading-tight"],[1,"flex","flex-col","mr-4"],[1,"text-xs","opacity-70"],["mat-icon-button","",1,"pointer-events-auto",3,"click"],["mat-menu-item","",1,"opacity-60"],[1,"h-full","w-full","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"],[1,"h-full","w-full","flex","flex-col","items-center","justify-center","space-y-2","p-8","text-center"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"a",1),r.TgZ(2,"div",2),r.TgZ(3,"app-icon",3),r._uU(4,"arrow_back"),r.qZA(),r.TgZ(5,"span",4),r._uU(6,"Back"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(7,"div",5),r.TgZ(8,"div",6),r.TgZ(9,"h2",7),r._uU(10," Available Spaces "),r.qZA(),r.TgZ(11,"div",8),r.YNc(12,et,5,6,"mat-form-field",9),r.ALo(13,"async"),r.YNc(14,nt,6,8,"mat-form-field",10),r.ALo(15,"async"),r.TgZ(16,"mat-form-field",11),r.TgZ(17,"mat-select",12),r.NdJ("ngModelChange",function(e){return t.setOptions({capacity:e})}),r.ALo(18,"async"),r.YNc(19,it,2,2,"mat-option",13),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(20,"div",14),r.YNc(21,at,3,4,"ng-container",15),r.ALo(22,"async"),r.qZA(),r.YNc(23,ct,10,5,"div",16),r.YNc(24,ut,4,1,"ng-template",null,17,r.W1O),r.YNc(26,dt,3,0,"ng-template",null,18,r.W1O)),2&e){const e=r.MAs(25);let n,i,o;r.xp6(1),r.Q6J("routerLink",r.DdM(16,gt)),r.xp6(11),r.Q6J("ngIf",(null==(n=r.lcZ(13,8,t.buildings))?null:n.length)>1),r.xp6(2),r.Q6J("ngIf",(null==(i=r.lcZ(15,10,t.levels))?null:i.length)>0),r.xp6(3),r.Q6J("ngModel",null==(o=r.lcZ(18,12,t.options))?null:o.capacity),r.xp6(2),r.Q6J("ngForOf",t.quick_capacities),r.xp6(2),r.Q6J("ngIf",!r.lcZ(22,14,t.loading))("ngIfElse",e),r.xp6(2),r.Q6J("ngIf",t.multiple)}},directives:[M.zs,w.yS,B.o,i.O5,W.KE,X.gD,o.JJ,o.On,i.sg,l.ey,Xe,H.p6,M.lW,H.VK,H.OP,_e.$g],pipes:[i.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}[filters][_ngcontent-%COMP%]{background-color:#007ac8}"]}),e})();var mt=n(5969);function ft(e,t){if(1&e&&(r.TgZ(0,"div",20),r.TgZ(1,"span"),r._uU(2),r.qZA(),r.TgZ(3,"button",21),r._uU(4," Map "),r.qZA(),r.qZA()),2&e){const e=t.$implicit;r.xp6(2),r.AsE("",e.display_name||e.name," [",(null==e.level?null:e.level.display_name)||(null==e.level?null:e.level.name),"]")}}function ht(e,t){if(1&e&&(r.TgZ(0,"div",22),r._UZ(1,"a-user-avatar",23),r.TgZ(2,"span"),r._uU(3),r.qZA(),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("user",e),r.xp6(2),r.Oqu(e.name||e.email)}}function Zt(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1,"Confirm"),r.qZA())}function _t(e,t){1&e&&r._UZ(0,"mat-spinner",24),2&e&&r.Q6J("diameter",24)}const vt=function(){return["/book","spaces","find"]},xt=function(){return["/book","spaces","form"]};let bt=(()=>{class e{constructor(e){this._state=e,this.show_spaces=!1,this.show_people=!1,this.loading=!1,this.postForm=()=>(0,I.mG)(this,void 0,void 0,function*(){this.loading=!0,yield this._state.postForm().catch(e=>(0,N.cB)(e)),this.loading=!1})}get form(){return this._state.form}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ge.MH))},e.\u0275cmp=r.Xpm({type:e,selectors:[["space-flow-confirm"]],decls:59,vars:38,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],[1,"flex","flex-col","items-center","space-y-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],[1,"text-xl","uppercase","font-medium","w-full","my-4"],[1,"flex","items-center","py-2","space-x-2","border-b","border-gray-200","w-full"],[1,"p-2","rounded-full","bg-gray-300","mr-2"],[1,"flex-1","truncate"],["mat-button","",1,"clear","underline",3,"routerLink"],[1,"border-b","border-gray-200","w-full"],[1,"flex","items-center","py-2","space-x-2"],["mat-button","",1,"clear","bg-transparent","border-none","underline",3,"disabled","click"],["list","",1,"overflow-hidden"],["class","flex items-center h-10 pl-12",4,"ngFor","ngForOf"],["class","flex items-center h-12 pl-12 space-x-2",4,"ngFor","ngForOf"],["mat-button","","confirm","",1,"w-32",3,"disabled","click"],[4,"ngIf"],["class","mx-auto",3,"diameter",4,"ngIf"],[1,"flex","items-center","h-10","pl-12"],["mat-button","",1,"bg-transparent","border-none","underline"],[1,"flex","items-center","h-12","pl-12","space-x-2"],[1,"text-sm",3,"user"],[1,"mx-auto",3,"diameter"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"a",1),r.TgZ(2,"div",2),r.TgZ(3,"app-icon",3),r._uU(4,"arrow_back"),r.qZA(),r.TgZ(5,"span",4),r._uU(6,"Back"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(7,"div",5),r.TgZ(8,"h2",6),r._uU(9," Your meeting details "),r.qZA(),r.TgZ(10,"div",7),r.TgZ(11,"div",8),r.TgZ(12,"app-icon"),r._uU(13,"event"),r.qZA(),r.qZA(),r.TgZ(14,"div",9),r._uU(15),r.ALo(16,"date"),r.ALo(17,"date"),r.ALo(18,"date"),r.qZA(),r.TgZ(19,"a",10),r._uU(20,"Edit"),r.qZA(),r.qZA(),r.TgZ(21,"div",7),r.TgZ(22,"div",8),r.TgZ(23,"app-icon"),r._uU(24,"schedule"),r.qZA(),r.qZA(),r.TgZ(25,"div",9),r._uU(26),r.qZA(),r.TgZ(27,"a",10),r._uU(28,"Edit"),r.qZA(),r.qZA(),r.TgZ(29,"div",11),r.TgZ(30,"div",12),r.TgZ(31,"div",8),r.TgZ(32,"app-icon"),r._uU(33,"place"),r.qZA(),r.qZA(),r.TgZ(34,"div",9),r._uU(35),r.qZA(),r.TgZ(36,"button",13),r.NdJ("click",function(){return t.show_spaces=!t.show_spaces}),r._uU(37),r.qZA(),r.TgZ(38,"a",10),r._uU(39,"Edit"),r.qZA(),r.qZA(),r.TgZ(40,"div",14),r.YNc(41,ft,5,2,"div",15),r.qZA(),r.qZA(),r.TgZ(42,"div",11),r.TgZ(43,"div",12),r.TgZ(44,"div",8),r.TgZ(45,"app-icon"),r._uU(46,"group"),r.qZA(),r.qZA(),r.TgZ(47,"div",9),r._uU(48),r.qZA(),r.TgZ(49,"button",13),r.NdJ("click",function(){return t.show_people=!t.show_people}),r._uU(50),r.qZA(),r.TgZ(51,"a",10),r._uU(52,"Edit"),r.qZA(),r.qZA(),r.TgZ(53,"div",14),r.YNc(54,ht,4,2,"div",16),r.qZA(),r.qZA(),r.TgZ(55,"button",17),r.NdJ("click",function(){return t.postForm()}),r.YNc(56,Zt,2,0,"span",18),r.YNc(57,_t,1,1,"mat-spinner",19),r.qZA(),r.qZA(),r._uU(58," < ")),2&e){let e,n,i,o,s,a,l,c,u,d;r.xp6(1),r.Q6J("routerLink",r.DdM(33,vt)),r.xp6(14),r.lnq(" ",r.xi3(16,24,null==(e=t.form.get("date"))?null:e.value,"longDate")," at ",r.xi3(17,27,null==(e=t.form.get("date"))?null:e.value,"shortTime")," ~ ",r.xi3(18,30,(null==(e=t.form.get("date"))?null:e.value)+60*(null==(e=t.form.get("duration"))?null:e.value)*1e3,"shortTime")," "),r.xp6(4),r.Q6J("routerLink",r.DdM(34,xt)),r.xp6(7),r.hij(" ",null==(n=t.form.get("duration"))?null:n.value," minutes "),r.xp6(1),r.Q6J("routerLink",r.DdM(35,xt)),r.xp6(8),r.hij(" ",null==(i=t.form.get("resources"))||null==i.value?null:i.value.length," Space(s) "),r.xp6(1),r.Q6J("disabled",!(null!=(o=t.form.get("resources"))&&null!=o.value&&o.value.length)),r.xp6(1),r.hij(" ",t.show_spaces?"Hide":"Show"," "),r.xp6(1),r.Q6J("routerLink",r.DdM(36,vt)),r.xp6(2),r.Udp("height",t.show_spaces?2.5*(null==(s=t.form.get("resources"))||null==s.value?null:s.value.length)+"rem":"0"),r.xp6(1),r.Q6J("ngForOf",null==(a=t.form.get("resources"))?null:a.value),r.xp6(7),r.hij(" ",(null==(l=t.form.get("attendees"))||null==l.value?null:l.value.length)||0," Attendee(s) "),r.xp6(1),r.Q6J("disabled",!(null!=(c=t.form.get("attendees"))&&null!=c.value&&c.value.length)),r.xp6(1),r.hij(" ",t.show_people?"Hide":"Show"," "),r.xp6(1),r.Q6J("routerLink",r.DdM(37,xt)),r.xp6(2),r.Udp("height",t.show_people?3*(null==(u=t.form.get("attendees"))||null==u.value?null:u.value.length)+"rem":"0"),r.xp6(1),r.Q6J("ngForOf",null==(d=t.form.get("attendees"))?null:d.value),r.xp6(1),r.Q6J("disabled",t.loading),r.xp6(1),r.Q6J("ngIf",!t.loading),r.xp6(1),r.Q6J("ngIf",t.loading)}},directives:[M.zs,w.yS,B.o,M.lW,i.sg,i.O5,mt.k,_e.$g],pipes:[i.uU],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}[list][_ngcontent-%COMP%]{transition:height .2s}"]}),e})();n(7937),n(6974);const wt=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}];function At(e,t){1&e&&(r.TgZ(0,"button",5),r.TgZ(1,"app-icon"),r._uU(2,"close"),r.qZA(),r.qZA())}function Tt(e,t){if(1&e&&(r.TgZ(0,"mat-option",18),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.id),r.xp6(1),r.hij(" ",e.name," ")}}function yt(e,t){if(1&e&&(r.TgZ(0,"div",14),r.TgZ(1,"mat-form-field",8),r.TgZ(2,"mat-select",15),r.NdJ("ngModelChange",function(e){return t.$implicit[0]=e}),r.YNc(3,Tt,2,2,"mat-option",16),r.qZA(),r.qZA(),r.TgZ(4,"mat-form-field",8),r.TgZ(5,"input",17),r.NdJ("ngModelChange",function(e){return t.$implicit[1]=e}),r.qZA(),r.TgZ(6,"mat-error"),r._uU(7,"Rule value is required"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=t.$implicit,n=r.oxw(2);r.xp6(2),r.Q6J("ngModel",e[0]),r.xp6(1),r.Q6J("ngForOf",n.rule_types),r.xp6(2),r.Q6J("ngModel",e[1])}}function qt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",6),r.TgZ(1,"div",7),r.TgZ(2,"mat-form-field",8),r.TgZ(3,"input",9),r.NdJ("ngModelChange",function(e){return t.$implicit.name=e}),r.qZA(),r.TgZ(4,"mat-error"),r._uU(5,"Ruleset name is required"),r.qZA(),r.qZA(),r.TgZ(6,"button",10),r.NdJ("click",function(){const t=r.CHM(e).$implicit,n=r.oxw();return t.rules.push(["",""]),n.show_rules=t.id}),r.TgZ(7,"app-icon"),r._uU(8,"add"),r.qZA(),r.qZA(),r.TgZ(9,"button",11),r.NdJ("click",function(){const t=r.CHM(e).$implicit,n=r.oxw();return n.show_rules=n.show_rules!==t.id?t.id:""}),r.TgZ(10,"app-icon"),r._uU(11),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",12),r.YNc(13,yt,8,3,"div",13),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,n=r.oxw();r.xp6(3),r.Q6J("ngModel",e.name),r.xp6(6),r.Q6J("disabled",!e.rules.length),r.xp6(2),r.Oqu(n.show_rules===e.id?"expand_less":"expand_more"),r.xp6(1),r.Udp("height",(n.show_rules===e.id?3.5*e.rules.length:0)+"em"),r.xp6(1),r.Q6J("ngForOf",e.rules)}}let kt=(()=>{class e{constructor(e){this._data=e,this.event=new r.vpe,this.loading=!1,this.rule_types=wt,this.rulesets=(e.config||[]).map(e=>(e.rules=e.rules.map(e=>[e[0],JSON.stringify(e[1])]),e))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const e=this.rulesets.map(e=>Object.assign(Object.assign({},e),{rules:e.rules.map(e=>{let t=e[1];try{t=JSON.parse(e[1])}catch(n){}return[e[0],t]})}));this.event.emit({reason:"done",metadata:e})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(We.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex px-2 h-14 space-x-2",4,"ngFor","ngForOf"],[1,"flex","px-2","h-14","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"header"),r.TgZ(1,"h3"),r._uU(2,"Edit Catering Configuration"),r.qZA(),r.YNc(3,At,3,0,"button",0),r.qZA(),r.TgZ(4,"main",1),r.TgZ(5,"button",2),r.NdJ("click",function(){return t.rulesets.push({id:t.new_id,rules:[]})}),r._uU(6," New Ruleset "),r.qZA(),r.YNc(7,qt,14,6,"div",3),r.qZA(),r.TgZ(8,"footer",4),r.TgZ(9,"button",2),r.NdJ("click",function(){return t.saveChanges()}),r._uU(10,"Save Changes"),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Q6J("ngIf",!t.loading),r.xp6(4),r.Q6J("ngForOf",t.rulesets))},directives:[i.O5,M.lW,i.sg,We.ZT,B.o,W.KE,k.Nt,o.Fj,o.Q7,o.JJ,o.On,W.TO,X.gD,l.ey],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}"]}),e})();var Mt=n(5842),Ot=n(3016),Ct=n(84),Ut=n(9236),Jt=n(5135),It=n(33);function Nt(e,t){1&e&&(r.TgZ(0,"button",7),r.TgZ(1,"app-icon"),r._uU(2,"close"),r.qZA(),r.qZA())}function Qt(e,t){if(1&e&&(r.TgZ(0,"div",15),r.TgZ(1,"label",16),r._uU(2," Name"),r.TgZ(3,"span"),r._uU(4,"*"),r.qZA(),r._uU(5,": "),r.qZA(),r.TgZ(6,"mat-form-field",17),r._UZ(7,"input",18),r.TgZ(8,"mat-error"),r._uU(9,"Name is required"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.ekj("error",e.form.controls.name.invalid&&e.form.controls.name.touched)}}function Ft(e,t){if(1&e&&(r.TgZ(0,"div",15),r.TgZ(1,"label",19),r._uU(2," Category"),r.TgZ(3,"span"),r._uU(4,"*"),r.qZA(),r._uU(5,": "),r.qZA(),r.TgZ(6,"mat-form-field",17),r._UZ(7,"input",20),r.TgZ(8,"mat-error"),r._uU(9,"Category is required"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2),t=r.MAs(9);r.xp6(1),r.ekj("error",e.form.controls.category.invalid&&e.form.controls.category.touched),r.xp6(6),r.Q6J("matAutocomplete",t)}}const jt=function(){return{class:"material-icons",content:"close"}};function Et(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-chip",27),r.NdJ("removed",function(){const t=r.CHM(e).$implicit;return r.oxw(3).removeTag(t)}),r._uU(1),r._UZ(2,"app-icon",28),r.qZA()}if(2&e){const e=t.$implicit;r.Q6J("selectable",!0)("removable",!0),r.xp6(1),r.hij(" ",e," "),r.xp6(1),r.Q6J("icon",r.DdM(4,jt))}}function Yt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",15),r.TgZ(1,"label",21),r.SDv(2,22),r.qZA(),r.TgZ(3,"mat-form-field",17),r.TgZ(4,"mat-chip-list",23,24),r.YNc(6,Et,3,5,"mat-chip",25),r.TgZ(7,"input",26),r.NdJ("matChipInputTokenEnd",function(t){return r.CHM(e),r.oxw(2).addTag(t)}),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(5),t=r.oxw(2);r.xp6(1),r.ekj("error",t.form.controls.tags.invalid&&t.form.controls.tags.touched),r.xp6(5),r.Q6J("ngForOf",t.tag_list),r.xp6(1),r.Q6J("matChipInputFor",e)("matChipInputSeparatorKeyCodes",t.separators)("matChipInputAddOnBlur",!0)}}function Pt(e,t){1&e&&(r.TgZ(0,"div",15),r.TgZ(1,"label",29),r._uU(2,"Description:"),r.qZA(),r.TgZ(3,"mat-form-field",17),r._UZ(4,"textarea",30),r.qZA(),r.qZA())}function Lt(e,t){if(1&e&&(r.TgZ(0,"div",15),r.TgZ(1,"label",16),r._uU(2," Unit Price"),r.TgZ(3,"span"),r._uU(4,"*"),r.qZA(),r._uU(5,": "),r.qZA(),r.TgZ(6,"mat-form-field",17),r._UZ(7,"input",31),r.TgZ(8,"mat-error"),r._uU(9,"Unit Price is required"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.ekj("error",e.form.controls.unit_price.invalid&&e.form.controls.unit_price.touched)}}function Dt(e,t){if(1&e&&(r.TgZ(0,"form",8),r.YNc(1,Qt,10,2,"div",9),r.YNc(2,Ft,10,3,"div",9),r.YNc(3,Yt,8,6,"div",9),r.YNc(4,Pt,5,0,"div",9),r.YNc(5,Lt,10,2,"div",9),r.TgZ(6,"div",10),r.TgZ(7,"label",11),r._uU(8,"Accept Points?"),r.qZA(),r.TgZ(9,"mat-checkbox",12),r._uU(10),r.qZA(),r.qZA(),r.TgZ(11,"div",10),r.TgZ(12,"label",13),r._uU(13,"Discount Cap"),r.qZA(),r._UZ(14,"a-counter",14),r.qZA(),r.qZA()),2&e){const e=r.oxw();let t;r.Q6J("formGroup",e.form),r.xp6(1),r.Q6J("ngIf",e.form.controls.name),r.xp6(1),r.Q6J("ngIf",e.form.controls.category),r.xp6(1),r.Q6J("ngIf",e.form.controls.tags),r.xp6(1),r.Q6J("ngIf",e.form.controls.description),r.xp6(1),r.Q6J("ngIf",e.form.controls.unit_price),r.xp6(5),r.Oqu(null!=(t=e.form.get("accept_points"))&&t.value?"No":"Yes"),r.xp6(4),r.Q6J("min",0)("max",100)("step",5)("render_fn",e.renderPercent)}}function St(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"footer",32),r.TgZ(1,"button",33),r.NdJ("click",function(){return r.CHM(e),r.oxw().saveChanges()}),r._uU(2," Save "),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("disabled",!e.form.dirty)}}function $t(e,t){1&e&&(r.TgZ(0,"div",34),r._UZ(1,"mat-spinner",35),r.TgZ(2,"p"),r._uU(3,"Saving catering item..."),r.qZA(),r.qZA())}function Bt(e,t){if(1&e&&(r.TgZ(0,"mat-option",36),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",e," ")}}let Gt=(()=>{class e{constructor(e){this._data=e,this.event=new r.vpe,this.form=new o.cw({name:new o.NI(this.item.name||"",[o.kI.required]),description:new o.NI(this.item.description||""),category:new o.NI(this.item.category||"",[o.kI.required]),unit_price:new o.NI(this.item.unit_price,[o.kI.required]),tags:new o.NI(this.item.tags||[]),accept_points:new o.NI(this.item.accept_points||!1),discount_cap:new o.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[Mt.K5,Mt.OC,Mt.L_]}get item(){return this._data.item||new Ot.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(e=0){return`${e}%`}addTag(e){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const t=e.input,n=e.value,i=this.tag_list;(n||"").trim()&&(i.push(n),this.form.controls.tags.setValue(i)),t&&(t.value="")}removeTag(e){if(!this.form||!this.form.controls.tags)return;const t=this.tag_list;this.form.controls.tags.markAsDirty();const n=t.indexOf(e);n>=0&&(t.splice(n,1),this.form.controls.tags.setValue(t))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new Ot.U(Object.assign(Object.assign(Object.assign({},this.item),{id:this.item.id||`item-${(0,N.Iy)(99999999)}`}),this.form.value))}})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(We.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let e,t;return e=$localize`:@@tagsLabel800ffadd463cfe152c5af3fa9f13803ab2e77b934746186018558508280: Tags: `,t=$localize`:@@zoneTagsPlaceholder8dc7c13b0c6b8ad9c770bce0ad72e14b4aef84563986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],e,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",t,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(e,t){if(1&e&&(r.TgZ(0,"header"),r.TgZ(1,"h3",0),r._uU(2),r.qZA(),r.YNc(3,Nt,3,0,"button",1),r.qZA(),r.YNc(4,Dt,15,11,"form",2),r.YNc(5,St,3,1,"footer",3),r.YNc(6,$t,4,0,"ng-template",null,4,r.W1O),r.TgZ(8,"mat-autocomplete",null,5),r.YNc(10,Bt,2,2,"mat-option",6),r.qZA()),2&e){const e=r.MAs(7);r.xp6(2),r.hij("",t.item.id?"Edit":"Add"," Item"),r.xp6(1),r.Q6J("ngIf",!t.loading),r.xp6(1),r.Q6J("ngIf",t.form&&!t.loading)("ngIfElse",e),r.xp6(1),r.Q6J("ngIf",!t.loading),r.xp6(5),r.Q6J("ngForOf",t.categories)}},directives:[We.uh,i.O5,Ct.XC,i.sg,M.lW,We.ZT,B.o,o._Y,o.JL,o.sg,Ut.oG,o.JJ,o.u,Jt.R,W.KE,k.Nt,o.Fj,W.TO,Ct.ZL,It.qn,It.oH,It.HS,It.qH,o.wV,_e.$g,l.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"]}),e})();var Ht=n(6817),Rt=n(7276);function Vt(e,t){1&e&&(r.TgZ(0,"button",7),r.TgZ(1,"app-icon"),r._uU(2,"close"),r.qZA(),r.qZA())}function zt(e,t){if(1&e&&(r.TgZ(0,"div",10),r.TgZ(1,"label",11),r._uU(2," Name"),r.TgZ(3,"span"),r._uU(4,"*"),r.qZA(),r._uU(5,": "),r.qZA(),r.TgZ(6,"mat-form-field",12),r._UZ(7,"input",13),r.TgZ(8,"mat-error"),r._uU(9,"Name is required"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.ekj("error",e.form.controls.name.invalid&&e.form.controls.name.touched)}}function Wt(e,t){if(1&e&&(r.TgZ(0,"div",10),r.TgZ(1,"label",14),r._uU(2," Type"),r.TgZ(3,"span"),r._uU(4,"*"),r.qZA(),r._uU(5,": "),r.qZA(),r.TgZ(6,"mat-form-field",12),r._UZ(7,"input",15),r.TgZ(8,"mat-error"),r._uU(9,"Type is required"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2),t=r.MAs(9);r.xp6(1),r.ekj("error",e.form.controls.group.invalid&&e.form.controls.group.touched),r.xp6(6),r.Q6J("matAutocomplete",t)}}function Xt(e,t){1&e&&(r.TgZ(0,"div",10),r.TgZ(1,"label",11),r._uU(2,"Unit Price:"),r.qZA(),r.TgZ(3,"mat-form-field",12),r._UZ(4,"input",16),r.qZA(),r.qZA())}function Kt(e,t){1&e&&(r.TgZ(0,"div",10),r.TgZ(1,"mat-checkbox",17),r._uU(2," Can select multiple of type "),r.qZA(),r.qZA())}function en(e,t){if(1&e&&(r.TgZ(0,"form",8),r.YNc(1,zt,10,2,"div",9),r.YNc(2,Wt,10,3,"div",9),r.YNc(3,Xt,5,0,"div",9),r.YNc(4,Kt,3,0,"div",9),r.qZA()),2&e){const e=r.oxw();r.Q6J("formGroup",e.form),r.xp6(1),r.Q6J("ngIf",e.form.controls.name),r.xp6(1),r.Q6J("ngIf",e.form.controls.group),r.xp6(1),r.Q6J("ngIf",e.form.controls.unit_price),r.xp6(1),r.Q6J("ngIf",e.form.controls.multiple)}}function tn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"footer",18),r.TgZ(1,"button",19),r.NdJ("click",function(){return r.CHM(e),r.oxw().saveChanges()}),r._uU(2," Save "),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("disabled",!e.form.dirty)}}function nn(e,t){1&e&&(r.TgZ(0,"div",20),r._UZ(1,"mat-spinner",21),r.TgZ(2,"p"),r._uU(3,"Saving catering item option..."),r.qZA(),r.qZA())}function on(e,t){if(1&e&&(r.TgZ(0,"mat-option",22),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",e," ")}}let sn=(()=>{class e{constructor(e){this._data=e,this.event=new r.vpe,this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}ngOnInit(){this.form=new o.cw({name:new o.NI(this.option.name||"",[o.kI.required]),group:new o.NI(this.option.group||"",[o.kI.required]),unit_price:new o.NI(this.option.unit_price),multiple:new o.NI(!!this.option.multiple,[])})}saveChanges(){this.loading=!0;const e=Object.assign(Object.assign(Object.assign({},this.option),{id:this.option.id||`option-${(0,Rt.Iy)(99999999)}`}),this.form.value);this.event.emit({reason:"done",metadata:{item:new Ot.U(Object.assign(Object.assign({},this._data.parent),{options:this._data.parent.options.filter(t=>t.id!==e.id).concat([e])}))}})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(We.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-none border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(e,t){if(1&e&&(r.TgZ(0,"header"),r.TgZ(1,"h3",0),r._uU(2),r.qZA(),r.YNc(3,Vt,3,0,"button",1),r.qZA(),r.YNc(4,en,5,5,"form",2),r.YNc(5,tn,3,1,"footer",3),r.YNc(6,nn,4,0,"ng-template",null,4,r.W1O),r.TgZ(8,"mat-autocomplete",null,5),r.YNc(10,on,2,2,"mat-option",6),r.qZA()),2&e){const e=r.MAs(7);r.xp6(2),r.hij(" ",t.option.id?"Edit":"Add"," Item Option "),r.xp6(1),r.Q6J("ngIf",!t.loading),r.xp6(1),r.Q6J("ngIf",t.form&&!t.loading)("ngIfElse",e),r.xp6(1),r.Q6J("ngIf",!t.loading),r.xp6(5),r.Q6J("ngForOf",t.types)}},directives:[We.uh,i.O5,Ct.XC,i.sg,M.lW,We.ZT,B.o,o._Y,o.JL,o.sg,W.KE,k.Nt,o.Fj,o.JJ,o.u,W.TO,Ct.ZL,o.wV,Ut.oG,_e.$g,l.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"]}),e})();var an=n(7968),rn=n(8774),ln=n(9310),cn=n(391),un=n(5109),dn=n(6828);function gn(e,t){1&e&&(r.TgZ(0,"div",17),r._uU(1," Options Available "),r.qZA())}function pn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"a-counter",18),r.NdJ("ngModelChange",function(t){r.CHM(e);const n=r.oxw().$implicit;return r.oxw(5).updateItemQuantity(n,t)}),r.qZA()}if(2&e){const e=r.oxw().$implicit;r.Q6J("ngModel",e.quantity)}}function mn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",19),r.TgZ(1,"div",20),r.TgZ(2,"button",21),r.TgZ(3,"app-icon"),r._uU(4,"remove"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(5,"div",22),r._uU(6),r.qZA(),r.TgZ(7,"button",23),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw(5).addItem(t)}),r.TgZ(8,"app-icon"),r._uU(9,"add"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw().$implicit;r.xp6(1),r.Q6J("matTooltip",e.quantity?"Items with options must be removed from order confirmation page":""),r.xp6(1),r.Q6J("disabled",!0),r.xp6(4),r.hij(" ",e.quantity," ")}}function fn(e,t){if(1&e&&(r.TgZ(0,"div",11),r.TgZ(1,"div",12),r.TgZ(2,"div",12),r._uU(3),r.qZA(),r.YNc(4,gn,2,0,"div",13),r.qZA(),r.TgZ(5,"div",14),r._uU(6),r.ALo(7,"currency"),r.qZA(),r.YNc(8,pn,1,1,"a-counter",15),r.YNc(9,mn,10,3,"div",16),r.qZA()),2&e){const e=t.$implicit;r.xp6(3),r.hij(" ",e.name," "),r.xp6(1),r.Q6J("ngIf",e.options.length),r.xp6(2),r.hij(" ",r.lcZ(7,5,e.unit_price/100)," "),r.xp6(2),r.Q6J("ngIf",!e.options.length),r.xp6(1),r.Q6J("ngIf",e.options.length)}}const hn=function(){return{}};function Zn(e,t){if(1&e&&(r.TgZ(0,"mat-tab",8),r.TgZ(1,"div",9),r.YNc(2,fn,10,7,"div",10),r.qZA(),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.Q6J("label",e),r.xp6(2),r.Q6J("ngForOf",(t.menu_items||r.DdM(2,hn))[e])}}function _n(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Zn,3,3,"mat-tab",7),r.BQk()),2&e){const e=t.$implicit,n=r.oxw(3);r.xp6(1),r.Q6J("ngIf",(n.menu_items||r.DdM(1,hn))[e].length)}}function vn(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"mat-tab-group"),r.YNc(2,_n,2,2,"ng-container",6),r.qZA(),r.BQk()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngForOf",e.categories)}}function xn(e,t){if(1&e&&(r.TgZ(0,"div",4),r.YNc(1,vn,3,1,"ng-container",5),r.qZA()),2&e){const e=r.oxw(),t=r.MAs(5);r.xp6(1),r.Q6J("ngIf",!e.show_order_details)("ngIfElse",t)}}function bn(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"button",26),r._uU(2," Cancel "),r.qZA(),r.TgZ(3,"button",27),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).show_order_details=!0}),r._uU(4," Confirm "),r.qZA(),r.BQk()}if(2&e){const e=r.oxw(2);r.xp6(3),r.Q6J("disabled",!e.order.item_count)("matBadge",e.order.item_count)("matBadgeHidden",!e.order.item_count)}}function wn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",28),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).show_order_details=!1}),r._uU(1," Back "),r.qZA(),r.TgZ(2,"button",29),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).saveOrder()}),r._uU(3," Save Order "),r.qZA()}}function An(e,t){if(1&e&&(r.TgZ(0,"footer",24),r.YNc(1,bn,5,3,"ng-container",5),r.YNc(2,wn,4,0,"ng-template",null,25,r.W1O),r.qZA()),2&e){const e=r.MAs(3),t=r.oxw();r.xp6(1),r.Q6J("ngIf",!t.show_order_details)("ngIfElse",e)}}function Tn(e,t){if(1&e&&(r.TgZ(0,"div",30),r._UZ(1,"mat-spinner",31),r.TgZ(2,"p"),r._uU(3),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(3),r.Oqu(e.loading)}}function yn(e,t){if(1&e&&(r.TgZ(0,"div",37),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(2);r.Q6J("matTooltip",t.optionsFor(e)),r.xp6(1),r.AsE(" ",e.options.length," option",1===e.options.length?"":"s"," selected ")}}function qn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",34),r.TgZ(1,"div",12),r.TgZ(2,"div",12),r._uU(3),r.qZA(),r.YNc(4,yn,2,3,"div",35),r.qZA(),r.TgZ(5,"div",14),r._uU(6),r.ALo(7,"currency"),r.qZA(),r.TgZ(8,"a-counter",36),r.NdJ("ngModelChange",function(t){const n=r.CHM(e).$implicit;return r.oxw(2).updateItemQuantity(n,t)}),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit;r.xp6(3),r.Oqu(e.name),r.xp6(1),r.Q6J("ngIf",e.options.length),r.xp6(2),r.hij(" ",r.lcZ(7,4,e.total_cost/100)," "),r.xp6(2),r.Q6J("ngModel",e.quantity)}}function kn(e,t){if(1&e&&(r.TgZ(0,"header",32),r.TgZ(1,"h3"),r._uU(2,"Confirm Order"),r.qZA(),r.qZA(),r.TgZ(3,"div",9),r.YNc(4,qn,9,6,"div",33),r.qZA()),2&e){const e=r.oxw();r.xp6(4),r.Q6J("ngForOf",e.order.items)}}function Mn(e,t,n){var i;let o=!0;for(const s of t)if(e.category===s.name||e.tags.includes(s.name)||(null===(i=n.space)||void 0===i?void 0:i.zones.includes(s.name))||"*"===s.name){let e=0;for(const t of s.rules){const i=new Date(n.date);switch(t[0]){case"after_hour":e+=(0,rn.Z)(i,(0,Ne.Z)(i,t[1]))?1:0;break;case"before_hour":e+=(0,ln.Z)(i,(0,Ne.Z)(i,t[1]))?1:0;break;case"min_length":e+=n.duration>=(0,cn.H1)(t[1])?1:0;break;case"max_length":e+=n.duration<=(0,cn.H1)(t[1])?1:0;break;case"visitor_type":e+=n.ext("visitor_type")===t[1]?1:0;break;default:e++}}o=e>=s.rules.length}return o}let On=(()=>{class e extends N.KG{constructor(e){super(),this._data=e,this.event=new r.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var e,t,n;return(0,I.mG)(this,void 0,void 0,function*(){this.loading="Loading menu...",this.order=new an.G(this._data.order),this.rules=yield this._data.getCateringConfig(null===(n=null===(t=null===(e=this.order.event)||void 0===e?void 0:e.space)||void 0===t?void 0:t.level)||void 0===n?void 0:n.parent_id),this._data.menu.subscribe(e=>{this.loading="Loading menu...";const t=(0,N.Tw)(e.map(e=>e.category)),n={};for(const i of t)n[i]=e.filter(e=>e.category===i&&Mn(e,this.rules,this.order.event));this.categories=t,this.menu_items=n,this.updateMenuQuantities(),this.timeout("clear_loading",()=>this.loading="",1e3)})})}addItem(e,t=!0){var n;const i=this.order.items.find(t=>t.id===e.id&&t.options.length===t.options.reduce((t,n)=>t+(e.options.find(e=>n.id===e.id)?1:0),0));t&&(null===(n=e.options)||void 0===n?void 0:n.length)?this._data.selectOptions(e.options).then(t=>{const n=new Ot.U(Object.assign(Object.assign({},e),{options:t}));this.addItem(n,!1)}):this.order=new an.G(Object.assign(Object.assign({},this.order),i?{items:this.order.items.filter(t=>!(t.id===e.id&&t.options_string===e.options_string)).concat([new Ot.U(Object.assign(Object.assign({},e),{quantity:i.quantity+1}))])}:{items:this.order.items.concat([new Ot.U(Object.assign(Object.assign({},e),{quantity:1}))])})),this.updateMenuQuantities()}removeItem(e){this.order=new an.G(Object.assign(Object.assign({},this.order),{items:this.order.items.filter(t=>t.id!==e.id&&t.options_string===e.options_string)})),this.updateMenuQuantities()}updateItemQuantity(e,t){const n=this.order.items.find(t=>t.id===e.id&&t.options_string===e.options_string);let i=[...this.order.items];i=n?this.order.items.filter(t=>!(t.id===e.id&&t.options_string===e.options_string)).concat([new Ot.U(Object.assign(Object.assign({},e),{quantity:t}))]):this.order.items.concat([new Ot.U(Object.assign(Object.assign({},e),{quantity:t}))]),i.sort((e,t)=>e.name.localeCompare(t.name)),this.order=new an.G(Object.assign(Object.assign({},this.order),{items:i})),this.updateMenuQuantities()}updateMenuQuantities(){for(const e in this.menu_items)for(const t of this.menu_items[e])t.quantity=this.order.items.reduce((e,n)=>n.id===t.id?e+n.quantity:e,0)}optionsFor(e){return e.options.map(e=>e.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(We.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[r.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(e,t){if(1&e&&(r.YNc(0,xn,2,2,"div",0),r.YNc(1,An,4,2,"footer",1),r.YNc(2,Tn,4,1,"ng-template",null,2,r.W1O),r.YNc(4,kn,5,1,"ng-template",null,3,r.W1O)),2&e){const e=r.MAs(3);r.Q6J("ngIf",!t.loading)("ngIfElse",e),r.xp6(1),r.Q6J("ngIf",!t.loading)}},directives:[i.O5,un.SP,i.sg,un.uX,Jt.R,o.Fj,o.JJ,o.On,dn.gM,M.lW,B.o,We.ZT,_e.$g],pipes:[i.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border-radius:0!important;border:1px solid #ccc;border-right:none;border-left:none;outline:none;font-size:1em;&:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}&.error::placeholder{color:rgba(var(--error),.45)}}"]}),e})();var Cn=n(4810);function Un(e,t){if(1&e&&(r.TgZ(0,"div",18),r._uU(1),r.ALo(2,"currency"),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" +",r.lcZ(2,1,e.unit_price/100)," ")}}function Jn(e,t){if(1&e&&(r.TgZ(0,"mat-radio-button",14),r.TgZ(1,"div",15),r.TgZ(2,"div",16),r._uU(3),r.qZA(),r.YNc(4,Un,3,3,"div",17),r.qZA(),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.id),r.xp6(3),r.hij(" ",e.name," "),r.xp6(1),r.Q6J("ngIf",e.unit_price)}}function In(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"mat-radio-group",10),r.NdJ("ngModelChange",function(t){r.CHM(e);const n=r.oxw().$implicit;return r.oxw().updateGroupOption(n,t)}),r.TgZ(2,"mat-radio-button",11),r.TgZ(3,"span",12),r._uU(4,"None"),r.qZA(),r.qZA(),r.YNc(5,Jn,5,3,"mat-radio-button",13),r.qZA(),r.BQk()}if(2&e){const e=r.oxw().$implicit;r.xp6(5),r.Q6J("ngForOf",null==e?null:e.options)}}function Nn(e,t){if(1&e&&(r.TgZ(0,"div",18),r._uU(1),r.ALo(2,"currency"),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" +",r.lcZ(2,1,e.unit_price/100)," ")}}function Qn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",20),r.NdJ("ngModelChange",function(t){const n=r.CHM(e).$implicit;return r.oxw(3).option_state[n.id]=t}),r.TgZ(1,"div",15),r.TgZ(2,"div",16),r._uU(3),r.qZA(),r.YNc(4,Nn,3,3,"div",17),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,n=r.oxw(3);r.Q6J("ngModel",n.option_state[e.id]),r.xp6(3),r.hij(" ",e.name," "),r.xp6(1),r.Q6J("ngIf",e.unit_price)}}function Fn(e,t){if(1&e&&r.YNc(0,Qn,5,3,"mat-checkbox",19),2&e){const e=r.oxw().$implicit;r.Q6J("ngForOf",null==e?null:e.options)}}function jn(e,t){if(1&e&&(r.TgZ(0,"div",5),r.TgZ(1,"div",6),r._uU(2),r.qZA(),r.TgZ(3,"div",7),r.YNc(4,In,6,1,"ng-container",8),r.YNc(5,Fn,1,1,"ng-template",null,9,r.W1O),r.qZA(),r.qZA()),2&e){const e=t.$implicit,n=r.MAs(6);r.uIk("group",e.name),r.xp6(2),r.Oqu(e.name),r.xp6(2),r.Q6J("ngIf",!e.multiple)("ngIfElse",n)}}let En=(()=>{class e{constructor(e){this._data=e,this.event=new r.vpe,this.option_state={};const t=(0,Rt.Tw)(this._data.options.map(e=>e.group||"Other")),n=[];for(const i of t){const e=this._data.options.filter(e=>e.group===i);n.push({name:i,multiple:!!e.find(e=>e.multiple),options:e})}this.groups=n}updateGroupOption(e,t){for(const n of e.options)this.option_state[n.id]=n.id===t}saveOptions(){const e=this._data.options.filter(e=>this.option_state[e.id]);this.event.emit({reason:"done",metadata:{options:e}})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(We.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(r.TgZ(0,"header"),r.TgZ(1,"h3"),r._uU(2,"Select options"),r.qZA(),r.TgZ(3,"button",0),r.TgZ(4,"app-icon"),r._uU(5,"close"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"main",1),r.YNc(7,jn,7,4,"div",2),r.qZA(),r.TgZ(8,"footer",3),r.TgZ(9,"button",4),r.NdJ("click",function(){return t.saveOptions()}),r._uU(10," Save "),r.qZA(),r.qZA()),2&e&&(r.xp6(7),r.Q6J("ngForOf",t.groups))},directives:[M.lW,We.ZT,B.o,i.sg,i.O5,Cn.VQ,o.JJ,o.On,Cn.U0,Ut.oG],pipes:[i.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}"]}),e})();function Yn(e,t){1&e&&(r.TgZ(0,"button",4),r.TgZ(1,"app-icon"),r._uU(2,"close"),r.qZA(),r.qZA())}function Pn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"main"),r.TgZ(1,"div",5),r.TgZ(2,"app-icon",6),r._uU(3,"upload"),r.qZA(),r.TgZ(4,"p"),r._uU(5,"Click to select file or Drag and drop files"),r.qZA(),r.TgZ(6,"input",7),r.NdJ("change",function(t){return r.CHM(e),r.oxw().handleFileEvent(t)}),r.qZA(),r.qZA(),r.TgZ(7,"div",8),r.TgZ(8,"button",9),r.NdJ("click",function(){return r.CHM(e),r.oxw().downloadTemplate()}),r._uU(9," Download Template "),r.qZA(),r.qZA(),r.qZA()}}function Ln(e,t){if(1&e&&(r.TgZ(0,"main",10),r._UZ(1,"mat-spinner",11),r.TgZ(2,"p"),r._uU(3),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(3),r.Oqu(e.loading)}}let Dn=(()=>{class e{constructor(){this.event=new r.vpe}handleFileEvent(e){this.loading="Processing menu data...";const t=e.target;if(!(null==t?void 0:t.files))return this.loading="";const n=t.files;if(!n.length)return this.loading="";const i=n[0],o=new FileReader;o.addEventListener("loadend",e=>{const t=(0,N.n5)(e.target.result);this.loading="",this.event.emit({reason:"done",metadata:t.filter(e=>"item"===(e.type||"").toLowerCase()).map(e=>new Ot.U(Object.assign(Object.assign({},e),{options:t.filter(t=>"option"===(t.type||"").toLowerCase()&&t.tags===e.id).map(e=>({id:e.id,name:e.name,group:e.category,multiple:e.multiple,unit_price:e.unit_price}))})))})}),o.readAsText(i)}downloadTemplate(){(0,N.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["mat-button","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(e,t){if(1&e&&(r.TgZ(0,"header",0),r.TgZ(1,"h2"),r._uU(2,"Import Catering Menu"),r.qZA(),r.YNc(3,Yn,3,0,"button",1),r.qZA(),r.YNc(4,Pn,10,0,"main",2),r.YNc(5,Ln,4,1,"ng-template",null,3,r.W1O)),2&e){const e=r.MAs(6);r.xp6(3),r.Q6J("ngIf",!t.loading),r.xp6(1),r.Q6J("ngIf",!t.loading)("ngIfElse",e)}},directives:[i.O5,M.lW,We.ZT,B.o,_e.$g],styles:[""]}),e})(),Sn=(()=>{class e extends N.KG{constructor(e,t){super(),this._org=e,this._dialog=t,this._menu=new P.X([]),this._loading=new P.X(!1),this._currency=new P.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(e=>(0,I.mG)(this,void 0,void 0,function*(){if(e){const t=(yield this.getCateringForZone(e.id)).map(e=>new Ot.U(e));this._currency.next(e.currency||"USD"),this._menu.next(t)}})))}get categories(){const e=this._menu.getValue();return(0,N.Tw)(e.map(e=>e.category))}manageCateringOrder(e){var t;return(0,I.mG)(this,void 0,void 0,function*(){const n=this._dialog.open(On,{data:{order:e,menu:this.menu,loading:this.loading,getCateringConfig:e=>this.getCateringConfig(e),selectOptions:e=>this.selectOptions(e)}}),i=yield Promise.race([n.componentInstance.event.pipe((0,Q.P)(e=>"done"===e.reason)).toPromise(),n.afterClosed().toPromise()]);return n.close(),(null===(t=null==i?void 0:i.metadata)||void 0===t?void 0:t.order)||e})}addItem(e=new Ot.U){return(0,I.mG)(this,void 0,void 0,function*(){const t=this._dialog.open(Gt,{data:{item:e,categories:this.categories}}),n=yield Promise.race([t.componentInstance.event.pipe((0,Q.P)(e=>"done"===e.reason)).toPromise(),t.afterClosed().toPromise()]);if("done"!==(null==n?void 0:n.reason))return;const i=this._menu.getValue(),o=i.findIndex(t=>t.id===e.id);o>=0?i.splice(o,1,n.metadata.item):i.push(n.metadata.item),this.updateMenu(this._org.building.id,i).then(()=>{this._menu.next([...i]),t.close()},()=>t.componentInstance.loading=!1)})}addOption(e,t={}){return(0,I.mG)(this,void 0,void 0,function*(){const n=(0,N.Tw)(e.options.map(e=>e.group)),i=this._dialog.open(sn,{data:{parent:e,option:t,types:n}}),o=yield Promise.race([i.componentInstance.event.pipe((0,Q.P)(e=>"done"===e.reason)).toPromise(),i.afterClosed().toPromise()]);if("done"!==(null==o?void 0:o.reason))return;const s=this._menu.getValue(),a=s.findIndex(t=>t.id===e.id);a>=0?s.splice(a,1,o.metadata.item):s.push(o.metadata.item),this.updateMenu(this._org.building.id,s).then(()=>{this._menu.next([...s]),i.close()},()=>i.componentInstance.loading=!1)})}selectOptions(e){return(0,I.mG)(this,void 0,void 0,function*(){const t=this._dialog.open(En,{data:{options:e}}),n=yield Promise.race([t.componentInstance.event.pipe((0,Q.P)(e=>"done"===e.reason)).toPromise(),t.afterClosed().toPromise()]);return"done"!==(null==n?void 0:n.reason)?[]:(t.close(),n.metadata.options)})}deleteItem(e){return(0,I.mG)(this,void 0,void 0,function*(){const t=yield(0,N._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${e.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==t.reason)return;t.loading("Removing catering item...");const n=this._menu.getValue().filter(t=>e.id!==t.id);this.updateMenu(this._org.building.id,n).then(()=>{this._menu.next([...n]),t.close()},()=>t.loading(""))})}deleteOption(e,t){return(0,I.mG)(this,void 0,void 0,function*(){const n=yield(0,N._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${t.name}" from "${e.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==n.reason)return;n.loading("Removing catering item option...");const i=this._menu.getValue();i.splice(i.findIndex(t=>t.id===e.id),1,new Ot.U(Object.assign(Object.assign({},e),{options:e.options.filter(e=>e.id!==t.id)}))),this.updateMenu(this._org.building.id,i).then(()=>{this._menu.next([...i]),n.close()},()=>n.loading(""))})}editConfig(){return(0,I.mG)(this,void 0,void 0,function*(){const e=yield this.getCateringConfig(this._org.building.id),t=this._menu.getValue(),n=(0,N.Tw)((0,N.xH)(t.map(e=>[e.category,...e.tags]))),i=this._dialog.open(kt,{data:{config:e,types:n}}),o=yield Promise.race([i.componentInstance.event.pipe((0,Q.P)(e=>"done"===e.reason)).toPromise(),i.afterClosed().toPromise()]);"done"===(null==o?void 0:o.reason)&&this.updateConfig(this._org.building.id,o.metadata).then(()=>i.close(),()=>i.componentInstance.loading=!1)})}importMenu(){return(0,I.mG)(this,void 0,void 0,function*(){const e=this._dialog.open(Dn),t=yield Promise.race([e.componentInstance.event.pipe((0,Q.P)(e=>"done"===e.reason)).toPromise(),e.afterClosed().toPromise()]);if("done"!==(null==t?void 0:t.reason))return;e.componentInstance.loading="Updating menu...";const n=this._menu.getValue(),i=this._org.building,o=(0,N.Tw)(t.metadata.concat(n),"id");yield this.updateMenu(i.id,o).catch(t=>{throw(0,N.cB)("Error importing catering menu"),e.close(),t}),(0,N.t5)(`Successfully imported catering menu. ${t.metadata.length} item(s) added.`),e.close()})}updateMenu(e,t){return(0,Ht.Ymr)(e,{id:e,name:"catering",details:t,description:`Catering menu for ${e}`}).toPromise()}getCateringForZone(e){return(0,I.mG)(this,void 0,void 0,function*(){const t=(yield(0,Ht.rlq)(e,{name:"catering"}).toPromise()).details;return t instanceof Array?t:[]})}getCateringConfig(e=this._org.building.id){return(0,I.mG)(this,void 0,void 0,function*(){const t=(yield(0,Ht.rlq)(e,{name:"catering_config"}).toPromise()).details;return t instanceof Array?t:[]})}updateConfig(e,t){return(0,Ht.Ymr)(e,{id:e,name:"catering_config",details:t,description:`Catering menu config for ${e}`}).toPromise()}addItemToOrder(e,t){let n=e.items;const i=n.find(e=>{var n,i;return e.id===t.id&&(null===(n=t.options)||void 0===n?void 0:n.length)===(null===(i=e.options)||void 0===i?void 0:i.reduce((e,n)=>e+(t.options.find(e=>n.id===e.id)?1:0),0))});return i?i.quantity+=1:n=n.concat([new Ot.U(Object.assign(Object.assign({},t),{quantity:1}))]),new an.G(Object.assign(Object.assign({},e),{items:n,event:null}))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(j.w7),r.LFG(We.uw))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function $n(e,t){1&e&&(r.TgZ(0,"div",20),r._uU(1," Add catering "),r.qZA())}function Bn(e,t){if(1&e&&(r.TgZ(0,"div",21),r.TgZ(1,"div",22),r._uU(2),r.qZA(),r.TgZ(3,"div",23),r._uU(4),r.ALo(5,"currency"),r.qZA(),r.qZA()),2&e){const e=r.oxw(3);r.xp6(2),r.hij(" ",null==e.form?null:e.form.value.catering[0].item_count," item(s) "),r.xp6(2),r.hij(" ",r.lcZ(5,2,(null==e.form?null:e.form.value.catering[0].total_cost)/100)," ")}}function Gn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",16),r.TgZ(1,"label"),r._uU(2,"Catering"),r.qZA(),r.TgZ(3,"an-action-field",17),r.NdJ("onAction",function(){return r.CHM(e),r.oxw(2).editCatering()}),r.YNc(4,$n,2,0,"div",18),r.YNc(5,Bn,6,4,"div",19),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(4),r.Q6J("ngIf",!(null!=e.form&&null!=e.form.value.catering&&e.form.value.catering.length)),r.xp6(1),r.Q6J("ngIf",null==e.form||null==e.form.value.catering?null:e.form.value.catering.length)}}function Hn(e,t){if(1&e&&(r.TgZ(0,"form",1),r.TgZ(1,"section",2),r.TgZ(2,"div",3),r.TgZ(3,"div",4),r.TgZ(4,"label"),r._uU(5,"Date"),r.qZA(),r.TgZ(6,"a-date-field",5),r._uU(7," Date and time must be in the future "),r.qZA(),r.qZA(),r.TgZ(8,"div",4),r.TgZ(9,"label"),r._uU(10,"Start Time"),r.qZA(),r._UZ(11,"a-time-field",5),r.qZA(),r.TgZ(12,"div",4),r.TgZ(13,"label"),r._uU(14,"End Time"),r.qZA(),r._UZ(15,"a-duration-field",6),r.qZA(),r.qZA(),r.qZA(),r.TgZ(16,"section",2),r.TgZ(17,"div",7),r.TgZ(18,"label"),r._uU(19,"Attendees"),r.qZA(),r._UZ(20,"a-user-list-field",8),r.qZA(),r.qZA(),r.TgZ(21,"section",2),r.TgZ(22,"div",9),r.TgZ(23,"div",10),r.TgZ(24,"label"),r._uU(25,"Meeting Subject "),r.TgZ(26,"span"),r._uU(27,"*"),r.qZA(),r.qZA(),r.TgZ(28,"mat-form-field",11),r._UZ(29,"input",12),r.TgZ(30,"mat-error"),r._uU(31,"Meeting Subject is required"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(32,"div",13),r.TgZ(33,"label"),r._uU(34,"Notes"),r.qZA(),r.TgZ(35,"mat-form-field",11),r._UZ(36,"textarea",14),r.qZA(),r.qZA(),r.YNc(37,Gn,6,2,"div",15),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw();let t;r.Q6J("formGroup",e.form),r.xp6(15),r.Q6J("time",null==(t=e.form.get("date"))?null:t.value),r.xp6(5),r.Q6J("hideActions",e.hide_actions),r.xp6(17),r.Q6J("ngIf",e.has_catering)}}n(4689),n(4019),n(8303),n(4914),n(205),n(3499),n(9005);let Rn=(()=>{class e{constructor(e,t){this._catering=e,this._settings=t,this.editCatering=()=>(0,I.mG)(this,void 0,void 0,function*(){return this.form.patchValue({catering:[yield this._catering.manageCateringOrder((this.form.value.catering?this.form.value.catering[0]:null)||new an.G)]})})}get has_catering(){return!!this._settings.get("app.rooms.has_catering")}get hide_actions(){return!!this._settings.get("app.booking.hide_user_actions")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Sn),r.Y36(N.gb))},e.\u0275cmp=r.Xpm({type:e,selectors:[["detailed-book-space-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"mb-4","border-b","border-gray-300"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],["formControlName","date"],["formControlName","duration",3,"time"],[1,"flex","flex-col","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["formControlName","attendees",3,"hideActions"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col"],["appearance","outline"],["matInput","","formControlName","title","placeholder","Meeting title"],[1,"flex","flex-col","resize-y"],["matInput","","formControlName","body","placeholder","Add meeting notes here..."],["class","flex flex-col mb-4",4,"ngIf"],[1,"flex","flex-col","mb-4"],[3,"onAction"],["class","opacity-40",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"opacity-40"],[1,"flex","items-center"],[1,"flex-1","w-1/2"],[1,"text-xs","opacity-60","px-4"]],template:function(e,t){1&e&&r.YNc(0,Hn,38,4,"form",0),2&e&&r.Q6J("ngIf",t.form)},directives:[i.O5,o._Y,o.JL,o.sg,z.Q,o.JJ,o.u,K.N,ee.B,te.E,W.KE,k.Nt,o.Fj,W.TO,G.s],pipes:[i.H9],styles:[""]}),e})();function Vn(e,t){if(1&e&&(r.TgZ(0,"mat-option",21),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.value),r.xp6(1),r.hij(" ",e.name," ")}}function zn(e,t){if(1&e&&(r.TgZ(0,"mat-option",21),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.value),r.xp6(1),r.hij(" ",e.name," ")}}function Wn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"section",12),r.TgZ(1,"div",13),r.TgZ(2,"h2",14),r._uU(3," Quick Book Space "),r.qZA(),r.TgZ(4,"div",15),r.TgZ(5,"mat-form-field",16),r.TgZ(6,"mat-select",17),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().time=t}),r.YNc(7,Vn,2,2,"mat-option",18),r.qZA(),r.qZA(),r.TgZ(8,"mat-form-field",16),r.TgZ(9,"mat-select",19),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().capacity=t}),r.YNc(10,zn,2,2,"mat-option",18),r.qZA(),r.qZA(),r.TgZ(11,"button",20),r.NdJ("click",function(){return r.CHM(e),r.oxw().quickBook()}),r.TgZ(12,"div",7),r.TgZ(13,"app-icon",8),r._uU(14,"search"),r.qZA(),r.TgZ(15,"span",9),r._uU(16,"Find Space"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(6),r.Q6J("ngModel",e.time),r.xp6(1),r.Q6J("ngForOf",e.quick_times),r.xp6(2),r.Q6J("ngModel",e.capacity),r.xp6(1),r.Q6J("ngForOf",e.quick_capacities)}}function Xn(e,t){1&e&&(r.TgZ(0,"section",22),r.TgZ(1,"div",23),r.TgZ(2,"h2",24),r._uU(3,"OR"),r.qZA(),r.qZA(),r.qZA())}let Kn=(()=>{class e{constructor(e,t){this._state=e,this._router=t,this.time=0,this.capacity=0,this.quick_times=[{name:"Now",value:0},{name:"Later Today",value:120},{name:"Tomorrow",value:(0,Ne.Z)((0,V.Z)(new Date,1),9).valueOf()}],this.quick_capacities=[{name:"Any Capacity",value:0},{name:"Small (1 - 4)",value:1},{name:"Medium (5 - 12)",value:5},{name:"Large (13 - 32)",value:13},{name:"Huge (32+)",value:33}],this.clearForm=()=>{this.time=this.capacity=0,this._state.clearForm()}}get is_edit(){var e,t;return!!(null===(t=null===(e=this.form)||void 0===e?void 0:e.get("id"))||void 0===t?void 0:t.value)}get form(){return this._state.form}quickBook(){this.form.patchValue({date:(this.time<1440?(0,Qe.Z)((0,Fe.Z)(new Date,{nearestTo:5}),this.time):(0,Ne.Z)((0,V.Z)(new Date,1),8)).valueOf(),title:"Ad-hoc Meeting"}),this._state.setOptions({capacity:this.capacity}),this._router.navigate(["/book","spaces","find"])}findSpace(){this.form.markAllAsTouched(),this.form.valid&&this._router.navigate(["/book","spaces","find"])}confirmBooking(){this.form.markAllAsTouched(),this.form.valid&&this._router.navigate(["/book","spaces","confirm"])}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ge.MH),r.Y36(w.F0))},e.\u0275cmp=r.Xpm({type:e,selectors:[["space-flow-form"]],decls:25,vars:7,consts:[["quick","","class","text-white",4,"ngIf"],["class","bg-gray-300",4,"ngIf"],["form","",1,"flex-1","min-h-[50%]"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[3,"form"],[1,"flex","flex-col","sm:flex-row","items-center","justify-center","space-x-0","space-y-2","sm:space-y-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],["mat-button","","clear","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]","inverse",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"ml-2","mx-4"],["mat-button","","find-space","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"],["mat-button","","standalone","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"],["quick","",1,"text-white"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","pb-2"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2"],["overlay","","appearance","outline",1,"sm:flex-2","h-[3.25rem]"],["name","time","placeholder","Now",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","capacity","placeholder","Any Capacity",3,"ngModel","ngModelChange"],["mat-button","",1,"sm:flex-1","h-[2.75rem]","mt-1","mb-2",3,"click"],[3,"value"],[1,"bg-gray-300"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"text-xl","uppercase","font-medium","my-4"]],template:function(e,t){1&e&&(r.YNc(0,Wn,17,4,"section",0),r.YNc(1,Xn,4,0,"section",1),r.TgZ(2,"section",2),r.TgZ(3,"h2",3),r._uU(4),r.qZA(),r._UZ(5,"detailed-book-space-form",4),r.TgZ(6,"div",5),r.TgZ(7,"button",6),r.NdJ("click",function(){return t.clearForm()}),r.TgZ(8,"div",7),r.TgZ(9,"app-icon",8),r._uU(10,"clear"),r.qZA(),r.TgZ(11,"span",9),r._uU(12),r.qZA(),r.qZA(),r.qZA(),r.TgZ(13,"button",10),r.NdJ("click",function(){return t.findSpace()}),r.TgZ(14,"div",7),r.TgZ(15,"app-icon",8),r._uU(16,"search"),r.qZA(),r.TgZ(17,"span",9),r._uU(18),r.qZA(),r.qZA(),r.qZA(),r.TgZ(19,"button",11),r.NdJ("click",function(){return t.confirmBooking()}),r.TgZ(20,"div",7),r.TgZ(21,"app-icon",8),r._uU(22,"event_available"),r.qZA(),r.TgZ(23,"span",9),r._uU(24),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Q6J("ngIf",!t.is_edit),r.xp6(1),r.Q6J("ngIf",!t.is_edit),r.xp6(3),r.hij(" ",t.is_edit?"Edit":"Detailed"," Booking "),r.xp6(1),r.Q6J("form",t.form),r.xp6(7),r.Oqu(t.is_edit?"Cancel Edit":"Clear Form"),r.xp6(6),r.Oqu(t.is_edit?"Update Spaces":"Find Space"),r.xp6(6),r.Oqu(t.is_edit?"Confirm changes":"Book without Space"))},directives:[i.O5,Rn,M.lW,B.o,W.KE,X.gD,o.JJ,o.On,i.sg,l.ey],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;overflow:auto}[quick][_ngcontent-%COMP%]{background-color:#007ac8}"]}),e})();function ei(e,t){1&e&&(r.ynx(0),r._UZ(1,"space-flow-find"),r.BQk())}function ti(e,t){1&e&&(r.ynx(0),r._UZ(1,"space-flow-confirm"),r.BQk())}function ni(e,t){if(1&e&&(r.ynx(0),r._UZ(1,"flow-success",4),r.BQk()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("calendar",null==e.last_success?null:e.last_success.host)}}function ii(e,t){1&e&&(r.ynx(0),r._UZ(1,"space-flow-form"),r.BQk())}let oi=(()=>{class e extends N.KG{constructor(e,t){super(),this._state=e,this._route=t}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.loadForm(),this._state.form||this._state.newForm(),this.subscription("route.params",this._route.paramMap.subscribe(e=>{e.has("step")&&this._state.setView(e.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(e=>{e.has("success")&&this._state.setView(e.get("success"))}))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ge.MH),r.Y36(w.gz))},e.\u0275cmp=r.Xpm({type:e,selectors:[["placeos-book-space-flow"]],features:[r.qOj],decls:6,vars:4,consts:[[1,"bg-white","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"calendar"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.ynx(1,1),r.YNc(2,ei,2,0,"ng-container",2),r.YNc(3,ti,2,0,"ng-container",2),r.YNc(4,ni,2,1,"ng-container",2),r.YNc(5,ii,2,0,"ng-container",3),r.BQk(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngSwitch",t.view),r.xp6(1),r.Q6J("ngSwitchCase","find"),r.xp6(1),r.Q6J("ngSwitchCase","confirm"),r.xp6(1),r.Q6J("ngSwitchCase","success"))},directives:[i.RF,i.n9,i.ED,pt,bt,Ie,Kn],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]}),e})();var si=n(1781);const ai=[{path:"",component:y,children:[{path:"code",component:J},{path:"desks",redirectTo:"desks/form"},{path:"desks/:step",component:Be},{path:"spaces",redirectTo:"spaces/form"},{path:"spaces/:step",component:oi},{path:"*",redirectTo:"spaces/form"}]},{path:"*",redirectTo:"spaces/form"}];let ri=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[i.ez,si.v,o.u5,o.UX,b,w.Bz.forChild(ai)]]}),e})()}}]);
//# sourceMappingURL=apps_workplace_src_app_book_book_module_ts.js.map