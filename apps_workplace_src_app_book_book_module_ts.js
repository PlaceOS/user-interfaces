"use strict";(self.webpackChunkworkplace=self.webpackChunkworkplace||[]).push([["apps_workplace_src_app_book_book_module_ts"],{4249:(Fa,Ze,p)=>{p.r(Ze),p.d(Ze,{BookModule:()=>ka});var u=p(4666),m=p(2508),st=p(4218),j=p(8971),lt=p(1755),t=p(9676),T=p(207);
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */const rt=["button"],ct=["*"],Te=new t.OlP("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS"),ye=new t.OlP("MatButtonToggleGroup"),pt={provide:m.JU,useExisting:(0,t.Gpc)(()=>Ae),multi:!0};let Me=0;class ke{constructor(s,n){this.source=s,this.value=n}}let Ae=(()=>{class o{constructor(n,i){this._changeDetector=n,this._vertical=!1,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name="mat-button-toggle-group-"+Me++,this.valueChange=new t.vpe,this.change=new t.vpe,this.appearance=i&&i.appearance?i.appearance:"standard"}get name(){return this._name}set name(n){this._name=n,this._buttonToggles&&this._buttonToggles.forEach(i=>{i.name=this._name,i._markForCheck()})}get vertical(){return this._vertical}set vertical(n){this._vertical=(0,j.Ig)(n)}get value(){const n=this._selectionModel?this._selectionModel.selected:[];return this.multiple?n.map(i=>i.value):n[0]?n[0].value:void 0}set value(n){this._setSelectionByValue(n),this.valueChange.emit(this.value)}get selected(){const n=this._selectionModel?this._selectionModel.selected:[];return this.multiple?n:n[0]||null}get multiple(){return this._multiple}set multiple(n){this._multiple=(0,j.Ig)(n)}get disabled(){return this._disabled}set disabled(n){this._disabled=(0,j.Ig)(n),this._buttonToggles&&this._buttonToggles.forEach(i=>i._markForCheck())}ngOnInit(){this._selectionModel=new lt.Ov(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(n=>n.checked))}writeValue(n){this.value=n,this._changeDetector.markForCheck()}registerOnChange(n){this._controlValueAccessorChangeFn=n}registerOnTouched(n){this._onTouched=n}setDisabledState(n){this.disabled=n}_emitChangeEvent(){const n=this.selected,i=Array.isArray(n)?n[n.length-1]:n,a=new ke(i,this.value);this._controlValueAccessorChangeFn(a.value),this.change.emit(a)}_syncButtonToggle(n,i,a=!1,l=!1){!this.multiple&&this.selected&&!n.checked&&(this.selected.checked=!1),this._selectionModel?i?this._selectionModel.select(n):this._selectionModel.deselect(n):l=!0,l?Promise.resolve().then(()=>this._updateModelValue(a)):this._updateModelValue(a)}_isSelected(n){return this._selectionModel&&this._selectionModel.isSelected(n)}_isPrechecked(n){return!(typeof this._rawValue>"u")&&(this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(i=>null!=n.value&&i===n.value):n.value===this._rawValue)}_setSelectionByValue(n){this._rawValue=n,this._buttonToggles&&(this.multiple&&n?(Array.isArray(n),this._clearSelection(),n.forEach(i=>this._selectValue(i))):(this._clearSelection(),this._selectValue(n)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(n=>n.checked=!1)}_selectValue(n){const i=this._buttonToggles.find(a=>null!=a.value&&a.value===n);i&&(i.checked=!0,this._selectionModel.select(i))}_updateModelValue(n){n&&this._emitChangeEvent(),this.valueChange.emit(this.value)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.sBO),t.Y36(Te,8))},o.\u0275dir=t.lG2({type:o,selectors:[["mat-button-toggle-group"]],contentQueries:function(n,i,a){if(1&n&&t.Suo(a,Fe,5),2&n){let l;t.iGM(l=t.CRH())&&(i._buttonToggles=l)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(n,i){2&n&&(t.uIk("aria-disabled",i.disabled),t.ekj("mat-button-toggle-vertical",i.vertical)("mat-button-toggle-group-appearance-standard","standard"===i.appearance))},inputs:{appearance:"appearance",name:"name",vertical:"vertical",value:"value",multiple:"multiple",disabled:"disabled"},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[t._Bn([pt,{provide:ye,useExisting:o}])]}),o})();const mt=(0,T.Kr)(class{});let Fe=(()=>{class o extends mt{constructor(n,i,a,l,r,c){super(),this._changeDetectorRef=i,this._elementRef=a,this._focusMonitor=l,this._isSingleSelector=!1,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new t.vpe;const d=Number(r);this.tabIndex=d||0===d?d:null,this.buttonToggleGroup=n,this.appearance=c&&c.appearance?c.appearance:"standard"}get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(n){this._appearance=n}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(n){const i=(0,j.Ig)(n);i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(n){this._disabled=(0,j.Ig)(n)}ngOnInit(){const n=this.buttonToggleGroup;this._isSingleSelector=n&&!n.multiple,this.id=this.id||"mat-button-toggle-"+Me++,this._isSingleSelector&&(this.name=n.name),n&&(n._isPrechecked(this)?this.checked=!0:n._isSelected(this)!==this._checked&&n._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const n=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),n&&n._isSelected(this)&&n._syncButtonToggle(this,!1,!1,!0)}focus(n){this._buttonElement.nativeElement.focus(n)}_onButtonClick(){const n=!!this._isSingleSelector||!this._checked;n!==this._checked&&(this._checked=n,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new ke(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(ye,8),t.Y36(t.sBO),t.Y36(t.SBq),t.Y36(st.tE),t.$8M("tabindex"),t.Y36(Te,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["mat-button-toggle"]],viewQuery:function(n,i){if(1&n&&t.Gf(rt,5),2&n){let a;t.iGM(a=t.CRH())&&(i._buttonElement=a.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(n,i){1&n&&t.NdJ("focus",function(){return i.focus()}),2&n&&(t.uIk("aria-label",null)("aria-labelledby",null)("id",i.id)("name",null),t.ekj("mat-button-toggle-standalone",!i.buttonToggleGroup)("mat-button-toggle-checked",i.checked)("mat-button-toggle-disabled",i.disabled)("mat-button-toggle-appearance-standard","standard"===i.appearance))},inputs:{disableRipple:"disableRipple",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",appearance:"appearance",checked:"checked",disabled:"disabled"},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[t.qOj],ngContentSelectors:ct,decls:6,vars:9,consts:[["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"id","disabled","click"],["button",""],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(n,i){if(1&n&&(t.F$t(),t.TgZ(0,"button",0,1),t.NdJ("click",function(){return i._onButtonClick()}),t.TgZ(2,"span",2),t.Hsn(3),t.qZA()(),t._UZ(4,"span",3)(5,"span",4)),2&n){const a=t.MAs(1);t.Q6J("id",i.buttonId)("disabled",i.disabled||null),t.uIk("tabindex",i.disabled?-1:i.tabIndex)("aria-pressed",i.checked)("name",i.name||null)("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby),t.xp6(5),t.Q6J("matRippleTrigger",a)("matRippleDisabled",i.disableRipple||i.disabled)}},dependencies:[T.wG],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.cdk-high-contrast-active .mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:.5}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}.cdk-high-contrast-active .mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.5}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 36px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}"],encapsulation:2,changeDetection:0}),o})(),ut=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[T.BQ,T.si,T.BQ]}),o})();
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
var C=p(959),G=p(2658),dt=p(4187),_t=p(6012);let gt=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["placeos-book"]],decls:5,vars:0,consts:[[1,"flex-1","flex","sm:flex-row","flex-col-reverse","h-1/2"],[1,"flex","flex-col","flex-1","h-1/2","sm:h-auto","overflow-hidden"],[1,"z-10"]],template:function(n,i){1&n&&(t._UZ(0,"topbar"),t.TgZ(1,"div",0)(2,"main",1),t._UZ(3,"router-outlet"),t.qZA()(),t._UZ(4,"footer-menu",2))},dependencies:[dt.o,_t.i,C.lC],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n/*# sourceMappingURL=book.component.ts-angular-inline--62.css.map*/"]}),o})(),ft=(()=>{class o{static hasCamera(){return o.listCameras(!1).then(n=>!!n.length).catch(()=>!1)}static listCameras(n=!1){if(!navigator.mediaDevices)return Promise.resolve([]);let i=null;return(n?navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(a=>i=a).catch(()=>{}):Promise.resolve()).then(()=>navigator.mediaDevices.enumerateDevices()).then(a=>a.filter(l=>"videoinput"===l.kind).map((l,r)=>({id:l.deviceId,label:l.label||(0===r?"Default Camera":`Camera ${r+1}`)}))).finally(()=>{if(i)for(const a of i.getTracks())a.stop(),i.removeTrack(a)})}constructor(n,i,a=this._onDecodeError,l=this._calculateScanRegion,r="environment"){this.$video=n,this.$canvas=document.createElement("canvas"),this._onDecode=i,this._legacyCanvasSize=o.DEFAULT_CANVAS_SIZE,this._preferredCamera=r,this._active=!1,this._paused=!1,this._flashOn=!1,"number"==typeof a?(this._legacyCanvasSize=a,console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future")):this._onDecodeError=a,"number"==typeof l?(this._legacyCanvasSize=l,console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future")):this._calculateScanRegion=l,this._scanRegion=this._calculateScanRegion(n),this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),n.disablePictureInPicture=!0,n.playsInline=!0,n.muted=!0;let c=!1;n.hidden&&(n.hidden=!1,c=!0),document.body.contains(n)||(document.body.appendChild(n),c=!0),requestAnimationFrame(()=>{const d=window.getComputedStyle(n);"none"===d.display&&(n.style.setProperty("display","block","important"),c=!0),"visible"!==d.visibility&&(n.style.setProperty("visibility","visible","important"),c=!0),c&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),n.style.opacity=0,n.style.width=0,n.style.height=0)}),n.addEventListener("play",this._onPlay),n.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),this._qrEnginePromise=o.createQrEngine()}hasFlash(){let n=null;return(this.$video.srcObject?Promise.resolve(this.$video.srcObject.getVideoTracks()[0]):this._getCameraStream().then(({stream:i})=>(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),n=i,i.getVideoTracks()[0]))).then(i=>"torch"in i.getSettings()).catch(()=>!1).finally(()=>{if(n)for(const i of n.getTracks())i.stop(),n.removeTrack(i)})}isFlashOn(){return this._flashOn}toggleFlash(){return this._flashOn?this.turnFlashOff():this.turnFlashOn()}turnFlashOn(){return this._flashOn||(this._flashOn=!0,!this._active||this._paused)?Promise.resolve():this.hasFlash().then(n=>n?this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]}):Promise.reject("No flash available")).catch(()=>{throw this._flashOn=!1,e})}turnFlashOff(){if(this._flashOn)return this._flashOn=!1,this._restartVideoStream()}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),this.stop(),o._postWorkerMessage(this._qrEnginePromise,"close")}start(){return this._active&&!this._paused||("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,document.hidden)?Promise.resolve():(this._paused=!1,this.$video.srcObject?(this.$video.play(),Promise.resolve()):this._getCameraStream().then(({stream:n,facingMode:i})=>{this.$video.srcObject=n,this.$video.play(),this._setVideoMirror(i),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{}))}).catch(n=>{throw this._active=!1,n}))}stop(){this.pause(),this._active=!1}pause(n=!1){if(this._paused=!0,!this._active)return Promise.resolve(!0);this.$video.pause();const i=()=>{const a=this.$video.srcObject?this.$video.srcObject.getTracks():[];for(const l of a)l.stop(),this.$video.srcObject.removeTrack(l);this.$video.srcObject=null};return n?(i(),Promise.resolve(!0)):new Promise(a=>setTimeout(a,300)).then(()=>!!this._paused&&(i(),!0))}setCamera(n){return n===this._preferredCamera?Promise.resolve():(this._preferredCamera=n,this._restartVideoStream())}static scanImage(n,i=null,a=null,l=null,r=!1,c=!1){const d=a instanceof Worker;let h=Promise.all([a||o.createQrEngine(),o._loadImage(n)]).then(([g,v])=>{let z;return a=g,[l,z]=this._drawToCanvas(v,i,l,r),a instanceof Worker?(d||a.postMessage({type:"inversionMode",data:"both"}),new Promise((we,B)=>{let K,O,V;O=Q=>{"qrResult"===Q.data.type&&(a.removeEventListener("message",O),a.removeEventListener("error",V),clearTimeout(K),null!==Q.data.data?we(Q.data.data):B(o.NO_QR_CODE_FOUND))},V=Q=>{a.removeEventListener("message",O),a.removeEventListener("error",V),clearTimeout(K),B("Scanner error: "+(Q?Q.message||Q:"Unknown Error"))},a.addEventListener("message",O),a.addEventListener("error",V),K=setTimeout(()=>V("timeout"),1e4);const at=z.getImageData(0,0,l.width,l.height);a.postMessage({type:"decode",data:at},[at.data.buffer])})):new Promise((we,B)=>{const K=setTimeout(()=>B("Scanner error: timeout"),1e4);a.detect(l).then(O=>{O.length?we(O[0].rawValue):B(o.NO_QR_CODE_FOUND)}).catch(O=>B("Scanner error: "+(O.message||O))).finally(()=>clearTimeout(K))})});return i&&c&&(h=h.catch(()=>o.scanImage(n,null,a,l,r))),h=h.finally(()=>{d||o._postWorkerMessage(a,"close")}),h}setGrayscaleWeights(n,i,a,l=!0){o._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:n,green:i,blue:a,useIntegerApproximation:l})}setInversionMode(n){o._postWorkerMessage(this._qrEnginePromise,"inversionMode",n)}static createQrEngine(n=o.WORKER_PATH){return("BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats?BarcodeDetector.getSupportedFormats():Promise.resolve([])).then(i=>-1!==i.indexOf("qr_code")?new BarcodeDetector({formats:["qr_code"]}):new Worker(n))}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video)}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(n){const i=Math.min(n.videoWidth,n.videoHeight),a=Math.round(2/3*i);return{x:Math.round((n.videoWidth-a)/2),y:Math.round((n.videoHeight-a)/2),width:a,height:a,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_scanFrame(){if(!this._active||this.$video.paused||this.$video.ended)return!1;requestAnimationFrame(()=>{this.$video.readyState<=1?this._scanFrame():this._qrEnginePromise.then(n=>o.scanImage(this.$video,this._scanRegion,n,this.$canvas)).then(this._onDecode,n=>{this._active&&(-1!==(n.message||n).indexOf("service unavailable")&&(this._qrEnginePromise=o.createQrEngine()),this._onDecodeError(n))}).then(()=>this._scanFrame())})}_onDecodeError(n){n!==o.NO_QR_CODE_FOUND&&console.log(n)}_getCameraStream(){if(!navigator.mediaDevices)return Promise.reject("Camera not found.");const n="environment"===this._preferredCamera||"user"===this._preferredCamera?"facingMode":"deviceId",i=[{width:{min:1024}},{width:{min:768}},{}];return[...i.map(l=>Object.assign({},l,{[n]:{exact:this._preferredCamera}})),...i].reduceRight((l,r)=>()=>navigator.mediaDevices.getUserMedia({video:r,audio:!1}).then(c=>({stream:c,facingMode:this._getFacingMode(c)||(r.facingMode?this._preferredCamera:"environment"===this._preferredCamera?"user":"environment")})).catch(l),()=>Promise.reject("Camera not found."))()}_restartVideoStream(){const n=this._paused;return this.pause(!0).then(i=>{if(i&&!n&&this._active)return this.start()})}_setVideoMirror(n){this.$video.style.transform="scaleX("+("user"===n?-1:1)+")"}_getFacingMode(n){const i=n.getVideoTracks()[0];return i?/rear|back|environment/i.test(i.label)?"environment":/front|user|face/i.test(i.label)?"user":null:null}static _drawToCanvas(n,i=null,a=null,l=!1){a=a||document.createElement("canvas");const r=i&&i.x?i.x:0,c=i&&i.y?i.y:0,d=i&&i.width?i.width:n.width||n.videoWidth,h=i&&i.height?i.height:n.height||n.videoHeight;if(!l){const v=i&&i.downScaledWidth?i.downScaledWidth:d,z=i&&i.downScaledHeight?i.downScaledHeight:h;a.width!==v&&(a.width=v),a.height!==z&&(a.height=z)}const g=a.getContext("2d",{alpha:!1});return g.imageSmoothingEnabled=!1,g.drawImage(n,r,c,d,h,0,0,a.width,a.height),[a,g]}static _loadImage(n){if(n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||window.ImageBitmap&&n instanceof window.ImageBitmap||window.OffscreenCanvas&&n instanceof window.OffscreenCanvas)return Promise.resolve(n);if(n instanceof Image)return o._awaitImageLoad(n).then(()=>n);if(n instanceof File||n instanceof Blob||n instanceof URL||"string"==typeof n){const i=new Image;return i.src=n instanceof File||n instanceof Blob?URL.createObjectURL(n):n,o._awaitImageLoad(i).then(()=>((n instanceof File||n instanceof Blob)&&URL.revokeObjectURL(i.src),i))}return Promise.reject("Unsupported image type.")}static _awaitImageLoad(n){return new Promise((i,a)=>{if(n.complete&&0!==n.naturalWidth)i();else{let l,r;l=()=>{n.removeEventListener("load",l),n.removeEventListener("error",r),i()},r=()=>{n.removeEventListener("load",l),n.removeEventListener("error",r),a("Image load error")},n.addEventListener("load",l),n.addEventListener("error",r)}})}static _postWorkerMessage(n,i,a){return Promise.resolve(n).then(l=>{l instanceof Worker&&l.postMessage({type:i,data:a})})}}return o.DEFAULT_CANVAS_SIZE=400,o.NO_QR_CODE_FOUND="No QR code found",o.WORKER_PATH="qr-scanner-worker.min.js",o})();var f=p(4522),I=p(1267);const ht=["video"];function vt(o,s){1&o&&(t.TgZ(0,"div",11)(1,"h2",12),t._uU(2," Scan QR Code "),t.qZA(),t.TgZ(3,"span",13),t._uU(4," Scan the QR code outisde a PlaceOS room or space. "),t.qZA()())}function xt(o,s){1&o&&(t.TgZ(0,"div",11)(1,"h2",12),t._uU(2," Enter Room ID "),t.qZA(),t.TgZ(3,"span",13),t._uU(4," Enter the room ID number outisde a PlaceOS room or space. "),t.qZA()())}let bt=(()=>{class o{constructor(n){this._router=n,this.is_scanning=!0,this.menu=new t.vpe(!1)}ngOnDestroy(){this._video_el.nativeElement.srcObject&&this._video_el.nativeElement.srcObject.getTracks().forEach(n=>n?.stop()),this._qr_scanner?.stop()}ngOnInit(){!navigator.mediaDevices?.getUserMedia||(navigator.mediaDevices.getUserMedia({video:!0}).then(n=>this._video_el.nativeElement.srcObject=n).catch(n=>console.error("Unable to fetch media devices!",n)),this._qr_scanner=new ft(this._video_el.nativeElement,n=>this.handleQrCode(n)),this._qr_scanner.start())}handleQrCode(n){const i=n;if(i.indexOf("/#/")>0){const l=/[?&]([^=#]+)=([^&#]*)/g,r={};let c;for(;c=l.exec(i);)r[c[1]]=c[2];this._router.navigate([i.split("/#")[1].split("?")[0]],r)}}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(C.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["book-code-flow"]],viewQuery:function(n,i){if(1&n&&t.Gf(ht,7),2&n){let a;t.iGM(a=t.CRH())&&(i._video_el=a.first)}},outputs:{menu:"menu"},decls:16,vars:9,consts:[[1,"flex-1","overflow-hidden","flex","items-center","justify-center","bg-black","relative"],["id","video",1,"min-w-full","min-h-full","object-cover"],["video",""],[1,"absolute","text-white","text-center","inset-0","flex","flex-col","items-center","justify-center"],["class","flex flex-col z-10 justify-end items-center relative",4,"ngIf"],[1,"flex","items-center","justify-center"],["box","",1,"rounded-2xl","h-64","w-64","transition-all","flex","items-center","justify-center","p-8","m-8","space-x-2"],[1,"uppercase"],["matInput","","name","booking-id","placeholder","e.g. 12102910",1,"border-none","bg-none","w-full","text-3xl","text-left",3,"ngModel","ngModelChange"],[1,"m-4","p-2","flex","items-center","space-x-2","bg-white","bg-opacity-50","rounded"],["mat-button","",3,"click"],[1,"flex","flex-col","z-10","justify-end","items-center","relative"],[1,"text-3xl","mb-1","uppercase","subpixel-antialiased"],[1,"mb-4"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"video",1,2),t.TgZ(3,"div",3),t.YNc(4,vt,5,0,"div",4),t.YNc(5,xt,5,0,"div",4),t.TgZ(6,"div",5)(7,"div",6)(8,"span",7),t._uU(9,"Booking ID"),t.qZA(),t.TgZ(10,"input",8),t.NdJ("ngModelChange",function(l){return i.room_code=l}),t.qZA()()(),t.TgZ(11,"div",9)(12,"button",10),t.NdJ("click",function(){return i.is_scanning=!0}),t._uU(13," Scan Code "),t.qZA(),t.TgZ(14,"button",10),t.NdJ("click",function(){return i.is_scanning=!1}),t._uU(15," Enter Code "),t.qZA()()()()),2&n&&(t.xp6(4),t.Q6J("ngIf",i.is_scanning),t.xp6(1),t.Q6J("ngIf",!i.is_scanning),t.xp6(2),t.ekj("input",!i.is_scanning),t.xp6(3),t.Q6J("ngModel",i.room_code),t.xp6(2),t.Tol("flex-1 text-black border-none w-40 "+(i.is_scanning?"bg-white":"bg-transparent hover:bg-white bg-opacity-50")),t.xp6(2),t.Tol("flex-1 text-black border-none w-40 "+(i.is_scanning?"bg-transparent hover:bg-white bg-opacity-50":"bg-white")))},dependencies:[u.O5,f.lW,I.Nt,m.Fj,m.JJ,m.On],styles:["[_nghost-%COMP%]{position:relative;width:100%;height:100vh;display:flex;flex-direction:column}[box][_ngcontent-%COMP%]{box-shadow:0 0 0 100vw #00000080}[box][_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:none}[box].input[_ngcontent-%COMP%]{width:32rem!important;max-width:calc(100% - 2rem)!important;padding:1rem!important;height:4rem!important;color:#000!important;background:white;box-shadow:0 0 0 100vw #000c}[box].input[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:initial}[box][_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:var(--heading-font);font-weight:500;text-transform:uppercase;letter-spacing:.05em}\n/*# sourceMappingURL=code-flow.component.ts-angular-inline--63.css.map*/"]}),o})();var x=p(1670),D=p(7381),_=p(6365),S=p(3619),M=p(5670),P=p(6119),L=p(312),Oe=p(2317),Ue=p(5692),oe=p(3910),b=p(5306),ie=p(3200),Z=p(5074),W=p(7371),ae=p(2306),se=p(1022),le=p(7303),re=p(6471),Ie=p(9697),R=p(4792);const q=function(){return{standalone:!0}};function Ct(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",10)(1,"mat-button-toggle-group",11),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.setOptions({group:"group"===a}))}),t.ALo(2,"async"),t.TgZ(3,"mat-button-toggle",12),t._uU(4," Single "),t.qZA(),t.TgZ(5,"mat-button-toggle",13),t._uU(6," Group "),t.qZA()()()}if(2&o){const n=t.oxw(2);let i;t.xp6(1),t.Q6J("ngModel",null!=(i=t.lcZ(2,2,n.options))&&i.group?"group":"single")("ngModelOptions",t.DdM(4,q))}}function wt(o,s){if(1&o&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function Zt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",4)(1,"label"),t._uU(2,"Building"),t.qZA(),t.TgZ(3,"mat-form-field",14)(4,"mat-select",15),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.building=a)})("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.setOptions({zone_id:null==a?null:a.id}))}),t.YNc(5,wt,2,2,"mat-option",16),t.ALo(6,"async"),t.qZA()()()}if(2&o){const n=t.oxw(2);t.xp6(4),t.Q6J("ngModel",n.building)("ngModelOptions",t.DdM(5,q)),t.xp6(1),t.Q6J("ngForOf",t.lcZ(6,3,n.buildings))}}function Tt(o,s){if(1&o&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function yt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",4)(1,"label"),t._uU(2,"Level"),t.qZA(),t.TgZ(3,"mat-form-field",14)(4,"mat-select",18),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.setOptions({zone_id:a||l.building.id}))}),t.YNc(5,Tt,2,2,"mat-option",16),t.ALo(6,"async"),t.qZA()()()}if(2&o){const n=t.oxw(2);t.xp6(4),t.Q6J("disabled",!n.building)("ngModelOptions",t.DdM(5,q)),t.xp6(1),t.Q6J("ngForOf",t.lcZ(6,3,n.levels))}}function Mt(o,s){1&o&&(t.TgZ(0,"mat-checkbox",24),t._uU(1," All Day "),t.qZA())}function kt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",3)(1,"div",19)(2,"label"),t._uU(3,"Start Time"),t.qZA(),t.TgZ(4,"a-time-field",20),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.form.patchValue({date:a}))}),t.qZA()(),t.TgZ(5,"div",21)(6,"label"),t._uU(7,"End Time"),t.qZA(),t._UZ(8,"a-duration-field",22),t.YNc(9,Mt,2,0,"mat-checkbox",23),t.qZA()()}if(2&o){const n=t.oxw(2);let i;t.xp6(4),t.Q6J("ngModel",n.form.value.date)("ngModelOptions",t.DdM(8,q)),t.xp6(4),t.Q6J("time",null==(i=n.form.get("date"))?null:i.value)("max",720)("min",60)("step",60)("disabled",n.form.value.all_day),t.xp6(1),t.Q6J("ngIf",n.allow_all_day)}}function At(o,s){1&o&&(t.TgZ(0,"div",25)(1,"label"),t._uU(2,"Host"),t.qZA(),t._UZ(3,"a-user-search-field",26),t.qZA())}function Ft(o,s){1&o&&(t.TgZ(0,"div",27)(1,"label"),t._uU(2,"Details"),t.qZA(),t.TgZ(3,"mat-form-field",28),t._UZ(4,"input",29),t.qZA()())}const qe=function(){return[]};function Ot(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",27)(1,"label"),t._uU(2,"Group Members"),t.qZA(),t.TgZ(3,"a-user-list-field",30),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.setOptions({members:a}))}),t.ALo(4,"async"),t.qZA()()}if(2&o){const n=t.oxw(2);let i;t.xp6(3),t.Q6J("simple",!0)("ngModel",(null==(i=t.lcZ(4,3,n.options))?null:i.members)||t.DdM(5,qe))("ngModelOptions",t.DdM(6,q))}}function Ut(o,s){if(1&o&&(t.TgZ(0,"mat-option",17)(1,"span",34),t._uU(2),t.qZA()()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(2),t.Oqu(n)}}function It(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",3)(1,"div",19)(2,"label"),t._uU(3,"Recurrence Period"),t.qZA(),t.TgZ(4,"mat-form-field",14)(5,"mat-select",31),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.setOptions({pattern:a}))}),t.ALo(6,"async"),t.TgZ(7,"mat-option",32),t._uU(8,"None"),t.qZA(),t.YNc(9,Ut,3,2,"mat-option",16),t.qZA()()(),t.TgZ(10,"div",19)(11,"label"),t._uU(12,"Recurrence End"),t.qZA(),t.TgZ(13,"a-date-field",33),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.setOptions({recurr_end:a}))}),t.ALo(14,"async"),t.ALo(15,"async"),t.ALo(16,"async"),t._uU(17," Date and time must be in the future "),t.qZA()()()}if(2&o){const n=t.oxw(2);let i,a,l;t.xp6(5),t.Q6J("ngModel",null==(i=t.lcZ(6,7,n.options))?null:i.recurrence_pattern)("ngModelOptions",t.DdM(15,q)),t.xp6(4),t.Q6J("ngForOf",n.recurrence_options),t.xp6(4),t.Q6J("disabled",!(null!=(a=t.lcZ(14,9,n.options))&&a.pattern)||"none"===(null==(a=t.lcZ(15,11,n.options))?null:a.pattern))("ngModel",(null==(l=t.lcZ(16,13,n.options))?null:l.recurr_end)||(null==n.form||null==n.form.value?null:n.form.value.date))("ngModelOptions",t.DdM(16,q))("to",n.book_until)}}function qt(o,s){if(1&o&&(t.TgZ(0,"mat-option",37),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}function Nt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",27)(1,"label"),t._uU(2,"Desk Features"),t.qZA(),t.TgZ(3,"mat-form-field",28)(4,"mat-select",35),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.setOptions({features:a||[]}))}),t.ALo(5,"async"),t.YNc(6,qt,2,2,"mat-option",36),t.ALo(7,"async"),t.qZA()()()}if(2&o){const n=t.oxw(2);let i;t.xp6(4),t.Q6J("ngModel",(null==(i=t.lcZ(5,3,n.options))?null:i.features)||t.DdM(7,qe))("ngModelOptions",t.DdM(8,q)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(7,5,n.features))}}function Jt(o,s){if(1&o&&(t.TgZ(0,"form",1),t.YNc(1,Ct,7,5,"div",2),t.TgZ(2,"div",3)(3,"div",4)(4,"label"),t._uU(5,"Date"),t.qZA(),t.TgZ(6,"a-date-field",5),t._uU(7," Date and time must be in the future "),t.qZA()(),t.YNc(8,Zt,7,6,"div",6),t.ALo(9,"async"),t.YNc(10,yt,7,6,"div",6),t.ALo(11,"async"),t.qZA(),t.YNc(12,kt,10,9,"div",7),t.YNc(13,At,4,0,"div",8),t.YNc(14,Ft,5,0,"div",9),t.YNc(15,Ot,5,7,"div",9),t.ALo(16,"async"),t.YNc(17,It,18,17,"div",7),t.YNc(18,Nt,8,9,"div",9),t.ALo(19,"async"),t.qZA()),2&o){const n=t.oxw();let i,a,l,r;t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.allow_groups),t.xp6(5),t.Q6J("to",n.book_until),t.xp6(2),t.Q6J("ngIf",(null==(i=t.lcZ(9,11,n.buildings))?null:i.length)>1),t.xp6(2),t.Q6J("ngIf",(null==(a=t.lcZ(11,13,n.levels))?null:a.length)>1),t.xp6(2),t.Q6J("ngIf",n.allow_time_changes),t.xp6(1),t.Q6J("ngIf",n.can_book_for_others),t.xp6(1),t.Q6J("ngIf",n.needs_reason),t.xp6(1),t.Q6J("ngIf",null==(l=t.lcZ(16,15,n.options))?null:l.group),t.xp6(2),t.Q6J("ngIf",n.can_recurr),t.xp6(1),t.Q6J("ngIf",null==(r=t.lcZ(19,17,n.features))?null:r.length)}}let Ne=(()=>{class o{constructor(n,i,a){this._state=n,this._org=i,this._settings=a,this.buildings=this._org.building_list,this.levels=this._org.active_levels,this.options=this._state.options,this.features=this._state.features,this.recurrence_options=["daily","weekly","monthly"],this.setOptions=l=>this._state.setOptions(l)}get building(){return this._org.building}set building(n){this._org.building=n}get can_book_for_others(){return this._settings.get("app.desks.can_book_for_others")}get can_recurr(){return this._settings.get("app.desks.recurrence_allowed")}get allow_groups(){return this._settings.get("app.desks.allow_groups")}get needs_reason(){return!0===this._settings.get("app.desks.needs_reason")}get allow_time_changes(){return!!this._settings.get("app.desks.allow_time_changes")}get allow_all_day(){return this.allow_time_changes&&!!this._settings.get("app.desks.allow_all_day")}get book_until(){return(0,ie.Z)((0,L.Z)(Date.now(),this._settings.get("app.desks.available_period")||90))}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(D.fy),t.Y36(S.w7),t.Y36(_.gb))},o.\u0275cmp=t.Xpm({type:o,selectors:[["detailed-book-desks-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4",4,"ngIf"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/4"],["formControlName","date",3,"to"],["class","flex flex-col flex-1 w-full sm:w-1/4",4,"ngIf"],["class","flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],["class","flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],["class","flex flex-col flex-1 w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],[1,"w-full",3,"ngModel","ngModelOptions","ngModelChange"],["value","single",1,"w-1/2"],["value","group",1,"w-1/2"],["appearance","outline"],["placeholder","Select building",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","Any Level","ngModel","",3,"disabled","ngModelOptions","ngModelChange"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3","relative"],["formControlName","duration",3,"time","max","min","step","disabled"],["formControlName","all_day","class","absolute top-0 right-0",4,"ngIf"],["formControlName","all_day",1,"absolute","top-0","right-0"],[1,"flex","flex-col","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["formControlName","user"],[1,"flex","flex-col","flex-1","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["appearance","outline",1,"w-full"],["matInput","","formControlName","description","placeholder","Reason for booking..."],[3,"simple","ngModel","ngModelOptions","ngModelChange"],["placeholder","None",3,"ngModel","ngModelOptions","ngModelChange"],["value","none"],[3,"disabled","ngModel","ngModelOptions","to","ngModelChange"],[1,"capitalize"],["multiple","","placeholder","Any Feature",3,"ngModel","ngModelOptions","ngModelChange"],["class","capitalize",3,"value",4,"ngFor","ngForOf"],[1,"capitalize",3,"value"]],template:function(n,i){1&n&&t.YNc(0,Jt,20,19,"form",0),2&n&&t.Q6J("ngIf",i.form)},dependencies:[u.sg,u.O5,T.ey,Z.KE,W.gD,I.Nt,ae.Q,se.B,le.N,re.E,Ie.d,R.oG,m._Y,m.Fj,m.JJ,m.JL,m.On,m.sg,m.u,Ae,Fe,u.Ov]}),o})();function Dt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.findDesk())}),t.TgZ(1,"div",6)(2,"app-icon",7),t._uU(3,"search"),t.qZA(),t.TgZ(4,"span",8),t._uU(5),t.qZA()()()}if(2&o){const n=t.oxw();t.xp6(5),t.Oqu(n.is_edit?"Update Desk":"Find Desk")}}function St(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.allocateDesk())}),t._uU(1),t.qZA()}if(2&o){const n=t.oxw();t.xp6(1),t.hij(" ",n.is_edit?"Update Desk":"Book Desk"," ")}}let Lt=(()=>{class o{constructor(n,i,a,l){this._state=n,this._router=i,this._org=a,this._settings=l,this.time=0,this.level="",this.quick_times=[{name:"Now",value:0},{name:"Tomorrow",value:(0,P.Z)((0,L.Z)(new Date,1),9).valueOf()}],this.levels=[],this.clearForm=()=>{this.time=0,this.level=this._org.building.id,this._state.clearForm()}}get is_edit(){return!!this.form?.get("id")?.value}get auto_allocation(){return!!this._settings.get("app.desks.auto_allocation")}get form(){return this._state.form}ngOnInit(){var n=this;return(0,x.Z)(function*(){yield n._org.initialised.pipe((0,M.P)(i=>i)),yield n._org.active_levels.pipe((0,M.P)(i=>i?.length>0)),n.level=n._org.building?.id,n.levels=[{id:n._org.building?.id,name:"Any Level"},...n._org.levelsForBuilding(n._org.building)]})()}quickBook(){this.form.patchValue({date:(this.time<1440?(0,Oe.Z)((0,Ue.Z)(new Date,{nearestTo:5}),this.time):(0,P.Z)((0,L.Z)(new Date,1),8)).valueOf(),title:"Ad-hoc Desk Booking"}),this.findDesk()}findDesk(){this.form.markAllAsTouched(),this.form.valid&&this._router.navigate(["/book","desks","map"])}allocateDesk(){var n=this;return(0,x.Z)(function*(){if(n.form.markAllAsTouched(),!n.form.valid)return;const i=n._settings.get("app.departments")||{},a=(0,_.ar)().groups.find(v=>v in i);if(!a)return void n._router.navigate(["/book","desks","map"]);const{level:l,centered_at:r}=i[a],c=n._org.levelWithID([l]);if(!l)return void n._router.navigate(["/book","desks","map"]);const d=yield n._state.available_assets.pipe((0,oe.q)(1)).toPromise(),h=yield(0,D.gV)(c.map_id,r,d.map(v=>v.map_id||v.id)),g=d.find(v=>v.map_id===h||v.id===h);g?(n._state.form.patchValue({asset_id:g?.id,asset_name:g.name,map_id:g?.map_id||g?.id,description:g.name,booking_type:"desk",zones:g.zone?[g.zone?.parent_id,g.zone?.id]:[]}),n._state.confirmPost()):n._router.navigate(["/book","desks","map"])})()}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(D.fy),t.Y36(C.F0),t.Y36(S.w7),t.Y36(_.gb))},o.\u0275cmp=t.Xpm({type:o,selectors:[["desk-flow-form"]],decls:15,vars:5,consts:[["form","",1,"flex-1","min-h-[50%]"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[3,"form"],[1,"mb-4","border-b","border-gray-300","w-full"],[1,"flex","flex-col","sm:flex-row","items-center","justify-center","space-x-0","space-y-2","sm:space-y-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],["mat-button","","clear","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]","inverse",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"ml-2","mx-4"],["class","sm:flex-1 w-full sm:w-auto h-[2.75rem]","find","","mat-button","",3,"click",4,"ngIf","ngIfElse"],["alloc_button",""],["find","","mat-button","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"]],template:function(n,i){if(1&n&&(t.TgZ(0,"section",0)(1,"h2",1),t._uU(2),t.qZA(),t._UZ(3,"detailed-book-desks-form",2)(4,"div",3),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return i.clearForm()}),t.TgZ(7,"div",6)(8,"app-icon",7),t._uU(9,"clear"),t.qZA(),t.TgZ(10,"span",8),t._uU(11),t.qZA()()(),t.YNc(12,Dt,6,1,"button",9),t.qZA()(),t.YNc(13,St,2,1,"ng-template",null,10,t.W1O)),2&n){const a=t.MAs(14);t.xp6(2),t.hij(" ",i.is_edit?"Edit":"Detailed"," Desk Booking "),t.xp6(1),t.Q6J("form",i.form),t.xp6(8),t.Oqu(i.is_edit?"Cancel Edit":"Clear Form"),t.xp6(1),t.Q6J("ngIf",!i.auto_allocation)("ngIfElse",a)}},dependencies:[u.O5,b.o,f.lW,Ne],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;overflow:auto}[quick][_ngcontent-%COMP%]{background-color:#007ac8}\n/*# sourceMappingURL=form.component.ts-angular-inline--66.css.map*/"]}),o})();var Je=p(3861),E=p(7716),k=p(4505),Qt=p(5722),N=p(6942),ce=p(823),De=p(9136),A=p(8589),F=p(1708),Se=p(6817);function Pt(o,s){if(1&o&&(t.TgZ(0,"div",27),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.xp6(1),t.hij(" ",n," ")}}const Et=function(){return[]};function Yt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"li",20),t.NdJ("click",function(){const l=t.CHM(n).$implicit,r=t.oxw();return t.KtG(r.setActiveDesk(l))}),t.TgZ(1,"app-icon",21),t._uU(2,"place"),t.qZA(),t.TgZ(3,"div",22)(4,"div",23),t._uU(5),t.qZA(),t.TgZ(6,"div",24),t._uU(7),t.qZA(),t.TgZ(8,"div",25),t.YNc(9,Pt,2,1,"div",26),t.qZA()()()}if(2&o){const n=s.$implicit,i=t.oxw();t.ekj("border-primary",(null==i.active_desk?null:i.active_desk.id)===n.id),t.uIk("desk-id",n.id),t.xp6(5),t.Oqu(n.name||n.id),t.xp6(2),t.hij(" ",(null==n.zone?null:n.zone.display_name)||(null==n.zone?null:n.zone.name)||"<No Level>"," "),t.xp6(2),t.Q6J("ngForOf",n.features||t.DdM(6,Et))}}function Bt(o,s){if(1&o&&(t.TgZ(0,"div",28),t._uU(1),t.ALo(2,"async"),t.ALo(3,"async"),t.qZA()),2&o){const n=t.oxw();let i;t.xp6(1),t.hij(" ",(null==(i=t.lcZ(2,1,n.level))?null:i.display_name)||(null==(i=t.lcZ(3,3,n.level))?null:i.name)," ")}}function jt(o,s){if(1&o&&(t.TgZ(0,"div",29),t._UZ(1,"mat-spinner",30),t.TgZ(2,"p"),t._uU(3),t.ALo(4,"async"),t.qZA()()),2&o){const n=t.oxw();t.xp6(1),t.Q6J("diameter",32),t.xp6(2),t.Oqu(t.lcZ(4,2,n.loading))}}function Gt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",31)(1,"div",32)(2,"div",23),t._uU(3),t.qZA(),t.TgZ(4,"div",24),t._uU(5),t.qZA()(),t.TgZ(6,"div",33)(7,"button",34),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.setActiveDesk(null))}),t._uU(8," Clear "),t.qZA(),t.TgZ(9,"button",35),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.makeBooking())}),t._uU(10," Book "),t.qZA()()()}if(2&o){const n=t.oxw();t.xp6(3),t.Oqu(n.active_desk.name),t.xp6(2),t.hij(" ",(null==n.active_desk.zone?null:n.active_desk.zone.display_name)||n.active_desk.zone.name||"<No Level>"," ")}}const Rt=function(){return["/book","desks","form"]};let $t=(()=>{class o extends _.KG{constructor(n,i){super(),this._state=n,this._explore=i,this.url=this._explore.map_url,this.styles=this._explore.map_styles,this.positions=this._explore.map_positions,this.features=this._explore.map_features,this.actions=this._explore.map_actions,this.labels=this._explore.map_labels,this.level=this._explore.level,this.desks=this._state.available_assets,this.loading=this._state.loading,this.form=this._state.form,this.option_details=(0,E.aj)([this._state.options,this.form.valueChanges.pipe((0,Qt.O)({}))]).pipe((0,N.U)(([a])=>{const l=this._state.form,r=(0,_.IO)({pattern:a.pattern,end:a.recurr_end,start:l.value.date,interval:1,days_of_week:-1}),c=`${(0,Je.Z)(l.value.date,"dd MMM yyyy")}${a.pattern&&"none"!==a.pattern?", "+r:""}${a.group?", "+a.group:""}, ${a.features?.length||"Any"} Feature${(a.features?.length||0)<2?"":"s"}`;return a.zone_id&&this._explore.setLevel(a.zone_id),c})),this._active_desk=new k.X(null),this.makeBooking=()=>this._state.confirmPost()}get active_desk(){return this._active_desk.getValue()}ngOnInit(){this.subscription("assets-statue",(0,E.aj)([this._state.assets,this._state.available_assets,this._active_desk]).pipe((0,ce.b)(200)).subscribe(([n,i])=>{const a={},l=[];for(const r of n){const c=r.bookable&&i.find(d=>d.id===r.id);a[`#${r.map_id||r.id}`]={fill:r.bookable?i.find(d=>d.id===r.id)?"#43a047":"#e53935":"#999",opacity:.6},c&&l.push({id:r.map_id||r.id,action:"click",callback:()=>this.setActiveDesk(r)})}this._explore.setStyles("desks",a),this._explore.setActions("desks",l),this._explore.setFeatures("desks",this.active_desk?[{location:this.active_desk.map_id||this.active_desk.id,content:'\n                    <span class="flex h-4 w-4 rounded-full absolute top-1/4 left-1/4 transform -translate-x-1/2 -translate-y-1/2 border-[3px] border-white shadow" >\n                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>\n                        <span class="relative inline-flex rounded-full h-full w-full bg-primary"></span>\n                    </span>'}]:[])}))}setActiveDesk(n){this._explore.setLevel(n?.zone?.id),this._active_desk.next(n),this._state.form.patchValue({asset_id:n?.id,asset_name:n.name,map_id:n?.map_id||n?.id,description:n.name,booking_type:"desk",zones:n.zone?[n.zone?.parent_id,n.zone?.id]:[]})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(D.fy),t.Y36(G.ck))},o.\u0275cmp=t.Xpm({type:o,selectors:[["desk-flow-map"]],features:[t.qOj],decls:38,vars:42,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],[1,"flex","flex-col","flex-1","h-1/2","w-full"],[1,"text-2xl","px-4","pt-4","text-center"],[1,"my-4","mx-auto","w-[640px]","max-w-[calc(100vw-2rem)]",3,"matMenuTriggerFor"],["menu","matMenu"],[1,"pt-4","max-h-[65vh]","overflow-auto",3,"click"],[3,"form"],["listing","",1,"flex","flex-1","h-1/2","relative","space-x-2"],[1,"list-style-none","w-full","sm:w-[20rem]","bg-gray-100","p-2","pb-32","overflow-auto","h-full","rounded-tr-lg","space-y-2"],[1,"px-2","sticky","top-0","bg-gray-100","w-full","z-10"],["matRipple","","class","flex items-center p-2 bg-white rounded shadow cursor-pointer space-x-2 min-h-[5rem] border",3,"border-primary","click",4,"ngFor","ngForOf"],[1,"hidden","sm:block","flex-1","bg-gray-200","rounded-tl-lg","border-l","border-t","border-gray-300","relative","overflow-hidden","h-full"],[3,"src","zoom","center","styles","features","actions","labels","focus"],["class","absolute top-2 left-2 bg-white rounded-3xl h-10 px-3 flex items-center border border-gray-300",4,"ngIf"],["class","absolute inset-0 bg-white bg-opacity-60 flex flex-col items-center justify-center space-y-2 !m-0 z-20",4,"ngIf"],["selection","","class","absolute bottom-2 left-1/2 transform -translate-x-1/2 p-2 bg-white shadow rounded w-[24rem] max-w-[calc(100vw-1rem)] space-y-2 !m-0 border border-gray-200",4,"ngIf"],["matRipple","",1,"flex","items-center","p-2","bg-white","rounded","shadow","cursor-pointer","space-x-2","min-h-[5rem]","border",3,"click"],[1,"text-2xl"],[1,"flex","flex-col","w-1/2","flex-1"],["name","",1,""],["level","",1,"text-xs"],["features","",1,"w-full","flex","flex-wrap"],["class","text-xs bg-primary text-white rounded-xl px-2 py-1 mt-1 mr-2",4,"ngFor","ngForOf"],[1,"text-xs","bg-primary","text-white","rounded-xl","px-2","py-1","mt-1","mr-2"],[1,"absolute","top-2","left-2","bg-white","rounded-3xl","h-10","px-3","flex","items-center","border","border-gray-300"],[1,"absolute","inset-0","bg-white","bg-opacity-60","flex","flex-col","items-center","justify-center","space-y-2","!m-0","z-20"],[3,"diameter"],["selection","",1,"absolute","bottom-2","left-1/2","transform","-translate-x-1/2","p-2","bg-white","shadow","rounded","w-[24rem]","max-w-[calc(100vw-1rem)]","space-y-2","!m-0","border","border-gray-200"],[1,""],[1,"flex","items-center","space-x-2"],["mat-button","",1,"inverse","flex-1",3,"click"],["mat-button","",1,"flex-1",3,"click"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"a",1)(2,"div",2)(3,"app-icon",3),t._uU(4,"arrow_back"),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"Back"),t.qZA()()()(),t.TgZ(7,"div",5)(8,"h2",6),t._uU(9,"Available Desks"),t.qZA(),t.TgZ(10,"an-action-field",7),t._uU(11),t.ALo(12,"async"),t.qZA(),t.TgZ(13,"mat-menu",null,8)(15,"div",9),t.NdJ("click",function(l){return l.stopPropagation(),l.preventDefault}),t._UZ(16,"detailed-book-desks-form",10),t.qZA()(),t.TgZ(17,"div",11)(18,"ul",12)(19,"div",13),t._uU(20),t.ALo(21,"async"),t.qZA(),t.YNc(22,Yt,10,7,"li",14),t.ALo(23,"async"),t.qZA(),t.TgZ(24,"div",15),t._UZ(25,"i-map",16),t.ALo(26,"async"),t.ALo(27,"async"),t.ALo(28,"async"),t.ALo(29,"async"),t.ALo(30,"async"),t.ALo(31,"async"),t.ALo(32,"async"),t.YNc(33,Bt,4,5,"div",17),t.ALo(34,"async"),t.qZA(),t.YNc(35,jt,5,4,"div",18),t.ALo(36,"async"),t.YNc(37,Gt,11,2,"div",19),t.qZA()()),2&n){const a=t.MAs(14);let l,r,c;t.xp6(1),t.Q6J("routerLink",t.DdM(41,Rt)),t.xp6(9),t.Q6J("matMenuTriggerFor",a),t.xp6(1),t.hij(" ",t.lcZ(12,17,i.option_details)||"No Filters"," "),t.xp6(5),t.Q6J("form",i.form),t.xp6(4),t.hij(" ",(null==(l=t.lcZ(21,19,i.desks))?null:l.length)||"0"," matches available "),t.xp6(2),t.Q6J("ngForOf",t.lcZ(23,21,i.desks)),t.xp6(3),t.Q6J("src",t.lcZ(26,23,i.url))("zoom",null==(r=t.lcZ(27,25,i.positions))?null:r.zoom)("center",null==(c=t.lcZ(28,27,i.positions))?null:c.center)("styles",t.lcZ(29,29,i.styles))("features",t.lcZ(30,31,i.features))("actions",t.lcZ(31,33,i.actions))("labels",t.lcZ(32,35,i.labels))("focus",(null==i.active_desk?null:i.active_desk.map_id)||(null==i.active_desk?null:i.active_desk.id)),t.xp6(8),t.Q6J("ngIf",t.lcZ(34,37,i.level)),t.xp6(2),t.Q6J("ngIf",t.lcZ(36,39,i.loading)),t.xp6(2),t.Q6J("ngIf",i.active_desk)}},dependencies:[u.sg,u.O5,b.o,De.p,A.VK,A.p6,f.lW,f.zs,F.Ou,Se.s,T.wG,C.yS,Ne,u.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}\n/*# sourceMappingURL=map.component.ts-angular-inline--67.css.map*/"]}),o})();const Ht=function(){return["/book","desks","map"]};let zt=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["desk-flow-confirm"]],decls:7,vars:2,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"a",1)(2,"div",2)(3,"app-icon",3),t._uU(4,"arrow_back"),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"Back"),t.qZA()()()()),2&n&&(t.xp6(1),t.Q6J("routerLink",t.DdM(1,Ht)))},dependencies:[b.o,f.zs,C.yS],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}\n/*# sourceMappingURL=confirm.component.ts-angular-inline--65.css.map*/"]}),o})();const Kt=function(o){return["/book",o]},Vt=function(){return{}},Wt=function(){return["/schedule"]},Xt=function(o){return{email:o}};let pe=(()=>{class o{constructor(){this.route="spaces",this.type="space"}get is_host(){return this.calendar===(0,_.ar)()?.email}get title(){return this.is_host?"your":"the host'"}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["flow-success"]],inputs:{calendar:"calendar",route:"route",type:"type"},decls:13,vars:12,consts:[["name","success",1,"fixed","inset-0","flex","flex-col","bg-secondary","items-center","justify-center","z-50"],[1,"text-4xl","rounded-full","bg-white","text-success","mb-4"],[1,"text-center","text-lg","text-white","mb-4"],[1,"flex","items-center","space-x-2"],["button","","mat-button","",1,"w-32","border","border-white",3,"routerLink","queryParams"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-icon"),t._uU(3,"done"),t.qZA()(),t.TgZ(4,"div",2),t._uU(5),t._UZ(6,"br"),t._uU(7),t.qZA(),t.TgZ(8,"div",3)(9,"a",4),t._uU(10," New Booking "),t.qZA(),t.TgZ(11,"a",4),t._uU(12," Your Bookings "),t.qZA()()()),2&n&&(t.xp6(5),t.hij(" Thank you, your ",i.type," booking was successful!"),t.xp6(2),t.hij(" An event has been added to ",i.title," calendar "),t.xp6(2),t.Q6J("routerLink",t.VKq(6,Kt,i.route))("queryParams",t.DdM(8,Vt)),t.xp6(2),t.Q6J("routerLink",t.DdM(9,Wt))("queryParams",t.VKq(10,Xt,i.calendar)))},dependencies:[b.o,f.zs,C.yS]}),o})();function en(o,s){1&o&&(t.ynx(0),t._UZ(1,"desk-flow-map"),t.BQk())}function tn(o,s){1&o&&(t.ynx(0),t._UZ(1,"desk-flow-confirm"),t.BQk())}function nn(o,s){if(1&o&&(t.ynx(0),t._UZ(1,"flow-success",4),t.BQk()),2&o){const n=t.oxw();t.xp6(1),t.Q6J("calendar",null==n.last_success?null:n.last_success.user_email)}}function on(o,s){1&o&&(t.ynx(0),t._UZ(1,"desk-flow-form"),t.BQk())}let an=(()=>{class o extends _.KG{constructor(n,i,a){super(),this._state=n,this._route=i,this._org=a}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){var n=this;return(0,x.Z)(function*(){yield n._org.initialised.pipe((0,M.P)(i=>i)).toPromise(),n._state.loadForm(),n._state.form||n._state.newForm(),n._state.form.patchValue({booking_type:"desk"}),n.subscription("route.params",n._route.paramMap.subscribe(i=>{i.has("step")&&n._state.setView(i.get("step"))})),n.subscription("route.query",n._route.queryParamMap.subscribe(i=>{i.has("success")&&n._state.setView(i.get("success"))}))})()}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(D.fy),t.Y36(C.gz),t.Y36(S.w7))},o.\u0275cmp=t.Xpm({type:o,selectors:[["placeos-book-desk-flow"]],features:[t.qOj],decls:6,vars:4,consts:[[1,"bg-white","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","desk","route","desks",3,"calendar"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.ynx(1,1),t.YNc(2,en,2,0,"ng-container",2),t.YNc(3,tn,2,0,"ng-container",2),t.YNc(4,nn,2,1,"ng-container",2),t.YNc(5,on,2,0,"ng-container",3),t.BQk(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngSwitch",i.view),t.xp6(1),t.Q6J("ngSwitchCase","map"),t.xp6(1),t.Q6J("ngSwitchCase","confirm"),t.xp6(1),t.Q6J("ngSwitchCase","success"))},dependencies:[u.RF,u.n9,u.ED,Lt,$t,zt,pe],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}\n/*# sourceMappingURL=desk-flow.component.ts-angular-inline--64.css.map*/"]}),o})();var J=p(8426),me=p(8442),sn=p(8335),w=p(1484);const ln=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}];function rn(o,s){1&o&&(t.TgZ(0,"button",5)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function cn(o,s){if(1&o&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(1),t.hij(" ",n.name," ")}}function pn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",14)(1,"mat-form-field",8)(2,"mat-select",15),t.NdJ("ngModelChange",function(a){const r=t.CHM(n).$implicit;return t.KtG(r[0]=a)}),t.YNc(3,cn,2,2,"mat-option",16),t.qZA()(),t.TgZ(4,"mat-form-field",8)(5,"input",17),t.NdJ("ngModelChange",function(a){const r=t.CHM(n).$implicit;return t.KtG(r[1]=a)}),t.qZA(),t.TgZ(6,"mat-error"),t._uU(7,"Rule value is required"),t.qZA()()()}if(2&o){const n=s.$implicit,i=t.oxw(2);t.xp6(2),t.Q6J("ngModel",n[0]),t.xp6(1),t.Q6J("ngForOf",i.rule_types),t.xp6(2),t.Q6J("ngModel",n[1])}}function mn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",6)(1,"div",7)(2,"mat-form-field",8)(3,"input",9),t.NdJ("ngModelChange",function(a){const r=t.CHM(n).$implicit;return t.KtG(r.name=a)}),t.qZA(),t.TgZ(4,"mat-error"),t._uU(5,"Ruleset name is required"),t.qZA()(),t.TgZ(6,"button",10),t.NdJ("click",function(){const l=t.CHM(n).$implicit,r=t.oxw();return l.rules.push(["",""]),t.KtG(r.show_rules=l.id)}),t.TgZ(7,"app-icon"),t._uU(8,"add"),t.qZA()(),t.TgZ(9,"button",11),t.NdJ("click",function(){const l=t.CHM(n).$implicit,r=t.oxw();return t.KtG(r.show_rules=r.show_rules!==l.id?l.id:"")}),t.TgZ(10,"app-icon"),t._uU(11),t.qZA()()(),t.TgZ(12,"div",12),t.YNc(13,pn,8,3,"div",13),t.qZA()()}if(2&o){const n=s.$implicit,i=t.oxw();t.xp6(3),t.Q6J("ngModel",n.name),t.xp6(6),t.Q6J("disabled",!n.rules.length),t.xp6(2),t.Oqu(i.show_rules===n.id?"expand_less":"expand_more"),t.xp6(1),t.Udp("height",(i.show_rules===n.id?3.5*n.rules.length:0)+"em"),t.xp6(1),t.Q6J("ngForOf",n.rules)}}let Le=(()=>{class o{constructor(n){this._data=n,this.event=new t.vpe,this.loading=!1,this.rule_types=ln,this.rulesets=(n.config||[]).map(i=>(i.rules=i.rules.map(a=>[a[0],JSON.stringify(a[1])]),i))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const n=this.rulesets.map(i=>({...i,rules:i.rules.map(a=>{let l=a[1];try{l=JSON.parse(a[1])}catch{}return[a[0],l]})}));this.event.emit({reason:"done",metadata:n})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(w.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex px-2 h-14 space-x-2",4,"ngFor","ngForOf"],[1,"flex","px-2","h-14","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(n,i){1&n&&(t.TgZ(0,"header")(1,"h3"),t._uU(2,"Edit Catering Configuration"),t.qZA(),t.YNc(3,rn,3,0,"button",0),t.qZA(),t.TgZ(4,"main",1)(5,"button",2),t.NdJ("click",function(){return i.rulesets.push({id:i.new_id,rules:[]})}),t._uU(6," New Ruleset "),t.qZA(),t.YNc(7,mn,14,6,"div",3),t.qZA(),t.TgZ(8,"footer",4)(9,"button",2),t.NdJ("click",function(){return i.saveChanges()}),t._uU(10,"Save Changes"),t.qZA()()),2&n&&(t.xp6(3),t.Q6J("ngIf",!i.loading),t.xp6(4),t.Q6J("ngForOf",i.rulesets))},dependencies:[u.sg,u.O5,T.ey,w.ZT,m.Fj,m.JJ,m.Q7,m.On,b.o,Z.TO,Z.KE,W.gD,f.lW,I.Nt],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}\n/*# sourceMappingURL=catering-config-modal.component.ts-angular-inline--70.css.map*/"]}),o})();var ue=p(8456),y=p(2962),X=p(8550),Y=p(1169),de=p(2793);function un(o,s){1&o&&(t.TgZ(0,"button",7)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function dn(o,s){if(1&o&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",18),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA()()()),2&o){const n=t.oxw(2);t.xp6(1),t.ekj("error",n.form.controls.name.invalid&&n.form.controls.name.touched)}}function _n(o,s){if(1&o&&(t.TgZ(0,"div",15)(1,"label",19),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA()()()),2&o){const n=t.oxw(2),i=t.MAs(9);t.xp6(1),t.ekj("error",n.form.controls.category.invalid&&n.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",i)}}const gn=function(){return{class:"material-icons",content:"close"}};function fn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"mat-chip",27),t.NdJ("removed",function(){const l=t.CHM(n).$implicit,r=t.oxw(3);return t.KtG(r.removeTag(l))}),t._uU(1),t._UZ(2,"app-icon",28),t.qZA()}if(2&o){const n=s.$implicit;t.Q6J("selectable",!0)("removable",!0),t.xp6(1),t.hij(" ",n," "),t.xp6(1),t.Q6J("icon",t.DdM(4,gn))}}function hn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",15)(1,"label",21),t.SDv(2,22),t.qZA(),t.TgZ(3,"mat-form-field",17)(4,"mat-chip-list",23,24),t.YNc(6,fn,3,5,"mat-chip",25),t.TgZ(7,"input",26),t.NdJ("matChipInputTokenEnd",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.addTag(a))}),t.qZA()()()()}if(2&o){const n=t.MAs(5),i=t.oxw(2);t.xp6(1),t.ekj("error",i.form.controls.tags.invalid&&i.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",i.tag_list),t.xp6(1),t.Q6J("matChipInputFor",n)("matChipInputSeparatorKeyCodes",i.separators)("matChipInputAddOnBlur",!0)}}function vn(o,s){1&o&&(t.TgZ(0,"div",15)(1,"label",29),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",17),t._UZ(4,"textarea",30),t.qZA()())}function xn(o,s){if(1&o&&(t.TgZ(0,"div",15)(1,"label",16),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",31),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA()()()),2&o){const n=t.oxw(2);t.xp6(1),t.ekj("error",n.form.controls.unit_price.invalid&&n.form.controls.unit_price.touched)}}function bn(o,s){if(1&o&&(t.TgZ(0,"form",8),t.YNc(1,dn,10,2,"div",9),t.YNc(2,_n,10,3,"div",9),t.YNc(3,hn,8,6,"div",9),t.YNc(4,vn,5,0,"div",9),t.YNc(5,xn,10,2,"div",9),t.TgZ(6,"div",10)(7,"label",11),t._uU(8,"Accept Points?"),t.qZA(),t.TgZ(9,"mat-checkbox",12),t._uU(10),t.qZA()(),t.TgZ(11,"div",10)(12,"label",13),t._uU(13,"Discount Cap"),t.qZA(),t._UZ(14,"a-counter",14),t.qZA()()),2&o){const n=t.oxw();let i;t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.form.controls.name),t.xp6(1),t.Q6J("ngIf",n.form.controls.category),t.xp6(1),t.Q6J("ngIf",n.form.controls.tags),t.xp6(1),t.Q6J("ngIf",n.form.controls.description),t.xp6(1),t.Q6J("ngIf",n.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(i=n.form.get("accept_points"))&&i.value?"No":"Yes"),t.xp6(4),t.Q6J("min",0)("max",100)("step",5)("render_fn",n.renderPercent)}}function Cn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"footer",32)(1,"button",33),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.saveChanges())}),t._uU(2," Save "),t.qZA()()}if(2&o){const n=t.oxw();t.xp6(1),t.Q6J("disabled",!n.form.dirty)}}function wn(o,s){1&o&&(t.TgZ(0,"div",34),t._UZ(1,"mat-spinner",35),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA()())}function Zn(o,s){if(1&o&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}let Qe=(()=>{class o{constructor(n){this._data=n,this.event=new t.vpe,this.form=new m.cw({name:new m.NI(this.item.name||"",[m.kI.required]),description:new m.NI(this.item.description||""),category:new m.NI(this.item.category||"",[m.kI.required]),unit_price:new m.NI(this.item.unit_price,[m.kI.required]),tags:new m.NI(this.item.tags||[]),accept_points:new m.NI(this.item.accept_points||!1),discount_cap:new m.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[ue.K5,ue.OC,ue.L_]}get item(){return this._data.item||new y.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(n=0){return`${n}%`}addTag(n){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const i=n.input,a=n.value,l=this.tag_list;(a||"").trim()&&(l.push(a),this.form.controls.tags.setValue(l)),i&&(i.value="")}removeTag(n){if(!this.form||!this.form.controls.tags)return;const i=this.tag_list;this.form.controls.tags.markAsDirty();const a=i.indexOf(n);a>=0&&(i.splice(a,1),this.form.controls.tags.setValue(i))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new y.U({...this.item,id:this.item.id||`item-${(0,_.Iy)(99999999)}`,...this.form.value})}})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(w.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let s,n;return s=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,n=$localize`:@@zoneTagsPlaceholder␟8dc7c13b0c6b8ad9c770bce0ad72e14b4aef8456␟3986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],s,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",n,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(n,i){if(1&n&&(t.TgZ(0,"header")(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,un,3,0,"button",1),t.qZA(),t.YNc(4,bn,15,11,"form",2),t.YNc(5,Cn,3,1,"footer",3),t.YNc(6,wn,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,Zn,2,2,"mat-option",6),t.qZA()),2&n){const a=t.MAs(7);t.xp6(2),t.hij("",i.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",i.form&&!i.loading)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(5),t.Q6J("ngForOf",i.categories)}},dependencies:[u.sg,u.O5,X.XC,X.ZL,T.ey,w.ZT,w.uh,R.oG,m._Y,m.Fj,m.wV,m.JJ,m.JL,m.sg,m.u,b.o,Z.TO,Z.KE,f.lW,I.Nt,F.Ou,Y.qn,Y.HS,Y.oH,Y.qH,de.R],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--71.css.map*/"]}),o})();var $=p(3690),Pe=p(3245);function Tn(o,s){1&o&&(t.TgZ(0,"button",7)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function yn(o,s){if(1&o&&(t.TgZ(0,"div",10)(1,"label",11),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",12),t._UZ(7,"input",13),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA()()()),2&o){const n=t.oxw(2);t.xp6(1),t.ekj("error",n.form.controls.name.invalid&&n.form.controls.name.touched)}}function Mn(o,s){if(1&o&&(t.TgZ(0,"div",10)(1,"label",14),t._uU(2," Type"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",12),t._UZ(7,"input",15),t.TgZ(8,"mat-error"),t._uU(9,"Type is required"),t.qZA()()()),2&o){const n=t.oxw(2),i=t.MAs(9);t.xp6(1),t.ekj("error",n.form.controls.group.invalid&&n.form.controls.group.touched),t.xp6(6),t.Q6J("matAutocomplete",i)}}function kn(o,s){1&o&&(t.TgZ(0,"div",10)(1,"label",11),t._uU(2,"Unit Price:"),t.qZA(),t.TgZ(3,"mat-form-field",12),t._UZ(4,"input",16),t.qZA()())}function An(o,s){1&o&&(t.TgZ(0,"div",10)(1,"mat-checkbox",17),t._uU(2," Can select multiple of type "),t.qZA()())}function Fn(o,s){if(1&o&&(t.TgZ(0,"form",8),t.YNc(1,yn,10,2,"div",9),t.YNc(2,Mn,10,3,"div",9),t.YNc(3,kn,5,0,"div",9),t.YNc(4,An,3,0,"div",9),t.qZA()),2&o){const n=t.oxw();t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.form.controls.name),t.xp6(1),t.Q6J("ngIf",n.form.controls.group),t.xp6(1),t.Q6J("ngIf",n.form.controls.unit_price),t.xp6(1),t.Q6J("ngIf",n.form.controls.multiple)}}function On(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"footer",18)(1,"button",19),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.saveChanges())}),t._uU(2," Save "),t.qZA()()}if(2&o){const n=t.oxw();t.xp6(1),t.Q6J("disabled",!n.form.dirty)}}function Un(o,s){1&o&&(t.TgZ(0,"div",20),t._UZ(1,"mat-spinner",21),t.TgZ(2,"p"),t._uU(3,"Saving catering item option..."),t.qZA()())}function In(o,s){if(1&o&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}let Ee=(()=>{class o{constructor(n){this._data=n,this.event=new t.vpe,this.form=new m.cw({name:new m.NI(this.option.name||"",[m.kI.required]),group:new m.NI(this.option.group||"",[m.kI.required]),unit_price:new m.NI(this.option.unit_price),multiple:new m.NI(!!this.option.multiple,[])}),this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}saveChanges(){this.loading=!0;const n={...this.option,id:this.option.id||`option-${(0,Pe.Iy)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new y.U({...this._data.parent,options:this._data.parent.options.filter(i=>i.id!==n.id).concat([n])})}})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(w.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(n,i){if(1&n&&(t.TgZ(0,"header")(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,Tn,3,0,"button",1),t.qZA(),t.YNc(4,Fn,5,5,"form",2),t.YNc(5,On,3,1,"footer",3),t.YNc(6,Un,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,In,2,2,"mat-option",6),t.qZA()),2&n){const a=t.MAs(7);t.xp6(2),t.hij(" ",i.option.id?"Edit":"Add"," Item Option "),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",i.form&&!i.loading)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(5),t.Q6J("ngForOf",i.types)}},dependencies:[u.sg,u.O5,X.XC,X.ZL,T.ey,w.ZT,w.uh,R.oG,m._Y,m.Fj,m.wV,m.JJ,m.JL,m.sg,m.u,b.o,Z.TO,Z.KE,f.lW,I.Nt,F.Ou],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-option-modal.component.ts-angular-inline--72.css.map*/"]}),o})();var U=p(5163),qn=p(1233),Nn=p(475),Ye=p(8025),ee=p(5892),Jn=p(6896);function Dn(o,s){1&o&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function Sn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw().$implicit,r=t.oxw(5);return t.KtG(r.updateItemQuantity(l,a))}),t.qZA()}if(2&o){const n=t.oxw().$implicit;t.Q6J("ngModel",n.quantity)}}function Ln(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),t._uU(4,"remove"),t.qZA()()(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(n);const a=t.oxw().$implicit,l=t.oxw(5);return t.KtG(l.addItem(a))}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA()()()}if(2&o){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",n.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",n.quantity," ")}}function Qn(o,s){if(1&o&&(t.TgZ(0,"div",11)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,Dn,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,Sn,1,1,"a-counter",15),t.YNc(9,Ln,10,3,"div",16),t.qZA()),2&o){const n=s.$implicit;t.xp6(3),t.hij(" ",n.name," "),t.xp6(1),t.Q6J("ngIf",n.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,5,n.unit_price/100)," "),t.xp6(2),t.Q6J("ngIf",!n.options.length),t.xp6(1),t.Q6J("ngIf",n.options.length)}}const Be=function(){return{}};function Pn(o,s){if(1&o&&(t.TgZ(0,"mat-tab",8)(1,"div",9),t.YNc(2,Qn,10,7,"div",10),t.qZA()()),2&o){const n=t.oxw().$implicit,i=t.oxw(3);t.Q6J("label",n),t.xp6(2),t.Q6J("ngForOf",(i.menu_items||t.DdM(2,Be))[n])}}function En(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Pn,3,3,"mat-tab",7),t.BQk()),2&o){const n=s.$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(i.menu_items||t.DdM(1,Be))[n].length)}}function Yn(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,En,2,2,"ng-container",6),t.qZA(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",n.categories)}}function Bn(o,s){if(1&o&&(t.TgZ(0,"div",4),t.YNc(1,Yn,3,1,"ng-container",5),t.qZA()),2&o){const n=t.oxw(),i=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!n.show_order_details)("ngIfElse",i)}}function jn(o,s){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){t.CHM(n);const a=t.oxw(2);return t.KtG(a.show_order_details=!0)}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&o){const n=t.oxw(2);t.xp6(3),t.Q6J("disabled",!n.order.item_count)("matBadge",n.order.item_count)("matBadgeHidden",!n.order.item_count)}}function Gn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(n);const a=t.oxw(2);return t.KtG(a.show_order_details=!1)}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){t.CHM(n);const a=t.oxw(2);return t.KtG(a.saveOrder())}),t._uU(3," Save Order "),t.qZA()}}function Rn(o,s){if(1&o&&(t.TgZ(0,"footer",24),t.YNc(1,jn,5,3,"ng-container",5),t.YNc(2,Gn,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&o){const n=t.MAs(3),i=t.oxw();t.xp6(1),t.Q6J("ngIf",!i.show_order_details)("ngIfElse",n)}}function $n(o,s){if(1&o&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&o){const n=t.oxw();t.xp6(3),t.Oqu(n.loading)}}function Hn(o,s){if(1&o&&(t.TgZ(0,"div",37),t._uU(1),t.qZA()),2&o){const n=t.oxw().$implicit,i=t.oxw(2);t.Q6J("matTooltip",i.optionsFor(n)),t.xp6(1),t.AsE(" ",n.options.length," option",1===n.options.length?"":"s"," selected ")}}function zn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",34)(1,"div",12)(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,Hn,2,3,"div",35),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",36),t.NdJ("ngModelChange",function(a){const r=t.CHM(n).$implicit,c=t.oxw(2);return t.KtG(c.updateItemQuantity(r,a))}),t.qZA()()}if(2&o){const n=s.$implicit;t.xp6(3),t.Oqu(n.name),t.xp6(1),t.Q6J("ngIf",n.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,4,n.total_cost/100)," "),t.xp6(2),t.Q6J("ngModel",n.quantity)}}function Kn(o,s){if(1&o&&(t.TgZ(0,"header",32)(1,"h3"),t._uU(2,"Confirm Order"),t.qZA()(),t.TgZ(3,"div",9),t.YNc(4,zn,9,6,"div",33),t.qZA()),2&o){const n=t.oxw();t.xp6(4),t.Q6J("ngForOf",n.order.items)}}function Vn(o,s,n){let i=!0;for(const a of s)if(o.category===a.name||o.tags.includes(a.name)||n.space?.zones.includes(a.name)||"*"===a.name){let l=0;for(const r of a.rules){const c=new Date(n.date);switch(r[0]){case"after_hour":l+=(0,qn.Z)(c,(0,P.Z)(c,r[1]))?1:0;break;case"before_hour":l+=(0,Nn.Z)(c,(0,P.Z)(c,r[1]))?1:0;break;case"min_length":l+=n.duration>=(0,Ye.H1)(r[1])?1:0;break;case"max_length":l+=n.duration<=(0,Ye.H1)(r[1])?1:0;break;case"visitor_type":l+=n.ext("visitor_type")===r[1]?1:0;break;default:l++}}i=l>=a.rules.length}return i}let je=(()=>{class o extends _.KG{constructor(n){super(),this._data=n,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var n=this;return(0,x.Z)(function*(){n.loading="Loading menu...",n.order=new U.G(n._data.order),n.rules=yield n._data.getCateringConfig(n.order.event?.space?.level?.parent_id),n._data.menu.subscribe(i=>{n.loading="Loading menu...";const a=(0,_.Tw)(i.map(r=>r.category)),l={};for(const r of a)l[r]=i.filter(c=>c.category===r&&Vn(c,n.rules,n.order.event));n.categories=a,n.menu_items=l,n.updateMenuQuantities(),n.timeout("clear_loading",()=>n.loading="",1e3)})})()}addItem(n,i=!0){const a=this.order.items.find(l=>l.id===n.id&&l.options.length===l.options.reduce((r,c)=>r+(n.options.find(d=>c.id===d.id)?1:0),0));i&&n.options?.length?this._data.selectOptions(n.options).then(l=>{const r=new y.U({...n,options:l});this.addItem(r,!1)}):this.order=new U.G(a?{...this.order,items:this.order.items.filter(l=>!(l.id===n.id&&l.options_string===n.options_string)).concat([new y.U({...n,quantity:a.quantity+1})])}:{...this.order,items:this.order.items.concat([new y.U({...n,quantity:1})])}),this.updateMenuQuantities()}removeItem(n){this.order=new U.G({...this.order,items:this.order.items.filter(i=>i.id!==n.id&&i.options_string===n.options_string)}),this.updateMenuQuantities()}updateItemQuantity(n,i){const a=this.order.items.find(r=>r.id===n.id&&r.options_string===n.options_string);let l=[...this.order.items];l=a?this.order.items.filter(r=>!(r.id===n.id&&r.options_string===n.options_string)).concat([new y.U({...n,quantity:i})]):this.order.items.concat([new y.U({...n,quantity:i})]),l.sort((r,c)=>r.name.localeCompare(c.name)),this.order=new U.G({...this.order,items:l}),this.updateMenuQuantities()}updateMenuQuantities(){for(const n in this.menu_items)for(const i of this.menu_items[n])i.quantity=this.order.items.reduce((a,l)=>l.id===i.id?a+l.quantity:a,0)}optionsFor(n){return n.options.map(i=>i.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(w.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(n,i){if(1&n&&(t.YNc(0,Bn,2,2,"div",0),t.YNc(1,Rn,4,2,"footer",1),t.YNc(2,$n,4,1,"ng-template",null,2,t.W1O),t.YNc(4,Kn,5,1,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(3);t.Q6J("ngIf",!i.loading)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!i.loading)}},dependencies:[u.sg,u.O5,ee.SP,ee.uX,w.ZT,Jn.gM,m.Fj,m.JJ,m.On,b.o,f.lW,F.Ou,de.R,u.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--73.css.map*/"]}),o})();var Ge=p(2922);function Wn(o,s){if(1&o&&(t.TgZ(0,"div",18),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const n=t.oxw().$implicit;t.xp6(1),t.hij(" +",t.lcZ(2,1,n.unit_price/100)," ")}}function Xn(o,s){if(1&o&&(t.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),t._uU(3),t.qZA(),t.YNc(4,Wn,3,3,"div",17),t.qZA()()),2&o){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(3),t.hij(" ",n.name," "),t.xp6(1),t.Q6J("ngIf",n.unit_price)}}function eo(o,s){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"mat-radio-group",10),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw().$implicit,r=t.oxw();return t.KtG(r.updateGroupOption(l,a))}),t.TgZ(2,"mat-radio-button",11)(3,"span",12),t._uU(4,"None"),t.qZA()(),t.YNc(5,Xn,5,3,"mat-radio-button",13),t.qZA(),t.BQk()}if(2&o){const n=t.oxw().$implicit;t.xp6(5),t.Q6J("ngForOf",null==n?null:n.options)}}function to(o,s){if(1&o&&(t.TgZ(0,"div",18),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const n=t.oxw().$implicit;t.xp6(1),t.hij(" +",t.lcZ(2,1,n.unit_price/100)," ")}}function no(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"mat-checkbox",20),t.NdJ("ngModelChange",function(a){const r=t.CHM(n).$implicit,c=t.oxw(3);return t.KtG(c.option_state[r.id]=a)}),t.TgZ(1,"div",15)(2,"div",16),t._uU(3),t.qZA(),t.YNc(4,to,3,3,"div",17),t.qZA()()}if(2&o){const n=s.$implicit,i=t.oxw(3);t.Q6J("ngModel",i.option_state[n.id]),t.xp6(3),t.hij(" ",n.name," "),t.xp6(1),t.Q6J("ngIf",n.unit_price)}}function oo(o,s){if(1&o&&t.YNc(0,no,5,3,"mat-checkbox",19),2&o){const n=t.oxw().$implicit;t.Q6J("ngForOf",null==n?null:n.options)}}function io(o,s){if(1&o&&(t.TgZ(0,"div",5)(1,"div",6),t._uU(2),t.qZA(),t.TgZ(3,"div",7),t.YNc(4,eo,6,1,"ng-container",8),t.YNc(5,oo,1,1,"ng-template",null,9,t.W1O),t.qZA()()),2&o){const n=s.$implicit,i=t.MAs(6);t.uIk("group",n.name),t.xp6(2),t.Oqu(n.name),t.xp6(2),t.Q6J("ngIf",!n.multiple)("ngIfElse",i)}}let Re=(()=>{class o{constructor(n){this._data=n,this.event=new t.vpe,this.option_state={};const i=(0,Pe.Tw)(this._data.options.map(l=>l.group||"Other")),a=[];for(const l of i){const r=this._data.options.filter(c=>c.group===l);a.push({name:l,multiple:!!r.find(c=>c.multiple),options:r})}this.groups=a}updateGroupOption(n,i){for(const a of n.options)this.option_state[a.id]=a.id===i}saveOptions(){const n=this._data.options.filter(i=>this.option_state[i.id]);this.event.emit({reason:"done",metadata:{options:n}})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(w.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(n,i){1&n&&(t.TgZ(0,"header")(1,"h3"),t._uU(2,"Select options"),t.qZA(),t.TgZ(3,"button",0)(4,"app-icon"),t._uU(5,"close"),t.qZA()()(),t.TgZ(6,"main",1),t.YNc(7,io,7,4,"div",2),t.qZA(),t.TgZ(8,"footer",3)(9,"button",4),t.NdJ("click",function(){return i.saveOptions()}),t._uU(10," Save "),t.qZA()()),2&n&&(t.xp6(7),t.Q6J("ngForOf",i.groups))},dependencies:[u.sg,u.O5,w.ZT,R.oG,Ge.VQ,Ge.U0,m.JJ,m.On,b.o,f.lW,u.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--74.css.map*/"]}),o})();function ao(o,s){1&o&&(t.TgZ(0,"button",4)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function so(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),t._uU(3,"upload"),t.qZA(),t.TgZ(4,"p"),t._uU(5,"Click to select file or Drag and drop files"),t.qZA(),t.TgZ(6,"input",7),t.NdJ("change",function(a){t.CHM(n);const l=t.oxw();return t.KtG(l.handleFileEvent(a))}),t.qZA()(),t.TgZ(7,"div",8)(8,"button",9),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.downloadTemplate())}),t._uU(9," Download Template "),t.qZA()()()}}function lo(o,s){if(1&o&&(t.TgZ(0,"main",10),t._UZ(1,"mat-spinner",11),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&o){const n=t.oxw();t.xp6(3),t.Oqu(n.loading)}}let $e=(()=>{class o{constructor(){this.event=new t.vpe}handleFileEvent(n){this.loading="Processing menu data...";const i=n.target;if(!i?.files)return this.loading="";const a=i.files;if(!a.length)return this.loading="";const l=a[0],r=new FileReader;r.addEventListener("loadend",c=>{const h=(0,_.n5)(c.target.result);this.loading="",this.event.emit({reason:"done",metadata:h.filter(g=>"item"===(g.type||"").toLowerCase()).map(g=>new y.U({...g,options:h.filter(v=>"option"===(v.type||"").toLowerCase()&&v.tags===g.id).map(v=>({id:v.id,name:v.name,group:v.category,multiple:v.multiple,unit_price:v.unit_price}))}))})}),r.readAsText(l)}downloadTemplate(){(0,_.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["mat-button","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(n,i){if(1&n&&(t.TgZ(0,"header",0)(1,"h2"),t._uU(2,"Import Catering Menu"),t.qZA(),t.YNc(3,ao,3,0,"button",1),t.qZA(),t.YNc(4,so,10,0,"main",2),t.YNc(5,lo,4,1,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(6);t.xp6(3),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",!i.loading)("ngIfElse",a)}},dependencies:[u.O5,w.ZT,b.o,f.lW,F.Ou]}),o})(),_e=(()=>{class o extends _.KG{constructor(n,i){var a;super(),a=this,this._org=n,this._dialog=i,this._menu=new k.X([]),this._loading=new k.X(!1),this._currency=new k.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(function(){var l=(0,x.Z)(function*(r){if(r){const c=(yield a.getCateringForZone(r.id)).map(d=>new y.U(d));a._currency.next(r.currency||"USD"),a._menu.next(c)}});return function(r){return l.apply(this,arguments)}}()))}get categories(){const n=this._menu.getValue();return(0,_.Tw)(n.map(i=>i.category))}manageCateringOrder(n){var i=this;return(0,x.Z)(function*(){const a=i._dialog.open(je,{data:{order:n,menu:i.menu,loading:i.loading,getCateringConfig:r=>i.getCateringConfig(r),selectOptions:r=>i.selectOptions(r)}}),l=yield Promise.race([a.componentInstance.event.pipe((0,M.P)(r=>"done"===r.reason)).toPromise(),a.afterClosed().toPromise()]);return a.close(),l?.metadata?.order||n})()}addItem(n=new y.U){var i=this;return(0,x.Z)(function*(){const a=i._dialog.open(Qe,{data:{item:n,categories:i.categories}}),l=yield Promise.race([a.componentInstance.event.pipe((0,M.P)(d=>"done"===d.reason)).toPromise(),a.afterClosed().toPromise()]);if("done"!==l?.reason)return;const r=i._menu.getValue(),c=r.findIndex(d=>d.id===n.id);c>=0?r.splice(c,1,l.metadata.item):r.push(l.metadata.item),i.updateMenu(i._org.building.id,r).then(()=>{i._menu.next([...r]),a.close()},()=>a.componentInstance.loading=!1)})()}addOption(n,i={}){var a=this;return(0,x.Z)(function*(){const l=(0,_.Tw)(n.options.map(g=>g.group)),r=a._dialog.open(Ee,{data:{parent:n,option:i,types:l}}),c=yield Promise.race([r.componentInstance.event.pipe((0,M.P)(g=>"done"===g.reason)).toPromise(),r.afterClosed().toPromise()]);if("done"!==c?.reason)return;const d=a._menu.getValue(),h=d.findIndex(g=>g.id===n.id);h>=0?d.splice(h,1,c.metadata.item):d.push(c.metadata.item),a.updateMenu(a._org.building.id,d).then(()=>{a._menu.next([...d]),r.close()},()=>r.componentInstance.loading=!1)})()}selectOptions(n){var i=this;return(0,x.Z)(function*(){const a=i._dialog.open(Re,{data:{options:n}}),l=yield Promise.race([a.componentInstance.event.pipe((0,M.P)(r=>"done"===r.reason)).toPromise(),a.afterClosed().toPromise()]);return"done"!==l?.reason?[]:(a.close(),l.metadata.options)})()}deleteItem(n){var i=this;return(0,x.Z)(function*(){const a=yield(0,_._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${n.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},i._dialog);if("done"!==a.reason)return;a.loading("Removing catering item...");const l=i._menu.getValue().filter(r=>n.id!==r.id);i.updateMenu(i._org.building.id,l).then(()=>{i._menu.next([...l]),a.close()},()=>a.loading(""))})()}deleteOption(n,i){var a=this;return(0,x.Z)(function*(){const l=yield(0,_._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${i.name}" from "${n.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},a._dialog);if("done"!==l.reason)return;l.loading("Removing catering item option...");const r=a._menu.getValue();r.splice(r.findIndex(c=>c.id===n.id),1,new y.U({...n,options:n.options.filter(c=>c.id!==i.id)})),a.updateMenu(a._org.building.id,r).then(()=>{a._menu.next([...r]),l.close()},()=>l.loading(""))})()}editConfig(){var n=this;return(0,x.Z)(function*(){const i=yield n.getCateringConfig(n._org.building.id),a=n._menu.getValue(),l=(0,_.Tw)((0,_.xH)(a.map(d=>[d.category,...d.tags]))),r=n._dialog.open(Le,{data:{config:i,types:l}}),c=yield Promise.race([r.componentInstance.event.pipe((0,M.P)(d=>"done"===d.reason)).toPromise(),r.afterClosed().toPromise()]);"done"===c?.reason&&n.updateConfig(n._org.building.id,c.metadata).then(()=>r.close(),()=>r.componentInstance.loading=!1)})()}importMenu(){var n=this;return(0,x.Z)(function*(){const i=n._dialog.open($e),a=yield Promise.race([i.componentInstance.event.pipe((0,M.P)(d=>"done"===d.reason)).toPromise(),i.afterClosed().toPromise()]);if("done"!==a?.reason)return;i.componentInstance.loading="Updating menu...";const l=n._menu.getValue(),r=n._org.building,c=(0,_.Tw)(a.metadata.concat(l),"id");yield n.updateMenu(r.id,c).catch(d=>{throw(0,_.cB)("Error importing catering menu"),i.close(),d}),(0,_.t5)(`Successfully imported catering menu. ${a.metadata.length} item(s) added.`),i.close()})()}updateMenu(n,i){return(0,$.Ymr)(n,{id:n,name:"catering",details:i,description:`Catering menu for ${n}`}).toPromise()}getCateringForZone(n){return(0,x.Z)(function*(){const i=(yield(0,$.rlq)(n,"catering").toPromise()).details;return i instanceof Array?i:[]})()}getCateringConfig(n=this._org.building.id){return(0,x.Z)(function*(){const i=(yield(0,$.rlq)(n,"catering_config").toPromise()).details;return i instanceof Array?i:[]})()}updateConfig(n,i){return(0,$.Ymr)(n,{id:n,name:"catering_config",details:i,description:`Catering menu config for ${n}`}).toPromise()}addItemToOrder(n,i){let a=n.items;const l=a.find(c=>c.id===i.id&&i.options?.length===c.options?.reduce((d,h)=>d+(i.options.find(g=>h.id===g.id)?1:0),0));return l?l.quantity+=1:a=a.concat([new y.U({...i,quantity:1})]),new U.G({...n,items:a,event:null})}}return o.\u0275fac=function(n){return new(n||o)(t.LFG(S.w7),t.LFG(w.uw))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ge=p(9095),fe=p(8759),H=p(9128),te=p(1810),he=p(9377);p(4211),p(3902);var Oo=p(3780);function Uo(o,s){1&o&&(t.TgZ(0,"mat-checkbox",20),t._uU(1," All Day "),t.qZA())}function Io(o,s){1&o&&(t.TgZ(0,"div",21)(1,"label"),t._uU(2,"Host"),t.qZA(),t._UZ(3,"a-user-search-field",22),t.qZA())}function qo(o,s){1&o&&(t.TgZ(0,"div",27),t._uU(1," Add catering "),t.qZA())}function No(o,s){if(1&o&&(t.TgZ(0,"div",28)(1,"div",29),t._uU(2),t.qZA(),t.TgZ(3,"div",30),t._uU(4),t.ALo(5,"currency"),t.qZA()()),2&o){const n=t.oxw(3);t.xp6(2),t.hij(" ",null==n.form?null:n.form.value.catering[0].item_count," item(s) "),t.xp6(2),t.hij(" ",t.lcZ(5,2,(null==n.form?null:n.form.value.catering[0].total_cost)/100)," ")}}function Jo(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",23)(1,"label"),t._uU(2,"Catering"),t.qZA(),t.TgZ(3,"an-action-field",24),t.NdJ("onAction",function(){t.CHM(n);const a=t.oxw(2);return t.KtG(a.editCatering())}),t.YNc(4,qo,2,0,"div",25),t.YNc(5,No,6,4,"div",26),t.qZA()()}if(2&o){const n=t.oxw(2);t.xp6(4),t.Q6J("ngIf",!(null!=n.form&&null!=n.form.value.catering&&n.form.value.catering.length)),t.xp6(1),t.Q6J("ngIf",null==n.form||null==n.form.value.catering?null:n.form.value.catering.length)}}const Do=function(){return{standalone:!0}};function So(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"form",1)(1,"section",2)(2,"div",3)(3,"div",4)(4,"label"),t._uU(5,"Date"),t.qZA(),t.TgZ(6,"a-date-field",5),t._uU(7," Date and time must be in the future "),t.qZA()(),t.TgZ(8,"div",4)(9,"label"),t._uU(10,"Start Time"),t.qZA(),t.TgZ(11,"a-time-field",6),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw();return t.KtG(l.form.patchValue({date:a}))}),t.qZA()(),t.TgZ(12,"div",7)(13,"label"),t._uU(14,"End Time"),t.qZA(),t._UZ(15,"a-duration-field",8),t.YNc(16,Uo,2,0,"mat-checkbox",9),t.qZA()()(),t.TgZ(17,"section",2),t.YNc(18,Io,4,0,"div",10),t.TgZ(19,"div",11)(20,"label"),t._uU(21,"Attendees"),t.qZA(),t._UZ(22,"a-user-list-field",12),t.qZA()(),t.TgZ(23,"section",2)(24,"div",13)(25,"div",14)(26,"label"),t._uU(27,"Meeting Subject "),t.TgZ(28,"span"),t._uU(29,"*"),t.qZA()(),t.TgZ(30,"mat-form-field",15),t._UZ(31,"input",16),t.TgZ(32,"mat-error"),t._uU(33,"Meeting Subject is required"),t.qZA()()(),t.TgZ(34,"div",17)(35,"label"),t._uU(36,"Notes"),t.qZA(),t._UZ(37,"rich-text-input",18),t.qZA(),t.YNc(38,Jo,6,2,"div",19),t.qZA()()()}if(2&o){const n=t.oxw();t.Q6J("formGroup",n.form),t.xp6(11),t.Q6J("ngModel",n.form.value.date)("ngModelOptions",t.DdM(10,Do)),t.xp6(4),t.Q6J("time",n.form.value.date)("max",n.max_duration)("disabled",n.form.value.all_day),t.xp6(1),t.Q6J("ngIf",n.allow_all_day),t.xp6(2),t.Q6J("ngIf",n.can_book_for_others),t.xp6(4),t.Q6J("hideActions",n.hide_actions),t.xp6(16),t.Q6J("ngIf",n.has_catering)}}let Lo=(()=>{class o{constructor(n,i){var a=this;this._catering=n,this._settings=i,this.editCatering=(0,x.Z)(function*(){return a.form.patchValue({catering:[yield a._catering.manageCateringOrder((a.form.value.catering?a.form.value.catering[0]:null)||new U.G)]})})}get has_catering(){return!!this._settings.get("app.events.has_catering")}get hide_actions(){return!!this._settings.get("app.events.hide_user_actions")}get can_book_for_others(){return this._settings.get("app.events.can_book_for_others")}get allow_all_day(){return this._settings.get("app.events.allow_all_day")}get max_duration(){return this._settings.get("app.events.max_duration")||240}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(_e),t.Y36(_.gb))},o.\u0275cmp=t.Xpm({type:o,selectors:[["detailed-book-space-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"mb-4","border-b","border-gray-300"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],["formControlName","date"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3","relative"],["formControlName","duration",3,"time","max","disabled"],["formControlName","all_day","class","absolute top-0 right-0",4,"ngIf"],["class","flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],[1,"flex","flex-col","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-2"],["formControlName","attendees",3,"hideActions"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col"],["appearance","outline"],["matInput","","formControlName","title","placeholder","Meeting title"],[1,"flex","flex-col","resize-y","mb-4"],["formControlName","body","placeholder","Add meeting notes here..."],["class","flex flex-col mb-4",4,"ngIf"],["formControlName","all_day",1,"absolute","top-0","right-0"],[1,"flex","flex-col","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["formControlName","organiser"],[1,"flex","flex-col","mb-4"],[3,"onAction"],["class","opacity-40",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"opacity-40"],[1,"flex","items-center"],[1,"flex-1","w-1/2"],[1,"text-xs","opacity-60","px-4"]],template:function(n,i){1&n&&t.YNc(0,So,39,11,"form",0),2&n&&t.Q6J("ngIf",i.form)},dependencies:[u.O5,Z.TO,Z.KE,I.Nt,Se.s,ae.Q,se.B,le.N,re.E,Ie.d,Oo.n,R.oG,m._Y,m.Fj,m.JJ,m.JL,m.On,m.sg,m.u,u.H9]}),o})(),Qo=(()=>{class o{constructor(n,i){this._state=n,this._router=i,this.time=0,this.capacity=0,this.quick_times=[{name:"Now",value:0},{name:"Later Today",value:120},{name:"Tomorrow",value:(0,P.Z)((0,L.Z)(new Date,1),9).valueOf()}],this.quick_capacities=[{name:"Any Capacity",value:0},{name:"Small (1 - 4)",value:1},{name:"Medium (5 - 12)",value:5},{name:"Large (13 - 32)",value:13},{name:"Huge (32+)",value:33}],this.clearForm=()=>{this.time=this.capacity=0,this._state.clearForm()}}get is_edit(){return!!this.form?.get("id")?.value}get form(){return this._state.form}quickBook(){this.form.patchValue({date:(this.time<1440?(0,Oe.Z)((0,Ue.Z)(new Date,{nearestTo:5}),this.time):(0,P.Z)((0,L.Z)(new Date,1),8)).valueOf(),title:"Ad-hoc Meeting"}),this._state.setOptions({capacity:this.capacity}),this._router.navigate(["/book","spaces","find"])}findSpace(){this.form.markAllAsTouched(),this.form.valid&&this._router.navigate(["/book","spaces","find"])}confirmBooking(){this.form.markAllAsTouched(),this.form.valid&&this._router.navigate(["/book","spaces","confirm"])}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(J.MH),t.Y36(C.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["space-flow-form"]],decls:23,vars:5,consts:[["form","",1,"flex-1","min-h-[50%]"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[3,"form"],[1,"flex","flex-col","sm:flex-row","items-center","justify-center","space-x-0","space-y-2","sm:space-y-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],["mat-button","","clear","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]","inverse",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"ml-2","mx-4"],["mat-button","","find-space","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"],["mat-button","","standalone","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"section",0)(1,"h2",1),t._uU(2),t.qZA(),t._UZ(3,"detailed-book-space-form",2),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return i.clearForm()}),t.TgZ(6,"div",5)(7,"app-icon",6),t._uU(8,"clear"),t.qZA(),t.TgZ(9,"span",7),t._uU(10),t.qZA()()(),t.TgZ(11,"button",8),t.NdJ("click",function(){return i.findSpace()}),t.TgZ(12,"div",5)(13,"app-icon",6),t._uU(14,"search"),t.qZA(),t.TgZ(15,"span",7),t._uU(16),t.qZA()()(),t.TgZ(17,"button",9),t.NdJ("click",function(){return i.confirmBooking()}),t.TgZ(18,"div",5)(19,"app-icon",6),t._uU(20,"event_available"),t.qZA(),t.TgZ(21,"span",7),t._uU(22),t.qZA()()()()()),2&n&&(t.xp6(2),t.hij(" ",i.is_edit?"Edit":"Detailed"," Space Booking "),t.xp6(1),t.Q6J("form",i.form),t.xp6(7),t.Oqu(i.is_edit?"Cancel Edit":"Clear Form"),t.xp6(6),t.Oqu(i.is_edit?"Update Spaces":"Find Space"),t.xp6(6),t.Oqu(i.is_edit?"Confirm changes":"Book without Space"))},dependencies:[b.o,f.lW,Lo],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;overflow:auto}[quick][_ngcontent-%COMP%]{background-color:#007ac8}\n/*# sourceMappingURL=form.component.ts-angular-inline--82.css.map*/"]}),o})();var Po=p(8933),Eo=p(9151);let Yo=(()=>{class o{constructor(n){this._dialog=n,this.bookChange=new t.vpe}bookSpace(){this.book=!this.multiple||!this.book,this.bookChange.emit(this.book)}viewLocation(){this._dialog.open(me.p6,{maxWidth:"95vw",maxHeight:"95vh",data:{item:this.space}})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(w.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["space-flow-find-item"]],inputs:{space:"space",multiple:"multiple",book:"book"},outputs:{bookChange:"bookChange"},decls:19,vars:8,consts:[[1,"flex","items-center","bg-white","p-2","my-2","shadow","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","rounded"],[1,"flex","flex-col","flex-1","space-y-2"],[1,"flex","items-center"],[1,"p-2","rounded-full","bg-gray-300","mr-2"],[1,"flex","flex-col","space-y-2","ml-2"],["mat-button","","book","",3,"click"],["locate","","mat-button","",1,"inverse",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-icon"),t._uU(5,"place"),t.qZA()(),t.TgZ(6,"span"),t._uU(7),t.qZA()(),t.TgZ(8,"div",2)(9,"div",3)(10,"app-icon"),t._uU(11,"group"),t.qZA()(),t.TgZ(12,"span"),t._uU(13),t.qZA()()(),t.TgZ(14,"div",4)(15,"button",5),t.NdJ("click",function(){return i.bookSpace()}),t._uU(16),t.qZA(),t.TgZ(17,"button",6),t.NdJ("click",function(){return i.viewLocation()}),t._uU(18," Map "),t.qZA()()()),2&n&&(t.xp6(7),t.AsE("",(null==i.space||null==i.space.level?null:i.space.level.display_name)||(null==i.space||null==i.space.level?null:i.space.level.name),", ",(null==i.space?null:i.space.display_name)||(null==i.space?null:i.space.name),""),t.xp6(6),t.hij("",(null==i.space?null:i.space.capacity)||0," People"),t.xp6(2),t.ekj("bg-pending",i.multiple&&i.book)("border-pending",i.multiple&&i.book),t.xp6(1),t.hij(" ",i.multiple?i.book?"Remove":"Select":"Book"," "))},dependencies:[b.o,f.lW],styles:["button[_ngcontent-%COMP%]{width:8rem}\n/*# sourceMappingURL=find-item.component.ts-angular-inline--80.css.map*/"]}),o})();function Bo(o,s){if(1&o&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function jo(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"mat-form-field",20)(1,"mat-select",21),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw();return t.KtG(l.setBuilding(a))}),t.ALo(2,"async"),t.YNc(3,Bo,2,2,"mat-option",13),t.ALo(4,"async"),t.qZA()()}if(2&o){const n=t.oxw();t.xp6(1),t.Q6J("ngModel",t.lcZ(2,2,n.building)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(4,4,n.buildings))}}function Go(o,s){if(1&o&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function Ro(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"mat-form-field",23)(1,"mat-select",24),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw();return t.KtG(l.setOptions({zone_ids:[a]}))}),t.ALo(2,"async"),t.ALo(3,"async"),t.YNc(4,Go,2,2,"mat-option",13),t.ALo(5,"async"),t.qZA()()}if(2&o){const n=t.oxw();let i;t.xp6(1),t.Q6J("ngModel",null!=(i=t.lcZ(2,2,n.options))&&null!=i.zone_ids&&i.zone_ids.length?null==(i=t.lcZ(3,4,n.options))?null:i.zone_ids[0]:""),t.xp6(3),t.Q6J("ngForOf",t.lcZ(5,6,n.levels))}}function $o(o,s){if(1&o&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n.value),t.xp6(1),t.hij(" ",n.name," ")}}function Ho(o,s){if(1&o&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}function zo(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"mat-form-field",11)(1,"mat-select",25),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw();return t.KtG(l.setOptions({features:a}))}),t.ALo(2,"async"),t.YNc(3,Ho,2,2,"mat-option",13),t.ALo(4,"async"),t.qZA()()}if(2&o){const n=t.oxw();let i;t.xp6(1),t.Q6J("ngModel",null==(i=t.lcZ(2,2,n.options))?null:i.features),t.xp6(2),t.Q6J("ngForOf",t.lcZ(4,4,n.features))}}function Ko(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"space-flow-find-item",28),t.NdJ("bookChange",function(a){const r=t.CHM(n).$implicit,c=t.oxw(3);return t.KtG(c.book_space[r.id]=a)})("bookChange",function(a){const r=t.CHM(n).$implicit,c=t.oxw(3);return t.KtG(c.handleBookEvent(r,a))}),t.qZA()}if(2&o){const n=s.$implicit,i=t.oxw(3);t.Q6J("space",n)("multiple",i.multiple)("book",i.book_space[n.id])}}function Vo(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Ko,1,3,"space-flow-find-item",26),t.ALo(2,"async"),t.TgZ(3,"p",27),t._uU(4," End of available spaces list "),t.qZA(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,n.spaces))}}function Wo(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Vo,5,3,"ng-container",16),t.ALo(2,"async"),t.BQk()),2&o){const n=t.oxw(),i=t.MAs(29);let a;t.xp6(1),t.Q6J("ngIf",(null==(a=t.lcZ(2,2,n.spaces))?null:a.length)>0)("ngIfElse",i)}}function Xo(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",37)(1,"div",38)(2,"div"),t._uU(3),t.qZA(),t.TgZ(4,"div",39),t._uU(5),t.qZA()(),t.TgZ(6,"button",40),t.NdJ("click",function(a){const r=t.CHM(n).$implicit;return t.oxw(2).handleBookEvent(r,!1),t.KtG(a.stopPropagation())}),t.TgZ(7,"app-icon"),t._uU(8,"close"),t.qZA()()()}if(2&o){const n=s.$implicit;t.xp6(3),t.Oqu(n.display_name||n.name),t.xp6(2),t.AsE(" ",(null==n.level?null:n.level.display_name)||(null==n.level?null:n.level.name)," ~ ",n.capacity||"2+"," People ")}}function ei(o,s){1&o&&(t.TgZ(0,"div",41),t._uU(1," No selected spaces "),t.qZA())}function ti(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",29)(1,"div",30)(2,"div",31),t._uU(3),t.qZA(),t.TgZ(4,"button",32),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.confirmBooking())}),t._uU(5," Book "),t.qZA()(),t.TgZ(6,"mat-menu",33,34),t.YNc(8,Xo,9,3,"div",35),t.YNc(9,ei,2,0,"div",36),t.qZA()()}if(2&o){const n=t.MAs(7),i=t.oxw();t.xp6(2),t.Q6J("matMenuTriggerFor",n),t.xp6(1),t.hij(" ",i.space_list.length," space(s) selected "),t.xp6(1),t.Q6J("disabled",!i.space_list.length),t.xp6(4),t.Q6J("ngForOf",i.space_list),t.xp6(1),t.Q6J("ngIf",!(null!=i.space_list&&i.space_list.length))}}function ni(o,s){1&o&&(t.TgZ(0,"div",42),t._UZ(1,"mat-spinner",43),t.TgZ(2,"p"),t._uU(3,"Retrieving available spaces..."),t.qZA()()),2&o&&(t.xp6(1),t.Q6J("diameter",32))}function oi(o,s){1&o&&(t.TgZ(0,"div",44)(1,"p"),t._uU(2," No available spaces for selected time, capacity or level(s) "),t.qZA()())}const ii=function(){return["/book","spaces","form"]};let ai=(()=>{class o{constructor(n,i,a,l,r){this._org=n,this._spaces=i,this._state=a,this._settings=l,this._router=r,this.book_space={},this.quick_capacities=[{name:"Any Capacity",value:0},{name:"Small (1 - 4)",value:1},{name:"Medium (5 - 12)",value:5},{name:"Large (13 - 32)",value:13},{name:"Huge (32+)",value:33}],this.space_list=[],this.buildings=this._org.building_list,this.building=this._org.active_building,this.levels=(0,E.aj)([this.building,this._state.options]).pipe((0,Eo.h)(([c])=>!!c),(0,N.U)(([c])=>[{id:this._org.building.id,name:"All Levels"},...this._org.levelsForBuilding(c)])),this.loading=this._state.loading,this.options=this._state.options,this.spaces=this._state.available_spaces,this.features=this._spaces.features,this.setOptions=c=>this._state.setOptions(c)}setBuilding(n){var i=this;return(0,x.Z)(function*(){const a=yield i.options.pipe((0,oe.q)(1)).toPromise();n&&(i._org.building=n);const l=i._org.levelsForBuilding(i._org.building);!l.find(c=>a.zone_ids?.includes(c.id))&&l.length&&i.setOptions({zone_ids:[l[0].id]})})()}get multiple(){return this._settings.get("app.events.multiple_spaces")??!1}ngOnInit(){var n=this;return(0,x.Z)(function*(){yield n._org.initialised.pipe((0,M.P)(a=>!!a)).toPromise(),yield n._spaces.initialised.pipe((0,M.P)(a=>!!a)).toPromise(),n.setBuilding(n._org.building),n.book_space={},(n._state.form?.get("resources")?.value||[]).forEach(a=>n.book_space[a.id]=!0),n.space_list=n._spaces.filter(a=>n.book_space[a.id])})()}handleBookEvent(n,i=!0){this.multiple?this.book_space[n.id]=i:(this.book_space={},this.book_space[n.id]=i,console.log("confirm booking reached"),this.confirmBooking()),this.space_list=this._spaces.filter(a=>this.book_space[a.id])}confirmBooking(){const n=this._spaces.filter(i=>this.book_space[i.id]);this._state.form.patchValue({resources:n,system:n[0]}),this._router.navigate(["/book","spaces","confirm"])}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(S.w7),t.Y36(Po.sK),t.Y36(J.MH),t.Y36(_.gb),t.Y36(C.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["space-flow-find"]],decls:30,vars:20,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],["filters",""],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","py-4"],[1,"text-xl","uppercase","font-medium","text-white"],[1,"flex","flex-col","items-center","sm:flex-row","space-x-0","sm:space-x-2"],["overlay","","buildings","","class","w-full sm:w-px sm:flex-1 h-[3.25rem]","appearance","outline",4,"ngIf"],["class","w-full sm:w-px sm:flex-1 h-[3.25rem]","overlay","","appearance","outline",4,"ngIf"],["overlay","","appearance","outline",1,"w-full","sm:w-px","sm:flex-1","h-[3.25rem]","hidden","sm:block"],["placeholder","Any Capacity",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","w-full sm:w-px sm:flex-1 h-[3.25rem] hidden sm:block","overlay","","appearance","outline",4,"ngIf"],[1,"flex-1","w-full","bg-gray-100","overflow-auto"],[4,"ngIf","ngIfElse"],["class","bg-white border-t border-gray-200",4,"ngIf"],["load_state",""],["empty_state",""],["overlay","","buildings","","appearance","outline",1,"w-full","sm:w-px","sm:flex-1","h-[3.25rem]"],["placeholder","Select Building...",3,"ngModel","ngModelChange"],[3,"value"],["overlay","","appearance","outline",1,"w-full","sm:w-px","sm:flex-1","h-[3.25rem]"],["placeholder","Level",3,"ngModel","ngModelChange"],["placeholder","Any Features","multiple","",3,"ngModel","ngModelChange"],["class","w-[640px] max-w-[calc(100%-2rem)] mx-auto ",3,"space","multiple","book","bookChange",4,"ngFor","ngForOf"],[1,"p-4","text-center","opacity-60"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto",3,"space","multiple","book","bookChange"],[1,"bg-white","border-t","border-gray-200"],[1,"flex","items-center","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","p-2"],[1,"flex-1","underline",3,"matMenuTriggerFor"],["mat-button","",1,"w-32",3,"disabled","click"],["yPosition","above"],["menu","matMenu"],["class","flex items-center pointer-events-none leading-tight","mat-menu-item","",4,"ngFor","ngForOf"],["mat-menu-item","","class"," opacity-60",4,"ngIf"],["mat-menu-item","",1,"flex","items-center","pointer-events-none","leading-tight"],[1,"flex","flex-col","mr-4"],[1,"text-xs","opacity-70"],["mat-icon-button","",1,"pointer-events-auto",3,"click"],["mat-menu-item","",1,"opacity-60"],[1,"h-full","w-full","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"],[1,"h-full","w-full","flex","flex-col","items-center","justify-center","space-y-2","p-8","text-center"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"a",1)(2,"div",2)(3,"app-icon",3),t._uU(4,"arrow_back"),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"Back"),t.qZA()()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"h2",7),t._uU(10," Available Spaces "),t.qZA(),t.TgZ(11,"div",8),t.YNc(12,jo,5,6,"mat-form-field",9),t.ALo(13,"async"),t.YNc(14,Ro,6,8,"mat-form-field",10),t.ALo(15,"async"),t.TgZ(16,"mat-form-field",11)(17,"mat-select",12),t.NdJ("ngModelChange",function(l){return i.setOptions({capacity:l})}),t.ALo(18,"async"),t.YNc(19,$o,2,2,"mat-option",13),t.qZA()(),t.YNc(20,zo,5,6,"mat-form-field",14),t.ALo(21,"async"),t.qZA()()(),t.TgZ(22,"div",15),t.YNc(23,Wo,3,4,"ng-container",16),t.ALo(24,"async"),t.qZA(),t.YNc(25,ti,10,5,"div",17),t.YNc(26,ni,4,1,"ng-template",null,18,t.W1O),t.YNc(28,oi,3,0,"ng-template",null,19,t.W1O)),2&n){const a=t.MAs(27);let l,r,c;t.xp6(1),t.Q6J("routerLink",t.DdM(19,ii)),t.xp6(11),t.Q6J("ngIf",(null==(l=t.lcZ(13,9,i.buildings))?null:l.length)>1),t.xp6(2),t.Q6J("ngIf",(null==(r=t.lcZ(15,11,i.levels))?null:r.length)>0),t.xp6(3),t.Q6J("ngModel",null==(c=t.lcZ(18,13,i.options))?null:c.capacity),t.xp6(2),t.Q6J("ngForOf",i.quick_capacities),t.xp6(1),t.Q6J("ngIf",t.lcZ(21,15,i.features).length),t.xp6(3),t.Q6J("ngIf",!t.lcZ(24,17,i.loading))("ngIfElse",a),t.xp6(2),t.Q6J("ngIf",i.multiple)}},dependencies:[u.sg,u.O5,b.o,T.ey,A.VK,A.OP,A.p6,Z.KE,W.gD,f.lW,f.zs,F.Ou,m.JJ,m.On,C.yS,Yo,u.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}[filters][_ngcontent-%COMP%]{background-color:#007ac8}\n/*# sourceMappingURL=find.component.ts-angular-inline--81.css.map*/"]}),o})();var si=p(9685),li=p(2193);function ri(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"date"),t.ALo(3,"date"),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.AsE(" at ",t.xi3(2,2,n.form.value.date,"shortTime")," ~ ",t.xi3(3,5,n.form.value+60*n.form.value.duration*1e3,"shortTime")," ")}}function ci(o,s){if(1&o&&(t.TgZ(0,"div",20)(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"button",21),t._uU(4," Map "),t.qZA()()),2&o){const n=s.$implicit;t.xp6(2),t.AsE("",n.display_name||n.name," [",(null==n.level?null:n.level.display_name)||(null==n.level?null:n.level.name),"]")}}function pi(o,s){if(1&o&&(t.TgZ(0,"div",22),t._UZ(1,"a-user-avatar",23),t.TgZ(2,"span"),t._uU(3),t.qZA()()),2&o){const n=s.$implicit;t.xp6(1),t.Q6J("user",n),t.xp6(2),t.Oqu(n.name||n.email)}}function mi(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1,"Confirm"),t.qZA())}function ui(o,s){1&o&&t._UZ(0,"mat-spinner",24),2&o&&t.Q6J("diameter",24)}const Xe=function(){return["/book","spaces","find"]},ve=function(){return["/book","spaces","form"]};let di=(()=>{class o{constructor(n){var i=this;this._state=n,this.show_spaces=!1,this.show_people=!1,this.loading=!1,this.postForm=(0,x.Z)(function*(){i.loading=!0,yield i._state.postForm().catch(a=>(0,_.cB)(a instanceof Object?a.message||"Bad Request":a)),i.loading=!1})}get form(){return this._state.form}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(J.MH))},o.\u0275cmp=t.Xpm({type:o,selectors:[["space-flow-confirm"]],decls:59,vars:33,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],[1,"flex","flex-col","items-center","space-y-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],[1,"text-xl","uppercase","font-medium","w-full","my-4"],[1,"flex","items-center","py-2","space-x-2","border-b","border-gray-200","w-full"],[1,"p-2","rounded-full","bg-gray-300","mr-2"],[1,"flex-1","truncate"],[4,"ngIf"],["mat-button","",1,"clear","underline",3,"routerLink"],[1,"border-b","border-gray-200","w-full"],[1,"flex","items-center","py-2","space-x-2"],["mat-button","",1,"clear","bg-transparent","border-none","underline",3,"disabled","click"],["list","",1,"overflow-hidden"],["class","flex items-center h-10 pl-12",4,"ngFor","ngForOf"],["class","flex items-center h-12 pl-12 space-x-2",4,"ngFor","ngForOf"],["mat-button","","confirm","",1,"w-32",3,"disabled","click"],["class","mx-auto",3,"diameter",4,"ngIf"],[1,"flex","items-center","h-10","pl-12"],["mat-button","",1,"bg-transparent","border-none","underline"],[1,"flex","items-center","h-12","pl-12","space-x-2"],[1,"text-sm",3,"user"],[1,"mx-auto",3,"diameter"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"a",1)(2,"div",2)(3,"app-icon",3),t._uU(4,"arrow_back"),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"Back"),t.qZA()()()(),t.TgZ(7,"div",5)(8,"h2",6),t._uU(9," Your meeting details "),t.qZA(),t.TgZ(10,"div",7)(11,"div",8)(12,"app-icon"),t._uU(13,"event"),t.qZA()(),t.TgZ(14,"div",9),t._uU(15),t.ALo(16,"date"),t.YNc(17,ri,4,8,"span",10),t.qZA(),t.TgZ(18,"a",11),t._uU(19,"Edit"),t.qZA()(),t.TgZ(20,"div",7)(21,"div",8)(22,"app-icon"),t._uU(23,"schedule"),t.qZA()(),t.TgZ(24,"div",9),t._uU(25),t.ALo(26,"duration"),t.qZA(),t.TgZ(27,"a",11),t._uU(28," Edit "),t.qZA()(),t.TgZ(29,"div",12)(30,"div",13)(31,"div",8)(32,"app-icon"),t._uU(33,"place"),t.qZA()(),t.TgZ(34,"div",9),t._uU(35),t.qZA(),t.TgZ(36,"button",14),t.NdJ("click",function(){return i.show_spaces=!i.show_spaces}),t._uU(37),t.qZA(),t.TgZ(38,"a",11),t._uU(39,"Edit"),t.qZA()(),t.TgZ(40,"div",15),t.YNc(41,ci,5,2,"div",16),t.qZA()(),t.TgZ(42,"div",12)(43,"div",13)(44,"div",8)(45,"app-icon"),t._uU(46,"group"),t.qZA()(),t.TgZ(47,"div",9),t._uU(48),t.qZA(),t.TgZ(49,"button",14),t.NdJ("click",function(){return i.show_people=!i.show_people}),t._uU(50),t.qZA(),t.TgZ(51,"a",11),t._uU(52,"Edit"),t.qZA()(),t.TgZ(53,"div",15),t.YNc(54,pi,4,2,"div",17),t.qZA()(),t.TgZ(55,"button",18),t.NdJ("click",function(){return i.postForm()}),t.YNc(56,mi,2,0,"span",10),t.YNc(57,ui,1,1,"mat-spinner",19),t.qZA()(),t._uU(58," < ")),2&n){let a,l,r,c,d,h,g,v;t.xp6(1),t.Q6J("routerLink",t.DdM(28,Xe)),t.xp6(14),t.hij(" ",t.xi3(16,23,i.form.value.date,"longDate")," "),t.xp6(2),t.Q6J("ngIf",!i.form.value.all_day),t.xp6(1),t.Q6J("routerLink",t.DdM(29,ve)),t.xp6(7),t.hij(" ",i.form.value.all_day?"All Day":t.lcZ(26,26,i.form.value.duration)," "),t.xp6(2),t.Q6J("routerLink",t.DdM(30,ve)),t.xp6(8),t.hij(" ",null==(a=i.form.get("resources"))||null==a.value?null:a.value.length," Space(s) "),t.xp6(1),t.Q6J("disabled",!(null!=(l=i.form.get("resources"))&&null!=l.value&&l.value.length)),t.xp6(1),t.hij(" ",i.show_spaces?"Hide":"Show"," "),t.xp6(1),t.Q6J("routerLink",t.DdM(31,Xe)),t.xp6(2),t.Udp("height",i.show_spaces?2.5*(null==(r=i.form.get("resources"))||null==r.value?null:r.value.length)+"rem":"0"),t.xp6(1),t.Q6J("ngForOf",null==(c=i.form.get("resources"))?null:c.value),t.xp6(7),t.hij(" ",(null==(d=i.form.get("attendees"))||null==d.value?null:d.value.length)||0," Attendee(s) "),t.xp6(1),t.Q6J("disabled",!(null!=(h=i.form.get("attendees"))&&null!=h.value&&h.value.length)),t.xp6(1),t.hij(" ",i.show_people?"Hide":"Show"," "),t.xp6(1),t.Q6J("routerLink",t.DdM(32,ve)),t.xp6(2),t.Udp("height",i.show_people?3*(null==(g=i.form.get("attendees"))||null==g.value?null:g.value.length)+"rem":"0"),t.xp6(1),t.Q6J("ngForOf",null==(v=i.form.get("attendees"))?null:v.value),t.xp6(1),t.Q6J("disabled",i.loading),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",i.loading)}},dependencies:[u.sg,u.O5,b.o,si.k,f.lW,f.zs,F.Ou,C.yS,u.uU,li.u],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}[list][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=confirm.component.ts-angular-inline--69.css.map*/"]}),o})();function _i(o,s){1&o&&(t.ynx(0),t._UZ(1,"space-flow-find"),t.BQk())}function gi(o,s){1&o&&(t.ynx(0),t._UZ(1,"space-flow-confirm"),t.BQk())}function fi(o,s){if(1&o&&(t.ynx(0),t._UZ(1,"flow-success",4),t.BQk()),2&o){const n=t.oxw();t.xp6(1),t.Q6J("calendar",null==n.last_success?null:n.last_success.host)}}function hi(o,s){1&o&&(t.ynx(0),t._UZ(1,"space-flow-form"),t.BQk())}let vi=(()=>{class o extends _.KG{constructor(n,i){super(),this._state=n,this._route=i}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.loadForm(),this._state.form||this._state.newForm(),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView(n.get("success"))}))}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(J.MH),t.Y36(C.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["placeos-book-space-flow"]],features:[t.qOj],decls:6,vars:4,consts:[[1,"bg-white","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"calendar"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.ynx(1,1),t.YNc(2,_i,2,0,"ng-container",2),t.YNc(3,gi,2,0,"ng-container",2),t.YNc(4,fi,2,1,"ng-container",2),t.YNc(5,hi,2,0,"ng-container",3),t.BQk(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngSwitch",i.view),t.xp6(1),t.Q6J("ngSwitchCase","find"),t.xp6(1),t.Q6J("ngSwitchCase","confirm"),t.xp6(1),t.Q6J("ngSwitchCase","success"))},dependencies:[u.RF,u.n9,u.ED,Qo,ai,di,pe],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}\n/*# sourceMappingURL=space-flow.component.ts-angular-inline--68.css.map*/"]}),o})();var xi=p(1992),bi=p(8461);const Ci=function(){return{}};function wi(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){const l=t.CHM(n).$implicit,r=t.oxw(2);return t.KtG(r.setDate(l.id))}),t.ALo(1,"async"),t.TgZ(2,"p",15),t._uU(3),t.qZA(),t.TgZ(4,"p",16),t._uU(5),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"p",17),t._uU(8,"Available"),t.qZA()()}if(2&o){const n=s.$implicit,i=t.oxw(2);let a;t.ekj("selected",n.id===(null==(a=t.lcZ(1,4,i.options))?null:a.date)),t.xp6(3),t.Oqu(n.name),t.xp6(2),t.hij(" ",(t.lcZ(6,6,i.counts)||t.DdM(8,Ci))[n.id]||"0"," ")}}function Zi(o,s){if(1&o&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function Ti(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",18)(1,"mat-form-field",19)(2,"mat-select",20),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.setLevel(null==a?null:a.id))}),t.ALo(3,"async"),t.YNc(4,Zi,2,2,"mat-option",21),t.ALo(5,"async"),t.qZA()()()}if(2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("ngModel",t.lcZ(3,2,n.level)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(5,4,n.levels))}}function yi(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){const l=t.CHM(n).$implicit,r=t.oxw(2);return t.KtG(r.setActive(l))}),t.ALo(1,"async"),t.TgZ(2,"div",24),t._uU(3),t.qZA(),t.TgZ(4,"div",25),t._uU(5),t.qZA()()}if(2&o){const n=s.$implicit,i=t.oxw(2);let a;t.ekj("active",(null==(a=t.lcZ(1,4,i.active_space))?null:a.id)===n.id),t.xp6(3),t.hij("Bay No. ",n.name,""),t.xp6(2),t.hij(" ",i.levelName(n.zone_id)," ")}}function Mi(o,s){1&o&&(t.TgZ(0,"p",29),t._uU(1," Note that your existing parking space reservation will be replaced "),t.qZA())}function ki(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",26)(1,"p"),t._uU(2),t.ALo(3,"async"),t.qZA(),t.YNc(4,Mi,2,0,"p",27),t.ALo(5,"async"),t.TgZ(6,"button",28),t.NdJ("click",function(){t.CHM(n);const a=t.oxw(2);return t.KtG(a.reserveSpace())}),t._uU(7," Reserve Space "),t.qZA()()}if(2&o){const n=t.oxw(2);let i;t.xp6(2),t.hij(" Parking Bay No. ",t.lcZ(3,2,n.active_space).name," selected. "),t.xp6(2),t.Q6J("ngIf",null==(i=t.lcZ(5,4,n.existing))?null:i.length)}}function Ai(o,s){if(1&o&&(t.TgZ(0,"div",30)(1,"p"),t._uU(2),t.ALo(3,"async"),t.ALo(4,"async"),t.qZA()()),2&o){const n=t.oxw(2);let i;t.xp6(2),t.hij(" Parking is not available for ",(null==(i=t.lcZ(3,1,n.building))?null:i.display_name)||(null==(i=t.lcZ(4,3,n.building))?null:i.name)," ")}}function Fi(o,s){if(1&o&&(t.TgZ(0,"div",2)(1,"div",3),t.YNc(2,wi,9,9,"button",4),t.qZA(),t.TgZ(3,"div",5)(4,"div",6),t.YNc(5,Ti,6,6,"div",7),t.ALo(6,"async"),t.TgZ(7,"p"),t._uU(8),t.ALo(9,"async"),t.qZA(),t.YNc(10,yi,6,6,"button",8),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"div",9),t._UZ(13,"i-map",10),t.ALo(14,"async"),t.ALo(15,"async"),t.ALo(16,"async"),t.ALo(17,"async"),t.ALo(18,"async"),t.ALo(19,"async"),t.ALo(20,"async"),t._UZ(21,"explore-zoom-controls",11),t.qZA(),t.YNc(22,ki,8,6,"div",12),t.ALo(23,"async"),t.YNc(24,Ai,5,5,"div",13),t.ALo(25,"async"),t.qZA()()),2&o){const n=t.oxw();let i,a,l,r,c;t.xp6(2),t.Q6J("ngForOf",n.dates),t.xp6(3),t.Q6J("ngIf",(null==(i=t.lcZ(6,13,n.levels))?null:i.length)>1),t.xp6(3),t.hij("",null==(a=t.lcZ(9,15,n.available))?null:a.length," space(s) available"),t.xp6(2),t.Q6J("ngForOf",t.lcZ(11,17,n.available)),t.xp6(3),t.Q6J("src",t.lcZ(14,19,n.url))("zoom",null==(l=t.lcZ(15,21,n.positions))?null:l.zoom)("center",null==(r=t.lcZ(16,23,n.positions))?null:r.center)("styles",t.lcZ(17,25,n.styles))("features",t.lcZ(18,27,n.features))("actions",t.lcZ(19,29,n.actions))("labels",t.lcZ(20,31,n.labels)),t.xp6(9),t.Q6J("ngIf",t.lcZ(23,33,n.active_space)),t.xp6(2),t.Q6J("ngIf",!(null!=(c=t.lcZ(25,35,n.levels))&&c.length))}}function Oi(o,s){1&o&&(t.TgZ(0,"div",32),t._UZ(1,"mat-spinner",33),t.TgZ(2,"p"),t._uU(3,"Reserving parking space..."),t.qZA()())}function Ui(o,s){if(1&o&&(t.YNc(0,Oi,4,0,"div",31),t.ALo(1,"async")),2&o){const n=t.oxw();let i;t.Q6J("ngIf",!(null!=(i=t.lcZ(1,1,n.levels))&&i.length))}}let Ii=(()=>{class o extends _.KG{constructor(n){super(),this._details=n,this.zoom=1,this.ratio=1,this.subscription("zoom",this._details.zoom$?.subscribe(i=>this.zoom=i)),this.subscription("ratio",this._details.ratio$?.subscribe(i=>this.ratio=i))}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(me.ui))},o.\u0275cmp=t.Xpm({type:o,selectors:[["space-ping"]],features:[t.qOj],decls:2,vars:2,consts:[[1,"absolute","inset-0","pointer-events-auto"],[1,"absolute","inset-0","animate-ping","border-4","border-green-600"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.qZA()),2&n&&t.Udp("transform","scale("+i.zoom*i.ratio+")")},encapsulation:2}),o})(),qi=(()=>{class o extends _.KG{constructor(n,i,a,l,r){var c;super(),c=this,this._state=n,this._parking=i,this._org=a,this._booking=l,this._router=r,this.url=this._state.map_url,this.styles=this._state.map_styles,this.positions=this._state.map_positions,this.features=this._state.map_features,this.actions=this._state.map_actions,this.labels=this._state.map_labels,this.building=this._org.active_building,this.level=this._state.level,this.levels=this._parking.levels,this.available=this._parking.available_spaces,this.counts=this._parking.week_availablility,this.options=this._parking.options,this.existing=this._parking.existing_event,this.loading=this._booking.loading,this.active_space=new k.X(null),this.dates=new Array(7).fill(0).map((d,h)=>({id:(0,he.Z)((0,L.Z)(Date.now(),h)).valueOf(),name:(0,Je.Z)((0,L.Z)(Date.now(),h),"EEE, dd MMM"),available:0})),this.setDate=d=>this._parking.setOptions({date:d}),this.setLevel=d=>this._state.setLevel(d),this.reserveSpace=(0,x.Z)(function*(){const d=yield c._parking.existing_event.pipe((0,oe.q)(1)).toPromise();d.length&&c._booking.form.patchValue({id:d[0].id}),yield c._booking.postForm(),c._router.navigate(["book","parking","success"])})}levelName(n){const i=this._org.levelWithID([n]);return i?.display_name||i?.name||""}setActive(n){n===this.active_space.getValue()?this.active_space.next(null):(this._booking.form.patchValue({asset_id:n.id,asset_name:n.name}),this.active_space.next(n))}ngOnInit(){var n=this;return(0,x.Z)(function*(){yield n._org.initialised.pipe((0,M.P)(i=>i)).toPromise(),n._state.reset(),n.subscription("levels",n._parking.levels.subscribe(i=>{n._state.setLevel(i[0]?.id)})),n.subscription("spaces",n._parking.available_spaces.subscribe(i=>{n._state.setActions("parking_spaces",(i||[]).map(a=>({id:a.map_id,action:"click",callback:()=>n.setActive(a)})))})),n.subscription("active_space",n.active_space.subscribe(i=>{if(!i)return n._state.setFeatures("parking_space",[]);n._state.setFeatures("parking_space",[{location:i.map_id,content:Ii,full_size:!0,z_index:0}])}))})()}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(G.ck),t.Y36(G.pi),t.Y36(S.w7),t.Y36(D.fy),t.Y36(C.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["parking-flow-map"]],features:[t._Bn([G.pi]),t.qOj],decls:4,vars:4,consts:[["class","w-full h-full flex flex-col items-center relative",4,"ngIf","ngIfElse"],["load_state",""],[1,"w-full","h-full","flex","flex-col","items-center","relative"],[1,"p-4","flex","items-center","justify-center","bg-secondary","w-full","shadow","z-10","text-white","space-x-2"],["matRipple","","class","border border-white flex flex-col items-center justify-center h-24 w-28 rounded",3,"selected","click",4,"ngFor","ngForOf"],[1,"flex","w-full","h-1/2","flex-1","z-0"],[1,"p-2","sm:w-[18rem]","w-full","h-full","bg-gray-50","shadow","z-10","overflow-auto","space-y-2"],["class","bg-white sticky top-0 w-full z-10",4,"ngIf"],["matRipple","","class","flex items-center justify-between bg-white rounded-lg border border-gray-200 p-2 w-full",3,"active","click",4,"ngFor","ngForOf"],[1,"bg-gray-200","flex-1","w-1/2","h-full","z-0","relative","hidden","sm:block"],[3,"src","zoom","center","styles","features","actions","labels"],[1,"absolute","bottom-0","right-0"],["class","absolute left-1/2 bottom-2 -translate-x-1/2 bg-white shadow rounded p-4 flex flex-col space-y-2",4,"ngIf"],["class","absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-50",4,"ngIf"],["matRipple","",1,"border","border-white","flex","flex-col","items-center","justify-center","h-24","w-28","rounded",3,"click"],[1,"mb-2","font-medium"],[1,"text-2xl"],[1,"text-sm"],[1,"bg-white","sticky","top-0","w-full","z-10"],["appearance","outline",1,"w-full","h-[3.25rem]"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["matRipple","",1,"flex","items-center","justify-between","bg-white","rounded-lg","border","border-gray-200","p-2","w-full",3,"click"],[1,"text-lg"],[1,"opacity-60"],[1,"absolute","left-1/2","bottom-2","-translate-x-1/2","bg-white","shadow","rounded","p-4","flex","flex-col","space-y-2"],["class","p-2 rounded text-sm max-w-[20rem] text-center text-pending leading-tight",4,"ngIf"],["mat-button","",3,"click"],[1,"p-2","rounded","text-sm","max-w-[20rem]","text-center","text-pending","leading-tight"],[1,"absolute","inset-0","bg-white/80","flex","flex-col","items-center","justify-center","z-50"],["class","absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-50 space-y-2",4,"ngIf"],[1,"absolute","inset-0","bg-white/80","flex","flex-col","items-center","justify-center","z-50","space-y-2"],["diameter","32"]],template:function(n,i){if(1&n&&(t.YNc(0,Fi,26,37,"div",0),t.ALo(1,"async"),t.YNc(2,Ui,2,3,"ng-template",null,1,t.W1O)),2&n){const a=t.MAs(3);t.Q6J("ngIf",!t.lcZ(1,2,i.loading))("ngIfElse",a)}},dependencies:[u.sg,u.O5,De.p,T.ey,Z.KE,W.gD,f.lW,F.Ou,T.wG,m.JJ,m.On,bi.s,u.Ov],styles:[".active[_ngcontent-%COMP%]{background-color:var(--primary)!important;color:#fff}.selected[_ngcontent-%COMP%]{background-color:#fff!important;color:#000d}\n/*# sourceMappingURL=parking-flow-map.component.ts-angular-inline--84.css.map*/"]}),o})(),Ni=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["parking-flow-confirm"]],decls:0,vars:0,template:function(n,i){}}),o})();function Ji(o,s){1&o&&(t.ynx(0),t._UZ(1,"parking-flow-confirm"),t.BQk())}function Di(o,s){if(1&o&&(t.ynx(0),t._UZ(1,"flow-success",4),t.BQk()),2&o){const n=t.oxw();t.xp6(1),t.Q6J("calendar",null==n.last_success?null:n.last_success.host)}}function Si(o,s){1&o&&(t.ynx(0),t._UZ(1,"parking-flow-map"),t.BQk())}let Li=(()=>{class o extends _.KG{constructor(n,i){super(),this._state=n,this._route=i}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.setOptions({type:"parking"}),this._state.loadForm(),this._state.form||this._state.newForm(),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView(n.get("success"))}))}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(D.fy),t.Y36(C.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["placeos-book-parking-flow"]],features:[t.qOj],decls:5,vars:3,consts:[[1,"bg-white","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["route","parking","type","parking",3,"calendar"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.ynx(1,1),t.YNc(2,Ji,2,0,"ng-container",2),t.YNc(3,Di,2,1,"ng-container",2),t.YNc(4,Si,2,0,"ng-container",3),t.BQk(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngSwitch",i.view),t.xp6(1),t.Q6J("ngSwitchCase","confirm"),t.xp6(1),t.Q6J("ngSwitchCase","success"))},dependencies:[u.RF,u.n9,u.ED,qi,Ni,pe],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}\n/*# sourceMappingURL=parking-flow.component.ts-angular-inline--83.css.map*/"]}),o})();var xe=p(4865);function Qi(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.dismiss())}),t.TgZ(1,"app-icon"),t._uU(2,"close"),t.qZA()()}}function Pi(o,s){1&o&&t._UZ(0,"mat-spinner",15)}function Ei(o,s){if(1&o&&(t.TgZ(0,"mat-chip")(1,"app-icon",22),t._uU(2,"business"),t.qZA(),t._uU(3),t.qZA()),2&o){const n=s.$implicit;t.xp6(3),t.hij(" ",n.name||n.email," ")}}function Yi(o,s){if(1&o&&(t.TgZ(0,"section",16)(1,"app-icon",4),t._uU(2,"done"),t.qZA(),t.TgZ(3,"div",5)(4,"h3"),t._uU(5),t.SDv(6,17),t._uU(7," "),t.qZA(),t.TgZ(8,"div",18)(9,"mat-chip-list",19,20),t.YNc(11,Ei,4,1,"mat-chip",21),t.qZA()()()()),2&o){const n=t.oxw();t.xp6(5),t.hij(" ",n.event.attendees.length," "),t.xp6(1),t.pQV(n.event.attendees.length),t.QtT(6),t.xp6(5),t.Q6J("ngForOf",n.event.attendees)}}function Bi(o,s){if(1&o&&(t.TgZ(0,"section",23)(1,"app-icon",4),t._uU(2,"done"),t.qZA(),t.TgZ(3,"div",5)(4,"h3"),t._uU(5,"Booked Room"),t.qZA(),t.TgZ(6,"div",6)(7,"app-icon"),t._uU(8,"meeting_room"),t.qZA(),t.TgZ(9,"div"),t._uU(10),t.qZA()(),t.TgZ(11,"div",6)(12,"app-icon"),t._uU(13,"place"),t.qZA(),t.TgZ(14,"div"),t._uU(15),t.qZA()()()()),2&o){const n=t.oxw();t.xp6(10),t.AsE(" ",(null==n.space.level?null:n.space.level.display_name)||(null==n.space.level?null:n.space.level.name),", ",n.space.display_name||n.space.name," "),t.xp6(5),t.Oqu(n.location)}}function ji(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.postForm())}),t._uU(1," Confirm "),t.qZA()}}function Gi(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.cancelPost())}),t._uU(1," Undo "),t.qZA()}}let et=(()=>{class o extends _.KG{constructor(n,i,a){var l;super(),l=this,this._event_form=n,this._org=i,this._sheet_ref=a,this.show_close=!1,this.loading=this._event_form.loading,this.postForm=(0,x.Z)(function*(){yield l._event_form.postForm(),l.dismiss(!0)}),this.cancelPost=()=>this._event_form.cancelPostForm(),this.dismiss=r=>this._sheet_ref?.dismiss(r)}get event(){return this._event_form.form.value}get space(){return this.event.resources[0]}get location(){return this._org.buildings.find(n=>n.id===this.space?.level?.parent_id)?.address||""}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(J.MH),t.Y36(S.w7),t.Y36(xe.oL,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["meeting-flow-confirm"]],inputs:{show_close:"show_close"},features:[t.qOj],decls:32,vars:24,consts:function(){let s;return s=$localize`:␟4b21718d2cf1162c66e915d086412945cb82f5c5␟2503133629493199843:{VAR_PLURAL, plural, =1 {attendee } other {attendees }}`,s=t.Zx4(s,{VAR_PLURAL:"\ufffd0\ufffd"}),[["mat-icon-button","",3,"click",4,"ngIf"],[1,"flex","items-center","justify-between","px-2"],["diameter","32",4,"ngIf"],["period","",1,"flex","space-x-1","px-2"],[1,"text-success"],["details","",1,"leading-6"],[1,"flex","items-center","space-x-2"],["date",""],["time",""],["attendees","","class","flex space-x-1 px-2",4,"ngIf"],["spaces","","class","flex space-x-1 px-2",4,"ngIf"],[1,"p-2","w-full","border-t","border-gray-200","mt-4"],["mat-button","","class","w-full",3,"click",4,"ngIf"],["mat-button","","class","inverse w-full",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],["diameter","32"],["attendees","",1,"flex","space-x-1","px-2"],s,["attendee-list",""],["aria-label","User selection"],["chipList",""],[4,"ngFor","ngForOf"],[1,"mr-2"],["spaces","",1,"flex","space-x-1","px-2"],["mat-button","",1,"w-full",3,"click"],["mat-button","",1,"inverse","w-full",3,"click"]]},template:function(n,i){1&n&&(t.YNc(0,Qi,3,0,"button",0),t.TgZ(1,"header",1)(2,"h2"),t._uU(3,"Confirm Meeting booking"),t.qZA(),t.YNc(4,Pi,1,0,"mat-spinner",2),t.ALo(5,"async"),t.qZA(),t.TgZ(6,"section",3)(7,"app-icon",4),t._uU(8,"done"),t.qZA(),t.TgZ(9,"div",5)(10,"h3"),t._uU(11),t.qZA(),t.TgZ(12,"div",6)(13,"app-icon"),t._uU(14,"calendar_today"),t.qZA(),t.TgZ(15,"div",7),t._uU(16),t.ALo(17,"date"),t.qZA()(),t.TgZ(18,"div",6)(19,"app-icon"),t._uU(20,"schedule"),t.qZA(),t.TgZ(21,"div",8),t._uU(22),t.ALo(23,"date"),t.ALo(24,"date"),t.qZA()()()(),t.YNc(25,Yi,12,3,"section",9),t.YNc(26,Bi,16,3,"section",10),t.TgZ(27,"footer",11),t.YNc(28,ji,2,0,"button",12),t.ALo(29,"async"),t.YNc(30,Gi,2,0,"button",13),t.ALo(31,"async"),t.qZA()),2&n&&(t.Q6J("ngIf",i.show_close),t.xp6(4),t.Q6J("ngIf",t.lcZ(5,9,i.loading)),t.xp6(7),t.Oqu(i.event.title||"~Untitled~"),t.xp6(5),t.Oqu(t.xi3(17,11,i.event.date,"fullDate")),t.xp6(6),t.hij(" ",i.event.all_day?"All Day":t.xi3(23,14,i.event.date,"shortTime")+" - "+t.xi3(24,17,i.event.date+60*i.event.duration*1e3,"h:mm a (z)")," "),t.xp6(3),t.Q6J("ngIf",i.event.attendees.length),t.xp6(1),t.Q6J("ngIf",null==i.space?null:i.space.id),t.xp6(2),t.Q6J("ngIf",!t.lcZ(29,20,i.loading)),t.xp6(2),t.Q6J("ngIf",t.lcZ(31,22,i.loading)))},dependencies:[u.sg,u.O5,b.o,f.lW,F.Ou,Y.qn,Y.HS,u.Ov,u.uU],styles:["section[_ngcontent-%COMP%] > app-icon[_ngcontent-%COMP%]{font-size:1.5rem}h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:medium;margin-bottom:.5rem}h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:medium;margin:.5rem 0}\n/*# sourceMappingURL=meeting-flow-confirm.component.ts-angular-inline--86.css.map*/"]}),o})();var Ri=p(1360),$i=p(1839),Hi=p(6813);const zi=function(){return{standalone:!0}};function Ki(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"label",4),t._uU(4,"Add Title"),t.TgZ(5,"span"),t._uU(6,"*"),t.qZA()(),t.TgZ(7,"mat-form-field",5),t._UZ(8,"input",6),t.TgZ(9,"mat-error"),t._uU(10,"Meeting title is required."),t.qZA()()(),t.TgZ(11,"div",3)(12,"label",7),t._uU(13,"Date"),t.TgZ(14,"span"),t._uU(15,"*"),t.qZA()(),t.TgZ(16,"a-date-field",8),t._uU(17," Date and time must be in the future "),t.qZA()()(),t.TgZ(18,"div",9)(19,"div",10)(20,"label",11),t._uU(21,"Start Time"),t.TgZ(22,"span"),t._uU(23,"*"),t.qZA()(),t.TgZ(24,"a-time-field",12),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw();return t.KtG(l.form.patchValue({date:a}))}),t.qZA()(),t.TgZ(25,"div",10)(26,"label",13),t._uU(27,"End Time"),t.TgZ(28,"span"),t._uU(29,"*"),t.qZA()(),t._UZ(30,"a-duration-field",14),t.qZA()()()}if(2&o){const n=t.oxw();t.Q6J("formGroup",n.form),t.xp6(24),t.Q6J("ngModel",n.form.value.date)("ngModelOptions",t.DdM(5,zi)),t.xp6(6),t.Q6J("time",null==n.form||null==n.form.value?null:n.form.value.date)("max",n.max_duration)}}let Vi=(()=>{class o{constructor(n){this._settings=n}get max_duration(){return this._settings.get("app.events.max_duration")||480}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(_.gb))},o.\u0275cmp=t.Xpm({type:o,selectors:[["meeting-form-details"]],inputs:{form:"form"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"flex","items-center","flex-wrap","sm:space-x-2"],[1,"flex-1","min-w-[256px]"],["for","title"],["appearance","outline",1,"w-full"],["matInput","","name","title","formControlName","title","placeholder","e.g. Team Meeting"],["for","date"],["name","date","formControlName","date"],[1,"flex","items-center","space-x-2"],[1,"flex-1","w-1/3"],["for","start-time"],["name","start-time",3,"ngModel","ngModelOptions","ngModelChange"],["for","end-time"],["name","end-time","formControlName","duration",3,"time","max"]],template:function(n,i){1&n&&t.YNc(0,Ki,31,6,"div",0),2&n&&t.Q6J("ngIf",i.form)},dependencies:[u.O5,Z.TO,Z.KE,I.Nt,ae.Q,se.B,le.N,m.Fj,m.JJ,m.JL,m.On,m.sg,m.u],encapsulation:2}),o})();const Wi=["confirm_ref"];let Xi=(()=>{class o{constructor(n,i,a){this._state=n,this._router=i,this._bottom_sheet=a,this.clearForm=()=>this._state.clearForm(),this.viewConfirm=()=>{if(!this.form.valid)return(0,_.cB)(`Some fields are invalid. [${(0,_.RD)(this.form).join(", ")}]`);this.sheet_ref=this._bottom_sheet.open(et),this.sheet_ref.instance.show_close=!0,this.sheet_ref.afterDismissed().subscribe(l=>{l&&(this._router.navigate(["/book","meeting","success"]),this._state.setView("success"))})}}get form(){return this._state.form}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(J.MH),t.Y36(C.F0),t.Y36(xe.ch))},o.\u0275cmp=t.Xpm({type:o,selectors:[["meeting-flow-form"]],viewQuery:function(n,i){if(1&n&&t.Gf(Wi,5),2&n){let a;t.iGM(a=t.CRH())&&(i._confirm_ref=a.first)}},decls:56,vars:2,consts:[[1,"h-full","w-full","bg-gray-100","overflow-auto"],[1,"max-w-full","w-[768px]","mx-auto","sm:my-4","bg-white","border","border-gray-300"],[1,"w-full","p-4","sm:py-4","sm:px-16","text-2xl","font-medium","border-b","border-gray-300"],[1,"p-0","sm:py-4","sm:px-16","divide-y","divide-gray-300","space-y-2",3,"formGroup"],[1,"p-2"],[1,"space-x-2","flex","items-center","mb-4"],[1,"bg-gray-100","rounded-full","h-6","w-6","flex","items-center","justify-center"],[1,"text-xl"],[3,"form"],["formControlName","attendees"],["formControlName","resources"],[1,"space-x-2","flex","items-center"],["formControlName","catering"],["formControlName","assets"],[1,"w-full","flex","flex-col"],["for","notes"],["appearance","outline"],["matInput","","name","notes","formControlName","body","placeholder","Notes..."],[1,"flex","flex-col","sm:flex-row","items-center","sm:space-x-2","p-2"],["mat-button","","confirm","",1,"mb-2","sm:mb-0","w-full","sm:w-auto",3,"click"],["mat-button","","clear-form","",1,"inverse","w-full","sm:w-auto",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3," Book Meeting "),t.qZA(),t.TgZ(4,"form",3)(5,"section",4)(6,"h3",5)(7,"div",6),t._uU(8," 1 "),t.qZA(),t.TgZ(9,"div",7),t._uU(10,"Details"),t.qZA()(),t._UZ(11,"meeting-form-details",8),t.qZA(),t.TgZ(12,"section",4)(13,"h3",5)(14,"div",6),t._uU(15," 2 "),t.qZA(),t.TgZ(16,"div",7),t._uU(17,"Attendees"),t.qZA()(),t._UZ(18,"a-user-list-field",9),t.qZA(),t.TgZ(19,"section",4)(20,"h3",5)(21,"div",6),t._uU(22," 3 "),t.qZA(),t.TgZ(23,"div",7),t._uU(24,"Room"),t.qZA()(),t._UZ(25,"space-list-field",10),t.qZA(),t.TgZ(26,"section",4)(27,"h3",11)(28,"div",6),t._uU(29," 4 "),t.qZA(),t.TgZ(30,"div",7),t._uU(31,"Catering"),t.qZA()(),t._UZ(32,"catering-list-field",12),t.qZA(),t.TgZ(33,"section",4)(34,"h3",11)(35,"div",6),t._uU(36," 5 "),t.qZA(),t.TgZ(37,"div",7),t._uU(38,"Assets"),t.qZA()(),t._UZ(39,"asset-list-field",13),t.qZA(),t.TgZ(40,"section",4)(41,"h3",5)(42,"div",6),t._uU(43," 6 "),t.qZA(),t.TgZ(44,"div",7),t._uU(45,"Notes"),t.qZA()(),t.TgZ(46,"div",14)(47,"label",15),t._uU(48,"General information for attendees"),t.qZA(),t.TgZ(49,"mat-form-field",16),t._UZ(50,"textarea",17),t.qZA()()(),t.TgZ(51,"section",18)(52,"button",19),t.NdJ("click",function(){return i.viewConfirm()}),t._uU(53," Confirm Meeting "),t.qZA(),t.TgZ(54,"button",20),t.NdJ("click",function(){return i.clearForm()}),t._uU(55," Clear Form "),t.qZA()()()()()),2&n&&(t.xp6(4),t.Q6J("formGroup",i.form),t.xp6(7),t.Q6J("form",i.form))},dependencies:[Z.KE,f.lW,I.Nt,re.E,Ri.k,$i.S,Hi.M,m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u,Vi],encapsulation:2}),o})();function ea(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.AsE(" room booking for ",(null==n.space?null:n.space.level.display_name)||(null==n.space?null:n.space.level.name),", ",(null==n.space?null:n.space.display_name)||(null==n.space?null:n.space.name)," ")}}function ta(o,s){1&o&&(t.TgZ(0,"span"),t._uU(1,"meeting"),t.qZA())}const na=function(){return["/"]};let oa=(()=>{class o{constructor(n){this._event_form=n}get last_event(){return this._event_form.last_success}get space(){return this.last_event.space}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(J.MH))},o.\u0275cmp=t.Xpm({type:o,selectors:[["meeting-flow-success"]],decls:16,vars:16,consts:[[1,"absolute","inset-0","bg-white","flex","flex-col","z-50"],[1,"flex-1","flex","flex-col","items-center","justify-center","space-y-2","p-8"],[1,"text-2xl","font-medium"],["src","assets/icons/success.svg"],[1,"text-center"],[4,"ngIf"],[1,"p-2","w-full","border-t","border-gray-200","mt-4"],["button","","mat-button","",1,"w-full",3,"routerLink"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"main",1)(2,"h2",2),t._uU(3,"Booking Confirmed!"),t.qZA(),t._UZ(4,"img",3),t.TgZ(5,"p",4),t._uU(6," Your "),t.YNc(7,ea,2,2,"span",5),t.YNc(8,ta,2,0,"span",5),t._uU(9),t.ALo(10,"date"),t.ALo(11,"date"),t.ALo(12,"date"),t.qZA()(),t.TgZ(13,"footer",6)(14,"a",7),t._uU(15," Great, thanks! "),t.qZA()()()),2&n&&(t.xp6(7),t.Q6J("ngIf",i.space),t.xp6(1),t.Q6J("ngIf",!i.space),t.xp6(1),t.lnq(" has been successfully booked for the ",t.xi3(10,6,i.last_event.date,"mediumDate")," at ",t.xi3(11,9,i.last_event.date,"shortTime"),"-",t.xi3(12,12,i.last_event.date+60*i.last_event.duration*1e3,"shortTime"),". "),t.xp6(5),t.Q6J("routerLink",t.DdM(15,na)))},dependencies:[u.O5,f.zs,C.yS,u.uU]}),o})();function ia(o,s){1&o&&t._UZ(0,"meeting-flow-success")}function aa(o,s){1&o&&t._UZ(0,"meeting-flow-confirm")}function sa(o,s){1&o&&t._UZ(0,"meeting-flow-form")}let la=(()=>{class o extends _.KG{constructor(n,i){super(),this._state=n,this._route=i}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.loadForm(),this._state.form||this._state.newForm(),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView("success")}))}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(J.MH),t.Y36(C.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["placeos-book-meeting-flow"]],features:[t.qOj],decls:4,vars:3,consts:[[1,"bg-white","h-full","w-full","z-50",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.YNc(1,ia,1,0,"meeting-flow-success",1),t.YNc(2,aa,1,0,"meeting-flow-confirm",1),t.YNc(3,sa,1,0,"meeting-flow-form",2),t.qZA()),2&n&&(t.Q6J("ngSwitch",i.view),t.xp6(1),t.Q6J("ngSwitchCase","success"),t.xp6(1),t.Q6J("ngSwitchCase","confirm"))},dependencies:[u.RF,u.n9,u.ED,Xi,et,oa],styles:["[_nghost-%COMP%]{height:100%;width:100%}\n/*# sourceMappingURL=meeting-flow.component.ts-angular-inline--85.css.map*/"]}),o})();var tt=p(8560);function ra(o,s){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"section",2),t._UZ(2,"image-carousel",3),t.TgZ(3,"button",4),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.close.emit())}),t.TgZ(4,"app-icon"),t._uU(5,"arrow_back"),t.qZA()(),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.toggleFav.emit())}),t.TgZ(7,"app-icon"),t._uU(8),t.qZA()()(),t.TgZ(9,"div",6)(10,"section",7)(11,"div")(12,"h2",8),t._uU(13),t.qZA(),t.TgZ(14,"p"),t._uU(15),t.qZA()(),t.TgZ(16,"a-counter",9),t.NdJ("ngModelChange",function(a){t.CHM(n);const l=t.oxw();return t.KtG(l.item.amount=a)}),t.qZA()(),t._UZ(17,"hr"),t.TgZ(18,"section",10)(19,"h2",11),t._uU(20,"Details"),t.qZA(),t.TgZ(21,"div",12)(22,"p"),t._uU(23),t.qZA()()()(),t.TgZ(24,"div",13)(25,"button",14),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return a.active=!a.active,t.KtG(a.activeChange.emit(a.active))}),t.TgZ(26,"div",15)(27,"app-icon",16),t._uU(28),t.qZA(),t.TgZ(29,"p"),t._uU(30),t.qZA()()()(),t.BQk()}if(2&o){const n=t.oxw();t.xp6(2),t.Q6J("images",n.images),t.xp6(4),t.ekj("text-white",!n.fav)("text-blue-400",n.fav),t.xp6(2),t.Oqu(n.fav?"favorite":"favorite_border"),t.xp6(5),t.hij(" ",n.item.name," "),t.xp6(2),t.hij("",n.item.count," Available"),t.xp6(1),t.Q6J("ngModel",n.item.amount)("min",1)("max",n.item.count||2),t.xp6(7),t.Oqu(n.item.description||"No description"),t.xp6(2),t.ekj("inverse",n.active),t.xp6(3),t.Oqu(n.active?"remove":"add"),t.xp6(2),t.hij(" ",n.active?"Remove this asset":"Add this asset"," ")}}function ca(o,s){1&o&&(t.TgZ(0,"div",17)(1,"p",18),t._uU(2," Select a asset to view it's details "),t.qZA()())}let be=(()=>{class o{constructor(){this.active=!1,this.fav=!1,this.toggleFav=new t.vpe,this.activeChange=new t.vpe,this.close=new t.vpe}get images(){return this.item?.images.map(n=>n.url)||[]}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["asset-details"]],inputs:{item:"item",active:"active",fav:"fav"},outputs:{toggleFav:"toggleFav",activeChange:"activeChange",close:"close"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["empty_state",""],["image","",1,"relative","w-full","h-64","bg-black/20"],[1,"absolute","inset-0",3,"images"],["mat-icon-button","","close","",1,"absolute","top-2","left-2","bg-black/40","sm:hidden","text-white",3,"click"],["mat-icon-button","","fav","",1,"absolute","top-2","right-2","bg-black/40",3,"click"],[1,"p-2","space-y-2","flex-1","h-1/2","overflow-auto"],["actions","",1,"z-0","flex","items-center","justify-between"],[1,"text-xl","font-medium","mb-2","mt-4"],[3,"ngModel","min","max","ngModelChange"],["details","",1,"space-y-2"],[1,"text-xl","font-medium"],[1,"flex","items-center","space-x-2"],[1,"p-2","border-t","border-gray-200","shadow"],["mat-button","","select","",1,"w-full",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-2xl"],["empty","",1,"p-16","flex","flex-col","items-center","justify-center","space-y-2"],[1,"opacity-30","text-center"]],template:function(n,i){if(1&n&&(t.YNc(0,ra,31,16,"ng-container",0),t.YNc(1,ca,3,0,"ng-template",null,1,t.W1O)),2&n){const a=t.MAs(2);t.Q6J("ngIf",i.item)("ngIfElse",a)}},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:30%;min-width:20rem;height:100%;min-height:65vh;background:white}\n/*# sourceMappingURL=asset-details.component.ts-angular-inline--1.css.map*/"]}),o})(),nt=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["asset-filters"]],decls:0,vars:0,template:function(n,i){}}),o})(),ot=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["asset-filters-display"]],decls:0,vars:0,template:function(n,i){}}),o})();var it=p(4139),pa=p(5038),ma=p(7418);class ua{constructor(s={}){this.amount=1,this.id=s.id||"",this.name=s.name||"",this.category=s.category||"",this.images=s.images||[],this.barcode=s.barcode||"",this.brand=s.brand||"",this.size=s.size||"Small",this.description=s.description||"",this.specifications=s.specifications||{},this.purchase_details=s.purchase_details||[],this.consumables=s.consumables||[],this.general_details=s.general_details||[],this.invoices=s.invoices||[],this.count=s.count??0,this.locations=s.locations||[],this.amount=s.amount??1}}var fa=p(354);let ha=(()=>{class o{constructor(){this._options=new k.X({date:Date.now()}),this._search=new k.X(""),this._loading=new k.X(""),this.search=this._search.asObservable(),this.loading=this._loading.asObservable(),this.asset_list=(0,it.of)(0).pipe((0,ge.w)(()=>(this._loading.next(this._loading.getValue()+"[Assets]"),function da(o){const s=(0,pa.U)({q:o});return(0,$.U2M)(`/api/engine/v1/assets${s||""}`).pipe((0,N.U)(n=>n.map(i=>new ua(i))),(0,ma.K)(n=>(0,it.of)([])))}())),(0,fe.b)(n=>this._loading.next(this._loading.getValue().replace(/\[Assets\]/g,""))),(0,H.d)(1)),this.asset_bookings=this._options.pipe((0,ce.b)(300),(0,ge.w)(({zone:n,date:i})=>(this._loading.next(this._loading.getValue()+"[Bookings]"),(0,fa.F2)({zones:n||"",period_start:(0,te.Z)((0,he.Z)(i)),period_end:(0,te.Z)((0,ie.Z)(i)),type:"asset-request"}))),(0,fe.b)(n=>this._loading.next(this._loading.getValue().replace(/\[Bookings\]/g,""))),(0,H.d)(1)),this.available_assets=(0,E.aj)([this.asset_list,this.asset_bookings]).pipe((0,N.U)(([n,i])=>n.filter(a=>!i.find(l=>l.asset_id===a.id))),(0,H.d)(1)),this.filtered_assets=(0,E.aj)([this._search,this.available_assets]).pipe((0,N.U)(([n,i])=>{const a=n.toLowerCase();return i.filter(l=>l.name.toLowerCase().includes(a)||l.description.toLowerCase().includes(a))}),(0,H.d)(1))}setSearch(n){this._search.next(`${n}`)}setOptions(n){this._options.next({...this._options.value,...n})}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function va(o,s){1&o&&(t.TgZ(0,"div",17)(1,"app-icon"),t._uU(2,"done"),t.qZA()())}function xa(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"li",9)(1,"button",10),t.NdJ("click",function(){const l=t.CHM(n).$implicit,r=t.oxw(3);return t.KtG(r.selectAsset(l))}),t.TgZ(2,"div",11),t.YNc(3,va,3,0,"div",12),t.qZA(),t.TgZ(4,"div",13)(5,"div",14),t._uU(6),t.qZA(),t.TgZ(7,"div",15)(8,"p"),t._uU(9),t.qZA()()()(),t.TgZ(10,"button",16),t.NdJ("click",function(){const l=t.CHM(n).$implicit,r=t.oxw(3);return t.KtG(r.toggleFav.emit(l))}),t.TgZ(11,"app-icon"),t._uU(12),t.qZA()()()}if(2&o){const n=s.$implicit,i=t.oxw(3);t.xp6(3),t.Q6J("ngIf",i.selected.includes(n.id)),t.xp6(3),t.hij(" ",n.name||"Asset"," "),t.xp6(3),t.hij(" ",n.count<1?2:n.count," Available "),t.xp6(1),t.ekj("text-blue-400",i.isFavourite(n.id)),t.xp6(2),t.Oqu(i.isFavourite(n.id)?"favorite":"favorite_border")}}function ba(o,s){if(1&o&&(t.TgZ(0,"ul",7),t.YNc(1,xa,13,6,"li",8),t.ALo(2,"async"),t.qZA()),2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,n.assets))}}function Ca(o,s){if(1&o&&(t.ynx(0),t.YNc(1,ba,3,3,"ul",6),t.ALo(2,"async"),t.BQk()),2&o){const n=t.oxw(),i=t.MAs(9);let a;t.xp6(1),t.Q6J("ngIf",null==(a=t.lcZ(2,2,n.assets))?null:a.length)("ngIfElse",i)}}function wa(o,s){1&o&&(t.TgZ(0,"div",18)(1,"p",19),t._uU(2," No available assets for selected time and/or filters "),t.qZA()())}function Za(o,s){1&o&&(t.TgZ(0,"div",20),t._UZ(1,"mat-spinner",21),t.TgZ(2,"p",22),t._uU(3,"Finding available assets..."),t.qZA()()),2&o&&(t.xp6(1),t.Q6J("diameter",32))}let Ce=(()=>{class o{constructor(n){this._asset_state=n,this.selected="",this.favorites=[],this.toggleFav=new t.vpe,this.onSelect=new t.vpe,this.loading=this._asset_state.loading,this.assets=this._asset_state.filtered_assets}isFavourite(n){return this.favorites.includes(n)}selectAsset(n){this.onSelect.emit(n)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(ha))},o.\u0275cmp=t.Xpm({type:o,selectors:[["asset-list"]],inputs:{selected:"selected",favorites:"favorites"},outputs:{toggleFav:"toggleFav",onSelect:"onSelect"},decls:12,vars:7,consts:[[1,"w-full","h-full","overflow-auto"],[1,"font-bold","px-2"],["count","",1,"text-sm","opacity-60","mb-4","px-2"],[4,"ngIf","ngIfElse"],["empty_state",""],["load_state",""],["class","list-style-none space-y-2 p-2",4,"ngIf","ngIfElse"],[1,"list-style-none","space-y-2","p-2"],["asset","","class","relative p-2 rounded-lg w-full shadow border bg-white border-gray-200",4,"ngFor","ngForOf"],["asset","",1,"relative","p-2","rounded-lg","w-full","shadow","border","bg-white","border-gray-200"],["matRipple","","select","",1,"w-full","h-full","flex","items-center",3,"click"],[1,"relative","w-16","h-16","rounded-xl","bg-black/20","mr-4"],["class","absolute top-1 left-1 border border-white bg-black/50 rounded-full h-6 w-6 flex items-center justify-center text-white",4,"ngIf"],[1,"space-y-2","text-left"],[1,"font-medium"],[1,"flex","items-center","text-sm","space-x-2"],["mat-icon-button","","fav","",1,"absolute","top-1","right-1",3,"click"],[1,"absolute","top-1","left-1","border","border-white","bg-black/50","rounded-full","h-6","w-6","flex","items-center","justify-center","text-white"],["empty","",1,"p-16","flex","flex-col","items-center","justify-center","space-y-2"],[1,"opacity-30","text-center"],["loading","",1,"p-16","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"],[1,"opacity-30"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"h3",1),t._uU(2,"Results"),t.qZA(),t.TgZ(3,"p",2),t._uU(4),t.ALo(5,"async"),t.qZA(),t.YNc(6,Ca,3,4,"ng-container",3),t.ALo(7,"async"),t.qZA(),t.YNc(8,wa,3,0,"ng-template",null,4,t.W1O),t.YNc(10,Za,4,1,"ng-template",null,5,t.W1O)),2&n){const a=t.MAs(11);let l;t.xp6(4),t.hij(" ",(null==(l=t.lcZ(5,3,i.assets))?null:l.length)||0," result(s) found "),t.xp6(2),t.Q6J("ngIf",!t.lcZ(7,5,i.loading))("ngIfElse",a)}},styles:["[_nghost-%COMP%]{width:100%;height:100%}\n/*# sourceMappingURL=asset-list.component.ts-angular-inline--2.css.map*/"]}),o})();var Ta=p(2581);let ya=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.ez,sn.W9,m.u5,me.Kk]}),o})();t.B6R(tt.v,[u.O5,b.o,f.lW,w.ZT,be,nt,ot,Ce],[]),t.B6R(be,[u.O5,de.R,m.JJ,m.On,b.o,Ta.K,f.lW],[]),t.B6R(Ce,[u.sg,u.O5,b.o,f.lW,F.Ou],[u.Ov]);const Ma=[{path:"",component:gt,children:[{path:"code",component:bt},{path:"desks",redirectTo:"desks/form"},{path:"desks/:step",component:an},{path:"spaces",redirectTo:"spaces/form"},{path:"spaces/:step",component:vi},{path:"meeting",redirectTo:"meeting/form"},{path:"meeting/:step",component:la},{path:"parking",redirectTo:"parking/form"},{path:"parking/:step",component:Li},{path:"*",redirectTo:"spaces/form"}]},{path:"*",redirectTo:"spaces/form"}];let ka=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.ez,xi.v,m.u5,ya,G.P2,m.UX,ut,xe._r,C.Bz.forChild(Ma)]}),o})()}}]);
//# sourceMappingURL=apps_workplace_src_app_book_book_module_ts.js.map