"use strict";(self.webpackChunkworkplace=self.webpackChunkworkplace||[]).push([["apps_workplace_src_app_book_book_module_ts"],{5364:(Mi,se,d)=>{d.r(se),d.d(se,{BookModule:()=>yi});var u=d(6362),p=d(587),E=d(6484),Re=d(9502),t=d(6723),w=d(1130),He=d(4128);const ze=["button"],Ve=["*"],re=new t.OlP("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS"),le=new t.OlP("MatButtonToggleGroup"),We={provide:p.JU,useExisting:(0,t.Gpc)(()=>pe),multi:!0};let ce=0;class de{constructor(s,n){this.source=s,this.value=n}}let pe=(()=>{class i{constructor(n,o){this._changeDetector=n,this._vertical=!1,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name="mat-button-toggle-group-"+ce++,this.valueChange=new t.vpe,this.change=new t.vpe,this.appearance=o&&o.appearance?o.appearance:"standard"}get name(){return this._name}set name(n){this._name=n,this._buttonToggles&&this._buttonToggles.forEach(o=>{o.name=this._name,o._markForCheck()})}get vertical(){return this._vertical}set vertical(n){this._vertical=(0,E.Ig)(n)}get value(){const n=this._selectionModel?this._selectionModel.selected:[];return this.multiple?n.map(o=>o.value):n[0]?n[0].value:void 0}set value(n){this._setSelectionByValue(n),this.valueChange.emit(this.value)}get selected(){const n=this._selectionModel?this._selectionModel.selected:[];return this.multiple?n:n[0]||null}get multiple(){return this._multiple}set multiple(n){this._multiple=(0,E.Ig)(n)}get disabled(){return this._disabled}set disabled(n){this._disabled=(0,E.Ig)(n),this._buttonToggles&&this._buttonToggles.forEach(o=>o._markForCheck())}ngOnInit(){this._selectionModel=new Re.Ov(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(n=>n.checked))}writeValue(n){this.value=n,this._changeDetector.markForCheck()}registerOnChange(n){this._controlValueAccessorChangeFn=n}registerOnTouched(n){this._onTouched=n}setDisabledState(n){this.disabled=n}_emitChangeEvent(){const n=this.selected,o=Array.isArray(n)?n[n.length-1]:n,a=new de(o,this.value);this._controlValueAccessorChangeFn(a.value),this.change.emit(a)}_syncButtonToggle(n,o,a=!1,r=!1){!this.multiple&&this.selected&&!n.checked&&(this.selected.checked=!1),this._selectionModel?o?this._selectionModel.select(n):this._selectionModel.deselect(n):r=!0,r?Promise.resolve().then(()=>this._updateModelValue(a)):this._updateModelValue(a)}_isSelected(n){return this._selectionModel&&this._selectionModel.isSelected(n)}_isPrechecked(n){return void 0!==this._rawValue&&(this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(o=>null!=n.value&&o===n.value):n.value===this._rawValue)}_setSelectionByValue(n){this._rawValue=n,this._buttonToggles&&(this.multiple&&n?(Array.isArray(n),this._clearSelection(),n.forEach(o=>this._selectValue(o))):(this._clearSelection(),this._selectValue(n)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(n=>n.checked=!1)}_selectValue(n){const o=this._buttonToggles.find(a=>null!=a.value&&a.value===n);o&&(o.checked=!0,this._selectionModel.select(o))}_updateModelValue(n){n&&this._emitChangeEvent(),this.valueChange.emit(this.value)}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(t.sBO),t.Y36(re,8))},i.\u0275dir=t.lG2({type:i,selectors:[["mat-button-toggle-group"]],contentQueries:function(n,o,a){if(1&n&&t.Suo(a,ue,5),2&n){let r;t.iGM(r=t.CRH())&&(o._buttonToggles=r)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(n,o){2&n&&(t.uIk("aria-disabled",o.disabled),t.ekj("mat-button-toggle-vertical",o.vertical)("mat-button-toggle-group-appearance-standard","standard"===o.appearance))},inputs:{appearance:"appearance",name:"name",vertical:"vertical",value:"value",multiple:"multiple",disabled:"disabled"},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[t._Bn([We,{provide:le,useExisting:i}])]}),i})();const Xe=(0,w.Kr)(class{});let ue=(()=>{class i extends Xe{constructor(n,o,a,r,l,c){super(),this._changeDetectorRef=o,this._elementRef=a,this._focusMonitor=r,this._isSingleSelector=!1,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new t.vpe;const m=Number(l);this.tabIndex=m||0===m?m:null,this.buttonToggleGroup=n,this.appearance=c&&c.appearance?c.appearance:"standard"}get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(n){this._appearance=n}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(n){const o=(0,E.Ig)(n);o!==this._checked&&(this._checked=o,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(n){this._disabled=(0,E.Ig)(n)}ngOnInit(){const n=this.buttonToggleGroup;this._isSingleSelector=n&&!n.multiple,this.id=this.id||"mat-button-toggle-"+ce++,this._isSingleSelector&&(this.name=n.name),n&&(n._isPrechecked(this)?this.checked=!0:n._isSelected(this)!==this._checked&&n._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const n=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),n&&n._isSelected(this)&&n._syncButtonToggle(this,!1,!1,!0)}focus(n){this._buttonElement.nativeElement.focus(n)}_onButtonClick(){const n=!!this._isSingleSelector||!this._checked;n!==this._checked&&(this._checked=n,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new de(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(le,8),t.Y36(t.sBO),t.Y36(t.SBq),t.Y36(He.tE),t.$8M("tabindex"),t.Y36(re,8))},i.\u0275cmp=t.Xpm({type:i,selectors:[["mat-button-toggle"]],viewQuery:function(n,o){if(1&n&&t.Gf(ze,5),2&n){let a;t.iGM(a=t.CRH())&&(o._buttonElement=a.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(n,o){1&n&&t.NdJ("focus",function(){return o.focus()}),2&n&&(t.uIk("aria-label",null)("aria-labelledby",null)("id",o.id)("name",null),t.ekj("mat-button-toggle-standalone",!o.buttonToggleGroup)("mat-button-toggle-checked",o.checked)("mat-button-toggle-disabled",o.disabled)("mat-button-toggle-appearance-standard","standard"===o.appearance))},inputs:{disableRipple:"disableRipple",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",appearance:"appearance",checked:"checked",disabled:"disabled"},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[t.qOj],ngContentSelectors:Ve,decls:6,vars:9,consts:[["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"id","disabled","click"],["button",""],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(n,o){if(1&n&&(t.F$t(),t.TgZ(0,"button",0,1),t.NdJ("click",function(){return o._onButtonClick()}),t.TgZ(2,"span",2),t.Hsn(3),t.qZA(),t.qZA(),t._UZ(4,"span",3),t._UZ(5,"span",4)),2&n){const a=t.MAs(1);t.Q6J("id",o.buttonId)("disabled",o.disabled||null),t.uIk("tabindex",o.disabled?-1:o.tabIndex)("aria-pressed",o.checked)("name",o.name||null)("aria-label",o.ariaLabel)("aria-labelledby",o.ariaLabelledby),t.xp6(5),t.Q6J("matRippleTrigger",a)("matRippleDisabled",o.disableRipple||o.disabled)}},directives:[w.wG],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:transparent}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.cdk-high-contrast-active .mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:.5}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}.cdk-high-contrast-active .mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.5}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;-moz-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{border-radius:inherit;pointer-events:none;opacity:0;top:0;left:0;right:0;bottom:0;position:absolute}.mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 36px}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}\n"],encapsulation:2,changeDetection:0}),i})(),Ke=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[w.BQ,w.si],w.BQ]}),i})();
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
var T=d(9504),Y=d(2658),et=d(4187),tt=d(6012);let nt=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["placeos-book"]],decls:5,vars:0,consts:[[1,"flex-1","flex","sm:flex-row","flex-col-reverse","h-1/2","z-10","relative"],[1,"relative","flex","flex-col","flex-1","h-1/2","sm:h-auto","overflow-hidden"]],template:function(n,o){1&n&&(t._UZ(0,"topbar"),t.TgZ(1,"div",0),t.TgZ(2,"main",1),t._UZ(3,"router-outlet"),t.qZA(),t.qZA(),t._UZ(4,"footer-menu"))},directives:[et.o,T.lC,tt.i],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}\n/*# sourceMappingURL=book.component.ts-angular-inline--52.css.map*/"]}),i})(),ot=(()=>{class i{static hasCamera(){return i.listCameras(!1).then(n=>!!n.length).catch(()=>!1)}static listCameras(n=!1){if(!navigator.mediaDevices)return Promise.resolve([]);let o=null;return(n?navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(a=>o=a).catch(()=>{}):Promise.resolve()).then(()=>navigator.mediaDevices.enumerateDevices()).then(a=>a.filter(r=>"videoinput"===r.kind).map((r,l)=>({id:r.deviceId,label:r.label||(0===l?"Default Camera":`Camera ${l+1}`)}))).finally(()=>{if(o)for(const a of o.getTracks())a.stop(),o.removeTrack(a)})}constructor(n,o,a=this._onDecodeError,r=this._calculateScanRegion,l="environment"){this.$video=n,this.$canvas=document.createElement("canvas"),this._onDecode=o,this._legacyCanvasSize=i.DEFAULT_CANVAS_SIZE,this._preferredCamera=l,this._active=!1,this._paused=!1,this._flashOn=!1,"number"==typeof a?(this._legacyCanvasSize=a,console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future")):this._onDecodeError=a,"number"==typeof r?(this._legacyCanvasSize=r,console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future")):this._calculateScanRegion=r,this._scanRegion=this._calculateScanRegion(n),this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),n.disablePictureInPicture=!0,n.playsInline=!0,n.muted=!0;let c=!1;n.hidden&&(n.hidden=!1,c=!0),document.body.contains(n)||(document.body.appendChild(n),c=!0),requestAnimationFrame(()=>{const m=window.getComputedStyle(n);"none"===m.display&&(n.style.setProperty("display","block","important"),c=!0),"visible"!==m.visibility&&(n.style.setProperty("visibility","visible","important"),c=!0),c&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),n.style.opacity=0,n.style.width=0,n.style.height=0)}),n.addEventListener("play",this._onPlay),n.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),this._qrEnginePromise=i.createQrEngine()}hasFlash(){let n=null;return(this.$video.srcObject?Promise.resolve(this.$video.srcObject.getVideoTracks()[0]):this._getCameraStream().then(({stream:o})=>(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),n=o,o.getVideoTracks()[0]))).then(o=>"torch"in o.getSettings()).catch(()=>!1).finally(()=>{if(n)for(const o of n.getTracks())o.stop(),n.removeTrack(o)})}isFlashOn(){return this._flashOn}toggleFlash(){return this._flashOn?this.turnFlashOff():this.turnFlashOn()}turnFlashOn(){return this._flashOn||(this._flashOn=!0,!this._active||this._paused)?Promise.resolve():this.hasFlash().then(n=>n?this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]}):Promise.reject("No flash available")).catch(()=>{throw this._flashOn=!1,e})}turnFlashOff(){if(this._flashOn)return this._flashOn=!1,this._restartVideoStream()}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),this.stop(),i._postWorkerMessage(this._qrEnginePromise,"close")}start(){return this._active&&!this._paused||("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,document.hidden)?Promise.resolve():(this._paused=!1,this.$video.srcObject?(this.$video.play(),Promise.resolve()):this._getCameraStream().then(({stream:n,facingMode:o})=>{this.$video.srcObject=n,this.$video.play(),this._setVideoMirror(o),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{}))}).catch(n=>{throw this._active=!1,n}))}stop(){this.pause(),this._active=!1}pause(n=!1){if(this._paused=!0,!this._active)return Promise.resolve(!0);this.$video.pause();const o=()=>{const a=this.$video.srcObject?this.$video.srcObject.getTracks():[];for(const r of a)r.stop(),this.$video.srcObject.removeTrack(r);this.$video.srcObject=null};return n?(o(),Promise.resolve(!0)):new Promise(a=>setTimeout(a,300)).then(()=>!!this._paused&&(o(),!0))}setCamera(n){return n===this._preferredCamera?Promise.resolve():(this._preferredCamera=n,this._restartVideoStream())}static scanImage(n,o=null,a=null,r=null,l=!1,c=!1){const m=a instanceof Worker;let _=Promise.all([a||i.createQrEngine(),i._loadImage(n)]).then(([x,g])=>{let Z;return a=x,[r,Z]=this._drawToCanvas(g,o,r,l),a instanceof Worker?(m||a.postMessage({type:"inversionMode",data:"both"}),new Promise((P,j)=>{let $,q,G;q=D=>{"qrResult"===D.data.type&&(a.removeEventListener("message",q),a.removeEventListener("error",G),clearTimeout($),null!==D.data.data?P(D.data.data):j(i.NO_QR_CODE_FOUND))},G=D=>{a.removeEventListener("message",q),a.removeEventListener("error",G),clearTimeout($),j("Scanner error: "+(D?D.message||D:"Unknown Error"))},a.addEventListener("message",q),a.addEventListener("error",G),$=setTimeout(()=>G("timeout"),1e4);const Ge=Z.getImageData(0,0,r.width,r.height);a.postMessage({type:"decode",data:Ge},[Ge.data.buffer])})):new Promise((P,j)=>{const $=setTimeout(()=>j("Scanner error: timeout"),1e4);a.detect(r).then(q=>{q.length?P(q[0].rawValue):j(i.NO_QR_CODE_FOUND)}).catch(q=>j("Scanner error: "+(q.message||q))).finally(()=>clearTimeout($))})});return o&&c&&(_=_.catch(()=>i.scanImage(n,null,a,r,l))),_=_.finally(()=>{m||i._postWorkerMessage(a,"close")}),_}setGrayscaleWeights(n,o,a,r=!0){i._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:n,green:o,blue:a,useIntegerApproximation:r})}setInversionMode(n){i._postWorkerMessage(this._qrEnginePromise,"inversionMode",n)}static createQrEngine(n=i.WORKER_PATH){return("BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats?BarcodeDetector.getSupportedFormats():Promise.resolve([])).then(o=>-1!==o.indexOf("qr_code")?new BarcodeDetector({formats:["qr_code"]}):new Worker(n))}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video)}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(n){const o=Math.min(n.videoWidth,n.videoHeight),a=Math.round(2/3*o);return{x:Math.round((n.videoWidth-a)/2),y:Math.round((n.videoHeight-a)/2),width:a,height:a,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_scanFrame(){if(!this._active||this.$video.paused||this.$video.ended)return!1;requestAnimationFrame(()=>{this.$video.readyState<=1?this._scanFrame():this._qrEnginePromise.then(n=>i.scanImage(this.$video,this._scanRegion,n,this.$canvas)).then(this._onDecode,n=>{this._active&&(-1!==(n.message||n).indexOf("service unavailable")&&(this._qrEnginePromise=i.createQrEngine()),this._onDecodeError(n))}).then(()=>this._scanFrame())})}_onDecodeError(n){n!==i.NO_QR_CODE_FOUND&&console.log(n)}_getCameraStream(){if(!navigator.mediaDevices)return Promise.reject("Camera not found.");const n="environment"===this._preferredCamera||"user"===this._preferredCamera?"facingMode":"deviceId",o=[{width:{min:1024}},{width:{min:768}},{}];return[...o.map(r=>Object.assign({},r,{[n]:{exact:this._preferredCamera}})),...o].reduceRight((r,l)=>()=>navigator.mediaDevices.getUserMedia({video:l,audio:!1}).then(c=>({stream:c,facingMode:this._getFacingMode(c)||(l.facingMode?this._preferredCamera:"environment"===this._preferredCamera?"user":"environment")})).catch(r),()=>Promise.reject("Camera not found."))()}_restartVideoStream(){const n=this._paused;return this.pause(!0).then(o=>{if(o&&!n&&this._active)return this.start()})}_setVideoMirror(n){this.$video.style.transform="scaleX("+("user"===n?-1:1)+")"}_getFacingMode(n){const o=n.getVideoTracks()[0];return o?/rear|back|environment/i.test(o.label)?"environment":/front|user|face/i.test(o.label)?"user":null:null}static _drawToCanvas(n,o=null,a=null,r=!1){a=a||document.createElement("canvas");const l=o&&o.x?o.x:0,c=o&&o.y?o.y:0,m=o&&o.width?o.width:n.width||n.videoWidth,_=o&&o.height?o.height:n.height||n.videoHeight;if(!r){const g=o&&o.downScaledWidth?o.downScaledWidth:m,Z=o&&o.downScaledHeight?o.downScaledHeight:_;a.width!==g&&(a.width=g),a.height!==Z&&(a.height=Z)}const x=a.getContext("2d",{alpha:!1});return x.imageSmoothingEnabled=!1,x.drawImage(n,l,c,m,_,0,0,a.width,a.height),[a,x]}static _loadImage(n){if(n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||window.ImageBitmap&&n instanceof window.ImageBitmap||window.OffscreenCanvas&&n instanceof window.OffscreenCanvas)return Promise.resolve(n);if(n instanceof Image)return i._awaitImageLoad(n).then(()=>n);if(n instanceof File||n instanceof Blob||n instanceof URL||"string"==typeof n){const o=new Image;return o.src=n instanceof File||n instanceof Blob?URL.createObjectURL(n):n,i._awaitImageLoad(o).then(()=>((n instanceof File||n instanceof Blob)&&URL.revokeObjectURL(o.src),o))}return Promise.reject("Unsupported image type.")}static _awaitImageLoad(n){return new Promise((o,a)=>{if(n.complete&&0!==n.naturalWidth)o();else{let r,l;r=()=>{n.removeEventListener("load",r),n.removeEventListener("error",l),o()},l=()=>{n.removeEventListener("load",r),n.removeEventListener("error",l),a("Image load error")},n.addEventListener("load",r),n.addEventListener("error",l)}})}static _postWorkerMessage(n,o,a){return Promise.resolve(n).then(r=>{r instanceof Worker&&r.postMessage({type:o,data:a})})}}return i.DEFAULT_CANVAS_SIZE=400,i.NO_QR_CODE_FOUND="No QR code found",i.WORKER_PATH="qr-scanner-worker.min.js",i})();var Q=d(4683),h=d(7317);const it=["video"];function at(i,s){1&i&&(t.TgZ(0,"div",11),t.TgZ(1,"h2",12),t._uU(2," Scan QR Code "),t.qZA(),t.TgZ(3,"span",13),t._uU(4," Scan the QR code outisde a PlaceOS room or space. "),t.qZA(),t.qZA())}function st(i,s){1&i&&(t.TgZ(0,"div",11),t.TgZ(1,"h2",12),t._uU(2," Enter Room ID "),t.qZA(),t.TgZ(3,"span",13),t._uU(4," Enter the room ID number outisde a PlaceOS room or space. "),t.qZA(),t.qZA())}let rt=(()=>{class i{constructor(n){this._router=n,this.is_scanning=!0,this.menu=new t.vpe(!1)}ngOnDestroy(){var n;this._video_el.nativeElement.srcObject&&this._video_el.nativeElement.srcObject.getTracks().forEach(o=>null==o?void 0:o.stop()),null===(n=this._qr_scanner)||void 0===n||n.stop()}ngOnInit(){var n;!(null===(n=navigator.mediaDevices)||void 0===n?void 0:n.getUserMedia)||(navigator.mediaDevices.getUserMedia({video:!0}).then(o=>this._video_el.nativeElement.srcObject=o).catch(o=>console.error("Unable to fetch media devices!",o)),this._qr_scanner=new ot(this._video_el.nativeElement,o=>this.handleQrCode(o)),this._qr_scanner.start())}handleQrCode(n){const o=n;if(o.indexOf("/#/")>0){const r=/[?&]([^=#]+)=([^&#]*)/g,l={};let c;for(;c=r.exec(o);)l[c[1]]=c[2];this._router.navigate([o.split("/#")[1].split("?")[0]],l)}}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(T.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["book-code-flow"]],viewQuery:function(n,o){if(1&n&&t.Gf(it,7),2&n){let a;t.iGM(a=t.CRH())&&(o._video_el=a.first)}},outputs:{menu:"menu"},decls:16,vars:9,consts:[[1,"flex-1","overflow-hidden","flex","items-center","justify-center","bg-black","relative"],["id","video",1,"min-w-full","min-h-full","object-cover"],["video",""],[1,"absolute","text-white","text-center","inset-0","flex","flex-col","items-center","justify-center"],["class","flex flex-col z-10 justify-end items-center relative",4,"ngIf"],[1,"flex","items-center","justify-center"],["box","",1,"rounded-2xl","h-64","w-64","transition-all","flex","items-center","justify-center","p-8","m-8","space-x-2"],[1,"uppercase"],["matInput","","name","booking-id","placeholder","e.g. 12102910",1,"border-none","bg-none","w-full","text-3xl","text-left",3,"ngModel","ngModelChange"],[1,"m-4","p-2","flex","items-center","space-x-2","bg-white","bg-opacity-50","rounded"],["mat-button","",3,"click"],[1,"flex","flex-col","z-10","justify-end","items-center","relative"],[1,"text-3xl","mb-1","uppercase","subpixel-antialiased"],[1,"mb-4"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"video",1,2),t.TgZ(3,"div",3),t.YNc(4,at,5,0,"div",4),t.YNc(5,st,5,0,"div",4),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"span",7),t._uU(9,"Booking ID"),t.qZA(),t.TgZ(10,"input",8),t.NdJ("ngModelChange",function(r){return o.room_code=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",9),t.TgZ(12,"button",10),t.NdJ("click",function(){return o.is_scanning=!0}),t._uU(13," Scan Code "),t.qZA(),t.TgZ(14,"button",10),t.NdJ("click",function(){return o.is_scanning=!1}),t._uU(15," Enter Code "),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(4),t.Q6J("ngIf",o.is_scanning),t.xp6(1),t.Q6J("ngIf",!o.is_scanning),t.xp6(2),t.ekj("input",!o.is_scanning),t.xp6(3),t.Q6J("ngModel",o.room_code),t.xp6(2),t.Tol("flex-1 text-black border-none w-40 "+(o.is_scanning?"bg-white":"bg-transparent hover:bg-white bg-opacity-50")),t.xp6(2),t.Tol("flex-1 text-black border-none w-40 "+(o.is_scanning?"bg-transparent hover:bg-white bg-opacity-50":"bg-white")))},directives:[u.O5,Q.Nt,p.Fj,p.JJ,p.On,h.lW],styles:["[_nghost-%COMP%]{width:100%;height:100vh;display:flex;flex-direction:column}[box][_ngcontent-%COMP%]{box-shadow:0 0 0 100vw #00000080}[box][_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:none}[box].input[_ngcontent-%COMP%]{width:32rem!important;max-width:calc(100% - 2rem)!important;padding:1rem!important;height:4rem!important;color:#000!important;background:white;box-shadow:0 0 0 100vw #000c}[box].input[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:initial}[box][_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:var(--heading-font);font-weight:500;text-transform:uppercase;letter-spacing:.05em}\n/*# sourceMappingURL=code-flow.component.ts-angular-inline--53.css.map*/"]}),i})();var v=d(4929),N=d(4509),f=d(6365),S=d(3619),A=d(5670),me=d(5148),R=d(7716),F=d(4505),lt=d(5722),B=d(6942),ge=d(823),b=d(5306),_e=d(6817),M=d(2796),fe=d(3200),J=d(312),he=d(2306),k=d(4770),H=d(1434),ve=d(7303),xe=d(1022),Ze=d(9697),be=d(6471);const I=function(){return{standalone:!0}};function ct(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",10),t.TgZ(1,"mat-button-toggle-group",11),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw(2).setOptions({group:"group"===a})}),t.ALo(2,"async"),t.TgZ(3,"mat-button-toggle",12),t._uU(4," Single "),t.qZA(),t.TgZ(5,"mat-button-toggle",13),t._uU(6," Group "),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);let o;t.xp6(1),t.Q6J("ngModel",null!=(o=t.lcZ(2,2,n.options))&&o.group?"group":"single")("ngModelOptions",t.DdM(4,I))}}function dt(i,s){if(1&i&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function pt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",4),t.TgZ(1,"label"),t._uU(2,"Building"),t.qZA(),t.TgZ(3,"mat-form-field",14),t.TgZ(4,"mat-select",15),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw(2).building=a})("ngModelChange",function(a){return t.CHM(n),t.oxw(2).setOptions({zone_id:null==a?null:a.id})}),t.YNc(5,dt,2,2,"mat-option",16),t.ALo(6,"async"),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);t.xp6(4),t.Q6J("ngModel",n.building)("ngModelOptions",t.DdM(5,I)),t.xp6(1),t.Q6J("ngForOf",t.lcZ(6,3,n.buildings))}}function ut(i,s){if(1&i&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function mt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",4),t.TgZ(1,"label"),t._uU(2,"Level"),t.qZA(),t.TgZ(3,"mat-form-field",14),t.TgZ(4,"mat-select",18),t.NdJ("ngModelChange",function(a){t.CHM(n);const r=t.oxw(2);return r.setOptions({zone_id:a||r.building.id})}),t.YNc(5,ut,2,2,"mat-option",16),t.ALo(6,"async"),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);t.xp6(4),t.Q6J("disabled",!n.building)("ngModelOptions",t.DdM(5,I)),t.xp6(1),t.Q6J("ngForOf",t.lcZ(6,3,n.levels))}}function gt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",3),t.TgZ(1,"div",19),t.TgZ(2,"label"),t._uU(3,"Start Time"),t.qZA(),t.TgZ(4,"a-time-field",20),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw(2).form.patchValue({date:a})}),t.qZA(),t.qZA(),t.TgZ(5,"div",19),t.TgZ(6,"label"),t._uU(7,"End Time"),t.qZA(),t._UZ(8,"a-duration-field",21),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);let o;t.xp6(4),t.Q6J("ngModel",n.form.value.date)("ngModelOptions",t.DdM(6,I)),t.xp6(4),t.Q6J("time",null==(o=n.form.get("date"))?null:o.value)("max",720)("min",60)("step",60)}}function _t(i,s){1&i&&(t.TgZ(0,"div",22),t.TgZ(1,"label"),t._uU(2,"Host"),t.qZA(),t._UZ(3,"a-user-search-field",23),t.qZA())}function ft(i,s){1&i&&(t.TgZ(0,"div",24),t.TgZ(1,"label"),t._uU(2,"Details"),t.qZA(),t.TgZ(3,"mat-form-field",25),t._UZ(4,"input",26),t.qZA(),t.qZA())}const Te=function(){return[]};function ht(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",24),t.TgZ(1,"label"),t._uU(2,"Group Members"),t.qZA(),t.TgZ(3,"a-user-list-field",27),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw(2).setOptions({members:a})}),t.ALo(4,"async"),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);let o;t.xp6(3),t.Q6J("simple",!0)("ngModel",(null==(o=t.lcZ(4,3,n.options))?null:o.members)||t.DdM(5,Te))("ngModelOptions",t.DdM(6,I))}}function vt(i,s){if(1&i&&(t.TgZ(0,"mat-option",17),t.TgZ(1,"span",31),t._uU(2),t.qZA(),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n),t.xp6(2),t.Oqu(n)}}function xt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",3),t.TgZ(1,"div",19),t.TgZ(2,"label"),t._uU(3,"Recurrence Period"),t.qZA(),t.TgZ(4,"mat-form-field",14),t.TgZ(5,"mat-select",28),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw(2).setOptions({pattern:a})}),t.ALo(6,"async"),t.TgZ(7,"mat-option",29),t._uU(8,"None"),t.qZA(),t.YNc(9,vt,3,2,"mat-option",16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div",19),t.TgZ(11,"label"),t._uU(12,"Recurrence End"),t.qZA(),t.TgZ(13,"a-date-field",30),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw(2).setOptions({recurr_end:a})}),t.ALo(14,"async"),t.ALo(15,"async"),t.ALo(16,"async"),t._uU(17," Date and time must be in the future "),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);let o,a,r;t.xp6(5),t.Q6J("ngModel",null==(o=t.lcZ(6,7,n.options))?null:o.recurrence_pattern)("ngModelOptions",t.DdM(15,I)),t.xp6(4),t.Q6J("ngForOf",n.recurrence_options),t.xp6(4),t.Q6J("disabled",!(null!=(a=t.lcZ(14,9,n.options))&&a.pattern)||"none"===(null==(a=t.lcZ(15,11,n.options))?null:a.pattern))("ngModel",(null==(r=t.lcZ(16,13,n.options))?null:r.recurr_end)||(null==n.form||null==n.form.value?null:n.form.value.date))("ngModelOptions",t.DdM(16,I))("to",n.book_until)}}function Zt(i,s){if(1&i&&(t.TgZ(0,"mat-option",34),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}function bt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",24),t.TgZ(1,"label"),t._uU(2,"Desk Features"),t.qZA(),t.TgZ(3,"mat-form-field",25),t.TgZ(4,"mat-select",32),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw(2).setOptions({features:a||[]})}),t.ALo(5,"async"),t.YNc(6,Zt,2,2,"mat-option",33),t.ALo(7,"async"),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);let o;t.xp6(4),t.Q6J("ngModel",(null==(o=t.lcZ(5,3,n.options))?null:o.features)||t.DdM(7,Te))("ngModelOptions",t.DdM(8,I)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(7,5,n.features))}}function Tt(i,s){if(1&i&&(t.TgZ(0,"form",1),t.YNc(1,ct,7,5,"div",2),t.TgZ(2,"div",3),t.TgZ(3,"div",4),t.TgZ(4,"label"),t._uU(5,"Date"),t.qZA(),t.TgZ(6,"a-date-field",5),t._uU(7," Date and time must be in the future "),t.qZA(),t.qZA(),t.YNc(8,pt,7,6,"div",6),t.ALo(9,"async"),t.YNc(10,mt,7,6,"div",6),t.ALo(11,"async"),t.qZA(),t.YNc(12,gt,9,7,"div",7),t.YNc(13,_t,4,0,"div",8),t.YNc(14,ft,5,0,"div",9),t.YNc(15,ht,5,7,"div",9),t.ALo(16,"async"),t.YNc(17,xt,18,17,"div",7),t.YNc(18,bt,8,9,"div",9),t.ALo(19,"async"),t.qZA()),2&i){const n=t.oxw();let o,a,r,l;t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.allow_groups),t.xp6(5),t.Q6J("to",n.book_until),t.xp6(2),t.Q6J("ngIf",(null==(o=t.lcZ(9,11,n.buildings))?null:o.length)>1),t.xp6(2),t.Q6J("ngIf",(null==(a=t.lcZ(11,13,n.levels))?null:a.length)>1),t.xp6(2),t.Q6J("ngIf",n.allow_time_changes),t.xp6(1),t.Q6J("ngIf",n.can_book_for_others),t.xp6(1),t.Q6J("ngIf",n.needs_reason),t.xp6(1),t.Q6J("ngIf",null==(r=t.lcZ(16,15,n.options))?null:r.group),t.xp6(2),t.Q6J("ngIf",n.can_recurr),t.xp6(1),t.Q6J("ngIf",null==(l=t.lcZ(19,17,n.features))?null:l.length)}}let Ce=(()=>{class i{constructor(n,o,a){this._state=n,this._org=o,this._settings=a,this.buildings=this._org.building_list,this.levels=this._org.active_levels,this.options=this._state.options,this.features=this._state.features,this.recurrence_options=["daily","weekly","monthly"],this.setOptions=r=>this._state.setOptions(r)}get building(){return this._org.building}set building(n){this._org.building=n}get can_book_for_others(){return this._settings.get("app.desks.can_book_for_others")}get can_recurr(){return this._settings.get("app.desks.recurrence_allowed")}get allow_groups(){return this._settings.get("app.desks.allow_groups")}get needs_reason(){return!0===this._settings.get("app.desks.needs_reason")}get allow_time_changes(){return!!this._settings.get("app.desks.allow_time_changes")}get book_until(){return(0,fe.Z)((0,J.Z)(Date.now(),this._settings.get("app.desks.available_period")||90))}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(N.fy),t.Y36(S.w7),t.Y36(f.gb))},i.\u0275cmp=t.Xpm({type:i,selectors:[["detailed-book-desks-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4",4,"ngIf"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/4"],["formControlName","date",3,"to"],["class","flex flex-col flex-1 w-full sm:w-1/4",4,"ngIf"],["class","flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],["class","flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],["class","flex flex-col flex-1 w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],[1,"w-full",3,"ngModel","ngModelOptions","ngModelChange"],["value","single",1,"w-1/2"],["value","group",1,"w-1/2"],["appearance","outline"],["placeholder","Select building",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","Any Level","ngModel","",3,"disabled","ngModelOptions","ngModelChange"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],[3,"ngModel","ngModelOptions","ngModelChange"],["formControlName","duration",3,"time","max","min","step"],[1,"flex","flex-col","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["formControlName","user"],[1,"flex","flex-col","flex-1","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["appearance","outline",1,"w-full"],["matInput","","formControlName","description","placeholder","Reason for booking..."],[3,"simple","ngModel","ngModelOptions","ngModelChange"],["placeholder","None",3,"ngModel","ngModelOptions","ngModelChange"],["value","none"],[3,"disabled","ngModel","ngModelOptions","to","ngModelChange"],[1,"capitalize"],["multiple","","placeholder","Any Feature",3,"ngModel","ngModelOptions","ngModelChange"],["class","capitalize",3,"value",4,"ngFor","ngForOf"],[1,"capitalize",3,"value"]],template:function(n,o){1&n&&t.YNc(0,Tt,20,19,"form",0),2&n&&t.Q6J("ngIf",o.form)},directives:[u.O5,p._Y,p.JL,p.sg,pe,p.JJ,p.On,ue,he.Q,p.u,k.KE,H.gD,u.sg,w.ey,ve.N,xe.B,Ze.d,Q.Nt,p.Fj,be.E],pipes:[u.Ov],styles:[""]}),i})();var we=d(9136),U=d(4742);function Ct(i,s){if(1&i&&(t.TgZ(0,"div",27),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.xp6(1),t.hij(" ",n," ")}}const wt=function(){return[]};function yt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"li",20),t.NdJ("click",function(){const r=t.CHM(n).$implicit;return t.oxw().setActiveDesk(r)}),t.TgZ(1,"app-icon",21),t._uU(2,"place"),t.qZA(),t.TgZ(3,"div",22),t.TgZ(4,"div",23),t._uU(5),t.qZA(),t.TgZ(6,"div",24),t._uU(7),t.qZA(),t.TgZ(8,"div",25),t.YNc(9,Ct,2,1,"div",26),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=s.$implicit,o=t.oxw();t.ekj("border-primary",(null==o.active_desk?null:o.active_desk.id)===n.id),t.uIk("desk-id",n.id),t.xp6(5),t.Oqu(n.name||n.id),t.xp6(2),t.hij(" ",(null==n.zone?null:n.zone.display_name)||(null==n.zone?null:n.zone.name)||"<No Level>"," "),t.xp6(2),t.Q6J("ngForOf",n.features||t.DdM(6,wt))}}function At(i,s){if(1&i&&(t.TgZ(0,"div",28),t._uU(1),t.ALo(2,"async"),t.ALo(3,"async"),t.qZA()),2&i){const n=t.oxw();let o;t.xp6(1),t.hij(" ",(null==(o=t.lcZ(2,1,n.level))?null:o.display_name)||(null==(o=t.lcZ(3,3,n.level))?null:o.name)," ")}}function Mt(i,s){if(1&i&&(t.TgZ(0,"div",29),t._UZ(1,"mat-spinner",30),t.TgZ(2,"p"),t._uU(3),t.ALo(4,"async"),t.qZA(),t.qZA()),2&i){const n=t.oxw();t.xp6(1),t.Q6J("diameter",32),t.xp6(2),t.Oqu(t.lcZ(4,2,n.loading))}}function kt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",31),t.TgZ(1,"div",32),t.TgZ(2,"div",23),t._uU(3),t.qZA(),t.TgZ(4,"div",24),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"div",33),t.TgZ(7,"button",34),t.NdJ("click",function(){return t.CHM(n),t.oxw().setActiveDesk(null)}),t._uU(8," Clear "),t.qZA(),t.TgZ(9,"button",35),t.NdJ("click",function(){return t.CHM(n),t.oxw().makeBooking()}),t._uU(10," Book "),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw();t.xp6(3),t.Oqu(n.active_desk.name),t.xp6(2),t.hij(" ",(null==n.active_desk.zone?null:n.active_desk.zone.display_name)||n.active_desk.zone.name||"<No Level>"," ")}}const qt=function(){return["/book","desks","form"]};let Ft=(()=>{class i extends f.KG{constructor(n,o){super(),this._state=n,this._explore=o,this.url=this._explore.map_url,this.styles=this._explore.map_styles,this.positions=this._explore.map_positions,this.features=this._explore.map_features,this.actions=this._explore.map_actions,this.labels=this._explore.map_labels,this.level=this._explore.level,this.desks=this._state.available_assets,this.loading=this._state.loading,this.form=this._state.form,this.option_details=(0,R.aj)([this._state.options,this.form.valueChanges.pipe((0,lt.O)({}))]).pipe((0,B.U)(([a])=>{var r,l;const c=this._state.form,m=(0,f.IO)({pattern:a.pattern,end:a.recurr_end,start:c.value.date,interval:1,days_of_week:-1}),_=`${(0,me.Z)(c.value.date,"dd MMM yyyy")}${a.pattern&&"none"!==a.pattern?", "+m:""}${a.group?", "+a.group:""}, ${(null===(r=a.features)||void 0===r?void 0:r.length)||"Any"} Feature${((null===(l=a.features)||void 0===l?void 0:l.length)||0)<2?"":"s"}`;return a.zone_id&&this._explore.setLevel(a.zone_id),_})),this._active_desk=new F.X(null),this.makeBooking=()=>this._state.confirmPost()}get active_desk(){return this._active_desk.getValue()}ngOnInit(){this.subscription("assets-statue",(0,R.aj)([this._state.assets,this._state.available_assets,this._active_desk]).pipe((0,ge.b)(200)).subscribe(([n,o])=>{const a={},r=[];for(const l of n){const c=l.bookable&&o.find(m=>m.id===l.id);a[`#${l.map_id||l.id}`]={fill:l.bookable?o.find(m=>m.id===l.id)?"#43a047":"#e53935":"#999",opacity:.6},c&&r.push({id:l.map_id||l.id,action:"click",callback:()=>this.setActiveDesk(l)})}this._explore.setStyles("desks",a),this._explore.setActions("desks",r),this._explore.setFeatures("desks",this.active_desk?[{location:this.active_desk.map_id||this.active_desk.id,content:'\n                    <span class="flex h-2 w-2 rounded-full absolute top-1/4 left-1/4 transform -translate-x-1/2 -translate-y-1/2" >\n                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>\n                        <span class="relative inline-flex rounded-full h-2 w-2 bg-primary"></span>\n                    </span>'}]:[])}))}setActiveDesk(n){var o,a,r;this._explore.setLevel(null===(o=null==n?void 0:n.zone)||void 0===o?void 0:o.id),this._active_desk.next(n),this._state.form.patchValue({asset_id:null==n?void 0:n.id,asset_name:n.name,map_id:(null==n?void 0:n.map_id)||(null==n?void 0:n.id),description:n.name,booking_type:"desk",zones:n.zone?[null===(a=n.zone)||void 0===a?void 0:a.parent_id,null===(r=n.zone)||void 0===r?void 0:r.id]:[]})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(N.fy),t.Y36(Y.ck))},i.\u0275cmp=t.Xpm({type:i,selectors:[["desk-flow-map"]],features:[t.qOj],decls:38,vars:42,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],[1,"flex","flex-col","flex-1","h-1/2","w-full"],[1,"text-2xl","px-4","pt-4","text-center"],[1,"my-4","mx-auto","w-[640px]","max-w-[calc(100vw-2rem)]",3,"matMenuTriggerFor"],["menu","matMenu"],[1,"pt-4","max-h-[65vh]","overflow-auto",3,"click"],[3,"form"],["listing","",1,"flex","flex-1","h-1/2","relative","space-x-2"],[1,"list-style-none","w-full","sm:w-[20rem]","bg-gray-100","p-2","pb-32","overflow-auto","h-full","rounded-tr-lg","space-y-2"],[1,"px-2","sticky","top-0","bg-gray-100","w-full","z-10"],["matRipple","","class","flex items-center p-2 bg-white rounded shadow cursor-pointer space-x-2 min-h-[5rem] border",3,"border-primary","click",4,"ngFor","ngForOf"],[1,"hidden","sm:block","flex-1","bg-gray-200","rounded-tl-lg","border-l","border-t","border-gray-300","relative","overflow-hidden","h-full"],[3,"src","zoom","center","styles","features","actions","labels","focus"],["class","absolute top-2 left-2 bg-white rounded-3xl h-10 px-3 flex items-center border border-gray-300",4,"ngIf"],["class","absolute inset-0 bg-white bg-opacity-60 flex flex-col items-center justify-center space-y-2 !m-0 z-20",4,"ngIf"],["selection","","class","absolute bottom-2 left-1/2 transform -translate-x-1/2 p-2 bg-white shadow rounded w-[24rem] max-w-[calc(100vw-1rem)] space-y-2 !m-0 border border-gray-200",4,"ngIf"],["matRipple","",1,"flex","items-center","p-2","bg-white","rounded","shadow","cursor-pointer","space-x-2","min-h-[5rem]","border",3,"click"],[1,"text-2xl"],[1,"flex","flex-col","w-1/2","flex-1"],["name","",1,""],["level","",1,"text-xs"],["features","",1,"w-full","flex","flex-wrap"],["class","text-xs bg-primary text-white rounded-xl px-2 py-1 mt-1 mr-2",4,"ngFor","ngForOf"],[1,"text-xs","bg-primary","text-white","rounded-xl","px-2","py-1","mt-1","mr-2"],[1,"absolute","top-2","left-2","bg-white","rounded-3xl","h-10","px-3","flex","items-center","border","border-gray-300"],[1,"absolute","inset-0","bg-white","bg-opacity-60","flex","flex-col","items-center","justify-center","space-y-2","!m-0","z-20"],[3,"diameter"],["selection","",1,"absolute","bottom-2","left-1/2","transform","-translate-x-1/2","p-2","bg-white","shadow","rounded","w-[24rem]","max-w-[calc(100vw-1rem)]","space-y-2","!m-0","border","border-gray-200"],[1,""],[1,"flex","items-center","space-x-2"],["mat-button","",1,"inverse","flex-1",3,"click"],["mat-button","",1,"flex-1",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"a",1),t.TgZ(2,"div",2),t.TgZ(3,"app-icon",3),t._uU(4,"arrow_back"),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"Back"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"div",5),t.TgZ(8,"h2",6),t._uU(9,"Available Desks"),t.qZA(),t.TgZ(10,"an-action-field",7),t._uU(11),t.ALo(12,"async"),t.qZA(),t.TgZ(13,"mat-menu",null,8),t.TgZ(15,"div",9),t.NdJ("click",function(r){return r.stopPropagation(),r.preventDefault}),t._UZ(16,"detailed-book-desks-form",10),t.qZA(),t.qZA(),t.TgZ(17,"div",11),t.TgZ(18,"ul",12),t.TgZ(19,"div",13),t._uU(20),t.ALo(21,"async"),t.qZA(),t.YNc(22,yt,10,7,"li",14),t.ALo(23,"async"),t.qZA(),t.TgZ(24,"div",15),t._UZ(25,"i-map",16),t.ALo(26,"async"),t.ALo(27,"async"),t.ALo(28,"async"),t.ALo(29,"async"),t.ALo(30,"async"),t.ALo(31,"async"),t.ALo(32,"async"),t.YNc(33,At,4,5,"div",17),t.ALo(34,"async"),t.qZA(),t.YNc(35,Mt,5,4,"div",18),t.ALo(36,"async"),t.YNc(37,kt,11,2,"div",19),t.qZA(),t.qZA()),2&n){const a=t.MAs(14);let r,l,c;t.xp6(1),t.Q6J("routerLink",t.DdM(41,qt)),t.xp6(9),t.Q6J("matMenuTriggerFor",a),t.xp6(1),t.hij(" ",t.lcZ(12,17,o.option_details)||"No Filters"," "),t.xp6(5),t.Q6J("form",o.form),t.xp6(4),t.hij(" ",(null==(r=t.lcZ(21,19,o.desks))?null:r.length)||"0"," matches available "),t.xp6(2),t.Q6J("ngForOf",t.lcZ(23,21,o.desks)),t.xp6(3),t.Q6J("src",t.lcZ(26,23,o.url))("zoom",null==(l=t.lcZ(27,25,o.positions))?null:l.zoom)("center",null==(c=t.lcZ(28,27,o.positions))?null:c.center)("styles",t.lcZ(29,29,o.styles))("features",t.lcZ(30,31,o.features))("actions",t.lcZ(31,33,o.actions))("labels",t.lcZ(32,35,o.labels))("focus",(null==o.active_desk?null:o.active_desk.map_id)||(null==o.active_desk?null:o.active_desk.id)),t.xp6(8),t.Q6J("ngIf",t.lcZ(34,37,o.level)),t.xp6(2),t.Q6J("ngIf",t.lcZ(36,39,o.loading)),t.xp6(2),t.Q6J("ngIf",o.active_desk)}},directives:[h.zs,T.yS,b.o,_e.s,M.p6,M.VK,Ce,u.sg,w.wG,we.p,u.O5,U.$g,h.lW],pipes:[u.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}\n/*# sourceMappingURL=map.component.ts-angular-inline--57.css.map*/"]}),i})();const Ot=function(){return["/book","desks","map"]};let It=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["desk-flow-confirm"]],decls:7,vars:2,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"a",1),t.TgZ(2,"div",2),t.TgZ(3,"app-icon",3),t._uU(4,"arrow_back"),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"Back"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("routerLink",t.DdM(1,Ot)))},directives:[h.zs,T.yS,b.o],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}\n/*# sourceMappingURL=confirm.component.ts-angular-inline--55.css.map*/"]}),i})();const Ut=function(i){return["/book",i]},Nt=function(){return{}},Jt=function(){return["/schedule"]},Dt=function(i){return{email:i}};let ee=(()=>{class i{constructor(){this.route="spaces",this.type="space"}get is_host(){var n;return this.calendar===(null===(n=(0,f.ar)())||void 0===n?void 0:n.email)}get title(){return this.is_host?"your":"the host'"}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["flow-success"]],inputs:{calendar:"calendar",route:"route",type:"type"},decls:13,vars:12,consts:[["name","success",1,"fixed","inset-0","flex","flex-col","bg-secondary","items-center","justify-center","z-50"],[1,"text-4xl","rounded-full","bg-white","text-success","mb-4"],[1,"text-center","text-lg","text-white","mb-4"],[1,"flex","items-center","space-x-2"],["button","","mat-button","",1,"w-32",3,"routerLink","queryParams"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"app-icon"),t._uU(3,"done"),t.qZA(),t.qZA(),t.TgZ(4,"div",2),t._uU(5),t._UZ(6,"br"),t._uU(7),t.qZA(),t.TgZ(8,"div",3),t.TgZ(9,"a",4),t._uU(10," New Booking "),t.qZA(),t.TgZ(11,"a",4),t._uU(12," Your Bookings "),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(5),t.hij(" Thank you, your ",o.type," booking was successful!"),t.xp6(2),t.hij(" An event has been added to ",o.title," calendar "),t.xp6(2),t.Q6J("routerLink",t.VKq(6,Ut,o.route))("queryParams",t.DdM(8,Nt)),t.xp6(2),t.Q6J("routerLink",t.DdM(9,Jt))("queryParams",t.VKq(10,Dt,o.calendar)))},directives:[b.o,h.zs,T.yS],styles:[""]}),i})();var L=d(6119),ye=d(2317),Ae=d(5692),te=d(3910);function Qt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(n),t.oxw().findDesk()}),t.TgZ(1,"div",6),t.TgZ(2,"app-icon",7),t._uU(3,"search"),t.qZA(),t.TgZ(4,"span",8),t._uU(5),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw();t.xp6(5),t.Oqu(n.is_edit?"Update Desk":"Find Desk")}}function St(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(n),t.oxw().allocateDesk()}),t._uU(1),t.qZA()}if(2&i){const n=t.oxw();t.xp6(1),t.hij(" ",n.is_edit?"Update Desk":"Book Desk"," ")}}let Lt=(()=>{class i{constructor(n,o,a,r){this._state=n,this._router=o,this._org=a,this._settings=r,this.time=0,this.level="",this.quick_times=[{name:"Now",value:0},{name:"Tomorrow",value:(0,L.Z)((0,J.Z)(new Date,1),9).valueOf()}],this.levels=[],this.clearForm=()=>{this.time=0,this.level=this._org.building.id,this._state.clearForm()}}get is_edit(){var n,o;return!!(null===(o=null===(n=this.form)||void 0===n?void 0:n.get("id"))||void 0===o?void 0:o.value)}get auto_allocation(){return!!this._settings.get("app.desks.auto_allocation")}get form(){return this._state.form}ngOnInit(){var n,o;return(0,v.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,A.P)(a=>a)),yield this._org.active_levels.pipe((0,A.P)(a=>(null==a?void 0:a.length)>0)),this.level=null===(n=this._org.building)||void 0===n?void 0:n.id,this.levels=[{id:null===(o=this._org.building)||void 0===o?void 0:o.id,name:"Any Level"},...this._org.levelsForBuilding(this._org.building)]})}quickBook(){this.form.patchValue({date:(this.time<1440?(0,ye.Z)((0,Ae.Z)(new Date,{nearestTo:5}),this.time):(0,L.Z)((0,J.Z)(new Date,1),8)).valueOf(),title:"Ad-hoc Desk Booking"}),this.findDesk()}findDesk(){this.form.markAllAsTouched(),this.form.valid&&this._router.navigate(["/book","desks","map"])}allocateDesk(){var n,o;return(0,v.mG)(this,void 0,void 0,function*(){if(this.form.markAllAsTouched(),!this.form.valid)return;const a=this._settings.get("app.departments")||{},r=(0,f.ar)().groups.find(Z=>Z in a);if(!r)return void this._router.navigate(["/book","desks","map"]);const{level:l,centered_at:c}=a[r],m=this._org.levelWithID([l]);if(!l)return void this._router.navigate(["/book","desks","map"]);const _=yield this._state.available_assets.pipe((0,te.q)(1)).toPromise(),x=yield(0,N.el)(m.map_id,c,_.map(Z=>Z.map_id||Z.id)),g=_.find(Z=>Z.map_id===x||Z.id===x);g?(this._state.form.patchValue({asset_id:null==g?void 0:g.id,asset_name:g.name,map_id:(null==g?void 0:g.map_id)||(null==g?void 0:g.id),description:g.name,booking_type:"desk",zones:g.zone?[null===(n=g.zone)||void 0===n?void 0:n.parent_id,null===(o=g.zone)||void 0===o?void 0:o.id]:[]}),this._state.confirmPost()):this._router.navigate(["/book","desks","map"])})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(N.fy),t.Y36(T.F0),t.Y36(S.w7),t.Y36(f.gb))},i.\u0275cmp=t.Xpm({type:i,selectors:[["desk-flow-form"]],decls:15,vars:5,consts:[["form","",1,"flex-1","min-h-[50%]"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[3,"form"],[1,"mb-4","border-b","border-gray-300","w-full"],[1,"flex","flex-col","sm:flex-row","items-center","justify-center","space-x-0","space-y-2","sm:space-y-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],["mat-button","","clear","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]","inverse",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"ml-2","mx-4"],["class","sm:flex-1 w-full sm:w-auto h-[2.75rem]","find","","mat-button","",3,"click",4,"ngIf","ngIfElse"],["alloc_button",""],["find","","mat-button","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"section",0),t.TgZ(1,"h2",1),t._uU(2),t.qZA(),t._UZ(3,"detailed-book-desks-form",2),t._UZ(4,"div",3),t.TgZ(5,"div",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return o.clearForm()}),t.TgZ(7,"div",6),t.TgZ(8,"app-icon",7),t._uU(9,"clear"),t.qZA(),t.TgZ(10,"span",8),t._uU(11),t.qZA(),t.qZA(),t.qZA(),t.YNc(12,Qt,6,1,"button",9),t.qZA(),t.qZA(),t.YNc(13,St,2,1,"ng-template",null,10,t.W1O)),2&n){const a=t.MAs(14);t.xp6(2),t.hij(" ",o.is_edit?"Edit":"Detailed"," Desk Booking "),t.xp6(1),t.Q6J("form",o.form),t.xp6(8),t.Oqu(o.is_edit?"Cancel Edit":"Clear Form"),t.xp6(1),t.Q6J("ngIf",!o.auto_allocation)("ngIfElse",a)}},directives:[Ce,h.lW,b.o,u.O5],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;overflow:auto}[quick][_ngcontent-%COMP%]{background-color:#007ac8}\n/*# sourceMappingURL=form.component.ts-angular-inline--56.css.map*/"]}),i})();function Pt(i,s){1&i&&(t.ynx(0),t._UZ(1,"desk-flow-map"),t.BQk())}function jt(i,s){1&i&&(t.ynx(0),t._UZ(1,"desk-flow-confirm"),t.BQk())}function Et(i,s){if(1&i&&(t.ynx(0),t._UZ(1,"flow-success",4),t.BQk()),2&i){const n=t.oxw();t.xp6(1),t.Q6J("calendar",null==n.last_success?null:n.last_success.user_email)}}function Yt(i,s){1&i&&(t.ynx(0),t._UZ(1,"desk-flow-form"),t.BQk())}let Bt=(()=>{class i extends f.KG{constructor(n,o,a){super(),this._state=n,this._route=o,this._org=a}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){return(0,v.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,A.P)(n=>n)).toPromise(),this._state.loadForm(),this._state.form||this._state.newForm(),this._state.form.patchValue({booking_type:"desk"}),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView(n.get("success"))}))})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(N.fy),t.Y36(T.gz),t.Y36(S.w7))},i.\u0275cmp=t.Xpm({type:i,selectors:[["placeos-book-desk-flow"]],features:[t.qOj],decls:6,vars:4,consts:[[1,"bg-white","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","desk","route","desks",3,"calendar"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.ynx(1,1),t.YNc(2,Pt,2,0,"ng-container",2),t.YNc(3,jt,2,0,"ng-container",2),t.YNc(4,Et,2,1,"ng-container",2),t.YNc(5,Yt,2,0,"ng-container",3),t.BQk(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngSwitch",o.view),t.xp6(1),t.Q6J("ngSwitchCase","map"),t.xp6(1),t.Q6J("ngSwitchCase","confirm"),t.xp6(1),t.Q6J("ngSwitchCase","success"))},directives:[u.RF,u.n9,Ft,It,ee,u.ED,Lt],styles:["[_nghost-%COMP%]{height:100%;width:100%}\n/*# sourceMappingURL=desk-flow.component.ts-angular-inline--54.css.map*/"]}),i})();var z=d(8426),$t=d(3985),Gt=d(9151),Rt=d(2878),C=d(5758);let Ht=(()=>{class i{constructor(n){this._dialog=n,this.bookChange=new t.vpe}bookSpace(){this.book=!this.multiple||!this.book,this.bookChange.emit(this.book)}viewLocation(){this._dialog.open(Rt.p,{maxWidth:"95vw",maxHeight:"95vh",data:{item:this.space}})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(C.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["space-flow-find-item"]],inputs:{space:"space",multiple:"multiple",book:"book"},outputs:{bookChange:"bookChange"},decls:19,vars:8,consts:[[1,"flex","items-center","bg-white","p-2","my-2","shadow","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","rounded"],[1,"flex","flex-col","flex-1","space-y-2"],[1,"flex","items-center"],[1,"p-2","rounded-full","bg-gray-300","mr-2"],[1,"flex","flex-col","space-y-2","ml-2"],["mat-button","","book","",3,"click"],["locate","","mat-button","",1,"inverse",3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"app-icon"),t._uU(5,"place"),t.qZA(),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA(),t.qZA(),t.TgZ(8,"div",2),t.TgZ(9,"div",3),t.TgZ(10,"app-icon"),t._uU(11,"group"),t.qZA(),t.qZA(),t.TgZ(12,"span"),t._uU(13),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",4),t.TgZ(15,"button",5),t.NdJ("click",function(){return o.bookSpace()}),t._uU(16),t.qZA(),t.TgZ(17,"button",6),t.NdJ("click",function(){return o.viewLocation()}),t._uU(18," Map "),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(7),t.AsE("",(null==o.space||null==o.space.level?null:o.space.level.display_name)||(null==o.space||null==o.space.level?null:o.space.level.name),", ",(null==o.space?null:o.space.display_name)||(null==o.space?null:o.space.name),""),t.xp6(6),t.hij("",(null==o.space?null:o.space.capacity)||0," People"),t.xp6(2),t.ekj("bg-pending",o.multiple&&o.book)("border-pending",o.multiple&&o.book),t.xp6(1),t.hij(" ",o.multiple?o.book?"Remove":"Select":"Book"," "))},directives:[b.o,h.lW],styles:["button[_ngcontent-%COMP%]{width:8rem}\n/*# sourceMappingURL=find-item.component.ts-angular-inline--70.css.map*/"]}),i})();function zt(i,s){if(1&i&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function Vt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"mat-form-field",20),t.TgZ(1,"mat-select",21),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw().setBuilding(a)}),t.ALo(2,"async"),t.YNc(3,zt,2,2,"mat-option",13),t.ALo(4,"async"),t.qZA(),t.qZA()}if(2&i){const n=t.oxw();t.xp6(1),t.Q6J("ngModel",t.lcZ(2,2,n.building)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(4,4,n.buildings))}}function Wt(i,s){if(1&i&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function Xt(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"mat-form-field",23),t.TgZ(1,"mat-select",24),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw().setOptions({zone_ids:[a]})}),t.ALo(2,"async"),t.ALo(3,"async"),t.YNc(4,Wt,2,2,"mat-option",13),t.ALo(5,"async"),t.qZA(),t.qZA()}if(2&i){const n=t.oxw();let o;t.xp6(1),t.Q6J("ngModel",null!=(o=t.lcZ(2,2,n.options))&&null!=o.zone_ids&&o.zone_ids.length?null==(o=t.lcZ(3,4,n.options))?null:o.zone_ids[0]:""),t.xp6(3),t.Q6J("ngForOf",t.lcZ(5,6,n.levels))}}function Kt(i,s){if(1&i&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n.value),t.xp6(1),t.hij(" ",n.name," ")}}function en(i,s){if(1&i&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}function tn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"mat-form-field",11),t.TgZ(1,"mat-select",25),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw().setOptions({features:a})}),t.ALo(2,"async"),t.YNc(3,en,2,2,"mat-option",13),t.ALo(4,"async"),t.qZA(),t.qZA()}if(2&i){const n=t.oxw();let o;t.xp6(1),t.Q6J("ngModel",null==(o=t.lcZ(2,2,n.options))?null:o.features),t.xp6(2),t.Q6J("ngForOf",t.lcZ(4,4,n.features))}}function nn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"space-flow-find-item",28),t.NdJ("bookChange",function(a){const l=t.CHM(n).$implicit;return t.oxw(3).book_space[l.id]=a})("bookChange",function(a){const l=t.CHM(n).$implicit;return t.oxw(3).handleBookEvent(l,a)}),t.qZA()}if(2&i){const n=s.$implicit,o=t.oxw(3);t.Q6J("space",n)("multiple",o.multiple)("book",o.book_space[n.id])}}function on(i,s){if(1&i&&(t.ynx(0),t.YNc(1,nn,1,3,"space-flow-find-item",26),t.ALo(2,"async"),t.TgZ(3,"p",27),t._uU(4," End of available spaces list "),t.qZA(),t.BQk()),2&i){const n=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,n.spaces))}}function an(i,s){if(1&i&&(t.ynx(0),t.YNc(1,on,5,3,"ng-container",16),t.ALo(2,"async"),t.BQk()),2&i){const n=t.oxw(),o=t.MAs(29);let a;t.xp6(1),t.Q6J("ngIf",(null==(a=t.lcZ(2,2,n.spaces))?null:a.length)>0)("ngIfElse",o)}}function sn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",37),t.TgZ(1,"div",38),t.TgZ(2,"div"),t._uU(3),t.qZA(),t.TgZ(4,"div",39),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"button",40),t.NdJ("click",function(a){const l=t.CHM(n).$implicit;return t.oxw(2).handleBookEvent(l,!1),a.stopPropagation()}),t.TgZ(7,"app-icon"),t._uU(8,"close"),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=s.$implicit;t.xp6(3),t.Oqu(n.display_name||n.name),t.xp6(2),t.AsE(" ",(null==n.level?null:n.level.display_name)||(null==n.level?null:n.level.name)," ~ ",n.capacity||"2+"," People ")}}function rn(i,s){1&i&&(t.TgZ(0,"div",41),t._uU(1," No selected spaces "),t.qZA())}function ln(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",29),t.TgZ(1,"div",30),t.TgZ(2,"div",31),t._uU(3),t.qZA(),t.TgZ(4,"button",32),t.NdJ("click",function(){return t.CHM(n),t.oxw().confirmBooking()}),t._uU(5," Book "),t.qZA(),t.qZA(),t.TgZ(6,"mat-menu",33,34),t.YNc(8,sn,9,3,"div",35),t.YNc(9,rn,2,0,"div",36),t.qZA(),t.qZA()}if(2&i){const n=t.MAs(7),o=t.oxw();t.xp6(2),t.Q6J("matMenuTriggerFor",n),t.xp6(1),t.hij(" ",o.space_list.length," space(s) selected "),t.xp6(1),t.Q6J("disabled",!o.space_list.length),t.xp6(4),t.Q6J("ngForOf",o.space_list),t.xp6(1),t.Q6J("ngIf",!(null!=o.space_list&&o.space_list.length))}}function cn(i,s){1&i&&(t.TgZ(0,"div",42),t._UZ(1,"mat-spinner",43),t.TgZ(2,"p"),t._uU(3,"Retrieving available spaces..."),t.qZA(),t.qZA()),2&i&&(t.xp6(1),t.Q6J("diameter",32))}function dn(i,s){1&i&&(t.TgZ(0,"div",44),t.TgZ(1,"p"),t._uU(2," No available spaces for selected time, capacity or level(s) "),t.qZA(),t.qZA())}const pn=function(){return["/book","spaces","form"]};let un=(()=>{class i{constructor(n,o,a,r,l){this._org=n,this._spaces=o,this._state=a,this._settings=r,this._router=l,this.book_space={},this.quick_capacities=[{name:"Any Capacity",value:0},{name:"Small (1 - 4)",value:1},{name:"Medium (5 - 12)",value:5},{name:"Large (13 - 32)",value:13},{name:"Huge (32+)",value:33}],this.space_list=[],this.buildings=this._org.building_list,this.building=this._org.active_building,this.levels=(0,R.aj)([this.building,this._state.options]).pipe((0,Gt.h)(([c])=>!!c),(0,B.U)(([c])=>[{id:this._org.building.id,name:"All Levels"},...this._org.levelsForBuilding(c)])),this.loading=this._state.loading,this.options=this._state.options,this.spaces=this._state.available_spaces,this.features=this._spaces.features,this.setOptions=c=>this._state.setOptions(c)}setBuilding(n){return(0,v.mG)(this,void 0,void 0,function*(){const o=yield this.options.pipe((0,te.q)(1)).toPromise();n&&(this._org.building=n);const a=this._org.levelsForBuilding(this._org.building);!a.find(l=>{var c;return null===(c=o.zone_ids)||void 0===c?void 0:c.includes(l.id)})&&a.length&&this.setOptions({zone_ids:[a[0].id]})})}get multiple(){var n;return null!==(n=this._settings.get("app.events.multiple_spaces"))&&void 0!==n&&n}ngOnInit(){var n,o;return(0,v.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,A.P)(r=>!!r)).toPromise(),yield this._spaces.initialised.pipe((0,A.P)(r=>!!r)).toPromise(),this.setBuilding(this._org.building),this.book_space={},((null===(o=null===(n=this._state.form)||void 0===n?void 0:n.get("resources"))||void 0===o?void 0:o.value)||[]).forEach(r=>this.book_space[r.id]=!0),this.space_list=this._spaces.filter(r=>this.book_space[r.id])})}handleBookEvent(n,o=!0){this.multiple?this.book_space[n.id]=o:(this.book_space={},this.book_space[n.id]=o,this.confirmBooking()),this.space_list=this._spaces.filter(a=>this.book_space[a.id])}confirmBooking(){const n=this._spaces.filter(o=>this.book_space[o.id]);this._state.form.patchValue({resources:n,system:n[0]}),this._router.navigate(["/book","spaces","confirm"])}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(S.w7),t.Y36($t.sK),t.Y36(z.MH),t.Y36(f.gb),t.Y36(T.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["space-flow-find"]],decls:30,vars:20,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],["filters",""],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","py-4"],[1,"text-xl","uppercase","font-medium","text-white"],[1,"flex","flex-col","items-center","sm:flex-row","space-x-0","sm:space-x-2"],["overlay","","buildings","","class","w-full sm:w-px sm:flex-1 h-[3.25rem]","appearance","outline",4,"ngIf"],["class","w-full sm:w-px sm:flex-1 h-[3.25rem]","overlay","","appearance","outline",4,"ngIf"],["overlay","","appearance","outline",1,"w-full","sm:w-px","sm:flex-1","h-[3.25rem]","hidden","sm:block"],["placeholder","Any Capacity",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","w-full sm:w-px sm:flex-1 h-[3.25rem] hidden sm:block","overlay","","appearance","outline",4,"ngIf"],[1,"flex-1","w-full","bg-gray-100","overflow-auto"],[4,"ngIf","ngIfElse"],["class","bg-white border-t border-gray-200",4,"ngIf"],["load_state",""],["empty_state",""],["overlay","","buildings","","appearance","outline",1,"w-full","sm:w-px","sm:flex-1","h-[3.25rem]"],["placeholder","Select Building...",3,"ngModel","ngModelChange"],[3,"value"],["overlay","","appearance","outline",1,"w-full","sm:w-px","sm:flex-1","h-[3.25rem]"],["placeholder","Level",3,"ngModel","ngModelChange"],["placeholder","Any Features","multiple","",3,"ngModel","ngModelChange"],["class","w-[640px] max-w-[calc(100%-2rem)] mx-auto ",3,"space","multiple","book","bookChange",4,"ngFor","ngForOf"],[1,"p-4","text-center","opacity-60"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto",3,"space","multiple","book","bookChange"],[1,"bg-white","border-t","border-gray-200"],[1,"flex","items-center","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","p-2"],[1,"flex-1","underline",3,"matMenuTriggerFor"],["mat-button","",1,"w-32",3,"disabled","click"],["yPosition","above"],["menu","matMenu"],["class","flex items-center pointer-events-none leading-tight","mat-menu-item","",4,"ngFor","ngForOf"],["mat-menu-item","","class"," opacity-60",4,"ngIf"],["mat-menu-item","",1,"flex","items-center","pointer-events-none","leading-tight"],[1,"flex","flex-col","mr-4"],[1,"text-xs","opacity-70"],["mat-icon-button","",1,"pointer-events-auto",3,"click"],["mat-menu-item","",1,"opacity-60"],[1,"h-full","w-full","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"],[1,"h-full","w-full","flex","flex-col","items-center","justify-center","space-y-2","p-8","text-center"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"a",1),t.TgZ(2,"div",2),t.TgZ(3,"app-icon",3),t._uU(4,"arrow_back"),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"Back"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"div",5),t.TgZ(8,"div",6),t.TgZ(9,"h2",7),t._uU(10," Available Spaces "),t.qZA(),t.TgZ(11,"div",8),t.YNc(12,Vt,5,6,"mat-form-field",9),t.ALo(13,"async"),t.YNc(14,Xt,6,8,"mat-form-field",10),t.ALo(15,"async"),t.TgZ(16,"mat-form-field",11),t.TgZ(17,"mat-select",12),t.NdJ("ngModelChange",function(r){return o.setOptions({capacity:r})}),t.ALo(18,"async"),t.YNc(19,Kt,2,2,"mat-option",13),t.qZA(),t.qZA(),t.YNc(20,tn,5,6,"mat-form-field",14),t.ALo(21,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"div",15),t.YNc(23,an,3,4,"ng-container",16),t.ALo(24,"async"),t.qZA(),t.YNc(25,ln,10,5,"div",17),t.YNc(26,cn,4,1,"ng-template",null,18,t.W1O),t.YNc(28,dn,3,0,"ng-template",null,19,t.W1O)),2&n){const a=t.MAs(27);let r,l,c;t.xp6(1),t.Q6J("routerLink",t.DdM(19,pn)),t.xp6(11),t.Q6J("ngIf",(null==(r=t.lcZ(13,9,o.buildings))?null:r.length)>1),t.xp6(2),t.Q6J("ngIf",(null==(l=t.lcZ(15,11,o.levels))?null:l.length)>0),t.xp6(3),t.Q6J("ngModel",null==(c=t.lcZ(18,13,o.options))?null:c.capacity),t.xp6(2),t.Q6J("ngForOf",o.quick_capacities),t.xp6(1),t.Q6J("ngIf",t.lcZ(21,15,o.features).length),t.xp6(3),t.Q6J("ngIf",!t.lcZ(24,17,o.loading))("ngIfElse",a),t.xp6(2),t.Q6J("ngIf",o.multiple)}},directives:[h.zs,T.yS,b.o,u.O5,k.KE,H.gD,p.JJ,p.On,u.sg,w.ey,Ht,M.p6,h.lW,M.VK,M.OP,U.$g],pipes:[u.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}[filters][_ngcontent-%COMP%]{background-color:#007ac8}\n/*# sourceMappingURL=find.component.ts-angular-inline--71.css.map*/"]}),i})();var mn=d(9685);function gn(i,s){if(1&i&&(t.TgZ(0,"div",20),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"button",21),t._uU(4," Map "),t.qZA(),t.qZA()),2&i){const n=s.$implicit;t.xp6(2),t.AsE("",n.display_name||n.name," [",(null==n.level?null:n.level.display_name)||(null==n.level?null:n.level.name),"]")}}function _n(i,s){if(1&i&&(t.TgZ(0,"div",22),t._UZ(1,"a-user-avatar",23),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.qZA()),2&i){const n=s.$implicit;t.xp6(1),t.Q6J("user",n),t.xp6(2),t.Oqu(n.name||n.email)}}function fn(i,s){1&i&&(t.TgZ(0,"span"),t._uU(1,"Confirm"),t.qZA())}function hn(i,s){1&i&&t._UZ(0,"mat-spinner",24),2&i&&t.Q6J("diameter",24)}const Me=function(){return["/book","spaces","find"]},ne=function(){return["/book","spaces","form"]};let vn=(()=>{class i{constructor(n){this._state=n,this.show_spaces=!1,this.show_people=!1,this.loading=!1,this.postForm=()=>(0,v.mG)(this,void 0,void 0,function*(){this.loading=!0,yield this._state.postForm().catch(o=>(0,f.cB)(o)),this.loading=!1})}get form(){return this._state.form}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(z.MH))},i.\u0275cmp=t.Xpm({type:i,selectors:[["space-flow-confirm"]],decls:59,vars:38,consts:[["topbar","",1,""],["button","","mat-button","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],[1,"flex","flex-col","items-center","space-y-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],[1,"text-xl","uppercase","font-medium","w-full","my-4"],[1,"flex","items-center","py-2","space-x-2","border-b","border-gray-200","w-full"],[1,"p-2","rounded-full","bg-gray-300","mr-2"],[1,"flex-1","truncate"],["mat-button","",1,"clear","underline",3,"routerLink"],[1,"border-b","border-gray-200","w-full"],[1,"flex","items-center","py-2","space-x-2"],["mat-button","",1,"clear","bg-transparent","border-none","underline",3,"disabled","click"],["list","",1,"overflow-hidden"],["class","flex items-center h-10 pl-12",4,"ngFor","ngForOf"],["class","flex items-center h-12 pl-12 space-x-2",4,"ngFor","ngForOf"],["mat-button","","confirm","",1,"w-32",3,"disabled","click"],[4,"ngIf"],["class","mx-auto",3,"diameter",4,"ngIf"],[1,"flex","items-center","h-10","pl-12"],["mat-button","",1,"bg-transparent","border-none","underline"],[1,"flex","items-center","h-12","pl-12","space-x-2"],[1,"text-sm",3,"user"],[1,"mx-auto",3,"diameter"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"a",1),t.TgZ(2,"div",2),t.TgZ(3,"app-icon",3),t._uU(4,"arrow_back"),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"Back"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"div",5),t.TgZ(8,"h2",6),t._uU(9," Your meeting details "),t.qZA(),t.TgZ(10,"div",7),t.TgZ(11,"div",8),t.TgZ(12,"app-icon"),t._uU(13,"event"),t.qZA(),t.qZA(),t.TgZ(14,"div",9),t._uU(15),t.ALo(16,"date"),t.ALo(17,"date"),t.ALo(18,"date"),t.qZA(),t.TgZ(19,"a",10),t._uU(20,"Edit"),t.qZA(),t.qZA(),t.TgZ(21,"div",7),t.TgZ(22,"div",8),t.TgZ(23,"app-icon"),t._uU(24,"schedule"),t.qZA(),t.qZA(),t.TgZ(25,"div",9),t._uU(26),t.qZA(),t.TgZ(27,"a",10),t._uU(28,"Edit"),t.qZA(),t.qZA(),t.TgZ(29,"div",11),t.TgZ(30,"div",12),t.TgZ(31,"div",8),t.TgZ(32,"app-icon"),t._uU(33,"place"),t.qZA(),t.qZA(),t.TgZ(34,"div",9),t._uU(35),t.qZA(),t.TgZ(36,"button",13),t.NdJ("click",function(){return o.show_spaces=!o.show_spaces}),t._uU(37),t.qZA(),t.TgZ(38,"a",10),t._uU(39,"Edit"),t.qZA(),t.qZA(),t.TgZ(40,"div",14),t.YNc(41,gn,5,2,"div",15),t.qZA(),t.qZA(),t.TgZ(42,"div",11),t.TgZ(43,"div",12),t.TgZ(44,"div",8),t.TgZ(45,"app-icon"),t._uU(46,"group"),t.qZA(),t.qZA(),t.TgZ(47,"div",9),t._uU(48),t.qZA(),t.TgZ(49,"button",13),t.NdJ("click",function(){return o.show_people=!o.show_people}),t._uU(50),t.qZA(),t.TgZ(51,"a",10),t._uU(52,"Edit"),t.qZA(),t.qZA(),t.TgZ(53,"div",14),t.YNc(54,_n,4,2,"div",16),t.qZA(),t.qZA(),t.TgZ(55,"button",17),t.NdJ("click",function(){return o.postForm()}),t.YNc(56,fn,2,0,"span",18),t.YNc(57,hn,1,1,"mat-spinner",19),t.qZA(),t.qZA(),t._uU(58," < ")),2&n){let a,r,l,c,m,_,x,g,Z,P;t.xp6(1),t.Q6J("routerLink",t.DdM(33,Me)),t.xp6(14),t.lnq(" ",t.xi3(16,24,null==(a=o.form.get("date"))?null:a.value,"longDate")," at ",t.xi3(17,27,null==(a=o.form.get("date"))?null:a.value,"shortTime")," ~ ",t.xi3(18,30,(null==(a=o.form.get("date"))?null:a.value)+60*(null==(a=o.form.get("duration"))?null:a.value)*1e3,"shortTime")," "),t.xp6(4),t.Q6J("routerLink",t.DdM(34,ne)),t.xp6(7),t.hij(" ",null==(r=o.form.get("duration"))?null:r.value," minutes "),t.xp6(1),t.Q6J("routerLink",t.DdM(35,ne)),t.xp6(8),t.hij(" ",null==(l=o.form.get("resources"))||null==l.value?null:l.value.length," Space(s) "),t.xp6(1),t.Q6J("disabled",!(null!=(c=o.form.get("resources"))&&null!=c.value&&c.value.length)),t.xp6(1),t.hij(" ",o.show_spaces?"Hide":"Show"," "),t.xp6(1),t.Q6J("routerLink",t.DdM(36,Me)),t.xp6(2),t.Udp("height",o.show_spaces?2.5*(null==(m=o.form.get("resources"))||null==m.value?null:m.value.length)+"rem":"0"),t.xp6(1),t.Q6J("ngForOf",null==(_=o.form.get("resources"))?null:_.value),t.xp6(7),t.hij(" ",(null==(x=o.form.get("attendees"))||null==x.value?null:x.value.length)||0," Attendee(s) "),t.xp6(1),t.Q6J("disabled",!(null!=(g=o.form.get("attendees"))&&null!=g.value&&g.value.length)),t.xp6(1),t.hij(" ",o.show_people?"Hide":"Show"," "),t.xp6(1),t.Q6J("routerLink",t.DdM(37,ne)),t.xp6(2),t.Udp("height",o.show_people?3*(null==(Z=o.form.get("attendees"))||null==Z.value?null:Z.value.length)+"rem":"0"),t.xp6(1),t.Q6J("ngForOf",null==(P=o.form.get("attendees"))?null:P.value),t.xp6(1),t.Q6J("disabled",o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf",o.loading)}},directives:[h.zs,T.yS,b.o,h.lW,u.sg,mn.k,u.O5,U.$g],pipes:[u.uU],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}[list][_ngcontent-%COMP%]{transition:height .2s}\n/*# sourceMappingURL=confirm.component.ts-angular-inline--59.css.map*/"]}),i})();var xn=d(4901);d(8335);const Zn=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}];function bn(i,s){1&i&&(t.TgZ(0,"button",5),t.TgZ(1,"app-icon"),t._uU(2,"close"),t.qZA(),t.qZA())}function Tn(i,s){if(1&i&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(1),t.hij(" ",n.name," ")}}function Cn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",14),t.TgZ(1,"mat-form-field",8),t.TgZ(2,"mat-select",15),t.NdJ("ngModelChange",function(a){return t.CHM(n).$implicit[0]=a}),t.YNc(3,Tn,2,2,"mat-option",16),t.qZA(),t.qZA(),t.TgZ(4,"mat-form-field",8),t.TgZ(5,"input",17),t.NdJ("ngModelChange",function(a){return t.CHM(n).$implicit[1]=a}),t.qZA(),t.TgZ(6,"mat-error"),t._uU(7,"Rule value is required"),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=s.$implicit,o=t.oxw(2);t.xp6(2),t.Q6J("ngModel",n[0]),t.xp6(1),t.Q6J("ngForOf",o.rule_types),t.xp6(2),t.Q6J("ngModel",n[1])}}function wn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",6),t.TgZ(1,"div",7),t.TgZ(2,"mat-form-field",8),t.TgZ(3,"input",9),t.NdJ("ngModelChange",function(a){return t.CHM(n).$implicit.name=a}),t.qZA(),t.TgZ(4,"mat-error"),t._uU(5,"Ruleset name is required"),t.qZA(),t.qZA(),t.TgZ(6,"button",10),t.NdJ("click",function(){const r=t.CHM(n).$implicit,l=t.oxw();return r.rules.push(["",""]),l.show_rules=r.id}),t.TgZ(7,"app-icon"),t._uU(8,"add"),t.qZA(),t.qZA(),t.TgZ(9,"button",11),t.NdJ("click",function(){const r=t.CHM(n).$implicit,l=t.oxw();return l.show_rules=l.show_rules!==r.id?r.id:""}),t.TgZ(10,"app-icon"),t._uU(11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",12),t.YNc(13,Cn,8,3,"div",13),t.qZA(),t.qZA()}if(2&i){const n=s.$implicit,o=t.oxw();t.xp6(3),t.Q6J("ngModel",n.name),t.xp6(6),t.Q6J("disabled",!n.rules.length),t.xp6(2),t.Oqu(o.show_rules===n.id?"expand_less":"expand_more"),t.xp6(1),t.Udp("height",(o.show_rules===n.id?3.5*n.rules.length:0)+"em"),t.xp6(1),t.Q6J("ngForOf",n.rules)}}let ke=(()=>{class i{constructor(n){this._data=n,this.event=new t.vpe,this.loading=!1,this.rule_types=Zn,this.rulesets=(n.config||[]).map(o=>(o.rules=o.rules.map(a=>[a[0],JSON.stringify(a[1])]),o))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const n=this.rulesets.map(o=>Object.assign(Object.assign({},o),{rules:o.rules.map(a=>{let r=a[1];try{r=JSON.parse(a[1])}catch(l){}return[a[0],r]})}));this.event.emit({reason:"done",metadata:n})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(C.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex px-2 h-14 space-x-2",4,"ngFor","ngForOf"],[1,"flex","px-2","h-14","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(n,o){1&n&&(t.TgZ(0,"header"),t.TgZ(1,"h3"),t._uU(2,"Edit Catering Configuration"),t.qZA(),t.YNc(3,bn,3,0,"button",0),t.qZA(),t.TgZ(4,"main",1),t.TgZ(5,"button",2),t.NdJ("click",function(){return o.rulesets.push({id:o.new_id,rules:[]})}),t._uU(6," New Ruleset "),t.qZA(),t.YNc(7,wn,14,6,"div",3),t.qZA(),t.TgZ(8,"footer",4),t.TgZ(9,"button",2),t.NdJ("click",function(){return o.saveChanges()}),t._uU(10,"Save Changes"),t.qZA(),t.qZA()),2&n&&(t.xp6(3),t.Q6J("ngIf",!o.loading),t.xp6(4),t.Q6J("ngForOf",o.rulesets))},directives:[u.O5,h.lW,C.ZT,b.o,u.sg,k.KE,Q.Nt,p.Fj,p.Q7,p.JJ,p.On,k.TO,H.gD,w.ey],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}\n/*# sourceMappingURL=catering-config-modal.component.ts-angular-inline--60.css.map*/"]}),i})();var oe=d(5939),y=d(2962),V=d(3188),W=d(1196),ie=d(1534),qe=d(2793);function yn(i,s){1&i&&(t.TgZ(0,"button",7),t.TgZ(1,"app-icon"),t._uU(2,"close"),t.qZA(),t.qZA())}function An(i,s){if(1&i&&(t.TgZ(0,"div",15),t.TgZ(1,"label",16),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",18),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA(),t.qZA(),t.qZA()),2&i){const n=t.oxw(2);t.xp6(1),t.ekj("error",n.form.controls.name.invalid&&n.form.controls.name.touched)}}function Mn(i,s){if(1&i&&(t.TgZ(0,"div",15),t.TgZ(1,"label",19),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA(),t.qZA(),t.qZA()),2&i){const n=t.oxw(2),o=t.MAs(9);t.xp6(1),t.ekj("error",n.form.controls.category.invalid&&n.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",o)}}const kn=function(){return{class:"material-icons",content:"close"}};function qn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"mat-chip",27),t.NdJ("removed",function(){const r=t.CHM(n).$implicit;return t.oxw(3).removeTag(r)}),t._uU(1),t._UZ(2,"app-icon",28),t.qZA()}if(2&i){const n=s.$implicit;t.Q6J("selectable",!0)("removable",!0),t.xp6(1),t.hij(" ",n," "),t.xp6(1),t.Q6J("icon",t.DdM(4,kn))}}function Fn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",15),t.TgZ(1,"label",21),t.SDv(2,22),t.qZA(),t.TgZ(3,"mat-form-field",17),t.TgZ(4,"mat-chip-list",23,24),t.YNc(6,qn,3,5,"mat-chip",25),t.TgZ(7,"input",26),t.NdJ("matChipInputTokenEnd",function(a){return t.CHM(n),t.oxw(2).addTag(a)}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.MAs(5),o=t.oxw(2);t.xp6(1),t.ekj("error",o.form.controls.tags.invalid&&o.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",o.tag_list),t.xp6(1),t.Q6J("matChipInputFor",n)("matChipInputSeparatorKeyCodes",o.separators)("matChipInputAddOnBlur",!0)}}function On(i,s){1&i&&(t.TgZ(0,"div",15),t.TgZ(1,"label",29),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",17),t._UZ(4,"textarea",30),t.qZA(),t.qZA())}function In(i,s){if(1&i&&(t.TgZ(0,"div",15),t.TgZ(1,"label",16),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",31),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA(),t.qZA(),t.qZA()),2&i){const n=t.oxw(2);t.xp6(1),t.ekj("error",n.form.controls.unit_price.invalid&&n.form.controls.unit_price.touched)}}function Un(i,s){if(1&i&&(t.TgZ(0,"form",8),t.YNc(1,An,10,2,"div",9),t.YNc(2,Mn,10,3,"div",9),t.YNc(3,Fn,8,6,"div",9),t.YNc(4,On,5,0,"div",9),t.YNc(5,In,10,2,"div",9),t.TgZ(6,"div",10),t.TgZ(7,"label",11),t._uU(8,"Accept Points?"),t.qZA(),t.TgZ(9,"mat-checkbox",12),t._uU(10),t.qZA(),t.qZA(),t.TgZ(11,"div",10),t.TgZ(12,"label",13),t._uU(13,"Discount Cap"),t.qZA(),t._UZ(14,"a-counter",14),t.qZA(),t.qZA()),2&i){const n=t.oxw();let o;t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.form.controls.name),t.xp6(1),t.Q6J("ngIf",n.form.controls.category),t.xp6(1),t.Q6J("ngIf",n.form.controls.tags),t.xp6(1),t.Q6J("ngIf",n.form.controls.description),t.xp6(1),t.Q6J("ngIf",n.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(o=n.form.get("accept_points"))&&o.value?"No":"Yes"),t.xp6(4),t.Q6J("min",0)("max",100)("step",5)("render_fn",n.renderPercent)}}function Nn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"footer",32),t.TgZ(1,"button",33),t.NdJ("click",function(){return t.CHM(n),t.oxw().saveChanges()}),t._uU(2," Save "),t.qZA(),t.qZA()}if(2&i){const n=t.oxw();t.xp6(1),t.Q6J("disabled",!n.form.dirty)}}function Jn(i,s){1&i&&(t.TgZ(0,"div",34),t._UZ(1,"mat-spinner",35),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA(),t.qZA())}function Dn(i,s){if(1&i&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}let Fe=(()=>{class i{constructor(n){this._data=n,this.event=new t.vpe,this.form=new p.cw({name:new p.NI(this.item.name||"",[p.kI.required]),description:new p.NI(this.item.description||""),category:new p.NI(this.item.category||"",[p.kI.required]),unit_price:new p.NI(this.item.unit_price,[p.kI.required]),tags:new p.NI(this.item.tags||[]),accept_points:new p.NI(this.item.accept_points||!1),discount_cap:new p.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[oe.K5,oe.OC,oe.L_]}get item(){return this._data.item||new y.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(n=0){return`${n}%`}addTag(n){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const o=n.input,a=n.value,r=this.tag_list;(a||"").trim()&&(r.push(a),this.form.controls.tags.setValue(r)),o&&(o.value="")}removeTag(n){if(!this.form||!this.form.controls.tags)return;const o=this.tag_list;this.form.controls.tags.markAsDirty();const a=o.indexOf(n);a>=0&&(o.splice(a,1),this.form.controls.tags.setValue(o))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new y.U(Object.assign(Object.assign(Object.assign({},this.item),{id:this.item.id||`item-${(0,f.Iy)(99999999)}`}),this.form.value))}})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(C.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let s,n;return s=$localize`:@@tagsLabel800ffadd463cfe152c5af3fa9f13803ab2e77b934746186018558508280: Tags: `,n=$localize`:@@zoneTagsPlaceholder8dc7c13b0c6b8ad9c770bce0ad72e14b4aef84563986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],s,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",n,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(n,o){if(1&n&&(t.TgZ(0,"header"),t.TgZ(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,yn,3,0,"button",1),t.qZA(),t.YNc(4,Un,15,11,"form",2),t.YNc(5,Nn,3,1,"footer",3),t.YNc(6,Jn,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,Dn,2,2,"mat-option",6),t.qZA()),2&n){const a=t.MAs(7);t.xp6(2),t.hij("",o.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf",o.form&&!o.loading)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!o.loading),t.xp6(5),t.Q6J("ngForOf",o.categories)}},directives:[C.uh,u.O5,h.lW,C.ZT,b.o,p._Y,p.JL,p.sg,k.KE,Q.Nt,p.Fj,p.JJ,p.u,k.TO,V.ZL,W.qn,u.sg,W.HS,W.qH,W.oH,p.wV,ie.oG,qe.R,U.$g,V.XC,w.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-item-modal.component.ts-angular-inline--61.css.map*/"]}),i})();var X=d(3674),Oe=d(3245);function Qn(i,s){1&i&&(t.TgZ(0,"button",7),t.TgZ(1,"app-icon"),t._uU(2,"close"),t.qZA(),t.qZA())}function Sn(i,s){if(1&i&&(t.TgZ(0,"div",10),t.TgZ(1,"label",11),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",12),t._UZ(7,"input",13),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA(),t.qZA(),t.qZA()),2&i){const n=t.oxw(2);t.xp6(1),t.ekj("error",n.form.controls.name.invalid&&n.form.controls.name.touched)}}function Ln(i,s){if(1&i&&(t.TgZ(0,"div",10),t.TgZ(1,"label",14),t._uU(2," Type"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",12),t._UZ(7,"input",15),t.TgZ(8,"mat-error"),t._uU(9,"Type is required"),t.qZA(),t.qZA(),t.qZA()),2&i){const n=t.oxw(2),o=t.MAs(9);t.xp6(1),t.ekj("error",n.form.controls.group.invalid&&n.form.controls.group.touched),t.xp6(6),t.Q6J("matAutocomplete",o)}}function Pn(i,s){1&i&&(t.TgZ(0,"div",10),t.TgZ(1,"label",11),t._uU(2,"Unit Price:"),t.qZA(),t.TgZ(3,"mat-form-field",12),t._UZ(4,"input",16),t.qZA(),t.qZA())}function jn(i,s){1&i&&(t.TgZ(0,"div",10),t.TgZ(1,"mat-checkbox",17),t._uU(2," Can select multiple of type "),t.qZA(),t.qZA())}function En(i,s){if(1&i&&(t.TgZ(0,"form",8),t.YNc(1,Sn,10,2,"div",9),t.YNc(2,Ln,10,3,"div",9),t.YNc(3,Pn,5,0,"div",9),t.YNc(4,jn,3,0,"div",9),t.qZA()),2&i){const n=t.oxw();t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.form.controls.name),t.xp6(1),t.Q6J("ngIf",n.form.controls.group),t.xp6(1),t.Q6J("ngIf",n.form.controls.unit_price),t.xp6(1),t.Q6J("ngIf",n.form.controls.multiple)}}function Yn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"footer",18),t.TgZ(1,"button",19),t.NdJ("click",function(){return t.CHM(n),t.oxw().saveChanges()}),t._uU(2," Save "),t.qZA(),t.qZA()}if(2&i){const n=t.oxw();t.xp6(1),t.Q6J("disabled",!n.form.dirty)}}function Bn(i,s){1&i&&(t.TgZ(0,"div",20),t._UZ(1,"mat-spinner",21),t.TgZ(2,"p"),t._uU(3,"Saving catering item option..."),t.qZA(),t.qZA())}function $n(i,s){if(1&i&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}let Ie=(()=>{class i{constructor(n){this._data=n,this.event=new t.vpe,this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}ngOnInit(){this.form=new p.cw({name:new p.NI(this.option.name||"",[p.kI.required]),group:new p.NI(this.option.group||"",[p.kI.required]),unit_price:new p.NI(this.option.unit_price),multiple:new p.NI(!!this.option.multiple,[])})}saveChanges(){this.loading=!0;const n=Object.assign(Object.assign(Object.assign({},this.option),{id:this.option.id||`option-${(0,Oe.Iy)(99999999)}`}),this.form.value);this.event.emit({reason:"done",metadata:{item:new y.U(Object.assign(Object.assign({},this._data.parent),{options:this._data.parent.options.filter(o=>o.id!==n.id).concat([n])}))}})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(C.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-none border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(n,o){if(1&n&&(t.TgZ(0,"header"),t.TgZ(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,Qn,3,0,"button",1),t.qZA(),t.YNc(4,En,5,5,"form",2),t.YNc(5,Yn,3,1,"footer",3),t.YNc(6,Bn,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,$n,2,2,"mat-option",6),t.qZA()),2&n){const a=t.MAs(7);t.xp6(2),t.hij(" ",o.option.id?"Edit":"Add"," Item Option "),t.xp6(1),t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf",o.form&&!o.loading)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!o.loading),t.xp6(5),t.Q6J("ngForOf",o.types)}},directives:[C.uh,u.O5,h.lW,C.ZT,b.o,p._Y,p.JL,p.sg,k.KE,Q.Nt,p.Fj,p.JJ,p.u,k.TO,V.ZL,p.wV,ie.oG,U.$g,V.XC,u.sg,w.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}\n/*# sourceMappingURL=catering-option-modal.component.ts-angular-inline--62.css.map*/"]}),i})();var O=d(5163),Gn=d(1233),Rn=d(475),Ue=d(8025),K=d(2379),Hn=d(89);function zn(i,s){1&i&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function Vn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(a){t.CHM(n);const r=t.oxw().$implicit;return t.oxw(5).updateItemQuantity(r,a)}),t.qZA()}if(2&i){const n=t.oxw().$implicit;t.Q6J("ngModel",n.quantity)}}function Wn(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",19),t.TgZ(1,"div",20),t.TgZ(2,"button",21),t.TgZ(3,"app-icon"),t._uU(4,"remove"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(n);const a=t.oxw().$implicit;return t.oxw(5).addItem(a)}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",n.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",n.quantity," ")}}function Xn(i,s){if(1&i&&(t.TgZ(0,"div",11),t.TgZ(1,"div",12),t.TgZ(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,zn,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,Vn,1,1,"a-counter",15),t.YNc(9,Wn,10,3,"div",16),t.qZA()),2&i){const n=s.$implicit;t.xp6(3),t.hij(" ",n.name," "),t.xp6(1),t.Q6J("ngIf",n.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,5,n.unit_price/100)," "),t.xp6(2),t.Q6J("ngIf",!n.options.length),t.xp6(1),t.Q6J("ngIf",n.options.length)}}const Ne=function(){return{}};function Kn(i,s){if(1&i&&(t.TgZ(0,"mat-tab",8),t.TgZ(1,"div",9),t.YNc(2,Xn,10,7,"div",10),t.qZA(),t.qZA()),2&i){const n=t.oxw().$implicit,o=t.oxw(3);t.Q6J("label",n),t.xp6(2),t.Q6J("ngForOf",(o.menu_items||t.DdM(2,Ne))[n])}}function eo(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Kn,3,3,"mat-tab",7),t.BQk()),2&i){const n=s.$implicit,o=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(o.menu_items||t.DdM(1,Ne))[n].length)}}function to(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,eo,2,2,"ng-container",6),t.qZA(),t.BQk()),2&i){const n=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",n.categories)}}function no(i,s){if(1&i&&(t.TgZ(0,"div",4),t.YNc(1,to,3,1,"ng-container",5),t.qZA()),2&i){const n=t.oxw(),o=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!n.show_order_details)("ngIfElse",o)}}function oo(i,s){if(1&i){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).show_order_details=!0}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&i){const n=t.oxw(2);t.xp6(3),t.Q6J("disabled",!n.order.item_count)("matBadge",n.order.item_count)("matBadgeHidden",!n.order.item_count)}}function io(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).show_order_details=!1}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).saveOrder()}),t._uU(3," Save Order "),t.qZA()}}function ao(i,s){if(1&i&&(t.TgZ(0,"footer",24),t.YNc(1,oo,5,3,"ng-container",5),t.YNc(2,io,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&i){const n=t.MAs(3),o=t.oxw();t.xp6(1),t.Q6J("ngIf",!o.show_order_details)("ngIfElse",n)}}function so(i,s){if(1&i&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA(),t.qZA()),2&i){const n=t.oxw();t.xp6(3),t.Oqu(n.loading)}}function ro(i,s){if(1&i&&(t.TgZ(0,"div",37),t._uU(1),t.qZA()),2&i){const n=t.oxw().$implicit,o=t.oxw(2);t.Q6J("matTooltip",o.optionsFor(n)),t.xp6(1),t.AsE(" ",n.options.length," option",1===n.options.length?"":"s"," selected ")}}function lo(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",34),t.TgZ(1,"div",12),t.TgZ(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,ro,2,3,"div",35),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",36),t.NdJ("ngModelChange",function(a){const l=t.CHM(n).$implicit;return t.oxw(2).updateItemQuantity(l,a)}),t.qZA(),t.qZA()}if(2&i){const n=s.$implicit;t.xp6(3),t.Oqu(n.name),t.xp6(1),t.Q6J("ngIf",n.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,4,n.total_cost/100)," "),t.xp6(2),t.Q6J("ngModel",n.quantity)}}function co(i,s){if(1&i&&(t.TgZ(0,"header",32),t.TgZ(1,"h3"),t._uU(2,"Confirm Order"),t.qZA(),t.qZA(),t.TgZ(3,"div",9),t.YNc(4,lo,9,6,"div",33),t.qZA()),2&i){const n=t.oxw();t.xp6(4),t.Q6J("ngForOf",n.order.items)}}function po(i,s,n){var o;let a=!0;for(const r of s)if(i.category===r.name||i.tags.includes(r.name)||(null===(o=n.space)||void 0===o?void 0:o.zones.includes(r.name))||"*"===r.name){let l=0;for(const c of r.rules){const m=new Date(n.date);switch(c[0]){case"after_hour":l+=(0,Gn.Z)(m,(0,L.Z)(m,c[1]))?1:0;break;case"before_hour":l+=(0,Rn.Z)(m,(0,L.Z)(m,c[1]))?1:0;break;case"min_length":l+=n.duration>=(0,Ue.H1)(c[1])?1:0;break;case"max_length":l+=n.duration<=(0,Ue.H1)(c[1])?1:0;break;case"visitor_type":l+=n.ext("visitor_type")===c[1]?1:0;break;default:l++}}a=l>=r.rules.length}return a}let Je=(()=>{class i extends f.KG{constructor(n){super(),this._data=n,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var n,o,a;return(0,v.mG)(this,void 0,void 0,function*(){this.loading="Loading menu...",this.order=new O.G(this._data.order),this.rules=yield this._data.getCateringConfig(null===(a=null===(o=null===(n=this.order.event)||void 0===n?void 0:n.space)||void 0===o?void 0:o.level)||void 0===a?void 0:a.parent_id),this._data.menu.subscribe(r=>{this.loading="Loading menu...";const l=(0,f.Tw)(r.map(m=>m.category)),c={};for(const m of l)c[m]=r.filter(_=>_.category===m&&po(_,this.rules,this.order.event));this.categories=l,this.menu_items=c,this.updateMenuQuantities(),this.timeout("clear_loading",()=>this.loading="",1e3)})})}addItem(n,o=!0){var a;const r=this.order.items.find(l=>l.id===n.id&&l.options.length===l.options.reduce((c,m)=>c+(n.options.find(_=>m.id===_.id)?1:0),0));o&&(null===(a=n.options)||void 0===a?void 0:a.length)?this._data.selectOptions(n.options).then(l=>{const c=new y.U(Object.assign(Object.assign({},n),{options:l}));this.addItem(c,!1)}):this.order=new O.G(Object.assign(Object.assign({},this.order),r?{items:this.order.items.filter(l=>!(l.id===n.id&&l.options_string===n.options_string)).concat([new y.U(Object.assign(Object.assign({},n),{quantity:r.quantity+1}))])}:{items:this.order.items.concat([new y.U(Object.assign(Object.assign({},n),{quantity:1}))])})),this.updateMenuQuantities()}removeItem(n){this.order=new O.G(Object.assign(Object.assign({},this.order),{items:this.order.items.filter(o=>o.id!==n.id&&o.options_string===n.options_string)})),this.updateMenuQuantities()}updateItemQuantity(n,o){const a=this.order.items.find(l=>l.id===n.id&&l.options_string===n.options_string);let r=[...this.order.items];r=a?this.order.items.filter(l=>!(l.id===n.id&&l.options_string===n.options_string)).concat([new y.U(Object.assign(Object.assign({},n),{quantity:o}))]):this.order.items.concat([new y.U(Object.assign(Object.assign({},n),{quantity:o}))]),r.sort((l,c)=>l.name.localeCompare(c.name)),this.order=new O.G(Object.assign(Object.assign({},this.order),{items:r})),this.updateMenuQuantities()}updateMenuQuantities(){for(const n in this.menu_items)for(const o of this.menu_items[n])o.quantity=this.order.items.reduce((a,r)=>r.id===o.id?a+r.quantity:a,0)}optionsFor(n){return n.options.map(o=>o.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(C.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(n,o){if(1&n&&(t.YNc(0,no,2,2,"div",0),t.YNc(1,ao,4,2,"footer",1),t.YNc(2,so,4,1,"ng-template",null,2,t.W1O),t.YNc(4,co,5,1,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(3);t.Q6J("ngIf",!o.loading)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!o.loading)}},directives:[u.O5,K.SP,u.sg,K.uX,qe.R,p.Fj,p.JJ,p.On,Hn.gM,h.lW,b.o,C.ZT,U.$g],pipes:[u.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em;&:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}&.error::placeholder{color:rgba(var(--error),.45)}}\n/*# sourceMappingURL=catering-order-modal.component.ts-angular-inline--63.css.map*/"]}),i})();var De=d(8390);function uo(i,s){if(1&i&&(t.TgZ(0,"div",18),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const n=t.oxw().$implicit;t.xp6(1),t.hij(" +",t.lcZ(2,1,n.unit_price/100)," ")}}function mo(i,s){if(1&i&&(t.TgZ(0,"mat-radio-button",14),t.TgZ(1,"div",15),t.TgZ(2,"div",16),t._uU(3),t.qZA(),t.YNc(4,uo,3,3,"div",17),t.qZA(),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(3),t.hij(" ",n.name," "),t.xp6(1),t.Q6J("ngIf",n.unit_price)}}function go(i,s){if(1&i){const n=t.EpF();t.ynx(0),t.TgZ(1,"mat-radio-group",10),t.NdJ("ngModelChange",function(a){t.CHM(n);const r=t.oxw().$implicit;return t.oxw().updateGroupOption(r,a)}),t.TgZ(2,"mat-radio-button",11),t.TgZ(3,"span",12),t._uU(4,"None"),t.qZA(),t.qZA(),t.YNc(5,mo,5,3,"mat-radio-button",13),t.qZA(),t.BQk()}if(2&i){const n=t.oxw().$implicit;t.xp6(5),t.Q6J("ngForOf",null==n?null:n.options)}}function _o(i,s){if(1&i&&(t.TgZ(0,"div",18),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&i){const n=t.oxw().$implicit;t.xp6(1),t.hij(" +",t.lcZ(2,1,n.unit_price/100)," ")}}function fo(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"mat-checkbox",20),t.NdJ("ngModelChange",function(a){const l=t.CHM(n).$implicit;return t.oxw(3).option_state[l.id]=a}),t.TgZ(1,"div",15),t.TgZ(2,"div",16),t._uU(3),t.qZA(),t.YNc(4,_o,3,3,"div",17),t.qZA(),t.qZA()}if(2&i){const n=s.$implicit,o=t.oxw(3);t.Q6J("ngModel",o.option_state[n.id]),t.xp6(3),t.hij(" ",n.name," "),t.xp6(1),t.Q6J("ngIf",n.unit_price)}}function ho(i,s){if(1&i&&t.YNc(0,fo,5,3,"mat-checkbox",19),2&i){const n=t.oxw().$implicit;t.Q6J("ngForOf",null==n?null:n.options)}}function vo(i,s){if(1&i&&(t.TgZ(0,"div",5),t.TgZ(1,"div",6),t._uU(2),t.qZA(),t.TgZ(3,"div",7),t.YNc(4,go,6,1,"ng-container",8),t.YNc(5,ho,1,1,"ng-template",null,9,t.W1O),t.qZA(),t.qZA()),2&i){const n=s.$implicit,o=t.MAs(6);t.uIk("group",n.name),t.xp6(2),t.Oqu(n.name),t.xp6(2),t.Q6J("ngIf",!n.multiple)("ngIfElse",o)}}let Qe=(()=>{class i{constructor(n){this._data=n,this.event=new t.vpe,this.option_state={};const o=(0,Oe.Tw)(this._data.options.map(r=>r.group||"Other")),a=[];for(const r of o){const l=this._data.options.filter(c=>c.group===r);a.push({name:r,multiple:!!l.find(c=>c.multiple),options:l})}this.groups=a}updateGroupOption(n,o){for(const a of n.options)this.option_state[a.id]=a.id===o}saveOptions(){const n=this._data.options.filter(o=>this.option_state[o.id]);this.event.emit({reason:"done",metadata:{options:n}})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(C.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(n,o){1&n&&(t.TgZ(0,"header"),t.TgZ(1,"h3"),t._uU(2,"Select options"),t.qZA(),t.TgZ(3,"button",0),t.TgZ(4,"app-icon"),t._uU(5,"close"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"main",1),t.YNc(7,vo,7,4,"div",2),t.qZA(),t.TgZ(8,"footer",3),t.TgZ(9,"button",4),t.NdJ("click",function(){return o.saveOptions()}),t._uU(10," Save "),t.qZA(),t.qZA()),2&n&&(t.xp6(7),t.Q6J("ngForOf",o.groups))},directives:[h.lW,C.ZT,b.o,u.sg,u.O5,De.VQ,p.JJ,p.On,De.U0,ie.oG],pipes:[u.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=catering-order-options-modal.component.ts-angular-inline--64.css.map*/"]}),i})();function xo(i,s){1&i&&(t.TgZ(0,"button",4),t.TgZ(1,"app-icon"),t._uU(2,"close"),t.qZA(),t.qZA())}function Zo(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"main"),t.TgZ(1,"div",5),t.TgZ(2,"app-icon",6),t._uU(3,"upload"),t.qZA(),t.TgZ(4,"p"),t._uU(5,"Click to select file or Drag and drop files"),t.qZA(),t.TgZ(6,"input",7),t.NdJ("change",function(a){return t.CHM(n),t.oxw().handleFileEvent(a)}),t.qZA(),t.qZA(),t.TgZ(7,"div",8),t.TgZ(8,"button",9),t.NdJ("click",function(){return t.CHM(n),t.oxw().downloadTemplate()}),t._uU(9," Download Template "),t.qZA(),t.qZA(),t.qZA()}}function bo(i,s){if(1&i&&(t.TgZ(0,"main",10),t._UZ(1,"mat-spinner",11),t.TgZ(2,"p"),t._uU(3),t.qZA(),t.qZA()),2&i){const n=t.oxw();t.xp6(3),t.Oqu(n.loading)}}let Se=(()=>{class i{constructor(){this.event=new t.vpe}handleFileEvent(n){this.loading="Processing menu data...";const o=n.target;if(!(null==o?void 0:o.files))return this.loading="";const a=o.files;if(!a.length)return this.loading="";const r=a[0],l=new FileReader;l.addEventListener("loadend",c=>{const _=(0,f.n5)(c.target.result);this.loading="",this.event.emit({reason:"done",metadata:_.filter(x=>"item"===(x.type||"").toLowerCase()).map(x=>new y.U(Object.assign(Object.assign({},x),{options:_.filter(g=>"option"===(g.type||"").toLowerCase()&&g.tags===x.id).map(g=>({id:g.id,name:g.name,group:g.category,multiple:g.multiple,unit_price:g.unit_price}))})))})}),l.readAsText(r)}downloadTemplate(){(0,f.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["mat-button","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(n,o){if(1&n&&(t.TgZ(0,"header",0),t.TgZ(1,"h2"),t._uU(2,"Import Catering Menu"),t.qZA(),t.YNc(3,xo,3,0,"button",1),t.qZA(),t.YNc(4,Zo,10,0,"main",2),t.YNc(5,bo,4,1,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(6);t.xp6(3),t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading)("ngIfElse",a)}},directives:[u.O5,h.lW,C.ZT,b.o,U.$g],styles:[""]}),i})(),ae=(()=>{class i extends f.KG{constructor(n,o){super(),this._org=n,this._dialog=o,this._menu=new F.X([]),this._loading=new F.X(!1),this._currency=new F.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(a=>(0,v.mG)(this,void 0,void 0,function*(){if(a){const r=(yield this.getCateringForZone(a.id)).map(l=>new y.U(l));this._currency.next(a.currency||"USD"),this._menu.next(r)}})))}get categories(){const n=this._menu.getValue();return(0,f.Tw)(n.map(o=>o.category))}manageCateringOrder(n){var o;return(0,v.mG)(this,void 0,void 0,function*(){const a=this._dialog.open(Je,{data:{order:n,menu:this.menu,loading:this.loading,getCateringConfig:l=>this.getCateringConfig(l),selectOptions:l=>this.selectOptions(l)}}),r=yield Promise.race([a.componentInstance.event.pipe((0,A.P)(l=>"done"===l.reason)).toPromise(),a.afterClosed().toPromise()]);return a.close(),(null===(o=null==r?void 0:r.metadata)||void 0===o?void 0:o.order)||n})}addItem(n=new y.U){return(0,v.mG)(this,void 0,void 0,function*(){const o=this._dialog.open(Fe,{data:{item:n,categories:this.categories}}),a=yield Promise.race([o.componentInstance.event.pipe((0,A.P)(c=>"done"===c.reason)).toPromise(),o.afterClosed().toPromise()]);if("done"!==(null==a?void 0:a.reason))return;const r=this._menu.getValue(),l=r.findIndex(c=>c.id===n.id);l>=0?r.splice(l,1,a.metadata.item):r.push(a.metadata.item),this.updateMenu(this._org.building.id,r).then(()=>{this._menu.next([...r]),o.close()},()=>o.componentInstance.loading=!1)})}addOption(n,o={}){return(0,v.mG)(this,void 0,void 0,function*(){const a=(0,f.Tw)(n.options.map(_=>_.group)),r=this._dialog.open(Ie,{data:{parent:n,option:o,types:a}}),l=yield Promise.race([r.componentInstance.event.pipe((0,A.P)(_=>"done"===_.reason)).toPromise(),r.afterClosed().toPromise()]);if("done"!==(null==l?void 0:l.reason))return;const c=this._menu.getValue(),m=c.findIndex(_=>_.id===n.id);m>=0?c.splice(m,1,l.metadata.item):c.push(l.metadata.item),this.updateMenu(this._org.building.id,c).then(()=>{this._menu.next([...c]),r.close()},()=>r.componentInstance.loading=!1)})}selectOptions(n){return(0,v.mG)(this,void 0,void 0,function*(){const o=this._dialog.open(Qe,{data:{options:n}}),a=yield Promise.race([o.componentInstance.event.pipe((0,A.P)(r=>"done"===r.reason)).toPromise(),o.afterClosed().toPromise()]);return"done"!==(null==a?void 0:a.reason)?[]:(o.close(),a.metadata.options)})}deleteItem(n){return(0,v.mG)(this,void 0,void 0,function*(){const o=yield(0,f._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${n.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==o.reason)return;o.loading("Removing catering item...");const a=this._menu.getValue().filter(r=>n.id!==r.id);this.updateMenu(this._org.building.id,a).then(()=>{this._menu.next([...a]),o.close()},()=>o.loading(""))})}deleteOption(n,o){return(0,v.mG)(this,void 0,void 0,function*(){const a=yield(0,f._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${o.name}" from "${n.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==a.reason)return;a.loading("Removing catering item option...");const r=this._menu.getValue();r.splice(r.findIndex(l=>l.id===n.id),1,new y.U(Object.assign(Object.assign({},n),{options:n.options.filter(l=>l.id!==o.id)}))),this.updateMenu(this._org.building.id,r).then(()=>{this._menu.next([...r]),a.close()},()=>a.loading(""))})}editConfig(){return(0,v.mG)(this,void 0,void 0,function*(){const n=yield this.getCateringConfig(this._org.building.id),o=this._menu.getValue(),a=(0,f.Tw)((0,f.xH)(o.map(c=>[c.category,...c.tags]))),r=this._dialog.open(ke,{data:{config:n,types:a}}),l=yield Promise.race([r.componentInstance.event.pipe((0,A.P)(c=>"done"===c.reason)).toPromise(),r.afterClosed().toPromise()]);"done"===(null==l?void 0:l.reason)&&this.updateConfig(this._org.building.id,l.metadata).then(()=>r.close(),()=>r.componentInstance.loading=!1)})}importMenu(){return(0,v.mG)(this,void 0,void 0,function*(){const n=this._dialog.open(Se),o=yield Promise.race([n.componentInstance.event.pipe((0,A.P)(c=>"done"===c.reason)).toPromise(),n.afterClosed().toPromise()]);if("done"!==(null==o?void 0:o.reason))return;n.componentInstance.loading="Updating menu...";const a=this._menu.getValue(),r=this._org.building,l=(0,f.Tw)(o.metadata.concat(a),"id");yield this.updateMenu(r.id,l).catch(c=>{throw(0,f.cB)("Error importing catering menu"),n.close(),c}),(0,f.t5)(`Successfully imported catering menu. ${o.metadata.length} item(s) added.`),n.close()})}updateMenu(n,o){return(0,X.Ymr)(n,{id:n,name:"catering",details:o,description:`Catering menu for ${n}`}).toPromise()}getCateringForZone(n){return(0,v.mG)(this,void 0,void 0,function*(){const o=(yield(0,X.rlq)(n,"catering").toPromise()).details;return o instanceof Array?o:[]})}getCateringConfig(n=this._org.building.id){return(0,v.mG)(this,void 0,void 0,function*(){const o=(yield(0,X.rlq)(n,"catering_config").toPromise()).details;return o instanceof Array?o:[]})}updateConfig(n,o){return(0,X.Ymr)(n,{id:n,name:"catering_config",details:o,description:`Catering menu config for ${n}`}).toPromise()}addItemToOrder(n,o){let a=n.items;const r=a.find(c=>{var m,_;return c.id===o.id&&(null===(m=o.options)||void 0===m?void 0:m.length)===(null===(_=c.options)||void 0===_?void 0:_.reduce((x,g)=>x+(o.options.find(Z=>g.id===Z.id)?1:0),0))});return r?r.quantity+=1:a=a.concat([new y.U(Object.assign(Object.assign({},o),{quantity:1}))]),new O.G(Object.assign(Object.assign({},n),{items:a,event:null}))}}return i.\u0275fac=function(n){return new(n||i)(t.LFG(S.w7),t.LFG(C.uw))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();d(9095),d(8759),d(9128),d(1810);var Ee=d(9377);function Go(i,s){1&i&&(t.TgZ(0,"div",9),t.TgZ(1,"label"),t._uU(2,"Host"),t.qZA(),t._UZ(3,"a-user-search-field",18),t.qZA())}function Ro(i,s){1&i&&(t.TgZ(0,"div",23),t._uU(1," Add catering "),t.qZA())}function Ho(i,s){if(1&i&&(t.TgZ(0,"div",24),t.TgZ(1,"div",25),t._uU(2),t.qZA(),t.TgZ(3,"div",26),t._uU(4),t.ALo(5,"currency"),t.qZA(),t.qZA()),2&i){const n=t.oxw(3);t.xp6(2),t.hij(" ",null==n.form?null:n.form.value.catering[0].item_count," item(s) "),t.xp6(2),t.hij(" ",t.lcZ(5,2,(null==n.form?null:n.form.value.catering[0].total_cost)/100)," ")}}function zo(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",19),t.TgZ(1,"label"),t._uU(2,"Catering"),t.qZA(),t.TgZ(3,"an-action-field",20),t.NdJ("onAction",function(){return t.CHM(n),t.oxw(2).editCatering()}),t.YNc(4,Ro,2,0,"div",21),t.YNc(5,Ho,6,4,"div",22),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);t.xp6(4),t.Q6J("ngIf",!(null!=n.form&&null!=n.form.value.catering&&n.form.value.catering.length)),t.xp6(1),t.Q6J("ngIf",null==n.form||null==n.form.value.catering?null:n.form.value.catering.length)}}d(4211),d(3902);const Vo=function(){return{standalone:!0}};function Wo(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"form",1),t.TgZ(1,"section",2),t.TgZ(2,"div",3),t.TgZ(3,"div",4),t.TgZ(4,"label"),t._uU(5,"Date"),t.qZA(),t.TgZ(6,"a-date-field",5),t._uU(7," Date and time must be in the future "),t.qZA(),t.qZA(),t.TgZ(8,"div",4),t.TgZ(9,"label"),t._uU(10,"Start Time"),t.qZA(),t.TgZ(11,"a-time-field",6),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw().form.patchValue({date:a})}),t.qZA(),t.qZA(),t.TgZ(12,"div",4),t.TgZ(13,"label"),t._uU(14,"End Time"),t.qZA(),t._UZ(15,"a-duration-field",7),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"section",2),t.YNc(17,Go,4,0,"div",8),t.TgZ(18,"div",9),t.TgZ(19,"label"),t._uU(20,"Attendees"),t.qZA(),t._UZ(21,"a-user-list-field",10),t.qZA(),t.qZA(),t.TgZ(22,"section",2),t.TgZ(23,"div",11),t.TgZ(24,"div",12),t.TgZ(25,"label"),t._uU(26,"Meeting Subject "),t.TgZ(27,"span"),t._uU(28,"*"),t.qZA(),t.qZA(),t.TgZ(29,"mat-form-field",13),t._UZ(30,"input",14),t.TgZ(31,"mat-error"),t._uU(32,"Meeting Subject is required"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(33,"div",15),t.TgZ(34,"label"),t._uU(35,"Notes"),t.qZA(),t.TgZ(36,"mat-form-field",13),t._UZ(37,"textarea",16),t.qZA(),t.qZA(),t.YNc(38,zo,6,2,"div",17),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw();let o;t.Q6J("formGroup",n.form),t.xp6(11),t.Q6J("ngModel",n.form.value.date)("ngModelOptions",t.DdM(8,Vo)),t.xp6(4),t.Q6J("time",null==(o=n.form.get("date"))?null:o.value)("max",n.max_duration),t.xp6(2),t.Q6J("ngIf",n.can_book_for_others),t.xp6(4),t.Q6J("hideActions",n.hide_actions),t.xp6(17),t.Q6J("ngIf",n.has_catering)}}let Xo=(()=>{class i{constructor(n,o){this._catering=n,this._settings=o,this.editCatering=()=>(0,v.mG)(this,void 0,void 0,function*(){return this.form.patchValue({catering:[yield this._catering.manageCateringOrder((this.form.value.catering?this.form.value.catering[0]:null)||new O.G)]})})}get has_catering(){return!!this._settings.get("app.events.has_catering")}get hide_actions(){return!!this._settings.get("app.events.hide_user_actions")}get can_book_for_others(){return this._settings.get("app.events.can_book_for_others")}get max_duration(){return this._settings.get("app.events.max_duration")||240}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(ae),t.Y36(f.gb))},i.\u0275cmp=t.Xpm({type:i,selectors:[["detailed-book-space-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"mb-4","border-b","border-gray-300"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],["formControlName","date"],[3,"ngModel","ngModelOptions","ngModelChange"],["formControlName","duration",3,"time","max"],["class","flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],[1,"flex","flex-col","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["formControlName","attendees",3,"hideActions"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col"],["appearance","outline"],["matInput","","formControlName","title","placeholder","Meeting title"],[1,"flex","flex-col","resize-y"],["matInput","","formControlName","body","placeholder","Add meeting notes here..."],["class","flex flex-col mb-4",4,"ngIf"],["formControlName","organiser"],[1,"flex","flex-col","mb-4"],[3,"onAction"],["class","opacity-40",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"opacity-40"],[1,"flex","items-center"],[1,"flex-1","w-1/2"],[1,"text-xs","opacity-60","px-4"]],template:function(n,o){1&n&&t.YNc(0,Wo,39,9,"form",0),2&n&&t.Q6J("ngIf",o.form)},directives:[u.O5,p._Y,p.JL,p.sg,he.Q,p.JJ,p.u,ve.N,p.On,xe.B,Ze.d,be.E,k.KE,Q.Nt,p.Fj,k.TO,_e.s],pipes:[u.H9],styles:[""]}),i})(),Ko=(()=>{class i{constructor(n,o){this._state=n,this._router=o,this.time=0,this.capacity=0,this.quick_times=[{name:"Now",value:0},{name:"Later Today",value:120},{name:"Tomorrow",value:(0,L.Z)((0,J.Z)(new Date,1),9).valueOf()}],this.quick_capacities=[{name:"Any Capacity",value:0},{name:"Small (1 - 4)",value:1},{name:"Medium (5 - 12)",value:5},{name:"Large (13 - 32)",value:13},{name:"Huge (32+)",value:33}],this.clearForm=()=>{this.time=this.capacity=0,this._state.clearForm()}}get is_edit(){var n,o;return!!(null===(o=null===(n=this.form)||void 0===n?void 0:n.get("id"))||void 0===o?void 0:o.value)}get form(){return this._state.form}quickBook(){this.form.patchValue({date:(this.time<1440?(0,ye.Z)((0,Ae.Z)(new Date,{nearestTo:5}),this.time):(0,L.Z)((0,J.Z)(new Date,1),8)).valueOf(),title:"Ad-hoc Meeting"}),this._state.setOptions({capacity:this.capacity}),this._router.navigate(["/book","spaces","find"])}findSpace(){this.form.markAllAsTouched(),this.form.valid&&this._router.navigate(["/book","spaces","find"])}confirmBooking(){this.form.markAllAsTouched(),this.form.valid&&this._router.navigate(["/book","spaces","confirm"])}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(z.MH),t.Y36(T.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["space-flow-form"]],decls:23,vars:5,consts:[["form","",1,"flex-1","min-h-[50%]"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[3,"form"],[1,"flex","flex-col","sm:flex-row","items-center","justify-center","space-x-0","space-y-2","sm:space-y-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],["mat-button","","clear","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]","inverse",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"ml-2","mx-4"],["mat-button","","find-space","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"],["mat-button","","standalone","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"section",0),t.TgZ(1,"h2",1),t._uU(2),t.qZA(),t._UZ(3,"detailed-book-space-form",2),t.TgZ(4,"div",3),t.TgZ(5,"button",4),t.NdJ("click",function(){return o.clearForm()}),t.TgZ(6,"div",5),t.TgZ(7,"app-icon",6),t._uU(8,"clear"),t.qZA(),t.TgZ(9,"span",7),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){return o.findSpace()}),t.TgZ(12,"div",5),t.TgZ(13,"app-icon",6),t._uU(14,"search"),t.qZA(),t.TgZ(15,"span",7),t._uU(16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"button",9),t.NdJ("click",function(){return o.confirmBooking()}),t.TgZ(18,"div",5),t.TgZ(19,"app-icon",6),t._uU(20,"event_available"),t.qZA(),t.TgZ(21,"span",7),t._uU(22),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(2),t.hij(" ",o.is_edit?"Edit":"Detailed"," Space Booking "),t.xp6(1),t.Q6J("form",o.form),t.xp6(7),t.Oqu(o.is_edit?"Cancel Edit":"Clear Form"),t.xp6(6),t.Oqu(o.is_edit?"Update Spaces":"Find Space"),t.xp6(6),t.Oqu(o.is_edit?"Confirm changes":"Book without Space"))},directives:[Xo,h.lW,b.o],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;overflow:auto}[quick][_ngcontent-%COMP%]{background-color:#007ac8}\n/*# sourceMappingURL=form.component.ts-angular-inline--72.css.map*/"]}),i})();function ei(i,s){1&i&&(t.ynx(0),t._UZ(1,"space-flow-find"),t.BQk())}function ti(i,s){1&i&&(t.ynx(0),t._UZ(1,"space-flow-confirm"),t.BQk())}function ni(i,s){if(1&i&&(t.ynx(0),t._UZ(1,"flow-success",4),t.BQk()),2&i){const n=t.oxw();t.xp6(1),t.Q6J("calendar",null==n.last_success?null:n.last_success.host)}}function oi(i,s){1&i&&(t.ynx(0),t._UZ(1,"space-flow-form"),t.BQk())}let ii=(()=>{class i extends f.KG{constructor(n,o){super(),this._state=n,this._route=o}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.loadForm(),this._state.form||this._state.newForm(),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView(n.get("success"))}))}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(z.MH),t.Y36(T.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["placeos-book-space-flow"]],features:[t.qOj],decls:6,vars:4,consts:[[1,"bg-white","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"calendar"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.ynx(1,1),t.YNc(2,ei,2,0,"ng-container",2),t.YNc(3,ti,2,0,"ng-container",2),t.YNc(4,ni,2,1,"ng-container",2),t.YNc(5,oi,2,0,"ng-container",3),t.BQk(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngSwitch",o.view),t.xp6(1),t.Q6J("ngSwitchCase","find"),t.xp6(1),t.Q6J("ngSwitchCase","confirm"),t.xp6(1),t.Q6J("ngSwitchCase","success"))},directives:[u.RF,u.n9,un,vn,ee,u.ED,Ko],styles:["[_nghost-%COMP%]{height:100%;width:100%}\n/*# sourceMappingURL=space-flow.component.ts-angular-inline--58.css.map*/"]}),i})();var ai=d(1992);let si=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["parking-flow-confirm"]],decls:0,vars:0,template:function(n,o){},styles:[""]}),i})();var ri=d(8461);const li=function(){return{}};function ci(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){const r=t.CHM(n).$implicit;return t.oxw(2).setDate(r.id)}),t.ALo(1,"async"),t.TgZ(2,"p",15),t._uU(3),t.qZA(),t.TgZ(4,"p",16),t._uU(5),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"p",17),t._uU(8,"Available"),t.qZA(),t.qZA()}if(2&i){const n=s.$implicit,o=t.oxw(2);let a;t.ekj("selected",n.id===(null==(a=t.lcZ(1,4,o.options))?null:a.date)),t.xp6(3),t.Oqu(n.name),t.xp6(2),t.hij(" ",(t.lcZ(6,6,o.counts)||t.DdM(8,li))[n.id]||"0"," ")}}function di(i,s){if(1&i&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&i){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n.display_name||n.name," ")}}function pi(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",18),t.TgZ(1,"mat-form-field",19),t.TgZ(2,"mat-select",20),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw(2).setLevel(null==a?null:a.id)}),t.ALo(3,"async"),t.YNc(4,di,2,2,"mat-option",21),t.ALo(5,"async"),t.qZA(),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);t.xp6(2),t.Q6J("ngModel",t.lcZ(3,2,n.level)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(5,4,n.levels))}}function ui(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){const r=t.CHM(n).$implicit;return t.oxw(2).setActive(r)}),t.ALo(1,"async"),t.TgZ(2,"div",24),t._uU(3),t.qZA(),t.TgZ(4,"div",25),t._uU(5),t.qZA(),t.qZA()}if(2&i){const n=s.$implicit,o=t.oxw(2);let a;t.ekj("active",(null==(a=t.lcZ(1,4,o.active_space))?null:a.id)===n.id),t.xp6(3),t.hij("Bay No. ",n.name,""),t.xp6(2),t.hij(" ",o.levelName(n.zone_id)," ")}}function mi(i,s){1&i&&(t.TgZ(0,"p",29),t._uU(1," Note that your existing parking space reservation will be replaced "),t.qZA())}function gi(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div",26),t.TgZ(1,"p"),t._uU(2),t.ALo(3,"async"),t.qZA(),t.YNc(4,mi,2,0,"p",27),t.ALo(5,"async"),t.TgZ(6,"button",28),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).reserveSpace()}),t._uU(7," Reserve Space "),t.qZA(),t.qZA()}if(2&i){const n=t.oxw(2);let o;t.xp6(2),t.hij(" Parking Bay No. ",t.lcZ(3,2,n.active_space).name," selected. "),t.xp6(2),t.Q6J("ngIf",null==(o=t.lcZ(5,4,n.existing))?null:o.length)}}function _i(i,s){if(1&i&&(t.TgZ(0,"div",30),t.TgZ(1,"p"),t._uU(2),t.ALo(3,"async"),t.ALo(4,"async"),t.qZA(),t.qZA()),2&i){const n=t.oxw(2);let o;t.xp6(2),t.hij(" Parking is not available for ",(null==(o=t.lcZ(3,1,n.building))?null:o.display_name)||(null==(o=t.lcZ(4,3,n.building))?null:o.name)," ")}}function fi(i,s){if(1&i&&(t.TgZ(0,"div",2),t.TgZ(1,"div",3),t.YNc(2,ci,9,9,"button",4),t.qZA(),t.TgZ(3,"div",5),t.TgZ(4,"div",6),t.YNc(5,pi,6,6,"div",7),t.ALo(6,"async"),t.TgZ(7,"p"),t._uU(8),t.ALo(9,"async"),t.qZA(),t.YNc(10,ui,6,6,"button",8),t.ALo(11,"async"),t.qZA(),t.TgZ(12,"div",9),t._UZ(13,"i-map",10),t.ALo(14,"async"),t.ALo(15,"async"),t.ALo(16,"async"),t.ALo(17,"async"),t.ALo(18,"async"),t.ALo(19,"async"),t.ALo(20,"async"),t._UZ(21,"explore-zoom-controls",11),t.qZA(),t.YNc(22,gi,8,6,"div",12),t.ALo(23,"async"),t.YNc(24,_i,5,5,"div",13),t.ALo(25,"async"),t.qZA(),t.qZA()),2&i){const n=t.oxw();let o,a,r,l,c;t.xp6(2),t.Q6J("ngForOf",n.dates),t.xp6(3),t.Q6J("ngIf",(null==(o=t.lcZ(6,13,n.levels))?null:o.length)>1),t.xp6(3),t.hij("",null==(a=t.lcZ(9,15,n.available))?null:a.length," space(s) available"),t.xp6(2),t.Q6J("ngForOf",t.lcZ(11,17,n.available)),t.xp6(3),t.Q6J("src",t.lcZ(14,19,n.url))("zoom",null==(r=t.lcZ(15,21,n.positions))?null:r.zoom)("center",null==(l=t.lcZ(16,23,n.positions))?null:l.center)("styles",t.lcZ(17,25,n.styles))("features",t.lcZ(18,27,n.features))("actions",t.lcZ(19,29,n.actions))("labels",t.lcZ(20,31,n.labels)),t.xp6(9),t.Q6J("ngIf",t.lcZ(23,33,n.active_space)),t.xp6(2),t.Q6J("ngIf",!(null!=(c=t.lcZ(25,35,n.levels))&&c.length))}}function hi(i,s){1&i&&(t.TgZ(0,"div",32),t._UZ(1,"mat-spinner",33),t.TgZ(2,"p"),t._uU(3,"Reserving parking space..."),t.qZA(),t.qZA())}function vi(i,s){if(1&i&&(t.YNc(0,hi,4,0,"div",31),t.ALo(1,"async")),2&i){const n=t.oxw();let o;t.Q6J("ngIf",!(null!=(o=t.lcZ(1,1,n.levels))&&o.length))}}let xi=(()=>{class i extends f.KG{constructor(n){var o,a;super(),this._details=n,this.zoom=1,this.ratio=1,this.subscription("zoom",null===(o=this._details.zoom$)||void 0===o?void 0:o.subscribe(r=>this.zoom=r)),this.subscription("ratio",null===(a=this._details.ratio$)||void 0===a?void 0:a.subscribe(r=>this.ratio=r))}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(xn.ui))},i.\u0275cmp=t.Xpm({type:i,selectors:[["space-ping"]],features:[t.qOj],decls:2,vars:2,consts:[[1,"absolute","inset-0","pointer-events-auto"],[1,"absolute","inset-0","animate-ping","border-4","border-green-600"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.qZA()),2&n&&t.Udp("transform","scale("+o.zoom*o.ratio+")")},encapsulation:2}),i})(),Zi=(()=>{class i extends f.KG{constructor(n,o,a,r,l){super(),this._state=n,this._parking=o,this._org=a,this._booking=r,this._router=l,this.url=this._state.map_url,this.styles=this._state.map_styles,this.positions=this._state.map_positions,this.features=this._state.map_features,this.actions=this._state.map_actions,this.labels=this._state.map_labels,this.building=this._org.active_building,this.level=this._state.level,this.levels=this._parking.levels,this.available=this._parking.available_spaces,this.counts=this._parking.week_availablility,this.options=this._parking.options,this.existing=this._parking.existing_event,this.loading=this._booking.loading,this.active_space=new F.X(null),this.dates=new Array(7).fill(0).map((c,m)=>({id:(0,Ee.Z)((0,J.Z)(Date.now(),m)).valueOf(),name:(0,me.Z)((0,J.Z)(Date.now(),m),"EEE, dd MMM"),available:0})),this.setDate=c=>this._parking.setOptions({date:c}),this.setLevel=c=>this._state.setLevel(c),this.reserveSpace=()=>(0,v.mG)(this,void 0,void 0,function*(){const c=yield this._parking.existing_event.pipe((0,te.q)(1)).toPromise();c.length&&this._booking.form.patchValue({id:c[0].id}),yield this._booking.postForm(),this._router.navigate(["book","parking","success"])})}levelName(n){const o=this._org.levelWithID([n]);return(null==o?void 0:o.display_name)||(null==o?void 0:o.name)||""}setActive(n){n===this.active_space.getValue()?this.active_space.next(null):(this._booking.form.patchValue({asset_id:n.id,asset_name:n.name}),this.active_space.next(n))}ngOnInit(){return(0,v.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,A.P)(n=>n)).toPromise(),this._state.reset(),this.subscription("levels",this._parking.levels.subscribe(n=>{var o;this._state.setLevel(null===(o=n[0])||void 0===o?void 0:o.id)})),this.subscription("spaces",this._parking.available_spaces.subscribe(n=>{this._state.setActions("parking_spaces",(n||[]).map(o=>({id:o.map_id,action:"click",callback:()=>this.setActive(o)})))})),this.subscription("active_space",this.active_space.subscribe(n=>{if(!n)return this._state.setFeatures("parking_space",[]);this._state.setFeatures("parking_space",[{location:n.map_id,content:xi,full_size:!0,z_index:0}])}))})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(Y.ck),t.Y36(Y.pi),t.Y36(S.w7),t.Y36(N.fy),t.Y36(T.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["parking-flow-map"]],features:[t._Bn([Y.pi]),t.qOj],decls:4,vars:4,consts:[["class","w-full h-full flex flex-col items-center relative",4,"ngIf","ngIfElse"],["load_state",""],[1,"w-full","h-full","flex","flex-col","items-center","relative"],[1,"p-4","flex","items-center","justify-center","bg-secondary","w-full","shadow","z-10","text-white","space-x-2"],["matRipple","","class","border border-white flex flex-col items-center justify-center h-24 w-28 rounded",3,"selected","click",4,"ngFor","ngForOf"],[1,"flex","w-full","h-1/2","flex-1","z-0"],[1,"p-2","sm:w-[18rem]","w-full","h-full","bg-gray-50","shadow","z-10","overflow-auto","space-y-2"],["class","bg-white sticky top-0 w-full z-10",4,"ngIf"],["matRipple","","class","flex items-center justify-between bg-white rounded-lg border border-gray-200 p-2 w-full",3,"active","click",4,"ngFor","ngForOf"],[1,"bg-gray-200","flex-1","w-1/2","h-full","z-0","relative","hidden","sm:block"],[3,"src","zoom","center","styles","features","actions","labels"],[1,"absolute","bottom-0","right-0"],["class","absolute left-1/2 bottom-2 -translate-x-1/2 bg-white shadow rounded p-4 flex flex-col space-y-2",4,"ngIf"],["class","absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-50",4,"ngIf"],["matRipple","",1,"border","border-white","flex","flex-col","items-center","justify-center","h-24","w-28","rounded",3,"click"],[1,"mb-2","font-medium"],[1,"text-2xl"],[1,"text-sm"],[1,"bg-white","sticky","top-0","w-full","z-10"],["appearance","outline",1,"w-full","h-[3.25rem]"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["matRipple","",1,"flex","items-center","justify-between","bg-white","rounded-lg","border","border-gray-200","p-2","w-full",3,"click"],[1,"text-lg"],[1,"opacity-60"],[1,"absolute","left-1/2","bottom-2","-translate-x-1/2","bg-white","shadow","rounded","p-4","flex","flex-col","space-y-2"],["class","p-2 rounded text-sm max-w-[20rem] text-center text-pending leading-tight",4,"ngIf"],["mat-button","",3,"click"],[1,"p-2","rounded","text-sm","max-w-[20rem]","text-center","text-pending","leading-tight"],[1,"absolute","inset-0","bg-white/80","flex","flex-col","items-center","justify-center","z-50"],["class","absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-50 space-y-2",4,"ngIf"],[1,"absolute","inset-0","bg-white/80","flex","flex-col","items-center","justify-center","z-50","space-y-2"],["diameter","32"]],template:function(n,o){if(1&n&&(t.YNc(0,fi,26,37,"div",0),t.ALo(1,"async"),t.YNc(2,vi,2,3,"ng-template",null,1,t.W1O)),2&n){const a=t.MAs(3);t.Q6J("ngIf",!t.lcZ(1,2,o.loading))("ngIfElse",a)}},directives:[u.O5,u.sg,w.wG,k.KE,H.gD,p.JJ,p.On,w.ey,we.p,ri.s,h.lW,U.$g],pipes:[u.Ov],styles:[".active[_ngcontent-%COMP%]{background-color:var(--primary)!important;color:#fff}.selected[_ngcontent-%COMP%]{background-color:#fff!important;color:#000d}\n/*# sourceMappingURL=parking-flow-map.component.ts-angular-inline--74.css.map*/"]}),i})();function bi(i,s){1&i&&(t.ynx(0),t._UZ(1,"parking-flow-confirm"),t.BQk())}function Ti(i,s){if(1&i&&(t.ynx(0),t._UZ(1,"flow-success",4),t.BQk()),2&i){const n=t.oxw();t.xp6(1),t.Q6J("calendar",null==n.last_success?null:n.last_success.host)}}function Ci(i,s){1&i&&(t.ynx(0),t._UZ(1,"parking-flow-map"),t.BQk())}const wi=[{path:"",component:nt,children:[{path:"code",component:rt},{path:"desks",redirectTo:"desks/form"},{path:"desks/:step",component:Bt},{path:"spaces",redirectTo:"spaces/form"},{path:"spaces/:step",component:ii},{path:"parking",redirectTo:"parking/form"},{path:"parking/:step",component:(()=>{class i extends f.KG{constructor(n,o){super(),this._state=n,this._route=o}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.setOptions({type:"parking"}),this._state.loadForm(),this._state.form||this._state.newForm(),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView(n.get("success"))}))}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(N.fy),t.Y36(T.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["placeos-book-parking-flow"]],features:[t.qOj],decls:5,vars:3,consts:[[1,"bg-white","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["route","parking","type","parking",3,"calendar"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.ynx(1,1),t.YNc(2,bi,2,0,"ng-container",2),t.YNc(3,Ti,2,1,"ng-container",2),t.YNc(4,Ci,2,0,"ng-container",3),t.BQk(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngSwitch",o.view),t.xp6(1),t.Q6J("ngSwitchCase","confirm"),t.xp6(1),t.Q6J("ngSwitchCase","success"))},directives:[u.RF,u.n9,si,ee,u.ED,Zi],styles:["[_nghost-%COMP%]{height:100%;width:100%}\n/*# sourceMappingURL=parking-flow.component.ts-angular-inline--73.css.map*/"]}),i})()},{path:"*",redirectTo:"spaces/form"}]},{path:"*",redirectTo:"spaces/form"}];let yi=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[u.ez,ai.v,p.u5,Y.P2,p.UX,Ke,T.Bz.forChild(wi)]]}),i})()}}]);
//# sourceMappingURL=apps_workplace_src_app_book_book_module_ts.js.map