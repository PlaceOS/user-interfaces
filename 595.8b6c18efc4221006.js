"use strict";(self.webpackChunkworkplace=self.webpackChunkworkplace||[]).push([[595],{6595:(or,Yt,d)=>{d.r(Yt),d.d(Yt,{BookModule:()=>Re});var l=d(6895),c=d(4006),x=d(6581),Sn=d(2687),Ie=d(1281),An=d(5017),e=d(6353),C=d(3238);const bn=["button"],Fn=["*"],Qt=new e.OlP("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS"),Bt=new e.OlP("MatButtonToggleGroup"),Nn={provide:c.JU,useExisting:(0,e.Gpc)(()=>Xt),multi:!0};let jt=0;class Ht{constructor(n,t){this.source=n,this.value=t}}let Xt=(()=>{class o{constructor(t,i){this._changeDetector=t,this._vertical=!1,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name="mat-button-toggle-group-"+jt++,this.valueChange=new e.vpe,this.change=new e.vpe,this.appearance=i&&i.appearance?i.appearance:"standard"}get name(){return this._name}set name(t){this._name=t,this._markButtonsForCheck()}get vertical(){return this._vertical}set vertical(t){this._vertical=(0,Ie.Ig)(t)}get value(){const t=this._selectionModel?this._selectionModel.selected:[];return this.multiple?t.map(i=>i.value):t[0]?t[0].value:void 0}set value(t){this._setSelectionByValue(t),this.valueChange.emit(this.value)}get selected(){const t=this._selectionModel?this._selectionModel.selected:[];return this.multiple?t:t[0]||null}get multiple(){return this._multiple}set multiple(t){this._multiple=(0,Ie.Ig)(t),this._markButtonsForCheck()}get disabled(){return this._disabled}set disabled(t){this._disabled=(0,Ie.Ig)(t),this._markButtonsForCheck()}ngOnInit(){this._selectionModel=new An.Ov(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(t=>t.checked))}writeValue(t){this.value=t,this._changeDetector.markForCheck()}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}_emitChangeEvent(t){const i=new Ht(t,this.value);this._controlValueAccessorChangeFn(i.value),this.change.emit(i)}_syncButtonToggle(t,i,_=!1,s=!1){!this.multiple&&this.selected&&!t.checked&&(this.selected.checked=!1),this._selectionModel?i?this._selectionModel.select(t):this._selectionModel.deselect(t):s=!0,s?Promise.resolve().then(()=>this._updateModelValue(t,_)):this._updateModelValue(t,_)}_isSelected(t){return this._selectionModel&&this._selectionModel.isSelected(t)}_isPrechecked(t){return!(typeof this._rawValue>"u")&&(this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(i=>null!=t.value&&i===t.value):t.value===this._rawValue)}_setSelectionByValue(t){this._rawValue=t,this._buttonToggles&&(this.multiple&&t?(Array.isArray(t),this._clearSelection(),t.forEach(i=>this._selectValue(i))):(this._clearSelection(),this._selectValue(t)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(t=>t.checked=!1)}_selectValue(t){const i=this._buttonToggles.find(_=>null!=_.value&&_.value===t);i&&(i.checked=!0,this._selectionModel.select(i))}_updateModelValue(t,i){i&&this._emitChangeEvent(t),this.valueChange.emit(this.value)}_markButtonsForCheck(){this._buttonToggles?.forEach(t=>t._markForCheck())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(Qt,8))},o.\u0275dir=e.lG2({type:o,selectors:[["mat-button-toggle-group"]],contentQueries:function(t,i,_){if(1&t&&e.Suo(_,zt,5),2&t){let s;e.iGM(s=e.CRH())&&(i._buttonToggles=s)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(t,i){2&t&&(e.uIk("aria-disabled",i.disabled),e.ekj("mat-button-toggle-vertical",i.vertical)("mat-button-toggle-group-appearance-standard","standard"===i.appearance))},inputs:{appearance:"appearance",name:"name",vertical:"vertical",value:"value",multiple:"multiple",disabled:"disabled"},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[e._Bn([Nn,{provide:Bt,useExisting:o}])]}),o})();const wn=(0,C.Kr)(class{});let zt=(()=>{class o extends wn{constructor(t,i,_,s,a,r){super(),this._changeDetectorRef=i,this._elementRef=_,this._focusMonitor=s,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new e.vpe;const u=Number(a);this.tabIndex=u||0===u?u:null,this.buttonToggleGroup=t,this.appearance=r&&r.appearance?r.appearance:"standard"}get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(t){this._appearance=t}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(t){const i=(0,Ie.Ig)(t);i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(t){this._disabled=(0,Ie.Ig)(t)}ngOnInit(){const t=this.buttonToggleGroup;this.id=this.id||"mat-button-toggle-"+jt++,t&&(t._isPrechecked(this)?this.checked=!0:t._isSelected(this)!==this._checked&&t._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const t=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),t&&t._isSelected(this)&&t._syncButtonToggle(this,!1,!1,!0)}focus(t){this._buttonElement.nativeElement.focus(t)}_onButtonClick(){const t=!!this._isSingleSelector()||!this._checked;t!==this._checked&&(this._checked=t,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new Ht(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}_getButtonName(){return this._isSingleSelector()?this.buttonToggleGroup.name:this.name||null}_isSingleSelector(){return this.buttonToggleGroup&&!this.buttonToggleGroup.multiple}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Bt,8),e.Y36(e.sBO),e.Y36(e.SBq),e.Y36(Sn.tE),e.$8M("tabindex"),e.Y36(Qt,8))},o.\u0275cmp=e.Xpm({type:o,selectors:[["mat-button-toggle"]],viewQuery:function(t,i){if(1&t&&e.Gf(bn,5),2&t){let _;e.iGM(_=e.CRH())&&(i._buttonElement=_.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(t,i){1&t&&e.NdJ("focus",function(){return i.focus()}),2&t&&(e.uIk("aria-label",null)("aria-labelledby",null)("id",i.id)("name",null),e.ekj("mat-button-toggle-standalone",!i.buttonToggleGroup)("mat-button-toggle-checked",i.checked)("mat-button-toggle-disabled",i.disabled)("mat-button-toggle-appearance-standard","standard"===i.appearance))},inputs:{disableRipple:"disableRipple",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",appearance:"appearance",checked:"checked",disabled:"disabled"},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[e.qOj],ngContentSelectors:Fn,decls:6,vars:9,consts:[["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"id","disabled","click"],["button",""],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(t,i){if(1&t&&(e.F$t(),e.TgZ(0,"button",0,1),e.NdJ("click",function(){return i._onButtonClick()}),e.TgZ(2,"span",2),e.Hsn(3),e.qZA()(),e._UZ(4,"span",3)(5,"span",4)),2&t){const _=e.MAs(1);e.Q6J("id",i.buttonId)("disabled",i.disabled||null),e.uIk("tabindex",i.disabled?-1:i.tabIndex)("aria-pressed",i.checked)("name",i._getButtonName())("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby),e.xp6(5),e.Q6J("matRippleTrigger",_)("matRippleDisabled",i.disableRipple||i.disabled)}},dependencies:[C.wG],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 36px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}"],encapsulation:2,changeDetection:0}),o})(),Mn=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[C.BQ,C.si,C.BQ]}),o})();var B=d(8242),ke=d(3874),E=d(9638),Vt=d(8560),Dt=d(6725),Pe=d(2793),T=d(5306),en=d(2581);function Zn(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"section",2),e._UZ(2,"image-carousel",3),e.TgZ(3,"button",4),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.close.emit())}),e.TgZ(4,"app-icon"),e._uU(5,"arrow_back"),e.qZA()(),e.TgZ(6,"button",5),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.toggleFav.emit())}),e.TgZ(7,"app-icon"),e._uU(8),e.qZA()()(),e.TgZ(9,"div",6)(10,"section",7)(11,"div")(12,"h2",8),e._uU(13),e.qZA(),e.TgZ(14,"p"),e._uU(15),e.qZA()(),e.TgZ(16,"a-counter",9),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.item.amount=_)}),e.qZA()(),e._UZ(17,"hr"),e.TgZ(18,"section",10)(19,"h2",11),e._uU(20,"Details"),e.qZA(),e.TgZ(21,"div",12)(22,"p"),e._uU(23),e.qZA()()()(),e.TgZ(24,"div",13)(25,"button",14),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return _.active=!_.active,e.KtG(_.activeChange.emit(_.active))}),e.TgZ(26,"div",15)(27,"app-icon",16),e._uU(28),e.qZA(),e.TgZ(29,"p"),e._uU(30),e.qZA()()()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("images",t.images),e.xp6(4),e.ekj("text-white",!t.fav)("text-blue-400",t.fav),e.xp6(2),e.Oqu(t.fav?"favorite":"favorite_border"),e.xp6(5),e.hij(" ",t.item.name," "),e.xp6(2),e.hij("",t.item.count," Available"),e.xp6(1),e.Q6J("ngModel",t.item.amount)("min",1)("max",t.item.count||2),e.xp6(7),e.Oqu(t.item.description||"No description"),e.xp6(2),e.ekj("inverse",t.active),e.xp6(3),e.Oqu(t.active?"remove":"add"),e.xp6(2),e.hij(" ",t.active?"Remove this asset":"Add this asset"," ")}}function Rn(o,n){1&o&&(e.TgZ(0,"div",17)(1,"p",18),e._uU(2," Select an asset to view it's details "),e.qZA()())}class oe{constructor(){this.active=!1,this.fav=!1,this.toggleFav=new e.vpe,this.activeChange=new e.vpe,this.close=new e.vpe}get images(){return this.item?.images.map(n=>n.url)||[]}}oe.\u0275fac=function(n){return new(n||oe)},oe.\u0275cmp=e.Xpm({type:oe,selectors:[["asset-details"]],inputs:{item:"item",active:"active",fav:"fav"},outputs:{toggleFav:"toggleFav",activeChange:"activeChange",close:"close"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["empty_state",""],["image","",1,"relative","w-full","h-64","sm:h-40","bg-black/20"],[1,"absolute","inset-0",3,"images"],["icon","","matRipple","","close","",1,"absolute","top-2","left-2","bg-black/40","sm:hidden","text-white",3,"click"],["icon","","matRipple","","fav","",1,"absolute","top-2","right-2","bg-black/40",3,"click"],[1,"p-2","space-y-2","flex-1","h-1/2","overflow-auto"],["actions","",1,"z-0","flex","items-center","justify-between"],[1,"text-xl","font-medium","mb-2","mt-4"],[3,"ngModel","min","max","ngModelChange"],["details","",1,"space-y-2"],[1,"text-xl","font-medium"],[1,"flex","items-center","space-x-2"],[1,"p-2","border-t","border-gray-200","shadow","sm:hidden"],["btn","","matRipple","","select","",1,"w-full",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-2xl"],["empty","",1,"p-16","flex","flex-col","items-center","justify-center","space-y-2"],[1,"opacity-30","text-center"]],template:function(n,t){if(1&n&&(e.YNc(0,Zn,31,16,"ng-container",0),e.YNc(1,Rn,3,0,"ng-template",null,1,e.W1O)),2&n){const i=e.MAs(2);e.Q6J("ngIf",t.item)("ngIfElse",i)}},dependencies:[l.O5,Pe.R,c.JJ,c.On,T.o,en.K],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:30%;min-width:20rem;height:100%;min-height:65vh}"]});class ie{}ie.\u0275fac=function(n){return new(n||ie)},ie.\u0275cmp=e.Xpm({type:ie,selectors:[["asset-filters"]],decls:0,vars:0,template:function(n,t){}});class _e{}_e.\u0275fac=function(n){return new(n||_e)},_e.\u0275cmp=e.Xpm({type:_e,selectors:[["asset-filters-display"]],decls:0,vars:0,template:function(n,t){}});var N=d(591),se=d(1086),q=d(3426),j=d(7545),ae=d(2994),W=d(5154),Lt=d(13),F=d(4850),L=d(9909),yn=d(5038),Ue=d(7221);class In{constructor(n={}){this.amount=1,this.id=n.id||"",this.name=n.name||"",this.category=n.category||"",this.images=n.images||[],this.barcode=n.barcode||"",this.brand=n.brand||"",this.size=n.size||"Small",this.description=n.description||"",this.specifications=n.specifications||{},this.purchase_date=1e3*n.purchase_date||Date.now(),this.purchase_price=n.purchase_price||0,this.purchase_details=n.purchase_details||[],this.consumables=n.consumables||[],this.general_details=n.general_details||[],this.invoices=n.invoices||[],this.count=n.count??0,this.locations=n.locations||[],this.amount=n.amount??1}}var Dn=d(354),P=d(9972),qt=d(8115),Rt=d(2722);class le{constructor(){this._options=new N.X({date:Date.now()}),this._search=new N.X(""),this._loading=new N.X(""),this.search=this._search.asObservable(),this.loading=this._loading.asObservable(),this.asset_list=(0,se.of)(0).pipe((0,j.w)(()=>(this._loading.next(this._loading.getValue()+"[Assets]"),function kn(o){const n=(0,yn.U)({q:o});return(0,L.U2M)(`/api/engine/v2/assets${n||""}`).pipe((0,F.U)(t=>t.map(i=>new In(i))),(0,Ue.K)(t=>(0,se.of)([])))}())),(0,ae.b)(n=>this._loading.next(this._loading.getValue().replace(/\[Assets\]/g,""))),(0,W.d)(1)),this.asset_bookings=this._options.pipe((0,Lt.b)(300),(0,j.w)(({zone:n,date:t})=>(this._loading.next(this._loading.getValue()+"[Bookings]"),(0,Dn.F2)({zones:n||"",period_start:(0,P.Z)((0,qt.Z)(t)),period_end:(0,P.Z)((0,Rt.Z)(t)),type:"asset-request"}))),(0,ae.b)(n=>this._loading.next(this._loading.getValue().replace(/\[Bookings\]/g,""))),(0,W.d)(1)),this.available_assets=(0,q.aj)([this.asset_list,this.asset_bookings]).pipe((0,F.U)(([n,t])=>n.filter(i=>!t.find(_=>_.asset_id===i.id)).sort((i,_)=>i.category.localeCompare(_.category)||i.name.localeCompare(_.name))),(0,W.d)(1)),this.filtered_assets=(0,q.aj)([this._search,this.available_assets]).pipe((0,F.U)(([n,t])=>{const i=n.toLowerCase();return t.filter(_=>_.name.toLowerCase().includes(i)||_.description.toLowerCase().includes(i))}),(0,W.d)(1))}setSearch(n){this._search.next(`${n}`)}setOptions(n){this._options.next({...this._options.value,...n})}}le.\u0275fac=function(n){return new(n||le)},le.\u0275prov=e.Yz7({token:le,factory:le.\u0275fac,providedIn:"root"});var w=d(1572);function Ln(o,n){if(1&o&&(e.TgZ(0,"div",18)(1,"span",19),e._uU(2),e.qZA()()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.amount||1)}}function qn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"li",9)(1,"button",10),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.selectAsset(s))}),e.TgZ(2,"div",11),e.YNc(3,Ln,3,1,"div",12),e.qZA(),e.TgZ(4,"div",13)(5,"div",14)(6,"div"),e._uU(7),e.qZA(),e.TgZ(8,"div",15),e._uU(9),e.qZA()(),e.TgZ(10,"div",16)(11,"p"),e._uU(12),e.qZA()()()(),e.TgZ(13,"button",17),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.toggleFav.emit(s))}),e.TgZ(14,"app-icon"),e._uU(15),e.qZA()()()}if(2&o){const t=n.$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("ngIf",i.selected.includes(t.id)),e.xp6(4),e.Oqu(t.name||"Asset"),e.xp6(2),e.hij(" ",t.category," "),e.xp6(3),e.hij(" ",t.count<1?2:t.count," Available "),e.xp6(1),e.ekj("text-blue-400",i.isFavourite(t.id)),e.xp6(2),e.Oqu(i.isFavourite(t.id)?"favorite":"favorite_border")}}function Kn(o,n){if(1&o&&(e.TgZ(0,"ul",7),e.YNc(1,qn,16,7,"li",8),e.ALo(2,"async"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.assets))}}function Wn(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Kn,3,3,"ul",6),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw(),i=e.MAs(9);let _;e.xp6(1),e.Q6J("ngIf",null==(_=e.lcZ(2,2,t.assets))?null:_.length)("ngIfElse",i)}}function $n(o,n){1&o&&(e.TgZ(0,"div",20)(1,"p",21),e._uU(2," No available assets for selected time and/or filters "),e.qZA()())}function Gn(o,n){1&o&&(e.TgZ(0,"div",22),e._UZ(1,"mat-spinner",23),e.TgZ(2,"p",24),e._uU(3,"Finding available assets..."),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("diameter",32))}class re{constructor(n){this._asset_state=n,this.selected="",this.favorites=[],this.toggleFav=new e.vpe,this.onSelect=new e.vpe,this.loading=this._asset_state.loading,this.assets=this._asset_state.filtered_assets}isFavourite(n){return this.favorites.includes(n)}selectAsset(n){this.onSelect.emit(n)}}re.\u0275fac=function(n){return new(n||re)(e.Y36(le))},re.\u0275cmp=e.Xpm({type:re,selectors:[["asset-list"]],inputs:{selected:"selected",favorites:"favorites"},outputs:{toggleFav:"toggleFav",onSelect:"onSelect"},decls:12,vars:7,consts:[[1,"w-full","h-full","overflow-auto","py-2","bg-black/5","dark:bg-white/10","dark:border-neutral-500"],[1,"font-bold","px-2"],["count","",1,"text-sm","opacity-60","mb-4","px-2"],[4,"ngIf","ngIfElse"],["empty_state",""],["load_state",""],["class","list-style-none space-y-2 p-2",4,"ngIf","ngIfElse"],[1,"list-style-none","space-y-2","p-2"],["asset","","class","relative p-2 rounded-lg w-full shadow border bg-white dark:bg-neutral-700 border-gray-200 dark:border-neutral-500",4,"ngFor","ngForOf"],["asset","",1,"relative","p-2","rounded-lg","w-full","shadow","border","bg-white","dark:bg-neutral-700","border-gray-200","dark:border-neutral-500"],["matRipple","","select","",1,"w-full","h-full","flex","items-center","pr-10",3,"click"],[1,"relative","w-16","h-16","rounded-xl","bg-black/20","mr-4"],["class","absolute top-1 left-1 border border-white bg-black/50 rounded-full h-6 w-6 flex items-center justify-center text-white",4,"ngIf"],[1,"space-y-2","text-left","flex-1"],[1,"font-medium","flex","items-center","justify-between"],[1,"opacity-60","text-xs"],[1,"flex","items-center","text-sm","space-x-2"],["icon","","matRipple","","fav","",1,"absolute","top-1","right-1",3,"click"],[1,"absolute","top-1","left-1","border","border-white","bg-black/50","rounded-full","h-6","w-6","flex","items-center","justify-center","text-white"],[1,"text-xs"],["empty","",1,"p-16","flex","flex-col","items-center","justify-center","space-y-2"],[1,"opacity-30","text-center"],["loading","",1,"p-16","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"],[1,"opacity-30"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Results"),e.qZA(),e.TgZ(3,"p",2),e._uU(4),e.ALo(5,"async"),e.qZA(),e.YNc(6,Wn,3,4,"ng-container",3),e.ALo(7,"async"),e.qZA(),e.YNc(8,$n,3,0,"ng-template",null,4,e.W1O),e.YNc(10,Gn,4,1,"ng-template",null,5,e.W1O)),2&n){const i=e.MAs(11);let _;e.xp6(4),e.hij(" ",(null==(_=e.lcZ(5,3,t.assets))?null:_.length)||0," result(s) found "),e.xp6(2),e.Q6J("ngIf",!e.lcZ(7,5,t.loading))("ngIfElse",i)}},dependencies:[l.sg,l.O5,T.o,w.Ou,l.Ov],styles:["[_nghost-%COMP%]{width:100%;height:100%}"]});var tn=d(9816),v=d(6325);class ce{}ce.\u0275fac=function(n){return new(n||ce)},ce.\u0275mod=e.oAB({type:ce}),ce.\u0275inj=e.cJS({imports:[l.ez,tn.W9,c.u5,Dt.Kk]}),e.B6R(Vt.v,[l.O5,T.o,v.ZT,oe,ie,_e,re],[]);var De=d(7957),R=d(6709),U=d(8255),Le=d(3848),qe=d(1948),H=d(266),S=d(9549),Jn=d(4693),p=d(8368);const Yn=[{id:"after_hour",name:"After Hour of Day"},{id:"before_hour",name:"Before Hour of Day"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Hours before Meeting"},{id:"within_hours",name:"Within Hours before Meeting"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}];var X=d(4385),D=d(4144);function Qn(o,n){1&o&&(e.TgZ(0,"button",7)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function Bn(o,n){if(1&o&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function jn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",16)(1,"mat-form-field",10)(2,"mat-select",17),e.NdJ("ngModelChange",function(_){const a=e.CHM(t).$implicit;return e.KtG(a[0]=_)}),e.YNc(3,Bn,2,2,"mat-option",18),e.qZA()(),e.TgZ(4,"mat-form-field",10)(5,"input",19),e.NdJ("ngModelChange",function(_){const a=e.CHM(t).$implicit;return e.KtG(a[1]=_)}),e.qZA(),e.TgZ(6,"mat-error"),e._uU(7,"Rule value is required"),e.qZA()(),e.TgZ(8,"button",12),e.NdJ("click",function(){const s=e.CHM(t).index,a=e.oxw().$implicit;return e.KtG(a.rules.splice(s,1))}),e.TgZ(9,"app-icon"),e._uU(10,"delete"),e.qZA()()()}if(2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("ngModel",t[0]),e.xp6(1),e.Q6J("ngForOf",i.rule_types),e.xp6(2),e.Q6J("ngModel",t[1])}}function Hn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"mat-form-field",10)(3,"input",11),e.NdJ("ngModelChange",function(_){const a=e.CHM(t).$implicit;return e.KtG(a.name=_)}),e.qZA(),e.TgZ(4,"mat-error"),e._uU(5,"Ruleset name is required"),e.qZA()(),e.TgZ(6,"button",12),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw();return s.rules.push(["",""]),e.KtG(a.show_rules=s.id)}),e.TgZ(7,"app-icon"),e._uU(8,"add"),e.qZA()(),e.TgZ(9,"button",13),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.show_rules=a.show_rules!==s.id?s.id:"")}),e.TgZ(10,"app-icon"),e._uU(11),e.qZA()(),e.TgZ(12,"button",12),e.NdJ("click",function(){const s=e.CHM(t).index,a=e.oxw();return e.KtG(a.rulesets.splice(s,1))}),e.TgZ(13,"app-icon"),e._uU(14,"delete"),e.qZA()()(),e.TgZ(15,"div",14),e.YNc(16,jn,11,3,"div",15),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw();e.xp6(3),e.Q6J("ngModel",t.name),e.xp6(6),e.Q6J("disabled",!t.rules.length),e.xp6(2),e.Oqu(i.show_rules===t.id?"expand_less":"expand_more"),e.xp6(4),e.Udp("height",(i.show_rules===t.id?5*t.rules.length:0)+"em"),e.xp6(1),e.Q6J("ngForOf",t.rules)}}class de extends p.KG{constructor(n){super(),this._data=n,this.event=new e.vpe,this.loading=!1,this.require_notes=this._data.require_notes,this.rule_types=Yn,this.rulesets=(n.config||[]).map(t=>(t.rules=t.rules.map(i=>[i[0],JSON.stringify(i[1])]),t))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveNotesSetting(n){this.timeout("save-notes",()=>this._data.saveNotes?this._data.saveNotes(n):"",1e3)}saveChanges(){this.loading=!0;const n=this.rulesets.map(t=>({...t,rules:t.rules.map(i=>{let _=i[1];try{_=JSON.parse(i[1])}catch{}return[i[0],_]})}));this.event.emit({reason:"done",metadata:n})}}de.\u0275fac=function(n){return new(n||de)(e.Y36(v.WI))},de.\u0275cmp=e.Xpm({type:de,selectors:[["catering-config-modal"]],outputs:{event:"event"},features:[e.qOj],decls:14,vars:3,consts:[["icon","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center","max-w-lg","px-4","pt-2","pb-4"],[1,"m-2",3,"ngModel","ngModelChange"],["matRipple","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["btn","","matRipple","",1,"mx-auto","w-32",3,"click"],["icon","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["icon","","matRipple","",1,"mb-6",3,"click"],["icon","","matRipple","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex items-center px-2 h-20 space-x-2",4,"ngFor","ngForOf"],[1,"flex","items-center","px-2","h-20","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(n,t){1&n&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Edit Catering Configuration"),e.qZA(),e.YNc(3,Qn,3,0,"button",0),e.qZA(),e.TgZ(4,"main",1)(5,"mat-checkbox",2),e.NdJ("ngModelChange",function(_){return t.saveNotesSetting(_)}),e._uU(6," Require notes for orders "),e.qZA(),e._UZ(7,"br"),e.TgZ(8,"button",3),e.NdJ("click",function(){return t.rulesets.push({id:t.new_id,rules:[]})}),e._uU(9," New Ruleset "),e.qZA(),e.YNc(10,Hn,17,6,"div",4),e.qZA(),e.TgZ(11,"footer",5)(12,"button",6),e.NdJ("click",function(){return t.saveChanges()}),e._uU(13," Save Changes "),e.qZA()()),2&n&&(e.xp6(3),e.Q6J("ngIf",!t.loading),e.xp6(2),e.Q6J("ngModel",t.require_notes),e.xp6(5),e.Q6J("ngForOf",t.rulesets))},dependencies:[l.sg,l.O5,C.ey,v.ZT,R.oG,c.Fj,c.JJ,c.Q7,c.On,T.o,S.KE,S.TO,X.gD,D.Nt],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}"]});var Kt=d(9521),M=d(2962),pe=d(7331),Xn=d(3670);function zn(o,n){1&o&&(e.TgZ(0,"button",6)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function Vn(o,n){if(1&o&&(e.TgZ(0,"div",17)(1,"label",18),e._uU(2," Name"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",19),e._UZ(7,"input",20),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()()),2&o){const t=e.oxw(2);e.xp6(1),e.ekj("error",t.form.controls.name.invalid&&t.form.controls.name.touched)}}function eo(o,n){if(1&o&&(e.TgZ(0,"div",17)(1,"label",21),e._uU(2," Category"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",19),e._UZ(7,"input",22),e.TgZ(8,"mat-error"),e._uU(9,"Category is required"),e.qZA()()()),2&o){const t=e.oxw(2),i=e.MAs(9);e.xp6(1),e.ekj("error",t.form.controls.category.invalid&&t.form.controls.category.touched),e.xp6(6),e.Q6J("matAutocomplete",i)}}function to(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-chip-row",29),e.NdJ("removed",function(){const s=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.removeTag(s))}),e._uU(1),e.TgZ(2,"button",30)(3,"app-icon"),e._uU(4,"cancel"),e.qZA()()()}if(2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t," "),e.xp6(1),e.uIk("aria-label","Remove "+t)}}function no(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",17)(1,"label",23),e.SDv(2,24),e.qZA(),e.TgZ(3,"mat-form-field",19)(4,"mat-chip-grid",25,26),e.YNc(6,to,5,2,"mat-chip-row",27),e.qZA(),e.TgZ(7,"input",28),e.NdJ("matChipInputTokenEnd",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.addTag(_))}),e.qZA()()()}if(2&o){const t=e.MAs(5),i=e.oxw(2);e.xp6(1),e.ekj("error",i.form.controls.tags.invalid&&i.form.controls.tags.touched),e.xp6(5),e.Q6J("ngForOf",i.tag_list),e.xp6(1),e.Q6J("matChipInputFor",t)("matChipInputSeparatorKeyCodes",i.separators)("matChipInputAddOnBlur",!0)}}function oo(o,n){1&o&&(e.TgZ(0,"div",17)(1,"label",31),e._uU(2,"Description:"),e.qZA(),e.TgZ(3,"mat-form-field",19),e._UZ(4,"textarea",32),e.qZA()())}function io(o,n){if(1&o&&(e.TgZ(0,"div",17)(1,"label",18),e._uU(2," Unit Price"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",19),e._UZ(7,"input",33),e.TgZ(8,"mat-error"),e._uU(9,"Unit Price is required"),e.qZA()()()),2&o){const t=e.oxw(2);e.xp6(1),e.ekj("error",t.form.controls.unit_price.invalid&&t.form.controls.unit_price.touched)}}function _o(o,n){1&o&&(e.TgZ(0,"div",17)(1,"label",34),e.SDv(2,35),e.qZA(),e._UZ(3,"image-list-field",36),e.qZA())}const Ke=function(){return{standalone:!0}};function so(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"form",7)(1,"div",8),e.YNc(2,Vn,10,2,"div",9),e.YNc(3,eo,10,3,"div",9),e.qZA(),e.YNc(4,no,8,6,"div",9),e.YNc(5,oo,5,0,"div",9),e.YNc(6,io,10,2,"div",9),e.TgZ(7,"div",10)(8,"label",11),e._uU(9,"Accept Points?"),e.qZA(),e.TgZ(10,"mat-checkbox",12),e._uU(11),e.qZA()(),e.TgZ(12,"div",13)(13,"mat-checkbox",14),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(_?s.addTag({value:"Gluten Free"}):s.removeTag("Gluten Free"))}),e._uU(14," Gluten Free (GF) "),e.qZA(),e.TgZ(15,"mat-checkbox",14),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(_?s.addTag({value:"Vegan"}):s.removeTag("Vegan"))}),e._uU(16," Vegan (VG) "),e.qZA(),e.TgZ(17,"mat-checkbox",14),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(_?s.addTag({value:"Vegetarian"}):s.removeTag("Vegetarian"))}),e._uU(18," Vegetarian (V) "),e.qZA(),e.TgZ(19,"mat-checkbox",14),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(_?s.addTag({value:"Contains Dairy"}):s.removeTag("Contains Dairy"))}),e._uU(20," Contains Dairy (D) "),e.qZA(),e.TgZ(21,"mat-checkbox",14),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(_?s.addTag({value:"Contains Nuts"}):s.removeTag("Contains Nuts"))}),e._uU(22," Contains Nuts (N) "),e.qZA()(),e.TgZ(23,"div",10)(24,"label",15),e._uU(25,"Discount Cap"),e.qZA(),e._UZ(26,"a-counter",16),e.qZA(),e.YNc(27,_o,4,0,"div",9),e.qZA()}if(2&o){const t=e.oxw();let i;e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",t.form.controls.name),e.xp6(1),e.Q6J("ngIf",t.form.controls.category),e.xp6(1),e.Q6J("ngIf",t.form.controls.tags),e.xp6(1),e.Q6J("ngIf",t.form.controls.description),e.xp6(1),e.Q6J("ngIf",t.form.controls.unit_price),e.xp6(5),e.Oqu(null!=(i=t.form.get("accept_points"))&&i.value?"No":"Yes"),e.xp6(2),e.Q6J("ngModel",t.hasTag("Gluten Free"))("ngModelOptions",e.DdM(22,Ke)),e.xp6(2),e.Q6J("ngModel",t.hasTag("Vegan"))("ngModelOptions",e.DdM(23,Ke)),e.xp6(2),e.Q6J("ngModel",t.hasTag("Vegetarian"))("ngModelOptions",e.DdM(24,Ke)),e.xp6(2),e.Q6J("ngModel",t.hasTag("Contains Dairy"))("ngModelOptions",e.DdM(25,Ke)),e.xp6(2),e.Q6J("ngModel",t.hasTag("Contains Nuts"))("ngModelOptions",e.DdM(26,Ke)),e.xp6(5),e.Q6J("min",0)("max",100)("step",5)("render_fn",t.renderPercent),e.xp6(1),e.Q6J("ngIf",t.form.controls.images)}}function ao(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"footer",37)(1,"button",38),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.saveChanges())}),e._uU(2," Save "),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.form.dirty)}}function lo(o,n){1&o&&(e.TgZ(0,"div",39),e._UZ(1,"mat-spinner",40),e.TgZ(2,"p"),e._uU(3,"Saving catering item..."),e.qZA()())}function ro(o,n){if(1&o&&(e.TgZ(0,"mat-option",41),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}class ue{constructor(n){this._data=n,this.event=new e.vpe,this.form=new c.cw({name:new c.NI(this.item.name||"",[c.kI.required]),description:new c.NI(this.item.description||""),category:new c.NI(this.item.category||"",[c.kI.required]),unit_price:new c.NI(this.item.unit_price,[c.kI.required]),tags:new c.NI(this.item.tags||[]),accept_points:new c.NI(this.item.accept_points||!1),discount_cap:new c.NI(this.item.discount_cap||0),images:new c.NI(this.item.images||[])}),this.loading=!1,this.separators=[Kt.K5,Kt.OC,Kt.L_]}get item(){return this._data.item||new M.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(n=0){return`${n}%`}hasTag(n){return this.tag_list.includes(n)}addTag(n){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const t=n.input,i=n.value,_=this.tag_list;(i||"").trim()&&(_.push(i),this.form.controls.tags.setValue(_)),t&&(t.value="")}removeTag(n){if(!this.form||!this.form.controls.tags)return;const t=this.tag_list;this.form.controls.tags.markAsDirty();const i=t.indexOf(n);i>=0&&(t.splice(i,1),this.form.controls.tags.setValue(t))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new M.U({...this.item,id:this.item.id||`item-${(0,p.Iy)(99999999)}`,...this.form.value})}})}}ue.\u0275fac=function(n){return new(n||ue)(e.Y36(v.WI))},ue.\u0275cmp=e.Xpm({type:ue,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let o,n,t;return o=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,n=$localize`:@@zoneTagsPlaceholder␟c133beffffe3288bbdbf8572a32910c33ce14991␟2194594490376201833:Item tags e.g. Gluten Free, Vegan etc.`,t=$localize`:@@imagesLabel␟e5d9e00faa06714d7671b164cad364b26f4c585b␟5137125764814732349:Images:`,[["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],[1,"flex","items-center","space-x-2"],["class","flex flex-col",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],["list","",1,"flex","items-center","flex-wrap","max-w-lg"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],o,["aria-label","Item Tags"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],["name","tags","placeholder",n,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"removed"],["matChipRemove",""],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["for","images"],t,["name","images","formControlName","images"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["btn","","matRipple","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(n,t){if(1&n&&(e.TgZ(0,"header")(1,"h3"),e._uU(2),e.qZA(),e.YNc(3,zn,3,0,"button",0),e.qZA(),e.YNc(4,so,28,27,"form",1),e.YNc(5,ao,3,1,"footer",2),e.YNc(6,lo,4,0,"ng-template",null,3,e.W1O),e.TgZ(8,"mat-autocomplete",null,4),e.YNc(10,ro,2,2,"mat-option",5),e.qZA()),2&n){const i=e.MAs(7);e.xp6(2),e.hij("",t.item.id?"Edit":"Add"," Item"),e.xp6(1),e.Q6J("ngIf",!t.loading),e.xp6(1),e.Q6J("ngIf",t.form&&!t.loading)("ngIfElse",i),e.xp6(1),e.Q6J("ngIf",!t.loading),e.xp6(5),e.Q6J("ngForOf",t.categories)}},dependencies:[l.sg,l.O5,De.XC,C.ey,De.ZL,v.ZT,R.oG,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.On,c.sg,c.u,T.o,S.KE,S.TO,D.Nt,w.Ou,pe.RA,pe.oH,pe.qH,pe.z3,Pe.R,Xn.h],styles:["[list][_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin:.5rem}"]});var m=d(9671),yt=d(2198),Z=d(7224),I=d(2986),A=d(6221),nn=d(3245);function co(o,n){1&o&&(e.TgZ(0,"button",6)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function po(o,n){if(1&o&&(e.TgZ(0,"div",9)(1,"label",10),e._uU(2," Name"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",11),e._UZ(7,"input",12),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()()),2&o){const t=e.oxw(2);e.xp6(1),e.ekj("error",t.form.controls.name.invalid&&t.form.controls.name.touched)}}function uo(o,n){if(1&o&&(e.TgZ(0,"div",9)(1,"label",13),e._uU(2," Type"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA(),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",11),e._UZ(7,"input",14),e.TgZ(8,"mat-error"),e._uU(9,"Type is required"),e.qZA()()()),2&o){const t=e.oxw(2),i=e.MAs(9);e.xp6(1),e.ekj("error",t.form.controls.group.invalid&&t.form.controls.group.touched),e.xp6(6),e.Q6J("matAutocomplete",i)}}function go(o,n){1&o&&(e.TgZ(0,"div",9)(1,"label",10),e._uU(2,"Unit Price:"),e.qZA(),e.TgZ(3,"mat-form-field",11),e._UZ(4,"input",15),e.qZA()())}function mo(o,n){1&o&&(e.TgZ(0,"div",9)(1,"mat-checkbox",16),e._uU(2," Can select multiple of type "),e.qZA()())}function fo(o,n){if(1&o&&(e.TgZ(0,"form",7),e.YNc(1,po,10,2,"div",8),e.YNc(2,uo,10,3,"div",8),e.YNc(3,go,5,0,"div",8),e.YNc(4,mo,3,0,"div",8),e.qZA()),2&o){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.form.controls.name),e.xp6(1),e.Q6J("ngIf",t.form.controls.group),e.xp6(1),e.Q6J("ngIf",t.form.controls.unit_price),e.xp6(1),e.Q6J("ngIf",t.form.controls.multiple)}}function ho(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"footer",17)(1,"button",18),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.saveChanges())}),e._uU(2," Save "),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.form.dirty)}}function Co(o,n){1&o&&(e.TgZ(0,"div",19),e._UZ(1,"mat-spinner",20),e.TgZ(2,"p"),e._uU(3,"Saving catering item option..."),e.qZA()())}function To(o,n){if(1&o&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}class ge{constructor(n){this._data=n,this.event=new e.vpe,this.form=new c.cw({name:new c.NI(this.option.name||"",[c.kI.required]),group:new c.NI(this.option.group||"",[c.kI.required]),unit_price:new c.NI(this.option.unit_price),multiple:new c.NI(!!this.option.multiple,[])}),this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}saveChanges(){this.loading=!0;const n={...this.option,id:this.option.id||`option-${(0,nn.Iy)(99999999)}`,...this.form.value};this.event.emit({reason:"done",metadata:{item:new M.U({...this._data.parent,options:this._data.parent.options.filter(t=>t.id!==n.id).concat([n])})}})}}ge.\u0275fac=function(n){return new(n||ge)(e.Y36(v.WI))},ge.\u0275cmp=e.Xpm({type:ge,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["icon","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto max-h-[65vh]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["icon","","mat-dialog-close",""],[1,"p-4","overflow-auto","max-h-[65vh]",3,"formGroup"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["btn","","matRipple","",3,"disabled","click"],["loading","",1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(n,t){if(1&n&&(e.TgZ(0,"header")(1,"h3"),e._uU(2),e.qZA(),e.YNc(3,co,3,0,"button",0),e.qZA(),e.YNc(4,fo,5,5,"form",1),e.YNc(5,ho,3,1,"footer",2),e.YNc(6,Co,4,0,"ng-template",null,3,e.W1O),e.TgZ(8,"mat-autocomplete",null,4),e.YNc(10,To,2,2,"mat-option",5),e.qZA()),2&n){const i=e.MAs(7);e.xp6(2),e.hij("",t.option.id?"Edit":"Add"," Item Option"),e.xp6(1),e.Q6J("ngIf",!t.loading),e.xp6(1),e.Q6J("ngIf",t.form&&!t.loading)("ngIfElse",i),e.xp6(1),e.Q6J("ngIf",!t.loading),e.xp6(5),e.Q6J("ngForOf",t.types)}},dependencies:[l.sg,l.O5,De.XC,C.ey,De.ZL,v.ZT,R.oG,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,T.o,S.KE,S.TO,D.Nt,w.Ou]});var $=d(5163),on=d(4960),xo=d(9358),vo=d(833),Oo=d(1998);function _n(o,n){(0,vo.Z)(2,arguments);var t=(0,Oo.Z)(n);return(0,xo.Z)(o,-t)}var sn=d(1390),me=d(3413),an=d(95);const Wt={};function ln(o,n,t){let i=!0;for(const _ of n)if(o.category===_.name||o.tags.includes(_.name)||t.resources.find(s=>s.zones.includes(_.name))||t.space?.zones.includes(_.name)||"*"===_.name){let s=0;for(const a of _.rules){const r=new Date(t.date);switch(a[0]){case"is_before":s+=(0,on.Z)(Date.now(),_n(r,a[1]))?1:0;break;case"within_hours":s+=(0,sn.Z)(Date.now(),_n(r,a[1]))?1:0;break;case"after_hour":s+=(0,sn.Z)(r,(0,me.Z)(r,a[1]))?1:0;break;case"before_hour":s+=(0,on.Z)(r,(0,me.Z)(r,a[1]))?1:0;break;case"min_length":s+=t.duration>=(0,an.H1)(a[1])?1:0;break;case"max_length":s+=t.duration<=(0,an.H1)(a[1])?1:0;break;case"visitor_type":s+=t.ext("visitor_type")===a[1]?1:0;break;default:s+=1}}i=s>=_.rules.length}return i}function So(o,n){1&o&&(e.TgZ(0,"div",17),e._uU(1," Options Available "),e.qZA())}function Ao(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"a-counter",18),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw(5);return e.KtG(a.updateItemQuantity(s,_))}),e.qZA()}if(2&o){const t=e.oxw().$implicit;e.Q6J("ngModel",t.quantity)}}function bo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",19)(1,"div",20)(2,"button",21)(3,"app-icon"),e._uU(4,"remove"),e.qZA()()(),e.TgZ(5,"div",22),e._uU(6),e.qZA(),e.TgZ(7,"button",23),e.NdJ("click",function(){e.CHM(t);const _=e.oxw().$implicit,s=e.oxw(5);return e.KtG(s.addItem(_))}),e.TgZ(8,"app-icon"),e._uU(9,"add"),e.qZA()()()}if(2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("matTooltip",t.quantity?"Items with options must be removed from order confirmation page":""),e.xp6(1),e.Q6J("disabled",!0),e.xp6(4),e.hij(" ",t.quantity," ")}}function Fo(o,n){if(1&o&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div",12),e._uU(3),e.qZA(),e.YNc(4,So,2,0,"div",13),e.qZA(),e.TgZ(5,"div",14),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.YNc(8,Ao,1,1,"a-counter",15),e.YNc(9,bo,10,3,"div",16),e.qZA()),2&o){const t=n.$implicit,i=e.oxw(5);e.xp6(3),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.options.length),e.xp6(2),e.hij(" ",e.xi3(7,5,t.unit_price/100,i.code)," "),e.xp6(2),e.Q6J("ngIf",!t.options.length),e.xp6(1),e.Q6J("ngIf",t.options.length)}}const rn=function(){return{}};function No(o,n){if(1&o&&(e.TgZ(0,"mat-tab",8)(1,"div",9),e.YNc(2,Fo,10,8,"div",10),e.qZA()()),2&o){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("label",t),e.xp6(2),e.Q6J("ngForOf",(i.menu_items||e.DdM(2,rn))[t])}}function wo(o,n){if(1&o&&(e.ynx(0),e.YNc(1,No,3,3,"mat-tab",7),e.BQk()),2&o){const t=n.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",(i.menu_items||e.DdM(1,rn))[t].length)}}function Mo(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-tab-group"),e.YNc(2,wo,2,2,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.categories)}}function Zo(o,n){if(1&o&&(e.TgZ(0,"div",4),e.YNc(1,Mo,3,1,"ng-container",5),e.qZA()),2&o){const t=e.oxw(),i=e.MAs(5);e.xp6(1),e.Q6J("ngIf",!t.show_order_details)("ngIfElse",i)}}function Ro(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",26),e._uU(2," Cancel "),e.qZA(),e.TgZ(3,"button",27),e.NdJ("click",function(){e.CHM(t);const _=e.oxw(2);return e.KtG(_.show_order_details=!0)}),e._uU(4," Confirm "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("disabled",!t.order.item_count)("matBadge",t.order.item_count)("matBadgeHidden",!t.order.item_count)}}function yo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const _=e.oxw(2);return e.KtG(_.show_order_details=!1)}),e._uU(1," Back "),e.qZA(),e.TgZ(2,"button",29),e.NdJ("click",function(){e.CHM(t);const _=e.oxw(2);return e.KtG(_.saveOrder())}),e._uU(3," Save Order "),e.qZA()}}function Io(o,n){if(1&o&&(e.TgZ(0,"footer",24),e.YNc(1,Ro,5,3,"ng-container",5),e.YNc(2,yo,4,0,"ng-template",null,25,e.W1O),e.qZA()),2&o){const t=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf",!i.show_order_details)("ngIfElse",t)}}function ko(o,n){if(1&o&&(e.TgZ(0,"div",30),e._UZ(1,"mat-spinner",31),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.Oqu(t.loading)}}function Po(o,n){if(1&o&&(e.TgZ(0,"div",37),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("matTooltip",i.optionsFor(t)),e.xp6(1),e.AsE(" ",t.options.length," option",1===t.options.length?"":"s"," selected ")}}function Uo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",34)(1,"div",12)(2,"div",12),e._uU(3),e.qZA(),e.YNc(4,Po,2,3,"div",35),e.qZA(),e.TgZ(5,"div",14),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"a-counter",36),e.NdJ("ngModelChange",function(_){const a=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.updateItemQuantity(a,_))}),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(3),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.options.length),e.xp6(2),e.hij(" ",e.xi3(7,4,t.total_cost/100,i.code)," "),e.xp6(2),e.Q6J("ngModel",t.quantity)}}function Do(o,n){if(1&o&&(e.TgZ(0,"header",32)(1,"h3"),e._uU(2,"Confirm Order"),e.qZA()(),e.TgZ(3,"div",9),e.YNc(4,Uo,9,7,"div",33),e.qZA()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.order.items)}}class fe extends p.KG{constructor(n,t){super(),this._org=n,this._data=t,this.event=new e.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}get code(){return this._org.currency_code}ngOnInit(){var n=this;return(0,m.Z)(function*(){n.loading="Loading menu...",n.order=new $.G(n._data.order),n.rules=yield n._data.getCateringConfig(n.order.event?.space?.level?.parent_id),n._data.menu.subscribe(t=>{n.loading="Loading menu...";const i=(0,p.Tw)(t.map(s=>s.category)),_={};for(const s of i)_[s]=t.filter(a=>a.category===s&&ln(a,n.rules,n.order.event));n.categories=i,n.menu_items=_,n.updateMenuQuantities(),n.timeout("clear_loading",()=>n.loading="",1e3)})})()}addItem(n,t=!0){const i=this.order.items.find(_=>_.id===n.id&&_.options.length===_.options.reduce((s,a)=>s+(n.options.find(r=>a.id===r.id)?1:0),0));t&&n.options?.length?this._data.selectOptions(n.options).then(_=>{const s=new M.U({...n,options:_});this.addItem(s,!1)}):this.order=new $.G(i?{...this.order,items:this.order.items.filter(_=>!(_.id===n.id&&_.options_string===n.options_string)).concat([new M.U({...n,quantity:i.quantity+1})])}:{...this.order,items:this.order.items.concat([new M.U({...n,quantity:1})])}),this.updateMenuQuantities()}removeItem(n){this.order=new $.G({...this.order,items:this.order.items.filter(t=>t.id!==n.id&&t.options_string===n.options_string)}),this.updateMenuQuantities()}updateItemQuantity(n,t){const i=this.order.items.find(s=>s.id===n.id&&s.options_string===n.options_string);let _=[...this.order.items];_=i?this.order.items.filter(s=>!(s.id===n.id&&s.options_string===n.options_string)).concat([new M.U({...n,quantity:t})]):this.order.items.concat([new M.U({...n,quantity:t})]),_.sort((s,a)=>s.name.localeCompare(a.name)),this.order=new $.G({...this.order,items:_}),this.updateMenuQuantities()}updateMenuQuantities(){for(const n in this.menu_items)for(const t of this.menu_items[n])t.quantity=this.order.items.reduce((i,_)=>_.id===t.id?i+_.quantity:i,0)}optionsFor(n){return n.options.map(t=>t.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}function Lo(o,n){if(1&o&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" +",e.xi3(2,1,t.unit_price/100,i.code)," ")}}function qo(o,n){if(1&o&&(e.TgZ(0,"mat-radio-button",14)(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,Lo,3,4,"div",17),e.qZA()()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(3),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.unit_price)}}function Ko(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-radio-group",10),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw();return e.KtG(a.updateGroupOption(s,_))}),e.TgZ(2,"mat-radio-button",11)(3,"span",12),e._uU(4,"None"),e.qZA()(),e.YNc(5,qo,5,3,"mat-radio-button",13),e.qZA(),e.BQk()}if(2&o){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",null==t?null:t.options)}}function Wo(o,n){if(1&o&&(e.TgZ(0,"div",18),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" +",e.xi3(2,1,t.unit_price/100,i.code)," ")}}function $o(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-checkbox",20),e.NdJ("ngModelChange",function(_){const a=e.CHM(t).$implicit,r=e.oxw(3);return e.KtG(r.option_state[a.id]=_)}),e.TgZ(1,"div",15)(2,"div",16),e._uU(3),e.qZA(),e.YNc(4,Wo,3,4,"div",17),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw(3);e.Q6J("ngModel",i.option_state[t.id]),e.xp6(3),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.unit_price)}}function Go(o,n){if(1&o&&e.YNc(0,$o,5,3,"mat-checkbox",19),2&o){const t=e.oxw().$implicit;e.Q6J("ngForOf",null==t?null:t.options)}}function Jo(o,n){if(1&o&&(e.TgZ(0,"div",5)(1,"div",6),e._uU(2),e.qZA(),e.TgZ(3,"div",7),e.YNc(4,Ko,6,1,"ng-container",8),e.YNc(5,Go,1,1,"ng-template",null,9,e.W1O),e.qZA()()),2&o){const t=n.$implicit,i=e.MAs(6);e.uIk("group",t.name),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Q6J("ngIf",!t.multiple)("ngIfElse",i)}}fe.\u0275fac=function(n){return new(n||fe)(e.Y36(A.w7),e.Y36(v.WI))},fe.\u0275cmp=e.Xpm({type:fe,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[e.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["icon","","matRipple","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["icon","","matRipple","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["btn","","matRipple","","mat-dialog-close","",1,"inverse"],["confirm","","btn","","matRipple","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["matRipple","",1,"inverse",3,"click"],["save","","btn","","matRipple","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(n,t){if(1&n&&(e.YNc(0,Zo,2,2,"div",0),e.YNc(1,Io,4,2,"footer",1),e.YNc(2,ko,4,1,"ng-template",null,2,e.W1O),e.YNc(4,Do,5,1,"ng-template",null,3,e.W1O)),2&n){const i=e.MAs(3);e.Q6J("ngIf",!t.loading)("ngIfElse",i),e.xp6(1),e.Q6J("ngIf",!t.loading)}},dependencies:[l.sg,l.O5,Le.uX,Le.SP,v.ZT,H.gM,c.Fj,c.JJ,c.On,T.o,w.Ou,Pe.R,l.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em}input[_ngcontent-%COMP%]:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}input.error[_ngcontent-%COMP%]::placeholder{color:rgba(var(--error),.45)}"]});class he{constructor(n){this._data=n,this.event=new e.vpe,this.option_state={},this.code=this._data.code;const t=(0,nn.Tw)(this._data.options.map(_=>_.group||"Other")),i=[];for(const _ of t){const s=this._data.options.filter(a=>a.group===_);i.push({name:_,multiple:!!s.find(a=>a.multiple),options:s})}this.groups=i}updateGroupOption(n,t){for(const i of n.options)this.option_state[i.id]=i.id===t}saveOptions(){const n=this._data.options.filter(t=>this.option_state[t.id]);this.event.emit({reason:"done",metadata:{options:n}})}}function Yo(o,n){1&o&&(e.TgZ(0,"button",4)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function Qo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"main")(1,"div",5)(2,"app-icon",6),e._uU(3,"upload"),e.qZA(),e.TgZ(4,"p"),e._uU(5,"Click to select file or Drag and drop files"),e.qZA(),e.TgZ(6,"input",7),e.NdJ("change",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.handleFileEvent(_))}),e.qZA()(),e.TgZ(7,"div",8)(8,"button",9),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.downloadTemplate())}),e._uU(9," Download Template "),e.qZA()()()}}function Bo(o,n){if(1&o&&(e.TgZ(0,"main",10),e._UZ(1,"mat-spinner",11),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.Oqu(t.loading)}}he.\u0275fac=function(n){return new(n||he)(e.Y36(v.WI))},he.\u0275cmp=e.Xpm({type:he,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["icon","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(n,t){1&n&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Select options"),e.qZA(),e.TgZ(3,"button",0)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.TgZ(6,"main",1),e.YNc(7,Jo,7,4,"div",2),e.qZA(),e.TgZ(8,"footer",3)(9,"button",4),e.NdJ("click",function(){return t.saveOptions()}),e._uU(10," Save "),e.qZA()()),2&n&&(e.xp6(7),e.Q6J("ngForOf",t.groups))},dependencies:[l.sg,l.O5,v.ZT,R.oG,qe.VQ,qe.U0,c.JJ,c.On,T.o,l.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}"]});class Ce{constructor(){this.event=new e.vpe}handleFileEvent(n){this.loading="Processing menu data...";const t=n.target;if(!t?.files)return this.loading="";const i=t.files;if(!i.length)return this.loading="";const _=i[0],s=new FileReader;s.addEventListener("loadend",a=>{const u=(0,p.n5)(a.target.result);this.loading="",this.event.emit({reason:"done",metadata:u.filter(g=>"item"===(g.type||"").toLowerCase()).map(g=>new M.U({...g,options:u.filter(h=>"option"===(h.type||"").toLowerCase()&&h.tags===g.id).map(h=>({id:h.id,name:h.name,group:h.category,multiple:h.multiple,unit_price:h.unit_price}))}))})}),s.readAsText(_)}downloadTemplate(){(0,p.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}Ce.\u0275fac=function(n){return new(n||Ce)},Ce.\u0275cmp=e.Xpm({type:Ce,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["icon","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["icon","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["matRipple","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(n,t){if(1&n&&(e.TgZ(0,"header",0)(1,"h2"),e._uU(2,"Import Catering Menu"),e.qZA(),e.YNc(3,Yo,3,0,"button",1),e.qZA(),e.YNc(4,Qo,10,0,"main",2),e.YNc(5,Bo,4,1,"ng-template",null,3,e.W1O)),2&n){const i=e.MAs(6);e.xp6(3),e.Q6J("ngIf",!t.loading),e.xp6(1),e.Q6J("ngIf",!t.loading)("ngIfElse",i)}},dependencies:[l.O5,v.ZT,T.o,w.Ou]});class K extends p.KG{constructor(n,t,i){var _;super(),_=this,this._org=n,this._dialog=t,this._settings=i,this._updated=new N.X(0),this._menu=new N.X([]),this._loading=new N.X(!1),this._currency=new N.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.settings=this._org.active_building.pipe((0,yt.h)(s=>!!s),(0,j.w)(s=>(0,L.rlq)(s.id,"catering-settings").pipe((0,Ue.K)(a=>(0,se.of)({})))),(0,F.U)(s=>s.details||{}),(0,ae.b)(s=>this._settings.post("require_catering_notes",!!s?.require_notes)),(0,W.d)(1)),this.charge_codes=this.settings.pipe((0,F.U)(s=>s.charge_codes||[])),this.availability=this.settings.pipe((0,F.U)(s=>s.disabled_rooms||[])),this.zone="",this.subscription("building",this._org.active_building.subscribe(function(){var s=(0,m.Z)(function*(a){if(a){const r=(yield _.getCateringForZone(a.id)).map(u=>new M.U(u));_._currency.next(_._settings.get("app.currency")||a.currency||"USD"),_._menu.next(r)}});return function(a){return s.apply(this,arguments)}}()))}get is_editable(){return!this.zone||this.zone===this._org.building?.id}get categories(){const n=this._menu.getValue();return(0,p.Tw)(n.map(t=>t.category))}manageCateringOrder(n){var t=this;return(0,m.Z)(function*(){const i=t._dialog.open(fe,{data:{code:t._currency.getValue(),order:n,menu:t.menu,loading:t.loading,getCateringConfig:s=>t.getCateringConfig(s),selectOptions:s=>t.selectOptions(s)}}),_=yield Promise.race([i.componentInstance.event.pipe((0,Z.P)(s=>"done"===s.reason)).toPromise(),i.afterClosed().toPromise()]);return i.close(),_?.metadata?.order||n})()}addItem(n=new M.U){var t=this;return(0,m.Z)(function*(){const i=t._dialog.open(ue,{data:{item:n,categories:t.categories}}),_=yield Promise.race([i.componentInstance.event.pipe((0,Z.P)(r=>"done"===r.reason)).toPromise(),i.afterClosed().toPromise()]);if("done"!==_?.reason)return;const s=t._menu.getValue(),a=s.findIndex(r=>r.id===n.id);a>=0?s.splice(a,1,_.metadata.item):s.push(_.metadata.item),t.updateMenu(t._org.building.id,s).then(()=>{t._menu.next([...s]),i.close()},()=>i.componentInstance.loading=!1)})()}updateItem(n){const t=this._menu.getValue(),i=t.findIndex(_=>_.id===n.id);i>=0?t.splice(i,1,n):t.push(n),this.updateMenu(this._org.building.id,t).then(()=>this._menu.next([...t]))}addOption(n,t={}){var i=this;return(0,m.Z)(function*(){const _=(0,p.Tw)(n.options.map(g=>g.group)),s=i._dialog.open(ge,{data:{parent:n,option:t,types:_}}),a=yield Promise.race([s.componentInstance.event.pipe((0,Z.P)(g=>"done"===g.reason)).toPromise(),s.afterClosed().toPromise()]);if("done"!==a?.reason)return;const r=i._menu.getValue(),u=r.findIndex(g=>g.id===n.id);u>=0?r.splice(u,1,a.metadata.item):r.push(a.metadata.item),i.updateMenu(i._org.building.id,r).then(()=>{i._menu.next([...r]),s.close()},()=>s.componentInstance.loading=!1)})()}selectOptions(n){var t=this;return(0,m.Z)(function*(){const i=t._dialog.open(he,{data:{code:t._currency.getValue(),options:n}}),_=yield Promise.race([i.componentInstance.event.pipe((0,Z.P)(s=>"done"===s.reason)).toPromise(),i.afterClosed().toPromise()]);return"done"!==_?.reason?[]:(i.close(),_.metadata.options)})()}deleteItem(n){var t=this;return(0,m.Z)(function*(){const i=yield(0,p._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${n.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},t._dialog);if("done"!==i.reason)return;i.loading("Removing catering item...");const _=t._menu.getValue().filter(s=>n.id!==s.id);t.updateMenu(t._org.building.id,_).then(()=>{t._menu.next([..._]),i.close()},()=>i.loading(""))})()}deleteOption(n,t){var i=this;return(0,m.Z)(function*(){const _=yield(0,p._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${t.name}" from "${n.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},i._dialog);if("done"!==_.reason)return;_.loading("Removing catering item option...");const s=i._menu.getValue();s.splice(s.findIndex(a=>a.id===n.id),1,new M.U({...n,options:n.options.filter(a=>a.id!==t.id)})),i.updateMenu(i._org.building.id,s).then(()=>{i._menu.next([...s]),_.close()},()=>_.loading(""))})()}editConfig(){var n=this;return(0,m.Z)(function*(){const t=yield n.getCateringConfig(n._org.building.id),{require_notes:i}=yield n.settings.pipe((0,I.q)(1)).toPromise(),_=n._menu.getValue(),s=(0,p.Tw)((0,p.xH)(_.map(u=>[u.category,...u.tags]))),a=n._dialog.open(de,{data:{config:t,types:s,require_notes:i,saveNotes:u=>n.saveSettings({require_notes:u})}}),r=yield Promise.race([a.componentInstance.event.pipe((0,Z.P)(u=>"done"===u.reason)).toPromise(),a.afterClosed().toPromise()]);"done"===r?.reason&&n.updateConfig(n._org.building.id,r.metadata).then(()=>a.close(),()=>a.componentInstance.loading=!1)})()}importMenu(){var n=this;return(0,m.Z)(function*(){const t=n._dialog.open(Ce),i=yield Promise.race([t.componentInstance.event.pipe((0,Z.P)(r=>"done"===r.reason)).toPromise(),t.afterClosed().toPromise()]);if("done"!==i?.reason)return;t.componentInstance.loading="Updating menu...";const _=n._menu.getValue(),s=n._org.building,a=(0,p.Tw)(i.metadata.concat(_),"id");yield n.updateMenu(s.id,a).catch(r=>{throw(0,p.cB)("Error importing catering menu"),t.close(),r}),(0,p.t5)(`Successfully imported catering menu. ${i.metadata.length} item(s) added.`),t.close()})()}updateMenu(n,t){return(0,L.Ymr)(n,{id:n,name:"catering",details:t,description:`Catering menu for ${n}`}).toPromise()}saveSettings(n){var t=this;return(0,m.Z)(function*(){const i=yield t.settings.pipe((0,I.q)(1)).toPromise();return(0,L.Ymr)(t._org.building.id,{id:t._org.building.id,name:"catering-settings",details:{...i,...n},description:`Catering settings for ${t._org.building.id}`}).toPromise()})()}getCateringForZone(n){return(0,m.Z)(function*(){const t=(yield(0,L.rlq)(n,"catering").toPromise()).details;return t instanceof Array?t:[]})()}getCateringConfig(n=this._org.building.id){return(0,m.Z)(function*(){const t=(yield(0,L.rlq)(n,"catering_config").toPromise()).details;return t instanceof Array?t:[]})()}updateConfig(n,t){return(0,L.Ymr)(n,{id:n,name:"catering_config",details:t,description:`Catering menu config for ${n}`}).toPromise()}addItemToOrder(n,t){let i=n.items;const _=i.find(a=>a.id===t.id&&t.options?.length===a.options?.reduce((r,u)=>r+(t.options.find(g=>u.id===g.id)?1:0),0));return _?_.quantity+=1:i=i.concat([new M.U({...t,quantity:1})]),new $.G({...n,items:i,event:null})}}function Ho(o,n){if(1&o&&(e.TgZ(0,"button",14)(1,"app-icon"),e._uU(2,"more_vert"),e.qZA()()),2&o){e.oxw(2);const t=e.MAs(4);e.Q6J("matMenuTriggerFor",t)}}function Xo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"mat-checkbox",7),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.is_enabled=_)}),e.qZA(),e.TgZ(2,"div",8)(3,"div",9)(4,"div"),e._uU(5),e.qZA(),e.TgZ(6,"div",10),e._uU(7),e.qZA()(),e.TgZ(8,"div",11),e._uU(9),e.ALo(10,"currency"),e.ALo(11,"async"),e.qZA()(),e.YNc(12,Ho,3,1,"button",12),e.TgZ(13,"button",13),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.show_options=!_.show_options)}),e.TgZ(14,"app-icon"),e._uU(15,"expand_more"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.is_enabled),e.xp6(4),e.Oqu(t.item.name),e.xp6(2),e.hij(" ",t.item.category," "),e.xp6(2),e.hij(" ",e.xi3(10,6,t.item.unit_price/100,e.lcZ(11,9,t.symbol))," "),e.xp6(3),e.Q6J("ngIf",t.can_edit),e.xp6(1),e.Q6J("disabled",!t.item.options.length)}}function zo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(t);const _=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.editOption(_))}),e.TgZ(1,"app-icon"),e._uU(2,"edit"),e.qZA()()}}function Vo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const _=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.removeOption(_))}),e.TgZ(1,"app-icon"),e._uU(2,"delete"),e.qZA()()}}function ei(o,n){if(1&o&&(e.TgZ(0,"div",17),e._UZ(1,"div",18),e.TgZ(2,"div",19)(3,"div",20),e._uU(4),e.qZA(),e.TgZ(5,"div",10),e._uU(6),e.qZA()(),e.YNc(7,zo,3,0,"button",21),e.YNc(8,Vo,3,0,"button",22),e.qZA()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(4),e.Oqu(t.name),e.xp6(2),e.hij(" ",t.group," "),e.xp6(1),e.Q6J("ngIf",i.can_edit),e.xp6(1),e.Q6J("ngIf",i.can_edit)}}function ti(o,n){if(1&o&&(e.TgZ(0,"div",15),e.YNc(1,ei,9,4,"div",16),e.qZA()),2&o){const t=e.oxw();e.Udp("height",t.show_options?3.5*t.item.options.length+"rem":"0"),e.xp6(1),e.Q6J("ngForOf",t.item.options)}}K.\u0275fac=function(n){return new(n||K)(e.LFG(A.w7),e.LFG(v.uw),e.LFG(p.gb))},K.\u0275prov=e.Yz7({token:K,factory:K.\u0275fac,providedIn:"root"});class Te{constructor(n){this._catering=n,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=t=>this._catering.addOption(this.item,t),this.removeOption=t=>this._catering.deleteOption(this.item,t),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}get can_edit(){return this._catering.is_editable}get is_enabled(){return!this.item.hide_for_zones.includes(this._catering.zone)}set is_enabled(n){let t=this.item.hide_for_zones;t=n?t.filter(i=>i!==this._catering.zone):(0,p.Tw)([...t,this._catering.zone]),this._catering.updateItem(new M.U({...this.item,hide_for_zones:t}))}get symbol(){return this._catering.currency}}function ni(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"div",6),e.BQk()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("item",t)}}function oi(o,n){if(1&o&&(e.ynx(0),e.YNc(1,ni,2,1,"ng-container",5),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.menu))}}function ii(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"div",6),e.BQk()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("item",t)}}function _i(o,n){if(1&o&&(e.TgZ(0,"mat-tab",7),e.YNc(1,ii,2,1,"ng-container",5),e.ALo(2,"async"),e.qZA()),2&o){const t=n.$implicit,i=e.oxw();e.Q6J("label",t),e.uIk("label",t),e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,3,i.tab_menu)[t])}}function si(o,n){1&o&&(e.TgZ(0,"div",8)(1,"app-icon"),e._uU(2,"close"),e.qZA(),e.TgZ(3,"p"),e._uU(4,"No items in menu"),e.qZA()())}Te.\u0275fac=function(n){return new(n||Te)(e.Y36(K))},Te.\u0275cmp=e.Xpm({type:Te,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:["catering-menu-item",""],decls:20,vars:2,consts:[[1,"w-full","h-full","bg-white","dark:bg-neutral-700","border","border-gray-300","dark:border-neutral-500","overflow-hidden","rounded"],["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-gray-100 dark:bg-neutral-700 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],["matTooltip","Allow Ordering Item",1,"mr-2",3,"ngModel","ngModelChange"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","opacity-60"],[1,"p-2","m-2","text-xs","font-bold","text-white","rounded","bg-primary"],["icon","","matRipple","",3,"matMenuTriggerFor",4,"ngIf"],["icon","","matRipple","",3,"disabled","click"],["icon","","matRipple","",3,"matMenuTriggerFor"],["options","",1,"bg-gray-100","dark:bg-neutral-700","overflow-hidden"],["class","flex p-2 items-center border-t border-solid border-gray-300 dark:border-neutral-500 relative",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-t","border-solid","border-gray-300","dark:border-neutral-500","relative"],[1,"absolute","inset-y-0","left-0","w-2","bg-gray-400","dark:bg-neutral-600"],[1,"flex-1","pl-4","pr-2"],[1,"text"],["edit","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["remove","","icon","","matRipple","","class","mx-2",3,"click",4,"ngIf"],["edit","","icon","","matRipple","",1,"mx-2",3,"click"],["remove","","icon","","matRipple","",1,"mx-2",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,Xo,16,11,"div",1),e.YNc(2,ti,2,3,"div",2),e.TgZ(3,"mat-menu",null,3)(5,"button",4),e.NdJ("click",function(){return t.addOption()}),e.TgZ(6,"app-icon"),e._uU(7,"add"),e.qZA(),e.TgZ(8,"div",5),e._uU(9,"Add Option"),e.qZA()(),e.TgZ(10,"button",4),e.NdJ("click",function(){return t.editItem()}),e.TgZ(11,"app-icon"),e._uU(12,"edit"),e.qZA(),e.TgZ(13,"div",5),e._uU(14,"Edit Item"),e.qZA()(),e.TgZ(15,"button",4),e.NdJ("click",function(){return t.removeItem()}),e.TgZ(16,"app-icon"),e._uU(17,"delete"),e.qZA(),e.TgZ(18,"div",5),e._uU(19,"Remove Item"),e.qZA()()()()),2&n&&(e.xp6(1),e.Q6J("ngIf",t.item),e.xp6(1),e.Q6J("ngIf",t.item))},dependencies:[l.sg,l.O5,U.VK,U.OP,U.p6,R.oG,H.gM,c.JJ,c.On,T.o,l.Ov,l.H9],styles:["[_nghost-%COMP%]{overflow:hidden;width:48rem;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}"]});class We{constructor(n){this._catering=n,this.menu=this._catering.menu,this.shown_tab=new N.X(""),this.tab_menu=this.menu.pipe((0,F.U)(t=>{const i={};for(const _ of this.categories)i[_]=t.filter(s=>s.category===_);return i}))}get categories(){return this._catering.categories}}function li(o,n){if(1&o&&(e.TgZ(0,"div",10),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function ri(o,n){if(1&o&&(e.ynx(0),e.YNc(1,li,2,1,"div",9),e.BQk()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t)}}function ci(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e._UZ(2,"div",2),e.qZA(),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.active=!_.active)}),e.TgZ(5,"app-icon"),e._uU(6),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6),e._uU(9),e.qZA(),e.TgZ(10,"div",7),e.YNc(11,ri,2,1,"ng-container",8),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(4),e.ekj("bg-success",t.active)("text-white",t.active)("border-solid",t.active),e.xp6(2),e.Oqu(t.active?"done":"local_pizza"),e.xp6(3),e.Oqu(null==t.item?null:t.item.name),e.xp6(2),e.Q6J("ngForOf",t.item.option_list)}}We.\u0275fac=function(n){return new(n||We)(e.Y36(K))},We.\u0275cmp=e.Xpm({type:We,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(n,t){if(1&n&&(e.TgZ(0,"mat-tab-group",0),e.NdJ("selectedIndexChange",function(_){return t.shown_tab.next(0===_?"":t.categories[_-1])}),e.TgZ(1,"mat-tab",1),e.YNc(2,oi,3,3,"ng-container",2),e.ALo(3,"async"),e.qZA(),e.YNc(4,_i,3,5,"mat-tab",3),e.qZA(),e.YNc(5,si,5,0,"ng-template",null,4,e.W1O)),2&n){const i=e.MAs(6);let _;e.xp6(2),e.Q6J("ngIf",null==(_=e.lcZ(3,3,t.menu))?null:_.length)("ngIfElse",i),e.xp6(2),e.Q6J("ngForOf",t.categories)}},dependencies:[l.sg,l.O5,Le.uX,Le.SP,T.o,Te,l.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}"]});class xe{constructor(){this.active=!1}}xe.\u0275fac=function(n){return new(n||xe)},xe.\u0275cmp=e.Xpm({type:xe,selectors:[["","catering-order-item",""]],inputs:{item:"item"},attrs:["catering-order-item",""],decls:1,vars:1,consts:[[4,"ngIf"],[1,"w-20","text-right","h-14","relative"],[1,"border-b-2","border-l-2","border-gray-400","dark:border-neutral-500","w-4","h-16","absolute","top-1/2","left-1/2","-translate-y-full"],[1,"w-12","mr-4"],["action","","icon","","matRipple","",1,"border","border-gray-300","dark:border-neutral-500","border-dashed","text-xl","text-dark-fade","p-2",3,"click"],[1,"flex","flex-1","border-b","border-gray-300","dark:border-neutral-500","border-solid","py-4"],[1,"flex-1"],[1,"flex","space-x-2","mr-2"],[4,"ngFor","ngForOf"],["class","text-xs py-1 px-2 bg-yellow-300 text-black rounded-2xl shadow",4,"ngIf"],[1,"text-xs","py-1","px-2","bg-yellow-300","text-black","rounded-2xl","shadow"]],template:function(n,t){1&n&&e.YNc(0,ci,12,9,"ng-container",0),2&n&&e.Q6J("ngIf",t.item)},dependencies:[l.sg,l.O5,T.o],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}"]});var cn=d(4211),di=d(3902);class z extends p.KG{constructor(){super(),this._poll=new N.X(0),this._loading=new N.X(!1),this._filters=new N.X({}),this.orders=(0,q.aj)([this._filters,this._poll]).pipe((0,Lt.b)(500),(0,j.w)(([{date:n,zones:t}])=>{this._loading.next(!0);const i=(0,P.Z)((0,qt.Z)(n||Date.now())),_=(0,P.Z)((0,Rt.Z)(n||Date.now()));return(0,cn.u$)({zone_ids:(t||[]).join(","),period_start:i,period_end:_})}),(0,F.U)(n=>(0,p.xH)(n.map(t=>t.ext("catering")))),(0,ae.b)(()=>this._loading.next(!1)),(0,W.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,F.U)(n=>n.filter(t=>function pi(o,n){const t=(n.search||"").toLowerCase();return!!o.items.find(i=>i.name.toLowerCase().includes(t)||!!i.options.find(_=>_.name.toLowerCase().includes(t)))}(t,this._filters.getValue())))),this.subscription("changes",this.orders.subscribe())}get filters(){return this._filters.getValue()}set filters(n){this._filters.next(n)}startPolling(n=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),n)}stopPolling(){this.clearInterval("polling")}updateStatus(n,t){const i=new $.G({...n,status:t}),_=new di.y({...n.event,catering:[...n.event.ext("catering").filter(s=>s.id!==n.id),i].map(s=>new $.G({...s}))});return(0,cn.ry)(_)}}z.\u0275fac=function(n){return new(n||z)},z.\u0275prov=e.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"});const ui=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}];function gi(o,n){if(1&o&&(e.TgZ(0,"button",19),e._uU(1," View "),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("matTooltip",t.order.notes)}}function mi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"app-icon"),e._uU(4,"room_service"),e.qZA()()(),e.TgZ(5,"div",7),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"div",8),e._uU(9),e.qZA(),e.TgZ(10,"div",9),e._uU(11),e.qZA(),e.TgZ(12,"div",10),e._uU(13),e.qZA(),e.TgZ(14,"div",11),e.YNc(15,gi,2,1,"button",12),e.qZA(),e.TgZ(16,"div",10),e._uU(17),e.qZA(),e.TgZ(18,"div",13)(19,"button",14)(20,"div",15),e._uU(21),e.qZA(),e.TgZ(22,"app-icon",16),e._uU(23,"arrow_drop_down"),e.qZA()()(),e.TgZ(24,"div",17)(25,"button",18),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.show_items=!_.show_items)}),e.TgZ(26,"app-icon"),e._uU(27),e.qZA()()()()}if(2&o){const t=e.oxw(),i=e.MAs(3);e.ekj("bg-gray-100",!t.show_items)("bg-gray-200",t.show_items),e.xp6(1),e.ekj("bg-gray-200",t.show_items)("dark:bg-neutral-700",t.show_items),e.xp6(5),e.hij(" ",e.xi3(7,19,t.order.deliver_at,"shortTime")," "),e.xp6(3),e.hij(" ",(null==t.order.event?null:t.order.event.space.display_name)||(null==t.order.event?null:t.order.event.space.name)||"~ No Location ~"," "),e.xp6(2),e.hij(" ",(null==t.order.event||null==t.order.event.organiser?null:t.order.event.organiser.name)||(null==t.order.event?null:t.order.event.host)||"~ Unknown Host ~"," "),e.xp6(2),e.Oqu(t.order.charge_code||"~ No Code ~"),e.xp6(2),e.Q6J("ngIf",t.order.notes),e.xp6(2),e.hij(" ",t.order.invoice_number||"~ No Invoice ~"," "),e.xp6(2),e.Udp("background",null==t.status?null:t.status.colour),e.Q6J("matMenuTriggerFor",i),e.xp6(2),e.hij(" ",null==t.status?null:t.status.name," "),e.xp6(6),e.Oqu(t.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function fi(o,n){1&o&&e._UZ(0,"li",22),2&o&&e.Q6J("item",n.$implicit)}function hi(o,n){if(1&o&&(e.TgZ(0,"ul",20),e.YNc(1,fi,1,1,"li",21),e.qZA()),2&o){const t=e.oxw();e.ekj("shown",t.show_items),e.Q6J("@show",t.show_items?"show":"hide"),e.xp6(1),e.Q6J("ngForOf",t.order.items)}}function Ci(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.updateStatus(s.id))}),e._UZ(1,"div",24),e.TgZ(2,"span",25),e._uU(3),e.qZA()()}if(2&o){const t=n.$implicit;e.xp6(1),e.Udp("background-color",t.colour),e.xp6(2),e.Oqu(t.name)}}class ve{constructor(n){this._orders=n,this.show_items=!1,this.statuses=ui,this.updateStatus=t=>this._orders.updateStatus(this.order,t)}get status(){return this.statuses.find(n=>n.id===this.order.status)}}function Ti(o,n){if(1&o&&(e.TgZ(0,"li",12),e._UZ(1,"catering-order",13),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("order",t)}}function xi(o,n){1&o&&(e.TgZ(0,"div",14)(1,"p"),e._uU(2,"No Catering Orders"),e.qZA()())}function vi(o,n){1&o&&e._UZ(0,"mat-progress-bar",15)}ve.\u0275fac=function(n){return new(n||ve)(e.Y36(z))},ve.\u0275cmp=e.Xpm({type:ve,selectors:[["catering-order"]],inputs:{order:"order"},decls:5,vars:3,consts:[["class","w-full flex items-center py-2 dark:bg-neutral-700",3,"bg-gray-100","bg-gray-200",4,"ngIf"],["class","list-none p-0 m-0 w-full relative z-0",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2","dark:bg-neutral-700"],[1,"w-20","flex","items-center","justify-center","z-20","h-full"],[1,"rounded-full","bg-gray-400","dark:bg-neutral-800","p-2","text-2xl","text-black","dark:text-white","opacity-60","flex","items-center","justify-center"],["time","",1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-24"],["class","clear underline",3,"matTooltip",4,"ngIf"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["icon","",3,"click"],[1,"clear","underline",3,"matTooltip"],[1,"list-none","p-0","m-0","w-full","relative","z-0"],["catering-order-item","","class","flex items-center",3,"item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(n,t){1&n&&(e.YNc(0,mi,28,22,"div",0),e.YNc(1,hi,2,4,"ul",1),e.TgZ(2,"mat-menu",null,2),e.YNc(4,Ci,4,3,"button",3),e.qZA()),2&n&&(e.Q6J("ngIf",t.order),e.xp6(1),e.Q6J("ngIf",null==t.order?null:t.order.items.length),e.xp6(3),e.Q6J("ngForOf",t.statuses))},dependencies:[l.sg,l.O5,U.VK,U.OP,U.p6,H.gM,T.o,xe,l.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}"],data:{animation:[p.X7]}});class $e{constructor(n){this._orders=n,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(n,t){return t?t.id:void 0}}$e.\u0275fac=function(n){return new(n||$e)(e.Y36(z))},$e.\u0275cmp=e.Xpm({type:$e,selectors:[["catering-order-list"]],decls:24,vars:10,consts:[[1,"sticky","top-0","w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-gray-300","bg-white","dark:bg-neutral-800","dark:border-neutral-500"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-gray-300 dark:border-neutral-500",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block opacity-60",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-gray-300","dark:border-neutral-500"],[3,"order"],["empty","",1,"info-block","opacity-60"],["mode","indeterminate",1,"w-full"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.TgZ(2,"div",2),e._uU(3,"Time"),e.qZA(),e.TgZ(4,"div",3),e._uU(5,"Location"),e.qZA(),e.TgZ(6,"div",4),e._uU(7,"Host"),e.qZA(),e.TgZ(8,"div",5),e._uU(9,"Charge Code"),e.qZA(),e.TgZ(10,"div",2),e._uU(11,"Notes"),e.qZA(),e.TgZ(12,"div",5),e._uU(13,"Invoice No."),e.qZA(),e.TgZ(14,"div",6),e._uU(15,"Status"),e.qZA(),e._UZ(16,"div",7),e.qZA(),e.TgZ(17,"ul",8),e.YNc(18,Ti,2,1,"li",9),e.ALo(19,"async"),e.YNc(20,xi,3,0,"div",10),e.ALo(21,"async"),e.qZA(),e.YNc(22,vi,1,0,"mat-progress-bar",11),e.ALo(23,"async")),2&n){let i;e.xp6(18),e.Q6J("ngForOf",e.lcZ(19,4,t.order_list))("ngForTrackBy",t.trackByFn),e.xp6(2),e.Q6J("ngIf",!(null!=(i=e.lcZ(21,6,t.order_list))&&i.length)),e.xp6(2),e.Q6J("ngIf",e.lcZ(23,8,t.loading))}},dependencies:[l.sg,l.O5,ve,l.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}"]});class G{constructor(n,t){this._org=n,this._settings=t,this._options=new N.X({}),this._filters=new N.X({search:"",tags:[],categories:[]}),this._loading=new N.X(""),this.loading=this._loading.asObservable(),this.filters=this._filters.asObservable(),this.settings=this._org.active_building.pipe((0,yt.h)(i=>!!i),(0,j.w)(i=>(0,L.rlq)(i.id,"catering-settings").pipe((0,Ue.K)(_=>(0,se.of)({})))),(0,F.U)(i=>i.details),(0,ae.b)(i=>this._settings.post("require_catering_notes",!!i.require_notes)),(0,W.d)(1)),this.charge_codes=this.settings.pipe((0,F.U)(i=>i.charge_codes||[])),this.availability=this.settings.pipe((0,F.U)(i=>i.disabled_rooms||[])),this.available_menu=(0,q.aj)([this._options,this._org.active_building]).pipe((0,yt.h)(([i,_])=>!!_),(0,j.w)(([{zone:i},_])=>(this._loading.next("[Menu]"),(0,L.rlq)(i||_.id,"catering").pipe((0,F.U)(s=>s.details.map(a=>new M.U(a))),(0,Ue.K)(s=>[])))),(0,ae.b)(i=>this._loading.next("")),(0,W.d)(1)),this.categories=this.available_menu.pipe((0,F.U)(i=>(0,p.Tw)(i.map(_=>_.category)))),this.filtered_menu=(0,q.aj)([this._filters,this.available_menu]).pipe((0,j.w)(function(){var i=(0,m.Z)(function*([{search:_,tags:s,categories:a,zone_id:r,date:u,duration:g,resources:h},b]){const y=yield function Eo(o,n=!1){return o?((!Wt[o]||n)&&(Wt[o]=(0,L.rlq)(o,"catering_config").pipe((0,F.U)(t=>t.details),(0,Ue.K)(t=>(0,se.of)([])))),Wt[o]):(0,se.of)([])}(r).toPromise();let f=(_=_.toLowerCase())?b.filter(O=>O.name.toLowerCase().includes(_)):b;return f=s.length?f.filter(O=>s.every(ne=>O.tags.includes(ne))):f,f=a.length?f.filter(O=>a.includes(O.category)):f,f=f.filter(O=>ln(O,y,{date:u,duration:g,resources:h})),f});return function(_){return i.apply(this,arguments)}}()),(0,W.d)(1))}get currency_code(){return this._org.currency_code}setOptions(n){this._options.next({...this._options.getValue(),...n})}setFilters(n){this._filters.next({...this._filters.getValue(),...n})}}function Oi(o,n){if(1&o&&(e.TgZ(0,"div",18),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.item.quantity||"1"," ")}}function Ei(o,n){if(1&o&&e._UZ(0,"img",19),2&o){const t=e.oxw();e.Q6J("src",t.item.images[0],e.LSH)}}function Si(o,n){1&o&&e._UZ(0,"img",20)}function Ai(o,n){if(1&o&&(e.TgZ(0,"p",21),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",e.xi3(2,1,t.item.unit_price/100,t.code)," ")}}function bi(o,n){if(1&o&&(e.TgZ(0,"div",22),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.options," ")}}function Fi(o,n){1&o&&(e.TgZ(0,"div",23),e._uU(1," GF "),e.qZA())}function Ni(o,n){1&o&&(e.TgZ(0,"div",24),e._uU(1," VG "),e.qZA())}function wi(o,n){1&o&&(e.TgZ(0,"div",25),e._uU(1," V "),e.qZA())}function Mi(o,n){1&o&&(e.TgZ(0,"div",26),e._uU(1," D "),e.qZA())}function Zi(o,n){1&o&&(e.TgZ(0,"div",27),e._uU(1," N "),e.qZA())}G.\u0275fac=function(n){return new(n||G)(e.LFG(A.w7),e.LFG(p.gb))},G.\u0275prov=e.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"});class Oe{constructor(){this.active=!1,this.selected=!1,this.favourite=!1,this.toggleFav=new e.vpe,this.select=new e.vpe}get options(){return this.item.option_list.map(n=>n.name).join(", ")}}function Ri(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"catering-item-list-item",9),e.NdJ("toggleFav",function(){const s=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.toggleFav.emit(s.id))})("select",function(){const s=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.selectItem(s,!0))}),e.qZA()}if(2&o){const t=n.$implicit,i=e.oxw(2);e.Q6J("item",t)("active",i.active===t.custom_id)("selected",!0)("favourite",i.isFavourite(t.id))}}function yi(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"h3",2),e._uU(2,"Ordered Items"),e.qZA(),e.TgZ(3,"p",3),e._uU(4),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"ul",7),e.YNc(7,Ri,1,4,"catering-item-list-item",8),e.ALo(8,"async"),e.qZA(),e.BQk()),2&o){const t=e.oxw();let i;e.xp6(4),e.hij(" ",(null==(i=e.lcZ(5,2,t.custom_items))?null:i.length)||0," items(s) "),e.xp6(3),e.Q6J("ngForOf",e.lcZ(8,4,t.custom_items))}}function Ii(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"catering-item-list-item",9),e.NdJ("toggleFav",function(){const s=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.toggleFav(s.id))})("select",function(){const s=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.selectItem(s,!0))}),e.qZA()}if(2&o){const t=n.$implicit,i=e.oxw(3);e.Q6J("item",t)("active",i.active===t.custom_id)("selected",i.selected.includes(t.custom_id))("favourite",i.isFavourite(t.id))}}function ki(o,n){if(1&o&&(e.TgZ(0,"ul",7),e.YNc(1,Ii,1,4,"catering-item-list-item",8),e.ALo(2,"async"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.item_list))}}function Pi(o,n){if(1&o&&(e.ynx(0),e.YNc(1,ki,3,3,"ul",10),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw(),i=e.MAs(11);let _;e.xp6(1),e.Q6J("ngIf",null==(_=e.lcZ(2,2,t.item_list))?null:_.length)("ngIfElse",i)}}function Ui(o,n){1&o&&(e.TgZ(0,"div",11)(1,"p",12),e._uU(2," No available items for selected time and/or filters "),e.qZA()())}function Di(o,n){1&o&&(e.TgZ(0,"div",13),e._UZ(1,"mat-spinner",14),e.TgZ(2,"p",15),e._uU(3,"Finding available items..."),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("diameter",32))}Oe.\u0275fac=function(n){return new(n||Oe)},Oe.\u0275cmp=e.Xpm({type:Oe,selectors:[["catering-item-list-item"]],inputs:{item:"item",active:"active",selected:"selected",favourite:"favourite"},outputs:{toggleFav:"toggleFav",select:"select"},decls:24,vars:17,consts:[["item","",1,"relative","p-2","rounded-lg","w-full","shadow","border","bg-white","dark:bg-neutral-600","border-gray-200","dark:border-neutral-500","sm:w-[20rem]"],["matRipple","","select","",1,"w-full","h-full","flex","items-center",3,"click"],[1,"relative","w-16","h-16","rounded-xl","bg-black/20","mr-4","overflow-hidden","border","border-gray-100","dark:border-neutral-600","flex","items-center","justify-center"],["class","absolute top-1 left-1 border border-white bg-black/50 rounded-full h-6 w-6 flex items-center justify-center text-white text-xs",4,"ngIf"],["class","object-cover min-h-full min-w-full",3,"src",4,"ngIf","ngIfElse"],["placeholder",""],[1,"space-y-2","text-left","flex-1"],[1,"font-medium","flex","flex-col","pr-10"],[1,"opacity-60","text-xs"],[1,"flex","items-center","text-sm","space-x-1"],["class","flex-1 w-px",4,"ngIf"],["class","text-xs px-2 py-1 rounded-2xl shadow border border-gray-100",4,"ngIf"],["class","text-xs h-5 w-7 rounded-xl shadow bg-green-500 flex items-center justify-center",4,"ngIf"],["class","text-xs h-5 w-7 rounded-xl shadow bg-blue-600 flex items-center justify-center",4,"ngIf"],["class","text-xs h-5 w-7 rounded-xl shadow bg-blue-400 flex items-center justify-center",4,"ngIf"],["class","text-xs h-5 w-7 rounded-xl shadow bg-yellow-500 flex items-center justify-center",4,"ngIf"],["class","text-xs h-5 w-7 rounded-xl shadow bg-orange-600 flex items-center justify-center",4,"ngIf"],["icon","","matRipple","","fav","",1,"absolute","top-1","right-1",3,"click"],[1,"absolute","top-1","left-1","border","border-white","bg-black/50","rounded-full","h-6","w-6","flex","items-center","justify-center","text-white","text-xs"],[1,"object-cover","min-h-full","min-w-full",3,"src"],["src","assets/icons/catering-placeholder.svg",1,"m-auto"],[1,"flex-1","w-px"],[1,"text-xs","px-2","py-1","rounded-2xl","shadow","border","border-gray-100"],[1,"text-xs","h-5","w-7","rounded-xl","shadow","bg-green-500","flex","items-center","justify-center"],[1,"text-xs","h-5","w-7","rounded-xl","shadow","bg-blue-600","flex","items-center","justify-center"],[1,"text-xs","h-5","w-7","rounded-xl","shadow","bg-blue-400","flex","items-center","justify-center"],[1,"text-xs","h-5","w-7","rounded-xl","shadow","bg-yellow-500","flex","items-center","justify-center"],[1,"text-xs","h-5","w-7","rounded-xl","shadow","bg-orange-600","flex","items-center","justify-center"]],template:function(n,t){if(1&n&&(e.TgZ(0,"li",0)(1,"button",1),e.NdJ("click",function(){return t.select.emit()}),e.TgZ(2,"div",2),e.YNc(3,Oi,2,1,"div",3),e.YNc(4,Ei,1,1,"img",4),e.YNc(5,Si,1,0,"ng-template",null,5,e.W1O),e.qZA(),e.TgZ(7,"div",6)(8,"div",7)(9,"div"),e._uU(10),e.qZA(),e.TgZ(11,"div",8),e._uU(12),e.qZA()(),e.TgZ(13,"div",9),e.YNc(14,Ai,3,4,"p",10),e.YNc(15,bi,2,1,"div",11),e.YNc(16,Fi,2,0,"div",12),e.YNc(17,Ni,2,0,"div",13),e.YNc(18,wi,2,0,"div",14),e.YNc(19,Mi,2,0,"div",15),e.YNc(20,Zi,2,0,"div",16),e.qZA()()(),e.TgZ(21,"button",17),e.NdJ("click",function(){return t.toggleFav.emit()}),e.TgZ(22,"app-icon"),e._uU(23),e.qZA()()()),2&n){const i=e.MAs(6);e.ekj("!border-black",t.active),e.xp6(3),e.Q6J("ngIf",t.item.quantity&&t.selected),e.xp6(1),e.Q6J("ngIf",null==t.item.images?null:t.item.images.length)("ngIfElse",i),e.xp6(6),e.Oqu(t.item.name||"Item"),e.xp6(2),e.hij(" ",t.item.category," "),e.xp6(2),e.Q6J("ngIf",t.item.unit_price),e.xp6(1),e.Q6J("ngIf",t.item.option_list.length),e.xp6(1),e.Q6J("ngIf",null==t.item.tags?null:t.item.tags.includes("Gluten Free")),e.xp6(1),e.Q6J("ngIf",null==t.item.tags?null:t.item.tags.includes("Vegan")),e.xp6(1),e.Q6J("ngIf",null==t.item.tags?null:t.item.tags.includes("Vegetarian")),e.xp6(1),e.Q6J("ngIf",null==t.item.tags?null:t.item.tags.includes("Contains Dairy")),e.xp6(1),e.Q6J("ngIf",null==t.item.tags?null:t.item.tags.includes("Contains Nuts")),e.xp6(1),e.ekj("text-blue-400",t.favourite),e.xp6(2),e.Oqu(t.favourite?"favorite":"favorite_border")}},dependencies:[l.O5,T.o,l.H9]});class Ee{constructor(n){this._state=n,this.active="",this.selected="",this.selected_items=[],this.favorites=[],this.toggleFav=new e.vpe,this.onSelect=new e.vpe,this.list=new N.X([]),this.loading=this._state.loading,this.item_list=this._state.filtered_menu,this.custom_items=(0,q.aj)([this.list,this._state.available_menu]).pipe((0,F.U)(([t,i])=>t.filter(_=>_.option_list?.length)))}get code(){return this._state.currency_code}ngOnChanges(n){n.selected_items&&this.list.next(this.selected_items||[])}isFavourite(n){return this.favorites?.includes(n)}selectItem(n,t=!1){this.onSelect.emit(n),t&&n.options?.forEach(i=>delete i.active)}}function Li(o,n){if(1&o&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,t.item.unit_price/100,t.code)," ")}}function qi(o,n){if(1&o&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t," ")}}function Ki(o,n){if(1&o&&(e.TgZ(0,"div",34),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(4);e.xp6(1),e.hij(" +",e.xi3(2,1,t.unit_price/100,i.code)," ")}}function Wi(o,n){if(1&o&&(e.TgZ(0,"mat-radio-button",30)(1,"div",31)(2,"div",32),e._uU(3),e.qZA(),e.YNc(4,Ki,3,4,"div",33),e.qZA()()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(3),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.unit_price)}}function $i(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-radio-group",25),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.group_state[s.name]=_)})("ngModelChange",function(_){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.updateGroupOption(s,_))}),e.TgZ(2,"mat-radio-button",26)(3,"span",27),e.SDv(4,28),e.qZA()(),e.YNc(5,Wi,5,3,"mat-radio-button",29),e.qZA(),e.BQk()}if(2&o){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngModel",i.group_state[t.name]),e.xp6(4),e.Q6J("ngForOf",null==t?null:t.options)}}function Gi(o,n){if(1&o&&(e.TgZ(0,"div",34),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(4);e.xp6(1),e.hij(" +",e.xi3(2,1,t.unit_price/100,i.code)," ")}}function Ji(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-checkbox",36),e.NdJ("ngModelChange",function(_){const a=e.CHM(t).$implicit,r=e.oxw(4);return e.KtG(r.option_state[a.id]=_)})("ngModelChange",function(_){const a=e.CHM(t).$implicit,r=e.oxw(4);return e.KtG(r.updateCheckedState(a.id,_))}),e.TgZ(1,"div",18)(2,"div",37),e._uU(3),e.qZA(),e.YNc(4,Gi,3,4,"div",33),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw(4);e.Q6J("ngModel",i.option_state[t.id]),e.xp6(3),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.unit_price)}}function Yi(o,n){if(1&o&&e.YNc(0,Ji,5,3,"mat-checkbox",35),2&o){const t=e.oxw().$implicit;e.Q6J("ngForOf",null==t?null:t.options)}}function Qi(o,n){if(1&o&&(e.TgZ(0,"div",21)(1,"div",22),e._uU(2),e.qZA(),e.TgZ(3,"div",23),e.YNc(4,$i,6,2,"ng-container",0),e.YNc(5,Yi,1,1,"ng-template",null,24,e.W1O),e.qZA()()),2&o){const t=n.$implicit,i=e.MAs(6);e.uIk("group",t.name),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",!t.multiple)("ngIfElse",i)}}function Bi(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"section",2),e._UZ(2,"image-carousel",3),e.TgZ(3,"button",4),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.close.emit())}),e.TgZ(4,"app-icon"),e._uU(5,"arrow_back"),e.qZA()(),e.TgZ(6,"button",5),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.toggleFav.emit())}),e.TgZ(7,"app-icon"),e._uU(8),e.qZA()()(),e.TgZ(9,"div",6)(10,"section",7)(11,"div")(12,"h2",8),e._uU(13),e.qZA(),e.YNc(14,Li,3,4,"p",9),e.qZA(),e.TgZ(15,"a-counter",10),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.item.quantity=_)}),e.qZA()(),e.TgZ(16,"section",11),e.YNc(17,qi,2,1,"div",12),e.qZA(),e._UZ(18,"hr"),e.TgZ(19,"section",13)(20,"div",14),e.YNc(21,Qi,7,4,"div",15),e.qZA()()(),e.TgZ(22,"div",16)(23,"button",17),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return _.active=!_.active,e.KtG(_.activeChange.emit(_.active))}),e.TgZ(24,"div",18)(25,"app-icon",19),e._uU(26),e.qZA(),e.TgZ(27,"p"),e._uU(28),e.qZA()()()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("images",t.item.images),e.xp6(4),e.ekj("text-white",!t.fav)("text-blue-400",t.fav),e.xp6(2),e.Oqu(t.fav?"favorite":"favorite_border"),e.xp6(5),e.hij(" ",t.item.name," "),e.xp6(1),e.Q6J("ngIf",t.item.unit_price),e.xp6(1),e.Q6J("ngModel",t.item.quantity)("min",1)("max",t.item.count||10),e.xp6(2),e.Q6J("ngForOf",t.item.tags),e.xp6(4),e.Q6J("ngForOf",t.groups),e.xp6(2),e.ekj("inverse",t.active),e.xp6(3),e.Oqu(t.active?"remove":"add"),e.xp6(2),e.hij(" ",t.active?"Remove this item":"Add this item"," ")}}function ji(o,n){1&o&&(e.TgZ(0,"div",38)(1,"p",39),e.SDv(2,40),e.qZA()())}Ee.\u0275fac=function(n){return new(n||Ee)(e.Y36(G))},Ee.\u0275cmp=e.Xpm({type:Ee,selectors:[["catering-item-list"]],inputs:{active:"active",selected:"selected",selected_items:"selected_items",favorites:"favorites"},outputs:{toggleFav:"toggleFav",onSelect:"onSelect"},features:[e.TTD],decls:14,vars:10,consts:[[1,"w-full","h-full","overflow-auto","py-2"],[4,"ngIf"],[1,"font-bold","px-2"],["count","",1,"text-sm","opacity-60","mb-2","px-2"],[4,"ngIf","ngIfElse"],["empty_state",""],["load_state",""],[1,"list-style-none","space-y-2","p-2"],["class","block",3,"item","active","selected","favourite","toggleFav","select",4,"ngFor","ngForOf"],[1,"block",3,"item","active","selected","favourite","toggleFav","select"],["class","list-style-none space-y-2 p-2",4,"ngIf","ngIfElse"],["empty","",1,"p-16","flex","flex-col","items-center","justify-center","space-y-2"],[1,"opacity-30","text-center"],["loading","",1,"p-16","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"],[1,"opacity-30"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0),e.YNc(1,yi,9,6,"ng-container",1),e.ALo(2,"async"),e.TgZ(3,"h3",2),e._uU(4,"Results"),e.qZA(),e.TgZ(5,"p",3),e._uU(6),e.ALo(7,"async"),e.qZA(),e.YNc(8,Pi,3,4,"ng-container",4),e.ALo(9,"async"),e.qZA(),e.YNc(10,Ui,3,0,"ng-template",null,5,e.W1O),e.YNc(12,Di,4,1,"ng-template",null,6,e.W1O)),2&n){const i=e.MAs(13);let _,s;e.xp6(1),e.Q6J("ngIf",null==(_=e.lcZ(2,4,t.custom_items))?null:_.length),e.xp6(5),e.hij(" ",(null==(s=e.lcZ(7,6,t.item_list))?null:s.length)||0," result(s) found "),e.xp6(2),e.Q6J("ngIf",!e.lcZ(9,8,t.loading))("ngIfElse",i)}},dependencies:[l.sg,l.O5,w.Ou,Oe,l.Ov]});class Se{constructor(){this.active=!1,this.fav=!1,this.code="USD",this.toggleFav=new e.vpe,this.activeChange=new e.vpe,this.close=new e.vpe,this.option_state={},this.group_state={}}ngOnChanges(n){n.item&&this.item&&this._update()}updateGroupOption(n,t){if(n){this.group_state[n.name]=t;for(const i of n.options)i.active=i.id===t}}updateCheckedState(n,t){const i=this.item?.options.find(_=>_.id===n);i&&(i.active=t)}_update(){if(!this.item)return;this.item.quantity||(this.item.quantity=1),this.option_state={},this.group_state={};const n=(0,p.Tw)(this.item.options.map(i=>i.group||"Other")),t=[];for(const i of n){const _=this.item.options.filter(s=>s.group===i);t.push({name:i,multiple:!!_.find(s=>s.multiple),options:_})}if(this.groups=t,this.item.option_list)for(const i of this.item.option_list){const _=this.item.options.find(s=>s.id===i.id);_&&(_.active=!0,this.option_state[i.id]=!0,this.updateGroupOption(this.groups.find(s=>s.name===_.group),_.id))}}}function Hi(o,n){1&o&&(e.TgZ(0,"h3",7),e.SDv(1,8),e.qZA())}function Xi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-checkbox",9),e.NdJ("ngModelChange",function(){const s=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.toggleCategory(s))}),e.ALo(1,"async"),e._uU(2),e.qZA()}if(2&o){const t=n.$implicit,i=e.oxw();let _;e.Q6J("ngModel",null==(_=e.lcZ(1,3,i.filters))||null==_.categories?null:_.categories.includes(t)),e.uIk("name",t),e.xp6(2),e.hij(" ",t," ")}}Se.\u0275fac=function(n){return new(n||Se)},Se.\u0275cmp=e.Xpm({type:Se,selectors:[["catering-item-details"]],inputs:{item:"item",active:"active",fav:"fav",code:"code"},outputs:{toggleFav:"toggleFav",activeChange:"activeChange",close:"close"},features:[e.TTD],decls:3,vars:2,consts:function(){let o,n;return o=$localize`:␟a2f14a73f7a6e94479f67423cc51102da8d6f524␟6252070156626006029:None`,n=$localize`:␟0fab86098296160aef9d98a89e252bee5cf35141␟2528715266490787662: Select an item to view it's details `,[[4,"ngIf","ngIfElse"],["empty_state",""],["image","",1,"relative","w-full","h-64","sm:h-40","bg-black/20"],[1,"absolute","inset-0",3,"images"],["icon","","matRipple","","close","",1,"absolute","top-2","left-2","bg-black/40","sm:hidden","text-white",3,"click"],["icon","","matRipple","","fav","",1,"absolute","top-2","right-2","bg-black/40",3,"click"],[1,"p-2","space-y-2","flex-1","h-1/2","overflow-auto"],["actions","",1,"z-0","flex","items-center","justify-between"],[1,"text-xl","font-medium","mb-2","mt-4"],[4,"ngIf"],[3,"ngModel","min","max","ngModelChange"],[1,"flex","items-center","flex-wrap"],["class","px-2 py-1 rounded-2xl bg-gray-200 dark:bg-neutral-500 text-sm capitalize m-1",4,"ngFor","ngForOf"],["details","",1,"space-y-2"],[1,"flex","flex-col","flex-wrap"],["class","min-w-1/2 flex-1",4,"ngFor","ngForOf"],[1,"p-2","border-t","border-gray-200","shadow","sm:hidden"],["btn","","matRipple","","select","",1,"w-full",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-2xl"],[1,"px-2","py-1","rounded-2xl","bg-gray-200","dark:bg-neutral-500","text-sm","capitalize","m-1"],[1,"min-w-1/2","flex-1"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-4"],["multi_options",""],["aria-label","Select an option",1,"flex","flex-col",3,"ngModel","ngModelChange"],["value","",1,"m-0"],[1,"font-medium","p-2"],o,["class","m-0",3,"value",4,"ngFor","ngForOf"],[1,"m-0",3,"value"],[1,"flex","items-center","justify-center","max-w-[calc(100vw-4rem)]","sm:max-w-[15rem]"],[1,"font-medium","p-2","flex-1","w-1/2","whitespace-normal"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[1,"font-medium","p-2","flex-1","w-1/2"],["empty","",1,"p-16","flex","flex-col","items-center","justify-center","space-y-2"],[1,"opacity-30","text-center"],n]},template:function(n,t){if(1&n&&(e.YNc(0,Bi,29,17,"ng-container",0),e.YNc(1,ji,3,0,"ng-template",null,1,e.W1O)),2&n){const i=e.MAs(2);e.Q6J("ngIf",t.item)("ngIfElse",i)}},dependencies:[l.sg,l.O5,R.oG,qe.VQ,qe.U0,c.JJ,c.On,T.o,en.K,Pe.R,l.H9],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:30%;min-width:20rem;height:100%;min-height:65vh}"]});const zi={coffee:'<svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0_605_8664)">\n    <path d="M38.388 21.2474C37.8243 20.7996 37.1598 20.4847 36.4474 20.3278C35.735 20.1708 34.9944 20.1762 34.2846 20.3434C34.2476 19.7774 34.2049 19.2037 34.1483 18.6155C34.1243 18.3664 34.0043 18.1349 33.8119 17.9668C33.6195 17.7986 33.3687 17.706 33.1088 17.707H1.26151C1.00166 17.706 0.750839 17.7986 0.558442 17.9668C0.366045 18.1349 0.246035 18.3664 0.222073 18.6155C-0.42931 25.3581 0.106585 30.5307 4.80024 35.4799C8.88062 39.7819 15.7271 39.9998 17.0599 39.9998H17.3047C18.6375 39.9998 25.4863 39.7774 29.5643 35.4799C30.5412 34.4597 31.3937 33.3353 32.1052 32.1286C32.2481 32.1199 32.3875 32.0819 32.514 32.0174C34.0959 31.2139 35.6169 30.3039 37.0656 29.2943C38.3815 28.4227 39.3664 27.1618 39.871 25.7028C40.0702 24.9006 40.0372 24.0612 39.7758 23.2757C39.5144 22.4902 39.0344 21.7887 38.388 21.2474ZM28.0329 34.13C24.4699 37.8905 18.0323 37.9984 17.3093 37.9984H17.0645C16.3426 37.9984 9.90389 37.8872 6.34092 34.13C2.37257 29.9436 1.75351 25.466 2.21549 19.7085H32.1583C32.6214 25.4649 32.0024 29.9425 28.0329 34.13ZM37.8498 25.2091C37.4485 26.2369 36.7212 27.117 35.771 27.7243C35.024 28.2636 34.2434 28.7582 33.4334 29.2053C34.1268 27.0036 34.4428 24.7078 34.3689 22.4082C34.3839 22.4027 34.3989 22.4082 34.4139 22.3982C34.8447 22.2182 35.3192 22.1579 35.7837 22.2242C36.2482 22.2905 36.6841 22.4808 37.0421 22.7733C37.4001 23.0659 37.6658 23.4491 37.8092 23.8796C37.9525 24.3101 37.9678 24.7707 37.8533 25.2091H37.8498Z" fill="currentcolor"/>\n    <path d="M9.43243 8.16274C9.85735 8.48322 10.2069 8.88673 10.4582 9.34669C10.7094 9.80666 10.8565 10.3126 10.89 10.8313C10.7939 11.9569 10.2754 13.0103 9.43128 13.7946C9.32937 13.883 9.24664 13.9899 9.18786 14.1092C9.12907 14.2286 9.0954 14.3579 9.08878 14.4898C9.08216 14.6217 9.10275 14.7536 9.14931 14.8778C9.19588 15.002 9.26753 15.1161 9.36012 15.2136C9.45271 15.311 9.56442 15.3898 9.6888 15.4455C9.81319 15.5012 9.9478 15.5326 10.0849 15.538C10.2219 15.5433 10.3587 15.5225 10.4874 15.4767C10.6161 15.4309 10.734 15.3611 10.8345 15.2712C12.1048 14.1093 12.8679 12.5254 12.9688 10.8413C12.9432 10.042 12.7392 9.25727 12.3708 8.5405C12.0023 7.82373 11.478 7.19166 10.8334 6.68722C10.4067 6.38353 10.055 5.99283 9.80341 5.54303C9.55184 5.09323 9.40662 4.59547 9.37815 4.08534C9.51392 3.18283 10.0073 2.36595 10.7548 1.80591C10.9718 1.64618 11.1147 1.41065 11.1528 1.15024C11.1908 0.889843 11.1208 0.625512 10.958 0.414392C10.7951 0.203272 10.5525 0.062327 10.2826 0.0220596C10.0127 -0.0182078 9.73715 0.0454338 9.51559 0.199206C8.90219 0.651996 8.39004 1.21933 8.0098 1.86721C7.62956 2.5151 7.38907 3.2302 7.30273 3.9697C7.30292 4.77855 7.49485 5.5767 7.86392 6.30333C8.23298 7.02996 8.76944 7.66592 9.43243 8.16274Z" fill="currentcolor"/>\n    <path d="M23.0984 8.16274C23.5234 8.48322 23.8729 8.88673 24.1242 9.34669C24.3754 9.80666 24.5225 10.3126 24.556 10.8313C24.4599 11.9569 23.9414 13.0103 23.0973 13.7946C22.9954 13.883 22.9126 13.9899 22.8539 14.1092C22.7951 14.2286 22.7614 14.3579 22.7548 14.4898C22.7482 14.6217 22.7687 14.7536 22.8153 14.8778C22.8619 15.002 22.9335 15.1161 23.0261 15.2136C23.1187 15.311 23.2304 15.3898 23.3548 15.4455C23.4792 15.5012 23.6138 15.5326 23.7509 15.538C23.8879 15.5433 24.0247 15.5225 24.1534 15.4767C24.2821 15.4309 24.4 15.3611 24.5005 15.2712C25.7708 14.1093 26.5339 12.5254 26.6348 10.8413C26.6092 10.042 26.4052 9.25727 26.0368 8.5405C25.6683 7.82373 25.144 7.19166 24.4994 6.68722C24.0727 6.38353 23.721 5.99283 23.4694 5.54303C23.2178 5.09323 23.0726 4.59547 23.0442 4.08534C23.1799 3.18283 23.6733 2.36595 24.4208 1.80591C24.6378 1.64618 24.7807 1.41065 24.8188 1.15024C24.8568 0.889843 24.7868 0.625512 24.624 0.414392C24.4611 0.203272 24.2185 0.062327 23.9486 0.0220596C23.6787 -0.0182078 23.4032 0.0454338 23.1816 0.199206C22.5682 0.651996 22.0561 1.21933 21.6758 1.86721C21.2956 2.5151 21.0551 3.2302 20.9688 3.9697C20.9689 4.77855 21.1609 5.5767 21.5299 6.30333C21.899 7.02996 22.4355 7.66592 23.0984 8.16274Z" fill="currentcolor"/>\n    <path d="M16.2645 8.16274C16.6894 8.48322 17.039 8.88673 17.2902 9.34669C17.5414 9.80666 17.6886 10.3126 17.722 10.8313C17.626 11.9569 17.1074 13.0103 16.2633 13.7946C16.1614 13.883 16.0787 13.9899 16.0199 14.1092C15.9611 14.2286 15.9274 14.3579 15.9208 14.4898C15.9142 14.6217 15.9348 14.7536 15.9813 14.8778C16.0279 15.002 16.0996 15.1161 16.1922 15.2136C16.2847 15.311 16.3964 15.3898 16.5208 15.4455C16.6452 15.5012 16.7798 15.5326 16.9169 15.538C17.054 15.5433 17.1908 15.5225 17.3194 15.4767C17.4481 15.4309 17.5661 15.3611 17.6666 15.2712C18.9368 14.1093 19.6999 12.5254 19.8009 10.8413C19.7752 10.042 19.5713 9.25727 19.2028 8.5405C18.8343 7.82373 18.31 7.19166 17.6654 6.68722C17.2387 6.38353 16.887 5.99283 16.6354 5.54303C16.3839 5.09323 16.2386 4.59547 16.2102 4.08534C16.346 3.18283 16.8393 2.36595 17.5869 1.80591C17.8038 1.64618 17.9468 1.41065 17.9848 1.15024C18.0228 0.889843 17.9528 0.625512 17.79 0.414392C17.6271 0.203272 17.3845 0.062327 17.1146 0.0220596C16.8447 -0.0182078 16.5692 0.0454338 16.3476 0.199206C15.7342 0.651996 15.2221 1.21933 14.8418 1.86721C14.4616 2.5151 14.2211 3.2302 14.1348 3.9697C14.1349 4.77855 14.3269 5.5767 14.6959 6.30333C15.065 7.02996 15.6015 7.66592 16.2645 8.16274Z" fill="currentcolor"/>\n    <path d="M7.16328 29.7138C5.86597 27.7051 5.17938 25.3866 5.18141 23.0212C5.18141 22.7558 5.07191 22.5013 4.87697 22.3136C4.68204 22.1259 4.41765 22.0205 4.14198 22.0205C3.8663 22.0205 3.60191 22.1259 3.40698 22.3136C3.21204 22.5013 3.10254 22.7558 3.10254 23.0212C3.10081 25.7653 3.89738 28.4551 5.40201 30.7857C5.55001 31.0072 5.78275 31.1637 6.04976 31.2211C6.31677 31.2784 6.59652 31.2322 6.82832 31.0923C7.06012 30.9524 7.22529 30.7301 7.288 30.4737C7.35071 30.2174 7.30588 29.9475 7.16328 29.7227V29.7138Z" fill="currentcolor"/>\n    <path d="M9.06498 32.7103C8.94112 32.6482 8.84235 32.548 8.78434 32.4257C8.73082 32.3026 8.65227 32.1911 8.55334 32.0977C8.45441 32.0043 8.33708 31.9309 8.20825 31.8818C8.07942 31.8327 7.9417 31.8089 7.80317 31.8118C7.66464 31.8146 7.5281 31.8441 7.40159 31.8986C7.27508 31.953 7.16115 32.0312 7.06649 32.1286C6.97184 32.226 6.89837 32.3407 6.8504 32.4658C6.80244 32.591 6.78094 32.7241 6.78719 32.8574C6.79344 32.9906 6.8273 33.1213 6.88678 33.2418C7.13536 33.7758 7.56332 34.2136 8.10177 34.4849C8.34682 34.6079 8.63256 34.6321 8.89616 34.5523C9.15975 34.4724 9.37959 34.295 9.50732 34.0591C9.63505 33.8232 9.6602 33.5481 9.57725 33.2943C9.49429 33.0405 9.31003 32.8289 9.06498 32.7059V32.7103Z" fill="currentcolor"/>\n    </g>\n    <defs>\n    <clipPath id="clip0_605_8664">\n    <rect width="40" height="40" fill="white"/>\n    </clipPath>\n    </defs>\n    </svg>\n    ',drinks:'<svg width="28" height="39" viewBox="0 0 28 39" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0_598_8203)">\n    <path d="M0 0L0.662157 8.11078C0.662157 8.12619 0.653028 8.1394 0.653028 8.15481C0.658117 8.18851 0.664982 8.22193 0.673584 8.25496L3.1852 39H25.1048L28.0034 0H0ZM25.7932 1.98093L25.4085 7.16985C25.3982 7.16985 25.3902 7.16985 25.3799 7.16985H2.64519L2.22279 1.98642L25.7932 1.98093ZM23.1948 37.0191H5.08147L2.80846 9.14527H25.2612L23.1948 37.0191Z" fill="currentcolor"/>\n    <path d="M6.24983 23.3122C6.28864 23.3122 6.32861 23.3122 6.364 23.3122C6.49825 23.2972 6.6281 23.2567 6.74613 23.1933C6.86415 23.1298 6.96804 23.0445 7.05181 22.9423C7.13559 22.8401 7.19762 22.7229 7.23436 22.5975C7.2711 22.4722 7.28181 22.341 7.26589 22.2117C7.0661 20.5444 6.86517 18.8155 6.66538 17.0855C6.4576 15.2861 6.24869 13.4846 6.03862 11.7502C5.99894 11.4962 5.85848 11.267 5.64686 11.111C5.43525 10.955 5.16904 10.8843 4.90438 10.9138C4.63973 10.9434 4.39731 11.0708 4.22831 11.2694C4.0593 11.4679 3.9769 11.722 3.9985 11.978C4.20628 13.7091 4.41522 15.5084 4.623 17.3056C4.82392 19.0378 5.02485 20.77 5.22578 22.4395C5.25574 22.6807 5.37661 22.9029 5.56542 23.0638C5.75424 23.2247 5.99781 23.3131 6.24983 23.3122Z" fill="currentcolor"/>\n    <path d="M6.05485 24.414C5.9204 24.4288 5.79029 24.469 5.67201 24.5323C5.55372 24.5957 5.44958 24.6809 5.36557 24.7832C5.28156 24.8854 5.21933 25.0027 5.18245 25.1282C5.14557 25.2537 5.13477 25.385 5.15067 25.5145L5.31392 26.8857C5.34197 27.1276 5.46141 27.351 5.64945 27.5134C5.83748 27.6758 6.08096 27.7658 6.33341 27.7662C6.37223 27.7662 6.41105 27.7662 6.44759 27.7607C6.5817 27.7462 6.71152 27.7063 6.82966 27.6434C6.9478 27.5806 7.05194 27.4959 7.13612 27.3942C7.22029 27.2925 7.28287 27.1758 7.32027 27.0508C7.35766 26.9258 7.36913 26.7949 7.35404 26.6656L7.1908 25.2889C7.15839 25.0286 7.02114 24.791 6.80864 24.6273C6.59614 24.4636 6.32541 24.387 6.05485 24.414Z" fill="currentcolor"/>\n    </g>\n    <defs>\n    <clipPath id="clip0_598_8203">\n    <rect width="28" height="39" fill="white"/>\n    </clipPath>\n    </defs>\n    </svg>\n    ',snacks:'<svg width="44" height="30" viewBox="0 0 44 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M39.9739 12.3839H39.9673C39.8416 11.3068 39.529 10.2613 39.0441 9.29623C38.2937 7.89066 37.2396 6.67826 35.9616 5.75118C34.6837 4.82411 33.2156 4.20677 31.669 3.94605C31.658 3.94605 31.6471 3.94605 31.635 3.94605C29.7116 1.41671 26.4577 0.0219894 22.162 0.00292969C17.7851 0.0287164 14.3819 1.44362 12.4015 3.94605C12.3773 3.94605 12.3553 3.94605 12.3312 3.94605C10.7845 4.20721 9.31631 4.82484 8.03823 5.75207C6.76016 6.6793 5.70574 7.89174 4.95505 9.29734C4.47112 10.2623 4.15888 11.3074 4.03289 12.3839H4.02631C2.34137 14.0479 1.12087 16.1402 0.490328 18.4457C-0.140217 20.7512 -0.15805 23.1866 0.438675 25.5015C1.16762 28.1328 2.30494 29.6228 3.81991 29.9323C4.02143 29.975 4.22667 29.9968 4.43249 29.9973C5.03503 29.925 5.61546 29.722 6.13483 29.4017C6.6542 29.0815 7.1005 28.6516 7.44377 28.1407C8.13563 27.3077 8.96125 26.601 9.88529 26.0508C10.6588 25.658 11.4715 25.3513 12.3092 25.136C12.7407 25.007 13.2105 24.8624 13.7122 24.6875C14.2182 24.7717 14.7299 24.8148 15.2426 24.8164C16.5191 24.8132 17.7827 24.5561 18.963 24.0597C19.2243 24.1678 19.4915 24.2603 19.7633 24.3366C20.4624 24.5255 21.1737 24.6634 21.892 24.7492C21.9649 24.7584 22.0386 24.7584 22.1115 24.7492C22.8298 24.6634 23.5411 24.5255 24.2402 24.3366C24.5121 24.2602 24.7794 24.1674 25.0405 24.0585C26.6985 24.7663 28.5179 24.9843 30.2913 24.6875C30.7941 24.8568 31.2639 25.0014 31.6954 25.136C32.5326 25.3518 33.3449 25.6585 34.1182 26.0508C35.0422 26.6006 35.8675 27.3074 36.5586 28.1407C36.9021 28.6516 37.3486 29.0816 37.8682 29.4018C38.3877 29.722 38.9683 29.925 39.571 29.9973C39.7765 29.9968 39.9813 29.975 40.1825 29.9323C41.6986 29.6228 42.8359 28.1317 43.5648 25.5015C44.1604 23.1863 44.1418 20.7509 43.5107 18.4455C42.8796 16.1401 41.6588 14.0479 39.9739 12.3839ZM8.94886 24.276C7.83296 24.927 6.83512 25.7694 5.99906 26.7661C5.09447 27.7561 4.76074 28.07 4.20854 27.9568C3.49936 27.8111 2.83628 26.7459 2.34227 24.9543C1.92223 23.3112 1.86627 21.5932 2.17848 19.9252C2.4907 18.2572 3.16322 16.6814 4.14706 15.3124C4.29059 16.0686 4.52165 16.8048 4.83539 17.5054C6.01506 20.1182 8.00316 22.2624 10.4935 23.6078C9.96108 23.7857 9.44437 24.0092 8.94886 24.276ZM14.1514 22.7266C13.9962 22.6555 13.8256 22.6265 13.6562 22.6425C12.1235 22.2411 10.6976 21.4958 9.48221 20.461C8.26685 19.4261 7.2926 18.1277 6.63029 16.66C6.16216 15.6502 5.92631 14.5445 5.94077 13.4274C5.95523 12.3102 6.21962 11.2112 6.71373 10.2145C7.64306 8.45293 9.17618 7.10357 11.0193 6.42493C9.99726 9.36013 10.6472 13.6553 12.7165 17.6365C13.6785 19.5654 15.0132 21.2752 16.6401 22.6627C15.8195 22.8232 14.9787 22.8448 14.1514 22.7266ZM23.7451 22.3903C23.1716 22.5448 22.5889 22.6613 22.0007 22.7389C21.4117 22.6614 20.8283 22.5449 20.254 22.3903C18.2033 21.8521 16.0374 19.7219 14.462 16.6925C12.6704 13.2438 12.0469 9.47672 12.8834 7.09538C14.473 2.55356 19.9093 2.03223 22.1653 2.01765C25.4445 2.03783 29.66 2.93475 31.1157 7.09538C31.9501 9.4756 31.3353 13.2427 29.5393 16.6903C27.9628 19.7197 25.798 21.851 23.7451 22.3891V22.3903ZM27.3579 22.6649C28.9873 21.2782 30.3233 19.5673 31.2848 17.6365C33.353 13.6542 34.0019 9.36013 32.9798 6.42493C34.8231 7.1032 36.3564 8.45266 37.2854 10.2145C37.7798 11.2111 38.0446 12.31 38.0594 13.4271C38.0743 14.5442 37.8388 15.6501 37.371 16.66C36.7089 18.1267 35.7356 19.4246 34.5215 20.4595C33.3074 21.4945 31.883 22.2405 30.3517 22.6436C30.1773 22.6248 30.0013 22.6546 29.8423 22.73C29.0162 22.8474 28.1769 22.825 27.3579 22.6638V22.6649ZM41.6601 24.9555C41.165 26.7493 40.5009 27.8122 39.7939 27.9579C39.2516 28.07 38.9156 27.7595 38.0033 26.7673C37.1671 25.7707 36.1693 24.9284 35.0536 24.2772C34.5589 24.0089 34.0429 23.7839 33.5111 23.6045C36.0014 22.2591 37.9895 20.1148 39.1692 17.502C39.4825 16.8016 39.7135 16.0659 39.8575 15.3101C40.8408 16.6799 41.5127 18.2562 41.8245 19.9245C42.1364 21.5927 42.0802 23.311 41.6601 24.9543V24.9555Z" fill="currentColor"/>\n    <path d="M17.3428 15.7782C16.1626 13.048 15.7674 10.0313 16.2032 7.08028C16.2231 6.94931 16.2174 6.81565 16.1867 6.68691C16.1559 6.55816 16.1006 6.43686 16.024 6.32994C15.9473 6.22302 15.8508 6.13257 15.7399 6.06375C15.629 5.99493 15.5059 5.94908 15.3777 5.92884C15.2495 5.90859 15.1186 5.91434 14.9925 5.94576C14.8665 5.97717 14.7477 6.03365 14.643 6.11194C14.5383 6.19023 14.4497 6.2888 14.3824 6.40205C14.315 6.5153 14.2701 6.641 14.2503 6.77197C13.7579 10.1061 14.2045 13.5144 15.538 16.5989C15.5889 16.7227 15.6636 16.8349 15.7575 16.9289C15.8515 17.0229 15.9628 17.0967 16.0851 17.1462C16.2074 17.1956 16.3381 17.2197 16.4695 17.2168C16.601 17.214 16.7306 17.1844 16.8507 17.1298C16.9709 17.0752 17.0791 16.9966 17.1691 16.8987C17.2591 16.8008 17.3291 16.6855 17.3749 16.5597C17.4208 16.4338 17.4415 16.2998 17.436 16.1656C17.4305 16.0315 17.3988 15.8997 17.3428 15.7782Z" fill="currentColor"/>\n    <path d="M19.696 19.2067C19.2865 18.9533 18.9569 18.5852 18.7464 18.146C18.6921 18.023 18.6143 17.9124 18.5174 17.8206C18.4206 17.7288 18.3067 17.6578 18.1825 17.6118C18.0583 17.5658 17.9263 17.5456 17.7944 17.5526C17.6625 17.5596 17.5333 17.5935 17.4144 17.6524C17.2955 17.7112 17.1894 17.7939 17.1023 17.8953C17.0153 17.9968 16.949 18.1151 16.9075 18.2432C16.866 18.3712 16.85 18.5065 16.8606 18.641C16.8712 18.7755 16.908 18.9065 16.969 19.0262C17.3477 19.8156 17.9407 20.4772 18.6772 20.9321C18.7884 21.0004 18.9117 21.0457 19.0401 21.0654C19.1684 21.085 19.2993 21.0786 19.4253 21.0466C19.5512 21.0146 19.6698 20.9576 19.7741 20.8788C19.8785 20.8 19.9666 20.701 20.0335 20.5874C20.1004 20.4738 20.1448 20.3478 20.164 20.2168C20.1832 20.0857 20.177 19.952 20.1456 19.8234C20.1143 19.6947 20.0585 19.5737 19.9813 19.4671C19.9041 19.3605 19.8072 19.2705 19.696 19.2022V19.2067Z" fill="currentColor"/>\n    </svg>\n    ',meals:'<svg width="44" height="47" viewBox="0 0 44 47" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <g clip-path="url(#clip0_598_8219)">\n    <path d="M42.941 2.11595C42.7415 1.9851 42.4981 1.93888 42.2644 1.98745C42.0307 2.03602 41.8259 2.1754 41.695 2.37496L34.006 14.102C33.3796 13.6496 32.7178 13.2483 32.027 12.902C32.0551 12.8557 32.0786 12.8068 32.097 12.756L35.4431 1.14795C35.5094 0.91841 35.4818 0.671927 35.3663 0.46273C35.2509 0.253533 35.0571 0.098759 34.8275 0.0324549C34.598 -0.0338492 34.3515 -0.0062506 34.1423 0.109178C33.9331 0.224607 33.7783 0.41841 33.712 0.647954L30.382 12.202C28.8498 11.6558 27.2357 11.3751 25.609 11.372C23.5868 11.3208 21.5789 11.7248 19.7337 12.5541C17.8886 13.3834 16.2534 14.6167 14.949 16.163C13.472 15.5617 11.8698 15.3326 10.2834 15.4959C8.69704 15.6593 7.17511 16.21 5.85156 17.0996C4.528 17.9893 3.44339 19.1906 2.69314 20.5978C1.94289 22.0051 1.54999 23.5752 1.54904 25.17H0.900049C0.781014 25.1699 0.663159 25.1936 0.553309 25.2394C0.443459 25.2853 0.343801 25.3524 0.260096 25.4371C0.176391 25.5217 0.110305 25.6221 0.0656684 25.7325C0.0210317 25.8428 -0.00126705 25.9609 5.5571e-05 26.08C0.0892682 29.5951 1.16582 33.0142 3.10662 35.9464C5.04743 38.8786 7.77413 41.2054 10.975 42.661V45.147C10.975 45.3856 11.0699 45.6146 11.2386 45.7834C11.4074 45.9521 11.6364 46.047 11.8751 46.047H29.692C29.9307 46.047 30.1596 45.9521 30.3284 45.7834C30.4972 45.6146 30.592 45.3856 30.592 45.147V42.665C33.7927 41.2092 36.5191 38.8822 38.4597 35.9501C40.4004 33.018 41.4768 29.599 41.566 26.084C41.5674 25.9649 41.5451 25.8468 41.5004 25.7365C41.4558 25.6261 41.3897 25.5257 41.306 25.4411C41.2223 25.3565 41.1226 25.2893 41.0128 25.2434C40.9029 25.1976 40.7851 25.1739 40.666 25.174H39.976C39.82 21.3924 38.1759 17.8258 35.402 15.251L43.197 3.36196C43.3282 3.16274 43.3749 2.91961 43.3269 2.68598C43.2789 2.45235 43.1401 2.24733 42.941 2.11595ZM11.292 17.249C13.3949 17.2513 15.4113 18.0864 16.9 19.5716C18.3887 21.0568 19.2286 23.0711 19.236 25.174H18.476C18.4537 23.2835 17.6871 21.4779 16.3423 20.149C14.9976 18.82 13.1832 18.0747 11.2925 18.0747C9.4019 18.0747 7.58747 18.82 6.24273 20.149C4.89799 21.4779 4.13134 23.2835 4.10903 25.174H3.34905C3.35619 23.0712 4.1959 21.0569 5.68447 19.5717C7.17304 18.0865 9.18928 17.2513 11.292 17.249ZM30.46 25.174C30.3295 24.0738 29.829 23.0506 29.0406 22.2723C28.2521 21.494 27.2226 21.0067 26.1208 20.8904C25.019 20.7742 23.9104 21.0358 22.9769 21.6324C22.0433 22.2291 21.3403 23.1252 20.983 24.174C20.8976 23.3879 20.7156 22.6154 20.441 21.874C21.2275 20.8287 22.312 20.0461 23.5519 19.6292C24.7917 19.2124 26.1287 19.1807 27.3869 19.5384C28.6451 19.8962 29.7655 20.6265 30.6005 21.6334C31.4356 22.6402 31.9461 23.8763 32.065 25.179L30.46 25.174ZM28.66 25.174H22.555C22.6942 24.4666 23.0746 23.8296 23.6314 23.3717C24.1882 22.9138 24.8867 22.6634 25.6075 22.6634C26.3284 22.6634 27.0269 22.9138 27.5837 23.3717C28.1404 23.8296 28.5209 24.4666 28.66 25.174ZM33.8661 25.174C33.7524 23.5697 33.1734 22.0335 32.1999 20.7533C31.2265 19.4731 29.9008 18.5046 28.3853 17.9663C26.8698 17.428 25.2303 17.3434 23.6674 17.7227C22.1045 18.102 20.6862 18.9288 19.5861 20.102C19.3425 19.7013 19.0704 19.3187 18.772 18.957C19.6483 18.0285 20.7095 17.2942 21.8871 16.8014C23.0648 16.3086 24.3327 16.0683 25.609 16.096C28.0701 16.1 30.4374 17.0409 32.2298 18.7275C34.0222 20.414 35.1053 22.7196 35.259 25.176L33.8661 25.174ZM15.376 25.174C15.376 24.0911 14.9459 23.0525 14.1802 22.2868C13.4145 21.5211 12.3759 21.091 11.2931 21.091C10.2102 21.091 9.17165 21.5211 8.40594 22.2868C7.64023 23.0525 7.21005 24.0911 7.21005 25.174H5.91003C5.92931 23.7594 6.5048 22.4093 7.51193 21.4158C8.51906 20.4223 9.87684 19.8653 11.2915 19.8653C12.7062 19.8653 14.064 20.4223 15.0712 21.4158C16.0783 22.4093 16.6537 23.7594 16.673 25.174H15.376ZM13.576 25.174H9.01205C9.02455 24.5769 9.27051 24.0085 9.6972 23.5906C10.1239 23.1728 10.6973 22.9387 11.2945 22.9387C11.8918 22.9387 12.4652 23.1728 12.8919 23.5906C13.3186 24.0085 13.5646 24.5769 13.5771 25.174H13.576ZM12.7761 44.251V43.132H28.792V44.251H12.7761ZM29.136 41.332H12.436C9.52258 40.1406 6.99281 38.1712 5.12332 35.6389C3.25383 33.1066 2.11663 30.109 1.83605 26.974H39.7281C39.4482 30.1081 38.3122 33.1051 36.4441 35.6373C34.5761 38.1695 32.048 40.1395 29.136 41.332ZM38.178 25.174H37.0601C36.9048 22.2401 35.6312 19.4773 33.5013 17.4538C31.3713 15.4303 28.547 14.2998 25.609 14.295C24.0957 14.2643 22.5927 14.55 21.1962 15.1338C19.7996 15.7176 18.5404 16.5865 17.499 17.685C17.2087 17.4481 16.9052 17.2277 16.5901 17.025C17.7218 15.7645 19.1155 14.7668 20.6734 14.1017C22.2314 13.4367 23.9159 13.1204 25.609 13.175C28.8438 13.1792 31.9531 14.4275 34.2929 16.6611C36.6327 18.8948 38.0237 21.9428 38.178 25.174Z" fill="currentColor"/>\n    <path d="M3.39209 30.1722C4.045 32.6025 5.31628 34.8222 7.08209 36.6152C7.16443 36.7021 7.26327 36.7717 7.37286 36.8199C7.48244 36.8682 7.60056 36.8941 7.72027 36.8961C7.83999 36.8981 7.95888 36.8762 8.07003 36.8317C8.18118 36.7872 8.28235 36.7209 8.36758 36.6368C8.45281 36.5528 8.52038 36.4525 8.56637 36.342C8.61237 36.2314 8.63585 36.1128 8.63543 35.9931C8.63501 35.8733 8.6107 35.7549 8.56393 35.6447C8.51716 35.5344 8.44888 35.4347 8.36306 35.3512C6.81633 33.7796 5.70257 31.8346 5.13006 29.7052C5.1013 29.589 5.04966 29.4797 4.97815 29.3837C4.90663 29.2878 4.81669 29.207 4.71359 29.1462C4.61049 29.0854 4.49631 29.0458 4.37771 29.0297C4.25912 29.0136 4.1385 29.0213 4.02291 29.0523C3.90733 29.0834 3.7991 29.1372 3.70456 29.2106C3.61001 29.284 3.53106 29.3755 3.47232 29.4798C3.41357 29.584 3.3762 29.699 3.36242 29.8179C3.34865 29.9368 3.35875 30.0572 3.39209 30.1722Z" fill="#323232"/>\n    <path d="M10.5356 39.5502C10.7282 39.6767 10.962 39.7245 11.1889 39.6838C11.4157 39.643 11.6182 39.5168 11.7547 39.3312C11.8913 39.1456 11.9514 38.9146 11.9227 38.6859C11.8941 38.4573 11.7788 38.2483 11.6006 38.1022L10.3336 37.1752C10.1407 37.0392 9.90209 36.9844 9.66918 37.0226C9.43627 37.0609 9.2277 37.1891 9.08843 37.3797C8.94915 37.5702 8.89031 37.8079 8.92458 38.0414C8.95884 38.2749 9.08345 38.4857 9.27159 38.6282L10.5356 39.5502Z" fill="#323232"/>\n    </g>\n    <defs>\n    <clipPath id="clip0_598_8219">\n    <rect width="43.348" height="46.051" fill="white"/>\n    </clipPath>\n    </defs>\n    </svg>'};class Ae{constructor(n){this._state=n,this.search=!1,this.icons=zi,this.filters=this._state.filters,this.setFilters=t=>this._state.setFilters(t),this.categories=this._state.categories}toggleCategory(n){var t=this;return(0,m.Z)(function*(){const{categories:i}=yield t.filters.pipe((0,I.q)(1)).toPromise();i.includes(n)?t.setFilters({categories:i.filter(_=>_!==n)}):t.setFilters({categories:[...i,n]})})()}toggleTag(n){var t=this;return(0,m.Z)(function*(){const{tags:i}=yield t.filters.pipe((0,I.q)(1)).toPromise();i.includes(n)?t.setFilters({tags:i.filter(_=>_!==n)}):t.setFilters({tags:[...i,n]})})()}}function Vi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.displayed=null)}),e.SDv(1,25),e.qZA()}}Ae.\u0275fac=function(n){return new(n||Ae)(e.Y36(G))},Ae.\u0275cmp=e.Xpm({type:Ae,selectors:[["catering-item-filters"]],inputs:{search:"search"},decls:10,vars:13,consts:function(){let o;return o=$localize`:␟24300e769843b029b0346b3ea18e51e4e97a3502␟3888583854485349732: Catergories `,[[1,"px-4","mt-3","mb-2"],["appearance","outline",1,"w-full","h-14"],["matPrefix","",1,"text-xl"],["matInput","","placeholder","Search menu...",3,"ngModel","ngModelChange"],["class","hidden sm:block font-medium px-2 py-4",4,"ngIf"],[1,"flex","flex-col","px-2","space-y-4"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[1,"hidden","sm:block","font-medium","px-2","py-4"],o,[3,"ngModel","ngModelChange"]]},template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"app-icon",2),e._uU(3,"search"),e.qZA(),e.TgZ(4,"input",3),e.NdJ("ngModelChange",function(_){return t.setFilters({search:_})}),e.ALo(5,"async"),e.qZA()()(),e.YNc(6,Hi,2,0,"h3",4),e.TgZ(7,"div",5),e.YNc(8,Xi,3,5,"mat-checkbox",6),e.ALo(9,"async"),e.qZA()),2&n){let i;e.ekj("sm:hidden",!t.search),e.xp6(4),e.Q6J("ngModel",null==(i=e.lcZ(5,9,t.filters))?null:i.search),e.xp6(2),e.Q6J("ngIf",!t.search),e.xp6(1),e.ekj("sm:hidden",t.search)("sm:pt-1",!t.search),e.xp6(1),e.Q6J("ngForOf",e.lcZ(9,11,t.categories))}},dependencies:[l.sg,l.O5,R.oG,c.Fj,c.JJ,c.On,T.o,S.KE,S.qo,D.Nt,l.Ov],styles:["[_nghost-%COMP%]{min-width:16rem}"]});const e_=[];class be{constructor(n,t,i,_){this._settings=n,this._order=t,this._org=i,this._data=_,this.displayed=null,this.selected=[...this._data[0]||[]],this._order.setFilters(this._data[1])}get favorites(){return this._settings.get("favourite_menu_items")||e_}get selected_ids(){return this.selected.map(n=>n.custom_id).join(",")}get count(){return this.selected.reduce((n,t)=>n+t.quantity,0)}get code(){return this._org.currency_code}isSelected(n){return n&&this.selected_ids.includes(n)}setSelected(n,t){const i=this.selected.filter(_=>_.custom_id!==n.custom_id);if(t){const _=new M.U(n);i.push(_),this.displayed=_}this.selected=i}toggleFavourite(n){const t=this.favorites;t.includes(n.id)?this._settings.saveUserSetting("favourite_menu_items",t.filter(_=>_!==n.id)):this._settings.saveUserSetting("favourite_menu_items",[...t,n.id])}}function t_(o,n){if(1&o&&e._UZ(0,"img",16),2&o){const t=e.oxw().$implicit;e.Q6J("src",t.images[0],e.LSH)}}function n_(o,n){1&o&&e._UZ(0,"img",17)}function o_(o,n){if(1&o&&(e.TgZ(0,"span",18),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("matTooltip",i.optionList(t)),e.xp6(1),e.hij(" ",t.option_list.length," option(s) ")}}function i_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5),e.YNc(2,t_,1,1,"img",6),e.YNc(3,n_,1,0,"ng-template",null,7,e.W1O),e.qZA(),e.TgZ(5,"div",8)(6,"div",9),e._uU(7),e.YNc(8,o_,2,2,"span",10),e.qZA(),e.TgZ(9,"div"),e._uU(10),e.qZA(),e.TgZ(11,"div",11)(12,"button",12),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.addItems(s))}),e.TgZ(13,"div",13)(14,"app-icon"),e._uU(15,"edit"),e.qZA(),e._uU(16," Change "),e.qZA()(),e.TgZ(17,"button",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.removeItem(s))}),e.TgZ(18,"div",13)(19,"app-icon"),e._uU(20,"close"),e.qZA(),e._uU(21," Remove "),e.qZA()()()(),e.TgZ(22,"button",15),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.toggleFavourite(s))}),e.TgZ(23,"app-icon"),e._uU(24),e.qZA()()()}if(2&o){const t=n.$implicit,i=e.MAs(4),_=e.oxw();e.xp6(2),e.Q6J("ngIf",null==t.images?null:t.images.length)("ngIfElse",i),e.xp6(5),e.hij(" ",t.name||"Item"," "),e.xp6(1),e.Q6J("ngIf",t.option_list.length),e.xp6(2),e.hij("",t.quantity," requested"),e.xp6(12),e.ekj("text-blue-400",_.favorites.includes(t.id)),e.xp6(2),e.Oqu(_.favorites.includes(t.id)?"favorite":"favorite_border")}}be.\u0275fac=function(n){return new(n||be)(e.Y36(p.gb),e.Y36(G),e.Y36(A.w7),e.Y36(v.WI))},be.\u0275cmp=e.Xpm({type:be,selectors:[["new-catering-order-modal"]],decls:32,vars:25,consts:function(){let o,n,t,i,_;return o=$localize`:␟737cdc02079fb61b2944ecf62f908ab35efb2d5a␟2076287131803615740:Add Catering`,n=$localize`:␟30d3439b0e0095fe69503245f3bd7a2e9498be7c␟8443571736703532556: View List `,t=$localize`:␟18843b85d1a4f17fefafd07bc5cde636dca44295␟819716823718458903:Back to form`,i=$localize`:␟523976668707aada89243171aa2abc1402656c5b␟4024487187516268099: ${"\ufffd0\ufffd"}:INTERPOLATION: items(s) added `,_=$localize`:␟ccda1d41ca79703a85a3a598c1d97e040a32b766␟874721418273731876: Back `,[[1,"w-[100vw]","h-[100vh]","sm:relative","sm:w-auto","sm:h-auto","flex","flex-col","bg-white","dark:bg-neutral-700"],[1,"flex","items-center","space-x-4","w-full"],["icon","","matRipple","",1,"bg-black/20",3,"mat-dialog-close"],o,[1,"flex-1","flex","items-center","divide-x","divide-gray-200","dark:divide-neutral-500","min-h-[65vh]","h-[65vh]","sm:max-h-[65vh]","sm:max-w-[95vw]","w-full","overflow-hidden"],[1,"h-full","hidden","sm:block","sm:max-w-[12rem]","sm:h-[65vh]","sm:max-h-full"],[1,"flex","flex-col","items-center","flex-1","w-1/2","h-full","sm:h-[65vh]"],[1,"w-full","border-b","border-gray-200","dark:border-neutral-500",3,"search"],[1,"flex-1","h-1/2","w-full","overflow-hidden",3,"active","selected","selected_items","favorites","toggleFav","onSelect"],[1,"h-full","w-full","sm:h-[65vh]","absolute","sm:relative","sm:flex","sm:max-w-[16rem]","z-20","bg-white","dark:bg-neutral-700",3,"item","active","code","fav","activeChange","toggleFav","close"],[1,"flex","sm:hidden","flex-col-reverse","items-center","justify-end","p-2","border-t","border-gray-200","dark:border-neutral-500","w-full"],["btn","","matRipple","","back-btn","","class","inverse sm:hidden w-full sm:w-auto",3,"click",4,"ngIf"],["btn","","matRipple","","save","",1,"w-full","sm:w-auto","sm:mb-0",3,"mat-dialog-close"],n,[1,"hidden","sm:flex","items-center","justify-between","p-2","border-t","border-gray-200","dark:border-neutral-500","w-full"],["btn","","matRipple","",1,"clear","text-primary",3,"mat-dialog-close"],[1,"flex","items-center"],[1,"text-xl"],[1,"mr-1","underline"],t,[1,"opacity-60","text-sm"],i,["btn","","matRipple","",3,"disabled","click"],[1,"mr-1"],["btn","","matRipple","","back-btn","",1,"inverse","sm:hidden","w-full","sm:w-auto",3,"click"],_]},template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"header",1)(2,"button",2)(3,"app-icon"),e._uU(4,"close"),e.qZA()(),e.TgZ(5,"h3"),e.SDv(6,3),e.qZA()(),e.TgZ(7,"main",4),e._UZ(8,"catering-item-filters",5),e.TgZ(9,"div",6),e._UZ(10,"catering-item-filters",7),e.TgZ(11,"catering-item-list",8),e.NdJ("toggleFav",function(_){return t.toggleFavourite(_)})("onSelect",function(_){return t.displayed=_}),e.qZA()(),e.TgZ(12,"catering-item-details",9),e.NdJ("activeChange",function(_){return t.setSelected(t.displayed,_)})("toggleFav",function(){return t.toggleFavourite(t.displayed)})("close",function(){return t.displayed=null}),e.qZA()(),e.TgZ(13,"footer",10),e.YNc(14,Vi,2,0,"button",11),e.TgZ(15,"button",12),e.SDv(16,13),e.qZA()(),e.TgZ(17,"footer",14)(18,"button",15)(19,"div",16)(20,"app-icon",17),e._uU(21,"arrow_back"),e.qZA(),e.TgZ(22,"div",18),e.SDv(23,19),e.qZA()()(),e.TgZ(24,"p",20),e.SDv(25,21),e.qZA(),e.TgZ(26,"button",22),e.NdJ("click",function(){return t.setSelected(t.displayed,!t.isSelected(null==t.displayed?null:t.displayed.custom_id))}),e.TgZ(27,"div",16)(28,"app-icon",17),e._uU(29),e.qZA(),e.TgZ(30,"div",23),e._uU(31),e.qZA()()()()()),2&n&&(e.xp6(2),e.Q6J("mat-dialog-close",t.selected),e.xp6(8),e.Q6J("search",!0),e.xp6(1),e.Q6J("active",null==t.displayed?null:t.displayed.custom_id)("selected",t.selected_ids)("selected_items",t.selected)("favorites",t.favorites),e.xp6(1),e.ekj("hidden",!t.displayed)("inset-0",t.displayed),e.Q6J("item",t.displayed)("active",t.selected_ids.includes((null==t.displayed?null:t.displayed.custom_id)||""))("code",t.code)("fav",!!t.displayed&&t.favorites.includes((null==t.displayed?null:t.displayed.id)||"")),e.xp6(2),e.Q6J("ngIf",t.displayed),e.xp6(1),e.ekj("mb-2",t.displayed),e.Q6J("mat-dialog-close",t.selected),e.xp6(3),e.Q6J("mat-dialog-close",t.selected),e.xp6(7),e.pQV(t.count),e.QtT(25),e.xp6(1),e.ekj("inverse",t.isSelected(null==t.displayed?null:t.displayed.custom_id)),e.Q6J("disabled",!t.displayed),e.xp6(3),e.Oqu(t.isSelected(null==t.displayed?null:t.displayed.custom_id)?"remove":"add"),e.xp6(2),e.hij(" ",t.isSelected(null==t.displayed?null:t.displayed.custom_id)?"Remove from Booking":"Add to booking"," "))},dependencies:[l.O5,v.ZT,T.o,Ee,Se,Ae]});const __=[];class V{constructor(n,t){this._settings=n,this._dialog=t,this.options={},this.items=[],this.disabled=!1,this.selected=[],this.registerOnChange=i=>this._onChange=i,this.registerOnTouched=i=>this._onTouch=i,this.setDisabledState=i=>this.disabled=i}get favorites(){return this._settings.get("favourite_menu_items")||__}setValue(n){this.items=n,this._onChange&&this._onChange(this.items)}writeValue(n){this.items=n||[]}removeItem(n){const t=this.items.filter(i=>i.id!==n.id);this.setValue(t)}addItems(n){this._dialog.open(be,{data:[this.items,this.options]}).afterClosed().subscribe(i=>{!i||this.setValue(i)})}optionList(n){return n.option_list.map(t=>t.name).join("\n")}toggleFavourite(n){const t=this.favorites;t.includes(n.id)?this._settings.saveUserSetting("favourite_menu_items",t.filter(_=>_!==n.id)):this._settings.saveUserSetting("favourite_menu_items",[...t,n.id])}}V.\u0275fac=function(n){return new(n||V)(e.Y36(p.gb),e.Y36(v.uw))},V.\u0275cmp=e.Xpm({type:V,selectors:[["catering-list-field"]],inputs:{options:"options"},features:[e._Bn([{provide:c.JU,useExisting:(0,e.Gpc)(()=>V),multi:!0}])],decls:8,vars:2,consts:[["list","",1,"space-y-2"],["space","","class","relative p-2 rounded-lg w-full flex items-center shadow border border-gray-200",4,"ngFor","ngForOf"],["btn","","matRipple","","add-space","",1,"w-full","inverse","mt-2",3,"disabled","click"],[1,"flex","items-center","justify-center","space-x-2"],["space","",1,"relative","p-2","rounded-lg","w-full","flex","items-center","shadow","border","border-gray-200"],[1,"w-16","h-16","rounded-xl","bg-black/20","mr-4","overflow-hidden","flex","items-center","justify-center"],["class","object-cover min-h-full min-w-full",3,"src",4,"ngIf","ngIfElse"],["placeholder",""],[1,"pb-4"],[1,"font-medium","flex","items-center"],["class","text-xs opacity-60 ml-4 font-normal",3,"matTooltip",4,"ngIf"],[1,"absolute","bottom-0","right-0","flex","items-center","justify-end","text-xs"],["btn","","matRipple","","edit","",1,"clear",3,"click"],[1,"flex","items-center","space-x-2"],["btn","","matRipple","","remove","",1,"clear",3,"click"],["icon","","matRipple","","fav","",1,"absolute","top-1","right-1",3,"click"],[1,"object-cover","min-h-full","min-w-full",3,"src"],["src","assets/icons/catering-placeholder.svg",1,"m-auto"],[1,"text-xs","opacity-60","ml-4","font-normal",3,"matTooltip"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,i_,25,8,"div",1),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return t.addItems()}),e.TgZ(3,"div",3)(4,"app-icon"),e._uU(5,"search"),e.qZA(),e.TgZ(6,"span"),e._uU(7,"Add Item"),e.qZA()()()),2&n&&(e.xp6(1),e.Q6J("ngForOf",t.items),e.xp6(1),e.Q6J("disabled",t.disabled))},dependencies:[l.sg,l.O5,H.gM,T.o]});var s_=d(8840);function a_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.toggleRoom(s.id))}),e.TgZ(1,"td"),e._UZ(2,"mat-checkbox",15),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",16)(6,"span",17),e.ALo(7,"async"),e.ALo(8,"async"),e._uU(9),e.ALo(10,"async"),e.qZA()()()}if(2&o){const t=n.$implicit,i=e.oxw(2);let _,s,a;e.xp6(2),e.Q6J("checked",i.selected.includes(t.id)),e.xp6(2),e.Oqu(t.display_name||t.name),e.xp6(2),e.ekj("bg-green-600",!(null!=(_=e.lcZ(7,7,i.availability))&&_.includes(t.id)))("bg-red-600",null==(s=e.lcZ(8,9,i.availability))?null:s.includes(t.id)),e.xp6(3),e.hij(" ",null!=(a=e.lcZ(10,11,i.availability))&&a.includes(t.id)?"Disabled":"Enabled"," ")}}function l_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"main",7)(1,"table",8)(2,"thead",9)(3,"tr")(4,"td",10),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.toggleRoom("*"))}),e._UZ(5,"mat-checkbox",11),e.ALo(6,"async"),e.ALo(7,"async"),e.qZA(),e._UZ(8,"td"),e.TgZ(9,"td",12),e._uU(10),e.ALo(11,"async"),e.qZA()()(),e.TgZ(12,"tbody"),e.YNc(13,a_,11,13,"tr",13),e.ALo(14,"async"),e.qZA()()()}if(2&o){const t=e.oxw();let i,_,s;e.xp6(5),e.Q6J("checked",(null==(i=e.lcZ(6,4,t.rooms))?null:i.length)===t.selected.length)("indeterminate",t.selected.length>0&&(null==(_=e.lcZ(7,6,t.rooms))?null:_.length)!==t.selected.length),e.xp6(5),e.hij(" ",null==(s=e.lcZ(11,8,t.rooms))?null:s.length," Room(s) "),e.xp6(3),e.Q6J("ngForOf",e.lcZ(14,10,t.rooms))}}function r_(o,n){1&o&&(e.TgZ(0,"main",18),e._UZ(1,"mat-spinner",19),e.TgZ(2,"p"),e._uU(3,"Saving disabled room list..."),e.qZA()())}class Ge{constructor(n,t){this._catering=n,this._org=t,this.loading=!1,this.selected=[],this.rooms=(0,s_.u)(this._org.building.id),this.availability=this._catering.availability}toggleRoom(n){var t=this;return(0,m.Z)(function*(){if("*"===n){const i=yield t.rooms.pipe((0,I.q)(1)).toPromise();t.selected=t.selected.length!==i.length?i.map(_=>_.id):[]}else t.selected=t.selected.includes(n)?t.selected.filter(i=>i!==n):[...t.selected,n]})()}enableSelected(){var n=this;return(0,m.Z)(function*(){n.loading=!0;const i=(yield n.availability.pipe((0,I.q)(1)).toPromise()).filter(_=>!n.selected.includes(_));yield n._catering.saveSettings({disabled_rooms:i}).catch(()=>null),n.loading=!1})()}disableSelected(){var n=this;return(0,m.Z)(function*(){const t=yield n.availability.pipe((0,I.q)(1)).toPromise(),i=(0,p.Tw)(t.concat(n.selected));yield n._catering.saveSettings({disabled_rooms:i}).catch(()=>null),n.loading=!1})()}}function c_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"mat-form-field",7)(2,"input",8),e.NdJ("ngModelChange",function(_){const a=e.CHM(t).index,r=e.oxw(2);return e.KtG(r.charge_codes[a]=_)}),e.qZA()(),e.TgZ(3,"button",9),e.NdJ("click",function(){const s=e.CHM(t).index,a=e.oxw(2);return e.KtG(a.removeCode(s))}),e.TgZ(4,"app-icon"),e._uU(5,"delete"),e.qZA()()()}if(2&o){const t=n.index,i=e.oxw(2);e.xp6(2),e.Q6J("ngModel",i.charge_codes[t])}}function d_(o,n){if(1&o&&(e.TgZ(0,"main",4),e.YNc(1,c_,6,1,"div",5),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.charge_codes)("ngForTrackBy",t.trackByFn)}}function p_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"footer",10)(1,"button",11),e._uU(2," Import Codes "),e.TgZ(3,"input",12),e.NdJ("change",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.addCodesFromFile(_))}),e.qZA()(),e.TgZ(4,"button",13),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.newCode())}),e._uU(5," Add Code "),e.qZA(),e.TgZ(6,"button",13),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.saveChargeCodes())}),e._uU(7," Save Changes "),e.qZA()()}}function u_(o,n){1&o&&(e.TgZ(0,"main",14),e._UZ(1,"mat-spinner",15),e.TgZ(2,"p"),e._uU(3,"Saving changes to charge codes..."),e.qZA()())}Ge.\u0275fac=function(n){return new(n||Ge)(e.Y36(K),e.Y36(A.w7))},Ge.\u0275cmp=e.Xpm({type:Ge,selectors:[["catering-rooms-state-modal"]],decls:15,vars:2,consts:[[1,"flex","items-center","justify-between","p-2"],[1,"p-2"],["icon","","mat-dialog-close",""],["class","max-h-[65vh] overflow-auto",4,"ngIf","ngIfElse"],[1,"flex","items-center","p-2","justify-end","space-x-2","border-t","border-gray-200","dark:border-neutral-500"],["btn","","matRipple","",3,"click"],["load_state",""],[1,"max-h-[65vh]","overflow-auto"],[1,"min-w-[32rem]"],[1,"border-b","border-gray-200","dark:border-neutral-500"],[1,"w-12",3,"click"],[1,"pointer-events-none",3,"checked","indeterminate"],[1,"text-right","text-xs"],["class","hover:bg-black/10 dark:hover:bg-white/5",3,"click",4,"ngFor","ngForOf"],[1,"hover:bg-black/10","dark:hover:bg-white/5",3,"click"],[1,"pointer-events-none",3,"checked"],[1,"text-right"],[1,"px-2","py-1","rounded-2xl"],[1,"w-64","h-48","p-8","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div")(1,"header",0)(2,"h3",1),e._uU(3,"Set Catering Availability for Rooms"),e.qZA(),e.TgZ(4,"button",2)(5,"app-icon"),e._uU(6,"close"),e.qZA()()(),e.YNc(7,l_,15,12,"main",3),e.TgZ(8,"footer",4)(9,"button",5),e.NdJ("click",function(){return t.enableSelected()}),e._uU(10," Enable Selected "),e.qZA(),e.TgZ(11,"button",5),e.NdJ("click",function(){return t.disableSelected()}),e._uU(12," Disable Selected "),e.qZA()()(),e.YNc(13,r_,4,0,"ng-template",null,6,e.W1O)),2&n){const i=e.MAs(14);e.xp6(7),e.Q6J("ngIf",!t.loading)("ngIfElse",i)}},dependencies:[l.sg,l.O5,v.ZT,R.oG,T.o,w.Ou,l.Ov],styles:["td[_ngcontent-%COMP%]{padding:.5rem}"]});class Je{constructor(n,t){this._state=n,this._dialog_ref=t,this.charge_codes=[],this.loading=!1}ngOnInit(){var n=this;return(0,m.Z)(function*(){n.charge_codes=(yield n._state.charge_codes.pipe((0,I.q)(1)).toPromise())||[]})()}newCode(){this.charge_codes.push("")}removeCode(n){this.charge_codes.splice(n,1)}addCodesFromFile(n){if(n.target){const t=n.target.files[0];if(t){const i=new FileReader;i.readAsText(t,"UTF-8"),i.addEventListener("load",_=>{const s=(0,p.n5)(_.srcElement.result)||[];for(const{code:a}of s)this.charge_codes.push(a);this.charge_codes=(0,p.Tw)(this.charge_codes),n.target.value=""}),i.addEventListener("error",_=>(0,p.cB)("Error reading file."))}}}saveChargeCodes(){var n=this;return(0,m.Z)(function*(){n.loading=!0;const t=n.charge_codes.filter(i=>i&&i.trim());yield n._state.saveSettings({charge_codes:t}),n._dialog_ref.close()})()}trackByFn(n,t){return n}}Je.\u0275fac=function(n){return new(n||Je)(e.Y36(K),e.Y36(v.so))},Je.\u0275cmp=e.Xpm({type:Je,selectors:[["charge-code-list-modal"]],decls:10,vars:3,consts:[["icon","","mat-dialog-close",""],["class","overflow-auto max-h-[65vh] min-h-[20rem] flex flex-col",4,"ngIf","ngIfElse"],["class","flex items-center p-2 space-x-2 border-t border-gray-200",4,"ngIf"],["load_state",""],[1,"overflow-auto","max-h-[65vh]","min-h-[20rem]","flex","flex-col"],["class","flex items-center space-x-2 w-full hover:bg-black/10 px-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","space-x-2","w-full","hover:bg-black/10","px-2"],["appearance","outline",1,"h-14","flex-1"],["matInput","","placeholder","Charge Code",3,"ngModel","ngModelChange"],["icon","",3,"click"],[1,"flex","items-center","p-2","space-x-2","border-t","border-gray-200"],["btn","","matRipple","",1,"w-48","inverse","relative"],["type","file",1,"opacity-0","absolute","inset-0",3,"change"],["btn","","matRipple","",1,"w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-20","space-y-2"],["diameter","32"]],template:function(n,t){if(1&n&&(e.TgZ(0,"header")(1,"h2"),e._uU(2,"Edit Charge Codes"),e.qZA(),e.TgZ(3,"button",0)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.YNc(6,d_,2,2,"main",1),e.YNc(7,p_,8,0,"footer",2),e.YNc(8,u_,4,0,"ng-template",null,3,e.W1O)),2&n){const i=e.MAs(9);e.xp6(6),e.Q6J("ngIf",!t.loading)("ngIfElse",i),e.xp6(1),e.Q6J("ngIf",!t.loading)}},dependencies:[l.sg,l.O5,v.ZT,c.Fj,c.JJ,c.On,T.o,S.KE,D.Nt,w.Ou]});class Fe{}Fe.\u0275fac=function(n){return new(n||Fe)},Fe.\u0275mod=e.oAB({type:Fe}),Fe.\u0275inj=e.cJS({imports:[l.ez,U.Tx,Le.Nh,De.Bb,v.Is,R.p9,qe.Fk,H.AV,c.u5,c.UX,Jn.K,S.lN,tn.W9]});var g_=d(4187),m_=d(6012);function f_(o,n){1&o&&e._UZ(0,"topbar")}function h_(o,n){1&o&&e._UZ(0,"footer-menu",4)}class Ye{get hide_nav(){return"true"===localStorage.getItem("PlaceOS.hide_nav")}}Ye.\u0275fac=function(n){return new(n||Ye)},Ye.\u0275cmp=e.Xpm({type:Ye,selectors:[["placeos-book"]],decls:5,vars:2,consts:[[4,"ngIf"],[1,"flex-1","flex","sm:flex-row","flex-col-reverse","h-1/2"],[1,"flex","flex-col","flex-1","h-1/2","sm:h-auto","overflow-hidden"],["class","z-10",4,"ngIf"],[1,"z-10"]],template:function(n,t){1&n&&(e.YNc(0,f_,1,0,"topbar",0),e.TgZ(1,"div",1)(2,"main",2),e._UZ(3,"router-outlet"),e.qZA()(),e.YNc(4,h_,1,0,"footer-menu",3)),2&n&&(e.Q6J("ngIf",!t.hide_nav),e.xp6(4),e.Q6J("ngIf",!t.hide_nav))},dependencies:[l.O5,g_.o,m_.i,x.lC],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}"]});var k=d(1299),It=d(9756);const C_=(()=>{class o{constructor(t,i,_,s,a){this._legacyCanvasSize=o.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=t,this.$canvas=document.createElement("canvas"),_&&"object"==typeof _?this._onDecode=i:(console.warn(_||s||a?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=i),this._onDecodeError=(i="object"==typeof _?_:{}).onDecodeError||("function"==typeof _?_:this._onDecodeError),this._calculateScanRegion=i.calculateScanRegion||("function"==typeof s?s:this._calculateScanRegion),this._preferredCamera=i.preferredCamera||a||this._preferredCamera,this._legacyCanvasSize="number"==typeof _?_:"number"==typeof s?s:this._legacyCanvasSize,this._maxScansPerSecond=i.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;let r=!1;if(t.hidden&&(t.hidden=!1,r=!0),document.body.contains(t)||(document.body.appendChild(t),r=!0),_=t.parentElement,i.highlightScanRegion||i.highlightCodeOutline){if(s=!!i.overlay,this.$overlay=i.overlay||document.createElement("div"),(a=this.$overlay.style).position="absolute",a.display="none",a.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!s&&i.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}_.insertBefore(this.$overlay,this.$video.nextSibling)}i.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame(()=>{let u=window.getComputedStyle(t);"none"===u.display&&(t.style.setProperty("display","block","important"),r=!0),"visible"!==u.visibility&&(t.style.setProperty("visibility","visible","important"),r=!0),r&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=o.createQrEngine()}static set WORKER_PATH(t){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static hasCamera(){return(0,m.Z)(function*(){try{return!!(yield o.listCameras(!1)).length}catch{return!1}})()}static listCameras(t=!1){return(0,m.Z)(function*(){if(!navigator.mediaDevices)return[];let _,i=function(){var s=(0,m.Z)(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(a=>"videoinput"===a.kind)});return function(){return s.apply(this,arguments)}}();try{t&&(yield i()).every(s=>!s.label)&&(_=yield navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(yield i()).map((s,a)=>({id:s.deviceId,label:s.label||(0===a?"Default Camera":`Camera ${a+1}`)}))}finally{_&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),o._stopVideoStream(_))}})()}hasFlash(){var t=this;return(0,m.Z)(function*(){let i;try{if(t.$video.srcObject){if(!(t.$video.srcObject instanceof MediaStream))return!1;i=t.$video.srcObject}else i=(yield t._getCameraStream()).stream;return"torch"in i.getVideoTracks()[0].getSettings()}catch{return!1}finally{i&&i!==t.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),o._stopVideoStream(i))}})()}isFlashOn(){return this._flashOn}toggleFlash(){var t=this;return(0,m.Z)(function*(){t._flashOn?yield t.turnFlashOff():yield t.turnFlashOn()})()}turnFlashOn(){var t=this;return(0,m.Z)(function*(){if(!t._flashOn&&!t._destroyed&&(t._flashOn=!0,t._active&&!t._paused))try{if(!(yield t.hasFlash()))throw"No flash available";yield t.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(i){throw t._flashOn=!1,i}})()}turnFlashOff(){var t=this;return(0,m.Z)(function*(){t._flashOn&&(t._flashOn=!1,yield t._restartVideoStream())})()}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),o._postWorkerMessage(this._qrEnginePromise,"close")}start(){var t=this;return(0,m.Z)(function*(){if(t._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!t._active||t._paused)&&("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),t._active=!0,!document.hidden))if(t._paused=!1,t.$video.srcObject)yield t.$video.play();else try{let{stream:i,facingMode:_}=yield t._getCameraStream();!t._active||t._paused?o._stopVideoStream(i):(t._setVideoMirror(_),t.$video.srcObject=i,yield t.$video.play(),t._flashOn&&(t._flashOn=!1,t.turnFlashOn().catch(()=>{})))}catch(i){if(!t._paused)throw t._active=!1,i}})()}stop(){this.pause(),this._active=!1}pause(t=!1){var i=this;return(0,m.Z)(function*(){if(i._paused=!0,!i._active)return!0;i.$video.pause(),i.$overlay&&(i.$overlay.style.display="none");let _=()=>{i.$video.srcObject instanceof MediaStream&&(o._stopVideoStream(i.$video.srcObject),i.$video.srcObject=null)};return t?(_(),!0):(yield new Promise(s=>setTimeout(s,300)),!!i._paused&&(_(),!0))})()}setCamera(t){var i=this;return(0,m.Z)(function*(){t!==i._preferredCamera&&(i._preferredCamera=t,yield i._restartVideoStream())})()}static scanImage(t,i,_,s,a=!1,r=!1){return(0,m.Z)(function*(){let u,g=!1;i&&("scanRegion"in i||"qrEngine"in i||"canvas"in i||"disallowCanvasResizing"in i||"alsoTryWithoutScanRegion"in i||"returnDetailedScanResult"in i)?(u=i.scanRegion,_=i.qrEngine,s=i.canvas,a=i.disallowCanvasResizing||!1,r=i.alsoTryWithoutScanRegion||!1,g=!0):console.warn(i||_||s||a||r?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),i=!!_;try{let h,b,y;if([_,h]=yield Promise.all([_||o.createQrEngine(),o._loadImage(t)]),[s,b]=o._drawToCanvas(h,u,s,a),_ instanceof Worker){let f=_;i||o._postWorkerMessageSync(f,"inversionMode","both"),y=yield new Promise((O,ne)=>{let wt,ye,Y,Ut=-1;ye=Q=>{Q.data.id===Ut&&(f.removeEventListener("message",ye),f.removeEventListener("error",Y),clearTimeout(wt),null!==Q.data.data?O({data:Q.data.data,cornerPoints:o._convertPoints(Q.data.cornerPoints,u)}):ne(o.NO_QR_CODE_FOUND))},Y=Q=>{f.removeEventListener("message",ye),f.removeEventListener("error",Y),clearTimeout(wt),ne("Scanner error: "+(Q?Q.message||Q:"Unknown Error"))},f.addEventListener("message",ye),f.addEventListener("error",Y),wt=setTimeout(()=>Y("timeout"),1e4);let Mt=b.getImageData(0,0,s.width,s.height);Ut=o._postWorkerMessageSync(f,"decode",Mt,[Mt.data.buffer])})}else y=yield Promise.race([new Promise((f,O)=>window.setTimeout(()=>O("Scanner error: timeout"),1e4)),(0,m.Z)(function*(){try{var[f]=yield _.detect(s);if(!f)throw o.NO_QR_CODE_FOUND;return{data:f.rawValue,cornerPoints:o._convertPoints(f.cornerPoints,u)}}catch(O){if(/not implemented|service unavailable/.test(f=O.message||O))return o._disableBarcodeDetector=!0,o.scanImage(t,{scanRegion:u,canvas:s,disallowCanvasResizing:a,alsoTryWithoutScanRegion:r});throw`Scanner error: ${f}`}})()]);return g?y:y.data}catch(h){if(!u||!r)throw h;let b=yield o.scanImage(t,{qrEngine:_,canvas:s,disallowCanvasResizing:a});return g?b:b.data}finally{i||o._postWorkerMessage(_,"close")}})()}setGrayscaleWeights(t,i,_,s=!0){o._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:i,blue:_,useIntegerApproximation:s})}setInversionMode(t){o._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}static createQrEngine(t){return(0,m.Z)(function*(){if(t&&console.warn("Specifying a worker path is not required and not supported anymore."),t=()=>d.e(920).then(d.bind(d,6920)).then(_=>_.createWorker()),o._disableBarcodeDetector||!("BarcodeDetector"in window)||!BarcodeDetector.getSupportedFormats||!(yield BarcodeDetector.getSupportedFormats()).includes("qr_code"))return t();let i=navigator.userAgentData;return i&&i.brands.some(({brand:_})=>/Chromium/i.test(_))&&/mac ?OS/i.test(i.platform)&&(yield i.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:_,platformVersion:s})=>/arm/i.test(_||"arm")&&13<=parseInt(s||"13")).catch(()=>!0))?t():new BarcodeDetector({formats:["qr_code"]})})()}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(t){let i=Math.round(.6666666666666666*Math.min(t.videoWidth,t.videoHeight));return{x:Math.round((t.videoWidth-i)/2),y:Math.round((t.videoHeight-i)/2),width:i,height:i,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var t=this.$video,i=t.videoWidth,_=t.videoHeight,s=t.offsetWidth,a=t.offsetHeight,r=t.offsetLeft,u=t.offsetTop,g=window.getComputedStyle(t),h=g.objectFit,b=i/_,y=s/a;switch(h){case"none":var f=i,O=_;break;case"fill":f=s,O=a;break;default:("cover"===h?b>y:b<y)?f=(O=a)*b:O=(f=s)/b,"scale-down"===h&&(f=Math.min(f,i),O=Math.min(O,_))}var[ne,wt]=g.objectPosition.split(" ").map((Y,Ut)=>{const Mt=parseFloat(Y);return Y.endsWith("%")?(Ut?a-O:s-f)*Mt/100:Mt});y=this._scanRegion.height||_,h=this._scanRegion.x||0;var ye=this._scanRegion.y||0;(b=this.$overlay.style).width=(g=this._scanRegion.width||i)/i*f+"px",b.height=y/_*O+"px",b.top=`${u+wt+ye/_*O}px`,_=/scaleX\(-1\)/.test(t.style.transform),b.left=`${r+(_?s-ne-f:ne)+(_?i-h-g:h)/i*f}px`,b.transform=t.style.transform}})}static _convertPoints(t,i){if(!i)return t;let _=i.x||0,s=i.y||0,a=i.width&&i.downScaledWidth?i.width/i.downScaledWidth:1;i=i.height&&i.downScaledHeight?i.height/i.downScaledHeight:1;for(let r of t)r.x=r.x*a+_,r.y=r.y*i+s;return t}_scanFrame(){var t=this;!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)((0,m.Z)(function*(){if(!(1>=t.$video.readyState)){var i=Date.now()-t._lastScanTimestamp,_=1e3/t._maxScansPerSecond;i<_&&(yield new Promise(a=>setTimeout(a,_-i))),t._lastScanTimestamp=Date.now();try{var s=yield o.scanImage(t.$video,{scanRegion:t._scanRegion,qrEngine:t._qrEnginePromise,canvas:t.$canvas})}catch(a){if(!t._active)return;t._onDecodeError(a)}!o._disableBarcodeDetector||(yield t._qrEnginePromise)instanceof Worker||(t._qrEnginePromise=o.createQrEngine()),s?(t._onDecode?t._onDecode(s):t._legacyOnDecode&&t._legacyOnDecode(s.data),t.$codeOutlineHighlight&&(clearTimeout(t._codeOutlineHighlightRemovalTimeout),t._codeOutlineHighlightRemovalTimeout=void 0,t.$codeOutlineHighlight.setAttribute("viewBox",`${t._scanRegion.x||0} ${t._scanRegion.y||0} ${t._scanRegion.width||t.$video.videoWidth} ${t._scanRegion.height||t.$video.videoHeight}`),t.$codeOutlineHighlight.firstElementChild.setAttribute("points",s.cornerPoints.map(({x:a,y:r})=>`${a},${r}`).join(" ")),t.$codeOutlineHighlight.style.display="")):t.$codeOutlineHighlight&&!t._codeOutlineHighlightRemovalTimeout&&(t._codeOutlineHighlightRemovalTimeout=setTimeout(()=>t.$codeOutlineHighlight.style.display="none",100))}t._scanFrame()}))}_onDecodeError(t){t!==o.NO_QR_CODE_FOUND&&console.log(t)}_getCameraStream(){var t=this;return(0,m.Z)(function*(){if(!navigator.mediaDevices)throw"Camera not found.";let i=/^(environment|user)$/.test(t._preferredCamera)?"facingMode":"deviceId",_=[{width:{min:1024}},{width:{min:768}},{}],s=_.map(a=>Object.assign({},a,{[i]:{exact:t._preferredCamera}}));for(let a of[...s,..._])try{let r=yield navigator.mediaDevices.getUserMedia({video:a,audio:!1});return{stream:r,facingMode:t._getFacingMode(r)||(a.facingMode?t._preferredCamera:"environment"===t._preferredCamera?"user":"environment")}}catch{}throw"Camera not found."})()}_restartVideoStream(){var t=this;return(0,m.Z)(function*(){let i=t._paused;(yield t.pause(!0))&&!i&&t._active&&(yield t.start())})()}static _stopVideoStream(t){for(let i of t.getTracks())i.stop(),t.removeTrack(i)}_setVideoMirror(t){this.$video.style.transform="scaleX("+("user"===t?-1:1)+")"}_getFacingMode(t){return(t=t.getVideoTracks()[0])?/rear|back|environment/i.test(t.label)?"environment":/front|user|face/i.test(t.label)?"user":null:null}static _drawToCanvas(t,i,_,s=!1){_=_||document.createElement("canvas");let a=i&&i.x?i.x:0,r=i&&i.y?i.y:0,u=i&&i.width?i.width:t.videoWidth||t.width,g=i&&i.height?i.height:t.videoHeight||t.height;return s||(s=i&&i.downScaledWidth?i.downScaledWidth:u,i=i&&i.downScaledHeight?i.downScaledHeight:g,_.width!==s&&(_.width=s),_.height!==i&&(_.height=i)),(i=_.getContext("2d",{alpha:!1})).imageSmoothingEnabled=!1,i.drawImage(t,a,r,u,g,0,0,_.width,_.height),[_,i]}static _loadImage(t){return(0,m.Z)(function*(){if(t instanceof Image)return yield o._awaitImageLoad(t),t;if(t instanceof HTMLVideoElement||t instanceof HTMLCanvasElement||t instanceof SVGImageElement||"OffscreenCanvas"in window&&t instanceof OffscreenCanvas||"ImageBitmap"in window&&t instanceof ImageBitmap)return t;if(!(t instanceof File||t instanceof Blob||t instanceof URL||"string"==typeof t))throw"Unsupported image type.";{let i=new Image;i.src=t instanceof File||t instanceof Blob?URL.createObjectURL(t):t.toString();try{return yield o._awaitImageLoad(i),i}finally{(t instanceof File||t instanceof Blob)&&URL.revokeObjectURL(i.src)}}})()}static _awaitImageLoad(t){return(0,m.Z)(function*(){t.complete&&0!==t.naturalWidth||(yield new Promise((i,_)=>{let s=a=>{t.removeEventListener("load",s),t.removeEventListener("error",s),a instanceof ErrorEvent?_("Image load error"):i()};t.addEventListener("load",s),t.addEventListener("error",s)}))})()}static _postWorkerMessage(t,i,_,s){return(0,m.Z)(function*(){return o._postWorkerMessageSync(yield t,i,_,s)})()}static _postWorkerMessageSync(t,i,_,s){if(!(t instanceof Worker))return-1;let a=o._workerMessageId++;return t.postMessage({id:a,type:i,data:_},s),a}}return o.DEFAULT_CANVAS_SIZE=400,o.NO_QR_CODE_FOUND="No QR code found",o._disableBarcodeDetector=!1,o._workerMessageId=0,o})(),T_=["video"];function x_(o,n){1&o&&(e.TgZ(0,"div",13)(1,"h2",14),e._uU(2," Scan QR Code "),e.qZA(),e.TgZ(3,"span",15),e._uU(4," Scan the QR code outisde a PlaceOS room or space. "),e.qZA()())}function v_(o,n){1&o&&(e.TgZ(0,"div",13)(1,"h2",14),e._uU(2," Enter Room ID "),e.qZA(),e.TgZ(3,"span",15),e._uU(4," Enter the room ID number outisde a PlaceOS room or space. "),e.qZA()())}function O_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",2),e._UZ(1,"video",3,4),e.TgZ(3,"div",5),e.YNc(4,x_,5,0,"div",6),e.YNc(5,v_,5,0,"div",6),e.TgZ(6,"div",7)(7,"div",8)(8,"span",9),e._uU(9,"Booking ID"),e.qZA(),e.TgZ(10,"input",10),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.room_code=_)}),e.qZA()()(),e.TgZ(11,"div",11)(12,"button",12),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.is_scanning=!0)}),e._uU(13," Scan Code "),e.qZA(),e.TgZ(14,"button",12),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.is_scanning=!1)}),e._uU(15," Enter Code "),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",t.is_scanning),e.xp6(1),e.Q6J("ngIf",!t.is_scanning),e.xp6(2),e.ekj("input",!t.is_scanning),e.xp6(3),e.Q6J("ngModel",t.room_code),e.xp6(2),e.Tol("flex-1 text-black border-none w-40 "+(t.is_scanning?"bg-white dark:bg-neutral-600":"bg-transparent hover:bg-white hover:dark:bg-neutral-600 bg-opacity-50")),e.xp6(2),e.Tol("flex-1 text-black border-none w-40 "+(t.is_scanning?"bg-transparent hover:bg-white hover:dark:bg-neutral-600 bg-opacity-50":"bg-white dark:bg-neutral-600"))}}function E_(o,n){1&o&&(e.TgZ(0,"div",16),e._UZ(1,"mat-spinner",17),e.TgZ(2,"p"),e._uU(3,"Checking in booking..."),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("diameter",32))}class Qe extends p.KG{constructor(n,t,i,_){super(),this._router=n,this._route=t,this._event_form=i,this._booking_form=_,this.menu=new e.vpe(!1),this.is_scanning=!0,this.loading=!1}ngOnDestroy(){this._video_el?.nativeElement?.srcObject&&this._video_el.nativeElement.srcObject.getTracks().forEach(n=>n?.stop()),this._qr_scanner?.stop()}ngOnInit(){this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("asset_id")&&this._checkinBooking(n.get("asset_id")),n.has("space_id")&&this._checkinEvent(n.get("space_id"),n.get("email"))}))}ngAfterViewInit(){!navigator.mediaDevices?.getUserMedia||this.loading||(navigator.mediaDevices.getUserMedia({video:!0}).then(n=>this._video_el.nativeElement.srcObject=n).catch(n=>console.error("Unable to fetch media devices!",n)),this._qr_scanner=new C_(this._video_el.nativeElement,n=>this.handleQrCode(n)),this._qr_scanner.start())}handleQrCode(n){const t=n;if(t.indexOf("/#/")>0){const _=/[?&]([^=#]+)=([^&#]*)/g,s={};let a;for(;a=_.exec(t);)s[a[1]]=a[2];this._router.navigate([t.split("/#")[1].split("?")[0]],s)}}_checkinBooking(n,t="desk"){var i=this;return(0,m.Z)(function*(){i.loading=!0;let _=yield(0,E.F2)({period_start:(0,P.Z)(Date.now()),period_end:(0,P.Z)((0,It.Z)(Date.now(),5)),type:t,email:(0,p.ar)().email}).toPromise().catch(a=>[]);const s=_.find(a=>a.asset_id===n);if(s)yield(0,E.FD)(s.id,!0).toPromise().catch(a=>{throw(0,p.cB)(`Unable to checkin booking with resource "${n}"`),i.loading=!1,a}),i._router.navigate(["/book","code","success"]);else{_=yield(0,E.F2)({period_start:(0,P.Z)(Date.now()),period_end:(0,P.Z)((0,Rt.Z)(Date.now())),type:t}).toPromise().catch(r=>[]);let a=_.find(r=>r.asset_id===n);if(a)return void i._router.navigate(["/book","code","error"],{queryParams:{type:"not_started",asset_id:n}});if(_=yield(0,E.F2)({period_start:(0,P.Z)(Date.now()),period_end:(0,P.Z)((0,It.Z)(Date.now(),5)),type:t}).toPromise().catch(r=>[]),a=_.find(r=>r.asset_id===n),a)return void i._router.navigate(["/book","code","error"],{queryParams:{type:"wrong_resource",asset_id:n}});i._router.navigate(["/book","code","error"],{queryParams:{type:"no_booking",asset_id:n}}),i._booking_form.newForm(new E.$N({asset_id:n,type:t})),i._booking_form.setOptions({type:t})}i.loading=!1})()}_checkinEvent(n,t){var i=this;return(0,m.Z)(function*(){t||(t=(0,p.ar)().email),i.loading=!0;const s=(yield(0,k.u$)({period_start:(0,P.Z)(Date.now()),period_end:(0,P.Z)(Date.now()+3e5)}).toPromise().catch(a=>[])).find(a=>a.resources.find(r=>r.id===n||r.email===n));if(s)yield(0,k.rq)(s.id,t,!0).toPromise().catch(a=>{throw(0,p.cB)(`Unable to checkin event with resource "${n}"`),i.loading=!1,a}),i._router.navigate(["/book","code","success"]),i.loading=!1;else{const a=yield(0,L.hMA)(n).toPromise();a&&i._event_form.newForm(new k.ym({system:a})),i._router.navigate(["/book","meeting"])}i.loading=!1})()}}Qe.\u0275fac=function(n){return new(n||Qe)(e.Y36(x.F0),e.Y36(x.gz),e.Y36(k.MH),e.Y36(E.fy))},Qe.\u0275cmp=e.Xpm({type:Qe,selectors:[["book-code-flow"]],viewQuery:function(n,t){if(1&n&&e.Gf(T_,5),2&n){let i;e.iGM(i=e.CRH())&&(t._video_el=i.first)}},outputs:{menu:"menu"},features:[e.qOj],decls:3,vars:2,consts:[["class","flex-1 overflow-hidden flex items-center justify-center bg-black relative",4,"ngIf","ngIfElse"],["load_state",""],[1,"flex-1","overflow-hidden","flex","items-center","justify-center","bg-black","relative"],["id","video",1,"min-w-full","min-h-full","object-cover"],["video",""],[1,"absolute","text-white","text-center","inset-0","flex","flex-col","items-center","justify-center"],["class","flex flex-col z-10 justify-end items-center relative",4,"ngIf"],[1,"flex","items-center","justify-center"],["box","",1,"rounded-2xl","h-64","w-64","transition-all","flex","items-center","justify-center","p-8","m-8","space-x-2"],[1,"uppercase"],["matInput","","name","booking-id","placeholder","e.g. 12102910",1,"border-none","bg-none","w-full","text-3xl","text-left",3,"ngModel","ngModelChange"],[1,"m-4","p-2","flex","items-center","space-x-2","bg-white","bg-opacity-50","rounded"],["matRipple","",3,"click"],[1,"flex","flex-col","z-10","justify-end","items-center","relative"],[1,"text-3xl","mb-1","uppercase","subpixel-antialiased"],[1,"mb-4"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"]],template:function(n,t){if(1&n&&(e.YNc(0,O_,16,9,"div",0),e.YNc(1,E_,4,1,"ng-template",null,1,e.W1O)),2&n){const i=e.MAs(2);e.Q6J("ngIf",!t.loading)("ngIfElse",i)}},dependencies:[l.O5,D.Nt,w.Ou,C.wG,c.Fj,c.JJ,c.On],styles:["[_nghost-%COMP%]{position:relative;width:100%;height:100vh;display:flex;flex-direction:column;background:#f0f0f0}[box][_ngcontent-%COMP%]{box-shadow:0 0 0 100vw #00000080}[box][_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:none}[box].input[_ngcontent-%COMP%]{width:32rem!important;max-width:calc(100% - 2rem)!important;padding:1rem!important;height:4rem!important;color:#000!important;background:white;box-shadow:0 0 0 100vw #000c}[box].input[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:initial}[box][_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:var(--heading-font);font-weight:500;text-transform:uppercase;letter-spacing:.05em}"]});var ee=d(5650),dn=d(8749),Be=d(2329),je=d(1022),He=d(7303),kt=d(6471),S_=d(9697);const J=function(){return{standalone:!0}};function A_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"mat-button-toggle-group",12),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setOptions({group:"group"===_}))}),e.ALo(2,"async"),e.TgZ(3,"mat-button-toggle",13),e._uU(4," Single "),e.qZA(),e.TgZ(5,"mat-button-toggle",14),e._uU(6," Group "),e.qZA()()()}if(2&o){const t=e.oxw(2);let i;e.xp6(1),e.Q6J("ngModel",null!=(i=e.lcZ(2,2,t.options))&&i.group?"group":"single")("ngModelOptions",e.DdM(4,J))}}function b_(o,n){if(1&o&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}function F_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",4)(1,"label"),e._uU(2,"Building"),e.qZA(),e.TgZ(3,"mat-form-field",15)(4,"mat-select",16),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.building=_)})("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setOptions({zone_id:null==_?null:_.id}))}),e.YNc(5,b_,2,2,"mat-option",17),e.ALo(6,"async"),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.building)("ngModelOptions",e.DdM(5,J)),e.xp6(1),e.Q6J("ngForOf",e.lcZ(6,3,t.buildings))}}function N_(o,n){if(1&o&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}function w_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",4)(1,"label"),e._uU(2,"Level"),e.qZA(),e.TgZ(3,"mat-form-field",15)(4,"mat-select",19),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setOptions({zone_id:_||s.building.id}))}),e.YNc(5,N_,2,2,"mat-option",17),e.ALo(6,"async"),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("disabled",!t.building)("ngModelOptions",e.DdM(5,J)),e.xp6(1),e.Q6J("ngForOf",e.lcZ(6,3,t.levels))}}function M_(o,n){1&o&&(e.TgZ(0,"mat-checkbox",25),e._uU(1," All Day "),e.qZA())}function Z_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",20)(2,"label"),e._uU(3,"Start Time"),e.qZA(),e.TgZ(4,"a-time-field",21),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.form.patchValue({date:_}))}),e.qZA()(),e.TgZ(5,"div",22)(6,"label"),e._uU(7,"End Time"),e.qZA(),e._UZ(8,"a-duration-field",23),e.YNc(9,M_,2,0,"mat-checkbox",24),e.qZA()()}if(2&o){const t=e.oxw(2);let i;e.xp6(4),e.Q6J("ngModel",t.form.value.date)("ngModelOptions",e.DdM(8,J)),e.xp6(4),e.Q6J("time",null==(i=t.form.get("date"))?null:i.value)("max",720)("min",60)("step",60)("disabled",t.form.value.all_day),e.xp6(1),e.Q6J("ngIf",t.allow_all_day)}}function R_(o,n){1&o&&(e.TgZ(0,"div",26)(1,"label"),e._uU(2,"Host"),e.qZA(),e._UZ(3,"a-user-search-field",27),e.qZA())}function y_(o,n){1&o&&(e.TgZ(0,"div",28)(1,"label"),e._uU(2,"Details"),e.qZA(),e.TgZ(3,"mat-form-field",29),e._UZ(4,"input",30),e.qZA()())}const pn=function(){return[]};function I_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",28)(1,"label"),e._uU(2,"Group Members"),e.qZA(),e.TgZ(3,"a-user-list-field",31),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setOptions({members:_}))}),e.ALo(4,"async"),e.qZA()()}if(2&o){const t=e.oxw(2);let i;e.xp6(3),e.Q6J("simple",!0)("ngModel",(null==(i=e.lcZ(4,3,t.options))?null:i.members)||e.DdM(5,pn))("ngModelOptions",e.DdM(6,J))}}function k_(o,n){if(1&o&&(e.TgZ(0,"mat-option",18)(1,"span",35),e._uU(2),e.qZA()()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(2),e.Oqu(t)}}function P_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",20)(2,"label"),e._uU(3,"Recurrence Period"),e.qZA(),e.TgZ(4,"mat-form-field",15)(5,"mat-select",32),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setOptions({pattern:_}))}),e.ALo(6,"async"),e.TgZ(7,"mat-option",33),e._uU(8,"None"),e.qZA(),e.YNc(9,k_,3,2,"mat-option",17),e.qZA()()(),e.TgZ(10,"div",20)(11,"label"),e._uU(12,"Recurrence End"),e.qZA(),e.TgZ(13,"a-date-field",34),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setOptions({recurr_end:_}))}),e.ALo(14,"async"),e.ALo(15,"async"),e.ALo(16,"async"),e._uU(17," Date and time must be in the future "),e.qZA()()()}if(2&o){const t=e.oxw(2);let i,_,s;e.xp6(5),e.Q6J("ngModel",null==(i=e.lcZ(6,7,t.options))?null:i.recurrence_pattern)("ngModelOptions",e.DdM(15,J)),e.xp6(4),e.Q6J("ngForOf",t.recurrence_options),e.xp6(4),e.Q6J("disabled",!(null!=(_=e.lcZ(14,9,t.options))&&_.pattern)||"none"===(null==(_=e.lcZ(15,11,t.options))?null:_.pattern))("ngModel",(null==(s=e.lcZ(16,13,t.options))?null:s.recurr_end)||(null==t.form||null==t.form.value?null:t.form.value.date))("ngModelOptions",e.DdM(16,J))("to",t.book_until)}}function U_(o,n){if(1&o&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function D_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",28)(1,"label"),e._uU(2,"Desk Features"),e.qZA(),e.TgZ(3,"mat-form-field",29)(4,"mat-select",36),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setOptions({features:_||[]}))}),e.ALo(5,"async"),e.YNc(6,U_,2,2,"mat-option",37),e.ALo(7,"async"),e.qZA()()()}if(2&o){const t=e.oxw(2);let i;e.xp6(4),e.Q6J("ngModel",(null==(i=e.lcZ(5,3,t.options))?null:i.features)||e.DdM(7,pn))("ngModelOptions",e.DdM(8,J)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(7,5,t.features))}}function L_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",39)(1,"mat-checkbox",21),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.form.patchValue({secondary_resource:_?"locker":""}))}),e._uU(2," Require locker "),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",!!t.form.value.secondary_resource)("ngModelOptions",e.DdM(2,J))}}function q_(o,n){if(1&o&&(e.TgZ(0,"form",1),e.YNc(1,A_,7,5,"div",2),e.TgZ(2,"div",3)(3,"div",4)(4,"label"),e._uU(5,"Date"),e.qZA(),e.TgZ(6,"a-date-field",5),e._uU(7," Date and time must be in the future "),e.qZA()(),e.YNc(8,F_,7,6,"div",6),e.ALo(9,"async"),e.YNc(10,w_,7,6,"div",6),e.ALo(11,"async"),e.qZA(),e.YNc(12,Z_,10,9,"div",7),e.YNc(13,R_,4,0,"div",8),e.YNc(14,y_,5,0,"div",9),e.YNc(15,I_,5,7,"div",9),e.ALo(16,"async"),e.YNc(17,P_,18,17,"div",7),e.YNc(18,D_,8,9,"div",9),e.ALo(19,"async"),e.YNc(20,L_,3,3,"div",10),e.qZA()),2&o){const t=e.oxw();let i,_,s,a;e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.allow_groups),e.xp6(5),e.Q6J("to",t.book_until),e.xp6(2),e.Q6J("ngIf",(null==(i=e.lcZ(9,12,t.buildings))?null:i.length)>1),e.xp6(2),e.Q6J("ngIf",(null==(_=e.lcZ(11,14,t.levels))?null:_.length)>1),e.xp6(2),e.Q6J("ngIf",t.allow_time_changes),e.xp6(1),e.Q6J("ngIf",t.can_book_for_others),e.xp6(1),e.Q6J("ngIf",t.needs_reason),e.xp6(1),e.Q6J("ngIf",null==(s=e.lcZ(16,16,t.options))?null:s.group),e.xp6(2),e.Q6J("ngIf",t.can_recurr),e.xp6(1),e.Q6J("ngIf",null==(a=e.lcZ(19,18,t.features))?null:a.length),e.xp6(2),e.Q6J("ngIf",t.can_book_lockers)}}class Ne{constructor(n,t,i){this._state=n,this._org=t,this._settings=i,this.buildings=this._org.building_list,this.levels=this._org.active_levels,this.options=this._state.options,this.features=this._state.features,this.recurrence_options=["daily","weekly","monthly"],this.setOptions=_=>this._state.setOptions(_)}get building(){return this._org.building}set building(n){this._org.building=n}get can_book_lockers(){return this._settings.get("app.desks.can_book_lockers")}get can_book_for_others(){return this._settings.get("app.desks.can_book_for_others")}get can_recurr(){return this._settings.get("app.desks.recurrence_allowed")}get allow_groups(){return this._settings.get("app.desks.allow_groups")}get needs_reason(){return!0===this._settings.get("app.desks.needs_reason")}get allow_time_changes(){return!!this._settings.get("app.desks.allow_time_changes")}get allow_all_day(){return this.allow_time_changes&&!!this._settings.get("app.desks.allow_all_day")}get book_until(){return(0,Rt.Z)((0,ee.Z)(Date.now(),this._settings.get("app.desks.available_period")||90))}}function K_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.findDesk())}),e.TgZ(1,"div",6)(2,"app-icon",7),e._uU(3,"search"),e.qZA(),e.TgZ(4,"span",8),e._uU(5),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(5),e.Oqu(t.is_edit?"Update Desk":"Find Desk")}}function W_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.allocateDesk())}),e._uU(1),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.is_edit?"Update Desk":"Book Desk"," ")}}Ne.\u0275fac=function(n){return new(n||Ne)(e.Y36(E.fy),e.Y36(A.w7),e.Y36(p.gb))},Ne.\u0275cmp=e.Xpm({type:Ne,selectors:[["detailed-book-desks-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4",4,"ngIf"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/4"],["formControlName","date",3,"to"],["class","flex flex-col flex-1 w-full sm:w-1/4",4,"ngIf"],["class","flex flex-col sm:flex-row space-x-0 sm:space-x-2 w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],["class","flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],["class","flex flex-col flex-1 w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],["class","flex flex-col flex-1 w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-4",4,"ngIf"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],[1,"w-full",3,"ngModel","ngModelOptions","ngModelChange"],["value","single",1,"w-1/2"],["value","group",1,"w-1/2"],["appearance","outline"],["placeholder","Select building",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","Any Level","ngModel","",3,"disabled","ngModelOptions","ngModelChange"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],[3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3","relative"],["formControlName","duration",3,"time","max","min","step","disabled"],["formControlName","all_day","class","absolute top-0 right-0",4,"ngIf"],["formControlName","all_day",1,"absolute","top-0","right-0"],[1,"flex","flex-col","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["formControlName","user"],[1,"flex","flex-col","flex-1","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["appearance","outline",1,"w-full"],["matInput","","formControlName","description","placeholder","Reason for booking..."],[3,"simple","ngModel","ngModelOptions","ngModelChange"],["placeholder","None",3,"ngModel","ngModelOptions","ngModelChange"],["value","none"],[3,"disabled","ngModel","ngModelOptions","to","ngModelChange"],[1,"capitalize"],["multiple","","placeholder","Any Feature",3,"ngModel","ngModelOptions","ngModelChange"],["class","capitalize",3,"value",4,"ngFor","ngForOf"],[1,"capitalize",3,"value"],[1,"flex","flex-col","flex-1","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"]],template:function(n,t){1&n&&e.YNc(0,q_,21,20,"form",0),2&n&&e.Q6J("ngIf",t.form)},dependencies:[l.sg,l.O5,C.ey,S.KE,X.gD,D.Nt,Be.Q,je.B,He.N,kt.E,S_.d,R.oG,c._Y,c.Fj,c.JJ,c.JL,c.On,c.sg,c.u,Xt,zt,l.Ov]});class Xe{constructor(n,t,i,_){this._state=n,this._router=t,this._org=i,this._settings=_,this.time=0,this.level="",this.quick_times=[{name:"Now",value:0},{name:"Tomorrow",value:(0,me.Z)((0,ee.Z)(new Date,1),9).valueOf()}],this.levels=[],this.clearForm=()=>{this.time=0,this.level=this._org.building.id,this._state.clearForm()}}get is_edit(){return!!this.form?.get("id")?.value}get auto_allocation(){return!!this._settings.get("app.desks.auto_allocation")}get form(){return this._state.form}ngOnInit(){var n=this;return(0,m.Z)(function*(){yield n._org.initialised.pipe((0,Z.P)(t=>t)),yield n._org.active_levels.pipe((0,Z.P)(t=>t?.length>0)),n.level=n._org.building?.id,n.levels=[{id:n._org.building?.id,name:"Any Level"},...n._org.levelsForBuilding(n._org.building)]})()}quickBook(){this.form.patchValue({date:(this.time<1440?(0,It.Z)((0,dn.Z)(new Date,{nearestTo:5}),this.time):(0,me.Z)((0,ee.Z)(new Date,1),8)).valueOf(),title:"Ad-hoc Desk Booking"}),this.findDesk()}findDesk(){this.form.markAllAsTouched(),this.form.patchValue({asset_id:" "}),this.form.valid&&(this.form.patchValue({asset_id:""}),this._router.navigate(["/book","desks","map"]))}allocateDesk(){var n=this;return(0,m.Z)(function*(){if(n.form.markAllAsTouched(),n.form.patchValue({asset_id:" "}),!n.form.valid)return(0,p.cB)(`Some fields are invalid. [${(0,p.RD)(n.form).join(", ")}]`);const t=n._settings.get("app.departments")||{"*":{level:n._org.levelsForBuilding()[0]?.id,centered_at:{x:.5,y:.5}}},i=(0,p.ar)().groups.find(h=>h in t)??"*";if(!t[i])return void n._router.navigate(["/book","desks","map"]);const{level:_,centered_at:s}=t[i],a=n._org.levelWithID([_]);if(!a)return void n._router.navigate(["/book","desks","map"]);const r=yield n._state.available_assets.pipe((0,I.q)(1)).toPromise(),u=_.map_id?yield(0,E.gV)(a.map_id,s,r.map(h=>h?.map_id||h?.id||"")):r[(0,p.Iy)(r.length)].id,g=r.find(h=>h.map_id===u||h.id===u);g?(n._state.form.patchValue({asset_id:g?.id,asset_name:g.name||g.id,map_id:g?.map_id||g?.id,description:g.name||g.id,booking_type:"desk",zones:g.zone?[g.zone?.parent_id,g.zone?.id]:[]}),yield n._state.confirmPost().catch(h=>console.error(h))):n._router.navigate(["/book","desks","map"])})()}}Xe.\u0275fac=function(n){return new(n||Xe)(e.Y36(E.fy),e.Y36(x.F0),e.Y36(A.w7),e.Y36(p.gb))},Xe.\u0275cmp=e.Xpm({type:Xe,selectors:[["desk-flow-form"]],decls:15,vars:5,consts:[["form","",1,"flex-1","min-h-[50%]"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[3,"form"],[1,"mb-4","border-b","border-gray-300","dark:border-neutral-500","w-full"],[1,"flex","flex-col","sm:flex-row","items-center","justify-center","space-x-0","space-y-2","sm:space-y-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],["btn","","matRipple","","clear","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]","inverse",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"ml-2","mx-4"],["class","sm:flex-1 w-full sm:w-auto h-[2.75rem]","find","","btn","","matRipple","",3,"click",4,"ngIf","ngIfElse"],["alloc_button",""],["find","","btn","","matRipple","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"]],template:function(n,t){if(1&n&&(e.TgZ(0,"section",0)(1,"h2",1),e._uU(2),e.qZA(),e._UZ(3,"detailed-book-desks-form",2)(4,"div",3),e.TgZ(5,"div",4)(6,"button",5),e.NdJ("click",function(){return t.clearForm()}),e.TgZ(7,"div",6)(8,"app-icon",7),e._uU(9,"clear"),e.qZA(),e.TgZ(10,"span",8),e._uU(11),e.qZA()()(),e.YNc(12,K_,6,1,"button",9),e.qZA()(),e.YNc(13,W_,2,1,"ng-template",null,10,e.W1O)),2&n){const i=e.MAs(14);e.xp6(2),e.hij(" ",t.is_edit?"Edit":"Detailed"," Desk Booking "),e.xp6(1),e.Q6J("form",t.form),e.xp6(8),e.Oqu(t.is_edit?"Cancel Edit":"Clear Form"),e.xp6(1),e.Q6J("ngIf",!t.auto_allocation)("ngIfElse",i)}},dependencies:[l.O5,T.o,C.wG,Ne],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;overflow:auto}[quick][_ngcontent-%COMP%]{background-color:#007ac8}"]});var un=d(6308),$_=d(1059),gn=d(9136),mn=d(6817);function G_(o,n){if(1&o&&(e.TgZ(0,"div",25),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t," ")}}const J_=function(){return[]};function Y_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"li",18),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.setActiveDesk(s))}),e.TgZ(1,"app-icon",19),e._uU(2,"place"),e.qZA(),e.TgZ(3,"div",20)(4,"div",21),e._uU(5),e.qZA(),e.TgZ(6,"div",22),e._uU(7),e.qZA(),e.TgZ(8,"div",23),e.YNc(9,G_,2,1,"div",24),e.qZA()()()}if(2&o){const t=n.$implicit,i=e.oxw();e.ekj("border-primary",(null==i.active_desk?null:i.active_desk.id)===t.id),e.uIk("desk-id",t.id),e.xp6(5),e.Oqu(t.name||t.id),e.xp6(2),e.hij(" ",(null==t.zone?null:t.zone.display_name)||(null==t.zone?null:t.zone.name)||"<No Level>"," "),e.xp6(2),e.Q6J("ngForOf",t.features||e.DdM(6,J_))}}function Q_(o,n){if(1&o&&(e.TgZ(0,"div",29),e._uU(1),e.ALo(2,"async"),e.ALo(3,"async"),e.qZA()),2&o){const t=e.oxw(2);let i;e.xp6(1),e.hij(" ",(null==(i=e.lcZ(2,1,t.level))?null:i.display_name)||(null==(i=e.lcZ(3,3,t.level))?null:i.name)," ")}}function B_(o,n){if(1&o&&(e.TgZ(0,"div",26),e._UZ(1,"i-map",27),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e.ALo(7,"async"),e.ALo(8,"async"),e.YNc(9,Q_,4,5,"div",28),e.ALo(10,"async"),e.qZA()),2&o){const t=e.oxw();let i,_;e.xp6(1),e.Q6J("src",e.lcZ(2,9,t.url))("zoom",null==(i=e.lcZ(3,11,t.positions))?null:i.zoom)("center",null==(_=e.lcZ(4,13,t.positions))?null:_.center)("styles",e.lcZ(5,15,t.styles))("features",e.lcZ(6,17,t.features))("actions",e.lcZ(7,19,t.actions))("labels",e.lcZ(8,21,t.labels))("focus",(null==t.active_desk?null:t.active_desk.map_id)||(null==t.active_desk?null:t.active_desk.id)),e.xp6(8),e.Q6J("ngIf",e.lcZ(10,23,t.level))}}function j_(o,n){if(1&o&&(e.TgZ(0,"div",30),e._UZ(1,"mat-spinner",31),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"async"),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("diameter",32),e.xp6(2),e.Oqu(e.lcZ(4,2,t.loading))}}function H_(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",32)(1,"div",33)(2,"div",21),e._uU(3),e.qZA(),e.TgZ(4,"div",22),e._uU(5),e.qZA()(),e.TgZ(6,"div",34)(7,"button",35),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.setActiveDesk(null))}),e._uU(8," Clear "),e.qZA(),e.TgZ(9,"button",36),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.makeBooking())}),e._uU(10," Book "),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(3),e.Oqu(t.active_desk.name),e.xp6(2),e.hij(" ",(null==t.active_desk.zone?null:t.active_desk.zone.display_name)||t.active_desk.zone.name||"<No Level>"," ")}}const X_=function(){return["/book","desks","form"]};class ze extends p.KG{constructor(n,t,i){super(),this._state=n,this._settings=t,this._explore=i,this.url=this._explore.map_url,this.styles=this._explore.map_styles,this.positions=this._explore.map_positions,this.features=this._explore.map_features,this.actions=this._explore.map_actions,this.labels=this._explore.map_labels,this.level=this._explore.level,this.desks=this._state.available_assets,this.loading=this._state.loading,this.form=this._state.form,this.option_details=(0,q.aj)([this._state.options,this.form.valueChanges.pipe((0,$_.O)({}))]).pipe((0,F.U)(([_])=>{const s=this._state.form,a=(0,p.IO)({pattern:_.pattern,end:_.recurr_end,start:s.value.date,interval:1,days_of_week:-1}),r=`${(0,un.Z)(s.value.date,"dd MMM yyyy")}${_.pattern&&"none"!==_.pattern?", "+a:""}${_.group?", "+_.group:""}, ${_.features?.length||"Any"} Feature${(_.features?.length||0)<2?"":"s"}`;return _.zone_id&&this._explore.setLevel(_.zone_id),r})),this._active_desk=new N.X(null),this.makeBooking=()=>this._state.confirmPost()}get active_desk(){return this._active_desk.getValue()}get hide_map(){return!!this._settings.get("app.desks.hide_map")}ngOnInit(){this.subscription("assets-statue",(0,q.aj)([this._state.assets,this._state.available_assets,this._active_desk]).pipe((0,Lt.b)(200)).subscribe(([n,t])=>{const i={},_=[];for(const s of n){const a=s.bookable&&t.find(r=>r.id===s.id);i[`#${s.map_id||s.id}`]={fill:s.bookable?t.find(r=>r.id===s.id)?"#43a047":"#e53935":"#999",opacity:.6},a&&_.push({id:s.map_id||s.id,action:"click",callback:()=>this.setActiveDesk(s)})}this._explore.setStyles("desks",i),this._explore.setActions("desks",_),this._explore.setFeatures("desks",this.active_desk?[{location:this.active_desk.map_id||this.active_desk.id,content:'\n                    <span class="flex h-4 w-4 rounded-full absolute top-1/4 left-1/4 transform -translate-x-1/2 -translate-y-1/2 border-[3px] border-white dark:border-neutral-4\xe500 shadow" >\n                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>\n                        <span class="relative inline-flex rounded-full h-full w-full bg-primary"></span>\n                    </span>'}]:[])}))}setActiveDesk(n){this._explore.setLevel(n?.zone?.id),this._active_desk.next(n),this._state.form.patchValue({asset_id:n?.id,asset_name:n.name,map_id:n?.map_id||n?.id,description:n.name,booking_type:"desk",zones:n.zone?[n.zone?.parent_id,n.zone?.id]:[]})}}ze.\u0275fac=function(n){return new(n||ze)(e.Y36(E.fy),e.Y36(p.gb),e.Y36(ke.ck))},ze.\u0275cmp=e.Xpm({type:ze,selectors:[["desk-flow-map"]],features:[e.qOj],decls:28,vars:22,consts:[["topbar","",1,""],["button","","btn","","matRipple","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],[1,"flex","flex-col","flex-1","h-1/2","w-full"],[1,"text-2xl","px-4","pt-4","text-center"],[1,"my-4","mx-auto","w-[640px]","max-w-[calc(100vw-2rem)]",3,"matMenuTriggerFor"],["menu","matMenu"],[1,"pt-4","max-h-[65vh]","overflow-auto",3,"click"],[3,"form"],["listing","",1,"flex","flex-1","h-1/2","relative","space-x-2"],[1,"list-style-none","w-full","sm:w-[20rem]","max-w-[48rem]","mx-auto","bg-gray-100","dark:bg-neutral-600","pb-32","overflow-auto","h-full","rounded-tr-lg","space-y-2"],[1,"py-2","px-4","sticky","top-0","inset-x-0","bg-gray-100","dark:bg-neutral-600","border-b","border-gray-200","dark:border-neutral-500","z-10"],["matRipple","","class","flex items-center p-2 mx-2 bg-white dark:bg-neutral-700 rounded shadow cursor-pointer space-x-2 min-h-[5rem] border",3,"border-primary","click",4,"ngFor","ngForOf"],["class","hidden sm:block flex-1 bg-gray-200 dark:bg-neutral-600 rounded-tl-lg border-l border-t border-gray-300 dark:border-neutral-500 relative overflow-hidden h-full",4,"ngIf"],["class","absolute inset-0 bg-white dark:bg-neutral-700 bg-opacity-60 flex flex-col items-center justify-center space-y-2 !m-0 z-20",4,"ngIf"],["selection","","class","absolute bottom-2 left-1/2 transform -translate-x-1/2 p-2 bg-white dark:bg-neutral-700 shadow rounded w-[24rem] max-w-[calc(100vw-1rem)] space-y-2 !m-0 border border-gray-200",4,"ngIf"],["matRipple","",1,"flex","items-center","p-2","mx-2","bg-white","dark:bg-neutral-700","rounded","shadow","cursor-pointer","space-x-2","min-h-[5rem]","border",3,"click"],[1,"text-2xl"],[1,"flex","flex-col","w-1/2","flex-1"],["name","",1,""],["level","",1,"text-xs"],["features","",1,"w-full","flex","flex-wrap"],["class","text-xs bg-primary text-white rounded-xl px-2 py-1 mt-1 mr-2",4,"ngFor","ngForOf"],[1,"text-xs","bg-primary","text-white","rounded-xl","px-2","py-1","mt-1","mr-2"],[1,"hidden","sm:block","flex-1","bg-gray-200","dark:bg-neutral-600","rounded-tl-lg","border-l","border-t","border-gray-300","dark:border-neutral-500","relative","overflow-hidden","h-full"],[3,"src","zoom","center","styles","features","actions","labels","focus"],["class","absolute top-2 left-2 bg-white dark:bg-neutral-700 rounded-3xl h-10 px-3 flex items-center border border-gray-300 dark:border-neutral-500",4,"ngIf"],[1,"absolute","top-2","left-2","bg-white","dark:bg-neutral-700","rounded-3xl","h-10","px-3","flex","items-center","border","border-gray-300","dark:border-neutral-500"],[1,"absolute","inset-0","bg-white","dark:bg-neutral-700","bg-opacity-60","flex","flex-col","items-center","justify-center","space-y-2","!m-0","z-20"],[3,"diameter"],["selection","",1,"absolute","bottom-2","left-1/2","transform","-translate-x-1/2","p-2","bg-white","dark:bg-neutral-700","shadow","rounded","w-[24rem]","max-w-[calc(100vw-1rem)]","space-y-2","!m-0","border","border-gray-200"],[1,""],[1,"flex","items-center","space-x-2"],["matRipple","",1,"inverse","flex-1",3,"click"],["matRipple","",1,"flex-1",3,"click"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"a",1)(2,"div",2)(3,"app-icon",3),e._uU(4,"arrow_back"),e.qZA(),e.TgZ(5,"span",4),e._uU(6,"Back"),e.qZA()()()(),e.TgZ(7,"div",5)(8,"h2",6),e._uU(9,"Available Desks"),e.qZA(),e.TgZ(10,"an-action-field",7),e._uU(11),e.ALo(12,"async"),e.qZA(),e.TgZ(13,"mat-menu",null,8)(15,"div",9),e.NdJ("click",function(_){return _.stopPropagation(),_.preventDefault}),e._UZ(16,"detailed-book-desks-form",10),e.qZA()(),e.TgZ(17,"div",11)(18,"ul",12)(19,"div",13),e._uU(20),e.ALo(21,"async"),e.qZA(),e.YNc(22,Y_,10,7,"li",14),e.ALo(23,"async"),e.qZA(),e.YNc(24,B_,11,25,"div",15),e.YNc(25,j_,5,4,"div",16),e.ALo(26,"async"),e.YNc(27,H_,11,2,"div",17),e.qZA()()),2&n){const i=e.MAs(14);let _;e.xp6(1),e.Q6J("routerLink",e.DdM(21,X_)),e.xp6(9),e.Q6J("matMenuTriggerFor",i),e.xp6(1),e.hij(" ",e.lcZ(12,13,t.option_details)||"No Filters"," "),e.xp6(5),e.Q6J("form",t.form),e.xp6(2),e.ekj("!w-full",t.hide_map)("rounded-tl-lg",t.hide_map),e.xp6(2),e.hij(" ",(null==(_=e.lcZ(21,15,t.desks))?null:_.length)||"0"," matches available "),e.xp6(2),e.Q6J("ngForOf",e.lcZ(23,17,t.desks)),e.xp6(2),e.Q6J("ngIf",!t.hide_map),e.xp6(1),e.Q6J("ngIf",e.lcZ(26,19,t.loading)),e.xp6(2),e.Q6J("ngIf",t.active_desk)}},dependencies:[l.sg,l.O5,T.o,gn.p,U.VK,U.p6,w.Ou,mn.s,C.wG,x.rH,Ne,l.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}"]});const z_=function(){return["/book","desks","map"]};class Ve{}function V_(o,n){1&o&&e._UZ(0,"br")}Ve.\u0275fac=function(n){return new(n||Ve)},Ve.\u0275cmp=e.Xpm({type:Ve,selectors:[["desk-flow-confirm"]],decls:7,vars:2,consts:[["topbar","",1,""],["btn","","matRipple","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"a",1)(2,"div",2)(3,"app-icon",3),e._uU(4,"arrow_back"),e.qZA(),e.TgZ(5,"span",4),e._uU(6,"Back"),e.qZA()()()()),2&n&&(e.xp6(1),e.Q6J("routerLink",e.DdM(1,z_)))},dependencies:[T.o,C.wG,x.rH],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}"]});const es=function(o){return["/book",o]},ts=function(){return{}},ns=function(){return["/schedule"]},os=function(o){return{email:o}};class te{constructor(){this.extra="",this.route="spaces",this.type="space"}get is_host(){return this.calendar===(0,p.ar)()?.email}get title(){return this.is_host?"your":"the host'"}}function is(o,n){1&o&&(e.ynx(0),e._UZ(1,"desk-flow-map"),e.BQk())}function _s(o,n){1&o&&(e.ynx(0),e._UZ(1,"desk-flow-confirm"),e.BQk())}function ss(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"flow-success",4),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("calendar",null==t.last_success?null:t.last_success.user_email)("extra",null!=t.last_success&&null!=t.last_success.extension_data&&t.last_success.extension_data.secondary_resource?"Locker E-093 has been allocated for this booking.":"")}}function as(o,n){1&o&&(e.ynx(0),e._UZ(1,"desk-flow-form"),e.BQk())}te.\u0275fac=function(n){return new(n||te)},te.\u0275cmp=e.Xpm({type:te,selectors:[["flow-success"]],inputs:{calendar:"calendar",extra:"extra",route:"route",type:"type"},decls:15,vars:14,consts:[["name","success",1,"fixed","inset-0","flex","flex-col","bg-indigo-900","items-center","justify-center","z-50"],[1,"text-7xl","rounded-full","bg-white","text-success","mb-4"],[1,"text-center","text-lg","text-white","mb-4","leading-10"],[4,"ngIf"],[1,"flex","items-center","space-x-2"],["btn","","matRipple","",1,"w-32","border","border-white",3,"routerLink","queryParams"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"app-icon"),e._uU(3,"done"),e.qZA()(),e.TgZ(4,"div",2),e._uU(5),e._UZ(6,"br"),e._uU(7),e.YNc(8,V_,1,0,"br",3),e._uU(9),e.qZA(),e.TgZ(10,"div",4)(11,"a",5),e._uU(12," New Booking "),e.qZA(),e.TgZ(13,"a",5),e._uU(14," Your Bookings "),e.qZA()()()),2&n&&(e.xp6(5),e.hij(" Thank you, your ",t.type," booking was successful!"),e.xp6(2),e.hij(" ",t.extra," "),e.xp6(1),e.Q6J("ngIf",t.extra),e.xp6(1),e.hij(" An event has been added to ",t.title," calendar "),e.xp6(2),e.Q6J("routerLink",e.VKq(8,es,t.route))("queryParams",e.DdM(10,ts)),e.xp6(2),e.Q6J("routerLink",e.DdM(11,ns))("queryParams",e.VKq(12,os,t.calendar)))},dependencies:[l.O5,T.o,C.wG,x.rH]});class et extends p.KG{constructor(n,t,i){super(),this._state=n,this._route=t,this._org=i}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){var n=this;return(0,m.Z)(function*(){yield n._org.initialised.pipe((0,Z.P)(t=>t)).toPromise(),n._state.loadForm(),n._state.form||n._state.newForm(),n._state.form.patchValue({booking_type:"desk"}),n.subscription("route.params",n._route.paramMap.subscribe(t=>{t.has("step")&&n._state.setView(t.get("step"))})),n.subscription("route.query",n._route.queryParamMap.subscribe(t=>{t.has("success")&&n._state.setView(t.get("success"))}))})()}}et.\u0275fac=function(n){return new(n||et)(e.Y36(E.fy),e.Y36(x.gz),e.Y36(A.w7))},et.\u0275cmp=e.Xpm({type:et,selectors:[["placeos-book-desk-flow"]],features:[e.qOj],decls:6,vars:4,consts:[[1,"bg-white","dark:bg-neutral-700","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","desk","route","desks",3,"calendar","extra"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.ynx(1,1),e.YNc(2,is,2,0,"ng-container",2),e.YNc(3,_s,2,0,"ng-container",2),e.YNc(4,ss,2,2,"ng-container",2),e.YNc(5,as,2,0,"ng-container",3),e.BQk(),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngSwitch",t.view),e.xp6(1),e.Q6J("ngSwitchCase","map"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"),e.xp6(1),e.Q6J("ngSwitchCase","success"))},dependencies:[l.RF,l.n9,l.ED,Xe,ze,Ve,te],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}"]});var fn=d(3780),hn=d(1789);function ls(o,n){1&o&&(e.TgZ(0,"mat-checkbox",22),e._uU(1," All Day "),e.qZA())}function rs(o,n){if(1&o&&(e.TgZ(0,"mat-option",29),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}const $t=function(){return{standalone:!0}};function cs(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-form-field",26)(1,"mat-select",27),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(3);return e.KtG(s.setBuilding(_))}),e.YNc(2,rs,2,2,"mat-option",28),e.ALo(3,"async"),e.qZA()()}if(2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.building)("ngModelOptions",e.DdM(5,$t)),e.xp6(1),e.Q6J("ngForOf",e.lcZ(3,3,t.buildings))}}function ds(o,n){if(1&o&&(e.TgZ(0,"div",23)(1,"label",24),e._uU(2,"Building"),e.qZA(),e.YNc(3,cs,4,6,"mat-form-field",25),e.ALo(4,"async"),e.qZA()),2&o){const t=e.oxw(2);let i;e.xp6(3),e.Q6J("ngIf",(null==(i=e.lcZ(4,1,t.buildings))?null:i.length)>1)}}function ps(o,n){if(1&o&&(e.TgZ(0,"mat-option",29),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function us(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",23)(1,"label",30),e._uU(2,"Features"),e.qZA(),e.TgZ(3,"mat-form-field",31)(4,"mat-select",32),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.optionsChange.emit({features:_}))}),e.YNc(5,ps,2,2,"mat-option",28),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("placeholder","Any "+t.features_label)("ngModel",null==t.options?null:t.options.features)("ngModelOptions",e.DdM(4,$t)),e.xp6(1),e.Q6J("ngForOf",t.features)}}function gs(o,n){1&o&&(e.TgZ(0,"div",35)(1,"label",36),e._uU(2,"Host"),e.TgZ(3,"span"),e._uU(4,"*"),e.qZA()(),e._UZ(5,"host-select-field",37),e.qZA())}function ms(o,n){if(1&o&&(e.TgZ(0,"div",38)(1,"label",39),e._uU(2,"Attendees"),e.qZA(),e._UZ(3,"a-user-list-field",40),e.qZA()),2&o){const t=e.oxw(3);e.xp6(3),e.Q6J("hideActions",t.hide_actions)}}function fs(o,n){if(1&o&&(e.TgZ(0,"section",2),e.YNc(1,gs,6,0,"div",33),e.YNc(2,ms,4,1,"div",34),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.can_book_for_others),e.xp6(1),e.Q6J("ngIf",!t.hide_attendees)}}function hs(o,n){1&o&&(e.TgZ(0,"div",41)(1,"label",42),e._uU(2,"Notes"),e.qZA(),e._UZ(3,"rich-text-input",43),e.qZA())}function Cs(o,n){1&o&&(e.TgZ(0,"div",48),e._uU(1," Add catering "),e.qZA())}function Ts(o,n){if(1&o&&(e.TgZ(0,"div",49)(1,"div",50),e._uU(2),e.qZA(),e.TgZ(3,"div",51),e._uU(4),e.ALo(5,"currency"),e.qZA()()),2&o){const t=e.oxw(3);e.xp6(2),e.hij(" ",null==t.form?null:t.form.value.catering[0].item_count," item(s) "),e.xp6(2),e.hij(" ",e.xi3(5,2,(null==t.form?null:t.form.value.catering[0].total_cost)/100,t.code)," ")}}function xs(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",44)(1,"label"),e._uU(2,"Catering"),e.qZA(),e.TgZ(3,"an-action-field",45),e.NdJ("onAction",function(){e.CHM(t);const _=e.oxw(2);return e.KtG(_.editCatering())}),e.YNc(4,Cs,2,0,"div",46),e.YNc(5,Ts,6,5,"div",47),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("ngIf",!(null!=t.form&&null!=t.form.value.catering&&t.form.value.catering.length)),e.xp6(1),e.Q6J("ngIf",null==t.form||null==t.form.value.catering?null:t.form.value.catering.length)}}function vs(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"form",1)(1,"section",2)(2,"div",3)(3,"div",4)(4,"label",5),e._uU(5,"Date"),e.qZA(),e.TgZ(6,"a-date-field",6),e._uU(7," Date and time must be in the future "),e.qZA()(),e.TgZ(8,"div",4)(9,"label",7),e._uU(10,"Start Time"),e.qZA(),e.TgZ(11,"a-time-field",8),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.form.patchValue({date:_}))}),e.qZA()(),e.TgZ(12,"div",9)(13,"label",10),e._uU(14,"End Time"),e.qZA(),e._UZ(15,"a-duration-field",11),e.YNc(16,ls,2,0,"mat-checkbox",12),e.qZA()(),e.TgZ(17,"div",3),e.YNc(18,ds,5,3,"div",13),e.YNc(19,us,6,5,"div",13),e.qZA()(),e.YNc(20,fs,3,2,"section",14),e.TgZ(21,"section",2)(22,"div",15)(23,"div",16)(24,"label",17),e._uU(25,"Meeting Subject "),e.TgZ(26,"span"),e._uU(27,"*"),e.qZA()(),e.TgZ(28,"mat-form-field",18),e._UZ(29,"input",19),e.TgZ(30,"mat-error"),e._uU(31,"Meeting Subject is required"),e.qZA()()(),e.YNc(32,hs,4,0,"div",20),e.YNc(33,xs,6,2,"div",21),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(11),e.Q6J("ngModel",t.form.value.date)("ngModelOptions",e.DdM(11,$t)),e.xp6(4),e.Q6J("time",t.form.value.date)("max",t.max_duration),e.xp6(1),e.Q6J("ngIf",t.allow_all_day),e.xp6(2),e.Q6J("ngIf",t.show_features&&(null==t.features?null:t.features.length)),e.xp6(1),e.Q6J("ngIf",t.show_features&&(null==t.features?null:t.features.length)),e.xp6(1),e.Q6J("ngIf",t.can_book_for_others||!t.hide_attendees),e.xp6(12),e.Q6J("ngIf",!t.hide_notes),e.xp6(1),e.Q6J("ngIf",t.has_catering)}}class tt{constructor(n,t,i){var _=this;this._catering=n,this._org=t,this._settings=i,this.features=[],this.optionsChange=new e.vpe,this.buildings=this._org.building_list,this.setBuilding=s=>this._org.building=s,this.editCatering=(0,m.Z)(function*(){return _.form.patchValue({catering:[yield _._catering.manageCateringOrder((_.form.value.catering?_.form.value.catering[0]:null)||new $.G)]})})}get building(){return this._org.building}get has_catering(){return!!this._settings.get("app.events.has_catering")}get hide_actions(){return!!this._settings.get("app.events.hide_user_actions")}get hide_notes(){return!!this._settings.get("app.events.hide_notes")}get hide_attendees(){return!!this._settings.get("app.events.hide_attendees")}get can_book_for_others(){return this._settings.get("app.events.can_book_for_others")}get allow_all_day(){return this._settings.get("app.events.allow_all_day")}get max_duration(){return this._settings.get("app.events.max_duration")||240}get show_features(){return!!this._settings.get("app.events.features_on_form")}get features_label(){return this._settings.get("app.events.features_label")||"feature"}get code(){return this._org.currency_code}}function Os(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.confirmBooking())}),e.TgZ(1,"div",5)(2,"app-icon",6),e._uU(3,"event_available"),e.qZA(),e.TgZ(4,"span",7),e._uU(5),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(5),e.Oqu(t.is_edit?"Confirm changes":"Book without Space")}}tt.\u0275fac=function(n){return new(n||tt)(e.Y36(K),e.Y36(A.w7),e.Y36(p.gb))},tt.\u0275cmp=e.Xpm({type:tt,selectors:[["detailed-book-space-form"]],inputs:{form:"form",options:"options",features:"features"},outputs:{optionsChange:"optionsChange"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"mb-4","border-b","border-gray-300","dark:border-neutral-500"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],["for","date"],["name","date","formControlName","date"],["for","start-time"],["name","start-time",3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3","relative"],["for","end-time"],["name","end-time","formControlName","duration",3,"time","max"],["formControlName","all_day","class","absolute top-0 right-0",4,"ngIf"],["class","flex flex-col flex-1 w-full",4,"ngIf"],["class","mb-4 border-b border-gray-300 dark:border-neutral-500",4,"ngIf"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["name","title","matInput","","formControlName","title","placeholder","Meeting title"],["class","flex flex-col resize-y mb-4",4,"ngIf"],["class","flex flex-col mb-4",4,"ngIf"],["formControlName","all_day",1,"absolute","top-0","right-0"],[1,"flex","flex-col","flex-1","w-full"],["for","building"],["overlay","","buildings","","class","w-full h-[3.25rem]","appearance","outline",4,"ngIf"],["overlay","","buildings","","appearance","outline",1,"w-full","h-[3.25rem]"],["placeholder","Select Building...",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","features"],["overlay","","appearance","outline",1,"w-full","h-[3.25rem]"],["multiple","",3,"placeholder","ngModel","ngModelOptions","ngModelChange"],["class","flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto",4,"ngIf"],["class","flex flex-col w-[640px] max-w-[calc(100%-2rem)] mx-auto mb-2",4,"ngIf"],[1,"flex","flex-col","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],["for","host"],["name","host","formControlName","organiser"],[1,"flex","flex-col","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-2"],["for","attendees"],["name","attendees","formControlName","attendees",3,"hideActions"],[1,"flex","flex-col","resize-y","mb-4"],["for","notes"],["name","notes","formControlName","body","placeholder","Add meeting notes here..."],[1,"flex","flex-col","mb-4"],[3,"onAction"],["class","opacity-40",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"opacity-40"],[1,"flex","items-center"],[1,"flex-1","w-1/2"],[1,"text-xs","opacity-60","px-4"]],template:function(n,t){1&n&&e.YNc(0,vs,34,12,"form",0),2&n&&e.Q6J("ngIf",t.form)},dependencies:[l.sg,l.O5,C.ey,S.KE,S.TO,X.gD,D.Nt,mn.s,Be.Q,je.B,He.N,kt.E,fn.n,hn.d,R.oG,c._Y,c.Fj,c.JJ,c.JL,c.On,c.sg,c.u,l.Ov,l.H9]});class nt{constructor(n,t,i){this._state=n,this._settings=t,this._router=i,this.time=0,this.capacity=0,this.quick_times=[{name:"Now",value:0},{name:"Later Today",value:120},{name:"Tomorrow",value:(0,me.Z)((0,ee.Z)(new Date,1),9).valueOf()}],this.quick_capacities=[{name:"Any Capacity",value:0},{name:"Small (1 - 4)",value:1},{name:"Medium (5 - 12)",value:5},{name:"Large (13 - 32)",value:13},{name:"Huge (32+)",value:33}],this.options=this._state.options,this.features=this._state.features,this.setOptions=_=>this._state.setOptions(_),this.clearForm=()=>{this.time=this.capacity=0,this._state.clearForm()}}get is_edit(){return!!this.form?.value?.id}get form(){return this._state.form}get allow_standalone_bookings(){return this._settings.get("app.events.allow_standalone_bookings")}quickBook(){this.form.value.host||this.form.patchValue({host:(0,p.ar)()?.email}),this.form.patchValue({date:(this.time<1440?(0,It.Z)((0,dn.Z)(new Date,{nearestTo:5}),this.time):(0,me.Z)((0,ee.Z)(new Date,1),8)).valueOf(),title:"Ad-hoc Meeting"}),this._state.setOptions({capacity:this.capacity}),this._router.navigate(["/book","spaces","find"])}findSpace(){if(this.form.markAllAsTouched(),this.form.value.host||this.form.patchValue({host:(0,p.ar)()?.email}),!this.form.valid)return(0,p.cB)(`Some fields are invalid. [${(0,p.RD)(this.form).join(", ")}]`);this._router.navigate(["/book","spaces","find"])}confirmBooking(){if(this.form.value.host||this.form.patchValue({host:(0,p.ar)()?.email}),this.form.markAllAsTouched(),!this.form.valid)return(0,p.cB)(`Some fields are invalid. [${(0,p.RD)(this.form).join(", ")}]`);this._router.navigate(["/book","spaces","confirm"])}}nt.\u0275fac=function(n){return new(n||nt)(e.Y36(k.MH),e.Y36(p.gb),e.Y36(x.F0))},nt.\u0275cmp=e.Xpm({type:nt,selectors:[["space-flow-form"]],decls:20,vars:11,consts:[["form","",1,"flex-1","min-h-[50%]"],[1,"text-xl","uppercase","font-medium","mb-2","mt-4","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[3,"form","options","features","optionsChange"],[1,"flex","flex-col","sm:flex-row","items-center","justify-center","space-x-0","space-y-2","sm:space-y-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],["btn","","matRipple","","clear","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]","inverse",3,"click"],[1,"flex","items-center","justify-center"],[1,"text-xl"],[1,"ml-2","mx-4"],["btn","","matRipple","","find-space","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"],["class","sm:flex-1 w-full sm:w-auto h-[2.75rem]","btn","","matRipple","","standalone","",3,"click",4,"ngIf"],["btn","","matRipple","","standalone","",1,"sm:flex-1","w-full","sm:w-auto","h-[2.75rem]",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"section",0)(1,"h2",1),e._uU(2),e.qZA(),e.TgZ(3,"detailed-book-space-form",2),e.NdJ("optionsChange",function(_){return t.setOptions(_)}),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"div",3)(7,"button",4),e.NdJ("click",function(){return t.clearForm()}),e.TgZ(8,"div",5)(9,"app-icon",6),e._uU(10,"clear"),e.qZA(),e.TgZ(11,"span",7),e._uU(12),e.qZA()()(),e.TgZ(13,"button",8),e.NdJ("click",function(){return t.findSpace()}),e.TgZ(14,"div",5)(15,"app-icon",6),e._uU(16,"search"),e.qZA(),e.TgZ(17,"span",7),e._uU(18),e.qZA()()(),e.YNc(19,Os,6,1,"button",9),e.qZA()()),2&n&&(e.xp6(2),e.hij(" ",t.is_edit?"Edit":"Detailed"," Space Booking "),e.xp6(1),e.Q6J("form",t.form)("options",e.lcZ(4,7,t.options))("features",e.lcZ(5,9,t.features)),e.xp6(9),e.Oqu(t.is_edit?"Cancel Edit":"Clear Form"),e.xp6(6),e.Oqu(t.is_edit?"Update Spaces":"Find Space"),e.xp6(1),e.Q6J("ngIf",t.is_edit||t.allow_standalone_bookings))},dependencies:[l.O5,T.o,C.wG,tt,l.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;overflow:auto}[quick][_ngcontent-%COMP%]{background-color:#007ac8}"]});var we=d(6198);d(2886);class ot{constructor(n){this._dialog=n,this.bookChange=new e.vpe}bookSpace(){this.book=!this.multiple||!this.book,this.bookChange.emit(this.book)}viewLocation(){this._dialog.open(Dt.p6,{maxWidth:"95vw",maxHeight:"95vh",data:{item:this.space}})}}function Es(o,n){if(1&o&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}function Ss(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-form-field",20)(1,"mat-select",21),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.setBuilding(_))}),e.ALo(2,"async"),e.YNc(3,Es,2,2,"mat-option",13),e.ALo(4,"async"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",e.lcZ(2,2,t.building)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(4,4,t.buildings))}}function As(o,n){if(1&o&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}function bs(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-form-field",23)(1,"mat-select",24),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.setOptions({zone_ids:[_]}))}),e.ALo(2,"async"),e.ALo(3,"async"),e.YNc(4,As,2,2,"mat-option",13),e.ALo(5,"async"),e.qZA()()}if(2&o){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngModel",null!=(i=e.lcZ(2,2,t.options))&&null!=i.zone_ids&&i.zone_ids.length?null==(i=e.lcZ(3,4,t.options))?null:i.zone_ids[0]:""),e.xp6(3),e.Q6J("ngForOf",e.lcZ(5,6,t.levels))}}function Fs(o,n){if(1&o&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function Ns(o,n){if(1&o&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function ws(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-form-field",11)(1,"mat-select",25),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.setOptions({features:_}))}),e.ALo(2,"async"),e.YNc(3,Ns,2,2,"mat-option",13),e.ALo(4,"async"),e.qZA()()}if(2&o){const t=e.oxw();let i;e.xp6(1),e.Q6J("placeholder","Any "+t.features_label)("ngModel",null==(i=e.lcZ(2,3,t.options))?null:i.features),e.xp6(2),e.Q6J("ngForOf",e.lcZ(4,5,t.features))}}function Ms(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"space-flow-find-item",28),e.NdJ("bookChange",function(_){const a=e.CHM(t).$implicit,r=e.oxw(3);return e.KtG(r.handleBookEvent(a,_))}),e.qZA()}if(2&o){const t=n.$implicit,i=e.oxw(3);e.Q6J("space",t)("multiple",i.multiple)("book",i.book_space[t.id])}}function Zs(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Ms,1,3,"space-flow-find-item",26),e.ALo(2,"async"),e.TgZ(3,"p",27),e._uU(4," End of available spaces list "),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.spaces))}}function Rs(o,n){if(1&o&&(e.ynx(0),e.YNc(1,Zs,5,3,"ng-container",16),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw(),i=e.MAs(29);let _;e.xp6(1),e.Q6J("ngIf",(null==(_=e.lcZ(2,2,t.spaces))?null:_.length)>0)("ngIfElse",i)}}function ys(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",37)(1,"div",38)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",39),e._uU(5),e.qZA()(),e.TgZ(6,"button",40),e.NdJ("click",function(_){const a=e.CHM(t).$implicit;return e.oxw(2).handleBookEvent(a,!1),e.KtG(_.stopPropagation())}),e.TgZ(7,"app-icon"),e._uU(8,"close"),e.qZA()()()}if(2&o){const t=n.$implicit;e.xp6(3),e.Oqu(t.display_name||t.name),e.xp6(2),e.AsE(" ",(null==t.level?null:t.level.display_name)||(null==t.level?null:t.level.name)," ~ ",t.capacity||"2+"," People ")}}function Is(o,n){1&o&&(e.TgZ(0,"div",41),e._uU(1," No selected spaces "),e.qZA())}function ks(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",29)(1,"div",30)(2,"div",31),e._uU(3),e.qZA(),e.TgZ(4,"button",32),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.confirmBooking())}),e._uU(5," Book "),e.qZA()(),e.TgZ(6,"mat-menu",33,34),e.YNc(8,ys,9,3,"div",35),e.YNc(9,Is,2,0,"div",36),e.qZA()()}if(2&o){const t=e.MAs(7),i=e.oxw();e.xp6(2),e.Q6J("matMenuTriggerFor",t),e.xp6(1),e.hij(" ",null==i.space_list?null:i.space_list.length," space(s) selected "),e.xp6(1),e.Q6J("disabled",!(null!=i.space_list&&i.space_list.length)),e.xp6(4),e.Q6J("ngForOf",i.space_list),e.xp6(1),e.Q6J("ngIf",!(null!=i.space_list&&i.space_list.length))}}function Ps(o,n){1&o&&(e.TgZ(0,"div",42),e._UZ(1,"mat-spinner",43),e.TgZ(2,"p"),e._uU(3,"Retrieving available spaces..."),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("diameter",32))}function Us(o,n){1&o&&(e.TgZ(0,"div",44)(1,"p"),e._uU(2," No available spaces for selected time, capacity or level(s) "),e.qZA()())}ot.\u0275fac=function(n){return new(n||ot)(e.Y36(v.uw))},ot.\u0275cmp=e.Xpm({type:ot,selectors:[["space-flow-find-item"]],inputs:{space:"space",multiple:"multiple",book:"book"},outputs:{bookChange:"bookChange"},decls:19,vars:8,consts:[[1,"flex","items-center","bg-white","dark:bg-neutral-700","p-2","my-2","shadow","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","rounded"],[1,"flex","flex-col","flex-1","space-y-2"],[1,"flex","items-center"],[1,"p-2","rounded-full","bg-gray-300","dark:bg-neutral-600","mr-2"],[1,"flex","flex-col","space-y-2","ml-2"],["matRipple","","book","",3,"click"],["locate","","btn","","matRipple","",1,"inverse",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-icon"),e._uU(5,"place"),e.qZA()(),e.TgZ(6,"span"),e._uU(7),e.qZA()(),e.TgZ(8,"div",2)(9,"div",3)(10,"app-icon"),e._uU(11,"group"),e.qZA()(),e.TgZ(12,"span"),e._uU(13),e.qZA()()(),e.TgZ(14,"div",4)(15,"button",5),e.NdJ("click",function(){return t.bookSpace()}),e._uU(16),e.qZA(),e.TgZ(17,"button",6),e.NdJ("click",function(){return t.viewLocation()}),e._uU(18," Map "),e.qZA()()()),2&n&&(e.xp6(7),e.AsE("",(null==t.space||null==t.space.level?null:t.space.level.display_name)||(null==t.space||null==t.space.level?null:t.space.level.name),", ",(null==t.space?null:t.space.display_name)||(null==t.space?null:t.space.name),""),e.xp6(6),e.hij("",(null==t.space?null:t.space.capacity)||0," People"),e.xp6(2),e.ekj("bg-pending",t.multiple&&t.book)("border-pending",t.multiple&&t.book),e.xp6(1),e.hij(" ",t.multiple?t.book?"Remove":"Select":"Book"," "))},dependencies:[T.o,C.wG],styles:["button[_ngcontent-%COMP%]{width:8rem}"]});const Ds=function(){return["/book","spaces","form"]};class it{constructor(n,t,i,_,s){this._org=n,this._state=t,this._settings=i,this._router=_,this._space_pipe=s,this.book_space={},this.quick_capacities=[{name:"Any Capacity",value:0},{name:"Small (1 - 4)",value:1},{name:"Medium (5 - 12)",value:5},{name:"Large (13 - 32)",value:13},{name:"Huge (32+)",value:33}],this.space_list=[],this.buildings=this._org.building_list,this.building=this._org.active_building,this.levels=(0,q.aj)([this.building,this._state.options]).pipe((0,yt.h)(([a])=>!!a),(0,F.U)(([a])=>[{id:this._org.building.id,name:"All Levels"},...this._org.levelsForBuilding(a)])),this.loading=this._state.loading,this.options=this._state.options,this.spaces=this._state.available_spaces,this.features=this._state.features,this.setOptions=a=>this._state.setOptions(a)}setBuilding(n){var t=this;return(0,m.Z)(function*(){const i=yield t.options.pipe((0,I.q)(1)).toPromise();n&&(t._org.building=n);const _=t._org.levelsForBuilding(t._org.building);!_.find(a=>i.zone_ids?.includes(a.id))&&_.length&&t.setOptions({zone_ids:[_[0].id]})})()}get multiple(){return this._settings.get("app.events.multiple_spaces")??!1}get features_label(){return this._settings.get("app.events.features_label")||"feature"}ngOnInit(){var n=this;return(0,m.Z)(function*(){yield n._org.initialised.pipe((0,Z.P)(i=>!!i)).toPromise(),n.setBuilding(n._org.building),n.book_space={},(n._state.form?.get("resources")?.value||[]).forEach(i=>n.book_space[i.id]=!0),n.space_list=yield n._getSpaceList()})()}handleBookEvent(n,t=!0){var i=this;return(0,m.Z)(function*(){i.multiple?i.book_space[n.id]=t:(i.book_space={},i.book_space[n.id]=t,i.confirmBooking()),i.space_list=yield i._getSpaceList()})()}confirmBooking(){var n=this;return(0,m.Z)(function*(){const t=yield n._getSpaceList();n._state.form.patchValue({resources:t,system:t[0]}),n._router.navigate(["/book","spaces","confirm"])})()}_getSpaceList(){const n=Object.keys(this.book_space).filter(t=>this.book_space[t]);return n.length?Promise.all(n.map(t=>this._space_pipe.transform(t))):Promise.resolve([])}}it.\u0275fac=function(n){return new(n||it)(e.Y36(A.w7),e.Y36(k.MH),e.Y36(p.gb),e.Y36(x.F0),e.Y36(we.X))},it.\u0275cmp=e.Xpm({type:it,selectors:[["space-flow-find"]],features:[e._Bn([we.X])],decls:30,vars:20,consts:[["topbar","",1,""],["button","","btn","","matRipple","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],["filters",""],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","py-4"],[1,"text-xl","uppercase","font-medium","text-white"],[1,"flex","flex-col","items-center","sm:flex-row","space-x-0","sm:space-x-2"],["overlay","","buildings","","class","w-full sm:w-px sm:flex-1 h-[3.25rem]","appearance","outline",4,"ngIf"],["class","w-full sm:w-px sm:flex-1 h-[3.25rem]","overlay","","appearance","outline",4,"ngIf"],["overlay","","appearance","outline",1,"w-full","sm:w-px","sm:flex-1","h-[3.25rem]","hidden","sm:block"],["placeholder","Any Capacity",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","w-full sm:w-px sm:flex-1 h-[3.25rem] hidden sm:block","overlay","","appearance","outline",4,"ngIf"],[1,"flex-1","w-full","bg-gray-100","dark:bg-neutral-600","overflow-auto"],[4,"ngIf","ngIfElse"],["class","bg-white dark:bg-neutral-700 border-t border-gray-200",4,"ngIf"],["load_state",""],["empty_state",""],["overlay","","buildings","","appearance","outline",1,"w-full","sm:w-px","sm:flex-1","h-[3.25rem]"],["placeholder","Select Building...",3,"ngModel","ngModelChange"],[3,"value"],["overlay","","appearance","outline",1,"w-full","sm:w-px","sm:flex-1","h-[3.25rem]"],["placeholder","Level",3,"ngModel","ngModelChange"],["multiple","",3,"placeholder","ngModel","ngModelChange"],["class","w-[640px] max-w-[calc(100%-2rem)] mx-auto ",3,"space","multiple","book","bookChange",4,"ngFor","ngForOf"],[1,"p-4","text-center","opacity-60"],[1,"w-[640px]","max-w-[calc(100%-2rem)]","mx-auto",3,"space","multiple","book","bookChange"],[1,"bg-white","dark:bg-neutral-700","border-t","border-gray-200"],[1,"flex","items-center","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","p-2"],[1,"flex-1","underline",3,"matMenuTriggerFor"],["btn","","matRipple","",1,"w-32",3,"disabled","click"],["yPosition","above"],["menu","matMenu"],["class","flex items-center pointer-events-none leading-tight","mat-menu-item","",4,"ngFor","ngForOf"],["mat-menu-item","","class"," opacity-60",4,"ngIf"],["mat-menu-item","",1,"flex","items-center","pointer-events-none","leading-tight"],[1,"flex","flex-col","mr-4"],[1,"text-xs","opacity-70"],["icon","","matRipple","",1,"pointer-events-auto",3,"click"],["mat-menu-item","",1,"opacity-60"],[1,"h-full","w-full","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"],[1,"h-full","w-full","flex","flex-col","items-center","justify-center","space-y-2","p-8","text-center"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"a",1)(2,"div",2)(3,"app-icon",3),e._uU(4,"arrow_back"),e.qZA(),e.TgZ(5,"span",4),e._uU(6,"Back"),e.qZA()()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"h2",7),e._uU(10," Available Spaces "),e.qZA(),e.TgZ(11,"div",8),e.YNc(12,Ss,5,6,"mat-form-field",9),e.ALo(13,"async"),e.YNc(14,bs,6,8,"mat-form-field",10),e.ALo(15,"async"),e.TgZ(16,"mat-form-field",11)(17,"mat-select",12),e.NdJ("ngModelChange",function(_){return t.setOptions({capacity:_})}),e.ALo(18,"async"),e.YNc(19,Fs,2,2,"mat-option",13),e.qZA()(),e.YNc(20,ws,5,7,"mat-form-field",14),e.ALo(21,"async"),e.qZA()()(),e.TgZ(22,"div",15),e.YNc(23,Rs,3,4,"ng-container",16),e.ALo(24,"async"),e.qZA(),e.YNc(25,ks,10,5,"div",17),e.YNc(26,Ps,4,1,"ng-template",null,18,e.W1O),e.YNc(28,Us,3,0,"ng-template",null,19,e.W1O)),2&n){const i=e.MAs(27);let _,s,a,r;e.xp6(1),e.Q6J("routerLink",e.DdM(19,Ds)),e.xp6(11),e.Q6J("ngIf",(null==(_=e.lcZ(13,9,t.buildings))?null:_.length)>1),e.xp6(2),e.Q6J("ngIf",(null==(s=e.lcZ(15,11,t.levels))?null:s.length)>0),e.xp6(3),e.Q6J("ngModel",null==(a=e.lcZ(18,13,t.options))?null:a.capacity),e.xp6(2),e.Q6J("ngForOf",t.quick_capacities),e.xp6(1),e.Q6J("ngIf",null==(r=e.lcZ(21,15,t.features))?null:r.length),e.xp6(3),e.Q6J("ngIf",!e.lcZ(24,17,t.loading))("ngIfElse",i),e.xp6(2),e.Q6J("ngIf",t.multiple)}},dependencies:[l.sg,l.O5,T.o,C.ey,U.VK,U.OP,U.p6,S.KE,X.gD,w.Ou,C.wG,c.JJ,c.On,x.rH,ot,l.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:var(--secondary-dark)}[filters][_ngcontent-%COMP%]{background-color:var(--secondary)}"]});var Ls=d(9685),qs=d(2193);function Ks(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.ALo(3,"date"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.AsE(" at ",e.xi3(2,2,t.form.value.date,"shortTime")," ~ ",e.xi3(3,5,t.form.value.date+60*t.form.value.duration*1e3,"shortTime")," ")}}function Ws(o,n){1&o&&(e.TgZ(0,"button",23),e._uU(1," Map "),e.qZA())}function $s(o,n){if(1&o&&(e.TgZ(0,"div",21)(1,"span"),e._uU(2),e.qZA(),e.YNc(3,Ws,2,0,"button",22),e.qZA()),2&o){const t=n.$implicit,i=e.oxw();e.xp6(2),e.AsE("",t.display_name||t.name," [",(null==t.level?null:t.level.display_name)||(null==t.level?null:t.level.name),"]"),e.xp6(1),e.Q6J("ngIf",i.can_view_location)}}function Gs(o,n){if(1&o&&(e.TgZ(0,"div",24),e._UZ(1,"a-user-avatar",25),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("user",t),e.xp6(2),e.Oqu(t.name||t.email)}}function Js(o,n){if(1&o&&(e.TgZ(0,"div",31),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("matTooltip",i.optionsFor(t)),e.xp6(1),e.AsE(" ",t.options.length," option",1===t.options.length?"":"s"," selected ")}}function Ys(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",24)(1,"div",27)(2,"div",27),e._uU(3),e.qZA(),e.YNc(4,Js,2,3,"div",28),e.qZA(),e.TgZ(5,"div",29),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"a-counter",30),e.NdJ("ngModelChange",function(_){const a=e.CHM(t).$implicit;return e.KtG(a.quantity=_)}),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(3),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.options.length),e.xp6(2),e.hij(" ",e.xi3(7,4,t.total_cost/100,i.code)," "),e.xp6(2),e.Q6J("ngModel",t.quantity)}}const Pt=function(){return["/book","spaces","form"]};function Qs(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13)(2,"div",8)(3,"app-icon"),e._uU(4,"group"),e.qZA()(),e.TgZ(5,"div",9),e._uU(6),e.qZA(),e.TgZ(7,"button",26),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.show_catering=!_.show_catering)}),e._uU(8),e.qZA(),e.TgZ(9,"a",11),e._uU(10,"Edit"),e.qZA()(),e.TgZ(11,"div",15),e.YNc(12,Ys,9,7,"div",17),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(6),e.hij(" ",(null==t.form.value.catering[0]?null:t.form.value.catering[0].item_count)||0," Catering Item(s) "),e.xp6(2),e.hij(" ",t.show_people?"Hide":"Show"," "),e.xp6(1),e.Q6J("routerLink",e.DdM(6,Pt)),e.xp6(2),e.Udp("height",t.show_catering?3*(null==t.form.value.catering[0]?null:t.form.value.catering[0].items.length)+"rem":"0"),e.xp6(1),e.Q6J("ngForOf",null==t.form.value.catering[0]?null:t.form.value.catering[0].items)}}function Bs(o,n){1&o&&(e.TgZ(0,"span"),e._uU(1,"Confirm"),e.qZA())}function js(o,n){1&o&&e._UZ(0,"mat-spinner",32),2&o&&e.Q6J("diameter",24)}const Cn=function(){return["/book","spaces","find"]};class _t{constructor(n,t,i){var _=this;this._org=n,this._state=t,this._settings=i,this.show_spaces=!1,this.show_people=!1,this.show_catering=!1,this.loading=!1,this.postForm=(0,m.Z)(function*(){_.loading=!0,yield _._state.postForm().catch(s=>(0,p.cB)(s instanceof Object?s.message||"Bad Request":s)),_.loading=!1})}optionsFor(n){return n.options.map(t=>t.name).join("\n")}get can_view_location(){return!this._settings.get("app.no_maps")}get form(){return this._state.form}get code(){return this._org.currency_code}}function Hs(o,n){1&o&&(e.ynx(0),e._UZ(1,"space-flow-find"),e.BQk())}function Xs(o,n){1&o&&(e.ynx(0),e._UZ(1,"space-flow-confirm"),e.BQk())}function zs(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"flow-success",4),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("calendar",null==t.last_success?null:t.last_success.host)}}function Vs(o,n){1&o&&(e.ynx(0),e._UZ(1,"space-flow-form"),e.BQk())}_t.\u0275fac=function(n){return new(n||_t)(e.Y36(A.w7),e.Y36(k.MH),e.Y36(p.gb))},_t.\u0275cmp=e.Xpm({type:_t,selectors:[["space-flow-confirm"]],decls:60,vars:34,consts:[["topbar","",1,""],["button","","btn","","matRipple","",1,"clear","h-[2.75rem]","text-white",3,"routerLink"],[1,"flex","items-center","justify-center","h-full"],[1,"text-xl"],[1,"ml-2","mx-4"],[1,"flex","flex-col","items-center","space-y-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto","mb-4"],[1,"text-xl","uppercase","font-medium","w-full","my-4"],[1,"flex","items-center","py-2","space-x-2","border-b","border-gray-200","w-full"],[1,"p-2","rounded-full","bg-gray-300","dark:bg-neutral-600","mr-2"],[1,"flex-1","truncate"],[4,"ngIf"],["btn","","matRipple","",1,"clear","underline",3,"routerLink"],[1,"border-b","border-gray-200","w-full"],[1,"flex","items-center","py-2","space-x-2"],["matRipple","",1,"clear","bg-transparent","border-none","underline",3,"disabled","click"],["list","",1,"overflow-hidden"],["class","flex items-center h-10 pl-12",4,"ngFor","ngForOf"],["class","flex items-center h-12 pl-12 space-x-2",4,"ngFor","ngForOf"],["class","border-b border-gray-200 w-full",4,"ngIf"],["matRipple","","confirm","",1,"w-32",3,"disabled","click"],["class","mx-auto",3,"diameter",4,"ngIf"],[1,"flex","items-center","h-10","pl-12"],["matRipple","","class","bg-transparent border-none underline",4,"ngIf"],["matRipple","",1,"bg-transparent","border-none","underline"],[1,"flex","items-center","h-12","pl-12","space-x-2"],[1,"text-sm",3,"user"],["matRipple","",1,"clear","bg-transparent","border-none","underline",3,"click"],[1,"flex-1","w-1/2"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"],[1,"mx-auto",3,"diameter"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"a",1)(2,"div",2)(3,"app-icon",3),e._uU(4,"arrow_back"),e.qZA(),e.TgZ(5,"span",4),e._uU(6,"Back"),e.qZA()()()(),e.TgZ(7,"div",5)(8,"h2",6),e._uU(9," Your meeting details "),e.qZA(),e.TgZ(10,"div",7)(11,"div",8)(12,"app-icon"),e._uU(13,"event"),e.qZA()(),e.TgZ(14,"div",9),e._uU(15),e.ALo(16,"date"),e.YNc(17,Ks,4,8,"span",10),e.qZA(),e.TgZ(18,"a",11),e._uU(19,"Edit"),e.qZA()(),e.TgZ(20,"div",7)(21,"div",8)(22,"app-icon"),e._uU(23,"schedule"),e.qZA()(),e.TgZ(24,"div",9),e._uU(25),e.ALo(26,"duration"),e.qZA(),e.TgZ(27,"a",11),e._uU(28," Edit "),e.qZA()(),e.TgZ(29,"div",12)(30,"div",13)(31,"div",8)(32,"app-icon"),e._uU(33,"place"),e.qZA()(),e.TgZ(34,"div",9),e._uU(35),e.qZA(),e.TgZ(36,"button",14),e.NdJ("click",function(){return t.show_spaces=!t.show_spaces}),e._uU(37),e.qZA(),e.TgZ(38,"a",11),e._uU(39,"Edit"),e.qZA()(),e.TgZ(40,"div",15),e.YNc(41,$s,4,3,"div",16),e.qZA()(),e.TgZ(42,"div",12)(43,"div",13)(44,"div",8)(45,"app-icon"),e._uU(46,"group"),e.qZA()(),e.TgZ(47,"div",9),e._uU(48),e.qZA(),e.TgZ(49,"button",14),e.NdJ("click",function(){return t.show_people=!t.show_people}),e._uU(50),e.qZA(),e.TgZ(51,"a",11),e._uU(52,"Edit"),e.qZA()(),e.TgZ(53,"div",15),e.YNc(54,Gs,4,2,"div",17),e.qZA()(),e.YNc(55,Qs,13,7,"div",18),e.TgZ(56,"button",19),e.NdJ("click",function(){return t.postForm()}),e.YNc(57,Bs,2,0,"span",10),e.YNc(58,js,1,1,"mat-spinner",20),e.qZA()(),e._uU(59," < ")),2&n){let i,_,s,a,r,u,g,h;e.xp6(1),e.Q6J("routerLink",e.DdM(29,Cn)),e.xp6(14),e.hij(" ",e.xi3(16,24,t.form.value.date,"longDate")," "),e.xp6(2),e.Q6J("ngIf",!t.form.value.all_day),e.xp6(1),e.Q6J("routerLink",e.DdM(30,Pt)),e.xp6(7),e.hij(" ",t.form.value.all_day?"All Day":e.lcZ(26,27,t.form.value.duration)," "),e.xp6(2),e.Q6J("routerLink",e.DdM(31,Pt)),e.xp6(8),e.hij(" ",null==(i=t.form.get("resources"))||null==i.value?null:i.value.length," Space(s) "),e.xp6(1),e.Q6J("disabled",!(null!=(_=t.form.get("resources"))&&null!=_.value&&_.value.length)),e.xp6(1),e.hij(" ",t.show_spaces?"Hide":"Show"," "),e.xp6(1),e.Q6J("routerLink",e.DdM(32,Cn)),e.xp6(2),e.Udp("height",t.show_spaces?2.5*(null==(s=t.form.get("resources"))||null==s.value?null:s.value.length)+"rem":"0"),e.xp6(1),e.Q6J("ngForOf",null==(a=t.form.get("resources"))?null:a.value),e.xp6(7),e.hij(" ",(null==(r=t.form.get("attendees"))||null==r.value?null:r.value.length)||0," Attendee(s) "),e.xp6(1),e.Q6J("disabled",!(null!=(u=t.form.get("attendees"))&&null!=u.value&&u.value.length)),e.xp6(1),e.hij(" ",t.show_people?"Hide":"Show"," "),e.xp6(1),e.Q6J("routerLink",e.DdM(33,Pt)),e.xp6(2),e.Udp("height",t.show_people?3*(null==(g=t.form.get("attendees"))||null==g.value?null:g.value.length)+"rem":"0"),e.xp6(1),e.Q6J("ngForOf",null==(h=t.form.get("attendees"))?null:h.value),e.xp6(1),e.Q6J("ngIf",null==t.form.value.catering?null:t.form.value.catering.length),e.xp6(1),e.Q6J("disabled",t.loading),e.xp6(1),e.Q6J("ngIf",!t.loading),e.xp6(1),e.Q6J("ngIf",t.loading)}},dependencies:[l.sg,l.O5,T.o,Ls.k,w.Ou,Pe.R,C.wG,H.gM,c.JJ,c.On,x.rH,l.H9,l.uU,qs.u],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[topbar][_ngcontent-%COMP%]{background-color:#00539f}[list][_ngcontent-%COMP%]{transition:height .2s}"]});class st extends p.KG{constructor(n,t){super(),this._state=n,this._route=t}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.loadForm(),this._state.form||this._state.newForm(),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView(n.get("success"))}))}}st.\u0275fac=function(n){return new(n||st)(e.Y36(k.MH),e.Y36(x.gz))},st.\u0275cmp=e.Xpm({type:st,selectors:[["placeos-book-space-flow"]],features:[e.qOj],decls:6,vars:4,consts:[[1,"bg-white","dark:bg-neutral-700","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"calendar"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.ynx(1,1),e.YNc(2,Hs,2,0,"ng-container",2),e.YNc(3,Xs,2,0,"ng-container",2),e.YNc(4,zs,2,1,"ng-container",2),e.YNc(5,Vs,2,0,"ng-container",3),e.BQk(),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngSwitch",t.view),e.xp6(1),e.Q6J("ngSwitchCase","find"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"),e.xp6(1),e.Q6J("ngSwitchCase","success"))},dependencies:[l.RF,l.n9,l.ED,nt,it,_t,te],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}"]});var ea=d(4322),ta=d(8461);const na=function(){return{}};function oa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.setDate(s.id))}),e.ALo(1,"async"),e.TgZ(2,"p",15),e._uU(3),e.qZA(),e.TgZ(4,"p",16),e._uU(5),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"p",17),e._uU(8,"Available"),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw(2);let _;e.ekj("selected",t.id===(null==(_=e.lcZ(1,4,i.options))?null:_.date)),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.hij(" ",(e.lcZ(6,6,i.counts)||e.DdM(8,na))[t.id]||"0"," ")}}function ia(o,n){if(1&o&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}function _a(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",18)(1,"mat-form-field",19)(2,"mat-select",20),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setLevel(null==_?null:_.id))}),e.ALo(3,"async"),e.YNc(4,ia,2,2,"mat-option",21),e.ALo(5,"async"),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngModel",e.lcZ(3,2,t.level)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(5,4,t.levels))}}function sa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.setActive(s))}),e.ALo(1,"async"),e.TgZ(2,"div",24),e._uU(3),e.qZA(),e.TgZ(4,"div",25),e._uU(5),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw(2);let _;e.ekj("active",(null==(_=e.lcZ(1,4,i.active_space))?null:_.id)===t.id),e.xp6(3),e.hij("Bay No. ",t.name,""),e.xp6(2),e.hij(" ",i.levelName(t.zone_id)," ")}}function aa(o,n){1&o&&(e.TgZ(0,"p",29),e._uU(1," Note that your existing parking space reservation will be replaced "),e.qZA())}function la(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",26)(1,"p"),e._uU(2),e.ALo(3,"async"),e.qZA(),e.YNc(4,aa,2,0,"p",27),e.ALo(5,"async"),e.TgZ(6,"button",28),e.NdJ("click",function(){e.CHM(t);const _=e.oxw(2);return e.KtG(_.reserveSpace())}),e._uU(7," Reserve Space "),e.qZA()()}if(2&o){const t=e.oxw(2);let i;e.xp6(2),e.hij(" Parking Bay No. ",e.lcZ(3,2,t.active_space).name," selected. "),e.xp6(2),e.Q6J("ngIf",null==(i=e.lcZ(5,4,t.existing))?null:i.length)}}function ra(o,n){if(1&o&&(e.TgZ(0,"div",30)(1,"p"),e._uU(2),e.ALo(3,"async"),e.ALo(4,"async"),e.qZA()()),2&o){const t=e.oxw(2);let i;e.xp6(2),e.hij(" Parking is not available for ",(null==(i=e.lcZ(3,1,t.building))?null:i.display_name)||(null==(i=e.lcZ(4,3,t.building))?null:i.name)," ")}}function ca(o,n){if(1&o&&(e.TgZ(0,"div",2)(1,"div",3),e.YNc(2,oa,9,9,"button",4),e.qZA(),e.TgZ(3,"div",5)(4,"div",6),e.YNc(5,_a,6,6,"div",7),e.ALo(6,"async"),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"async"),e.qZA(),e.YNc(10,sa,6,6,"button",8),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"div",9),e._UZ(13,"i-map",10),e.ALo(14,"async"),e.ALo(15,"async"),e.ALo(16,"async"),e.ALo(17,"async"),e.ALo(18,"async"),e.ALo(19,"async"),e.ALo(20,"async"),e._UZ(21,"explore-zoom-controls",11),e.qZA(),e.YNc(22,la,8,6,"div",12),e.ALo(23,"async"),e.YNc(24,ra,5,5,"div",13),e.ALo(25,"async"),e.qZA()()),2&o){const t=e.oxw();let i,_,s,a,r;e.xp6(2),e.Q6J("ngForOf",t.dates),e.xp6(3),e.Q6J("ngIf",(null==(i=e.lcZ(6,13,t.levels))?null:i.length)>1),e.xp6(3),e.hij("",null==(_=e.lcZ(9,15,t.available))?null:_.length," space(s) available"),e.xp6(2),e.Q6J("ngForOf",e.lcZ(11,17,t.available)),e.xp6(3),e.Q6J("src",e.lcZ(14,19,t.url))("zoom",null==(s=e.lcZ(15,21,t.positions))?null:s.zoom)("center",null==(a=e.lcZ(16,23,t.positions))?null:a.center)("styles",e.lcZ(17,25,t.styles))("features",e.lcZ(18,27,t.features))("actions",e.lcZ(19,29,t.actions))("labels",e.lcZ(20,31,t.labels)),e.xp6(9),e.Q6J("ngIf",e.lcZ(23,33,t.active_space)),e.xp6(2),e.Q6J("ngIf",!(null!=(r=e.lcZ(25,35,t.levels))&&r.length))}}function da(o,n){1&o&&(e.TgZ(0,"div",32),e._UZ(1,"mat-spinner",33),e.TgZ(2,"p"),e._uU(3,"Reserving parking space..."),e.qZA()())}function pa(o,n){if(1&o&&(e.YNc(0,da,4,0,"div",31),e.ALo(1,"async")),2&o){const t=e.oxw();let i;e.Q6J("ngIf",!(null!=(i=e.lcZ(1,1,t.levels))&&i.length))}}class at extends p.KG{constructor(n){super(),this._details=n,this.zoom=1,this.ratio=1,this.subscription("zoom",this._details.zoom$?.subscribe(t=>this.zoom=t)),this.subscription("ratio",this._details.ratio$?.subscribe(t=>this.ratio=t))}}at.\u0275fac=function(n){return new(n||at)(e.Y36(Dt.ui))},at.\u0275cmp=e.Xpm({type:at,selectors:[["space-ping"]],features:[e.qOj],decls:2,vars:2,consts:[[1,"absolute","inset-0","pointer-events-auto"],[1,"absolute","inset-0","animate-ping","border-4","border-green-600"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.qZA()),2&n&&e.Udp("transform","scale("+t.zoom*t.ratio+")")},encapsulation:2});class lt extends p.KG{constructor(n,t,i,_,s){var a;super(),a=this,this._state=n,this._parking=t,this._org=i,this._booking=_,this._router=s,this.url=this._state.map_url,this.styles=this._state.map_styles,this.positions=this._state.map_positions,this.features=this._state.map_features,this.actions=this._state.map_actions,this.labels=this._state.map_labels,this.building=this._org.active_building,this.level=this._state.level,this.levels=this._parking.levels,this.available=this._parking.available_spaces,this.counts=this._parking.week_availablility,this.options=this._parking.options,this.existing=this._parking.existing_event,this.loading=this._booking.loading,this.active_space=new N.X(null),this.dates=new Array(7).fill(0).map((r,u)=>({id:(0,qt.Z)((0,ee.Z)(Date.now(),u)).valueOf(),name:(0,un.Z)((0,ee.Z)(Date.now(),u),"EEE, dd MMM"),available:0})),this.setDate=r=>this._parking.setOptions({date:r}),this.setLevel=r=>this._state.setLevel(r),this.reserveSpace=(0,m.Z)(function*(){const r=yield a._parking.existing_event.pipe((0,I.q)(1)).toPromise();r.length&&a._booking.form.patchValue({id:r[0].id}),yield a._booking.postForm(),a._router.navigate(["book","parking","success"])})}levelName(n){const t=this._org.levelWithID([n]);return t?.display_name||t?.name||""}setActive(n){n===this.active_space.getValue()?this.active_space.next(null):(this._booking.form.patchValue({asset_id:n.id,asset_name:n.name}),this.active_space.next(n))}ngOnInit(){var n=this;return(0,m.Z)(function*(){yield n._org.initialised.pipe((0,Z.P)(t=>t)).toPromise(),n._state.reset(),n.subscription("levels",n._parking.levels.subscribe(t=>{n._state.setLevel(t[0]?.id)})),n.subscription("spaces",n._parking.available_spaces.subscribe(t=>{n._state.setActions("parking_spaces",(t||[]).map(i=>({id:i.map_id,action:"click",callback:()=>n.setActive(i)})))})),n.subscription("active_space",n.active_space.subscribe(t=>{if(!t)return n._state.setFeatures("parking_space",[]);n._state.setFeatures("parking_space",[{location:t.map_id,content:at,full_size:!0,z_index:0}])}))})()}}lt.\u0275fac=function(n){return new(n||lt)(e.Y36(ke.ck),e.Y36(ke.pi),e.Y36(A.w7),e.Y36(E.fy),e.Y36(x.F0))},lt.\u0275cmp=e.Xpm({type:lt,selectors:[["parking-flow-map"]],features:[e._Bn([ke.pi]),e.qOj],decls:4,vars:4,consts:[["class","w-full h-full flex flex-col items-center relative",4,"ngIf","ngIfElse"],["load_state",""],[1,"w-full","h-full","flex","flex-col","items-center","relative"],[1,"p-4","flex","items-center","justify-center","bg-secondary","w-full","shadow","z-10","text-white","space-x-2"],["matRipple","","class","border border-white flex flex-col items-center justify-center h-24 w-28 rounded",3,"selected","click",4,"ngFor","ngForOf"],[1,"flex","w-full","h-1/2","flex-1","z-0"],[1,"p-2","sm:w-[18rem]","w-full","h-full","bg-gray-50","dark:bg-neutral-600","shadow","border-r","border-gray-200","dark:border-neutral-500","z-10","overflow-auto","space-y-2"],["class","bg-white dark:bg-neutral-700 sticky top-0 w-full z-10",4,"ngIf"],["matRipple","","class","flex items-center justify-between bg-white dark:bg-neutral-700 rounded-lg border border-gray-200 p-2 w-full",3,"active","click",4,"ngFor","ngForOf"],[1,"bg-gray-200","dark:bg-neutral-600","flex-1","w-1/2","h-full","z-0","relative","hidden","sm:block"],[3,"src","zoom","center","styles","features","actions","labels"],[1,"absolute","bottom-0","right-0"],["class","absolute left-1/2 bottom-2 -translate-x-1/2 bg-white dark:bg-neutral-800 shadow rounded p-4 flex flex-col space-y-2",4,"ngIf"],["class","absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-50",4,"ngIf"],["matRipple","",1,"border","border-white","flex","flex-col","items-center","justify-center","h-24","w-28","rounded",3,"click"],[1,"mb-2","font-medium"],[1,"text-2xl"],[1,"text-sm"],[1,"bg-white","dark:bg-neutral-700","sticky","top-0","w-full","z-10"],["appearance","outline",1,"w-full","h-[3.25rem]"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["matRipple","",1,"flex","items-center","justify-between","bg-white","dark:bg-neutral-700","rounded-lg","border","border-gray-200","p-2","w-full",3,"click"],[1,"text-lg"],[1,"opacity-60"],[1,"absolute","left-1/2","bottom-2","-translate-x-1/2","bg-white","dark:bg-neutral-800","shadow","rounded","p-4","flex","flex-col","space-y-2"],["class","p-2 rounded text-sm max-w-[20rem] text-center text-pending leading-tight",4,"ngIf"],["btn","","matRipple","",3,"click"],[1,"p-2","rounded","text-sm","max-w-[20rem]","text-center","text-pending","leading-tight"],[1,"absolute","inset-0","bg-white/80","flex","flex-col","items-center","justify-center","z-50"],["class","absolute inset-0 bg-white/80 flex flex-col items-center justify-center z-50 space-y-2",4,"ngIf"],[1,"absolute","inset-0","bg-white/80","flex","flex-col","items-center","justify-center","z-50","space-y-2"],["diameter","32"]],template:function(n,t){if(1&n&&(e.YNc(0,ca,26,37,"div",0),e.ALo(1,"async"),e.YNc(2,pa,2,3,"ng-template",null,1,e.W1O)),2&n){const i=e.MAs(3);e.Q6J("ngIf",!e.lcZ(1,2,t.loading))("ngIfElse",i)}},dependencies:[l.sg,l.O5,gn.p,C.ey,S.KE,X.gD,w.Ou,C.wG,c.JJ,c.On,ta.s,l.Ov],styles:[".active[_ngcontent-%COMP%]{background-color:var(--primary)!important;color:#fff}.selected[_ngcontent-%COMP%]{background-color:#fff!important;color:#000d}"]});class Me{}function ua(o,n){1&o&&(e.ynx(0),e._UZ(1,"parking-flow-confirm"),e.BQk())}function ga(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"flow-success",4),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("calendar",null==t.last_success?null:t.last_success.host)}}function ma(o,n){1&o&&(e.ynx(0),e._UZ(1,"parking-flow-map"),e.BQk())}Me.\u0275fac=function(n){return new(n||Me)},Me.\u0275cmp=e.Xpm({type:Me,selectors:[["parking-flow-confirm"]],decls:0,vars:0,template:function(n,t){}});class rt extends p.KG{constructor(n,t){super(),this._state=n,this._route=t}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.setOptions({type:"parking"}),this._state.loadForm(),this._state.form||this._state.newForm(),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView(n.get("success"))}))}}rt.\u0275fac=function(n){return new(n||rt)(e.Y36(E.fy),e.Y36(x.gz))},rt.\u0275cmp=e.Xpm({type:rt,selectors:[["placeos-book-parking-flow"]],features:[e.qOj],decls:5,vars:3,consts:[[1,"bg-white","dark:bg-neutral-700","h-full","w-full"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["route","parking","type","parking",3,"calendar"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.ynx(1,1),e.YNc(2,ua,2,0,"ng-container",2),e.YNc(3,ga,2,1,"ng-container",2),e.YNc(4,ma,2,0,"ng-container",3),e.BQk(),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngSwitch",t.view),e.xp6(1),e.Q6J("ngSwitchCase","confirm"),e.xp6(1),e.Q6J("ngSwitchCase","success"))},dependencies:[l.RF,l.n9,l.ED,lt,Me,te],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}"]});var fa=d(3149),Tn=d(7739),xn=d(7202);function ha(o,n){1&o&&(e.TgZ(0,"button",19)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function Ca(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",10)(2,"app-icon"),e._uU(3,"meeting_room"),e.qZA(),e.TgZ(4,"div"),e._uU(5),e.qZA()(),e.BQk()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(5),e.AsE(" ",(null==i.level?null:i.level.display_name)||(null==i.level?null:i.level.name),", ",t.display_name||t.name," ")}}function Ta(o,n){if(1&o&&(e.TgZ(0,"div",7)(1,"div",8)(2,"app-icon"),e._uU(3,"done"),e.qZA()(),e.TgZ(4,"h3",9),e.SDv(5,20),e.qZA(),e.YNc(6,Ca,6,2,"ng-container",21),e.TgZ(7,"div",10)(8,"app-icon"),e._uU(9,"place"),e.qZA(),e.TgZ(10,"div"),e._uU(11),e.qZA()()()),2&o){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",t.event.resources),e.xp6(5),e.Oqu(t.location)}}function xa(o,n){if(1&o&&(e.TgZ(0,"mat-chip")(1,"app-icon",27),e._uU(2,"business"),e.qZA(),e._uU(3),e.qZA()),2&o){const t=n.$implicit;e.xp6(3),e.hij(" ",t.name||t.email," ")}}function va(o,n){if(1&o&&(e.TgZ(0,"div",22)(1,"div",8)(2,"app-icon"),e._uU(3,"done"),e.qZA()(),e.TgZ(4,"h3",9),e.SDv(5,23),e.qZA(),e.TgZ(6,"div",24)(7,"mat-chip-list",25,26),e.YNc(9,xa,4,1,"mat-chip",21),e.qZA()()()),2&o){const t=e.oxw();e.xp6(5),e.pQV(t.event.attendees.length)(t.event.attendees.length),e.QtT(5),e.xp6(4),e.Q6J("ngForOf",t.event.attendees)}}function Oa(o,n){if(1&o&&(e.TgZ(0,"div",39)(1,"div",32),e._uU(2),e.qZA()()),2&o){const t=n.$implicit;e.Q6J("matTooltip",t.name),e.xp6(2),e.hij(" ",t.name," ")}}function Ea(o,n){if(1&o&&(e.TgZ(0,"div",40),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" ",e.xi3(2,1,t.unit_price_with_options/100,i.code)," ea ")}}function Sa(o,n){if(1&o&&(e.TgZ(0,"div",10)(1,"div",34),e._uU(2),e.qZA(),e.TgZ(3,"div",35),e._uU(4),e.qZA(),e.TgZ(5,"div",10),e.YNc(6,Oa,3,2,"div",36),e.qZA(),e.YNc(7,Ea,3,4,"div",37),e.TgZ(8,"div",38),e._uU(9),e.ALo(10,"currency"),e.qZA()()),2&o){const t=n.$implicit,i=e.oxw(3);e.xp6(2),e.hij(" \xd7",t.quantity," "),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Q6J("ngForOf",t.option_list),e.xp6(1),e.Q6J("ngIf",t.quantity>1),e.xp6(2),e.hij(" ",e.xi3(10,5,t.total_cost/100,i.code)," ")}}function Aa(o,n){if(1&o&&(e.TgZ(0,"div",7)(1,"div",8)(2,"app-icon"),e._uU(3,"done"),e.qZA()(),e.TgZ(4,"h3",9),e.SDv(5,28),e.qZA(),e.TgZ(6,"div",29),e.YNc(7,Sa,11,8,"div",30),e.TgZ(8,"div",31)(9,"div",32),e._uU(10,"Total:"),e.qZA(),e.TgZ(11,"div",33),e._uU(12),e.ALo(13,"currency"),e.qZA()()()()),2&o){const t=e.oxw(2);e.xp6(7),e.Q6J("ngForOf",t.catering_order),e.xp6(5),e.hij(" ",e.xi3(13,2,t.catering_order.total_cost/100,t.code)," ")}}function ba(o,n){if(1&o&&(e.TgZ(0,"div",43)(1,"div",44),e._uU(2),e.qZA(),e.TgZ(3,"div",35),e._uU(4),e.qZA()()),2&o){const t=n.$implicit;e.xp6(2),e.hij(" ",t.amount," "),e.xp6(2),e.Oqu(t.name)}}function Fa(o,n){if(1&o&&(e.TgZ(0,"div",7)(1,"div",8)(2,"app-icon"),e._uU(3,"done"),e.qZA()(),e.TgZ(4,"h3",9),e.SDv(5,41),e.qZA(),e.YNc(6,ba,5,2,"div",42),e.qZA()),2&o){const t=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",t.event.assets)}}function Na(o,n){if(1&o&&(e.TgZ(0,"div",6),e.YNc(1,Aa,14,5,"div",13),e.YNc(2,Fa,7,1,"div",13),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null==t.event.catering?null:t.event.catering.length),e.xp6(1),e.Q6J("ngIf",null==t.event.assets?null:t.event.assets.length)}}function wa(o,n){if(1&o&&(e.TgZ(0,"div",22)(1,"div",8)(2,"app-icon"),e._uU(3,"done"),e.qZA()(),e.TgZ(4,"h3",9),e.SDv(5,45),e.qZA(),e._UZ(6,"div",46),e.ALo(7,"sanitize"),e.qZA()),2&o){const t=e.oxw();e.xp6(6),e.Q6J("innerHTML",e.lcZ(7,1,t.event.body),e.oJD)}}function Ma(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.postForm())}),e.SDv(1,48),e.qZA()}}function Za(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.cancelPost())}),e.SDv(1,50),e.qZA()}}class ct extends p.KG{constructor(n,t,i,_){var s;super(),s=this,this._event_form=n,this._org=t,this._space_pipe=i,this._dialog_ref=_,this.show_close=!1,this.loading=this._event_form.loading,this.catering_order=this.event.catering[0]?.items||this.event.catering||[],this.postForm=(0,m.Z)(function*(){yield s._event_form.postForm().catch(a=>{throw(0,p.cB)(a),a}),s.dismiss(!0)}),this.cancelPost=()=>this._event_form.cancelPostForm(),this.dismiss=a=>this._dialog_ref?.close(a),this._space=this.event.resources[0]}ngOnInit(){var n=this;return(0,m.Z)(function*(){n._space=(yield n._space_pipe.transform(n.event.resources[0].email))||n._space})()}get event(){return this._event_form.form.value}get space(){return this.event.resources[0]}get level(){return this._org.levelWithID(this.space.zones)}get location(){const n=this._org.buildings.find(t=>this.space.zones.includes(t.id));return n?.address||n?.display_name||n?.name}get code(){return this._org.currency_code}}function Ra(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.dismiss())}),e.TgZ(1,"app-icon"),e._uU(2,"close"),e.qZA()()}}function ya(o,n){1&o&&e._UZ(0,"mat-spinner",16)}function Ia(o,n){if(1&o&&(e.TgZ(0,"mat-chip")(1,"app-icon",23),e._uU(2,"business"),e.qZA(),e._uU(3),e.qZA()),2&o){const t=n.$implicit;e.xp6(3),e.hij(" ",t.name||t.email," ")}}function ka(o,n){if(1&o&&(e.TgZ(0,"section",17)(1,"app-icon",5),e._uU(2,"done"),e.qZA(),e.TgZ(3,"div",6)(4,"h3"),e.SDv(5,18),e.qZA(),e.TgZ(6,"div",19)(7,"mat-chip-list",20,21),e.YNc(9,Ia,4,1,"mat-chip",22),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(5),e.pQV(t.event.attendees.length)(t.event.attendees.length),e.QtT(5),e.xp6(4),e.Q6J("ngForOf",t.event.attendees)}}function Pa(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",7)(2,"app-icon"),e._uU(3,"meeting_room"),e.qZA(),e.TgZ(4,"div"),e._uU(5),e.qZA()(),e.BQk()),2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(5),e.AsE(" ",(null==i.level?null:i.level.display_name)||(null==i.level?null:i.level.name),", ",t.display_name||t.name," ")}}function Ua(o,n){if(1&o&&(e.TgZ(0,"section",24)(1,"app-icon",5),e._uU(2,"done"),e.qZA(),e.TgZ(3,"div",6)(4,"h3"),e.SDv(5,25),e.qZA(),e.YNc(6,Pa,6,2,"ng-container",22),e.TgZ(7,"div",7)(8,"app-icon"),e._uU(9,"place"),e.qZA(),e.TgZ(10,"div"),e._uU(11),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",t.event.resources),e.xp6(5),e.Oqu(t.location)}}function Da(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.postForm())}),e.SDv(1,27),e.qZA()}}function La(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.cancelPost())}),e.SDv(1,29),e.qZA()}}ct.\u0275fac=function(n){return new(n||ct)(e.Y36(k.MH),e.Y36(A.w7),e.Y36(we.X),e.Y36(v.so,8))},ct.\u0275cmp=e.Xpm({type:ct,selectors:[["meeting-flow-confirm-modal"]],inputs:{show_close:"show_close"},features:[e._Bn([we.X]),e.qOj],decls:36,vars:27,consts:function(){let o,n,t,i,_,s,a,r,u;return o=$localize`:␟0cd25444b7557b2f0c8453f99ac6ac586e2734ef␟5359169455682005018:Confirm Meeting booking`,n=$localize`:␟7ace4094f7f2f91e71cf8e2a5602a04062a20a47␟2833154702556922571:Booked Room`,t=$localize`:␟c5594e72436351a54e7ea9bf29633f268a7fb4cc␟2881938321285403712:{VAR_PLURAL, plural, =1 {Attendee } other {Attendees }}`,t=e.Zx4(t,{VAR_PLURAL:"\ufffd1\ufffd"}),i=$localize`:␟fefdc4e5a41940aedc80a7f0018e6d80486047f5␟1751846422096489161: ${"\ufffd0\ufffd"}:INTERPOLATION: ${t}:ICU: `,_=$localize`:␟c83ae01dc090addaaeb41ad9255bc2321f333169␟5431495212207850952:Catering`,s=$localize`:␟ee8f8008bae6ce3a49840c4e1d39b4af23d4c263␟1647750822609779679:Assets`,a=$localize`:␟fcde58253a4cfd52c228eebdae74e1be7a1ab714␟8104421162933956065:Notes`,r=$localize`:␟0ad83be7464a0a2e8d100342e144bc3fbc789f9d␟3141803775366633134: Confirm `,u=$localize`:␟3246106df0ffbc1a4aaee22a096777a223ef992b␟9045980436739109169: Undo `,[["header","",1,"p-4","flex","items-center","justify-center","border-b","border-grey-200","relative"],["icon","","matRipple","","mat-dialog-close","","class","absolute left-2 top-1/2 -translate-y-1/2",4,"ngIf"],[1,"text-xl","font-medium"],o,["diameter","32",1,"absolute","right-0","top-1/2","-translate-y-1/2"],[1,"min-w-[48rem]","divide-y","divide-gray-300","p-4","space-y-4"],[1,"flex","divide-x","divide-gray-300"],[1,"pr-4","py-4","pl-16","relative","space-y-2","flex-1"],[1,"absolute","top-4","left-4","flex","items-center","justify-center","rounded-full","border","border-success","text-success","text-2xl"],[1,"text-xl","!mt-0"],[1,"flex","items-center","space-x-2"],["date",""],["time",""],["class","pr-4 py-4 pl-16 relative space-y-2 flex-1",4,"ngIf"],["class","pr-4 py-4 pl-16 relative space-y-2",4,"ngIf"],["class","flex divide-x divide-gray-300",4,"ngIf"],[1,"p-2","border-t","border-gray-200","flex","items-center","justify-end"],["btn","","matRipple","","class","w-32",3,"click",4,"ngIf"],["btn","","matRipple","","class","inverse w-32",3,"click",4,"ngIf"],["icon","","matRipple","","mat-dialog-close","",1,"absolute","left-2","top-1/2","-translate-y-1/2"],n,[4,"ngFor","ngForOf"],[1,"pr-4","py-4","pl-16","relative","space-y-2"],i,["attendee-list",""],["aria-label","User selection"],["chipList",""],[1,"mr-2"],_,[1,"space-y-2"],["class","flex items-center space-x-2",4,"ngFor","ngForOf"],[1,"w-full","bg-gray-200","flex","justify-end","p-2"],[1,"font-medium"],[1,"font-mono","text-right","min-w-[6rem]"],["count","",1,"flex","items-center","justify-center","min-w-[2rem]","h-8","rounded-full","bg-gray-200"],["name","",1,"flex-1"],["class","flex items-center text-xs px-2 py-1 rounded-2xl bg-gray-100",3,"matTooltip",4,"ngFor","ngForOf"],["price","","class","font-mono text-right p-2 text-sm",4,"ngIf"],["total-price","",1,"font-mono","min-w-[6rem]","text-right","p-2"],[1,"flex","items-center","text-xs","px-2","py-1","rounded-2xl","bg-gray-100",3,"matTooltip"],["price","",1,"font-mono","text-right","p-2","text-sm"],s,["class","flex items-center",4,"ngFor","ngForOf"],[1,"flex","items-center"],["count","",1,"flex","items-center","justify-center","w-12","h-12","rounded-full"],a,[3,"innerHTML"],["btn","","matRipple","",1,"w-32",3,"click"],r,["btn","","matRipple","",1,"inverse","w-32",3,"click"],u]},template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,ha,3,0,"button",1),e.TgZ(2,"h2",2),e.SDv(3,3),e.qZA(),e._UZ(4,"mat-spinner",4),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"main",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"app-icon"),e._uU(11,"done"),e.qZA()(),e.TgZ(12,"h3",9),e._uU(13),e.qZA(),e.TgZ(14,"div",10)(15,"app-icon"),e._uU(16,"calendar_today"),e.qZA(),e.TgZ(17,"div",11),e._uU(18),e.ALo(19,"date"),e.qZA()(),e.TgZ(20,"div",10)(21,"app-icon"),e._uU(22,"schedule"),e.qZA(),e.TgZ(23,"div",12),e._uU(24),e.ALo(25,"date"),e.ALo(26,"date"),e.qZA()()(),e.YNc(27,Ta,12,2,"div",13),e.qZA(),e.YNc(28,va,10,3,"div",14),e.YNc(29,Na,3,2,"div",15),e.YNc(30,wa,8,3,"div",14),e.qZA(),e.TgZ(31,"footer",16),e.YNc(32,Ma,2,0,"button",17),e.ALo(33,"async"),e.YNc(34,Za,2,0,"button",18),e.ALo(35,"async"),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",t.show_close),e.xp6(3),e.ekj("opacity-0",!e.lcZ(5,12,t.loading)),e.xp6(9),e.Oqu(t.event.title),e.xp6(5),e.Oqu(e.xi3(19,14,t.event.date,"fullDate")),e.xp6(6),e.hij(" ",t.event.all_day?"All Day":e.xi3(25,17,t.event.date,"shortTime")+" - "+e.xi3(26,20,t.event.date+60*t.event.duration*1e3,"h:mm a (z)")," "),e.xp6(3),e.Q6J("ngIf",t.event.resources.length),e.xp6(1),e.Q6J("ngIf",t.event.attendees.length),e.xp6(1),e.Q6J("ngIf",(null==t.event.catering?null:t.event.catering.length)||(null==t.event.assets?null:t.event.assets.length)),e.xp6(1),e.Q6J("ngIf",t.event.body),e.xp6(2),e.Q6J("ngIf",!e.lcZ(33,23,t.loading)),e.xp6(2),e.Q6J("ngIf",e.lcZ(35,25,t.loading)))},dependencies:[l.sg,l.O5,T.o,v.ZT,w.Ou,pe.HS,C.wG,H.gM,l.Ov,l.H9,l.uU,xn.n]});class Ze extends p.KG{constructor(n,t,i,_){var s;super(),s=this,this._event_form=n,this._org=t,this._space_pipe=i,this._sheet_ref=_,this.show_close=!1,this.loading=this._event_form.loading,this.postForm=(0,m.Z)(function*(){yield s._event_form.postForm().catch(a=>{throw(0,p.cB)(a),a}),s.dismiss(!0)}),this.cancelPost=()=>this._event_form.cancelPostForm(),this.dismiss=a=>this._sheet_ref?.dismiss(a),this._space=this.event.resources[0]}ngOnInit(){var n=this;return(0,m.Z)(function*(){n._space=(yield n._space_pipe.transform(n.event.resources[0].email))||n._space})()}get event(){return this._event_form.form.value}get space(){return this._space}get level(){return this._org.levelWithID(this.space.zones)}get location(){const n=this._org.buildings.find(t=>this.space.zones.includes(t.id));return n?.address||n?.display_name||n?.name}}Ze.\u0275fac=function(n){return new(n||Ze)(e.Y36(k.MH),e.Y36(A.w7),e.Y36(we.X),e.Y36(B.oL,8))},Ze.\u0275cmp=e.Xpm({type:Ze,selectors:[["meeting-flow-confirm"]],inputs:{show_close:"show_close"},features:[e._Bn([we.X]),e.qOj],decls:32,vars:24,consts:function(){let o,n,t,i,_,s;return o=$localize`:␟0cd25444b7557b2f0c8453f99ac6ac586e2734ef␟5359169455682005018:Confirm Meeting booking`,n=$localize`:␟4b21718d2cf1162c66e915d086412945cb82f5c5␟2503133629493199843:{VAR_PLURAL, plural, =1 {attendee } other {attendees }}`,n=e.Zx4(n,{VAR_PLURAL:"\ufffd1\ufffd"}),t=$localize`:␟107fd539cb631844739e297e9d5474c7fec90b32␟5235780670058538300: ${"\ufffd0\ufffd"}:INTERPOLATION: ${n}:ICU: `,i=$localize`:␟7ace4094f7f2f91e71cf8e2a5602a04062a20a47␟2833154702556922571:Booked Room`,_=$localize`:␟0ad83be7464a0a2e8d100342e144bc3fbc789f9d␟3141803775366633134: Confirm `,s=$localize`:␟3246106df0ffbc1a4aaee22a096777a223ef992b␟9045980436739109169: Undo `,[["icon","","matRipple","",3,"click",4,"ngIf"],[1,"flex","items-center","justify-between","px-2"],o,["diameter","32",4,"ngIf"],["period","",1,"flex","space-x-1","px-2"],[1,"text-success","mt-1"],["details","",1,"leading-6"],[1,"flex","items-center","space-x-2"],["date",""],["time",""],["attendees","","class","flex space-x-1 px-2",4,"ngIf"],["spaces","","class","flex space-x-1 px-2",4,"ngIf"],[1,"p-2","w-full","border-t","border-gray-200","mt-4"],["btn","","matRipple","","class","w-full",3,"click",4,"ngIf"],["btn","","matRipple","","class","inverse w-full",3,"click",4,"ngIf"],["icon","","matRipple","",3,"click"],["diameter","32"],["attendees","",1,"flex","space-x-1","px-2"],t,["attendee-list",""],["aria-label","User selection"],["chipList",""],[4,"ngFor","ngForOf"],[1,"mr-2"],["spaces","",1,"flex","space-x-1","px-2"],i,["btn","","matRipple","",1,"w-full",3,"click"],_,["btn","","matRipple","",1,"inverse","w-full",3,"click"],s]},template:function(n,t){1&n&&(e.YNc(0,Ra,3,0,"button",0),e.TgZ(1,"header",1)(2,"h2"),e.SDv(3,2),e.qZA(),e.YNc(4,ya,1,0,"mat-spinner",3),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"section",4)(7,"app-icon",5),e._uU(8,"done"),e.qZA(),e.TgZ(9,"div",6)(10,"h3"),e._uU(11),e.qZA(),e.TgZ(12,"div",7)(13,"app-icon"),e._uU(14,"calendar_today"),e.qZA(),e.TgZ(15,"div",8),e._uU(16),e.ALo(17,"date"),e.qZA()(),e.TgZ(18,"div",7)(19,"app-icon"),e._uU(20,"schedule"),e.qZA(),e.TgZ(21,"div",9),e._uU(22),e.ALo(23,"date"),e.ALo(24,"date"),e.qZA()()()(),e.YNc(25,ka,10,3,"section",10),e.YNc(26,Ua,12,2,"section",11),e.TgZ(27,"footer",12),e.YNc(28,Da,2,0,"button",13),e.ALo(29,"async"),e.YNc(30,La,2,0,"button",14),e.ALo(31,"async"),e.qZA()),2&n&&(e.Q6J("ngIf",t.show_close),e.xp6(4),e.Q6J("ngIf",e.lcZ(5,9,t.loading)),e.xp6(7),e.Oqu(t.event.title||"~Untitled~"),e.xp6(5),e.Oqu(e.xi3(17,11,t.event.date,"fullDate")),e.xp6(6),e.hij(" ",t.event.all_day?"All Day":e.xi3(23,14,t.event.date,"shortTime")+" - "+e.xi3(24,17,t.event.date+60*t.event.duration*1e3,"h:mm a (z)")," "),e.xp6(3),e.Q6J("ngIf",t.event.attendees.length),e.xp6(1),e.Q6J("ngIf",null==t.space?null:t.space.id),e.xp6(2),e.Q6J("ngIf",!e.lcZ(29,20,t.loading)),e.xp6(2),e.Q6J("ngIf",e.lcZ(31,22,t.loading)))},dependencies:[l.sg,l.O5,T.o,w.Ou,pe.HS,C.wG,l.Ov,l.uU],styles:["section[_ngcontent-%COMP%] > app-icon[_ngcontent-%COMP%]{font-size:1.5rem}h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:medium;margin-bottom:.5rem}h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:medium;margin:.5rem 0}"]});var vn=d(1360),qa=d(6813),dt=d(9383);function Ka(o,n){1&o&&(e.TgZ(0,"mat-checkbox",18),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"FORM.ALL_DAY")," "))}function Wa(o,n){1&o&&(e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"span"),e._uU(5,"*"),e.qZA()(),e._UZ(6,"host-select-field",21),e.qZA()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"FORM.HOST")))}const $a=function(){return{standalone:!0}};function Ga(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"label",4),e._uU(4),e.ALo(5,"translate"),e.TgZ(6,"span"),e._uU(7,"*"),e.qZA()(),e.TgZ(8,"mat-form-field",5),e._UZ(9,"input",6),e.TgZ(10,"mat-error"),e._uU(11),e.ALo(12,"translate"),e.qZA()()(),e.TgZ(13,"div",3)(14,"label",7),e._uU(15),e.ALo(16,"translate"),e.TgZ(17,"span"),e._uU(18,"*"),e.qZA()(),e.TgZ(19,"a-date-field",8),e._uU(20),e.ALo(21,"translate"),e.qZA()()(),e.TgZ(22,"div",9)(23,"div",10)(24,"label",11),e._uU(25),e.ALo(26,"translate"),e.TgZ(27,"span"),e._uU(28,"*"),e.qZA()(),e.TgZ(29,"a-time-field",12),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.form.patchValue({date:_}))}),e.qZA()(),e.TgZ(30,"div",13)(31,"label",14),e._uU(32),e.ALo(33,"translate"),e.TgZ(34,"span"),e._uU(35,"*"),e.qZA()(),e._UZ(36,"a-duration-field",15),e.YNc(37,Ka,3,3,"mat-checkbox",16),e.qZA()(),e.YNc(38,Wa,7,3,"div",17),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(4),e.Oqu(e.lcZ(5,13,"FORM.TITLE")),e.xp6(7),e.Oqu(e.lcZ(12,15,"FORM.TITLE_ERROR")),e.xp6(4),e.Oqu(e.lcZ(16,17,"FORM.DATE")),e.xp6(5),e.hij(" ",e.lcZ(21,19,"FORM.DATE_ERROR")," "),e.xp6(5),e.Oqu(e.lcZ(26,21,"FORM.START_TIME")),e.xp6(4),e.Q6J("ngModel",t.form.value.date)("ngModelOptions",e.DdM(25,$a)),e.xp6(3),e.Oqu(e.lcZ(33,23,"FORM.END_TIME")),e.xp6(4),e.Q6J("time",null==t.form||null==t.form.value?null:t.form.value.date)("max",t.max_duration),e.xp6(1),e.Q6J("ngIf",t.allow_all_day),e.xp6(1),e.Q6J("ngIf",t.can_book_for_others)}}class pt{constructor(n){this._settings=n}get max_duration(){return this._settings.get("app.events.max_duration")||480}get can_book_for_others(){return this._settings.get("app.events.can_book_for_others")}get allow_all_day(){return this._settings.get("app.events.allow_all_day")}}pt.\u0275fac=function(n){return new(n||pt)(e.Y36(p.gb))},pt.\u0275cmp=e.Xpm({type:pt,selectors:[["meeting-form-details"]],inputs:{form:"form"},decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"flex","items-center","flex-wrap","sm:space-x-2"],[1,"flex-1","min-w-[256px]"],["for","title"],["appearance","outline",1,"w-full"],["matInput","","name","title","formControlName","title","placeholder","e.g. Team Meeting"],["for","date"],["name","date","formControlName","date"],[1,"flex","items-center","space-x-2"],[1,"flex-1","w-1/3"],["for","start-time"],["name","start-time",3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex-1","w-1/3","relative"],["for","end-time"],["name","end-time","formControlName","duration",3,"time","max"],["formControlName","all_day","class","absolute -top-2 right-0",4,"ngIf"],["class","w-full",4,"ngIf"],["formControlName","all_day",1,"absolute","-top-2","right-0"],[1,"w-full"],["for","host"],["name","host","formControlName","organiser"]],template:function(n,t){1&n&&e.YNc(0,Ga,39,26,"div",0),2&n&&e.Q6J("ngIf",t.form)},dependencies:[l.O5,S.KE,S.TO,D.Nt,Be.Q,je.B,He.N,hn.d,R.oG,c.Fj,c.JJ,c.JL,c.On,c.sg,c.u,dt.X$],encapsulation:2});const Ja=["confirm_ref"],Ya=["input"];function Qa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"section",4)(1,"h3",5)(2,"div",6),e._uU(3," 2 "),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._UZ(7,"div",8),e.TgZ(8,"button",20),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.findAvailableTime())}),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"button",9),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.hide_block.attendees=!_.hide_block.attendees)}),e.TgZ(12,"app-icon"),e._uU(13),e.qZA()()(),e.TgZ(14,"div",10),e._UZ(15,"a-user-list-field",21),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(5),e.hij(" ",e.lcZ(6,5,"FORM.ATTENDEES")," "),e.xp6(4),e.hij(" ",e.lcZ(10,7,"WPA.AVAILABILITY")," "),e.xp6(4),e.Oqu(t.hide_block.attendees?"expand_more":"expand_less"),e.xp6(1),e.Q6J("@show",t.hide_block.attendees?"hide":"show"),e.xp6(1),e.Q6J("guests",t.allow_externals)}}function Ba(o,n){1&o&&(e.TgZ(0,"div",22),e._uU(1," The selected room has less capacity than the number of meeting attendees. "),e.qZA())}function ja(o,n){if(1&o&&(e.TgZ(0,"mat-option",32),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}const Ha=function(){return{standalone:!0}};function Xa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-form-field",26),e.NdJ("openedChange",function(){e.CHM(t);const _=e.oxw(2);return e.KtG(_.focusInput())}),e.TgZ(1,"mat-select",27)(2,"input",28,29),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.code_filter.next(_))}),e.qZA(),e._UZ(4,"mat-option",30),e.YNc(5,ja,2,2,"mat-option",31),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"mat-error"),e._uU(8," Catering charge code is required "),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngModel",t.code_filter.getValue())("ngModelOptions",e.DdM(5,Ha)),e.xp6(3),e.Q6J("ngForOf",e.lcZ(6,3,t.filtered_codes))}}function za(o,n){1&o&&(e.TgZ(0,"mat-form-field",33),e._UZ(1,"textarea",34),e.TgZ(2,"mat-error"),e._uU(3," Catering Order notes are required "),e.qZA()())}const Va=function(o,n,t){return{date:o,duration:n,zone_id:t}};function el(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"section",4)(1,"h3",5)(2,"div",6),e._uU(3," 4 "),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._UZ(7,"div",8),e.TgZ(8,"button",9),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.hide_block.catering=!_.hide_block.catering)}),e.TgZ(9,"app-icon"),e._uU(10),e.qZA()()(),e.TgZ(11,"div",10),e._UZ(12,"catering-list-field",23),e.YNc(13,Xa,9,6,"mat-form-field",24),e.ALo(14,"async"),e.YNc(15,za,4,0,"mat-form-field",25),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(5),e.hij(" ",e.lcZ(6,6,"WPA.CATERING")," "),e.xp6(5),e.Oqu(t.hide_block.catering?"expand_more":"expand_less"),e.xp6(1),e.Q6J("@show",t.hide_block.catering?"hide":"show"),e.xp6(1),e.Q6J("options",e.kEZ(10,Va,t.form.value.date,t.form.value.duration,null==t.form.value.resources[0]||null==t.form.value.resources[0].level?null:t.form.value.resources[0].level.parent_id)),e.xp6(1),e.Q6J("ngIf",e.lcZ(14,8,(null==t.form.value.catering?null:t.form.value.catering.length)&&t.has_codes)),e.xp6(2),e.Q6J("ngIf",null==t.form.value.catering?null:t.form.value.catering.length)}}function tl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"section",4)(1,"h3",5)(2,"div",6),e._uU(3),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"div",7),e._uU(6),e.ALo(7,"translate"),e.qZA(),e._UZ(8,"div",8),e.TgZ(9,"button",9),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.hide_block.assets=!_.hide_block.assets)}),e.TgZ(10,"app-icon"),e._uU(11),e.qZA()()(),e.TgZ(12,"div",10),e._UZ(13,"asset-list-field",35),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,4,t.has_catering)?"5":"4"," "),e.xp6(3),e.hij(" ",e.lcZ(7,6,"WPA.ASSETS")," "),e.xp6(5),e.Oqu(t.hide_block.assets?"expand_more":"expand_less"),e.xp6(1),e.Q6J("@show",t.hide_block.assets?"hide":"show")}}function nl(o,n){if(1&o&&(e.TgZ(0,"section",4)(1,"h3",36)(2,"div",6),e._uU(3),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"div",7),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"div",37)(10,"label",38),e._uU(11),e.ALo(12,"translate"),e.qZA(),e._UZ(13,"rich-text-input",39),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,3,t.has_catering)&&t.has_assets?"6":e.lcZ(5,5,t.has_catering)||t.has_assets?"5":"4"," "),e.xp6(4),e.hij(" ",e.lcZ(8,7,"FORM.NOTES")," "),e.xp6(4),e.hij(" ",e.lcZ(12,9,"WPA.NOTES_INFO")," ")}}class ut extends p.KG{constructor(n,t,i,_,s,a,r){super(),this._state=n,this._catering=t,this._settings=i,this._router=_,this._dialog=s,this._bottom_sheet=a,this._org=r,this.hide_block={},this.code_filter=new N.X(""),this.has_catering=this._catering.available_menu.pipe((0,F.U)(u=>u.length>0)),this.has_codes=this._catering.charge_codes.pipe((0,F.U)(u=>u.length>0)),this.filtered_codes=(0,q.aj)([this.code_filter,this._catering.charge_codes]).pipe((0,F.U)(([u,g])=>g.filter(h=>h.toLowerCase().includes(u.toLowerCase())))),this.clearForm=()=>this._state.resetForm(),this.viewConfirm=()=>(this.form.value.host||this.form.patchValue({host:(0,p.ar)()?.email}),this.strict_capacity_check&&this.attendee_count>this.total_capacity?(0,p.cB)("Attendee count is greater than the capacity of the selected rooms"):(this.form.markAllAsTouched(),this.form.valid?this._settings.get("app.events.booking_unavailable")?this._state.openEventLinkModal():void(window.innerWidth>=768?(this.dialog_ref=this._dialog.open(ct),this.dialog_ref.componentInstance.show_close=!0,this.dialog_ref.afterClosed().subscribe(u=>{u&&(this._router.navigate(["/book","meeting","success"]),this._state.setView("success"))})):(this.sheet_ref=this._bottom_sheet.open(Ze),this.sheet_ref.instance.show_close=!0,this.sheet_ref.afterDismissed().subscribe(u=>{u&&(this._router.navigate(["/book","meeting","success"]),this._state.setView("success"))}))):(0,p.cB)(`Some fields are invalid. [${(0,p.RD)(this.form).join(", ")}]`)))}get form(){return this._state.form}get has_assets(){return!!this._settings.get("app.events.has_assets")}get hide_notes(){return!!this._settings.get("app.events.hide_notes")}get hide_attendees(){return!!this._settings.get("app.events.hide_attendees")}get allow_externals(){return this._settings.get("app.events.allow_externals")}get strict_capacity_check(){return this._settings.get("app.events.strict_capacity_check")}get total_capacity(){return this.form.value.resources?.reduce((n,t)=>n+t.capacity,0)||0}get attendee_count(){const n=(0,p.ar)();let t=this.form.value.attendees?.length||0;return this.form.value.attendees.find(i=>i.email.toLowerCase()===n.email.toLowerCase())||(t+=1),t}ngOnInit(){var n=this;return(0,m.Z)(function*(){yield n._org.initialised.pipe((0,Z.P)(t=>t)).toPromise(),n.subscription("space_changes",n.form.controls.resources.valueChanges.subscribe(t=>n._checkCateringEligibility(t))),n.subscription("date_changes",n.form.controls.date.valueChanges.subscribe(t=>n._checkCateringEligibility(n.form.value.resources))),n.subscription("duration_changes",n.form.controls.duration.valueChanges.subscribe(t=>n._checkCateringEligibility(n.form.value.resources))),n._catering.setOptions({zone:""}),n._checkCateringEligibility(n.form.value.resources||[])})()}focusInput(){this.timeout("input-focus",()=>{this._input_el.nativeElement.value="",this._input_el?.nativeElement?.focus()},300)}findAvailableTime(){const{attendees:n,organiser:t,date:i,duration:_}=this.form.value,s=this._dialog.open(fa.u,{data:{users:n,host:t||(0,p.ar)(),date:i,duration:_}});s.afterClosed().subscribe(a=>{!a||this.form.patchValue({date:s.componentInstance.date,attendees:s.componentInstance.users,duration:s.componentInstance.duration})})}_checkCateringEligibility(n){var t=this;return(0,m.Z)(function*(){if(n?.length){yield(0,Tn.H)(100).toPromise();const i=t.form.getRawValue();t._catering.setFilters({search:"",date:i.date,duration:i.duration,resources:n,zone_id:t._org.levelWithID(n[0].zones)?.parent_id}),yield(0,Tn.H)(500).toPromise();const _=yield t._catering.filtered_menu.pipe((0,I.q)(1)).toPromise(),s=yield t._catering.availability.pipe((0,I.q)(1)).toPromise();!n.every(r=>_.filter(u=>!u.hide_for_zones.find(g=>r.zones.includes(g))).length>0)||s.find(r=>n.find(u=>u.id===r))?(t.form.patchValue({catering:[]}),t.form.controls.catering.disable(),(0,p.Zd)("Catering is unavailable for some of the selected spaces.")):t.form.controls.catering.enable()}else t.form.controls.catering.disable()})()}}function ol(o,n){if(1&o&&(e.tHW(0,5,1),e._UZ(1,"span"),e.N_p()),2&o){const t=e.oxw();e.xp6(1),e.pQV((null==t.space?null:t.space.level.display_name)||(null==t.space?null:t.space.level.name))((null==t.space?null:t.space.display_name)||(null==t.space?null:t.space.name)),e.QtT(0)}}function il(o,n){1&o&&(e.tHW(0,5,2),e._UZ(1,"span"),e.N_p())}ut.\u0275fac=function(n){return new(n||ut)(e.Y36(k.MH),e.Y36(G),e.Y36(p.gb),e.Y36(x.F0),e.Y36(v.uw),e.Y36(B.ch),e.Y36(A.w7))},ut.\u0275cmp=e.Xpm({type:ut,selectors:[["meeting-flow-form"]],viewQuery:function(n,t){if(1&n&&(e.Gf(Ja,5),e.Gf(Ya,5)),2&n){let i;e.iGM(i=e.CRH())&&(t._confirm_ref=i.first),e.iGM(i=e.CRH())&&(t._input_el=i.first)}},features:[e.qOj],decls:47,vars:30,consts:function(){let o;return o=$localize`:␟e26549266cb03cd521fa0036d18ea57004186570␟1405384778004392663:{VAR_SELECT, select, true {Reset } false {Clear }}`,o=e.Zx4(o,{VAR_SELECT:"\ufffd0\ufffd"}),[[1,"h-full","w-full","bg-gray-100","dark:bg-neutral-900","overflow-auto"],[1,"max-w-full","w-[48rem]","mx-auto","sm:my-4","bg-white","dark:bg-[#1F2021]","border","border-gray-300","dark:border-neutral-700"],[1,"w-full","p-4","sm:py-4","sm:px-16","text-2xl","font-medium","border-b","border-gray-300","dark:border-neutral-700"],[1,"p-0","sm:py-4","sm:px-16","divide-y","divide-gray-300","space-y-2",3,"formGroup"],[1,"p-2"],[1,"space-x-2","flex","items-center"],[1,"bg-black/20","rounded-full","h-6","w-6","flex","items-center","justify-center"],[1,"text-xl"],[1,"flex-1","w-px"],["icon","","matRipple","",3,"click"],[1,"overflow-hidden"],[1,"mt-4",3,"form"],["class","p-2",4,"ngIf"],[1,"overflow-hidden","flex","flex-col","items-center"],["class","bg-yellow-500 rounded shadow p-2 text-xs mx-auto my-2 text-black inline-flex",4,"ngIf"],["formControlName","resources",1,"w-full"],[1,"flex","flex-col","sm:flex-row","items-center","sm:space-x-2","p-2"],["btn","","matRipple","","confirm","",1,"mb-2","sm:mb-0","w-full","sm:w-auto",3,"click"],["btn","","matRipple","","clear-form","",1,"inverse","w-full","sm:w-auto",3,"click"],o,["matRipple","",1,"bg-none","underline","text-xs","text-blue-500",3,"click"],["formControlName","attendees",1,"mt-4",3,"guests"],[1,"bg-yellow-500","rounded","shadow","p-2","text-xs","mx-auto","my-2","text-black","inline-flex"],["formControlName","catering",3,"options"],["appearance","outline","class","w-full mt-2",3,"openedChange",4,"ngIf"],["appearance","outline","class","w-full",4,"ngIf"],["appearance","outline",1,"w-full","mt-2",3,"openedChange"],["formControlName","catering_charge_code","placeholder","Charge Code"],["placeholder","Search charge codes...",1,"sticky","top-0","bg-white","px-4","py-3","text-base","border-x-0","border-t-0","border-b","focus:border-b","border-gray-200","w-full","rounded-none","z-50",3,"ngModel","ngModelOptions","ngModelChange"],["input",""],[1,"hidden"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["appearance","outline",1,"w-full"],["matInput","","formControlName","catering_notes","placeholder","Extra catering details..."],["formControlName","assets"],[1,"space-x-2","flex","items-center","mb-4"],[1,"w-full","flex","flex-col"],["for","notes"],["name","notes","formControlName","body","placeholder","Notes..."]]},template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"form",3)(6,"section",4)(7,"h3",5)(8,"div",6),e._uU(9," 1 "),e.qZA(),e.TgZ(10,"div",7),e._uU(11),e.ALo(12,"translate"),e.qZA(),e._UZ(13,"div",8),e.TgZ(14,"button",9),e.NdJ("click",function(){return t.hide_block.details=!t.hide_block.details}),e.TgZ(15,"app-icon"),e._uU(16),e.qZA()()(),e.TgZ(17,"div",10),e._UZ(18,"meeting-form-details",11),e.qZA()(),e.YNc(19,Qa,16,9,"section",12),e.TgZ(20,"section",4)(21,"h3",5)(22,"div",6),e._uU(23," 3 "),e.qZA(),e.TgZ(24,"div",7),e._uU(25),e.ALo(26,"translate"),e.qZA(),e._UZ(27,"div",8),e.TgZ(28,"button",9),e.NdJ("click",function(){return t.hide_block.resources=!t.hide_block.resources}),e.TgZ(29,"app-icon"),e._uU(30),e.qZA()()(),e.TgZ(31,"div",13),e.YNc(32,Ba,2,0,"div",14),e._UZ(33,"space-list-field",15),e.qZA()(),e.YNc(34,el,16,14,"section",12),e.ALo(35,"async"),e.YNc(36,tl,14,8,"section",12),e.YNc(37,nl,14,11,"section",12),e.TgZ(38,"section",16)(39,"button",17),e.NdJ("click",function(){return t.viewConfirm()}),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"button",18),e.NdJ("click",function(){return t.clearForm()}),e._uU(43," "),e.SDv(44,19),e._uU(45),e.ALo(46,"translate"),e.qZA()()()()()),2&n&&(e.xp6(3),e.AsE(" ",t.form.value.id?"Edit":"Book"," ",e.lcZ(4,18,"WPA.BOOK_MEETING_HEADING")," "),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(6),e.hij(" ",e.lcZ(12,20,"WPA.DETAILS")," "),e.xp6(5),e.Oqu(t.hide_block.details?"expand_more":"expand_less"),e.xp6(1),e.Q6J("@show",t.hide_block.details?"hide":"show"),e.xp6(1),e.Q6J("form",t.form),e.xp6(1),e.Q6J("ngIf",!t.hide_attendees),e.xp6(6),e.hij(" ",e.lcZ(26,22,"WPA.ROOM")," "),e.xp6(5),e.Oqu(t.hide_block.resources?"expand_more":"expand_less"),e.xp6(1),e.Q6J("@show",t.hide_block.resources?"hide":"show"),e.xp6(1),e.Q6J("ngIf",!t.strict_capacity_check&&t.total_capacity&&t.total_capacity<=(null==t.form.value.attendees?null:t.form.value.attendees.length)),e.xp6(2),e.Q6J("ngIf",e.lcZ(35,24,t.has_catering)),e.xp6(2),e.Q6J("ngIf",t.has_assets),e.xp6(1),e.Q6J("ngIf",!t.hide_notes),e.xp6(3),e.hij(" ",e.lcZ(41,26,"WPA.CONFIRM_MEETING")," "),e.xp6(4),e.pQV(!!t.form.value.id),e.QtT(44),e.xp6(1),e.hij(" ",e.lcZ(46,28,"WPA.CLEAR_FORM")," "))},dependencies:[l.sg,l.O5,T.o,C.ey,S.KE,S.TO,X.gD,D.Nt,kt.E,vn.k,qa.M,fn.n,C.wG,c._Y,c.Fj,c.JJ,c.JL,c.On,V,c.sg,c.u,pt,l.Ov,dt.X$],encapsulation:2,data:{animation:[p.X7]}});const _l=function(){return["/"]};class gt{constructor(n){this._event_form=n}get last_event(){return this._event_form.last_success}get space(){return this.last_event.space}}function sl(o,n){1&o&&e._UZ(0,"meeting-flow-success")}function al(o,n){1&o&&e._UZ(0,"meeting-flow-confirm")}function ll(o,n){1&o&&e._UZ(0,"meeting-flow-form")}gt.\u0275fac=function(n){return new(n||gt)(e.Y36(k.MH))},gt.\u0275cmp=e.Xpm({type:gt,selectors:[["meeting-flow-success"]],decls:17,vars:22,consts:function(){let o;return o=$localize`:␟fcd080c00f4f5c76df108562d0c74d1c0915ed37␟4274860785713978383: Your ${"\ufffd*8:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_SPAN: room booking for ${"\ufffd0:1\ufffd"}:INTERPOLATION:, ${"\ufffd1:1\ufffd"}:INTERPOLATION_1: ${"[\ufffd/#1:1\ufffd\ufffd/*8:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*9:2\ufffd]"}:CLOSE_TAG_SPAN:${"\ufffd*9:2\ufffd\ufffd#1:2\ufffd"}:START_TAG_SPAN_1:meeting${"[\ufffd/#1:1\ufffd\ufffd/*8:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*9:2\ufffd]"}:CLOSE_TAG_SPAN: has been successfully booked for the ${"\ufffd0\ufffd"}:INTERPOLATION_2: at ${"\ufffd1\ufffd"}:INTERPOLATION_3:-${"\ufffd2\ufffd"}:INTERPOLATION_4:. `,o=e.Zx4(o),[[1,"absolute","inset-0","bg-white","dark:bg-neutral-600","flex","flex-col","z-50"],[1,"flex-1","flex","flex-col","items-center","justify-center","space-y-2","p-8"],[1,"text-2xl","font-medium"],["src","assets/icons/success.svg"],[1,"text-center","max-w-[32rem]"],o,[4,"ngIf"],[1,"p-2","w-full","border-t","border-gray-200","dark:bg-neutral-500","mt-4","flex","items-center","justify-center"],["btn","","matRipple","",1,"w-full","max-w-[32rem]",3,"routerLink"]]},template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"main",1)(2,"h2",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"img",3),e.TgZ(6,"p",4),e.tHW(7,5),e.YNc(8,ol,2,2,"span",6),e.YNc(9,il,2,0,"span",6),e.ALo(10,"date"),e.ALo(11,"date"),e.ALo(12,"date"),e.N_p(),e.qZA()(),e.TgZ(13,"footer",7)(14,"a",8),e._uU(15),e.ALo(16,"translate"),e.qZA()()()),2&n&&(e.xp6(3),e.hij(" ",e.lcZ(4,8,"WPA.BOOKING_CONFIRMED")," "),e.xp6(5),e.Q6J("ngIf",t.space),e.xp6(1),e.Q6J("ngIf",!t.space),e.xp6(3),e.pQV(e.xi3(10,10,t.last_event.date,"mediumDate"))(e.xi3(11,13,t.last_event.date,"shortTime"))(e.xi3(12,16,t.last_event.date+60*t.last_event.duration*1e3,"shortTime")),e.QtT(7),e.xp6(2),e.Q6J("routerLink",e.DdM(21,_l)),e.xp6(1),e.hij(" ",e.lcZ(16,19,"WPA.BOOKING_DONE_CONTINUE")," "))},dependencies:[l.O5,C.wG,x.rH,l.uU,dt.X$]});class mt extends p.KG{constructor(n,t){super(),this._state=n,this._route=t}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.loadForm(),this._state.form||this._state.newForm(),this._state.listenForStatusChanges(),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView("success")}))}}function rl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.dismiss())}),e.TgZ(1,"app-icon"),e._uU(2,"close"),e.qZA()()}}function cl(o,n){1&o&&e._UZ(0,"mat-spinner",16)}function dl(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",21)(2,"app-icon"),e._uU(3,"arrow_upward"),e.qZA(),e.TgZ(4,"div"),e._uU(5),e.qZA()(),e.BQk()),2&o){const t=n.$implicit;e.xp6(5),e.Oqu(t)}}function pl(o,n){if(1&o&&(e.TgZ(0,"section",17)(1,"app-icon",6),e._uU(2,"done"),e.qZA(),e.TgZ(3,"div",7)(4,"h3",18),e._uU(5),e.qZA(),e.TgZ(6,"div",8)(7,"app-icon"),e._uU(8,"person"),e.qZA(),e.TgZ(9,"span"),e.SDv(10,19),e.qZA()(),e.TgZ(11,"div",8)(12,"app-icon"),e._uU(13,"place"),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.qZA()(),e.YNc(16,dl,6,1,"ng-container",20),e.qZA()()),2&o){const t=e.oxw();e.xp6(5),e.hij(" ",(null==t.booking_asset?null:t.booking_asset.name)||(null==t.booking_asset?null:t.booking_asset.id)||""," "),e.xp6(10),e.Oqu(t.location),e.xp6(1),e.Q6J("ngForOf",t.booking_asset.features)}}function ul(o,n){if(1&o&&(e.TgZ(0,"div",25)(1,"div",26),e._uU(2),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA()()),2&o){const t=n.$implicit;e.xp6(2),e.hij(" ",t.amount," "),e.xp6(2),e.Oqu(t.name)}}function gl(o,n){if(1&o&&(e.TgZ(0,"section",22)(1,"app-icon",6),e._uU(2,"done"),e.qZA(),e.TgZ(3,"div",7)(4,"h3"),e.SDv(5,23),e.qZA(),e.YNc(6,ul,5,2,"div",24),e.qZA()()),2&o){const t=e.oxw();e.xp6(5),e.pQV(t.assets_count),e.QtT(5),e.xp6(1),e.Q6J("ngForOf",t.assets)}}function ml(o,n){1&o&&(e.TgZ(0,"section",22)(1,"app-icon",6),e._uU(2,"done"),e.qZA(),e.TgZ(3,"div",7)(4,"h3"),e.SDv(5,27),e.qZA(),e.TgZ(6,"div",25)(7,"span"),e._uU(8,"Locker E-043"),e.qZA()()()())}function fl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.postForm())}),e.SDv(1,29),e.qZA()}}mt.\u0275fac=function(n){return new(n||mt)(e.Y36(k.MH),e.Y36(x.gz))},mt.\u0275cmp=e.Xpm({type:mt,selectors:[["placeos-book-meeting-flow"]],features:[e.qOj],decls:4,vars:3,consts:[[1,"bg-white","dark:bg-neutral-900","h-full","w-full","z-50",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,sl,1,0,"meeting-flow-success",1),e.YNc(2,al,1,0,"meeting-flow-confirm",1),e.YNc(3,ll,1,0,"meeting-flow-form",2),e.qZA()),2&n&&(e.Q6J("ngSwitch",t.view),e.xp6(1),e.Q6J("ngSwitchCase","success"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"))},dependencies:[l.RF,l.n9,l.ED,ut,Ze,gt],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]});class ft extends p.KG{constructor(n,t,i){var _;super(),_=this,this._state=n,this._org=t,this._sheet_ref=i,this.show_close=!1,this.loading=this._state.loading,this.postForm=(0,m.Z)(function*(){yield _._state.postForm(),_.dismiss(!0)}),this.dismiss=s=>this._sheet_ref?.dismiss(s)}get booking(){return this._state.form.value}get assets(){return this.booking.assets||null}get needs_locker(){return!!this.booking.secondary_resource}get assets_count(){return this.assets?.length?this.assets.reduce((n,t)=>n+t.amount,0):0}get booking_asset(){return this.booking.booking_asset}get location(){const n=this._org.buildings.find(i=>i.id===this.booking_asset?.zone?.parent_id),t=this._org.levels.find(i=>i.id===this.booking_asset?.zone?.id);return`${t?.display_name||t?.name}${n?",":""} ${n?.address||n?.display_name||n?.name||""}`}}ft.\u0275fac=function(n){return new(n||ft)(e.Y36(E.fy),e.Y36(A.w7),e.Y36(B.oL,8))},ft.\u0275cmp=e.Xpm({type:ft,selectors:[["new-desk-flow-confirm"]],inputs:{show_close:"show_close"},features:[e.qOj],decls:31,vars:22,consts:function(){let o,n,t,i,_;return o=$localize`:␟0882dc9e94f4d0eb3cd1bd084b002f11dcbf97a4␟872571517031618480:Confirm Desk Booking`,n=$localize`:␟f3cd229363e020d7ceb13bb351bb87f86dda78ef␟6431414344811875961:Single desk`,t=$localize`:␟baacc4ba232f9320250b9871e259ccb844857f15␟3853466990357051325:${"\ufffd0\ufffd"}:INTERPOLATION: Asset(s)`,i=$localize`:␟831b916fccb1f3e17a1e16c1d7dbd5cb34ab9aaf␟1356827781051284287:Requested Locker`,_=$localize`:␟0ad83be7464a0a2e8d100342e144bc3fbc789f9d␟3141803775366633134: Confirm `,[["close","","icon","","matRipple","",3,"click",4,"ngIf"],[1,"flex","items-center","justify-between","px-2"],[1,"text-2xl","font-medium","mb-2"],o,["diameter","32",4,"ngIf"],["period","",1,"flex","space-x-1","py-4","px-2"],[1,"text-success"],["details","",1,"leading-6"],[1,"flex","items-center","space-x-2"],["date",""],["time",""],["desk","","class","flex space-x-1 py-4 px-2 border-t dark:border-neutral-500",4,"ngIf"],["assets","","class","flex space-x-1 py-4 px-2 border-t dark:border-neutral-500",4,"ngIf"],[1,"p-2","w-full","border-t","border-gray-200","dark:border-neutral-500","mt-4"],["confirm","","btn","","matRipple","","class","w-full",3,"click",4,"ngIf"],["close","","icon","","matRipple","",3,"click"],["diameter","32"],["desk","",1,"flex","space-x-1","py-4","px-2","border-t","dark:border-neutral-500"],["name",""],n,[4,"ngFor","ngForOf"],["features","",1,"flex","items-center","space-x-2"],["assets","",1,"flex","space-x-1","py-4","px-2","border-t","dark:border-neutral-500"],t,["class","flex space-x-2",4,"ngFor","ngForOf"],[1,"flex","space-x-2"],[1,"h-5","w-5","bg-gray-100","dark:bg-neutral-600","rounded-full"],i,["confirm","","btn","","matRipple","",1,"w-full",3,"click"],_]},template:function(n,t){1&n&&(e.YNc(0,rl,3,0,"button",0),e.TgZ(1,"header",1)(2,"h2",2),e.SDv(3,3),e.qZA(),e.YNc(4,cl,1,0,"mat-spinner",4),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"section",5)(7,"app-icon",6),e._uU(8,"done"),e.qZA(),e.TgZ(9,"div",7)(10,"h3"),e._uU(11),e.qZA(),e.TgZ(12,"div",8)(13,"app-icon"),e._uU(14,"calendar_today"),e.qZA(),e.TgZ(15,"div",9),e._uU(16),e.ALo(17,"date"),e.qZA()(),e.TgZ(18,"div",8)(19,"app-icon"),e._uU(20,"schedule"),e.qZA(),e.TgZ(21,"div",10),e._uU(22),e.ALo(23,"date"),e.ALo(24,"date"),e.qZA()()()(),e.YNc(25,pl,17,3,"section",11),e.YNc(26,gl,7,2,"section",12),e.YNc(27,ml,9,0,"section",12),e.TgZ(28,"footer",13),e.YNc(29,fl,2,0,"button",14),e.ALo(30,"async"),e.qZA()),2&n&&(e.Q6J("ngIf",t.show_close),e.xp6(4),e.Q6J("ngIf",e.lcZ(5,9,t.loading)),e.xp6(7),e.Oqu(t.booking.title||"~Untitled~"),e.xp6(5),e.Oqu(e.xi3(17,11,t.booking.date,"fullDate")),e.xp6(6),e.hij(" ",t.booking.all_day?"All Day":e.xi3(23,14,t.booking.date,"shortTime")+" - "+e.xi3(24,17,t.booking.date+60*t.booking.duration*1e3,"h:mm a (z)")," "),e.xp6(3),e.Q6J("ngIf",null==t.booking_asset?null:t.booking_asset.id),e.xp6(1),e.Q6J("ngIf",null==t.assets?null:t.assets.length),e.xp6(1),e.Q6J("ngIf",t.needs_locker),e.xp6(2),e.Q6J("ngIf",!e.lcZ(30,20,t.loading)))},dependencies:[l.sg,l.O5,T.o,w.Ou,C.wG,l.Ov,l.uU],styles:["section[_ngcontent-%COMP%] > app-icon[_ngcontent-%COMP%]{font-size:1.5rem;margin-top:.3rem}h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:medium;margin:.5rem 0}"]});var hl=d(321);function Cl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"section",32)(1,"button",33),e.NdJ("click",function(){e.CHM(t);const _=e.oxw(2);return e.KtG(_.setOptions({group:!1,members:[]}))}),e.ALo(2,"async"),e.ALo(3,"async"),e.TgZ(4,"app-icon",34),e._uU(5,"person"),e.qZA(),e.TgZ(6,"div",35),e.SDv(7,36),e.qZA(),e._UZ(8,"div",37),e.ALo(9,"async"),e.ALo(10,"async"),e.qZA(),e.TgZ(11,"button",33),e.NdJ("click",function(){e.CHM(t);const _=e.oxw(2);return e.KtG(_.setOptions({group:!0}))}),e.ALo(12,"async"),e.ALo(13,"async"),e.TgZ(14,"app-icon",34),e._uU(15,"group_add"),e.qZA(),e.TgZ(16,"div",35),e.SDv(17,38),e.qZA(),e._UZ(18,"div",37),e.ALo(19,"async"),e.ALo(20,"async"),e.qZA()()}if(2&o){const t=e.oxw(2);let i,_,s,a,r,u,g,h;e.xp6(1),e.ekj("text-primary",!(null!=(i=e.lcZ(2,16,t.options))&&i.group))("opacity-60",null==(_=e.lcZ(3,18,t.options))?null:_.group),e.xp6(7),e.ekj("bg-gray-200",null==(s=e.lcZ(9,20,t.options))?null:s.group)("bg-primary",!(null!=(a=e.lcZ(10,22,t.options))&&a.group)),e.xp6(3),e.ekj("text-primary",null==(r=e.lcZ(12,24,t.options))?null:r.group)("opacity-60",!(null!=(u=e.lcZ(13,26,t.options))&&u.group)),e.xp6(7),e.ekj("bg-gray-200",!(null!=(g=e.lcZ(19,28,t.options))&&g.group))("bg-primary",null==(h=e.lcZ(20,30,t.options))?null:h.group)}}function Tl(o,n){1&o&&(e.TgZ(0,"mat-checkbox",39),e.SDv(1,40),e.qZA())}const Gt=function(){return{standalone:!0}};function xl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"mat-checkbox",41),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.form.patchValue({secondary_resource:_?"locker":""}))}),e.SDv(3,42),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngModel",!!t.form.value.secondary_resource)("ngModelOptions",e.DdM(2,Gt))}}const vl=function(){return[]};function Ol(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"section",3)(1,"h3",43)(2,"div",5),e._uU(3," 2 "),e.qZA(),e.TgZ(4,"div",6),e.SDv(5,44),e.qZA(),e._UZ(6,"div",45),e.qZA(),e.TgZ(7,"div",46)(8,"a-user-list-field",47),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setOptions({members:_}))}),e.ALo(9,"async"),e.qZA()()()}if(2&o){const t=e.oxw(2);let i;e.xp6(8),e.Q6J("ngModel",(null==(i=e.lcZ(9,2,t.options))?null:i.members)||e.DdM(4,vl))("ngModelOptions",e.DdM(5,Gt))}}function El(o,n){if(1&o&&(e.TgZ(0,"section",3)(1,"h3",4)(2,"div",5),e._uU(3),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"div",6),e.SDv(6,48),e.qZA()(),e._UZ(7,"asset-list-field",49),e.qZA()),2&o){const t=e.oxw(2);let i;e.xp6(3),e.hij(" ",null!=(i=e.lcZ(4,1,t.options))&&i.group?4:3," ")}}function Sl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1),e.YNc(1,Cl,21,32,"section",2),e.TgZ(2,"section",3)(3,"h3",4)(4,"div",5),e._uU(5," 1 "),e.qZA(),e.TgZ(6,"div",6),e.SDv(7,7),e.qZA()(),e.TgZ(8,"div",8)(9,"div",9)(10,"label",10),e._uU(11,"Add Title"),e.TgZ(12,"span"),e._uU(13,"*"),e.qZA()(),e.TgZ(14,"mat-form-field",11),e._UZ(15,"input",12),e.TgZ(16,"mat-error"),e.SDv(17,13),e.qZA()()(),e.TgZ(18,"div",9)(19,"label",14),e.tHW(20,15),e._UZ(21,"span"),e.N_p(),e.qZA(),e.TgZ(22,"a-date-field",16),e.SDv(23,17),e.qZA()()(),e.TgZ(24,"div",18)(25,"div",19)(26,"label",20),e.tHW(27,21),e._UZ(28,"span"),e.N_p(),e.qZA(),e.TgZ(29,"a-time-field",22),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.form.patchValue({date:_}))}),e.qZA()(),e.TgZ(30,"div",23)(31,"label",24),e.tHW(32,25),e._UZ(33,"span"),e.N_p(),e.qZA(),e._UZ(34,"a-duration-field",26),e.YNc(35,Tl,2,0,"mat-checkbox",27),e.qZA()(),e.YNc(36,xl,4,3,"div",28),e.qZA(),e.YNc(37,Ol,10,6,"section",29),e.ALo(38,"async"),e.TgZ(39,"section",3)(40,"h3",4)(41,"div",5),e._uU(42),e.ALo(43,"async"),e.qZA(),e.TgZ(44,"div",6),e.SDv(45,30),e.qZA()(),e._UZ(46,"desk-list-field",31),e.qZA(),e.YNc(47,El,8,3,"section",29),e.qZA()}if(2&o){const t=e.oxw();let i,_,s;e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.allow_groups),e.xp6(1),e.ekj("!border-none",t.allow_groups),e.xp6(27),e.Q6J("ngModel",t.form.value.date)("ngModelOptions",e.DdM(19,Gt)),e.xp6(5),e.Q6J("time",null==(i=t.form.get("date"))?null:i.value)("max",720)("min",60)("step",60),e.xp6(1),e.Q6J("ngIf",t.allow_all_day),e.xp6(1),e.Q6J("ngIf",t.can_book_lockers),e.xp6(1),e.Q6J("ngIf",null==(_=e.lcZ(38,15,t.options))?null:_.group),e.xp6(5),e.hij(" ",null!=(s=e.lcZ(43,17,t.options))&&s.group?3:2," "),e.xp6(5),e.Q6J("ngIf",t.has_assets)}}class ht extends p.KG{constructor(n,t,i){super(),this._state=n,this._org=t,this._settings=i,this.find=new e.vpe,this.buildings=this._org.building_list,this.levels=this._org.active_levels,this.options=this._state.options,this.features=this._state.features,this.from_id=!1,this.recurrence_options=["daily","weekly","monthly"],this.setOptions=_=>this._state.setOptions(_),this.setFeature=(_,s)=>this._state.setFeature(_,s)}get building(){return this._org.building}set building(n){this._org.building=n}get can_book_for_others(){return this._settings.get("app.desks.can_book_for_others")}get can_book_lockers(){return this._settings.get("app.desks.can_book_lockers")}get can_recurr(){return this._settings.get("app.desks.recurrence_allowed")}get allow_groups(){return this._settings.get("app.desks.allow_groups")}get has_assets(){return!!this._settings.get("app.desks.has_assets")}get needs_reason(){return!0===this._settings.get("app.desks.needs_reason")}get allow_time_changes(){return!!this._settings.get("app.desks.allow_time_changes")}get allow_all_day(){return this.allow_time_changes&&!!this._settings.get("app.desks.allow_all_day")}ngOnInit(){this.subscription("change",this._state.form.get("resources")?.valueChanges?.subscribe(n=>n.length?this.setBookingAsset(n[0]):""))}setBookingAsset(n){!n||(this.selected_desk=n,this._state.form.patchValue({asset_id:n?.id,asset_name:n.name,map_id:n?.map_id||n?.id,description:n.name,booking_type:"desk",zones:n.zone?[n.zone?.parent_id,n.zone?.id]:[],booking_asset:n}))}}ht.\u0275fac=function(n){return new(n||ht)(e.Y36(E.fy),e.Y36(A.w7),e.Y36(p.gb))},ht.\u0275cmp=e.Xpm({type:ht,selectors:[["new-desk-form-details"]],inputs:{form:"form"},outputs:{find:"find"},features:[e.qOj],decls:1,vars:1,consts:function(){let o,n,t,i,_,s,a,r,u,g,h,b,y;return o=$localize`:␟4f8b2bb476981727ab34ed40fde1218361f92c45␟5028777105388019087:Details`,n=$localize`:␟3501a14ee1e89ea7009e8c9d1d6796a9ac9c3718␟4954033536980360307:Booking title is required.`,t=$localize`:␟04cfb5fd033651743bc4b9408bd52ba4ee894070␟3158758063619980932:Date${"\ufffd#21\ufffd"}:START_TAG_SPAN:*${"\ufffd/#21\ufffd"}:CLOSE_TAG_SPAN:`,i=$localize`:␟407bcc42df8640bf3b85c58145c8d24572bb47b6␟6682406734296000735: Date and time must be in the future `,_=$localize`:␟34a7595cdc15925514038224946986bfd90dc0ed␟3039786638368843634:Start Time${"\ufffd#28\ufffd"}:START_TAG_SPAN:*${"\ufffd/#28\ufffd"}:CLOSE_TAG_SPAN:`,s=$localize`:␟85d5c3a89bab9a7475a7db095089e161586cb7a1␟5960185837188220843:End Time${"\ufffd#33\ufffd"}:START_TAG_SPAN:*${"\ufffd/#33\ufffd"}:CLOSE_TAG_SPAN:`,a=$localize`:␟654c7e59b2003acf985bee710bad11e8cdd461f8␟6078724721705612215:Desk`,r=$localize`:␟ee6b1f617dd5320b23fbed018c38ac092db5e40a␟3413004253239957216:Single`,u=$localize`:␟4c90059afafb7e160384d9f512797c95bb95c6dc␟8623978917681527907:Group`,g=$localize`:␟8a5018aa2d4dd0e8a98f4499d4b7b4a9255441a5␟8093595438228616861: All Day `,h=$localize`:␟f1701d7a0d6bfb739979f9e406793d97acd138e3␟8675972661523566351: Require locker `,b=$localize`:␟60ae849c087ccc322073478a12b2504433fbdd61␟9086691296106045671:Group Members`,y=$localize`:␟1bdfc0dfd2ac89f5d0d2af3a66e5e959d094b39c␟8637135334686190699:Request Asset`,[["class","p-0 sm:py-4 sm:px-16 divide-y divide-gray-300 space-y-2",3,"formGroup",4,"ngIf"],[1,"p-0","sm:py-4","sm:px-16","divide-y","divide-gray-300","space-y-2",3,"formGroup"],["class","flex items-center",4,"ngIf"],[1,"p-2"],[1,"space-x-2","flex","items-center","mb-4"],[1,"bg-black/20","rounded-full","h-6","w-6","flex","items-center","justify-center"],[1,"text-xl"],o,[1,"flex","items-center","flex-wrap","sm:space-x-2"],[1,"flex-1","min-w-[256px]"],["for","title"],["appearance","outline",1,"w-full"],["matInput","","name","title","formControlName","title","placeholder","e.g. Focus Time"],n,["for","date"],t,["name","date","formControlName","date"],i,[1,"flex","items-center","space-x-2"],[1,"flex-1","w-1/3"],["for","start-time"],_,["name","start-time",3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex-1","w-1/3","relative"],["for","end-time"],s,["name","end-time","formControlName","duration",3,"time","max","min","step"],["formControlName","all_day","class","absolute -top-2 right-0",4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],["class","p-2",4,"ngIf"],a,["formControlName","resources"],[1,"flex","items-center"],["matRipple","",1,"relative","h-16","flex","items-center","justify-center","flex-1","space-x-2",3,"click"],[1,"text-2xl"],[1,""],r,[1,"absolute","h-2","inset-x-0","bottom-0","!m-0"],u,["formControlName","all_day",1,"absolute","-top-2","right-0"],g,[3,"ngModel","ngModelOptions","ngModelChange"],h,[1,"space-x-2","flex","items-center"],b,[1,"flex-1","w-px"],[1,"overflow-hidden"],[1,"mt-4",3,"ngModel","ngModelOptions","ngModelChange"],y,["formControlName","assets"]]},template:function(n,t){1&n&&e.YNc(0,Sl,48,20,"div",0),2&n&&e.Q6J("ngIf",t.form)},dependencies:[l.O5,T.o,S.KE,S.TO,D.Nt,Be.Q,je.B,He.N,kt.E,vn.k,hl.A,C.wG,R.oG,c.Fj,c.JJ,c.JL,c.On,c.sg,c.u,l.Ov],encapsulation:2});class Ct{constructor(n,t,i,_,s){this._state=n,this._router=t,this._org=i,this._bottom_sheet=_,this._settings=s,this.level="",this.levels=[],this.clearForm=()=>{this.level=this._org.building.id,this._state.clearForm()},this.viewConfirm=()=>{if(!this.form.valid)return(0,p.cB)(`Some fields are invalid. [${(0,p.RD)(this.form).join(", ")}]`);this.sheet_ref=this._bottom_sheet.open(ft),this.sheet_ref.instance.show_close=!0,this.sheet_ref.afterDismissed().subscribe(a=>{a&&(this._router.navigate(["/book","newdesk","success"]),this._state.setView("success"))})}}get form(){return this._state.form}ngOnInit(){var n=this;return(0,m.Z)(function*(){yield n._org.initialised.pipe((0,Z.P)(t=>t)),yield n._org.active_levels.pipe((0,Z.P)(t=>t?.length>0)),n.level=n._org.building?.id,n.levels=[{id:n._org.building?.id,name:"Any Level"},...n._org.levelsForBuilding(n._org.building)]})()}}Ct.\u0275fac=function(n){return new(n||Ct)(e.Y36(E.fy),e.Y36(x.F0),e.Y36(A.w7),e.Y36(B.ch),e.Y36(p.gb))},Ct.\u0275cmp=e.Xpm({type:Ct,selectors:[["new-desk-flow-form"]],decls:9,vars:2,consts:function(){let o,n;return o=$localize`:␟4bea0720f004b37b457bf013e0b7f72a2adcb9b1␟7639597883564022112: Book Desk `,n=$localize`:␟ba76c84c2e66f5a18f3856c7839505c55fba682f␟1406658621282821522: Confirm Desk `,[[1,"h-full","w-full","bg-gray-100","dark:bg-neutral-600","overflow-auto"],[1,"max-w-full","w-[48rem]","mx-auto","sm:my-4","bg-white","dark:bg-neutral-700","border","border-gray-300","dark:border-neutral-500"],[1,"w-full","p-4","sm:py-4","sm:px-16","text-2xl","font-medium","border-b","border-gray-300","dark:border-neutral-500"],o,[3,"form"],[1,"sm:mb-2","border-b","border-gray-300","dark:border-neutral-500","w-full"],[1,"flex","flex-col","sm:flex-row","items-center","sm:space-x-2","p-2","sm:px-16","sm:mb-2"],["btn","","matRipple","","confirm","",1,"w-full","sm:w-auto",3,"disabled","click"],n]},template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e.SDv(3,3),e.qZA(),e._UZ(4,"new-desk-form-details",4)(5,"div",5),e.TgZ(6,"section",6)(7,"button",7),e.NdJ("click",function(){return t.viewConfirm()}),e.SDv(8,8),e.qZA()()()()),2&n&&(e.xp6(4),e.Q6J("form",t.form),e.xp6(3),e.Q6J("disabled",!t.form.valid))},dependencies:[C.wG,ht],encapsulation:2});var Jt=d(9497),Al=d(158);function bl(o,n){if(1&o&&(e.tHW(0,6,1),e._UZ(1,"span",12),e.N_p()),2&o){const t=e.oxw();e.xp6(1),e.pQV(null==t.last_event||null==t.last_event.extension_data||null==t.last_event.extension_data.assets?null:t.last_event.extension_data.assets.length),e.QtT(0)}}function Fl(o,n){if(1&o&&(e.TgZ(0,"div",13)(1,"a",14),e.ALo(2,"sanitize"),e._UZ(3,"img",15),e.TgZ(4,"span"),e.SDv(5,16),e.qZA()(),e.TgZ(6,"a",14),e.ALo(7,"sanitize"),e._UZ(8,"img",17),e.TgZ(9,"span"),e.SDv(10,18),e.qZA()(),e.TgZ(11,"a",14),e.ALo(12,"safe"),e.TgZ(13,"app-icon",19),e._uU(14,"download"),e.qZA(),e.TgZ(15,"span"),e.SDv(16,20),e.qZA()()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("href",e.xi3(2,3,t.outlook_link,"url"),e.LSH),e.xp6(5),e.Q6J("href",e.xi3(7,6,t.google_link,"url"),e.LSH),e.xp6(5),e.Q6J("href",e.xi3(12,9,t.ical_link,"url"),e.LSH)}}const Nl=function(){return["/"]};class Tt{constructor(n,t){this._state=n,this._settings=t,this.outlook_link="",this.google_link="",this.ical_link="",this.viewCalendarLinks=()=>this._state.openBookingLinkModal()}get location(){const n=this.last_event?.extension_data?.booking_asset;return n&&n.zone?`, ${n.zone.display_name||n.zone.name||n.zone.id}`:""}get last_event(){return this._state.last_success}get show_links(){return this._settings.get("app.desks.show_calendar_links")}ngOnInit(){this.outlook_link=(0,Jt.Y$)(this.last_event),this.google_link=(0,Jt.T$)(this.last_event),this.ical_link=(0,Jt.KS)(this.last_event)}}function wl(o,n){1&o&&(e.ynx(0),e._UZ(1,"new-desk-flow-success"),e.BQk())}function Ml(o,n){1&o&&(e.ynx(0),e._UZ(1,"new-desk-flow-form"),e.BQk())}Tt.\u0275fac=function(n){return new(n||Tt)(e.Y36(E.fy),e.Y36(p.gb))},Tt.\u0275cmp=e.Xpm({type:Tt,selectors:[["new-desk-flow-success"]],decls:15,vars:18,consts:function(){let o,n,t,i,_,s;return o=$localize`:␟56ae814b08614e0ea7d03f8c2f6deb8385091857␟3615288463984354959: ${"\ufffd0\ufffd"}:INTERPOLATION:${"\ufffd1\ufffd"}:INTERPOLATION_1: Booked! `,n=$localize`:␟44c59d98706bc456a0feecbb41601eec38da367e␟1969482015227334006: Great, thanks! `,t=$localize`:␟d067b9f19941cfab1981b0c03f7da88743fff219␟7814817659106221463: Your desk has been successfully booked ${"\ufffd*7:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_SPAN: including ${"\ufffd0:1\ufffd"}:INTERPOLATION: asset(s) ${"\ufffd/#1:1\ufffd\ufffd/*7:1\ufffd"}:CLOSE_TAG_SPAN: for the ${"\ufffd0\ufffd"}:INTERPOLATION_1: at ${"\ufffd1\ufffd"}:INTERPOLATION_2:-${"\ufffd2\ufffd"}:INTERPOLATION_3:. `,i=$localize`:␟11765fae755306c1287745a7ddb4461aae072a68␟7547869007893180695:Add to Outlook`,_=$localize`:␟fa6bd0f777a40a0f26b09751bf006c7337d547ac␟2479867054818994962:Add to Google Calendar`,s=$localize`:␟1af54061e7f4bcfb1048ffaa05c9b8f7c4b41679␟4894641609416495396:Download iCal File`,[[1,"absolute","inset-0","bg-white","dark:bg-neutral-600","flex","flex-col","z-50"],[1,"flex-1","flex","flex-col","items-center","justify-center","space-y-2","p-8"],[1,"text-2xl","font-medium","text-center"],o,["src","assets/icons/success.svg"],[1,"text-center"],t,["assets","",4,"ngIf"],["class","flex flex-col items-center space-y-4 p-4 relative",4,"ngIf"],[1,"p-2","w-full","border-t","border-gray-200","dark:border-neutral-500","mt-4","flex","items-center","justify-center"],["btn","","matRipple","",1,"w-full","max-w-[32rem]","mx-auto",3,"routerLink"],n,["assets",""],[1,"flex","flex-col","items-center","space-y-4","p-4","relative"],["btn","","matRipple","","target","_blank","rel","noopener noreferer",1,"flex","items-center","p-2","space-x-2","pr-4","w-64","rounded","inverse",3,"href"],["src","assets/icons/outlook.svg",1,"w-6"],i,["src","assets/icons/gcal.svg",1,"w-6"],_,[1,"text-xl"],s]},template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"main",1)(2,"h2",2),e.SDv(3,3),e.qZA(),e._UZ(4,"img",4),e.TgZ(5,"p",5),e.tHW(6,6),e.YNc(7,bl,2,1,"span",7),e.ALo(8,"date"),e.ALo(9,"date"),e.ALo(10,"date"),e.N_p(),e.qZA(),e.YNc(11,Fl,17,12,"div",8),e.qZA(),e.TgZ(12,"footer",9)(13,"a",10),e.SDv(14,11),e.qZA()()()),2&n&&(e.xp6(3),e.pQV(t.last_event.asset_name||t.last_event.asset_id)(t.location),e.QtT(3),e.xp6(4),e.Q6J("ngIf",null==t.last_event||null==t.last_event.extension_data||null==t.last_event.extension_data.assets?null:t.last_event.extension_data.assets.length),e.xp6(3),e.pQV(e.xi3(8,8,t.last_event.date,"mediumDate"))(e.xi3(9,11,t.last_event.date,"shortTime"))(e.xi3(10,14,t.last_event.date+60*t.last_event.duration*1e3,"shortTime")),e.QtT(6),e.xp6(1),e.Q6J("ngIf",t.show_links),e.xp6(2),e.Q6J("routerLink",e.DdM(17,Nl)))},dependencies:[l.O5,T.o,C.wG,x.rH,l.uU,Al.y,xn.n],encapsulation:2});class xt extends p.KG{constructor(n,t,i){super(),this._state=n,this._route=t,this._org=i}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){var n=this;return(0,m.Z)(function*(){yield n._org.initialised.pipe((0,Z.P)(t=>t)).toPromise(),n._state.loadForm(),n._state.form||n._state.newForm(),n._state.setOptions({type:"desk"}),n._state.form.patchValue({booking_type:"desk"}),n.subscription("route.params",n._route.paramMap.subscribe(t=>{t.has("step")&&n._state.setView(t.get("step"))})),n.subscription("route.query",n._route.queryParamMap.subscribe(t=>{t.has("success")&&n._state.setView(t.get("success")),t.has("asset_id")&&n._state.form.patchValue({resources:[new A.nk({id:t.get("asset_id"),name:t.get("asset_id")})]})}))})()}}xt.\u0275fac=function(n){return new(n||xt)(e.Y36(E.fy),e.Y36(x.gz),e.Y36(A.w7))},xt.\u0275cmp=e.Xpm({type:xt,selectors:[["placeos-new-book-desk-flow"]],features:[e.qOj],decls:4,vars:2,consts:[[1,"bg-white","dark:bg-neutral-900","h-full","w-full","z-50"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.ynx(1,1),e.YNc(2,wl,2,0,"ng-container",2),e.YNc(3,Ml,2,0,"ng-container",3),e.BQk(),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngSwitch",t.view),e.xp6(1),e.Q6J("ngSwitchCase","success"))},dependencies:[l.RF,l.n9,l.ED,Ct,Tt],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]});var Zl=d(9761);class vt{constructor(n){this._router=n}onDone(){this._router.navigate(["/"])}}function Rl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.dismiss())}),e.TgZ(1,"app-icon"),e._uU(2,"close"),e.qZA()()}}function yl(o,n){1&o&&e._UZ(0,"mat-spinner",16)}function Il(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",21)(2,"app-icon"),e._uU(3,"arrow_upward"),e.qZA(),e.TgZ(4,"div"),e._uU(5),e.qZA()(),e.BQk()),2&o){const t=n.$implicit;e.xp6(5),e.Oqu(t)}}function kl(o,n){if(1&o&&(e.TgZ(0,"section",17)(1,"app-icon",6),e._uU(2,"done"),e.qZA(),e.TgZ(3,"div",7)(4,"h3",18),e._uU(5),e.qZA(),e.TgZ(6,"div",8)(7,"app-icon"),e._uU(8,"person"),e.qZA(),e.TgZ(9,"span"),e.SDv(10,19),e.qZA()(),e.TgZ(11,"div",8)(12,"app-icon"),e._uU(13,"place"),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.qZA()(),e.YNc(16,Il,6,1,"ng-container",20),e.qZA()()),2&o){const t=e.oxw();e.xp6(5),e.hij(" ",(null==t.booking_asset?null:t.booking_asset.name)||(null==t.booking_asset?null:t.booking_asset.id)||""," "),e.xp6(10),e.Oqu(t.location),e.xp6(1),e.Q6J("ngForOf",t.booking_asset.features)}}function Pl(o,n){if(1&o&&(e.TgZ(0,"div",25)(1,"div",26),e._uU(2),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA()()),2&o){const t=n.$implicit;e.xp6(2),e.hij(" ",t.amount," "),e.xp6(2),e.Oqu(t.name)}}function Ul(o,n){if(1&o&&(e.TgZ(0,"section",22)(1,"app-icon",6),e._uU(2,"done"),e.qZA(),e.TgZ(3,"div",7)(4,"h3"),e.SDv(5,23),e.qZA(),e.YNc(6,Pl,5,2,"div",24),e.qZA()()),2&o){const t=e.oxw();e.xp6(5),e.pQV(t.assets_count),e.QtT(5),e.xp6(1),e.Q6J("ngForOf",t.assets)}}function Dl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(t);const _=e.oxw();return e.KtG(_.postForm())}),e.SDv(1,28),e.qZA()}}vt.\u0275fac=function(n){return new(n||vt)(e.Y36(x.F0))},vt.\u0275cmp=e.Xpm({type:vt,selectors:[["placeos-book-space-flow"]],decls:3,vars:0,consts:[[1,"bg-gray-100","dark:bg-neutral-600","h-full","w-full","overflow-auto"],[1,"w-full","h-full","sm:h-auto","max-w-[640px]","mx-auto","sm:my-4","bg-white","shadow","border","border-gray-200","dark:border-neutral-500","overflow-hidden"],[3,"done"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"invite-visitor-form",2),e.NdJ("done",function(){return t.onDone()}),e.qZA()()())},dependencies:[Zl.C],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}"]});class Ot extends p.KG{constructor(n,t,i){var _;super(),_=this,this._state=n,this._org=t,this._sheet_ref=i,this.show_close=!1,this.loading=this._state.loading,this.postForm=(0,m.Z)(function*(){yield _._state.postForm(),_.dismiss(!0)}),this.dismiss=s=>this._sheet_ref?.dismiss(s)}get booking(){return this._state.form.value}get assets(){return this.booking.assets||null}get assets_count(){return this.assets?.length?this.assets.reduce((n,t)=>n+t.amount,0):0}get booking_asset(){return this.booking.booking_asset}get location(){const n=this._org.buildings.find(i=>i.id===this.booking_asset?.zone?.parent_id),t=this._org.levels.find(i=>i.id===this.booking_asset?.zone?.id);return`${t?.display_name||t?.name}${n?",":""} ${n?.address||n?.display_name||n?.name||""}`}}Ot.\u0275fac=function(n){return new(n||Ot)(e.Y36(E.fy),e.Y36(A.w7),e.Y36(B.oL,8))},Ot.\u0275cmp=e.Xpm({type:Ot,selectors:[["new-parking-flow-confirm"]],inputs:{show_close:"show_close"},features:[e.qOj],decls:30,vars:21,consts:function(){let o,n,t,i;return o=$localize`:␟6ac3300544e83db3f24ae1c1021893d886c0a744␟6045786788889963176: Confirm Parking Reservation `,n=$localize`:␟f07b4a195d4f2e886e6648ea01409e8747490a41␟3161111465515562669:Car Park`,t=$localize`:␟baacc4ba232f9320250b9871e259ccb844857f15␟3853466990357051325:${"\ufffd0\ufffd"}:INTERPOLATION: Asset(s)`,i=$localize`:␟0ad83be7464a0a2e8d100342e144bc3fbc789f9d␟3141803775366633134: Confirm `,[["close","","icon","","matRipple","",3,"click",4,"ngIf"],[1,"flex","items-center","justify-between","px-2"],[1,"text-2xl","font-medium","mb-2"],o,["diameter","32",4,"ngIf"],["period","",1,"flex","space-x-1","py-4","px-2"],[1,"text-success"],["details","",1,"leading-6"],[1,"flex","items-center","space-x-2"],["date",""],["time",""],["resource","","class","flex space-x-1 py-4 px-2 border-t",4,"ngIf"],["assets","","class","flex space-x-1 py-4 px-2 border-t",4,"ngIf"],[1,"p-2","w-full","border-t","border-gray-200","mt-4"],["confirm","","btn","","matRipple","","class","w-full",3,"click",4,"ngIf"],["close","","icon","","matRipple","",3,"click"],["diameter","32"],["resource","",1,"flex","space-x-1","py-4","px-2","border-t"],["name",""],n,[4,"ngFor","ngForOf"],["features","",1,"flex","items-center","space-x-2"],["assets","",1,"flex","space-x-1","py-4","px-2","border-t"],t,["class","flex space-x-2",4,"ngFor","ngForOf"],[1,"flex","space-x-2"],[1,"h-5","w-5","bg-gray-100","rounded-full"],["confirm","","btn","","matRipple","",1,"w-full",3,"click"],i]},template:function(n,t){1&n&&(e.YNc(0,Rl,3,0,"button",0),e.TgZ(1,"header",1)(2,"h2",2),e.SDv(3,3),e.qZA(),e.YNc(4,yl,1,0,"mat-spinner",4),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"section",5)(7,"app-icon",6),e._uU(8,"done"),e.qZA(),e.TgZ(9,"div",7)(10,"h3"),e._uU(11),e.qZA(),e.TgZ(12,"div",8)(13,"app-icon"),e._uU(14,"calendar_today"),e.qZA(),e.TgZ(15,"div",9),e._uU(16),e.ALo(17,"date"),e.qZA()(),e.TgZ(18,"div",8)(19,"app-icon"),e._uU(20,"schedule"),e.qZA(),e.TgZ(21,"div",10),e._uU(22),e.ALo(23,"date"),e.ALo(24,"date"),e.qZA()()()(),e.YNc(25,kl,17,3,"section",11),e.YNc(26,Ul,7,2,"section",12),e.TgZ(27,"footer",13),e.YNc(28,Dl,2,0,"button",14),e.ALo(29,"async"),e.qZA()),2&n&&(e.Q6J("ngIf",t.show_close),e.xp6(4),e.Q6J("ngIf",e.lcZ(5,8,t.loading)),e.xp6(7),e.Oqu(t.booking.title||"~Untitled~"),e.xp6(5),e.Oqu(e.xi3(17,10,t.booking.date,"fullDate")),e.xp6(6),e.hij(" ",t.booking.all_day?"All Day":e.xi3(23,13,t.booking.date,"shortTime")+" - "+e.xi3(24,16,t.booking.date+60*t.booking.duration*1e3,"h:mm a (z)")," "),e.xp6(3),e.Q6J("ngIf",null==t.booking_asset?null:t.booking_asset.id),e.xp6(1),e.Q6J("ngIf",null==t.assets?null:t.assets.length),e.xp6(2),e.Q6J("ngIf",!e.lcZ(29,19,t.loading)))},dependencies:[l.sg,l.O5,T.o,w.Ou,C.wG,l.Ov,l.uU],styles:["section[_ngcontent-%COMP%] > app-icon[_ngcontent-%COMP%]{font-size:1.5rem;margin-top:.3rem}h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:medium;margin:.5rem 0}"]});var Ll=d(1474);function ql(o,n){if(1&o&&(e.TgZ(0,"mat-option",27),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}function Kl(o,n){1&o&&(e.TgZ(0,"mat-checkbox",28),e.SDv(1,29),e.qZA())}const On=function(){return{standalone:!0}};function Wl(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"label",4),e.tHW(4,5),e._UZ(5,"span"),e.N_p(),e.qZA(),e.TgZ(6,"mat-form-field",6)(7,"mat-select",7),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.setBuilding(_))}),e.ALo(8,"async"),e.YNc(9,ql,2,2,"mat-option",8),e.ALo(10,"async"),e.qZA(),e.TgZ(11,"mat-error"),e.SDv(12,9),e.qZA()()()(),e.TgZ(13,"div",2)(14,"div",3)(15,"label",4),e.tHW(16,10),e._UZ(17,"span"),e.N_p(),e.qZA(),e.TgZ(18,"mat-form-field",6),e._UZ(19,"input",11),e.TgZ(20,"mat-error"),e.SDv(21,12),e.qZA()()(),e.TgZ(22,"div",3)(23,"label",13),e.tHW(24,14),e._UZ(25,"span"),e.N_p(),e.qZA(),e.TgZ(26,"a-date-field",15),e.SDv(27,16),e.qZA()()(),e.TgZ(28,"div",17)(29,"div",18)(30,"label",19),e.tHW(31,20),e._UZ(32,"span"),e.N_p(),e.qZA(),e.TgZ(33,"a-time-field",21),e.NdJ("ngModelChange",function(_){e.CHM(t);const s=e.oxw();return e.KtG(s.form.patchValue({date:_}))}),e.qZA()(),e.TgZ(34,"div",22)(35,"label",23),e.tHW(36,24),e._UZ(37,"span"),e.N_p(),e.qZA(),e._UZ(38,"a-duration-field",25),e.YNc(39,Kl,2,0,"mat-checkbox",26),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(7),e.Q6J("ngModel",e.lcZ(8,9,t.building))("ngModelOptions",e.DdM(13,On)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(10,11,t.building_list)),e.xp6(24),e.Q6J("ngModel",t.form.value.date)("ngModelOptions",e.DdM(14,On)),e.xp6(5),e.Q6J("time",null==t.form||null==t.form.value?null:t.form.value.date)("max",t.max_duration),e.xp6(1),e.Q6J("ngIf",t.allow_all_day)}}class Et extends p.KG{constructor(n,t){super(),this._settings=n,this._org=t,this.building=this._org.active_building,this.building_list=this._org.building_list,this.setBuilding=i=>this._org.building=i}get max_duration(){return this._settings.get("app.bookings.max_duration")||480}get allow_all_day(){return this._settings.get("app.bookings.allow_all_day")}ngOnInit(){this.subscription("change",this.form.get("resources")?.valueChanges?.subscribe(n=>n.length?this.setBookingAsset(n[0]):""))}setBookingAsset(n){!n||this.form.patchValue({asset_id:n?.id,asset_name:n.name,map_id:n?.map_id||n?.id,description:n.name,booking_type:"parking",zones:n.zone?[n.zone?.parent_id,n.zone?.id]:[],booking_asset:n})}}Et.\u0275fac=function(n){return new(n||Et)(e.Y36(p.gb),e.Y36(A.w7))},Et.\u0275cmp=e.Xpm({type:Et,selectors:[["parking-form-details"]],inputs:{form:"form"},features:[e.qOj],decls:1,vars:1,consts:function(){let o,n,t,i,_,s,a,r,u;return o=$localize`:␟029554be61f13a5f5f40b24ff6a076e8cf3ce232␟5030059473688609624:Building${"\ufffd#5\ufffd"}:START_TAG_SPAN:*${"\ufffd/#5\ufffd"}:CLOSE_TAG_SPAN:`,n=$localize`:␟08e3d128bec28b1e0d78c758b98afd2af8a9b9db␟3928125525365975257:Building is required`,t=$localize`:␟cdeff056c80e8cb677a396ccfd5935d3ccacbaaa␟553839126299245827:Add Title${"\ufffd#17\ufffd"}:START_TAG_SPAN:*${"\ufffd/#17\ufffd"}:CLOSE_TAG_SPAN:`,i=$localize`:␟0c2de7385a88f7877e11c22c4e44db7f8ddfdc9c␟6959098405177292139:Meeting title is required.`,_=$localize`:␟04cfb5fd033651743bc4b9408bd52ba4ee894070␟3158758063619980932:Date${"\ufffd#25\ufffd"}:START_TAG_SPAN:*${"\ufffd/#25\ufffd"}:CLOSE_TAG_SPAN:`,s=$localize`:␟455329270b0142c3d200cf5bc63dbcb0bf0c6a39␟7901981723580144849: Date and time must be in the future `,a=$localize`:␟34a7595cdc15925514038224946986bfd90dc0ed␟3039786638368843634:Start Time${"\ufffd#32\ufffd"}:START_TAG_SPAN:*${"\ufffd/#32\ufffd"}:CLOSE_TAG_SPAN:`,r=$localize`:␟85d5c3a89bab9a7475a7db095089e161586cb7a1␟5960185837188220843:End Time${"\ufffd#37\ufffd"}:START_TAG_SPAN:*${"\ufffd/#37\ufffd"}:CLOSE_TAG_SPAN:`,u=$localize`:␟3f764cf800e1b80f028aa7c5f93eb9e97ba1ad85␟3728070438368732304: All Day `,[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"flex","items-center","flex-wrap","sm:space-x-2"],[1,"flex-1","min-w-[256px]"],["for","title"],o,["appearance","outline",1,"w-full"],[3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],n,t,["matInput","","name","title","formControlName","title","placeholder","e.g. Team Meeting"],i,["for","date"],_,["name","date","formControlName","date"],s,[1,"flex","items-center","space-x-2"],[1,"flex-1","w-1/3"],["for","start-time"],a,["name","start-time",3,"ngModel","ngModelOptions","ngModelChange"],[1,"flex-1","w-1/3","relative"],["for","end-time"],r,["name","end-time","formControlName","duration",3,"time","max"],["formControlName","all_day","class","absolute top-0 right-0",4,"ngIf"],[3,"value"],["formControlName","all_day",1,"absolute","top-0","right-0"],u]},template:function(n,t){1&n&&e.YNc(0,Wl,40,15,"div",0),2&n&&e.Q6J("ngIf",t.form)},dependencies:[l.sg,l.O5,C.ey,S.KE,S.TO,X.gD,D.Nt,Be.Q,je.B,He.N,R.oG,c.Fj,c.JJ,c.JL,c.On,c.sg,c.u,l.Ov]});class St extends p.KG{constructor(n,t,i,_){super(),this._state=n,this._settings=t,this._router=i,this._bottom_sheet=_,this.hide_block={},this.clearForm=()=>this._state.resetForm(),this.viewConfirm=()=>{if(!this.form.valid)return(0,p.cB)(`Some fields are invalid. [${(0,p.RD)(this.form).join(", ")}]`);this.sheet_ref=this._bottom_sheet.open(Ot),this.sheet_ref.instance.show_close=!0,this.sheet_ref.afterDismissed().subscribe(s=>{s&&(this._router.navigate(["/book","new-parking","success"]),this._state.setView("success"))})}}get form(){return this._state.form}ngOnInit(){this._state.setOptions({type:"parking"})}}St.\u0275fac=function(n){return new(n||St)(e.Y36(E.fy),e.Y36(p.gb),e.Y36(x.F0),e.Y36(B.ch))},St.\u0275cmp=e.Xpm({type:St,selectors:[["parking-flow-form"]],features:[e.qOj],decls:34,vars:8,consts:function(){let o,n,t,i,_;return o=$localize`:␟1a35d8abd8af5fbdc560fef43534a449dee57c33␟6157089537932930617: ${"\ufffd0\ufffd"}:INTERPOLATION: Parking Reservation `,n=$localize`:␟4f8b2bb476981727ab34ed40fde1218361f92c45␟5028777105388019087:Details`,t=$localize`:␟52d92107e6b2e533468a728409354191bc7b0618␟8946906119075338535:Space`,i=$localize`:␟7b837f0569edc83611ec018993bf131599b941b6␟425357839768260226: Confirm Reservation `,_=$localize`:␟a6bac7e54de03807f0b5486f4f9f9add5ec00fb2␟1889608407849557875: ${"\ufffd0\ufffd"}:INTERPOLATION: Form `,[[1,"h-full","w-full","bg-gray-100","dark:bg-neutral-600","overflow-auto"],[1,"max-w-full","w-[48rem]","mx-auto","sm:my-4","bg-white","dark:bg-neutral-700","border","border-gray-300","dark:border-neutral-500"],[1,"w-full","p-4","sm:py-4","sm:px-16","text-2xl","font-medium","border-b","border-gray-300","dark:border-neutral-500"],o,[1,"p-0","sm:py-4","sm:px-16","divide-y","divide-gray-300","space-y-2",3,"formGroup"],[1,"p-2"],[1,"space-x-2","flex","items-center"],[1,"bg-black/20","rounded-full","h-6","w-6","flex","items-center","justify-center"],[1,"text-xl"],n,[1,"flex-1","w-px"],["icon","","matRipple","",3,"click"],[1,"overflow-hidden"],[1,"mt-4",3,"form"],t,["formControlName","resources"],[1,"flex","flex-col","sm:flex-row","items-center","sm:space-x-2","p-2"],["btn","","matRipple","","confirm","",1,"mb-2","sm:mb-0","w-full","sm:w-auto",3,"click"],i,["btn","","matRipple","","clear-form","",1,"inverse","w-full","sm:w-auto",3,"click"],_]},template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e.SDv(3,3),e.qZA(),e.TgZ(4,"form",4)(5,"section",5)(6,"h3",6)(7,"div",7),e._uU(8," 1 "),e.qZA(),e.TgZ(9,"div",8),e.SDv(10,9),e.qZA(),e._UZ(11,"div",10),e.TgZ(12,"button",11),e.NdJ("click",function(){return t.hide_block.details=!t.hide_block.details}),e.TgZ(13,"app-icon"),e._uU(14),e.qZA()()(),e.TgZ(15,"div",12),e._UZ(16,"parking-form-details",13),e.qZA()(),e.TgZ(17,"section",5)(18,"h3",6)(19,"div",7),e._uU(20," 2 "),e.qZA(),e.TgZ(21,"div",8),e.SDv(22,14),e.qZA(),e._UZ(23,"div",10),e.TgZ(24,"button",11),e.NdJ("click",function(){return t.hide_block.space=!t.hide_block.space}),e.TgZ(25,"app-icon"),e._uU(26),e.qZA()()(),e.TgZ(27,"div",12),e._UZ(28,"parking-space-list-field",15),e.qZA()(),e.TgZ(29,"section",16)(30,"button",17),e.NdJ("click",function(){return t.viewConfirm()}),e.SDv(31,18),e.qZA(),e.TgZ(32,"button",19),e.NdJ("click",function(){return t.clearForm()}),e.SDv(33,20),e.qZA()()()()()),2&n&&(e.xp6(3),e.pQV(t.form.value.id?"Edit":"Book"),e.QtT(3),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(10),e.Oqu(t.hide_block.details?"expand_more":"expand_less"),e.xp6(1),e.Q6J("@show",t.hide_block.details?"hide":"show"),e.xp6(1),e.Q6J("form",t.form),e.xp6(10),e.Oqu(t.hide_block.space?"expand_more":"expand_less"),e.xp6(1),e.Q6J("@show",t.hide_block.space?"hide":"show"),e.xp6(6),e.pQV(t.form.value.id?"Reset":"Clear"),e.QtT(33))},dependencies:[T.o,Ll.h,C.wG,c._Y,c.JJ,c.JL,c.sg,c.u,Et],data:{animation:[p.X7]}});const $l=function(){return["/"]};class At{constructor(n){this._state=n}get location(){const n=this.last_event?.extension_data?.booking_asset;return n&&n.zone?`, ${n.zone.display_name||n.zone.name||n.zone.id}`:""}get last_event(){return this._state.last_success}}function Gl(o,n){1&o&&e._UZ(0,"parking-flow-success")}function Jl(o,n){1&o&&e._UZ(0,"parking-flow-confirm")}function Yl(o,n){1&o&&e._UZ(0,"parking-flow-form")}At.\u0275fac=function(n){return new(n||At)(e.Y36(E.fy))},At.\u0275cmp=e.Xpm({type:At,selectors:[["parking-flow-success"]],decls:14,vars:16,consts:function(){let o,n,t;return o=$localize`:␟21cad50e7a6d698f282551d4331fbd036f1dbfbd␟8243507933110259384:Parking Space Confirmed!`,n=$localize`:␟25c4a16c36095489227adae7799a3c73d367be35␟8902696609937191558: Your ${"\ufffd#6\ufffd"}:START_TAG_SPAN: parking space reservation for ${"\ufffd0\ufffd"}:INTERPOLATION: at ${"\ufffd1\ufffd"}:INTERPOLATION_1:, ${"\ufffd/#6\ufffd"}:CLOSE_TAG_SPAN:has been successfully booked for the ${"\ufffd2\ufffd"}:INTERPOLATION_2: at ${"\ufffd3\ufffd"}:INTERPOLATION_3:-${"\ufffd4\ufffd"}:INTERPOLATION_4:. `,t=$localize`:␟ebdb7427e661a3194bc5c3619482b7d363ddbb3c␟5973872115846779659: Great, thanks! `,[[1,"absolute","inset-0","bg-white","flex","flex-col","z-50"],[1,"flex-1","flex","flex-col","items-center","justify-center","space-y-2","p-8"],[1,"text-2xl","font-medium"],o,[1,"text-center","max-w-[32rem]"],n,["src","assets/icons/parking-success.svg"],[1,"p-2","w-full","border-t","border-gray-200","mt-4","flex","items-center","justify-center"],["button","","btn","","matRipple","",1,"w-full","max-w-[32rem]",3,"routerLink"],t]},template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"main",1)(2,"h2",2),e.SDv(3,3),e.qZA(),e.TgZ(4,"p",4),e.tHW(5,5),e._UZ(6,"span"),e.ALo(7,"date"),e.ALo(8,"date"),e.ALo(9,"date"),e.N_p(),e.qZA(),e._UZ(10,"img",6),e.qZA(),e.TgZ(11,"footer",7)(12,"a",8),e.SDv(13,9),e.qZA()()()),2&n&&(e.xp6(9),e.pQV(t.last_event.asset_name)(t.location)(e.xi3(7,6,t.last_event.date,"mediumDate"))(e.xi3(8,9,t.last_event.date,"shortTime"))(e.xi3(9,12,t.last_event.date+60*t.last_event.duration*1e3,"shortTime")),e.QtT(5),e.xp6(3),e.Q6J("routerLink",e.DdM(15,$l)))},dependencies:[C.wG,x.rH,l.uU]});class bt extends p.KG{constructor(n,t){super(),this._state=n,this._route=t}get view(){return this._state.view}get last_success(){return this._state.last_success}ngOnInit(){this._state.loadForm(),this._state.form||this._state.newForm(),this._state.setOptions({type:"parking"}),this._state.form.patchValue({booking_type:"parking"}),this.subscription("route.params",this._route.paramMap.subscribe(n=>{n.has("step")&&this._state.setView(n.get("step"))})),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("success")&&this._state.setView("success")}))}}bt.\u0275fac=function(n){return new(n||bt)(e.Y36(E.fy),e.Y36(x.gz))},bt.\u0275cmp=e.Xpm({type:bt,selectors:[["placeos-new-parking-flow"]],features:[e.qOj],decls:4,vars:3,consts:[[1,"bg-white","dark:bg-neutral-900","h-full","w-full","z-50",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,Gl,1,0,"parking-flow-success",1),e.YNc(2,Jl,1,0,"parking-flow-confirm",1),e.YNc(3,Yl,1,0,"parking-flow-form",2),e.qZA()),2&n&&(e.Q6J("ngSwitch",t.view),e.xp6(1),e.Q6J("ngSwitchCase","success"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"))},dependencies:[l.RF,l.n9,l.ED,Me,St,At],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]});const Ql=function(){return["/"]};class Ft{}function Bl(o,n){1&o&&(e.ynx(0),e._uU(1," Booking has not started yet. Please try again once the booking has commenced. "),e.BQk())}function jl(o,n){1&o&&(e.ynx(0),e._uU(1," You have booking with a difference resource. "),e.BQk())}function Hl(o,n){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.hij(" You do not have a booking. Would you like to book ",t.asset_id,"? ")}}Ft.\u0275fac=function(n){return new(n||Ft)},Ft.\u0275cmp=e.Xpm({type:Ft,selectors:[["code-flow-success"]],decls:13,vars:11,consts:[[1,"absolute","inset-0","bg-white","dark:bg-neutral-600","flex","flex-col","z-50"],[1,"flex-1","flex","flex-col","items-center","justify-center","space-y-2","p-8"],[1,"text-2xl","font-medium"],["src","assets/icons/success.svg"],[1,"text-center","max-w-[32rem]"],[1,"p-2","w-full","border-t","border-gray-200","dark:bg-neutral-500","mt-4","flex","items-center","justify-center"],["button","","btn","","matRipple","",1,"w-full","max-w-[32rem]",3,"routerLink"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"main",1)(2,"h2",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"img",3),e.TgZ(6,"p",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"footer",5)(10,"a",6),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&n&&(e.xp6(3),e.hij(" ",e.lcZ(4,4,"WPA.RESOURCE_CHECKED_IN")," "),e.xp6(4),e.hij(" ",e.lcZ(8,6,"WPA.CHECKED_IN")," "),e.xp6(3),e.Q6J("routerLink",e.DdM(10,Ql)),e.xp6(1),e.hij(" ",e.lcZ(12,8,"WPA.BOOKING_DONE_CONTINUE")," "))},dependencies:[C.wG,x.rH,dt.X$]});const Xl=function(){return["/book","code"]},En=function(o){return{asset_id:o}};function zl(o,n){if(1&o&&(e.TgZ(0,"a",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw();e.Q6J("routerLink",e.DdM(5,Xl))("queryParams",e.VKq(6,En,t.asset_id)),e.xp6(1),e.hij(" ",e.lcZ(2,3,"WPA.TRY_AGAIN")," ")}}const Vl=function(){return["/book","newdesk"]};function er(o,n){if(1&o&&(e.TgZ(0,"a",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw();e.Q6J("routerLink",e.DdM(5,Vl))("queryParams",e.VKq(6,En,t.asset_id)),e.xp6(1),e.hij(" ",e.lcZ(2,3,"WPA.BOOK")," ")}}const tr=function(){return["/"]};class Nt extends p.KG{constructor(n){super(),this._route=n,this.type="",this.asset_id=""}ngOnInit(){this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{this.type=n.get("type"),this.asset_id=n.get("asset_id")}))}}Nt.\u0275fac=function(n){return new(n||Nt)(e.Y36(x.gz))},Nt.\u0275cmp=e.Xpm({type:Nt,selectors:[["code-flow-success"]],features:[e.qOj],decls:17,vars:13,consts:[[1,"absolute","inset-0","bg-white","dark:bg-neutral-600","flex","flex-col","z-50"],[1,"flex-1","flex","flex-col","items-center","justify-center","space-y-2","p-8"],[1,"text-2xl","font-medium"],[1,"py-4"],["src","assets/icons/not-found.svg",1,"h-64"],[1,"text-center","max-w-[32rem]",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"p-2","w-full","border-t","border-gray-200","dark:bg-neutral-500","mt-4","flex","items-center","justify-center","space-x-2"],["button","","btn","","matRipple","","class","w-full max-w-[32rem]",3,"routerLink","queryParams",4,"ngIf"],["button","","btn","","matRipple","",1,"w-full","max-w-[32rem]","inverse",3,"routerLink"],["button","","btn","","matRipple","",1,"w-full","max-w-[32rem]",3,"routerLink","queryParams"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"main",1)(2,"h2",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",3),e._UZ(6,"img",4),e.qZA(),e.TgZ(7,"p",5),e.YNc(8,Bl,2,0,"ng-container",6),e.YNc(9,jl,2,0,"ng-container",6),e.YNc(10,Hl,2,1,"ng-container",7),e.qZA()(),e.TgZ(11,"footer",8),e.YNc(12,zl,3,8,"a",9),e.YNc(13,er,3,8,"a",9),e.TgZ(14,"a",10),e._uU(15),e.ALo(16,"translate"),e.qZA()()()),2&n&&(e.xp6(3),e.hij(" ",e.lcZ(4,8,"WPA.RESOURCE_CHECKED_IN_FAILED")," "),e.xp6(4),e.Q6J("ngSwitch",t.type),e.xp6(1),e.Q6J("ngSwitchCase","not_started"),e.xp6(1),e.Q6J("ngSwitchCase","wrong_resource"),e.xp6(3),e.Q6J("ngIf","not_started"===t.type),e.xp6(1),e.Q6J("ngIf","no_booking"===t.type),e.xp6(1),e.Q6J("routerLink",e.DdM(12,tr)),e.xp6(1),e.hij(" ",e.lcZ(16,10,"COMMON.CONTINUE")," "))},dependencies:[l.O5,l.RF,l.n9,l.ED,C.wG,x.rH,dt.X$]});const nr=[{path:"",component:Ye,children:[{path:"code",component:Qe},{path:"code/success",component:Ft},{path:"code/error",component:Nt},{path:"newdesk",redirectTo:"newdesk/form"},{path:"newdesk/:step",component:xt},{path:"desks",redirectTo:"desks/form"},{path:"desks/:step",component:et},{path:"spaces",redirectTo:"spaces/form"},{path:"spaces/:step",component:st},{path:"meeting",redirectTo:"meeting/form"},{path:"meeting/:step",component:mt},{path:"parking",redirectTo:"parking/form"},{path:"parking/:step",component:rt},{path:"new-parking",redirectTo:"new-parking/form"},{path:"new-parking/:step",component:bt},{path:"visitor",redirectTo:"visitor/form"},{path:"visitor/:step",component:vt},{path:"*",redirectTo:"spaces/form"}]},{path:"*",redirectTo:"spaces/form"}];class Re{}Re.\u0275fac=function(n){return new(n||Re)},Re.\u0275mod=e.oAB({type:Re}),Re.\u0275inj=e.cJS({imports:[l.ez,ea.v,c.u5,ce,Fe,ke.P2,c.UX,Mn,B._r,E.EP,x.Bz.forChild(nr)]})}}]);