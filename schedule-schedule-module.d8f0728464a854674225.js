(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{L0xO:function(e,t,n){"use strict";n.r(t),n.d(t,"ScheduleModule",(function(){return Ke}));var i=n("qvOF"),c=n("2kYt"),s=n("nIj0"),a=n("sEIs"),o=n("R3Ii"),l=n("YtkY"),r=n("20lr"),b=n("9MvL"),d=n("XyEp"),u=n("R3DB"),h=n("KuCG"),f=n("EDDe"),m=n("CzDk"),v=n("HM3f"),g=n("EM62"),p=n("D57K"),_=n("05Mk"),O=n("eZII"),y=n("mrqE"),w=n("C05f"),x=n("47ST"),M=n("ROBh"),V=n("mWib"),k=n("TLy2"),W=n("4e/d"),E=n("wqq/"),j=n("7JBE"),I=n("OZ4H");let D=(()=>{class e extends r.b{constructor(e,t,n){super(),this._calendars=e,this._dialog=t,this._router=n,this._loading=new w.a(""),this._poll=new w.a(!1),this._active_item=new w.a(""),this._event_list=new w.a([]),this._options=new w.a({date:(new Date).valueOf()}),this.loading=this._loading.asObservable(),this.events=this._event_list.asObservable(),this.options=this._options.asObservable(),this.calendars=this._calendars.calendar_list,this.active_item=this._active_item.pipe(Object(V.a)(500),Object(k.a)(e=>e?Object(O.f)(e,{calendar:this._options.getValue().calendar||Object(r.h)().email}):Object(x.a)("No ID")),Object(W.a)(e=>this._active_item.getValue()?Object(_.j)(this._active_item.getValue()):Object(M.a)(null)),Object(W.a)(e=>Object(M.a)(null)),Object(l.a)(e=>(this._item=e,e)),Object(E.a)()),this.filtered_events=Object(v.b)([this._options,this._event_list]).pipe(Object(l.a)(([e,t])=>t.filter(t=>e.calendar&&t instanceof O.a||(!e.calendar||"desks"===e.calendar)&&t instanceof _.a))),this.subscription("event_list",Object(v.b)([this._options,this._poll]).pipe(Object(V.a)(1e3),Object(k.a)(([e])=>{this._loading.next(" ");const t=Object(b.a)(e.date).valueOf();let n=function(e){return Object(y.a)(1,arguments),Object(f.a)(e,Date.now())}(t)?6:4;const i=Object(h.a)(Object(d.a)(t,n)).valueOf();return Promise.all([Object(O.c)({period_start:Math.floor(t/1e3),period_end:Math.floor(i/1e3),calendars:e.calendar}).toPromise(),Object(_.g)({period_start:Math.floor(t/1e3),period_end:Math.floor(i/1e3),type:"desk"})])}),Object(l.a)(([e,t])=>e.concat(t)),Object(W.a)(e=>[])).subscribe(e=>{const t=Object(b.a)(this._options.getValue().date).valueOf(),n=Object(h.a)(Object(d.a)(t,6)).valueOf();let i=this._event_list.getValue().filter(i=>!Object(r.w)(t,n,i.date,i.date+60*i.duration*1e3)&&!e.find(e=>e.id===i.id));i=i.concat(e),i.sort((e,t)=>e.date-t.date),this._event_list.next(i),this._loading.next("")}))}get date(){return this._options.getValue().date}setOptions(e){this._options.next(Object.assign(Object.assign({},this._options.getValue()),e))}setItem(e){this._active_item.next(e)}startPolling(e=15e3){this._poll.next(!this._poll.getValue()),this.interval("poll",()=>this._poll.next(!this._poll.getValue()),e)}stopPolling(){this.clearInterval("poll")}duplicateEvent(){if(sessionStorage){const e=new O.a(Object.assign(Object.assign({},this._item),{id:""}));sessionStorage.setItem("STAFF.booking_form",JSON.stringify(e))}this._router.navigate(["/book"])}deleteEvent(){return Object(p.a)(this,void 0,void 0,(function*(){if(!this._item)return;const e=yield Object(r.o)({title:"Cancel Meeting",content:"Are you sure you want to cancel this meeting: "+this._item.title,icon:{content:"delete"}},this._dialog);if(!e)return;const t=this._item instanceof O.a;e.loading(`Cancelling ${t?"meeting":"desk booking"}...`);const n=t?Object(O.d)(this._item.id).toPromise():Object(_.h)(this._item.id).toPromise(),i=yield n.catch(e=>e);if(e.close(),i)return Object(r.m)(`Error unable to cancel ${t?"meeting":"desk booking"}. Error: ${i.statusText||i.message||i}`);Object(r.n)(`Successfully cancelled ${t?"meeting":"desk booking"}.`),this._router.navigate(["/schedule","listing"],{queryParamsHandling:"preserve"})}))}}return e.\u0275fac=function(t){return new(t||e)(g.dc(j.a),g.dc(I.b),g.dc(a.d))},e.\u0275prov=g.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var C=n("29Wa"),P=n("R7+U"),R=n("mFH5"),Y=n("PBFl"),S=n("Jb3d"),Q=n("0/Ep"),A=n("Cd2c"),B=n("gcUQ"),F=n("D8Xy"),T=n("WPBw");function $(e,t){1&e&&(g.Wb(0,"app-icon"),g.Oc(1,"cancel"),g.Vb())}function q(e,t){1&e&&(g.Wb(0,"app-icon"),g.Oc(1,"forum"),g.Vb())}function H(e,t){1&e&&(g.Wb(0,"label"),g.Oc(1,"(Cancelled)"),g.Vb())}const K=function(){return{type:"icon",class:"material-icons",content:"place"}};function N(e,t){1&e&&g.Rb(0,"app-icon",10),2&e&&g.rc("icon",g.uc(1,K))}const L=function(e){return["/schedule","view",e]};let X=(()=>{class e{constructor(e){this._router=e}get isFuture(){return Object(F.a)(this.event.date,new Date)}get status(){return this.event.status}get is_done(){return Object(u.a)(Object(T.a)(this.event.date,this.event.duration),new Date)}get location(){return this.event&&"date"!==this.event.type&&"empty"!==this.event.type?this.event.location:"No location"}get type_image(){return this.event&&"date"!==this.event.type&&"empty"!==this.event.type?this.event instanceof O.a&&this.event.has_visitors?"external":"book_room":"block"}get time(){return this.event.all_day||this.event.duration>1380?"All Day":Object(m.a)(this.event.date,"h:mm a")}get query(){return{calendar:this.event.calendar,type:this.event.type}}}return e.\u0275fac=function(t){return new(t||e)(g.Qb(a.d))},e.\u0275cmp=g.Kb({type:e,selectors:[["schedule-event-item"]],inputs:{event:"event"},decls:15,vars:15,consts:[["matRipple","",1,"flex","mb-1",3,"routerLink","queryParams"],[1,"icon",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],[1,"flex","flex-col","h-20","flex-1","w-1/2","bg-white","p-2","justify-center"],[1,"text-lg","font-medium","capitalize","pl-1","truncate"],[1,"flex","items-center"],[3,"icon",4,"ngIf"],[1,"truncate","pl-1"],[3,"icon"]],template:function(e,t){1&e&&(g.Wb(0,"a",0),g.Wb(1,"div"),g.Wb(2,"div",1),g.Mc(3,$,2,0,"app-icon",2),g.Mc(4,q,2,0,"app-icon",3),g.Vb(),g.Wb(5,"div"),g.Oc(6),g.Vb(),g.Mc(7,H,2,0,"label",4),g.Vb(),g.Wb(8,"div",5),g.Wb(9,"div",6),g.Oc(10),g.Vb(),g.Wb(11,"div",7),g.Mc(12,N,1,2,"app-icon",8),g.Wb(13,"div",9),g.Oc(14),g.Vb(),g.Vb(),g.Vb(),g.Vb()),2&e&&(g.rc("routerLink",g.vc(13,L,t.event.id))("queryParams",t.query),g.Eb(1),g.Gb("h-20 w-20 flex flex-col items-center justify-center "+t.status),g.Ib("done",t.is_done),g.Eb(1),g.rc("ngSwitch",t.event.status),g.Eb(1),g.rc("ngSwitchCase","cancelled"),g.Eb(3),g.Pc(t.time),g.Eb(1),g.rc("ngIf","cancelled"===t.event.status),g.Eb(3),g.Qc(" ",t.event.title," "),g.Eb(2),g.rc("ngIf",!!t.location),g.Eb(2),g.Pc(t.location||"No location"))},directives:[a.f,R.o,c.q,c.r,c.s,c.o,Q.a],styles:[".confirmed[_ngcontent-%COMP%], .approved[_ngcontent-%COMP%] {\n                background: #388e3c;\n                color: #fff;\n            }\n\n            .tentative[_ngcontent-%COMP%] {\n                background: #ffa000;\n                color: #000;\n            }\n\n            .declined[_ngcontent-%COMP%], .cancelled[_ngcontent-%COMP%] {\n                background: #d32f2f;\n                color: #fff;\n            }\n\n            .done[_ngcontent-%COMP%] {\n                opacity: 0.35;\n            }"]}),e})();function J(e,t){if(1&e&&g.Rb(0,"schedule-event-item",5),2&e){const e=t.$implicit;g.sc("id",t.index),g.rc("event",e)}}function z(e,t){if(1&e&&(g.Ub(0),g.Mc(1,J,1,2,"schedule-event-item",4),g.Tb()),2&e){const e=g.kc();g.Eb(1),g.rc("ngForOf",e.events)}}function U(e,t){if(1&e&&(g.Wb(0,"div",6),g.Oc(1),g.lc(2,"date"),g.Vb()),2&e){const e=g.kc();g.Eb(1),g.Qc("No events for ",g.mc(2,1,e.date),"")}}let G=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=g.Kb({type:e,selectors:[["schedule-event-date-list"]],inputs:{date:"date",events:"events"},decls:7,vars:6,consts:[[1,"text-xl","mb-4"],[4,"ngIf","ngIfElse"],["empty_state",""],[1,"mb-4"],[3,"id","event",4,"ngFor","ngForOf"],[3,"id","event"],[1,"p-8"]],template:function(e,t){if(1&e&&(g.Wb(0,"div",0),g.Oc(1),g.lc(2,"date"),g.Vb(),g.Mc(3,z,2,1,"ng-container",1),g.Mc(4,U,3,3,"ng-template",null,2,g.Nc),g.Rb(6,"div",3)),2&e){const e=g.yc(5);g.Eb(1),g.Qc(" ",g.nc(2,3,t.date,"fullDate")," "),g.Eb(2),g.rc("ngIf",null==t.events?null:t.events.length)("ngIfElse",e)}},directives:[c.o,c.n,X],pipes:[c.f],styles:[""]}),e})();var Z=n("66mq");function ee(e,t){if(1&e&&(g.Wb(0,"mat-option",22),g.Oc(1),g.Vb()),2&e){const e=t.$implicit;g.rc("value",e.id),g.Eb(1),g.Qc(" ",e.summary," ")}}function te(e,t){if(1&e&&(g.Rb(0,"schedule-event-date-list",23),g.lc(1,"date")),2&e){const e=t.$implicit;g.rc("date",e.key)("events",e.value),g.Fb("date",g.nc(1,3,e.key,"yyyy-MM-dd"))}}function ne(e,t){1&e&&g.Rb(0,"mat-progress-bar",24)}const ie=function(){return{class:"material-icons",content:"event"}};let ce=(()=>{class e extends r.b{constructor(e,t){super(),this._state=e,this._el=t,this.loading=this._state.loading,this.options=this._state.options,this.calendars=this._state.calendars,this.events=Object(v.b)([this._state.filtered_events,this._state.options]).pipe(Object(l.a)(([e,t])=>{let n=Object(b.a)(new Date);const i=Object(d.a)(t.date||n,12),c={};let s=0;for(;s<e.length||Object(u.a)(n,i);){const t=Object(h.a)(n),i=e.filter(e=>Object(r.w)(n.valueOf(),t.valueOf(),e.date,e.date+60*e.duration*1e3));s+=i.length,c[n.valueOf()]=i,n=Object(d.a)(n,1)}return c})),this.min_date=Object(b.a)(new Date),this.setDate=e=>this._state.setOptions({date:e}),this.setCalendar=e=>this._state.setOptions({calendar:e})}ngOnInit(){this._state.startPolling()}ngOnDestroy(){super.ngOnDestroy(),this._state.stopPolling()}onScroll(e){var t;const n=Array.prototype.slice.call((null===(t=this._el)||void 0===t?void 0:t.nativeElement.querySelectorAll("schedule-event-date-list"))||[]);if(!(null==n?void 0:n.length))return;const i=e.target.scrollTop;let c=null;for(const a of n)if(a.offsetTop-i>0){c=a;break}if(!c)return;const s=new Date(c.getAttribute("date"));Object(f.a)(s,this._state.date)||this.setDate(s.valueOf())}scrollTo(e){this.timeout("scroll_to",()=>{var t;const n=null===(t=this._el)||void 0===t?void 0:t.nativeElement.querySelector(`[date="${Object(m.a)(e,"yyyy-MM-dd")}"]`);n&&n.scrollIntoView({behavior:"smooth",inline:"center"})},1e3)}}return e.\u0275fac=function(t){return new(t||e)(g.Qb(D),g.Qb(g.m))},e.\u0275cmp=g.Kb({type:e,selectors:[["schedule-event-list"]],features:[g.Bb],decls:37,vars:23,consts:[[1,"flex","p-2","items-center","bg-white","border-b","border-gray-200","shadow","space-x-2"],["appearance","outline",1,"h-12"],["name","calendars",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","desks"],[1,"flex-1","w-0"],["mat-button","",1,"clear",3,"matMenuTriggerFor"],["legend","matMenu"],[1,"flex","items-center","px-4","py-2","hover:bg-gray-100"],[1,"bg-success","h-2","w-2","rounded-full","mr-4"],[1,"bg-pending","h-2","w-2","rounded-full","mr-4"],[1,"bg-error","h-2","w-2","rounded-full","mr-4"],["mat-icon-button","",1,"relative"],["dateMenu",""],[3,"icon"],["matInput","",1,"opacity-0","absolute","inset-0",3,"ngModel","matDatepicker","min","ngModelChange"],["matSuffix","",1,"opacity-0","absolute","inset-0",3,"for"],["picker",""],[1,"w-full","flex-1","h-1/2","flex","flex-col"],[1,"flex-1","w-full","h-1/2","overflow-auto","p-4",3,"scroll"],[3,"date","events",4,"ngFor","ngForOf"],["mode","indeterminate",4,"ngIf"],[3,"value"],[3,"date","events"],["mode","indeterminate"]],template:function(e,t){if(1&e&&(g.Wb(0,"div",0),g.Wb(1,"mat-form-field",1),g.Wb(2,"mat-select",2),g.gc("ngModelChange",(function(e){return t.setCalendar(e)})),g.lc(3,"async"),g.Mc(4,ee,2,2,"mat-option",3),g.lc(5,"async"),g.Wb(6,"mat-option",4),g.Oc(7,"Desks"),g.Vb(),g.Vb(),g.Vb(),g.Rb(8,"div",5),g.Wb(9,"button",6),g.Oc(10," Legend "),g.Vb(),g.Wb(11,"mat-menu",null,7),g.Wb(13,"div",8),g.Rb(14,"div",9),g.Oc(15," Approved "),g.Vb(),g.Wb(16,"div",8),g.Rb(17,"div",10),g.Oc(18," Tentative "),g.Vb(),g.Wb(19,"div",8),g.Rb(20,"div",11),g.Oc(21," Declined "),g.Vb(),g.Vb(),g.Wb(22,"button",12,13),g.Rb(24,"app-icon",14),g.Wb(25,"input",15),g.gc("ngModelChange",(function(e){return t.setDate(e),t.scrollTo(e)})),g.lc(26,"async"),g.Vb(),g.Rb(27,"mat-datepicker-toggle",16),g.Vb(),g.Rb(28,"mat-datepicker",null,17),g.Vb(),g.Wb(30,"main",18),g.Wb(31,"div",19),g.gc("scroll",(function(e){return t.onScroll(e)})),g.Mc(32,te,2,6,"schedule-event-date-list",20),g.lc(33,"keyvalue"),g.lc(34,"async"),g.Vb(),g.Mc(35,ne,1,0,"mat-progress-bar",21),g.lc(36,"async"),g.Vb()),2&e){const e=g.yc(12),n=g.yc(29);let i=null;g.Eb(2),g.rc("ngModel",g.mc(3,10,t.options).calendar),g.Eb(2),g.rc("ngForOf",g.mc(5,12,t.calendars)),g.Eb(5),g.rc("matMenuTriggerFor",e),g.Eb(15),g.rc("icon",g.uc(22,ie)),g.Eb(1),g.rc("ngModel",null==(i=g.mc(26,14,t.options))?null:i.date)("matDatepicker",n)("min",t.min_date),g.Eb(2),g.rc("for",n),g.Eb(5),g.rc("ngForOf",g.mc(33,16,g.mc(34,18,t.events))),g.Eb(3),g.rc("ngIf",g.mc(36,20,t.loading))}},directives:[C.c,P.a,s.l,s.o,c.n,R.l,Y.b,S.d,S.a,Q.a,A.b,s.c,B.b,B.d,C.g,B.a,c.o,G,Z.a],pipes:[c.b,c.h,c.f],styles:["[_nghost-%COMP%] {\n                display: flex;\n                flex-direction: column;\n                width: 100%;\n                height: 50%;\n                flex: 1;\n            }\n\n            main[_ngcontent-%COMP%] {\n                background: #f0f0f0;\n            }"]}),e})();var se=n("e81E"),ae=n("C9Ki"),oe=n("d4mj");let le=(()=>{class e{constructor(){this.show_menu=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=g.Kb({type:e,selectors:[["app-schedule"]],decls:4,vars:2,consts:[[3,"menu","menuChange"],[1,"w-full"],[3,"show","showChange"]],template:function(e,t){1&e&&(g.Wb(0,"a-topbar-header",0),g.gc("menuChange",(function(e){return t.show_menu=e})),g.Vb(),g.Rb(1,"router-outlet"),g.Rb(2,"a-footer-menu",1),g.Wb(3,"a-overlay-menu",2),g.gc("showChange",(function(e){return t.show_menu=e})),g.Vb()),2&e&&(g.rc("menu",t.show_menu),g.Eb(3),g.rc("show",t.show_menu))},directives:[se.a,a.h,ae.a,oe.a],styles:["[_nghost-%COMP%] {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n            }"]}),e})();var re=n("jOdJ"),be=n("6CBO"),de=n("BQ33"),ue=n("Wc1D");function he(e,t){if(1&e){const e=g.Xb();g.Wb(0,"button",10),g.gc("click",(function(){return g.Bc(e),g.kc().locate()})),g.Oc(1," View "),g.Vb()}}let fe=(()=>{class e extends r.b{constructor(e,t){super(),this._state=e,this._dialog=t,this.event=this._state.active_item,this.when=this.event.pipe(Object(l.a)(e=>{if(!e)return"Unable to determine.";const t=de(e.date),n=t.add(e.duration||60,"m");return e.all_day||e.duration>1380?t.format("DD MMM YYYY")+" - All Day":t.isSame(n,"d")?`${t.format("DD MMM YYYY, h:mm A")} - ${n.format("h:mm A")}`:`${t.format("DD MMM YYYY, h:mm A")} - ${n.format("DD MMM YYYY, h:mm A")}`})),this.deleteEvent=()=>this._state.deleteEvent()}locate(){return Object(p.a)(this,void 0,void 0,(function*(){const e=yield this.event.toPromise(),t=new be.b({name:"Desk Booking",map_id:e.asset_id,zones:e.zones});this._dialog.open(ue.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{space:t}})}))}}return e.\u0275fac=function(t){return new(t||e)(g.Qb(D),g.Qb(I.b))},e.\u0275cmp=g.Kb({type:e,selectors:[["schedule-booking-details"]],features:[g.Bb],decls:33,vars:15,consts:[[1,"flex","flex-col","items-center","mb-4"],[1,"text-xl","capitalize","mb-2","font-medium"],[1,"rounded","py-4","bg-white","border-gray-300","shadow","space-y-4","w-full","text-lg"],[1,"flex","items-center","space-x-2","px-3"],[1,"text-2xl"],[1,"flex-1"],[1,"ml-12"],[1,"flex","items-center","space-x-2","px-4"],["class","w-24","mat-button","",3,"click",4,"ngIf"],["mat-button","",1,"error","w-24",3,"click"],["mat-button","",1,"w-24",3,"click"]],template:function(e,t){if(1&e&&(g.Wb(0,"div"),g.Wb(1,"div",0),g.Wb(2,"div",1),g.Oc(3),g.lc(4,"async"),g.Vb(),g.Vb(),g.Wb(5,"div",2),g.Wb(6,"div",3),g.Wb(7,"app-icon",4),g.Oc(8,"perm_identity"),g.Vb(),g.Wb(9,"div",5),g.Oc(10),g.lc(11,"async"),g.Vb(),g.Vb(),g.Rb(12,"hr",6),g.Wb(13,"div",3),g.Wb(14,"app-icon",4),g.Oc(15,"schedule"),g.Vb(),g.Wb(16,"div",5),g.Oc(17),g.lc(18,"async"),g.Vb(),g.Vb(),g.Rb(19,"hr",6),g.Wb(20,"div",3),g.Wb(21,"app-icon",4),g.Oc(22,"place"),g.Vb(),g.Wb(23,"div",5),g.Oc(24),g.lc(25,"async"),g.Vb(),g.Vb(),g.Rb(26,"hr",6),g.Wb(27,"div",7),g.Mc(28,he,2,0,"button",8),g.lc(29,"async"),g.Rb(30,"div",5),g.Wb(31,"button",9),g.gc("click",(function(){return t.deleteEvent()})),g.Oc(32," Delete "),g.Vb(),g.Vb(),g.Vb(),g.Vb()),2&e){let e=null,n=null,i=null,c=null;g.Eb(3),g.Qc(" ",(null==(e=g.mc(4,5,t.event))?null:e.title)||"No Title"," "),g.Eb(7),g.Pc(null==(n=g.mc(11,7,t.event))?null:n.user_name),g.Eb(7),g.Pc(g.mc(18,9,t.when)),g.Eb(7),g.Pc(null==(i=g.mc(25,11,t.event))?null:i.description),g.Eb(4),g.rc("ngIf",null==(c=g.mc(29,13,t.event))?null:c.asset_id)}},directives:[Q.a,c.o,Y.b],pipes:[c.b],styles:["[_nghost-%COMP%]    > div[_ngcontent-%COMP%] {\n                margin: auto;\n                width: 640px;\n                max-width: 100vw;\n                padding: 1rem;\n            }"]}),e})();var me=n("QHQ3"),ve=n("PQKe"),ge=n("Pqvn"),pe=n("2QvJ"),_e=n("RlfO");function Oe(e,t){if(1&e){const e=g.Xb();g.Wb(0,"form",1),g.gc("ngSubmit",(function(){return g.Bc(e),g.kc().save()})),g.Rb(1,"booking-edit",2),g.Wb(2,"div",3),g.Wb(3,"button",4),g.gc("click",(function(){return g.Bc(e),g.kc().cancel()})),g.Oc(4," Cancel "),g.Vb(),g.Wb(5,"button",5),g.Oc(6,"Save"),g.Vb(),g.Vb(),g.Vb()}if(2&e){const e=g.kc();g.rc("formGroup",e.form),g.Eb(1),g.rc("form",e.form)("event",e.event)}}let ye=(()=>{class e extends r.b{constructor(e){super(),this._dialog=e,this.change=new g.p,this.loading=new g.p}ngOnInit(){this.event&&(this.form=Object(O.b)(this.event))}ngOnChanges(e){e.event&&this.event&&(this.form=Object(O.b)(this.event))}cancel(){this.change.emit({type:"cancel_edit"})}save(){if(this.form.markAllAsTouched(),this.form.valid){const e=this._dialog.open(pe.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{booking:this.event}});e.componentInstance.event.subscribe(t=>{"success"===t.reason&&(this.change.emit({type:"view"}),e.close())})}else console.warn("Some form fields are invalid:",this.form)}handleEvent(e){}}return e.\u0275fac=function(t){return new(t||e)(g.Qb(I.b))},e.\u0275cmp=g.Kb({type:e,selectors:[["schedule-event-edit"]],inputs:{event:"event"},outputs:{change:"change",loading:"loading"},features:[g.Bb,g.Cb],decls:1,vars:1,consts:[["class","grid m-auto mt-8",3,"formGroup","ngSubmit",4,"ngIf"],[1,"grid","m-auto","mt-8",3,"formGroup","ngSubmit"],[3,"form","event"],[1,"footer","flex","items-center","justify-center","w-full","p-2","space-x-2"],["mat-button","","type","button",1,"inverse",3,"click"],["mat-button","","type","submit"]],template:function(e,t){1&e&&g.Mc(0,Oe,7,3,"form",0),2&e&&g.rc("ngIf",t.form&&t.event)},directives:[c.o,s.r,s.m,s.g,_e.a,Y.b],styles:["form[_ngcontent-%COMP%] {\n                grid-template-columns: max-content;\n                grid-template-rows: 1fr auto;\n                grid-template-areas:\n                    'edit'\n                    'actions';\n                max-width: 600px;\n            }\n\n            booking-edit[_ngcontent-%COMP%], schedule-event-view[_ngcontent-%COMP%] {\n                grid-area: edit;\n            }\n\n            .footer[_ngcontent-%COMP%] {\n                grid-area: actions;\n            }"]}),e})();function we(e,t){if(1&e){const e=g.Xb();g.Wb(0,"button",21),g.gc("click",(function(){g.Bc(e);const t=g.kc().$implicit;return g.kc(4).showSpace(t)})),g.Oc(1," View "),g.Vb()}}function xe(e,t){if(1&e&&(g.Wb(0,"div",18),g.Wb(1,"label",19),g.Oc(2),g.Vb(),g.Mc(3,we,2,0,"button",20),g.Vb()),2&e){const e=t.$implicit;g.Eb(2),g.Pc((null==e?null:e.name)||"No location"),g.Eb(1),g.rc("ngIf",null==e?null:e.map_id)}}function Me(e,t){if(1&e&&(g.Wb(0,"div",16),g.Mc(1,xe,4,2,"div",17),g.Vb()),2&e){const e=g.kc(3);g.Eb(1),g.rc("ngForOf",e.spaces)}}function Ve(e,t){if(1&e&&(g.Wb(0,"div",5),g.Wb(1,"app-icon",6),g.Oc(2,"place"),g.Vb(),g.Mc(3,Me,2,1,"div",15),g.Vb()),2&e){const e=g.kc(2);g.Eb(3),g.rc("ngIf","event"===e.event.type)}}function ke(e,t){1&e&&g.Rb(0,"hr",8)}function We(e,t){if(1&e){const e=g.Xb();g.Wb(0,"button",21),g.gc("click",(function(){return g.Bc(e),g.kc(3).showAttendees()})),g.Oc(1," View "),g.Vb()}}function Ee(e,t){if(1&e&&(g.Wb(0,"div",5),g.Wb(1,"app-icon",6),g.Oc(2,"people_outline"),g.Vb(),g.Wb(3,"div",22),g.Wb(4,"p",19),g.Oc(5),g.Vb(),g.Mc(6,We,2,0,"button",20),g.Vb(),g.Vb()),2&e){const e=g.kc(2);g.Eb(5),g.Qc(" ",e.attendees.length," Attendees "),g.Eb(1),g.rc("ngIf",e.attendees.length>0)}}function je(e,t){1&e&&g.Rb(0,"hr",8)}function Ie(e,t){if(1&e&&(g.Wb(0,"div",5),g.Wb(1,"app-icon",6),g.Oc(2,"screen_share"),g.Vb(),g.Wb(3,"div",7),g.Wb(4,"a",23),g.Oc(5),g.Vb(),g.Vb(),g.Vb()),2&e){const e=g.kc(2);g.Eb(4),g.sc("href",e.link,g.Dc),g.Eb(1),g.Pc(e.link)}}function De(e,t){1&e&&g.Rb(0,"hr",8)}function Ce(e,t){if(1&e){const e=g.Xb();g.Wb(0,"div",24),g.Wb(1,"app-icon",6),g.Oc(2,"people_outline"),g.Vb(),g.Wb(3,"div",22),g.Wb(4,"p",19),g.Oc(5,"Catered"),g.Vb(),g.Wb(6,"button",21),g.gc("click",(function(){return g.Bc(e),g.kc(2).showCatering()})),g.Oc(7," View "),g.Vb(),g.Vb(),g.Vb()}}function Pe(e,t){1&e&&g.Rb(0,"hr",8)}function Re(e,t){if(1&e&&(g.Wb(0,"div",24),g.Wb(1,"app-icon",6),g.Oc(2,"subject"),g.Vb(),g.Rb(3,"div",25),g.Vb()),2&e){const e=g.kc(2);g.Eb(3),g.rc("innerHTML",e.body,g.Cc)}}function Ye(e,t){1&e&&g.Rb(0,"hr",8)}function Se(e,t){if(1&e){const e=g.Xb();g.Wb(0,"div"),g.Wb(1,"div",2),g.Wb(2,"div",3),g.Oc(3),g.Vb(),g.Vb(),g.Wb(4,"div",4),g.Wb(5,"div",5),g.Wb(6,"app-icon",6),g.Oc(7,"perm_identity"),g.Vb(),g.Wb(8,"div",7),g.Oc(9),g.Vb(),g.Vb(),g.Rb(10,"hr",8),g.Wb(11,"div",5),g.Wb(12,"app-icon",6),g.Oc(13,"schedule"),g.Vb(),g.Wb(14,"div",7),g.Oc(15),g.Vb(),g.Vb(),g.Rb(16,"hr",8),g.Mc(17,Ve,4,1,"div",9),g.Mc(18,ke,1,0,"hr",10),g.Mc(19,Ee,7,2,"div",9),g.Mc(20,je,1,0,"hr",10),g.Mc(21,Ie,6,2,"div",9),g.Mc(22,De,1,0,"hr",10),g.Mc(23,Ce,8,0,"div",11),g.Mc(24,Pe,1,0,"hr",10),g.Mc(25,Re,4,1,"div",11),g.Mc(26,Ye,1,0,"hr",10),g.Wb(27,"div",12),g.Wb(28,"button",13),g.gc("click",(function(){return g.Bc(e),g.kc().duplicateEvent()})),g.Oc(29," Duplicate "),g.Vb(),g.Wb(30,"button",14),g.gc("click",(function(){return g.Bc(e),g.kc().deleteEvent()})),g.Oc(31," Delete "),g.Vb(),g.Vb(),g.Vb(),g.Vb()}if(2&e){const e=g.kc();g.Eb(3),g.Qc(" ",(null==e.event?null:e.event.title)||"No Title"," "),g.Eb(6),g.Pc(null==e.event||null==e.event.organiser?null:e.event.organiser.name),g.Eb(6),g.Pc(e.when),g.Eb(2),g.rc("ngIf",e.spaces&&e.spaces.length),g.Eb(1),g.rc("ngIf",e.spaces&&e.spaces.length),g.Eb(1),g.rc("ngIf",null==e.attendees?null:e.attendees.length),g.Eb(1),g.rc("ngIf",null==e.attendees?null:e.attendees.length),g.Eb(1),g.rc("ngIf",e.link),g.Eb(1),g.rc("ngIf",e.link),g.Eb(1),g.rc("ngIf",null==e.catering_items?null:e.catering_items.length),g.Eb(1),g.rc("ngIf",null==e.catering_items?null:e.catering_items.length),g.Eb(1),g.rc("ngIf",e.body),g.Eb(1),g.rc("ngIf",e.body)}}function Qe(e,t){if(1&e&&g.Rb(0,"schedule-event-edit",26),2&e){const e=g.kc();g.rc("event",e.event)}}let Ae=(()=>{class e extends r.b{constructor(e,t,n){super(),this._dialog=e,this._spaces=t,this._state=n,this.editing=!1,this.deleteEvent=()=>this._state.deleteEvent(),this.duplicateEvent=()=>this._state.duplicateEvent(),this.editEvent=()=>this.editing=!0}get organiser(){return this.event.creator||Object(r.h)().name}get when(){if(!this.event)return"Unable to determine.";const e=de(this.event.date),t=e.add(this.event.duration||60,"m");return this.event.all_day||this.event.duration>1380?e.format("DD MMM YYYY")+" - All Day":e.isSame(t,"d")?`${e.format("DD MMM YYYY, h:mm A")} - ${t.format("h:mm A")}`:`${e.format("DD MMM YYYY, h:mm A")} - ${t.format("DD MMM YYYY, h:mm A")}`}get duration(){return Object(me.a)({minutes:this.event.duration||60})}get catering_items(){var e;if(!(null===(e=this.event.catering)||void 0===e?void 0:e.length))return;const t=this.event.catering[0];return t?[...t.items]:[]}get catering_note(){return""}get spaces(){var e;return(null===(e=this.event.resources)||void 0===e?void 0:e.length)?this.event.resources.map(e=>this._spaces.find(e.email)):[]}get attendees(){var e;return(null===(e=this.event.attendees)||void 0===e?void 0:e.filter(e=>e.email!==this.event.creator))||[]}get link(){return this.event.meeting_link}get body(){return this.event.body}showCatering(){this._dialog.open(ge.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{catering:this.catering_items,catering_note:this.catering_note}})}showAttendees(){this._dialog.open(ve.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{attendees:this.attendees}})}showSpace(e){const t=this._spaces.find(e.id);this._dialog.open(ue.a,{width:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:t}})}}return e.\u0275fac=function(t){return new(t||e)(g.Qb(I.b),g.Qb(be.d),g.Qb(D))},e.\u0275cmp=g.Kb({type:e,selectors:[["schedule-event-details"]],inputs:{event:"event"},features:[g.Bb],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["edit_state",""],[1,"flex","flex-col","items-center","mb-4"],[1,"text-xl","capitalize","mb-2","font-medium"],[1,"rounded","py-4","bg-white","border-gray-300","shadow","space-y-4","w-full","text-lg"],[1,"flex","items-center","space-x-2","px-3"],[1,"text-2xl"],[1,"flex-1"],[1,"ml-12"],["class","flex items-center space-x-2 px-3",4,"ngIf"],["class","ml-12",4,"ngIf"],["class","flex space-x-2 px-3",4,"ngIf"],[1,"flex","items-center","space-x-2","px-4"],["mat-button","",1,"flex-1","inverse",3,"click"],["mat-button","",1,"flex-1","error",3,"click"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],["class","flex",4,"ngFor","ngForOf"],[1,"flex"],[1,"flex-1","w-1/2"],["mat-button","","class","clear underline",3,"click",4,"ngIf"],["mat-button","",1,"clear","underline",3,"click"],[1,"flex-1","flex","items-center"],["target","blank",1,"underline",3,"href"],[1,"flex","space-x-2","px-3"],[1,"flex","flex-col",3,"innerHTML"],[3,"event"]],template:function(e,t){if(1&e&&(g.Mc(0,Se,32,13,"div",0),g.Mc(1,Qe,1,1,"ng-template",null,1,g.Nc)),2&e){const e=g.yc(2);g.rc("ngIf",!t.editing)("ngIfElse",e)}},directives:[c.o,Q.a,Y.b,c.n,ye],styles:["[_nghost-%COMP%]    > div[_ngcontent-%COMP%] {\n                margin: auto;\n                width: 640px;\n                max-width: 100vw;\n                padding: 1rem;\n            }"]}),e})();var Be=n("csyo");function Fe(e,t){1&e&&g.Rb(0,"schedule-booking-details")}function Te(e,t){if(1&e&&(g.Rb(0,"schedule-event-details",10),g.lc(1,"async")),2&e){const e=g.kc(2);g.rc("event",g.mc(1,1,e.event))}}function $e(e,t){if(1&e&&(g.Wb(0,"div"),g.Ub(1,7),g.Mc(2,Fe,1,0,"schedule-booking-details",8),g.Mc(3,Te,2,3,"schedule-event-details",9),g.Tb(),g.Vb()),2&e){const e=g.kc();g.Eb(1),g.rc("ngSwitch",e.type),g.Eb(1),g.rc("ngSwitchCase","booking")}}function qe(e,t){if(1&e&&(g.Wb(0,"div",11),g.Rb(1,"mat-spinner",12),g.Wb(2,"p"),g.Oc(3),g.lc(4,"async"),g.Vb(),g.Vb()),2&e){const e=g.kc();g.Eb(1),g.rc("diameter",48),g.Eb(2),g.Pc(g.mc(4,2,e.loading)||"Loading event details...")}}const He=[{path:"",component:le,children:[{path:"listing",component:ce},{path:"view/:id",component:(()=>{class e extends r.b{constructor(e,t,n,i){super(),this._state=e,this._router=t,this._route=n,this._location=i,this.loading=this._state.loading,this.event=this._state.active_item,this.setOptions=e=>this._state.setOptions(e),this.setID=e=>this._state.setItem(e),this.type=""}ngOnInit(){this.subscription("route.params",Object(v.b)([this._route.paramMap,this._route.queryParamMap]).subscribe(([e,t])=>{e.has("id")&&this.setID(e.get("id")),t.has("type")&&(this.type=t.get("type")),t.has("calendar")&&this.setOptions({calendar:t.get("calendar")})})),this.timeout("check_event",()=>Object(p.a)(this,void 0,void 0,(function*(){return this._router.navigate(["/schedule","listing"],{queryParamsHandling:"preserve"})})),3e3),this._state.active_item.pipe(Object(re.a)(e=>!!e)).subscribe(()=>this.clearTimeout("check_event"))}back(){this._location.back()}}return e.\u0275fac=function(t){return new(t||e)(g.Qb(D),g.Qb(a.d),g.Qb(a.a),g.Qb(c.j))},e.\u0275cmp=g.Kb({type:e,selectors:[["schedule-view-event"]],features:[g.Bb],decls:12,vars:6,consts:[[1,"w-full","h-12","flex","items-center","bg-white","shadow","px-2"],["mat-button","",1,"clear",3,"click"],[1,"flex","items-center"],[1,"mr-2"],[1,"flex-1","h-1/2","w-full","overflow-auto"],[4,"ngIf","ngIfElse"],["load_state",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"event",4,"ngSwitchDefault"],[3,"event"],[1,"p-8","flex","flex-col","items-center","justify-center","h-full","w-full"],[1,"mb-4",3,"diameter"]],template:function(e,t){if(1&e&&(g.Wb(0,"div",0),g.Wb(1,"button",1),g.gc("click",(function(){return t.back()})),g.Wb(2,"div",2),g.Wb(3,"app-icon",3),g.Oc(4,"keyboard_backspace"),g.Vb(),g.Oc(5," Back "),g.Vb(),g.Vb(),g.Vb(),g.Wb(6,"main",4),g.Mc(7,$e,4,2,"div",5),g.lc(8,"async"),g.lc(9,"async"),g.Vb(),g.Mc(10,qe,5,4,"ng-template",null,6,g.Nc)),2&e){const e=g.yc(11);g.Eb(7),g.rc("ngIf",g.mc(8,2,t.event)&&!g.mc(9,4,t.loading))("ngIfElse",e)}},directives:[Y.b,Q.a,c.o,c.q,c.r,c.s,fe,Ae,Be.b],pipes:[c.b],styles:["[_nghost-%COMP%] {\n                display: flex;\n                flex-direction: column;\n                width: 100%;\n                height: 50%;\n                flex: 1;\n            }\n\n            main[_ngcontent-%COMP%] {\n                background: #f0f0f0;\n            }"]}),e})()},{path:"**",redirectTo:"listing"}]},{path:"**",redirectTo:""}];let Ke=(()=>{class e{}return e.\u0275mod=g.Ob({type:e}),e.\u0275inj=g.Nb({factory:function(t){return new(t||e)},imports:[[c.c,s.h,s.p,a.g.forChild(He),o.a,i.c]]}),e})()}}]);
//# sourceMappingURL=schedule-schedule-module.d8f0728464a854674225.js.map