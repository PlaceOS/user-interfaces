{"version":3,"sources":["./src/app/control/space-list/item/item.component.html","./src/app/control/space-list/item/item.component.ts","./src/app/control/space-list/space-list.component.html","./src/app/control/space-list/space-list.component.ts","./src/app/control/control.component.ts","./src/app/control/control.component.html","./src/app/control/control.module.ts"],"names":["ControlSpaceListItemComponent","_settings","_org","this","get","space","level","bld","buildings","find","building","id","parent_id","name","ControlSpaceListComponent","_spaces","super","space_list","initialised","pipe","first","_","subscribe","filter","support_url","sort","a","b","bld_a","space_a_name","toLowerCase","level_a_name","bld_a_name","bld_b","space_b_name","level_b_name","bld_b_name","localeCompare","search","search_str","space_name","level_name","bld_name","indexOf","ControlComponent","title","ROUTES","path","component","ControlModule","forChild"],"mappings":"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","file":"control-control-module.60b2a267f886a49b78be.js","sourcesContent":["<div class=\"space-details\" *ngIf=\"space\" [class.with-image]=\"show_image\">\n    <div class=\"details\">\n        <div\n            class=\"image\"\n            *ngIf=\"show_image && space.image\"\n            [style.background-image]=\"'url(' + space.image + ')'\"\n        ></div>\n        <div class=\"overlay\"></div>\n        <div class=\"name\">{{ space.name }}</div>\n        <div class=\"info\">\n            <div class=\"location\">{{ location }}</div>\n            <div class=\"capacity\">\n                <app-icon\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'account_circle' }\"\n                ></app-icon>\n                {{ space.capacity || '0' }}\n            </div>\n        </div>\n    </div>\n    <div class=\"actions\">\n        <a\n            mat-button\n            color=\"primary\"\n            button\n            [routerLink]=\"['/explore']\"\n            [queryParams]=\"{ space: space.id }\"\n        >\n            Find\n        </a>\n        <a mat-button color=\"primary\" button [href]=\"space.support_url | safe: 'url'\">\n            Control\n        </a>\n    </div>\n</div>\n","import { Component, Input } from '@angular/core';\n\nimport { SettingsService } from '@user-interfaces/common';\nimport { OrganisationService } from '@user-interfaces/organisation';\nimport { Space } from '@user-interfaces/spaces';\n\n\n@Component({\n    selector: 'a-control-space-list-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss']\n})\nexport class ControlSpaceListItemComponent {\n    /** Space to display */\n    @Input() public space: Space;\n\n    public get show_image() {\n        return this._settings.get('app.space_display.show_images');\n    }\n\n    /** Display location of the space */\n    public get location(): string {\n        if (!this.space) {\n            return 'Unable to determine location';\n        }\n        const level = this.space.level;\n        const bld = this._org.buildings.find(building => building.id === level.parent_id);\n        return `${bld ? bld.name + ', ' : ''}${level.name}`;\n    }\n\n    constructor(private _settings: SettingsService, private _org: OrganisationService) { }\n}\n","<div class=\"control-list\">\n    <div class=\"filter\">\n        <a-searchbar [(value)]=\"search_str\" [loading]=\"loading\" [autofocus]=\"true\"></a-searchbar>\n    </div>\n    <div class=\"list\" *ngIf=\"filtered_list.length; else empty_state\">\n        <div class=\"item\" *ngFor=\"let space of filtered_list\">\n            <a-control-space-list-item [space]=\"space\"></a-control-space-list-item>\n        </div>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"list\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <app-icon\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n                ></app-icon>\n            </div>\n            <div class=\"text\">\n                {{ search_str ? ' No matches for \"' + search_str + '\"' : 'No controllable spaces' }}\n            </div>\n        </div>\n    </div>\n</ng-template>\n","import { Component, OnInit } from '@angular/core';\nimport { first } from 'rxjs/operators';\n\nimport { BaseClass } from '@user-interfaces/common';\nimport { OrganisationService } from '@user-interfaces/organisation';\nimport { Space, SpacesService } from '@user-interfaces/spaces';\n\n@Component({\n    selector: 'a-control-space-list',\n    templateUrl: './space-list.component.html',\n    styleUrls: ['./space-list.component.scss']\n})\nexport class ControlSpaceListComponent extends BaseClass implements OnInit {\n    /** List of controllable spaces */\n    public space_list: Space[] = [];\n    /** Filter string */\n    public search_str: string;\n    /** Whether space list is being filtered */\n    public loading: boolean;\n\n    constructor(private _spaces: SpacesService, private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first(_ => _)).subscribe(() => {\n            this.space_list = this._spaces.filter(space => !!space.support_url);\n            this.space_list.sort((a, b) => {\n                const bld_a = this._org.buildings.find(\n                    building => building.id === a.level.parent_id\n                );\n                const space_a_name = (a.name || '').toLowerCase();\n                const level_a_name = ((a.level ? a.level.name : '') || '').toLowerCase();\n                const bld_a_name = ((bld_a ? bld_a.name : '') || '').toLowerCase();\n                const bld_b = this._org.buildings.find(\n                    building => building.id === b.level.parent_id\n                );\n                const space_b_name = (b.name || '').toLowerCase();\n                const level_b_name = ((b.level ? b.level.name : '') || '').toLowerCase();\n                const bld_b_name = ((bld_b ? bld_b.name : '') || '').toLowerCase();\n                return (\n                    bld_a_name.localeCompare(bld_b_name) ||\n                    level_a_name.localeCompare(level_b_name) ||\n                    space_a_name.localeCompare(space_b_name)\n                );\n            });\n        });\n    }\n\n    /** List of spaces filtered using the search string */\n    public get filtered_list(): Space[] {\n        const search = (this.search_str || '').toLowerCase();\n        return (this.space_list || []).filter(space => {\n            const bld = this._org.buildings.find(\n                building => building.id === space.level.parent_id\n            );\n            const space_name = (space.name || '').toLowerCase();\n            const level_name = ((space.level ? space.level.name : '') || '').toLowerCase();\n            const bld_name = ((bld ? bld.name : '') || '').toLowerCase();\n            return (\n                space_name.indexOf(search) >= 0 ||\n                (level_name && level_name.indexOf(search) >= 0) ||\n                (bld_name && bld_name.indexOf(search) >= 0)\n            );\n        });\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { BaseClass, SettingsService } from '@user-interfaces/common';\n\n@Component({\n    selector: 'app-control',\n    templateUrl: './control.component.html',\n    styleUrls: ['./control.component.scss']\n})\nexport class ControlComponent extends BaseClass implements OnInit {\n    /** Whether to show the overlay menu */\n    public show_menu: boolean;\n\n    constructor(private _settings: SettingsService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._settings.title = 'Control';\n    }\n}\n","<div class=\"control page\">\n    <header class=\"header\">\n        <a-topbar-header [(menu)]=\"show_menu\"></a-topbar-header>\n    </header>\n    <main class=\"body\">\n        <a-control-space-list></a-control-space-list>\n    </main>\n    <footer class=\"footer\">\n        <a-footer-menu></a-footer-menu>\n    </footer>\n</div>\n<a-overlay-menu [(show)]=\"show_menu\"></a-overlay-menu>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { ControlComponent } from './control.component';\nimport { SharedContentModule } from '../ui/shared.module';\nimport { ControlSpaceListComponent } from './space-list/space-list.component';\nimport { ControlSpaceListItemComponent } from './space-list/item/item.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: ControlComponent }\n];\n\n@NgModule({\n    declarations: [ControlComponent, ControlSpaceListComponent, ControlSpaceListItemComponent],\n    imports: [\n        CommonModule,\n        RouterModule.forChild(ROUTES),\n        SharedContentModule\n    ]\n})\nexport class ControlModule {}\n"],"sourceRoot":"webpack:///"}