"use strict";(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([[806],{6806:(ee,v,i)=>{i.r(v),i.d(v,{DayViewModule:()=>H});var r=i(2057),p=i(4751),m=i(2636),C=i(2656),Z=i(7592),T=i(3702),e=i(4788),k=i(4945),_=i(4762),x=i(8049),h=i(7331),O=i(8539),c=i(8736),W=i(2895),V=i(5306),M=i(6833),A=i(1260),b=i(3624),P=i(1293),f=i(7935);function U(n,s){if(1&n&&(e.TgZ(0,"mat-option",11),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}let J=(()=>{class n extends h.KG{constructor(t,o,l,a){super(),this._state=t,this._org=o,this._route=l,this._router=a,this.zones=[],this.levels=this._org.active_levels,this.options=this._state.options,this.setDate=d=>this._state.setDate(d),this.setWeekends=d=>this._state.setUIOptions({show_weekends:d}),this.newBooking=d=>this._state.newBooking(d),this.updateZones=d=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:d.join(",")}}),this._state.setZones(d)}}ngOnInit(){return(0,_.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,x.P)(t=>t)).toPromise(),this.subscription("route.query",this._route.queryParamMap.subscribe(t=>{if(t.has("zone_ids")){const o=t.get("zone_ids").split(",");if(o.length){const l=this._org.levelWithID(o);if(this.zones=o,!l)return;this._org.building=this._org.buildings.find(a=>a.id===l.parent_id)}}})),this.subscription("levels",this._org.active_levels.subscribe(t=>{this.zones=this.zones.filter(o=>t.find(l=>l.id===o)),!this.zones.length&&t.length&&this.zones.push(t[0].id),this.updateZones(this.zones)}))})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.Y),e.Y36(O.w7),e.Y36(m.gz),e.Y36(m.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["week-view-topbar"]],features:[e.qOj],decls:16,vars:7,consts:[["mat-button","","new","",1,"w-12","xl:w-auto",3,"click"],[1,"flex","items-center"],[1,"mr-2"],[1,"hidden","xl:block"],["appearance","outline"],["multiple","","placeholder","All Levels",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"m-2",3,"ngModel","ngModelChange"],[1,"text-xs"],[1,"flex-1","w-0"],[3,"dateChange"],[3,"value"]],template:function(t,o){if(1&t&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return o.newBooking()}),e.TgZ(1,"div",1),e.TgZ(2,"app-icon",2),e._uU(3,"add"),e.qZA(),e.TgZ(4,"div",3),e._uU(5,"New Booking"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"mat-form-field",4),e.TgZ(7,"mat-select",5),e.NdJ("ngModelChange",function(a){return o.zones=a})("ngModelChange",function(a){return o.updateZones(a)}),e.YNc(8,U,2,2,"mat-option",6),e.ALo(9,"async"),e.qZA(),e.qZA(),e.TgZ(10,"mat-slide-toggle",7),e.NdJ("ngModelChange",function(a){return o.setWeekends(a)}),e.ALo(11,"async"),e.TgZ(12,"div",8),e._uU(13,"Show weekends"),e.qZA(),e.qZA(),e._UZ(14,"div",9),e.TgZ(15,"date-options",10),e.NdJ("dateChange",function(a){return o.setDate(a)}),e.qZA()),2&t){let l;e.xp6(7),e.Q6J("ngModel",o.zones),e.xp6(1),e.Q6J("ngForOf",e.lcZ(9,3,o.levels)),e.xp6(2),e.Q6J("ngModel",null==(l=e.lcZ(11,5,o.options))?null:l.show_weekends)}},directives:[W.lW,V.o,M.KE,A.gD,p.JJ,p.On,r.sg,b.Rr,P.E,f.ey],pipes:[r.Ov],styles:["[_nghost-%COMP%]{display:flex;align-items:center;background-color:#fff;height:5em;padding:0 1em}button[_ngcontent-%COMP%]{min-width:0;padding:0 .85rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em;margin-left:1em}"]}),n})();var u=i(3501),w=i(4840),D=i(2094),Y=i(6215),E=i(739),y=i(8002);i(7932);let F=(()=>{class n{constructor(t){this._state=t,this.view=o=>this._state.setEvent(o)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.Y))},n.\u0275cmp=e.Xpm({type:n,selectors:[["week-view-event"]],inputs:{event:"event"},decls:8,vars:9,consts:[["content","","matRipple","",3,"click"],[1,"text-base"],[1,"text-sm"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return o.view(o.event)}),e.TgZ(1,"div",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"div",2),e._uU(7),e.qZA(),e.qZA()),2&t&&(e.Tol("m-2 p-2 bg-white shadow rounded border-2 text-black text-left font-normal "+("done"===(null==o.event?null:o.event.state)?"done":null==o.event?null:o.event.type)),e.xp6(2),e.Oqu(null==o.event?null:o.event.title),e.xp6(2),e.Oqu(e.xi3(5,6,null==o.event?null:o.event.date,"shortTime")),e.xp6(3),e.AsE(" ",null==o.event?null:o.event.attendees.length," Attendee",1===(null==o.event?null:o.event.attendees.length)?"":"s"," "))},directives:[f.wG],pipes:[r.uU],styles:["button[_ngcontent-%COMP%]{background:none!important;border:none!important}[content][_ngcontent-%COMP%]{width:calc(100% - 1rem)}.done[_ngcontent-%COMP%]{opacity:.5}.done[_ngcontent-%COMP%]:hover{opacity:1}.cancelled[_ngcontent-%COMP%]{border-color:#626262}.external[_ngcontent-%COMP%]{border-color:#d85be0}.internal[_ngcontent-%COMP%]{border-color:#00a4c7}"]}),n})();function Q(n,s){1&n&&e._UZ(0,"week-view-event",5),2&n&&e.Q6J("event",s.$implicit)}function z(n,s){if(1&n&&(e.ynx(0),e.YNc(1,Q,1,1,"week-view-event",4),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.events))}}function N(n,s){1&n&&(e.TgZ(0,"p",6),e._uU(1,"No events"),e.qZA())}let I=(()=>{class n{constructor(t){this._state=t,this._index=new Y.X(0),this.date=this._state.date.pipe((0,y.U)(o=>(0,u.Z)((0,w.Z)(o),this.index).valueOf())),this.events=(0,E.aj)([this._state.filtered,this._state.date,this._index]).pipe((0,y.U)(([o,l,a])=>{const d=(0,u.Z)((0,w.Z)(l),a).valueOf(),q=(0,D.Z)(d).valueOf();return o.filter(g=>(0,h.MZ)(d,q,g.date,g.date+60*g.duration*1e3))}))}ngOnChanges(t){t.index&&this._index.next(this.index)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.Y))},n.\u0275cmp=e.Xpm({type:n,selectors:[["week-view-day"]],inputs:{index:"index"},features:[e.TTD],decls:9,vars:10,consts:[[1,"flex","items-center","justify-center","border-b","border-gray-200","bg-gray-500","w-full","py-3","text-white"],[1,"flex-1","h-1/2","overflow-auto","w-full"],[4,"ngIf","ngIfElse"],["empty_state",""],[3,"event",4,"ngFor","ngForOf"],[3,"event"],[1,"text-center","p-2"]],template:function(t,o){if(1&t&&(e.TgZ(0,"header",0),e._uU(1),e.ALo(2,"date"),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"div",1),e.YNc(5,z,3,3,"ng-container",2),e.ALo(6,"async"),e.qZA(),e.YNc(7,N,2,0,"ng-template",null,3,e.W1O)),2&t){const l=e.MAs(8);let a;e.xp6(1),e.hij(" ",e.xi3(2,3,e.lcZ(3,6,o.date),"EEE, MMM d, y")," "),e.xp6(4),e.Q6J("ngIf",null==(a=e.lcZ(6,8,o.events))?null:a.length)("ngIfElse",l)}},directives:[r.O5,r.sg,F],pipes:[r.uU,r.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%}"]}),n})();var L=i(3985),B=i(914);function j(n,s){if(1&n&&(e.ynx(0),e._UZ(1,"week-view-day",5),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("index",t)}}function X(n,s){if(1&n&&(e.ynx(0),e.YNc(1,j,2,1,"ng-container",4),e.ALo(2,"async"),e.BQk()),2&n){const t=s.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",0!==t&&6!==t||e.lcZ(2,1,o.options).show_weekends)}}function R(n,s){1&n&&e._UZ(0,"mat-progress-bar",6)}function S(n,s){if(1&n&&(e._UZ(0,"view-event-details",7),e.ALo(1,"async")),2&n){const t=e.oxw();e.Q6J("event",e.lcZ(1,1,t.event))}}let $=(()=>{class n{constructor(t){this._state=t,this.weekdays=[0,1,2,3,4,5,6],this.options=this._state.options,this.event=this._state.event,this.loading=this._state.loading}ngOnInit(){this._state.startPolling("week")}ngOnDestroy(){this._state.stopPolling()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.Y))},n.\u0275cmp=e.Xpm({type:n,selectors:[["week-view-timeline"]],decls:6,vars:7,consts:[[1,"flex","divide-x","border-gray-400","h-full"],[4,"ngFor","ngForOf"],["mode","indeterminate",4,"ngIf"],[3,"event",4,"ngIf"],[4,"ngIf"],[1,"h-full","flex-1",3,"index"],["mode","indeterminate"],[3,"event"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.YNc(1,X,3,3,"ng-container",1),e.qZA(),e.YNc(2,R,1,0,"mat-progress-bar",2),e.ALo(3,"async"),e.YNc(4,S,2,3,"view-event-details",3),e.ALo(5,"async")),2&t&&(e.xp6(1),e.Q6J("ngForOf",o.weekdays),e.xp6(1),e.Q6J("ngIf",e.lcZ(3,3,o.loading)),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,5,o.event)))},directives:[r.sg,r.O5,I,L.pW,B.E],pipes:[r.Ov],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%;overflow:hidden}"]}),n})();const G=["app-weekview",""],K=[{path:"",component:(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["","app-weekview",""]],attrs:G,decls:4,vars:0,consts:[[1,"relative","overflow-hidden"]],template:function(t,o){1&t&&(e._UZ(0,"sidebar"),e.TgZ(1,"main",0),e._UZ(2,"week-view-topbar"),e._UZ(3,"week-view-timeline"),e.qZA())},directives:[k.k,J,$],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%;background:var(--bg)}sidebar[_ngcontent-%COMP%]{height:100%}main[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-width:50%;height:100%}"]}),n})()}];let H=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[r.ez,p.u5,C.v,Z.YR,T.PP,m.Bz.forChild(K)]]}),n})()}}]);