{"version":3,"file":"apps_workplace_src_app_control_control_module_ts.js","mappings":"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","names":["i0","ctx_r0","show_image","space","name","location","capacity","support_url","_c0","_c1","id","ControlSpaceListItemComponent","this","_settings","get","level","bld","_org","buildings","find","building","parent_id","display_name","constructor","static","__ngFactoryType__","i1","i2","core","VBU","selectors","inputs","decls","vars","consts","template","rf","ctx","ControlSpaceListItemComponent_div_0_Template","ControlSpaceListComponent_div_6_a_control_space_list_item_1_Template","ctx_r2","filtered_list","search_str","ControlSpaceListComponent","AsyncHandler","_spaces","super","space_list","ngOnInit","_this","_asyncToGenerator","initialised","pipe","first","_","toPromise","filter","sort","a","b","sortSpaces","search","toLowerCase","space_name","level_name","bld_name","indexOf","second","bld_a","space_a_name","level_a_name","bld_a_name","bld_b","space_b_name","level_b_name","bld_b_name","localeCompare","features","$event","_r1","ControlSpaceListComponent_mat_spinner_5_Template","ControlSpaceListComponent_div_6_Template","ControlSpaceListComponent_ng_template_7_Template","loading","length","empty_state_r4","ControlComponent","title","attrs","ROUTES","path","component","ControlModule","$C","G2t","CommonModule","FormsModule","RouterModule","forChild","SharedComponentModule"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./apps/workplace/src/app/control/list-item.component.ts","./apps/workplace/src/app/control/space-list.component.ts","./apps/workplace/src/app/control/control.component.ts","./apps/workplace/src/app/control/control.module.ts"],"sourcesContent":["import { Component, Input } from '@angular/core';\n\nimport { SettingsService } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { Space } from '@placeos/spaces';\n\n@Component({\n    selector: 'a-control-space-list-item',\n    template: `\n        <div\n            class=\"flex flex-wrap items-center sm:space-x-4 bg-base-100 hover:bg-base-200 overflow-hidden p-2 pl-4 mb-2\"\n            *ngIf=\"space\"\n            [class.with-image]=\"show_image\"\n        >\n            <div class=\"flex flex-col flex-1\">\n                <div class=\"text-xl\">{{ space.name }}</div>\n                <div class=\"flex items-center w-full text-sm\">\n                    <div class=\"flex-1\">{{ location }}</div>\n                    <div class=\"flex items-center text-lg\">\n                        <app-icon>account_circle</app-icon>\n                        {{ space.capacity || '0' }}\n                    </div>\n                </div>\n            </div>\n            <div\n                class=\"flex w-full sm:w-auto sm:flex-col items-center space-x-2 sm:space-x-0 sm:space-y-2 mt-4 sm:mt-0\"\n            >\n                <a\n                    btn\n                    matRipple\n                    control\n                    class=\"w-32 flex-1 sm:flex-none\"\n                    [href]=\"space.support_url | safe: 'url'\"\n                >\n                    Control\n                </a>\n                <a\n                    btn\n                    matRipple\n                    locate\n                    class=\"w-32 flex-1 sm:flex-none inverse\"\n                    [routerLink]=\"['/explore']\"\n                    [queryParams]=\"{ space: space.id }\"\n                >\n                    Find\n                </a>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class ControlSpaceListItemComponent {\n    /** Space to display */\n    @Input() public space: Space;\n\n    public get show_image() {\n        return this._settings.get('app.spaces.show_images');\n    }\n\n    /** Display location of the space */\n    public get location(): string {\n        if (!this.space) {\n            return 'Unable to determine location';\n        }\n        const level = this.space.level;\n        const bld = this._org.buildings.find(\n            (building) => building.id === level.parent_id\n        );\n        return `${bld ? (bld.display_name || bld.name) + ', ' : ''}${\n            level?.display_name || level?.name || '<No Level>'\n        }`;\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _org: OrganisationService\n    ) {}\n}\n","import { Component, OnInit } from '@angular/core';\nimport { first } from 'rxjs/operators';\n\nimport { AsyncHandler } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { Space, SpacesService } from '@placeos/spaces';\n\n@Component({\n    selector: 'a-control-space-list',\n    template: `\n        <div class=\"w-full flex items-center justify-center p-2\">\n            <mat-form-field overlay class=\"rounded h-12\" appearance=\"outline\">\n                <app-icon class=\"text-xl\" matPrefix>search</app-icon>\n                <input\n                    matInput\n                    [(ngModel)]=\"search_str\"\n                    placeholder=\"Search...\"\n                />\n                <mat-spinner\n                    matSuffix\n                    class=\"top-2\"\n                    *ngIf=\"loading\"\n                    [diameter]=\"32\"\n                ></mat-spinner>\n            </mat-form-field>\n        </div>\n        <div\n            class=\"flex flex-col flex-1 overflow-auto w-full\"\n            *ngIf=\"filtered_list.length; else empty_state\"\n        >\n            <a-control-space-list-item\n                *ngFor=\"let space of filtered_list\"\n                [space]=\"space\"\n            ></a-control-space-list-item>\n        </div>\n        <ng-template #empty_state>\n            <div class=\"flex flex-col items-center p-8\">\n                <app-icon>close</app-icon>\n                <p>\n                    {{\n                        search_str\n                            ? ' No matches for \"' + search_str + '\"'\n                            : 'No controllable spaces'\n                    }}\n                </p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n            }\n\n            mat-form-field {\n                width: 48rem;\n                max-width: calc(100% - 2rem);\n            }\n        `,\n    ],\n})\nexport class ControlSpaceListComponent extends AsyncHandler implements OnInit {\n    /** List of controllable spaces */\n    public space_list: Space[] = [];\n    /** Filter string */\n    public search_str: string;\n    /** Whether space list is being filtered */\n    public loading: boolean;\n\n    constructor(\n        private _spaces: SpacesService,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._spaces.initialised.pipe(first((_) => _)).toPromise();\n        this.space_list = this._spaces.filter((space) => !!space.support_url);\n        this.space_list.sort((a, b) => this.sortSpaces(a, b));\n    }\n\n    /** List of spaces filtered using the search string */\n    public get filtered_list(): Space[] {\n        const search = (this.search_str || '').toLowerCase();\n        return (this.space_list || []).filter((space) => {\n            const bld = this._org.buildings.find(\n                (building) => building.id === space.level.parent_id\n            );\n            const space_name = (space.name || '').toLowerCase();\n            const level_name = (\n                (space.level ? space.level.name : '') || ''\n            ).toLowerCase();\n            const bld_name = ((bld ? bld.name : '') || '').toLowerCase();\n            return (\n                space_name.indexOf(search) >= 0 ||\n                (level_name && level_name.indexOf(search) >= 0) ||\n                (bld_name && bld_name.indexOf(search) >= 0)\n            );\n        });\n    }\n\n    private sortSpaces(first: Space, second: Space) {\n        const bld_a = this._org.buildings.find(\n            (building) => building.id === first.level?.parent_id\n        );\n        const space_a_name = (first.name || '').toLowerCase();\n        const level_a_name = (\n            (first.level ? first.level.name : '') || ''\n        ).toLowerCase();\n        const bld_a_name = (bld_a?.name || '').toLowerCase();\n        const bld_b = this._org.buildings.find(\n            (building) => building.id === second.level?.parent_id\n        );\n        const space_b_name = (second.name || '').toLowerCase();\n        const level_b_name = (\n            (second.level ? second.level.name : '') || ''\n        ).toLowerCase();\n        const bld_b_name = (bld_b?.name || '').toLowerCase();\n        return (\n            bld_a_name.localeCompare(bld_b_name) ||\n            level_a_name.localeCompare(level_b_name) ||\n            space_a_name.localeCompare(space_b_name)\n        );\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { SettingsService } from '@placeos/common';\n\n@Component({\n    selector: '[app-control]',\n    template: `\n        <topbar></topbar>\n        <div class=\"flex-1 flex sm:flex-row flex-col-reverse h-1/2\">\n            <main\n                class=\"relative z-0 flex flex-col flex-1 h-1/2 sm:h-auto overflow-hidden\"\n            >\n                <a-control-space-list></a-control-space-list>\n            </main>\n        </div>\n        <footer-menu></footer-menu>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n                background: #f0f0f0;\n            }\n        `,\n    ],\n})\nexport class ControlComponent implements OnInit {\n    constructor(private _settings: SettingsService) {}\n\n    public ngOnInit(): void {\n        this._settings.title = 'Control';\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { ControlComponent } from './control.component';\nimport { ControlSpaceListComponent } from './space-list.component';\nimport { ControlSpaceListItemComponent } from './list-item.component';\nimport { FormsModule } from '@angular/forms';\nimport { SharedComponentModule } from '../components/shared.module';\n\nconst ROUTES: Route[] = [{ path: '', component: ControlComponent }];\n\n@NgModule({\n    declarations: [\n        ControlComponent,\n        ControlSpaceListComponent,\n        ControlSpaceListItemComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        RouterModule.forChild(ROUTES),\n        SharedComponentModule,\n    ],\n})\nexport class ControlModule {}\n"],"x_google_ignoreList":[]}