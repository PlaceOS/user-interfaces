{"version":3,"sources":["./apps/workplace/src/app/control/list-item.component.ts","./apps/workplace/src/app/control/space-list.component.ts","./apps/workplace/src/app/control/control.component.ts","./apps/workplace/src/app/control/control.module.ts"],"names":["ControlSpaceListItemComponent","_settings","_org","this","get","space","level","bld","buildings","find","building","id","parent_id","display_name","name","ControlSpaceListComponent","_spaces","super","space_list","initialised","pipe","first","_","subscribe","filter","support_url","sort","a","b","bld_a","space_a_name","toLowerCase","level_a_name","bld_a_name","bld_b","space_b_name","level_b_name","bld_b_name","localeCompare","search","search_str","space_name","level_name","bld_name","indexOf","ControlComponent","title","ROUTES","path","component","ControlModule"],"mappings":"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","file":"apps_workplace_src_app_control_control_module_ts.js","sourcesContent":["import { Component, Input } from '@angular/core';\n\nimport { SettingsService } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { Space } from '@placeos/spaces';\n\n@Component({\n    selector: 'a-control-space-list-item',\n    template: `\n        <div\n            class=\"flex flex-wrap items-center sm:space-x-4 bg-white hover:bg-gray-100 overflow-hidden p-2 pl-4 mb-2\"\n            *ngIf=\"space\"\n            [class.with-image]=\"show_image\"\n        >\n            <div class=\"flex flex-col flex-1\">\n                <div class=\"text-xl\">{{ space.name }}</div>\n                <div class=\"flex items-center w-full text-sm\">\n                    <div class=\"flex-1\">{{ location }}</div>\n                    <div class=\"flex items-center text-lg\">\n                        <app-icon>account_circle</app-icon>\n                        {{ space.capacity || '0' }}\n                    </div>\n                </div>\n            </div>\n            <div\n                class=\"flex w-full sm:w-auto sm:flex-col items-center space-x-2 sm:space-x-0 sm:space-y-2 mt-4 sm:mt-0\"\n            >\n                <a\n                    mat-button\n                    button\n                    class=\"w-32 flex-1 sm:flex-none\"\n                    [href]=\"space.support_url | safe: 'url'\"\n                >\n                    Control\n                </a>\n                <a\n                    mat-button\n                    button\n                    class=\"w-32 flex-1 sm:flex-none inverse\"\n                    [routerLink]=\"['/explore']\"\n                    [queryParams]=\"{ space: space.id }\"\n                >\n                    Find\n                </a>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class ControlSpaceListItemComponent {\n    /** Space to display */\n    @Input() public space: Space;\n\n    public get show_image() {\n        return this._settings.get('app.space_display.show_images');\n    }\n\n    /** Display location of the space */\n    public get location(): string {\n        if (!this.space) {\n            return 'Unable to determine location';\n        }\n        const level = this.space.level;\n        const bld = this._org.buildings.find(\n            (building) => building.id === level.parent_id\n        );\n        return `${bld ? (bld.display_name || bld.name) + ', ' : ''}${\n            level.display_name || level.name\n        }`;\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _org: OrganisationService\n    ) {}\n}\n","import { Component, OnInit } from '@angular/core';\nimport { first } from 'rxjs/operators';\n\nimport { BaseClass } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { Space, SpacesService } from '@placeos/spaces';\n\n@Component({\n    selector: 'a-control-space-list',\n    template: `\n        <div class=\"w-full flex items-center justify-center p-2\">\n            <mat-form-field overlay class=\"rounded h-12\" appearance=\"outline\">\n                <app-icon class=\"text-xl\" matPrefix>search</app-icon>\n                <input\n                    matInput\n                    [(ngModel)]=\"search_str\"\n                    placeholder=\"Search...\"\n                />\n                <mat-spinner\n                    matSuffix\n                    class=\"top-2\"\n                    *ngIf=\"loading\"\n                    [diameter]=\"32\"\n                ></mat-spinner>\n            </mat-form-field>\n        </div>\n        <div\n            class=\"flex flex-col flex-1 overflow-auto w-full\"\n            *ngIf=\"filtered_list.length; else empty_state\"\n        >\n            <a-control-space-list-item\n                *ngFor=\"let space of filtered_list\"\n                [space]=\"space\"\n            ></a-control-space-list-item>\n        </div>\n        <ng-template #empty_state>\n            <div class=\"flex flex-col items-center p-8\">\n                <app-icon>close</app-icon>\n                <p>\n                    {{\n                        search_str\n                            ? ' No matches for \"' + search_str + '\"'\n                            : 'No controllable spaces'\n                    }}\n                </p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n            }\n\n            mat-form-field {\n                width: 768px;\n                max-width: calc(100% - 2rem);\n            }\n        `,\n    ],\n})\nexport class ControlSpaceListComponent extends BaseClass implements OnInit {\n    /** List of controllable spaces */\n    public space_list: Space[] = [];\n    /** Filter string */\n    public search_str: string;\n    /** Whether space list is being filtered */\n    public loading: boolean;\n\n    constructor(\n        private _spaces: SpacesService,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.space_list = this._spaces.filter(\n                (space) => !!space.support_url\n            );\n            this.space_list.sort((a, b) => {\n                const bld_a = this._org.buildings.find(\n                    (building) => building.id === a.level.parent_id\n                );\n                const space_a_name = (a.name || '').toLowerCase();\n                const level_a_name = (\n                    (a.level ? a.level.name : '') || ''\n                ).toLowerCase();\n                const bld_a_name = (\n                    (bld_a ? bld_a.name : '') || ''\n                ).toLowerCase();\n                const bld_b = this._org.buildings.find(\n                    (building) => building.id === b.level.parent_id\n                );\n                const space_b_name = (b.name || '').toLowerCase();\n                const level_b_name = (\n                    (b.level ? b.level.name : '') || ''\n                ).toLowerCase();\n                const bld_b_name = (\n                    (bld_b ? bld_b.name : '') || ''\n                ).toLowerCase();\n                return (\n                    bld_a_name.localeCompare(bld_b_name) ||\n                    level_a_name.localeCompare(level_b_name) ||\n                    space_a_name.localeCompare(space_b_name)\n                );\n            });\n        });\n    }\n\n    /** List of spaces filtered using the search string */\n    public get filtered_list(): Space[] {\n        const search = (this.search_str || '').toLowerCase();\n        return (this.space_list || []).filter((space) => {\n            const bld = this._org.buildings.find(\n                (building) => building.id === space.level.parent_id\n            );\n            const space_name = (space.name || '').toLowerCase();\n            const level_name = (\n                (space.level ? space.level.name : '') || ''\n            ).toLowerCase();\n            const bld_name = ((bld ? bld.name : '') || '').toLowerCase();\n            return (\n                space_name.indexOf(search) >= 0 ||\n                (level_name && level_name.indexOf(search) >= 0) ||\n                (bld_name && bld_name.indexOf(search) >= 0)\n            );\n        });\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { SettingsService } from '@placeos/common';\n\n@Component({\n    selector: '[app-control]',\n    template: `\n        <topbar></topbar>\n        <div class=\"flex-1 flex sm:flex-row flex-col-reverse h-1/2\">\n            <nav-menu class=\"relative z-10\"></nav-menu>\n            <main\n                class=\"relative z-0 flex flex-col flex-1 h-1/2 sm:h-auto overflow-hidden\"\n            >\n                <a-control-space-list></a-control-space-list>\n            </main>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n                background: #f0f0f0;\n            }\n        `,\n    ],\n})\nexport class ControlComponent implements OnInit {\n    constructor(private _settings: SettingsService) {}\n\n    public ngOnInit(): void {\n        this._settings.title = 'Control';\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { ControlComponent } from './control.component';\nimport { SharedContentModule } from '../ui/shared.module';\nimport { ControlSpaceListComponent } from './space-list.component';\nimport { ControlSpaceListItemComponent } from './list-item.component';\nimport { FormsModule } from '@angular/forms';\n\nconst ROUTES: Route[] = [{ path: '', component: ControlComponent }];\n\n@NgModule({\n    declarations: [\n        ControlComponent,\n        ControlSpaceListComponent,\n        ControlSpaceListItemComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        RouterModule.forChild(ROUTES),\n        SharedContentModule,\n    ],\n})\nexport class ControlModule {}\n"],"sourceRoot":"webpack:///"}