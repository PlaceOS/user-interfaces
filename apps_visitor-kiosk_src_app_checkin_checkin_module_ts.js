"use strict";(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([["apps_visitor-kiosk_src_app_checkin_checkin_module_ts"],{8774:(Qi,ge,d)=>{d.r(ge),d.d(ge,{VisitorCheckinModule:()=>Yi});var p=d(93),u=d(9298),v=d(1560),ze=d(2487),h=d(3786),q=d(88),B=d(2064),_=d(2247),z=d(3775),X=d(3702),Xe=d(7326),w=d(6491),t=d(8946);let P=(()=>{class o{constructor(){this._event=new w.X(null),this._guest=new w.X(null),this._photo=new w.X(""),this._error=new w.X(""),this._form=new w.X(null),this.event=this._event.asObservable(),this.guest=this._guest.asObservable(),this.error=this._error.asObservable(),this.form=this._form.asObservable()}clear(){this._guest.next(null),this._event.next(null),this._photo.next(null)}setPhoto(n){this._photo.next(n)}setError(n){this._error.next(n)}loadGuestAndEvent(n,i){return(0,h.mG)(this,void 0,void 0,function*(){const a=yield(0,X.pP)(n).toPromise();if(i){const m=yield(0,z.Vh)(i).toPromise();return this._guest.next(a),this._event.next(m),this._form.next((0,X.en)(a,m.host)),{guest:a,event:m}}const r=yield(0,X.n2)(n).toPromise(),l=new Date,c=r.filter(m=>(0,Xe.Z)(new Date(m.date),l));if(c.sort((m,g)=>m.date-g.date),c.length<=0)throw new Error(`No meetings for with guest "${n}" today`);return this._guest.next(a),this._event.next(c[0]),this._form.next((0,X.en)(a,c[0].host)),{guest:a,event:c[0]}})}updateGuest(n){return(0,h.mG)(this,void 0,void 0,function*(){const i=this._guest.getValue(),a=this._form.getValue();!i||!a||(yield(0,B.Ymr)(i.email,{name:"preferences",details:Object.assign(Object.assign(Object.assign({},i),a.value),n||{})}).toPromise())})}checkinGuest(){var n,i;return(0,h.mG)(this,void 0,void 0,function*(){const a=this._guest.getValue(),r=this._event.getValue();!a||!r||(yield(0,z.rq)(r.id,a.email,!0,{system_id:(null===(n=r.system)||void 0===n?void 0:n.id)||(null===(i=r.resources[0])||void 0===i?void 0:i.id)}).toPromise())})}printPass(){try{return new Promise(n=>setTimeout(()=>n(""),5e3))}catch(n){(0,_.cB)("Error printing visitor pass")}return Promise.reject()}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var A=d(3176),j=d(4813),b=d(5159),C=d(5306),F=d(1039);const Ke=["checkin-details",""],et=function(){return["/welcome"]};function tt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"form",2),t.ALo(1,"async"),t.TgZ(2,"h3",3),t._uU(3,"Confirm Details"),t.qZA(),t.TgZ(4,"div",4),t.TgZ(5,"label",5),t._uU(6,"Host"),t.qZA(),t.TgZ(7,"mat-form-field",6),t._UZ(8,"input",7),t.TgZ(9,"mat-error"),t._uU(10," The email address of your host is required "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",4),t.TgZ(12,"label",8),t._uU(13,"Name"),t.qZA(),t.TgZ(14,"mat-form-field",6),t._UZ(15,"input",9),t.TgZ(16,"mat-error"),t._uU(17,"Please enter your full name"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"div",4),t.TgZ(19,"label",10),t._uU(20,"Email"),t.qZA(),t.TgZ(21,"mat-form-field",6),t._UZ(22,"input",11),t.TgZ(23,"mat-error"),t._uU(24,"A valid email address is required"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",4),t.TgZ(26,"label",10),t._uU(27,"Phone Number"),t.qZA(),t.TgZ(28,"mat-form-field",6),t._UZ(29,"input",12),t.qZA(),t.qZA(),t.TgZ(30,"div",4),t.TgZ(31,"label",10),t._uU(32,"Organisation / Company"),t.qZA(),t.TgZ(33,"mat-form-field",6),t._UZ(34,"input",13),t.qZA(),t.qZA(),t.TgZ(35,"button",14),t.NdJ("click",function(){return t.CHM(n),t.oxw().updateGuest()}),t._uU(36,"Next"),t.qZA(),t.TgZ(37,"a",15),t.TgZ(38,"app-icon"),t._uU(39,"close"),t.qZA(),t.qZA(),t.qZA()}if(2&o){const n=t.oxw();t.Q6J("formGroup",t.lcZ(1,2,n.form)),t.xp6(37),t.Q6J("routerLink",t.DdM(4,et))}}function nt(o,s){1&o&&(t.TgZ(0,"div",16),t._UZ(1,"mat-spinner",17),t.TgZ(2,"div",18),t._uU(3," Updating data and checking in... "),t.qZA(),t.qZA()),2&o&&(t.xp6(1),t.Q6J("diameter",48))}let it=(()=>{class o{constructor(n,i){this._checkin=n,this._router=i,this.form=this._checkin.form,this.loading=!1}ngOnInit(){this.form.pipe((0,q.P)()).subscribe(n=>n?"":this.previous())}updateGuest(){return(0,h.mG)(this,void 0,void 0,function*(){this.loading=!0,yield this._checkin.updateGuest(),yield this._checkin.checkinGuest(),this.loading=!1,this._router.navigate(["/checkin","covid"])})}previous(){this._router.navigate(["/checkin","scan"])}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(P),t.Y36(v.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["","checkin-details",""]],attrs:Ke,decls:4,vars:4,consts:[["class","bg-white rounded shadow overflow-hidden relative flex flex-col items-center my-4 mx-auto",3,"formGroup",4,"ngIf","ngIfElse"],["load_state",""],[1,"bg-white","rounded","shadow","overflow-hidden","relative","flex","flex-col","items-center","my-4","mx-auto",3,"formGroup"],[1,"text-2xl","m-4"],["field","",1,"flex","flex-col"],["form","host"],["appearance","outline"],["matInput","","name","host","formControlName","host","placeholder","Host's Email Address"],["form","name"],["matInput","","name","name","formControlName","name","placeholder","Full Name"],["form","email"],["matInput","","name","email","formControlName","email","placeholder","Email Address"],["matInput","","name","phone","type","tel","formControlName","phone","placeholder","Phone Number"],["matInput","","name","phone","type","tel","formControlName","phone","placeholder","Organisation / Company"],["next","","mat-button","",3,"click"],["mat-icon-button","",1,"absolute","top-0","right-0",3,"routerLink"],[1,"flex","flex-col","items-center","m-auto"],[3,"diameter"],[1,"my-4","text-lg","text-white"]],template:function(n,i){if(1&n&&(t.YNc(0,tt,40,5,"form",0),t.ALo(1,"async"),t.YNc(2,nt,4,1,"ng-template",null,1,t.W1O)),2&n){const a=t.MAs(3);t.Q6J("ngIf",t.lcZ(1,2,i.form)&&!i.loading)("ngIfElse",a)}},directives:[p.O5,u._Y,u.JL,u.sg,A.KE,j.Nt,u.Fj,u.JJ,u.u,A.TO,b.lW,b.zs,v.yS,C.o,F.$g],pipes:[p.Ov],styles:["[_nghost-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-color:#00000080}form[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem)}[field][_ngcontent-%COMP%]{width:calc(100% - 2rem)}.absolute[_ngcontent-%COMP%]{position:absolute}button[_ngcontent-%COMP%]{margin-bottom:1rem;width:8rem}"]}),o})();var ot=d(2171);const at=function(){return["/welcome"]};function rt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",2),t.TgZ(1,"h3",3),t._uU(2,"Take a photo to continue"),t.qZA(),t.TgZ(3,"a-take-photo",4),t.NdJ("photoAccepted",function(a){return t.CHM(n),t.oxw().handlePhoto(a)}),t.qZA(),t.TgZ(4,"a",5),t.TgZ(5,"app-icon"),t._uU(6,"close"),t.qZA(),t.qZA(),t.qZA()}2&o&&(t.xp6(4),t.Q6J("routerLink",t.DdM(1,at)))}function st(o,s){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"mat-spinner",7),t.TgZ(2,"div",8),t._uU(3," Printing guest pass... "),t.qZA(),t.qZA()),2&o&&(t.xp6(1),t.Q6J("diameter",48))}let lt=(()=>{class o{constructor(n,i){this._checkin=n,this._router=i}handlePhoto(n){return(0,h.mG)(this,void 0,void 0,function*(){if(!n)return(0,_.cB)("Error saving image, please try again");this.loading=!0,this._checkin.setPhoto(n),yield this._checkin.printPass().catch(i=>{throw this.loading=!1,(0,_.cB)(i),i}),this.loading=!1,this._router.navigate(["/checkin","results"])})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(P),t.Y36(v.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["checkin-photo"]],decls:3,vars:2,consts:[["class","bg-white rounded shadow overflow-hidden relative flex flex-col items-center p-4",4,"ngIf","ngIfElse"],["load_state",""],[1,"bg-white","rounded","shadow","overflow-hidden","relative","flex","flex-col","items-center","p-4"],[1,"text-xl","mb-4"],[3,"photoAccepted"],["mat-icon-button","",1,"absolute","top-0","right-0",3,"routerLink"],[1,"flex","flex-col","items-center","m-auto"],[3,"diameter"],[1,"my-4","text-lg","text-white"]],template:function(n,i){if(1&n&&(t.YNc(0,rt,7,2,"div",0),t.YNc(1,st,4,1,"ng-template",null,1,t.W1O)),2&n){const a=t.MAs(2);t.Q6J("ngIf",!i.loading)("ngIfElse",a)}},directives:[p.O5,ot.Q,b.zs,v.yS,C.o,F.$g],styles:["[_nghost-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0;right:0;bottom:0;background-color:#00000080}.absolute[_ngcontent-%COMP%]{position:absolute}"]}),o})();d(114),d(8466);var y=d(8931);const ct=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}];var _e=d(7820),f=d(6360);function dt(o,s){1&o&&(t.TgZ(0,"button",5),t.TgZ(1,"app-icon"),t._uU(2,"close"),t.qZA(),t.qZA())}function mt(o,s){if(1&o&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(1),t.hij(" ",n.name," ")}}function ut(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",14),t.TgZ(1,"mat-form-field",8),t.TgZ(2,"mat-select",15),t.NdJ("ngModelChange",function(a){return t.CHM(n).$implicit[0]=a}),t.YNc(3,mt,2,2,"mat-option",16),t.qZA(),t.qZA(),t.TgZ(4,"mat-form-field",8),t.TgZ(5,"input",17),t.NdJ("ngModelChange",function(a){return t.CHM(n).$implicit[1]=a}),t.qZA(),t.TgZ(6,"mat-error"),t._uU(7,"Rule value is required"),t.qZA(),t.qZA(),t.qZA()}if(2&o){const n=s.$implicit,i=t.oxw(2);t.xp6(2),t.Q6J("ngModel",n[0]),t.xp6(1),t.Q6J("ngForOf",i.rule_types),t.xp6(2),t.Q6J("ngModel",n[1])}}function pt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",6),t.TgZ(1,"div",7),t.TgZ(2,"mat-form-field",8),t.TgZ(3,"input",9),t.NdJ("ngModelChange",function(a){return t.CHM(n).$implicit.name=a}),t.qZA(),t.TgZ(4,"mat-error"),t._uU(5,"Ruleset name is required"),t.qZA(),t.qZA(),t.TgZ(6,"button",10),t.NdJ("click",function(){const r=t.CHM(n).$implicit,l=t.oxw();return r.rules.push(["",""]),l.show_rules=r.id}),t.TgZ(7,"app-icon"),t._uU(8,"add"),t.qZA(),t.qZA(),t.TgZ(9,"button",11),t.NdJ("click",function(){const r=t.CHM(n).$implicit,l=t.oxw();return l.show_rules=l.show_rules!==r.id?r.id:""}),t.TgZ(10,"app-icon"),t._uU(11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",12),t.YNc(13,ut,8,3,"div",13),t.qZA(),t.qZA()}if(2&o){const n=s.$implicit,i=t.oxw();t.xp6(3),t.Q6J("ngModel",n.name),t.xp6(6),t.Q6J("disabled",!n.rules.length),t.xp6(2),t.Oqu(i.show_rules===n.id?"expand_less":"expand_more"),t.xp6(1),t.Udp("height",(i.show_rules===n.id?3.5*n.rules.length:0)+"em"),t.xp6(1),t.Q6J("ngForOf",n.rules)}}let he=(()=>{class o{constructor(n){this._data=n,this.event=new t.vpe,this.loading=!1,this.rule_types=ct,this.rulesets=(n.config||[]).map(i=>(i.rules=i.rules.map(a=>[a[0],JSON.stringify(a[1])]),i))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const n=this.rulesets.map(i=>Object.assign(Object.assign({},i),{rules:i.rules.map(a=>{let r=a[1];try{r=JSON.parse(a[1])}catch(l){}return[a[0],r]})}));this.event.emit({reason:"done",metadata:n})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(y.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex px-2 h-14 space-x-2",4,"ngFor","ngForOf"],[1,"flex","px-2","h-14","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(n,i){1&n&&(t.TgZ(0,"header"),t.TgZ(1,"h3"),t._uU(2,"Edit Catering Configuration"),t.qZA(),t.YNc(3,dt,3,0,"button",0),t.qZA(),t.TgZ(4,"main",1),t.TgZ(5,"button",2),t.NdJ("click",function(){return i.rulesets.push({id:i.new_id,rules:[]})}),t._uU(6," New Ruleset "),t.qZA(),t.YNc(7,pt,14,6,"div",3),t.qZA(),t.TgZ(8,"footer",4),t.TgZ(9,"button",2),t.NdJ("click",function(){return i.saveChanges()}),t._uU(10,"Save Changes"),t.qZA(),t.qZA()),2&n&&(t.xp6(3),t.Q6J("ngIf",!i.loading),t.xp6(4),t.Q6J("ngForOf",i.rulesets))},directives:[p.O5,b.lW,p.sg,y.ZT,C.o,A.KE,j.Nt,u.Fj,u.Q7,u.JJ,u.On,A.TO,_e.gD,f.ey],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}"]}),o})();var R=d(7193),M=d(2962),K=d(9034),ae=d(3393),fe=d(2793),ee=d(5346);function gt(o,s){1&o&&(t.TgZ(0,"button",7),t.TgZ(1,"app-icon"),t._uU(2,"close"),t.qZA(),t.qZA())}function _t(o,s){if(1&o&&(t.TgZ(0,"div",15),t.TgZ(1,"label",16),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",18),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA(),t.qZA(),t.qZA()),2&o){const n=t.oxw(2);t.xp6(1),t.ekj("error",n.form.controls.name.invalid&&n.form.controls.name.touched)}}function ht(o,s){if(1&o&&(t.TgZ(0,"div",15),t.TgZ(1,"label",19),t._uU(2," Category"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",20),t.TgZ(8,"mat-error"),t._uU(9,"Category is required"),t.qZA(),t.qZA(),t.qZA()),2&o){const n=t.oxw(2),i=t.MAs(9);t.xp6(1),t.ekj("error",n.form.controls.category.invalid&&n.form.controls.category.touched),t.xp6(6),t.Q6J("matAutocomplete",i)}}const ft=function(){return{class:"material-icons",content:"close"}};function bt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"mat-chip",27),t.NdJ("removed",function(){const r=t.CHM(n).$implicit;return t.oxw(3).removeTag(r)}),t._uU(1),t._UZ(2,"app-icon",28),t.qZA()}if(2&o){const n=s.$implicit;t.Q6J("selectable",!0)("removable",!0),t.xp6(1),t.hij(" ",n," "),t.xp6(1),t.Q6J("icon",t.DdM(4,ft))}}function vt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",15),t.TgZ(1,"label",21),t.SDv(2,22),t.qZA(),t.TgZ(3,"mat-form-field",17),t.TgZ(4,"mat-chip-list",23,24),t.YNc(6,bt,3,5,"mat-chip",25),t.TgZ(7,"input",26),t.NdJ("matChipInputTokenEnd",function(a){return t.CHM(n),t.oxw(2).addTag(a)}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const n=t.MAs(5),i=t.oxw(2);t.xp6(1),t.ekj("error",i.form.controls.tags.invalid&&i.form.controls.tags.touched),t.xp6(5),t.Q6J("ngForOf",i.tag_list),t.xp6(1),t.Q6J("matChipInputFor",n)("matChipInputSeparatorKeyCodes",i.separators)("matChipInputAddOnBlur",!0)}}function Ct(o,s){1&o&&(t.TgZ(0,"div",15),t.TgZ(1,"label",29),t._uU(2,"Description:"),t.qZA(),t.TgZ(3,"mat-form-field",17),t._UZ(4,"textarea",30),t.qZA(),t.qZA())}function Tt(o,s){if(1&o&&(t.TgZ(0,"div",15),t.TgZ(1,"label",16),t._uU(2," Unit Price"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",17),t._UZ(7,"input",31),t.TgZ(8,"mat-error"),t._uU(9,"Unit Price is required"),t.qZA(),t.qZA(),t.qZA()),2&o){const n=t.oxw(2);t.xp6(1),t.ekj("error",n.form.controls.unit_price.invalid&&n.form.controls.unit_price.touched)}}function xt(o,s){if(1&o&&(t.TgZ(0,"form",8),t.YNc(1,_t,10,2,"div",9),t.YNc(2,ht,10,3,"div",9),t.YNc(3,vt,8,6,"div",9),t.YNc(4,Ct,5,0,"div",9),t.YNc(5,Tt,10,2,"div",9),t.TgZ(6,"div",10),t.TgZ(7,"label",11),t._uU(8,"Accept Points?"),t.qZA(),t.TgZ(9,"mat-checkbox",12),t._uU(10),t.qZA(),t.qZA(),t.TgZ(11,"div",10),t.TgZ(12,"label",13),t._uU(13,"Discount Cap"),t.qZA(),t._UZ(14,"a-counter",14),t.qZA(),t.qZA()),2&o){const n=t.oxw();let i;t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.form.controls.name),t.xp6(1),t.Q6J("ngIf",n.form.controls.category),t.xp6(1),t.Q6J("ngIf",n.form.controls.tags),t.xp6(1),t.Q6J("ngIf",n.form.controls.description),t.xp6(1),t.Q6J("ngIf",n.form.controls.unit_price),t.xp6(5),t.Oqu(null!=(i=n.form.get("accept_points"))&&i.value?"No":"Yes"),t.xp6(4),t.Q6J("min",0)("max",100)("step",5)("render_fn",n.renderPercent)}}function Zt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"footer",32),t.TgZ(1,"button",33),t.NdJ("click",function(){return t.CHM(n),t.oxw().saveChanges()}),t._uU(2," Save "),t.qZA(),t.qZA()}if(2&o){const n=t.oxw();t.xp6(1),t.Q6J("disabled",!n.form.dirty)}}function yt(o,s){1&o&&(t.TgZ(0,"div",34),t._UZ(1,"mat-spinner",35),t.TgZ(2,"p"),t._uU(3,"Saving catering item..."),t.qZA(),t.qZA())}function Mt(o,s){if(1&o&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}let be=(()=>{class o{constructor(n){this._data=n,this.event=new t.vpe,this.form=new u.cw({name:new u.NI(this.item.name||"",[u.kI.required]),description:new u.NI(this.item.description||""),category:new u.NI(this.item.category||"",[u.kI.required]),unit_price:new u.NI(this.item.unit_price,[u.kI.required]),tags:new u.NI(this.item.tags||[]),accept_points:new u.NI(this.item.accept_points||!1),discount_cap:new u.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[R.K5,R.OC,R.L_]}get item(){return this._data.item||new M.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(n=0){return`${n}%`}addTag(n){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const i=n.input,a=n.value,r=this.tag_list;(a||"").trim()&&(r.push(a),this.form.controls.tags.setValue(r)),i&&(i.value="")}removeTag(n){if(!this.form||!this.form.controls.tags)return;const i=this.tag_list;this.form.controls.tags.markAsDirty();const a=i.indexOf(n);a>=0&&(i.splice(a,1),this.form.controls.tags.setValue(i))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new M.U(Object.assign(Object.assign(Object.assign({},this.item),{id:this.item.id||`item-${(0,_.Iy)(99999999)}`}),this.form.value))}})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(y.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let s,n;return s=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,n=$localize`:@@zoneTagsPlaceholder␟8dc7c13b0c6b8ad9c770bce0ad72e14b4aef8456␟3986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],s,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",n,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(n,i){if(1&n&&(t.TgZ(0,"header"),t.TgZ(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,gt,3,0,"button",1),t.qZA(),t.YNc(4,xt,15,11,"form",2),t.YNc(5,Zt,3,1,"footer",3),t.YNc(6,yt,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,Mt,2,2,"mat-option",6),t.qZA()),2&n){const a=t.MAs(7);t.xp6(2),t.hij("",i.item.id?"Edit":"Add"," Item"),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",i.form&&!i.loading)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(5),t.Q6J("ngForOf",i.categories)}},directives:[y.uh,p.O5,K.XC,p.sg,b.lW,y.ZT,C.o,u._Y,u.JL,u.sg,ae.oG,u.JJ,u.u,fe.R,A.KE,j.Nt,u.Fj,A.TO,K.ZL,ee.qn,ee.oH,ee.HS,ee.qH,u.wV,F.$g,f.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"]}),o})();var wt=d(8539),ve=d(3245);function At(o,s){1&o&&(t.TgZ(0,"button",7),t.TgZ(1,"app-icon"),t._uU(2,"close"),t.qZA(),t.qZA())}function It(o,s){if(1&o&&(t.TgZ(0,"div",10),t.TgZ(1,"label",11),t._uU(2," Name"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",12),t._UZ(7,"input",13),t.TgZ(8,"mat-error"),t._uU(9,"Name is required"),t.qZA(),t.qZA(),t.qZA()),2&o){const n=t.oxw(2);t.xp6(1),t.ekj("error",n.form.controls.name.invalid&&n.form.controls.name.touched)}}function kt(o,s){if(1&o&&(t.TgZ(0,"div",10),t.TgZ(1,"label",14),t._uU(2," Type"),t.TgZ(3,"span"),t._uU(4,"*"),t.qZA(),t._uU(5,": "),t.qZA(),t.TgZ(6,"mat-form-field",12),t._UZ(7,"input",15),t.TgZ(8,"mat-error"),t._uU(9,"Type is required"),t.qZA(),t.qZA(),t.qZA()),2&o){const n=t.oxw(2),i=t.MAs(9);t.xp6(1),t.ekj("error",n.form.controls.group.invalid&&n.form.controls.group.touched),t.xp6(6),t.Q6J("matAutocomplete",i)}}function Ot(o,s){1&o&&(t.TgZ(0,"div",10),t.TgZ(1,"label",11),t._uU(2,"Unit Price:"),t.qZA(),t.TgZ(3,"mat-form-field",12),t._UZ(4,"input",16),t.qZA(),t.qZA())}function qt(o,s){1&o&&(t.TgZ(0,"div",10),t.TgZ(1,"mat-checkbox",17),t._uU(2," Can select multiple of type "),t.qZA(),t.qZA())}function Pt(o,s){if(1&o&&(t.TgZ(0,"form",8),t.YNc(1,It,10,2,"div",9),t.YNc(2,kt,10,3,"div",9),t.YNc(3,Ot,5,0,"div",9),t.YNc(4,qt,3,0,"div",9),t.qZA()),2&o){const n=t.oxw();t.Q6J("formGroup",n.form),t.xp6(1),t.Q6J("ngIf",n.form.controls.name),t.xp6(1),t.Q6J("ngIf",n.form.controls.group),t.xp6(1),t.Q6J("ngIf",n.form.controls.unit_price),t.xp6(1),t.Q6J("ngIf",n.form.controls.multiple)}}function Lt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"footer",18),t.TgZ(1,"button",19),t.NdJ("click",function(){return t.CHM(n),t.oxw().saveChanges()}),t._uU(2," Save "),t.qZA(),t.qZA()}if(2&o){const n=t.oxw();t.xp6(1),t.Q6J("disabled",!n.form.dirty)}}function Nt(o,s){1&o&&(t.TgZ(0,"div",20),t._UZ(1,"mat-spinner",21),t.TgZ(2,"p"),t._uU(3,"Saving catering item option..."),t.qZA(),t.qZA())}function Ut(o,s){if(1&o&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n," ")}}let Ce=(()=>{class o{constructor(n){this._data=n,this.event=new t.vpe,this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}ngOnInit(){this.form=new u.cw({name:new u.NI(this.option.name||"",[u.kI.required]),group:new u.NI(this.option.group||"",[u.kI.required]),unit_price:new u.NI(this.option.unit_price),multiple:new u.NI(!!this.option.multiple,[])})}saveChanges(){this.loading=!0;const n=Object.assign(Object.assign(Object.assign({},this.option),{id:this.option.id||`option-${(0,ve.Iy)(99999999)}`}),this.form.value);this.event.emit({reason:"done",metadata:{item:new M.U(Object.assign(Object.assign({},this._data.parent),{options:this._data.parent.options.filter(i=>i.id!==n.id).concat([n])}))}})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(y.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-none border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(n,i){if(1&n&&(t.TgZ(0,"header"),t.TgZ(1,"h3",0),t._uU(2),t.qZA(),t.YNc(3,At,3,0,"button",1),t.qZA(),t.YNc(4,Pt,5,5,"form",2),t.YNc(5,Lt,3,1,"footer",3),t.YNc(6,Nt,4,0,"ng-template",null,4,t.W1O),t.TgZ(8,"mat-autocomplete",null,5),t.YNc(10,Ut,2,2,"mat-option",6),t.qZA()),2&n){const a=t.MAs(7);t.xp6(2),t.hij(" ",i.option.id?"Edit":"Add"," Item Option "),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",i.form&&!i.loading)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(5),t.Q6J("ngForOf",i.types)}},directives:[y.uh,p.O5,K.XC,p.sg,b.lW,y.ZT,C.o,u._Y,u.JL,u.sg,A.KE,j.Nt,u.Fj,u.JJ,u.u,A.TO,K.ZL,u.wV,ae.oG,F.$g,f.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"]}),o})();var I=d(5163),Dt=d(8292),Te=d(1112),Et=d(6412),xe=d(8025),H=d(4534),re=d(9577),Y=d(6529),k=d(9613),te=d(9441),G=d(1318),se=d(9919),le=d(2516),St=d(1134),Ft=d(8059),T=d(2458),ce=d(1143),Rt=d(3720),L=d(2663),N=d(657),U=d(4079),D=d(5897),$=d(7056);
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */function Yt(o,s){1&o&&t.Hsn(0)}const de=["*"];function Jt(o,s){}const Qt=function(o){return{animationDuration:o}},Bt=function(o,s){return{value:o,params:s}},jt=["tabBodyWrapper"],Ht=["tabHeader"];function Gt(o,s){}function $t(o,s){if(1&o&&t.YNc(0,Gt,0,0,"ng-template",9),2&o){const n=t.oxw().$implicit;t.Q6J("cdkPortalOutlet",n.templateLabel)}}function Wt(o,s){if(1&o&&t._uU(0),2&o){const n=t.oxw().$implicit;t.Oqu(n.textLabel)}}function Vt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",6),t.NdJ("click",function(){const a=t.CHM(n),r=a.$implicit,l=a.index,c=t.oxw(),m=t.MAs(1);return c._handleClick(r,m,l)})("cdkFocusChange",function(a){const l=t.CHM(n).index;return t.oxw()._tabFocusChanged(a,l)}),t.TgZ(1,"div",7),t.YNc(2,$t,1,1,"ng-template",8),t.YNc(3,Wt,1,1,"ng-template",8),t.qZA(),t.qZA()}if(2&o){const n=s.$implicit,i=s.index,a=t.oxw();t.ekj("mat-tab-label-active",a.selectedIndex==i),t.Q6J("id",a._getTabLabelId(i))("disabled",n.disabled)("matRippleDisabled",n.disabled||a.disableRipple),t.uIk("tabIndex",a._getTabIndex(n,i))("aria-posinset",i+1)("aria-setsize",a._tabs.length)("aria-controls",a._getTabContentId(i))("aria-selected",a.selectedIndex==i)("aria-label",n.ariaLabel||null)("aria-labelledby",!n.ariaLabel&&n.ariaLabelledby?n.ariaLabelledby:null),t.xp6(2),t.Q6J("ngIf",n.templateLabel),t.xp6(1),t.Q6J("ngIf",!n.templateLabel)}}function zt(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"mat-tab-body",10),t.NdJ("_onCentered",function(){return t.CHM(n),t.oxw()._removeTabBodyWrapperHeight()})("_onCentering",function(a){return t.CHM(n),t.oxw()._setTabBodyWrapperHeight(a)}),t.qZA()}if(2&o){const n=s.$implicit,i=s.index,a=t.oxw();t.ekj("mat-tab-body-active",a.selectedIndex===i),t.Q6J("id",a._getTabContentId(i))("content",n.content)("position",n.position)("origin",n.origin)("animationDuration",a.animationDuration),t.uIk("tabindex",null!=a.contentTabIndex&&a.selectedIndex===i?a.contentTabIndex:null)("aria-labelledby",a._getTabLabelId(i))}}const Ze=["tabListContainer"],ye=["tabList"],Me=["nextPaginator"],we=["previousPaginator"],Kt=new t.OlP("MatInkBarPositioner",{providedIn:"root",factory:function(){return s=>({left:s?(s.offsetLeft||0)+"px":"0",width:s?(s.offsetWidth||0)+"px":"0"})}});let ne=(()=>{class o{constructor(n,i,a,r){this._elementRef=n,this._ngZone=i,this._inkBarPositioner=a,this._animationMode=r}alignToElement(n){this.show(),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._setStyles(n))}):this._setStyles(n)}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}_setStyles(n){const i=this._inkBarPositioner(n),a=this._elementRef.nativeElement;a.style.left=i.left,a.style.width=i.width}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.SBq),t.Y36(t.R0b),t.Y36(Kt),t.Y36(k.Qb,8))},o.\u0275dir=t.lG2({type:o,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(n,i){2&n&&t.ekj("_mat-animation-noopable","NoopAnimations"===i._animationMode)}}),o})();
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */const Ae=new t.OlP("MatTabContent"),Ie=new t.OlP("MatTabLabel"),ke=new t.OlP("MAT_TAB"),tn=(0,f.Id)(class{}),Oe=new t.OlP("MAT_TAB_GROUP");let me=(()=>{class o extends tn{constructor(n,i){super(),this._viewContainerRef=n,this._closestTabGroup=i,this.textLabel="",this._contentPortal=null,this._stateChanges=new te.xQ,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(n){this._setTemplateLabelInput(n)}get content(){return this._contentPortal}ngOnChanges(n){(n.hasOwnProperty("textLabel")||n.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new Y.UE(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(n){n&&n._closestTab===this&&(this._templateLabel=n)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.s_b),t.Y36(Oe,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["mat-tab"]],contentQueries:function(n,i,a){if(1&n&&(t.Suo(a,Ie,5),t.Suo(a,Ae,7,t.Rgc)),2&n){let r;t.iGM(r=t.CRH())&&(i.templateLabel=r.first),t.iGM(r=t.CRH())&&(i._explicitContent=r.first)}},viewQuery:function(n,i){if(1&n&&t.Gf(t.Rgc,7),2&n){let a;t.iGM(a=t.CRH())&&(i._implicitContent=a.first)}},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"]},exportAs:["matTab"],features:[t._Bn([{provide:ke,useExisting:o}]),t.qOj,t.TTD],ngContentSelectors:de,decls:1,vars:0,template:function(n,i){1&n&&(t.F$t(),t.YNc(0,Yt,1,0,"ng-template"))},encapsulation:2}),o})();
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */const nn={translateTab:(0,T.X$)("translateTab",[(0,T.SB)("center, void, left-origin-center, right-origin-center",(0,T.oB)({transform:"none"})),(0,T.SB)("left",(0,T.oB)({transform:"translate3d(-100%, 0, 0)",minHeight:"1px"})),(0,T.SB)("right",(0,T.oB)({transform:"translate3d(100%, 0, 0)",minHeight:"1px"})),(0,T.eR)("* => left, * => right, left => center, right => center",(0,T.jt)("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),(0,T.eR)("void => left-origin-center",[(0,T.oB)({transform:"translate3d(-100%, 0, 0)"}),(0,T.jt)("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),(0,T.eR)("void => right-origin-center",[(0,T.oB)({transform:"translate3d(100%, 0, 0)"}),(0,T.jt)("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */let on=(()=>{class o extends Y.Pl{constructor(n,i,a,r){super(n,i,r),this._host=a,this._centeringSub=G.w.EMPTY,this._leavingSub=G.w.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe((0,ce.O)(this._host._isCenterPosition(this._host._position))).subscribe(n=>{n&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t._Vd),t.Y36(t.s_b),t.Y36((0,t.Gpc)(()=>qe)),t.Y36(p.K0))},o.\u0275dir=t.lG2({type:o,selectors:[["","matTabBodyHost",""]],features:[t.qOj]}),o})(),an=(()=>{class o{constructor(n,i,a){this._elementRef=n,this._dir=i,this._dirChangeSubscription=G.w.EMPTY,this._translateTabComplete=new te.xQ,this._onCentering=new t.vpe,this._beforeCentering=new t.vpe,this._afterLeavingCenter=new t.vpe,this._onCentered=new t.vpe(!0),this.animationDuration="500ms",i&&(this._dirChangeSubscription=i.change.subscribe(r=>{this._computePositionAnimationState(r),a.markForCheck()})),this._translateTabComplete.pipe((0,Rt.x)((r,l)=>r.fromState===l.fromState&&r.toState===l.toState)).subscribe(r=>{this._isCenterPosition(r.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(r.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(n){this._positionIndex=n,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(n){const i=this._isCenterPosition(n.toState);this._beforeCentering.emit(i),i&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(n){return"center"==n||"left-origin-center"==n||"right-origin-center"==n}_computePositionAnimationState(n=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==n?"left":"right":this._positionIndex>0?"ltr"==n?"right":"left":"center"}_computePositionFromOrigin(n){const i=this._getLayoutDirection();return"ltr"==i&&n<=0||"rtl"==i&&n>0?"left-origin-center":"right-origin-center"}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.SBq),t.Y36(D.Is,8),t.Y36(t.sBO))},o.\u0275dir=t.lG2({type:o,inputs:{animationDuration:"animationDuration",position:"position",_content:["content","_content"],origin:"origin"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),o})(),qe=(()=>{class o extends an{constructor(n,i,a){super(n,i,a)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.SBq),t.Y36(D.Is,8),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["mat-tab-body"]],viewQuery:function(n,i){if(1&n&&t.Gf(Y.Pl,5),2&n){let a;t.iGM(a=t.CRH())&&(i._portalHost=a.first)}},hostAttrs:[1,"mat-tab-body"],features:[t.qOj],decls:3,vars:6,consts:[["cdkScrollable","",1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(n,i){1&n&&(t.TgZ(0,"div",0,1),t.NdJ("@translateTab.start",function(r){return i._onTranslateTabStarted(r)})("@translateTab.done",function(r){return i._translateTabComplete.next(r)}),t.YNc(2,Jt,0,0,"ng-template",2),t.qZA()),2&n&&t.Q6J("@translateTab",t.WLB(3,Bt,i._position,t.VKq(1,Qt,i.animationDuration)))},directives:[on],styles:[".mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}\n"],encapsulation:2,data:{animation:[nn.translateTab]}}),o})();
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */const Pe=new t.OlP("MAT_TABS_CONFIG");
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */let rn=0;class sn{}const ln=(0,f.pj)((0,f.Kr)(class{constructor(o){this._elementRef=o}}),"primary");let cn=(()=>{class o extends ln{constructor(n,i,a,r){var l;super(n),this._changeDetectorRef=i,this._animationMode=r,this._tabs=new t.n_E,this._indexToSelect=0,this._tabBodyWrapperHeight=0,this._tabsSubscription=G.w.EMPTY,this._tabLabelSubscription=G.w.EMPTY,this._selectedIndex=null,this.headerPosition="above",this.selectedIndexChange=new t.vpe,this.focusChange=new t.vpe,this.animationDone=new t.vpe,this.selectedTabChange=new t.vpe(!0),this._groupId=rn++,this.animationDuration=a&&a.animationDuration?a.animationDuration:"500ms",this.disablePagination=!(!a||null==a.disablePagination)&&a.disablePagination,this.dynamicHeight=!(!a||null==a.dynamicHeight)&&a.dynamicHeight,this.contentTabIndex=null!==(l=null==a?void 0:a.contentTabIndex)&&void 0!==l?l:null}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(n){this._dynamicHeight=(0,N.Ig)(n)}get selectedIndex(){return this._selectedIndex}set selectedIndex(n){this._indexToSelect=(0,N.su)(n,null)}get animationDuration(){return this._animationDuration}set animationDuration(n){this._animationDuration=/^\d+$/.test(n)?n+"ms":n}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(n){this._contentTabIndex=(0,N.su)(n,null)}get backgroundColor(){return this._backgroundColor}set backgroundColor(n){const i=this._elementRef.nativeElement;i.classList.remove(`mat-background-${this.backgroundColor}`),n&&i.classList.add(`mat-background-${n}`),this._backgroundColor=n}ngAfterContentChecked(){const n=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=n){const i=null==this._selectedIndex;if(!i){this.selectedTabChange.emit(this._createChangeEvent(n));const a=this._tabBodyWrapper.nativeElement;a.style.minHeight=a.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((a,r)=>a.isActive=r===n),i||(this.selectedIndexChange.emit(n),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((i,a)=>{i.position=a-n,null!=this._selectedIndex&&0==i.position&&!i.origin&&(i.origin=n-this._selectedIndex)}),this._selectedIndex!==n&&(this._selectedIndex=n,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{if(this._clampTabIndex(this._indexToSelect)===this._selectedIndex){const i=this._tabs.toArray();for(let a=0;a<i.length;a++)if(i[a].isActive){this._indexToSelect=this._selectedIndex=a;break}}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe((0,ce.O)(this._allTabs)).subscribe(n=>{this._tabs.reset(n.filter(i=>i._closestTabGroup===this||!i._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}focusTab(n){const i=this._tabHeader;i&&(i.focusIndex=n)}_focusChanged(n){this.focusChange.emit(this._createChangeEvent(n))}_createChangeEvent(n){const i=new sn;return i.index=n,this._tabs&&this._tabs.length&&(i.tab=this._tabs.toArray()[n]),i}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=(0,se.T)(...this._tabs.map(n=>n._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(n){return Math.min(this._tabs.length-1,Math.max(n||0,0))}_getTabLabelId(n){return`mat-tab-label-${this._groupId}-${n}`}_getTabContentId(n){return`mat-tab-content-${this._groupId}-${n}`}_setTabBodyWrapperHeight(n){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const i=this._tabBodyWrapper.nativeElement;i.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(i.style.height=n+"px")}_removeTabBodyWrapperHeight(){const n=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=n.clientHeight,n.style.height="",this.animationDone.emit()}_handleClick(n,i,a){n.disabled||(this.selectedIndex=i.focusIndex=a)}_getTabIndex(n,i){return n.disabled?null:this.selectedIndex===i?0:-1}_tabFocusChanged(n,i){n&&"mouse"!==n&&"touch"!==n&&(this._tabHeader.focusIndex=i)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.SBq),t.Y36(t.sBO),t.Y36(Pe,8),t.Y36(k.Qb,8))},o.\u0275dir=t.lG2({type:o,inputs:{headerPosition:"headerPosition",animationDuration:"animationDuration",disablePagination:"disablePagination",dynamicHeight:"dynamicHeight",contentTabIndex:"contentTabIndex",selectedIndex:"selectedIndex",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[t.qOj]}),o})(),Le=(()=>{class o extends cn{constructor(n,i,a,r){super(n,i,a,r)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.SBq),t.Y36(t.sBO),t.Y36(Pe,8),t.Y36(k.Qb,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["mat-tab-group"]],contentQueries:function(n,i,a){if(1&n&&t.Suo(a,me,5),2&n){let r;t.iGM(r=t.CRH())&&(i._allTabs=r)}},viewQuery:function(n,i){if(1&n&&(t.Gf(jt,5),t.Gf(Ht,5)),2&n){let a;t.iGM(a=t.CRH())&&(i._tabBodyWrapper=a.first),t.iGM(a=t.CRH())&&(i._tabHeader=a.first)}},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(n,i){2&n&&t.ekj("mat-tab-group-dynamic-height",i.dynamicHeight)("mat-tab-group-inverted-header","below"===i.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[t._Bn([{provide:Oe,useExisting:o}]),t.qOj],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","disabled","matRippleDisabled","click","cdkFocusChange",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","content","position","origin","animationDuration","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","disabled","matRippleDisabled","click","cdkFocusChange"],[1,"mat-tab-label-content"],[3,"ngIf"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","content","position","origin","animationDuration","_onCentered","_onCentering"]],template:function(n,i){1&n&&(t.TgZ(0,"mat-tab-header",0,1),t.NdJ("indexFocused",function(r){return i._focusChanged(r)})("selectFocusedIndex",function(r){return i.selectedIndex=r}),t.YNc(2,Vt,4,14,"div",2),t.qZA(),t.TgZ(3,"div",3,4),t.YNc(5,zt,1,9,"mat-tab-body",5),t.qZA()),2&n&&(t.Q6J("selectedIndex",i.selectedIndex||0)("disableRipple",i.disableRipple)("disablePagination",i.disablePagination),t.xp6(2),t.Q6J("ngForOf",i._tabs),t.xp6(1),t.ekj("_mat-animation-noopable","NoopAnimations"===i._animationMode),t.xp6(2),t.Q6J("ngForOf",i._tabs))},directives:function(){return[gn,p.sg,Ne,f.wG,H.kH,p.O5,Y.Pl,qe]},styles:[".mat-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-tab-body-wrapper{transition:none;animation:none}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}\n"],encapsulation:2}),o})();
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */const dn=(0,f.Id)(class{});let Ne=(()=>{class o extends dn{constructor(n){super(),this.elementRef=n}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.SBq))},o.\u0275dir=t.lG2({type:o,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(n,i){2&n&&(t.uIk("aria-disabled",!!i.disabled),t.ekj("mat-tab-disabled",i.disabled))},inputs:{disabled:"disabled"},features:[t.qOj]}),o})();
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */const Ue=(0,U.i$)({passive:!0});let Ee=(()=>{class o{constructor(n,i,a,r,l,c,m){this._elementRef=n,this._changeDetectorRef=i,this._viewportRuler=a,this._dir=r,this._ngZone=l,this._platform=c,this._animationMode=m,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new te.xQ,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new te.xQ,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new t.vpe,this.indexFocused=new t.vpe,l.runOutsideAngular(()=>{(0,le.R)(n.nativeElement,"mouseleave").pipe((0,L.R)(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get selectedIndex(){return this._selectedIndex}set selectedIndex(n){n=(0,N.su)(n),this._selectedIndex!=n&&(this._selectedIndexChanged=!0,this._selectedIndex=n,this._keyManager&&this._keyManager.updateActiveItem(n))}ngAfterViewInit(){(0,le.R)(this._previousPaginator.nativeElement,"touchstart",Ue).pipe((0,L.R)(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),(0,le.R)(this._nextPaginator.nativeElement,"touchstart",Ue).pipe((0,L.R)(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const n=this._dir?this._dir.change:(0,St.of)("ltr"),i=this._viewportRuler.change(150),a=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new H.Em(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap(),this._keyManager.updateActiveItem(this._selectedIndex),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(a):a(),(0,se.T)(n,i,this._items.changes).pipe((0,L.R)(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>Promise.resolve().then(a)),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe((0,L.R)(this._destroyed)).subscribe(r=>{this.indexFocused.emit(r),this._setTabFocus(r)})}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(n){if(!(0,R.Vb)(n))switch(n.keyCode){case R.K5:case R.L_:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(n));break;default:this._keyManager.onKeydown(n)}}_onContentChanges(){const n=this._elementRef.nativeElement.textContent;n!==this._currentTextContent&&(this._currentTextContent=n||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(n){!this._isValidIndex(n)||this.focusIndex===n||!this._keyManager||this._keyManager.setActiveItem(n)}_isValidIndex(n){if(!this._items)return!0;const i=this._items?this._items.toArray()[n]:null;return!!i&&!i.disabled}_setTabFocus(n){if(this._showPaginationControls&&this._scrollToLabel(n),this._items&&this._items.length){this._items.toArray()[n].focus();const i=this._tabListContainer.nativeElement;i.scrollLeft="ltr"==this._getLayoutDirection()?0:i.scrollWidth-i.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const n=this.scrollDistance,i="ltr"===this._getLayoutDirection()?-n:n;this._tabList.nativeElement.style.transform=`translateX(${Math.round(i)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(n){this._scrollTo(n)}_scrollHeader(n){return this._scrollTo(this._scrollDistance+("before"==n?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(n){this._stopInterval(),this._scrollHeader(n)}_scrollToLabel(n){if(this.disablePagination)return;const i=this._items?this._items.toArray()[n]:null;if(!i)return;const a=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:r,offsetWidth:l}=i.elementRef.nativeElement;let c,m;"ltr"==this._getLayoutDirection()?(c=r,m=c+l):(m=this._tabList.nativeElement.offsetWidth-r,c=m-l);const g=this.scrollDistance,x=this.scrollDistance+a;c<g?this.scrollDistance-=g-c+60:m>x&&(this.scrollDistance+=m-x+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const n=this._tabList.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;n||(this.scrollDistance=0),n!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=n}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabList.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const n=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,i=n?n.elementRef.nativeElement:null;i?this._inkBar.alignToElement(i):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(n,i){i&&null!=i.button&&0!==i.button||(this._stopInterval(),(0,Ft.H)(650,100).pipe((0,L.R)((0,se.T)(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:a,distance:r}=this._scrollHeader(n);(0===r||r>=a)&&this._stopInterval()}))}_scrollTo(n){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const i=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(i,n)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:i,distance:this._scrollDistance}}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.SBq),t.Y36(t.sBO),t.Y36($.rL),t.Y36(D.Is,8),t.Y36(t.R0b),t.Y36(U.t4),t.Y36(k.Qb,8))},o.\u0275dir=t.lG2({type:o,inputs:{disablePagination:"disablePagination"}}),o})(),pn=(()=>{class o extends Ee{constructor(n,i,a,r,l,c,m){super(n,i,a,r,l,c,m),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=(0,N.Ig)(n)}_itemSelected(n){n.preventDefault()}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.SBq),t.Y36(t.sBO),t.Y36($.rL),t.Y36(D.Is,8),t.Y36(t.R0b),t.Y36(U.t4),t.Y36(k.Qb,8))},o.\u0275dir=t.lG2({type:o,inputs:{disableRipple:"disableRipple"},features:[t.qOj]}),o})(),gn=(()=>{class o extends pn{constructor(n,i,a,r,l,c,m){super(n,i,a,r,l,c,m)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(t.SBq),t.Y36(t.sBO),t.Y36($.rL),t.Y36(D.Is,8),t.Y36(t.R0b),t.Y36(U.t4),t.Y36(k.Qb,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["mat-tab-header"]],contentQueries:function(n,i,a){if(1&n&&t.Suo(a,Ne,4),2&n){let r;t.iGM(r=t.CRH())&&(i._items=r)}},viewQuery:function(n,i){if(1&n&&(t.Gf(ne,7),t.Gf(Ze,7),t.Gf(ye,7),t.Gf(Me,5),t.Gf(we,5)),2&n){let a;t.iGM(a=t.CRH())&&(i._inkBar=a.first),t.iGM(a=t.CRH())&&(i._tabListContainer=a.first),t.iGM(a=t.CRH())&&(i._tabList=a.first),t.iGM(a=t.CRH())&&(i._nextPaginator=a.first),t.iGM(a=t.CRH())&&(i._previousPaginator=a.first)}},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(n,i){2&n&&t.ekj("mat-tab-header-pagination-controls-enabled",i._showPaginationControls)("mat-tab-header-rtl","rtl"==i._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[t.qOj],ngContentSelectors:de,decls:13,vars:8,consts:[["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(n,i){1&n&&(t.F$t(),t.TgZ(0,"div",0,1),t.NdJ("click",function(){return i._handlePaginatorClick("before")})("mousedown",function(r){return i._handlePaginatorPress("before",r)})("touchend",function(){return i._stopInterval()}),t._UZ(2,"div",2),t.qZA(),t.TgZ(3,"div",3,4),t.NdJ("keydown",function(r){return i._handleKeydown(r)}),t.TgZ(5,"div",5,6),t.NdJ("cdkObserveContent",function(){return i._onContentChanges()}),t.TgZ(7,"div",7),t.Hsn(8),t.qZA(),t._UZ(9,"mat-ink-bar"),t.qZA(),t.qZA(),t.TgZ(10,"div",8,9),t.NdJ("mousedown",function(r){return i._handlePaginatorPress("after",r)})("click",function(){return i._handlePaginatorClick("after")})("touchend",function(){return i._stopInterval()}),t._UZ(12,"div",2),t.qZA()),2&n&&(t.ekj("mat-tab-header-pagination-disabled",i._disableScrollBefore),t.Q6J("matRippleDisabled",i._disableScrollBefore||i.disableRipple),t.xp6(5),t.ekj("_mat-animation-noopable","NoopAnimations"===i._animationMode),t.xp6(5),t.ekj("mat-tab-header-pagination-disabled",i._disableScrollAfter),t.Q6J("matRippleDisabled",i._disableScrollAfter||i.disableRipple))},directives:[f.wG,re.wD,ne],styles:['.mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:transparent;touch-action:none}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;content:"";height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-ink-bar{transition:none;animation:none}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}._mat-animation-noopable.mat-tab-list{transition:none;animation:none}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}\n'],encapsulation:2}),o})();
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
var vn=d(620);function Cn(o,s){1&o&&(t.TgZ(0,"div",17),t._uU(1," Options Available "),t.qZA())}function Tn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"a-counter",18),t.NdJ("ngModelChange",function(a){t.CHM(n);const r=t.oxw().$implicit;return t.oxw(5).updateItemQuantity(r,a)}),t.qZA()}if(2&o){const n=t.oxw().$implicit;t.Q6J("ngModel",n.quantity)}}function xn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",19),t.TgZ(1,"div",20),t.TgZ(2,"button",21),t.TgZ(3,"app-icon"),t._uU(4,"remove"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"button",23),t.NdJ("click",function(){t.CHM(n);const a=t.oxw().$implicit;return t.oxw(5).addItem(a)}),t.TgZ(8,"app-icon"),t._uU(9,"add"),t.qZA(),t.qZA(),t.qZA()}if(2&o){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",n.quantity?"Items with options must be removed from order confirmation page":""),t.xp6(1),t.Q6J("disabled",!0),t.xp6(4),t.hij(" ",n.quantity," ")}}function Zn(o,s){if(1&o&&(t.TgZ(0,"div",11),t.TgZ(1,"div",12),t.TgZ(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,Cn,2,0,"div",13),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.YNc(8,Tn,1,1,"a-counter",15),t.YNc(9,xn,10,3,"div",16),t.qZA()),2&o){const n=s.$implicit;t.xp6(3),t.hij(" ",n.name," "),t.xp6(1),t.Q6J("ngIf",n.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,5,n.unit_price/100)," "),t.xp6(2),t.Q6J("ngIf",!n.options.length),t.xp6(1),t.Q6J("ngIf",n.options.length)}}const Fe=function(){return{}};function yn(o,s){if(1&o&&(t.TgZ(0,"mat-tab",8),t.TgZ(1,"div",9),t.YNc(2,Zn,10,7,"div",10),t.qZA(),t.qZA()),2&o){const n=t.oxw().$implicit,i=t.oxw(3);t.Q6J("label",n),t.xp6(2),t.Q6J("ngForOf",(i.menu_items||t.DdM(2,Fe))[n])}}function Mn(o,s){if(1&o&&(t.ynx(0),t.YNc(1,yn,3,3,"mat-tab",7),t.BQk()),2&o){const n=s.$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("ngIf",(i.menu_items||t.DdM(1,Fe))[n].length)}}function wn(o,s){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-tab-group"),t.YNc(2,Mn,2,2,"ng-container",6),t.qZA(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",n.categories)}}function An(o,s){if(1&o&&(t.TgZ(0,"div",4),t.YNc(1,wn,3,1,"ng-container",5),t.qZA()),2&o){const n=t.oxw(),i=t.MAs(5);t.xp6(1),t.Q6J("ngIf",!n.show_order_details)("ngIfElse",i)}}function In(o,s){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",26),t._uU(2," Cancel "),t.qZA(),t.TgZ(3,"button",27),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).show_order_details=!0}),t._uU(4," Confirm "),t.qZA(),t.BQk()}if(2&o){const n=t.oxw(2);t.xp6(3),t.Q6J("disabled",!n.order.item_count)("matBadge",n.order.item_count)("matBadgeHidden",!n.order.item_count)}}function kn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).show_order_details=!1}),t._uU(1," Back "),t.qZA(),t.TgZ(2,"button",29),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).saveOrder()}),t._uU(3," Save Order "),t.qZA()}}function On(o,s){if(1&o&&(t.TgZ(0,"footer",24),t.YNc(1,In,5,3,"ng-container",5),t.YNc(2,kn,4,0,"ng-template",null,25,t.W1O),t.qZA()),2&o){const n=t.MAs(3),i=t.oxw();t.xp6(1),t.Q6J("ngIf",!i.show_order_details)("ngIfElse",n)}}function qn(o,s){if(1&o&&(t.TgZ(0,"div",30),t._UZ(1,"mat-spinner",31),t.TgZ(2,"p"),t._uU(3),t.qZA(),t.qZA()),2&o){const n=t.oxw();t.xp6(3),t.Oqu(n.loading)}}function Pn(o,s){if(1&o&&(t.TgZ(0,"div",37),t._uU(1),t.qZA()),2&o){const n=t.oxw().$implicit,i=t.oxw(2);t.Q6J("matTooltip",i.optionsFor(n)),t.xp6(1),t.AsE(" ",n.options.length," option",1===n.options.length?"":"s"," selected ")}}function Ln(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"div",34),t.TgZ(1,"div",12),t.TgZ(2,"div",12),t._uU(3),t.qZA(),t.YNc(4,Pn,2,3,"div",35),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"a-counter",36),t.NdJ("ngModelChange",function(a){const l=t.CHM(n).$implicit;return t.oxw(2).updateItemQuantity(l,a)}),t.qZA(),t.qZA()}if(2&o){const n=s.$implicit;t.xp6(3),t.Oqu(n.name),t.xp6(1),t.Q6J("ngIf",n.options.length),t.xp6(2),t.hij(" ",t.lcZ(7,4,n.total_cost/100)," "),t.xp6(2),t.Q6J("ngModel",n.quantity)}}function Nn(o,s){if(1&o&&(t.TgZ(0,"header",32),t.TgZ(1,"h3"),t._uU(2,"Confirm Order"),t.qZA(),t.qZA(),t.TgZ(3,"div",9),t.YNc(4,Ln,9,6,"div",33),t.qZA()),2&o){const n=t.oxw();t.xp6(4),t.Q6J("ngForOf",n.order.items)}}function Un(o,s,n){var i;let a=!0;for(const r of s)if(o.category===r.name||o.tags.includes(r.name)||(null===(i=n.space)||void 0===i?void 0:i.zones.includes(r.name))||"*"===r.name){let l=0;for(const c of r.rules){const m=new Date(n.date);switch(c[0]){case"after_hour":l+=(0,Dt.Z)(m,(0,Te.Z)(m,c[1]))?1:0;break;case"before_hour":l+=(0,Et.Z)(m,(0,Te.Z)(m,c[1]))?1:0;break;case"min_length":l+=n.duration>=(0,xe.H1)(c[1])?1:0;break;case"max_length":l+=n.duration<=(0,xe.H1)(c[1])?1:0;break;case"visitor_type":l+=n.ext("visitor_type")===c[1]?1:0;break;default:l++}}a=l>=r.rules.length}return a}let Re=(()=>{class o extends _.KG{constructor(n){super(),this._data=n,this.event=new t.vpe,this.loading="",this.menu_items={},this.categories=[],this.loading="Loading menu..."}ngOnInit(){var n,i,a;return(0,h.mG)(this,void 0,void 0,function*(){this.loading="Loading menu...",this.order=new I.G(this._data.order),this.rules=yield this._data.getCateringConfig(null===(a=null===(i=null===(n=this.order.event)||void 0===n?void 0:n.space)||void 0===i?void 0:i.level)||void 0===a?void 0:a.parent_id),this._data.menu.subscribe(r=>{this.loading="Loading menu...";const l=(0,_.Tw)(r.map(m=>m.category)),c={};for(const m of l)c[m]=r.filter(g=>g.category===m&&Un(g,this.rules,this.order.event));this.categories=l,this.menu_items=c,this.updateMenuQuantities(),this.timeout("clear_loading",()=>this.loading="",1e3)})})}addItem(n,i=!0){var a;const r=this.order.items.find(l=>l.id===n.id&&l.options.length===l.options.reduce((c,m)=>c+(n.options.find(g=>m.id===g.id)?1:0),0));i&&(null===(a=n.options)||void 0===a?void 0:a.length)?this._data.selectOptions(n.options).then(l=>{const c=new M.U(Object.assign(Object.assign({},n),{options:l}));this.addItem(c,!1)}):this.order=new I.G(Object.assign(Object.assign({},this.order),r?{items:this.order.items.filter(l=>!(l.id===n.id&&l.options_string===n.options_string)).concat([new M.U(Object.assign(Object.assign({},n),{quantity:r.quantity+1}))])}:{items:this.order.items.concat([new M.U(Object.assign(Object.assign({},n),{quantity:1}))])})),this.updateMenuQuantities()}removeItem(n){this.order=new I.G(Object.assign(Object.assign({},this.order),{items:this.order.items.filter(i=>i.id!==n.id&&i.options_string===n.options_string)})),this.updateMenuQuantities()}updateItemQuantity(n,i){const a=this.order.items.find(l=>l.id===n.id&&l.options_string===n.options_string);let r=[...this.order.items];r=a?this.order.items.filter(l=>!(l.id===n.id&&l.options_string===n.options_string)).concat([new M.U(Object.assign(Object.assign({},n),{quantity:i}))]):this.order.items.concat([new M.U(Object.assign(Object.assign({},n),{quantity:i}))]),r.sort((l,c)=>l.name.localeCompare(c.name)),this.order=new I.G(Object.assign(Object.assign({},this.order),{items:r})),this.updateMenuQuantities()}updateMenuQuantities(){for(const n in this.menu_items)for(const i of this.menu_items[n])i.quantity=this.order.items.reduce((a,r)=>r.id===i.id?a+r.quantity:a,0)}optionsFor(n){return n.options.map(i=>i.name).join("\n")}saveOrder(){this.event.emit({reason:"done",metadata:{order:this.order}})}confirmOrder(){this.show_order_details=!0}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(y.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[t.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],["class","flex items-center justify-center space-x-2 p-2 border-t border-gray-200",4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-200",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-200"],[1,"flex-1","w-1/2"],["class","text-xs no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["ngDefaultControl","",3,"ngModel","ngModelChange",4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-xs","no-underline"],["ngDefaultControl","",3,"ngModel","ngModelChange"],[1,"flex","items-center"],[3,"matTooltip"],["mat-icon-button","",3,"disabled"],[1,"count","h-12","w-12","flex","items-center","justify-center"],["mat-icon-button","",3,"click"],[1,"flex","items-center","justify-center","space-x-2","p-2","border-t","border-gray-200"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(n,i){if(1&n&&(t.YNc(0,An,2,2,"div",0),t.YNc(1,On,4,2,"footer",1),t.YNc(2,qn,4,1,"ng-template",null,2,t.W1O),t.YNc(4,Nn,5,1,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(3);t.Q6J("ngIf",!i.loading)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!i.loading)}},directives:[p.O5,Le,p.sg,me,fe.R,u.Fj,u.JJ,u.On,vn.gM,b.lW,C.o,y.ZT,F.$g],pipes:[p.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:32em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:12em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border:none;border-radius:0!important;border-top:1px solid #ccc;border-bottom:1px solid #ccc;outline:none;font-size:1em;&:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}&.error::placeholder{color:rgba(var(--error),.45)}}"]}),o})();var ie=d(9673);function Dn(o,s){if(1&o&&(t.TgZ(0,"div",18),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const n=t.oxw().$implicit;t.xp6(1),t.hij(" +",t.lcZ(2,1,n.unit_price/100)," ")}}function En(o,s){if(1&o&&(t.TgZ(0,"mat-radio-button",14),t.TgZ(1,"div",15),t.TgZ(2,"div",16),t._uU(3),t.qZA(),t.YNc(4,Dn,3,3,"div",17),t.qZA(),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n.id),t.xp6(3),t.hij(" ",n.name," "),t.xp6(1),t.Q6J("ngIf",n.unit_price)}}function Sn(o,s){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"mat-radio-group",10),t.NdJ("ngModelChange",function(a){t.CHM(n);const r=t.oxw().$implicit;return t.oxw().updateGroupOption(r,a)}),t.TgZ(2,"mat-radio-button",11),t.TgZ(3,"span",12),t._uU(4,"None"),t.qZA(),t.qZA(),t.YNc(5,En,5,3,"mat-radio-button",13),t.qZA(),t.BQk()}if(2&o){const n=t.oxw().$implicit;t.xp6(5),t.Q6J("ngForOf",null==n?null:n.options)}}function Fn(o,s){if(1&o&&(t.TgZ(0,"div",18),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const n=t.oxw().$implicit;t.xp6(1),t.hij(" +",t.lcZ(2,1,n.unit_price/100)," ")}}function Rn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"mat-checkbox",20),t.NdJ("ngModelChange",function(a){const l=t.CHM(n).$implicit;return t.oxw(3).option_state[l.id]=a}),t.TgZ(1,"div",15),t.TgZ(2,"div",16),t._uU(3),t.qZA(),t.YNc(4,Fn,3,3,"div",17),t.qZA(),t.qZA()}if(2&o){const n=s.$implicit,i=t.oxw(3);t.Q6J("ngModel",i.option_state[n.id]),t.xp6(3),t.hij(" ",n.name," "),t.xp6(1),t.Q6J("ngIf",n.unit_price)}}function Yn(o,s){if(1&o&&t.YNc(0,Rn,5,3,"mat-checkbox",19),2&o){const n=t.oxw().$implicit;t.Q6J("ngForOf",null==n?null:n.options)}}function Jn(o,s){if(1&o&&(t.TgZ(0,"div",5),t.TgZ(1,"div",6),t._uU(2),t.qZA(),t.TgZ(3,"div",7),t.YNc(4,Sn,6,1,"ng-container",8),t.YNc(5,Yn,1,1,"ng-template",null,9,t.W1O),t.qZA(),t.qZA()),2&o){const n=s.$implicit,i=t.MAs(6);t.uIk("group",n.name),t.xp6(2),t.Oqu(n.name),t.xp6(2),t.Q6J("ngIf",!n.multiple)("ngIfElse",i)}}let Ye=(()=>{class o{constructor(n){this._data=n,this.event=new t.vpe,this.option_state={};const i=(0,ve.Tw)(this._data.options.map(r=>r.group||"Other")),a=[];for(const r of i){const l=this._data.options.filter(c=>c.group===r);a.push({name:r,multiple:!!l.find(c=>c.multiple),options:l})}this.groups=a}updateGroupOption(n,i){for(const a of n.options)this.option_state[a.id]=a.id===i}saveOptions(){const n=this._data.options.filter(i=>this.option_state[i.id]);this.event.emit({reason:"done",metadata:{options:n}})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(y.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"p-2"],["mat-button","",1,"w-32",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2","capitalize"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],[1,"font-medium","p-2"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(n,i){1&n&&(t.TgZ(0,"header"),t.TgZ(1,"h3"),t._uU(2,"Select options"),t.qZA(),t.TgZ(3,"button",0),t.TgZ(4,"app-icon"),t._uU(5,"close"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"main",1),t.YNc(7,Jn,7,4,"div",2),t.qZA(),t.TgZ(8,"footer",3),t.TgZ(9,"button",4),t.NdJ("click",function(){return i.saveOptions()}),t._uU(10," Save "),t.qZA(),t.qZA()),2&n&&(t.xp6(7),t.Q6J("ngForOf",i.groups))},directives:[b.lW,y.ZT,C.o,p.sg,p.O5,ie.VQ,u.JJ,u.On,ie.U0,ae.oG],pipes:[p.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em;width:24rem;max-width:calc(100vw - 2rem)}"]}),o})();function Qn(o,s){1&o&&(t.TgZ(0,"button",4),t.TgZ(1,"app-icon"),t._uU(2,"close"),t.qZA(),t.qZA())}function Bn(o,s){if(1&o){const n=t.EpF();t.TgZ(0,"main"),t.TgZ(1,"div",5),t.TgZ(2,"app-icon",6),t._uU(3,"upload"),t.qZA(),t.TgZ(4,"p"),t._uU(5,"Click to select file or Drag and drop files"),t.qZA(),t.TgZ(6,"input",7),t.NdJ("change",function(a){return t.CHM(n),t.oxw().handleFileEvent(a)}),t.qZA(),t.qZA(),t.TgZ(7,"div",8),t.TgZ(8,"button",9),t.NdJ("click",function(){return t.CHM(n),t.oxw().downloadTemplate()}),t._uU(9," Download Template "),t.qZA(),t.qZA(),t.qZA()}}function jn(o,s){if(1&o&&(t.TgZ(0,"main",10),t._UZ(1,"mat-spinner",11),t.TgZ(2,"p"),t._uU(3),t.qZA(),t.qZA()),2&o){const n=t.oxw();t.xp6(3),t.Oqu(n.loading)}}let Je=(()=>{class o{constructor(){this.event=new t.vpe}handleFileEvent(n){this.loading="Processing menu data...";const i=n.target;if(!(null==i?void 0:i.files))return this.loading="";const a=i.files;if(!a.length)return this.loading="";const r=a[0],l=new FileReader;l.addEventListener("loadend",c=>{const g=(0,_.n5)(c.target.result);this.loading="",this.event.emit({reason:"done",metadata:g.filter(x=>"item"===(x.type||"").toLowerCase()).map(x=>new M.U(Object.assign(Object.assign({},x),{options:g.filter(Z=>"option"===(Z.type||"").toLowerCase()&&Z.tags===x.id).map(Z=>({id:Z.id,name:Z.name,group:Z.category,multiple:Z.multiple,unit_price:Z.unit_price}))})))})}),l.readAsText(r)}downloadTemplate(){(0,_.Sv)("import-menu-template.csv","ID,Type,Name,Unit Price,Category,Description,Tags,Multiple\nitem-1,item,Coffee,200,Drink,Wake Up,,\noption-1,option,1 Sugar,20,Sugars,,item-1,false")}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["catering-import-menu-modal"]],outputs:{event:"event"},decls:7,vars:3,consts:[[1,"h-12","bg-primary","flex","items-center","justify-between","px-4"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[1,"relative","flex","flex-col","items-center","justify-center","space-y-2","h-[24rem]","w-[24rem]","border-4","border-gray-200","border-dashed","rounded-xl","hover:bg-gray-100","m-4","p-4","cursor-pointer"],[1,"text-4xl"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"],[1,"flex","items-center","justify-center","px-4","pb-4"],["mat-button","",1,"clear","underline","w-48",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","h-[24rem]","w-[24rem]"],["diameter","32"]],template:function(n,i){if(1&n&&(t.TgZ(0,"header",0),t.TgZ(1,"h2"),t._uU(2,"Import Catering Menu"),t.qZA(),t.YNc(3,Qn,3,0,"button",1),t.qZA(),t.YNc(4,Bn,10,0,"main",2),t.YNc(5,jn,4,1,"ng-template",null,3,t.W1O)),2&n){const a=t.MAs(6);t.xp6(3),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",!i.loading)("ngIfElse",a)}},directives:[p.O5,b.lW,y.ZT,C.o,F.$g],styles:[""]}),o})(),ue=(()=>{class o extends _.KG{constructor(n,i){super(),this._org=n,this._dialog=i,this._menu=new w.X([]),this._loading=new w.X(!1),this._currency=new w.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(a=>(0,h.mG)(this,void 0,void 0,function*(){if(a){const r=(yield this.getCateringForZone(a.id)).map(l=>new M.U(l));this._currency.next(a.currency||"USD"),this._menu.next(r)}})))}get categories(){const n=this._menu.getValue();return(0,_.Tw)(n.map(i=>i.category))}manageCateringOrder(n){var i;return(0,h.mG)(this,void 0,void 0,function*(){const a=this._dialog.open(Re,{data:{order:n,menu:this.menu,loading:this.loading,getCateringConfig:l=>this.getCateringConfig(l),selectOptions:l=>this.selectOptions(l)}}),r=yield Promise.race([a.componentInstance.event.pipe((0,q.P)(l=>"done"===l.reason)).toPromise(),a.afterClosed().toPromise()]);return a.close(),(null===(i=null==r?void 0:r.metadata)||void 0===i?void 0:i.order)||n})}addItem(n=new M.U){return(0,h.mG)(this,void 0,void 0,function*(){const i=this._dialog.open(be,{data:{item:n,categories:this.categories}}),a=yield Promise.race([i.componentInstance.event.pipe((0,q.P)(c=>"done"===c.reason)).toPromise(),i.afterClosed().toPromise()]);if("done"!==(null==a?void 0:a.reason))return;const r=this._menu.getValue(),l=r.findIndex(c=>c.id===n.id);l>=0?r.splice(l,1,a.metadata.item):r.push(a.metadata.item),this.updateMenu(this._org.building.id,r).then(()=>{this._menu.next([...r]),i.close()},()=>i.componentInstance.loading=!1)})}addOption(n,i={}){return(0,h.mG)(this,void 0,void 0,function*(){const a=(0,_.Tw)(n.options.map(g=>g.group)),r=this._dialog.open(Ce,{data:{parent:n,option:i,types:a}}),l=yield Promise.race([r.componentInstance.event.pipe((0,q.P)(g=>"done"===g.reason)).toPromise(),r.afterClosed().toPromise()]);if("done"!==(null==l?void 0:l.reason))return;const c=this._menu.getValue(),m=c.findIndex(g=>g.id===n.id);m>=0?c.splice(m,1,l.metadata.item):c.push(l.metadata.item),this.updateMenu(this._org.building.id,c).then(()=>{this._menu.next([...c]),r.close()},()=>r.componentInstance.loading=!1)})}selectOptions(n){return(0,h.mG)(this,void 0,void 0,function*(){const i=this._dialog.open(Ye,{data:{options:n}}),a=yield Promise.race([i.componentInstance.event.pipe((0,q.P)(r=>"done"===r.reason)).toPromise(),i.afterClosed().toPromise()]);return"done"!==(null==a?void 0:a.reason)?[]:(i.close(),a.metadata.options)})}deleteItem(n){return(0,h.mG)(this,void 0,void 0,function*(){const i=yield(0,_._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${n.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==i.reason)return;i.loading("Removing catering item...");const a=this._menu.getValue().filter(r=>n.id!==r.id);this.updateMenu(this._org.building.id,a).then(()=>{this._menu.next([...a]),i.close()},()=>i.loading(""))})}deleteOption(n,i){return(0,h.mG)(this,void 0,void 0,function*(){const a=yield(0,_._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${i.name}" from "${n.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==a.reason)return;a.loading("Removing catering item option...");const r=this._menu.getValue();r.splice(r.findIndex(l=>l.id===n.id),1,new M.U(Object.assign(Object.assign({},n),{options:n.options.filter(l=>l.id!==i.id)}))),this.updateMenu(this._org.building.id,r).then(()=>{this._menu.next([...r]),a.close()},()=>a.loading(""))})}editConfig(){return(0,h.mG)(this,void 0,void 0,function*(){const n=yield this.getCateringConfig(this._org.building.id),i=this._menu.getValue(),a=(0,_.Tw)((0,_.xH)(i.map(c=>[c.category,...c.tags]))),r=this._dialog.open(he,{data:{config:n,types:a}}),l=yield Promise.race([r.componentInstance.event.pipe((0,q.P)(c=>"done"===c.reason)).toPromise(),r.afterClosed().toPromise()]);"done"===(null==l?void 0:l.reason)&&this.updateConfig(this._org.building.id,l.metadata).then(()=>r.close(),()=>r.componentInstance.loading=!1)})}importMenu(){return(0,h.mG)(this,void 0,void 0,function*(){const n=this._dialog.open(Je),i=yield Promise.race([n.componentInstance.event.pipe((0,q.P)(c=>"done"===c.reason)).toPromise(),n.afterClosed().toPromise()]);if("done"!==(null==i?void 0:i.reason))return;n.componentInstance.loading="Updating menu...";const a=this._menu.getValue(),r=this._org.building,l=(0,_.Tw)(i.metadata.concat(a),"id");yield this.updateMenu(r.id,l).catch(c=>{throw(0,_.cB)("Error importing catering menu"),n.close(),c}),(0,_.t5)(`Successfully imported catering menu. ${i.metadata.length} item(s) added.`),n.close()})}updateMenu(n,i){return(0,B.Ymr)(n,{id:n,name:"catering",details:i,description:`Catering menu for ${n}`}).toPromise()}getCateringForZone(n){return(0,h.mG)(this,void 0,void 0,function*(){const i=(yield(0,B.rlq)(n,"catering").toPromise()).details;return i instanceof Array?i:[]})}getCateringConfig(n=this._org.building.id){return(0,h.mG)(this,void 0,void 0,function*(){const i=(yield(0,B.rlq)(n,"catering_config").toPromise()).details;return i instanceof Array?i:[]})}updateConfig(n,i){return(0,B.Ymr)(n,{id:n,name:"catering_config",details:i,description:`Catering menu config for ${n}`}).toPromise()}addItemToOrder(n,i){let a=n.items;const r=a.find(c=>{var m,g;return c.id===i.id&&(null===(m=i.options)||void 0===m?void 0:m.length)===(null===(g=c.options)||void 0===g?void 0:g.reduce((x,Z)=>x+(i.options.find(E=>Z.id===E.id)?1:0),0))});return r?r.quantity+=1:a=a.concat([new M.U(Object.assign(Object.assign({},i),{quantity:1}))]),new I.G(Object.assign(Object.assign({},n),{items:a,event:null}))}}return o.\u0275fac=function(n){return new(n||o)(t.LFG(wt.w7),t.LFG(y.uw))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();d(7227);var oe=d(3927);function Ci(o,s){if(1&o&&(t.TgZ(0,"mat-option",8),t._uU(1),t.qZA()),2&o){const n=s.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n.name," ")}}d(9097),d(639),d(9902),d(8636),d(2597),d(1361),d(6186),d(8703),d(4211),d(3902);const Ti=function(){return["/welcome"]};let xi=(()=>{class o{constructor(n,i,a){this._router=n,this._checkin=i,this._catering=a,this.menu=this._catering.menu.pipe((0,oe.U)(r=>r.filter(l=>l.tags.find(c=>"drink"===c.toLowerCase()))))}update(){var n;return(0,h.mG)(this,void 0,void 0,function*(){if(!this.beverage)return this.next();const i=yield this._checkin.event.pipe((0,q.P)(r=>!!r)).toPromise();if(!i)return(0,_.cB)("Unable to load event data.");const a=(i.ext("catering")?i.ext("catering")[0]:null)||new I.G;yield(0,z.eJ)(i.id,new z.ym(Object.assign(Object.assign({},i),{extension_data:Object.assign(Object.assign({},i.extension_data),{catering:[...(null===(n=i.extension_data.catering)||void 0===n?void 0:n.filter(r=>r.id!==a.id))||[],new I.G(Object.assign(Object.assign({},a),{items:[...a.items,new M.U(Object.assign(Object.assign({},this.beverage),{quantity:1}))]}))]})}))).toPromise(),(0,_.t5)("Successfully update event."),this.next()})}next(){this._router.navigate(["/welcome"])}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(v.F0),t.Y36(P),t.Y36(ue))},o.\u0275cmp=t.Xpm({type:o,selectors:[["checkin-preferences"]],decls:13,vars:7,consts:[[1,"bg-white","rounded","shadow","overflow-hidden","relative","flex","flex-col","items-center","my-4","p-4","mx-auto"],[1,"text-xl","mb-2","w-full"],[1,"w-full"],["appearance","outline",1,"w-full"],["placeholder","Select beverage",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-button","",1,"w-32",3,"click"],["mat-icon-button","",1,"absolute","top-0","right-0",3,"routerLink"],[3,"value"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"h3",1),t._uU(2,"Would you like a drink?"),t.qZA(),t.TgZ(3,"div",2),t.TgZ(4,"mat-form-field",3),t.TgZ(5,"mat-select",4),t.NdJ("ngModelChange",function(r){return i.beverage=r}),t.YNc(6,Ci,2,2,"mat-option",5),t.ALo(7,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){return i.update()}),t._uU(9),t.qZA(),t.TgZ(10,"a",7),t.TgZ(11,"app-icon"),t._uU(12,"close"),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(5),t.Q6J("ngModel",i.beverage),t.xp6(1),t.Q6J("ngForOf",t.lcZ(7,4,i.menu)),t.xp6(3),t.hij(" ",i.beverage?"Update":"Continue"," "),t.xp6(1),t.Q6J("routerLink",t.DdM(6,Ti)))},directives:[A.KE,_e.gD,u.JJ,u.On,p.sg,b.lW,b.zs,v.yS,C.o,f.ey],pipes:[p.Ov],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem)}"]}),o})(),We=(()=>{class o{static hasCamera(){return o.listCameras(!1).then(n=>!!n.length).catch(()=>!1)}static listCameras(n=!1){if(!navigator.mediaDevices)return Promise.resolve([]);let i=null;return(n?navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(a=>i=a).catch(()=>{}):Promise.resolve()).then(()=>navigator.mediaDevices.enumerateDevices()).then(a=>a.filter(r=>"videoinput"===r.kind).map((r,l)=>({id:r.deviceId,label:r.label||(0===l?"Default Camera":`Camera ${l+1}`)}))).finally(()=>{if(i)for(const a of i.getTracks())a.stop(),i.removeTrack(a)})}constructor(n,i,a=this._onDecodeError,r=this._calculateScanRegion,l="environment"){this.$video=n,this.$canvas=document.createElement("canvas"),this._onDecode=i,this._legacyCanvasSize=o.DEFAULT_CANVAS_SIZE,this._preferredCamera=l,this._active=!1,this._paused=!1,this._flashOn=!1,"number"==typeof a?(this._legacyCanvasSize=a,console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future")):this._onDecodeError=a,"number"==typeof r?(this._legacyCanvasSize=r,console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future")):this._calculateScanRegion=r,this._scanRegion=this._calculateScanRegion(n),this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),n.disablePictureInPicture=!0,n.playsInline=!0,n.muted=!0;let c=!1;n.hidden&&(n.hidden=!1,c=!0),document.body.contains(n)||(document.body.appendChild(n),c=!0),requestAnimationFrame(()=>{const m=window.getComputedStyle(n);"none"===m.display&&(n.style.setProperty("display","block","important"),c=!0),"visible"!==m.visibility&&(n.style.setProperty("visibility","visible","important"),c=!0),c&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),n.style.opacity=0,n.style.width=0,n.style.height=0)}),n.addEventListener("play",this._onPlay),n.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),this._qrEnginePromise=o.createQrEngine()}hasFlash(){let n=null;return(this.$video.srcObject?Promise.resolve(this.$video.srcObject.getVideoTracks()[0]):this._getCameraStream().then(({stream:i})=>(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),n=i,i.getVideoTracks()[0]))).then(i=>"torch"in i.getSettings()).catch(()=>!1).finally(()=>{if(n)for(const i of n.getTracks())i.stop(),n.removeTrack(i)})}isFlashOn(){return this._flashOn}toggleFlash(){return this._flashOn?this.turnFlashOff():this.turnFlashOn()}turnFlashOn(){return this._flashOn||(this._flashOn=!0,!this._active||this._paused)?Promise.resolve():this.hasFlash().then(n=>n?this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]}):Promise.reject("No flash available")).catch(()=>{throw this._flashOn=!1,e})}turnFlashOff(){if(this._flashOn)return this._flashOn=!1,this._restartVideoStream()}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),this.stop(),o._postWorkerMessage(this._qrEnginePromise,"close")}start(){return this._active&&!this._paused||("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,document.hidden)?Promise.resolve():(this._paused=!1,this.$video.srcObject?(this.$video.play(),Promise.resolve()):this._getCameraStream().then(({stream:n,facingMode:i})=>{this.$video.srcObject=n,this.$video.play(),this._setVideoMirror(i),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{}))}).catch(n=>{throw this._active=!1,n}))}stop(){this.pause(),this._active=!1}pause(n=!1){if(this._paused=!0,!this._active)return Promise.resolve(!0);this.$video.pause();const i=()=>{const a=this.$video.srcObject?this.$video.srcObject.getTracks():[];for(const r of a)r.stop(),this.$video.srcObject.removeTrack(r);this.$video.srcObject=null};return n?(i(),Promise.resolve(!0)):new Promise(a=>setTimeout(a,300)).then(()=>!!this._paused&&(i(),!0))}setCamera(n){return n===this._preferredCamera?Promise.resolve():(this._preferredCamera=n,this._restartVideoStream())}static scanImage(n,i=null,a=null,r=null,l=!1,c=!1){const m=a instanceof Worker;let g=Promise.all([a||o.createQrEngine(),o._loadImage(n)]).then(([x,Z])=>{let E;return a=x,[r,E]=this._drawToCanvas(Z,i,r,l),a instanceof Worker?(m||a.postMessage({type:"inversionMode",data:"both"}),new Promise((pe,Q)=>{let W,O,V;O=S=>{"qrResult"===S.data.type&&(a.removeEventListener("message",O),a.removeEventListener("error",V),clearTimeout(W),null!==S.data.data?pe(S.data.data):Q(o.NO_QR_CODE_FOUND))},V=S=>{a.removeEventListener("message",O),a.removeEventListener("error",V),clearTimeout(W),Q("Scanner error: "+(S?S.message||S:"Unknown Error"))},a.addEventListener("message",O),a.addEventListener("error",V),W=setTimeout(()=>V("timeout"),1e4);const Ve=E.getImageData(0,0,r.width,r.height);a.postMessage({type:"decode",data:Ve},[Ve.data.buffer])})):new Promise((pe,Q)=>{const W=setTimeout(()=>Q("Scanner error: timeout"),1e4);a.detect(r).then(O=>{O.length?pe(O[0].rawValue):Q(o.NO_QR_CODE_FOUND)}).catch(O=>Q("Scanner error: "+(O.message||O))).finally(()=>clearTimeout(W))})});return i&&c&&(g=g.catch(()=>o.scanImage(n,null,a,r,l))),g=g.finally(()=>{m||o._postWorkerMessage(a,"close")}),g}setGrayscaleWeights(n,i,a,r=!0){o._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:n,green:i,blue:a,useIntegerApproximation:r})}setInversionMode(n){o._postWorkerMessage(this._qrEnginePromise,"inversionMode",n)}static createQrEngine(n=o.WORKER_PATH){return("BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats?BarcodeDetector.getSupportedFormats():Promise.resolve([])).then(i=>-1!==i.indexOf("qr_code")?new BarcodeDetector({formats:["qr_code"]}):new Worker(n))}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video)}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(n){const i=Math.min(n.videoWidth,n.videoHeight),a=Math.round(2/3*i);return{x:Math.round((n.videoWidth-a)/2),y:Math.round((n.videoHeight-a)/2),width:a,height:a,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_scanFrame(){if(!this._active||this.$video.paused||this.$video.ended)return!1;requestAnimationFrame(()=>{this.$video.readyState<=1?this._scanFrame():this._qrEnginePromise.then(n=>o.scanImage(this.$video,this._scanRegion,n,this.$canvas)).then(this._onDecode,n=>{this._active&&(-1!==(n.message||n).indexOf("service unavailable")&&(this._qrEnginePromise=o.createQrEngine()),this._onDecodeError(n))}).then(()=>this._scanFrame())})}_onDecodeError(n){n!==o.NO_QR_CODE_FOUND&&console.log(n)}_getCameraStream(){if(!navigator.mediaDevices)return Promise.reject("Camera not found.");const n="environment"===this._preferredCamera||"user"===this._preferredCamera?"facingMode":"deviceId",i=[{width:{min:1024}},{width:{min:768}},{}];return[...i.map(r=>Object.assign({},r,{[n]:{exact:this._preferredCamera}})),...i].reduceRight((r,l)=>()=>navigator.mediaDevices.getUserMedia({video:l,audio:!1}).then(c=>({stream:c,facingMode:this._getFacingMode(c)||(l.facingMode?this._preferredCamera:"environment"===this._preferredCamera?"user":"environment")})).catch(r),()=>Promise.reject("Camera not found."))()}_restartVideoStream(){const n=this._paused;return this.pause(!0).then(i=>{if(i&&!n&&this._active)return this.start()})}_setVideoMirror(n){this.$video.style.transform="scaleX("+("user"===n?-1:1)+")"}_getFacingMode(n){const i=n.getVideoTracks()[0];return i?/rear|back|environment/i.test(i.label)?"environment":/front|user|face/i.test(i.label)?"user":null:null}static _drawToCanvas(n,i=null,a=null,r=!1){a=a||document.createElement("canvas");const l=i&&i.x?i.x:0,c=i&&i.y?i.y:0,m=i&&i.width?i.width:n.width||n.videoWidth,g=i&&i.height?i.height:n.height||n.videoHeight;if(!r){const Z=i&&i.downScaledWidth?i.downScaledWidth:m,E=i&&i.downScaledHeight?i.downScaledHeight:g;a.width!==Z&&(a.width=Z),a.height!==E&&(a.height=E)}const x=a.getContext("2d",{alpha:!1});return x.imageSmoothingEnabled=!1,x.drawImage(n,l,c,m,g,0,0,a.width,a.height),[a,x]}static _loadImage(n){if(n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||window.ImageBitmap&&n instanceof window.ImageBitmap||window.OffscreenCanvas&&n instanceof window.OffscreenCanvas)return Promise.resolve(n);if(n instanceof Image)return o._awaitImageLoad(n).then(()=>n);if(n instanceof File||n instanceof Blob||n instanceof URL||"string"==typeof n){const i=new Image;return i.src=n instanceof File||n instanceof Blob?URL.createObjectURL(n):n,o._awaitImageLoad(i).then(()=>((n instanceof File||n instanceof Blob)&&URL.revokeObjectURL(i.src),i))}return Promise.reject("Unsupported image type.")}static _awaitImageLoad(n){return new Promise((i,a)=>{if(n.complete&&0!==n.naturalWidth)i();else{let r,l;r=()=>{n.removeEventListener("load",r),n.removeEventListener("error",l),i()},l=()=>{n.removeEventListener("load",r),n.removeEventListener("error",l),a("Image load error")},n.addEventListener("load",r),n.addEventListener("error",l)}})}static _postWorkerMessage(n,i,a){return Promise.resolve(n).then(r=>{r instanceof Worker&&r.postMessage({type:i,data:a})})}}return o.DEFAULT_CANVAS_SIZE=400,o.NO_QR_CODE_FOUND="No QR code found",o.WORKER_PATH="qr-scanner-worker.min.js",o})();const Zi=["video"],yi=["checkin-qr-scan",""],Mi=function(){return["/welcome"]};let wi=(()=>{class o{constructor(n,i){this._checkin=n,this._router=i}ngOnInit(){this.setupQRReader()}ngOnDestroy(){var n;this._video_el.nativeElement.srcObject&&this._video_el.nativeElement.srcObject.getTracks().forEach(i=>null==i?void 0:i.stop()),null===(n=this._reader)||void 0===n||n.stop()}checkQRCode(n){return(0,h.mG)(this,void 0,void 0,function*(){const i=n.split(",");if(2!==i.length)return(0,_.cB)("Invalid QRCode"),void this.setupQRReader();yield this._checkin.loadGuestAndEvent(i[0],i[1]).catch(a=>{throw this.handleError(a.message||a),a}),this._router.navigate(["/checkin","details"])})}checkEmail(n){return(0,h.mG)(this,void 0,void 0,function*(){!n||!n.includes("@")||n.length<5||(yield this._checkin.loadGuestAndEvent(n).catch(i=>{throw this.handleError(i.message||i),i}),this._router.navigate(["/checkin","details"]))})}setupQRReader(){var n;(null===(n=navigator.mediaDevices)||void 0===n?void 0:n.getUserMedia)&&navigator.mediaDevices.getUserMedia({video:!0}).then(i=>this._video_el.nativeElement.srcObject=i).catch(i=>console.error("Unable to fetch media devices!",i)),We&&(this._reader=new We(this._video_el.nativeElement,i=>this.checkQRCode(i)),this._reader.start())}handleError(n){console.error(n),this._checkin.setError((null==n?void 0:n.statusText)||n),this._router.navigate(["/checkin","error"])}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(P),t.Y36(v.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["","checkin-qr-scan",""]],viewQuery:function(n,i){if(1&n&&t.Gf(Zi,7),2&n){let a;t.iGM(a=t.CRH())&&(i._video_el=a.first)}},attrs:yi,decls:12,vars:3,consts:[[1,"bg-white","rounded","shadow","overflow-hidden","relative","flex","flex-col","items-center"],[1,"mt-6","mb-4"],["appearance","outline"],["matInput","","placeholder","Enter email...","type","email","autocomplete","off",3,"ngModel","ngModelChange","blur","keyup.enter"],["id","qr-stream","playsinline","","width","640","height","480","autoplay","",1,"rounded","m-4","bg-gray-200","border","border-gray-500"],["video",""],["mat-icon-button","",1,"absolute","top-0","right-0",3,"routerLink"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"p",1),t._uU(2," Please enter your email address or scan your QR code "),t.qZA(),t.TgZ(3,"mat-form-field",2),t.TgZ(4,"input",3),t.NdJ("ngModelChange",function(r){return i.email=r})("blur",function(){return i.checkEmail(i.email)})("keyup.enter",function(){return i.checkEmail(i.email)}),t.qZA(),t.TgZ(5,"mat-error"),t._uU(6,"Invalid email format"),t.qZA(),t.qZA(),t._UZ(7,"video",4,5),t.TgZ(9,"a",6),t.TgZ(10,"app-icon"),t._uU(11,"close"),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(4),t.Q6J("ngModel",i.email),t.xp6(5),t.Q6J("routerLink",t.DdM(2,Mi)))},directives:[A.KE,j.Nt,u.Fj,u.JJ,u.On,A.TO,b.zs,v.yS,C.o],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%;background-color:#00000080}video[_ngcontent-%COMP%]{width:36rem;height:27rem}mat-form-field[_ngcontent-%COMP%]{width:36rem}a[_ngcontent-%COMP%]{position:absolute}"]}),o})();function Ai(o,s){1&o&&(t.TgZ(0,"p"),t._uU(1," Please wait in the lobby. "),t.qZA())}function Ii(o,s){1&o&&(t.TgZ(0,"p"),t._uU(1," Please use the vistor access lift over there. "),t.qZA())}const ki=function(){return["/checkin","preferences"]};function Oi(o,s){if(1&o&&(t.TgZ(0,"div",1),t.TgZ(1,"h3",2),t._uU(2,"You are checked in!"),t.qZA(),t.TgZ(3,"p",3),t._uU(4),t.ALo(5,"date"),t.ALo(6,"async"),t.ALo(7,"async"),t._UZ(8,"br"),t._uU(9),t.ALo(10,"async"),t.qZA(),t.YNc(11,Ai,2,0,"p",4),t.ALo(12,"async"),t.YNc(13,Ii,2,0,"p",4),t.ALo(14,"async"),t.TgZ(15,"a",5),t._uU(16," Done "),t.qZA(),t.qZA()),2&o){const n=t.oxw();let i,a,r;t.xp6(4),t.AsE(" Welcome, you have a meeting at ",t.xi3(5,6,(null==(i=t.lcZ(6,9,n.event))?null:i.date)||"","shortDate")," with ",(null==t.lcZ(7,11,n.event).organiser?null:t.lcZ(7,11,n.event).organiser.name)||"","."),t.xp6(5),t.hij(" ",(null==t.lcZ(10,13,n.event).organiser?null:t.lcZ(10,13,n.event).organiser.name)||""," has been notified and will be with you shortly.\xa0 "),t.xp6(2),t.Q6J("ngIf",!(null!=(a=t.lcZ(12,15,n.event))&&a.can_access_lift)),t.xp6(2),t.Q6J("ngIf",null==(r=t.lcZ(14,17,n.event))?null:r.can_access_lift),t.xp6(2),t.Q6J("routerLink",t.DdM(19,ki))}}let qi=(()=>{class o{constructor(n,i){this._checkin=n,this._router=i,this.event=this._checkin.event,this.guest=this._checkin.guest}ngOnInit(){this.event.pipe((0,q.P)()).subscribe(n=>n?"":this.previous())}previous(){this._router.navigate(["/checkin"])}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(P),t.Y36(v.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["checkin-results"]],decls:2,vars:3,consts:[["class","bg-white rounded shadow overflow-hidden relative flex flex-col items-center my-4 p-4 mx-auto space-y-4",4,"ngIf"],[1,"bg-white","rounded","shadow","overflow-hidden","relative","flex","flex-col","items-center","my-4","p-4","mx-auto","space-y-4"],[1,"text-xl"],[1,"text-center"],[4,"ngIf"],["button","","mat-button","",1,"w-32",3,"routerLink"]],template:function(n,i){1&n&&(t.YNc(0,Oi,17,20,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,i.event))},directives:[p.O5,b.zs,v.yS],pipes:[p.Ov,p.uU],styles:["[_nghost-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0;right:0;bottom:0;background-color:#00000080}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem)}"]}),o})();function Pi(o,s){if(1&o&&(t.TgZ(0,"p",5),t._uU(1),t.ALo(2,"async"),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,n.error))}}const Li=function(){return["/welcome"]};let Ni=(()=>{class o{constructor(n){this._checkin=n,this.error=this._checkin.error}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(P))},o.\u0275cmp=t.Xpm({type:o,selectors:[["checkin-error"]],decls:9,vars:5,consts:[[1,"bg-white","rounded","shadow","overflow-hidden","relative","flex","flex-col","items-center","my-4","mx-auto","p-4"],[1,"text-2xl","mb-4"],["class","mb-2",4,"ngIf"],[1,"mb-4"],["button","","mat-button","",1,"w-32",3,"routerLink"],[1,"mb-2"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"h3",1),t._uU(2,"Please see reception."),t.qZA(),t.YNc(3,Pi,3,3,"p",2),t.ALo(4,"async"),t.TgZ(5,"p",3),t._uU(6,"Our staff at reception will assist you."),t.qZA(),t.TgZ(7,"a",4),t._uU(8," Back "),t.qZA(),t.qZA()),2&n&&(t.xp6(3),t.Q6J("ngIf",t.lcZ(4,2,i.error)),t.xp6(4),t.Q6J("routerLink",t.DdM(4,Li)))},directives:[p.O5,b.zs,v.yS],pipes:[p.Ov],styles:["[_nghost-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0;right:0;bottom:0;background-color:#00000080}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:28rem;max-width:calc(100vw - 2rem)}"]}),o})();const Ui=["checkin-covid",""],Di=function(){return["/welcome"]};let Ei=(()=>{class o{constructor(n,i){this._router=n,this._checkin=i}confirm(){if(!this.symptoms||!this.contact)return(0,_.cB)("Please select yes or no for each question");this._checkin.updateGuest({covid:"true"===this.contact,symptoms:"true"===this.symptoms}),"false"===this.symptoms&&"false"===this.contact?this._router.navigate(["/checkin","results"]):(this._checkin.setError("Please get tested for COVID-19 and self-isolate at home for 14 days"),this._router.navigate(["/checkin","error"]))}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(v.F0),t.Y36(P))},o.\u0275cmp=t.Xpm({type:o,selectors:[["","checkin-covid",""]],attrs:Ui,decls:55,vars:5,consts:[[1,"bg-white","rounded","p-4","relative","overflow-y-auto","overflow-x-hidden"],[1,"text-xl","font-medium","mb-4"],[1,"list-decimal","list-inside"],[1,"list-disc","list-inside","px-4","mb-4"],["aria-label","Has Symptoms",3,"ngModel","ngModelChange"],["value","true"],["value","false",1,"ml-4"],[1,"my-4"],["aria-label","COVID contact or self-isolated",3,"ngModel","ngModelChange"],["mat-button","",3,"click"],["mat-icon-button","",1,"absolute","top-0","right-0",3,"disabled","routerLink"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"h3",1),t._uU(2,"COVID Disclaimer"),t.qZA(),t.TgZ(3,"ol",2),t.TgZ(4,"li"),t._uU(5," Do you have any of the following symptoms?"),t._UZ(6,"br"),t._UZ(7,"br"),t.TgZ(8,"ul",3),t.TgZ(9,"li"),t._uU(10,"Fever"),t.qZA(),t.TgZ(11,"li"),t._uU(12,"Cough"),t.qZA(),t.TgZ(13,"li"),t._uU(14,"Shortness of breath"),t.qZA(),t.TgZ(15,"li"),t._uU(16,"Chills"),t.qZA(),t.TgZ(17,"li"),t._uU(18,"Body aches"),t.qZA(),t.TgZ(19,"li"),t._uU(20,"Sore or scratchy throat"),t.qZA(),t.TgZ(21,"li"),t._uU(22,"Headache"),t.qZA(),t.TgZ(23,"li"),t._uU(24,"Runny nose"),t.qZA(),t.TgZ(25,"li"),t._uU(26,"Muscle pain"),t.qZA(),t.TgZ(27,"li"),t._uU(28,"Vomitting"),t.qZA(),t.TgZ(29,"li"),t._uU(30,"Nausea"),t.qZA(),t.TgZ(31,"li"),t._uU(32,"Diarrhoa"),t.qZA(),t.TgZ(33,"li"),t._uU(34,"Loss of taste or smell"),t.qZA(),t.qZA(),t.TgZ(35,"mat-radio-group",4),t.NdJ("ngModelChange",function(r){return i.symptoms=r}),t.TgZ(36,"mat-radio-button",5),t._uU(37,"Yes"),t.qZA(),t.TgZ(38,"mat-radio-button",6),t._uU(39,"No"),t.qZA(),t.qZA(),t.qZA(),t._UZ(40,"hr",7),t.TgZ(41,"li"),t._uU(42," Have you been in contact with a COVID-19 case in the last 14 days or been asked to self-isolate by a health offical?"),t._UZ(43,"br"),t._UZ(44,"br"),t.TgZ(45,"mat-radio-group",8),t.NdJ("ngModelChange",function(r){return i.contact=r}),t.TgZ(46,"mat-radio-button",5),t._uU(47,"Yes"),t.qZA(),t.TgZ(48,"mat-radio-button",6),t._uU(49,"No"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(50,"button",9),t.NdJ("click",function(){return i.confirm()}),t._uU(51,"Confirm"),t.qZA(),t.TgZ(52,"a",10),t.TgZ(53,"app-icon"),t._uU(54,"close"),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(35),t.Q6J("ngModel",i.symptoms),t.xp6(10),t.Q6J("ngModel",i.contact),t.xp6(7),t.Q6J("disabled",!i.symptoms&&!i.contact)("routerLink",t.DdM(4,Di)))},directives:[ie.VQ,u.JJ,u.On,ie.U0,b.lW,b.zs,v.yS,C.o],styles:["[_nghost-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0;right:0;bottom:0;background-color:#00000080}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem);max-height:calc(100% - 2rem)}.absolute[_ngcontent-%COMP%]{position:absolute}button[_ngcontent-%COMP%]{margin:1rem 11rem 0;width:8rem}"]}),o})();var Si=d(3925);const Fi=["app-checkin",""],Ri=[{path:"",component:(()=>{class o{constructor(n){this._settings=n}get background(){return this._settings.get("app.home.background")}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(_.gb))},o.\u0275cmp=t.Xpm({type:o,selectors:[["","app-checkin",""]],attrs:Fi,decls:3,vars:2,consts:[[1,"w-full"],[1,"flex-1","w-full","bg-center","bg-cover","relative"]],template:function(n,i){1&n&&(t._UZ(0,"a-topbar-header",0),t.TgZ(1,"div",1),t._UZ(2,"router-outlet"),t.qZA()),2&n&&(t.xp6(1),t.Udp("background-image","url("+i.background+")"))},directives:[Si.B,v.lC],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}"]}),o})(),children:[{path:"scan",component:wi},{path:"details",component:it},{path:"preferences",component:xi},{path:"photo",component:lt},{path:"results",component:qi},{path:"error",component:Ni},{path:"covid",component:Ei},{path:"**",redirectTo:"scan"}]},{path:"**",redirectTo:""}];let Yi=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[p.ez,u.u5,u.UX,ze.q,v.Bz.forChild(Ri)]]}),o})()}}]);
//# sourceMappingURL=apps_visitor-kiosk_src_app_checkin_checkin_module_ts.js.map