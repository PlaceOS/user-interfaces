"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_level-manager_level-manager_module_ts"],{2518:(oe,_,o)=>{o.r(_),o.d(_,{LevelManagerModule:()=>ne});var d=o(6477),s=o(9542),T=o(6585),x=o(3045),A=o(2886),N=o(5533),g=o(5912),m=o(308),u=o(4505),y=o(7716),S=o(6942),Z=o(1670),f=o(7486),v=o(1426),e=o(6839),L=o(8750),P=o(380),O=o(6508),h=o(7728),F=o(5312),E=o(5306);function b(t,a){1&t&&(e.TgZ(0,"button",4)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function I(t,a){if(1&t&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.Q6J("value",n.id),e.xp6(1),e.hij(" ",n.display_name||n.name," ")}}function R(t,a){if(1&t&&(e.TgZ(0,"div",9)(1,"label",10),e.tHW(2,11),e._UZ(3,"span"),e.N_p(),e.qZA(),e.TgZ(4,"mat-form-field",12)(5,"mat-select",13),e.YNc(6,I,2,2,"mat-option",14),e.ALo(7,"async"),e.qZA(),e.TgZ(8,"mat-error"),e._uU(9,"Building is required"),e.qZA()()()),2&t){const n=e.oxw(3);e.xp6(1),e.ekj("error",n.form.controls.parent_id.invalid&&n.form.controls.parent_id.touched),e.xp6(5),e.Q6J("ngForOf",e.lcZ(7,3,n.building_list))}}function G(t,a){1&t&&(e.TgZ(0,"div",9)(1,"label",16),e.SDv(2,17),e.qZA(),e.TgZ(3,"mat-form-field",12),e._UZ(4,"input",18),e.qZA()())}function w(t,a){if(1&t&&(e.TgZ(0,"form",7),e.YNc(1,R,10,5,"div",8),e.YNc(2,G,5,0,"div",8),e.qZA()),2&t){const n=e.oxw(2);e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("ngIf",n.form.controls.parent_id),e.xp6(1),e.Q6J("ngIf",n.form.controls.display_name)}}function D(t,a){if(1&t&&(e.TgZ(0,"main",5),e.YNc(1,w,3,3,"form",6),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.form)}}function $(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"footer",19)(1,"button",20),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.save())}),e._uU(2,"Save"),e.qZA()()}}function U(t,a){1&t&&(e.TgZ(0,"div",21),e._UZ(1,"mat-spinner",22),e.TgZ(2,"p",23),e._uU(3,"Saving level..."),e.qZA()())}let V=(()=>{class t{constructor(n,l){this._org=n,this._data=l,this.loading=!1,this.building_list=this._org.building_list,this.form=new s.cw({id:new s.NI(this._data?.id||""),display_name:new s.NI(this._data?.display_name||"",[s.kI.required]),parent_id:new s.NI(this._data?.parent_id||"",[s.kI.required])})}save(){var n=this;return(0,Z.Z)(function*(){if(!n.form.valid)return(0,v.cB)(`Some form fields are invalid. [${(0,v.RD)(n.form).join(", ")}]`);n.loading=!0;const l=n.form.getRawValue();yield(l.id?(0,m.BfP)(l.id,{...l,name:`LEVEL ${(0,m.N9E)().description} ${l.display_name}`}):(0,m.ri3)({...l,name:`LEVEL ${(0,m.N9E)().description} ${l.display_name}`})).toPromise().catch(),n.loading=!1})()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(g.w7),e.Y36(f.WI))},t.\u0275cmp=e.Xpm({type:t,selectors:[["level-modal"]],decls:8,vars:5,consts:function(){let a,n,l;return a=$localize`:@@zoneLabel␟5e09041a10f5eb39aadfaa1a8dd77f4dc8d77314␟711878476466678637: Building${"\ufffd#3\ufffd"}:START_TAG_SPAN:*${"\ufffd/#3\ufffd"}:CLOSE_TAG_SPAN:: `,n=$localize`:@@displayNameLabel␟8d766661ed5e178519720ec8e959d2a737f600a6␟1377207093952578744: Display Name: `,l=$localize`:@@displayNamePlaceholder␟e438ba78cbafdb5bcbce0820bfaad995a504f222␟3013055597615607317:Display Name`,[["btn","","icon","","mat-dialog-close","",4,"ngIf"],["class","max-h-[65vh] overflow-y-auto overflow-x-hidden p-4",4,"ngIf","ngIfElse"],["class","p-2 flex justify-end border-t border-gray-200",4,"ngIf"],["load_state",""],["btn","","icon","","mat-dialog-close",""],[1,"max-h-[65vh]","overflow-y-auto","overflow-x-hidden","p-4"],["system","","class","flex flex-col w-[36rem] max-w-[calc(100vw-4rem)]",3,"formGroup",4,"ngIf"],["system","",1,"flex","flex-col","w-[36rem]","max-w-[calc(100vw-4rem)]",3,"formGroup"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],["for","zone"],a,["appearance","outline"],["formControlName","parent_id","placeholder","Select Building"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","display-name"],n,["matInput","","name","display-name","placeholder",l,"formControlName","display_name"],[1,"p-2","flex","justify-end","border-t","border-gray-200"],["btn","",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","justify-center","w-64","h-64"],["diameter","32"],[1,"mt-4"]]},template:function(n,l){if(1&n&&(e.TgZ(0,"header")(1,"h2"),e._uU(2),e.qZA(),e.YNc(3,b,3,0,"button",0),e.qZA(),e.YNc(4,D,2,1,"main",1),e.YNc(5,$,3,0,"footer",2),e.YNc(6,U,4,0,"ng-template",null,3,e.W1O)),2&n){const i=e.MAs(7);e.xp6(2),e.hij("",l.form.value.id?"Edit":"Add"," Level"),e.xp6(1),e.Q6J("ngIf",!l.loading),e.xp6(1),e.Q6J("ngIf",!l.loading)("ngIfElse",i),e.xp6(1),e.Q6J("ngIf",!l.loading)}},dependencies:[d.sg,d.O5,s._Y,s.Fj,s.JJ,s.JL,L.KE,L.TO,P.Nt,O.gD,h.ey,F.Ou,f.ZT,s.sg,s.u,E.o,d.Ov]}),t})(),M=(()=>{class t{constructor(n,l){this._org=n,this._dialog=l,this._options=new u.X({}),this._change=new u.X(0),this.options=this._options.asObservable(),this.regions=this._org.region_list,this.level_list=this._org.level_list,this.filtered_levels=(0,y.aj)([this.level_list,this._options]).pipe((0,S.U)(([i,c])=>{c.zone&&(i=i.filter(r=>r.parent_id===c.zone)),c.search&&(i=i.filter(r=>r.name.toLowerCase().includes(c.search.toLowerCase())));for(const r of i){const p=this._org.buildings.find(te=>te.id===r.parent_id);p&&(r.building=p.display_name||p.name)}return i}))}setFilters(n){this._options.next({...this._options.getValue(),...n})}setSearchString(n){this._options.next({...this._options.getValue(),search:n})}editLevel(n=new m.TT8){this._dialog.open(V,{data:n}).afterClosed().subscribe(i=>{i&&setTimeout(()=>this._change.next(Date.now()),300)})}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(g.w7),e.LFG(f.uw))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var J=o(6866),Y=o(3320),z=o(2423),j=o(1110);function X(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",3)(1,"button",4),e.NdJ("click",function(){const c=e.CHM(n).row,r=e.oxw();return e.KtG(r.editLevel(c))}),e.TgZ(2,"app-icon"),e._uU(3,"edit"),e.qZA()()()}}const B=function(){return["display_name","building","actions"]},Q=function(){return["Name","Building"," "]},H=function(){return["flex","12r","5r"]},K=function(t){return{actions:t}};let W=(()=>{class t{constructor(n){this._manager=n,this.levels=this._manager.filtered_levels,this.editLevel=l=>this._manager.editLevel(l)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(M))},t.\u0275cmp=e.Xpm({type:t,selectors:[["level-list"]],decls:4,vars:10,consts:[[1,"absolute","inset-0","overflow-auto"],["empty","No levels",1,"block","min-w-[48rem]","w-full","h-full",3,"dataSource","columns","display_column","column_size","template"],["action_template",""],[1,"w-full","flex","justify-end","space-x-2"],["btn","","icon","","matTooltip","Edit Level",3,"click"]],template:function(n,l){if(1&n&&(e.TgZ(0,"div",0),e._UZ(1,"custom-table",1),e.qZA(),e.YNc(2,X,4,0,"ng-template",null,2,e.W1O)),2&n){const i=e.MAs(3);e.xp6(1),e.Q6J("dataSource",l.levels)("columns",e.DdM(5,B))("display_column",e.DdM(6,Q))("column_size",e.DdM(7,H))("template",e.VKq(8,K,i))}},dependencies:[z.gM,E.o,j.C]}),t})();const q=["app-level-manager",""];let C=(()=>{class t{constructor(n){this._manager=n,this.newLevel=()=>this._manager.editLevel()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(M))},t.\u0275cmp=e.Xpm({type:t,selectors:[["","app-level-manager",""]],attrs:q,decls:10,vars:0,consts:[[1,"flex","flex-1","h-px"],[1,"flex","flex-col","flex-1","w-1/2","h-full"],[1,"flex","items-center","justify-between","mb-2","p-8"],[1,"text-2xl","font-medium"],["btn","","matRipple","",3,"click"],[1,"block","w-full","relative","flex-1","h-1/2"]],template:function(n,l){1&n&&(e._UZ(0,"app-topbar"),e.TgZ(1,"div",0),e._UZ(2,"app-sidebar"),e.TgZ(3,"main",1)(4,"header",2)(5,"h2",3),e._uU(6,"Level Management"),e.qZA(),e.TgZ(7,"button",4),e.NdJ("click",function(){return l.newLevel()}),e._uU(8," Add Level "),e.qZA()(),e._UZ(9,"level-list",5),e.qZA()())},dependencies:[J.O,Y.u,h.wG,W],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:#fff}sidebar[_ngcontent-%COMP%]{height:100%}main[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-width:50%;height:100%}\n/*# sourceMappingURL=level-manager.component.ts-angular-inline--177.css.map*/"]}),t})();var k=o(1031);const ee=[{path:"",component:C},{path:"new",component:C}];let ne=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.ez,s.u5,x.v,A.YR,N.PP,k.Hi,T.Bz.forChild(ee)]}),t})()}}]);
//# sourceMappingURL=apps_concierge_src_app_level-manager_level-manager_module_ts.js.map