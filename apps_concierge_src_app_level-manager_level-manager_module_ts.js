"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_level-manager_level-manager_module_ts"],{94876:(S,p,l)=>{l.r(p),l.d(p,{LevelManagerModule:()=>se});var f=l(26575),a=l(28849),C=l(92649),L=l(97910),h=l(46514),E=l(59524),x=l(71670),g=l(93121),d=l(47298),A=l(70462),s=l(28159),O=l(47422),u=l(17401),v=l(34592),e=l(29039),N=l(71268),I=l(99674),R=l(96355),M=l(10257),b=l(56658),G=l(33910),P=l(94888);function F(n,r){1&n&&(e.TgZ(0,"button",4)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function $(n,r){if(1&n&&(e.TgZ(0,"mat-option",16),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(),e.hij(" ",t.display_name||t.name," ")}}function w(n,r){if(1&n&&(e.TgZ(0,"div",10)(1,"label",11),e.tHW(2,12),e._UZ(3,"span"),e.N_p(),e.qZA(),e.TgZ(4,"mat-form-field",13)(5,"mat-select",14),e.YNc(6,$,2,2,"mat-option",15),e.ALo(7,"async"),e.qZA(),e.TgZ(8,"mat-error"),e._uU(9,"Building is required"),e.qZA()()()),2&n){const t=e.oxw(3);e.xp6(),e.ekj("error",t.form.controls.parent_id.invalid&&t.form.controls.parent_id.touched),e.xp6(5),e.Q6J("ngForOf",e.lcZ(7,3,t.building_list))}}function D(n,r){1&n&&(e.TgZ(0,"div",10)(1,"label",17),e.SDv(2,18),e.qZA(),e.TgZ(3,"mat-form-field",13),e._UZ(4,"input",19),e.qZA()())}function U(n,r){1&n&&(e.TgZ(0,"div",10)(1,"label",20),e.SDv(2,21),e.qZA(),e.TgZ(3,"mat-form-field",13),e._UZ(4,"input",22),e.qZA()())}function V(n,r){1&n&&(e.TgZ(0,"div",23)(1,"mat-checkbox",24),e._uU(2," Has Parking Spaces "),e.qZA()())}function J(n,r){if(1&n&&(e.TgZ(0,"form",7),e.YNc(1,w,10,5,"div",8)(2,D,5,0,"div",8)(3,U,5,0,"div",8)(4,V,3,0,"div",9),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("formGroup",t.form),e.xp6(),e.Q6J("ngIf",t.form.controls.parent_id),e.xp6(),e.Q6J("ngIf",t.form.controls.display_name),e.xp6(),e.Q6J("ngIf",t.form.controls.map_id),e.xp6(),e.Q6J("ngIf",t.form.controls.parking)}}function z(n,r){if(1&n&&(e.TgZ(0,"main",5),e.YNc(1,J,5,5,"form",6),e.qZA()),2&n){const t=e.oxw();e.xp6(),e.Q6J("ngIf",t.form)}}function Y(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"footer",25)(1,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.save())}),e._uU(2,"Save"),e.qZA()()}}function j(n,r){1&n&&(e.TgZ(0,"div",27),e._UZ(1,"mat-spinner",28),e.TgZ(2,"p",29),e._uU(3,"Saving level..."),e.qZA()())}let X=(()=>{class n{constructor(t,o,i){this._org=t,this._data=o,this._dialog_ref=i,this.loading=!1,this.building_list=this._org.building_list,this.form=new a.cw({id:new a.NI(this._data?.id||""),display_name:new a.NI(this._data?.display_name||"",[a.kI.required]),parent_id:new a.NI(this._data?.parent_id||"",[a.kI.required]),map_id:new a.NI(this._data?.map_id||"",[a.kI.required]),parking:new a.NI(this._data?.tags?.includes("parking")||!1)})}save(){var t=this;return(0,x.Z)(function*(){if(!t.form.valid)return(0,v.cB)(`Some form fields are invalid. [${(0,v.RD)(t.form).join(", ")}]`);t.loading=!0;const o=t.form.getRawValue();o.tags=o.parking?["level","parking"]:["level"];const i=yield(o.id?(0,d.BfP)(o.id,{...o,name:`LEVEL ${(0,d.N9E)().description} ${o.display_name}`}):(0,d.ri3)({...o,name:`LEVEL ${(0,d.N9E)().description} ${o.display_name}`})).toPromise().catch();i.id&&t._dialog_ref.close(i),t.loading=!1})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(g.w7),e.Y36(u.WI),e.Y36(u.so))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["level-modal"]],decls:8,vars:5,consts:()=>{let t,o,i,c,m;return t=$localize`:@@zoneLabel␟5e09041a10f5eb39aadfaa1a8dd77f4dc8d77314␟711878476466678637: Building${"\ufffd#3\ufffd"}:START_TAG_SPAN:*${"\ufffd/#3\ufffd"}:CLOSE_TAG_SPAN:: `,o=$localize`:@@displayNameLabel␟8d766661ed5e178519720ec8e959d2a737f600a6␟1377207093952578744: Display Name: `,i=$localize`:@@displayNamePlaceholder␟e438ba78cbafdb5bcbce0820bfaad995a504f222␟3013055597615607317:Display Name`,c=$localize`:@@mapIdLabel␟df25418cac1c9528713ba16dc8d5e1f497e1e0d3␟7638966832226302469: Map URL: `,m=$localize`:@@mapIdPlaceholder␟f78f3836515ccc83a36f25d9174f585019d54341␟1505388289077394171:URL of the Map SVG file`,[["btn","","icon","","mat-dialog-close","",4,"ngIf"],["class","max-h-[65vh] overflow-y-auto overflow-x-hidden p-4",4,"ngIf","ngIfElse"],["class","p-2 flex justify-end border-t border-base-200",4,"ngIf"],["load_state",""],["btn","","icon","","mat-dialog-close",""],[1,"max-h-[65vh]","overflow-y-auto","overflow-x-hidden","p-4"],["system","","class","flex flex-col w-[36rem] max-w-[calc(100vw-4rem)]",3,"formGroup",4,"ngIf"],["system","",1,"flex","flex-col","w-[36rem]","max-w-[calc(100vw-4rem)]",3,"formGroup"],["class","flex flex-col",4,"ngIf"],["class","flex flex-col py-2",4,"ngIf"],[1,"flex","flex-col"],["for","zone"],t,["appearance","outline"],["formControlName","parent_id","placeholder","Select Building"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","display-name"],o,["matInput","","name","display-name","placeholder",i,"formControlName","display_name"],["for","map-id"],c,["matInput","","name","map-id","placeholder",m,"formControlName","map_id"],[1,"flex","flex-col","py-2"],["name","parking","formControlName","parking"],[1,"p-2","flex","justify-end","border-t","border-base-200"],["btn","",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","justify-center","w-64","h-64"],["diameter","32"],[1,"mt-4"]]},template:function(o,i){if(1&o&&(e.TgZ(0,"header")(1,"h2"),e._uU(2),e.qZA(),e.YNc(3,F,3,0,"button",0),e.qZA(),e.YNc(4,z,2,1,"main",1)(5,Y,3,0,"footer",2)(6,j,4,0,"ng-template",null,3,e.W1O)),2&o){const c=e.MAs(7);e.xp6(2),e.hij("",i.form.value.id?"Edit":"Add"," Level"),e.xp6(),e.Q6J("ngIf",!i.loading),e.xp6(),e.Q6J("ngIf",!i.loading)("ngIfElse",c),e.xp6(),e.Q6J("ngIf",!i.loading)}},dependencies:[f.sg,f.O5,a._Y,a.Fj,a.JJ,a.JL,N.KE,N.TO,I.Nt,R.gD,M.ey,b.oG,G.Ou,u.ZT,a.sg,a.u,P.o,f.Ov]})}return n})(),y=(()=>{class n{constructor(t,o){this._org=t,this._dialog=o,this._options=new A.X({}),this._change=new A.X(0),this.options=this._options.asObservable(),this.level_list=this._org.level_list,this.filtered_levels=(0,s.aj)([this.level_list,this._options]).pipe((0,O.U)(([i,c])=>{c.zone&&(i=i.filter(m=>m.parent_id===c.zone)),c.search&&(i=i.filter(m=>m.name.toLowerCase().includes(c.search.toLowerCase())));for(const m of i){const _=this._org.buildings.find(re=>re.id===m.parent_id);_&&(m.building=_.display_name||_.name)}return i}))}setFilters(t){this._options.next({...this._options.getValue(),...t})}setSearchString(t){this._options.next({...this._options.getValue(),search:t})}editLevel(t=new d.TT8){this._dialog.open(X,{data:t}).afterClosed().subscribe(i=>{i&&this._org.addZone(i)})}removeLevel(t){var o=this;return(0,x.Z)(function*(){const i=yield(0,v._5)({title:"Remove Building",content:`Are you sure you want to remove the building "${t.name}"?`,icon:{content:"delete_forever"},confirm_text:"Remove"},o._dialog);if("done"!==i.reason)return i.close();i.loading("Removing building..."),yield(0,d.Jwl)(t.id).toPromise(),o._org.removeZone({id:t.id,tags:["level"]}),(0,v.t5)("Successfully removed building."),i.close()})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.LFG(g.w7),e.LFG(u.uw))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Q=l(33005),B=l(19842),T=l(78128),H=l(27442);function W(n,r){1&n&&(e.TgZ(0,"div",5)(1,"app-icon"),e._uU(2,"done"),e.qZA()())}function K(n,r){if(1&n&&e.YNc(0,W,3,0,"div",4),2&n){const t=r.row;e.Q6J("ngIf",null==t.tags?null:t.tags.includes("parking"))}}function k(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",6)(1,"button",7)(2,"app-icon"),e._uU(3,"more_vert"),e.qZA()(),e.TgZ(4,"mat-menu",null,8)(6,"button",9),e.NdJ("click",function(){const c=e.CHM(t).row,m=e.oxw();return e.KtG(m.editLevel(c))}),e.TgZ(7,"div",10)(8,"app-icon"),e._uU(9,"edit"),e.qZA(),e.TgZ(10,"span"),e._uU(11,"Edit Level"),e.qZA()()(),e.TgZ(12,"button",9),e.NdJ("click",function(){const c=e.CHM(t).row,m=e.oxw();return e.KtG(m.removeLevel(c))}),e.TgZ(13,"div",11)(14,"app-icon"),e._uU(15,"delete"),e.qZA(),e.TgZ(16,"span"),e._uU(17,"Delete Level"),e.qZA()()()()()}if(2&n){const t=e.MAs(5);e.xp6(),e.Q6J("matMenuTriggerFor",t)}}const q=()=>["display_name","building","parking","actions"],ee=()=>["Name","Building","Parking"," "],te=()=>["flex","12r","4r","3.75r"],ne=(n,r)=>({actions:n,parking:r});let oe=(()=>{class n{constructor(t){this._manager=t,this.levels=this._manager.filtered_levels,this.editLevel=o=>this._manager.editLevel(o),this.removeLevel=o=>this._manager.removeLevel(o)}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(y))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["level-list"]],decls:6,vars:11,consts:[[1,"absolute","inset-0","overflow-auto","px-4"],["empty","No levels",1,"block","min-w-[28rem]","w-full","h-full",3,"dataSource","columns","display_column","column_size","template"],["parking_template",""],["action_template",""],["class","rounded h-8 w-8 flex items-center justify-center text-2xl bg-success text-success-content mx-auto",4,"ngIf"],[1,"rounded","h-8","w-8","flex","items-center","justify-center","text-2xl","bg-success","text-success-content","mx-auto"],[1,"w-full","flex","justify-end","space-x-2"],["btn","","icon","","matRipple","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"flex","items-center","space-x-2"],[1,"flex","items-center","space-x-2","text-red-500"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0),e._UZ(1,"custom-table",1),e.qZA(),e.YNc(2,K,1,1,"ng-template",null,2,e.W1O)(4,k,18,1,"ng-template",null,3,e.W1O)),2&o){const c=e.MAs(3),m=e.MAs(5);e.xp6(),e.Q6J("dataSource",i.levels)("columns",e.DdM(5,q))("display_column",e.DdM(6,ee))("column_size",e.DdM(7,te))("template",e.WLB(8,ne,m,c))}},dependencies:[f.O5,T.VK,T.OP,T.p6,M.wG,P.o,H.C]})}return n})();const le=["app-level-manager",""];let Z=(()=>{class n{constructor(t){this._manager=t,this.newLevel=()=>this._manager.editLevel()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(y))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["","app-level-manager",""]],attrs:le,decls:10,vars:0,consts:[[1,"flex","flex-1","h-px"],[1,"flex","flex-col","flex-1","w-1/2","h-full"],[1,"flex","items-center","justify-between","mb-2","px-4","py-8"],[1,"text-2xl","font-medium"],["btn","","matRipple","",3,"click"],[1,"block","w-full","relative","flex-1","h-1/2"]],template:function(o,i){1&o&&(e._UZ(0,"app-topbar"),e.TgZ(1,"div",0),e._UZ(2,"app-sidebar"),e.TgZ(3,"main",1)(4,"header",2)(5,"h2",3),e._uU(6,"Level Management"),e.qZA(),e.TgZ(7,"button",4),e.NdJ("click",function(){return i.newLevel()}),e._uU(8," Add Level "),e.qZA()(),e._UZ(9,"level-list",5),e.qZA()())},dependencies:[Q.O,B.u,M.wG,oe],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}sidebar[_ngcontent-%COMP%]{height:100%}main[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-width:50%;height:100%}\n\n/*# sourceMappingURL=level-manager.component.ts-angular-inline--186.css.map*/"]})}return n})();var ie=l(21757);const ae=[{path:"",component:Z},{path:"new",component:Z}];let se=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[f.ez,a.u5,L.v,h.YR,E.PP,ie.Hi,C.Bz.forChild(ae)]})}return n})()},59524:(S,p,l)=>{l.d(p,{Y:()=>h,PP:()=>f.P,mO:()=>E.mO,VE:()=>d.VE,w0:()=>d.w0,sF:()=>g.sF});var f=l(43211),L=(l(86755),l(80882),l(67343));class h{constructor(s={}){this.type=s.type||s.location||"other",this.position=s.position||s.map_id||s.asset_id||{x:s.x/s.map_width||0,y:s.y/s.map_height||0},this.variance=s.variance||0,this.last_seen=s.last_seen||(0,L.Z)(new Date),this.level=s.level,this.building=s.building,this.at_location=!!s.at_location,this.coordinates_from=s.coordinates_from||"top-left"}}var E=l(223),g=(l(11451),l(38125)),d=l(48675)}}]);
//# sourceMappingURL=apps_concierge_src_app_level-manager_level-manager_module_ts.js.map