(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{uHdG:function(t,e,n){"use strict";n.r(e),n.d(e,"ReportsModule",(function(){return Bt}));var i=n("2kYt"),a=n("nIj0"),s=n("sEIs"),o=n("oRDy"),c=n("EM62"),l=n("mFH5"),r=n("PBFl"),b=n("R7+U"),p=n("Y2X+"),d=n("5XID"),g=n("ZTXN"),u=n("29Wa");
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
function h(t,e){if(1&t&&(c.Vb(0,"mat-option",19),c.Lc(1),c.Ub()),2&t){const t=e.$implicit;c.qc("value",t),c.Db(1),c.Nc(" ",t," ")}}function f(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-form-field",16),c.Vb(1,"mat-select",17),c.fc("selectionChange",(function(e){return c.yc(t),c.jc(2)._changePageSize(e.value)})),c.Jc(2,h,2,2,"mat-option",18),c.Ub(),c.Ub()}if(2&t){const t=c.jc(2);c.qc("appearance",t._formFieldAppearance)("color",t.color),c.Db(1),c.qc("value",t.pageSize)("disabled",t.disabled)("aria-label",t._intl.itemsPerPageLabel),c.Db(1),c.qc("ngForOf",t._displayedPageSizeOptions)}}function v(t,e){if(1&t&&(c.Vb(0,"div",20),c.Lc(1),c.Ub()),2&t){const t=c.jc(2);c.Db(1),c.Mc(t.pageSize)}}function m(t,e){if(1&t&&(c.Vb(0,"div",12),c.Vb(1,"div",13),c.Lc(2),c.Ub(),c.Jc(3,f,3,6,"mat-form-field",14),c.Jc(4,v,2,1,"div",15),c.Ub()),2&t){const t=c.jc();c.Db(2),c.Nc(" ",t._intl.itemsPerPageLabel," "),c.Db(1),c.qc("ngIf",t._displayedPageSizeOptions.length>1),c.Db(1),c.qc("ngIf",t._displayedPageSizeOptions.length<=1)}}function _(t,e){if(1&t){const t=c.Wb();c.Vb(0,"button",21),c.fc("click",(function(){return c.yc(t),c.jc().firstPage()})),c.ic(),c.Vb(1,"svg",7),c.Qb(2,"path",22),c.Ub(),c.Ub()}if(2&t){const t=c.jc();c.qc("matTooltip",t._intl.firstPageLabel)("matTooltipDisabled",t._previousButtonsDisabled())("matTooltipPosition","above")("disabled",t._previousButtonsDisabled()),c.Eb("aria-label",t._intl.firstPageLabel)}}function y(t,e){if(1&t){const t=c.Wb();c.ic(),c.hc(),c.Vb(0,"button",23),c.fc("click",(function(){return c.yc(t),c.jc().lastPage()})),c.ic(),c.Vb(1,"svg",7),c.Qb(2,"path",24),c.Ub(),c.Ub()}if(2&t){const t=c.jc();c.qc("matTooltip",t._intl.lastPageLabel)("matTooltipDisabled",t._nextButtonsDisabled())("matTooltipPosition","above")("disabled",t._nextButtonsDisabled()),c.Eb("aria-label",t._intl.lastPageLabel)}}let O=(()=>{class t{constructor(){this.changes=new g.b,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,e,n)=>{if(0==n||0==e)return"0 of "+n;const i=t*e;return`${i+1} \u2013 ${i<(n=Math.max(n,0))?Math.min(i+e,n):i+e} of ${n}`}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Object(c.Lb)({factory:function(){return new t},token:t,providedIn:"root"}),t})();const U={provide:O,deps:[[new c.E,new c.N,O]],useFactory:function(t){return t||new O}},V=new c.t("MAT_PAGINATOR_DEFAULT_OPTIONS");
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */class k{}const x=Object(l.u)(Object(l.w)(k));let D=(()=>{class t extends x{constructor(t,e,n){if(super(),this._intl=t,this._changeDetectorRef=e,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.page=new c.o,this._intlChanges=t.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),n){const{pageSize:t,pageSizeOptions:e,hidePageSize:i,showFirstLastButtons:a}=n;null!=t&&(this._pageSize=t),null!=e&&(this._pageSizeOptions=e),null!=i&&(this._hidePageSize=i),null!=a&&(this._showFirstLastButtons=a)}}get pageIndex(){return this._pageIndex}set pageIndex(t){this._pageIndex=Math.max(Object(d.e)(t),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(t){this._length=Object(d.e)(t),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(t){this._pageSize=Math.max(Object(d.e)(t),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(t){this._pageSizeOptions=(t||[]).map(t=>Object(d.e)(t)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(t){this._hidePageSize=Object(d.b)(t)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(t){this._showFirstLastButtons=Object(d.b)(t)}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex++,this._emitPageEvent(t)}previousPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex--,this._emitPageEvent(t)}firstPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=0,this._emitPageEvent(t)}lastPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(t)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(t){const e=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(e)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._initialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((t,e)=>t-e),this._changeDetectorRef.markForCheck())}_emitPageEvent(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(O),c.Pb(c.h),c.Pb(void 0))},t.\u0275dir=c.Kb({type:t,inputs:{pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",color:"color"},outputs:{page:"page"},features:[c.Ab]}),t})(),L=(()=>{class t extends D{constructor(t,e,n){super(t,e,n),n&&null!=n.formFieldAppearance&&(this._formFieldAppearance=n.formFieldAppearance)}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(O),c.Pb(c.h),c.Pb(V,8))},t.\u0275cmp=c.Jb({type:t,selectors:[["mat-paginator"]],hostAttrs:[1,"mat-paginator"],inputs:{disabled:"disabled"},exportAs:["matPaginator"],features:[c.Ab],decls:14,vars:14,consts:[[1,"mat-paginator-outer-container"],[1,"mat-paginator-container"],["class","mat-paginator-page-size",4,"ngIf"],[1,"mat-paginator-range-actions"],[1,"mat-paginator-range-label"],["mat-icon-button","","type","button","class","mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-paginator-page-size"],[1,"mat-paginator-page-size-label"],["class","mat-paginator-page-size-select",3,"appearance","color",4,"ngIf"],["class","mat-paginator-page-size-value",4,"ngIf"],[1,"mat-paginator-page-size-select",3,"appearance","color"],[3,"value","disabled","aria-label","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(t,e){1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Jc(2,m,5,3,"div",2),c.Vb(3,"div",3),c.Vb(4,"div",4),c.Lc(5),c.Ub(),c.Jc(6,_,3,5,"button",5),c.Vb(7,"button",6),c.fc("click",(function(){return e.previousPage()})),c.ic(),c.Vb(8,"svg",7),c.Qb(9,"path",8),c.Ub(),c.Ub(),c.hc(),c.Vb(10,"button",9),c.fc("click",(function(){return e.nextPage()})),c.ic(),c.Vb(11,"svg",7),c.Qb(12,"path",10),c.Ub(),c.Ub(),c.Jc(13,y,3,5,"button",11),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.Db(2),c.qc("ngIf",!e.hidePageSize),c.Db(3),c.Nc(" ",e._intl.getRangeLabel(e.pageIndex,e.pageSize,e.length)," "),c.Db(1),c.qc("ngIf",e.showFirstLastButtons),c.Db(1),c.qc("matTooltip",e._intl.previousPageLabel)("matTooltipDisabled",e._previousButtonsDisabled())("matTooltipPosition","above")("disabled",e._previousButtonsDisabled()),c.Eb("aria-label",e._intl.previousPageLabel),c.Db(3),c.qc("matTooltip",e._intl.nextPageLabel)("matTooltipDisabled",e._nextButtonsDisabled())("matTooltipPosition","above")("disabled",e._nextButtonsDisabled()),c.Eb("aria-label",e._intl.nextPageLabel),c.Db(3),c.qc("ngIf",e.showFirstLastButtons))},directives:[i.n,r.b,p.a,u.c,b.a,i.m,l.j],styles:[".mat-paginator{display:block}.mat-paginator-outer-container{display:flex}.mat-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap-reverse;width:100%}.mat-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-paginator-page-size{margin-right:0;margin-left:8px}.mat-paginator-page-size-label{margin:0 4px}.mat-paginator-page-size-select{margin:6px 4px 0 4px;width:56px}.mat-paginator-page-size-select.mat-form-field-appearance-outline{width:64px}.mat-paginator-page-size-select.mat-form-field-appearance-fill{width:64px}.mat-paginator-range-label{margin:0 32px 0 24px}.mat-paginator-range-actions{display:flex;align-items:center}.mat-paginator-icon{width:28px;fill:currentColor}[dir=rtl] .mat-paginator-icon{transform:rotate(180deg)}\n"],encapsulation:2,changeDetection:0}),t})(),P=(()=>{class t{}return t.\u0275mod=c.Nb({type:t}),t.\u0275inj=c.Mb({factory:function(e){return new(e||t)},providers:[U],imports:[[i.c,r.c,b.b,p.b,l.h]]}),t})();
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
var w=n("UfDH"),j=n("D57K"),z=n("jOdJ"),M=n("20lr"),S=n("/It1"),I=n("05Mk"),C=n("eZII"),F=n("9MvL"),T=n("KuCG"),q=n("JuBR"),$=n("njY1"),J=n("mrqE"),E=864e5;function N(t,e){Object(J.a)(2,arguments);var n=Object(F.a)(t),i=Object(F.a)(e),a=n.getTime()-Object($.a)(n),s=i.getTime()-Object($.a)(i);return Math.round((a-s)/E)}function B(t,e){var n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function R(t,e){Object(J.a)(2,arguments);var n=Object(q.a)(t),i=Object(q.a)(e),a=B(n,i),s=Math.abs(N(n,i));n.setDate(n.getDate()-a*s);var o=B(n,i)===-a,c=a*(s-o);return 0===c?0:c}var A=n("CzDk"),Q=n("C05f"),H=n("ROBh"),K=n("HM3f"),W=n("mWib"),Y=n("TLy2"),Z=n("4e/d"),G=n("YtkY"),X=n("wqq/"),tt=n("dJst");let et=(()=>{class t{constructor(t){this._org=t,this._generate=new g.b,this._loading=new Q.a(""),this._active_bookings=new Q.a([]),this._options=new Q.a({start:new Date,end:new Date}),this._bookings_list=this._generate.pipe(Object(W.a)(500),Object(Y.a)(t=>{var e;console.log("Report:",t);const n=this._options.getValue();if(this._loading.next("Loading report details..."),!(null==n?void 0:n.type)&&!(null===(e=null==n?void 0:n.zones)||void 0===e?void 0:e.length))return Object(H.a)([]);const i=Object(F.a)((null==n?void 0:n.start)?new Date(n.start):new Date).valueOf(),a=Object(T.a)((null==n?void 0:n.end)?new Date(n.end):i).valueOf(),s=(null==n?void 0:n.zones)?n.zones.filter(t=>"All"!==t).join(","):"",o={period_start:Math.floor(i/1e3),period_end:Math.floor(a/1e3)};return"desks"===n.type?Object(I.e)(Object.assign(Object.assign({},o),{zones:s,type:"desk"})):Object(C.d)(Object.assign(Object.assign({},o),{zone_ids:s}))}),Object(Z.a)(t=>[]),Object(G.a)(t=>(this._loading.next(""),(null==t?void 0:t.length)||Object(M.m)("No bookings for the selected levels and period"),this._active_bookings.next(t||[]),t)),Object(X.a)()),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.bookings=this._active_bookings.asObservable(),this.counts=this._options.pipe(Object(W.a)(500),Object(Y.a)(t=>{const e=(t.zones||[]).filter(t=>-1!==t&&"All"!==t);return Promise.all(e.map(t=>Object(S.s)(t,{name:"desks"}).pipe(Object(G.a)(e=>[t,e.details.length])).toPromise()))}),Object(Z.a)(t=>[]),Object(G.a)(t=>{const e={};return this._active_bookings.next([]),t.forEach(([t,n])=>e[t]=n),e}),Object(X.a)()),this.stats=Object(K.b)([this.counts,this.bookings]).pipe(Object(G.a)(([t,e])=>e[0]instanceof C.a?function(t,e=8){const n=t.reduce((t,e)=>t+e.attendees.length,0),i=t.reduce((t,e)=>{var n;return t+(null===(n=e.system)||void 0===n?void 0:n.capacity)},0),a=t.reduce((t,e)=>t+e.duration,0)/(60*e),s=n/i;return{count:t.length,avg_length:t.reduce((t,e)=>t+e.duration,0)/t.length,efficiency:(a+s)/2,total_users:n,total_capacity:i,occupancy:s,utilisation:a,events:t}}(e,8*this.duration):function(t,e=1,n={}){console.log("Counts:",n);const i=Object.keys(n).reduce((t,e)=>t+(n[e]||0),0);return{total:i,count:t.length,utilisation:t.length/i,events:t}}(e||[],this.duration,t))),this._bookings_list.subscribe(t=>t)}get duration(){const t=this._options.getValue();return Math.abs(R(t.start,t.end))}generateReport(){this._generate.next((new Date).valueOf())}setOptions(t){var e,n,i,a,s,o,c;(null===(e=t.zones)||void 0===e?void 0:e.includes("All"))?t.zones=["All",...this._org.levelsForBuilding(this._org.building).map(t=>t.id)]:t.zones&&(null===(i=null===(n=this._options.getValue())||void 0===n?void 0:n.zones)||void 0===i?void 0:i.includes("All"))&&(t.zones=[]),(null===(a=t.start)||void 0===a?void 0:a.valueOf())!==(null===(s=this._options.getValue().start)||void 0===s?void 0:s.valueOf())&&(null===(o=t.end)||void 0===o?void 0:o.valueOf())!==(null===(c=this._options.getValue().end)||void 0===c?void 0:c.valueOf())&&this._options.next(Object.assign(Object.assign({},this._options.getValue()),t))}downloadReport(){const t=this._options.getValue(),e=this._active_bookings.getValue();Object(M.i)(`report+${t.type}+${Object(A.a)(t.start,"yyyy-MM-dd")}+${Object(A.a)(t.end,"yyyy-MM-dd")}.csv`,Object(M.l)(e.map(t=>{const e=t.toJSON();return delete e.zones,delete e.server_names,e})))}}return t.\u0275fac=function(e){return new(e||t)(c.cc(tt.c))},t.\u0275prov=c.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var nt=n("gcUQ"),it=n("csyo");function at(t,e){if(1&t&&(c.Vb(0,"mat-option",13),c.Lc(1),c.Ub()),2&t){const t=e.$implicit;c.qc("value",t.id),c.Db(1),c.Nc(" ",t.display_name||t.name," ")}}function st(t,e){1&t&&c.Qb(0,"mat-spinner",14),2&t&&c.qc("diameter",32)}function ot(t,e){1&t&&(c.Vb(0,"p"),c.Lc(1,"Generate Report"),c.Ub())}let ct=(()=>{class t extends M.b{constructor(t,e,n){super(),this._state=t,this._org=e,this._route=n,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(t=>""+t.id),this.levels=this._org.active_levels,this.loading=this._state.loading,this.bookings=this._state.bookings,this.options=this._state.options,this.generateReport=()=>this._state.generateReport(),this.downloadReport=()=>this._state.downloadReport(),this.setStartDate=t=>this._state.setOptions({start:new Date(t)}),this.setEndDate=t=>this._state.setOptions({end:new Date(t)}),this.setZones=t=>this._state.setOptions({zones:t})}ngOnInit(){return Object(j.a)(this,void 0,void 0,(function*(){yield this._org.initialised.pipe(Object(z.a)(t=>t)).toPromise(),this.subscription("route.query",this._route.queryParamMap.subscribe(t=>{if(t.has("zone_ids")){const e=t.get("zone_ids").split(",");if(e.length){const t=this._org.levelWithID(e);if(!t)return;this._org.building=this._org.buildings.find(e=>e.id===t.parent_id),this.setZones(e)}}}))}))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et),c.Pb(tt.c),c.Pb(s.a))},t.\u0275cmp=c.Jb({type:t,selectors:[["reports-options"]],features:[c.Ab],decls:27,vars:28,consts:[["appearance","outline",1,"w-48"],["multiple","","placeholder","Select Levels...",3,"ngModel","ngModelChange"],["value","All"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"w-64"],[3,"rangePicker"],["matStartDate","","placeholder","Start date",3,"ngModel","ngModelChange"],["matEndDate","","placeholder","End date",3,"ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["mat-button","",1,"ml-4",3,"disabled","click"],[3,"diameter",4,"ngIf"],[4,"ngIf"],[3,"value"],[3,"diameter"]],template:function(t,e){if(1&t&&(c.Vb(0,"mat-form-field",0),c.Vb(1,"mat-select",1),c.fc("ngModelChange",(function(t){return e.setZones(t)})),c.kc(2,"async"),c.Vb(3,"mat-option",2),c.Lc(4,"All Levels"),c.Ub(),c.Jc(5,at,2,2,"mat-option",3),c.kc(6,"async"),c.Ub(),c.Ub(),c.Vb(7,"mat-form-field",4),c.Vb(8,"mat-date-range-input",5),c.Vb(9,"input",6),c.fc("ngModelChange",(function(t){return t?e.setStartDate(t):""})),c.kc(10,"async"),c.Ub(),c.Vb(11,"input",7),c.fc("ngModelChange",(function(t){return t?e.setEndDate(t):""})),c.kc(12,"async"),c.Ub(),c.Ub(),c.Qb(13,"mat-datepicker-toggle",8),c.Qb(14,"mat-date-range-picker",null,9),c.Ub(),c.Vb(16,"button",10),c.fc("click",(function(){return e.generateReport()})),c.kc(17,"async"),c.kc(18,"async"),c.Jc(19,st,1,1,"mat-spinner",11),c.kc(20,"async"),c.Jc(21,ot,2,0,"p",12),c.kc(22,"async"),c.Ub(),c.Vb(23,"button",10),c.fc("click",(function(){return e.downloadReport()})),c.kc(24,"async"),c.Vb(25,"p"),c.Lc(26,"Download Report"),c.Ub(),c.Ub()),2&t){const t=c.vc(15);let n=null,i=null,a=null,s=null,o=null;c.Db(1),c.qc("ngModel",null==(n=c.lc(2,10,e.options))?null:n.zones),c.Db(4),c.qc("ngForOf",c.lc(6,12,e.levels)),c.Db(3),c.qc("rangePicker",t),c.Db(1),c.qc("ngModel",null==(i=c.lc(10,14,e.options))?null:i.start),c.Db(2),c.qc("ngModel",null==(a=c.lc(12,16,e.options))?null:a.end),c.Db(2),c.qc("for",t),c.Db(3),c.qc("disabled",!!c.lc(17,18,e.loading)||!(null!=(s=c.lc(18,20,e.options))&&null!=s.zones&&s.zones.length)),c.Db(3),c.qc("ngIf",c.lc(20,22,e.loading)),c.Db(2),c.qc("ngIf",!c.lc(22,24,e.loading)),c.Db(2),c.qc("disabled",!(null!=(o=c.lc(24,26,e.bookings))&&o.length))}},directives:[u.c,b.a,a.l,a.o,l.j,i.m,nt.a,nt.h,a.c,nt.g,nt.f,u.g,nt.b,r.b,i.n,it.b],pipes:[i.b],styles:["[_nghost-%COMP%] {\n                display: flex;\n                align-items: center;\n                background-color: #fff;\n                height: 5em;\n                padding: 0 1em;\n            }\n\n            button[_ngcontent-%COMP%] {\n                min-width: 0;\n                padding: 0 0.85rem;\n            }\n\n            mat-form-field[_ngcontent-%COMP%] {\n                height: 3.25em;\n                margin-left: 1em;\n            }\n\n            mat-slide-toggle[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] {\n                width: 5.5em;\n                white-space: initial;\n                line-height: 1.2em;\n            }"]}),t})();var lt=n("0/Ep");const rt=function(){return["/reports","desks"]},bt=function(){return["/reports","spaces"]};let pt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Jb({type:t,selectors:[["reports-menu"],["","reports-menu",""]],decls:20,vars:4,consts:[["matRipple","",1,"h-64","w-64","m-4","p-4","flex","flex-col","items-center","justify-center","bg-white","rounded","shadow","hover:bg-gray-100",3,"routerLink"],[1,"text-8xl"],[1,"text-xl","font-bold","mb-4"],[1,"flex","items-center"],[1,"ml-2"]],template:function(t,e){1&t&&(c.Vb(0,"a",0),c.Vb(1,"app-icon",1),c.Lc(2,"room"),c.Ub(),c.Vb(3,"h3",2),c.Lc(4,"Desks"),c.Ub(),c.Vb(5,"div",3),c.Vb(6,"p"),c.Lc(7,"View Report"),c.Ub(),c.Vb(8,"app-icon",4),c.Lc(9,"chevron_right"),c.Ub(),c.Ub(),c.Ub(),c.Vb(10,"a",0),c.Vb(11,"app-icon",1),c.Lc(12,"meeting_room"),c.Ub(),c.Vb(13,"h3",2),c.Lc(14,"Rooms"),c.Ub(),c.Vb(15,"div",3),c.Vb(16,"p"),c.Lc(17,"View Report"),c.Ub(),c.Vb(18,"app-icon",4),c.Lc(19,"chevron_right"),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.qc("routerLink",c.rc(2,rt)),c.Db(10),c.qc("routerLink",c.rc(3,bt)))},directives:[s.f,l.m,lt.a],styles:["[_nghost-%COMP%] {\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                background: var(--bg);\n            }"]}),t})();const dt=["app-reports",""];function gt(t,e){1&t&&c.Qb(0,"div",4)}let ut=(()=>{class t{constructor(t){this._router=t}get path(){const t=this._router.url.split("/");return t[t.length-1]}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(s.d))},t.\u0275cmp=c.Jb({type:t,selectors:[["","app-reports",""]],attrs:dt,decls:6,vars:1,consts:[[1,"h-full"],[1,"relative","overflow-hidden","flex","flex-col","flex-1","w-1/2","h-full"],[1,"flex-1","h-1/2","w-full","overflow-auto"],["reports-menu","","class","absolute inset-0",4,"ngIf"],["reports-menu","",1,"absolute","inset-0"]],template:function(t,e){1&t&&(c.Qb(0,"sidebar",0),c.Vb(1,"main",1),c.Qb(2,"reports-options"),c.Vb(3,"div",2),c.Qb(4,"router-outlet"),c.Ub(),c.Jc(5,gt,1,0,"div",3),c.Ub()),2&t&&(c.Db(5),c.qc("ngIf","reports"===e.path))},directives:[w.a,ct,s.h,i.n,pt],styles:["[_nghost-%COMP%] {\n                display: flex;\n                height: 100%;\n                width: 100%;\n                background: var(--bg);\n            }"]}),t})();var ht=n("6CBO"),ft=n("mjT4"),vt=n("QHQ3");let mt=(()=>{class t{constructor(t){this._state=t,this.total_count=this._state.stats.pipe(Object(G.a)(t=>t.count||0)),this.avg_length=this._state.stats.pipe(Object(G.a)(t=>Object(vt.a)({minutes:t.avg_length||0}))),this.efficiency=this._state.stats.pipe(Object(G.a)(t=>(100*(t.efficiency||0)).toFixed(1))),this.total_users=this._state.stats.pipe(Object(G.a)(t=>t.total_users||0)),this.total_capacity=this._state.stats.pipe(Object(G.a)(t=>t.total_capacity||0)),this.occupancy=this._state.stats.pipe(Object(G.a)(t=>(100*(t.occupancy||0)).toFixed(1))),this.utilisation=this._state.stats.pipe(Object(G.a)(t=>(100*(t.utilisation||0)).toFixed(1)))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et))},t.\u0275cmp=c.Jb({type:t,selectors:[["report-spaces-overall"]],decls:44,vars:21,consts:[[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"flex-1","flex","flex-col","items-center","justify-center"]],template:function(t,e){1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"h3"),c.Lc(3,"Total Bookings"),c.Ub(),c.Vb(4,"p"),c.Lc(5),c.kc(6,"async"),c.Ub(),c.Ub(),c.Vb(7,"div",1),c.Vb(8,"h3"),c.Lc(9,"Average Bookings Length"),c.Ub(),c.Vb(10,"p"),c.Lc(11),c.kc(12,"async"),c.Ub(),c.Ub(),c.Ub(),c.Vb(13,"div",0),c.Vb(14,"div",2),c.Vb(15,"h3"),c.Lc(16,"Overall Efficiency"),c.Ub(),c.Vb(17,"p"),c.Lc(18),c.kc(19,"async"),c.Ub(),c.Ub(),c.Vb(20,"div",2),c.Vb(21,"h3"),c.Lc(22,"Occupancy"),c.Ub(),c.Vb(23,"p"),c.Lc(24),c.kc(25,"async"),c.Ub(),c.Ub(),c.Vb(26,"div",2),c.Vb(27,"h3"),c.Lc(28,"Total Attendees"),c.Ub(),c.Vb(29,"p"),c.Lc(30),c.kc(31,"async"),c.Ub(),c.Ub(),c.Vb(32,"div",2),c.Vb(33,"h3"),c.Lc(34,"Total Capacity"),c.Ub(),c.Vb(35,"p"),c.Lc(36),c.kc(37,"async"),c.Ub(),c.Ub(),c.Vb(38,"div",2),c.Vb(39,"h3"),c.Lc(40,"Utilisation"),c.Ub(),c.Vb(41,"p"),c.Lc(42),c.kc(43,"async"),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.Db(5),c.Mc(c.lc(6,7,e.total_count)||0),c.Db(6),c.Mc(c.lc(12,9,e.avg_length)||"None"),c.Db(7),c.Nc("",c.lc(19,11,e.efficiency)||0,"%"),c.Db(6),c.Nc("",c.lc(25,13,e.occupancy)||0,"%"),c.Db(6),c.Mc(c.lc(31,15,e.total_users)||0),c.Db(6),c.Mc(c.lc(37,17,e.total_capacity)||0),c.Db(6),c.Nc("",c.lc(43,19,e.utilisation)||0,"%"))},pipes:[i.b],styles:["h3[_ngcontent-%COMP%] {\n            font-weight: 500;\n        }\n\n        p[_ngcontent-%COMP%]:not([simple]) {\n            font-size: 1.75rem;\n        }"]}),t})();var _t=n("J+dc"),yt=n("Bfk7");function Ot(t,e){if(1&t&&(c.Vb(0,"div",14),c.Vb(1,"div",15),c.Lc(2),c.Ub(),c.Vb(3,"div",16),c.Lc(4),c.Ub(),c.Vb(5,"div",17),c.Lc(6),c.Ub(),c.Vb(7,"div",16),c.Lc(8),c.kc(9,"toFixed"),c.Ub(),c.Vb(10,"div",17),c.Lc(11),c.Ub(),c.Vb(12,"div",18),c.Lc(13),c.kc(14,"toFixed"),c.Ub(),c.Ub()),2&t){const t=e.$implicit;c.Db(2),c.Nc(" ",t.name," "),c.Db(2),c.Mc(t.capacity),c.Db(2),c.Mc(t.count),c.Db(2),c.Nc(" ",c.lc(9,6,100*t.utilisation),"% "),c.Db(3),c.Mc(t.avg_attendees),c.Db(2),c.Nc(" ",c.lc(14,8,100*t.occupancy),"% ")}}let Ut=(()=>{class t{constructor(t){this._reports=t,this.page=0,this.sort$=new Q.a(null),this.space_list=Object(K.b)([this._reports.stats,this._reports.options,this.sort$]).pipe(Object(W.a)(300),Object(G.a)(([t,{start:e,end:n},i])=>{let a=[];for(const o of t.events){const t=o.resources||[];for(const e of t){a.find(t=>t.id===e.id)||a.push({id:e.id,name:e.display_name||e.name,capacity:e.capacity||1,count:0,attendees:0,avg_attendees:0,usage:0,utilisation:0,occupancy:0});const t=a.find(t=>t.id===e.id);t.count+=1,t.usage+=o.duration,t.attendees+=o.attendees.length}}const s=R(n,e);for(const o of a)o.avg_attendees=o.attendees/o.count,o.utilisation=o.usage/60/8/s,o.occupancy=o.avg_attendees/o.capacity;if(null==i?void 0:i.prop){const{prop:t,desc:e}=i;a=a.sort((e,n)=>"string"==typeof e[t]?e[t].localeCompare(n[t]):e[t]-n[t]),e||(a=a.reverse())}return this.page=0,a})),this.download=()=>Object(j.a)(this,void 0,void 0,(function*(){const t=yield this.space_list.pipe(Object(_t.a)(1)).toPromise();Object(M.i)("report-spaces-usage.csv",Object(M.l)(t))}))}toggleSort(t){const e=this.sort$.getValue();this.sort$.next(t!==(null==e?void 0:e.prop)||e.desc?{prop:t,desc:t!==(null==e?void 0:e.prop)}:{})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et))},t.\u0275cmp=c.Jb({type:t,selectors:[["report-spaces-space-listing"]],decls:51,vars:54,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["table-head","",1,"flex","items-center","font-medium","border-b","border-gray-200"],[1,"flex-1","w-1/6","p-4","flex","items-center",3,"click"],[1,"ml-2"],[1,"w-28","p-4","flex","items-center",3,"click"],[1,"w-44","p-4","flex","items-center",3,"click"],[1,"w-32","p-4","flex","items-center",3,"click"],["table-body",""],["table-row","","class","flex items-center border-b border-gray-200",4,"ngFor","ngForOf"],["table-footer",""],[3,"length","pageSize","hidePageSize","page"],["table-row","",1,"flex","items-center","border-b","border-gray-200"],[1,"flex-1","w-1/6","p-4","truncate"],[1,"w-28","p-4"],[1,"w-44","p-4"],[1,"w-32","p-4"]],template:function(t,e){if(1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"h3",2),c.Lc(3,"Space Utilisation"),c.Ub(),c.Vb(4,"button",3),c.fc("click",(function(){return e.download()})),c.Vb(5,"app-icon"),c.Lc(6,"download"),c.Ub(),c.Ub(),c.Ub(),c.Vb(7,"div",4),c.Vb(8,"div",5),c.fc("click",(function(){return e.toggleSort("name")})),c.kc(9,"async"),c.Lc(10," Name "),c.Vb(11,"app-icon",6),c.Lc(12),c.kc(13,"async"),c.Ub(),c.Ub(),c.Vb(14,"div",7),c.fc("click",(function(){return e.toggleSort("capacity")})),c.kc(15,"async"),c.Lc(16," Capacity "),c.Vb(17,"app-icon",6),c.Lc(18),c.kc(19,"async"),c.Ub(),c.Ub(),c.Vb(20,"div",8),c.fc("click",(function(){return e.toggleSort("count")})),c.kc(21,"async"),c.Lc(22," Meeting Count "),c.Vb(23,"app-icon",6),c.Lc(24),c.kc(25,"async"),c.Ub(),c.Ub(),c.Vb(26,"div",7),c.fc("click",(function(){return e.toggleSort("utilisation")})),c.kc(27,"async"),c.Lc(28," Utilisation "),c.Vb(29,"app-icon",6),c.Lc(30),c.kc(31,"async"),c.Ub(),c.Ub(),c.Vb(32,"div",8),c.fc("click",(function(){return e.toggleSort("avg_attendees")})),c.kc(33,"async"),c.Lc(34," Avg. Attendees "),c.Vb(35,"app-icon",6),c.Lc(36),c.kc(37,"async"),c.Ub(),c.Ub(),c.Vb(38,"div",9),c.fc("click",(function(){return e.toggleSort("occupancy")})),c.kc(39,"async"),c.Lc(40," Occupancy "),c.Vb(41,"app-icon",6),c.Lc(42),c.kc(43,"async"),c.Ub(),c.Ub(),c.Ub(),c.Vb(44,"div",10),c.Jc(45,Ot,15,10,"div",11),c.kc(46,"slice"),c.kc(47,"async"),c.Ub(),c.Vb(48,"div",12),c.Vb(49,"mat-paginator",13),c.fc("page",(function(t){return e.page=t.pageIndex})),c.kc(50,"async"),c.Ub(),c.Ub(),c.Ub()),2&t){let t=null,n=null,i=null,a=null,s=null,o=null,l=null,r=null,b=null,p=null,d=null,g=null,u=null;c.Db(8),c.Hb("active","name"===(null==(t=c.lc(9,22,e.sort$))?null:t.prop)),c.Db(4),c.Mc(null!=(n=c.lc(13,24,e.sort$))&&n.desc?"south":"north"),c.Db(2),c.Hb("active","capacity"===(null==(i=c.lc(15,26,e.sort$))?null:i.prop)),c.Db(4),c.Mc(null!=(a=c.lc(19,28,e.sort$))&&a.desc?"south":"north"),c.Db(2),c.Hb("active","count"===(null==(s=c.lc(21,30,e.sort$))?null:s.prop)),c.Db(4),c.Mc(null!=(o=c.lc(25,32,e.sort$))&&o.desc?"south":"north"),c.Db(2),c.Hb("active","utilisation"===(null==(l=c.lc(27,34,e.sort$))?null:l.prop)),c.Db(4),c.Mc(null!=(r=c.lc(31,36,e.sort$))&&r.desc?"south":"north"),c.Db(2),c.Hb("active","avg_attendees"===(null==(b=c.lc(33,38,e.sort$))?null:b.prop)),c.Db(4),c.Mc(null!=(p=c.lc(37,40,e.sort$))&&p.desc?"south":"north"),c.Db(2),c.Hb("active","occupancy"===(null==(d=c.lc(39,42,e.sort$))?null:d.prop)),c.Db(4),c.Mc(null!=(g=c.lc(43,44,e.sort$))&&g.desc?"south":"north"),c.Db(3),c.qc("ngForOf",c.nc(46,46,c.lc(47,50,e.space_list),7*e.page,7*e.page+7)),c.Db(4),c.qc("length",(null==(u=c.lc(50,52,e.space_list))?null:u.length)||0)("pageSize",7)("hidePageSize",!0)}},directives:[r.b,lt.a,i.m,L],pipes:[i.b,i.u,yt.a],styles:["[table-head][_ngcontent-%COMP%]    > div[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n                display: none;\n            }\n            [table-head][_ngcontent-%COMP%]    > div[_ngcontent-%COMP%]:hover   app-icon[_ngcontent-%COMP%] {\n                display: initial;\n                opacity: 0.5;\n            }\n            [table-head][_ngcontent-%COMP%]    > div.active[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n                display: initial;\n            }"]}),t})();function Vt(t,e){if(1&t&&(c.Vb(0,"div",14),c.Vb(1,"div",15),c.Lc(2),c.Ub(),c.Vb(3,"div",16),c.Lc(4),c.Ub(),c.Vb(5,"div",17),c.Lc(6),c.Ub(),c.Vb(7,"div",17),c.Lc(8),c.Ub(),c.Vb(9,"div",18),c.Lc(10),c.kc(11,"toFixed"),c.Ub(),c.Ub()),2&t){const t=e.$implicit;c.Db(2),c.Nc(" ",t.name," "),c.Db(2),c.Mc(t.capacity),c.Db(2),c.Mc(t.count),c.Db(2),c.Mc(t.avg_attendees),c.Db(2),c.Nc(" ",c.lc(11,5,100*t.occupancy),"% ")}}let kt=(()=>{class t{constructor(t){this._reports=t,this.page=0,this.sort$=new Q.a(null),this.user_list=Object(K.b)([this._reports.stats,this.sort$]).pipe(Object(W.a)(300),Object(G.a)(([t,e])=>{let n=[];for(const i of t.events){const t=i.attendees||[],e=i.resources.reduce((t,e)=>t+e.capacity,0)||1;for(const a of t){n.find(t=>t.email===a.email)||n.push({id:a.email,name:a.name,capacity:e,count:0,attendees:0,avg_attendees:0,occupancy:0});const t=n.find(t=>t.id===a.email);t.count+=1,t.attendees+=i.attendees.length}}for(const i of n)i.avg_attendees=i.attendees/i.count,i.occupancy=i.avg_attendees/i.capacity;if(null==e?void 0:e.prop){const{prop:t,desc:i}=e;n=n.sort((e,n)=>"string"==typeof e[t]?e[t].localeCompare(n[t]):e[t]-n[t]),i||(n=n.reverse())}return this.page=0,n}),Object(X.a)(1)),this.download=()=>Object(j.a)(this,void 0,void 0,(function*(){const t=yield this.user_list.pipe(Object(_t.a)(1)).toPromise();Object(M.i)("report-space-attendee-usage.csv",Object(M.l)(t))}))}toggleSort(t){const e=this.sort$.getValue();this.sort$.next(t!==(null==e?void 0:e.prop)||e.desc?{prop:t,desc:t!==(null==e?void 0:e.prop)}:{})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et))},t.\u0275cmp=c.Jb({type:t,selectors:[["report-spaces-user-listing"]],decls:45,vars:47,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","px-4","py-2","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["table-head","",1,"flex","items-center","font-medium","border-b","border-gray-200"],[1,"flex-1","w-1/6","p-4","flex","items-center",3,"click"],[1,"ml-2"],[1,"w-28","p-4","flex","items-center",3,"click"],[1,"w-44","p-4","flex","items-center",3,"click"],[1,"w-32","p-4","flex","items-center",3,"click"],["table-body",""],["table-row","","class","flex items-center border-b border-gray-200",4,"ngFor","ngForOf"],["table-footer",""],[3,"length","pageSize","hidePageSize","page"],["table-row","",1,"flex","items-center","border-b","border-gray-200"],[1,"flex-1","w-1/6","p-4","truncate"],[1,"w-28","p-4"],[1,"w-44","p-4"],[1,"w-32","p-4"]],template:function(t,e){if(1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"h3",2),c.Lc(3,"Staff Utilisation"),c.Ub(),c.Vb(4,"button",3),c.fc("click",(function(){return e.download()})),c.Vb(5,"app-icon"),c.Lc(6,"download"),c.Ub(),c.Ub(),c.Ub(),c.Vb(7,"div",4),c.Vb(8,"div",5),c.fc("click",(function(){return e.toggleSort("name")})),c.kc(9,"async"),c.Lc(10," Name "),c.Vb(11,"app-icon",6),c.Lc(12),c.kc(13,"async"),c.Ub(),c.Ub(),c.Vb(14,"div",7),c.fc("click",(function(){return e.toggleSort("capacity")})),c.kc(15,"async"),c.Lc(16," Capacity "),c.Vb(17,"app-icon",6),c.Lc(18),c.kc(19,"async"),c.Ub(),c.Ub(),c.Vb(20,"div",8),c.fc("click",(function(){return e.toggleSort("count")})),c.kc(21,"async"),c.Lc(22," Meeting Count "),c.Vb(23,"app-icon",6),c.Lc(24),c.kc(25,"async"),c.Ub(),c.Ub(),c.Vb(26,"div",8),c.fc("click",(function(){return e.toggleSort("avg_attendees")})),c.kc(27,"async"),c.Lc(28," Avg. Attendees "),c.Vb(29,"app-icon",6),c.Lc(30),c.kc(31,"async"),c.Ub(),c.Ub(),c.Vb(32,"div",9),c.fc("click",(function(){return e.toggleSort("occupancy")})),c.kc(33,"async"),c.Lc(34," Occupancy "),c.Vb(35,"app-icon",6),c.Lc(36),c.kc(37,"async"),c.Ub(),c.Ub(),c.Ub(),c.Vb(38,"div",10),c.Jc(39,Vt,12,7,"div",11),c.kc(40,"slice"),c.kc(41,"async"),c.Ub(),c.Vb(42,"div",12),c.Vb(43,"mat-paginator",13),c.fc("page",(function(t){return e.page=t.pageIndex})),c.kc(44,"async"),c.Ub(),c.Ub(),c.Ub()),2&t){let t=null,n=null,i=null,a=null,s=null,o=null,l=null,r=null,b=null,p=null,d=null;c.Db(8),c.Hb("active","name"===(null==(t=c.lc(9,19,e.sort$))?null:t.prop)),c.Db(4),c.Mc(null!=(n=c.lc(13,21,e.sort$))&&n.desc?"south":"north"),c.Db(2),c.Hb("active","capacity"===(null==(i=c.lc(15,23,e.sort$))?null:i.prop)),c.Db(4),c.Mc(null!=(a=c.lc(19,25,e.sort$))&&a.desc?"south":"north"),c.Db(2),c.Hb("active","count"===(null==(s=c.lc(21,27,e.sort$))?null:s.prop)),c.Db(4),c.Mc(null!=(o=c.lc(25,29,e.sort$))&&o.desc?"south":"north"),c.Db(2),c.Hb("active","avg_attendees"===(null==(l=c.lc(27,31,e.sort$))?null:l.prop)),c.Db(4),c.Mc(null!=(r=c.lc(31,33,e.sort$))&&r.desc?"south":"north"),c.Db(2),c.Hb("active","occupancy"===(null==(b=c.lc(33,35,e.sort$))?null:b.prop)),c.Db(4),c.Mc(null!=(p=c.lc(37,37,e.sort$))&&p.desc?"south":"north"),c.Db(3),c.qc("ngForOf",c.nc(40,39,c.lc(41,43,e.user_list),7*e.page,7*e.page+7)),c.Db(4),c.qc("length",(null==(d=c.lc(44,45,e.user_list))?null:d.length)||0)("pageSize",7)("hidePageSize",!0)}},directives:[r.b,lt.a,i.m,L],pipes:[i.b,i.u,yt.a],styles:["[table-head][_ngcontent-%COMP%]    > div[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n                display: none;\n            }\n            [table-head][_ngcontent-%COMP%]    > div[_ngcontent-%COMP%]:hover   app-icon[_ngcontent-%COMP%] {\n                display: initial;\n                opacity: 0.5;\n            }\n            [table-head][_ngcontent-%COMP%]    > div.active[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%] {\n                display: initial;\n            }"]}),t})();const xt=["report-spaces",""];function Dt(t,e){1&t&&(c.Tb(0),c.Qb(1,"report-spaces-overall"),c.Qb(2,"report-spaces-space-listing"),c.Qb(3,"report-spaces-user-listing"),c.Sb())}function Lt(t,e){if(1&t&&(c.Tb(0),c.Jc(1,Dt,4,0,"ng-container",0),c.kc(2,"async"),c.Sb()),2&t){const t=c.jc(),e=c.vc(5);c.Db(1),c.qc("ngIf",c.lc(2,2,t.total_count))("ngIfElse",e)}}function Pt(t,e){1&t&&(c.Vb(0,"div",3),c.Qb(1,"mat-spinner",4),c.Vb(2,"p",5),c.Lc(3,"Loading report data..."),c.Ub(),c.Ub()),2&t&&(c.Db(1),c.qc("diameter",32))}function wt(t,e){1&t&&(c.Vb(0,"div",3),c.Vb(1,"p",5),c.Lc(2," Select levels and time period to generate a report. "),c.Ub(),c.Ub())}let jt=(()=>{class t{constructor(t){this._state=t,this.total_count=this._state.stats.pipe(Object(G.a)(t=>t.count||0)),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"events"})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et))},t.\u0275cmp=c.Jb({type:t,selectors:[["","report-spaces",""]],attrs:xt,decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(t,e){if(1&t&&(c.Jc(0,Lt,3,4,"ng-container",0),c.kc(1,"async"),c.Jc(2,Pt,4,1,"ng-template",null,1,c.Kc),c.Jc(4,wt,3,0,"ng-template",null,2,c.Kc)),2&t){const t=c.vc(3);c.qc("ngIf",!c.lc(1,2,e.loading))("ngIfElse",t)}},directives:[i.n,mt,Ut,kt,it.b],pipes:[i.b],styles:[""]}),t})();var zt=n("R3DB"),Mt=n("XyEp");function St(t,e){if(1&t&&(c.Vb(0,"div",11),c.Vb(1,"div",5),c.Lc(2),c.kc(3,"date"),c.Ub(),c.Vb(4,"div",6),c.Lc(5),c.Ub(),c.Vb(6,"div",6),c.Lc(7),c.Ub(),c.Vb(8,"div",6),c.Lc(9),c.Ub(),c.Vb(10,"div",6),c.Lc(11),c.Ub(),c.Ub()),2&t){const t=e.$implicit;c.Db(2),c.Nc(" ",c.mc(3,6,t.date,"MMMM d, y(EEE)")," "),c.Db(3),c.Oc(" ",t.count||0," / ",t.total||0," "),c.Db(2),c.Mc(t.approved||0),c.Db(2),c.Mc(t.count||0),c.Db(2),c.Nc("",t.utilisation,"%")}}let It=(()=>{class t{constructor(t){this._state=t,this.page=0,this.day_list=Object(K.b)([this._state.options,this._state.stats]).pipe(Object(G.a)(([t,e])=>{const{start:n,end:i}=t;this.page=0;let a=n;const s=[];for(;Object(zt.a)(a,i);){const t=Object(F.a)(a).valueOf(),n=Object(T.a)(t).valueOf(),i=e.events.filter(e=>Object(M.w)(t,n,e.date,e.date+60*e.duration*1e3));s.push({date:t,total:e.total,free:e.total-i.length,approved:i.reduce((t,e)=>t+(e.approved?1:0),0),count:i.length,utilisation:(i.length/e.total*100).toFixed(1)}),a=Object(Mt.a)(a,1)}return s}),Object(X.a)(1)),this.download=()=>Object(j.a)(this,void 0,void 0,(function*(){let t=yield this.day_list.pipe(Object(_t.a)(1)).toPromise();t=t.map(t=>Object.assign(Object.assign({},t),{date:Object(A.a)(t.date,"MMMM d, y(EEE)")})),Object(M.i)("desks-usage.csv",Object(M.l)(t))}))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et))},t.\u0275cmp=c.Jb({type:t,selectors:[["report-desks-overall-list"]],decls:25,vars:12,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["table-head","",1,"flex","items-center","font-medium","border-b","border-gray-200"],[1,"w-1/3","p-4"],[1,"w-1/6","p-4"],["table-body",""],["table-row","","class","flex items-center border-b border-gray-200",4,"ngFor","ngForOf"],["table-footer",""],[3,"length","pageSize","hidePageSize","page"],["table-row","",1,"flex","items-center","border-b","border-gray-200"]],template:function(t,e){if(1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"h3",2),c.Lc(3,"Daily Utilisation"),c.Ub(),c.Vb(4,"button",3),c.fc("click",(function(){return e.download()})),c.Vb(5,"app-icon"),c.Lc(6,"download"),c.Ub(),c.Ub(),c.Ub(),c.Vb(7,"div",4),c.Vb(8,"div",5),c.Lc(9,"Date"),c.Ub(),c.Vb(10,"div",6),c.Lc(11,"Used Desks"),c.Ub(),c.Vb(12,"div",6),c.Lc(13,"Approved Bookings"),c.Ub(),c.Vb(14,"div",6),c.Lc(15,"Total Requests"),c.Ub(),c.Vb(16,"div",6),c.Lc(17,"Utilisation"),c.Ub(),c.Ub(),c.Vb(18,"div",7),c.Jc(19,St,12,9,"div",8),c.kc(20,"slice"),c.kc(21,"async"),c.Ub(),c.Vb(22,"div",9),c.Vb(23,"mat-paginator",10),c.fc("page",(function(t){return e.page=t.pageIndex})),c.kc(24,"async"),c.Ub(),c.Ub(),c.Ub()),2&t){let t=null;c.Db(19),c.qc("ngForOf",c.nc(20,4,c.lc(21,8,e.day_list),7*e.page,7*e.page+7)),c.Db(4),c.qc("length",(null==(t=c.lc(24,10,e.day_list))?null:t.length)||0)("pageSize",7)("hidePageSize",!0)}},directives:[r.b,lt.a,i.m,L],pipes:[i.u,i.b,i.f],encapsulation:2}),t})();function Ct(t,e){if(1&t&&(c.Vb(0,"div",11),c.Vb(1,"div",5),c.Lc(2),c.Ub(),c.Vb(3,"div",6),c.Lc(4),c.Ub(),c.Vb(5,"div",6),c.Lc(6),c.Ub(),c.Vb(7,"div",6),c.Lc(8),c.Ub(),c.Vb(9,"div",6),c.Lc(10),c.Ub(),c.Ub()),2&t){const t=e.$implicit;c.Db(2),c.Nc(" ",t.name," "),c.Db(2),c.Oc(" ",t.count||0," / ",t.total||0," "),c.Db(2),c.Mc(t.approved||0),c.Db(2),c.Mc(t.count||0),c.Db(2),c.Nc("",t.utilisation,"%")}}let Ft=(()=>{class t{constructor(t,e){this._state=t,this._org=e,this.page=0,this.level_list=Object(K.b)([this._state.options,this._state.stats,this._state.counts]).pipe(Object(G.a)(([t,e,n])=>{const{start:i,end:a,zones:s}=t,o=R(a,i);this.page=0;const c=[];console.log("Duration:",o);for(const l of s){if("All"===l)continue;const t=this._org.levelWithID([l]),i=n[l]||0,a=e.events.filter(t=>t.zones.includes(l));console.log("Evnets:",a.length);let s=(i*o-a.length)/o;s%1!=0&&(s=s.toFixed(2)),c.push({name:(null==t?void 0:t.display_name)||(null==t?void 0:t.name),free:s,total:i,count:a.length,utilisation:(a.length/(i*o)*100||0).toFixed(2)})}return c}),Object(X.a)(1)),this.download=()=>Object(j.a)(this,void 0,void 0,(function*(){let t=yield this.level_list.pipe(Object(_t.a)(1)).toPromise();Object(M.i)("desks-levels-usage.csv",Object(M.l)(t))}))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et),c.Pb(tt.c))},t.\u0275cmp=c.Jb({type:t,selectors:[["report-desks-levels-list"]],decls:25,vars:12,consts:[[1,"m-4","rounded","bg-white","shadow","overflow-hidden"],[1,"border-b","border-gray-300","p-4","flex","items-center"],[1,"font-bold","text-xl","flex-1"],["mat-icon-button","",3,"click"],["table-head","",1,"flex","items-center","font-medium","border-b","border-gray-200"],[1,"w-1/3","p-4"],[1,"w-1/6","p-4"],["table-body",""],["table-row","","class","flex items-center border-b border-gray-200",4,"ngFor","ngForOf"],["table-footer",""],[3,"length","pageSize","hidePageSize","page"],["table-row","",1,"flex","items-center","border-b","border-gray-200"]],template:function(t,e){if(1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"h3",2),c.Lc(3,"Level Utilisation"),c.Ub(),c.Vb(4,"button",3),c.fc("click",(function(){return e.download()})),c.Vb(5,"app-icon"),c.Lc(6,"download"),c.Ub(),c.Ub(),c.Ub(),c.Vb(7,"div",4),c.Vb(8,"div",5),c.Lc(9,"Level"),c.Ub(),c.Vb(10,"div",6),c.Lc(11,"Avg. Used Desks"),c.Ub(),c.Vb(12,"div",6),c.Lc(13,"Approved Bookings"),c.Ub(),c.Vb(14,"div",6),c.Lc(15,"Total Requests"),c.Ub(),c.Vb(16,"div",6),c.Lc(17,"Utilisation"),c.Ub(),c.Ub(),c.Vb(18,"div",7),c.Jc(19,Ct,11,6,"div",8),c.kc(20,"slice"),c.kc(21,"async"),c.Ub(),c.Vb(22,"div",9),c.Vb(23,"mat-paginator",10),c.fc("page",(function(t){return e.page=t.pageIndex})),c.kc(24,"async"),c.Ub(),c.Ub(),c.Ub()),2&t){let t=null;c.Db(19),c.qc("ngForOf",c.nc(20,4,c.lc(21,8,e.level_list),7*e.page,7*e.page+7)),c.Db(4),c.qc("length",(null==(t=c.lc(24,10,e.level_list))?null:t.length)||0)("pageSize",7)("hidePageSize",!0)}},directives:[r.b,lt.a,i.m,L],pipes:[i.u,i.b],encapsulation:2}),t})();const Tt=["report-desks",""];function qt(t,e){if(1&t&&(c.Tb(0),c.Vb(1,"div",3),c.Vb(2,"div",4),c.Vb(3,"h3"),c.Lc(4,"Total Bookings"),c.Ub(),c.Vb(5,"p"),c.Lc(6),c.kc(7,"async"),c.Ub(),c.Ub(),c.Vb(8,"div",4),c.Vb(9,"h3"),c.Lc(10,"Utilisation"),c.Ub(),c.Vb(11,"p"),c.Lc(12),c.kc(13,"async"),c.Ub(),c.Ub(),c.Ub(),c.Qb(14,"report-desks-overall-list"),c.Qb(15,"report-desks-levels-list"),c.Sb()),2&t){const t=c.jc(2);c.Db(6),c.Mc(c.lc(7,2,t.total_count)||0),c.Db(6),c.Nc("",c.lc(13,4,t.utilisation)||0,"%")}}function $t(t,e){if(1&t&&(c.Tb(0),c.Jc(1,qt,16,6,"ng-container",0),c.kc(2,"async"),c.Sb()),2&t){const t=c.jc(),e=c.vc(5);c.Db(1),c.qc("ngIf",c.lc(2,2,t.total_count))("ngIfElse",e)}}function Jt(t,e){1&t&&(c.Vb(0,"div",5),c.Qb(1,"mat-spinner",6),c.Vb(2,"p",7),c.Lc(3,"Loading report data..."),c.Ub(),c.Ub()),2&t&&(c.Db(1),c.qc("diameter",32))}function Et(t,e){1&t&&(c.Vb(0,"div",5),c.Vb(1,"p",7),c.Lc(2," Select levels and time period to generate a report. "),c.Ub(),c.Ub())}const Nt=[{path:"",component:ut,children:[{path:""},{path:"spaces",component:jt},{path:"desks",component:(()=>{class t{constructor(t){this._state=t,this.total_count=this._state.stats.pipe(Object(G.a)(t=>t.count||0)),this.utilisation=this._state.stats.pipe(Object(G.a)(t=>(100*(t.utilisation||0)).toFixed(1))),this.loading=this._state.loading}ngOnInit(){this._state.setOptions({type:"desks"})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(et))},t.\u0275cmp=c.Jb({type:t,selectors:[["","report-desks",""]],attrs:Tt,decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"m-4","p-4","rounded","bg-white","shadow","flex","justify-center","items-center","space-x-2"],[1,"flex","flex-col","items-center","flex-1"],[1,"h-full","w-full","flex","flex-col","items-center","p-8"],[1,"mb-4",3,"diameter"],["simple",""]],template:function(t,e){if(1&t&&(c.Jc(0,$t,3,4,"ng-container",0),c.kc(1,"async"),c.Jc(2,Jt,4,1,"ng-template",null,1,c.Kc),c.Jc(4,Et,3,0,"ng-template",null,2,c.Kc)),2&t){const t=c.vc(3);c.qc("ngIf",!c.lc(1,2,e.loading))("ngIfElse",t)}},directives:[i.n,It,Ft,it.b],pipes:[i.b],styles:["h3[_ngcontent-%COMP%] {\n                font-weight: 500;\n            }\n\n            p[_ngcontent-%COMP%]:not([simple]) {\n                font-size: 1.75rem;\n            }"]}),t})()},{path:"**",redirectTo:"desks"}]}];let Bt=(()=>{class t{}return t.\u0275mod=c.Nb({type:t}),t.\u0275inj=c.Mb({factory:function(e){return new(e||t)},imports:[[i.c,a.h,o.a,ht.a,ft.c,P,s.g.forChild(Nt)]]}),t})()}}]);
//# sourceMappingURL=reports-reports-module.53bd19393dca0212aeb5.js.map