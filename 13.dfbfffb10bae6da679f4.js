(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{cKIz:function(e,n,t){"use strict";t.r(n),t.d(n,"DayViewModule",(function(){return T}));var i=t("EM62"),c=t("2kYt"),s=t("nIj0"),o=t("sEIs"),a=t("oRDy"),l=t("6CBO"),r=t("mjT4"),d=t("UfDH"),h=t("D57K"),u=t("jOdJ"),g=t("20lr"),f=t("HWRp"),p=t("dJst"),v=t("PBFl"),m=t("0/Ep"),b=t("29Wa"),w=t("R7+U"),_=t("k8N0"),y=t("wrRZ"),k=t("mFH5");function x(e,n){if(1&e&&(i.mc(0,"mat-option",11),i.ad(1),i.lc()),2&e){const e=n.$implicit;i.Hc("value",e.id),i.Ub(1),i.cd(" ",e.display_name||e.name," ")}}const O=function(){return{class:"material-icons",content:"add"}};let C=(()=>{class e extends g.b{constructor(e,n,t,i){super(),this._state=e,this._org=n,this._route=t,this._router=i,this.zones=[],this.levels=this._org.active_levels,this.options=this._state.options,this.setDate=e=>this._state.setDate(e),this.setWeekends=e=>this._state.setUIOptions({show_weekends:e}),this.newBooking=e=>this._state.newBooking(e),this.updateZones=e=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:e.join(",")}}),this._state.setZones(e)}}ngOnInit(){return Object(h.a)(this,void 0,void 0,(function*(){yield this._org.initialised.pipe(Object(u.a)(e=>e)).toPromise(),this.subscription("route.query",this._route.queryParamMap.subscribe(e=>{if(e.has("zone_ids")){const n=e.get("zone_ids").split(",");if(n.length){const e=this._org.levelWithID(n);if(!e)return;this._org.building=this._org.buildings.find(n=>n.id===e.parent_id),this.zones=n}}})),this.subscription("levels",this._org.active_levels.subscribe(e=>{this.zones=this.zones.filter(n=>e.find(e=>e.id===n)),!this.zones.length&&e.length&&this.zones.push(e[0].id),this.updateZones(this.zones)}))}))}}return e.\u0275fac=function(n){return new(n||e)(i.gc(f.a),i.gc(p.c),i.gc(o.a),i.gc(o.d))},e.\u0275cmp=i.ac({type:e,selectors:[["week-view-topbar"]],features:[i.Rb],decls:15,vars:9,consts:[["mat-button","",1,"w-12","xl:w-auto",3,"click"],[1,"flex","items-center"],[1,"mr-2",3,"icon"],[1,"hidden","xl:block"],["appearance","outline"],["multiple","","placeholder","All Levels",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"m-2",3,"ngModel","ngModelChange"],[1,"text-xs"],[1,"flex-1","w-0"],[3,"dateChange"],[3,"value"]],template:function(e,n){if(1&e&&(i.mc(0,"button",0),i.xc("click",(function(){return n.newBooking()})),i.mc(1,"div",1),i.hc(2,"app-icon",2),i.mc(3,"div",3),i.ad(4,"New Booking"),i.lc(),i.lc(),i.lc(),i.mc(5,"mat-form-field",4),i.mc(6,"mat-select",5),i.xc("ngModelChange",(function(e){return n.zones=e}))("ngModelChange",(function(e){return n.updateZones(e)})),i.Yc(7,x,2,2,"mat-option",6),i.Cc(8,"async"),i.lc(),i.lc(),i.mc(9,"mat-slide-toggle",7),i.xc("ngModelChange",(function(e){return n.setWeekends(e)})),i.Cc(10,"async"),i.mc(11,"div",8),i.ad(12,"Show weekends"),i.lc(),i.lc(),i.hc(13,"div",9),i.mc(14,"date-options",10),i.xc("dateChange",(function(e){return n.setDate(e)})),i.lc()),2&e){let e=null;i.Ub(2),i.Hc("icon",i.Ic(8,O)),i.Ub(4),i.Hc("ngModel",n.zones),i.Ub(1),i.Hc("ngForOf",i.Dc(8,4,n.levels)),i.Ub(2),i.Hc("ngModel",null==(e=i.Dc(10,6,n.options))?null:e.show_weekends)}},directives:[v.b,m.a,b.c,w.a,s.l,s.o,c.m,_.a,y.a,k.l],pipes:[c.b],styles:["[_nghost-%COMP%] {\n                display: flex;\n                align-items: center;\n                background-color: #fff;\n                height: 5em;\n                padding: 0 1em;\n            }\n\n            button[_ngcontent-%COMP%] {\n                min-width: 0;\n                padding: 0 .85rem;\n            }\n\n            mat-form-field[_ngcontent-%COMP%] {\n                height: 3.25em;\n                width: 8em;\n                margin-left: 1em;\n            }"]}),e})();var M=t("XyEp"),P=t("zYp8"),j=t("KuCG"),U=t("C05f"),D=t("HM3f"),H=t("YtkY");let I=(()=>{class e{constructor(e){this._state=e,this.view=e=>this._state.setEvent(e)}}return e.\u0275fac=function(n){return new(n||e)(i.gc(f.a))},e.\u0275cmp=i.ac({type:e,selectors:[["week-view-event"]],inputs:{event:"event"},decls:8,vars:9,consts:[["content","","matRipple","",3,"click"],[1,"text-base"],[1,"text-sm"]],template:function(e,n){1&e&&(i.mc(0,"div",0),i.xc("click",(function(){return n.view(n.event)})),i.mc(1,"div",1),i.ad(2),i.lc(),i.mc(3,"div",2),i.ad(4),i.Cc(5,"date"),i.lc(),i.mc(6,"div",2),i.ad(7),i.lc(),i.lc()),2&e&&(i.Wb("m-2 p-2 bg-white shadow rounded border-2 text-black text-left font-normal "+("done"===n.event.state?"done":null==n.event?null:n.event.type)),i.Ub(2),i.bd(null==n.event?null:n.event.title),i.Ub(2),i.bd(i.Ec(5,6,null==n.event?null:n.event.date,"shortTime")),i.Ub(3),i.dd(" ",null==n.event?null:n.event.attendees.length," Attendee",1===(null==n.event?null:n.event.attendees.length)?"":"s"," "))},directives:[k.o],pipes:[c.f],styles:["button[_ngcontent-%COMP%] {\n                background: none !important;\n                border: none !important;\n            }\n\n            [content][_ngcontent-%COMP%] {\n                width: calc(100% - 1rem);\n            }\n\n            .done[_ngcontent-%COMP%] {\n                opacity: 0.5;\n            }\n\n            .done[_ngcontent-%COMP%]:hover {\n                opacity: 1;\n            }\n\n            .cancelled[_ngcontent-%COMP%] {\n                border-color: #626262;\n            }\n\n            .external[_ngcontent-%COMP%] {\n                border-color: #d85be0;\n            }\n\n            .internal[_ngcontent-%COMP%] {\n                border-color: #00a4c7;\n            }"]}),e})();function z(e,n){1&e&&i.hc(0,"week-view-event",5),2&e&&i.Hc("event",n.$implicit)}function E(e,n){if(1&e&&(i.kc(0),i.Yc(1,z,1,1,"week-view-event",4),i.Cc(2,"async"),i.jc()),2&e){const e=i.Bc();i.Ub(1),i.Hc("ngForOf",i.Dc(2,1,e.events))}}function F(e,n){1&e&&(i.mc(0,"p",6),i.ad(1,"No events"),i.lc())}let Y=(()=>{class e{constructor(e){this._state=e,this._index=new U.a(0),this.date=this._state.date.pipe(Object(H.a)(e=>Object(M.a)(Object(P.a)(e),this.index).valueOf())),this.events=Object(D.a)([this._state.filtered_week,this._state.date,this._index]).pipe(Object(H.a)(e=>{const[n,t,i]=e,c=Object(M.a)(Object(P.a)(t),i).valueOf(),s=Object(j.a)(c).valueOf();return n.filter(e=>Object(g.w)(c,s,e.date,e.date+60*e.duration*1e3))}))}ngOnChanges(e){e.index&&this._index.next(this.index)}}return e.\u0275fac=function(n){return new(n||e)(i.gc(f.a))},e.\u0275cmp=i.ac({type:e,selectors:[["week-view-day"]],inputs:{index:"index"},features:[i.Sb],decls:9,vars:10,consts:[[1,"flex","items-center","justify-center","border-b","border-gray-200","bg-gray-500","w-full","py-3","text-white"],[1,"flex-1","h-1/2","overflow-auto","w-full"],[4,"ngIf","ngIfElse"],["empty_state",""],[3,"event",4,"ngFor","ngForOf"],[3,"event"],[1,"text-center","p-2"]],template:function(e,n){if(1&e&&(i.mc(0,"header",0),i.ad(1),i.Cc(2,"date"),i.Cc(3,"async"),i.lc(),i.mc(4,"div",1),i.Yc(5,E,3,3,"ng-container",2),i.Cc(6,"async"),i.lc(),i.Yc(7,F,2,0,"ng-template",null,3,i.Zc)),2&e){const e=i.Mc(8);let t=null;i.Ub(1),i.cd(" ",i.Ec(2,3,i.Dc(3,6,n.date),"EEE, MMM d, y")," "),i.Ub(4),i.Hc("ngIf",null==(t=i.Dc(6,8,n.events))?null:t.length)("ngIfElse",e)}},directives:[c.n,c.m,I],pipes:[c.f,c.b],styles:["[_nghost-%COMP%] {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                height: 100%;\n            }"]}),e})();var B=t("66mq"),W=t("aFyq");function R(e,n){if(1&e&&(i.kc(0),i.hc(1,"week-view-day",5),i.jc()),2&e){const e=i.Bc().$implicit;i.Ub(1),i.Hc("index",e)}}function Z(e,n){if(1&e&&(i.kc(0),i.Yc(1,R,2,1,"ng-container",4),i.Cc(2,"async"),i.jc()),2&e){const e=n.$implicit,t=i.Bc();i.Ub(1),i.Hc("ngIf",0!==e&&6!==e||i.Dc(2,1,t.options).show_weekends)}}function q(e,n){1&e&&i.hc(0,"mat-progress-bar",6)}function J(e,n){if(1&e&&(i.hc(0,"view-event-details",7),i.Cc(1,"async")),2&e){const e=i.Bc();i.Hc("event",i.Dc(1,1,e.event))}}let $=(()=>{class e{constructor(e){this._state=e,this.weekdays=[0,1,2,3,4,5,6],this.options=this._state.options,this.event=this._state.event,this.loading=this._state.loading}ngOnInit(){this._state.startPollingWeek()}ngOnDestroy(){this._state.stopPolling()}}return e.\u0275fac=function(n){return new(n||e)(i.gc(f.a))},e.\u0275cmp=i.ac({type:e,selectors:[["week-view-timeline"]],decls:6,vars:7,consts:[[1,"flex","divide-x","border-gray-400","h-full"],[4,"ngFor","ngForOf"],["mode","indeterminate",4,"ngIf"],[3,"event",4,"ngIf"],[4,"ngIf"],[1,"h-full","flex-1",3,"index"],["mode","indeterminate"],[3,"event"]],template:function(e,n){1&e&&(i.mc(0,"div",0),i.Yc(1,Z,3,3,"ng-container",1),i.lc(),i.Yc(2,q,1,0,"mat-progress-bar",2),i.Cc(3,"async"),i.Yc(4,J,2,3,"view-event-details",3),i.Cc(5,"async")),2&e&&(i.Ub(1),i.Hc("ngForOf",n.weekdays),i.Ub(1),i.Hc("ngIf",i.Dc(3,3,n.loading)),i.Ub(2),i.Hc("ngIf",i.Dc(5,5,n.event)))},directives:[c.m,c.n,Y,B.a,W.a],pipes:[c.b],styles:["[_nghost-%COMP%] {\n                position: relative;\n                height: 100%;\n                width: 100%;\n                overflow: hidden;\n            }"]}),e})();const K=["app-weekview",""],N=[{path:"",component:(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=i.ac({type:e,selectors:[["","app-weekview",""]],attrs:K,decls:4,vars:0,consts:[[1,"relative","overflow-hidden"]],template:function(e,n){1&e&&(i.hc(0,"sidebar"),i.mc(1,"main",0),i.hc(2,"week-view-topbar"),i.hc(3,"week-view-timeline"),i.lc())},directives:[d.a,C,$],styles:["[_nghost-%COMP%] {\n                display: flex;\n                height: 100%;\n                width: 100%;\n                background: var(--bg);\n            }\n\n            sidebar[_ngcontent-%COMP%] {\n                height: 100%;\n            }\n\n            main[_ngcontent-%COMP%] {\n                display: flex;\n                flex-direction: column;\n                flex: 1;\n                min-width: 50%;\n                height: 100%;\n            }"]}),e})()}];let T=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({imports:[[c.c,s.h,a.a,l.a,r.c,o.g.forChild(N)]]}),e})()}}]);