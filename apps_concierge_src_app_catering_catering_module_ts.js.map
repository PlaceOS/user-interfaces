{"version":3,"sources":["./apps/concierge/src/app/catering/catering-topbar.component.ts","./apps/concierge/src/app/catering/catering.component.ts","./apps/concierge/src/app/catering/catering.module.ts"],"names":["CateringTopbarComponent","_orders","_catering","_org","_route","_router","super","zones","levels","this","active_levels","setDate","date","filters","updateZones","z","navigate","relativeTo","queryParams","zone_ids","join","addItem","editConfig","importMenu","initialised","pipe","first","_","toPromise","subscription","queryParamMap","subscribe","params","has","get","split","length","level","levelWithID","building","buildings","find","bld","id","parent_id","paramMap","page","filter","zone","lvl","push","CateringComponent","ROUTES","path","component","CateringModule"],"mappings":"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","file":"apps_concierge_src_app_catering_catering_module_ts.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { first } from 'rxjs/operators';\n\nimport { BaseClass } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { CateringOrdersService, CateringStateService } from '@placeos/catering';\n\n@Component({\n    selector: 'catering-topbar',\n    template: `\n        <mat-form-field appearance=\"outline\">\n            <mat-select\n                multiple\n                [(ngModel)]=\"zones\"\n                (ngModelChange)=\"updateZones($event)\"\n                placeholder=\"All Levels\"\n            >\n                <mat-option\n                    *ngFor=\"let level of levels | async\"\n                    [value]=\"level.id\"\n                >\n                    {{ level.display_name || level.name }}\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n        <button *ngIf=\"page === 'menu'\" mat-button (click)=\"addItem()\">\n            Add Item\n        </button>\n        <button *ngIf=\"page === 'menu'\" mat-button (click)=\"editConfig()\">\n            Edit Config\n        </button>\n        <button *ngIf=\"page === 'menu'\" mat-button (click)=\"importMenu()\">\n            Import Menu\n        </button>\n        <div class=\"flex-1 w-2\"></div>\n        <!-- <searchbar class=\"mr-2\"></searchbar> -->\n        <date-options (dateChange)=\"setDate($event)\"></date-options>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                align-items: center;\n                background-color: #fff;\n                height: 5em;\n                padding: 0 1em;\n                border-bottom: 1px solid #ccc;\n            }\n\n            :host > * + * {\n                margin-left: 0.5rem;\n            }\n\n            mat-form-field {\n                height: 3.25em;\n                width: 8em;\n            }\n        `,\n    ],\n})\nexport class CateringTopbarComponent extends BaseClass implements OnInit {\n    /** List of selected levels */\n    public zones: string[] = [];\n    /** Currently active page */\n    public page: string;\n    /** List of levels for the active building */\n    public readonly levels = this._org.active_levels;\n    /** Set filtered date */\n    public readonly setDate = (date) =>\n        (this._orders.filters = { ...this._orders.filters, date });\n    /** List of levels for the active building */\n    public readonly updateZones = (z) => {\n        this._router.navigate([], {\n            relativeTo: this._route,\n            queryParams: { zone_ids: z.join(',') },\n        });\n        this._orders.filters = { ...this._orders.filters, zones: [z] };\n    };\n\n    public readonly addItem = () => this._catering.addItem();\n    public readonly editConfig = () => this._catering.editConfig();\n    public readonly importMenu = () => this._catering.importMenu();\n\n    constructor(\n        private _orders: CateringOrdersService,\n        private _catering: CateringStateService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _router: Router\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('zone_ids')) {\n                    const zones = params.get('zone_ids').split(',');\n                    if (!zones.length) return;\n                    const level = this._org.levelWithID(zones);\n                    this.zones = zones;\n                    if (!level) return;\n                    this._org.building = this._org.buildings.find(\n                        (bld) => bld.id === level.parent_id\n                    );\n                }\n            })\n        );\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe(\n                (params) =>\n                    (this.page = params.has('view') ? params.get('view') : '')\n            )\n        );\n        this.subscription(\n            'levels',\n            this._org.active_levels.subscribe((levels) => {\n                this.zones = this.zones.filter((zone) =>\n                    levels.find((lvl) => lvl.id === zone)\n                );\n                if (!this.zones.length && levels.length) {\n                    this.zones.push(levels[0].id);\n                }\n                this.updateZones(this.zones);\n            })\n        );\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { BaseClass } from '@placeos/common';\n\n@Component({\n    selector: '[app-catering]',\n    template: `\n        <sidebar></sidebar>\n        <main class=\"relative w-full flex flex-col\">\n            <catering-topbar class=\"relative z-10\"></catering-topbar>\n            <ng-container [ngSwitch]=\"page\">\n                <catering-order-list\n                    *ngSwitchCase=\"'orders'\"\n                    class=\"flex-1\"\n                ></catering-order-list>\n                <catering-menu\n                    *ngSwitchCase=\"'menu'\"\n                    class=\"flex-1\"\n                ></catering-menu>\n                <div\n                    *ngSwitchDefault\n                    class=\"flex flex-1 items-center justify-center\"\n                >\n                    <a\n                        matRipple\n                        class=\"rounded flex flex-col items-center bg-white shadow text-black\"\n                        [routerLink]=\"['/catering', 'menu']\"\n                    >\n                        <div\n                            name=\"img\"\n                            class=\"relative w-full flex flex-1 items-center justify-center text-2xl text-white bg-center bg-cover\"\n                            [style.background-image]=\"'url(assets/menus.jpg)'\"\n                        >\n                            <div\n                                class=\"absolute inset-0 bg-black opacity-60 z-0\"\n                            ></div>\n                            <span class=\"z-10\">Menus and Pricing</span>\n                        </div>\n                        <div\n                            class=\"p-2 h-14 w-full text-sm text-center flex items-center justify-center\"\n                        >\n                            View and Edit Menus and Pricing\n                        </div>\n                    </a>\n                    <a\n                        matRipple\n                        class=\"rounded flex flex-col items-center bg-white shadow text-black\"\n                        [routerLink]=\"['/catering', 'orders']\"\n                    >\n                        <div\n                            name=\"img\"\n                            class=\"relative w-full flex flex-1 items-center justify-center text-2xl text-white bg-center bg-cover\"\n                            [style.background-image]=\"'url(assets/orders.jpg)'\"\n                        >\n                            <div\n                                class=\"absolute inset-0 bg-black opacity-60 z-0\"\n                            ></div>\n                            <span class=\"z-10\">Today's Orders</span>\n                        </div>\n                        <div\n                            class=\"p-2 h-14 w-full text-sm text-center flex items-center justify-center\"\n                        >\n                            View Catering Orders and their statuses upon arrival\n                        </div>\n                    </a>\n                </div>\n            </ng-container>\n        </main>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                height: 100%;\n                width: 100%;\n                background: var(--bg);\n            }\n\n            a {\n                width: 28rem;\n                height: 16rem;\n                margin-left: 0.5rem;\n                text-decoration: none;\n                transition: background 200ms;\n            }\n\n            a:hover {\n                background-color: #00000001 !important;\n            }\n\n            a:first-child {\n                margin: 0;\n            }\n        `,\n    ],\n})\nexport class CateringComponent extends BaseClass implements OnInit {\n    /** Page being displayed */\n    public page: string;\n\n    constructor(private _route: ActivatedRoute) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe(\n                (params) =>\n                    (this.page = params.has('view') ? params.get('view') : '')\n            )\n        );\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatChipsModule } from '@angular/material/chips';\n\nimport { UIModule } from '../ui/ui.module';\n\nimport { CateringComponent } from './catering.component';\nimport { CateringTopbarComponent } from './catering-topbar.component';\nimport { SharedCateringModule } from '@placeos/catering';\n\nconst ROUTES: Route[] = [\n    { path: '', component: CateringComponent },\n    { path: ':view', component: CateringComponent },\n];\n\n@NgModule({\n    declarations: [CateringComponent, CateringTopbarComponent],\n    imports: [\n        CommonModule,\n        FormsModule,\n        UIModule,\n        MatTabsModule,\n        MatChipsModule,\n        SharedCateringModule,\n        RouterModule.forChild(ROUTES),\n    ],\n})\nexport class CateringModule {}\n"],"sourceRoot":"webpack:///"}