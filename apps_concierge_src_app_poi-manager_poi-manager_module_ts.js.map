{"version":3,"file":"apps_concierge_src_app_poi-manager_poi-manager_module_ts.js","mappings":"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","names":["MapShowElementComponent","constructor","_data","this","hover","static","__ngFactoryType__","i0","MAP_FEATURE_DATA","core","VBU","selectors","decls","vars","consts","template","rf","ctx","lvl_r2","display_name","name","ctx_r2","page","tmp_2_0","search_results","length","poi_r5","location","_r4","$implicit","selected","next","id","hovered","SelectPOIMapModalComponent_ng_container_26_button_1_div_4_Template","value","SelectPOIMapModalComponent_ng_container_26_button_1_Template","_r6","last_page","SelectPOIMapModalComponent","AsyncHandler","poiItemFromMapsIndoorsItem","item","properties","externalId","roomId","building","floorName","area","Math","abs","geometry","bbox","_org","_maps_people","super","level","BuildingLevel","map_info","BehaviorSubject","search","changed","level_list","active_levels","actions","action","callback","e","p","selectID","features","combineLatest","pipe","map","s_id","h_id","unique","content","full_size","no_scale","data","filter","_","available$","debounceTime","switchMap","q","available","mapsindoors","services","LocationsService","getLocations","then","l","list","i","selected_item","unshift","of","Object","entries","w","h","toLowerCase","includes","sort","a","b","tap","floor","shareReplay","setMapInfo","info","ngOnInit","_this","_asyncToGenerator","levels","take","toPromise","level_id","find","onChange","Date","now","_this2","timeout","pos","short_list","x","y","push","MAT_DIALOG_DATA","i1","i2","i18n_0","$localize","$event","_r1","SelectPOIMapModalComponent_mat_option_14_Template","SelectPOIMapModalComponent_span_25_Template","SelectPOIMapModalComponent_ng_container_26_Template","SelectPOIMapModalComponent_div_28_Template","SelectPOIMapModalComponent_ng_template_29_Template","map_id","_c0","tmp_9_0","tmp_11_0","empty_state_r7","bld_r4","_r2","POIModalComponent_main_4_form_1_div_2_mat_option_6_Template","building_list","level_r5","POIModalComponent_main_4_form_1_div_4_mat_option_6_Template","selectPOIfromMap","_r7","form","patchValue","POIModalComponent_main_4_form_1_div_1_Template","POIModalComponent_main_4_form_1_div_2_Template","POIModalComponent_main_4_form_1_div_4_Template","location_type","POIModalComponent_main_4_form_1_div_15_Template","POIModalComponent_main_4_form_1_div_16_Template","controls","tmp_5_0","POIModalComponent_main_4_form_1_Template","_r8","save","POIModalComponent","_dialog_ref","_settings","_dialog","loading","Array","FormGroup","FormControl","Validators","required","can_search","ref","open","getRawValue","afterClosed","subscribe","d","componentInstance","valid","notifyError","getInvalidFields","join","randomString","short_link_id","path","get","public_key","uri","updateShortURL","description","window","origin","encodeURIComponent","createShortURL","metadata","showMetadata","organisation","details","lvl","localeCompare","resp","updateMetadata","catch","close","i3","POIModalComponent_button_3_Template","POIModalComponent_main_4_Template","POIModalComponent_footer_5_Template","POIModalComponent_ng_template_6_Template","load_state_r9","POIManagementService","_options","_change","options","asObservable","_features","active_building","catchError","mapping","levelsForBuilding","flatten","filtered_features","setFilters","getValue","setSearchString","editPointOfInterest","poi","removePointOfInterest","openConfirmModal","title","icon","confirm_text","reason","notifySuccess","jDH","factory","ɵfac","providedIn","row_r1","POIListComponent_ng_template_5_div_0_Template","ctx_r4","print","row_r4","qr_link","qr_code","_r3","row","loadQrCode","loadPublicQrCode","POIListComponent_ng_template_7_ng_template_9_Template","edit","remove","qr_menu_r7","menu_r8","POIListComponent","kiosk_url","_manager","region","link","generateQRCode","split","POIListComponent_ng_template_3_Template","POIListComponent_ng_template_5_Template","POIListComponent_ng_template_7_Template","_c5","_c1","level_template_r9","_c2","_c3","bool_template_r10","_c4","action_template_r11","bld_r3","ctx_r1","POIManagerComponent_div_10_mat_option_3_Template","buildings","POIManagerComponent","bld","use_region","_state","new","active_buildings","attrs","POIManagerComponent_div_10_Template","tmp_0_0","tmp_1_0","ROUTES","component","POIManagerModule","$C","G2t","CommonModule","FormsModule","UIModule","SharedSpacesModule","SharedUsersModule","MatChipsModule","RouterModule","forChild","MapLocation","type","position","asset_id","map_width","map_height","variance","last_seen","getUnixTime","at_location","coordinates_from"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./apps/concierge/src/app/poi-manager/map-show-element.component.ts","./apps/concierge/src/app/poi-manager/select-poi-map-modal.component.ts","./apps/concierge/src/app/poi-manager/poi-modal.component.ts","./apps/concierge/src/app/poi-manager/poi-management.service.ts","./apps/concierge/src/app/poi-manager/poi-list.component.ts","./apps/concierge/src/app/poi-manager/poi-manager.component.ts","./apps/concierge/src/app/poi-manager/poi-manager.module.ts","./libs/users/src/lib/location.class.ts"],"sourcesContent":["import { Component, Inject } from '@angular/core';\nimport { MAP_FEATURE_DATA } from '@placeos/components';\n\n@Component({\n    selector: 'map-show-element',\n    template: `\n        <div\n            class=\"relative w-full h-full border-4\"\n            [class.border-warning]=\"hover\"\n            [class.border-success]=\"!hover\"\n        >\n            <div\n                class=\"opacity-40 absolute inset-0\"\n                [class.bg-warning]=\"hover\"\n                [class.bg-success]=\"!hover\"\n            ></div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class MapShowElementComponent {\n    constructor(@Inject(MAP_FEATURE_DATA) private _data: { hover: boolean }) {}\n\n    public get hover() {\n        return !!this._data?.hover;\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { AsyncHandler, MapsPeopleService, unique } from '@placeos/common';\nimport { BuildingLevel, OrganisationService } from '@placeos/organisation';\nimport { Rect } from '@placeos/svg-viewer/dist/types';\nimport { BehaviorSubject, combineLatest, of } from 'rxjs';\nimport {\n    debounceTime,\n    map,\n    shareReplay,\n    switchMap,\n    take,\n    tap,\n} from 'rxjs/operators';\nimport { MapShowElementComponent } from './map-show-element.component';\nimport { PointOfInterest } from './poi-management.service';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\ntype BoundsMap = Record<string, Rect>;\n\ndeclare let mapsindoors: any;\n\n@Component({\n    selector: 'select-poi-map-modal',\n    template: `\n        <header>\n            <h2>Select Point of Interest from Map</h2>\n            <button icon matRipple mat-dialog-close>\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            class=\"flex min-w-[80vw] max-w-[calc(100vw-2rem)] sm:max-w-[64rem] max-h-[75vh] h-[75vh] overflow-hidden\"\n        >\n            <div map class=\"relative h-full flex-1 w-1/2 bg-base-200\">\n                <interactive-map\n                    [src]=\"level?.map_id\"\n                    [actions]=\"actions\"\n                    [features]=\"features | async\"\n                    [options]=\"{ controls: true }\"\n                    [focus]=\"selected.value\"\n                    (mapInfo)=\"setMapInfo($event)\"\n                ></interactive-map>\n            </div>\n            <div\n                poi-list\n                class=\"relative flex flex-col h-full w-[20rem] border-l border-base-300 shadow\"\n            >\n                <div search class=\"flex flex-col border-b border-base-200 p-2\">\n                    <mat-form-field\n                        class=\"w-full no-subscript mb-2\"\n                        appearance=\"outline\"\n                    >\n                        <mat-select\n                            name=\"level\"\n                            [(ngModel)]=\"level\"\n                            (ngModelChange)=\"onChange()\"\n                        >\n                            <mat-option\n                                *ngFor=\"let lvl of level_list | async\"\n                                [value]=\"lvl\"\n                            >\n                                {{ lvl.display_name || lvl.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                    <mat-form-field\n                        class=\"w-full no-subscript\"\n                        appearance=\"outline\"\n                    >\n                        <input\n                            matInput\n                            name=\"search\"\n                            placeholder=\"Search\"\n                            [ngModel]=\"search | async\"\n                            (ngModelChange)=\"search.next($event)\"\n                            i18n-placeholder=\"@@searchPlaceholder\"\n                        />\n                        <app-icon matPrefix class=\"text-2xl\">search</app-icon>\n                    </mat-form-field>\n                </div>\n                <div\n                    list\n                    class=\"flex flex-col flex-1 h-1/2 overflow-auto space-y-2 px-2\"\n                >\n                    <div class=\"sticky top-0 w-full bg-base-100 px-1 py-3 z-10\">\n                        Results ({{ (search_results | async)?.length || 0 }})\n                        <span *ngIf=\"last_page\">\n                            {{ page * 100 + 1 }} -\n                            {{\n                                (search_results | async)?.length >\n                                page * 100 + 100\n                                    ? page * 100 + 100\n                                    : (search_results | async)?.length\n                            }}\n                        </span>\n                    </div>\n                    <ng-container\n                        *ngIf=\"\n                            (search_results | async)?.length;\n                            else empty_state\n                        \"\n                    >\n                        <button\n                            btn\n                            matRipple\n                            *ngFor=\"\n                                let poi of search_results\n                                    | async\n                                    | slice: page * 100 : page * 100 + 100\n                            \"\n                            class=\"clear flex items-center text-left w-full hover:bg-base-200 rounded\"\n                            [class.!bg-primary]=\"poi.id === selected.value\"\n                            [class.!text-primary-content]=\"\n                                poi.id === selected.value\n                            \"\n                            (click)=\"selected.next(poi.id)\"\n                            (mouseover)=\"hovered.next(poi.id)\"\n                        >\n                            <div class=\"flex flex-col w-full\">\n                                <div class=\"\">{{ poi.name || poi.id }}</div>\n                                <div\n                                    class=\"text-xs opacity-30\"\n                                    *ngIf=\"poi.location\"\n                                >\n                                    {{ poi.location }}\n                                </div>\n                            </div>\n                        </button>\n                    </ng-container>\n                    <div\n                        pagination\n                        *ngIf=\"last_page > 0\"\n                        class=\"sticky flex items-center justify-center bottom-0 w-full bg-base-100 p-2 z-10 space-x-1\"\n                    >\n                        <button\n                            icon\n                            matRipple\n                            class=\"border border-base-200 rounded\"\n                            [disabled]=\"page === 0\"\n                            (click)=\"page = page - 1\"\n                        >\n                            <app-icon>chevron_left</app-icon>\n                        </button>\n                        <button\n                            icon\n                            matRipple\n                            [class.!bg-secondary]=\"page === 0\"\n                            [class.text-secondary-content]=\"page === 0\"\n                            [class.!rounded-full]=\"page === 0\"\n                            (click)=\"page = 0\"\n                        >\n                            1\n                        </button>\n                        <button icon [class.opacity-0]=\"page < 2\">\n                            <app-icon>more_horiz</app-icon>\n                        </button>\n                        <button\n                            icon\n                            matRipple\n                            class=\"!bg-secondary text-secondary-content\"\n                            [class.opacity-0]=\"page == 0 || page == last_page\"\n                        >\n                            {{ page + 1 }}\n                        </button>\n                        <button icon [class.opacity-0]=\"page > last_page - 2\">\n                            <app-icon>more_horiz</app-icon>\n                        </button>\n                        <button\n                            icon\n                            matRipple\n                            class=\"border border-base-200 rounded\"\n                            [class.!bg-secondary]=\"page === last_page\"\n                            [class.text-secondary-content]=\"page === last_page\"\n                            [class.!rounded-full]=\"page === last_page\"\n                            (click)=\"page = last_page\"\n                        >\n                            {{ last_page + 1 }}\n                        </button>\n                        <button\n                            icon\n                            matRipple\n                            class=\"border border-base-200 rounded\"\n                            [disabled]=\"page === last_page\"\n                            (click)=\"page = page + 1\"\n                        >\n                            <app-icon>chevron_right</app-icon>\n                        </button>\n                    </div>\n                    <ng-template #empty_state>\n                        <div\n                            class=\"flex flex-col items-center justify-center h-full flex-1 space-y-4\"\n                        >\n                            <img\n                                src=\"assets/icons/no-results.svg\"\n                                class=\"w-36\"\n                            />\n                            <div class=\"text-center opacity-30\">\n                                No results found\n                            </div>\n                        </div>\n                    </ng-template>\n                </div>\n                <div actions class=\"p-2 border-t border-base-200\">\n                    <button\n                        btn\n                        matRipple\n                        [disabled]=\"!selected.value\"\n                        class=\"w-full\"\n                        [mat-dialog-close]=\"selected.value\"\n                    >\n                        Save\n                    </button>\n                </div>\n            </div>\n        </main>\n    `,\n    styles: [``],\n})\nexport class SelectPOIMapModalComponent extends AsyncHandler {\n    public selected_item: any;\n    public level: BuildingLevel = new BuildingLevel();\n    public map_info: BoundsMap = {};\n    public page = 0;\n    public last_page = 0;\n    public readonly selected = new BehaviorSubject<string>('');\n    public readonly hovered = new BehaviorSubject<string>('');\n    public readonly search = new BehaviorSubject('');\n    public readonly changed = new BehaviorSubject(0);\n    public readonly level_list = this._org.active_levels;\n    public readonly actions = [\n        { id: '*', action: 'click', callback: (e, p) => this.selectID(p || e) },\n    ];\n    public readonly features = combineLatest([\n        this.selected,\n        this.hovered,\n    ]).pipe(\n        map(([s_id, h_id]) =>\n            unique(\n                [\n                    {\n                        location: s_id,\n                        content: MapShowElementComponent,\n                        full_size: true,\n                        no_scale: true,\n                    },\n                    {\n                        location: h_id,\n                        content: MapShowElementComponent,\n                        data: { hover: true },\n                        full_size: true,\n                        no_scale: true,\n                    },\n                ].filter((_) => _.location),\n                'location',\n            ),\n        ),\n    );\n\n    public poiItemFromMapsIndoorsItem(item: any) {\n        return {\n            id: item.properties.externalId || item.properties.roomId || item.id,\n            name: item.properties.name,\n            location: item.properties.building\n                ? `${item.properties.building}, Level ${item.properties.floorName}`\n                : '',\n            area:\n                Math.abs(item.geometry.bbox[0] - item.geometry.bbox[2]) *\n                Math.abs(item.geometry.bbox[1] - item.geometry.bbox[3]),\n        };\n    }\n\n    public readonly search_results = combineLatest([\n        this.search,\n        this._maps_people.available$,\n        this.changed,\n    ]).pipe(\n        debounceTime(300),\n        switchMap(([q, available]) => {\n            return available\n                ? q.length > 2\n                    ? mapsindoors?.services.LocationsService.getLocations({\n                          q,\n                      }).then((l) => {\n                          const list = l.map((i) =>\n                              this.poiItemFromMapsIndoorsItem(i),\n                          );\n                          if (this.selected_item) {\n                              list.unshift(\n                                  this.poiItemFromMapsIndoorsItem(\n                                      this.selected_item,\n                                  ),\n                              );\n                          }\n                          return list;\n                      })\n                    : of(\n                          this.selected_item\n                              ? [\n                                    this.poiItemFromMapsIndoorsItem(\n                                        this.selected_item,\n                                    ),\n                                ]\n                              : [],\n                      )\n                : of(\n                      Object.entries(this.map_info)\n                          .map(([id, bbox]) => ({\n                              id,\n                              area: bbox.w * bbox.h,\n                          }))\n                          .filter(\n                              ({ id, area }) =>\n                                  id.toLowerCase().includes(q.toLowerCase()) &&\n                                  area < 0.5,\n                          )\n                          .sort((a, b) => b.area - a.area),\n                  );\n        }),\n        tap((l: any[]) => {\n            this.page = 0;\n            this.last_page = Math.floor(l.length / 100);\n        }),\n        shareReplay(1),\n    );\n\n    public readonly setMapInfo = (info: BoundsMap) => (this.map_info = info);\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: PointOfInterest,\n        private _org: OrganisationService,\n        private _maps_people: MapsPeopleService,\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        if (this._data?.location && typeof this._data.location === 'string') {\n            this.selected.next(this._data.location as string);\n        }\n        const levels = await this.level_list.pipe(take(1)).toPromise();\n        if (levels.length) {\n            let level = levels[0];\n            if (this._data?.level_id) {\n                level =\n                    levels.find((_) => _.id === this._data.level_id) || level;\n            }\n            this.level = level;\n        }\n    }\n\n    public onChange() {\n        this.changed.next(Date.now());\n    }\n\n    public selectID(e: any) {\n        this.timeout('select_id', async () => {\n            const use_maps_indoors = await this._maps_people.available$\n                .pipe(take(1))\n                .toPromise();\n            if (!use_maps_indoors) {\n                const pos: { x: number; y: number } = e;\n                const short_list: [string, number][] = [];\n                for (const [id, bbox] of Object.entries(this.map_info)) {\n                    if (\n                        bbox.x <= pos.x &&\n                        pos.x <= bbox.x + bbox.w &&\n                        bbox.y <= pos.y &&\n                        pos.y <= bbox.y + bbox.h\n                    ) {\n                        short_list.push([id, bbox.h * bbox.w]);\n                    }\n                }\n                short_list.sort((a, b) => a[1] - b[1]);\n                short_list.filter(([_, a]) => a <= 0.5);\n                if (short_list.length) {\n                    this.selected.next(short_list[0][0]);\n                }\n            } else {\n                const id =\n                    e.properties?.externalId || e.properties?.roomId || e.id;\n                this.selected_item = e;\n                if (id) this.selected.next(id);\n                this.changed.next(Date.now());\n            }\n        });\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialog,\n    MatDialogRef,\n} from '@angular/material/dialog';\nimport {\n    AsyncHandler,\n    SettingsService,\n    createShortURL,\n    getInvalidFields,\n    notifyError,\n    randomString,\n    updateShortURL,\n} from '@placeos/common';\nimport { OrganisationService, Building } from '@placeos/organisation';\nimport { showMetadata, updateMetadata } from '@placeos/ts-client';\nimport { PointOfInterest } from './poi-management.service';\nimport { take } from 'rxjs/operators';\nimport { SelectPOIMapModalComponent } from './select-poi-map-modal.component';\n\n@Component({\n    selector: 'poi-modal',\n    template: `\n        <header>\n            <h2>{{ form.value.id ? 'Edit' : 'Add' }} Point Of Interest</h2>\n            <button btn icon mat-dialog-close *ngIf=\"!loading\">\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            class=\"max-h-[65vh] overflow-y-auto overflow-x-hidden p-4\"\n            *ngIf=\"!loading; else load_state\"\n        >\n            <form\n                system\n                class=\"flex flex-col w-[28rem] max-w-[calc(100vw-4rem)]\"\n                *ngIf=\"form\"\n                [formGroup]=\"form\"\n            >\n                <div class=\"flex flex-col\" *ngIf=\"form.controls.name\">\n                    <label for=\"name\" i18n=\"@@nameLabel\">\n                        Name<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"name\"\n                            placeholder=\"Name\"\n                            i18n-placeholder=\"@@namePlaceholder\"\n                            formControlName=\"name\"\n                        />\n                    </mat-form-field>\n                </div>\n                <div\n                    class=\"flex flex-col\"\n                    *ngIf=\"(building_list | async)?.length > 1\"\n                >\n                    <label for=\"name\" i18n=\"@@nameLabel\">\n                        Building<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            [(ngModel)]=\"building\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            placeholder=\"Select Building\"\n                        >\n                            <mat-option\n                                *ngFor=\"let bld of building_list | async\"\n                                [value]=\"bld\"\n                            >\n                                {{ bld.display_name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col\" *ngIf=\"form.controls.level_id\">\n                    <label for=\"name\" i18n=\"@@nameLabel\">\n                        Level<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            formControlName=\"level_id\"\n                            placeholder=\"Select Level\"\n                        >\n                            <mat-option\n                                *ngFor=\"let level of level_list | async\"\n                                [value]=\"level.id\"\n                            >\n                                {{ level.display_name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col\">\n                    <label for=\"name\" i18n=\"@@nameLabel\">\n                        Location<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            [(ngModel)]=\"location_type\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            placeholder=\"Location Type\"\n                        >\n                            <mat-option value=\"map_id\">Map ID</mat-option>\n                            <mat-option value=\"coordinates\"\n                                >Coordinates</mat-option\n                            >\n                        </mat-select>\n                    </mat-form-field>\n                    <div\n                        class=\"flex items-center space-x-2 pb-2\"\n                        *ngIf=\"location_type === 'map_id'\"\n                    >\n                        <mat-form-field\n                            class=\"no-subscript\"\n                            appearance=\"outline\"\n                        >\n                            <input\n                                matInput\n                                name=\"location\"\n                                placeholder=\"Location\"\n                                i18n-placeholder=\"@@locationPlaceholder\"\n                                formControlName=\"location\"\n                            />\n                        </mat-form-field>\n                        <button\n                            icon\n                            matRipple\n                            class=\"rounded border border-base-300 h-12 w-12\"\n                            (click)=\"selectPOIfromMap()\"\n                        >\n                            <app-icon>place</app-icon>\n                        </button>\n                    </div>\n                    <div\n                        class=\"flex items-center space-x-2\"\n                        *ngIf=\"location_type === 'coordinates'\"\n                    >\n                        <mat-form-field appearance=\"outline\" class=\"flex-1\">\n                            <input\n                                matInput\n                                name=\"latitude\"\n                                [ngModel]=\"form.value.location[0]\"\n                                (ngModelChange)=\"\n                                    form.patchValue({\n                                        location: [\n                                            $event,\n                                            form.value.location[1],\n                                        ],\n                                    })\n                                \"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                            />\n                        </mat-form-field>\n                        <mat-form-field appearance=\"outline\" class=\"flex-1\">\n                            <input\n                                matInput\n                                name=\"longitude\"\n                                [ngModel]=\"form.value.location[1]\"\n                                (ngModelChange)=\"\n                                    form.patchValue({\n                                        location: [\n                                            form.value.location[0],\n                                            $event,\n                                        ],\n                                    })\n                                \"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                            />\n                        </mat-form-field>\n                    </div>\n                    <div class=\"pt-2\">\n                        <mat-checkbox formControlName=\"can_search\">\n                            Is Searchable?\n                        </mat-checkbox>\n                    </div>\n                </div>\n            </form>\n        </main>\n        <footer\n            class=\"p-2 flex justify-end border-t border-base-200\"\n            *ngIf=\"!loading\"\n        >\n            <button btn class=\"w-32\" (click)=\"save()\">Save</button>\n        </footer>\n        <ng-template #load_state>\n            <div class=\"flex flex-col items-center justify-center w-64 h-64\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p class=\"mt-4\">Saving Point Of Interest...</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class POIModalComponent extends AsyncHandler {\n    public loading = false;\n    public location_type =\n        this._data?.location instanceof Array ? 'coordinates' : 'map_id';\n    public readonly building_list = this._org.building_list;\n    public readonly level_list = this._org.active_levels;\n\n    public get building() {\n        return this._org.building;\n    }\n\n    public set building(value: Building) {\n        this._org.building = value;\n    }\n\n    public readonly form = new FormGroup({\n        id: new FormControl(this._data?.id || ''),\n        name: new FormControl(this._data?.name || '', [Validators.required]),\n        level_id: new FormControl(this._data?.level_id || '', [\n            Validators.required,\n        ]),\n        location: new FormControl(this._data?.location || '', [\n            Validators.required,\n        ]),\n        can_search: new FormControl(this._data?.can_search ?? false),\n    });\n\n    constructor(\n        private _org: OrganisationService,\n        @Inject(MAT_DIALOG_DATA) private _data: PointOfInterest | undefined,\n        private _dialog_ref: MatDialogRef<POIModalComponent>,\n        private _settings: SettingsService,\n        private _dialog: MatDialog,\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        if (!this.form.value.level_id) {\n            const levels = await this.level_list.pipe(take(1)).toPromise();\n            if (levels.length) this.form.patchValue({ level_id: levels[0].id });\n        }\n    }\n\n    public selectPOIfromMap() {\n        const ref = this._dialog.open(SelectPOIMapModalComponent, {\n            data: {\n                ...this._data,\n                ...this.form.getRawValue(),\n            },\n        });\n        ref.afterClosed().subscribe((d) => {\n            if (!d) return;\n            this.form.patchValue({\n                location: d,\n                level_id: ref.componentInstance.level?.id,\n            });\n        });\n    }\n\n    public async save() {\n        if (!this.form.valid) {\n            return notifyError(\n                `Some form fields are invalid. [${getInvalidFields(\n                    this.form,\n                ).join(', ')}]`,\n            );\n        }\n        const data: any = this.form.getRawValue();\n        if (!data.id) data.id = `POI-${randomString(8)}`;\n        data.short_link_id = this._data?.short_link_id;\n        const path = this._settings.get('app.kiosk_url_path') || '/map-kiosk';\n        const public_key = this._settings.get('app.short_url_public_key');\n        const location =\n            typeof data.location === 'string'\n                ? data.location\n                : data.location.join(',');\n        let uri = `${path}/#/explore?level=${data.level_id}&locate=${location}&public=true`;\n        if (public_key) uri += `&x-api-key=${public_key}`;\n        if (!data.short_link_id) {\n            const { id } = await createShortURL({\n                name: data.name,\n                description: `Point of Interest: ${data.name}`,\n                uri: `${\n                    window.location.origin\n                }/auth/login?continue=${encodeURIComponent(uri)}`,\n            } as any).toPromise();\n            data.short_link_id = id;\n        } else {\n            await updateShortURL(data.short_link_id, {\n                id: data.short_link_id,\n                name: data.name,\n                description: `Point of Interest: ${data.name}`,\n                uri: `${\n                    window.location.origin\n                }/auth/login?continue=${encodeURIComponent(uri)}`,\n            } as any).toPromise();\n        }\n        this.loading = true;\n        const old_metadata = await showMetadata(\n            this._org.organisation.id,\n            'points-of-interest',\n            {},\n        ).toPromise();\n        const metadata = old_metadata.details || {};\n        if (!metadata[data.level_id]) metadata[data.level_id] = [];\n        if (this._data?.id) {\n            for (const lvl in metadata) {\n                if (metadata[lvl])\n                    metadata[lvl] = metadata[lvl].filter(\n                        (_) => _.id !== data.id,\n                    );\n            }\n        }\n        metadata[data.level_id] = [\n            ...metadata[data.level_id].filter((_) => _.id !== data.id),\n            data,\n        ].sort((a, b) => a.name.localeCompare(b.name));\n        const resp = await updateMetadata(this._org.organisation.id, {\n            name: 'points-of-interest',\n            details: metadata,\n            description: 'Point of Interests for maps',\n        })\n            .toPromise()\n            .catch((e) => notifyError(e));\n        if ((resp as any).id) this._dialog_ref.close(resp);\n        this.loading = false;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { OrganisationService } from '@placeos/organisation';\nimport { BehaviorSubject, combineLatest, of } from 'rxjs';\nimport { catchError, map, shareReplay, switchMap } from 'rxjs/operators';\nimport { POIModalComponent } from './poi-modal.component';\nimport {\n    flatten,\n    notifyError,\n    notifySuccess,\n    openConfirmModal,\n} from '@placeos/common';\nimport { showMetadata, updateMetadata } from '@placeos/ts-client';\n\nexport interface POIListOptions {\n    search?: string;\n}\n\nexport interface PointOfInterest {\n    id: string;\n    name: string;\n    level_id: string;\n    location: string | [number, number];\n    short_link_id: string;\n    qr_code?: string;\n    qr_link?: string;\n    can_search?: boolean;\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class POIManagementService {\n    private _options = new BehaviorSubject<POIListOptions>({});\n    private _change = new BehaviorSubject(0);\n\n    public options = this._options.asObservable();\n\n    private _features = combineLatest([\n        this._org.active_building,\n        this._change,\n    ]).pipe(\n        switchMap(() =>\n            showMetadata(this._org.organisation.id, 'points-of-interest').pipe(\n                catchError((_) => of({ details: {} })),\n            ),\n        ),\n        map((_) => {\n            const mapping = _.details || {};\n            const levels = this._org.levelsForBuilding(this._org.building);\n            const list = flatten(levels.map((lvl) => mapping[lvl.id] || []));\n            return list as PointOfInterest[];\n        }),\n        shareReplay(1),\n    );\n\n    public readonly filtered_features = combineLatest([\n        this._features,\n        this._options,\n    ]).pipe(\n        map(([list, options]) => {\n            if (options.search) {\n                list = list.filter((_) =>\n                    _.name.toLowerCase().includes(options.search.toLowerCase()),\n                );\n            }\n            return list;\n        }),\n    );\n\n    constructor(\n        private _org: OrganisationService,\n        private _dialog: MatDialog,\n    ) {}\n\n    public setFilters(options: Partial<POIListOptions>) {\n        this._options.next({ ...this._options.getValue(), ...options });\n    }\n\n    public setSearchString(search: string) {\n        this._options.next({ ...this._options.getValue(), search });\n    }\n\n    public editPointOfInterest(poi?: PointOfInterest) {\n        const ref = this._dialog.open(POIModalComponent, {\n            data: poi,\n        });\n        ref.afterClosed().subscribe(() => this._change.next(Date.now()));\n    }\n\n    public async removePointOfInterest(poi: PointOfInterest) {\n        const ref = await openConfirmModal(\n            {\n                title: 'Remove Point of Interest',\n                content: `Are you sure you want to remove the point of interest \"${poi.name}\"?`,\n                icon: { content: 'delete_forever' },\n                confirm_text: 'Remove',\n            },\n            this._dialog,\n        );\n        if (ref.reason !== 'done') return ref.close();\n        ref.loading('Removing point of interest...');\n        const old_metadata = await showMetadata(\n            this._org.organisation.id,\n            'points-of-interest',\n        ).toPromise();\n        const metadata = old_metadata.details || {};\n        for (const lvl in metadata) {\n            if (metadata[lvl])\n                metadata[lvl] = metadata[lvl].filter((_) => _.id !== poi.id);\n        }\n        await updateMetadata(this._org.organisation.id, {\n            name: 'points-of-interest',\n            details: metadata,\n            description: '',\n        })\n            .toPromise()\n            .catch((e) => {\n                notifyError(e);\n                ref.close();\n                throw e;\n            });\n        notifySuccess('Successfully removed point of interest.');\n        ref.close();\n        this._change.next(Date.now());\n    }\n}\n","import { Component } from '@angular/core';\nimport {\n    POIManagementService,\n    PointOfInterest,\n} from './poi-management.service';\nimport { SettingsService } from '@placeos/common';\nimport { generateQRCode } from 'libs/common/src/lib/qr-code';\n\n@Component({\n    selector: 'poi-list',\n    template: `\n        <div class=\"absolute inset-0 overflow-auto px-8\">\n            <simple-table\n                class=\"min-w-[48rem] block text-sm\"\n                [data]=\"features\"\n                empty_message=\"No Points of Interest found.\"\n                [columns]=\"[\n                    { key: 'name', name: 'Name' },\n                    {\n                        key: 'level_id',\n                        name: 'Level',\n                        content: level_template,\n                        size: '12rem',\n                        sortable: false,\n                    },\n                    { key: 'location', name: 'Location', size: '10rem' },\n                    {\n                        key: 'can_search',\n                        name: 'Searchable',\n                        size: '7rem',\n                        content: bool_template,\n                    },\n                    {\n                        key: 'actions',\n                        name: ' ',\n                        content: action_template,\n                        size: '9.5rem',\n                        sortable: false,\n                    },\n                ]\"\n                [sortable]=\"true\"\n            ></simple-table>\n            <div class=\"w-full h-12\"></div>\n        </div>\n        <ng-template #level_template let-row=\"row\">\n            <div class=\"p-4\">\n                {{ (row.level_id | level)?.display_name || 'Unknown' }}\n            </div>\n        </ng-template>\n        <ng-template #bool_template let-data=\"data\">\n            <div\n                *ngIf=\"data\"\n                class=\"rounded h-8 w-8 flex items-center justify-center text-2xl bg-success text-success-content mx-auto\"\n            >\n                <app-icon>done</app-icon>\n            </div>\n        </ng-template>\n        <ng-template #action_template let-row=\"row\">\n            <div class=\"w-full flex justify-end space-x-2 px-4 py-2 mx-auto\">\n                <div matTooltip=\"Private QR Code\">\n                    <button\n                        icon\n                        matRipple\n                        customTooltip\n                        [content]=\"qr_menu\"\n                        (click)=\"loadQrCode(row)\"\n                    >\n                        <app-icon>qr_code</app-icon>\n                    </button>\n                </div>\n                <div matTooltip=\"Public QR Code\">\n                    <button\n                        icon\n                        matRipple\n                        customTooltip\n                        [disabled]=\"!row.short_link_id\"\n                        [content]=\"qr_menu\"\n                        (click)=\"loadPublicQrCode(row)\"\n                    >\n                        <app-icon>qr_code</app-icon>\n                    </button>\n                </div>\n                <ng-template #qr_menu>\n                    <div class=\"bg-base-100 py-2 shadow rounded\">\n                        <div class=\"\" printable>\n                            <a\n                                [href]=\"row.qr_link | safe: 'url'\"\n                                target=\"_blank\"\n                                ref=\"noopener noreferrer\"\n                                class=\"block p-2 mx-4 my-2 rounded-lg border border-base-200 bg-base-100\"\n                            >\n                                <img class=\"w-48\" [src]=\"row.qr_code\" />\n                            </a>\n                            <div\n                                class=\"w-[calc(100%-2rem)] text-center mt-2 font-mono text-sm bg-base-200 rounded p-2 mx-4\"\n                            >\n                                {{ row.name || row.id }}\n                            </div>\n                        </div>\n                        <button\n                            btn\n                            matRipple\n                            class=\"w-[calc(100%-2rem)] mx-4 my-2\"\n                            (click)=\"print()\"\n                        >\n                            Print QR Code\n                        </button>\n                    </div>\n                </ng-template>\n                <button btn icon matRipple [matMenuTriggerFor]=\"menu\">\n                    <app-icon>more_vert</app-icon>\n                </button>\n                <mat-menu #menu=\"matMenu\">\n                    <button mat-menu-item (click)=\"edit(row)\">\n                        <div class=\"flex items-center space-x-2\">\n                            <app-icon>edit</app-icon>\n                            <span>Edit Point of Interest</span>\n                        </div>\n                    </button>\n                    <button mat-menu-item (click)=\"remove(row)\">\n                        <div class=\"flex items-center space-x-2 text-red-500\">\n                            <app-icon class=\"text-error\">delete</app-icon>\n                            <span>Delete Point of Interest</span>\n                        </div>\n                    </button>\n                </mat-menu>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class POIListComponent {\n    public readonly features = this._manager.filtered_features;\n\n    public readonly edit = (region) =>\n        this._manager.editPointOfInterest(region);\n    public readonly remove = (region) =>\n        this._manager.removePointOfInterest(region);\n\n    public get kiosk_url() {\n        const path = this._settings.get('app.kiosk_url_path') || '/map-kiosk';\n        return `${window.location.origin}${path}`;\n    }\n\n    constructor(\n        private _manager: POIManagementService,\n        private _settings: SettingsService,\n    ) {}\n\n    public loadQrCode(item: PointOfInterest) {\n        const location =\n            typeof item.location === 'string'\n                ? item.location\n                : item.location.join(',');\n        const link = `${this.kiosk_url}/#/explore?level=${encodeURIComponent(\n            item.level_id,\n        )}&locate=${encodeURIComponent(location)}`;\n        item.qr_link = link;\n        item.qr_code = generateQRCode(link);\n    }\n\n    public loadPublicQrCode(item: PointOfInterest) {\n        const link = `${location.origin}/r/${item.short_link_id.split('-')[1]}`;\n        item.qr_link = link;\n        item.qr_code = generateQRCode(link);\n    }\n\n    public print() {\n        window.print();\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { POIManagementService } from './poi-management.service';\nimport { Building, OrganisationService } from '@placeos/organisation';\nimport { SettingsService } from '@placeos/common';\n\n@Component({\n    selector: '[app-poi-manager]',\n    template: `\n        <app-topbar></app-topbar>\n        <div class=\"flex flex-1 h-px\">\n            <app-sidebar></app-sidebar>\n            <main class=\"flex flex-col flex-1 w-1/2 h-full\">\n                <header\n                    class=\"flex items-center justify-between px-8 py-8\"\n                    [class.mb-2]=\"\n                        !use_region || (buildings | async)?.length <= 1\n                    \"\n                >\n                    <h2 class=\"text-2xl font-medium\">\n                        Point of Interest Management\n                    </h2>\n                    <button btn matRipple (click)=\"new()\">\n                        Add Point of Interest\n                    </button>\n                </header>\n                <div\n                    class=\"flex items-center justify-between mb-2 px-8\"\n                    *ngIf=\"use_region && (buildings | async)?.length > 1\"\n                >\n                    <mat-form-field appearance=\"outline\" class=\"w-64\">\n                        <mat-select\n                            name=\"building\"\n                            [ngModel]=\"building\"\n                            (ngModelChange)=\"building = $event\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            [placeholder]=\"\n                                building?.display_name || building?.name\n                            \"\n                        >\n                            <mat-option\n                                *ngFor=\"let bld of buildings | async\"\n                                [value]=\"bld\"\n                            >\n                                {{ bld.display_name || bld.name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <poi-list class=\"block w-full relative flex-1 h-1/2\"></poi-list>\n            </main>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n                background-color: var(--b1);\n            }\n\n            sidebar {\n                height: 100%;\n            }\n\n            main {\n                display: flex;\n                flex-direction: column;\n                flex: 1;\n                min-width: 50%;\n                height: 100%;\n            }\n        `,\n    ],\n})\nexport class POIManagerComponent {\n    public readonly new = () => this._state.editPointOfInterest();\n\n    public readonly buildings = this._org.active_buildings;\n\n    public get building() {\n        return this._org.building;\n    }\n\n    public set building(bld: Building) {\n        this._org.building = bld;\n    }\n\n    public get use_region() {\n        return !!this._settings.get('app.use_region');\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _state: POIManagementService,\n        private _settings: SettingsService\n    ) {}\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { UIModule } from '../ui/ui.module';\n\nimport { SharedSpacesModule } from '@placeos/spaces';\nimport { SharedUsersModule } from '@placeos/users';\n\nimport { POIManagerComponent } from './poi-manager.component';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { POIListComponent } from './poi-list.component';\nimport { POIModalComponent } from './poi-modal.component';\nimport { SelectPOIMapModalComponent } from './select-poi-map-modal.component';\nimport { MapShowElementComponent } from './map-show-element.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: POIManagerComponent },\n    { path: 'new', component: POIManagerComponent },\n];\n\n@NgModule({\n    declarations: [\n        POIManagerComponent,\n        POIListComponent,\n        POIModalComponent,\n        SelectPOIMapModalComponent,\n        MapShowElementComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        UIModule,\n        SharedSpacesModule,\n        SharedUsersModule,\n        MatChipsModule,\n        RouterModule.forChild(ROUTES),\n    ],\n})\nexport class POIManagerModule {}\n","import { HashMap } from '@placeos/common';\nimport { getUnixTime } from 'date-fns';\n\nexport class MapLocation {\n    /** Source that the location was generated */\n    public type: 'desk' | 'wireless' | 'meeting' | 'other';\n    /** Details of the location */\n    public position: string | { x: number, y: number };\n    /** Accuracy of the location data */\n    public variance: number;\n    /** Unix epoch in seconds that the data was last updated */\n    public last_seen: number;\n    /** ID of the level associated with the location */\n    public level: string;\n    /** ID of the building associated with the location */\n    public building: string;\n    /** Whether user is currently at the location if fixed */\n    public at_location: boolean;\n    /**  */\n    public coordinates_from:\n        | 'top-left'\n        | 'top-right'\n        | 'bottom-left'\n        | 'bottom-right';\n\n    constructor(_data: HashMap = {}) {\n        this.type = _data.type || _data.location || 'other';\n        this.position = _data.position ||\n            _data.map_id || _data.asset_id || {\n                x: _data.x / _data.map_width || 0,\n                y: _data.y / _data.map_height || 0,\n            };\n        this.variance = _data.variance || 0;\n        this.last_seen = _data.last_seen || getUnixTime(new Date());\n        this.level = _data.level;\n        this.building = _data.building;\n        this.at_location = !!_data.at_location;\n        this.coordinates_from = _data.coordinates_from || 'top-left';\n    }\n}\n"],"x_google_ignoreList":[]}