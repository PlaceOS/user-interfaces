{"version":3,"file":"apps_concierge_src_app_poi-manager_poi-manager_module_ts.js","mappings":"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","names":["i0","bld_r12","display_name","$event","_r14","ctx_r13","building","POIModalComponent_main_4_form_1_div_2_mat_option_6_Template","ctx_r7","_c0","building_list","level_r16","id","POIModalComponent_main_4_form_1_div_4_mat_option_6_Template","ctx_r8","level_list","_r18","ctx_r17","form","patchValue","location","value","ctx_r19","ctx_r10","POIModalComponent_main_4_form_1_div_1_Template","POIModalComponent_main_4_form_1_div_2_Template","POIModalComponent_main_4_form_1_div_4_Template","_r21","ctx_r20","location_type","POIModalComponent_main_4_form_1_ng_container_15_Template","POIModalComponent_main_4_form_1_div_16_Template","ctx_r5","controls","name","tmp_2_0","length","level_id","POIModalComponent_main_4_form_1_Template","ctx_r1","_r23","ctx_r22","save","POIModalComponent","AsyncHandler","this","_org","constructor","_data","_dialog_ref","_settings","super","loading","Array","active_levels","FormGroup","FormControl","Validators","required","ngOnInit","_this","_asyncToGenerator","levels","pipe","take","toPromise","_this2","valid","notifyError","getInvalidFields","join","data","getRawValue","randomString","short_link_id","path","get","public_key","uri","window","origin","updateShortURL","description","createShortURL","metadata","showMetadata","details","filter","_","sort","a","b","localeCompare","resp","updateMetadata","catch","e","close","static","t","i1","MAT_DIALOG_DATA","i2","i3","core","Xpm","selectors","features","decls","vars","consts","i18n_0","$localize","POIModalComponent_button_3_Template","POIModalComponent_main_4_Template","POIModalComponent_footer_5_Template","POIModalComponent_ng_template_6_Template","ctx","_r4","POIManagementService","_dialog","_options","BehaviorSubject","_change","options","asObservable","_features","combineLatest","active_building","switchMap","bld","map","shareReplay","filtered_features","list","Object","values","reduce","acc","search","toLowerCase","includes","setFilters","next","getValue","setSearchString","editPointOfInterest","poi","open","afterClosed","subscribe","Date","now","removePointOfInterest","ref","openConfirmModal","title","content","icon","confirm_text","reason","notifySuccess","Yz7","factory","Éµfac","providedIn","tmp_0_0","_r10","ctx_r9","print","row_r5","qr_link","qr_code","_r13","row","ctx_r12","loadQrCode","ctx_r14","loadPublicQrCode","POIListComponent_ng_template_4_ng_template_9_Template","ctx_r15","edit","ctx_r16","remove","_r7","_r8","POIListComponent","kiosk_url","item","link","encodeURIComponent","generateQRCode","split","_manager","region","template","rf","POIListComponent_ng_template_2_Template","POIListComponent_ng_template_4_Template","_c1","_c2","_c3","_r1","_r3","POIManagerComponent","_state","new","attrs","ROUTES","component","POIManagerModule","oAB","cJS","CommonModule","FormsModule","UIModule","SharedSpacesModule","SharedUsersModule","MatChipsModule","RouterModule","forChild"],"sourceRoot":"webpack:///","sources":["./apps/concierge/src/app/poi-manager/poi-modal.component.ts","./apps/concierge/src/app/poi-manager/poi-management.service.ts","./apps/concierge/src/app/poi-manager/poi-list.component.ts","./apps/concierge/src/app/poi-manager/poi-manager.component.ts","./apps/concierge/src/app/poi-manager/poi-manager.module.ts"],"sourcesContent":["import { Component, Inject } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport {\n    AsyncHandler,\n    SettingsService,\n    createShortURL,\n    getInvalidFields,\n    notifyError,\n    randomString,\n    updateShortURL,\n} from '@placeos/common';\nimport { OrganisationService, Building } from '@placeos/organisation';\nimport { showMetadata, updateMetadata } from '@placeos/ts-client';\nimport { PointOfInterest } from './poi-management.service';\nimport { take } from 'rxjs/operators';\n\n@Component({\n    selector: 'poi-modal',\n    template: `\n        <header>\n            <h2>{{ form.value.id ? 'Edit' : 'Add' }} Point Of Interest</h2>\n            <button btn icon mat-dialog-close *ngIf=\"!loading\">\n                <app-icon>close</app-icon>\n            </button>\n        </header>\n        <main\n            class=\"max-h-[65vh] overflow-y-auto overflow-x-hidden p-4\"\n            *ngIf=\"!loading; else load_state\"\n        >\n            <form\n                system\n                class=\"flex flex-col w-[28rem] max-w-[calc(100vw-4rem)]\"\n                *ngIf=\"form\"\n                [formGroup]=\"form\"\n            >\n                <div class=\"flex flex-col\" *ngIf=\"form.controls.name\">\n                    <label for=\"name\" i18n=\"@@nameLabel\">\n                        Name<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"name\"\n                            placeholder=\"Name\"\n                            i18n-placeholder=\"@@namePlaceholder\"\n                            formControlName=\"name\"\n                        />\n                    </mat-form-field>\n                </div>\n                <div\n                    class=\"flex flex-col\"\n                    *ngIf=\"(building_list | async)?.length > 1\"\n                >\n                    <label for=\"name\" i18n=\"@@nameLabel\">\n                        Building<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            [(ngModel)]=\"building\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            placeholder=\"Select Building\"\n                        >\n                            <mat-option\n                                *ngFor=\"let bld of building_list | async\"\n                                [value]=\"bld\"\n                            >\n                                {{ bld.display_name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col\" *ngIf=\"form.controls.level_id\">\n                    <label for=\"name\" i18n=\"@@nameLabel\">\n                        Level<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            formControlName=\"level_id\"\n                            placeholder=\"Select Level\"\n                        >\n                            <mat-option\n                                *ngFor=\"let level of level_list | async\"\n                                [value]=\"level.id\"\n                            >\n                                {{ level.display_name }}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col\">\n                    <label for=\"name\" i18n=\"@@nameLabel\">\n                        Location<span>*</span>:\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select\n                            [(ngModel)]=\"location_type\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            placeholder=\"Location Type\"\n                        >\n                            <mat-option value=\"map_id\">Map ID</mat-option>\n                            <mat-option value=\"coordinates\"\n                                >Coordinates</mat-option\n                            >\n                        </mat-select>\n                    </mat-form-field>\n                    <ng-container *ngIf=\"location_type === 'map_id'\">\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                name=\"location\"\n                                placeholder=\"Location\"\n                                i18n-placeholder=\"@@locationPlaceholder\"\n                                formControlName=\"location\"\n                            />\n                        </mat-form-field>\n                    </ng-container>\n                    <div\n                        class=\"flex items-center space-x-2\"\n                        *ngIf=\"location_type === 'coordinates'\"\n                    >\n                        <mat-form-field appearance=\"outline\" class=\"flex-1\">\n                            <input\n                                matInput\n                                name=\"latitude\"\n                                [ngModel]=\"form.value.location[0]\"\n                                (ngModelChange)=\"\n                                    form.patchValue({\n                                        location: [\n                                            $event,\n                                            form.value.location[1]\n                                        ]\n                                    })\n                                \"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                            />\n                        </mat-form-field>\n                        <mat-form-field appearance=\"outline\" class=\"flex-1\">\n                            <input\n                                matInput\n                                name=\"longitude\"\n                                [ngModel]=\"form.value.location[1]\"\n                                (ngModelChange)=\"\n                                    form.patchValue({\n                                        location: [\n                                            form.value.location[0],\n                                            $event\n                                        ]\n                                    })\n                                \"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                            />\n                        </mat-form-field>\n                    </div>\n                </div>\n            </form>\n        </main>\n        <footer\n            class=\"p-2 flex justify-end border-t border-base-200\"\n            *ngIf=\"!loading\"\n        >\n            <button btn class=\"w-32\" (click)=\"save()\">Save</button>\n        </footer>\n        <ng-template #load_state>\n            <div class=\"flex flex-col items-center justify-center w-64 h-64\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p class=\"mt-4\">Saving Point Of Interest...</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class POIModalComponent extends AsyncHandler {\n    public loading = false;\n    public location_type =\n        this._data?.location instanceof Array ? 'coordinates' : 'map_id';\n    public readonly building_list = this._org.building_list;\n    public readonly level_list = this._org.active_levels;\n\n    public get building() {\n        return this._org.building;\n    }\n\n    public set building(value: Building) {\n        this._org.building = value;\n    }\n\n    public readonly form = new FormGroup({\n        id: new FormControl(this._data?.id || ''),\n        name: new FormControl(this._data?.name || '', [Validators.required]),\n        level_id: new FormControl(this._data?.level_id || '', [\n            Validators.required,\n        ]),\n        location: new FormControl(this._data?.location || '', [\n            Validators.required,\n        ]),\n    });\n\n    constructor(\n        private _org: OrganisationService,\n        @Inject(MAT_DIALOG_DATA) private _data: PointOfInterest | undefined,\n        private _dialog_ref: MatDialogRef<POIModalComponent>,\n        private _settings: SettingsService\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        if (!this.form.value.level_id) {\n            const levels = await this.level_list.pipe(take(1)).toPromise();\n            if (levels.length) this.form.patchValue({ level_id: levels[0].id });\n        }\n    }\n\n    public async save() {\n        if (!this.form.valid) {\n            return notifyError(\n                `Some form fields are invalid. [${getInvalidFields(\n                    this.form\n                ).join(', ')}]`\n            );\n        }\n        const data: any = this.form.getRawValue();\n        if (!data.id) data.id = `POI-${randomString(8)}`;\n        data.short_link_id = this._data?.short_link_id;\n        const path = this._settings.get('app.kiosk_url_path') || '/map-kiosk';\n        const public_key = this._settings.get('app.short_url_public_key');\n        const location =\n            typeof data.location === 'string'\n                ? data.location\n                : data.location.join(',');\n        let uri = `${window.location.origin}${path}/#/explore?level=${data.level_id}&locate=${location}&public=true`;\n        if (public_key) uri += `&x-api-key=${public_key}`;\n        if (!data.short_link_id) {\n            const { id } = await createShortURL({\n                name: data.name,\n                description: `Point of Interest: ${data.name}`,\n                uri,\n            } as any).toPromise();\n            data.short_link_id = id;\n        } else {\n            await updateShortURL(data.short_link_id, {\n                id: data.short_link_id,\n                name: data.name,\n                description: `Point of Interest: ${data.name}`,\n                uri,\n            } as any).toPromise();\n        }\n        this.loading = true;\n        const old_metadata = await showMetadata(\n            this._org.building.id,\n            'map_features',\n            {}\n        ).toPromise();\n        const metadata = old_metadata.details || {};\n        if (!metadata[data.level_id]) metadata[data.level_id] = [];\n        metadata[data.level_id] = [\n            ...metadata[data.level_id].filter((_) => _.id !== data.id),\n            data,\n        ].sort((a, b) => a.name.localeCompare(b.name));\n        const resp = await updateMetadata(this._org.building.id, {\n            name: 'map_features',\n            details: metadata,\n            description: '',\n        })\n            .toPromise()\n            .catch((e) => notifyError(e));\n        if ((resp as any).id) this._dialog_ref.close(resp);\n        this.loading = false;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { OrganisationService } from '@placeos/organisation';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map, shareReplay, switchMap } from 'rxjs/operators';\nimport { POIModalComponent } from './poi-modal.component';\nimport {\n    SettingsService,\n    notifyError,\n    notifySuccess,\n    openConfirmModal,\n} from '@placeos/common';\nimport { showMetadata, updateMetadata } from '@placeos/ts-client';\nimport { generateQRCode } from 'libs/common/src/lib/qr-code';\n\nexport interface POIListOptions {\n    search?: string;\n}\n\nexport interface PointOfInterest {\n    id: string;\n    name: string;\n    level_id: string;\n    location: string | [number, number];\n    short_link_id: string;\n    qr_code?: string;\n    qr_link?: string;\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class POIManagementService {\n    private _options = new BehaviorSubject<POIListOptions>({});\n    private _change = new BehaviorSubject(0);\n\n    public options = this._options.asObservable();\n\n    private _features = combineLatest([\n        this._org.active_building,\n        this._change,\n    ]).pipe(\n        switchMap(([bld]) => showMetadata(bld.id, 'map_features', {})),\n        map((_) => _.details || {}),\n        shareReplay(1)\n    );\n\n    public readonly filtered_features = combineLatest([\n        this._features,\n        this._options,\n    ]).pipe(\n        map(([features, options]) => {\n            let list = Object.values(features).reduce(\n                (acc, _) => [...acc, ..._],\n                []\n            );\n            if (options.search) {\n                list = list.filter((_) =>\n                    _.name.toLowerCase().includes(options.search.toLowerCase())\n                );\n            }\n            return list;\n        })\n    );\n\n    constructor(\n        private _org: OrganisationService,\n        private _dialog: MatDialog\n    ) {}\n\n    public setFilters(options: Partial<POIListOptions>) {\n        this._options.next({ ...this._options.getValue(), ...options });\n    }\n\n    public setSearchString(search: string) {\n        this._options.next({ ...this._options.getValue(), search });\n    }\n\n    public editPointOfInterest(poi?: PointOfInterest) {\n        const ref = this._dialog.open(POIModalComponent, {\n            data: poi,\n        });\n        ref.afterClosed().subscribe(() => this._change.next(Date.now()));\n    }\n\n    public async removePointOfInterest(poi: PointOfInterest) {\n        const ref = await openConfirmModal(\n            {\n                title: 'Remove Point of Interest',\n                content: `Are you sure you want to remove the point of interest \"${poi.name}\"?`,\n                icon: { content: 'delete_forever' },\n                confirm_text: 'Remove',\n            },\n            this._dialog\n        );\n        if (ref.reason !== 'done') return ref.close();\n        ref.loading('Removing point of interest...');\n        const old_metadata = await showMetadata(\n            this._org.building.id,\n            'map_features',\n            {}\n        ).toPromise();\n        const metadata = old_metadata.details || {};\n        if (metadata[poi.level_id]) {\n            metadata[poi.level_id] = metadata[poi.level_id].filter(\n                (_) => _.id !== poi.id\n            );\n        }\n        await updateMetadata(this._org.building.id, {\n            name: 'map_features',\n            details: metadata,\n            description: '',\n        })\n            .toPromise()\n            .catch((e) => {\n                notifyError(e);\n                ref.close();\n                throw e;\n            });\n        notifySuccess('Successfully removed point of interest.');\n        ref.close();\n        this._change.next(Date.now());\n    }\n}\n","import { Component } from '@angular/core';\nimport {\n    POIManagementService,\n    PointOfInterest,\n} from './poi-management.service';\nimport { SettingsService } from '@placeos/common';\nimport { generateQRCode } from 'libs/common/src/lib/qr-code';\n\n@Component({\n    selector: 'poi-list',\n    template: `\n        <div class=\"absolute inset-0 overflow-auto px-4\">\n            <custom-table\n                class=\"block min-w-[32rem] w-full h-full\"\n                [dataSource]=\"features\"\n                [columns]=\"['name', 'level', 'location', 'actions']\"\n                [display_column]=\"['Name', 'Level', 'Location', ' ']\"\n                [column_size]=\"['flex', '10r', '10r', '9r']\"\n                [template]=\"{\n                    level: level_template,\n                    actions: action_template\n                }\"\n                empty=\"No Points of Interest found.\"\n            ></custom-table>\n        </div>\n        <ng-template #level_template let-row=\"row\">\n            {{ (row.level_id | level)?.display_name || 'Unknown' }}\n        </ng-template>\n        <ng-template #action_template let-row=\"row\">\n            <div class=\"w-full flex justify-end space-x-2\">\n                <div matTooltip=\"Private QR Code\">\n                    <button\n                        icon\n                        matRipple\n                        customTooltip\n                        [content]=\"qr_menu\"\n                        (click)=\"loadQrCode(row)\"\n                    >\n                        <app-icon>qr_code</app-icon>\n                    </button>\n                </div>\n                <div matTooltip=\"Public QR Code\">\n                    <button\n                        icon\n                        matRipple\n                        customTooltip\n                        [disabled]=\"!row.short_link_id\"\n                        [content]=\"qr_menu\"\n                        (click)=\"loadPublicQrCode(row)\"\n                    >\n                        <app-icon>qr_code</app-icon>\n                    </button>\n                </div>\n                <ng-template #qr_menu>\n                    <div class=\"bg-base-100 py-2 shadow rounded\">\n                        <div class=\"\" printable>\n                            <a\n                                [href]=\"row.qr_link | safe: 'url'\"\n                                target=\"_blank\"\n                                ref=\"noopener noreferrer\"\n                                class=\"block p-2 mx-4 my-2 rounded-lg border border-base-200 bg-base-100\"\n                            >\n                                <img class=\"w-48\" [src]=\"row.qr_code\" />\n                            </a>\n                            <div\n                                class=\"w-[calc(100%-2rem)] text-center mt-2 font-mono text-sm bg-base-200 rounded p-2 mx-4\"\n                            >\n                                {{ row.name || row.id }}\n                            </div>\n                        </div>\n                        <button\n                            btn\n                            matRipple\n                            class=\"w-[calc(100%-2rem)] mx-4 my-2\"\n                            (click)=\"print()\"\n                        >\n                            Print QR Code\n                        </button>\n                    </div>\n                </ng-template>\n                <button btn icon matRipple [matMenuTriggerFor]=\"menu\">\n                    <app-icon>more_vert</app-icon>\n                </button>\n                <mat-menu #menu=\"matMenu\">\n                    <button mat-menu-item (click)=\"edit(row)\">\n                        <div class=\"flex items-center space-x-2\">\n                            <app-icon>edit</app-icon>\n                            <span>Edit Point of Interest</span>\n                        </div>\n                    </button>\n                    <button mat-menu-item (click)=\"remove(row)\">\n                        <div class=\"flex items-center space-x-2 text-red-500\">\n                            <app-icon class=\"text-error\">delete</app-icon>\n                            <span>Delete Point of Interest</span>\n                        </div>\n                    </button>\n                </mat-menu>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class POIListComponent {\n    public readonly features = this._manager.filtered_features;\n\n    public readonly edit = (region) =>\n        this._manager.editPointOfInterest(region);\n    public readonly remove = (region) =>\n        this._manager.removePointOfInterest(region);\n\n    public get kiosk_url() {\n        const path = this._settings.get('app.kiosk_url_path') || '/map-kiosk';\n        return `${window.location.origin}${path}`;\n    }\n\n    public loadQrCode(item: PointOfInterest) {\n        const location =\n            typeof item.location === 'string'\n                ? item.location\n                : item.location.join(',');\n        const link = `${this.kiosk_url}/#/explore?level=${encodeURIComponent(\n            item.level_id\n        )}&locate=${encodeURIComponent(location)}`;\n        item.qr_link = link;\n        item.qr_code = generateQRCode(link);\n    }\n\n    public loadPublicQrCode(item: PointOfInterest) {\n        const link = `${location.origin}/r/${item.short_link_id.split('-')[1]}`;\n        item.qr_link = link;\n        item.qr_code = generateQRCode(link);\n    }\n\n    constructor(\n        private _manager: POIManagementService,\n        private _settings: SettingsService\n    ) {}\n}\n","import { Component } from '@angular/core';\nimport { POIManagementService } from './poi-management.service';\n\n@Component({\n    selector: '[app-poi-manager]',\n    template: `\n        <app-topbar></app-topbar>\n        <div class=\"flex flex-1 h-px\">\n            <app-sidebar></app-sidebar>\n            <main class=\"flex flex-col flex-1 w-1/2 h-full\">\n                <header\n                    class=\"flex items-center justify-between mb-2 px-4 py-8\"\n                >\n                    <h2 class=\"text-2xl font-medium\">\n                        Point of Interest Management\n                    </h2>\n                    <button btn matRipple (click)=\"new()\">\n                        Add Point of Interest\n                    </button>\n                </header>\n                <poi-list class=\"block w-full relative flex-1 h-1/2\"></poi-list>\n            </main>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n                background-color: var(--b1);\n            }\n\n            sidebar {\n                height: 100%;\n            }\n\n            main {\n                display: flex;\n                flex-direction: column;\n                flex: 1;\n                min-width: 50%;\n                height: 100%;\n            }\n        `,\n    ],\n})\nexport class POIManagerComponent {\n    public readonly new = () => this._state.editPointOfInterest();\n\n    constructor(private readonly _state: POIManagementService) {}\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { UIModule } from '../ui/ui.module';\n\nimport { SharedSpacesModule } from '@placeos/spaces';\nimport { SharedUsersModule } from '@placeos/users';\n\nimport { POIManagerComponent } from './poi-manager.component';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { POIListComponent } from './poi-list.component';\nimport { POIModalComponent } from './poi-modal.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: POIManagerComponent },\n    { path: 'new', component: POIManagerComponent },\n];\n\n@NgModule({\n    declarations: [POIManagerComponent, POIListComponent, POIModalComponent],\n    imports: [\n        CommonModule,\n        FormsModule,\n        UIModule,\n        SharedSpacesModule,\n        SharedUsersModule,\n        MatChipsModule,\n        RouterModule.forChild(ROUTES),\n    ],\n})\nexport class POIManagerModule {}\n"],"x_google_ignoreList":[]}