{"version":3,"sources":["./src/app/directory/directory.module.ts","./src/app/directory/user-list/user-list.component.ts","./src/app/directory/user-list/user-list.component.html","./src/app/directory/user-list/item/item.component.ts","./src/app/directory/user-list/item/item.component.html"],"names":[],"mappings":"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","file":"directory-directory-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { SharedContentModule } from '../ui/shared.module';\nimport { DirectoryUserListComponent } from './user-list/user-list.component';\nimport { DirectoryUserListItemComponent } from './user-list/item/item.component';\n\nconst ROUTES: Route[] = [{ path: '', component: DirectoryUserListComponent }];\n\n@NgModule({\n    declarations: [DirectoryUserListComponent, DirectoryUserListItemComponent],\n    imports: [CommonModule, RouterModule.forChild(ROUTES), SharedContentModule]\n})\nexport class DirectoryModule {}\n","import { Component, OnInit} from '@angular/core';\nimport { Subject, Observable } from 'rxjs';\nimport { switchMap, debounceTime, distinctUntilChanged, map } from 'rxjs/operators';\n\nimport { BaseClass, SettingsService } from '@user-interfaces/common';\nimport { StaffService, User } from '@user-interfaces/users';\n\nconst LETTERS = `ABCDEFGHIJKLMNOPQRSTUVWXYZ`.split('');\n\n@Component({\n    selector: 'a-directory-user-list',\n    templateUrl: './user-list.component.html',\n    styleUrls: ['./user-list.component.scss'],\n})\nexport class DirectoryUserListComponent extends BaseClass implements OnInit {\n    /** List of controllable spaces */\n    public user_list: User[] = [];\n    /** String  */\n    public search_str: string;\n    /** List of users from an API search */\n    public search_results$: Observable<User[]>;\n    /** Whether space list is being filtered */\n    public loading: boolean;\n    /** Subject holding the value of the search */\n    public readonly search$ = new Subject<string>();\n    /** Whether to show menu */\n    public show_menu: boolean;\n\n    public groupedUsers: { [id: string]: User[] } = {};\n\n    /** Minimum length of the search string needed to initial a search */\n    public get min_search_length(): number {\n        const length = this._settings.get('app.directory.min_search_length');\n        return typeof length === 'number' && length >= 0 ? length : 3;\n    }\n\n    constructor(private _settings: SettingsService, private _users: StaffService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(400),\n            distinctUntilChanged(),\n            switchMap((query) => {\n                this.loading = true;\n                const retVal =\n                    query.length >= this.min_search_length\n                        ? this._users.query({ q: query }).catch(() => [])\n                        : Promise.resolve(this.user_list || []);\n                return retVal;\n            }),\n            map((list: User[]) => {\n                this.loading = false;\n                return list;\n            })\n        );\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.search_results$.subscribe((list) => {\n                this.user_list = list;\n                this.buildGroups(this.user_list);\n            })\n        );\n        this.search$.next('');\n    }\n\n    public get letters(): string[] {\n        return LETTERS;\n    }\n\n    private buildGroups(users: User[]) {\n        const sorted = users.sort((a, b) => a.name.localeCompare(b.name));\n        for (const letter of this.letters) {\n            this.groupedUsers[letter] = sorted.filter((f) => f.name.startsWith(letter));\n        }\n    }\n}\n","<div class=\"directory page\">\n    <header class=\"header\">\n        <a-topbar-header [(menu)]=\"show_menu\"></a-topbar-header>\n    </header>\n    <div class=\"actions\" [class.blank]=\"false\" [class.has-back]=\"false\">\n        <div class=\"search\">\n            <a-searchbar\n                [(value)]=\"search_str\"\n                (valueChange)=\"search$.next($event)\"\n                [loading]=\"loading\"\n                [autofocus]=\"true\"\n                [flat]=\"true\"\n                placeholder=\"Search for a person...\"\n            ></a-searchbar>\n        </div>\n    </div>\n    <main>\n        <ng-container *ngIf=\"groupedUsers && user_list.length; else empty_state\">\n            <ng-container *ngFor=\"let letter of letters\">\n                <ng-container *ngIf=\"groupedUsers[letter].length\">\n                    <div class=\"letter\">{{ letter }}</div>\n                    <a-directory-user-list-item\n                        *ngFor=\"let user of groupedUsers[letter]\"\n                        [user]=\"user\"\n                    ></a-directory-user-list-item>\n                </ng-container>\n            </ng-container>\n        </ng-container>\n    </main>\n    <footer class=\"footer\">\n        <a-footer-menu></a-footer-menu>\n    </footer>\n</div>\n<ng-template #empty_state>\n    <div class=\"list\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <app-icon\n                    [icon]=\"{\n                        type: 'icon',\n                        class: 'material-icons',\n                        content:\n                            search_str && search_str.length >= min_search_length\n                                ? 'close'\n                                : 'arrow_upward'\n                    }\"\n                ></app-icon>\n            </div>\n            <div class=\"text\">\n                {{\n                    search_str && search_str.length >= min_search_length\n                        ? ' No matches for \"' + search_str + '\"'\n                        : 'Type above to search for users'\n                }}\n            </div>\n        </div>\n    </div>\n</ng-template>\n<a-overlay-menu [(show)]=\"show_menu\"></a-overlay-menu>\n","import { Component, OnInit, Input } from '@angular/core';\n\nimport { SettingsService } from '@user-interfaces/common';\nimport { User } from '@user-interfaces/users';\n\n@Component({\n    selector: 'a-directory-user-list-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n})\nexport class DirectoryUserListItemComponent {\n    /** Space to display */\n    @Input() public user: User;\n\n    public get show_image() {\n        return this._settings.get('app.directory.show_avatars');\n    }\n\n    public sendLocateEvent() {\n        // this._service.Analytics.event('Locate', `locate_clicked_user_${this.user.name}`);\n    }\n\n    public sendCallEvent() {\n        // this._service.Analytics.event('Call', `call_clicked_user_${this.user.name}`);\n    }\n\n    constructor(private _settings: SettingsService) {}\n}\n","<div class=\"space-details\" *ngIf=\"user\" [class.with-image]=\"show_image\">\n    <div class=\"group\">\n        <div class=\"avatar\" *ngIf=\"show_image\">\n            <a-user-avatar [user]=\"user\"></a-user-avatar>\n        </div>\n        <div class=\"details\">\n            <div class=\"name\">{{ user.name }}</div>\n            <div class=\"info\">\n                <a name=\"email\" [href]=\"'mailto:' + user.email | safe: 'url'\">{{ user.email }}</a>\n            </div>\n        </div>\n    </div>\n    <div class=\"actions\">\n        <a\n            mat-flat-button\n            color=\"primary\"\n            button\n            name=\"locate\"\n            [routerLink]=\"['/explore']\"\n            [queryParams]=\"{ user: user.email }\"\n            (click)=\"sendLocateEvent()\"\n        >\n            Locate\n        </a>\n        <a\n            mat-flat-button\n            color=\"primary\"\n            button\n            name=\"call\"\n            *ngIf=\"user.phone\"\n            [href]=\"'tel:' + user.phone | safe: 'url'\"\n            (click)=\"sendCallEvent()\"\n        >\n            Call\n        </a>\n    </div>\n</div>\n"],"sourceRoot":"webpack:///"}