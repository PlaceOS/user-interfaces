"use strict";(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([["default-libs_events_src_index_ts-libs_form-fields_src_index_ts"],{3775:(W,R,o)=>{o.d(R,{ym:()=>$.y,rq:()=>x.rq,r7:()=>Z,ry:()=>x.ry,Vh:()=>x.Vh,eJ:()=>x.eJ}),o(2247),o(8539),o(6217);var $=o(3902),x=o(4211),p=o(9298),N=o(9189),t=o(6371),E=o(2711),I=o(4252),P=o(1112),j=o(8292),b=o(9756);const A=_=>{var v;return(null===(v=_.parent)||void 0===v?void 0:v.get("date"))&&(0,j.Z)(new Date,(0,b.Z)(_.parent.get("date").value,_.value))?{duration:!0}:null};function Z(_){var v,l,f;const i=new p.cw({id:new p.NI(_.id),host:new p.NI(_.host||"",[p.kI.required]),organiser:new p.NI(_.organiser||{},[p.kI.required]),creator:new p.NI(_.creator,[p.kI.required]),calendar:new p.NI(_.calendar),attendees:new p.NI(_.attendees||[]),resources:new p.NI(_.resources||[]),title:new p.NI(_.title,[p.kI.required]),body:new p.NI(_.body),private:new p.NI(_.private),date:new p.NI(_.date,[p.kI.required]),duration:new p.NI(_.duration,[A]),all_day:new p.NI(_.all_day),recurring:new p.NI(_.recurring),recurrence:new p.NI(_.recurrence),recurring_master_id:new p.NI(_.recurring_master_id),master:new p.NI(_.master),attachments:new p.NI(_.attachments),catering:new p.NI((null===(v=_.extension_data)||void 0===v?void 0:v.catering)||[]),visitor_type:new p.NI(null===(l=_.extension_data)||void 0===l?void 0:l.visitor_type),location:new p.NI(_.location),needs_space:new p.NI(!0),needs_parking:new p.NI((null===(f=_.extension_data)||void 0===f?void 0:f.needs_parking)||!1),system:new p.NI(_.system)});return i.get("organiser").valueChanges.subscribe(r=>i.controls.host.setValue(null==r?void 0:r.email)),i.get("resources").valueChanges.subscribe(r=>i.controls.system.setValue(r.length?r[0]:null)),_.id&&(i.get("host").disable(),i.get("organiser").disable()),"started"===_.state&&i.get("date").disable(),i}o(8025),(0,N.Z)(function(_,v){(0,I.Z)(2,arguments);var l=(0,E.Z)(_),f=(0,t.Z)(v);return l.setMinutes(f),l}((0,P.Z)(new Date,6),0),{days:-1})},4211:(W,R,o)=>{o.d(R,{u$:()=>N,Vh:()=>t,eJ:()=>I,ry:()=>J,rq:()=>T});var e=o(2064),n=o(3927),D=o(5038),$=o(5197),x=o(3902);const p="/api/staff/v1/events";function N(C){const M=(0,D.U)(C);return(0,e.U2M)(`${p}${M?"?"+M:""}`).pipe((0,n.U)(Z=>Z.map(O=>new x.y(O))))}function t(C,M={}){const Z=(0,D.U)(M);return(0,e.U2M)(`${p}/${encodeURIComponent(C)}${Z?"?"+Z:""}`).pipe((0,n.U)(O=>new x.y(O)))}function I(C,M,Z={},O="patch"){const L=(0,D.U)(Z);return("patch"===O?e.r$K:e.gzd)(`${p}/${encodeURIComponent(C)}${L?"?"+L:""}`,"patch"===O?M:new x.y(M).toJSON()).pipe((0,n.U)(w=>new x.y(w)))}const J=(C,M)=>{var Z;return null===(Z=C)||void 0===Z||delete Z.status,C.id?I(C.id,C,M):function(C){return(0,e.v_Q)(`${p}`,new x.y(C).toJSON()).pipe((0,n.U)(M=>new x.y(M)))}(C)};function T(C,M,Z,O={}){const L=(0,D.U)(Object.assign(Object.assign({},O),{state:Z}));return(0,e.v_Q)(`${p}/${encodeURIComponent(C)}/guests/${M}/checkin${L?"?"+L:""}`,"").pipe((0,n.U)(w=>new $.OO(w)))}},146:(W,R,o)=>{o.d(R,{W9:()=>q});var e=o(93),n=o(9298),D=o(3176),$=o(4813),x=o(7820),p=o(9034),N=o(114),t=o(8946);o(5306),o(2793),o(7073),o(8254),o(4449),o(2247),o(88),o(3702),o(8931),o(9697),o(5159),o(9685);var Q=o(620);o(7193),o(5346);var Y=o(3393);let q=(()=>{class h{}return h.\u0275fac=function(s){return new(s||h)},h.\u0275mod=t.oAB({type:h}),h.\u0275inj=t.cJS({imports:[[e.ez,n.u5,n.UX,D.lN,$.c,x.LD,p.Bb,Q.AV,Y.p9,N.Kk]]}),h})()},2793:(W,R,o)=>{o.d(R,{R:()=>x});var e=o(8946),n=o(9298),D=o(5159),$=o(5306);let x=(()=>{class p{constructor(){this.step=1,this.max=10,this.min=0}add(){this.value||(this.value=this.min||0),this.value+=this.ctrl_key?100*this.step:this.shift_key?10*this.step:this.step||1,this.value>this.max&&(this.value=this.max||10),this.setValue(this.value)}remove(){this.value||(this.value=this.min||0),this.value-=this.ctrl_key?100*this.step:this.shift_key?10*this.step:this.step||1,this.value<this.min&&(this.value=this.min||0),this.setValue(this.value)}setValue(t){this.value=t,this._onChange&&this._onChange(t)}writeValue(t){this.value=t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouch=t}}return p.\u0275fac=function(t){return new(t||p)},p.\u0275cmp=e.Xpm({type:p,selectors:[["a-counter"]],inputs:{step:"step",max:"max",min:"min",render_fn:"render_fn"},features:[e._Bn([{provide:n.JU,useExisting:(0,e.Gpc)(()=>p),multi:!0}])],decls:9,vars:3,consts:[["counter","",1,"flex","items-center","text-base",3,"keydown.shift","keydown.control","keydown.meta","keyup.shift","keyup.control","keyup.meta"],["mat-icon-button","","name","remove","type","button",3,"disabled","click"],["value","",1,"p-1","text-center"],["mat-icon-button","","name","add","type","button",3,"disabled","click"]],template:function(t,E){1&t&&(e.TgZ(0,"div",0),e.NdJ("keydown.shift",function(){return E.shift_key=!0},!1,e.Jf7)("keydown.control",function(){return E.ctrl_key=!0},!1,e.Jf7)("keydown.meta",function(){return E.ctrl_key=!0},!1,e.Jf7)("keyup.shift",function(){return E.shift_key=!1},!1,e.Jf7)("keyup.control",function(){return E.ctrl_key=!1},!1,e.Jf7)("keyup.meta",function(){return E.ctrl_key=!1},!1,e.Jf7),e.TgZ(1,"button",1),e.NdJ("click",function(){return E.remove()}),e.TgZ(2,"app-icon"),e._uU(3,"remove"),e.qZA(),e.qZA(),e.TgZ(4,"div",2),e._uU(5),e.qZA(),e.TgZ(6,"button",3),e.NdJ("click",function(){return E.add()}),e.TgZ(7,"app-icon"),e._uU(8,"add"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("disabled",!E.value||E.value===E.min),e.xp6(4),e.Oqu((E.render_fn?E.render_fn(E.value):E.value)||"0"),e.xp6(1),e.Q6J("disabled",E.value===E.max))},directives:[D.lW,$.o],styles:["[value][_ngcontent-%COMP%]{min-width:3em}"]}),p})()},7073:(W,R,o)=>{o.d(R,{Q:()=>Q});var e=o(8946),n=o(9298),D=o(6360),$=o(6371),x=o(1387),p=o(4252),t=o(2711),E=o(3897),I=o(9186);function J(S,_){if(arguments.length<1)throw new TypeError("1 argument required, but only ".concat(arguments.length," present"));var v=(0,t.Z)(S);if(!(0,E.Z)(v))throw new RangeError("Invalid time value");var l=_||{},f=null==l.format?"extended":String(l.format),i=null==l.representation?"complete":String(l.representation);if("extended"!==f&&"basic"!==f)throw new RangeError("format must be 'extended' or 'basic'");if("date"!==i&&"time"!==i&&"complete"!==i)throw new RangeError("representation must be 'date', 'time', or 'complete'");var r="",m="",F="extended"===f?"-":"",U="extended"===f?":":"";if("time"!==i){var B=(0,I.Z)(v.getDate(),2),K=(0,I.Z)(v.getMonth()+1,2),G=(0,I.Z)(v.getFullYear(),4);r="".concat(G).concat(F).concat(K).concat(F).concat(B)}if("date"!==i){var Y=v.getTimezoneOffset();if(0!==Y){var k=Math.abs(Y),q=(0,I.Z)(Math.floor(k/60),2),h=(0,I.Z)(k%60,2),y=Y<0?"+":"-";m="".concat(y).concat(q,":").concat(h)}else m="Z";var s=(0,I.Z)(v.getHours(),2),c=(0,I.Z)(v.getMinutes(),2),g=(0,I.Z)(v.getSeconds(),2),a=""===r?"":"T",u=[s,c,g].join(U);r="".concat(r).concat(a).concat(u).concat(m)}return r}var P=o(7487),j=o(6186),b=o(8703),A=o(8168),T=o(8939),C=o(3176),M=o(4813),Z=o(5877);const O=["*"];let L=(()=>{class S extends D.LF{format(v,l){return(0,P.Z)(v,"input"===l?"MMMM d, yyyy":"MMM yyyy")}}return S.\u0275fac=function(){let _;return function(l){return(_||(_=e.n5z(S)))(l||S)}}(),S.\u0275prov=e.Yz7({token:S,factory:S.\u0275fac}),S})();const w={parse:{dateInput:"LL"},display:{dateInput:"input",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}};let Q=(()=>{class S extends T.K{constructor(){super(...arguments),this._from=(new Date).valueOf(),this.position="right",this.offset="bottom"}get from(){return new Date(this._from)||(0,j.Z)(new Date)}get until(){return new Date(this._to)||function(S,_){(0,p.Z)(2,arguments);var v=(0,$.Z)(_);return(0,x.Z)(S,12*v)}((0,b.Z)(new Date),1)}get date_string(){return(0,P.Z)(new Date(this.date),"DD MMM YYYY")}ngOnInit(){this.date=(new Date).toISOString()}setValue(v){const l=new Date(this.date);let f=(0,A.Z)(v,{hours:l.getHours(),minutes:l.getMinutes()}).valueOf();f<this.from.valueOf()&&(f=this.from.valueOf()),this.date=J(f||new Date),this._onChange&&this._onChange(f),this.show_tooltip=!1}writeValue(v){this.date=J(v||new Date),this.show_tooltip=!1}registerOnChange(v){this._onChange=v}registerOnTouched(v){this._onTouch=v}setDisabledState(v){this.disabled=v}}return S.\u0275fac=function(){let _;return function(l){return(_||(_=e.n5z(S)))(l||S)}}(),S.\u0275cmp=e.Xpm({type:S,selectors:[["a-date-field"]],inputs:{_from:["from","_from"],_to:["to","_to"],position:"position",offset:"offset",disabled:"disabled"},features:[e._Bn([{provide:D._A,useClass:L},{provide:D.sG,useValue:w},{provide:n.JU,useExisting:(0,e.Gpc)(()=>S),multi:!0}]),e.qOj],ngContentSelectors:O,decls:7,vars:6,consts:[["appearance","outline","overlay","",3,"click"],["matInput","",3,"ngModel","disabled","min","max","matDatepicker","ngModelChange"],["matSuffix","",3,"for"],["picker",""]],template:function(v,l){if(1&v){const f=e.EpF();e.F$t(),e.TgZ(0,"mat-form-field",0),e.NdJ("click",function(){return e.CHM(f),e.MAs(4).open()}),e.TgZ(1,"input",1),e.NdJ("ngModelChange",function(r){return l.setValue(r)}),e.qZA(),e._UZ(2,"mat-datepicker-toggle",2),e._UZ(3,"mat-datepicker",null,3),e.TgZ(5,"mat-error"),e.Hsn(6),e.qZA(),e.qZA()}if(2&v){const f=e.MAs(4);e.xp6(1),e.Q6J("ngModel",l.date)("disabled",l.disabled)("min",l.from)("max",l.until)("matDatepicker",f),e.xp6(1),e.Q6J("for",f)}},directives:[C.KE,M.Nt,n.Fj,Z.hl,n.JJ,n.On,Z.nW,C.R9,Z.Mq,C.TO],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),S})()},8254:(W,R,o)=>{o.d(R,{B:()=>j});var e=o(8946),n=o(9298),D=o(3773),$=["years","months","weeks","days","hours","minutes","seconds"];function x(b,A){if(arguments.length<1)throw new TypeError("1 argument required, but only ".concat(arguments.length," present"));var T=(null==A?void 0:A.format)||$,C=(null==A?void 0:A.locale)||D.Z,M=(null==A?void 0:A.zero)||!1,Z=(null==A?void 0:A.delimiter)||" ",O=T.reduce(function(L,w){var Q="x".concat(w.replace(/(^.)/,function(_){return _.toUpperCase()}));return"number"==typeof b[w]&&(M||b[w])?L.concat(C.formatDistance(Q,b[w])):L},[]).join(Z);return O}var p=o(160),N=o(3176),t=o(7820),E=o(93),I=o(6360);function J(b,A){if(1&b&&(e.TgZ(0,"mat-option",5),e._uU(1),e.qZA()),2&b){const T=A.$implicit;e.Q6J("value",T.id),e.xp6(1),e.hij(" ",T.name," ")}}const P=["*"];let j=(()=>{class b{constructor(){this.max=240,this.min=30,this.step=15,this.specialPreprops=[],this.duration=60}ngOnInit(){this.duration_options=this.generateDurationOptions(this.max,this.min,this.step)}ngOnChanges(T){(T.max||T.min||T.step||T.time)&&(this.duration_options=this.generateDurationOptions(this.max,this.min,this.step))}setValue(T){this.duration=T,this._onChange&&this._onChange(+T)}writeValue(T){this.duration=T}setDisabledState(T){this.disabled=T}registerOnChange(T){this._onChange=T}registerOnTouched(T){this._onTouch=T}generateDurationOptions(T,C,M){const Z=[];let O=C;const L=this.time?p(this.time):null;for(const w of this.specialPreprops)Z.push({id:w,name:L?`${L.add(w,"m").format("h:mm A")} (${x({hours:Math.floor(w/60),minutes:w%60})})`:`${x({hours:Math.floor(w/60),minutes:w%60})}`});for(;O<=T;)Z.push({id:O,name:L?`${L.add(O,"m").format("h:mm A")} (${x({hours:Math.floor(O/60),minutes:O%60})})`:`${x({hours:Math.floor(O/60),minutes:O%60})}`}),O+=M;return Z}}return b.\u0275fac=function(T){return new(T||b)},b.\u0275cmp=e.Xpm({type:b,selectors:[["a-duration-field"]],inputs:{max:"max",min:"min",step:"step",time:"time",disabled:"disabled",specialPreprops:"specialPreprops"},features:[e._Bn([{provide:n.JU,useExisting:(0,e.Gpc)(()=>b),multi:!0}]),e.TTD],ngContentSelectors:P,decls:7,vars:5,consts:[[1,"duration-field"],["appearance","outline"],[3,"value","disabled","placeholder","valueChange"],["select",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(T,C){1&T&&(e.F$t(),e.TgZ(0,"div",0),e.TgZ(1,"mat-form-field",1),e.TgZ(2,"mat-select",2,3),e.NdJ("valueChange",function(Z){return C.setValue(Z)}),e.YNc(4,J,2,2,"mat-option",4),e.qZA(),e.TgZ(5,"mat-error"),e.Hsn(6),e.qZA(),e.qZA(),e.qZA()),2&T&&(e.uIk("disabled",C.disabled),e.xp6(2),e.Q6J("value",C.duration)("disabled",C.disabled)("placeholder",C.duration+" minutes"),e.xp6(2),e.Q6J("ngForOf",C.duration_options))},directives:[N.KE,t.gD,E.sg,N.TO,I.ey],styles:["[_nghost-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),b})()},4449:(W,R,o)=>{o.d(R,{N:()=>v});var e=o(8946),n=o(9298),D=o(2247),$=o(2711),x=o(4252);function p(l){(0,x.Z)(1,arguments);var f=(0,$.Z)(l);return f.setSeconds(0,0),f}var N=o(7487),t=o(8168),E=o(3483),I=o(7326),J=o(8292),P=o(6186),j=o(8703),b=o(9756),A=o(3176),T=o(4813),C=o(5159),M=o(5306),Z=o(93),O=o(7820),L=o(6360);const w=["select"];function Q(l,f){if(1&l&&(e.TgZ(0,"mat-option",9),e._uU(1),e.qZA()),2&l){const i=f.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.name," ")}}function S(l,f){if(1&l){const i=e.EpF();e.TgZ(0,"mat-form-field",5),e.TgZ(1,"mat-select",6,7),e.NdJ("valueChange",function(m){return e.CHM(i),e.oxw().setValue(m)}),e.YNc(3,Q,2,2,"mat-option",8),e.qZA(),e.qZA()}if(2&l){const i=e.oxw();e.xp6(1),e.Q6J("value",i.time)("disabled",i.disabled),e.xp6(2),e.Q6J("ngForOf",i.time_options)}}const _=["*"];let v=(()=>{class l extends D.KG{constructor(){super(...arguments),this.step=15,this.no_past_times=!0,this.date=(new Date).valueOf(),this.time=(0,N.Z)(new Date,"HH:mm")}ngOnInit(){this.show_select=!0,this._time_options=this.generateAvailableTimes(this.date,!this.no_past_times,this.step),this.timeout("hide",()=>this.show_select=!1)}ngOnChanges(i){(i.no_past_times||i.step)&&(this._time_options=this.generateAvailableTimes(this.date,!this.no_past_times,this.step))}get time_options(){const i=(this.time||"00:00").split(":"),r=(0,t.Z)(this.date,{hours:+i[0],minutes:+i[1]});return r.getMinutes()%15!=0&&!this._time_options.find(m=>m.id===(0,N.Z)(r,"HH:mm"))&&(this._time_options.push({name:`${(0,N.Z)(r,(0,D.hI)())}`,id:(0,N.Z)(r,"HH:mm")}),this._time_options.sort((m,F)=>`${m.id}`.localeCompare(`${F.id}`))),this._time_options}setValue(i){if(this.time=i,this._onChange){const r=(this.time||"00:00").split(":"),m=p((0,t.Z)(this.date,{hours:+r[0],minutes:+r[1]}));this._onChange(m.valueOf())}}writeValue(i){this.date=i||this.date;let r=p(this.date);r=(0,E.Z)(r,{nearestTo:5}),this.time=(0,N.Z)(r,"HH:mm"),this._time_options=this.generateAvailableTimes(this.date,!this.no_past_times,this.step)}setDisabledState(i){this.disabled=i}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouch=i}showSelect(){this.show_select=!0,this.timeout("on_shown",()=>{this.select_field&&(this.select_field.focus(),this.select_field.open(),this.subscription("listen_close",this.select_field.openedChange.subscribe(i=>{i||(this.show_select=!1)})))})}generateAvailableTimes(i,r,m=15){const F=new Date;let U=new Date(i);const B=[];r||!(0,I.Z)(U,F)&&(0,J.Z)(U,F)?U=(0,P.Z)(U):(0,J.Z)(U,F)&&(U=F),U=(0,E.Z)(U,{nearestTo:m});const K=(0,j.Z)(U);for(;(0,J.Z)(K,U);)B.push({name:`${(0,N.Z)(U,(0,D.hI)())}`,id:(0,N.Z)(U,"HH:mm")}),U=(0,b.Z)(U,m);return B}}return l.\u0275fac=function(){let f;return function(r){return(f||(f=e.n5z(l)))(r||l)}}(),l.\u0275cmp=e.Xpm({type:l,selectors:[["a-time-field"]],viewQuery:function(i,r){if(1&i&&e.Gf(w,5),2&i){let m;e.iGM(m=e.CRH())&&(r.select_field=m.first)}},inputs:{step:"step",disabled:"disabled",no_past_times:"no_past_times"},features:[e._Bn([{provide:n.JU,useExisting:(0,e.Gpc)(()=>l),multi:!0}]),e.qOj,e.TTD],ngContentSelectors:_,decls:8,vars:5,consts:[["appearance","outline",3,"keydown.enter"],["matInput","","type","time",3,"disabled","ngModel","ngModelChange"],["mat-icon-button","","matSuffix","",1,"relative","top-1","-right-1",3,"click"],[1,"text-2xl","text-black","text-opacity-50"],["appearance","outline",4,"ngIf"],["appearance","outline"],[3,"value","disabled","valueChange"],["select",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,r){1&i&&(e.F$t(),e.TgZ(0,"mat-form-field",0),e.NdJ("keydown.enter",function(){return r.showSelect()}),e.TgZ(1,"input",1),e.NdJ("ngModelChange",function(F){return r.setValue(F)}),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return r.showSelect()}),e.TgZ(3,"app-icon",3),e._uU(4," arrow_drop_down "),e.qZA(),e.qZA(),e.TgZ(5,"mat-error"),e.Hsn(6),e.qZA(),e.qZA(),e.YNc(7,S,4,3,"mat-form-field",4)),2&i&&(e.Udp("display",r.show_select?"none":""),e.xp6(1),e.Q6J("disabled",r.disabled)("ngModel",r.time),e.xp6(6),e.Q6J("ngIf",r.show_select))},directives:[A.KE,T.Nt,n.Fj,n.JJ,n.On,C.lW,A.R9,M.o,A.TO,Z.O5,O.gD,Z.sg,L.ey],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),l})()},9697:(W,R,o)=>{o.d(R,{d:()=>v});var e=o(8946),n=o(9298),D=o(9441),$=o(1134),x=o(2720),p=o(639),N=o(3720),t=o(9902),E=o(8293),I=o(3927),J=o(2247),P=o(3702),j=o(3176),b=o(4813),A=o(4618),T=o(9034),C=o(5306),M=o(93),Z=o(1039),O=o(6360);const L=["input"];function w(l,f){1&l&&e._UZ(0,"mat-spinner",11)}function Q(l,f){if(1&l){const i=e.EpF();e.TgZ(0,"mat-option",12),e.NdJ("click",function(){const F=e.CHM(i).$implicit,U=e.oxw();return U.setValue(F),U.blurInput()}),e.TgZ(1,"div",13),e._uU(2),e.qZA(),e.TgZ(3,"div",14),e._uU(4),e.qZA(),e.qZA()}if(2&l){const i=f.$implicit;e.xp6(2),e.Oqu(i.name),e.xp6(2),e.hij(" ",i.email," ")}}function S(l,f){if(1&l){const i=e.EpF();e.TgZ(0,"mat-option",15),e.TgZ(1,"div",16),e.NdJ("mousedown",function(m){return m.stopPropagation(),m.preventDefault()})("touchstart",function(m){return m.stopPropagation(),m.preventDefault()})("click",function(m){e.CHM(i);const F=e.oxw();return F.setValue(F.search_str),m.stopPropagation(),m.preventDefault()}),e.TgZ(2,"div",17),e._uU(3),e.qZA(),e.qZA(),e.qZA()}if(2&l){const i=e.oxw();e.xp6(3),e.hij(' Add external attendee "',i.search_str,'" ')}}function _(l,f){if(1&l){const i=e.EpF();e.TgZ(0,"mat-option",18),e.NdJ("click",function(){return e.CHM(i),e.oxw().empty_fn()}),e._uU(1),e.qZA()}if(2&l){const i=e.oxw();e.Q6J("disabled",!i.empty_fn),e.xp6(1),e.AsE(" ",i.search_str?"No users found.":""," ",i.error," ")}}let v=(()=>{class l extends J.KG{constructor(){super(...arguments),this.error="",this.query_fn=i=>(0,P.VE)(i),this.search$=new D.xQ,this.search_results$=this.search$.pipe((0,p.b)(400),(0,N.x)(),(0,t.w)(i=>(this.loading=!0,this.options&&this.options.length>0?(0,$.of)(this.options):i.length>=3?this.guests?(0,x.D)([(0,P.VE)(i),(0,P.jf)(i)]):this.query_fn(i):(0,$.of)([]))),(0,E.K)(i=>(0,$.of)([])),(0,I.U)(i=>{this.loading=!1,i=(0,J.xH)(i);const r=(this.search_str||"").toLowerCase();return i.filter(m=>!this.filter||this.filter(m,r))})),this.cancelReset=()=>this.clearTimeout("reset"),this.blurInput=()=>{this.timeout("blur",()=>{var i,r;return null===(r=null===(i=this._input_el)||void 0===i?void 0:i.nativeElement)||void 0===r?void 0:r.blur()})}}ngOnInit(){this.subscription("search_results",this.search_results$.subscribe(i=>this.user_list=i))}resetSearchString(){this.timeout("reset",()=>{var i;return this.search_str=(null===(i=this.active_user)||void 0===i?void 0:i.name)||""},100)}setValue(i,r){"string"==typeof i&&i===this.search_str&&(i=new P.n5({name:(this.search_str||r||"").split("@")[0],email:this.search_str||r||""})),i instanceof P.n5&&(this.active_user=i,this._onChange&&this._onChange(i),this.resetSearchString())}writeValue(i){this.active_user=i,this.resetSearchString()}setDisabledState(i){this.disabled=i}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouch=i}}return l.\u0275fac=function(){let f;return function(r){return(f||(f=e.n5z(l)))(r||l)}}(),l.\u0275cmp=e.Xpm({type:l,selectors:[["a-user-search-field"]],viewQuery:function(i,r){if(1&i&&e.Gf(L,5,e.SBq),2&i){let m;e.iGM(m=e.CRH())&&(r._input_el=m.first)}},inputs:{disabled:"disabled",placeholder:"placeholder",options:"options",guests:"guests",error:"error",validate:"validate",empty_fn:"empty_fn",filter:"filter",query_fn:"query_fn"},features:[e._Bn([{provide:n.JU,useExisting:(0,e.Gpc)(()=>l),multi:!0}]),e.qOj],decls:12,vars:8,consts:[["form-field","",1,"user-search-field","text-black"],["overlay","","appearance","outline"],["matInput","","keyboard","","name","user-search",3,"ngModel","disabled","placeholder","matAutocomplete","ngModelChange","keyup.enter","blur","focus"],["input",""],["matPrefix","",1,"text-2xl","relative"],["matSuffix","","diameter","16",4,"ngIf"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"click",4,"ngFor","ngForOf"],["class","relative pointer-events-none",4,"ngIf"],[3,"disabled","click",4,"ngIf"],["matSuffix","","diameter","16"],[3,"click"],[1,"leading-tight"],[1,"text-xs","text-black","opacity-60"],[1,"relative","pointer-events-none"],[1,"absolute","inset-0","px-4","pointer-events-auto",3,"mousedown","touchstart","click"],[1,"pointer-events-none"],[3,"disabled","click"]],template:function(i,r){if(1&i&&(e.TgZ(0,"div",0),e.TgZ(1,"mat-form-field",1),e.TgZ(2,"input",2,3),e.NdJ("ngModelChange",function(F){return r.search_str=F})("ngModelChange",function(F){return r.search$.next(F||"")})("keyup.enter",function(){return r.validate&&r.validate(r.search_str)?r.setValue(r.search_str):""})("blur",function(){return r.resetSearchString()})("focus",function(){return r.cancelReset()}),e.qZA(),e.TgZ(4,"app-icon",4),e._uU(5,"search"),e.qZA(),e.YNc(6,w,1,0,"mat-spinner",5),e.qZA(),e.TgZ(7,"mat-autocomplete",6,7),e.NdJ("optionSelected",function(F){return r.setValue(F.option.value)}),e.YNc(9,Q,5,2,"mat-option",8),e.YNc(10,S,4,1,"mat-option",9),e.YNc(11,_,2,3,"mat-option",10),e.qZA(),e.qZA()),2&i){const m=e.MAs(8);e.xp6(2),e.Q6J("ngModel",r.search_str)("disabled",r.disabled)("placeholder",r.placeholder||"Search for user...")("matAutocomplete",m),e.xp6(4),e.Q6J("ngIf",r.loading),e.xp6(3),e.Q6J("ngForOf",r.user_list),e.xp6(1),e.Q6J("ngIf",r.search_str&&r.validate&&r.validate(r.search_str)),e.xp6(1),e.Q6J("ngIf",!(null!=r.user_list&&r.user_list.length)&&(r.search_str||r.error))}},directives:[j.KE,b.Nt,A.U,n.Fj,T.ZL,n.JJ,n.On,C.o,j.qo,M.O5,T.XC,M.sg,Z.$g,j.R9,O.ey],styles:["[_nghost-%COMP%], mat-form-field[_ngcontent-%COMP%]{width:100%}app-icon[_ngcontent-%COMP%]{top:.15em;left:-.15em}"]}),l})()},3702:(W,R,o)=>{o.d(R,{Y:()=>i,rW:()=>I,U9:()=>p.U9,n5:()=>x.n5,en:()=>p.en,n2:()=>h,jf:()=>K,VE:()=>s,pP:()=>Y,w0:()=>c}),o(114);var n=o(8946),D=o(8931),$=o(2247),x=o(5197),p=o(9375);function N(a,u){if(1&a&&(n.TgZ(0,"main",6),n._UZ(1,"user-form",7),n.qZA()),2&a){const d=n.oxw();n.xp6(1),n.Q6J("form",d.form)}}function t(a,u){if(1&a){const d=n.EpF();n.TgZ(0,"footer",8),n.TgZ(1,"button",9),n._uU(2,"Cancel"),n.qZA(),n.TgZ(3,"button",10),n.NdJ("click",function(){return n.CHM(d),n.oxw().saveChanges()}),n._uU(4,"Save"),n.qZA(),n.qZA()}}function E(a,u){1&a&&(n.TgZ(0,"main",11),n._UZ(1,"mat-spinner",12),n.TgZ(2,"p"),n._uU(3,"Saving attendee..."),n.qZA(),n.qZA())}let I=(()=>{class a extends $.KG{constructor(d){super(),this._data=d,this.event=new n.vpe,this.loading=!1}ngOnInit(){this.user=this._data.user||{},this.form=(0,p.HO)(this.user)}saveChanges(){if(this.form&&(this.form.markAllAsTouched(),this.form.valid)){const d=new x.n5(Object.assign(Object.assign({},this.form.value),{type:"external"}));this.event.emit({reason:"done",metadata:d})}}}return a.\u0275fac=function(d){return new(d||a)(n.Y36(D.WI))},a.\u0275cmp=n.Xpm({type:a,selectors:[["new-user-modal"]],outputs:{event:"event"},features:[n.qOj],decls:11,vars:4,consts:[["mat-dialog-title","",1,"heading"],[1,"flex-1"],["mat-icon-button","","mat-dialog-close",""],["class","flex flex-col items-center w-full p-2",4,"ngIf","ngIfElse"],["class","flex items-center justify-center w-full p-2 border-t border-gray-300 space-x-2",4,"ngIf"],["load_state",""],[1,"flex","flex-col","items-center","w-full","p-2"],[3,"form"],[1,"flex","items-center","justify-center","w-full","p-2","border-t","border-gray-300","space-x-2"],["mat-button","","mat-dialog-close","",1,"inverse"],["mat-button","",3,"click"],[1,"flex","flex-col","items-center","w-full","p-2","space-y-2"],["diameter","32"]],template:function(d,V){if(1&d&&(n.TgZ(0,"header"),n.TgZ(1,"div",0),n._uU(2),n.qZA(),n._UZ(3,"div",1),n.TgZ(4,"button",2),n.TgZ(5,"app-icon"),n._uU(6,"close"),n.qZA(),n.qZA(),n.qZA(),n.YNc(7,N,2,1,"main",3),n.YNc(8,t,5,0,"footer",4),n.YNc(9,E,4,0,"ng-template",null,5,n.W1O)),2&d){const H=n.MAs(10);n.xp6(2),n.hij(" ",null!=V.user&&V.user.id?"Edit":"Add"," External Attendee "),n.xp6(5),n.Q6J("ngIf",!V.loading)("ngIfElse",H),n.xp6(1),n.Q6J("ngIf",!V.loading)}},styles:["main[_ngcontent-%COMP%]{min-height:20em!important;width:100%}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em}"]}),a})();var J=o(93),P=o(9298),j=o(3176),b=o(4813),A=o(3393);function T(a,u){if(1&a&&(n.TgZ(0,"div",3),n.TgZ(1,"label",4),n._uU(2," Name"),n.TgZ(3,"span"),n._uU(4,"*"),n.qZA(),n._uU(5,": "),n.qZA(),n.TgZ(6,"mat-form-field",5),n._UZ(7,"input",6),n.TgZ(8,"mat-error"),n._uU(9,"Name is required"),n.qZA(),n.qZA(),n.qZA()),2&a){const d=n.oxw(2);n.xp6(1),n.ekj("error",d.hasError("name"))}}function C(a,u){if(1&a&&(n.TgZ(0,"div",3),n.TgZ(1,"label",7),n._uU(2," Email"),n.TgZ(3,"span"),n._uU(4,"*"),n.qZA(),n._uU(5,": "),n.qZA(),n.TgZ(6,"mat-form-field",5),n._UZ(7,"input",8),n.TgZ(8,"mat-error"),n._uU(9,"A valid email is required"),n.qZA(),n.qZA(),n.qZA()),2&a){const d=n.oxw(2);n.xp6(1),n.ekj("error",d.hasError("email"))}}function M(a,u){if(1&a&&(n.TgZ(0,"div",3),n.TgZ(1,"label",9),n._uU(2," Organisation"),n.TgZ(3,"span"),n._uU(4,"*"),n.qZA(),n._uU(5,": "),n.qZA(),n.TgZ(6,"mat-form-field",5),n._UZ(7,"input",10),n.TgZ(8,"mat-error"),n._uU(9,"Organisation is required"),n.qZA(),n.qZA(),n.qZA()),2&a){const d=n.oxw(2);n.xp6(1),n.ekj("error",d.hasError("organisation"))}}function Z(a,u){if(1&a&&(n.TgZ(0,"div",3),n.TgZ(1,"label",11),n._uU(2," Phone: "),n.qZA(),n.TgZ(3,"mat-form-field",5),n._UZ(4,"input",12),n.TgZ(5,"mat-error"),n._uU(6,"Phone format is invalid"),n.qZA(),n.qZA(),n.qZA()),2&a){const d=n.oxw(2);n.xp6(1),n.ekj("error",d.hasError("phone"))}}function O(a,u){1&a&&(n.TgZ(0,"div",3),n.TgZ(1,"mat-checkbox",13),n._uU(2," Assistance required "),n.qZA(),n.qZA())}function L(a,u){1&a&&(n.TgZ(0,"div",3),n.TgZ(1,"mat-checkbox",14),n._uU(2," Visit expected "),n.qZA(),n.qZA())}function w(a,u){if(1&a&&(n.TgZ(0,"form",1),n.YNc(1,T,10,2,"div",2),n.YNc(2,C,10,2,"div",2),n.YNc(3,M,10,2,"div",2),n.YNc(4,Z,7,2,"div",2),n.YNc(5,O,3,0,"div",2),n.YNc(6,L,3,0,"div",2),n.qZA()),2&a){const d=n.oxw();n.Q6J("formGroup",d.form),n.xp6(1),n.Q6J("ngIf",d.form.controls.name),n.xp6(1),n.Q6J("ngIf",d.form.controls.email),n.xp6(1),n.Q6J("ngIf",d.form.controls.organisation),n.xp6(1),n.Q6J("ngIf",d.form.controls.phone),n.xp6(1),n.Q6J("ngIf",d.form.controls.assistance_required),n.xp6(1),n.Q6J("ngIf",d.form.controls.visit_expected)}}let Q=(()=>{class a{hasError(d){var V;const{invalid:H,touched:z}=(null===(V=this.form)||void 0===V?void 0:V.controls[d])||{};return H&&z}}return a.\u0275fac=function(d){return new(d||a)},a.\u0275cmp=n.Xpm({type:a,selectors:[["user-form"]],inputs:{form:"form"},decls:1,vars:1,consts:[["user-form","",3,"formGroup",4,"ngIf"],["user-form","",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","name"],["appearance","outline"],["matInput","","name","name","placeholder","Name","formControlName","name"],["for","email"],["matInput","","name","email","placeholder","Email Address","formControlName","email"],["for","org"],["matInput","","name","org","placeholder","Organisation","formControlName","organisation"],["for","phone"],["matInput","","name","phone","type","tel","placeholder","Phone","formControlName","phone"],["name","assistance-required","color","primary","formControlName","assistance_required"],["name","visit-expected","color","primary","formControlName","visit_expected"]],template:function(d,V){1&d&&n.YNc(0,w,7,7,"form",0),2&d&&n.Q6J("ngIf",V.form)},directives:[J.O5,P._Y,P.JL,P.sg,j.KE,b.Nt,P.Fj,P.JJ,P.u,j.TO,A.oG],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),a})();var S=o(5159),_=o(5306),v=o(1039);n.B6R(I,[D.uh,S.lW,D.ZT,_.o,J.O5,Q,v.$g],[]);var f=o(1361);class i{constructor(u={}){this.type=u.type||u.location||"other",this.position=u.position||u.map_id||{x:u.x/u.map_width||0,y:u.y/u.map_height||0},this.variance=u.variance||0,this.last_seen=u.last_seen||(0,f.Z)(new Date),this.level=u.level,this.building=u.building,this.at_location=!!u.at_location,this.coordinates_from=u.coordinates_from||"top-left"}}var r=o(2064),m=o(3927),F=o(3902),U=o(5038);const B="/api/staff/v1/guests";function K(a){const u=(0,U.U)({q:a});return(0,r.U2M)(`${B}${a?"?"+u:""}`).pipe((0,m.U)(d=>d.map(V=>new x.OO(V))))}function Y(a){return(0,r.U2M)(`${B}/${encodeURIComponent(a)}`).pipe((0,m.U)(u=>new x.OO(u)))}function h(a){return(0,r.U2M)(`${B}/${encodeURIComponent(a)}/meetings`).pipe((0,m.U)(u=>u.map(d=>new F.y(d))))}const y="/api/staff/v1/people";function s(a){const u=(0,U.U)({q:a});return(0,r.U2M)(`${y}${a?"?"+u:""}`).pipe((0,m.U)(d=>d.map(V=>new x.mO(V))))}function c(a){return(0,r.U2M)(`${y}/${encodeURIComponent(a)}`).pipe((0,m.U)(u=>new x.mO(u)))}},1112:(W,R,o)=>{o.d(R,{Z:()=>$});var e=o(6371),n=o(2711),D=o(4252);function $(x,p){(0,D.Z)(2,arguments);var N=(0,n.Z)(x),t=(0,e.Z)(p);return N.setHours(t),N}}}]);
//# sourceMappingURL=default-libs_events_src_index_ts-libs_form-fields_src_index_ts.js.map