{"version":3,"sources":["./src/app/explore/overlays/booking-modal/booking-modal.component.ts","./src/app/explore/overlays/booking-modal/booking-modal.component.html","./src/app/explore/explore.component.ts","./src/app/explore/explore.module.ts"],"names":[],"mappings":"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","file":"explore-explore-module.js","sourcesContent":["import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { FormGroup } from '@angular/forms';\n\nimport { Space } from '@user-interfaces/spaces';\nimport { BaseClass, DialogEvent } from '@user-interfaces/common';\nimport { CalendarEvent, EventsService, generateEventForm } from '@user-interfaces/events';\nimport { CalendarService } from '@user-interfaces/calendar';\nimport { StaffService } from '@user-interfaces/users';\n\nexport interface BookingModalData {\n    space: Space;\n    date: number;\n}\n\n@Component({\n    selector: 'a-booking-modal',\n    templateUrl: './booking-modal.component.html',\n    styleUrls: ['./booking-modal.component.scss'],\n})\nexport class BookingModalComponent extends BaseClass implements OnInit {\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** New Booking data */\n    public booking: CalendarEvent;\n    /** Form fields for booking */\n    public form: FormGroup;\n    /** Display string for the current loading state */\n    public loading: string;\n    /** Inditcation on which booking modal form to show */\n    public first_form: boolean;\n    /** Display string for when room is available */\n    public available_until: string;\n\n    /** Selected space */\n    public get space(): Space {\n        return this._data.space;\n    }\n\n    constructor(\n        private _calendar: CalendarService,\n        private _events: EventsService,\n        private _staff: StaffService,\n        private _dialog_ref: MatDialogRef<BookingModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: BookingModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.booking = new CalendarEvent({\n            date: this._data.date,\n            system: { id: this._data.space.id },\n            attendees: [\n                {\n                    id: this._staff.current.id,\n                    email: this._staff.current.email,\n                },\n            ],\n        } as any);\n        this.form = generateEventForm(this.booking);\n        this.first_form = true;\n    }\n\n    public next() {\n        this.first_form = false;\n    }\n\n    public cancel() {\n        this._dialog_ref.close();\n    }\n\n    public async book() {\n        this.form.markAllAsTouched();\n        if (this.form.valid) {\n            this._dialog_ref.disableClose = true;\n            this.loading = 'Checking space availability...';\n            const available = await this.checkSpaceAvailability().catch(() => {\n                // this._service.notifyError('The space is not available for this period.');\n            });\n            this.loading = '';\n            if (!available) {\n                this._dialog_ref.disableClose = false;\n                return;\n            }\n            this.loading = 'Processing booking request...';\n            try {\n                const booking = new CalendarEvent({ ...this.booking, ...this.form.value });\n                await this._events.save(booking);\n                this.event.emit({ reason: 'done' });\n                this._dialog_ref.close();\n                // this._service.notifySuccess(\n                //     `Successfully ${this.booking.id ? 'updated' : 'created'} booking`\n                // );\n            } catch (saveErr) {\n                // this._service.notifyError('Booking could not be created.');\n                this._dialog_ref.disableClose = false;\n            }\n        }\n        this.loading = '';\n    }\n\n    /**\n     * Check whether the selected spaces are available for the selected time period\n     */\n    public async checkSpaceAvailability(): Promise<boolean> {\n        const event = new CalendarEvent({ ...this.booking, ...this.form.value });\n        const available_spaces = await this._calendar.availability({\n            system_ids: event.system.id,\n            period_start: Math.floor(event.date / 1000),\n            period_end: Math.floor((event.date + event.duration * 60 * 1000) / 1000),\n        });\n\n        if (available_spaces.length < 1) {\n            throw new Error(`The space is not available for the selected time period.`);\n        }\n        return true;\n    }\n}\n","<header>\n    <div class=\"header\">\n        <div class=\"row\">\n            <div class=\"icon\">\n                <app-icon\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'add_circle' }\"\n                ></app-icon>\n            </div>\n        </div>\n        <div class=\"title\">Book {{ space.display_name || space.name }}</div>\n        <div class=\"capacity\" *ngIf=\"space.capacity >= 0\">\n            <span>Capacity: </span>{{ space.capacity }} {{ space.capacity === 1 ? 'person' : 'people' }}\n        </div>\n    </div>\n</header>\n<mat-dialog-content>\n    <div class=\"body\">\n        <div *ngIf=\"first_form\" class=\"row title\">\n            <span class=\"status\">\n                {{ available_until }}\n            </span>\n        </div>\n        <span *ngIf=\"!first_form\">\n            Would you like to add equipment to your room? (eg - room configurations, specific\n            equipment types etc) Additional requests are handled by concierge staff.\n        </span>\n        <main *ngIf=\"!loading; else load_state\">\n            <a-booking-form-modal [first_form]=\"first_form\" [form]=\"form\"></a-booking-form-modal>\n        </main>\n    </div>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <button mat-button class=\"inverse\" (click)=\"cancel()\">Cancel</button>\n        <button mat-flat-button color=\"primary\" (click)=\"book()\" class=\"book\">\n            Book\n        </button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"48\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'app-explore',\n    template: `\n        <header>\n            <a-topbar-header [(menu)]=\"show_menu\"></a-topbar-header>\n        </header>\n        <main class=\"flex flex-1 w-full relative\">\n            <explore-map-view></explore-map-view>\n        </main>\n        <footer class=\"flex w-full\">\n            <a-footer-menu class=\"w-full\"></a-footer-menu>\n        </footer>\n        <a-overlay-menu [(show)]=\"show_menu\"></a-overlay-menu>\n    `,\n    styles: [\n        `\n            :host {\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                overflow: hidden;\n                display: flex;\n                flex-direction: column;\n            }\n        `,\n    ],\n})\nexport class ExploreComponent {\n    public show_menu: boolean = false;\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Route } from '@angular/router';\nimport { FormsModule } from '@angular/forms';\n\nimport { SharedContentModule } from '../ui/shared.module';\nimport { ExploreComponent } from './explore.component';\n\nimport { BookingModalComponent } from './overlays/booking-modal/booking-modal.component';\nimport { SharedExploreModule } from '@user-interfaces/explore';\n\nimport {\n    MAP_FEATURE_DATA,\n} from '@user-interfaces/components';\n\nconst ROUTES: Route[] = [\n    { path: '', component: ExploreComponent },\n    { path: ':search_type', component: ExploreComponent },\n];\n\n@NgModule({\n    declarations: [\n        ExploreComponent,\n\n        BookingModalComponent,\n    ],\n    imports: [\n        CommonModule,\n        RouterModule.forChild(ROUTES),\n        SharedContentModule,\n        SharedExploreModule,\n        FormsModule,\n    ],\n    providers: [{ provide: MAP_FEATURE_DATA, useValue: {} }],\n})\nexport class ExploreModule {}\n"],"sourceRoot":"webpack:///"}