"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_signage_signage_module_ts"],{2229:(fi,W,d)=>{d.r(W),d.d(W,{COMPONENTS:()=>_i,SignageModule:()=>ui});var h=d(316),p=d(4456),x=d(6842),b=d(1514),be=d(363),u=d(9204),g=d(7375),Q=d(2185),m=d(3998),F=d(521),v=d(2175),K=d(1536),L=d(8627),B=d(9803),E=d(1963),y=d(5443),D=d(7841),q=d(9314),e=d(7404),C=d(2587),O=d(1134),k=d(5060),T=d(9434),X=d(3208);function Fe(n,l){if(1&n&&e.nrm(0,"img",10),2&n){const t=e.XpG(2);e.Y8G("source",t.resource.toString())}}function je(n,l){if(1&n&&e.nrm(0,"video",11),2&n){const t=e.XpG(2);e.Y8G("source",t.resource.toString())}}function ke(n,l){if(1&n&&(e.j41(0,"main",6)(1,"div",7),e.DNE(2,Fe,1,1,"img",8)(3,je,1,1,"video",9),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("ngIf","image"===t.type),e.R7$(),e.Y8G("ngIf","video"===t.type)}}function Ce(n,l){if(1&n){const t=e.RV6();e.j41(0,"footer",12)(1,"button",13),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.save.emit())}),e.EFF(2," Save Media "),e.k0s()()}}function Te(n,l){if(1&n&&(e.j41(0,"main",14),e.nrm(1,"mat-spinner",15),e.j41(2,"p"),e.EFF(3),e.k0s()()),2&n){const t=e.XpG();e.R7$(),e.Y8G("diameter",32),e.R7$(2),e.JRh(t.loading)}}let A=(()=>{class n{constructor(t){this._data=t,this.save=new e.bkB,this.loading="",this.resource=this._data.url,this.type=this._data.type,this.name=this._data.name,this.file=this._data.file,this.can_save=!1!==this._data.save}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(C.Vh))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-media-preview-modal"]],outputs:{save:"save"},decls:10,vars:4,consts:[["load_state",""],[1,"flex","items-center","justify-between","p-2","border-b","border-base-300"],[1,"px-2"],["icon","","matRipple","","mat-dialog-close",""],["class","bg-base-200",4,"ngIf","ngIfElse"],["class","p-2 flex items-center justify-end space-x-2 border-t border-base-300",4,"ngIf"],[1,"bg-base-200"],[1,"max-w-[80vw]","max-h-[65vh]","w-[80vw]","h-[65vh]","flex","items-center","justify-center"],["class","w-full h-full object-contain object-center","auth","",3,"source",4,"ngIf"],["class","w-full h-full object-contain object-center","auth","","autoplay","","controls","",3,"source",4,"ngIf"],["auth","",1,"w-full","h-full","object-contain","object-center",3,"source"],["auth","","autoplay","","controls","",1,"w-full","h-full","object-contain","object-center",3,"source"],[1,"p-2","flex","items-center","justify-end","space-x-2","border-t","border-base-300"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-8","w-[28rem]","h-[20rem]","max-w-[80vw]","max-h-[65vh]"],[3,"diameter"]],template:function(a,i){if(1&a&&(e.j41(0,"header",1)(1,"h1",2),e.EFF(2),e.k0s(),e.j41(3,"button",3)(4,"app-icon"),e.EFF(5,"close"),e.k0s()()(),e.DNE(6,ke,4,2,"main",4)(7,Ce,3,0,"footer",5)(8,Te,4,2,"ng-template",null,0,e.C5r)),2&a){const s=e.sdS(9);e.R7$(2),e.SpI("Preview - ",i.name,""),e.R7$(4),e.Y8G("ngIf",!i.loading)("ngIfElse",s),e.R7$(),e.Y8G("ngIf",i.can_save&&!i.loading)}},dependencies:[h.bT,O.LG,C.tx,k.r6,T.R,X.U]})}return n})();var ee=d(291),G=d(9908),S=d(4950),P=d(7984),te=d(5175),Me=d(7024),ie=d(9608),N=d(4992),z=d(8975);const we=["search_input"];function Ie(n,l){1&n&&(e.j41(0,"button",6)(1,"app-icon"),e.EFF(2,"close"),e.k0s()())}function Se(n,l){if(1&n&&(e.j41(0,"main",7)(1,"label",8),e.EFF(2,"Name"),e.j41(3,"span",9),e.EFF(4,"*"),e.k0s()(),e.j41(5,"mat-form-field",10),e.nrm(6,"input",11),e.j41(7,"mat-error"),e.EFF(8,"Name is required"),e.k0s()(),e.j41(9,"div",12)(10,"mat-checkbox",13),e.EFF(11,"Enabled"),e.k0s(),e.j41(12,"mat-checkbox",14),e.EFF(13," Shuffle Playback "),e.k0s()(),e.j41(14,"div",15)(15,"label",16),e.EFF(16," Default Play Time"),e.k0s(),e.j41(17,"div",17),e.EFF(18),e.nI1(19,"mediaDuration"),e.k0s()(),e.j41(20,"mat-slider",18),e.nrm(21,"input",19),e.k0s(),e.j41(22,"div",20)(23,"div",21)(24,"label",22),e.EFF(25,"Orientation"),e.k0s(),e.j41(26,"mat-form-field",10)(27,"mat-select",23)(28,"mat-option",24),e.EFF(29," Unspecified "),e.k0s(),e.j41(30,"mat-option",25),e.EFF(31,"Landscape"),e.k0s(),e.j41(32,"mat-option",26),e.EFF(33,"Portrait"),e.k0s(),e.j41(34,"mat-option",27),e.EFF(35,"Square"),e.k0s()()()(),e.j41(36,"div",21)(37,"label",28),e.EFF(38,"Animation"),e.k0s(),e.j41(39,"mat-form-field",10)(40,"mat-select",29)(41,"mat-option",30),e.EFF(42,"Cut"),e.k0s(),e.j41(43,"mat-option",30),e.EFF(44,"Cross Fade"),e.k0s(),e.j41(45,"mat-option",30),e.EFF(46,"Slide Top"),e.k0s(),e.j41(47,"mat-option",30),e.EFF(48,"Slide Left"),e.k0s(),e.j41(49,"mat-option",30),e.EFF(50,"Slide Right"),e.k0s(),e.j41(51,"mat-option",30),e.EFF(52,"Slide Bottom"),e.k0s()()()()(),e.j41(53,"label",31),e.EFF(54,"Description"),e.k0s(),e.j41(55,"mat-form-field",10),e.nrm(56,"textarea",32),e.k0s(),e.j41(57,"div",33)(58,"div",21)(59,"label",34),e.EFF(60,"Valid From"),e.k0s(),e.nrm(61,"a-date-field",35),e.k0s(),e.j41(62,"div",21)(63,"label",36),e.EFF(64,"Valid Until"),e.k0s(),e.nrm(65,"a-date-field",37),e.k0s()()()),2&n){const t=e.XpG();e.Y8G("formGroup",t.form),e.R7$(18),e.SpI(" ",e.bMT(19,10,t.form.value.default_duration/1e3)," "),e.R7$(23),e.Y8G("value",1),e.R7$(2),e.Y8G("value",2),e.R7$(2),e.Y8G("value",3),e.R7$(2),e.Y8G("value",4),e.R7$(2),e.Y8G("value",5),e.R7$(2),e.Y8G("value",6),e.R7$(14),e.Y8G("from",t.form.value.valid_from)("disabled",!t.form.value.valid_from)}}function Re(n,l){if(1&n){const t=e.RV6();e.j41(0,"footer",38)(1,"button",39),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.savePlaylist())}),e.EFF(2," Save Playlist "),e.k0s()()}}function Ee(n,l){1&n&&(e.j41(0,"main",40),e.nrm(1,"mat-spinner",41),e.j41(2,"p",42),e.EFF(3,"Saving Playlist..."),e.k0s()()),2&n&&(e.R7$(),e.Y8G("diameter",32))}let ne=(()=>{class n{constructor(t={},a,i,s){this._data=t,this._state=a,this._dialog=i,this._dialog_ref=s,this.loading=!1,this.playlist=this._data,this.media=this._state.media,this.search=new F.t(""),this.form=new p.gE({id:new p.MJ(this.playlist.id||""),name:new p.MJ(this.playlist.name||"",[p.k0.required]),description:new p.MJ(this.playlist.description||""),default_animation:new p.MJ(this.playlist.default_animation||ee.f.Cut),orientation:new p.MJ(this.playlist.orientation||"unspecified"),enabled:new p.MJ(this.playlist.enabled),random:new p.MJ(this.playlist.random),default_duration:new p.MJ(this.playlist.default_duration||15e3),valid_from:new p.MJ(1e3*this.playlist.valid_from),valid_until:new p.MJ(1e3*this.playlist.valid_until)})}savePlaylist(){var t=this;return(0,u.A)(function*(){if(t.form.markAllAsTouched(),t.form.updateValueAndValidity(),t.form.invalid)return;t.loading=!0;const a=t.form.getRawValue(),i=yield t._state.savePlaylist({...a,valid_from:(0,G._)(a.valid_from),valid_until:(0,G._)(a.valid_until)}).catch(s=>{throw(0,g.UG)("Error saving playlist"),t.loading=!1,s});t._dialog_ref.close(i)})()}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(C.Vh),e.rXU(w),e.rXU(C.bZ),e.rXU(C.CP))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-playlist-modal"]],viewQuery:function(a,i){if(1&a&&e.GBs(we,5),2&a){let s;e.mGM(s=e.lsd())&&(i.search_input=s.first)}},decls:8,vars:5,consts:[["load_state",""],[1,"flex","items-center","justify-between","border-b","border-base-300"],[1,"p-2","font-medium","text-xl"],["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 flex flex-col w-[32rem] max-w-[calc(100vw-2rem)]",3,"formGroup",4,"ngIf","ngIfElse"],["class","p-4 flex items-center justify-end space-x-2 border-t border-base-300",4,"ngIf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","flex","flex-col","w-[32rem]","max-w-[calc(100vw-2rem)]",3,"formGroup"],["for","name"],["required",""],["appearance","outline",1,"w-full"],["matInput","","name","name","placeholder","Name","formControlName","name"],[1,"flex","items-center","space-x-8","mb-4"],["formControlName","enabled"],["formControlName","random"],[1,"flex","items-center","space-x-4"],["for","default-duration",1,"w-auto","min-w-0","m-0"],[1,"text-xs","font-mono"],["min","5000","max","300000","step","1000"],["name","default-duration","matSliderThumb","","formControlName","default_duration"],[1,"flex","space-x-2"],[1,"flex-1"],["for","orientation"],["name","orientation","formControlName","orientation","placeholder","Unspecified"],["value","unspecified"],["value","landscape"],["value","portrait"],["value","square"],["for","animation"],["name","animation","formControlName","default_animation","placeholder","Playlist Default"],[3,"value"],["for","description"],["matInput","","name","description","placeholder","Description","formControlName","description",1,"min-h-32"],[1,"flex","space-x-4"],["for","valid-from"],["name","valid-from","formControlName","valid_from"],["for","valid-until"],["name","valid-until","formControlName","valid_until",3,"from","disabled"],[1,"p-4","flex","items-center","justify-end","space-x-2","border-t","border-base-300"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-8"],[3,"diameter"],[1,"mt-4"]],template:function(a,i){if(1&a&&(e.j41(0,"header",1)(1,"h1",2),e.EFF(2),e.k0s(),e.DNE(3,Ie,3,0,"button",3),e.k0s(),e.DNE(4,Se,66,12,"main",4)(5,Re,3,0,"footer",5)(6,Ee,4,1,"ng-template",null,0,e.C5r)),2&a){const s=e.sdS(7);e.R7$(2),e.SpI(" ",i.playlist.id?"Edit":"New"," Playlist "),e.R7$(),e.Y8G("ngIf",!i.loading),e.R7$(),e.Y8G("ngIf",!i.loading)("ngIfElse",s),e.R7$(),e.Y8G("ngIf",!i.loading)}},dependencies:[h.bT,p.me,p.BC,p.cb,S.rl,S.TL,P.fg,te.VO,k.wT,Me.So,O.LG,C.tx,k.r6,p.j4,p.JD,ie.G,T.R,N.IV,N.OU,z.X]})}return n})();var De=d(3240),Ge=d(4938),Pe=d(6441);function $e(n,l){1&n&&(e.j41(0,"button",6)(1,"app-icon"),e.EFF(2,"close"),e.k0s()())}function Ve(n,l){if(1&n&&(e.j41(0,"div",15)(1,"label",33),e.EFF(2,"Start Time"),e.k0s(),e.j41(3,"div",17),e.EFF(4),e.nI1(5,"mediaDuration"),e.k0s()(),e.j41(6,"mat-slider",34),e.nrm(7,"input",35),e.k0s()),2&n){const t=e.XpG(2);e.R7$(4),e.SpI(" ",e.i5U(5,2,t.form.value.start_time/1e3,!0)," "),e.R7$(2),e.Y8G("max",(t.item.video_length||3e5)-1e3)}}function Le(n,l){if(1&n&&(e.EFF(0),e.nI1(1,"mediaDuration")),2&n){const t=e.XpG(2);e.SpI(" ",e.i5U(1,1,t.form.value.play_time/1e3,!0)," ")}}function Xe(n,l){if(1&n&&(e.j41(0,"span",18),e.EFF(1),e.nI1(2,"mediaDuration"),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.SpI(" Default (",t.item.video_length?e.bMT(2,1,t.item.video_length/1e3):"",") ")}}function Ne(n,l){if(1&n){const t=e.RV6();e.j41(0,"main",7)(1,"div",8)(2,"button",9),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.preview())}),e.nrm(3,"img",10),e.j41(4,"div",11),e.EFF(5),e.k0s()(),e.j41(6,"label",12),e.EFF(7,"Name"),e.k0s(),e.j41(8,"mat-form-field",13),e.nrm(9,"input",14),e.j41(10,"mat-error"),e.EFF(11,"A name is required"),e.k0s()(),e.DNE(12,Ve,8,5),e.j41(13,"div",15)(14,"label",16),e.EFF(15," Play Time"),e.k0s(),e.j41(16,"div",17),e.DNE(17,Le,2,4)(18,Xe,3,3,"span",18),e.k0s()(),e.j41(19,"mat-slider",19),e.nrm(20,"input",20),e.k0s(),e.j41(21,"label",21),e.EFF(22,"Animation"),e.k0s(),e.j41(23,"mat-form-field",13)(24,"mat-select",22)(25,"mat-option",23),e.EFF(26,"Playlist Default"),e.k0s(),e.j41(27,"mat-option",23),e.EFF(28,"Cut"),e.k0s(),e.j41(29,"mat-option",23),e.EFF(30,"Cross Fade"),e.k0s(),e.j41(31,"mat-option",23),e.EFF(32,"Slide Top"),e.k0s(),e.j41(33,"mat-option",23),e.EFF(34,"Slide Left"),e.k0s(),e.j41(35,"mat-option",23),e.EFF(36,"Slide Right"),e.k0s(),e.j41(37,"mat-option",23),e.EFF(38,"Slide Bottom"),e.k0s()()(),e.j41(39,"label",24),e.EFF(40,"Description"),e.k0s(),e.j41(41,"mat-form-field",25),e.nrm(42,"textarea",26),e.k0s(),e.j41(43,"div",27)(44,"div",28)(45,"label",29),e.EFF(46,"Valid From"),e.k0s(),e.nrm(47,"a-date-field",30),e.k0s(),e.j41(48,"div",28)(49,"label",31),e.EFF(50,"Valid Until"),e.k0s(),e.nrm(51,"a-date-field",32),e.k0s()()()()}if(2&n){const t=e.XpG();e.Y8G("formGroup",t.form),e.R7$(3),e.Y8G("source",t.thumbnail||t.url),e.R7$(2),e.SpI(" ",t.media_type," "),e.R7$(7),e.vxM("video"===t.media_type?12:-1),e.R7$(5),e.vxM(t.form.value.play_time?17:18),e.R7$(2),e.Y8G("min",t.form.value.start_time)("max",t.item.video_length||3e5),e.R7$(6),e.Y8G("value",0),e.R7$(2),e.Y8G("value",1),e.R7$(2),e.Y8G("value",2),e.R7$(2),e.Y8G("value",3),e.R7$(2),e.Y8G("value",4),e.R7$(2),e.Y8G("value",5),e.R7$(2),e.Y8G("value",6),e.R7$(14),e.Y8G("from",t.form.value.valid_from)}}function ze(n,l){if(1&n){const t=e.RV6();e.j41(0,"footer",36)(1,"button",37),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveMedia())}),e.EFF(2," Save "),e.k0s()()}}function Ue(n,l){1&n&&(e.j41(0,"main",38),e.nrm(1,"mat-spinner",39),e.j41(2,"p"),e.EFF(3,"Saving media item..."),e.k0s()())}let ae=(()=>{class n{get media_type(){return this.file&&(this.file.type.includes("video")?"video":this.file.type.includes("image")?"image":"")||this.item.media_type}get url(){return this.item.id?this.item.media_url:(this._file_url||(this._file_url=URL.createObjectURL(this.file)),this._file_url)}constructor(t,a){this._data=t,this._dialog_ref=a,this.loading=!1,this.item=this._data.media,this.file=this._data.file,this.thumbnail=this._data.file_thumbnail||this._data.media.thumbnail_url,this.form=new p.gE({name:new p.MJ("",[p.k0.required]),description:new p.MJ(""),animation:new p.MJ(ee.f.Default),start_time:new p.MJ(0),play_time:new p.MJ(null),valid_from:new p.MJ((0,De.o)(Date.now()).valueOf()),valid_until:new p.MJ((0,Ge.e)((0,Pe.D)(Date.now()),10).valueOf())}),this.preview=()=>this._data.preview({media_url:this.url,media_type:this.media_type,name:this.form.value.name}),console.log("File:",this._data.file,this._data.file_metadata),this.form.patchValue({...this._data.media,valid_from:1e3*this._data.media.valid_from,valid_until:1e3*this._data.media.valid_until}),this._data.file&&this.form.patchValue({name:this._data.file.name}),this._data.file_metadata&&(this.item.video_length=Math.floor(1e3*this._data.file_metadata[1]))}ngOnDestroy(){this._file_url&&URL.revokeObjectURL(this._file_url)}saveMedia(){var t=this;return(0,u.A)(function*(){if(t.form.markAllAsTouched(),t.form.updateValueAndValidity(),!t.form.valid)return;t.loading=!0,t._dialog_ref.disableClose=!0;const a=t.form.getRawValue(),i={...t.item,...a,valid_from:(0,G._)(new Date(a.valid_from)),valid_until:(0,G._)(a.valid_until)},s=o=>{throw t._dialog_ref.disableClose=!1,t.loading=!1,o};t.item.id?yield(0,m.UZU)(t.item.id,i).toPromise().catch(s):yield t._data.onAdd(t.file,i).catch(s),t._dialog_ref.disableClose=!1,t._dialog_ref.close(),(0,g.VX)("Successfully saved media item.")})()}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(C.Vh),e.rXU(C.CP))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-media-modal"]],decls:8,vars:5,consts:[["load_state",""],[1,"flex","items-center","justify-between","border-b","border-base-300"],[1,"p-2","text-xl","font-medium"],["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-4 max-w-[calc(100vw-2rem)] w-[32rem] max-h-[65vh] overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex justify-end p-4 border-t border-base-300",4,"ngIf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-4","max-w-[calc(100vw-2rem)]","w-[32rem]","max-h-[65vh]","overflow-auto",3,"formGroup"],[1,"flex","flex-col"],["matRipple","",1,"relative","w-full","h-48","mx-auto","bg-base-300","rounded-xl","overflow-hidden","mb-4",3,"click"],["auth","",1,"h-full","w-full","object-contain","object-center",3,"source"],[1,"absolute","top-2","left-2","px-2","py-1","rounded","text-xs","bg-base-400","capitalize"],["for","name"],["appearance","outline"],["matInput","","name","name","formControlName","name","placeholder","Media Name"],[1,"flex","items-center","space-x-4"],["for","play-time",1,"w-auto","min-w-0","m-0"],[1,"text-xs","font-mono"],[1,"opacity-30"],["step","100",3,"min","max"],["name","play-time","matSliderThumb","","formControlName","play_time"],["for","animation"],["name","animation","formControlName","animation","placeholder","Playlist Default"],[3,"value"],["for","description"],["appearance","outline",1,"w-full"],["matInput","","name","description","placeholder","Description","formControlName","description",1,"min-h-32"],[1,"flex","space-x-4"],[1,"flex-1"],["for","valid-from"],["name","valid-from","formControlName","valid_from"],["for","valid-until"],["name","valid-until","formControlName","valid_until",3,"from"],["for","start-time",1,"w-auto","min-w-0","m-0"],["min","0","step","100",3,"max"],["name","start-time","matSliderThumb","","formControlName","start_time"],[1,"flex","justify-end","p-4","border-t","border-base-300"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-8","max-w-[calc(100vw-2rem)]","min-h-64","w-[32rem]","space-y-4"],["diameter","32"]],template:function(a,i){if(1&a&&(e.j41(0,"header",1)(1,"h2",2),e.EFF(2),e.k0s(),e.DNE(3,$e,3,0,"button",3),e.k0s(),e.DNE(4,Ne,52,15,"main",4)(5,ze,3,0,"footer",5)(6,Ue,4,0,"ng-template",null,0,e.C5r)),2&a){const s=e.sdS(7);e.R7$(2),e.SpI(" ",i.item.id?"Edit":"New"," Media Item "),e.R7$(),e.Y8G("ngIf",!i.loading),e.R7$(),e.Y8G("ngIf",!i.loading)("ngIfElse",s),e.R7$(),e.Y8G("ngIf",!i.loading)}},dependencies:[h.bT,p.me,p.BC,p.cb,S.rl,S.TL,P.fg,te.VO,k.wT,O.LG,C.tx,k.r6,p.j4,p.JD,ie.G,T.R,X.U,N.IV,N.OU,z.X]})}return n})(),w=(()=>{class n extends g.Tv{changed(){this._change.next(Date.now())}constructor(t,a,i){super(),this._org=t,this._dialog=a,this._settings=i,this._loading=new F.t(!1),this._change=new F.t(0),this._active_upload=new F.t(null),this.loading=this._loading.asObservable(),this.has_changed=this._change.asObservable(),this.media=(0,v.zV)([this._org.active_building,this._change]).pipe((0,L.p)(([s])=>!!s?.id),(0,B.B)(300),(0,E.n)(([s])=>(0,m.Pof)({limit:2500})),(0,y.T)(s=>s.data.sort((o,r)=>r.created_at-o.created_at)),(0,D.t)(1)),this.playlists=(0,v.zV)([this._org.active_building,this._change]).pipe((0,L.p)(([s])=>!!s?.id),(0,B.B)(300),(0,E.n)(()=>(0,m.oD0)({limit:500})),(0,y.T)(s=>(s.data||[]).sort((o,r)=>o.name.localeCompare(r.name))),(0,D.t)(1)),this.displays=(0,v.zV)([this._org.active_region,this._org.active_building,this._change]).pipe((0,L.p)(([s,o])=>!!o?.id),(0,E.n)(([s,o])=>(0,m.BbB)({zone_id:(this._settings.get("app.use_region")?s?.id:"")||o?.id,limit:500,signage:!0}).pipe((0,y.T)(r=>(r.data||[]).sort((c,_)=>(c.display_name||c.name).localeCompare(_.display_name||_.name))))),(0,D.t)(1)),this.zones=(0,v.zV)([this._org.active_building,this._change]).pipe((0,E.n)(([s])=>(0,m.smM)({limit:250}).pipe((0,q.W)(()=>(0,K.of)({data:[]})))),(0,y.T)(s=>(s.data||[]).sort((o,r)=>(o.display_name||o.name).localeCompare(r.display_name||r.name))))}editPlaylist(t=new m.xIT({})){return new Promise(a=>{this._dialog.open(ne,{data:t}).afterClosed().subscribe(s=>{this.timeout("changed",()=>this._change.next(Date.now())),a(s)})})}editMedia(t=new m.HN5({}),a,i=""){var s=this;return new Promise(function(){var o=(0,u.A)(function*(r){s._dialog.open(ae,{data:{media:t,file:a,file_metadata:a?yield s._getMediaMetadata(a):["landscape"===t.orientation,0],file_thumbnail:a?yield s._generateThumbnail(a,1024,720):"",playlist_id:i,onAdd:(_,f)=>s.addMedia(_,f),preview:_=>s.previewMedia(_)}}).afterClosed().subscribe(_=>{s.timeout("changed",()=>s._change.next(Date.now())),r(_)})});return function(r){return o.apply(this,arguments)}}())}savePlaylist(t){var a=this;return(0,u.A)(function*(){yield(t.id?(0,m.I_z)(t.id,t):(0,m.yDx)(t)).toPromise(),(0,g.VX)("Successfully saved playlist."),a._change.next(Date.now())})()}removePlaylist(t){return(0,u.A)(function*(){t?.id&&(yield(0,m.pIQ)(t.id).toPromise(),(0,g.VX)("Successfully removed playlist."))})()}updatePlaylistMedia(t,a){return(0,u.A)(function*(){yield(0,m.UCT)(t,a).toPromise(),(0,g.VX)("Successfully updated playlist media.")})()}previewMedia(t){this._dialog.open(A,{data:{url:t.media_url,type:t.media_type,name:t.name,save:!1}})}previewFileFromInput(t,a=""){const i=t.target;if(!i?.files?.length)return;const o=i.files[0];o&&(o.type.includes("image")||o.type.includes("video"))?this.editMedia(void 0,o,a):(0,g.UG)("Invalid file type.")}previewFileMedia(t,a=""){var i=this;const s=URL.createObjectURL(t),o=t.type.includes("image")?"image":"video",r=this._dialog.open(A,{data:{url:s,type:o,name:t.name,save:!0,file:t}});r.afterClosed().subscribe(()=>URL.revokeObjectURL(s)),r.componentInstance.save.subscribe((0,u.A)(function*(){r.componentInstance.loading="Saving...";const c=yield i.addMedia(t).catch(_=>{throw(0,g.UG)("Error saving media."),r.componentInstance.loading="",_});if(a&&c.id){const f=[...(yield(0,m.$kw)(a).toPromise()).items,c.id];yield(0,m.UCT)(a,f).toPromise()}r.close()}))}addMedia(t,a=new m.HN5({})){var i=this;return(0,u.A)(function*(){const s=R=>new Promise((V,gi)=>{let ve=null,xe=!1;(0,g.QM)(R).subscribe(Y=>{ve=Y,Y.link&&(xe=!0,V({id:Y.upload.id,link:Y.link}))},gi,()=>xe?null:V(ve))}),[o,r]=yield i._getMediaMetadata(t),c=yield i._generateThumbnail(t,1280,720).catch(R=>null),_=yield s(t);let f=null;c&&(f=yield s(function Ye(n,l){const[t,a]=n.split(","),i=t.split(":")[1].split(";")[0],s=atob(a),o=new ArrayBuffer(s.length),r=new Uint8Array(o);for(let c=0;c<s.length;c++)r[c]=s.charCodeAt(c);return new File([r],l,{type:i})}(c,`thumb+${t.name}`)));const M={...new m.HN5({...a,name:a.name||t.name,media_id:_.id,media_uri:_.link,media_type:t.type.includes("image")?"image":"video",orientation:o?"landscape":"portrait",thumbnail_id:f.id})};for(const R in M)M[R]||delete M[R];const $=yield(0,m.OSd)(M).toPromise();return i._active_upload.next(null),i._change.next(Date.now()),$})()}updateMedia(t){return(0,u.A)(function*(){t?.id&&(yield(0,m.UZU)(t.id,t).toPromise())})()}removeMedia(t){var a=this;return(0,u.A)(function*(){if(!t?.id)return;const i=yield(0,g.GE)({title:"Remove Media item",content:`\n                Are you sure you wish to remove the media item "<strong>${t.name}</strong>"?<br/><br/>\n                <i class="text-sm">The item will be removed from all playlists and the files deleted from storage.</i>\n                `,icon:{content:"delete"}},a._dialog);"done"===i.reason&&(i.loading("Removing media..."),yield(0,m.lek)(t.id).toPromise(),a._change.next(Date.now()),i.close())})()}_getMediaMetadata(t){return new Promise(a=>{const i=URL.createObjectURL(t);if(t.type.includes("video")){let s=document.createElement("video");s.src=i.toString(),s.addEventListener("loadedmetadata",()=>{const{videoWidth:o,videoHeight:r}=s;a([o>r,s.duration])}),s.load()}else{let s=new Image;s.onload=()=>a([s.width>s.height,0]),s.src=i.toString()}})}_generateThumbnail(t,a,i){var s=this;return(0,u.A)(function*(){return console.log("File:",t,a,i),t.type.includes("video")?s._generateVideoThumbnail(t,a,i):s._generateImageThumbnail(t,a,i)})()}_generateImageThumbnail(t,a,i){return new Promise((s,o)=>{const r=new Image;r.src=URL.createObjectURL(t),console.log("Image:",r.src),r.onload=()=>{const c=this._generateThumbnailFromResource(r,r.width,r.height,a,i);URL.revokeObjectURL(r.src),s(c)},r.onerror=o})}_generateVideoThumbnail(t,a,i){return new Promise((s,o)=>{const r=document.createElement("video");r.autoplay=!0,r.muted=!0,r.src=URL.createObjectURL(t),r.onloadeddata=()=>{const c=this._generateThumbnailFromResource(r,r.videoWidth,r.videoHeight,a,i);URL.revokeObjectURL(r.src),s(c)},r.onerror=o})}_generateThumbnailFromResource(t,a,i,s,o){const r=document.createElement("canvas"),c=r.getContext("2d");let _=a,f=i;const M=_/f;return _>s&&(_=o,f=_/M),f>o&&(f=s,_=f*M),r.width=_,r.height=f,c.drawImage(t,0,0,_,f),r.toDataURL("image/jpeg")}static#e=this.\u0275fac=function(a){return new(a||n)(e.KVO(Q.yb),e.KVO(C.bZ),e.KVO(g.h$))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Be=d(5189),Oe=d(6843),U=d(8223);const Ae=["app-new-staff",""];function Je(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.newItem(i.active_link))}),e.EFF(1),e.k0s()}if(2&n){const t=e.XpG();e.R7$(),e.SpI(" Add ",t.singular(t.active_link)," ")}}function Ze(n,l){if(1&n){const t=e.RV6();e.j41(0,"a",11),e.nI1(1,"lowercase"),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.active_link=i)}),e.EFF(2),e.k0s()}if(2&n){const t=l.$implicit,a=e.XpG();e.Y8G("routerLink","/signage/"+e.bMT(1,3,t))("active",a.active_link==t),e.R7$(2),e.SpI(" ",t," ")}}let se=(()=>{class n extends g.Tv{singular(t){return"Media"===t||"Playlists"===t?"Playlist":""}newItem(t){var a=this;return(0,u.A)(function*(){switch(t){case"Media":case"Playlists":const i=yield a._state.editPlaylist();i&&a._router.navigate(["/signage/media",{query:{playlist:i.id}}])}})()}constructor(t,a){super(),this._state=t,this._router=a,this.loading=this._state.loading,this.links=["Media","Displays","Zones"],this.active_link=this.links[0],this.previewFile=i=>this._state.previewFileFromInput(i)}ngOnInit(){this.subscription("route.query",this._router.events.subscribe(t=>{t instanceof x.wF&&(this.active_link=this.links.find(a=>this._router.url.includes(a.toLowerCase())))})),this.active_link=this.links.find(t=>this._router.url.includes(t.toLowerCase()))}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(w),e.rXU(x.Ix))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["","app-new-staff",""]],features:[e.Vt3],attrs:Ae,decls:15,vars:2,consts:[["tabPanel",""],[1,"flex","flex-1","h-px"],[1,"flex","flex-col","flex-1","w-1/2","h-full"],[1,"p-8","h-28","flex","items-center","justify-between"],[1,"text-2xl","font-medium"],["btn","","matRipple","","class","w-40",3,"click",4,"ngIf"],[1,"px-8"],["mat-tab-nav-bar","",3,"tabPanel"],["mat-tab-link","",3,"routerLink","active"],[1,"flex-1","h-1/2","overflow-auto","px-8","py-4"],["btn","","matRipple","",1,"w-40",3,"click"],["mat-tab-link","",3,"click","routerLink","active"]],template:function(a,i){if(1&a&&(e.nrm(0,"app-topbar"),e.j41(1,"div",1),e.nrm(2,"app-sidebar"),e.j41(3,"main",2)(4,"div",3)(5,"h2",4),e.EFF(6," Digital Signage Management "),e.k0s(),e.DNE(7,Je,2,1,"button",5),e.k0s(),e.j41(8,"div",6)(9,"nav",7),e.Z7z(10,Ze,3,5,"a",8,e.fX1),e.k0s()(),e.j41(12,"mat-tab-nav-panel",9,0),e.nrm(14,"router-outlet"),e.k0s()()()),2&a){const s=e.sdS(13);e.R7$(7),e.Y8G("ngIf","Media"===i.active_link),e.R7$(2),e.Y8G("tabPanel",s),e.R7$(),e.Dyx(i.links)}},dependencies:[h.bT,Be.S,Oe.c,k.r6,x.n3,x.Wk,U.Bu,U.hQ,U.Ql,h.GH],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}\n\n/*# sourceMappingURL=signage.component.ts-angular-inline--190.css.map*/"]})}return n})();var He=d(7871);let We=(()=>{class n extends g.Tv{constructor(t,a,i,s){super(),this._state=t,this._org=a,this._route=i,this._router=s,this.zones=[],this.levels=this._org.active_levels}ngOnInit(){var t=this;return(0,u.A)(function*(){yield t._org.initialised.pipe((0,He.$)(a=>a)).toPromise(),t.subscription("route.query",t._route.queryParamMap.subscribe(a=>{if(a.has("zone_ids")){const i=a.get("zone_ids").split(",");if(i.length){const s=t._org.levelWithID(i);if(!s)return;t._org.building=t._org.buildings.find(o=>o.id===s.parent_id),t.zones=i}}})),t.subscription("levels",t._org.active_levels.subscribe(a=>{t.zones=t.zones.filter(i=>a.find(s=>s.id===i)),!t.zones.length&&a.length&&t.zones.push(a[0].id)}))})()}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(w),e.rXU(Q.yb),e.rXU(x.nX),e.rXU(x.Ix))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-topbar"]],features:[e.Vt3],decls:1,vars:0,consts:[[1,"flex","items-center","bg-base-100","h-20","px-4","border-b","border-base-200","space-x-2"]],template:function(a,i){1&a&&e.nrm(0,"div",0)},styles:["mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em}\n\n/*# sourceMappingURL=signage-topbar.component.ts-angular-inline--191.css.map*/"]})}return n})();var oe=d(3206),I=d(1034),J=d(640);const Qe=(n,l)=>l.id;function Ke(n,l){1&n&&e.nrm(0,"div",9)}function qe(n,l){1&n&&e.nrm(0,"div",10)}function et(n,l){1&n&&(e.j41(0,"div",24)(1,"app-icon",25),e.EFF(2," add "),e.k0s()())}function tt(n,l){if(1&n&&e.nrm(0,"img",26),2&n){const t=e.XpG().$implicit;e.Y8G("source",t.thumbnail_url)}}function it(n,l){if(1&n&&(e.j41(0,"div",27),e.EFF(1),e.nI1(2,"mediaDuration"),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.bMT(2,1,t.play_time/1e3)," ")}}function nt(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",8),e.DNE(1,Ke,1,0,"div",9)(2,qe,1,0,"div",10)(3,et,3,0,"div",11),e.j41(4,"div",12),e.DNE(5,tt,1,1,"img",13),e.j41(6,"div",14),e.EFF(7),e.k0s(),e.DNE(8,it,3,3,"div",15),e.k0s(),e.j41(9,"div",16)(10,"div",17),e.EFF(11),e.k0s(),e.j41(12,"button",18)(13,"app-icon"),e.EFF(14,"more_vert"),e.k0s()(),e.j41(15,"mat-menu",null,0)(17,"button",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.editItem(i))}),e.j41(18,"div",20)(19,"app-icon",21),e.EFF(20,"edit"),e.k0s(),e.j41(21,"div",22),e.EFF(22,"Edit Media Item"),e.k0s()()(),e.j41(23,"button",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.previewItem(i))}),e.j41(24,"div",20)(25,"app-icon",21),e.EFF(26,"visibility"),e.k0s(),e.j41(27,"div",22),e.EFF(28," Preview Media Item "),e.k0s()()(),e.j41(29,"button",19),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.removeItem(i))}),e.j41(30,"div",20)(31,"app-icon",23),e.EFF(32," delete "),e.k0s(),e.j41(33,"div",22),e.EFF(34," Remove Media Item "),e.k0s()()()()()()}if(2&n){const t=l.$implicit,a=e.sdS(16),i=e.XpG(2);e.R7$(),e.vxM(t.valid_from&&i.now<t.valid_from?1:t.valid_until&&i.now>t.valid_until?2:-1),e.R7$(4),e.Y8G("ngIf",t.thumbnail_url),e.R7$(),e.AVh("bg-info","video"===t.media_type)("text-info-content","video"===t.media_type)("bg-warning","image"===t.media_type)("text-warning-content","image"===t.media_type),e.R7$(),e.SpI(" ",t.media_type," "),e.R7$(),e.Y8G("ngIf",t.play_time),e.R7$(2),e.Y8G("matTooltip",t.name),e.R7$(),e.SpI(" ",t.name," "),e.R7$(),e.Y8G("matMenuTriggerFor",a)}}function at(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",7),e.nI1(1,"async"),e.bIt("cdkDropListDropped",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.drop(i))}),e.Z7z(2,nt,35,15,"div",8,Qe),e.nI1(4,"async"),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("cdkDropListData",e.bMT(1,2,t.media))("cdkDropListConnectedTo",t.playlist_ids),e.R7$(2),e.Dyx(e.bMT(4,4,t.media))}}function st(n,l){1&n&&(e.j41(0,"div",6)(1,"app-icon",28),e.EFF(2,"hide_image"),e.k0s(),e.j41(3,"p"),e.EFF(4,"No media found."),e.k0s()())}let le=(()=>{class n{get now(){return(0,G._)((0,oe.c)(Date.now()))}constructor(t){var a=this;this._state=t,this.playlist_count=0,this.search=new F.t(""),this.media=(0,v.zV)([this.search,this._state.media]).pipe((0,y.T)(([i,s])=>s.filter(o=>o.name.toLowerCase().includes(i.toLowerCase())))),this.playlist_ids=[],this.previewItem=i=>this._state.previewMedia(i),this.editItem=i=>this._state.editMedia(i),this.removeItem=function(){var i=(0,u.A)(function*(s){return a._state.removeMedia(s)});return function(s){return i.apply(this,arguments)}}()}ngOnChanges(t){t.playlist_count&&(this.playlist_ids=new Array(this.playlist_count).fill(0).map((a,i)=>`playlist-${i}`))}drop(t){}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(w))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-media-list"]],inputs:{playlist_count:"playlist_count"},features:[e.OA$],decls:8,vars:4,consts:[["menu","matMenu"],[1,"p-4"],[1,"text-xl","font-medium","text-center","mb-4"],["appearance","outline",1,"w-full","no-subscript"],["matInput","","placeholder","Search...",3,"ngModelChange","ngModel"],["cdkDropList","","id","media-list",1,"grid","w-full","gap-4","md:grid-cols-2","lg:grid-cols-3","p-4",3,"cdkDropListData","cdkDropListConnectedTo"],[1,"flex","flex-col","items-center","justify-center","p-8","space-y-2","opacity-30","mx-auto","flex-1"],["cdkDropList","","id","media-list",1,"grid","w-full","gap-4","md:grid-cols-2","lg:grid-cols-3","p-4",3,"cdkDropListDropped","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"relative","bg-base-100","rounded-lg","flex","flex-col","items-center","justify-center","p-3","hover:opacity-80","border","border-base-300"],[1,"absolute","inset-0","z-0","bg-warning","opacity-10","rounded-lg"],[1,"absolute","inset-0","z-0","bg-error","opacity-10","rounded-lg"],["class","min-h-10 min-w-10 border-4 rounded-2xl border-base-400 bg-base-300 border-dashed flex items-center justify-center",4,"cdkDragPlaceholder"],["preview","",1,"relative","w-full","h-36","bg-base-200","rounded-lg","overflow-hidden"],["auth","","class","w-full h-full object-contain rounded-lg",3,"source",4,"ngIf"],[1,"absolute","top-1","left-1","px-2","py-1","text-xs","rounded-lg","capitalize","font-mono"],["class","absolute bottom-1 right-1 px-2 py-1 text-xs rounded-lg bg-info text-info-content capitalize font-mono",4,"ngIf"],[1,"flex","items-center","justify-between","w-full","relative","top-1"],[1,"text-base-content","truncate","flex-1","w-1/2",3,"matTooltip"],["icon","","matRipple","","aria-label","Media Actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"flex","items-center","space-x-2"],[1,"text-2xl"],[1,"pr-2"],[1,"text-2xl","text-error"],[1,"min-h-10","min-w-10","border-4","rounded-2xl","border-base-400","bg-base-300","border-dashed","flex","items-center","justify-center"],[1,"text-2xl","text-base-100"],["auth","",1,"w-full","h-full","object-contain","rounded-lg",3,"source"],[1,"absolute","bottom-1","right-1","px-2","py-1","text-xs","rounded-lg","bg-info","text-info-content","capitalize","font-mono"],[1,"text-6xl"]],template:function(a,i){if(1&a&&(e.j41(0,"div",1)(1,"h3",2),e.EFF(2,"Media"),e.k0s(),e.j41(3,"mat-form-field",3)(4,"input",4),e.bIt("ngModelChange",function(o){return i.search.next(o)}),e.k0s()()(),e.DNE(5,at,5,6,"div",5),e.nI1(6,"async"),e.DNE(7,st,5,0,"div",6)),2&a){let s;e.R7$(4),e.Y8G("ngModel",i.search.getValue()),e.R7$(),e.vxM((null==(s=e.bMT(6,2,i.media))?null:s.length)>0?5:7)}},dependencies:[h.bT,p.me,p.BC,p.vS,S.rl,P.fg,I.kk,I.fb,I.Cp,J.oV,k.r6,T.R,X.U,b.O7,b.T1,b.EM,h.Jj,z.X],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}\n\n/*# sourceMappingURL=signage-media-list.component.ts-angular-inline--192.css.map*/"]})}return n})();var j=d(3602),re=d(9273);function ot(n,l){1&n&&(e.j41(0,"div",14),e.EFF(1," Shuffle ON "),e.k0s())}function lt(n,l){1&n&&e.nrm(0,"div",18)}function rt(n,l){1&n&&e.nrm(0,"div",19)}function ct(n,l){1&n&&(e.j41(0,"div",31)(1,"app-icon",32),e.EFF(2," add "),e.k0s()())}function dt(n,l){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",17),e.DNE(2,lt,1,0,"div",18)(3,rt,1,0,"div",19)(4,ct,3,0,"div",20),e.j41(5,"button",21)(6,"app-icon"),e.EFF(7,"drag_handle"),e.k0s()(),e.j41(8,"div",22),e.nrm(9,"img",23),e.k0s(),e.j41(10,"div",24),e.EFF(11),e.k0s(),e.j41(12,"button",25)(13,"app-icon"),e.EFF(14,"more_vert"),e.k0s()(),e.j41(15,"mat-menu",null,0)(17,"button",26),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.editItem(i))}),e.j41(18,"div",27)(19,"app-icon",28),e.EFF(20," edit "),e.k0s(),e.j41(21,"div",29),e.EFF(22,"Edit Media Item"),e.k0s()()(),e.j41(23,"button",26),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.previewItem(i))}),e.j41(24,"div",27)(25,"app-icon",28),e.EFF(26," visibility "),e.k0s(),e.j41(27,"div",29),e.EFF(28," Preview Media Item "),e.k0s()()(),e.j41(29,"button",26),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.removeItem(i))}),e.j41(30,"div",27)(31,"app-icon",30),e.EFF(32," delete "),e.k0s(),e.j41(33,"div",29),e.EFF(34," Remove Media Item "),e.k0s()()()()(),e.bVm()}if(2&n){const t=l.$implicit,a=e.sdS(16),i=e.XpG(2);e.R7$(2),e.vxM(t.valid_from&&i.now<t.valid_from?2:t.valid_until&&i.now>t.valid_until?3:-1),e.R7$(7),e.Y8G("source",t.thumbnail_url),e.R7$(2),e.SpI(" ",t.name," "),e.R7$(),e.Y8G("matMenuTriggerFor",a)}}function pt(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",15),e.nI1(1,"async"),e.bIt("cdkDropListDropped",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.drop(i))}),e.DNE(2,dt,35,4,"ng-container",16),e.nI1(3,"async"),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("cdkDropListData",e.bMT(1,3,t.media))("cdkDropListConnectedTo",t.playlist_ids),e.R7$(2),e.Y8G("ngForOf",e.bMT(3,5,t.media))}}function mt(n,l){1&n&&(e.j41(0,"div",13)(1,"app-icon",33),e.EFF(2,"hide_image"),e.k0s(),e.j41(3,"p"),e.EFF(4,"No media in playlist."),e.k0s()())}let ce=(()=>{class n{get now(){return(0,G._)((0,oe.c)(Date.now()))}constructor(t,a){var i=this;this._state=t,this._router=a,this.playlist="",this.playlist_count=0,this.playlist_ids=[],this._playlist=new F.t(""),this.editPlaylist=(0,u.A)(function*(){const s=yield i.selected_playlist.pipe((0,j.s)(1)).toPromise();i._state.editPlaylist(s)}),this.removeItem=function(){var s=(0,u.A)(function*(o){const r=yield i._playlist_media.pipe((0,j.s)(1)).toPromise(),c=r.items.filter(_=>_!==o.id);console.log("Remove Item:",r,o,c),yield i._state.updatePlaylistMedia(i.playlist,c),i._playlist.next(i.playlist)});return function(o){return s.apply(this,arguments)}}(),this.previewItem=s=>this._state.previewMedia(s),this.editItem=s=>this._state.editMedia(s),this.selected_playlist=(0,v.zV)([this._playlist,this._state.playlists]).pipe((0,y.T)(([s,o])=>{const r=o.find(c=>c.id===s);return r||this._router.navigate(["/signage/media",{}]),r})),this._playlist_media=this._playlist.pipe((0,L.p)(s=>!!s),(0,B.B)(300),(0,E.n)(s=>(0,m.$kw)(s).pipe((0,q.W)(()=>(0,K.of)({id:"",items:[]})))),(0,D.t)(1)),this.media=(0,v.zV)([this._playlist_media,this._state.media]).pipe((0,y.T)(([s,o])=>s.items.map(r=>o.find(c=>c.id===r)).filter(r=>r)),(0,re.Z)([]))}ngOnChanges(t){t.playlist&&this._playlist.next(this.playlist),t.playlist_count&&(this.playlist_ids=new Array(this.playlist_count).fill(0).map((a,i)=>`playlist-${i}`))}animation_name(t){switch(t){case m.fcj.Cut:return"Cut";case m.fcj.CrossFade:return"Cross Fade";case m.fcj.SlideBottom:return"Slide Bottom";case m.fcj.SlideLeft:return"Slide Left";case m.fcj.SlideRight:return"Slide Right";case m.fcj.SlideTop:return"Slide Top"}return"Default"}drop(t){var a=this;return(0,u.A)(function*(){if(t.previousIndex===t.currentIndex)return;const i=yield a._playlist.pipe((0,j.s)(1)).toPromise(),s=yield a._playlist_media.pipe((0,j.s)(1)).toPromise();if(!i&&s)return;const o=[...s.items];(0,b.HD)(o,t.previousIndex,t.currentIndex),yield a._state.updatePlaylistMedia(i,o),a._playlist.next(a.playlist)})()}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(w),e.rXU(x.Ix))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-playlist-media-list"]],inputs:{playlist:"playlist",playlist_count:"playlist_count"},features:[e.OA$],decls:36,vars:39,consts:[["menu","matMenu"],[1,"flex","flex-col","space-y-4","relative","p-4","h-full","w-full"],[1,"text-xl","font-medium","text-center"],["icon","","matRipple","","matTooltip","Edit Playlist",1,"absolute","top-2","right-2","!m-0",3,"click"],["details","",1,"flex","items-center","flex-wrap"],[1,"ml-2","text-xs","px-2","py-1","m-1","rounded"],["class","ml-2 text-xs px-2 py-1 m-1 rounded bg-secondary text-secondary-content",4,"ngIf"],["matTooltip","Default Transition Animation",1,"text-xs","px-2","py-1","m-1"],[1,"ml-1","uppercase","bg-base-200","px-2","py-1","rounded"],["matTooltip","Default Playback Duration",1,"text-xs","px-2","py-1","m-1"],[1,"ml-1","font-mono","bg-base-200","px-2","py-1","rounded"],["matTooltip","Prefered Orientation",1,"text-xs","px-2","py-1","m-1"],["cdkDropList","","id","playlist-list",1,"flex-1","h-1/2","overflow-auto","flex","flex-col","space-y-2",3,"cdkDropListData","cdkDropListConnectedTo"],[1,"flex","flex-col","items-center","justify-center","p-8","space-y-2","opacity-30","mx-auto","flex-1"],[1,"ml-2","text-xs","px-2","py-1","m-1","rounded","bg-secondary","text-secondary-content"],["cdkDropList","","id","playlist-list",1,"flex-1","h-1/2","overflow-auto","flex","flex-col","space-y-2",3,"cdkDropListDropped","cdkDropListData","cdkDropListConnectedTo"],[4,"ngFor","ngForOf"],["cdkDrag","",1,"relative","w-full","bg-base-100","h-20","rounded-lg","flex","items-center","p-2","space-x-2","border","border-base-300"],[1,"absolute","inset-0","z-0","bg-warning","opacity-10","rounded-lg"],[1,"absolute","inset-0","z-0","bg-error","opacity-10","rounded-lg"],["class","min-h-10 min-w-10 border-4 rounded-2xl border-base-400 bg-base-300 border-dashed flex items-center justify-center",4,"cdkDragPlaceholder"],["matRipple","","cdkDragHandle","","matTooltip","Drag to reorder",1,"flex","items-center","justify-center","w-6","h-full","rounded","hover:bg-base-200"],["preview","",1,"w-[4.5rem]","h-16","bg-base-200","rounded-lg","overflow-hidden"],["auth","",1,"w-full","h-full","object-contain",3,"source"],[1,"text-base-content","truncate","flex-1","w-1/2"],["icon","","matRipple","","aria-label","Media Actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"flex","items-center","space-x-2"],[1,"text-2xl"],[1,"pr-2"],[1,"text-2xl","text-error"],[1,"min-h-10","min-w-10","border-4","rounded-2xl","border-base-400","bg-base-300","border-dashed","flex","items-center","justify-center"],[1,"text-2xl","text-base-100"],[1,"text-6xl"]],template:function(a,i){if(1&a&&(e.j41(0,"div",1)(1,"h3",2),e.EFF(2),e.nI1(3,"async"),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return i.editPlaylist()}),e.j41(5,"app-icon"),e.EFF(6,"edit"),e.k0s()(),e.j41(7,"div",4)(8,"div",5),e.nI1(9,"async"),e.nI1(10,"async"),e.nI1(11,"async"),e.nI1(12,"async"),e.EFF(13),e.nI1(14,"async"),e.k0s(),e.DNE(15,ot,2,0,"div",6),e.nI1(16,"async"),e.j41(17,"div",7),e.EFF(18," Animation: "),e.j41(19,"span",8),e.EFF(20),e.nI1(21,"async"),e.k0s()(),e.j41(22,"div",9),e.EFF(23," Duration: "),e.j41(24,"span",10),e.EFF(25),e.nI1(26,"async"),e.nI1(27,"mediaDuration"),e.k0s()(),e.j41(28,"div",11),e.EFF(29," Orientation: "),e.j41(30,"span",8),e.EFF(31),e.nI1(32,"async"),e.k0s()()(),e.DNE(33,pt,4,7,"div",12),e.nI1(34,"async"),e.DNE(35,mt,5,0,"div",13),e.k0s()),2&a){let s,o,r,c,_,f,M,$,R,V;e.R7$(2),e.SpI(" Playlist - ",null==(s=e.bMT(3,15,i.selected_playlist))?null:s.name," "),e.R7$(6),e.AVh("bg-success",null==(o=e.bMT(9,17,i.selected_playlist))?null:o.enabled)("text-success-content",null==(r=e.bMT(10,19,i.selected_playlist))?null:r.enabled)("bg-error",!(null!=(c=e.bMT(11,21,i.selected_playlist))&&c.enabled))("text-error-content",!(null!=(_=e.bMT(12,23,i.selected_playlist))&&_.enabled)),e.R7$(5),e.SpI(" ",null!=(f=e.bMT(14,25,i.selected_playlist))&&f.enabled?"Enabled":"Disabled"," "),e.R7$(2),e.Y8G("ngIf",null==(M=e.bMT(16,27,i.selected_playlist))?null:M.random),e.R7$(5),e.JRh(i.animation_name(null==($=e.bMT(21,29,i.selected_playlist))?null:$.default_animation)),e.R7$(5),e.JRh(e.bMT(27,33,(null==(R=e.bMT(26,31,i.selected_playlist))?null:R.default_duration)/1e3)),e.R7$(6),e.JRh(null==(V=e.bMT(32,35,i.selected_playlist))?null:V.orientation),e.R7$(2),e.vxM(e.bMT(34,37,i.media).length>0?33:35)}},dependencies:[h.Sq,h.bT,I.kk,I.fb,I.Cp,J.oV,k.r6,T.R,X.U,b.O7,b.T1,b.Fb,b.EM,h.Jj,z.X],styles:["[_nghost-%COMP%]{height:100%}\n\n/*# sourceMappingURL=signage-playlist-media-list.component.ts-angular-inline--194.css.map*/"]})}return n})();const _t=(n,l)=>l.id,de=()=>[],ut=()=>({playlist:""}),gt=n=>({playlist:n}),ft=()=>["media-list","playlist-list"];function ht(n,l){if(1&n){const t=e.RV6();e.j41(0,"a",13),e.bIt("cdkDropListDropped",function(i){const s=e.eBV(t).$implicit,o=e.XpG(2);return e.Njj(o.selected_playlist===s.id?"":o.drop(s,i))}),e.j41(1,"div",14),e.EFF(2),e.k0s()()}if(2&n){const t=l.$implicit,a=l.$index,i=e.XpG(2);e.AVh("!bg-secondary",i.selected_playlist===t.id)("text-secondary-content",i.selected_playlist===t.id),e.Y8G("routerLink",e.lJ4(9,de))("queryParams",e.eq3(10,gt,t.id))("id","playlist-"+a)("cdkDropListConnectedTo",e.lJ4(12,ft)),e.R7$(2),e.SpI(" ",t.name," ")}}function yt(n,l){if(1&n&&(e.Z7z(0,ht,3,13,"a",12,_t),e.nI1(2,"async")),2&n){const t=e.XpG();e.Dyx(e.bMT(2,0,t.playlists))}}function vt(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.addPlaylist())}),e.j41(1,"div",20)(2,"app-icon",21),e.EFF(3,"add"),e.k0s(),e.j41(4,"span",22),e.EFF(5,"Add Playlist"),e.k0s()()()}}function xt(n,l){if(1&n&&(e.j41(0,"div",15)(1,"app-icon",16),e.EFF(2,"hide_image"),e.k0s(),e.j41(3,"p",17),e.EFF(4),e.k0s()(),e.DNE(5,vt,6,0,"button",18)),2&n){const t=e.XpG();e.R7$(4),e.SpI(" ",t.search.getValue()?"No matching playlists found":"No playlists"," "),e.R7$(),e.Y8G("ngIf",!t.search.getValue())}}function bt(n,l){if(1&n&&(e.nrm(0,"signage-media-list",23),e.nI1(1,"async")),2&n){let t;const a=e.XpG();e.Y8G("playlist_count",null==(t=e.bMT(1,1,a.playlists))?null:t.length)}}function Ft(n,l){if(1&n&&(e.nrm(0,"signage-playlist-media-list",24),e.nI1(1,"async")),2&n){let t;const a=e.XpG();e.Y8G("playlist",a.selected_playlist)("playlist_count",null==(t=e.bMT(1,2,a.playlists))?null:t.length)}}function jt(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",25),e.bIt("dragleave",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.hideOverlay(i))})("drop",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.previewFile(i))}),e.nrm(1,"div",26),e.j41(2,"div",27)(3,"app-icon",16),e.EFF(4,"cloud_upload"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Drop Media to upload"),e.k0s()(),e.j41(7,"input",28),e.bIt("change",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.previewFile(i))}),e.k0s()()}}let pe=(()=>{class n extends g.Tv{onEnter(t){this.clearTimeout("hide_overlay"),this.show_dropzone=t?.dataTransfer?.types.includes("Files")}hideOverlay(t){this.show_dropzone&&(console.log("Hide Overlay:",t),t.target instanceof HTMLInputElement||t.preventDefault(),this.timeout("hide_overlay",()=>this.show_dropzone=!1))}constructor(t,a,i){var s;super(),s=this,this._state=t,this._router=a,this._route=i,this.search=new F.t(""),this.loading=this._state.loading,this.playlists=(0,v.zV)([this.search,this._state.playlists]).pipe((0,y.T)(([o,r])=>r.filter(c=>c.name.toLowerCase().includes(o.toLowerCase())))),this.selected_playlist="",this.show_dropzone=!1,this.addPlaylist=(0,u.A)(function*(){const o=yield s._state.editPlaylist();o&&s._router.navigate(["/signage/media",{query:{playlist:o.id}}])}),this.previewMedia=o=>this._state.previewMedia(o),this.previewFile=o=>this._state.previewFileFromInput(o,this.selected_playlist)}ngOnInit(){this.subscription("route.params",this._route.queryParamMap.subscribe(t=>{t.has("playlist")&&(this.selected_playlist=t.get("playlist"))}))}drop(t,a){var i=this;return(0,u.A)(function*(){const s=a.previousContainer.data[a.previousIndex];(!s.id||!t.id)&&console.log("Drop Event:",a);const r=[...(yield(0,m.$kw)(t.id).toPromise()).items,s.id];yield i._state.updatePlaylistMedia(t.id,r)})()}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(w),e.rXU(x.Ix),e.rXU(x.nX))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-media"]],features:[e.Vt3],decls:17,vars:15,consts:[[1,"relative","h-full","w-full","overflow-visible","flex","space-x-4"],["sidebar","",1,"w-64","h-full","flex","flex-col","space-y-4","py-4"],[1,"text-xl","font-medium","text-center"],["appearance","outline",1,"w-full","no-subscript"],["matInput","","placeholder","Search...",3,"ngModelChange","ngModel"],["matRipple","",1,"w-full","px-6","rounded-3xl","h-12","flex","items-center","hover:bg-base-200",3,"routerLink","queryParams"],[1,"w-full"],[1,"relative","flex-1","w-1/2","h-full","overflow-hidden","rounded-lg","border","border-base-300","shadow",3,"dragover","dragenter","drop"],[1,"h-full","w-full","overflow-auto"],[3,"playlist_count",4,"ngIf"],[3,"playlist","playlist_count",4,"ngIf"],["class","absolute inset-0",3,"dragleave","drop",4,"ngIf"],["matRipple","","cdkDropList","",1,"w-full","px-6","rounded-3xl","h-12","flex","items-center","hover:bg-base-200",3,"!bg-secondary","text-secondary-content","routerLink","queryParams","id","cdkDropListConnectedTo"],["matRipple","","cdkDropList","",1,"w-full","px-6","rounded-3xl","h-12","flex","items-center","hover:bg-base-200",3,"cdkDropListDropped","routerLink","queryParams","id","cdkDropListConnectedTo"],[1,"flex-1"],[1,"flex","flex-col","items-center","justify-center","p-8","space-y-2","opacity-30"],[1,"text-6xl"],[1,"text-center"],["btn","","matRipple","","class","inverse",3,"click",4,"ngIf"],["btn","","matRipple","",1,"inverse",3,"click"],[1,"flex","items-center","justify-center","w-full"],[1,"text-2xl"],[1,"ml-2","mr-4"],[3,"playlist_count"],[3,"playlist","playlist_count"],[1,"absolute","inset-0",3,"dragleave","drop"],[1,"absolute","inset-0","bg-base-content","opacity-60"],[1,"absolute","inset-4","border-4","border-dashed","border-base-300","flex","flex-col","items-center","justify-center","rounded-2xl","text-base-100","space-y-4"],["type","file",1,"absolute","inset-0","opacity-0",3,"change"]],template:function(a,i){if(1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"h3",2),e.EFF(3,"Playlists"),e.k0s(),e.j41(4,"mat-form-field",3)(5,"input",4),e.bIt("ngModelChange",function(o){return i.search.next(o)}),e.k0s()(),e.j41(6,"a",5),e.EFF(7," All Media "),e.k0s(),e.nrm(8,"hr",6),e.DNE(9,yt,3,2),e.nI1(10,"async"),e.DNE(11,xt,6,2),e.k0s(),e.j41(12,"div",7),e.bIt("dragover",function(o){return i.onEnter(o)})("dragenter",function(o){return i.onEnter(o)})("drop",function(o){return i.hideOverlay(o)},!1,e.tSv),e.j41(13,"div",8),e.DNE(14,bt,2,3,"signage-media-list",9)(15,Ft,2,4,"signage-playlist-media-list",10),e.k0s(),e.DNE(16,jt,8,0,"div",11),e.k0s()()),2&a){let s;e.R7$(5),e.Y8G("ngModel",i.search.getValue()),e.R7$(),e.AVh("!bg-secondary",!i.selected_playlist)("text-secondary-content",!i.selected_playlist),e.Y8G("routerLink",e.lJ4(13,de))("queryParams",e.lJ4(14,ut)),e.R7$(3),e.vxM((null==(s=e.bMT(10,11,i.playlists))?null:s.length)>0?9:11),e.R7$(5),e.Y8G("ngIf",!i.selected_playlist),e.R7$(),e.Y8G("ngIf",i.selected_playlist),e.R7$(),e.Y8G("ngIf",i.show_dropzone)}},dependencies:[h.bT,p.me,p.BC,p.vS,S.rl,P.fg,k.r6,T.R,x.Wk,b.O7,le,ce,h.Jj],styles:["[_nghost-%COMP%]{min-height:100%}\n\n/*# sourceMappingURL=signage-media.component.ts-angular-inline--193.css.map*/"]})}return n})();var kt=d(6815),me=d(6e3);const Ct=n=>({item:n});function Tt(n,l){1&n&&e.eu8(0)}function Mt(n,l){if(1&n&&e.DNE(0,Tt,1,0,"ng-container",11),2&n){const t=e.XpG().$implicit,a=e.XpG();e.Y8G("ngTemplateOutlet",a.result_template)("ngTemplateOutletContext",e.eq3(2,Ct,t))}}function wt(n,l){if(1&n&&(e.j41(0,"div",10),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.name||t," ")}}function It(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",9),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.selected.next(i))}),e.DNE(1,Mt,1,4,"ng-container")(2,wt,2,1,"div",10),e.k0s()}if(2&n){const t=e.XpG();e.R7$(),e.vxM(t.result_template?1:2)}}function St(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",12),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.close.next())}),e.j41(1,"div",13),e.EFF(2," No items available to select "),e.k0s()()}}let Z=(()=>{class n{constructor(){this.item_list=[],this.selected=new e.bkB,this.close=new e.bkB,this.search=new F.t(""),this._items=new F.t([])}ngOnChanges(t){t.item_list&&this._items.next(this.item_list||[])}static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["search-overlay"]],inputs:{item_list:"item_list",result_template:"result_template"},outputs:{selected:"selected",close:"close"},features:[e.OA$],decls:13,vars:2,consts:[[1,"absolute","inset-0","flex","flex-col","p-8","items-center",3,"click","keydown.esc"],[1,"absolute","inset-0","bg-base-content","opacity-70","z-0"],[1,"relative","mb-4","w-[32rem]","max-w-[calc(100%-2rem)]","mx-auto","z-10",3,"click"],["placeholder","Search...",1,"rounded-[4rem]","text-xl","text-base-content","bg-base-100","border","border-base-300","shadow","pl-14","pr-6","py-4","w-full",3,"ngModelChange","ngModel"],[1,"absolute","left-3","top-1/2","-translate-y-1/2","text-3xl","pointer-events-none"],[1,"overflow-auto","max-h-[65%]","w-[32rem]","max-w-[calc(100%-2rem)]","mx-auto","rounded","z-10",3,"click"],["matRipple","",1,"w-full","text-left"],["matRipple","",1,"w-full","p-4","text-base-100"],["icon","","matRipple","",1,"absolute","top-10","right-8","text-base-100","text-xl","h-12","w-12"],["matRipple","",1,"w-full","text-left",3,"click"],[1,"p-4","w-full","bg-base-100","hover:bg-base-200","border","border-base-300"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["matRipple","",1,"w-full","p-4","text-base-100",3,"click"],[1,"opacity-30"]],template:function(a,i){1&a&&(e.j41(0,"div",0),e.bIt("click",function(){return i.close.next()})("keydown.esc",function(){return i.close.next()},!1,e.tSv),e.nrm(1,"div",1),e.j41(2,"div",2),e.bIt("click",function(o){return o.stopPropagation()}),e.j41(3,"input",3),e.bIt("ngModelChange",function(o){return i.search.next(o)}),e.k0s(),e.j41(4,"app-icon",4),e.EFF(5," search "),e.k0s()(),e.j41(6,"div",5),e.bIt("click",function(o){return o.stopPropagation()}),e.Z7z(7,It,3,1,"button",6,e.fX1),e.DNE(9,St,3,0,"button",7),e.k0s(),e.j41(10,"button",8)(11,"app-icon"),e.EFF(12,"close"),e.k0s()()()),2&a&&(e.R7$(3),e.Y8G("ngModel",i.search.getValue()),e.R7$(4),e.Dyx(i.item_list),e.R7$(2),e.vxM(null!=i.item_list&&i.item_list.length?-1:9))},dependencies:[h.T3,p.me,p.BC,p.vS,k.r6,T.R]})}return n})();const Rt=["*"],Et=(n,l)=>l.id,Dt=()=>["/signage","media"],Gt=n=>({playlist:n});function Pt(n,l){if(1&n&&(e.j41(0,"div",6),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(" ",t.extra," ")}}function $t(n,l){if(1&n&&(e.j41(0,"a",7)(1,"app-icon"),e.EFF(2,"link"),e.k0s()()),2&n){const t=e.XpG();e.Y8G("href",t.link+t.item.id,e.B4B)}}function Vt(n,l){1&n&&e.nrm(0,"div",23)}function Lt(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",9),e.DNE(1,Vt,1,0,"div",11),e.j41(2,"button",12)(3,"app-icon"),e.EFF(4,"drag_handle"),e.k0s()(),e.j41(5,"div",13)(6,"div",14),e.EFF(7),e.k0s(),e.j41(8,"div",15),e.EFF(9),e.k0s()(),e.j41(10,"button",16)(11,"app-icon"),e.EFF(12,"more_vert"),e.k0s()(),e.j41(13,"mat-menu",null,0)(15,"a",17)(16,"div",18)(17,"app-icon",19),e.EFF(18," visibility "),e.k0s(),e.j41(19,"div",20),e.EFF(20,"View Playlist"),e.k0s()()(),e.j41(21,"button",21),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.remove.next(i))}),e.j41(22,"div",18)(23,"app-icon",22),e.EFF(24," delete "),e.k0s(),e.j41(25,"div",20),e.EFF(26,"Remove Playlist"),e.k0s()()()()()}if(2&n){const t=l.$implicit,a=e.sdS(14);e.R7$(7),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" ",t.media_count||0," Media items "),e.R7$(),e.Y8G("matMenuTriggerFor",a),e.R7$(5),e.Y8G("routerLink",e.lJ4(5,Dt))("queryParams",e.eq3(6,Gt,t.id))}}function Xt(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",8),e.bIt("cdkDropListDropped",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.ondrop.next(i))}),e.Z7z(1,Lt,27,8,"div",9,Et),e.nI1(3,"async"),e.k0s(),e.j41(4,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.add.emit())}),e.EFF(5,"Add Playlist"),e.k0s()}if(2&n){const t=e.XpG();e.R7$(),e.Dyx(e.bMT(3,0,t.active_playlists))}}function Nt(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",5)(1,"div",24)(2,"app-icon",25),e.EFF(3,"hide_image"),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s()(),e.j41(6,"button",26),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.add.emit())}),e.EFF(7," Add Playlist "),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(5),e.SpI("No playlists in ",t.name,".")}}let H=(()=>{class n{constructor(t){this._state=t,this.name="zone",this.extra="",this.link="",this.add=new e.bkB,this.remove=new e.bkB,this.ondrop=new e.bkB,this._playlist_ids=new F.t([]),this.active_playlists=(0,v.zV)([this._state.playlists,this._playlist_ids,this._state.has_changed]).pipe((0,y.T)(([a,i])=>i.map(s=>a.find(o=>o.id===s))),(0,re.Z)([]))}ngOnChanges(t){t.item&&this._playlist_ids.next(this.item?.playlists||[])}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(w))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-item-playlists"]],inputs:{item:"item",name:"name",extra:"extra",link:"link"},outputs:{add:"add",remove:"remove",ondrop:"ondrop"},features:[e.OA$],ngContentSelectors:Rt,decls:9,vars:6,consts:[["menu","matMenu"],[1,"flex","items-center","justify-center","space-x-2"],[1,"text-xl","font-medium"],["class","px-2 py-1 text-xs font-mono bg-base-200 rounded-lg uppercase",4,"ngIf"],["icon","","matRipple","","target","_blank","ref","noopener noreferrer",3,"href",4,"ngIf"],[1,"flex","flex-col","items-center","justify-center","p-8","space-y-2","mx-auto","flex-1"],[1,"px-2","py-1","text-xs","font-mono","bg-base-200","rounded-lg","uppercase"],["icon","","matRipple","","target","_blank","ref","noopener noreferrer",3,"href"],["cdkDropList","",1,"flex-1","h-1/2","overflow-auto","flex","flex-col","space-y-2","mt-4",3,"cdkDropListDropped"],["cdkDrag","",1,"w-full","bg-base-100","h-20","rounded-lg","flex","items-center","p-2","space-x-2","border","border-base-300"],["btn","","matRipple","",3,"click"],["class","h-20 w-full border-4 border-dashed border-base-400 bg-base-300 rounded-xl",4,"cdkDragPlaceholder"],["matRipple","","cdkDragHandle","","matTooltip","Drag to reorder",1,"flex","items-center","justify-center","w-6","h-full","rounded","hover:bg-base-200"],[1,"text-base-content","flex-1","w-1/2"],[1,"truncate"],[1,"truncate","text-sm","opacity-30"],["icon","","matRipple","","aria-label","Media Actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"routerLink","queryParams"],[1,"flex","items-center","space-x-2"],[1,"text-2xl"],[1,"pr-2"],["mat-menu-item","",3,"click"],[1,"text-2xl","text-error"],[1,"h-20","w-full","border-4","border-dashed","border-base-400","bg-base-300","rounded-xl"],[1,"flex","flex-col","items-center","justify-center","opacity-30"],[1,"text-6xl"],["btn","","matRipple","",1,"w-40",3,"click"]],template:function(a,i){1&a&&(e.NAR(),e.j41(0,"div",1)(1,"h3",2),e.EFF(2),e.k0s(),e.DNE(3,Pt,2,1,"div",3)(4,$t,3,1,"a",4),e.k0s(),e.SdG(5),e.DNE(6,Xt,6,2),e.nI1(7,"async"),e.DNE(8,Nt,8,1,"div",5)),2&a&&(e.R7$(2),e.SpI(" ",(null==i.item?null:i.item.display_name)||(null==i.item?null:i.item.name)," "),e.R7$(),e.Y8G("ngIf",i.extra),e.R7$(),e.Y8G("ngIf",i.link),e.R7$(2),e.vxM(e.bMT(7,4,i.active_playlists).length>0&&i.item?6:8))},dependencies:[h.bT,I.kk,I.fb,I.Cp,J.oV,k.r6,T.R,x.Wk,b.O7,b.T1,b.Fb,b.EM,h.Jj],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}\n\n/*# sourceMappingURL=signage-item-playlists.component.ts-angular-inline--195.css.map*/"]})}return n})();var zt=d(5312);const _e=(n,l)=>l.id,ue=()=>[],Ut=n=>({display:n}),Yt=(n,l)=>({display:n,trigger:l}),Bt=()=>["/signage","zones"],Ot=n=>({zone:n});function At(n,l){if(1&n&&(e.j41(0,"div",12)(1,"div",13),e.nrm(2,"div",14),e.k0s(),e.j41(3,"a",15)(4,"span",16),e.EFF(5),e.k0s()()()),2&n){const t=l.$implicit,a=e.XpG(2).$implicit,i=e.XpG(2);e.R7$(3),e.AVh("!bg-secondary",i.selected_trigger.getValue()===(null==t?null:t.id))("text-secondary-content",i.selected_trigger.getValue()===(null==t?null:t.id)),e.Y8G("routerLink",e.lJ4(7,ue))("queryParams",e.l_i(8,Yt,a.id,null==t?null:t.id)),e.R7$(2),e.JRh((null==t?null:t.display_name)||(null==t?null:t.name)||"Trigger")}}function Jt(n,l){if(1&n&&(e.Z7z(0,At,6,11,"div",12,_e),e.nI1(2,"async")),2&n){const t=e.XpG(3);e.Dyx(e.bMT(2,0,t.triggers))}}function Zt(n,l){if(1&n&&(e.j41(0,"a",11),e.EFF(1),e.k0s(),e.DNE(2,Jt,3,2),e.nI1(3,"async")),2&n){let t;const a=l.$implicit,i=e.XpG(2);e.AVh("!bg-secondary",i.selected.getValue()===a.id)("text-secondary-content",i.selected.getValue()===a.id),e.Y8G("routerLink",e.lJ4(10,ue))("queryParams",e.eq3(11,Ut,a.id)),e.R7$(),e.SpI(" ",a.display_name||a.name," "),e.R7$(),e.vxM((null==(t=e.bMT(3,8,i.active_display))?null:t.id)!==a.id||i.switching?-1:2)}}function Ht(n,l){if(1&n&&(e.j41(0,"div",5),e.Z7z(1,Zt,4,13,null,null,_e),e.nI1(3,"async"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Dyx(e.bMT(3,0,t.displays))}}function Wt(n,l){if(1&n&&(e.j41(0,"div",6)(1,"app-icon",17),e.EFF(2,"hide_image"),e.k0s(),e.j41(3,"p",18),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.SpI(" ",t.search.getValue()?"No matching displays found":"No displays"," ")}}function Qt(n,l){if(1&n&&(e.j41(0,"a",22),e.EFF(1),e.nI1(2,"zone"),e.nI1(3,"async"),e.nI1(4,"zone"),e.nI1(5,"async"),e.k0s()),2&n){let t;const a=l.$implicit;e.Y8G("routerLink",e.lJ4(11,Bt))("queryParams",e.eq3(12,Ot,a)),e.R7$(),e.SpI(" ",(null==(t=e.bMT(3,5,e.bMT(2,3,a)))?null:t.display_name)||(null==(t=e.bMT(5,9,e.bMT(4,7,a)))?null:t.name)," ")}}function Kt(n,l){if(1&n&&(e.j41(0,"div",21),e.Z7z(1,Qt,6,14,"a",22,e.fX1),e.nI1(3,"async"),e.j41(4,"button",23),e.EFF(5," Add Zone "),e.k0s()()),2&n){let t;const a=e.XpG(2);e.R7$(),e.Dyx(null==(t=e.bMT(3,0,a.active_display))?null:t.zones)}}function qt(n,l){if(1&n){const t=e.RV6();e.j41(0,"signage-item-playlists",19),e.nI1(1,"async"),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.nI1(5,"async"),e.nI1(6,"async"),e.bIt("add",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.adding=!0)})("remove",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.removePlaylist(i))})("ondrop",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.drop(i))}),e.DNE(7,Kt,6,2,"div",20),e.nI1(8,"async"),e.k0s()}if(2&n){let t;const a=e.XpG();e.Y8G("item",e.bMT(1,5,a.active_trigger)||e.bMT(2,7,a.active_display))("name",e.bMT(3,9,a.active_trigger)?"trigger":"display")("extra",e.bMT(4,11,a.active_trigger)?"":null==(t=e.bMT(5,13,a.active_display))?null:t.orientation)("link",e.bMT(6,15,a.active_trigger)?"":a.signage_path+"/#/signage/"),e.R7$(7),e.Y8G("ngIf",!e.bMT(8,17,a.active_trigger))}}function ei(n,l){1&n&&(e.j41(0,"div",9)(1,"app-icon",17),e.EFF(2,"desktop_windows"),e.k0s(),e.j41(3,"p"),e.EFF(4,"Select a display from the left to view playlists"),e.k0s()())}function ti(n,l){if(1&n){const t=e.RV6();e.j41(0,"search-overlay",24),e.nI1(1,"async"),e.bIt("selected",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.addPlaylist(i))})("close",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.adding=!1)}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("item_list",e.bMT(1,1,t.playlists))}}let ge=(()=>{class n extends g.Tv{get signage_path(){return this._settings.get("app.signage_path")||"/signage"}constructor(t,a,i){super(),this._state=t,this._route=a,this._settings=i,this.adding=!1,this.switching=!1,this.search=new F.t(""),this.loading=this._state.loading,this.displays=(0,v.zV)([this.search,this._state.displays]).pipe((0,y.T)(([s,o])=>o.filter(r=>r.name.toLowerCase().includes(s.toLowerCase())))),this.selected=new F.t(""),this.selected_trigger=new F.t(""),this.active_display=(0,v.zV)([this.displays,this.selected]).pipe((0,y.T)(([s,o])=>s.find(r=>r.id===o))),this.triggers=this.selected.pipe((0,E.n)(s=>(0,m.xW)(s)),(0,y.T)(s=>s.data),(0,me.M)(s=>setTimeout(()=>this.switching=!1,200)),(0,D.t)(1)),this.active_trigger=(0,v.zV)([this.triggers,this.selected_trigger,this.selected]).pipe((0,y.T)(([s,o,r])=>s.find(c=>c.id===o&&c.control_system_id===r))),this.playlists=(0,v.zV)([this.active_display,this.active_trigger,this._state.playlists,this._state.has_changed]).pipe((0,y.T)(([s,o,r])=>r.filter(c=>!(o||s)?.playlists.find(_=>c.id===_))))}ngOnInit(){this.subscription("route.params",this._route.queryParamMap.subscribe(t=>{this.switching=t.get("display")!==this.selected.getValue(),this.selected.next(t.get("display")||""),this.selected_trigger.next(t.get("trigger")||"")}))}addPlaylist(t){var a=this;return(0,u.A)(function*(){const i=yield a.active_display.pipe((0,j.s)(1)).toPromise(),s=yield a.active_trigger.pipe((0,j.s)(1)).toPromise(),o=s||i,r=[...o.playlists,t.id];yield(s?m.Yjp:m.Pny)(o.id,{playlists:r,version:i.version},"patch").toPromise(),(0,g.VX)("Successfully added playlist to the "+(s?"trigger":"display")),a._state.changed(),a.adding=!1})()}removePlaylist(t){var a=this;return(0,u.A)(function*(){const i=yield a.active_display.pipe((0,j.s)(1)).toPromise(),s=yield a.active_trigger.pipe((0,j.s)(1)).toPromise(),o=s||i,r=o.playlists.filter(_=>t.id!==_);yield(s?m.Yjp:m.Pny)(o.id,{playlists:r,version:i.version},"patch").toPromise(),(0,g.VX)("Successfully removed playlist from "+(s?"trigger":"display")),a._state.changed(),a.adding=!1})()}drop(t){var a=this;return(0,u.A)(function*(){const i=yield a.active_display.pipe((0,j.s)(1)).toPromise(),s=yield a.active_trigger.pipe((0,j.s)(1)).toPromise(),o=s||i,r=o.playlists,c=[...r];(0,b.HD)(c,t.previousIndex,t.currentIndex),o.playlists=c,a._state.changed(),yield(s?m.Yjp:m.Pny)(o.id,{playlists:c,version:i.version},"patch").toPromise().catch(f=>{throw o.playlists=r,a._state.changed(),f}),(0,g.VX)("Successfully re-ordered playlists on "+(s?"trigger":"display")),a._state.changed()})()}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(w),e.rXU(x.nX),e.rXU(g.h$))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-displays"]],features:[e.Vt3],decls:14,vars:8,consts:[[1,"relative","h-full","w-full","overflow-visible","flex","space-x-4"],["sidebar","",1,"w-64","h-full","flex","flex-col","space-y-4","py-4"],[1,"text-xl","font-medium","text-center"],["appearance","outline",1,"w-full","no-subscript"],["matInput","","placeholder","Search...",3,"ngModelChange","ngModel"],[1,"h-1/2","flex-1","w-full","overflow-auto","space-y-2"],[1,"flex","flex-col","items-center","justify-center","p-8","space-y-2","opacity-30"],[1,"relative","flex","flex-col","flex-1","w-1/2","h-full","overflow-auto","rounded-lg","border","border-base-300","p-4","shadow","space-y-4"],[1,"flex","flex-col","flex-1",3,"item","name","extra","link"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2","opacity-30"],[3,"item_list","selected","close",4,"ngIf"],["matRipple","",1,"w-full","px-6","rounded-3xl","min-h-12","flex","items-center","hover:bg-base-200","truncate","z-10",3,"routerLink","queryParams"],[1,"relative","flex","items-center","space-x-2","z-0"],[1,"w-6"],[1,"absolute","h-16","w-4","border-b-2","border-l-2","border-base-300","top-1/2","left-6","-translate-y-full"],["matRipple","",1,"w-1/2","flex-1","px-6","rounded-3xl","min-h-12","flex","items-center","hover:bg-base-200","truncate",3,"routerLink","queryParams"],[1,"max-w-full","truncate"],[1,"text-6xl"],[1,"text-center"],[1,"flex","flex-col","flex-1",3,"add","remove","ondrop","item","name","extra","link"],["class","flex flex-wrap items-center overflow-auto mt-4",4,"ngIf"],[1,"flex","flex-wrap","items-center","overflow-auto","mt-4"],["matRipple","",1,"px-2","py-1","font-mono","text-xs","bg-base-200","rounded","whitespace-nowrap","m-1",3,"routerLink","queryParams"],["matRipple","",1,"underline","font-mono","text-xs","px-2","py-1","rounded","m-1"],[3,"selected","close","item_list"]],template:function(a,i){if(1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"h3",2),e.EFF(3,"Displays"),e.k0s(),e.j41(4,"mat-form-field",3)(5,"input",4),e.bIt("ngModelChange",function(o){return i.search.next(o)}),e.k0s()(),e.DNE(6,Ht,4,2,"div",5),e.nI1(7,"async"),e.DNE(8,Wt,5,1,"div",6),e.k0s(),e.j41(9,"div",7),e.DNE(10,qt,9,19,"signage-item-playlists",8),e.nI1(11,"async"),e.DNE(12,ei,5,0,"div",9)(13,ti,2,3,"search-overlay",10),e.k0s()()),2&a){let s;e.R7$(5),e.Y8G("ngModel",i.search.getValue()),e.R7$(),e.vxM((null==(s=e.bMT(7,4,i.displays))?null:s.length)>0?6:8),e.R7$(4),e.vxM(e.bMT(11,6,i.active_display)?10:12),e.R7$(3),e.Y8G("ngIf",i.adding)}},dependencies:[h.bT,p.me,p.BC,p.vS,S.rl,P.fg,k.r6,T.R,x.Wk,Z,H,h.Jj,zt.l]})}return n})();const fe=(n,l)=>l.id,he=()=>[],ii=n=>({zone:n}),ni=(n,l)=>({zone:n,trigger:l});function ai(n,l){if(1&n&&(e.j41(0,"div",12)(1,"div",13),e.nrm(2,"div",14),e.k0s(),e.j41(3,"a",15),e.EFF(4),e.k0s()()),2&n){const t=l.$implicit,a=e.XpG(2).$implicit,i=e.XpG(2);e.R7$(3),e.AVh("!bg-secondary",i.selected_trigger.getValue()===(null==t?null:t.id))("text-secondary-content",i.selected_trigger.getValue()===(null==t?null:t.id)),e.Y8G("routerLink",e.lJ4(7,he))("queryParams",e.l_i(8,ni,a.id,null==t?null:t.id)),e.R7$(),e.SpI(" ",(null==t?null:t.display_name)||(null==t?null:t.name)||"Trigger"," ")}}function si(n,l){if(1&n&&(e.Z7z(0,ai,5,11,"div",12,fe),e.nI1(2,"async")),2&n){const t=e.XpG(3);e.Dyx(e.bMT(2,0,t.triggers))}}function oi(n,l){if(1&n&&(e.j41(0,"a",11),e.EFF(1),e.k0s(),e.DNE(2,si,3,2),e.nI1(3,"async")),2&n){let t;const a=l.$implicit,i=e.XpG(2);e.AVh("!bg-secondary",i.selected.getValue()===a.id)("text-secondary-content",i.selected.getValue()===a.id),e.Y8G("routerLink",e.lJ4(10,he))("queryParams",e.eq3(11,ii,a.id)),e.R7$(),e.SpI(" ",a.display_name||a.name," "),e.R7$(),e.vxM((null==(t=e.bMT(3,8,i.active_zone))?null:t.id)!==a.id||i.switching?-1:2)}}function li(n,l){if(1&n&&(e.j41(0,"div",5),e.Z7z(1,oi,4,13,null,null,fe),e.nI1(3,"async"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Dyx(e.bMT(3,0,t.zones))}}function ri(n,l){if(1&n&&(e.j41(0,"div",6)(1,"app-icon",16),e.EFF(2,"hide_image"),e.k0s(),e.j41(3,"p",17),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.SpI(" ",t.search.getValue()?"No matching zones found":"No zones"," ")}}function ci(n,l){if(1&n){const t=e.RV6();e.j41(0,"signage-item-playlists",18),e.nI1(1,"async"),e.nI1(2,"async"),e.nI1(3,"async"),e.bIt("add",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.adding=!0)})("remove",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.removePlaylist(i))})("ondrop",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.drop(i))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("item",e.bMT(1,2,t.active_trigger)||e.bMT(2,4,t.active_zone))("name",e.bMT(3,6,t.active_trigger)?"trigger":"zone")}}function di(n,l){1&n&&(e.j41(0,"div",9)(1,"app-icon",16),e.EFF(2,"desktop_windows"),e.k0s(),e.j41(3,"p"),e.EFF(4,"Select a zone from the left to view playlists"),e.k0s()())}function pi(n,l){if(1&n){const t=e.RV6();e.j41(0,"search-overlay",19),e.nI1(1,"async"),e.bIt("selected",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.addPlaylist(i))})("close",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.adding=!1)}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("item_list",e.bMT(1,1,t.playlists))}}let ye=(()=>{class n extends g.Tv{constructor(t,a){super(),this._state=t,this._route=a,this.adding=!1,this.switching=!1,this.search=new F.t(""),this.loading=this._state.loading,this.zones=(0,v.zV)([this.search,this._state.zones]).pipe((0,y.T)(([i,s])=>s.filter(o=>o.name.toLowerCase().includes(i.toLowerCase())))),this.selected=new F.t(""),this.selected_trigger=new F.t(""),this.active_zone=(0,v.zV)([this.zones,this.selected]).pipe((0,y.T)(([i,s])=>i.find(o=>o.id===s))),this.triggers=this.selected.pipe((0,E.n)(i=>(0,m.cgk)(i)),(0,y.T)(i=>i.data),(0,me.M)(i=>setTimeout(()=>this.switching=!1,100)),(0,D.t)(1)),this.active_trigger=(0,v.zV)([this.triggers,this.selected_trigger]).pipe((0,y.T)(([i,s])=>i.find(o=>o.id===s))),this.playlists=(0,v.zV)([this.active_zone,this.active_trigger,this._state.playlists,this._state.has_changed]).pipe((0,y.T)(([i,s,o])=>o.filter(r=>!(s||i)?.playlists.find(c=>r.id===c))))}ngOnInit(){this.subscription("route.params",this._route.queryParamMap.subscribe(t=>{this.switching=t.get("zone")!==this.selected.getValue(),this.selected.next(t.get("zone")||""),this.selected_trigger.next(t.get("trigger")||"")}))}addPlaylist(t){var a=this;return(0,u.A)(function*(){console.log("Add Playlist:",t);const i=yield a.active_zone.pipe((0,j.s)(1)).toPromise(),s=yield a.active_trigger.pipe((0,j.s)(1)).toPromise(),o=s||i,r=[...o.playlists,t.id];yield(s?m.Yjp:m.G5B)(o.id,{playlists:r,version:i.version},"patch").toPromise(),(0,g.VX)("Successfully added playlist to the "+(s?"trigger":"zone")),a._state.changed(),a.adding=!1})()}removePlaylist(t){var a=this;return(0,u.A)(function*(){const i=yield a.active_zone.pipe((0,j.s)(1)).toPromise(),s=yield a.active_trigger.pipe((0,j.s)(1)).toPromise(),o=s||i,r=o.filter(_=>t.id!==_);yield(s?m.Yjp:m.G5B)(o.id,{playlists:r,version:i.version},"patch").toPromise(),(0,g.VX)("Successfully removed playlist from "+(s?"trigger":"zone")),a._state.changed(),a.adding=!1})()}drop(t){var a=this;return(0,u.A)(function*(){const i=yield a.active_zone.pipe((0,j.s)(1)).toPromise(),s=yield a.active_trigger.pipe((0,j.s)(1)).toPromise(),o=s||i,r=o.playlists,c=[...r];(0,b.HD)(c,t.previousIndex,t.currentIndex),o.playlists=c,a._state.changed(),yield(s?m.Yjp:m.G5B)(o.id,{playlists:c,version:i.version},"patch").toPromise().catch(f=>{throw o.playlists=r,a._state.changed(),f}),(0,g.VX)("Successfully re-ordered playlists on "+(s?"trigger":"zone")),a._state.changed()})()}static#e=this.\u0275fac=function(a){return new(a||n)(e.rXU(w),e.rXU(x.nX))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["signage-zones"]],features:[e.Vt3],decls:14,vars:8,consts:[[1,"relative","h-full","w-full","overflow-visible","flex","space-x-4"],["sidebar","",1,"w-64","h-full","flex","flex-col","space-y-4","py-4"],[1,"text-xl","font-medium","text-center"],["appearance","outline",1,"w-full","no-subscript"],["matInput","","placeholder","Search...",3,"ngModelChange","ngModel"],[1,"h-1/2","flex-1","w-full","overflow-auto","space-y-2"],[1,"flex","flex-col","items-center","justify-center","p-8","space-y-2","opacity-30"],[1,"relative","flex","flex-col","flex-1","w-1/2","h-full","overflow-auto","rounded-lg","border","border-base-300","p-4","shadow","space-y-4"],[1,"flex","flex-col","flex-1",3,"item","name"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2","opacity-30"],[3,"item_list","selected","close",4,"ngIf"],["matRipple","",1,"w-full","px-6","rounded-3xl","min-h-12","flex","items-center","hover:bg-base-200","truncate","z-10",3,"routerLink","queryParams"],[1,"relative","flex","items-center","space-x-2","z-0"],[1,"w-6"],[1,"absolute","h-16","w-4","border-b-2","border-l-2","border-base-300","top-1/2","left-6","-translate-y-full"],["matRipple","",1,"w-full","px-6","rounded-3xl","min-h-12","flex","items-center","hover:bg-base-200","truncate",3,"routerLink","queryParams"],[1,"text-6xl"],[1,"text-center"],[1,"flex","flex-col","flex-1",3,"add","remove","ondrop","item","name"],[3,"selected","close","item_list"]],template:function(a,i){if(1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"h3",2),e.EFF(3,"Zones"),e.k0s(),e.j41(4,"mat-form-field",3)(5,"input",4),e.bIt("ngModelChange",function(o){return i.search.next(o)}),e.k0s()(),e.DNE(6,li,4,2,"div",5),e.nI1(7,"async"),e.DNE(8,ri,5,1,"div",6),e.k0s(),e.j41(9,"div",7),e.DNE(10,ci,4,8,"signage-item-playlists",8),e.nI1(11,"async"),e.DNE(12,di,5,0,"div",9)(13,pi,2,3,"search-overlay",10),e.k0s()()),2&a){let s;e.R7$(5),e.Y8G("ngModel",i.search.getValue()),e.R7$(),e.vxM((null==(s=e.bMT(7,4,i.zones))?null:s.length)>0?6:8),e.R7$(4),e.vxM(e.bMT(11,6,i.active_zone)?10:12),e.R7$(3),e.Y8G("ngIf",i.adding)}},dependencies:[h.bT,p.me,p.BC,p.vS,S.rl,P.fg,k.r6,T.R,x.Wk,Z,H,h.Jj]})}return n})();const mi=[{path:"",component:se,children:[{path:"",redirectTo:"media",pathMatch:"full"},{path:"media",component:pe},{path:"displays",component:ge},{path:"zones",component:ye},{path:"*",redirectTo:"media",pathMatch:"full"}]}],_i=[se,We,pe,ae,A,ne,le,ce,ge,ye,Z,H];let ui=(()=>{class n{static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[h.MD,p.YN,be.r,kt.hI,x.iI.forChild(mi),U.RI,b.ad]})}return n})()}}]);
//# sourceMappingURL=apps_concierge_src_app_signage_signage_module_ts.js.map