"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_signage_signage_module_ts"],{4462:(fe,y,s)=>{s.r(y),s.d(y,{COMPONENTS:()=>pe,SignageModule:()=>ge});var g=s(6575),L=s(8849),d=s(2649),j=s(7910),T=s(1670),F=s(5985),r=s(7109),Z=s(3121),w=s(7298),h=s(462),I=s(8159),z=s(9681),Y=s(5046),J=s(6520),N=s(8175),R=s(7422),D=s(680),Q=s(6939),E=s(4727),$=s(8257),v=s(7401),e=s(9039),S=s(257),C=s(4888);function W(i,c){if(1&i&&e._UZ(0,"img",8),2&i){const t=e.oxw();e.Q6J("src",t.resource.toString(),e.LSH)}}function k(i,c){if(1&i&&e._UZ(0,"video",9),2&i){const t=e.oxw();e.Q6J("src",t.resource.toString(),e.LSH)}}function X(i,c){1&i&&(e.TgZ(0,"footer",10)(1,"button",11),e._uU(2,"Save Media"),e.qZA()())}let _=(()=>{class i{constructor(t){this._data=t,this.resource=this._data.url,this.type=this._data.type,this.name=this._data.name,this.can_save=!1!==this._data.save}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(v.WI))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["signage-media-preview-modal"]],decls:11,vars:4,consts:[[1,"flex","items-center","justify-between","p-2","border-b","border-base-300"],[1,"px-2"],["icon","","matRipple","","mat-dialog-close",""],[1,"bg-base-200"],[1,"max-w-[80vw]","max-h-[65vh]","w-[80vw]","h-[65vh]","flex","items-center","justify-center"],["class","max-w-full max-h-full",3,"src",4,"ngIf"],["class","max-w-full max-h-full","autoplay","","controls","",3,"src",4,"ngIf"],["class","p-2 flex items-center justify-end space-x-2 border-t border-base-300",4,"ngIf"],[1,"max-w-full","max-h-full",3,"src"],["autoplay","","controls","",1,"max-w-full","max-h-full",3,"src"],[1,"p-2","flex","items-center","justify-end","space-x-2","border-t","border-base-300"],["btn","","matRipple","",1,"w-32"]],template:function(n,a){1&n&&(e.TgZ(0,"header",0)(1,"h1",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.TgZ(6,"main",3)(7,"div",4),e.YNc(8,W,1,1,"img",5)(9,k,1,1,"video",6),e.qZA()(),e.YNc(10,X,3,0,"footer",7)),2&n&&(e.xp6(2),e.hij("Preview - ",a.name,""),e.xp6(6),e.Q6J("ngIf","image"===a.type),e.xp6(1),e.Q6J("ngIf","video"===a.type),e.xp6(1),e.Q6J("ngIf",a.can_save))},dependencies:[g.O5,v.ZT,S.wG,C.o]})}return i})(),p=(()=>{class i{constructor(t,n){this._org=t,this._dialog=n,this._loading=new h.X(!1),this._change=new h.X(0),this._active_upload=new h.X(null),this.loading=this._loading.asObservable(),this.media=(0,I.aj)([this._org.active_building,this._change]).pipe((0,Y.h)(([a])=>!!a?.id),(0,J.w)(([a])=>(0,w.rlq)(a.id,"signage-media").pipe((0,N.K)(()=>(0,z.of)({})))),(0,R.U)(a=>(a.details instanceof Array?a.details:null)||[{id:`media-${(0,r.O1)(8)}`,name:"Welcome to PlaceOS",description:"This is a sample media file",url:"https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png",type:"image",duration:15},{id:`media-${(0,r.O1)(8)}`,name:"Welcome to PlaceOS",description:"This is a sample media file",url:"https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png",type:"image",duration:30},{id:`media-${(0,r.O1)(8)}`,name:"Welcome to PlaceOS",description:"This is a sample media file",url:"https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png",type:"image",duration:60},{id:`media-${(0,r.O1)(8)}`,name:"Welcome to PlaceOS",description:"This is a sample media file",url:"https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png",type:"image",duration:15},{id:`media-${(0,r.O1)(8)}`,name:"Welcome to PlaceOS",description:"This is a sample media file",url:"https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png",type:"image",duration:30},{id:`media-${(0,r.O1)(8)}`,name:"Welcome to PlaceOS",description:"This is a sample media file",url:"https://assets-global.website-files.com/6171e55cb416782d0a8e7a4c/6171e8d5fe3ffc10c0c800bc_PlaceOS-Logo-Dark-Alt.png",type:"image",duration:60}]),(0,D.d)(1))}previewMedia(t){const{url:n,type:a,name:o}=t;this._dialog.open(_,{data:{url:n,type:a,name:o,save:!1}}).afterClosed().subscribe(()=>URL.revokeObjectURL(n))}previewFileMedia(t){const n=URL.createObjectURL(t),a=t.type.includes("image")?"image":"video";this._dialog.open(_,{data:{url:n,type:a,name:t.name,save:!0}}).afterClosed().subscribe(()=>URL.revokeObjectURL(n))}addMedia(t){var n=this;return(0,T.Z)(function*(){const a=yield n._uploadFile(t),o=yield n.media.pipe((0,Q.q)(1)).toPromise();o.push({id:`media-${(0,r.O1)(8)}`,name:a.name,description:"",url:a.url,type:t.type.includes("image")?"image":"video",duration:15});const l=n._org.building.id;yield(0,w.Ymr)(l,{name:"signage-media",details:o,description:"Media for signage displays"}).toPromise(),(0,r.t5)("Successfully added media."),n._active_upload.next(null),n._change.next(Date.now())})()}_uploadFile(t){return new Promise((n,a)=>{const o=new FileReader;o.addEventListener("loadend",l=>{const ue=$.PP(l.target.result,t.type),b=(0,F.IL)([ue],{file_name:t.name})[0],m={id:`${(0,r.Iy)(999999999999)}`,name:t.name,progress:0,size:t.size,created_at:Date.now(),url:""};b.status.pipe((0,E.o)(f=>"complete"!==f.status,!0)).subscribe(f=>{b.access_url&&(m.url=b.access_url),m.progress=f.progress,"error"===f.status&&(m.progress=-1,a())},a,()=>n(m)),this._active_upload.next(m)}),o.readAsArrayBuffer(t)})}static#e=this.\u0275fac=function(n){return new(n||i)(e.LFG(Z.w7),e.LFG(v.uw))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var B=s(3005),G=s(9842),u=s(989);const H=["app-new-staff",""];function K(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(){const o=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.active_link=o)}),e.ALo(1,"lowercase"),e._uU(2),e.qZA()}if(2&i){const t=c.$implicit,n=e.oxw();e.Q6J("routerLink","/signage/"+e.lcZ(1,3,t))("active",n.active_link==t),e.xp6(2),e.hij(" ",t," ")}}let M=(()=>{class i extends r.cx{constructor(t,n){super(),this._state=t,this._router=n,this.loading=this._state.loading,this.links=["Playlists","Media","Displays","Zones","Triggers"],this.active_link=this.links[0]}ngOnInit(){this.subscription("route.query",this._router.events.subscribe(t=>{t instanceof d.m2&&(this.active_link=this.links.find(n=>this._router.url.includes(n.toLowerCase())))})),this.active_link=this.links.find(t=>this._router.url.includes(t.toLowerCase()))}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(p),e.Y36(d.F0))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["","app-new-staff",""]],features:[e.qOj],attrs:H,decls:13,vars:2,consts:[[1,"flex","flex-1","h-px"],[1,"flex","flex-col","flex-1","w-1/2","h-full"],[1,"p-8"],[1,"text-2xl","font-medium"],["mat-tab-nav-bar","",3,"tabPanel"],[1,"flex-1","h-1/2","overflow-auto"],["tabPanel",""],["mat-tab-link","",3,"routerLink","active","click"],["mat-tab-link","",3,"routerLink","active"]],template:function(n,a){if(1&n&&(e._UZ(0,"app-topbar"),e.TgZ(1,"div",0),e._UZ(2,"app-sidebar"),e.TgZ(3,"main",1)(4,"div",2)(5,"h2",3),e._uU(6),e.qZA()(),e.TgZ(7,"nav",4),e.SjG(8,K,3,5,"a",8,e.x6l),e.qZA(),e.TgZ(10,"mat-tab-nav-panel",5,6),e._UZ(12,"router-outlet"),e.qZA()()()),2&n){const o=e.MAs(11);e.xp6(6),e.hij(" Signage - ",a.active_link," "),e.xp6(1),e.Q6J("tabPanel",o),e.wJu(8,a.links)}},dependencies:[B.O,G.u,d.lC,d.rH,u.BU,u.sW,u.Nj,g.i8],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}\n\n/*# sourceMappingURL=signage.component.ts-angular-inline--185.css.map*/"]})}return i})();var V=s(7627);let q=(()=>{class i extends r.cx{constructor(t,n,a,o){super(),this._state=t,this._org=n,this._route=a,this._router=o,this.zones=[],this.levels=this._org.active_levels}ngOnInit(){var t=this;return(0,T.Z)(function*(){yield t._org.initialised.pipe((0,V.P)(n=>n)).toPromise(),t.subscription("route.query",t._route.queryParamMap.subscribe(n=>{if(n.has("zone_ids")){const a=n.get("zone_ids").split(",");if(a.length){const o=t._org.levelWithID(a);if(!o)return;t._org.building=t._org.buildings.find(l=>l.id===o.parent_id),t.zones=a}}})),t.subscription("levels",t._org.active_levels.subscribe(n=>{t.zones=t.zones.filter(a=>n.find(o=>o.id===a)),!t.zones.length&&n.length&&t.zones.push(n[0].id)}))})()}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(p),e.Y36(Z.w7),e.Y36(d.gz),e.Y36(d.F0))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["signage-topbar"]],features:[e.qOj],decls:1,vars:0,consts:[[1,"flex","items-center","bg-base-100","h-20","px-4","border-b","border-base-200","space-x-2"]],template:function(n,a){1&n&&e._UZ(0,"div",0)},styles:["mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em}\n\n/*# sourceMappingURL=signage-topbar.component.ts-angular-inline--186.css.map*/"]})}return i})(),x=(()=>{class i{constructor(t){this._state=t,this.loading=this._state.loading}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(p))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["signage-playlists"]],decls:0,vars:0,template:function(n,a){}})}return i})(),O=(()=>{class i{constructor(t){this._state=t,this.loading=this._state.loading}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(p))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["signage-displays"]],decls:0,vars:0,template:function(n,a){}})}return i})(),A=(()=>{class i{constructor(t){this._state=t,this.loading=this._state.loading}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(p))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["signage-zones"]],decls:0,vars:0,template:function(n,a){}})}return i})(),U=(()=>{class i{constructor(t){this._state=t,this.loading=this._state.loading}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(p))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["signage-triggers"]],decls:0,vars:0,template:function(n,a){}})}return i})();var ee=s(3910),te=s(1537);function ie(i,c){if(1&i&&(e.TgZ(0,"div",18),e._UZ(1,"div",11),e.TgZ(2,"div",12),e._uU(3),e.ALo(4,"mediaDuration"),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",e.lcZ(4,1,t.duration)," ")}}function ne(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"button",8),e.NdJ("click",function(){const o=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.previewMedia(o))}),e._UZ(2,"img",9),e.TgZ(3,"div",10),e._UZ(4,"div",11),e.TgZ(5,"div",12),e._uU(6),e.qZA()(),e.TgZ(7,"div",13),e._UZ(8,"div",11),e.TgZ(9,"div",12),e._uU(10),e.qZA()(),e.YNc(11,ie,5,3,"div",14),e.qZA(),e.TgZ(12,"div",15)(13,"div",16),e._uU(14),e.qZA(),e.TgZ(15,"button",17)(16,"app-icon"),e._uU(17,"more_vert"),e.qZA()()()()}if(2&i){const t=c.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("src",t.url,e.LSH),e.xp6(4),e.hij(" ","image"===t.type?"Image":"Video"," "),e.xp6(4),e.hij(" ",n.count||0," Playlist(s) "),e.xp6(1),e.Q6J("ngIf",t.duration),e.xp6(3),e.hij(" ",t.name," ")}}function ae(i,c){if(1&i&&(e.ynx(0),e.TgZ(1,"div",5),e.YNc(2,ne,18,5,"div",6),e.ALo(3,"async"),e.qZA(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,1,t.media))}}function se(i,c){if(1&i&&(e.ynx(0),e.YNc(1,ae,4,3,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&i){const t=e.oxw(),n=e.MAs(5);let a;e.xp6(1),e.Q6J("ngIf",null==(a=e.lcZ(2,2,t.media))?null:a.length)("ngIfElse",n)}}function oe(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",19),e._UZ(1,"div",20)(2,"div",21),e.TgZ(3,"div",22)(4,"app-icon",23),e._uU(5,"upload"),e.qZA(),e.TgZ(6,"p"),e._uU(7,"Drop file to upload file"),e.qZA()(),e.TgZ(8,"input",24),e.NdJ("change",function(a){e.CHM(t);const o=e.oxw();return e.KtG(o.previewFile(a))}),e.qZA()()}}function le(i,c){1&i&&(e.TgZ(0,"div",25)(1,"app-icon",23),e._uU(2,"hide_image"),e.qZA(),e.TgZ(3,"p"),e._uU(4,"No media found."),e.qZA()())}function re(i,c){1&i&&(e.TgZ(0,"div",26),e._UZ(1,"mat-spinner",27),e.TgZ(2,"p"),e._uU(3,"Loading..."),e.qZA()())}let P=(()=>{class i extends r.cx{onEnter(t){this.show_dropzone=t?.dataTransfer?.types.includes("Files")}hideOverlay(t){t.target instanceof HTMLInputElement||t.preventDefault(),this.timeout("hide_overlay",()=>this.show_dropzone=!1)}constructor(t){super(),this._state=t,this.loading=this._state.loading,this.media=this._state.media,this.show_dropzone=!1,this.previewMedia=n=>this._state.previewMedia(n)}previewFile(t){const n=t.target;if(!n?.files?.length)return;const o=n.files[0];o&&(o.type.includes("image")||o.type.includes("video"))?this._state.previewFileMedia(o):(0,r.cB)("Invalid file type.")}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(p))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["signage-media"]],features:[e.qOj],decls:8,vars:5,consts:[[1,"relative","bg-base-200","min-h-full","w-full",3,"dragenter","drop"],[4,"ngIf","ngIfElse"],["class","absolute inset-0",4,"ngIf"],["empty_template",""],["load_template",""],[1,"flex","flex-wrap","items-start","justify-start","w-full","p-2"],["class","m-2 p-2 bg-base-100 rounded-lg overflow-hidden h-[13rem] border border-base-300 shadow",4,"ngFor","ngForOf"],[1,"m-2","p-2","bg-base-100","rounded-lg","overflow-hidden","h-[13rem]","border","border-base-300","shadow"],[1,"w-64","h-36","overflow-hidden","bg-base-200","rounded","m-0","p-0","relative",3,"click"],[1,"object-cover","w-full","h-full",3,"src"],[1,"absolute","top-2","left-2","flex","items-center","justify-center","rounded","overflow-hidden"],[1,"absolute","inset-0","bg-base-content","opacity-60","z-0"],[1,"relative","text-base-100","z-10","px-2","py-1","text-xs"],[1,"absolute","top-2","right-2","flex","items-center","justify-center","rounded","overflow-hidden"],["class","absolute bottom-2 right-2 flex items-center justify-center rounded overflow-hidden",4,"ngIf"],[1,"flex","items-center","justify-between","space-x-2"],[1,"truncate","flex-1","w-1/2","px-2"],["icon","","matRipple",""],[1,"absolute","bottom-2","right-2","flex","items-center","justify-center","rounded","overflow-hidden"],[1,"absolute","inset-0"],[1,"absolute","inset-0","bg-base-200"],[1,"absolute","inset-0","bg-base-content","opacity-70"],[1,"absolute","inset-4","border-4","border-dashed","border-neutral","text-base-100","rounded-xl","flex","flex-col","items-center","justify-center"],[1,"text-8xl"],["type","file",1,"absolute","inset-0","w-full","opacity-0",3,"change"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2","opacity-30"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"]],template:function(n,a){if(1&n&&(e.TgZ(0,"div",0),e.NdJ("dragenter",function(l){return a.onEnter(l)},!1,e.evT)("drop",function(l){return a.hideOverlay(l)},!1,e.evT),e.YNc(1,se,3,4,"ng-container",1),e.ALo(2,"async"),e.YNc(3,oe,9,0,"div",2),e.qZA(),e.YNc(4,le,5,0,"ng-template",null,3,e.W1O)(6,re,4,0,"ng-template",null,4,e.W1O)),2&n){const o=e.MAs(7);e.xp6(1),e.Q6J("ngIf",!e.lcZ(2,3,a.loading))("ngIfElse",o),e.xp6(2),e.Q6J("ngIf",a.show_dropzone)}},dependencies:[g.sg,g.O5,ee.Ou,S.wG,C.o,g.Ov,te.C],styles:["[_nghost-%COMP%]{min-height:100%}\n\n/*# sourceMappingURL=signage-media.component.ts-angular-inline--187.css.map*/"]})}return i})();var ce=s(1862);const de=[{path:"",component:M,children:[{path:"",component:x},{path:"playlists",component:x},{path:"media",component:P},{path:"displays",component:O},{path:"zones",component:A},{path:"triggers",component:U},{path:"*",redirectTo:"playlists",pathMatch:"full"}]}],pe=[M,q,x,P,O,A,U,_];let ge=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[g.ez,L.u5,j.v,ce.Kk,d.Bz.forChild(de),u.Nh]})}return i})()}}]);
//# sourceMappingURL=apps_concierge_src_app_signage_signage_module_ts.js.map