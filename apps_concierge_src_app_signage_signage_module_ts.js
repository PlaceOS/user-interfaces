"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_signage_signage_module_ts"],{7961:(xe,z,r)=>{r.r(z),r.d(z,{COMPONENTS:()=>je,SignageModule:()=>Fe});var u=r(60316),p=r(34456),w=r(26842),ot=r(40363),v=r(89204),g=r(82333),J=r(12185),M=r(3998),C=r(90521),f=r(42175),G=r(71536),V=r(8627),D=r(71963),$=r(29314),h=r(35443),lt=r(7841),O=r(33602);class L{constructor(o={}){this.id=o.id||"",this.name=o.name||"",this.description=o.description||"",this.media=o.media||[],this.media_durations=o.media_durations||{}}}class rt{constructor(o={}){this.id=o.id||"",this.name=o.name||"",this.description=o.description||"",this.orientation=o.orientation||"landscape",this.playlists=o.playlists||[]}}class ct{constructor(o={}){this.id=o.id||"",this.name=o.name||"",this.description=o.description||"",this.type=o.type||"image",this.duration=o.duration||15,this.orientation=o.orientation||"landscape",this.url=o.url||""}}var t=r(68559),y=r(12587),P=r(41134),j=r(85060),k=r(69434);function pt(a,o){if(1&a&&t.nrm(0,"img",10),2&a){const e=t.XpG(2);t.Y8G("src",e.resource.toString(),t.B4B)}}function mt(a,o){if(1&a&&t.nrm(0,"video",11),2&a){const e=t.XpG(2);t.Y8G("src",e.resource.toString(),t.B4B)}}function dt(a,o){if(1&a&&(t.j41(0,"main",6)(1,"div",7),t.DNE(2,pt,1,1,"img",8)(3,mt,1,1,"video",9),t.k0s()()),2&a){const e=t.XpG();t.R7$(2),t.Y8G("ngIf","image"===e.type),t.R7$(),t.Y8G("ngIf","video"===e.type)}}function ut(a,o){if(1&a){const e=t.RV6();t.j41(0,"footer",12)(1,"button",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.save.emit())}),t.EFF(2," Save Media "),t.k0s()()}}function gt(a,o){if(1&a&&(t.j41(0,"main",14),t.nrm(1,"mat-spinner",15),t.j41(2,"p"),t.EFF(3),t.k0s()()),2&a){const e=t.XpG();t.R7$(),t.Y8G("diameter",32),t.R7$(2),t.JRh(e.loading)}}let Y=(()=>{class a{constructor(e){this._data=e,this.save=new t.bkB,this.loading="",this.resource=this._data.url,this.type=this._data.type,this.name=this._data.name,this.file=this._data.file,this.can_save=!1!==this._data.save}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(y.Vh))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["signage-media-preview-modal"]],outputs:{save:"save"},decls:10,vars:4,consts:[["load_state",""],[1,"flex","items-center","justify-between","p-2","border-b","border-base-300"],[1,"px-2"],["icon","","matRipple","","mat-dialog-close",""],["class","bg-base-200",4,"ngIf","ngIfElse"],["class","p-2 flex items-center justify-end space-x-2 border-t border-base-300",4,"ngIf"],[1,"bg-base-200"],[1,"max-w-[80vw]","max-h-[65vh]","w-[80vw]","h-[65vh]","flex","items-center","justify-center"],["class","max-w-full max-h-full",3,"src",4,"ngIf"],["class","max-w-full max-h-full","autoplay","","controls","",3,"src",4,"ngIf"],[1,"max-w-full","max-h-full",3,"src"],["autoplay","","controls","",1,"max-w-full","max-h-full",3,"src"],[1,"p-2","flex","items-center","justify-end","space-x-2","border-t","border-base-300"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-8","w-[28rem]","h-[20rem]","max-w-[80vw]","max-h-[65vh]"],[3,"diameter"]],template:function(i,n){if(1&i&&(t.j41(0,"header",1)(1,"h1",2),t.EFF(2),t.k0s(),t.j41(3,"button",3)(4,"app-icon"),t.EFF(5,"close"),t.k0s()()(),t.DNE(6,dt,4,2,"main",4)(7,ut,3,0,"footer",5)(8,gt,4,2,"ng-template",null,0,t.C5r)),2&i){const s=t.sdS(9);t.R7$(2),t.SpI("Preview - ",n.name,""),t.R7$(4),t.Y8G("ngIf",!n.loading)("ngIfElse",s),t.R7$(),t.Y8G("ngIf",n.can_save&&!n.loading)}},dependencies:[u.bT,P.LG,y.tx,j.r6,k.R]})}return a})();var N=r(89273),R=r(24950),A=r(87984),Z=r(25175),S=r(31034),W=r(80640),X=r(12993),I=r(28975);const _t=["search_input"],ft=()=>["_index","name","type","duration","actions"],ht=()=>[" ","Name","Type","Duration"," "],yt=()=>["3r","flex","10r","6r","10r"],bt=(a,o)=>({duration:a,actions:o}),H=()=>({standalone:!0});function vt(a,o){1&a&&(t.j41(0,"button",11)(1,"app-icon"),t.EFF(2,"close"),t.k0s()())}function jt(a,o){if(1&a){const e=t.RV6();t.j41(0,"button",27),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.addMedia(n))}),t.j41(1,"div",28)(2,"div",29),t.EFF(3),t.k0s(),t.j41(4,"code",30),t.EFF(5),t.k0s(),t.j41(6,"code",31),t.EFF(7),t.nI1(8,"mediaDuration"),t.k0s()()()}if(2&a){const e=o.$implicit;t.R7$(3),t.JRh(e.name),t.R7$(2),t.JRh(e.type),t.R7$(2),t.JRh(t.bMT(8,3,e.duration))}}function Ft(a,o){if(1&a){const e=t.RV6();t.j41(0,"main",12)(1,"label",13),t.EFF(2,"Name"),t.j41(3,"span",14),t.EFF(4,"*"),t.k0s()(),t.j41(5,"mat-form-field",15),t.nrm(6,"input",16),t.j41(7,"mat-error"),t.EFF(8,"Name is required"),t.k0s()(),t.j41(9,"label",17),t.EFF(10,"Description"),t.k0s(),t.j41(11,"mat-form-field",15),t.nrm(12,"textarea",18),t.k0s(),t.j41(13,"label",19),t.EFF(14,"Media"),t.k0s(),t.nrm(15,"custom-table",20),t.j41(16,"button",21),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.focusSearchInput())}),t.EFF(17," Add Media "),t.k0s(),t.j41(18,"mat-menu",22,3)(20,"mat-form-field",23)(21,"app-icon",24),t.EFF(22," search "),t.k0s(),t.j41(23,"input",25,4),t.bIt("ngModelChange",function(n){t.eBV(e);const s=t.XpG();return t.Njj(s.search.next(n))}),t.k0s()(),t.DNE(25,jt,9,5,"button",26),t.nI1(26,"async"),t.nI1(27,"slice"),t.k0s()()}if(2&a){const e=t.sdS(19),i=t.XpG(),n=t.sdS(7),s=t.sdS(9);t.Y8G("formGroup",i.form),t.R7$(15),t.Y8G("dataSource",i.media_list)("columns",t.lJ4(16,ft))("display_column",t.lJ4(17,ht))("column_size",t.lJ4(18,yt))("template",t.l_i(19,bt,n,s)),t.R7$(),t.Y8G("matMenuTriggerFor",e),t.R7$(7),t.Y8G("ngModel",i.search.getValue())("ngModelOptions",t.lJ4(22,H)),t.R7$(2),t.Y8G("ngForOf",t.brH(27,12,t.bMT(26,10,i.new_media),0,8))}}function xt(a,o){if(1&a){const e=t.RV6();t.j41(0,"footer",32)(1,"button",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.savePlaylist())}),t.EFF(2," Save Playlist "),t.k0s()()}}function wt(a,o){if(1&a){const e=t.RV6();t.j41(0,"button",34)(1,"code"),t.EFF(2),t.nI1(3,"mediaDuration"),t.k0s()(),t.j41(4,"mat-menu",35,5)(6,"mat-form-field",23)(7,"mat-select",36),t.bIt("ngModelChange",function(n){const s=t.eBV(e).row,l=t.XpG();return t.Njj(l.setDuration(s.id,n))}),t.j41(8,"mat-option",37),t.EFF(9,"Use Media Default"),t.k0s(),t.j41(10,"mat-option",37),t.EFF(11,"5 seconds"),t.k0s(),t.j41(12,"mat-option",37),t.EFF(13,"10 seconds"),t.k0s(),t.j41(14,"mat-option",37),t.EFF(15,"15 seconds"),t.k0s(),t.j41(16,"mat-option",37),t.EFF(17,"30 seconds"),t.k0s(),t.j41(18,"mat-option",37),t.EFF(19,"45 seconds"),t.k0s(),t.j41(20,"mat-option",37),t.EFF(21,"1 minute"),t.k0s(),t.j41(22,"mat-option",37),t.EFF(23,"1 minute 15 seconds"),t.k0s(),t.j41(24,"mat-option",37),t.EFF(25,"1 minute 30 seconds"),t.k0s(),t.j41(26,"mat-option",37),t.EFF(27,"1 minute 45 seconds"),t.k0s(),t.j41(28,"mat-option",37),t.EFF(29,"2 minute"),t.k0s(),t.j41(30,"mat-option",37),t.EFF(31,"2 minute 15 seconds"),t.k0s(),t.j41(32,"mat-option",37),t.EFF(33,"2 minute 30 seconds"),t.k0s(),t.j41(34,"mat-option",37),t.EFF(35,"2 minute 45 seconds"),t.k0s(),t.j41(36,"mat-option",37),t.EFF(37,"3 minute"),t.k0s(),t.j41(38,"mat-option",37),t.EFF(39,"3 minute 15 seconds"),t.k0s(),t.j41(40,"mat-option",37),t.EFF(41,"3 minute 30 seconds"),t.k0s(),t.j41(42,"mat-option",37),t.EFF(43,"3 minute 45 seconds"),t.k0s(),t.j41(44,"mat-option",37),t.EFF(45,"4 minute"),t.k0s(),t.j41(46,"mat-option",37),t.EFF(47,"4 minute 15 seconds"),t.k0s(),t.j41(48,"mat-option",37),t.EFF(49,"4 minute 30 seconds"),t.k0s(),t.j41(50,"mat-option",37),t.EFF(51,"4 minute 45 seconds"),t.k0s(),t.j41(52,"mat-option",37),t.EFF(53,"5 minute"),t.k0s()()()()}if(2&a){const e=o.row,i=t.sdS(5),n=t.XpG();t.AVh("pointer-events-none","image"!==e.type),t.Y8G("matMenuTriggerFor",i),t.R7$(),t.AVh("bg-warning",n.form.value.media_durations[e.id])("text-warning-content",n.form.value.media_durations[e.id]),t.R7$(),t.SpI(" ",t.bMT(3,33,n.form.value.media_durations[e.id]||e.duration)," "),t.R7$(5),t.Y8G("ngModel",n.form.value.media_durations[e.id]||0)("ngModelOptions",t.lJ4(35,H)),t.R7$(),t.Y8G("value",0),t.R7$(2),t.Y8G("value",5),t.R7$(2),t.Y8G("value",10),t.R7$(2),t.Y8G("value",15),t.R7$(2),t.Y8G("value",30),t.R7$(2),t.Y8G("value",45),t.R7$(2),t.Y8G("value",60),t.R7$(2),t.Y8G("value",75),t.R7$(2),t.Y8G("value",90),t.R7$(2),t.Y8G("value",105),t.R7$(2),t.Y8G("value",120),t.R7$(2),t.Y8G("value",135),t.R7$(2),t.Y8G("value",150),t.R7$(2),t.Y8G("value",165),t.R7$(2),t.Y8G("value",180),t.R7$(2),t.Y8G("value",195),t.R7$(2),t.Y8G("value",210),t.R7$(2),t.Y8G("value",225),t.R7$(2),t.Y8G("value",240),t.R7$(2),t.Y8G("value",255),t.R7$(2),t.Y8G("value",270),t.R7$(2),t.Y8G("value",285),t.R7$(2),t.Y8G("value",300)}}function Mt(a,o){if(1&a){const e=t.RV6();t.j41(0,"div",38)(1,"button",39),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.changeOrder(n,-1))}),t.j41(2,"app-icon"),t.EFF(3,"arrow_upward"),t.k0s()(),t.j41(4,"button",40),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.changeOrder(n,1))}),t.j41(5,"app-icon"),t.EFF(6,"arrow_downward"),t.k0s()(),t.j41(7,"button",41),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.previewMedia(n))}),t.j41(8,"app-icon"),t.EFF(9,"visibility"),t.k0s()(),t.j41(10,"button",42),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.removeMedia(n))}),t.j41(11,"app-icon"),t.EFF(12,"delete"),t.k0s()()()}if(2&a){const e=o.first,i=o.last;t.R7$(),t.Y8G("disabled",e),t.R7$(3),t.Y8G("disabled",i)}}function kt(a,o){1&a&&(t.j41(0,"main",43),t.nrm(1,"mat-spinner",44),t.j41(2,"p",45),t.EFF(3,"Saving Playlist..."),t.k0s()()),2&a&&(t.R7$(),t.Y8G("diameter",32))}let Q=(()=>{class a{constructor(e={},i,n,s){this._data=e,this._state=i,this._dialog=n,this._dialog_ref=s,this.loading=!1,this.playlist=this._data,this.media=this._state.media,this.search=new C.t(""),this.form=new p.gE({id:new p.MJ(this.playlist.id||""),name:new p.MJ(this.playlist.name||"",[p.k0.required]),description:new p.MJ(this.playlist.description||""),media:new p.MJ(this.playlist.media||[]),media_durations:new p.MJ(this.playlist.media_durations||{})}),this.media_list=(0,f.zV)([this.media,this.form.valueChanges.pipe((0,N.Z)(this.form.getRawValue()))]).pipe((0,h.T)(([l,{}])=>(this.form.getRawValue().media||[]).map(m=>l.find(d=>d.id===m)||new ct({id:m})))),this.new_media=(0,f.zV)([this.media,this.search,this.form.valueChanges.pipe((0,N.Z)(this.form.getRawValue()))]).pipe((0,h.T)(([l,c,m])=>l.filter(d=>!this.form.getRawValue().media.includes(d.id)).filter(d=>d.name.toLowerCase().includes(c.toLowerCase()))))}indexOf(e){return this.form.getRawValue().media.indexOf(e)}focusSearchInput(){setTimeout(()=>this.search_input.nativeElement?.focus(),100)}savePlaylist(){var e=this;return(0,v.A)(function*(){e.form.markAllAsTouched(),e.form.updateValueAndValidity(),!e.form.invalid&&(e.loading=!0,yield e._state.savePlaylist(e.form.getRawValue()).catch(i=>{throw(0,g.UG)("Error saving playlist"),e.loading=!1,i}),e._dialog_ref.close())})()}setDuration(e,i){const{media_durations:n}=this.form.getRawValue(),s={...n};s[e]=i,this.form.patchValue({media_durations:s})}addMedia(e){const{id:i}=e,{media:n}=this.form.getRawValue();this.form.patchValue({media:[...n,i]})}removeMedia(e){const{media:i,media_durations:n}=this.form.getRawValue(),s=i.indexOf(e.id),l=[...i];delete n[e.id],l.splice(s,1),this.form.patchValue({media:l,media_durations:{...n}})}changeOrder(e,i){const{media:n}=this.form.getRawValue(),s=n.indexOf(e.id),l=[...n];l.splice(s,1),l.splice(s+i,0,e.id),this.form.patchValue({media:l})}previewMedia(e){const{url:i,type:n,name:s}=e;this._dialog.open(Y,{data:{url:i,type:n,name:s,save:!1}}).afterClosed().subscribe(()=>URL.revokeObjectURL(i))}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(y.Vh),t.rXU(F),t.rXU(y.bZ),t.rXU(y.CP))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["signage-playlist-modal"]],viewQuery:function(i,n){if(1&i&&t.GBs(_t,5),2&i){let s;t.mGM(s=t.lsd())&&(n.search_input=s.first)}},decls:12,vars:5,consts:[["duration_template",""],["actions_template",""],["load_state",""],["media_menu","matMenu"],["search_input",""],["duration_menu","matMenu"],[1,"flex","items-center","justify-between","p-2","border-b","border-base-300"],[1,"px-2"],["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-2 flex flex-col",3,"formGroup",4,"ngIf","ngIfElse"],["class","p-2 flex items-center justify-end space-x-2 border-t border-base-300",4,"ngIf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-2","flex","flex-col",3,"formGroup"],["for","name"],["required",""],["appearance","outline",1,"w-full"],["matInput","","name","name","placeholder","Name","formControlName","name"],["for","description"],["matInput","","name","description","placeholder","Description","formControlName","description"],["for","media"],[1,"block","w-full","mb-2",3,"dataSource","columns","display_column","column_size","template"],["btn","","matRipple","",1,"w-full",3,"click","matMenuTriggerFor"],[1,"w-[32rem]","max-w-[80vw]"],["appearance","outline",1,"w-[calc(100%-1rem)]","mx-2","no-subscript"],["matPrefix","",1,"text-2xl","-left-1"],["matInput","","placeholder","Media Name",3,"ngModelChange","ngModel","ngModelOptions"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],[1,"flex","items-center","w-full"],[1,"flex-1","truncate"],[1,"capitalize"],[1,"bg-base-300","text-base-content"],[1,"p-2","flex","items-center","justify-end","space-x-2","border-t","border-base-300"],["btn","","matRipple","",1,"w-32",3,"click"],["matTooltip","Set Custom Duration",3,"matMenuTriggerFor"],[1,"w-[20rem]","max-w-[80vw]"],[3,"ngModelChange","ngModel","ngModelOptions"],[3,"value"],[1,"w-full","flex","items-center","justify-end"],["icon","","matRipple","","matTooltip","Move Media to previous item",3,"click","disabled"],["icon","","matRipple","","matTooltip","Move Media to next item",3,"click","disabled"],["icon","","matRipple","","matTooltip","Preview Media",3,"click"],["icon","","matRipple","","matTooltip","Remove Media from Playlist",1,"text-error",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-8"],[3,"diameter"],[1,"mt-4"]],template:function(i,n){if(1&i&&(t.j41(0,"header",6)(1,"h1",7),t.EFF(2),t.k0s(),t.DNE(3,vt,3,0,"button",8),t.k0s(),t.DNE(4,Ft,28,23,"main",9)(5,xt,3,0,"footer",10)(6,wt,54,36,"ng-template",null,0,t.C5r)(8,Mt,13,2,"ng-template",null,1,t.C5r)(10,kt,4,1,"ng-template",null,2,t.C5r)),2&i){const s=t.sdS(11);t.R7$(2),t.SpI("",n.playlist.id?"Edit":"New"," Playlist"),t.R7$(),t.Y8G("ngIf",!n.loading),t.R7$(),t.Y8G("ngIf",!n.loading)("ngIfElse",s),t.R7$(),t.Y8G("ngIf",!n.loading)}},dependencies:[u.Sq,u.bT,p.me,p.BC,p.cb,p.vS,R.rl,R.TL,R.JW,A.fg,Z.VO,j.wT,S.kk,S.fb,S.Cp,W.oV,P.LG,y.tx,j.r6,p.j4,p.JD,k.R,X.r,u.Jj,u.P9,I.X]})}return a})();var Rt=r(66e3);const St=["search_input"],Tt=()=>["_index","name","type","duration","actions"],Ct=()=>[" ","Name","Type","Duration"," "],It=()=>["3r","flex","10r","6r","10r"],Et=(a,o)=>({duration:a,actions:o}),Gt=()=>({standalone:!0});function Vt(a,o){1&a&&(t.j41(0,"button",10)(1,"app-icon"),t.EFF(2,"close"),t.k0s()())}function Dt(a,o){if(1&a){const e=t.RV6();t.j41(0,"button",29),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.addPlaylist(n))}),t.j41(1,"div",30)(2,"div",31),t.EFF(3),t.k0s(),t.j41(4,"code",32),t.EFF(5),t.nI1(6,"mediaDuration"),t.k0s()()()}if(2&a){const e=o.$implicit;t.R7$(3),t.JRh(e.name),t.R7$(2),t.JRh(t.bMT(6,2,e.duration))}}function $t(a,o){if(1&a){const e=t.RV6();t.j41(0,"main",11)(1,"label",12),t.EFF(2,"Name"),t.j41(3,"span",13),t.EFF(4,"*"),t.k0s()(),t.j41(5,"mat-form-field",14),t.nrm(6,"input",15),t.j41(7,"mat-error"),t.EFF(8,"Name is required"),t.k0s()(),t.j41(9,"label",16),t.EFF(10,"Description"),t.k0s(),t.j41(11,"mat-form-field",14),t.nrm(12,"textarea",17),t.k0s(),t.j41(13,"label",16),t.EFF(14,"Orientation"),t.j41(15,"span",13),t.EFF(16,"*"),t.k0s()(),t.j41(17,"mat-form-field",14)(18,"mat-select",18)(19,"mat-option",19),t.EFF(20,"Landscape"),t.k0s(),t.j41(21,"mat-option",20),t.EFF(22,"Portrait"),t.k0s()(),t.j41(23,"mat-error"),t.EFF(24,"Orientation is required"),t.k0s()(),t.j41(25,"label",21),t.EFF(26,"Playlists"),t.k0s(),t.nrm(27,"custom-table",22),t.j41(28,"button",23),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.focusSearchInput())}),t.EFF(29," Add Playlist "),t.k0s(),t.j41(30,"mat-menu",24,3)(32,"mat-form-field",25)(33,"app-icon",26),t.EFF(34," search "),t.k0s(),t.j41(35,"input",27,4),t.bIt("ngModelChange",function(n){t.eBV(e);const s=t.XpG();return t.Njj(s.search.next(n))}),t.k0s()(),t.DNE(37,Dt,7,4,"button",28),t.nI1(38,"async"),t.nI1(39,"slice"),t.k0s()()}if(2&a){const e=t.sdS(31),i=t.XpG(),n=t.sdS(7),s=t.sdS(9);t.Y8G("formGroup",i.form),t.R7$(27),t.Y8G("dataSource",i.playlist_list)("columns",t.lJ4(16,Tt))("display_column",t.lJ4(17,Ct))("column_size",t.lJ4(18,It))("template",t.l_i(19,Et,s,n)),t.R7$(),t.Y8G("matMenuTriggerFor",e),t.R7$(7),t.Y8G("ngModel",i.search.getValue())("ngModelOptions",t.lJ4(22,Gt)),t.R7$(2),t.Y8G("ngForOf",t.brH(39,12,t.bMT(38,10,i.new_playlists),0,8))}}function Pt(a,o){if(1&a){const e=t.RV6();t.j41(0,"footer",33)(1,"button",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.saveDisplay())}),t.EFF(2," Save Display "),t.k0s()()}}function Yt(a,o){if(1&a){const e=t.RV6();t.j41(0,"div",35)(1,"button",36),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.changeOrder(n,-1))}),t.j41(2,"app-icon"),t.EFF(3,"arrow_upward"),t.k0s()(),t.j41(4,"button",37),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.changeOrder(n,1))}),t.j41(5,"app-icon"),t.EFF(6,"arrow_downward"),t.k0s()(),t.j41(7,"button",38),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.previewPlaylist(n))}),t.j41(8,"app-icon"),t.EFF(9,"visibility"),t.k0s()(),t.j41(10,"button",39),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.removePlaylist(n))}),t.j41(11,"app-icon"),t.EFF(12,"delete"),t.k0s()()()}if(2&a){const e=o.first,i=o.last;t.R7$(),t.Y8G("disabled",e),t.R7$(3),t.Y8G("disabled",i)}}function Nt(a,o){if(1&a&&(t.j41(0,"code",32),t.EFF(1),t.nI1(2,"mediaDuration"),t.k0s()),2&a){const e=o.data;t.R7$(),t.SpI(" ",t.bMT(2,1,e)," ")}}function Xt(a,o){1&a&&(t.j41(0,"main",40),t.nrm(1,"mat-spinner",41),t.j41(2,"p",42),t.EFF(3,"Saving Display..."),t.k0s()()),2&a&&(t.R7$(),t.Y8G("diameter",32))}let K=(()=>{class a{constructor(e={},i,n,s){this._data=e,this._state=i,this._dialog=n,this._dialog_ref=s,this.loading=!1,this.display=this._data,this.playlists=(0,f.zV)([this._state.playlists,this._state.media]).pipe((0,h.T)(([l,c])=>l.map(m=>({...m,duration:m.media.reduce((d,x)=>d+(m.media_durations[x]||c.find(({id:b})=>b===x)?.duration||0),0)}))),(0,Rt.M)(console.log)),this.search=new C.t(""),this.form=new p.gE({id:new p.MJ(this.display.id||""),name:new p.MJ(this.display.name||"",[p.k0.required]),description:new p.MJ(this.display.description||""),orientation:new p.MJ(this.display.orientation||"landscape",[p.k0.required]),playlists:new p.MJ(this.display.playlists||[])}),this.playlist_list=(0,f.zV)([this.playlists,this.form.valueChanges.pipe((0,N.Z)(this.form.getRawValue()))]).pipe((0,h.T)(([l,c])=>(this.form.getRawValue().playlists||[]).map(m=>l.find(d=>d.id===m)||new L({id:m})))),this.new_playlists=(0,f.zV)([this.playlists,this.search,this.form.valueChanges.pipe((0,N.Z)(this.form.getRawValue()))]).pipe((0,h.T)(([l,c,m])=>l.filter(d=>!this.form.getRawValue().playlists.includes(d.id)).filter(d=>d.name.toLowerCase().includes(c.toLowerCase()))))}focusSearchInput(){setTimeout(()=>this.search_input.nativeElement?.focus(),100)}saveDisplay(){var e=this;return(0,v.A)(function*(){e.form.markAllAsTouched(),e.form.updateValueAndValidity(),!e.form.invalid&&(e.loading=!0,yield e._state.saveDisplay(e.form.getRawValue()).catch(i=>{throw(0,g.UG)("Error saving display."),e.loading=!1,i}),e._dialog_ref.close())})()}addPlaylist(e){const{id:i}=e,{playlists:n}=this.form.getRawValue();this.form.patchValue({playlists:[...n,i]})}removePlaylist(e){const{playlists:i}=this.form.getRawValue(),n=i.indexOf(e.id),s=[...i];s.splice(n,1),this.form.patchValue({playlists:s})}changeOrder(e,i){const{playlists:n}=this.form.getRawValue(),s=n.indexOf(e.id),l=[...n];l.splice(s,1),l.splice(s+i,0,e.id),this.form.patchValue({playlists:l})}previewPlaylist(e){}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(y.Vh),t.rXU(F),t.rXU(y.bZ),t.rXU(y.CP))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["signage-display-modal"]],viewQuery:function(i,n){if(1&i&&t.GBs(St,5),2&i){let s;t.mGM(s=t.lsd())&&(n.search_input=s.first)}},decls:12,vars:5,consts:[["actions_template",""],["duration_template",""],["load_state",""],["media_menu","matMenu"],["search_input",""],[1,"flex","items-center","justify-between","p-2","border-b","border-base-300"],[1,"px-2"],["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","p-2 flex flex-col",3,"formGroup",4,"ngIf","ngIfElse"],["class","p-2 flex items-center justify-end space-x-2 border-t border-base-300",4,"ngIf"],["icon","","matRipple","","mat-dialog-close",""],[1,"p-2","flex","flex-col",3,"formGroup"],["for","name"],["required",""],["appearance","outline",1,"w-full"],["matInput","","name","name","placeholder","Name","formControlName","name"],["for","description"],["matInput","","name","description","placeholder","Description","formControlName","description"],["formControlName","orientation"],["value","landscape"],["value","portrait"],["for","media"],[1,"block","w-full","mb-2",3,"dataSource","columns","display_column","column_size","template"],["btn","","matRipple","",1,"w-full",3,"click","matMenuTriggerFor"],[1,"w-[32rem]","max-w-[80vw]"],["appearance","outline",1,"w-[calc(100%-1rem)]","mx-2","no-subscript"],["matPrefix","",1,"text-2xl","-left-1"],["matInput","","placeholder","Media Name",3,"ngModelChange","ngModel","ngModelOptions"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],[1,"flex","items-center","w-full"],[1,"flex-1","truncate"],[1,"bg-base-300","text-base-content"],[1,"p-2","flex","items-center","justify-end","space-x-2","border-t","border-base-300"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"w-full","flex","items-center","justify-end"],["icon","","matRipple","","matTooltip","Move Playlist to previous item",3,"click","disabled"],["icon","","matRipple","","matTooltip","Move Playlist to next item",3,"click","disabled"],["icon","","matRipple","","matTooltip","Preview Playlist",3,"click"],["icon","","matRipple","","matTooltip","Remove Playlist from Display",1,"text-error",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-8"],[3,"diameter"],[1,"mt-4"]],template:function(i,n){if(1&i&&(t.j41(0,"header",5)(1,"h1",6),t.EFF(2),t.k0s(),t.DNE(3,Vt,3,0,"button",7),t.k0s(),t.DNE(4,$t,40,23,"main",8)(5,Pt,3,0,"footer",9)(6,Yt,13,2,"ng-template",null,0,t.C5r)(8,Nt,3,3,"ng-template",null,1,t.C5r)(10,Xt,4,1,"ng-template",null,2,t.C5r)),2&i){const s=t.sdS(11);t.R7$(2),t.SpI("",n.display.id?"Edit":"New"," Display"),t.R7$(),t.Y8G("ngIf",!n.loading),t.R7$(),t.Y8G("ngIf",!n.loading)("ngIfElse",s),t.R7$(),t.Y8G("ngIf",!n.loading)}},dependencies:[u.Sq,u.bT,p.me,p.BC,p.cb,p.vS,R.rl,R.TL,R.JW,A.fg,Z.VO,j.wT,S.kk,S.fb,S.Cp,W.oV,P.LG,y.tx,j.r6,p.j4,p.JD,k.R,X.r,u.Jj,u.P9,I.X]})}return a})(),F=(()=>{class a{constructor(e,i){this._org=e,this._dialog=i,this._loading=new C.t(!1),this._change=new C.t(0),this._active_upload=new C.t(null),this.loading=this._loading.asObservable(),this.media=(0,f.zV)([this._org.active_building,this._change]).pipe((0,V.p)(([n])=>!!n?.id),(0,D.n)(([n])=>(0,M.bpY)(n.id,"signage-media").pipe((0,$.W)(()=>(0,G.of)({})))),(0,h.T)(n=>(n.details instanceof Array?n.details:null)||[]),(0,lt.t)(1)),this.playlists=(0,f.zV)([this._org.active_building,this._change]).pipe((0,V.p)(([n])=>!!n?.id),(0,D.n)(([n])=>(0,M.bpY)(n.id,"signage-playlists").pipe((0,$.W)(()=>(0,G.of)({})))),(0,h.T)(n=>n.details instanceof Array?n.details:[])),this.displays=(0,f.zV)([this._org.active_building,this._change]).pipe((0,V.p)(([n])=>!!n?.id),(0,D.n)(([n])=>(0,M.bpY)(n.id,"signage-displays").pipe((0,$.W)(()=>(0,G.of)({})))),(0,h.T)(n=>n.details instanceof Array?n.details:[])),this.zones=(0,f.zV)([this._org.active_building,this._change]).pipe((0,V.p)(([n])=>!!n?.id),(0,D.n)(([n])=>(0,M.smM)({parent_id:n.id,tags:"signage",limit:100}).pipe((0,$.W)(()=>(0,G.of)({data:[]})))),(0,h.T)(n=>n.data||[]))}editPlaylist(e=new L){this._dialog.open(Q,{data:e}).afterClosed().subscribe(()=>this._change.next(Date.now()))}savePlaylist(e,i=!1){var n=this;return(0,v.A)(function*(){const s=n._org.building.id,l=(yield n.playlists.pipe((0,O.s)(1)).toPromise())||[],c=l.findIndex(m=>m.id===e.id);c>=0&&l.splice(c,1),e.id||(e.id=`playlist-${(0,g.DU)(8)}`),i||l.push(e),yield(0,M.D58)(s,{name:"signage-playlists",details:l,description:"Playlists for signage displays"}).toPromise(),(0,g.VX)(`Successfully ${i?"removed":"saved"} playlist.`),n._change.next(Date.now())})()}removePlaylist(e){var i=this;return(0,v.A)(function*(){yield i.savePlaylist(e,!0)})()}editDisplay(e=new rt){this._dialog.open(K,{data:e}).afterClosed().subscribe(()=>this._change.next(Date.now()))}saveDisplay(e,i=!1){var n=this;return(0,v.A)(function*(){const s=n._org.building.id,l=yield n.displays.pipe((0,O.s)(1)).toPromise(),c=l.findIndex(m=>m.id===e.id);c>=0&&l.splice(c,1),e.id||(e.id=`display-${(0,g.DU)(8)}`),i||l.push(e),yield(0,M.D58)(s,{name:"signage-displays",details:l,description:"Displays for signage displays"}).toPromise(),(0,g.VX)(`Successfully ${i?"removed":"saved"} display.`),n._change.next(Date.now())})()}removeDisplay(e){var i=this;return(0,v.A)(function*(){yield i.saveDisplay(e,!0)})()}previewMedia(e){const{url:i,type:n,name:s}=e;this._dialog.open(Y,{data:{url:i,type:n,name:s,save:!1}}).afterClosed().subscribe(()=>URL.revokeObjectURL(i))}previewFileMedia(e){var i=this;const n=URL.createObjectURL(e),s=e.type.includes("image")?"image":"video",l=this._dialog.open(Y,{data:{url:n,type:s,name:e.name,save:!0,file:e}});l.afterClosed().subscribe(()=>URL.revokeObjectURL(n)),l.componentInstance.save.subscribe((0,v.A)(function*(){l.componentInstance.loading="Saving...",yield i.addMedia(e).catch(c=>{throw(0,g.UG)("Error saving media."),l.componentInstance.loading="",c}),l.close()}))}addMedia(e){var i=this;return(0,v.A)(function*(){const s=yield new Promise((b,T)=>{let _=null,U=!1;(0,g.QM)(e).subscribe(E=>{_=E,E.link&&(U=!0,b(E.link))},T,()=>U?null:b(_))}),l=yield i.media.pipe((0,O.s)(1)).toPromise(),c=new Promise(b=>{const T=URL.createObjectURL(e);if(e.type.includes("video")){let _=document.createElement("video");_.src=T.toString(),_.addEventListener("loadedmetadata",()=>{const{videoWidth:U,videoHeight:E}=_;b([U>E,d])}),_.load()}else{let _=new Image;_.onload=()=>b([_.width>_.height,0]),_.src=T.toString()}}),[m,d]=yield c;l.push({id:`media-${(0,g.DU)(8)}`,name:e.name,description:"",url:s,type:e.type.includes("image")?"image":"video",orientation:m?"landscape":"portrait",duration:d||15});const x=i._org.building.id;yield(0,M.D58)(x,{name:"signage-media",details:l,description:"Media for signage displays"}).toPromise(),i._active_upload.next(null),i._change.next(Date.now())})()}static#t=this.\u0275fac=function(i){return new(i||a)(t.KVO(J.yb),t.KVO(y.bZ))};static#e=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var Bt=r(45189),Ut=r(96843),B=r(38223);const Ot=["app-new-staff",""];function zt(a,o){if(1&a){const e=t.RV6();t.j41(0,"button",9),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.newItem(n.active_link))}),t.EFF(1),t.k0s()}if(2&a){const e=t.XpG();t.R7$(),t.SpI(" Add ",e.singular(e.active_link)," ")}}function Jt(a,o){if(1&a){const e=t.RV6();t.j41(0,"a",10),t.nI1(1,"lowercase"),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.active_link=n)}),t.EFF(2),t.k0s()}if(2&a){const e=o.$implicit,i=t.XpG();t.Y8G("routerLink","/signage/"+t.bMT(1,3,e))("active",i.active_link==e),t.R7$(2),t.SpI(" ",e," ")}}let q=(()=>{class a extends g.Tv{singular(e){return e.replace(/s$/,"")}newItem(e){switch(e){case"Playlists":this._state.editPlaylist();break;case"Displays":this._state.editDisplay()}}constructor(e,i){super(),this._state=e,this._router=i,this.loading=this._state.loading,this.links=["Playlists","Media","Displays","Zones","Triggers"],this.active_link=this.links[0]}ngOnInit(){this.subscription("route.query",this._router.events.subscribe(e=>{e instanceof w.wF&&(this.active_link=this.links.find(i=>this._router.url.includes(i.toLowerCase())))})),this.active_link=this.links.find(e=>this._router.url.includes(e.toLowerCase()))}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(F),t.rXU(w.Ix))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["","app-new-staff",""]],features:[t.Vt3],attrs:Ot,decls:14,vars:3,consts:[["tabPanel",""],[1,"flex","flex-1","h-px"],[1,"flex","flex-col","flex-1","w-1/2","h-full"],[1,"p-8","h-28","flex","items-center","justify-between"],[1,"text-2xl","font-medium"],["btn","","matRipple","","class","w-32",3,"click",4,"ngIf"],["mat-tab-nav-bar","",3,"tabPanel"],["mat-tab-link","",3,"routerLink","active"],[1,"flex-1","h-1/2","overflow-auto"],["btn","","matRipple","",1,"w-32",3,"click"],["mat-tab-link","",3,"click","routerLink","active"]],template:function(i,n){if(1&i&&(t.nrm(0,"app-topbar"),t.j41(1,"div",1),t.nrm(2,"app-sidebar"),t.j41(3,"main",2)(4,"div",3)(5,"h2",4),t.EFF(6),t.k0s(),t.DNE(7,zt,2,1,"button",5),t.k0s(),t.j41(8,"nav",6),t.Z7z(9,Jt,3,5,"a",7,t.fX1),t.k0s(),t.j41(11,"mat-tab-nav-panel",8,0),t.nrm(13,"router-outlet"),t.k0s()()()),2&i){const s=t.sdS(12);t.R7$(6),t.SpI(" Signage - ",n.active_link," "),t.R7$(),t.Y8G("ngIf","Media"!==n.active_link),t.R7$(),t.Y8G("tabPanel",s),t.R7$(),t.Dyx(n.links)}},dependencies:[u.bT,Bt.S,Ut.c,j.r6,w.n3,w.Wk,B.Bu,B.hQ,B.Ql,u.GH],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}\n\n/*# sourceMappingURL=signage.component.ts-angular-inline--189.css.map*/"]})}return a})();var Lt=r(57871);let At=(()=>{class a extends g.Tv{constructor(e,i,n,s){super(),this._state=e,this._org=i,this._route=n,this._router=s,this.zones=[],this.levels=this._org.active_levels}ngOnInit(){var e=this;return(0,v.A)(function*(){yield e._org.initialised.pipe((0,Lt.$)(i=>i)).toPromise(),e.subscription("route.query",e._route.queryParamMap.subscribe(i=>{if(i.has("zone_ids")){const n=i.get("zone_ids").split(",");if(n.length){const s=e._org.levelWithID(n);if(!s)return;e._org.building=e._org.buildings.find(l=>l.id===s.parent_id),e.zones=n}}})),e.subscription("levels",e._org.active_levels.subscribe(i=>{e.zones=e.zones.filter(n=>i.find(s=>s.id===n)),!e.zones.length&&i.length&&e.zones.push(i[0].id)}))})()}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(F),t.rXU(J.yb),t.rXU(w.nX),t.rXU(w.Ix))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["signage-topbar"]],features:[t.Vt3],decls:1,vars:0,consts:[[1,"flex","items-center","bg-base-100","h-20","px-4","border-b","border-base-200","space-x-2"]],template:function(i,n){1&i&&t.nrm(0,"div",0)},styles:["mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em}\n\n/*# sourceMappingURL=signage-topbar.component.ts-angular-inline--190.css.map*/"]})}return a})();var tt=r(26354);const Zt=()=>["name","description","media","duration","actions"],Wt=()=>["Name","Description","Media","Duration"," "],Ht=()=>["8r","flex","10r","6r","5r"],Qt=(a,o,e)=>({media:a,duration:o,actions:e});function Kt(a,o){1&a&&t.EFF(0),2&a&&t.SpI(" ",o.row.media.length," Media Item(s) ")}function qt(a,o){if(1&a&&(t.j41(0,"code"),t.EFF(1),t.nI1(2,"mediaDuration"),t.k0s()),2&a){const e=o.row;t.R7$(),t.JRh(t.bMT(2,1,e.duration))}}function te(a,o){if(1&a){const e=t.RV6();t.j41(0,"button",5),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.editItem(n))}),t.j41(1,"app-icon"),t.EFF(2,"edit"),t.k0s()(),t.j41(3,"button",6),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.deleteItem(n))}),t.j41(4,"app-icon"),t.EFF(5,"delete"),t.k0s()()}}function ee(a,o){1&a&&t.nrm(0,"mat-progress-bar",7)}let et=(()=>{class a{constructor(e){this._state=e,this.loading=this._state.loading,this.playlists=this._state.playlists,this.media=this._state.media,this.deleteItem=i=>this._state.removePlaylist(i),this.editItem=i=>this._state.editPlaylist(i),this.playlist_list=(0,f.zV)([this.playlists,this.media]).pipe((0,h.T)(([i,n])=>i.map(s=>({...s,duration:s.media.reduce((l,c)=>l+(s.media_durations[c]||n.find(m=>m.id===c)?.duration||15),0)}))))}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(F))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["signage-playlists"]],decls:9,vars:15,consts:[["media_template",""],["duration_template",""],["actions_template",""],[1,"block","min-w-[48rem]",3,"dataSource","columns","display_column","column_size","template"],["class","absolute inset-x-0 bottom-0","mode","indeterminate",4,"ngIf"],["icon","","matRipple","",3,"click"],["icon","","matRipple","",1,"text-error",3,"click"],["mode","indeterminate",1,"absolute","inset-x-0","bottom-0"]],template:function(i,n){if(1&i&&(t.nrm(0,"custom-table",3),t.DNE(1,Kt,1,1,"ng-template",null,0,t.C5r)(3,qt,3,3,"ng-template",null,1,t.C5r)(5,te,6,0,"ng-template",null,2,t.C5r)(7,ee,1,0,"mat-progress-bar",4),t.nI1(8,"async")),2&i){const s=t.sdS(2),l=t.sdS(4),c=t.sdS(6);t.Y8G("dataSource",n.playlist_list)("columns",t.lJ4(8,Zt))("display_column",t.lJ4(9,Wt))("column_size",t.lJ4(10,Ht))("template",t.sMw(11,Qt,s,l,c)),t.R7$(7),t.Y8G("ngIf",t.bMT(8,6,n.loading))}},dependencies:[u.bT,tt.HM,j.r6,k.R,X.r,u.Jj,I.X]})}return a})();const ie=()=>["name","description","playlists","orientation","duration","actions"],ne=()=>["Name","Description","Media","Orientation","Duration"," "],ae=()=>["8r","flex","8r","7r","6r","5r"],se=(a,o,e)=>({playlists:a,duration:o,actions:e});function oe(a,o){1&a&&t.EFF(0),2&a&&t.SpI(" ",o.row.playlists.length," Playlist(s) ")}function le(a,o){if(1&a&&(t.j41(0,"code"),t.EFF(1),t.nI1(2,"mediaDuration"),t.k0s()),2&a){const e=o.row;t.R7$(),t.JRh(t.bMT(2,1,e.duration))}}function re(a,o){if(1&a){const e=t.RV6();t.j41(0,"button",5),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.editItem(n))}),t.j41(1,"app-icon"),t.EFF(2,"edit"),t.k0s()(),t.j41(3,"button",6),t.bIt("click",function(){const n=t.eBV(e).row,s=t.XpG();return t.Njj(s.deleteItem(n))}),t.j41(4,"app-icon"),t.EFF(5,"delete"),t.k0s()()}}function ce(a,o){1&a&&t.nrm(0,"mat-progress-bar",7)}let it=(()=>{class a{constructor(e){this._state=e,this.loading=this._state.loading,this.displays=this._state.displays,this.playlists=this._state.playlists,this.media=this._state.media,this.deleteItem=i=>this._state.removePlaylist(i),this.editItem=i=>this._state.editPlaylist(i),this.display_list=(0,f.zV)([this.displays,this.playlists,this.media]).pipe((0,h.T)(([i,n,s])=>(i||[]).map(l=>({...l,playlists:l.playlists?.map(c=>n.find(m=>m.id===c))||[],duration:l.playlists.reduce((c,m)=>{const d=n.find(x=>x.id===m);return d?c+d.media.reduce((x,b)=>x+(d.media_durations[b]||s.find(T=>T.id===b)?.duration||15),0):c},0)}))))}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(F))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["signage-displays"]],decls:9,vars:15,consts:[["playlists_template",""],["duration_template",""],["actions_template",""],[1,"block","min-w-[52rem]",3,"dataSource","columns","display_column","column_size","template"],["class","absolute inset-x-0 bottom-0","mode","indeterminate",4,"ngIf"],["icon","","matRipple","",3,"click"],["icon","","matRipple","",1,"text-error",3,"click"],["mode","indeterminate",1,"absolute","inset-x-0","bottom-0"]],template:function(i,n){if(1&i&&(t.nrm(0,"custom-table",3),t.DNE(1,oe,1,1,"ng-template",null,0,t.C5r)(3,le,3,3,"ng-template",null,1,t.C5r)(5,re,6,0,"ng-template",null,2,t.C5r)(7,ce,1,0,"mat-progress-bar",4),t.nI1(8,"async")),2&i){const s=t.sdS(2),l=t.sdS(4),c=t.sdS(6);t.Y8G("dataSource",n.display_list)("columns",t.lJ4(8,ie))("display_column",t.lJ4(9,ne))("column_size",t.lJ4(10,ae))("template",t.sMw(11,se,s,l,c)),t.R7$(7),t.Y8G("ngIf",t.bMT(8,6,n.loading))}},dependencies:[u.bT,tt.HM,j.r6,k.R,X.r,u.Jj,I.X]})}return a})(),nt=(()=>{class a{constructor(e){this._state=e,this.loading=this._state.loading}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(F))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["signage-zones"]],decls:0,vars:0,template:function(i,n){}})}return a})(),at=(()=>{class a{constructor(e){this._state=e,this.loading=this._state.loading}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(F))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["signage-triggers"]],decls:0,vars:0,template:function(i,n){}})}return a})();var pe=r(12976);function me(a,o){if(1&a&&(t.nrm(0,"img",18),t.nI1(1,"thumbnail")),2&a){const e=t.XpG().$implicit;t.Y8G("src","video"===e.type?t.bMT(1,1,e.url):e.url,t.B4B)}}function de(a,o){if(1&a&&(t.j41(0,"div",19),t.nrm(1,"div",11),t.j41(2,"div",12),t.EFF(3),t.nI1(4,"mediaDuration"),t.k0s()()),2&a){const e=t.XpG().$implicit;t.R7$(3),t.SpI(" ",t.bMT(4,1,e.duration)," ")}}function ue(a,o){if(1&a){const e=t.RV6();t.j41(0,"div",7)(1,"button",8),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG(3);return t.Njj(s.previewMedia(n))}),t.DNE(2,me,2,3,"img",9),t.nI1(3,"thumbnail"),t.j41(4,"div",10),t.nrm(5,"div",11),t.j41(6,"div",12),t.EFF(7),t.k0s()(),t.j41(8,"div",13),t.nrm(9,"div",11),t.j41(10,"div",12),t.EFF(11),t.k0s()(),t.DNE(12,de,5,3,"div",14),t.k0s(),t.j41(13,"div",15)(14,"div",16),t.EFF(15),t.k0s(),t.j41(16,"button",17)(17,"app-icon"),t.EFF(18,"more_vert"),t.k0s()()()()}if(2&a){const e=o.$implicit,i=t.XpG(3);t.R7$(2),t.Y8G("ngIf","video"===e.type?t.bMT(3,5,e.url):e.url),t.R7$(5),t.SpI(" ","image"===e.type?"Image":"Video"," "),t.R7$(4),t.SpI(" ",i.count||0," Playlist(s) "),t.R7$(),t.Y8G("ngIf",e.duration),t.R7$(3),t.SpI(" ",e.name," ")}}function ge(a,o){if(1&a&&(t.qex(0),t.j41(1,"div",5),t.DNE(2,ue,19,7,"div",6),t.nI1(3,"async"),t.k0s(),t.bVm()),2&a){const e=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",t.bMT(3,1,e.media))}}function _e(a,o){if(1&a&&(t.qex(0),t.DNE(1,ge,4,3,"ng-container",3),t.nI1(2,"async"),t.bVm()),2&a){let e;const i=t.XpG(),n=t.sdS(5);t.R7$(),t.Y8G("ngIf",null==(e=t.bMT(2,2,i.media))?null:e.length)("ngIfElse",n)}}function fe(a,o){if(1&a){const e=t.RV6();t.j41(0,"div",20),t.nrm(1,"div",21)(2,"div",22),t.j41(3,"div",23)(4,"app-icon",24),t.EFF(5,"upload"),t.k0s(),t.j41(6,"p"),t.EFF(7,"Drop file to upload file"),t.k0s()(),t.j41(8,"input",25),t.bIt("change",function(n){t.eBV(e);const s=t.XpG();return t.Njj(s.previewFile(n))}),t.k0s()()}}function he(a,o){1&a&&(t.j41(0,"div",26)(1,"app-icon",24),t.EFF(2,"hide_image"),t.k0s(),t.j41(3,"p"),t.EFF(4,"No media found."),t.k0s()())}function ye(a,o){1&a&&(t.j41(0,"div",27),t.nrm(1,"mat-spinner",28),t.j41(2,"p"),t.EFF(3,"Loading..."),t.k0s()())}let st=(()=>{class a extends g.Tv{onEnter(e){this.show_dropzone=e?.dataTransfer?.types.includes("Files")}hideOverlay(e){e.target instanceof HTMLInputElement||e.preventDefault(),this.timeout("hide_overlay",()=>this.show_dropzone=!1)}constructor(e){super(),this._state=e,this.loading=this._state.loading,this.media=this._state.media,this.show_dropzone=!1,this.previewMedia=i=>this._state.previewMedia(i)}previewFile(e){const i=e.target;if(!i?.files?.length)return;const s=i.files[0];s&&(s.type.includes("image")||s.type.includes("video"))?this._state.previewFileMedia(s):(0,g.UG)("Invalid file type.")}static#t=this.\u0275fac=function(i){return new(i||a)(t.rXU(F))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["signage-media"]],features:[t.Vt3],decls:8,vars:5,consts:[["empty_template",""],["load_template",""],[1,"relative","bg-base-200","min-h-full","w-full",3,"dragenter","drop"],[4,"ngIf","ngIfElse"],["class","absolute inset-0",4,"ngIf"],[1,"flex","flex-wrap","items-start","justify-start","w-full","p-2"],["class","m-2 p-2 bg-base-100 rounded-lg overflow-hidden h-[13rem] w-[17rem] border border-base-300 shadow",4,"ngFor","ngForOf"],[1,"m-2","p-2","bg-base-100","rounded-lg","overflow-hidden","h-[13rem]","w-[17rem]","border","border-base-300","shadow"],[1,"w-64","h-36","overflow-hidden","bg-base-200","rounded","m-0","p-0","relative",3,"click"],["class","object-contain w-full h-full",3,"src",4,"ngIf"],[1,"absolute","top-2","left-2","flex","items-center","justify-center","rounded","overflow-hidden"],[1,"absolute","inset-0","bg-base-content","opacity-60","z-0"],[1,"relative","text-base-100","z-10","px-2","py-1","text-xs"],[1,"absolute","top-2","right-2","flex","items-center","justify-center","rounded","overflow-hidden"],["class","absolute bottom-2 right-2 flex items-center justify-center rounded overflow-hidden",4,"ngIf"],[1,"flex","items-center","justify-between","space-x-2"],[1,"truncate","flex-1","w-1/2","px-2"],["icon","","matRipple",""],[1,"object-contain","w-full","h-full",3,"src"],[1,"absolute","bottom-2","right-2","flex","items-center","justify-center","rounded","overflow-hidden"],[1,"absolute","inset-0"],[1,"absolute","inset-0","bg-base-200"],[1,"absolute","inset-0","bg-base-content","opacity-70"],[1,"absolute","inset-4","border-4","border-dashed","border-neutral","text-base-100","rounded-xl","flex","flex-col","items-center","justify-center"],[1,"text-8xl"],["type","file",1,"absolute","inset-0","w-full","opacity-0",3,"change"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2","opacity-30"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2"],["diameter","32"]],template:function(i,n){if(1&i){const s=t.RV6();t.j41(0,"div",2),t.bIt("dragenter",function(c){return t.eBV(s),t.Njj(n.onEnter(c))},!1,t.EBC)("drop",function(c){return t.eBV(s),t.Njj(n.hideOverlay(c))},!1,t.EBC),t.DNE(1,_e,3,4,"ng-container",3),t.nI1(2,"async"),t.DNE(3,fe,9,0,"div",4),t.k0s(),t.DNE(4,he,5,0,"ng-template",null,0,t.C5r)(6,ye,4,0,"ng-template",null,1,t.C5r)}if(2&i){const s=t.sdS(7);t.R7$(),t.Y8G("ngIf",!t.bMT(2,3,n.loading))("ngIfElse",s),t.R7$(2),t.Y8G("ngIf",n.show_dropzone)}},dependencies:[u.Sq,u.bT,P.LG,j.r6,k.R,u.Jj,I.X,pe.j],styles:["[_nghost-%COMP%]{min-height:100%}\n\n/*# sourceMappingURL=signage-media.component.ts-angular-inline--191.css.map*/"]})}return a})();var be=r(46815);const ve=[{path:"",component:q,children:[{path:"",redirectTo:"playlists",pathMatch:"full"},{path:"playlists",component:et},{path:"media",component:st},{path:"displays",component:it},{path:"zones",component:nt},{path:"triggers",component:at},{path:"*",redirectTo:"playlists",pathMatch:"full"}]}],je=[q,At,et,st,it,nt,at,Y,Q,K];let Fe=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.$C({type:a});static#i=this.\u0275inj=t.G2t({imports:[u.MD,p.YN,ot.r,be.hI,w.iI.forChild(ve),B.RI]})}return a})()}}]);
//# sourceMappingURL=apps_concierge_src_app_signage_signage_module_ts.js.map