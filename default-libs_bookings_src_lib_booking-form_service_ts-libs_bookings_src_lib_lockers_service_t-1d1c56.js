"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["default-libs_bookings_src_lib_booking-form_service_ts-libs_bookings_src_lib_lockers_service_t-1d1c56"],{8929:(z,w,_)=>{_.d(w,{f:()=>j});var i=_(1670),K=_(9885),s=_(9112),u=_(308),t=_(1810),S=_(2317),n=_(3861),y=_(7485),C=_(4505),M=_(4139),A=_(7716),p=_(8623),T=_(5398),l=_(9128),P=_(823),c=_(6116),m=_(9095),h=_(8759),N=_(6942),L=_(9151),D=_(5670),E=_(3910),b=_(565),f=_(6962),R=_(1980),r=_(354),e=_(4282),o=_(8871),a=_(4367),d=_(1562),x=_(2560),g=_(1484);const U=["book/desks","book/parking","book/new-desks","book/new-parking"];class j extends s.cx{get view(){return this._view.getValue()}get booking(){return this._booking.getValue()}newForm(O=new f.$){this.form.reset(),this.form.patchValue((0,u.sWL)({...O,...O.extension_data},[null,void 0,""])),this.subscription("form_change",this.form.valueChanges.subscribe(()=>this.storeForm())),this._booking.next(O),this._options.next({type:this._options.getValue().type})}constructor(O,v,I,Z,k){super(),this._router=O,this._settings=v,this._org=I,this._dialog=Z,this._payments=k,this._view=new C.X("form"),this._options=new C.X({type:"desk"}),this._booking=new C.X(null),this._loading=new C.X(""),this.last_success=new f.$(JSON.parse(sessionStorage.getItem("PLACEOS.last_booked_booking")||"{}")),this.loading=this._loading.asObservable(),this.options=this._options.pipe((0,l.d)(1)),this.form=(0,R.PR)(),this.resource=this.options.pipe((0,P.b)(300),(0,c.g)("type"),(0,m.w)(({type:B})=>{if(!this._org.building)return(0,M.of)([]);switch(B){case"desk":return this._loading.next("Loading desks..."),this.loadResourceList("desks");case"parking":return this._loading.next("Loading parking spaces..."),this.loadResourceList("parking_spaces")}return(0,M.of)([])}),(0,h.b)(()=>this._loading.next("")),(0,l.d)(1)),this.features=this.resource.pipe((0,N.U)(B=>{const $=[];for(const{features:W}of B)W instanceof Array&&W.forEach(F=>$.push(F));return(0,s.Tw)($).sort((W,F)=>W.localeCompare(F))}),(0,l.d)(1)),this.available_resources=(0,A.aj)([this.options,this.resource,(0,p.T)(this.form.valueChanges,(0,T.H)(1e3))]).pipe((0,L.h)(()=>this.form.getRawValue().date>0&&this.form.getRawValue().duration>0),(0,P.b)(500),(0,h.b)(([{type:B}])=>this._loading.next(`Checking ${B} availability...`)),(0,m.w)(([B,$])=>(0,r.F2)({period_start:(0,t.Z)(this.form.getRawValue().date),period_end:(0,t.Z)((0,S.Z)(this.form.getRawValue().date,this.form.getRawValue().duration||1440)),type:B.type,zones:B.zone_id}).pipe((0,N.U)(W=>$.filter(F=>(!F.groups?.length||F.groups.some(G=>(0,s.ar)().groups.includes(G)))&&!1!==F.bookable&&(!B.features||B.features?.every(G=>F.features.includes(G)))&&(!B.zone_id||B.zone_id===F.zone?.id||B.zone_id===F.zone?.parent_id)&&!W.find(G=>G.asset_id===F.id&&"declined"!==G.status))))),(0,h.b)(()=>this._loading.next("")),(0,l.d)(1)),this.grouped_availability=(0,A.aj)([this.options,this.available_resources]).pipe((0,N.U)(([B,$])=>{const W=[],F=[...$].sort((Q,X)=>Q.zone?.id?.localeCompare(X.zone?.id)),G=B.members?.length?B.members:[(0,s.ar)()];for(;F.length;){const Q=[];let X=F.pop();for(;Q.length<G.length&&(!Q.length||Q.find(V=>V.zone?.id===X.zone?.id));)Q.push(X),X=F.pop();Q.length<G.length||W.push(Q)}return W})),this.subscription("router.bookings",this._router.events.subscribe(B=>{B instanceof K.m2&&!U.find($=>B.url.includes($))&&this.clearForm()})),this._org.initialised.pipe((0,D.P)(B=>B)).subscribe(()=>this.setOptions({}))}setView(O){this._view.next(O)}setOptions(O){this._options.next({...this._options.getValue(),...O})}setFeature(O,v){if(!O?.length)return;const I=this._options.getValue()?.features||[];v&&!I.includes(O)&&I.push(O),!v&&I.includes(O)&&I.splice(I.findIndex(Z=>Z===O),1),this.setOptions({features:I})}resetForm(){const O=this._booking.getValue();this.form.reset({user:(0,s.ar)(),booked_by:(0,s.ar)()}),this.form.patchValue((0,u.sWL)({...O||{},...O?.extension_data||{}},[null,void 0,""])),this._options.next({type:this._options.getValue().type})}clearForm(){sessionStorage.removeItem("PLACEOS.booking_form"),sessionStorage.removeItem("PLACEOS.booking_form_options"),this.newForm()}storeForm(){sessionStorage.setItem("PLACEOS.booking_form",JSON.stringify(this.form.getRawValue()||{})),sessionStorage.setItem("PLACEOS.booking_form_filters",JSON.stringify(this._options.getValue()||{}))}loadForm(){this.form.reset({user:(0,s.ar)(),booked_by:(0,s.ar)()});const O=JSON.parse(sessionStorage.getItem("PLACEOS.booking_form")||"{}"),v=new f.$(O);this._booking.next(v);const I=(0,u.sWL)({...O,...v||{},...v?.extension_data||{}},[null,void 0,""]);this.form.patchValue(I),this.setOptions({zone_id:this._org.building?.id,...JSON.parse(sessionStorage.getItem("PLACEOS.booking_form_filters")||"{}")})}clearOldState(){sessionStorage.removeItem("PLACEOS.last_booked_booking"),this.last_success=new f.$}openBookingLinkModal(O=!1){if(this.form.markAllAsTouched(),!this.form.valid&&!O)return;const v=new f.$({...this.booking,...this.form.getRawValue()});this._dialog.open(a.w,{data:v})}confirmPost(){var O=this;return(0,i.Z)(function*(){yield O.checkQuestions();const v=O._options.getValue(),I=O.form.getRawValue();let Z=`Would you like to book the ${v.type} ${I.asset_name} for ${(0,n.Z)(I.date,"dd MMM yyyy")}${I.duration<720?" at "+(0,n.Z)(I.date,"h:mm a"):""}`;v.group&&(Z=`${Z}.<br>You group members will be assigned desks nearby your selected desk.`);const k=yield(0,s._5)({title:`Book ${v.type}`,content:Z,icon:{content:"event_available"}},O._dialog);if("done"!==k?.reason)throw"User cancelled";k.loading("Performing booking request..."),v.group?yield O.postFormForGroup().catch(B=>{throw(0,s.cB)(JSON.stringify(B)),k.close(),B}):yield O.postForm().catch(B=>{throw(0,s.cB)(JSON.stringify(B)),k.close(),B}),k.close()})()}postForm(O=!1){var v=this;return(0,i.Z)(function*(){if(!v.form)throw"No form for booking";if(!v.form.valid)throw`Some form fields are invalid. [${(0,s.RD)(v.form).join(", ")}]`;v.form.patchValue({booking_type:v.form.getRawValue().booking_type||v._options.getValue().type});let I=v.form.getRawValue(),Z=v._booking.getValue()||new f.$;if(O||(yield v.checkResourceAvailable(I,v._options.getValue().type)),(I.duration>=720||I.all_day)&&(v.form.patchValue({date:(0,y.Z)(I.date,{hours:11,minutes:59}).valueOf(),duration:720}),I=v.form.getRawValue()),v._payments.payment_module){const $=yield v._payments.makePayment({type:v._options.getValue().type,resource_name:I.asset_name,date:I.date,duration:I.duration,all_day:I.all_day});if(!$?.success)return;I.extension_data={invoice:$,invoice_id:$.invoice_id}}(I.assets?.length||Z.extension_data.assets?.length)&&(yield(0,d.cd)(`${I.booked_by_email}|${I.date}`,{date:I.date,duration:I.duration,host:I.booked_by_email},I.assets,Z.extension_data.assets)),v._loading.next("Saving booking");const k=yield(0,r.km)(new f.$({...v._options.getValue(),...I,description:I.asset_name||I.description,user_name:I.user?.name,user_id:(I.user?.id?.includes("@")?"":I?.user?.id)||(0,s.ar)()?.id,extension_data:{...I.extension_data||{},department:I.user?.department||(0,s.ar)()?.department},approved:!!v._settings.get("app.bookings.no_approval")})).toPromise().catch($=>{throw v._loading.next(""),$});v._loading.next("");const{booking_type:B}=I;return v.clearForm(),v.form?.patchValue({booking_type:B}),v.last_success=k,sessionStorage.setItem("PLACEOS.last_booked_booking",JSON.stringify(k)),v.setView("success"),k})()}postFormForGroup(){var O=this;return(0,i.Z)(function*(){const{members:v,group:I,type:Z}=O._options.getValue();if(!I)throw"No group available to book for";const k=v.filter(X=>X.email!==(0,s.ar)().email);if(k.length<=0)throw"No members in your group to book for.";const B=O.form.value,$=yield O.available_resources.pipe((0,E.q)(1)).toPromise(),W=$.find(X=>X.id===B.asset_id||X.map_id===B.asset_id),F=O._org.levelWithID([W.zone?.id]),G=[W,...yield O._getNearbyResources(F.map_id,B.asset_id,$,k.length)],Q=(0,s.Tw)([(0,s.ar)(),...k],"email");yield Promise.all(Q.map((X,V)=>O.checkResourceAvailable({...B,asset_id:G[V].map_id||G[V].id,user_email:X.email},Z)));for(let X=0;X<Q.length;X++){const V=Q[X],J=G[X];O.form.patchValue({...B,user:V,user_email:V.email,user_id:V.id,asset_id:J?.id,asset_name:J.name,description:J.name,map_id:J?.map_id||J?.id,zones:J.zone?(0,s.Tw)([O._org.organisation.id,J.zone?.parent_id,J.zone?.id]):[O._org.organisation.id]}),O.postForm(!0)}})()}checkQuestions(){var O=this;return(0,i.Z)(function*(){if(!1!==O._settings.get("app.desks.ignore_questions"))return;const v=O._dialog.open(e.I);if("done"!==(yield Promise.race([v.componentInstance.event.pipe((0,D.P)(k=>"done"===k.reason)).toPromise(),v.afterClosed().toPromise()]))?.reason)throw"User cancelled";const Z=v.componentInstance.form.getRawValue();for(const k in Z)if(Z[k])throw"User failed questionaire";v.close()})()}checkResourceAvailable({asset_id:O,date:v,duration:I,user_email:Z,all_day:k},B){var $=this;return(0,i.Z)(function*(){I=k?720:I||60;const W=yield(0,r.F2)({period_start:(0,t.Z)(v),period_end:(0,t.Z)(v+60*I*1e3),type:B}).toPromise();if(W.find(G=>G.asset_id===O))throw O.includes("@")?`${O} already has an invite for the selected time`:`${O} is not available at the selected time`;const F=$._settings.get(`app.booking.allowed_daily_${B}_count`)??1;if(F>0&&W.filter(G=>G.user_email===(Z||(0,s.ar)()?.email)&&"declined"!==G.status).length>=F){const G=Z===(0,s.ar)()?.email;throw`${G?"You":Z} already ${G?"have":"has"} a ${B} booked`}return!0})()}loadResourceList(O){return(0,u.BW_)(this._org.building.id,{name:O}).pipe((0,N.U)(v=>(0,s.xH)(v.map(I=>(I.metadata[O]?.details instanceof Array?I.metadata[O]?.details:[]).map(Z=>({...Z,zone:I.zone}))))))}_getNearbyResources(O,v,I,Z){return(0,i.Z)(function*(){const k=[];let B=I.filter($=>$.id!==v&&$.map_id!==v);for(let $=0;$<Z;$++){const W=yield(0,R.gV)(O,v,B.map(F=>F.map_id||F.id));W&&(k.push(I.find(F=>F.id===W||F.map_id===W)),B=B.filter(F=>F.id!==W&&F.map_id!==W))}return k})()}}j.\u0275fac=function(O){return new(O||j)(x.LFG(K.F0),x.LFG(s.gb),x.LFG(b.w),x.LFG(g.uw),x.LFG(o.c))},j.\u0275prov=x.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"})},4367:(z,w,_)=>{_.d(w,{w:()=>M});var i=_(1484),K=_(719),s=_(9497),t=(_(6962),_(2560)),S=_(5306),n=_(207),y=_(158),C=_(7202);class M{constructor(p,T){this._event=p,this._settings=T,this.outlook_link=(0,s.Y$)(this._event),this.google_link=(0,s.T$)(this._event),this.ical_link=(0,s.KS)(this._event)}}M.\u0275fac=function(p){return new(p||M)(t.Y36(i.WI),t.Y36(K.g))},M.\u0275cmp=t.Xpm({type:M,selectors:[["booking-link-modal"]],decls:22,vars:12,consts:function(){let A,p,T;return A=$localize`:␟34c16b14ad0e33db574c8bea543e66e766aa3a01␟4015832758698516701:Create in Outlook`,p=$localize`:␟f745484670e6b6bbb8a1c327c222e665fb25b863␟3788591245559456526:Create in Google Calendar`,T=$localize`:␟1af54061e7f4bcfb1048ffaa05c9b8f7c4b41679␟4894641609416495396:Download iCal File`,[[1,"p-4","w-full","pb-2"],[1,"flex","flex-col","items-center","space-y-4","p-4","relative"],["button","","matRipple","","target","_blank","rel","noopener noreferer",1,"flex","items-center","p-2","space-x-2","pr-4","w-64","rounded","inverse",3,"href"],["src","assets/icons/outlook.svg",1,"w-6"],A,["src","assets/icons/gcal.svg",1,"w-6"],p,[1,"text-xl"],T,["icon","","mat-dialog-close","",1,"absolute","top-2","right-0"]]},template:function(p,T){1&p&&(t.TgZ(0,"div",0),t._uU(1,"Add event to your calendar"),t.qZA(),t.TgZ(2,"div",1)(3,"a",2),t.ALo(4,"sanitize"),t._UZ(5,"img",3),t.TgZ(6,"span"),t.SDv(7,4),t.qZA()(),t.TgZ(8,"a",2),t.ALo(9,"sanitize"),t._UZ(10,"img",5),t.TgZ(11,"span"),t.SDv(12,6),t.qZA()(),t.TgZ(13,"a",2),t.ALo(14,"safe"),t.TgZ(15,"app-icon",7),t._uU(16,"download"),t.qZA(),t.TgZ(17,"span"),t.SDv(18,8),t.qZA()()(),t.TgZ(19,"button",9)(20,"app-icon"),t._uU(21,"close"),t.qZA()()),2&p&&(t.xp6(3),t.Q6J("href",t.xi3(4,3,T.outlook_link,"url"),t.LSH),t.xp6(5),t.Q6J("href",t.xi3(9,6,T.google_link,"url"),t.LSH),t.xp6(5),t.Q6J("href",t.xi3(14,9,T.ical_link,"url"),t.LSH))},dependencies:[i.ZT,S.o,n.wG,y.y,C.n],styles:["[_nghost-%COMP%]{position:relative}\n/*# sourceMappingURL=booking-link-modal.component.ts-angular-inline--62.css.map*/"]})},4282:(z,w,_)=>{_.d(w,{I:()=>M});var i=_(2560),K=_(2508),u=(_(9112),_(4666)),t=_(2922),S=_(1484),n=_(207);function y(A,p){if(1&A){const T=i.EpF();i.TgZ(0,"div",2)(1,"h2",3),i.SDv(2,4),i.qZA(),i.TgZ(3,"main",5)(4,"div",6)(5,"label"),i.tHW(6,7),i._UZ(7,"span"),i.N_p(),i.qZA(),i.TgZ(8,"mat-radio-group",8)(9,"mat-radio-button",9),i._uU(10,"Yes"),i.qZA(),i.TgZ(11,"mat-radio-button",9),i._uU(12,"No"),i.qZA()()(),i.TgZ(13,"div",6)(14,"label"),i.tHW(15,10),i._UZ(16,"span"),i.N_p(),i.qZA(),i.TgZ(17,"mat-radio-group",11)(18,"mat-radio-button",9),i._uU(19,"Yes"),i.qZA(),i.TgZ(20,"mat-radio-button",9),i._uU(21,"No"),i.qZA()()(),i.TgZ(22,"div",12)(23,"label"),i.tHW(24,13),i._UZ(25,"span"),i.N_p(),i.qZA(),i.TgZ(26,"mat-radio-group",14)(27,"mat-radio-button",9),i._uU(28,"Yes"),i.qZA(),i.TgZ(29,"mat-radio-button",9),i._uU(30,"No"),i.qZA()()()(),i.TgZ(31,"footer",15)(32,"button",16),i.NdJ("click",function(){i.CHM(T);const P=i.oxw();return i.KtG(P.submit())}),i.SDv(33,17),i.qZA()(),i.TgZ(34,"button",18)(35,"i",19),i._uU(36,"close"),i.qZA()()()}if(2&A){const T=i.oxw();i.xp6(3),i.Q6J("formGroup",T.form),i.xp6(6),i.Q6J("value",!0),i.xp6(2),i.Q6J("value",!1),i.xp6(7),i.Q6J("value",!0),i.xp6(2),i.Q6J("value",!1),i.xp6(7),i.Q6J("value",!0),i.xp6(2),i.Q6J("value",!1)}}function C(A,p){1&A&&(i.TgZ(0,"main",20)(1,"p",21),i.SDv(2,22),i.qZA(),i.TgZ(3,"button",18)(4,"i",19),i._uU(5,"close"),i.qZA()()())}class M{constructor(){this.event=new i.vpe,this.form=new K.cw({travelled:new K.NI(!1),unwell:new K.NI(!1),contact:new K.NI(!1)})}submit(){this.form.markAllAsTouched(),Object.keys(this.form.value).find(p=>!0===this.form.value[p]||"true"===this.form.value[p])?this.failure=!0:this.event.emit({reason:"done"})}}M.\u0275fac=function(p){return new(p||M)},M.\u0275cmp=i.Xpm({type:M,selectors:[["desk-question-modal"]],outputs:{event:"event"},decls:3,vars:2,consts:function(){let A,p,T,l,P,c;return A=$localize`:␟02006a13b8e6aacb7a6e15bafd8004ed529f5d81␟877348132538805077:COVID-19 Questionnaire`,p=$localize`:␟dad7efbd2320e5ea935aef911f18cbcb24690133␟1650520403092579087: Have you travelled overseas within the last 14 days?${"\ufffd#7\ufffd"}:START_TAG_SPAN:*${"\ufffd/#7\ufffd"}:CLOSE_TAG_SPAN:`,T=$localize`:␟cf50bf8de6c6db836da440c89a375631f7ba3fb0␟1182497320820036810: Are you unwell or experiencing any cold or flu-like symptoms?${"\ufffd#16\ufffd"}:START_TAG_SPAN:*${"\ufffd/#16\ufffd"}:CLOSE_TAG_SPAN:`,l=$localize`:␟273153c91358de15d124ff2966859d9949080f4c␟737527639567676154: Have you had contact with anyone with suspected COVID-19?${"\ufffd#25\ufffd"}:START_TAG_SPAN:*${"\ufffd/#25\ufffd"}:CLOSE_TAG_SPAN:`,P=$localize`:␟71c77bb8cecdf11ec3eead24dd1ba506573fa9cd␟935187492052582731:Submit`,c=$localize`:␟17d62f424c2c025579e1ec0e3f5ad971f57681df␟4401678084033805848: Your request to work from the office has been rejected based on your response to the compulsory Covid-19 questions. Please feel free to submit a new request when circumstances change in a way that changes your answer to the questions. `,[["class","relative",4,"ngIf","ngIfElse"],["fail_state",""],[1,"relative"],[1,"p-4","text-xl"],A,[1,"p-4",3,"formGroup"],[1,"flex","flex-col","mb-4"],p,["formControlName","travelled",1,"space-x-2"],[3,"value"],T,["formControlName","unwell",1,"space-x-2"],[1,"flex","flex-col"],l,["formControlName","contact",1,"space-x-2"],[1,"flex","justify-center","items-center","p-2"],["btn","","matRipple","",3,"click"],P,["close","","icon","","matRipple","","mat-dialog-close",""],[1,"material-icons"],["failure","",1,"pt-8","relative"],[1,"p-4"],c]},template:function(p,T){if(1&p&&(i.YNc(0,y,37,7,"div",0),i.YNc(1,C,6,0,"ng-template",null,1,i.W1O)),2&p){const l=i.MAs(2);i.Q6J("ngIf",!T.failure)("ngIfElse",l)}},dependencies:[u.O5,K.JJ,K.JL,K.sg,K.u,t.VQ,t.U0,S.ZT,n.wG],styles:["main[_ngcontent-%COMP%]{width:24rem;max-width:calc(100vw - 4.5rem)}[close][_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem}\n/*# sourceMappingURL=desk-questions-modal.component.ts-angular-inline--61.css.map*/"]})},7121:(z,w,_)=>{_.d(w,{A:()=>T});var i=_(1670),K=_(6221),s=_(308),u=_(4505),t=_(7716),S=_(4139),n=_(9151),y=_(9095),C=_(7418),M=_(6942),A=_(9128),p=_(2560);class T{setLevel(P){this._level.next(P)}constructor(P){this._org=P,this._level=new u.X(""),this._change=new u.X(0),this.lockers_banks$=(0,t.aj)([this._org.active_building,this._change]).pipe((0,n.h)(([c])=>!!c),(0,y.w)(([c])=>(0,s.rlq)(c.id,"lockers").pipe((0,C.K)(()=>(0,S.of)(new s.k44)))),(0,M.U)(c=>c.details||[]),(0,A.d)(1)),this.lockers$=this.lockers_banks$.pipe((0,M.U)(c=>{const m=[];for(const h of c)m.push(...h.lockers.map(N=>({...N,bank_id:h.id})));return m})),this.filtered_lockers$=(0,t.aj)([this._level,this.lockers$]).pipe((0,M.U)(([c,m])=>m.filter(h=>(!c||h.level_id===c)&&h.bookable)))}saveLockers(P){var c=this;return(0,i.Z)(function*(){yield(0,s.Ymr)(c._org.building.id,{name:"lockers",description:"",details:P}),c._change.next(Date.now())})()}}T.\u0275fac=function(P){return new(P||T)(p.LFG(K.w7))},T.\u0275prov=p.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"})},6168:(z,w,_)=>{function i(s){var u=this;s="object"==typeof s?s:{},u.revision=3,u.imageTypes={bmp:"image/bmp",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpg",png:"image/png","svg+xml":"image/svg+xml",tiff:"image/tiff",webp:"image/webp","x-icon":"image/x-icon"},u.toTable=s.toTable,u.domElement=u.toTable?document.createElement("div"):document.createElement("canvas"),u.url=s.url||"",u.size=s.size||280,u.qrc=!1,u.colorLight=s.colorLight||"#fff",u.colorDark=s.colorDark||"#000",u.ecclevel=s.ecclevel||1,u.noBorder=s.noBorder,u.borderSize=s.borderSize||4;var t,S,n,y,C,M,A,p=[],T=[],l=[],P=[],c=[],m=[],h=function(r,e){var o;r>e&&(o=r,r=e,e=o),o=e,o*=e,o+=e,o>>=1,P[o+=r]=1},N=function(r,e){var o;for(l[r+n*e]=1,o=-2;o<2;o++)l[r+o+n*(e-2)]=1,l[r-2+n*(e+o+1)]=1,l[r+2+n*(e+o)]=1,l[r+o+1+n*(e+2)]=1;for(o=0;o<2;o++)h(r-1,e+o),h(r+1,e-o),h(r-o,e-1),h(r+o,e+1)},L=function(r){for(;r>=255;)r=((r-=255)>>8)+(255&r);return r},D=function(r,e,o,a){var d,x,g,U=i.gexp,j=i.glog;for(d=0;d<a;d++)p[o+d]=0;for(d=0;d<e;d++){if(255!=(g=j[p[r+d]^p[o]]))for(x=1;x<a;x++)p[o+x-1]=p[o+x]^U[L(g+m[a-x])];else for(x=o;x<o+a;x++)p[x]=p[x+1];p[o+a-1]=255==g?0:U[L(g+m[0])]}},E=function(r,e){var o;return r>e&&(o=r,r=e,e=o),o=e,o+=e*e,o>>=1,P[o+=r]},b=function(r){var e,o,a,d;switch(r){case 0:for(o=0;o<n;o++)for(e=0;e<n;e++)e+o&1||E(e,o)||(l[e+o*n]^=1);break;case 1:for(o=0;o<n;o++)for(e=0;e<n;e++)1&o||E(e,o)||(l[e+o*n]^=1);break;case 2:for(o=0;o<n;o++)for(a=0,e=0;e<n;e++,a++)3==a&&(a=0),a||E(e,o)||(l[e+o*n]^=1);break;case 3:for(d=0,o=0;o<n;o++,d++)for(3==d&&(d=0),a=d,e=0;e<n;e++,a++)3==a&&(a=0),a||E(e,o)||(l[e+o*n]^=1);break;case 4:for(o=0;o<n;o++)for(a=0,d=o>>1&1,e=0;e<n;e++,a++)3==a&&(a=0,d=!d),d||E(e,o)||(l[e+o*n]^=1);break;case 5:for(d=0,o=0;o<n;o++,d++)for(3==d&&(d=0),a=0,e=0;e<n;e++,a++)3==a&&(a=0),(e&o&1)+!(!a|!d)||E(e,o)||(l[e+o*n]^=1);break;case 6:for(d=0,o=0;o<n;o++,d++)for(3==d&&(d=0),a=0,e=0;e<n;e++,a++)3==a&&(a=0),(e&o&1)+(a&&a==d)&1||E(e,o)||(l[e+o*n]^=1);break;case 7:for(d=0,o=0;o<n;o++,d++)for(3==d&&(d=0),a=0,e=0;e<n;e++,a++)3==a&&(a=0),(a&&a==d)+(e+o&1)&1||E(e,o)||(l[e+o*n]^=1)}},f=function(r){var e,o=0;for(e=0;e<=r;e++)c[e]>=5&&(o+=i.N1+c[e]-5);for(e=3;e<r-1;e+=2)c[e-2]==c[e+2]&&c[e+2]==c[e-1]&&c[e-1]==c[e+1]&&3*c[e-1]==c[e]&&(0==c[e-3]||e+3>r||3*c[e-3]>=4*c[e]||3*c[e+3]>=4*c[e])&&(o+=i.N3);return o},R=function(){var r,e,o,a,d,x=0,g=0;for(e=0;e<n-1;e++)for(r=0;r<n-1;r++)(l[r+n*e]&&l[r+1+n*e]&&l[r+n*(e+1)]&&l[r+1+n*(e+1)]||!(l[r+n*e]||l[r+1+n*e]||l[r+n*(e+1)]||l[r+1+n*(e+1)]))&&(x+=i.N2);for(e=0;e<n;e++){for(c[0]=0,o=a=r=0;r<n;r++)(d=l[r+n*e])==a?c[o]++:c[++o]=1,g+=(a=d)?1:-1;x+=f(o)}g<0&&(g=-g);var U=g,j=0;for(U+=U<<2,U<<=1;U>n*n;)U-=n*n,j++;for(x+=j*i.N4,r=0;r<n;r++){for(c[0]=0,o=a=e=0;e<n;e++)(d=l[r+n*e])==a?c[o]++:c[++o]=1,a=d;x+=f(o)}return x};u.genframe=function(r){var e,o,a,d,x,g,U,j,Y=i.eccblocks,O=i.gexp,v=i.glog;d=r.length,S=0;do{if(S++,a=4*(t-1)+16*(S-1),y=Y[a++],C=Y[a++],M=Y[a++],A=Y[a],d<=(a=M*(y+C)+C-3+(S<=9)))break}while(S<40);for(n=17+4*S,x=M+(M+A)*(y+C)+C,d=0;d<x;d++)T[d]=0;for(p=r.slice(0),d=0;d<n*n;d++)l[d]=0;for(d=0;d<(n*(n+1)+1)/2;d++)P[d]=0;for(d=0;d<3;d++){for(a=0,o=0,1==d&&(a=n-7),2==d&&(o=n-7),l[o+3+n*(a+3)]=1,e=0;e<6;e++)l[o+e+n*a]=1,l[o+n*(a+e+1)]=1,l[o+6+n*(a+e)]=1,l[o+e+1+n*(a+6)]=1;for(e=1;e<5;e++)h(o+e,a+1),h(o+1,a+e+1),h(o+5,a+e),h(o+e+1,a+5);for(e=2;e<4;e++)l[o+e+n*(a+2)]=1,l[o+2+n*(a+e+1)]=1,l[o+4+n*(a+e)]=1,l[o+e+1+n*(a+4)]=1}if(S>1)for(d=i.adelta[S],o=n-7;;){for(e=n-7;e>d-3&&(N(e,o),!(e<d));)e-=d;if(o<=d+9)break;N(6,o-=d),N(o,6)}for(l[8+n*(n-8)]=1,o=0;o<7;o++)h(7,o),h(n-8,o),h(7,o+n-7);for(e=0;e<8;e++)h(e,7),h(e+n-8,7),h(e,n-8);for(e=0;e<9;e++)h(e,8);for(e=0;e<8;e++)h(e+n-8,8),h(8,e);for(o=0;o<7;o++)h(8,o+n-7);for(e=0;e<n-14;e++)1&e?(h(8+e,6),h(6,8+e)):(l[8+e+6*n]=1,l[6+n*(8+e)]=1);if(S>6)for(d=i.vpat[S-7],a=17,e=0;e<6;e++)for(o=0;o<3;o++,a--)1&(a>11?S>>a-12:d>>a)?(l[5-e+n*(2-o+n-11)]=1,l[2-o+n-11+n*(5-e)]=1):(h(5-e,2-o+n-11),h(2-o+n-11,5-e));for(o=0;o<n;o++)for(e=0;e<=o;e++)l[e+n*o]&&h(e,o);for(x=p.length,g=0;g<x;g++)T[g]=p.charCodeAt(g);if(p=T.slice(0),x>=(e=M*(y+C)+C)-2&&(x=e-2,S>9&&x--),g=x,S>9){for(p[g+2]=0,p[g+3]=0;g--;)p[g+3]|=255&(d=p[g])<<4,p[g+2]=d>>4;p[2]|=255&x<<4,p[1]=x>>4,p[0]=64|x>>12}else{for(p[g+1]=0,p[g+2]=0;g--;)p[g+2]|=255&(d=p[g])<<4,p[g+1]=d>>4;p[1]|=255&x<<4,p[0]=64|x>>4}for(g=x+3-(S<10);g<e;)p[g++]=236,p[g++]=17;for(m[0]=1,g=0;g<A;g++){for(m[g+1]=1,U=g;U>0;U--)m[U]=m[U]?m[U-1]^O[L(v[m[U]]+g)]:m[U-1];m[0]=O[L(v[m[0]]+g)]}for(g=0;g<=A;g++)m[g]=v[m[g]];for(a=e,o=0,g=0;g<y;g++)D(o,M,a,A),o+=M,a+=A;for(g=0;g<C;g++)D(o,M+1,a,A),o+=M+1,a+=A;for(o=0,g=0;g<M;g++){for(U=0;U<y;U++)T[o++]=p[g+U*M];for(U=0;U<C;U++)T[o++]=p[y*M+g+U*(M+1)]}for(U=0;U<C;U++)T[o++]=p[y*M+g+U*(M+1)];for(g=0;g<A;g++)for(U=0;U<y+C;U++)T[o++]=p[e+g+U*A];for(p=T,e=o=n-1,a=x=1,j=(M+A)*(y+C)+C,g=0;g<j;g++)for(d=p[g],U=0;U<8;U++,d<<=1){128&d&&(l[e+n*o]=1);do{x?e--:(e++,a?0!=o?o--:(a=!a,6==(e-=2)&&(e--,o=9)):o!=n-1?o++:(a=!a,6==(e-=2)&&(e--,o-=8))),x=!x}while(E(e,o))}for(p=l.slice(0),d=0,o=3e4,a=0;a<8&&(b(a),(e=R())<o&&(o=e,d=a),7!=d);a++)l=p.slice(0);for(d!=a&&b(d),o=i.fmtword[d+(t-1<<3)],a=0;a<8;a++,o>>=1)1&o&&(l[n-1-a+8*n]=1,a<6?l[8+n*a]=1:l[8+n*(a+1)]=1);for(a=0;a<7;a++,o>>=1)1&o&&(l[8+n*(n-7+a)]=1,a?l[6-a+8*n]=1:l[7+8*n]=1);return l},u.init=function(){t=u.ecclevel;var r=u.genframe(u.url);u.toTable?u.tableWrite(r,n):u.canvasWrite(r,n)},u.init()}function K(s,u="#fff0",t="#000"){return new i({url:s||"Hello",size:360,colorLight:u,colorDark:t,toTable:!1,ecclevel:1,noBorder:!0,borderSize:0})?.toImage("svg+xml")?.src}_.d(w,{w:()=>K}),i.prototype={canvasWrite:function(s,u){if(!this.qrc&&(this.qrc=this.getContext(this.domElement),!this.qrc))return this.toTable=!0,this.domElement=document.createElement("div"),void this.tableWrite(s,u);var t=this.size,S=this.qrc;S.lineWidth=1;var n=t;n/=u+10,n=Math.round(n-.5);var y=4;this.noBorder?(S.canvas.width=S.canvas.height=n*u,y=0):S.canvas.width=S.canvas.height=t,S.clearRect(0,0,t,t),S.fillStyle=this.colorLight,S.fillRect(0,0,n*(u+8),n*(u+8)),S.fillStyle=this.colorDark;for(var C=0;C<u;C++)for(var M=0;M<u;M++)s[M*u+C]&&S.fillRect(n*(y+C),n*(y+M),n,n)},tableWrite:function(s,u){var t=this,S=Math.round(this.size/u-3.5)+"px",n=u+(t.noBorder?0:2*t.borderSize),y=t.borderSize,C="width:"+S+";height:"+S+";",M=t.colorLight,A=t.colorDark,p=document.createElement("table");p.style.cssText="border:0;border-collapse:collapse;";for(var T,l=document.createElement("tr"),P=document.createElement("td"),c=function(){return P.cloneNode()},m=function(){var f=c();return f.style.cssText=C+"background:"+M,f},h=function(f){for(var R=f.firstChild,r=0;r<y;r++)f.insertBefore(m(),R),f.appendChild(m())},N=0;N<u;N++){var L=l.cloneNode();p.appendChild(L);for(var D=0;D<u;D++)if(1===s[N*u+D]){var E=(T=void 0,(T=c()).style.cssText=C+"background:"+A,T);L.appendChild(E)}else{var b=m();L.appendChild(b)}t.noBorder||h(L)}t.noBorder||function(f){for(var R=f.firstChild,r=0;r<t.borderSize;r++){for(var e=l.cloneNode(),o=0;o<n;o++){var a=m();e.appendChild(a)}f.appendChild(e),f.insertBefore(e.cloneNode(!0),R)}}(p),t.domElement.innerHTML="",t.domElement.appendChild(p)},getContext:function(s){return s.getContext&&s.getContext("2d")?s.getContext("2d"):(console.log("Browser does not have 2d Canvas support"),!1)},toImage:function(s){if(this.qrc){var u=this.imageTypes[s];if(!u)throw new Error(s+" is not a valid image type ");var t=new Image;return t.src=this.domElement.toDataURL(u),t}}},i.adelta=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],i.vpat=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],i.fmtword=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],i.eccblocks=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],i.glog=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],i.gexp=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],i.N1=3,i.N2=3,i.N3=40,i.N4=10},3496:(z,w,_)=>{_.d(w,{m:()=>n});var i=_(1484),K=_(719),s=_(6168),u=_(2560),t=_(5306);class n{constructor(C,M){this._data=C,this._settings=M,this.space=this._data.space,this.qr_code=(0,s.w)(`${location.origin}${(this._settings.get("app.booking_qr_path")||"workplace/#/explore?space={{id}}").replace("{{id}}",this._data.space?.email)}`)}}n.\u0275fac=function(C){return new(C||n)(u.Y36(i.WI),u.Y36(K.g))},n.\u0275cmp=u.Xpm({type:n,selectors:[["explore-book-qr"]],decls:9,vars:2,consts:function(){let y;return y=$localize`:␟cbd43c9fe40f6bb5fd5497b1436b4dce15539dfb␟381017318285325317:Book - ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[1,"truncate"],y,[1,"flex-1"],["icon","","mat-dialog-close",""],[1,"p-4"],[1,"w-64","h-64","m-auto",3,"src"]]},template:function(C,M){1&C&&(u.TgZ(0,"header")(1,"h2",0),u.SDv(2,1),u.qZA(),u._UZ(3,"div",2),u.TgZ(4,"button",3)(5,"app-icon"),u._uU(6,"close"),u.qZA()()(),u.TgZ(7,"main",4),u._UZ(8,"img",5),u.qZA()),2&C&&(u.xp6(2),u.pQV(null==M.space?null:M.space.name),u.QtT(2),u.xp6(6),u.Q6J("src",M.qr_code,u.LSH))},dependencies:[t.o,i.ZT]})},1718:(z,w,_)=>{_.d(w,{w:()=>D});var i=_(1670),K=_(1484),s=_(9112),u=_(8943),t=_(2560),S=_(9885),n=_(4666),y=_(5306),C=_(5074),M=_(207),A=_(1267),p=_(1708),T=_(2508),l=_(1022);function P(E,b){1&E&&(t.TgZ(0,"button",5)(1,"app-icon"),t._uU(2,"close"),t.qZA()())}function c(E,b){if(1&E&&(t.TgZ(0,"div",11)(1,"label"),t.SDv(2,21),t.qZA(),t.TgZ(3,"div",22),t._uU(4),t.ALo(5,"date"),t.qZA()()),2&E){const f=t.oxw(3);t.xp6(4),t.hij(" ",t.xi3(5,1,null==f.form.controls.date?null:f.form.controls.date.value,"medium")," ")}}function m(E,b){if(1&E&&(t.TgZ(0,"div",23)(1,"label"),t.SDv(2,24),t.qZA(),t._UZ(3,"a-duration-field",25),t.qZA()),2&E){const f=t.oxw(3);t.xp6(3),t.Q6J("time",f.form.value.date)("max",f.max_duration)}}function h(E,b){if(1&E&&(t.TgZ(0,"main",10)(1,"div",11)(2,"label",12),t._uU(3,"Title"),t.TgZ(4,"span"),t._uU(5,"*"),t.qZA(),t._uU(6,":"),t.qZA(),t.TgZ(7,"mat-form-field",13),t._UZ(8,"input",14),t.TgZ(9,"mat-error"),t.SDv(10,15),t.qZA()()(),t.TgZ(11,"div",11)(12,"label"),t.SDv(13,16),t.qZA(),t.TgZ(14,"div",17),t._uU(15),t.qZA()(),t.TgZ(16,"div",18),t.YNc(17,c,6,4,"div",19),t.YNc(18,m,4,2,"div",20),t.qZA()()),2&E){const f=t.oxw(2);t.Q6J("formGroup",f.form),t.xp6(15),t.hij(" ",(null==f.form.controls.resources||null==f.form.controls.resources.value[0]?null:f.form.controls.resources.value[0].display_name)||(null==f.form.controls.resources||null==f.form.controls.resources.value[0]?null:f.form.controls.resources.value[0].name)," "),t.xp6(2),t.Q6J("ngIf",f.form.controls.date),t.xp6(1),t.Q6J("ngIf",f.form.controls.duration)}}function N(E,b){if(1&E){const f=t.EpF();t.ynx(0),t.YNc(1,h,19,4,"main",6),t.TgZ(2,"footer",7)(3,"button",8),t.NdJ("click",function(){t.CHM(f);const r=t.oxw();return t.KtG(r.save())}),t.SDv(4,9),t.qZA()(),t.BQk()}if(2&E){const f=t.oxw();t.xp6(1),t.Q6J("ngIf",f.form)}}function L(E,b){if(1&E&&(t.TgZ(0,"div",26),t._UZ(1,"mat-spinner",27),t.TgZ(2,"p"),t._uU(3),t.ALo(4,"async"),t.qZA()()),2&E){const f=t.oxw();t.xp6(1),t.Q6J("diameter",48),t.xp6(2),t.Oqu(t.lcZ(4,2,f.loading))}}class D{get form(){return this._event_form.form}get max_duration(){return this._settings.get("app.events.max_duration")||240}constructor(b,f,R,r,e){this._data=b,this._settings=f,this._event_form=R,this._dialog_ref=r,this._router=e,this.loading=this._event_form.loading}ngOnInit(){this._event_form.newForm(),this.form.patchValue({resources:[this._data.space],host:(0,s.ar)().email,organiser:(0,s.ar)()})}save(){var b=this;return(0,i.Z)(function*(){yield b._event_form.postForm(),b._settings.app_name.toLowerCase().includes("workplace")?b._router.navigate(["/book","meeting","success"]):(0,s.t5)("Succefully booked room."),b._dialog_ref.close()})()}}D.\u0275fac=function(b){return new(b||D)(t.Y36(K.WI),t.Y36(s.gb),t.Y36(u.M),t.Y36(K.so),t.Y36(S.F0))},D.\u0275cmp=t.Xpm({type:D,selectors:[["explore-booking-modal"]],decls:10,vars:7,consts:function(){let E,b,f,R,r,e,o;return E=$localize`:␟bd532c9813cc0577fcc3ff32640a61afef2bf40a␟6464057252608386690:New Booking`,b=$localize`:␟2fa313c798ad138557539ba3c6a3bfdc426eaaa2␟2367152680379951719: Save `,f=$localize`:␟5cf0071757dd8065e052662e4d191a210c766579␟2997066279074525950:Booking Title`,R=$localize`:␟35a900d9fa8e824539ca4b0d1a10bd2f7f8c1172␟8953173802652113530:Booking title is required`,r=$localize`:␟0f342dcd63b8732a5599eb91ce166b55335dbbc4␟1329943553963489238:Space:`,e=$localize`:␟05fa0bded36de6e73a1fa44838b627349dace044␟6899410641137821757:Date:`,o=$localize`:␟e17a1d75189da843f541f7764f188f2b19a97df2␟4220765745195024064:Duration:`,[E,[1,"flex-1"],["icon","","matRipple","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["load_state",""],["icon","","matRipple","","mat-dialog-close",""],["class","p-4 max-w-[85vw]",3,"formGroup",4,"ngIf"],[1,"flex","justify-center","p-2","border-t","border-gray-200"],["btn","","matRipple","",1,"w-32",3,"click"],b,[1,"p-4","max-w-[85vw]",3,"formGroup"],[1,"flex","flex-col"],["for","title"],["appearance","outline"],["matInput","","name","title","formControlName","title","placeholder",f],R,r,["name","space",1,"sm:mt-4","mb-4"],[1,"flex","sm:space-x-4","flex-wrap"],["class","flex flex-col",4,"ngIf"],["class","flex flex-col w-full sm:w-auto",4,"ngIf"],e,[1,"sm:mt-4","mb-4"],[1,"flex","flex-col","w-full","sm:w-auto"],o,["formControlName","duration",1,"w-full",3,"time","max"],["load","",1,"h-64","flex","flex-col","items-center","justify-center"],[1,"m-4",3,"diameter"]]},template:function(b,f){if(1&b&&(t.TgZ(0,"header")(1,"h2"),t.SDv(2,0),t.qZA(),t._UZ(3,"div",1),t.YNc(4,P,3,0,"button",2),t.ALo(5,"async"),t.qZA(),t.YNc(6,N,5,1,"ng-container",3),t.ALo(7,"async"),t.YNc(8,L,5,4,"ng-template",null,4,t.W1O)),2&b){const R=t.MAs(9);t.xp6(4),t.Q6J("ngIf",!t.lcZ(5,3,f.loading)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(7,5,f.loading))("ngIfElse",R)}},dependencies:[n.O5,y.o,C.KE,C.TO,M.wG,K.ZT,A.Nt,p.Ou,T.Fj,T.JJ,T.JL,T.sg,T.u,l.B,n.Ov,n.uU],styles:["header[_ngcontent-%COMP%]{max-width:calc(100vw + 100%)}[load][_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 2rem)}\n/*# sourceMappingURL=explore-booking-modal.component.ts-angular-inline--60.css.map*/"]})},9275:(z,w,_)=>{_.d(w,{i:()=>T});var i=_(719),K=_(9136),s=_(2560),u=_(4666),t=_(3970);function S(l,P){if(1&l&&s._UZ(0,"img",17),2&l){const c=s.oxw(2);s.Q6J("src",c.space.images[0],s.LSH)}}function n(l,P){1&l&&s._UZ(0,"div",18)}function y(l,P){if(1&l&&(s.TgZ(0,"div",19),s._uU(1),s.qZA()),2&l){const c=s.oxw(2);s.xp6(1),s.hij(" ",c.available_until," ")}}function C(l,P){if(1&l&&(s.TgZ(0,"div",20)(1,"span"),s.SDv(2,21),s.qZA(),s._uU(3),s.qZA()),2&l){const c=s.oxw(2);s.xp6(3),s.AsE("",c.space.capacity," ",1===c.space.capacity?"person":"people"," ")}}function M(l,P){if(1&l&&(s.TgZ(0,"li",24),s._uU(1),s.qZA()),2&l){const c=P.$implicit;s.xp6(1),s.hij(" ",c," ")}}function A(l,P){if(1&l&&(s.TgZ(0,"ul",22),s.YNc(1,M,2,1,"li",23),s.qZA()),2&l){const c=s.oxw(2);s.xp6(1),s.Q6J("ngForOf",c.space.features)}}function p(l,P){if(1&l&&(s.TgZ(0,"div",3),s._UZ(1,"div",4),s.TgZ(2,"div",5)(3,"div",6),s.YNc(4,S,1,1,"img",7),s.YNc(5,n,1,0,"div",8),s.qZA(),s.TgZ(6,"div",9)(7,"div",10),s._uU(8," "),s.SDv(9,11),s._uU(10," "),s.qZA(),s.YNc(11,y,2,1,"div",12),s.qZA(),s.TgZ(12,"div",13)(13,"h4",14),s._uU(14),s.qZA(),s.YNc(15,C,4,2,"div",15),s.YNc(16,A,2,1,"ul",16),s.qZA()()()),2&l){const c=s.oxw();s.ekj("-translate-x-full","end"===c.x_pos)("-translate-y-full","bottom"===c.y_pos),s.Q6J("id",null==c.space?null:c.space.id),s.xp6(3),s.ekj("bg-black",c.space.images[0])("h-32",c.space.images[0])("h-8",!c.space.images[0]),s.xp6(1),s.Q6J("ngIf",c.space.images[0]),s.xp6(1),s.Q6J("ngIf",c.space.images[0]),s.xp6(2),s.Tol("capitalize rounded p-1 px-2 text-light border border-white shadow "+c.status),s.xp6(2),s.pQV(c.status),s.QtT(9),s.xp6(2),s.Q6J("ngIf","not-bookable"!==c.status),s.xp6(3),s.hij(" ",c.space.display_name||c.space.name," "),s.xp6(1),s.Q6J("ngIf",c.space.capacity>=0),s.xp6(1),s.Q6J("ngIf",(null==c.space.features?null:c.space.features.length)>0&&c.show_features)}}class T{get show_features(){return!this._settings.get("app.spaces.hide_features")}constructor(P,c,m){this._details=P,this._settings=c,this._element=m,this.space=this._details.space,this.events=this._details.events,this.status=this._details.status}ngOnInit(){setTimeout(()=>this.updateOffset(),200)}updateOffset(){const P=this._element.nativeElement.getBoundingClientRect();this.x_pos=P.x<document.body.clientWidth/2?"start":"end",this.y_pos=P.y<document.body.clientHeight/2?"top":"bottom"}get available_until(){return""}}T.\u0275fac=function(P){return new(P||T)(s.Y36(K.u),s.Y36(i.g),s.Y36(s.SBq))},T.\u0275cmp=s.Xpm({type:T,selectors:[["explore-space-info"]],decls:4,vars:7,consts:function(){let l,P;return l=$localize`:␟86e6b3a473ea3e05830d2aef91c81199de1b9d33␟3658078071800974217:{VAR_SELECT, select, free {Free } busy {Busy } pending {Pending } reserved {Reserved } other {Not Bookable }}`,l=s.Zx4(l,{VAR_SELECT:"\ufffd0\ufffd"}),P=$localize`:␟36c2a5db33c6cfc9e239e589f975f5492bbb0550␟2292396409867038415:Capacity: `,[["customTooltip","",1,"h-full","w-full","pointer-events-auto","relative","hidden","sm:block",3,"content","backdrop","xPosition","yPosition","hover","delay","mouseenter"],["tooltip",""],["space_tooltip",""],["name","space-info",1,"absolute","rounded","bg-white","dark:bg-neutral-800","top-0","left-0","transform","shadow","pointer-events-none","overflow-hidden",3,"id"],[1,"arrow"],[1,"relative"],[1,"w-full","overflow-hidden","flex","items-center","justify-center","relative","bg-opacity-20"],["class","object-cover min-h-full min-w-full",3,"src",4,"ngIf"],["class","absolute inset-0 bg-black/30",4,"ngIf"],[1,"absolute","top-2","left-2","flex","flex-wrap","text-sm"],["status",""],l,["available-until","",4,"ngIf"],[1,"flex","flex-col","py-4","px-2"],[1,"font-medium","text-xl","mb-2","px-2"],["capacity","","class","text-base px-2 mb-2",4,"ngIf"],["class","flex flex-wrap",4,"ngIf"],[1,"object-cover","min-h-full","min-w-full",3,"src"],[1,"absolute","inset-0","bg-black/30"],["available-until",""],["capacity","",1,"text-base","px-2","mb-2"],P,[1,"flex","flex-wrap"],["class","text-xs px-2 py-1 m-1 rounded-2xl bg-gray-200 dark:bg-neutral-600 font-medium",4,"ngFor","ngForOf"],[1,"text-xs","px-2","py-1","m-1","rounded-2xl","bg-gray-200","dark:bg-neutral-600","font-medium"]]},template:function(P,c){if(1&P&&(s.TgZ(0,"div",0,1),s.NdJ("mouseenter",function(){return c.updateOffset()}),s.qZA(),s.YNc(2,p,17,20,"ng-template",null,2,s.W1O)),2&P){const m=s.MAs(3);s.Q6J("content",m)("backdrop",!1)("xPosition","center")("yPosition","center")("hover",!0)("delay",3e3),s.uIk("id",(null==c.space?null:c.space.map_id)||(null==c.space?null:c.space.id))}},dependencies:[u.sg,u.O5,t.X],styles:["[name=space-info][_ngcontent-%COMP%]{width:16rem}[status][_ngcontent-%COMP%]{background-color:#43a047;font-weight:500}[status].busy[_ngcontent-%COMP%]{background-color:#e53935}[status].pending[_ngcontent-%COMP%]{background-color:#ffb300}[status].not-bookable[_ngcontent-%COMP%]{background-color:#757575}\n/*# sourceMappingURL=explore-space-info.component.ts-angular-inline--59.css.map*/"]})},6888:(z,w,_)=>{_.d(w,{a:()=>P,y:()=>l});var i=_(308),K=_(6942),s=_(9112),u=_(8296),t=_(656),S=_(3902),n=_(6667),y=_(9275),C=_(1718),M=_(3496),A=_(8943),p=_(2560),T=_(1484);const l={free:"#43a047",pending:"#ffb300",reserved:"#e65100",busy:"#e53935","signs-of-life":"#1565c0","not-bookable":"#757575",unknown:"#757575"};class P extends s.cx{constructor(m,h,N,L){super(),this._state=m,this._settings=h,this._event_form=N,this._dialog=L,this._bookings={},this._statuses={},this._bind=this._state.spaces.pipe((0,K.U)(D=>{if(this.unsubWith("b-"),this.unsubWith("s-"),this._statuses={},D?.length){for(const E of D){const b=(0,i.rTZ)(E.id,"Bookings");let f=b.binding("bookings");this.subscription(`b-${E.id}`,f.listen().subscribe(R=>this.handleBookingsChange(D,E,R))),this.subscription(`b-bind-${E.id}`,f.bind()),f=b.binding("status"),this.subscription(`s-${E.id}`,f.listen().subscribe(R=>this.handleStatusChange(D,E,R))),this.subscription(`s-bind-${E.id}`,f.bind())}this.updateActions(D),this.updateHoverElements(D)}})),this.subscription("spaces",this._bind.subscribe())}bookSpace(m){return"free"===this._statuses[m.id]&&m.bookable?(this._event_form.newForm(),this._event_form.form.patchValue({host:(0,s.ar)()?.email,resources:[m]}),this._settings.get("app.events.booking_unavailable")?this._event_form.openEventLinkModal():void this._dialog.open(this._settings.get("app.explore.show_booking_qr")?M.m:C.w,{data:{space:m}})):(0,u.cB)(`${m.display_name||m.name} is unavailable at the current time`)}handleBookingsChange(m,h,N){N&&(this._bookings[h.id]=N.map(L=>new S.y(L)),this.timeout("update_hover_els",()=>this.updateHoverElements(m),100))}handleStatusChange(m,h,N){this._statuses[h.id]=h.bookable?N||"free":"not-bookable",this.timeout("update_statuses",()=>{this.clearTimeout("update_hover_els"),this.updateStatus(m),this.updateHoverElements(m)},100)}updateStatus(m){const h={},N=this._settings.get("app.explore.colors")||{};for(const L of m){const D=this._statuses[L.id]||"not-bookable";h[`#${L.map_id}`]={fill:N[`space-${D}`]||N[`${D}`]||l[`${D}`],opacity:.6}}this._state.setStyles("spaces",h)}updateHoverElements(m){const h=[];for(const N of m)N.map_id&&h.push({location:N.map_id,full_size:!0,no_scale:!0,content:y.i,data:{space:new t.T(N),events:this._bookings[N.id],status:this._statuses[N.id]}});this._state.setFeatures("spaces",h)}updateActions(m){const h=[];for(const N of m)N.map_id&&(h.push({id:N.map_id,action:"click",callback:()=>this.bookSpace(N)}),h.push({id:N.map_id,action:"touchend",callback:()=>this.bookSpace(N)}));this.timeout("set-actions",()=>this._state.setActions("spaces",h),50)}}P.\u0275fac=function(m){return new(m||P)(p.LFG(n.c),p.LFG(s.gb),p.LFG(A.M),p.LFG(T.uw))},P.\u0275prov=p.Yz7({token:P,factory:P.\u0275fac})},6667:(z,w,_)=>{_.d(w,{c:()=>h});var i=_(1670),K=_(308),s=_(4505),u=_(4139),t=_(7716),S=_(9095),n=_(6942),y=_(7418),C=_(9128),M=_(823),A=_(5670),p=_(9151),T=_(9112),l=_(565),P=_(656),c=_(73),m=_(2560);class h extends T.cx{get positions(){return this._positions.getValue()}get active_level(){return this._level.getValue()}constructor(L,D,E){super(),this._org=L,this._spaces=D,this._settings=E,this._level=new s.X(null),this._positions=new s.X({zoom:1,center:{x:.5,y:.5}}),this._styles=new s.X({}),this._features=new s.X({}),this._actions=new s.X({}),this._labels=new s.X({}),this._options=new s.X({disable:["zones","devices"]}),this._message=new s.X(""),this.level=this._level.asObservable(),this.message=this._message.asObservable(),this.spaces=this._level.pipe((0,S.w)(b=>(0,K.vIL)({zone_id:b?.id,limit:50}).pipe((0,n.U)(({data:f})=>f.map(R=>new P.T(R))),(0,y.K)(f=>(0,u.of)([])))),(0,C.d)(1)),this.map_url=this._level.pipe((0,n.U)(b=>(b?b.map_id:"")||"")),this.map_positions=this._positions.asObservable(),this.map_features=(0,t.aj)([this._features,this._options]).pipe((0,M.b)(200),(0,n.U)(([b,f])=>{let R=[];for(const r in b)f.disable?.includes(r)||f.disable_features?.includes(r)||(R=R.concat(b[r]));return R})),this.map_actions=(0,t.aj)([this._actions,this._options]).pipe((0,M.b)(200),(0,n.U)(([b,f])=>{let R=[];for(const r in b)f.disable?.includes(r)||f.disable_actions?.includes(r)||(R=R.concat(b[r]));return R})),this.map_labels=(0,t.aj)([this._labels,this._options]).pipe((0,M.b)(200),(0,n.U)(([b,f])=>{let R=[];for(const r in b)f.disable?.includes(r)||f.disable_labels?.includes(r)||(R=R.concat(b[r]));return R})),this.map_styles=(0,t.aj)([this._styles,this._options]).pipe((0,M.b)(200),(0,n.U)(([b,f])=>{let R={text:{display:"none"}};for(const r in b)f.disable?.includes(r)||f.disable_styles?.includes(r)||(R={...R,...b[r]});return f.disable?.includes("zones")&&(R["#zones"]={display:"none"},R["#Zones"]={display:"none"}),R})),this.options=this._options.asObservable(),this.init()}init(){var L=this;return(0,i.Z)(function*(){yield L._org.initialised.pipe((0,A.P)(D=>D)).toPromise(),L._org.active_building.pipe((0,p.h)(D=>!!D)).subscribe(D=>{const E=L._level.getValue(),b=L._org.levelsForBuilding(D);!b.find(R=>E?.id===R.id)&&b.length&&L.setLevel(b[0].id),L._settings.get("app.explore.disable_actions")&&L.setOptions({disable_actions:L._settings.get("app.explore.disable_actions")}),L._settings.get("app.explore.disable_labels")&&L.setOptions({disable_labels:L._settings.get("app.explore.disable_labels")}),L._settings.get("app.explore.disable_features")&&L.setOptions({disable_features:L._settings.get("app.explore.disable_features")}),L._settings.get("app.explore.disable_styles")&&L.setOptions({disable_styles:L._settings.get("app.explore.disable_styles")})})})()}setOptions(L){const D=this._options.getValue(),E=(0,T.Tw)([...L.disable||D.disable,...this._settings.get("app.explore.disable")||[]]);this._options.next({...this._options.getValue(),...L,disable:E})}reset(){this._styles.next({}),this._features.next({}),this._labels.next({}),this._actions.next({}),this.setPositions(1,{x:.5,y:.5})}setLevel(L){const D=this._org.levelWithID([L]);D&&this._level.next(D)}setStyles(L,D){const E=this._styles.getValue();E[L]=D,this._styles.next(E)}setFeatures(L,D){const E=this._features.getValue();E[L]=D,this._features.next(E)}setActions(L,D){const E=this._actions.getValue();E[L]=D,this._actions.next(E)}setLabels(L,D){const E=this._labels.getValue();E[L]=D,this._labels.next(E)}setPositions(L,D){this._positions.next({zoom:L,center:D})}}h.\u0275fac=function(L){return new(L||h)(m.LFG(l.w),m.LFG(c.s),m.LFG(T.gb))},h.\u0275prov=m.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}}]);
//# sourceMappingURL=default-libs_bookings_src_lib_booking-form_service_ts-libs_bookings_src_lib_lockers_service_t-1d1c56.js.map