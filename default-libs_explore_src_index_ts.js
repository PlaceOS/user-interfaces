(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([["default-libs_explore_src_index_ts"],{2892:(e,t,s)=>{"use strict";function i(e){var t=this;e="object"==typeof e?e:{},t.revision=3,t.imageTypes={bmp:"image/bmp",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpg",png:"image/png","svg+xml":"image/svg+xml",tiff:"image/tiff",webp:"image/webp","x-icon":"image/x-icon"},t.toTable=e.toTable,t.domElement=t.toTable?document.createElement("div"):document.createElement("canvas"),t.url=e.url||"",t.size=e.size||280,t.qrc=!1,t.colorLight=e.colorLight||"#fff",t.colorDark=e.colorDark||"#000",t.ecclevel=e.ecclevel||1,t.noBorder=e.noBorder,t.borderSize=e.borderSize||4;var s,o,n,a,r,l,c,d=[],u=[],p=[],h=[],f=[],_=[],g=function(e,t){var s;e>t&&(s=e,e=t,t=s),s=t,s*=t,s+=t,s>>=1,h[s+=e]=1},m=function(e,t){var s;for(p[e+n*t]=1,s=-2;s<2;s++)p[e+s+n*(t-2)]=1,p[e-2+n*(t+s+1)]=1,p[e+2+n*(t+s)]=1,p[e+s+1+n*(t+2)]=1;for(s=0;s<2;s++)g(e-1,t+s),g(e+1,t-s),g(e-s,t-1),g(e+s,t+1)},b=function(e){for(;e>=255;)e=((e-=255)>>8)+(255&e);return e},v=function(e,t,s,o){var n,a,r,l=i.gexp,c=i.glog;for(n=0;n<o;n++)d[s+n]=0;for(n=0;n<t;n++){if(255!=(r=c[d[e+n]^d[s]]))for(a=1;a<o;a++)d[s+a-1]=d[s+a]^l[b(r+_[o-a])];else for(a=s;a<s+o;a++)d[a]=d[a+1];d[s+o-1]=255==r?0:l[b(r+_[0])]}},x=function(e,t){var s;return e>t&&(s=e,e=t,t=s),s=t,s+=t*t,s>>=1,h[s+=e]},Z=function(e){var t,s,i,o;switch(e){case 0:for(s=0;s<n;s++)for(t=0;t<n;t++)t+s&1||x(t,s)||(p[t+s*n]^=1);break;case 1:for(s=0;s<n;s++)for(t=0;t<n;t++)1&s||x(t,s)||(p[t+s*n]^=1);break;case 2:for(s=0;s<n;s++)for(i=0,t=0;t<n;t++,i++)3==i&&(i=0),i||x(t,s)||(p[t+s*n]^=1);break;case 3:for(o=0,s=0;s<n;s++,o++)for(3==o&&(o=0),i=o,t=0;t<n;t++,i++)3==i&&(i=0),i||x(t,s)||(p[t+s*n]^=1);break;case 4:for(s=0;s<n;s++)for(i=0,o=s>>1&1,t=0;t<n;t++,i++)3==i&&(i=0,o=!o),o||x(t,s)||(p[t+s*n]^=1);break;case 5:for(o=0,s=0;s<n;s++,o++)for(3==o&&(o=0),i=0,t=0;t<n;t++,i++)3==i&&(i=0),(t&s&1)+!(!i|!o)||x(t,s)||(p[t+s*n]^=1);break;case 6:for(o=0,s=0;s<n;s++,o++)for(3==o&&(o=0),i=0,t=0;t<n;t++,i++)3==i&&(i=0),(t&s&1)+(i&&i==o)&1||x(t,s)||(p[t+s*n]^=1);break;case 7:for(o=0,s=0;s<n;s++,o++)for(3==o&&(o=0),i=0,t=0;t<n;t++,i++)3==i&&(i=0),(i&&i==o)+(t+s&1)&1||x(t,s)||(p[t+s*n]^=1)}},k=function(e){var t,s=0;for(t=0;t<=e;t++)f[t]>=5&&(s+=i.N1+f[t]-5);for(t=3;t<e-1;t+=2)f[t-2]==f[t+2]&&f[t+2]==f[t-1]&&f[t-1]==f[t+1]&&3*f[t-1]==f[t]&&(0==f[t-3]||t+3>e||3*f[t-3]>=4*f[t]||3*f[t+3]>=4*f[t])&&(s+=i.N3);return s},w=function(){var e,t,s,o,a,r=0,l=0;for(t=0;t<n-1;t++)for(e=0;e<n-1;e++)(p[e+n*t]&&p[e+1+n*t]&&p[e+n*(t+1)]&&p[e+1+n*(t+1)]||!(p[e+n*t]||p[e+1+n*t]||p[e+n*(t+1)]||p[e+1+n*(t+1)]))&&(r+=i.N2);for(t=0;t<n;t++){for(f[0]=0,s=o=e=0;e<n;e++)(a=p[e+n*t])==o?f[s]++:f[++s]=1,l+=(o=a)?1:-1;r+=k(s)}l<0&&(l=-l);var c=l,d=0;for(c+=c<<2,c<<=1;c>n*n;)c-=n*n,d++;for(r+=d*i.N4,e=0;e<n;e++){for(f[0]=0,s=o=t=0;t<n;t++)(a=p[e+n*t])==o?f[s]++:f[++s]=1,o=a;r+=k(s)}return r};t.genframe=function(e){var t,f,k,y,T,A,q,O,U=i.eccblocks,C=i.gexp,z=i.glog;y=e.length,o=0;do{if(o++,k=4*(s-1)+16*(o-1),a=U[k++],r=U[k++],l=U[k++],c=U[k],y<=(k=l*(a+r)+r-3+(o<=9)))break}while(o<40);for(n=17+4*o,T=l+(l+c)*(a+r)+r,y=0;y<T;y++)u[y]=0;for(d=e.slice(0),y=0;y<n*n;y++)p[y]=0;for(y=0;y<(n*(n+1)+1)/2;y++)h[y]=0;for(y=0;y<3;y++){for(k=0,f=0,1==y&&(k=n-7),2==y&&(f=n-7),p[f+3+n*(k+3)]=1,t=0;t<6;t++)p[f+t+n*k]=1,p[f+n*(k+t+1)]=1,p[f+6+n*(k+t)]=1,p[f+t+1+n*(k+6)]=1;for(t=1;t<5;t++)g(f+t,k+1),g(f+1,k+t+1),g(f+5,k+t),g(f+t+1,k+5);for(t=2;t<4;t++)p[f+t+n*(k+2)]=1,p[f+2+n*(k+t+1)]=1,p[f+4+n*(k+t)]=1,p[f+t+1+n*(k+4)]=1}if(o>1)for(y=i.adelta[o],f=n-7;;){for(t=n-7;t>y-3&&(m(t,f),!(t<y));)t-=y;if(f<=y+9)break;m(6,f-=y),m(f,6)}for(p[8+n*(n-8)]=1,f=0;f<7;f++)g(7,f),g(n-8,f),g(7,f+n-7);for(t=0;t<8;t++)g(t,7),g(t+n-8,7),g(t,n-8);for(t=0;t<9;t++)g(t,8);for(t=0;t<8;t++)g(t+n-8,8),g(8,t);for(f=0;f<7;f++)g(8,f+n-7);for(t=0;t<n-14;t++)1&t?(g(8+t,6),g(6,8+t)):(p[8+t+6*n]=1,p[6+n*(8+t)]=1);if(o>6)for(y=i.vpat[o-7],k=17,t=0;t<6;t++)for(f=0;f<3;f++,k--)1&(k>11?o>>k-12:y>>k)?(p[5-t+n*(2-f+n-11)]=1,p[2-f+n-11+n*(5-t)]=1):(g(5-t,2-f+n-11),g(2-f+n-11,5-t));for(f=0;f<n;f++)for(t=0;t<=f;t++)p[t+n*f]&&g(t,f);for(T=d.length,A=0;A<T;A++)u[A]=d.charCodeAt(A);if(d=u.slice(0),T>=(t=l*(a+r)+r)-2&&(T=t-2,o>9&&T--),A=T,o>9){for(d[A+2]=0,d[A+3]=0;A--;)d[A+3]|=255&(y=d[A])<<4,d[A+2]=y>>4;d[2]|=255&T<<4,d[1]=T>>4,d[0]=64|T>>12}else{for(d[A+1]=0,d[A+2]=0;A--;)d[A+2]|=255&(y=d[A])<<4,d[A+1]=y>>4;d[1]|=255&T<<4,d[0]=64|T>>4}for(A=T+3-(o<10);A<t;)d[A++]=236,d[A++]=17;for(_[0]=1,A=0;A<c;A++){for(_[A+1]=1,q=A;q>0;q--)_[q]=_[q]?_[q-1]^C[b(z[_[q]]+A)]:_[q-1];_[0]=C[b(z[_[0]]+A)]}for(A=0;A<=c;A++)_[A]=z[_[A]];for(k=t,f=0,A=0;A<a;A++)v(f,l,k,c),f+=l,k+=c;for(A=0;A<r;A++)v(f,l+1,k,c),f+=l+1,k+=c;for(f=0,A=0;A<l;A++){for(q=0;q<a;q++)u[f++]=d[A+q*l];for(q=0;q<r;q++)u[f++]=d[a*l+A+q*(l+1)]}for(q=0;q<r;q++)u[f++]=d[a*l+A+q*(l+1)];for(A=0;A<c;A++)for(q=0;q<a+r;q++)u[f++]=d[t+A+q*c];for(d=u,t=f=n-1,k=T=1,O=(l+c)*(a+r)+r,A=0;A<O;A++)for(y=d[A],q=0;q<8;q++,y<<=1){128&y&&(p[t+n*f]=1);do{T?t--:(t++,k?0!=f?f--:(k=!k,6==(t-=2)&&(t--,f=9)):f!=n-1?f++:(k=!k,6==(t-=2)&&(t--,f-=8))),T=!T}while(x(t,f))}for(d=p.slice(0),y=0,f=3e4,k=0;k<8&&(Z(k),(t=w())<f&&(f=t,y=k),7!=y);k++)p=d.slice(0);for(y!=k&&Z(y),f=i.fmtword[y+(s-1<<3)],k=0;k<8;k++,f>>=1)1&f&&(p[n-1-k+8*n]=1,k<6?p[8+n*k]=1:p[8+n*(k+1)]=1);for(k=0;k<7;k++,f>>=1)1&f&&(p[8+n*(n-7+k)]=1,k?p[6-k+8*n]=1:p[7+8*n]=1);return p},t.init=function(){s=t.ecclevel;var e=t.genframe(t.url);t.toTable?t.tableWrite(e,n):t.canvasWrite(e,n)},t.init()}function o(e,t="#fff0",s="#000"){var o;const n=new i({url:e||"Hello",size:360,colorLight:t,colorDark:s,toTable:!1,ecclevel:1,noBorder:!0,borderSize:0});return null===(o=null==n?void 0:n.toImage("svg+xml"))||void 0===o?void 0:o.src}s.d(t,{w:()=>o}),i.prototype={canvasWrite:function(e,t){if(!this.qrc&&(this.qrc=this.getContext(this.domElement),!this.qrc))return this.toTable=!0,this.domElement=document.createElement("div"),void this.tableWrite(e,t);var s=this.size,i=this.qrc;i.lineWidth=1;var o=s;o/=t+10,o=Math.round(o-.5);var n=4;this.noBorder?(i.canvas.width=i.canvas.height=o*t,n=0):i.canvas.width=i.canvas.height=s,i.clearRect(0,0,s,s),i.fillStyle=this.colorLight,i.fillRect(0,0,o*(t+8),o*(t+8)),i.fillStyle=this.colorDark;for(var a=0;a<t;a++)for(var r=0;r<t;r++)e[r*t+a]&&i.fillRect(o*(n+a),o*(n+r),o,o)},tableWrite:function(e,t){var s=this,i=Math.round(this.size/t-3.5)+"px",o=t+(s.noBorder?0:2*s.borderSize),n=s.borderSize,a="width:"+i+";height:"+i+";",r=s.colorLight,l=s.colorDark,c=document.createElement("table");c.style.cssText="border:0;border-collapse:collapse;";for(var d,u=document.createElement("tr"),p=document.createElement("td"),h=function(){return p.cloneNode()},f=function(){var e=h();return e.style.cssText=a+"background:"+r,e},_=function(e){for(var t=e.firstChild,s=0;s<n;s++)e.insertBefore(f(),t),e.appendChild(f())},g=0;g<t;g++){var m=u.cloneNode();c.appendChild(m);for(var b=0;b<t;b++)if(1===e[g*t+b]){var v=(d=void 0,(d=h()).style.cssText=a+"background:"+l,d);m.appendChild(v)}else{var x=f();m.appendChild(x)}s.noBorder||_(m)}s.noBorder||function(e){for(var t=e.firstChild,i=0;i<s.borderSize;i++){for(var n=u.cloneNode(),a=0;a<o;a++){var r=f();n.appendChild(r)}e.appendChild(n),e.insertBefore(n.cloneNode(!0),t)}}(c),s.domElement.innerHTML="",s.domElement.appendChild(c)},getContext:function(e){return e.getContext&&e.getContext("2d")?e.getContext("2d"):(console.log("Browser does not have 2d Canvas support"),!1)},toImage:function(e){if(this.qrc){var t=this.imageTypes[e];if(!t)throw new Error(e+" is not a valid image type ");var s=new Image;return s.src=this.domElement.toDataURL(t),s}}},i.adelta=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],i.vpat=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],i.fmtword=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],i.eccblocks=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],i.glog=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],i.gexp=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],i.N1=3,i.N2=3,i.N3=40,i.N4=10},8870:(e,t,s)=>{"use strict";s.d(t,{Xp:()=>H,ck:()=>_.c,P2:()=>R});var i=s(1511),o=s(6073),n=s(2347),a=s(7521),r=s(2522),l=s(6899),c=s(9604),d=s(4762),u=s(6687),p=s(3530),h=s(2619),f=s(1496),_=s(8284);s(6898),s(6283),s(4786),s(1522);var g=s(6817),m=(s(611),s(4587),s(9996)),b=(s(4266),s(9633)),v=s(4608);s(8239),s(9720);var x=s(5980),Z=s(1548),k=(s(6756),s(9980));s(7806),s(2892);const w={free:"#43a047",pending:"#ffb300",reserved:"#e65100",busy:"#e53935","not-bookable":"#757575",unknown:"#757575"};s(1314);var y=s(8512),T=s(3080),A=s(4689),q=s(7727),O=s(4914),U=s(205),C=s(8125),z=s(3848),P=s(6839),I=s(5087),M=s(1842);const j=["explore-device-info",""];function N(e,t){if(1&e&&(h.TgZ(0,"p",14),h.TgZ(1,"label"),h._uU(2,"Manufacturer:"),h.qZA(),h._uU(3),h.qZA()),2&e){const e=h.oxw(2);h.xp6(3),h.hij(" ",e.manufacturer," ")}}function J(e,t){if(1&e&&(h.TgZ(0,"p",15),h.TgZ(1,"label"),h._uU(2,"OS:"),h.qZA(),h._uU(3),h.qZA()),2&e){const e=h.oxw(2);h.xp6(3),h.hij(" ",e.os,"")}}function L(e,t){if(1&e&&(h.TgZ(0,"p",16),h.TgZ(1,"label"),h._uU(2,"SSID:"),h.qZA(),h._uU(3),h.qZA()),2&e){const e=h.oxw(2);h.xp6(3),h.hij(" ",e.ssid,"")}}function S(e,t){if(1&e&&(h.TgZ(0,"p",17),h.TgZ(1,"label"),h._uU(2,"Username:"),h.qZA(),h._uU(3),h.qZA()),2&e){const e=h.oxw(2);h.xp6(3),h.hij(" ",(null==e.user?null:e.user.name)||(null==e.user?null:e.user.username)||e.username," ")}}function E(e,t){if(1&e&&(h.TgZ(0,"p",18),h.TgZ(1,"label"),h._uU(2,"Type:"),h.qZA(),h._uU(3),h.qZA()),2&e){const e=h.oxw(2);h.xp6(3),h.hij(" ",e.user.type," ")}}function D(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"div",5),h.NdJ("mouseleave",function(){return h.CHM(e),h.oxw().close()}),h._UZ(1,"div",6),h.TgZ(2,"div",7),h.TgZ(3,"p",8),h.TgZ(4,"label"),h._uU(5,"MAC:"),h.qZA(),h._uU(6),h.qZA(),h.TgZ(7,"p"),h.TgZ(8,"label"),h._uU(9,"Accuracy:"),h.qZA(),h._uU(10),h.qZA(),h.TgZ(11,"p"),h.TgZ(12,"label"),h._uU(13,"Last Seen:"),h.qZA(),h._uU(14),h.qZA(),h.YNc(15,N,4,1,"p",9),h.YNc(16,J,4,1,"p",10),h.YNc(17,L,4,1,"p",11),h.YNc(18,S,4,1,"p",12),h.YNc(19,E,4,1,"p",13),h.qZA(),h.qZA()}if(2&e){const e=h.oxw();h.xp6(6),h.hij(" ",e.mac,""),h.xp6(4),h.hij(" ",e.variance,"m"),h.xp6(4),h.hij(" ",e.last_seen,""),h.xp6(1),h.Q6J("ngIf",e.manufacturer),h.xp6(1),h.Q6J("ngIf",e.os),h.xp6(1),h.Q6J("ngIf",e.ssid),h.xp6(1),h.Q6J("ngIf",e.username),h.xp6(1),h.Q6J("ngIf",e.user)}}let X=(()=>{class e extends u.KG{constructor(e,t){var s;super(),this._details=e,this._element=t,this.username="",this.user=this._details.user,this.mac=this._details.mac,this.manufacturer=this._details.manufacturer,this.os=this._details.os,this.ssid=this._details.ssid,this.variance=null===(s=this._details.variance)||void 0===s?void 0:s.toFixed(2),this.diameter=100*this._details.variance,this.bg_color=this._details.bg_color||this.distance_color}get last_seen(){return(0,I.Z)(1e3*(this._details.last_seen||0),{addSuffix:!0})}get distance(){return Math.abs((0,M.Z)(1e3*(this._details.last_seen||0),new Date))}get distance_color(){return this.distance<10?"#43a047":this.distance<20?"#ffb300":"#e53935"}ngOnInit(e=0){e>10||setTimeout(()=>{var t;const s=null===(t=this._element.nativeElement.parentElement)||void 0===t?void 0:t.parentElement;if(!s)return this.ngOnInit(++e);const i=parseInt(s.style.top,10)/100,o=parseInt(s.style.left,10)/100;this.y_pos=i>=.5?"bottom":"top",this.x_pos=o>=.5?"end":"start"},200)}loadUser(){return(0,d.mG)(this,void 0,void 0,function*(){if(this.username)return;const e=(0,g.rTZ)(this._details.system,"LocationServices");if(e){this.username="Loading...";const t=yield e.execute("check_ownership_of",[this.mac]).catch(e=>null);this.username=t&&t.assigned_to?t.assigned_to:""}})}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(n.ui),h.Y36(h.SBq))},e.\u0275cmp=h.Xpm({type:e,selectors:[["","explore-device-info",""]],features:[h.qOj],attrs:j,decls:6,vars:9,consts:[["name","radius",1,"radius","absolute","center","bg-blue-600","bg-opacity-25","border-4","border-dashed","border-blue-600","rounded-full",3,"mouseenter"],["name","dot",1,"h-2","w-2","absolute","center","rounded-full","shadow"],["dot",""],["customTooltip","",1,"absolute","inset-0","pointer-events-auto",3,"content","backdrop","xPosition","yPosition","hover"],["device_tooltip",""],["name","device-info",1,"w-64","rounded","bg-white","p-4","top-0","left-0","shadow","pointer-events-none","mx-2",3,"mouseleave"],[1,"arrow"],[1,"details"],[1,"break-words"],["type","",4,"ngIf"],["os","",4,"ngIf"],["ssid","",4,"ngIf"],["username","",4,"ngIf"],["user","",4,"ngIf"],["type",""],["os",""],["ssid",""],["username",""],["user",""]],template:function(e,t){if(1&e&&(h.TgZ(0,"div",0),h.NdJ("mouseenter",function(){return t.loadUser()}),h.qZA(),h._UZ(1,"div",1,2),h._UZ(3,"div",3),h.YNc(4,D,20,8,"ng-template",null,4,h.W1O)),2&e){const e=h.MAs(5);h.Akn("height: "+t.diameter+"%; width: "+t.diameter+"%;"),h.xp6(1),h.Udp("background-color",t.bg_color),h.xp6(2),h.Q6J("content",e)("backdrop",!1)("xPosition",t.x_pos)("yPosition",t.y_pos)("hover",!0)}},directives:[b.X,i.O5],styles:["[_nghost-%COMP%]{pointer-events:auto}[_nghost-%COMP%] > [name=dot][_ngcontent-%COMP%]{background-color:#616161}[_nghost-%COMP%]:hover > [name=radius][_ngcontent-%COMP%]{opacity:1}[name=radius][_ngcontent-%COMP%]{opacity:0;transition:opacity .2s;pointer-events:none}"]}),e})();function B(e,t){if(1&e&&(h.TgZ(0,"p",8),h._uU(1),h.qZA()),2&e){const e=h.oxw(2);h.xp6(1),h.Oqu(e.user)}}function G(e,t){if(1&e&&(h.TgZ(0,"p",9),h._uU(1),h.ALo(2,"date"),h.ALo(3,"date"),h.qZA()),2&e){const e=h.oxw(2);h.xp6(1),h.AsE(" ",h.xi3(2,2,e.start,"shortTime")," \u2013 ",h.xi3(3,5,e.end,"shortTime")," ")}}function Y(e,t){if(1&e&&(h.TgZ(0,"div",2),h._UZ(1,"div",3),h.TgZ(2,"div",4),h.TgZ(3,"h4",5),h._uU(4),h.qZA(),h.YNc(5,B,2,1,"p",6),h.YNc(6,G,4,8,"p",7),h.qZA(),h.qZA()),2&e){const e=h.oxw();h.Tol("absolute rounded bg-white p-4 top-0 left-0 shadow pointer-events-none "+e.x_pos+" "+e.y_pos),h.Q6J("id",e.map_id),h.xp6(4),h.Oqu(e.map_id),h.xp6(1),h.Q6J("ngIf",e.user),h.xp6(1),h.Q6J("ngIf",e.start)}}let F=(()=>{class e{constructor(e,t){this._details=e,this._element=t,this.map_id=this._details.map_id,this.user=this._details.user,this.start=this._details.start,this.end=this._details.end}ngOnInit(e=0){e>10||setTimeout(()=>{var t;const s=null===(t=this._element.nativeElement.parentElement)||void 0===t?void 0:t.parentElement;if(!s)return this.ngOnInit(++e);const i=parseInt(s.style.top,10)/100,o=parseInt(s.style.left,10)/100;this.y_pos=i>=.5?"bottom":"top",this.x_pos=o>=.5?"right":"left"},200)}get available_until(){return""}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(n.ui),h.Y36(h.SBq))},e.\u0275cmp=h.Xpm({type:e,selectors:[["explore-desk-info"]],decls:3,vars:5,consts:[["customTooltip","",1,"h-full","w-full","pointer-events-auto","relative",3,"content","backdrop","xPosition","yPosition","hover"],["desk_tooltip",""],["name","space-info",3,"id"],[1,"arrow"],[1,"details"],["map-id","",1,"m-0","font-medium"],["user","","class","mt-2 text-sm",4,"ngIf"],["start","","class","mt-1 text-sm",4,"ngIf"],["user","",1,"mt-2","text-sm"],["start","",1,"mt-1","text-sm"]],template:function(e,t){if(1&e&&(h._UZ(0,"div",0),h.YNc(1,Y,7,6,"ng-template",null,1,h.W1O)),2&e){const e=h.MAs(2);h.Q6J("content",e)("backdrop",!1)("xPosition","center")("yPosition","center")("hover",!0)}},directives:[b.X,i.O5],pipes:[i.uU],styles:["[name=space-info][_ngcontent-%COMP%]{width:16rem}[name=status][_ngcontent-%COMP%]{background-color:#43a047;font-weight:500}[name=status].busy[_ngcontent-%COMP%]{background-color:#e53935}[name=status].pending[_ngcontent-%COMP%]{background-color:#ffb300}[name=status].not-bookable[_ngcontent-%COMP%]{background-color:#757575}"]}),e})();var Q=s(6762),V=s(5089);const W=function(){return{standalone:!0}};function K(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"main",5),h.TgZ(1,"div",6),h.TgZ(2,"div",7),h.TgZ(3,"label"),h._uU(4,"Date"),h.qZA(),h.TgZ(5,"a-date-field",8),h._uU(6," Date and time must be in the future "),h.qZA(),h.qZA(),h.qZA(),h.TgZ(7,"div",6),h.TgZ(8,"div",9),h.TgZ(9,"label"),h._uU(10,"Start Time"),h.qZA(),h.TgZ(11,"a-time-field",10),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().form.patchValue({date:t})}),h.qZA(),h.qZA(),h.TgZ(12,"div",9),h.TgZ(13,"label"),h._uU(14,"End Time"),h.qZA(),h._UZ(15,"a-duration-field",11),h.qZA(),h.qZA(),h.qZA()}if(2&e){const e=h.oxw();let t;h.Q6J("formGroup",e.form),h.xp6(5),h.Q6J("to",e.book_until),h.xp6(6),h.Q6J("ngModel",e.form.value.date)("ngModelOptions",h.DdM(8,W)),h.xp6(4),h.Q6J("time",null==(t=e.form.get("date"))?null:t.value)("max",720)("min",60)("step",60)}}let $=(()=>{class e{constructor(e){this._data=e,this.book_until=this._data.until,this.form=new o.cw({date:new o.NI(e.date),duration:new o.NI(e.duration)})}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(v.WI))},e.\u0275cmp=h.Xpm({type:e,selectors:[["set-datetime-modal"]],decls:10,vars:2,consts:[["classs","flex items-center justify-between"],["mat-icon-button","","mat-dialog-close",""],["class","w-[24rem] pt-4",3,"formGroup",4,"ngIf"],[1,"w-full","p-2","border-t","border-gray-200","flex","items-center","justify-center"],["mat-button","",1,"w-32",3,"mat-dialog-close"],[1,"w-[24rem]","pt-4",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","space-x-0","sm:space-x-2","w-[640px]","max-w-[calc(100%-2rem)]","mx-auto"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/4"],["formControlName","date",3,"to"],[1,"flex","flex-col","flex-1","w-full","sm:w-1/3"],[3,"ngModel","ngModelOptions","ngModelChange"],["formControlName","duration",3,"time","max","min","step"]],template:function(e,t){1&e&&(h.TgZ(0,"header",0),h.TgZ(1,"h2"),h._uU(2,"Set date and time"),h.qZA(),h.TgZ(3,"button",1),h.TgZ(4,"app-icon"),h._uU(5,"close"),h.qZA(),h.qZA(),h.qZA(),h.YNc(6,K,16,9,"main",2),h.TgZ(7,"footer",3),h.TgZ(8,"button",4),h._uU(9,"Continue"),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Q6J("ngIf",t.form),h.xp6(2),h.Q6J("mat-dialog-close",t.form.value))},directives:[x.lW,v.ZT,Z.o,i.O5,o.JL,o.sg,Q.Q,o.JJ,o.u,V.N,o.On,k.B],styles:[""]}),e})(),H=(()=>{class e extends u.KG{constructor(e,t,s,i,o){super(),this._state=e,this._org=t,this._settings=s,this._bookings=i,this._dialog=o,this._in_use=new y.X([]),this._options=new y.X({}),this._desks=new y.X([]),this._reserved=new y.X([]),this._statuses={},this._users={},this._poll=new y.X(0),this._desk_bookings=(0,T.aj)([this._state.level,this._poll]).pipe((0,A.w)(([e])=>(0,P.F2)({period_start:(0,O.Z)((0,U.Z)(new Date)),period_end:(0,O.Z)((0,C.Z)(new Date)),type:"desk",zones:e.id}))),this.desk_list=this._state.level.pipe((0,A.w)(e=>(0,g.rlq)(e.id,"desks").pipe((0,m.U)(t=>(t.details instanceof Array?t.details:[]).map(t=>new f.nk(Object.assign(Object.assign({},t),{zone:e})))))),(0,q.K)(e=>[])),this._bind=this._state.level.pipe((0,m.U)(e=>{var t,s;if(this._statuses={},this.unsubWith("lvl"),!e)return;const i=this._org.buildings.find(t=>t.id===e.parent_id);if(!i)return;const o=(null===(t=i.bindings)||void 0===t?void 0:t.area_management)||(null===(s=this._org.organisation.bindings)||void 0===s?void 0:s.area_management);if(!o)return;let n=(0,g.rTZ)(o,"AreaManagement").binding(e.id);this.subscription("lvl-in_use",n.listen().subscribe(e=>this.processBindingChange(e||{},o))),this.subscription("lvl-in_use_bind",n.bind()),n=(0,g.rTZ)(o,"AreaManagement").binding(`${e.id}:desk_ids`),this.subscription("lvl-desks_list",n.listen().subscribe(e=>this._desks.next(e||[]))),this.subscription("lvl-desk_list_bind",n.bind())})),this._state_change=(0,T.aj)([this.desk_list,this._in_use,this._reserved,this._options]).pipe((0,m.U)(([e,t,s])=>{this._statuses={};for(const{id:i,bookable:o}of e){const e=t.some(e=>i===e),n=s.some(e=>i===e);this._statuses[i]=o?e?n?"reserved":"busy":"free":"not-bookable"}this.processDesks(e)})),this.init()}init(){return(0,d.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,p.P)(e=>e)).toPromise(),this.setOptions({enable_booking:!1!==this._settings.get("app.desks.enabled")}),this.subscription("bind",this._bind.subscribe()),this.subscription("changes",this._state_change.subscribe()),this.subscription("desks",this.desk_list.subscribe(e=>this.processDesks(e)))})}startPolling(e=3e4){this.subscription("desks_in_use_bookings",this._desk_bookings.subscribe(e=>this._in_use.next(e.map(e=>e.asset_id)))),this.interval("poll",()=>this._poll.next((new Date).valueOf()),e)}stopPolling(){this.clearInterval("poll")}setOptions(e){this._options.next(Object.assign(Object.assign({},this._options.getValue()),e))}processBindingChange({value:e},t){const s=(e||[]).filter(e=>!["desk","booking"].includes(e.location)),i=(e||[]).filter(e=>"desk"===e.location||"booking"===e.location&&"desk"===e.type);this._in_use.next(i.map(e=>e.map_id||e.asset_id)),this._reserved.next(i.filter(e=>!e.at_location).map(e=>e.map_id||e.asset_id)),this.processDevices(s,t),this.timeout("update",()=>this.updateStatus(),100)}updateStatus(){const e={},t=this._settings.get("app.explore.colors")||{};for(const s in this._statuses)this._statuses[s]&&(e[`#${s}`]={fill:t[`desk-${this._statuses[s]}`]||t[`${this._statuses[s]}`]||w[`${this._statuses[s]}`],opacity:.6});this._state.setStyles("desks",e)}processDevices(e,t){var s,i;const o=[];for(const n of e){const e=n.x/n.map_width,a=n.y/n.map_height;o.push({location:{x:(null===(s=n.coordinates_from)||void 0===s?void 0:s.includes("right"))?1-e:e,y:(null===(i=n.coordinates_from)||void 0===i?void 0:i.includes("bottom"))?1-a:a},content:X,z_index:20,data:Object.assign(Object.assign({},n),{system:t})})}this._state.setFeatures("devices",o)}processDesks(e){const t=[],s=[],i=this._options.getValue();for(const o of e){if(t.push({location:o.id,content:F,full_size:!0,no_scale:!0,data:{map_id:o.name,user:this._users[o.map_id]||o.staff_name,status:this._statuses[o.map_id]},z_index:20}),!o.bookable)continue;const e=()=>(0,d.mG)(this,void 0,void 0,function*(){var e,t;this._bookings.newForm();const{date:s,duration:n}=yield this._setBookingTime(this._bookings.form.value.date,this._bookings.form.value.duration);this._bookings.form.patchValue({asset_id:o.id,asset_name:o.name,date:s,duration:n,map_id:(null==o?void 0:o.map_id)||(null==o?void 0:o.id),description:o.name,user:i.host||(0,u.ar)(),booking_type:"desk",zones:o.zone?[null===(e=o.zone)||void 0===e?void 0:e.parent_id,null===(t=o.zone)||void 0===t?void 0:t.id]:[]}),yield this._bookings.confirmPost(),(0,u.t5)(`Successfull booked desk ${o.name||o.id}`)});s.push({id:o.id,action:"click",callback:e}),s.push({id:o.id,action:"touchend",callback:e})}this._state.setActions("desks",this._options.getValue().enable_booking?s:[]),this._state.setFeatures("desks",t),this.timeout("update",()=>this.updateStatus(),100)}_setBookingTime(e,t){return(0,d.mG)(this,void 0,void 0,function*(){if(this._settings.get("app.desks.allow_time_changes")){const s=(0,C.Z)((0,z.Z)(Date.now(),this._settings.get("app.desks.available_period")||90)),i=this._dialog.open($,{data:{date:e,duration:t,until:s}}),o=yield i.afterClosed().toPromise();if(!o)throw"User cancelled";e=o.date,t=o.duration}return{date:e,duration:t}})}}return e.\u0275fac=function(t){return new(t||e)(h.LFG(_.c),h.LFG(f.w7),h.LFG(u.gb),h.LFG(P.fy),h.LFG(v.uw))},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac}),e})();s(7209),s(7256),s(2571),s(878),s(7701),s(4019),s(8303),s(5205),s(84);let R=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[i.ez,n.Kk,o.u5,o.UX,a.rP,r.U8,l.eL,c.W9]]}),e})()},8284:(e,t,s)=>{"use strict";s.d(t,{c:()=>f});var i=s(4762),o=s(8512),n=s(3080),a=s(9996),r=s(7701),l=s(3530),c=s(3835),d=s(6687),u=s(2619),p=s(1496),h=s(7209);let f=(()=>{class e extends d.KG{constructor(e,t,s){super(),this._org=e,this._spaces=t,this._settings=s,this._level=new o.X(null),this._positions=new o.X({zoom:1,center:{x:.5,y:.5}}),this._styles=new o.X({}),this._features=new o.X({}),this._actions=new o.X({}),this._labels=new o.X({}),this._options=new o.X({disable:["zones","devices"]}),this._message=new o.X(""),this.level=this._level.asObservable(),this.message=this._message.asObservable(),this.spaces=(0,n.aj)([this._level,this._spaces.list]).pipe((0,a.U)(([e,t])=>t.filter(t=>t.zones.includes(null==e?void 0:e.id)))),this.map_url=this._level.pipe((0,a.U)(e=>(e?e.map_id:"")||"")),this.map_positions=this._positions.asObservable(),this.map_features=(0,n.aj)([this._features,this._options]).pipe((0,r.b)(200),(0,a.U)(([e,t])=>{var s,i;let o=[];for(const n in e)(null===(s=t.disable)||void 0===s?void 0:s.includes(n))||(null===(i=t.disable_features)||void 0===i?void 0:i.includes(n))||(o=o.concat(e[n]));return o})),this.map_actions=(0,n.aj)([this._actions,this._options]).pipe((0,r.b)(200),(0,a.U)(([e,t])=>{var s,i;let o=[];for(const n in e)(null===(s=t.disable)||void 0===s?void 0:s.includes(n))||(null===(i=t.disable_actions)||void 0===i?void 0:i.includes(n))||(o=o.concat(e[n]));return o})),this.map_labels=(0,n.aj)([this._labels,this._options]).pipe((0,r.b)(200),(0,a.U)(([e,t])=>{var s,i;let o=[];for(const n in e)(null===(s=t.disable)||void 0===s?void 0:s.includes(n))||(null===(i=t.disable_labels)||void 0===i?void 0:i.includes(n))||(o=o.concat(e[n]));return o})),this.map_styles=(0,n.aj)([this._styles,this._options]).pipe((0,r.b)(200),(0,a.U)(([e,t])=>{var s,i,o;let n={text:{display:"none"}};for(const a in e)(null===(s=t.disable)||void 0===s?void 0:s.includes(a))||(null===(i=t.disable_styles)||void 0===i?void 0:i.includes(a))||(n=Object.assign(Object.assign({},n),e[a]));return(null===(o=t.disable)||void 0===o?void 0:o.includes("zones"))&&(n["#zones"]={display:"none"},n["#Zones"]={display:"none"}),n})),this.options=this._options.asObservable(),this.init()}get positions(){return this._positions.getValue()}get active_level(){return this._level.getValue()}init(){return(0,i.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,l.P)(e=>e)).toPromise(),this._org.active_building.pipe((0,c.h)(e=>!!e)).subscribe(e=>{const t=this._level.getValue(),s=this._org.levelsForBuilding(e);!s.find(e=>(null==t?void 0:t.id)===e.id)&&s.length&&this.setLevel(s[0].id),this._settings.get("app.explore.disable_actions")&&this.setOptions({disable_actions:this._settings.get("app.explore.disable_actions")}),this._settings.get("app.explore.disable_labels")&&this.setOptions({disable_labels:this._settings.get("app.explore.disable_labels")}),this._settings.get("app.explore.disable_features")&&this.setOptions({disable_features:this._settings.get("app.explore.disable_features")}),this._settings.get("app.explore.disable_styles")&&this.setOptions({disable_styles:this._settings.get("app.explore.disable_styles")})})})}setOptions(e){const t=this._options.getValue(),s=(0,d.Tw)([...e.disable||t.disable,...this._settings.get("app.explore.disable")||[]]);this._options.next(Object.assign(Object.assign(Object.assign({},this._options.getValue()),e),{disable:s}))}setLevel(e){const t=this._org.levelWithID([e]);t&&this._level.next(t)}setStyles(e,t){const s=this._styles.getValue();s[e]=t,this._styles.next(s)}setFeatures(e,t){const s=this._features.getValue();s[e]=t,this._features.next(s)}setActions(e,t){const s=this._actions.getValue();s[e]=t,this._actions.next(s)}setLabels(e,t){const s=this._labels.getValue();s[e]=t,this._labels.next(s)}setPositions(e,t){this._positions.next({zoom:e,center:t})}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(p.w7),u.LFG(h.sK),u.LFG(d.gb))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},2571:(e,t,s)=>{"use strict";s.d(t,{s:()=>r});var i=s(2619),o=s(8284),n=s(5980),a=s(1548);let r=(()=>{class e{constructor(e){this._state=e,this.zoomIn=()=>this._state.setPositions(Math.min(10,1.2*this._state.positions.zoom),this._state.positions.center),this.zoomOut=()=>this._state.setPositions(Math.max(1,this._state.positions.zoom*(1/1.2)),this._state.positions.center),this.reset=()=>this._state.setPositions(1,{x:.5,y:.5})}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(o.c))},e.\u0275cmp=i.Xpm({type:e,selectors:[["explore-zoom-controls"]],decls:9,vars:0,consts:[["z-in","","mat-icon-button","",1,"bg-white",3,"click"],["z-out","","mat-icon-button","",1,"bg-white",3,"click"],["reset","","mat-icon-button","",1,"bg-white",3,"click"]],template:function(e,t){1&e&&(i.TgZ(0,"button",0),i.NdJ("click",function(){return t.zoomIn()}),i.TgZ(1,"app-icon"),i._uU(2,"add"),i.qZA(),i.qZA(),i.TgZ(3,"button",1),i.NdJ("click",function(){return t.zoomOut()}),i.TgZ(4,"app-icon"),i._uU(5,"remove"),i.qZA(),i.qZA(),i.TgZ(6,"button",2),i.NdJ("click",function(){return t.reset()}),i.TgZ(7,"app-icon"),i._uU(8,"autorenew"),i.qZA(),i.qZA())},directives:[n.lW,a.o],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding:.5rem}button[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:0}button[_ngcontent-%COMP%]:first-child{border-radius:.25rem .25rem 0 0;border-bottom:none}button[_ngcontent-%COMP%]:last-child{border-radius:0 0 .25rem .25rem;border-top:none}"]}),e})()}}]);
//# sourceMappingURL=default-libs_explore_src_index_ts.js.map