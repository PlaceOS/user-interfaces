"use strict";(self.webpackChunkconcierge=self.webpackChunkconcierge||[]).push([["apps_concierge_src_app_asset-manager_asset-manager_module_ts"],{1436:(Yi,ee,l)=>{l.r(ee),l.d(ee,{AppAssetManangerModule:()=>Hi});var p=l(6575),f=l(2649),V=l(727),te=l(8173),Ee=l(3517),Pe=l(498),e=l(9039);let Re=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[Pe.vT]})}return n})();var b=l(257),Je=l(6515),Qe=l(2484);l(2501);let G=(()=>{class n{constructor(){this.changes=new Qe.xQ,this.optionalLabel="Optional",this.completedLabel="Completed",this.editableLabel="Editable"}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Xe={provide:G,deps:[[new e.FiY,new e.tp0,G]],useFactory:function We(n){return n||new G}};let nt=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({providers:[Xe,b.rD],imports:[b.BQ,p.ez,Ee.eL,Re,Je.Ps,b.si,b.BQ]})}return n})();var it=l(7910),_=l(1670),D=l(8466),u=l(7109),ot=l(7049),se=l(7016),st=l(4512),F=l(7343),L=l(462),A=l(8159),rt=l(9681),M=l(6520),re=l(5746),U=l(680),at=l(5933),y=l(7422),K=l(5046),lt=l(5083),ct=l(8175),z=l(6939),H=l(7627),m=l(6285),E=l(7298),I=l(3121),C=l(7401),k=l(4888);function pt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7),e._uU(2),e.qZA(),e.TgZ(3,"button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,s=e.oxw();return e.KtG(s.edit(o))}),e.TgZ(4,"app-icon"),e._uU(5,"edit"),e.qZA()(),e.TgZ(6,"button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,s=e.oxw();return e.KtG(s.remove(o))}),e.TgZ(7,"app-icon"),e._uU(8,"delete"),e.qZA()()()}if(2&n){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.name)}}function dt(n,r){if(1&n&&(e.ynx(0),e.YNc(1,pt,9,1,"div",5),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.id)}}let ae=(()=>{class n{constructor(t,i){var o=this;this._data=t,this._dialog_ref=i,this.changed=new e.vpe,this.list=this._data.list,this.edit=this._data.edit,this.remove=function(){var s=(0,_.Z)(function*(a){yield(0,m.Qd)(a.id).toPromise(),o.changed.emit()});return function(a){return s.apply(this,arguments)}}()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(C.WI),e.Y36(C.so))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-category-management-modal"]],decls:14,vars:3,consts:[["btn","","icon","","matRipple","","mat-dialog-close",""],[1,"overflow-y-auto","min-w-[20rem]","divide-y","divide-base-200","max-h-[65vh]"],["btn","","matRipple","",1,"flex","items-center","justify-center","space-x-2","w-[calc(100%-1rem)]","m-2",3,"click"],[1,"truncate"],[4,"ngFor","ngForOf"],["class","flex items-center space-x-2 hover:bg-base-200:bg-base-300 p-2",4,"ngIf"],[1,"flex","items-center","space-x-2","hover:bg-base-200:bg-base-300","p-2"],[1,"flex-1","truncate"],["btn","","icon","","matRipple","",3,"click"]],template:function(i,o){1&i&&(e.TgZ(0,"header")(1,"h2"),e._uU(2,"Manage Categories"),e.qZA(),e.TgZ(3,"button",0)(4,"app-icon"),e._uU(5,"close"),e.qZA()()(),e.TgZ(6,"main",1)(7,"button",2),e.NdJ("click",function(){return o.edit()}),e.TgZ(8,"div",3),e._uU(9,"New Category"),e.qZA(),e.TgZ(10,"app-icon"),e._uU(11,"add"),e.qZA()(),e.YNc(12,dt,2,1,"ng-container",4),e.ALo(13,"async"),e.qZA()),2&i&&(e.xp6(12),e.Q6J("ngForOf",e.lcZ(13,1,o.list)))},dependencies:[p.sg,p.O5,C.ZT,b.wG,k.o,p.Ov]})}return n})();var T=l(1268),O=l(9674),Y=l(162),N=l(3910),g=l(8849);function ut(n,r){1&n&&(e.TgZ(0,"button",6)(1,"app-icon"),e._uU(2,"close"),e.qZA()())}function _t(n,r){if(1&n&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function mt(n,r){if(1&n&&(e.TgZ(0,"main",7)(1,"div",8)(2,"label",9),e._uU(3,"Name"),e.TgZ(4,"span"),e._uU(5,"*"),e.qZA()(),e.TgZ(6,"mat-form-field",10),e._UZ(7,"input",11),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()(),e.TgZ(10,"div",8)(11,"label",9),e._uU(12,"Parent Category"),e.qZA(),e.TgZ(13,"mat-form-field",10)(14,"mat-select",12),e.ALo(15,"async"),e.YNc(16,_t,2,2,"mat-option",13),e.ALo(17,"async"),e.qZA()()()()),2&n){const t=e.oxw();let i;e.Q6J("formGroup",t.form),e.xp6(14),e.Q6J("disabled",!(null!=(i=e.lcZ(15,3,t.categories))&&i.length)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(17,5,t.categories))}}function gt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"footer",15)(1,"a",16),e._uU(2,"Cancel"),e.qZA(),e.TgZ(3,"button",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e._uU(4,"Save"),e.qZA()()}}function ft(n,r){1&n&&(e.TgZ(0,"div",18),e._UZ(1,"mat-spinner",19),e.TgZ(2,"p",20),e._uU(3,"Saving Category..."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("diameter",32))}let $=(()=>{class n{constructor(t,i,o){this._state=i,this._dialog_ref=o,this.loading=!1,this.form=(0,m.rx)(),this.categories=this._state.categories.pipe((0,y.U)(s=>s.filter(a=>a.parent_category_id!==this.form.value.id))),t?.category&&this.form.patchValue(t.category)}save(){var t=this;return(0,_.Z)(function*(){if(!t.form.valid)return;t.loading=!0,t._dialog_ref.disableClose=!0;const i=t.form.value,o=yield(0,m.Di)(i).toPromise().catch(s=>{throw t.loading=!1,t._dialog_ref.disableClose=!1,(0,u.cB)(`Error saving category: ${s.message}`),s});t.form.reset(),t.loading=!1,t._dialog_ref.close(o)})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(C.WI),e.Y36(Z),e.Y36(C.so))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-category-form"]],decls:8,vars:5,consts:[[1,"flex","items-center","p-2"],[1,"text-center","text-xl","font-medium"],["btn","","icon","","matRipple","","mat-dialog-close","",4,"ngIf"],["class","flex-1 h-1/2 overflow-auto p-2 w-[20rem] max-w-[80vw]",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex justify-end space-x-2 p-2 border-t border-base-200",4,"ngIf"],["load_state",""],["btn","","icon","","matRipple","","mat-dialog-close",""],[1,"flex-1","h-1/2","overflow-auto","p-2","w-[20rem]","max-w-[80vw]",3,"formGroup"],[1,"flex","flex-col","space-y-2"],["for","name"],["appearance","outline"],["matInput","","name","name","placeholder","Category Name","formControlName","name"],["formControlName","parent_category_id","placeholder","No Parent",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"flex","justify-end","space-x-2","p-2","border-t","border-base-200"],["btn","","matRipple","","mat-dialog-close","",1,"w-32","inverse"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","justify-center","p-8"],[3,"diameter"],[1,"mt-4"]],template:function(i,o){if(1&i&&(e.TgZ(0,"header",0)(1,"h2",1),e._uU(2),e.qZA(),e.YNc(3,ut,3,0,"button",2),e.qZA(),e.YNc(4,mt,18,7,"main",3)(5,gt,5,0,"footer",4)(6,ft,4,1,"ng-template",null,5,e.W1O)),2&i){const s=e.MAs(7);e.xp6(2),e.hij(" ",o.form.value.id?"Edit":"Add"," Category "),e.xp6(1),e.Q6J("ngIf",!o.loading),e.xp6(1),e.Q6J("ngIf",!o.loading)("ngIfElse",s),e.xp6(1),e.Q6J("ngIf",!o.loading)}},dependencies:[p.sg,p.O5,T.KE,T.TO,O.Nt,Y.gD,b.ey,N.Ou,C.ZT,b.wG,g.Fj,g.JJ,g.JL,g.sg,g.u,k.o,p.Ov]})}return n})();var P=l(1862);let Z=(()=>{class n extends u.cx{get form(){return this._form}get is_new_ui(){return location.hash.includes("new")||location.pathname.includes("new")}get base_route(){return this.is_new_ui?"/book/assets/new":"/book/assets"}constructor(t,i,o){super(),this._spaces=t,this._org=i,this._dialog=o,this._options=new L.X({view:"grid"}),this._change=new L.X(0),this._poll=new L.X(0),this._extra_assets=new L.X([]),this._form=(0,m.PG)(),this._loading=new L.X(!1),this.loading=this._loading.asObservable(),this.options=this._options.asObservable(),this.extra_assets=this._extra_assets.asObservable(),this.products=(0,A.aj)([this._change,this._org.active_building]).pipe((0,M.w)(()=>(this._loading.next(!0),(0,m.AS)({zone_id:this._org.building?.id}))),(0,re.b)(s=>this._loading.next(!1)),(0,U.d)(1)),this.purchase_orders=this._change.pipe((0,M.w)(()=>(this._loading.next(!0),(0,m.TB)())),(0,re.b)(()=>this._loading.next(!1)),(0,U.d)(1)),this.requests=(0,A.aj)([this._options,this._org.active_building,this._poll,this._change,this._spaces.initialised]).pipe((0,at.b)(200),(0,M.w)(([{date:s},a])=>{const c=(0,se.Z)(s||Date.now()).valueOf(),d=(0,st.Z)(s||Date.now()).valueOf();return(0,D.F2)({zones:a?.id,period_start:(0,F.Z)(c),period_end:(0,F.Z)(d),type:"asset-request"}).pipe((0,y.U)(x=>x.map(v=>new D.$N({...v,extension_data:{...v.extension_data,space:this._spaces.find(v.extension_data.space_id)}})).filter(v=>{const w=v.extension_data.request||{deliver_at_time:c},q=v.linked_event?.date_end||1e3*v.linked_event?.event_end||1e3*v.linked_bookings[0]?.booking_end||d;return w?.deliver_at_time>=c&&w?.deliver_at_time<d&&w?.deliver_at_time<q})))}),(0,U.d)(1)),this.filtered_requests=(0,A.aj)([this.requests,this._options]).pipe((0,y.U)(([s,a])=>{const c=(a.search||"").toLowerCase();return c?s.filter(d=>d.user_name.toLowerCase().includes(c)||d.title.toLowerCase().includes(c)||d.extension_data.location_name?.toLowerCase().includes(c)||d.extension_data.assets?.find(x=>x.name.toLowerCase().includes(c))||d.status.includes(c)||d.extension_data.tracking?.includes(c)):s})),this.categories=(0,A.aj)([this._options,this._change]).pipe((0,M.w)(()=>(0,m.vD)()),(0,y.U)(s=>[new m.fd({id:"",name:"Uncategorised"}),...s]),(0,U.d)(1)),this.active_product=(0,A.aj)([this._options,this._org.active_building,this._change]).pipe((0,K.h)(([{active_item:s}])=>!!s),(0,y.U)(([s,a])=>[s.active_item,a]),(0,lt.x)(),(0,M.w)(([s])=>(0,m.ue)(s,{zone_id:this._org.building.id})),(0,U.d)(1)),this.active_product_requests=this.active_product.pipe((0,M.w)(s=>this.requests.pipe((0,y.U)(a=>a.filter(c=>s.assets.find(d=>d.id===c.asset_id))))),(0,y.U)(s=>s.filter(a=>"declined"!==a.status))),this.filtered_products=(0,A.aj)([this.products,this._options]).pipe((0,y.U)(([s,a])=>a.search?s.filter(c=>c.name.toLowerCase().includes(a.search.toLowerCase())):s)),this.product_mapping=(0,A.aj)([this.filtered_products,this.categories]).pipe((0,y.U)(([s,a])=>{const c={_count:s.length};s.forEach(x=>x.category_id=a.find(v=>v.id===x.category_id)?x.category_id:"");const d=(0,u.Tw)(s.map(x=>x.category_id));for(const x of d)c[x]=s.filter(v=>v.category_id===x);return c})),this.settings=(0,A.aj)([this._org.active_building,this._change]).pipe((0,K.h)(([s])=>!!s),(0,M.w)(([s])=>(0,E.rlq)(s.id,"assets-settings").pipe((0,ct.K)(a=>(0,rt.of)({})))),(0,y.U)(s=>s.details||{}),(0,U.d)(1)),this.availability=this.settings.pipe((0,y.U)(s=>s.disabled_rooms||[]))}startPolling(t=15e3){return this.interval("polling",()=>this._poll.next(Date.now()),t),()=>this.stopPolling()}stopPolling(){this.clearInterval("polling")}resetForm(){this._form=(0,m.PG)()}manageCategories(){const t=this._dialog.open(ae,{data:{list:this.categories,edit:i=>this.editCategory(i)}});this.subscription("category_modal",t.componentInstance.changed.subscribe(()=>this._change.next(Date.now()))),t.afterClosed().subscribe(()=>this.unsub("category_modal"))}editCategory(t={}){var i=this;return(0,_.Z)(function*(){const s=yield i._dialog.open($,{data:{category:t}}).afterClosed().toPromise();return s?(i._change.next(Date.now()),s):null})()}setExtraAssets(t){this._extra_assets.next(t)}setOptions(t){this._options.next({...this._options.getValue(),...t})}postChange(){this.timeout("change",()=>this._change.next(Date.now()),1e3)}setStatus(t,i){var o=this;return(0,_.Z)(function*(){let s=t;return"declined"===i?s=yield(0,D.FP)(t.id).toPromise():"approved"===i&&(s=yield(0,D.jT)(t.id).toPromise()),o._change.next(Date.now()),s})()}setTracking(t,i){var o=this;return(0,_.Z)(function*(){const s=yield(0,D.Wp)(t.id,{...t.toJSON(),extension_data:{...t.extension_data,tracking:i}}).toPromise();return o._change.next(Date.now()),s})()}deleteActiveProduct(){var t=this;return(0,_.Z)(function*(){const i=yield t.active_product.pipe((0,z.q)(1)).toPromise();i?.id&&(yield(0,m.RE)(i.id).toPromise(),t._change.next(Date.now()),(0,u.t5)("Successfully deleted asset"))})()}postForm(){var t=this;return(0,_.Z)(function*(){if(!t.form?.valid)return;const i=t.form.value,o={...i},s=["other_data","id","name","quantity","category","purchase_date","brand","images"];for(const c of s)delete o[c];i.other_data=(0,E.sWL)(o,[void 0,null,""]);const a=yield(0,m.U)(i).toPromise();return t._change.next(Date.now()),(0,u.t5)(`Successfully ${i.id?"updated":"created"} asset`),t.resetForm(),a.id})()}editConfig(){var t=this;return(0,_.Z)(function*(){const i=yield t.getConfig(t._org.building.id),o=yield t.products.pipe((0,z.q)(1)).toPromise(),s=(0,u.Tw)((0,u.xH)(o.map(d=>[d.name]))),a=t._dialog.open(P.uX,{data:{resource_name:"Assets",config:i,types:s,require_notes:!1}}),c=yield Promise.race([a.componentInstance.event.pipe((0,H.P)(d=>"done"===d.reason)).toPromise(),a.afterClosed().toPromise()]);"done"===c?.reason&&t.updateConfig(t._org.building.id,c.metadata).then(()=>a.close(),()=>a.componentInstance.loading=!1)})()}getConfig(t=this._org.building.id){return(0,_.Z)(function*(){const i=(yield(0,E.rlq)(t,"assets_config").toPromise()).details;return i instanceof Array?i:[]})()}updateConfig(t,i){return(0,E.Ymr)(t,{id:t,name:"assets_config",details:i,description:`Assets config for ${t}`}).toPromise()}saveSettings(t){var i=this;return(0,_.Z)(function*(){const o=yield i.settings.pipe((0,z.q)(1)).toPromise(),s=yield(0,E.Ymr)(i._org.building.id,{id:i._org.building.id,name:"assets-settings",details:{...o,...t},description:`Assets settings for ${i._org.building.id}`}).toPromise();return i._change.next(Date.now()),s})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(ot.sK),e.LFG(I.w7),e.LFG(C.uw))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var R=l(989),ht=l(702);const xt=n=>[n,"manage","group"];function vt(n,r){if(1&n&&(e.TgZ(0,"a",10),e._uU(1," Add Product "),e.qZA()),2&n){const t=e.oxw();e.Q6J("routerLink",e.VKq(1,xt,t.base_route))}}const bt=n=>[n,"manage","purchase-order"];function yt(n,r){if(1&n&&(e.TgZ(0,"a",10),e._uU(1," Add Purchase Order "),e.qZA()),2&n){const t=e.oxw();e.Q6J("routerLink",e.VKq(1,bt,t.base_route))}}function Tt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-button-toggle-group",11),e.NdJ("ngModelChange",function(o){e.CHM(t);const s=e.oxw();return e.KtG(s.setOptions({view:o}))}),e.ALo(1,"async"),e.TgZ(2,"mat-button-toggle",12)(3,"div",13)(4,"app-icon"),e._uU(5,"view_module"),e.qZA()()(),e.TgZ(6,"mat-button-toggle",14)(7,"div",13)(8,"app-icon"),e._uU(9,"view_list"),e.qZA()()()()}if(2&n){const t=e.oxw();let i;e.Q6J("ngModel",null==(i=e.lcZ(1,1,t.options))?null:i.view)}}function Zt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.editConfig())}),e.TgZ(1,"app-icon"),e._uU(2,"menu_book"),e.qZA()()}}function At(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.setRoomAvailability())}),e.TgZ(1,"app-icon"),e._uU(2,"event_available"),e.qZA()()}}function Ct(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.manageCategories())}),e.TgZ(1,"app-icon"),e._uU(2,"list_alt"),e.qZA()()}}let le=(()=>{class n extends u.cx{get base_route(){return this._state.base_route}constructor(t,i){super(),this._state=t,this._dialog=i,this.active="",this.options=this._state.options,this.setOptions=o=>this._state.setOptions(o),this.manageCategories=()=>this._state.manageCategories(),this.editConfig=()=>this._state.editConfig()}setRoomAvailability(){var t=this;return(0,_.Z)(function*(){const i=t._dialog.open(P.z4,{data:{type:"Assets",disabled_rooms:yield t._state.availability.pipe((0,z.q)(1)).toPromise()}});t.subscription("room-availability",i.componentInstance.change.subscribe(function(){var o=(0,_.Z)(function*(s){yield t._state.saveSettings({disabled_rooms:s}).catch(),i.componentInstance.loading=!1});return function(s){return o.apply(this,arguments)}}()))})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z),e.Y36(C.uw))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-manager-topbar"]],inputs:{active:"active"},features:[e.qOj],decls:13,vars:9,consts:[[1,"w-full","px-4","py-2","bg-base-100","flex","items-center","space-x-4"],["btn","","matRipple","","class","secondary",3,"routerLink",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],[1,"flex-1"],["btn","","icon","","matRipple","","class","border border-base-200","matTooltip","Edit Config",3,"click",4,"ngIf"],["btn","","icon","","matRipple","","class","border border-base-200","matTooltip","Room Availability",3,"click",4,"ngIf"],["btn","","icon","","matRipple","","class","border border-base-200","matTooltip","Manage Categories",3,"click",4,"ngIf"],["appearance","outline",1,"h-[3.25rem]"],["matPrefix","",1,"text-2xl","relative","top-1","-left-1"],["matInput","","placeholder","Search products and requests",3,"ngModel","ngModelChange"],["btn","","matRipple","",1,"secondary",3,"routerLink"],[3,"ngModel","ngModelChange"],["value","grid"],[1,"flex","items-center","justify-center","h-10","w-6","text-xl"],["value","list"],["btn","","icon","","matRipple","","matTooltip","Edit Config",1,"border","border-base-200",3,"click"],["btn","","icon","","matRipple","","matTooltip","Room Availability",1,"border","border-base-200",3,"click"],["btn","","icon","","matRipple","","matTooltip","Manage Categories",1,"border","border-base-200",3,"click"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,vt,2,3,"a",1)(2,yt,2,3,"a",1)(3,Tt,10,3,"mat-button-toggle-group",2),e._UZ(4,"div",3),e.YNc(5,Zt,3,0,"button",4)(6,At,3,0,"button",5)(7,Ct,3,0,"button",6),e.TgZ(8,"mat-form-field",7)(9,"app-icon",8),e._uU(10," search "),e.qZA(),e.TgZ(11,"input",9),e.NdJ("ngModelChange",function(a){return o.setOptions({search:a})}),e.ALo(12,"async"),e.qZA()()()),2&i){let s;e.xp6(1),e.Q6J("ngIf","items"===o.active),e.xp6(1),e.Q6J("ngIf","purchase-orders"===o.active),e.xp6(1),e.Q6J("ngIf","items"===o.active),e.xp6(2),e.Q6J("ngIf","items"===o.active),e.xp6(1),e.Q6J("ngIf","items"===o.active),e.xp6(1),e.Q6J("ngIf","items"===o.active),e.xp6(4),e.Q6J("ngModel",null==(s=e.lcZ(12,7,o.options))?null:s.search)}},dependencies:[p.O5,T.KE,T.qo,O.Nt,ht.gM,b.wG,g.Fj,g.JJ,g.On,k.o,V.A9,V.Yi,f.rH,p.Ov]})}return n})();const wt=n=>[n,"list","requests"];function Mt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.active="requests")}),e._uU(1," Requests "),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("routerLink",e.VKq(3,wt,t.base_route))("routerLinkActive","active")("active","requests"===t.active)}}const St=n=>[n,"list","items"],qt=n=>[n,"list","purchase-orders"];function It(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"nav",4),e.YNc(1,Mt,2,5,"a",5),e.TgZ(2,"a",6),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.active="items")}),e._uU(3," Products "),e.qZA(),e.TgZ(4,"a",6),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.active="purchase-orders")}),e._uU(5," Purchase Orders "),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.is_new),e.xp6(1),e.Q6J("routerLink",e.VKq(5,St,t.base_route))("active","items"===t.active),e.xp6(2),e.Q6J("routerLink",e.VKq(7,qt,t.base_route))("active","purchase-orders"===t.active)}}let ce=(()=>{class n extends u.cx{get base_route(){return this._state.base_route}constructor(t,i){super(),this._router=t,this._state=i,this.active="requests",this.is_new=!1}ngOnInit(){this.is_new=this._router.url.includes("new"),this.active=this._router.url.includes("requests")?"requests":this._router.url.includes("items")?"items":"purchase-orders",this.subscription("router.events",this._router.events.subscribe(t=>{t instanceof f.m2&&(this.is_new=this._router.url.includes("new"),this.active=this._router.url.includes("requests")?"requests":this._router.url.includes("items")?"items":"purchase-orders")}))}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(f.F0),e.Y36(Z))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-listing"]],features:[e.qOj],decls:5,vars:2,consts:[[3,"active"],[1,"flex","flex-col","flex-1","h-1/2","w-full","px-4"],["mat-tab-nav-bar","",4,"ngIf"],[1,"flex-1","h-1/2","w-full","overflow-visible"],["mat-tab-nav-bar",""],["mat-tab-link","",3,"routerLink","routerLinkActive","active","click",4,"ngIf"],["mat-tab-link","",3,"routerLink","active","click"],["mat-tab-link","",3,"routerLink","routerLinkActive","active","click"]],template:function(i,o){1&i&&(e._UZ(0,"asset-manager-topbar",0),e.TgZ(1,"div",1),e.YNc(2,It,6,9,"nav",2),e.TgZ(3,"div",3),e._UZ(4,"router-outlet"),e.qZA()()),2&i&&(e.Q6J("active",o.active),e.xp6(2),e.Q6J("ngIf",!o.is_new||"requests"!==o.active))},dependencies:[p.O5,R.BU,R.Nj,f.lC,f.rH,f.Od,le],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%}\n\n/*# sourceMappingURL=asset-listing.component.ts-angular-inline--115.css.map*/"]})}return n})();var kt=l(2349);const Lt=["asset-manager",""];let pe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["","asset-manager",""]],attrs:Lt,decls:3,vars:0,consts:[[1,"relative","w-1/2","flex-1","bg-base-100","overflow-hidden"]],template:function(i,o){1&i&&(e._UZ(0,"sidebar"),e.TgZ(1,"main",0),e._UZ(2,"router-outlet"),e.qZA())},dependencies:[kt.k,f.lC],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%;background:var(--b1)}\n\n/*# sourceMappingURL=asset-manager.component.ts-angular-inline--116.css.map*/"]})}return n})();var Ut=l(942),S=l(8128),Ot=l(1674),J=l(7442);let B=(()=>{class n{transform(t,i="_",o=" "){return(t||"").split(i).join(o)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275pipe=e.Yjl({name:"splitjoin",type:n,pure:!0})}return n})();function Nt(n,r){if(1&n&&(e.TgZ(0,"div",15),e._uU(1),e.qZA()),2&n){const t=e.oxw();let i;e.xp6(1),e.hij(" ",(null==(i=t.level(t.selected.zone))?null:i.display_name)||"N/A"," ")}}const de=()=>({display:"none"}),Dt=(n,r)=>({"#Zones":n,"#zones":r});function Ft(n,r){if(1&n&&e._UZ(0,"i-map",16),2&n){const t=e.oxw();let i;e.Q6J("src",(null==(i=t.level(t.selected.zone))?null:i.map_id)||"")("styles",e.WLB(5,Dt,e.DdM(3,de),e.DdM(4,de)))("features",t.selected_feature)}}function Et(n,r){1&n&&(e.TgZ(0,"p",17),e._uU(1," Select a space from the list to view map location "),e.qZA())}function Pt(n,r){if(1&n&&e._uU(0),2&n){const t=r.data,i=e.oxw();let o;e.hij(" ",(null==(o=i.level(t))?null:o.display_name)||"N/A"," ")}}function Rt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(o){return o.stopPropagation()}),e.TgZ(1,"div",19),e._uU(2),e.ALo(3,"splitjoin"),e.qZA(),e.TgZ(4,"app-icon",20),e._uU(5,"expand_more"),e.qZA()(),e.TgZ(6,"mat-menu",21,22)(8,"button",23),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw();return e.KtG(a.setTracking(s,"in_storage"))}),e._uU(9," In Storage "),e.qZA(),e.TgZ(10,"button",23),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw();return e.KtG(a.setTracking(s,"in_transit"))}),e._uU(11," In Transit "),e.qZA(),e.TgZ(12,"button",23),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw();return e.KtG(a.setTracking(s,"at_location"))}),e._uU(13," At Location "),e.qZA()()}if(2&n){const t=r.row,i=e.MAs(7),o=e.oxw();e.Q6J("matMenuTriggerFor",i)("disabled",o.loading[t.id]),e.xp6(2),e.hij(" ",e.lcZ(3,3,null==t.extension_data?null:t.extension_data.tracking)||"In Storage"," ")}}const Jt=()=>["zones","description","tracking","user_name"],Qt=()=>["Level","Space","Tracking","Requestee"],jt=()=>["4r","flex","10r","6r"],zt=(n,r)=>({tracking:n,zones:r});let ue=(()=>{class n{updateFeatures(){var t=this;return(0,_.Z)(function*(){const i=yield t._space.transform(t.selected.extension_data?.location_id);t.selected_feature=t.selected?[{location:i.map_id,content:P.qL,z_index:99,data:{message:`${i.display_name||i.name} is here`}}]:[]})()}setTracking(t,i){var o=this;return(0,_.Z)(function*(){o.loading[t.id]=!0,yield o._state.setTracking(t,i),o.loading[t.id]=!1})()}constructor(t,i,o){this._state=t,this._org=i,this._space=o,this.asset=this._state.active_product,this.requests=this._state.active_product_requests,this.loading={}}level(t){return this._org.levelWithID(t)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z),e.Y36(I.w7),e.Y36(Ut.X))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-location-modal"]],decls:24,vars:20,consts:[[1,"p-6","relative"],["icon","","matRipple","","mat-dialog-close","",1,"absolute","top-4","right-4"],[1,"font-medium","mb-2"],["appearance","outline",1,"h-[3.5rem]","mb-2"],["matPrefix",""],["matInput","","placeholder","Search..."],[1,"flex","items-center","space-x-4","w-[90vw]","text-sm"],[1,"flex-1","h-[60vh]","w-1/2","border","border-base-200","bg-base-200","overflow-auto"],[3,"dataSource","columns","display_column","column_size","template","row_clicked"],[1,"flex-1","h-[60vh]","w-1/2","border","border-base-200","bg-base-200","relative","flex","items-center","justify-center"],["class","absolute top-4 left-4 bg-base-100 px-4 py-2 rounded-3xl border border-base-200",4,"ngIf"],[3,"src","styles","features",4,"ngIf","ngIfElse"],["empty_state",""],["level_template",""],["tracking_template",""],[1,"absolute","top-4","left-4","bg-base-100","px-4","py-2","rounded-3xl","border","border-base-200"],[3,"src","styles","features"],[1,"opacity-30"],["matRipple","",1,"bg-none","w-full","flex","items-center","px-2","py-1","text-left",3,"matMenuTriggerFor","disabled","click"],[1,"capitalize","flex-1"],[1,"text-2xl"],[1,"w-36"],["tracking_menu","matMenu"],["mat-menu-item","",3,"click"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0)(1,"button",1)(2,"app-icon"),e._uU(3,"close"),e.qZA()(),e.TgZ(4,"h2",2),e._uU(5),e.ALo(6,"async"),e.ALo(7,"async"),e.qZA(),e.TgZ(8,"mat-form-field",3)(9,"app-icon",4),e._uU(10,"search"),e.qZA(),e._UZ(11,"input",5),e.qZA(),e.TgZ(12,"div",6)(13,"div",7)(14,"custom-table",8),e.NdJ("row_clicked",function(a){return o.selected=a,o.updateFeatures()}),e.qZA()(),e.TgZ(15,"div",9),e.YNc(16,Nt,2,1,"div",10)(17,Ft,1,8,"i-map",11),e.qZA()()(),e.YNc(18,Et,2,0,"ng-template",null,12,e.W1O)(20,Pt,1,1,"ng-template",null,13,e.W1O)(22,Rt,14,5,"ng-template",null,14,e.W1O)),2&i){const s=e.MAs(19),a=e.MAs(21),c=e.MAs(23);let d;e.xp6(5),e.AsE(" ",null==(d=e.lcZ(6,10,o.asset))?null:d.name," in use location: ",null==(d=e.lcZ(7,12,o.requests))?null:d.length," "),e.xp6(9),e.Q6J("dataSource",o.requests)("columns",e.DdM(14,Jt))("display_column",e.DdM(15,Qt))("column_size",e.DdM(16,jt))("template",e.WLB(17,zt,c,a)),e.xp6(2),e.Q6J("ngIf",o.selected),e.xp6(1),e.Q6J("ngIf",o.selected)("ngIfElse",s)}},dependencies:[p.O5,T.KE,T.qo,O.Nt,S.VK,S.OP,S.p6,C.ZT,b.wG,k.o,Ot.p,J.C,p.Ov,B]})}return n})();var Ht=l(8415),Yt=l(3884),Bt=l(1624);function Vt(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw(2);let i;e.xp6(1),e.hij(" ",(null==(i=e.lcZ(2,1,t.item))?null:i.description)||"~No Description~"," ")}}function Gt(n,r){1&n&&(e.TgZ(0,"span",48),e._uU(1,"No Description"),e.qZA())}const _e=n=>[n,"manage","asset"],me=(n,r)=>({id:n,group_id:r});function Kt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",49)(1,"a",50),e.ALo(2,"async"),e.TgZ(3,"app-icon",22),e._uU(4,"edit"),e.qZA()(),e.TgZ(5,"button",51),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw(2);return e.KtG(a.removeAsset(s))}),e.TgZ(6,"app-icon",22),e._uU(7,"delete"),e.qZA()()()}if(2&n){const t=r.row,i=e.oxw(2);let o;e.xp6(1),e.Q6J("routerLink",e.VKq(4,_e,i.base_route))("queryParams",e.WLB(6,me,t.id,null==(o=e.lcZ(2,2,i.item))?null:o.id))}}const ge=n=>[n,"manage","purchase-order"];function $t(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",49)(1,"a",50)(2,"app-icon",22),e._uU(3,"edit"),e.qZA()(),e.TgZ(4,"button",51),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw(2);return e.KtG(a.removePurchaseOrder(s))}),e.TgZ(5,"app-icon",22),e._uU(6,"delete"),e.qZA()()()}if(2&n){const t=r.row,i=e.oxw(2);e.xp6(1),e.Q6J("routerLink",e.VKq(2,ge,i.base_route))("queryParams",e.WLB(4,me,t.id,null==t?null:t.id))}}const Wt=n=>[n,"list","items"],W=()=>[],Xt=n=>[n,"manage","group"],en=n=>({id:n}),X=n=>({group_id:n}),tn=n=>[n,"manage","asset-bulk"],nn=()=>["id","identifier","serial_number","actions"],on=()=>["ID","Label/Friendly Name","Serial Number"," "],sn=()=>["10r","14r","8r","flex"],rn=n=>({actions:n}),an=()=>["purchase_order_number","invoice_number","expected_service_start_date","expected_service_end_date","actions"],ln=()=>["Order Number","Invoice Number","Service Start","Service End"," "],cn=()=>["10r","10r","10r","10r","flex"],pn=(n,r,t)=>({actions:n,expected_service_start_date:r,expected_service_end_date:t});function dn(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7)(2,"a",8)(3,"div",9)(4,"app-icon",10),e._uU(5,"arrow_back"),e.qZA(),e.TgZ(6,"div",11),e._uU(7,"Back"),e.qZA()()(),e.TgZ(8,"div",12)(9,"span"),e._uU(10,"Assets"),e.qZA(),e.TgZ(11,"span")(12,"app-icon",13),e._uU(13,"chevron_right"),e.qZA()(),e.TgZ(14,"span"),e._uU(15),e.ALo(16,"async"),e.qZA(),e.TgZ(17,"span")(18,"app-icon",13),e._uU(19,"chevron_right"),e.qZA()(),e.TgZ(20,"span"),e._uU(21),e.ALo(22,"async"),e.qZA()()(),e.TgZ(23,"div",9)(24,"div",14),e._UZ(25,"image-carousel",15),e.ALo(26,"async"),e.qZA(),e.TgZ(27,"div",16)(28,"div",17)(29,"div",18),e._uU(30),e.ALo(31,"async"),e.qZA(),e.TgZ(32,"div",19)(33,"a",20),e.ALo(34,"async"),e.TgZ(35,"div",21)(36,"app-icon",22),e._uU(37,"edit"),e.qZA(),e.TgZ(38,"div",23),e._uU(39,"Edit"),e.qZA()()(),e._UZ(40,"div",24),e.TgZ(41,"button",25)(42,"div",26)(43,"app-icon",22),e._uU(44,"delete"),e.qZA(),e.TgZ(45,"div",23),e._uU(46,"Delete"),e.qZA()()()()(),e.TgZ(47,"div",27),e.YNc(48,Vt,3,3,"ng-container",28),e.ALo(49,"async"),e.YNc(50,Gt,2,0,"ng-template",null,29,e.W1O),e.qZA(),e.TgZ(52,"div",30)(53,"div",31)(54,"div",32),e._uU(55),e.ALo(56,"async"),e.ALo(57,"async"),e.qZA()(),e.TgZ(58,"div",31)(59,"div",32),e._uU(60),e.ALo(61,"async"),e.qZA(),e.TgZ(62,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.viewLocations())}),e.ALo(63,"async"),e.ALo(64,"async"),e._uU(65," View Locations "),e.qZA()()()()(),e.TgZ(66,"mat-tab-group",34)(67,"mat-tab",35)(68,"div",36)(69,"h3",37),e._uU(70,"Assets"),e.qZA(),e.TgZ(71,"div",38)(72,"a",39),e.ALo(73,"async"),e._uU(74," Add Asset "),e.qZA(),e.TgZ(75,"a",39),e.ALo(76,"async"),e._uU(77," Bulk Add Asset "),e.qZA()(),e._UZ(78,"custom-table",40),e.ALo(79,"async"),e.YNc(80,Kt,8,9,"ng-template",null,41,e.W1O),e.qZA()(),e.TgZ(82,"mat-tab",42)(83,"div",36)(84,"h3",37),e._uU(85,"General"),e.qZA(),e.TgZ(86,"div",43)(87,"div",44)(88,"label"),e._uU(89,"Brand"),e.qZA(),e.TgZ(90,"div"),e._uU(91),e.ALo(92,"async"),e.qZA()()()()(),e.TgZ(93,"mat-tab",45)(94,"div",36)(95,"h3",37),e._uU(96,"Purchase Orders"),e.qZA(),e.TgZ(97,"a",46),e.ALo(98,"async"),e._uU(99," Add Purchase Order "),e.qZA(),e._UZ(100,"custom-table",40),e.ALo(101,"async"),e.YNc(102,$t,7,7,"ng-template",null,47,e.W1O),e.qZA()()()()}if(2&n){const t=e.MAs(51),i=e.MAs(81),o=e.MAs(103),s=e.oxw(),a=e.MAs(7),c=e.MAs(5);let d,x,v,w,q,Q,j,ke,Le,Ue,Oe,Ne,De,Fe;e.xp6(2),e.Q6J("routerLink",e.VKq(64,Wt,s.base_route)),e.xp6(13),e.Oqu(null==(d=e.lcZ(16,30,s.item))||null==d.category?null:d.category.name),e.xp6(6),e.Oqu(null==(x=e.lcZ(22,32,s.item))?null:x.name),e.xp6(4),e.Q6J("images",(null==(v=e.lcZ(26,34,s.item))?null:v.images)||e.DdM(66,W)),e.xp6(5),e.hij(" ",null==(w=e.lcZ(31,36,s.item))?null:w.name," "),e.xp6(3),e.Q6J("routerLink",e.VKq(67,Xt,s.base_route))("queryParams",e.VKq(69,en,null==(q=e.lcZ(34,38,s.item))?null:q.id)),e.xp6(9),e.Q6J("content",a),e.xp6(6),e.Q6J("ngIf",null==(Q=e.lcZ(49,40,s.item))?null:Q.description)("ngIfElse",t),e.xp6(7),e.hij(" Available: ",e.lcZ(56,42,s.asset_list).length-(null==(j=e.lcZ(57,44,s.requests))?null:j.length)||0," "),e.xp6(5),e.hij(" In Use: ",(null==(ke=e.lcZ(61,46,s.requests))?null:ke.length)||0," "),e.xp6(2),e.Q6J("disabled",e.lcZ(63,48,s.asset_list).length-(null==(Le=e.lcZ(64,50,s.requests))?null:Le.length)!=0),e.xp6(10),e.Q6J("routerLink",e.VKq(71,_e,s.base_route))("queryParams",e.VKq(73,X,null==(Ue=e.lcZ(73,52,s.item))?null:Ue.id)),e.xp6(3),e.Q6J("routerLink",e.VKq(75,tn,s.base_route))("queryParams",e.VKq(77,X,null==(Oe=e.lcZ(76,54,s.item))?null:Oe.id)),e.xp6(3),e.Q6J("dataSource",e.lcZ(79,56,s.asset_list)||e.DdM(79,W))("columns",e.DdM(80,nn))("display_column",e.DdM(81,on))("column_size",e.DdM(82,sn))("template",e.VKq(83,rn,i)),e.xp6(13),e.hij(" ",(null==(Ne=e.lcZ(92,58,s.item))?null:Ne.brand)||"~None~"," "),e.xp6(6),e.Q6J("routerLink",e.VKq(85,ge,s.base_route))("queryParams",e.VKq(87,X,null==(De=e.lcZ(98,60,s.item))?null:De.id)),e.xp6(3),e.Q6J("dataSource",(null==(Fe=e.lcZ(101,62,s.item))?null:Fe.purchase_orders)||e.DdM(89,W))("columns",e.DdM(90,an))("display_column",e.DdM(91,ln))("column_size",e.DdM(92,cn))("template",e.kEZ(93,pn,o,c,c))}}function un(n,r){1&n&&(e.TgZ(0,"div",52),e._UZ(1,"mat-spinner",53),e.TgZ(2,"p"),e._uU(3,"Loading product details..."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("diameter",32))}function _n(n,r){1&n&&(e.TgZ(0,"span",48),e._uU(1," No Date "),e.qZA())}function mn(n,r){if(1&n&&(e._uU(0),e.ALo(1,"date"),e.YNc(2,_n,2,0,"span",54)),2&n){const t=r.data;e.hij(" ",e.xi3(1,2,1e3*t,"mediumDate")," "),e.xp6(2),e.Q6J("ngIf",!t)}}function gn(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",57)(1,"p"),e._uU(2,"Are you sure you want to permanently delete this product?"),e.qZA(),e.TgZ(3,"div",58)(4,"button",59),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.closeTooltip())}),e._uU(5," No "),e.qZA(),e.TgZ(6,"button",60),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.deleteAsset())}),e._uU(7," Yes, delete "),e.qZA()()()}}function fn(n,r){1&n&&(e.TgZ(0,"div",61),e._UZ(1,"mat-spinner",53),e.TgZ(2,"p"),e._uU(3,"Deleting product details..."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("diameter",32))}function hn(n,r){if(1&n&&e.YNc(0,gn,8,0,"div",55)(1,fn,4,1,"ng-template",null,56,e.W1O),2&n){const t=e.MAs(2),i=e.oxw();e.Q6J("ngIf",!i.deleting)("ngIfElse",t)}}function xn(n,r){1&n&&(e.TgZ(0,"div",62),e._uU(1,"No purchase orders"),e.qZA())}function vn(n,r){1&n&&(e.TgZ(0,"div",62),e._uU(1,"No assets"),e.qZA())}let fe=(()=>{class n extends u.cx{deleteAsset(){var t=this;return(0,_.Z)(function*(){t.deleting=!0,yield t._state.deleteActiveProduct(),t.deleting=!1,t._router.navigate([t._state.base_route,"list","items"]),t.closeTooltip()})()}closeTooltip(){this._tooltip_el?.close()}get code(){return this._org.currency_code}get base_route(){return this._state.base_route}constructor(t,i,o,s,a){super(),this._route=t,this._router=i,this._state=o,this._dialog=s,this._org=a,this.loading=!1,this.deleting=!1,this.item=this._state.active_product,this.asset_list=(0,A.aj)([this.item,this._state.extra_assets]).pipe((0,y.U)(([c,d])=>c?(0,u.Tw)([...c.assets,...d.filter(x=>x.type_id===c.id)],"id"):[])),this.requests=this._state.active_product_requests.pipe((0,y.U)(c=>c.filter(d=>d.date<=Date.now()&&(0,Ht.Z)(d.date,d.duration).valueOf()>=Date.now())))}viewLocations(){this._dialog.open(ue)}ngOnInit(){this.loading=!0,this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("id")&&this._state.setOptions({active_item:t.get("id")})})),this.timeout("no_asset",()=>this._router.navigate([this._state.base_route]),1e3),this._state.active_product.pipe((0,H.P)(t=>!!t)).subscribe(()=>{this.clearTimeout("no_asset"),this.loading=!1})}removeAsset(t){var i=this;return(0,_.Z)(function*(){const o=yield(0,u._5)({title:"Delete asset",content:"Are you sure you want to delete this asset?",confirm_text:"Delete",icon:{content:"delete"}},i._dialog);if("done"!==o.reason)return;o.loading("Deleting asset..."),yield(0,m.mo)(t.id).toPromise(),yield(0,m.E5)(t.id);const s=yield i._state.active_product.pipe((0,H.P)()).toPromise();i._state.setOptions({active_item:""}),setTimeout(()=>i._state.setOptions({active_item:s.id}),1e3),o.close()})()}removePurchaseOrder(t){var i=this;return(0,_.Z)(function*(){const o=yield(0,u._5)({title:"Delete purchase order",content:"Are you sure you want to delete this purchase order?",confirm_text:"Delete",icon:{content:"delete"}},i._dialog);if("done"!==o.reason)return;o.loading("Deleting purchase order..."),yield(0,m.Nv)(t.id).toPromise();const s=yield i._state.active_product.pipe((0,H.P)()).toPromise();i._state.setOptions({active_item:""}),setTimeout(()=>i._state.setOptions({active_item:s.id}),1e3),o.close()})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(f.gz),e.Y36(f.F0),e.Y36(Z),e.Y36(C.uw),e.Y36(I.w7))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-view"]],viewQuery:function(i,o){if(1&i&&e.Gf(P.Xo,5),2&i){let s;e.iGM(s=e.CRH())&&(o._tooltip_el=s.first)}},features:[e.qOj],decls:12,vars:4,consts:[["class","h-full w-full flex flex-col",4,"ngIf","ngIfElse"],["loading_state",""],["date_template",""],["delete_tooltip",""],["empty_invoices",""],["empty_items",""],[1,"h-full","w-full","flex","flex-col"],[1,"flex","items-center","space-x-4","p-2","bg-base-100","border-b","border-base-200"],["btn","","matRipple","",1,"inverse",3,"routerLink"],[1,"flex","items-center"],[1,"text-xl"],[1,"mr-2"],[1,"flex","items-center","space-x-2","font-medium"],[1,"text-2xl"],[1,"bg-base-100","flex-1","w-1/2","h-[22.5rem]"],[3,"images"],[1,"w-[32rem]","h-[22.5rem]","px-4","flex","flex-col"],[1,"w-full","flex","items-center","justify-between","border-b","border-base-200"],[1,"font-medium"],[1,"flex","items-center","text-sm"],["button","","btn","","matRipple","",1,"clear",3,"routerLink","queryParams"],[1,"flex","items-center","text-blue-600","hover:text-blue-900"],[1,"text-lg"],[1,"mr-2","underline"],[1,"w-px","h-4","bg-base-200"],["btn","","matRipple","",1,"clear"],["customTooltip","",1,"flex","items-center","text-blue-600","hover:text-blue-900",3,"content"],[1,"py-4","w-full","flex-1","h-1/2","overflow-auto"],[4,"ngIf","ngIfElse"],["no_desc_state",""],[1,"rounded","bg-base-100","shadow","border","border-base-200","w-full","divide-y","divide-base-200"],[1,"flex","items-center","justify-between","p-3"],[1,"pl-2"],["btn","","matRipple","",3,"disabled","click"],[1,"flex-1","h-px"],["label","Assets"],[1,"max-w-[768px]","mx-auto","p-4"],[1,"p-2"],[1,"flex","w-full","items-center","space-x-2","mb-2"],["btn","","matRipple","",1,"flex-1",3,"routerLink","queryParams"],["asset-view","","empty","No assets for this product",1,"w-full","block","text-sm",3,"dataSource","columns","display_column","column_size","template"],["action_template",""],["label","Specifications"],["data-table","",1,"bg-base-100","border","border-base-200"],[1,"flex","items-center","p-2"],["label","Purchase information"],["btn","","matRipple","",1,"mb-2",3,"routerLink","queryParams"],["po_action_template",""],[1,"opacity-30"],[1,"flex","w-full","items-center","justify-end"],["btn","","icon","","matRipple","",1,"clear",3,"routerLink","queryParams"],["btn","","icon","","matRipple","",3,"click"],[1,"h-full","w-full","flex","flex-col","items-center","justify-center"],[3,"diameter"],["class","opacity-30",4,"ngIf"],["class","p-4 bg-base-100 rounded my-2 text-center w-[18rem]",4,"ngIf","ngIfElse"],["delete_loading",""],[1,"p-4","bg-base-100","rounded","my-2","text-center","w-[18rem]"],[1,"flex","items-center","space-x-2","mt-6"],["btn","","matRipple","",1,"inverse","flex-1","w-24",3,"click"],["btn","","matRipple","",1,"error","flex-1","w-24",3,"click"],[1,"p-4","bg-base-100","rounded","my-2","w-64","h-36","flex","flex-col","items-center","justify-center","space-y-2"],[1,"p-2","opacity-30"]],template:function(i,o){if(1&i&&(e.YNc(0,dn,104,97,"div",0),e.ALo(1,"async"),e.YNc(2,un,4,1,"ng-template",null,1,e.W1O)(4,mn,3,5,"ng-template",null,2,e.W1O)(6,hn,3,2,"ng-template",null,3,e.W1O)(8,xn,2,0,"ng-template",null,4,e.W1O)(10,vn,2,0,"ng-template",null,5,e.W1O)),2&i){const s=e.MAs(3);e.Q6J("ngIf",!o.loading&&e.lcZ(1,2,o.item))("ngIfElse",s)}},dependencies:[p.O5,N.Ou,b.wG,k.o,J.C,Yt.X,Bt.K,R.uX,R.SP,f.rH,p.Ov,p.uU],styles:["[_nghost-%COMP%]{height:100%}[data-table][_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2n){background:#0001}label[_ngcontent-%COMP%]{width:10rem;min-width:0}\n\n/*# sourceMappingURL=asset-view.component.ts-angular-inline--117.css.map*/"]})}return n})();var bn=l(1771),he=l(2882),yn=l(6324);let xe=(()=>{class n{transform(t,i=!0){let o=(0,yn.Z)({days:Math.floor(t/1440),hours:Math.floor(t/60%24),minutes:Math.floor(t%60)});return i?o.replace(" day","d").replace(" hour","hr").replace(" minute","min"):o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275pipe=e.Yjl({name:"duration",type:n,pure:!0})}return n})();function Tn(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.TgZ(2,"span",29),e._uU(3),e.qZA()()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.hij(" x",t.quantity," ")}}const Zn=n=>({name:n});function An(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",1),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.request=null,e.KtG(o.requestChange.emit(o.request))}),e._UZ(1,"div",2),e.TgZ(2,"div",3),e.NdJ("click",function(o){return o.stopPropagation()}),e.TgZ(3,"button",4),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.request=null,e.KtG(o.requestChange.emit(o.request))}),e.TgZ(4,"app-icon"),e._uU(5,"close"),e.qZA()(),e.TgZ(6,"div",5),e._UZ(7,"a-user-avatar",6),e.TgZ(8,"div",7)(9,"div",8),e._uU(10),e.qZA(),e.TgZ(11,"div",9)(12,"app-icon"),e._uU(13,"mail"),e.qZA(),e.TgZ(14,"a",10),e._uU(15),e.qZA()(),e.TgZ(16,"div",9)(17,"app-icon"),e._uU(18,"call"),e.qZA(),e.TgZ(19,"a",10),e._uU(20),e.qZA()(),e.TgZ(21,"div",9)(22,"app-icon"),e._uU(23,"work_outline"),e.qZA(),e.TgZ(24,"div"),e._uU(25),e.qZA()()()(),e.TgZ(26,"div",11)(27,"div",12)(28,"div",13)(29,"app-icon",14),e._uU(30,"send"),e.qZA()(),e.TgZ(31,"div",8),e._uU(32,"Asset Requested"),e.qZA()(),e.TgZ(33,"div",15),e.YNc(34,Tn,4,2,"div",16),e.qZA(),e.TgZ(35,"div",17)(36,"div",13)(37,"app-icon",14),e._uU(38,"event"),e.qZA()(),e.TgZ(39,"div",8),e._uU(40,"Date For"),e.qZA()(),e.TgZ(41,"div",18),e._uU(42),e.ALo(43,"date"),e.qZA(),e.TgZ(44,"div",17)(45,"div",13)(46,"app-icon",14),e._uU(47,"schedule"),e.qZA()(),e.TgZ(48,"div",8),e._uU(49,"Period"),e.qZA()(),e.TgZ(50,"div",18),e._uU(51),e.ALo(52,"date"),e.ALo(53,"date"),e.ALo(54,"duration"),e.qZA(),e.TgZ(55,"div",17)(56,"div",13)(57,"app-icon",14),e._uU(58,"place"),e.qZA()(),e.TgZ(59,"div",8),e._uU(60,"Floor"),e.qZA()(),e.TgZ(61,"div",18),e._uU(62),e.qZA(),e.TgZ(63,"div",17)(64,"div",13)(65,"app-icon",14),e._uU(66,"meeting_room"),e.qZA()(),e.TgZ(67,"div",8),e._uU(68,"Room"),e.qZA()(),e.TgZ(69,"div",18),e._uU(70),e.qZA(),e.TgZ(71,"div",19)(72,"button",20)(73,"app-icon",21),e._uU(74),e.qZA(),e.TgZ(75,"div",22),e._uU(76),e.qZA(),e.TgZ(77,"app-icon",23),e._uU(78,"expand_more"),e.qZA()(),e.TgZ(79,"mat-menu",24,25)(81,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.setStatus("approved"))}),e._uU(82," Approve "),e.qZA(),e.TgZ(83,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.setStatus("declined"))}),e._uU(84," Decline "),e.qZA()(),e.TgZ(85,"button",27)(86,"div",22),e._uU(87),e.ALo(88,"splitjoin"),e.qZA(),e.TgZ(89,"app-icon",23),e._uU(90,"expand_more"),e.qZA()(),e.TgZ(91,"mat-menu",24,28)(93,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.setTracking("in_storage"))}),e._uU(94," In Storage "),e.qZA(),e.TgZ(95,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.setTracking("in_transit"))}),e._uU(96," In Transit "),e.qZA(),e.TgZ(97,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.setTracking("at_location"))}),e._uU(98," At Location "),e.qZA()()()()()()}if(2&n){const t=e.MAs(80),i=e.MAs(92),o=e.oxw();let s;e.xp6(7),e.Q6J("user",e.VKq(46,Zn,o.request.user_name)),e.xp6(3),e.Oqu(o.request.user_name),e.xp6(4),e.Q6J("href","mailto:"+o.request.user_email,e.LSH),e.xp6(1),e.hij(" ",o.request.user_email||"staff@place.tech"," "),e.xp6(4),e.Q6J("href","tel:"+o.request.user_phone,e.LSH),e.xp6(1),e.hij(" ",o.request.user_phone||"04 1234 5678"," "),e.xp6(5),e.Oqu(o.request.user_company||"PlaceOS"),e.xp6(9),e.Q6J("ngForOf",o.items),e.xp6(8),e.hij(" ",e.xi3(43,33,o.request.date,"EEEE, MMMM d, y")," "),e.xp6(9),e.lnq(" ",e.xi3(52,36,o.request.date,o.time_format)," \u2013 ",e.xi3(53,39,o.request.date+60*o.request.duration*1e3,o.time_format)," (",e.lcZ(54,42,o.request.duration),") "),e.xp6(11),e.hij(" ",(null==(s=o.level(o.request.zones))?null:s.display_name)||"N/A"," "),e.xp6(8),e.hij(" ",o.request.description," "),e.xp6(2),e.ekj("bg-success","approved"===o.request.status)("bg-error","declined"===o.request.status)("bg-warning","tentative"===o.request.status),e.Q6J("matMenuTriggerFor",t)("disabled",o.loading),e.xp6(1),e.ekj("text-green-600","approved"===o.request.status)("text-red-600","declined"===o.request.status)("text-yellow-400","tentative"===o.request.status),e.xp6(1),e.hij(" ","approved"===o.request.status?"done":"declined"===o.request.status?"close":"warning"," "),e.xp6(2),e.hij(" ",o.request.status," "),e.xp6(9),e.Q6J("matMenuTriggerFor",i)("disabled",o.loading),e.xp6(2),e.hij(" ",e.lcZ(88,44,null==o.request.extension_data?null:o.request.extension_data.tracking)||"In Storage"," ")}}let ve=(()=>{class n{get items(){return this.request?.extension_data?.request?.items||[]}get time_format(){return this._settings.time_format}constructor(t,i,o){this._state=t,this._org=i,this._settings=o,this.requestChange=new e.vpe,this.loading=!1}level(t){return this._org.levelWithID(t)}setStatus(t){var i=this;return(0,_.Z)(function*(){i.loading=!0,yield i._state.setStatus(i.request,t),i.request.status=t,i.loading=!1})()}setTracking(t){var i=this;return(0,_.Z)(function*(){i.loading=!0,yield i._state.setTracking(i.request,t),i.request.extension_data.tracking=t,i.loading=!1})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z),e.Y36(I.w7),e.Y36(u.gb))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-request-details"]],inputs:{request:"request"},outputs:{requestChange:"requestChange"},decls:1,vars:1,consts:[["class","fixed inset-0 z-50",3,"click",4,"ngIf"],[1,"fixed","inset-0","z-50",3,"click"],[1,"absolute","inset-0","bg-black","opacity-50"],[1,"absolute","inset-y-0","right-0","bg-base-100","w-[480px]",3,"click"],["icon","","matRipple","",1,"absolute","top-1","right-1",3,"click"],[1,"border-b","border-base-200","px-2","py-4","flex","space-x-4"],[1,"text-xl",3,"user"],["details","",1,"space-y-1"],[1,"font-medium"],[1,"flex","items-center","text-sm","space-x-2"],[1,"underline",3,"href"],[1,"px-3","py-4","relative"],[1,"flex","items-center","space-x-4"],[1,"h-6","w-6","rounded-full","text-secondary","bg-base-200","flex","items-center","justify-center"],[1,"text-sm"],[1,"pl-10","flex","flex-col","mt-1"],[4,"ngFor","ngForOf"],[1,"flex","items-center","space-x-4","mt-4"],[1,"pl-10","mt-1"],[1,"absolute","top-4","right-4","text-sm"],["matRipple","",1,"rounded-3xl","!bg-opacity-20","flex","items-center","px-2","py-1","w-full","text-left","space-x-2","mb-4",3,"matMenuTriggerFor","disabled"],[1,"text-xl"],[1,"capitalize","flex-1"],[1,"text-2xl"],[1,"w-36"],["menu","matMenu"],["mat-menu-item","",3,"click"],["matRipple","",1,"bg-none","w-full","flex","items-center","px-2","py-1","text-left","border","border-base-200","rounded-none",3,"matMenuTriggerFor","disabled"],["tracking_menu","matMenu"],[1,"text-xs","bg-success","text-success-content","px-2","py-1","rounded"]],template:function(i,o){1&i&&e.YNc(0,An,99,48,"div",0),2&i&&e.Q6J("ngIf",o.request)},dependencies:[p.sg,p.O5,S.VK,S.OP,S.p6,b.wG,k.o,he.k,p.uU,B,xe]})}return n})();const Cn=n=>({name:n});function wn(n,r){if(1&n&&(e.TgZ(0,"div",14),e._UZ(1,"a-user-avatar",15),e.TgZ(2,"div",16),e._uU(3),e.qZA()()),2&n){const t=r.row;e.xp6(1),e.Q6J("user",e.VKq(2,Cn,t.user_name)),e.xp6(2),e.Oqu(t.user_name)}}function Mn(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.AsE(" ",t.quantity||1,"\xd7 ",t.name," ")}}const Sn=()=>[];function qn(n,r){if(1&n&&(e.TgZ(0,"div",17),e.YNc(1,Mn,2,2,"div",18),e.qZA()),2&n){const t=r.row;e.xp6(1),e.Q6J("ngForOf",(null==t.extension_data||null==t.extension_data.request?null:t.extension_data.request.items)||e.DdM(1,Sn))}}function In(n,r){if(1&n&&(e._uU(0),e.ALo(1,"date")),2&n){const t=r.row,i=e.oxw();e.hij(" ",e.xi3(1,1,null==t.extension_data||null==t.extension_data.request?null:t.extension_data.request.deliver_at,"MMM d, "+i.time_format)," ")}}function kn(n,r){if(1&n&&e._uU(0),2&n){const t=r.data,i=e.oxw();let o;e.hij(" ",(null==(o=i.level(t))?null:o.display_name)||"N/A"," ")}}function Ln(n,r){if(1&n&&(e._uU(0),e.ALo(1,"date"),e._UZ(2,"br"),e._uU(3),e.ALo(4,"date")),2&n){const t=r.row,i=e.oxw();e.hij(" ",e.xi3(1,2,i.date(t),"MMM d, "+i.time_format)," "),e.xp6(3),e.hij(" ",e.xi3(4,5,i.date(t)+60*t.duration*1e3,"MMM d, "+i.time_format)," ")}}function Un(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(o){return o.stopPropagation()}),e.TgZ(1,"app-icon",20),e._uU(2),e.qZA(),e.TgZ(3,"div",21),e._uU(4),e.qZA(),e.TgZ(5,"app-icon",22),e._uU(6,"expand_more"),e.qZA()(),e.TgZ(7,"mat-menu",23,24)(9,"button",25),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw();return e.KtG(a.setStatus(s,"approved"))}),e._uU(10," Approve "),e.qZA(),e.TgZ(11,"button",25),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw();return e.KtG(a.setStatus(s,"declined"))}),e._uU(12," Decline "),e.qZA()()}if(2&n){const t=r.row,i=e.MAs(8),o=e.oxw();e.ekj("bg-success","approved"===t.status)("bg-error","declined"===t.status)("bg-warning","tentative"===t.status)("text-success-content","approved"===t.status)("text-error-content","declined"===t.status)("text-warning-content","tentative"===t.status),e.Q6J("matMenuTriggerFor",i)("disabled",o.loading[t.id]),e.xp6(2),e.hij(" ","approved"===t.status?"done":"declined"===t.status?"close":"warning"," "),e.xp6(2),e.Oqu(t.status)}}function On(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(o){return o.stopPropagation()}),e.TgZ(1,"div",21),e._uU(2),e.ALo(3,"splitjoin"),e.qZA(),e.TgZ(4,"app-icon",22),e._uU(5,"expand_more"),e.qZA()(),e.TgZ(6,"mat-menu",23,27)(8,"button",25),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw();return e.KtG(a.setTracking(s,"in_storage"))}),e._uU(9," In Storage "),e.qZA(),e.TgZ(10,"button",25),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw();return e.KtG(a.setTracking(s,"in_transit"))}),e._uU(11," In Transit "),e.qZA(),e.TgZ(12,"button",25),e.NdJ("click",function(){const s=e.CHM(t).row,a=e.oxw();return e.KtG(a.setTracking(s,"at_location"))}),e._uU(13," At Location "),e.qZA()()}if(2&n){const t=r.row,i=e.MAs(7),o=e.oxw();e.Q6J("matMenuTriggerFor",i)("disabled",o.loading[t.id]),e.xp6(2),e.hij(" ",e.lcZ(3,3,null==t.extension_data?null:t.extension_data.tracking)||"In Storage"," ")}}const Nn=()=>["user","assets","date","period","zones","description","approval","tracking"],Dn=()=>["Requester","Asset","Deliver At","Meeting Time","Floor","Location","Approval","Tracking"],Fn=()=>["flex","12r","","8r","6r","12r","10r","10r"],En=(n,r,t,i,o,s,a)=>({user:n,assets:r,date:t,period:i,approval:o,tracking:s,zones:a});let be=(()=>{class n extends u.cx{date(t){return t.all_day?(0,se.Z)(t.date).valueOf():t.date}setStatus(t,i){var o=this;return(0,_.Z)(function*(){o.loading[t.id]=!0,yield o._state.setStatus(t,i),o.loading[t.id]=!1})()}setTracking(t,i){var o=this;return(0,_.Z)(function*(){o.loading[t.id]=!0,yield o._state.setTracking(t,i),o.loading[t.id]=!1})()}get time_format(){return this._settings.time_format}constructor(t,i,o){super(),this._state=t,this._org=i,this._settings=o,this.requests=this._state.filtered_requests,this.filters=this._state.options,this.loading={},this.setDate=s=>this._state.setOptions({date:s})}level(t){return this._org.levelWithID(t)}ngOnInit(){this.subscription("polling",this._state.startPolling())}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z),e.Y36(I.w7),e.Y36(u.gb))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-asset-request-list"]],features:[e.qOj],decls:26,vars:29,consts:[[1,"relative","-left-4","w-[calc(100%+2rem)]","mt-4","h-[calc(100%-1rem)]","flex","flex-col"],[1,"bg-base-100","px-4","border-t","border-b","border-base-200","flex","items-center","justify-between"],[1,"opacity-60","text-sm"],[3,"date","dateChange"],[1,"w-full","overflow-auto","h-1/2","flex-1","p-4"],["asset-requests","",1,"block","min-w-[82rem]","text-sm",3,"dataSource","columns","display_column","column_size","template","empty","row_clicked"],["user_template",""],["assets_template",""],["date_template",""],["level_template",""],["period_template",""],["approval_template",""],["tracking_template",""],[3,"request","requestChange"],[1,"flex","items-center","space-x-2"],[3,"user"],[1,"flex-1"],[1,"flex","flex-col"],[4,"ngFor","ngForOf"],["matRipple","",1,"rounded-3xl","!bg-opacity-20","flex","items-center","px-2","py-1","w-full","text-left","space-x-2",3,"matMenuTriggerFor","disabled","click"],[1,"text-xl"],[1,"capitalize","flex-1"],[1,"text-2xl"],[1,"w-36"],["menu","matMenu"],["mat-menu-item","",3,"click"],["matRipple","",1,"bg-none","w-full","flex","items-center","px-2","py-1","text-left",3,"matMenuTriggerFor","disabled","click"],["tracking_menu","matMenu"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"date-options",3),e.NdJ("dateChange",function(a){return o.setDate(a)}),e.ALo(7,"async"),e.qZA()(),e.TgZ(8,"div",4)(9,"custom-table",5),e.NdJ("row_clicked",function(a){return o.request=a}),e.ALo(10,"async"),e.qZA()()(),e.YNc(11,wn,4,4,"ng-template",null,6,e.W1O)(13,qn,2,2,"ng-template",null,7,e.W1O)(15,In,2,4,"ng-template",null,8,e.W1O)(17,kn,1,1,"ng-template",null,9,e.W1O)(19,Ln,5,8,"ng-template",null,10,e.W1O)(21,Un,13,16,"ng-template",null,11,e.W1O)(23,On,14,5,"ng-template",null,12,e.W1O),e.TgZ(25,"asset-request-details",13),e.NdJ("requestChange",function(a){return o.request=a}),e.qZA()),2&i){const s=e.MAs(12),a=e.MAs(14),c=e.MAs(16),d=e.MAs(18),x=e.MAs(20),v=e.MAs(22),w=e.MAs(24);let q,Q,j;e.xp6(3),e.AsE(" ",null==(q=e.lcZ(4,10,o.requests))?null:q.length," asset request","1"===(null==(q=e.lcZ(5,12,o.requests))?null:q.length)?"":"s"," "),e.xp6(3),e.Q6J("date",null==(Q=e.lcZ(7,14,o.filters))?null:Q.date),e.xp6(3),e.Q6J("dataSource",o.requests)("columns",e.DdM(18,Nn))("display_column",e.DdM(19,Dn))("column_size",e.DdM(20,Fn))("template",e.Hh0(21,En,s,a,c,x,v,w,d))("empty",null!=(j=e.lcZ(10,16,o.filters))&&j.search?"No matching asset requests":"There are no asset requests for the currently selected date."),e.xp6(16),e.Q6J("request",o.request)}},dependencies:[p.sg,bn.E,S.VK,S.OP,S.p6,b.wG,k.o,he.k,J.C,ve,p.Ov,p.uU,B],styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}\n\n/*# sourceMappingURL=asset-request-list.component.ts-angular-inline--118.css.map*/"]})}return n})();var Pn=l(8075);function Rn(n,r){if(1&n&&e._UZ(0,"img",22),2&n){const t=e.oxw().$implicit;e.Q6J("source",t.images[0])}}function Jn(n,r){1&n&&e._UZ(0,"img",23)}function Qn(n,r){if(1&n&&(e.TgZ(0,"div",24),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" Assets: ",t.asset_count||(null==t.assets?null:t.assets.length)||0," ")}}const ye=(n,r)=>[n,"view",r];function jn(n,r){if(1&n&&(e.TgZ(0,"a",15)(1,"div",16),e.YNc(2,Rn,1,1,"img",17)(3,Jn,1,0,"ng-template",null,18,e.W1O),e.qZA(),e.TgZ(5,"div",19)(6,"div",20),e._uU(7),e.qZA(),e.YNc(8,Qn,2,1,"div",21),e.qZA()()),2&n){const t=r.$implicit,i=e.MAs(4),o=e.oxw(5);e.Q6J("routerLink",e.WLB(5,ye,o.base_route,t.id)),e.xp6(2),e.Q6J("ngIf",null==t.images?null:t.images.length)("ngIfElse",i),e.xp6(5),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.asset_count||(null==t.assets?null:t.assets.length))}}function zn(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",13),e.YNc(2,jn,9,8,"a",14),e.ALo(3,"async"),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,1,i.products)[t.id])}}function Hn(n,r){if(1&n&&e._UZ(0,"img",22),2&n){const t=e.oxw().$implicit;e.Q6J("source",t.images[0])}}function Yn(n,r){1&n&&e._UZ(0,"img",30)}function Bn(n,r){if(1&n&&(e.TgZ(0,"div",24),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" Assets: ",t.asset_count||(null==t.assets?null:t.assets.length)||0," ")}}function Vn(n,r){if(1&n&&(e.TgZ(0,"a",27)(1,"div",28),e.YNc(2,Hn,1,1,"img",17)(3,Yn,1,0,"ng-template",null,18,e.W1O),e.qZA(),e.TgZ(5,"div",29)(6,"div",20),e._uU(7),e.qZA(),e.YNc(8,Bn,2,1,"div",21),e.qZA()()),2&n){const t=r.$implicit,i=e.MAs(4),o=e.oxw(5);e.Q6J("routerLink",e.WLB(5,ye,o.base_route,t.id)),e.xp6(2),e.Q6J("ngIf",null==t.images?null:t.images.length)("ngIfElse",i),e.xp6(5),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.asset_count||(null==t.assets?null:t.assets.length))}}function Gn(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",25),e.YNc(2,Vn,9,8,"a",26),e.ALo(3,"async"),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,1,i.products)[t.id])}}function Kn(n,r){if(1&n&&(e.TgZ(0,"div",6)(1,"h2",7)(2,"span",8),e._uU(3),e.qZA(),e.TgZ(4,"span",9),e._uU(5),e.ALo(6,"async"),e.ALo(7,"async"),e.qZA()(),e.ynx(8,10),e.ALo(9,"async"),e.YNc(10,zn,4,3,"ng-container",11)(11,Gn,4,3,"ng-container",12),e.BQk(),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(3),e.Oqu(null==t?null:t.name),e.xp6(2),e.AsE(" (",null==e.lcZ(6,5,i.products)[t.id]?null:e.lcZ(6,5,i.products)[t.id].length," item",1===(null==e.lcZ(7,7,i.products)[t.id]?null:e.lcZ(7,7,i.products)[t.id].length)?"":"s",") "),e.xp6(3),e.Q6J("ngSwitch",e.lcZ(9,9,i.options).view),e.xp6(2),e.Q6J("ngSwitchCase","list")}}function $n(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Kn,12,11,"div",5),e.ALo(2,"async"),e.BQk()),2&n){const t=r.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==e.lcZ(2,1,i.products)[t.id]?null:e.lcZ(2,1,i.products)[t.id].length)}}function Wn(n,r){if(1&n&&(e.TgZ(0,"div",3),e.YNc(1,$n,3,3,"ng-container",4),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.categories))}}function Xn(n,r){1&n&&e._UZ(0,"mat-progress-bar",31)}const ei=n=>[n,"manage","group"];function ti(n,r){if(1&n&&(e.TgZ(0,"a",35),e._uU(1," Create New Product "),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("routerLink",e.VKq(1,ei,t.base_route))}}function ni(n,r){if(1&n&&(e.TgZ(0,"div",32)(1,"p",33),e._uU(2),e.ALo(3,"async"),e.qZA(),e.YNc(4,ti,2,3,"a",34),e.ALo(5,"async"),e.qZA()),2&n){const t=e.oxw();let i,o;e.xp6(2),e.hij(" ",null!=(i=e.lcZ(3,2,t.options))&&i.search?"No matching assets found":"No assets available. Create a new asset with the button below"," "),e.xp6(2),e.Q6J("ngIf",!(null!=(o=e.lcZ(5,4,t.options))&&o.search))}}let Te=(()=>{class n{get base_route(){return this._state.base_route}constructor(t){this._state=t,this.loading=this._state.loading,this.options=this._state.options,this.categories=this._state.categories,this.products=this._state.product_mapping}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-asset-item-list"]],decls:7,vars:9,consts:[["class","overflow-auto pb-2 w-full h-full",4,"ngIf","ngIfElse"],["mode","indeterminate",4,"ngIf"],["empty_state",""],[1,"overflow-auto","pb-2","w-full","h-full"],[4,"ngFor","ngForOf"],["class","",4,"ngIf"],[1,""],[1,"py-2"],[1,"font-medium"],[1,"text-xs"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"rounded","overflow-hidden","bg-base-100","border","border-base-200","divide-y","divide-base-200"],["matRipple","","class","flex items-center text-left space-x-4 p-4 border border-base-200 hover:border-indigo-400 rounded",3,"routerLink",4,"ngFor","ngForOf"],["matRipple","",1,"flex","items-center","text-left","space-x-4","p-4","border","border-base-200","hover:border-indigo-400","rounded",3,"routerLink"],[1,"h-12","w-12","flex","items-center","justify-center","border","border-base-200","bg-base-200","overflow-hidden"],["auth","","class","min-w-full min-h-full object-cover",3,"source",4,"ngIf","ngIfElse"],["placeholder",""],[1,"flex-1","flex","flex-col","justify-center"],[1,"truncate"],["class","text-xs opacity-60",4,"ngIf"],["auth","",1,"min-w-full","min-h-full","object-cover",3,"source"],["src","assets/icons/asset-placeholder.svg",1,"m-auto"],[1,"text-xs","opacity-60"],[1,"flex","items-center","overflow-hidden","flex-wrap","-mx-2","w-full"],["matRipple","","class","bg-base-100 rounded shadow w-40 h-44 text-left m-2 border border-base-200 hover:border-indigo-400 flex flex-col",3,"routerLink",4,"ngFor","ngForOf"],["matRipple","",1,"bg-base-100","rounded","shadow","w-40","h-44","text-left","m-2","border","border-base-200","hover:border-indigo-400","flex","flex-col",3,"routerLink"],[1,"w-full","h-32","flex","items-center","justify-center","bg-base-200","overflow-hidden"],[1,"border-t","border-base-200","w-full","px-3","py-1","flex-1","flex","flex-col","justify-center"],["src","assets/icons/asset-placeholder.svg",1,"m-auto","w-16"],["mode","indeterminate"],[1,"flex","flex-col","items-center","justify-center","p-8","space-y-4","h-full","w-full"],[1,"opacity-40"],["button","","btn","","matRipple","",3,"routerLink",4,"ngIf"],["button","","btn","","matRipple","",3,"routerLink"]],template:function(i,o){if(1&i&&(e.YNc(0,Wn,3,3,"div",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,Xn,1,0,"mat-progress-bar",1),e.ALo(4,"async"),e.YNc(5,ni,6,6,"ng-template",null,2,e.W1O)),2&i){const s=e.MAs(6);let a;e.Q6J("ngIf",(null==(a=e.lcZ(1,3,o.categories))?null:a.length)&&(null==(a=e.lcZ(2,5,o.products))?null:a._count))("ngIfElse",s),e.xp6(3),e.Q6J("ngIf",e.lcZ(4,7,o.loading))}},dependencies:[p.sg,p.O5,p.RF,p.n9,p.ED,te.pW,b.wG,Pn.A,f.rH,p.Ov],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}\n\n/*# sourceMappingURL=asset-item-list.component.ts-angular-inline--119.css.map*/"]})}return n})();var ii=l(6577),oi=l(6362);function si(n,r){if(1&n&&(e.TgZ(0,"h3",30),e._uU(1),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(2);let i;e.xp6(1),e.hij(" Associated Assets (",(null==(i=e.lcZ(2,1,t.asset_list))?null:i.length)||"0",") ")}}const ri=()=>[],ai=()=>["name","identifier","serial_number","actions"],li=()=>["Name","Label/Friendly Name","Serial Number"," "],ci=()=>["10r","11r","8r","flex"],pi=n=>({actions:n});function di(n,r){if(1&n&&(e._UZ(0,"custom-table",31),e.ALo(1,"async")),2&n){const t=e.oxw(2);e.Q6J("dataSource",e.lcZ(1,5,t.asset_list)||e.DdM(7,ri))("columns",e.DdM(8,ai))("display_column",e.DdM(9,li))("column_size",e.DdM(10,ci))("template",e.VKq(11,pi,t.action_template))}}const ui=(n,r)=>[n,"view",r],_i=n=>[n,"list","purchase-orders"];function mi(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",3)(1,"header",4)(2,"h2",5),e._uU(3),e.qZA()(),e.TgZ(4,"main",6)(5,"div",7)(6,"label",8),e._uU(7," Order Number"),e.TgZ(8,"span"),e._uU(9,"*"),e.qZA()(),e.TgZ(10,"mat-form-field",9),e._UZ(11,"input",10),e.TgZ(12,"mat-error"),e._uU(13,"Order number is required"),e.qZA()()(),e.TgZ(14,"div",7)(15,"label",11),e._uU(16," Invoice Number "),e.qZA(),e.TgZ(17,"mat-form-field",9),e._UZ(18,"input",12),e.TgZ(19,"mat-error"),e._uU(20,"Invoice number is required"),e.qZA()()(),e.TgZ(21,"div",13)(22,"div",14)(23,"label",15),e._uU(24," Purchase Date "),e.qZA(),e._UZ(25,"a-date-field",16),e.qZA(),e.TgZ(26,"div",14)(27,"label",17),e._uU(28," Purchase Price "),e.qZA(),e.TgZ(29,"mat-form-field",18)(30,"div",19),e._uU(31,"$"),e.qZA(),e._UZ(32,"input",20),e.qZA()()(),e.TgZ(33,"div",13)(34,"div",7)(35,"label",21),e._uU(36," Expected Service Start Date "),e.qZA(),e._UZ(37,"a-date-field",22),e.qZA(),e.TgZ(38,"div",7)(39,"label",23),e._uU(40," Expected Service End Date "),e.qZA(),e._UZ(41,"a-date-field",24),e.qZA()(),e.YNc(42,si,3,3,"h3",25)(43,di,2,13,"custom-table",26),e.qZA(),e.TgZ(44,"footer",27)(45,"a",28),e._uU(46," Cancel "),e.qZA(),e.TgZ(47,"button",29),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e._uU(48," Save "),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.hij(" ",t.form.value.id?"Edit":"Add"," Purchase Order "),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(21),e.Q6J("from",t.from),e.xp6(7),e.Q6J("from",t.from),e.xp6(5),e.Q6J("from",t.from),e.xp6(5),e.Q6J("ngIf",null==t.item?null:t.item.id),e.xp6(1),e.Q6J("ngIf",null==t.item?null:t.item.id),e.xp6(2),e.Q6J("routerLink",t.product_id?e.WLB(8,ui,t.base_route,t.product_id):e.VKq(11,_i,t.base_route))}}function gi(n,r){if(1&n&&(e.TgZ(0,"div",32),e._UZ(1,"mat-spinner",33),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("diameter",32),e.xp6(2),e.Oqu(t.loading)}}let Ze=(()=>{class n extends u.cx{get base_route(){return this._state.base_route}constructor(t,i,o,s){var a;super(),a=this,this._state=t,this._route=i,this._router=o,this._org=s,this.form=(0,m.dY)(),this.loading="",this._id=new L.X(""),this.from=(0,ii.Z)(Date.now(),-5),this.asset_list=(0,A.aj)([this._id,this._org.active_building]).pipe((0,K.h)(([c,d])=>!!c&&!!d),(0,M.w)(([c])=>(0,m.Q6)({order_id:c})),(0,M.w)(function(){var c=(0,_.Z)(function*(d){const x=yield(0,m.iF)({zone_id:a._org.building.id,limit:500}).toPromise();return d.map(v=>({...v,name:x.find(w=>w.id===v.asset_type_id)?.name||v.id}))});return function(d){return c.apply(this,arguments)}}()),(0,U.d)(1))}ngOnInit(){var t=this;this.subscription("route.query",this._route.queryParamMap.subscribe(function(){var i=(0,_.Z)(function*(o){if(o.get("id")){t.loading="Loading purchase order details...";const s=yield(0,m.l5)(o.get("id")).toPromise().catch(()=>null);s||((0,u.cB)("Unable to load purchase order details."),t._router.navigate([t.base_route])),t.form.patchValue({...s,order_number:s.purchase_order_number,purchase_date:1e3*s.purchase_date,expected_service_end_date:1e3*s.expected_service_end_date,expected_service_start_date:1e3*s.expected_service_start_date}),t.item=s,t._id.next(s.id),t.loading=""}o.get("group_id")&&(t.product_id=o.get("group_id"))});return function(o){return i.apply(this,arguments)}}())),this._state.setOptions({active_item:null})}save(){var t=this;return(0,_.Z)(function*(){if(!t.form.valid)return;t.loading="Saving Product...";const i=t.form.value;i.purchase_date=(0,F.Z)(i.purchase_date)||null,i.expected_service_start_date=(0,F.Z)(i.expected_service_start_date)||t.item?.expected_service_start_date||null,i.expected_service_end_date=(0,F.Z)(i.expected_service_end_date)||t.item?.expected_service_end_date||null,yield(0,m.aS)(i).toPromise().catch(s=>{throw t.loading="",(0,u.cB)(`Error saving purchase order.: ${s.message}`),s}),t.form.reset(),(0,u.t5)("Successfully saved purchase order."),t._state.postChange(),t._router.navigate(t.product_id?[t.base_route,"view",t.product_id]:[t.base_route,"list","purchase-orders"]),t.loading=""})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z),e.Y36(f.gz),e.Y36(f.F0),e.Y36(I.w7))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-purchase-order-form"]],features:[e.qOj],decls:4,vars:2,consts:[[1,"absolute","inset-0","bg-base-100"],["class","h-full max-w-[32rem] mx-auto flex flex-col",4,"ngIf","ngIfElse"],["load_state",""],[1,"h-full","max-w-[32rem]","mx-auto","flex","flex-col"],[1,"p-4"],[1,"text-center","text-xl","font-medium"],[1,"flex-1","h-1/2","overflow-auto",3,"formGroup"],[1,"flex","flex-col","space-y-2"],["for","order-number"],["appearance","outline"],["matInput","","name","order-number","placeholder","Order Number","formControlName","order_number"],["for","invoice-number"],["matInput","","name","invoice-number","placeholder","Invoice Number","formControlName","invoice_number"],[1,"flex","space-x-2"],[1,"flex-1","flex","flex-col","space-y-2"],["for","purchase-date"],["name","purchase-date","formControlName","purchase_date",3,"from"],["for","unit-price"],["appearance","outline",1,"w-full"],["matPrefix",""],["matInput","","name","unit-price","formControlName","unit_price",3,"from"],["for","depreciation-start-date"],["name","depreciation-start-date","formControlName","expected_service_start_date",3,"from"],["for","depreciation-end-date"],["name","depreciation-end-date","formControlName","expected_service_end_date"],["class","font-medium mb-2",4,"ngIf"],["asset-view","","class","w-full block text-sm","empty","No assets for this purchase order",3,"dataSource","columns","display_column","column_size","template",4,"ngIf"],[1,"flex","justify-end","space-x-2","p-2","border-t","border-base-200"],["btn","","matRipple","",1,"w-32","inverse",3,"routerLink"],["btn","","matRipple","",1,"w-32",3,"click"],[1,"font-medium","mb-2"],["asset-view","","empty","No assets for this purchase order",1,"w-full","block","text-sm",3,"dataSource","columns","display_column","column_size","template"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,mi,49,13,"div",1),e.qZA(),e.YNc(2,gi,4,2,"ng-template",null,2,e.W1O)),2&i){const s=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!o.loading)("ngIfElse",s)}},dependencies:[p.O5,T.KE,T.TO,T.qo,O.Nt,N.Ou,b.wG,g.Fj,g.JJ,g.JL,g.sg,g.u,oi.Q,J.C,f.rH,p.Ov]})}return n})();function fi(n,r){if(1&n&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.purchase_order_number||t.invoice_number," ")}}function hi(n,r){1&n&&(e.TgZ(0,"mat-option",25),e._uU(1," No purchase orders "),e.qZA()),2&n&&e.Q6J("disabled",!0)}const xi=()=>({standalone:!0}),vi=(n,r)=>[n,"view",r],bi=n=>[n];function yi(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",3)(1,"header",4)(2,"h2",5),e._uU(3),e.qZA()(),e.TgZ(4,"main",6)(5,"div",7)(6,"label",8),e._uU(7,"Product"),e.qZA(),e.TgZ(8,"mat-form-field",9),e._UZ(9,"input",10),e.qZA()(),e.TgZ(10,"div",11)(11,"div",7)(12,"label",12),e._uU(13," Serial Number "),e.qZA(),e.TgZ(14,"mat-form-field",9),e._UZ(15,"input",13),e.TgZ(16,"mat-error"),e._uU(17,"Serial Number is required"),e.qZA()()(),e.TgZ(18,"div",7)(19,"label",14),e._uU(20,"Label/Friendly Name"),e.qZA(),e.TgZ(21,"mat-form-field",9),e._UZ(22,"input",15),e.TgZ(23,"mat-error"),e._uU(24," Label/Friendly Name is required "),e.qZA()()()(),e.TgZ(25,"div",7)(26,"label",16),e._uU(27," Purchase Order ID "),e.qZA(),e.TgZ(28,"mat-form-field",9)(29,"mat-select",17),e.YNc(30,fi,2,2,"mat-option",18),e.ALo(31,"async"),e.YNc(32,hi,2,1,"mat-option",19),e.ALo(33,"async"),e.qZA(),e.TgZ(34,"mat-error"),e._uU(35," Purchase Order ID is required "),e.qZA()()(),e.TgZ(36,"div",7)(37,"label",12),e._uU(38,"Barcode"),e.qZA(),e.TgZ(39,"mat-form-field",9),e._UZ(40,"input",20),e.TgZ(41,"mat-error"),e._uU(42,"Barcode is required"),e.qZA()()()(),e.TgZ(43,"footer",21)(44,"a",22),e._uU(45," Cancel "),e.qZA(),e.TgZ(46,"button",23),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e._uU(47," Save "),e.qZA()()()}if(2&n){const t=e.oxw();let i;e.xp6(3),e.hij(" ",t.form.value.id?"Edit":"Add"," Asset "),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(5),e.Q6J("ngModel",(null==t.product?null:t.product.name)||"No Product")("ngModelOptions",e.DdM(12,xi))("disabled",!0),e.xp6(21),e.Q6J("ngForOf",e.lcZ(31,8,t.purchase_orders)),e.xp6(2),e.Q6J("ngIf",!(null!=(i=e.lcZ(33,10,t.purchase_orders))&&i.length)),e.xp6(12),e.Q6J("routerLink",t.product?e.WLB(13,vi,t.base_route,t.product.id):e.VKq(16,bi,t.base_route))}}function Ti(n,r){if(1&n&&(e.TgZ(0,"div",26),e._UZ(1,"mat-spinner",27),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("diameter",32),e.xp6(2),e.Oqu(t.loading)}}let Ae=(()=>{class n extends u.cx{get base_route(){return this._state.base_route}constructor(t,i,o,s){super(),this._state=t,this._route=i,this._router=o,this._org=s,this.form=(0,m.PG)(),this.purchase_orders=this._state.purchase_orders,this.loading=""}ngOnInit(){var t=this;this.subscription("route.query",this._route.queryParamMap.subscribe(function(){var i=(0,_.Z)(function*(o){if(o.get("id")){t.loading="Loading Asset Details...";const s=yield(0,m.dq)(o.get("id")).toPromise().catch(()=>null);s||((0,u.cB)("Unable to load asset details."),t._router.navigate([t.base_route])),t.form.patchValue(s),t.loading=""}if(o.get("group_id")){t.loading="Loading Product Details...";const s=yield(0,m.L)(o.get("group_id")).toPromise().catch(()=>null);s||((0,u.cB)("Unable to load associated product details."),t._router.navigate([t.base_route])),t.product=s,t.form.patchValue({type_id:s.id}),t.loading=""}});return function(o){return i.apply(this,arguments)}}())),this._state.setOptions({active_item:null})}save(){var t=this;return(0,_.Z)(function*(){if(!t.form.valid)return(0,u.cB)(`Some fields are invalid. [${(0,u.RD)(t.form)}]`);t.loading="Saving Product...";const i=t.form.value,o=yield(0,m.U)({...i,zone_id:t._org.building.id}).toPromise().catch(s=>{throw t.loading="",(0,u.cB)(`Error saving asset: ${s.message}`),s});t.form.reset(),t._state.postChange(),t._state.setExtraAssets([o].map(s=>({...s,type_id:t.product.id}))),(0,u.t5)("Asset saved successfully."),t._router.navigate([t.base_route,"view",t.product?.id]),t.loading=""})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z),e.Y36(f.gz),e.Y36(f.F0),e.Y36(I.w7))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-form"]],features:[e.qOj],decls:4,vars:2,consts:[[1,"absolute","inset-0","bg-base-100"],["class","h-full max-w-[32rem] mx-auto flex flex-col",4,"ngIf","ngIfElse"],["load_state",""],[1,"h-full","max-w-[32rem]","mx-auto","flex","flex-col"],[1,"p-4"],[1,"text-center","text-xl","font-medium"],[1,"flex-1","h-1/2","overflow-auto",3,"formGroup"],[1,"flex","flex-1","flex-col","space-y-2"],["for","name"],["appearance","outline"],["matInput","",3,"ngModel","ngModelOptions","disabled"],[1,"flex","items-center","space-x-2"],["for","serial-number"],["matInput","","name","serial-number","placeholder","Serial Number","formControlName","serial_number"],["for","identifier"],["matInput","","name","identifier","placeholder","Identifier, Asset ID or Barcode","formControlName","identifier"],["for","purchase-order-id"],["formControlName","purchase_order_id","placeholder","Select Purchase Order"],[3,"value",4,"ngFor","ngForOf"],["class","opacity-60",3,"disabled",4,"ngIf"],["matInput","","name","barcode","placeholder","Barcode","formControlName","barcode"],[1,"flex","justify-end","space-x-2","p-2","border-t","border-base-200"],["btn","","matRipple","",1,"w-32","inverse",3,"routerLink"],["btn","","matRipple","",1,"w-32",3,"click"],[3,"value"],[1,"opacity-60",3,"disabled"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,yi,48,18,"div",1),e.qZA(),e.YNc(2,Ti,4,2,"ng-template",null,2,e.W1O)),2&i){const s=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!o.loading)("ngIfElse",s)}},dependencies:[p.sg,p.O5,T.KE,T.TO,O.Nt,Y.gD,b.ey,N.Ou,b.wG,g.Fj,g.JJ,g.JL,g.On,g.sg,g.u,f.rH,p.Ov]})}return n})();var Zi=l(4035);function Ai(n,r){if(1&n&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}const Ci=(n,r)=>[n,"view",r],wi=n=>[n,"list","items"];function Mi(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",3)(1,"header",4)(2,"h2",5),e._uU(3),e.qZA()(),e.TgZ(4,"main",6)(5,"div",7)(6,"label",8),e._uU(7,"Name"),e.TgZ(8,"span"),e._uU(9,"*"),e.qZA()(),e.TgZ(10,"mat-form-field",9),e._UZ(11,"input",10),e.TgZ(12,"mat-error"),e._uU(13,"Name is required"),e.qZA()()(),e.TgZ(14,"div",7)(15,"label",8),e._uU(16,"Category"),e.TgZ(17,"span"),e._uU(18,"*"),e.qZA()(),e.TgZ(19,"mat-form-field",9)(20,"mat-select",11),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.current_category=o.form.value.category_id)}),e.YNc(21,Ai,2,2,"mat-option",12),e.ALo(22,"async"),e.TgZ(23,"mat-option",13),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.newCategory())}),e.TgZ(24,"div",14)(25,"app-icon"),e._uU(26,"add"),e.qZA(),e.TgZ(27,"p"),e._uU(28,"New Category"),e.qZA()()()(),e.TgZ(29,"mat-error"),e._uU(30,"Category is required"),e.qZA()()(),e.TgZ(31,"div",7)(32,"label",15),e._uU(33,"Brand"),e.TgZ(34,"span"),e._uU(35,"*"),e.qZA()(),e.TgZ(36,"mat-form-field",9),e._UZ(37,"input",16),e.TgZ(38,"mat-error"),e._uU(39,"Brand is required"),e.qZA()()(),e.TgZ(40,"div",7)(41,"label",17),e._uU(42,"Description"),e.qZA(),e.TgZ(43,"mat-form-field",9),e._UZ(44,"textarea",18),e.TgZ(45,"mat-error"),e._uU(46,"Description is required"),e.qZA()()(),e.TgZ(47,"div",7)(48,"label",19),e._uU(49,"Images"),e.qZA(),e._UZ(50,"image-list-field",20),e.qZA()(),e.TgZ(51,"footer",21)(52,"a",22),e._uU(53," Cancel "),e.qZA(),e.TgZ(54,"button",23),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e._uU(55," Save "),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.hij(" ",t.form.value.id?"Edit":"Add"," Product "),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(17),e.Q6J("ngForOf",e.lcZ(22,4,t.categories)),e.xp6(31),e.Q6J("routerLink",t.form.value.id?e.WLB(6,Ci,t.base_route,t.form.value.id):e.VKq(9,wi,t.base_route))}}function Si(n,r){if(1&n&&(e.TgZ(0,"div",25),e._UZ(1,"mat-spinner",26),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("diameter",32),e.xp6(2),e.Oqu(t.loading)}}let Ce=(()=>{class n extends u.cx{get base_route(){return this._state.base_route}constructor(t,i,o,s){super(),this._state=t,this._route=i,this._router=o,this._dialog=s,this.form=(0,m.UN)(),this.new_category=new L.X(null),this.categories=(0,A.aj)([this._state.categories,this.new_category]).pipe((0,y.U)(([a,c])=>c?(0,u.Tw)([...a,c],"id"):a)),this.loading=""}ngOnInit(){var t=this;this.subscription("route.query",this._route.queryParamMap.subscribe(function(){var i=(0,_.Z)(function*(o){if(o.get("id")){t.loading="Loading Product Details...";const s=yield(0,m.L)(o.get("id")).toPromise().catch(()=>null);s||((0,u.cB)("Unable to load product details."),t._router.navigate([t.base_route])),t.form.patchValue(s),t.loading=""}});return function(o){return i.apply(this,arguments)}}()))}newCategory(){var t=this;return(0,_.Z)(function*(){t.form.patchValue({category_id:t.current_category});const i=yield t._state.editCategory();i&&(t.new_category.next(i),t.form.patchValue({category_id:i.id}))})()}save(){var t=this;return(0,_.Z)(function*(){if(!t.form.valid)return;t.loading="Saving Product...";const i=t.form.value,o=yield(0,m.E$)(i).toPromise().catch(s=>{throw t.loading="",(0,u.cB)(`Error saving Product: ${s.message}`),s});t.form.reset(),t.loading="",t._state.postChange(),t._router.navigate([t.base_route,"view",o.id])})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z),e.Y36(f.gz),e.Y36(f.F0),e.Y36(C.uw))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-group-form"]],features:[e.qOj],decls:4,vars:2,consts:[[1,"absolute","inset-0","bg-base-100"],["class","h-full max-w-[32rem] mx-auto flex flex-col",4,"ngIf","ngIfElse"],["load_state",""],[1,"h-full","max-w-[32rem]","mx-auto","flex","flex-col"],[1,"p-4"],[1,"text-center","text-xl","font-medium"],[1,"flex-1","h-1/2","overflow-auto","p-2",3,"formGroup"],[1,"flex","flex-col","space-y-2"],["for","name"],["appearance","outline"],["matInput","","name","name","placeholder","Name of the product","formControlName","name"],["formControlName","category_id","placeholder","Category of Product",3,"click"],[3,"value",4,"ngFor","ngForOf"],[1,"relative",3,"click"],[1,"flex","items-center","space-x-2"],["for","brand"],["matInput","","name","brand","placeholder","Brand of the product","formControlName","brand"],["for","description"],["matInput","","name","description","placeholder","Description of the product","formControlName","description"],["for","images"],["name","images","formControlName","images"],[1,"flex","justify-end","space-x-2","p-2","border-t","border-base-200"],["btn","","matRipple","",1,"w-32","inverse",3,"routerLink"],["btn","","matRipple","",1,"w-32",3,"click"],[3,"value"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,Mi,56,11,"div",1),e.qZA(),e.YNc(2,Si,4,2,"ng-template",null,2,e.W1O)),2&i){const s=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!o.loading)("ngIfElse",s)}},dependencies:[p.sg,p.O5,T.KE,T.TO,O.Nt,Y.gD,b.ey,N.Ou,b.wG,g.Fj,g.JJ,g.JL,g.sg,g.u,Zi.h,k.o,f.rH,p.Ov]})}return n})();function qi(n,r){1&n&&(e.TgZ(0,"span",5),e._uU(1,"No Date set"),e.qZA())}function Ii(n,r){if(1&n&&(e.YNc(0,qi,2,0,"span",4),e._uU(1),e.ALo(2,"date")),2&n){const t=r.data;e.Q6J("ngIf",!t),e.xp6(1),e.hij(" ",t?e.xi3(2,2,1e3*t,"mediumDate"):""," ")}}const ki=()=>["purchase_order_number","invoice_number","purchase_date","expected_service_start_date","expected_service_end_date"],Li=()=>["Order Number","Invoice Number","Purchase Date","Depreciation Start","Depreciation End"],Ui=()=>["flex","10r","10r","10r","10r"],Oi=(n,r,t)=>({purchase_date:n,expected_service_start_date:r,expected_service_end_date:t});let we=(()=>{class n{constructor(t,i){this._state=t,this._router=i,this.now=Date.now(),this.purchase_orders=(0,A.aj)([this._state.options,this._state.purchase_orders]).pipe((0,y.U)(([{search:o},s])=>s.filter(a=>!o||a.purchase_order_number.toLowerCase().includes(o.toLowerCase())||a.invoice_number?.toLowerCase().includes(o.toLowerCase())))),this.filters=this._state.options}editOrder(t){this._router.navigate([this._state.base_route,"manage","purchase-order"],{queryParams:{id:t.id}})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z),e.Y36(f.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-asset-purchase-order-list"]],decls:6,vars:15,consts:[[1,"relative","-left-4","w-[calc(100%+2rem)]","mt-4","h-[calc(100%-1rem)]","flex","flex-col"],[1,"w-full","overflow-auto","h-1/2","flex-1","p-4"],["purchase-orders","",1,"block","min-w-[52rem]","text-sm",3,"dataSource","columns","display_column","column_size","template","empty","row_clicked"],["date_template",""],["class","opacity-30",4,"ngIf"],[1,"opacity-30"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"custom-table",2),e.NdJ("row_clicked",function(a){return o.editOrder(a)}),e.ALo(3,"async"),e.qZA()()(),e.YNc(4,Ii,3,5,"ng-template",null,3,e.W1O)),2&i){const s=e.MAs(5);let a;e.xp6(2),e.Q6J("dataSource",o.purchase_orders)("columns",e.DdM(8,ki))("display_column",e.DdM(9,Li))("column_size",e.DdM(10,Ui))("template",e.kEZ(11,Oi,s,s,s))("empty",null!=(a=e.lcZ(3,6,o.filters))&&a.search?"No matching purchase orders found.":"There are purchase orders for this building.")}},dependencies:[p.O5,J.C,p.Ov,p.uU],styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}\n\n/*# sourceMappingURL=asset-purchase-order-list.component.ts-angular-inline--120.css.map*/"]})}return n})();function Ni(n,r){if(1&n&&(e.TgZ(0,"mat-option",23),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.purchase_order_number||t.invoice_number," ")}}function Di(n,r){1&n&&(e.TgZ(0,"mat-option",24),e._uU(1," No purchase orders "),e.qZA()),2&n&&e.Q6J("disabled",!0)}const Me=()=>({standalone:!0}),Fi=(n,r)=>[n,"view",r],Ei=n=>[n];function Pi(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",3)(1,"header",4)(2,"h2",5),e._uU(3),e.qZA()(),e.TgZ(4,"main",6)(5,"div",7)(6,"label",8),e._uU(7,"Product"),e.qZA(),e.TgZ(8,"mat-form-field",9),e._UZ(9,"input",10),e.qZA()(),e.TgZ(10,"div",11)(11,"div",7)(12,"label",12),e._uU(13," Number of Assets to create "),e.qZA(),e.TgZ(14,"mat-form-field",9)(15,"input",13),e.NdJ("ngModelChange",function(o){e.CHM(t);const s=e.oxw();return e.KtG(s.count=o)}),e.qZA()()()(),e.TgZ(16,"div",7)(17,"label",14),e._uU(18,"Label/Friendly Name"),e.qZA(),e.TgZ(19,"mat-form-field",9),e._UZ(20,"input",15),e.TgZ(21,"mat-error"),e._uU(22," Label/Friendly Name is required "),e.qZA()()(),e.TgZ(23,"div",7)(24,"label",16),e._uU(25," Purchase Order ID "),e.qZA(),e.TgZ(26,"mat-form-field",9)(27,"mat-select",17),e.YNc(28,Ni,2,2,"mat-option",18),e.ALo(29,"async"),e.YNc(30,Di,2,1,"mat-option",19),e.ALo(31,"async"),e.qZA(),e.TgZ(32,"mat-error"),e._uU(33," Purchase Order ID is required "),e.qZA()()()(),e.TgZ(34,"footer",20)(35,"a",21),e._uU(36," Cancel "),e.qZA(),e.TgZ(37,"button",22),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e._uU(38," Save "),e.qZA()()()}if(2&n){const t=e.oxw();let i;e.xp6(3),e.hij(" Bulk ",t.form.value.id?"Edit":"Add"," Asset "),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(5),e.Q6J("ngModel",(null==t.product?null:t.product.name)||"No Product")("ngModelOptions",e.DdM(14,Me))("disabled",!0),e.xp6(6),e.Q6J("ngModel",t.count)("ngModelOptions",e.DdM(15,Me)),e.xp6(13),e.Q6J("ngForOf",e.lcZ(29,10,t.purchase_orders)),e.xp6(2),e.Q6J("ngIf",!(null!=(i=e.lcZ(31,12,t.purchase_orders))&&i.length)),e.xp6(5),e.Q6J("routerLink",t.product?e.WLB(16,Fi,t.base_route,t.product.id):e.VKq(19,Ei,t.base_route))}}function Ri(n,r){if(1&n&&(e.TgZ(0,"div",25),e._UZ(1,"mat-spinner",26),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("diameter",32),e.xp6(2),e.Oqu(t.loading)}}let Se=(()=>{class n extends u.cx{get base_route(){return this._state.base_route}constructor(t,i,o,s){super(),this._state=t,this._route=i,this._router=o,this._org=s,this.form=(0,m.PG)(),this.purchase_orders=this._state.purchase_orders,this.count=2,this.loading=""}ngOnInit(){var t=this;this.subscription("route.query",this._route.queryParamMap.subscribe(function(){var i=(0,_.Z)(function*(o){if(o.get("id")){t.loading="Loading Asset Details...";const s=yield(0,m.dq)(o.get("id")).toPromise().catch(()=>null);s||((0,u.cB)("Unable to load asset details."),t._router.navigate([t.base_route])),t.form.patchValue(s),t.loading=""}if(o.get("group_id")){t.loading="Loading Product Details...";const s=yield(0,m.L)(o.get("group_id")).toPromise().catch(()=>null);s||((0,u.cB)("Unable to load associated product details."),t._router.navigate([t.base_route])),t.product=s,t.form.patchValue({type_id:s.id}),t.loading=""}});return function(o){return i.apply(this,arguments)}}())),this._state.setOptions({active_item:null}),this.count=2}save(){var t=this;return(0,_.Z)(function*(){if(!t.count&&t.count<1)return(0,u.cB)("Please enter a valid number of assets to add.");if(!t.form.valid)return(0,u.cB)(`Some fields are invalid. [${(0,u.RD)(t.form)}]`);t.loading="Saving Product...";const i=t.form.value,o=yield(0,m.NI)(new Array(t.count).fill({...i,zone_id:t._org.building.id})).toPromise().catch(s=>{throw t.loading="",(0,u.cB)(`Error saving asset: ${s.message}`),s});t._state.setExtraAssets(o.map(s=>({...s,type_id:t.product.id}))),t.form.reset(),t._state.postChange(),(0,u.t5)(`Asset added ${o.length} successfully.`),t._router.navigate([t.base_route,"view",t.product?.id]),t.loading=""})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(Z),e.Y36(f.gz),e.Y36(f.F0),e.Y36(I.w7))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["asset-bulk-form"]],features:[e.qOj],decls:4,vars:2,consts:[[1,"absolute","inset-0","bg-base-100"],["class","h-full max-w-[32rem] mx-auto flex flex-col",4,"ngIf","ngIfElse"],["load_state",""],[1,"h-full","max-w-[32rem]","mx-auto","flex","flex-col"],[1,"p-4"],[1,"text-center","text-xl","font-medium"],[1,"flex-1","h-1/2","overflow-auto",3,"formGroup"],[1,"flex","flex-1","flex-col","space-y-2"],["for","name"],["appearance","outline"],["matInput","",3,"ngModel","ngModelOptions","disabled"],[1,"flex","items-center","space-x-2"],["for","count"],["matInput","","name","count","type","number","placeholder","Number of assets to add",3,"ngModel","ngModelOptions","ngModelChange"],["for","identifier"],["matInput","","name","identifier","placeholder","Identifier, Asset ID or Barcode","formControlName","identifier"],["for","purchase-order-id"],["formControlName","purchase_order_id","placeholder","Select Purchase Order"],[3,"value",4,"ngFor","ngForOf"],["class","opacity-60",3,"disabled",4,"ngIf"],[1,"flex","justify-end","space-x-2","p-2","border-t","border-base-200"],["btn","","matRipple","",1,"w-32","inverse",3,"routerLink"],["btn","","matRipple","",1,"w-32",3,"click"],[3,"value"],[1,"opacity-60",3,"disabled"],[1,"absolute","inset-0","flex","flex-col","items-center","justify-center","space-y-2"],[3,"diameter"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0),e.YNc(1,Pi,39,21,"div",1),e.qZA(),e.YNc(2,Ri,4,2,"ng-template",null,2,e.W1O)),2&i){const s=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!o.loading)("ngIfElse",s)}},dependencies:[p.sg,p.O5,T.KE,T.TO,O.Nt,Y.gD,b.ey,N.Ou,b.wG,g.Fj,g.wV,g.JJ,g.JL,g.On,g.sg,g.u,f.rH,p.Ov]})}return n})();var Ji=l(3005),Qi=l(9842);const ji=["asset-manager",""];const Ie=[{path:"list",component:ce,children:[{path:"items",component:Te},{path:"requests",component:be},{path:"purchase-orders",component:we},{path:"**",redirectTo:"requests"}]},{path:"view/:id",component:fe},{path:"manage",children:[{path:"group",component:Ce},{path:"asset",component:Ae},{path:"asset-bulk",component:Se},{path:"category",component:$},{path:"purchase-order",component:Ze}]},{path:"**",redirectTo:"list/requests"}],zi=[{path:"new",component:(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["","asset-manager",""]],attrs:ji,decls:5,vars:0,consts:[[1,"flex","flex-1","h-px"],[1,"flex","flex-col","flex-1","w-1/2","h-full"]],template:function(i,o){1&i&&(e._UZ(0,"app-topbar"),e.TgZ(1,"div",0),e._UZ(2,"app-sidebar"),e.TgZ(3,"main",1),e._UZ(4,"router-outlet"),e.qZA()())},dependencies:[Ji.O,Qi.u,f.lC],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;background-color:var(--b1)}\n\n/*# sourceMappingURL=new-asset-manager.component.ts-angular-inline--121.css.map*/"]})}return n})(),children:Ie},{path:"",component:pe,children:Ie},{path:"**",redirectTo:""}];let Hi=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[p.ez,it.v,P.Kk,V.vV,te.Cv,R.Nh,nt,f.Bz.forChild(zi)]})}return n})()}}]);
//# sourceMappingURL=apps_concierge_src_app_asset-manager_asset-manager_module_ts.js.map