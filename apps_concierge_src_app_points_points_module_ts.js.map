{"version":3,"sources":["./apps/concierge/src/app/points/points-assets.component.ts","./apps/concierge/src/app/points/points-overview.component.ts","./apps/concierge/src/app/points/asset-modal.component.ts","./apps/concierge/src/app/points/points-topbar.component.ts","./apps/concierge/src/app/points/points.component.ts","./apps/concierge/src/app/points/points.module.ts"],"names":["PointsAssetsComponent","asset_list","id","name","type","unit_price","accept_points","discount_cap","custom_rates","PointsOverviewComponent","points","value","desk_checkin","room_checkin","booking_cancel","wellness_card","this","loadPoints","toFixed","JSON","parse","localStorage","getItem","setItem","stringify","storePoints","PointsAssetModalComponent","form","PointsTopbarComponent","_org","super","initialised","pipe","first","_","toPromise","ROUTES","path","component","PointsComponent","_dialog","_router","subscription","events","subscribe","parts","url","split","page","length","console","log","open","children","redirectTo","PointsModule"],"mappings":"qSA+CY,kBAAiD,SAAU,S,oBAAV,mB,yBAGjD,kBAAuB,S,oBAAqC,S,oBAArC,mD,yBAGvB,iBACI,sBAKI,SACJ,QACJ,S,oBALQ,iCAA2B,iBAG3B,mD,yBAKR,iBAA6B,SAAW,S,oBAAX,0B,kRAYlC,Y,MAAMA,EA3Db,cA4DW,KAAAC,WAA2B,CAC9B,CACIC,GAAI,IACJC,KAAM,oBACNC,KAAM,QACNC,WAAY,IACZC,eAAe,EACfC,aAAc,GACdC,aAAc,IAElB,CACIN,GAAI,IACJC,KAAM,oBACNC,KAAM,QACNC,WAAY,KACZC,eAAe,EACfC,aAAc,GACdC,aAAc,M,6CAlBbR,I,wBAAAA,EAAqB,oa,GAAA,MAxD1B,0BA0BA,0CAGA,0CAGA,0CAWA,2C,uDAzCI,iCAAyB,qBAAzB,CAAyB,4BAAzB,CAAyB,yBAAzB,CAAyB,iC,6HAsD9B,G,wBCIA,Y,MAAMS,EA9Eb,cA+EW,KAAAC,OAAS,CACZC,MAAO,GACPC,aAAc,EACdC,aAAc,EACdC,eAAgB,EAChBC,cAAe,GAGZ,WACHC,KAAKC,aAGF,YAAYN,EAAgB,GAC/B,MAAO,IAAIA,aAAK,EAALA,EAAOO,QAAQ,KAGvB,aACHF,KAAKN,OAAS,OAAH,wBACJM,KAAKN,QACLS,KAAKC,MACJC,aAAaC,QAAQ,0BAA4B,OAKtD,cACHD,aAAaE,QACT,wBACAJ,KAAKK,UAAUR,KAAKN,U,6CA7BnBD,I,wBAAAA,EAAuB,kqBA3E5B,gBACI,4BACJ,QACA,qBACI,gBAA8C,uBAAW,QACzD,iBACI,gBAAM,qBAAS,QACf,uBAGI,4DAA0B,kCACT,EAAAgB,gBAEpB,QACD,sBACI,mBACJ,QACJ,QACJ,QACA,sBACI,iBAA8C,8BAAiB,QAC/D,kBACI,kBAGI,wBAEI,mEAAiC,kCAChB,EAAAA,gBACpB,QACD,iBAAM,qCAAwB,QAClC,QACA,kBAGI,wBAEI,mEAAiC,kCAChB,EAAAA,gBACpB,QACD,iBAAM,qCAAwB,QAClC,QACA,kBAGI,wBAEI,qEAAmC,kCAClB,EAAAA,gBACpB,QACD,iBACK,gEACK,QAEd,QACA,mBACI,wBAEI,oEAAkC,kCACjB,EAAAA,gBACpB,QACD,iBAAM,gDAAmC,QAC7C,QACJ,QACJ,S,MAvDY,0BAAY,yBAAZ,CAAY,2BAkBR,gDAUA,gDAUA,kDAWA,mD,yGAiBjB,G,qECtEC,kBACI,qBACI,iBACI,mBAAsB,gCAAoB,QAC1C,uBAQJ,QACA,iBACI,cAAI,sBAAU,QACd,eACJ,QACJ,QACA,uBACI,kBACI,kBAAO,2BAAc,QACrB,4BAGJ,QACA,kBACI,oBAAsB,yBAAY,QAClC,yBAQJ,QACJ,QACJ,S,qBArCyD,0BAOzC,0BAAW,UAAX,CAAW,WAAX,CAAW,2BAuBX,yBAAS,UAAT,CAAS,SAAT,CAAS,8BAyB1B,Y,MAAMC,EAGF,YAAYf,EAAgB,G,MAC/B,MAAO,IAAiB,QAAZ,EAAAA,EAAQ,WAAI,eAAEO,QAAQ,KAG/B,cAAcP,EAAgB,GACjC,MAAO,GAAGA,KAGP,WACHK,KAAKW,KAAO,IAAI,KAAU,CACtBzB,GAAI,IAAI,KAAY,OAAM,QAAU,cACpCC,KAAM,IAAI,KAAY,IACtBC,KAAM,IAAI,KAAY,IACtBE,cAAe,IAAI,MAAY,GAC/BC,aAAc,IAAI,KAAY,IAC9BF,WAAY,IAAI,KAAY,KAC5BG,aAAc,IAAI,KAAY,O,6CAnB7BkB,I,wBAAAA,EAAyB,wtBA1D9B,kBACI,cAAI,4BAAgB,QACxB,QACA,yBAsCA,oBAGI,oBACI,oBACJ,QACA,oBAAkC,gBAAI,QAC1C,S,MA7C6C,gC,2IAuD9C,G,oEC5BA,Y,MAAME,UAA8B,KAEvC,YACYC,GAERC,QAFQ,KAAAD,OAKC,W,oDACHb,KAAKa,KAAKE,YAAYC,MAAK,EAAAC,EAAA,GAAOC,GAAMA,IAAIC,e,6CAT7CP,GAAqB,c,wBAArBA,EAAqB,4I,QA5B1B,iBACI,SACJ,QAEA,0B,0SAwBD,G,wCCzBS,oBAA6C,8DAAqB,qBAAS,S,0FCCrFQ,EAAkB,CACpB,CACIC,KAAM,GACNC,UD8BD,M,MAAMC,UAAwB,KAIjC,YAAoBC,EAA4BC,GAC5CX,QADgB,KAAAU,UAA4B,KAAAC,UAIzC,WACHzB,KAAK0B,aACD,eACA1B,KAAKyB,QAAQE,OAAOC,UAAU,KAC1B,MAAMC,EAAQ7B,KAAKyB,QAAQK,IAAIC,MAAM,KACrC/B,KAAKgC,KAAOH,EAAMA,EAAMI,OAAS,GACjCC,QAAQC,IAAI,OAAQnC,KAAKgC,SAGjC,MAAMH,EAAQ7B,KAAKyB,QAAQK,IAAIC,MAAM,KACrC/B,KAAKgC,KAAOH,EAAMA,EAAMI,OAAS,GAG9B,WACHjC,KAAKwB,QAAQY,KAAK1B,I,6CAtBba,GAAe,0B,wBAAfA,EAAe,wVArCpB,mBACA,kBACI,2BACI,0BACJ,QACA,iBACI,eAKI,sBACJ,QACA,eAKI,oBACJ,QACJ,QACA,iBACI,0BACJ,QACJ,S,MArBiB,yCAKL,wCAAsC,8BAOtC,wCAAoC,8B,4IAsBjD,GC7BCc,SAAU,CACN,CAAEhB,KAAM,GAAIiB,WAAY,YACxB,CAAEjB,KAAM,SAAUC,UAAWtC,GAC7B,CAAEqC,KAAM,WAAYC,UAAW7B,GAC/B,CAAE4B,KAAM,IAAKiB,WAAY,eAsB9B,Y,MAAMC,G,6CAAAA,I,wBAAAA,I,4BATA,CACL,KACA,KACA,IACA,KACA,KACA,cAAsBnB,O,GAGvB","file":"apps_concierge_src_app_points_points_module_ts.js","sourcesContent":["import { Component } from '@angular/core';\n\nexport interface CustomRate {\n    rate: number;\n    conditions: any;\n}\n\nexport interface PointAsset {\n    id: string;\n    name: string;\n    type: 'space' | 'desk' | 'parking';\n    accept_points: boolean;\n    discount_cap: number;\n    unit_price: number;\n    custom_rates: CustomRate[];\n}\n\n@Component({\n    selector: 'points-assets',\n    template: `\n        <custom-table\n            class=\"w-full h-full\"\n            [dataSource]=\"asset_list\"\n            [columns]=\"[\n                'name',\n                'type',\n                'unit_price',\n                'accept_points',\n                'discount_cap'\n            ]\"\n            [display_column]=\"[\n                'Name',\n                'Type',\n                'Unit Price',\n                'Accepts Points',\n                'Discount %'\n            ]\"\n            [column_size]=\"['flex']\"\n            [template]=\"{\n                type: type_template,\n                unit_price: price_template,\n                accept_points: accept_template,\n                discount_cap: discount_template\n            }\"\n            empty=\"No priced assets\"\n        ></custom-table>\n        <ng-template #type_template let-data=\"data\">\n            <span class=\"p-2 bg-gray-200 rounded capitalize\">{{ data }}</span>\n        </ng-template>\n        <ng-template #price_template let-data=\"data\">\n            <span class=\"text-xs\"> {{ data / 100 | currency }} per hour </span>\n        </ng-template>\n        <ng-template #accept_template let-data=\"data\">\n            <div class=\"flex justify-center h-px\">\n                <app-icon\n                    class=\"text-2xl\"\n                    [class.text-success]=\"data\"\n                    [class.text-error]=\"!data\"\n                >\n                    {{ data ? 'check_circle' : 'cancel' }}\n                </app-icon>\n            </div>\n        </ng-template>\n        <ng-template #discount_template let-data=\"data\">\n            <div class=\"text-right px-4\">{{ data }}%</div>\n        </ng-template>\n    `,\n    styles: [`\n        :host {\n            height: 100%;\n            width: 100%;\n            overflow-x: auto;\n            overflow-y: hidden;\n        }\n    `],\n})\nexport class PointsAssetsComponent {\n    public asset_list: PointAsset[] = [\n        {\n            id: '1',\n            name: 'Meeting Room 1.01',\n            type: 'space',\n            unit_price: 3000,\n            accept_points: false,\n            discount_cap: 99,\n            custom_rates: [],\n        },\n        {\n            id: '2',\n            name: 'Meeting Room 1.02',\n            type: 'space',\n            unit_price: 2800,\n            accept_points: true,\n            discount_cap: 30,\n            custom_rates: [],\n        },\n    ];\n}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'points-overview',\n    template: `\n        <h2 class=\"p-2 bg-secondary text-white w-full  font-medium text-lg\">\n            Point Overview\n        </h2>\n        <section class=\"bg-white w-full\">\n            <h2 class=\"p-2 underline font-medium text-lg\">Point Value</h2>\n            <div class=\"flex items-center space-x-2 p-2 mb-4\">\n                <span>1 point =</span>\n                <a-counter\n                    class=\"bg-white rounded border border-gray-200\"\n                    [step]=\"0.1\"\n                    [(ngModel)]=\"points.value\"\n                    (ngModelChange)=\"storePoints()\"\n                    [render_fn]=\"renderPrice\"\n                ></a-counter>\n                <app-icon matTooltip=\"Set point redemption caps on menu items\">\n                    info\n                </app-icon>\n            </div>\n        </section>\n        <section class=\"bg-white w-full flex-1\">\n            <h2 class=\"p-2 underline font-medium text-lg\">Automatic Rewards</h2>\n            <div class=\"p-4\">\n                <div\n                    class=\"flex items-center space-x-2 p-2 border-b border-gray-200\"\n                >\n                    <a-counter\n                        class=\"bg-white rounded border border-gray-200\"\n                        [(ngModel)]=\"points.desk_checkin\"\n                        (ngModelChange)=\"storePoints()\"\n                    ></a-counter>\n                    <span>Points for desk check-in</span>\n                </div>\n                <div\n                    class=\"flex items-center space-x-2 p-2 border-b border-gray-200\"\n                >\n                    <a-counter\n                        class=\"bg-white rounded border border-gray-200\"\n                        [(ngModel)]=\"points.room_checkin\"\n                        (ngModelChange)=\"storePoints()\"\n                    ></a-counter>\n                    <span>Points for room check-in</span>\n                </div>\n                <div\n                    class=\"flex items-center space-x-2 p-2 border-b border-gray-200\"\n                >\n                    <a-counter\n                        class=\"bg-white rounded border border-gray-200\"\n                        [(ngModel)]=\"points.booking_cancel\"\n                        (ngModelChange)=\"storePoints()\"\n                    ></a-counter>\n                    <span\n                        >Points for booking cancellation with 24 hour\n                        notice</span\n                    >\n                </div>\n                <div class=\"flex items-center space-x-2 p-2 \">\n                    <a-counter\n                        class=\"bg-white rounded border border-gray-200\"\n                        [(ngModel)]=\"points.wellness_card\"\n                        (ngModelChange)=\"storePoints()\"\n                    ></a-counter>\n                    <span>Points for completing wellness card</span>\n                </div>\n            </div>\n        </section>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n            }\n        `,\n    ],\n})\nexport class PointsOverviewComponent {\n    public points = {\n        value: 0.1,\n        desk_checkin: 2,\n        room_checkin: 2,\n        booking_cancel: 3,\n        wellness_card: 1,\n    };\n\n    public ngOnInit() {\n        this.loadPoints();\n    }\n\n    public renderPrice(value: number = 0) {\n        return `$${value?.toFixed(2)}`;\n    }\n\n    public loadPoints() {\n        this.points = {\n            ...this.points,\n            ...JSON.parse(\n                localStorage.getItem('PLACEOS.point_details') || '{}'\n            ),\n        };\n    }\n\n    public storePoints() {\n        localStorage.setItem(\n            'PLACEOS.point_details',\n            JSON.stringify(this.points)\n        );\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { randomInt } from '@placeos/common';\n\n@Component({\n    selector: 'points-asset-modal',\n    template: `\n        <header>\n            <h2>New Points Asset</h2>\n        </header>\n        <main class=\"min-w-[24rem] overflow-hidden\" *ngIf=\"form\" [formGroup]=\"form\">\n            <section class=\"p-2\">\n                <div class=\"flex items-center\">\n                    <label class=\"flex-1\">Standard hourly rate</label>\n                    <a-counter\n                        class=\"border border-gray-200 rounded\"\n                        formControlName=\"unit_price\"\n                        [min]=\"500\"\n                        [max]=\"80000\"\n                        [step]=\"500\"\n                        [render_fn]=\"renderPrice\"\n                    ></a-counter>\n                </div>\n                <div class=\"\">\n                    <h2>Rate Rules</h2>\n                    <div></div>\n                </div>\n            </section>\n            <section class=\"border-t border-gray-200 p-2\">\n                <div class=\"flex items-center\">\n                    <label>Accept Points?</label>\n                    <mat-checkbox\n                        formControlName=\"accept_points\"\n                    ></mat-checkbox>\n                </div>\n                <div class=\"flex items-center\">\n                    <label class=\"flex-1\">Discount Cap</label>\n                    <a-counter\n                        class=\"border border-gray-200 rounded\"\n                        formControlName=\"discount_cap\"\n                        [min]=\"0\"\n                        [max]=\"100\"\n                        [step]=\"5\"\n                        [render_fn]=\"renderPercent\"\n                    ></a-counter>\n                </div>\n            </section>\n        </main>\n        <footer\n            class=\"flex items-center justify-center p-2 space-x-2 border-t border-gray-200\"\n        >\n            <button mat-button mat-dialog-close class=\"inverse flex-1\">\n                Cancel\n            </button>\n            <button mat-button class=\"flex-1\">Save</button>\n        </footer>\n    `,\n    styles: [`\n        label {\n            width: auto;\n            min-width: 0;\n            margin: 0 1rem 0 0;\n        }\n    `],\n})\nexport class PointsAssetModalComponent implements OnInit {\n    public form: FormGroup;\n\n    public renderPrice(value: number = 0) {\n        return `$${(value / 100)?.toFixed(2)}`;\n    }\n\n    public renderPercent(value: number = 0) {\n        return `${value}%`;\n    }\n\n    public ngOnInit() {\n        this.form = new FormGroup({\n            id: new FormControl(`PA-${randomInt(999_999_999)}`),\n            name: new FormControl(''),\n            type: new FormControl(''),\n            accept_points: new FormControl(false),\n            discount_cap: new FormControl(50),\n            unit_price: new FormControl(1000),\n            custom_rates: new FormControl([]),\n        });\n    }\n}\n","import { Component } from '@angular/core';\nimport { BaseClass } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { first } from 'rxjs/operators';\n\n\n@Component({\n    selector: 'points-topbar',\n    template: `\n        <div class=\"flex-1 w-2\">\n            <ng-content></ng-content>\n        </div>\n        <!-- <searchbar class=\"mr-2\"></searchbar> -->\n        <date-options></date-options>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                align-items: center;\n                background-color: #fff;\n                height: 5em;\n                padding: 0 1em;\n                border-bottom: 1px solid #ccc;\n            }\n\n            :host > * + * {\n                margin-left: .5rem;\n            }\n\n            mat-form-field {\n                height: 3.25em;\n                width: 8em;\n            }\n        `,\n    ],\n})\nexport class PointsTopbarComponent extends BaseClass {\n\n    constructor(\n        private _org: OrganisationService,\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Router } from '@angular/router';\nimport { BaseClass } from '@placeos/common';\nimport { PointsAssetModalComponent } from './asset-modal.component';\n\n@Component({\n    selector: 'placeos-points',\n    template: `\n        <sidebar></sidebar>\n        <main class=\"relative w-full flex flex-col\">\n            <points-topbar class=\"relative z-10\">\n                <button *ngIf=\"page === 'assets'\" mat-button (click)=\"newAsset()\">New Asset</button>\n            </points-topbar>\n            <nav mat-tab-nav-bar>\n                <a\n                    mat-tab-link\n                    [routerLink]=\"['/points', 'overview']\"\n                    [active]=\"page === 'overview'\"\n                >\n                    Overview\n                </a>\n                <a\n                    mat-tab-link\n                    [routerLink]=\"['/points', 'assets']\"\n                    [active]=\"page === 'assets'\"\n                >\n                    Assets\n                </a>\n            </nav>\n            <div class=\"flex-1 w-full h-1/2 overflow-auto\">\n                <router-outlet></router-outlet>\n            </div>\n        </main>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                height: 100%;\n                width: 100%;\n                background: var(--bg);\n            }\n        `,\n    ],\n})\nexport class PointsComponent extends BaseClass implements OnInit {\n    /** Page being displayed */\n    public page: string;\n\n    constructor(private _dialog: MatDialog, private _router: Router) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'route.params',\n            this._router.events.subscribe(() => {\n                const parts = this._router.url.split('/');\n                this.page = parts[parts.length - 1];\n                console.log('URL:', this.page);\n            })\n        );\n        const parts = this._router.url.split('/');\n        this.page = parts[parts.length - 1];\n    }\n\n    public newAsset() {\n        this._dialog.open(PointsAssetModalComponent);\n    }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { Route, RouterModule } from '@angular/router';\nimport { UIModule } from '../ui/ui.module';\nimport { PointsAssetModalComponent } from './asset-modal.component';\nimport { PointsAssetsComponent } from './points-assets.component';\nimport { PointsOverviewComponent } from './points-overview.component';\nimport { PointsTopbarComponent } from './points-topbar.component';\nimport { PointsComponent } from './points.component';\n\nconst ROUTES: Route[] = [\n    {\n        path: '',\n        component: PointsComponent,\n        children: [\n            { path: '', redirectTo: 'overview' },\n            { path: 'assets', component: PointsAssetsComponent },\n            { path: 'overview', component: PointsOverviewComponent },\n            { path: '*', redirectTo: 'overview' },\n        ],\n    },\n];\n\n@NgModule({\n    declarations: [\n        PointsComponent,\n        PointsTopbarComponent,\n        PointsOverviewComponent,\n        PointsAssetsComponent,\n        PointsAssetModalComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        UIModule,\n        MatTabsModule,\n        MatChipsModule,\n        RouterModule.forChild(ROUTES),\n    ],\n})\nexport class PointsModule {}\n"],"sourceRoot":"webpack:///"}