{"version":3,"file":"apps_concierge_src_app_day-view_day-view_module_ts.js","mappings":"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","names":["i0","level_r1","id","display_name","name","type_r2","$event","_r3","ctx_r3","updateUIOptions","show_overflow","tmp_1_0","ui_options","DayviewTopbarComponent","AsyncHandler","options","this","_state","setUIOptions","allow_setup_breakdown","_settings","get","constructor","_org","_route","_router","super","zones","types","type_list","map","i","levels","active_levels","setDate","d","newBooking","updateZones","z","navigate","relativeTo","queryParams","zone_ids","join","setZones","updateTypes","setFilters","hide_type","reduce","list","item","includes","push","ngOnInit","_this","_asyncToGenerator","initialised","pipe","first","_","toPromise","subscription","queryParamMap","subscribe","params","has","split","length","level","levelWithID","building","buildings","find","bld","parent_id","filter","zone","lvl","static","__ngFactoryType__","i1","i2","i3","i4","core","VBU","selectors","features","decls","vars","consts","template","rf","ctx","DayviewTopbarComponent_mat_option_8_Template","DayviewTopbarComponent_mat_option_14_Template","DayviewTopbarComponent_mat_slide_toggle_15_Template","_c0","ctx_r0","type","overflow_top","overflow_height","event","title","time","attendees","_r2","view","DayviewEventComponent_div_2_div_3_Template","DayviewEventComponent_div_2_div_4_Template","DayviewEventComponent_div_2_div_5_Template","top","height","organiser","duration","ext","event_end","time_format","DAY_IN_MINUTES","DayviewEventComponent","date","Date","format","addMinutes","guests","status","e","setEvent","ngOnChanges","changes","start","startOfDay","diff","differenceInMinutes","setup_time","breakdown_time","inputs","DayviewEventComponent_div_0_Template","DayviewEventComponent_div_2_Template","DayviewEventComponent_div_3_Template","tmp_0_0","tmp_2_0","show_cleaning","DayviewSpaceComponent_ng_container_0_dayview_event_1_Template","ctx_r1","events","DayviewSpaceComponent","filtered","bookings","bkn","resources","space","email","DayviewSpaceComponent_ng_container_0_Template","ctx_r2","scroll","y","time_r2","x","space_r4","tmp_4_0","space_list","i_r6","HOUR_BLOCKS","Array","fill","idx","DayviewTimelineComponent","blocks","loading","spaces","active_building","switchMap","querySystems","zone_id","limit","catchError","of","data","Space","shareReplay","combineLatest","startPolling","ngOnDestroy","stopPolling","onScroll","requestAnimationFrame","srcElement","scrollLeft","scrollTop","DayviewTimelineComponent_div_4_Template","DayviewTimelineComponent_div_8_Template","_r1","DayviewTimelineComponent_dayview_space_12_Template","DayviewTimelineComponent_div_14_Template","DayviewTimelineComponent_mat_progress_bar_15_Template","DayviewTimelineComponent_view_event_details_17_Template","DayViewComponent","links","route","attrs","event_r4","$implicit","selected","next","typeColor","state","date_end","system","tmp_11_0","host","RoomBookingSearchComponent_div_7_div_6_Template","RoomBookingSearchComponent_div_7_button_9_Template","RoomBookingSearchComponent","color","EventEmitter","show","search","BehaviorSubject","event_list","toLowerCase","is_system_event","showSearch","_input_element","nativeElement","focus","hideSearch","timeout","viewQuery","RoomBookingSearchComponent_app_icon_6_Template","RoomBookingSearchComponent_div_7_Template","getValue","space_r1","formatHour","hour_r2","RoomBookingsTimelineComponent_div_21_div_2_Template","block_height","i_r4","timeToOffset","now","i_r5","block_width","event_r7","all_day","tz","_r6","space_r8","viewEvent","RoomBookingsTimelineComponent_ng_container_28_ng_container_1_button_1_ng_container_2_Template","RoomBookingsTimelineComponent_ng_container_28_ng_container_1_button_1_ng_container_3_Template","i_r9","endToOffset","eventTooltip","RoomBookingsTimelineComponent_ng_container_28_ng_container_1_button_1_Template","RoomBookingsTimelineComponent_ng_container_28_ng_container_1_Template","RoomBookingsTimelineComponent","startOfMinute","valueOf","timezone","tz_offset","getTimezoneOffsetString","_local_tz","block_start","block_end","block_range","Math","min","max","_dialog","is_today","isSameDay","show_time","today","offset","getTimezoneDifferenceInHours","addHours","setHours","end","debounceTime","startWith","_hour_list","from","hours","edit","Intl","DateTimeFormat","resolvedOptions","timeZone","_date_pipe","DatePipe","hour","transform","h","current_tz","start_time","getDate","space_id","scroll_to","ref","open","EventDetailsModalComponent","componentInstance","hide_edit","remove","action","_ref","SetupBreakdownModalComponent","afterClosed","replace","_x","apply","arguments","_this2","content","resp","openConfirmModal","icon","reason","declineEvent","calendar","mailbox","system_id","catch","notifyError","close","notifySuccess","closeAll","RoomBookingsTimelineComponent_div_0_Template","RoomBookingsTimelineComponent_div_4_Template","RoomBookingsTimelineComponent_div_18_Template","RoomBookingsTimelineComponent_div_21_Template","RoomBookingsTimelineComponent_div_22_Template","RoomBookingsTimelineComponent_div_25_Template","RoomBookingsTimelineComponent_div_26_Template","RoomBookingsTimelineComponent_ng_container_28_Template","RoomBookingsTimelineComponent_div_30_Template","tmp_5_0","event_r2","tmp_3_0","images","RoomBookingsApprovalsComponent_div_17_span_7_Template","RoomBookingsApprovalsComponent_div_17_img_9_Template","approve","reject","tmp_6_0","_r4","RoomBookingsApprovalsComponent","value","_show","sessionStorage","setItem","pending","filtered_pending","getItem","binding","mod","getModule","execute","RoomBookingsApprovalsComponent_div_15_Template","RoomBookingsApprovalsComponent_div_17_Template","RoomBookingsApprovalsComponent_div_19_Template","RoomBookingsApprovalsComponent_button_20_Template","RoomWeekBookingsTimelineComponent_div_18_div_4_Template","date_r1","isToday","RoomWeekBookingsTimelineComponent_div_25_button_1_span_9_Template","RoomWeekBookingsTimelineComponent_div_25_button_1_Template","date_r5","RoomWeekBookingsTimelineComponent","days","addDays","startOfWeek","this_week","isSameWeek","dateLeft","dateRight","dateLeftStartOfWeek","dateRightStartOfWeek","_data_pipe","day_list","date_value","event_date_value","event_max_count","poll","RoomWeekBookingsTimelineComponent_div_0_Template","RoomWeekBookingsTimelineComponent_div_4_Template","RoomWeekBookingsTimelineComponent_div_18_Template","RoomWeekBookingsTimelineComponent_div_25_Template","tmp_9_0","level_r2","RoomBookingsComponent_mat_option_21_div_2_Template","use_region","RoomBookingsComponent_ng_container_23_div_1_Template","type_r6","_r5","setFilter","_r7","type_r8","RoomBookingsComponent_For_37_div_0_Template","EMPTY","RoomBookingsComponent","filters","has_approvals","period","active_region","region","levelsForRegion","levelsForBuilding","queryParamsHandling","o","setPeriod","p","take","RoomBookingsComponent_mat_option_21_Template","RoomBookingsComponent_ng_container_23_Template","RoomBookingsComponent_mat_checkbox_34_Template","RoomBookingsComponent_For_37_Template","_forTrack0","RoomBookingsComponent_room_bookings_timeline_39_Template","RoomBookingsComponent_room_week_bookings_timeline_41_Template","RoomBookingsComponent_room_bookings_approvals_43_Template","menu_r9","ROUTES","path","component","NewDayViewComponent","DayViewModule","$C","G2t","CommonModule","FormsModule","UIModule","SharedSpacesModule","SharedUsersModule","SharedCateringModule","RouterModule","forChild","MapLocation","_data","location","position","map_id","asset_id","map_width","map_height","variance","last_seen","getUnixTime","at_location","coordinates_from"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./apps/concierge/src/app/day-view/dayview-topbar.component.ts","./apps/concierge/src/app/day-view/dayview-event.component.ts","./apps/concierge/src/app/day-view/dayview-space.component.ts","./apps/concierge/src/app/day-view/dayview-timeline.component.ts","./apps/concierge/src/app/day-view/day-view.component.ts","./apps/concierge/src/app/day-view/room-booking-search.component.ts","./apps/concierge/src/app/day-view/room-timeline.component.ts","./apps/concierge/src/app/day-view/room-approvals.component.ts","./node_modules/date-fns/isSameWeek.mjs","./apps/concierge/src/app/day-view/room-week-timeline.component.ts","./apps/concierge/src/app/day-view/room-bookings.component.ts","./apps/concierge/src/app/day-view/day-view.module.ts","./apps/concierge/src/app/day-view/new-dayview.component.ts","./libs/users/src/lib/location.class.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { first } from 'rxjs/operators';\n\nimport { AsyncHandler, Identity, SettingsService } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { BookingUIOptions, EventsStateService } from './events-state.service';\n\n@Component({\n    selector: 'dayview-topbar',\n    template: `\n        <div\n            class=\"flex items-center px-4 h-20 bg-base-100 border-b border-base-200\"\n        >\n            <button\n                btn\n                matRipple\n                new\n                class=\"w-12 xl:w-auto overflow-hidden\"\n                (click)=\"newBooking()\"\n            >\n                <div class=\"flex items-center\">\n                    <app-icon\n                        class=\"mr-2\"\n                        [icon]=\"{ class: 'material-icons', content: 'add' }\"\n                    ></app-icon>\n                    <div class=\"hidden xl:block\">New Booking</div>\n                </div>\n            </button>\n            <mat-form-field appearance=\"outline\">\n                <mat-select\n                    multiple\n                    [(ngModel)]=\"zones\"\n                    (ngModelChange)=\"updateZones($event)\"\n                    placeholder=\"All Levels\"\n                >\n                    <mat-option\n                        *ngFor=\"let level of levels | async\"\n                        [value]=\"level.id\"\n                    >\n                        {{ level.display_name || level.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-form-field appearance=\"outline\">\n                <mat-select\n                    multiple\n                    [(ngModel)]=\"type_list\"\n                    (ngModelChange)=\"updateTypes($event)\"\n                    placeholder=\"No Events\"\n                >\n                    <mat-select-trigger>Legend</mat-select-trigger>\n                    <mat-option *ngFor=\"let type of types\" [value]=\"type.id\">\n                        {{ type.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-slide-toggle\n                class=\"m-2\"\n                [ngModel]=\"(ui_options | async)?.show_overflow\"\n                (ngModelChange)=\"updateUIOptions({ show_overflow: $event })\"\n                *ngIf=\"allow_setup_breakdown\"\n            >\n                <div class=\"text-xs\">Setup / Breakdown</div>\n            </mat-slide-toggle>\n            <div class=\"flex-1 w-0\"></div>\n            <!-- <searchbar class=\"mr-2\"></searchbar> -->\n            <date-options (dateChange)=\"setDate($event)\"></date-options>\n        </div>\n    `,\n    styles: [\n        `\n            button {\n                min-width: 0;\n                padding: 0 0.85rem;\n            }\n\n            mat-form-field {\n                height: 3.25em;\n                width: 8em;\n                margin-left: 1em;\n            }\n\n            mat-slide-toggle div {\n                width: 5.5em;\n                white-space: initial;\n                line-height: 1.2em;\n            }\n        `,\n    ],\n})\nexport class DayviewTopbarComponent extends AsyncHandler {\n    /** List of selected levels */\n    public zones: string[] = [];\n\n    public readonly types: Identity[] = [\n        { id: 'internal', name: 'Internal' },\n        { id: 'external', name: 'External' },\n        { id: 'cancelled', name: 'Cancelled' },\n    ];\n    /** List of selected types */\n    public type_list: string[] = this.types.map((i) => `${i.id}`);\n    /** List of levels for the active building */\n    public readonly levels = this._org.active_levels;\n    /** List of levels for the active building */\n    public readonly ui_options = this._state.options;\n    /** Set filtered date */\n    public readonly setDate = (d) => this._state.setDate(d);\n    /**  */\n    public readonly newBooking = (d?) => this._state.newBooking(d);\n    /** List of levels for the active building */\n    public readonly updateZones = (z) => {\n        this._router.navigate([], {\n            relativeTo: this._route,\n            queryParams: { zone_ids: z.join(',') },\n        });\n        this._state.setZones(z);\n    };\n    /** List of levels for the active building */\n    public readonly updateTypes = (types) =>\n        this._state.setFilters({\n            hide_type: this.types.reduce((list, item) => {\n                !types.includes(item.id) ? list.push(item) : '';\n                return list;\n            }, []),\n        });\n\n    public updateUIOptions(options: BookingUIOptions) {\n        this._state.setUIOptions(options);\n    }\n\n    public get allow_setup_breakdown() {\n        return this._settings.get('app.events.allow_setup_breakdown');\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _router: Router,\n        private _settings: SettingsService\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('zone_ids')) {\n                    const zones = params.get('zone_ids').split(',');\n                    if (zones.length) {\n                        this.zones = zones;\n                        const level = this._org.levelWithID(zones);\n                        if (!level) return;\n                        this._org.building = this._org.buildings.find(\n                            (bld) => bld.id === level.parent_id\n                        );\n                    }\n                }\n            })\n        );\n        this.subscription(\n            'levels',\n            this._org.active_levels.subscribe((levels) => {\n                this.zones = this.zones.filter((zone) =>\n                    levels.find((lvl) => lvl.id === zone)\n                );\n                if (!this.zones.length && levels.length) {\n                    this.zones.push(levels[0].id);\n                }\n                this.updateZones(this.zones);\n            })\n        );\n        this.updateTypes(this.type_list);\n    }\n}\n","import { Component, Input, OnChanges, SimpleChanges } from '@angular/core';\nimport { startOfDay, differenceInMinutes, format, addMinutes } from 'date-fns';\n\nimport { CalendarEvent } from '@placeos/events';\nimport { EventsStateService } from './events-state.service';\nimport { SettingsService } from '@placeos/common';\n\nconst DAY_IN_MINUTES = 24 * 60;\n\n@Component({\n    selector: 'dayview-event',\n    template: `\n        <div\n            *ngIf=\"(ui_options | async)?.show_overflow\"\n            [class]=\"\n                'overflow-block absolute rounded overflow-hidden w-full ' + type\n            \"\n            [style.top]=\"overflow_top * 100 + '%'\"\n            [style.height]=\"overflow_height * 100 + '%'\"\n        ></div>\n        <div\n            event\n            matRipple\n            [class]=\"\n                'absolute rounded overflow-hidden text-sm border border-base-200 shadow-sm z-10 hover:z-30 ' +\n                type\n            \"\n            *ngIf=\"event\"\n            [style.top]=\"top * 100 + '%'\"\n            [style.height]=\"height * 100 + '%'\"\n            (click)=\"view(event)\"\n        >\n            <div class=\"px-2 py-1 font-medium\">{{ event.organiser?.name }}</div>\n            <div class=\"py-1 flex items-center\" *ngIf=\"event.duration > 30\">\n                <app-icon class=\"mx-2\">title</app-icon>\n                {{ event.title }}\n            </div>\n            <div class=\"py-1 flex items-center\" *ngIf=\"event.duration > 60\">\n                <app-icon class=\"mx-2\">schedule</app-icon>\n                {{ time }}\n            </div>\n            <div class=\"py-1 flex items-center\" *ngIf=\"event.duration > 90\">\n                <app-icon class=\"mx-2\">people</app-icon>\n                {{ event.attendees.length }} Attendee{{\n                    event.attendees.length === 1 ? '' : 's'\n                }}\n            </div>\n        </div>\n        <div\n            *ngIf=\"event && (ui_options | async)?.show_cleaning\"\n            cleaning\n            class=\"absolute rounded overflow-hidden flex w-full shadow p-2 bg-base-100 z-20 hover:!h-48\"\n            [style.top]=\"top * 100 + '%'\"\n            [style.height]=\"height * 100 + '%'\"\n        >\n            <div\n                [class]=\"\n                    'icon flex items-center justify-center mr-2 text-3xl rounded h-12 w-12 text-pending ' +\n                    event.ext('cleaning_status')\n                \"\n            >\n                <app-icon>{{\n                    event.ext('cleaning_status') === 'done' ? 'done' : 'warning'\n                }}</app-icon>\n            </div>\n            <div class=\"flex-1 w-1/2\">\n                {{\n                    event.ext('cleaning_status') === 'done'\n                        ? 'Finished'\n                        : 'Scheduled to'\n                }}\n                clean at\n                {{\n                    event.ext('cleaning_time') || event.event_end * 1000\n                        | date: time_format\n                }}\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            [event] {\n                background-color: #ccc;\n                width: 12rem;\n                z-index: 100;\n                transition: box-shadow 200ms;\n            }\n\n            [event]:hover {\n                box-shadow: 0 1px 3px 1px rgba(0, 0, 0, 0.2),\n                    0 1px 1px 0 rgba(0, 0, 0, 0.14),\n                    0 2px 1px -1px rgba(0, 0, 0, 0.12) !important;\n                cursor: pointer;\n            }\n\n            .overflow-block {\n                opacity: 0.3;\n                width: 12rem;\n            }\n\n            .internal {\n                background-color: #1565c0;\n                color: #fff;\n            }\n\n            .icon {\n                background-color: #f0f0f0;\n            }\n\n            .icon.done {\n                color: #21a453;\n            }\n\n            .external {\n                background-color: #ad1457;\n                color: #fff;\n            }\n\n            .cancelled {\n                background-color: #ccc;\n            }\n        `,\n    ],\n})\nexport class DayviewEventComponent implements OnChanges {\n    /** Event to display */\n    @Input() public event: CalendarEvent;\n    /** Top position for the event */\n    public top = -999;\n    /** Height of the event on the calendar */\n    public height = 0;\n    /** Top position for the event */\n    public overflow_top = -999;\n    /** Height of the event on the calendar */\n    public overflow_height = 0;\n\n    public readonly ui_options = this._state.options;\n\n    public readonly view = (e) => this._state.setEvent(e);\n\n    public get time() {\n        const date = new Date(this.event.date);\n        return (\n            format(date, this.time_format) +\n            ' - ' +\n            format(addMinutes(date, this.event.duration), this.time_format)\n        );\n    }\n\n    public get type() {\n        return this.event.guests.length\n            ? 'external'\n            : this.event.status === 'declined'\n            ? 'cancelled'\n            : 'internal';\n    }\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _settings: SettingsService\n    ) {}\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.event && this.event) {\n            const start = startOfDay(new Date(this.event.date));\n            const diff = differenceInMinutes(new Date(this.event.date), start);\n            this.top = diff / DAY_IN_MINUTES;\n            this.height = this.event.duration / DAY_IN_MINUTES;\n            this.overflow_top =\n                (diff - (this.event.setup_time || 0)) / DAY_IN_MINUTES;\n            this.overflow_height =\n                (this.event.duration +\n                    (this.event.setup_time || 0) +\n                    (this.event.breakdown_time || 0)) /\n                DAY_IN_MINUTES;\n        }\n    }\n}\n","import { Component, Input, OnInit } from '@angular/core';\nimport { map } from 'rxjs/operators';\n\nimport { CalendarEvent } from '@placeos/events';\nimport { Space } from '@placeos/spaces';\nimport { EventsStateService } from './events-state.service';\nimport { AsyncHandler } from '@placeos/common';\n\n@Component({\n    selector: 'dayview-space',\n    template: `\n        <ng-container *ngIf=\"space\">\n            <dayview-event\n                *ngFor=\"let event of events | async\"\n                [event]=\"event\"\n            ></dayview-event>\n        </ng-container>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n            }\n        `,\n    ],\n})\nexport class DayviewSpaceComponent extends AsyncHandler implements OnInit {\n    /** Space to display events for */\n    @Input() public space: Space;\n\n    public shown_event: CalendarEvent;\n    /** List of events for the selected space */\n    public readonly events = this._state.filtered.pipe(\n        map((bookings) => {\n            return bookings.filter((bkn) =>\n                bkn.resources.find((space) => this.space.email === space.email)\n            );\n        })\n    );\n\n    constructor(private _state: EventsStateService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription('events', this._state.filtered.subscribe());\n    }\n}\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { querySystems } from '@placeos/ts-client';\nimport { combineLatest, of } from 'rxjs';\nimport {\n    catchError,\n    filter,\n    map,\n    shareReplay,\n    switchMap,\n} from 'rxjs/operators';\n\nimport { AsyncHandler } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { Space } from '@placeos/spaces';\nimport { EventsStateService } from './events-state.service';\n\nconst HOUR_BLOCKS = new Array(24).fill(0).map((_, idx) => {\n    return (idx % 12 === 0 ? 12 : idx % 12) + (idx >= 12 ? ' PM' : ' AM');\n});\n\n@Component({\n    selector: 'dayview-timeline',\n    template: `\n        <div class=\"absolute inset-0 flex\">\n            <div class=\"time h-full w-24 overflow-hidden bg-base-100 relative\">\n                <div header class=\"relative h-16 z-50\">\n                    <div\n                        class=\"bg-base-100 absolute top-0 left-0 right-0 bottom-8\"\n                    ></div>\n                </div>\n                <div\n                    *ngFor=\"let time of blocks\"\n                    change-transform\n                    class=\"relative h-16 border-r border-base-300 z-10\"\n                    [style.transform]=\"'translateY(-' + scroll.y + 'px)'\"\n                >\n                    <div\n                        class=\"absolute text-center w-full text-xs top-0 transform -translate-y-1/2 opacity-40\"\n                    >\n                        {{ time }}\n                    </div>\n                    <div\n                        class=\"absolute h-px w-2 top-0 right-0 bg-base-300\"\n                    ></div>\n                </div>\n                <div class=\"absolute h-8 w-px top-8 right-0 bg-base-300\"></div>\n            </div>\n            <div class=\"h-full flex-1 flex flex-col w-1/2\">\n                <div\n                    header\n                    class=\"flex relative overflow-hidden border-b border-base-300 border-opacity-50 bg-base-100 h-16 w-full\"\n                >\n                    <div\n                        *ngFor=\"let space of space_list | async\"\n                        change-transform\n                        class=\"relative h-16 w-48 min-w-[12rem]\"\n                        [style.transform]=\"'translateX(-' + scroll.x + 'px)'\"\n                    >\n                        <div\n                            bar\n                            class=\"absolute h-8 w-px bottom-0 -left-px bg-base-300\"\n                        ></div>\n                        <div class=\"name m-2 text-center\">\n                            {{ space.display_name || space.name }}\n                        </div>\n                    </div>\n                </div>\n                <div\n                    #scroll_el\n                    content\n                    class=\"relative flex flex-1 overflow-auto\"\n                    (scroll)=\"onScroll($event)\"\n                >\n                    <dayview-space\n                        *ngFor=\"let space of space_list | async\"\n                        [space]=\"space\"\n                        class=\"w-48 min-w-[12rem] h-[96rem] border-r border-base-300\"\n                    ></dayview-space>\n                    <div\n                        *ngFor=\"let time of blocks; let i = index\"\n                        class=\"absolute bg-base-300 h-px min-w-full left-0\"\n                        [style.width]=\"\n                            (space_list | async)?.length * 12 + 'rem'\n                        \"\n                        [style.top]=\"i * 4 + 'rem'\"\n                    ></div>\n                </div>\n            </div>\n            <mat-progress-bar\n                *ngIf=\"loading | async\"\n                mode=\"indeterminate\"\n                class=\"absolute bottom-0 left-0 right-0\"\n            ></mat-progress-bar>\n            <view-event-details\n                *ngIf=\"event | async\"\n                [event]=\"event | async\"\n            ></view-event-details>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                height: 100%;\n                width: 100%;\n            }\n\n            [change-transform] {\n                will-change: transform;\n            }\n        `,\n    ],\n})\nexport class DayviewTimelineComponent\n    extends AsyncHandler\n    implements OnInit, OnDestroy\n{\n    /** Time blocks to display */\n    public readonly blocks: string[] = HOUR_BLOCKS;\n    /** Current scroll position of the content */\n    public scroll: { x: number; y: number } = { x: 0, y: 0 };\n    /** Whether event data is loading */\n    public readonly loading = this._state.loading;\n    /** Event to show more details about */\n    public readonly event = this._state.event;\n\n    public readonly spaces = this._org.active_building.pipe(\n        filter((_) => !!_),\n        switchMap(({ id }) =>\n            querySystems({ zone_id: id, limit: 1000 }).pipe(\n                catchError(() => of({ data: [] }))\n            )\n        ),\n        map(({ data }) =>\n            data.map(\n                (_) =>\n                    new Space({\n                        ..._,\n                        level: this._org.levelWithID(_.zones),\n                    } as any)\n            )\n        ),\n        shareReplay(1)\n    );\n    /** List of spaces to display */\n    public readonly space_list = combineLatest([\n        this.spaces,\n        this._state.zones,\n    ]).pipe(\n        map(\n            ([spaces, zones]) =>\n                spaces.filter(\n                    (space) =>\n                        !zones?.length ||\n                        space.zones.find((z) => zones.includes(z))\n                ) || []\n        )\n    );\n\n    constructor(\n        private _org: OrganisationService,\n        private _state: EventsStateService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.startPolling();\n    }\n\n    public ngOnDestroy() {\n        this._state.stopPolling();\n    }\n\n    public onScroll(e) {\n        requestAnimationFrame(\n            () =>\n                (this.scroll = {\n                    x: e.srcElement.scrollLeft,\n                    y: e.srcElement.scrollTop,\n                })\n        );\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { ApplicationLinkInternal, SettingsService } from '@placeos/common';\n\n@Component({\n    selector: '[app-dayview]',\n    template: `\n        <sidebar class=\"h-full\"></sidebar>\n        <main\n            class=\"relative overflow-hidden flex flex-col flex-1 w-1/2 h-full bg-base-200\"\n        >\n            <dayview-topbar></dayview-topbar>\n            <dayview-timeline></dayview-timeline>\n        </main>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class DayViewComponent implements OnInit {\n    public get links(): ApplicationLinkInternal[] {\n        return this._settings.get('app.general.menu') || [];\n    }\n\n    constructor(private _settings: SettingsService, private _router: Router) {}\n\n    public ngOnInit() {\n        if (!this.links.find((_) => _.route.includes('day-view'))) {\n            this._router.navigate([`/${this.links[0].route}`]);\n        }\n    }\n}\n","import {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Output,\n    ViewChild,\n} from '@angular/core';\nimport { EventsStateService } from './events-state.service';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport { CalendarEvent } from '@placeos/events';\n\n@Component({\n    selector: 'room-booking-search',\n    template: `\n        <div class=\"relative\">\n            <button icon matRipple (click)=\"showSearch()\">\n                <app-icon>search</app-icon>\n            </button>\n            <input\n                #input_el\n                [class.opacity-0]=\"!show\"\n                [class.pointer-events-none]=\"!show\"\n                class=\"absolute top-1/2 -translate-y-1/2 w-[20rem] right-0 rounded-full pl-10 pr-4 py-3 border border-base-300 shadow bg-base-100\"\n                [ngModel]=\"search.getValue()\"\n                (ngModelChange)=\"search.next($event)\"\n                (blur)=\"hideSearch()\"\n                placeholder=\"Search day's events...\"\n            />\n            <app-icon\n                *ngIf=\"show\"\n                class=\"text-2xl absolute top-1/2 -translate-y-1/2 right-[17.5rem]\"\n            >\n                search\n            </app-icon>\n            <div\n                class=\"absolute top-full translate-y-2 w-[18rem] right-4 rounded border border-base-300 bg-base-100 max-h-[65vh] overflow-auto shadow\"\n                *ngIf=\"show\"\n            >\n                <div class=\"sticky top-0 p-4 bg-base-100 rounded z-10\">\n                    <div class=\"opacity-60 text-xs\">\n                        {{ (filtered | async)?.length }} of\n                        {{ (events | async)?.length }} Event(s)\n                    </div>\n                </div>\n                <div\n                    *ngIf=\"!(filtered | async).length\"\n                    class=\"opacity-30 p-4 flex items-center justify-center text-sm text-center\"\n                >\n                    {{\n                        (events | async).length\n                            ? 'No matching events found.'\n                            : 'No events for the currently selected date and zone'\n                    }}\n                </div>\n                <div class=\"px-2 pb-2 -mt-2\">\n                    <button\n                        matRipple\n                        *ngFor=\"let event of filtered | async\"\n                        class=\"relative flex items-center p-2 hover:bg-base-200 rounded w-full text-left space-x-2 z-0\"\n                        (click)=\"selected.next(event)\"\n                    >\n                        <div\n                            class=\"h-10 w-1 rounded-full\"\n                            [style.background-color]=\"typeColor(event)\"\n                        ></div>\n                        <div date class=\"leading-tight\">\n                            <div class=\"text-2xl mx-auto\">\n                                {{ event.date | date: 'dd' }}\n                            </div>\n                            <div\n                                class=\"font-medium text-sm uppercase mx-auto -mt-1\"\n                            >\n                                {{ event.date | date: 'MMM' }}\n                            </div>\n                        </div>\n                        <div class=\"flex-1 w-1/2\">\n                            <div class=\"flex items-center space-x-2 w-full\">\n                                <div\n                                    class=\"text-sm flex-1 truncate\"\n                                    [class.line-through]=\"\n                                        event.state === 'done'\n                                    \"\n                                >\n                                    {{ event.title }}\n                                </div>\n                                <div class=\"opacity-60 text-xs\">\n                                    {{ event.date | date: time_format }}\n                                    &ndash;\n                                    {{ event.date_end | date: time_format }}\n                                </div>\n                            </div>\n                            <div class=\"text-xs opacity-30 truncate\">\n                                {{ event.system?.display_name }}\n                            </div>\n                            <div class=\"text-xs opacity-30 truncate\">\n                                {{ (event.host | user)?.name || event.host }}\n                            </div>\n                        </div>\n                    </button>\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class RoomBookingSearchComponent extends AsyncHandler {\n    @Output() public selected = new EventEmitter<CalendarEvent>();\n    public show = false;\n    public readonly search = new BehaviorSubject('');\n    public readonly events = this._state.filtered;\n\n    public readonly types: any[] = [\n        { id: 'internal', name: 'Internal', color: '#D81B60' },\n        { id: 'external', name: 'External', color: '#1E88E5' },\n        { id: 'cancelled', name: 'Cancelled', color: '#eeeeee' },\n    ];\n\n    public readonly filtered = combineLatest([this.search, this.events]).pipe(\n        map(([search, event_list]) => {\n            search = search.toLowerCase();\n            return event_list.filter((e) => {\n                return (\n                    !e.is_system_event &&\n                    (e.title.toLowerCase().includes(search) ||\n                        e.organiser?.name.toLowerCase().includes(search) ||\n                        e.host.toLowerCase().includes(search) ||\n                        e.system?.display_name.toLowerCase().includes(search) ||\n                        e.system?.name.toLowerCase().includes(search) ||\n                        e.resources[0]?.display_name\n                            .toLowerCase()\n                            ?.includes(search) ||\n                        e.resources[0]?.name.toLowerCase()?.includes(search) ||\n                        e.resources[0]?.email.toLowerCase()?.includes(search))\n                );\n            });\n        }),\n    );\n\n    @ViewChild('input_el', { static: true })\n    private _input_element: ElementRef<HTMLInputElement>;\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    public typeColor(event) {\n        const type = this.types.find((_) => _.id === event.type);\n        return type?.color || '#EEE';\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _settings: SettingsService,\n    ) {\n        super();\n    }\n\n    public showSearch() {\n        this.show = true;\n        this._input_element.nativeElement.focus();\n    }\n\n    public hideSearch() {\n        if (!this.show) return;\n        this.timeout('hide', () => (this.show = false));\n    }\n}\n","import { Component } from '@angular/core';\nimport {\n    addHours,\n    differenceInMinutes,\n    format,\n    isSameDay,\n    setHours,\n    startOfDay,\n    startOfMinute,\n} from 'date-fns';\nimport { EventsStateService } from './events-state.service';\nimport { combineLatest } from 'rxjs';\nimport { debounceTime, map, shareReplay, startWith } from 'rxjs/operators';\nimport {\n    AsyncHandler,\n    SettingsService,\n    getTimezoneDifferenceInHours,\n    getTimezoneOffsetString,\n    notifyError,\n    notifySuccess,\n    openConfirmModal,\n} from '@placeos/common';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    CalendarEvent,\n    EventDetailsModalComponent,\n    SetupBreakdownModalComponent,\n    declineEvent,\n} from '@placeos/events';\nimport { DatePipe } from '@angular/common';\nimport { OrganisationService } from '@placeos/organisation';\n\n@Component({\n    selector: 'room-bookings-timeline',\n    template: `\n        <div\n            class=\"mx-2 mt-2 p-2 w-[calc(100%-1rem)] bg-info text-info-content rounded-lg text-center text-xs\"\n            *ngIf=\"timezone && tz\"\n        >\n            Timezone of the building is displayed and is different from your\n            local timezone.\n        </div>\n        <div\n            class=\"relative flex items-center justify-center p-2 space-x-2 border-b border-base-200 z-20\"\n        >\n            <date-options\n                [date]=\"date | async\"\n                (dateChange)=\"setDate($event)\"\n                [is_new]=\"true\"\n            ></date-options>\n            <div\n                class=\"absolute top-1/2 -translate-y-1/2 left-4 text-info text-sm\"\n                *ngIf=\"is_today | async\"\n            >\n                Today\n            </div>\n            <div class=\"absolute top-1/2 -translate-y-1/2 right-8\">\n                <room-booking-search\n                    (selected)=\"viewEvent($event, $event.system?.id, true)\"\n                ></room-booking-search>\n            </div>\n        </div>\n        <div timeline class=\"grid overflow-auto w-full h-1/2 flex-1 z-0\">\n            <div\n                timezone\n                class=\"sticky top-0 left-0 z-30 bg-base-100 flex items-center justify-center\"\n            >\n                <div class=\"text-xs opacity-30\">\n                    {{ date | async | date: 'z' : tz }}\n                </div>\n                <div\n                    class=\"absolute h-2 w-px right-0 bottom-0 bg-base-300\"\n                ></div>\n                <div\n                    class=\"absolute w-2 h-px right-0 bottom-0 bg-base-300\"\n                ></div>\n            </div>\n            <div\n                space-headers\n                class=\"sticky top-0 z-20 border-b border-base-300 flex items-center bg-base-100\"\n                [style.width]=\"(spaces | async)?.length * block_width + 'rem'\"\n            >\n                <div\n                    *ngFor=\"let space of spaces | async\"\n                    class=\"relative h-full w-56 flex items-center justify-center\"\n                >\n                    <div class=\"truncate\">\n                        {{ space.display_name || space.name }}\n                    </div>\n                    <div\n                        class=\"absolute h-2 w-px -left-px bottom-0 bg-base-300\"\n                    ></div>\n                </div>\n            </div>\n            <div\n                hour-blocks\n                class=\"sticky left-0 z-10 border-r border-base-300 bg-base-100 overflow-visible\"\n                [style.height]=\"block_range * block_height + 'rem'\"\n            >\n                <div\n                    *ngFor=\"let hour of hours; let i = index\"\n                    class=\"relative w-full\"\n                    [style.height]=\"block_height + 'rem'\"\n                >\n                    <div\n                        class=\"absolute -top-px right-0 w-2 h-px bg-base-300\"\n                    ></div>\n                    <div\n                        class=\"absolute -top-px right-3 -translate-y-1/2 text-xs opacity-60\"\n                        *ngIf=\"i !== 0\"\n                    >\n                        {{ formatHour(hour) }}\n                    </div>\n                </div>\n                <div\n                    class=\"absolute bg-secondary right-0 translate-x-1/2 -translate-y-1/2 h-2 w-2 rounded-full\"\n                    *ngIf=\"(show_time | async) && timeToOffset(now) < 100\"\n                    [style.top]=\"'calc(' + timeToOffset(now) + '% + 1px)'\"\n                ></div>\n            </div>\n            <div space-blocks class=\"relative overflow-hidden\">\n                <div\n                    *ngFor=\"let hour of hours; let i = index\"\n                    class=\"relative w-full border-b border-base-200\"\n                    [style.height]=\"block_height + 'rem'\"\n                ></div>\n                <div\n                    *ngFor=\"let space of spaces | async; let i = index\"\n                    class=\"absolute w-px h-full bg-base-200 top-0\"\n                    [style.left]=\"'calc(' + i * block_width + 'rem - 1px)'\"\n                ></div>\n\n                <ng-container\n                    *ngFor=\"let space of spaces | async; let i = index\"\n                >\n                    <ng-container\n                        *ngFor=\"let event of (events | async)[space.id] || []\"\n                    >\n                        <button\n                            event\n                            matRipple\n                            class=\"absolute w-52 hover:opacity-90 text-left\"\n                            [style.left]=\"i * block_width + 0.25 + 'rem'\"\n                            [style.top]=\"timeToOffset(event.date) + '%'\"\n                            [style.height]=\"endToOffset(event.duration) + '%'\"\n                            (click)=\"viewEvent(event, space.id)\"\n                            [matTooltip]=\"eventTooltip(event)\"\n                            *ngIf=\"\n                                !event.is_system_event ||\n                                (ui_options | async).show_overflow\n                            \"\n                        >\n                            <div\n                                class=\"relative w-full h-full shadow bg-base-100 border border-base-200 hover:bg-base-200 rounded-lg overflow-hidden px-3 py-1 text-xs\"\n                                [class.opacity-60]=\"event.state === 'done'\"\n                                [class.!rounded-none]=\"event.is_system_event\"\n                                [class.!border-secondary]=\"\n                                    event.is_system_event\n                                \"\n                            >\n                                <ng-container *ngIf=\"event.is_system_event\">\n                                    <div\n                                        class=\"absolute -inset-px bg-secondary opacity-30\"\n                                    ></div>\n                                </ng-container>\n                                <ng-container *ngIf=\"!event.is_system_event\">\n                                    <div\n                                        class=\"absolute left-0 inset-y-0 w-1 \"\n                                        [class.bg-secondary]=\"\n                                            event.status !== 'cancelled'\n                                        \"\n                                        [class.bg-error]=\"\n                                            event.status === 'cancelled'\n                                        \"\n                                    ></div>\n                                    <p\n                                        class=\"truncate\"\n                                        [class.opacity-60]=\"\n                                            event.status === 'cancelled'\n                                        \"\n                                    >\n                                        {{\n                                            event.all_day\n                                                ? 'All Day'\n                                                : (event.date\n                                                  | date: time_format : tz)\n                                        }}\n                                        &ndash;\n                                        {{ event.title }}\n                                    </p>\n                                    <p\n                                        class=\"truncate\"\n                                        [class.opacity-60]=\"\n                                            event.status === 'cancelled'\n                                        \"\n                                    >\n                                        {{\n                                            event.organiser?.name || event.host\n                                        }}\n                                    </p>\n                                </ng-container>\n                            </div>\n                        </button>\n                    </ng-container>\n                </ng-container>\n                <div\n                    *ngIf=\"show_time | async\"\n                    class=\"absolute inset-x-0 h-[2px] bg-secondary\"\n                    [style.top]=\"timeToOffset(now) + '%'\"\n                ></div>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                max-width: 100%;\n            }\n\n            [timeline] {\n                grid-template-columns: 4rem auto;\n                grid-template-rows: 3.5rem auto;\n            }\n        `,\n    ],\n})\nexport class RoomBookingsTimelineComponent extends AsyncHandler {\n    public block_width = 14;\n    public readonly ui_options = this._state.options;\n    public readonly spaces = this._state.spaces;\n    public readonly date = this._state.date;\n    public readonly is_today = this.date.pipe(\n        map((d) => isSameDay(d, Date.now())),\n    );\n    public readonly show_time = combineLatest([\n        this.date,\n        this._org.active_building,\n    ]).pipe(\n        map(([d]) => {\n            const today = isSameDay(d, Date.now());\n            const offset = this.timezone\n                ? getTimezoneDifferenceInHours(this.timezone)\n                : 0;\n            const start = addHours(\n                setHours(startOfDay(Date.now()), this.block_start),\n                -offset,\n            ).valueOf();\n            const end = addHours(\n                setHours(startOfDay(Date.now()), this.block_end),\n                -offset,\n            ).valueOf();\n            return today && Date.now() >= start && Date.now() <= end;\n        }),\n    );\n    public readonly events = combineLatest([\n        this._state.spaces,\n        this._state.filtered,\n        this.date,\n    ]).pipe(\n        debounceTime(300),\n        map(([spaces, events, date]) => {\n            const map = {};\n            const offset = this.timezone\n                ? getTimezoneDifferenceInHours(this.timezone)\n                : 0;\n            const start = addHours(\n                setHours(startOfDay(date), this.block_start),\n                -offset,\n            ).valueOf();\n            const end = addHours(\n                setHours(startOfDay(date), this.block_end),\n                -offset,\n            ).valueOf();\n            for (const space of spaces) {\n                map[space.id] = events\n                    .filter(\n                        (event) =>\n                            event.resources.find(\n                                (item) =>\n                                    item.id === space.id ||\n                                    item.email === space.email,\n                            ) ||\n                            event.system?.id === space.id ||\n                            event.system?.email === space.email,\n                    )\n                    .filter(\n                        (event) => event.date_end >= start && event.date <= end,\n                    );\n            }\n            return map;\n        }),\n        startWith({}),\n        shareReplay(1),\n    );\n\n    private _hour_list = Array.from({ length: 24 }, (_, i) => i);\n    public hours: number[] = [];\n\n    public get now() {\n        return startOfMinute(Date.now()).valueOf();\n    }\n\n    public readonly edit = (e) => this._state.newBooking(e);\n    public readonly setDate = (d) => this._state.setDate(d);\n\n    private _local_tz = getTimezoneOffsetString(\n        Intl.DateTimeFormat().resolvedOptions().timeZone,\n    );\n\n    public get timezone() {\n        return this._settings.get('app.events.use_building_timezone')\n            ? this._org.building.timezone\n            : '';\n    }\n\n    public get tz() {\n        const tz = this.timezone;\n        if (!tz) return '';\n        const tz_offset = getTimezoneOffsetString(tz);\n        return tz_offset === this._local_tz ? '' : tz_offset;\n    }\n\n    public get block_start() {\n        return +this._settings.get('app.events.block_start') || 0;\n    }\n\n    public get block_end() {\n        return +this._settings.get('app.events.block_end') || 24;\n    }\n\n    public get block_range() {\n        return Math.min(24, Math.max(this.block_end - this.block_start, 1));\n    }\n\n    public get block_height() {\n        return +this._settings.get('app.events.block_height') || 3;\n    }\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _dialog: MatDialog,\n        private _settings: SettingsService,\n        private _org: OrganisationService,\n    ) {\n        super();\n    }\n\n    public formatHour(hour: number) {\n        const date = setHours(Date.now(), hour);\n        return this._settings.get('app.use_24_hour_time')\n            ? format(date, 'HH:00')\n            : format(date, 'h a');\n    }\n\n    private _date_pipe = new DatePipe('en');\n\n    public eventTooltip(event: CalendarEvent) {\n        const tooltip = `Start: ${event.all_day ? 'All Day' : this._date_pipe.transform(event.date, this.time_format)}\nTitle:  ${event.title}\nHost:  ${event.organiser?.name || event.host}`;\n        return tooltip;\n    }\n\n    public ngOnInit() {\n        this.subscription('poll', this._state.startPolling());\n        this.subscription(\n            'hour_list',\n            this._org.active_building.subscribe(() => {\n                this.hours = this._hour_list.filter(\n                    (h) => h >= this.block_start && h < this.block_end,\n                );\n            }),\n        );\n        this.hours = this._hour_list.filter(\n            (h) => h >= this.block_start && h < this.block_end,\n        );\n        const current_tz = Intl.DateTimeFormat().resolvedOptions().timeZone;\n        const offset = !this.timezone\n            ? 0\n            : getTimezoneDifferenceInHours(current_tz, this.timezone);\n    }\n\n    public timeToOffset(date: number) {\n        const current_tz = Intl.DateTimeFormat().resolvedOptions().timeZone;\n        const offset = !this.timezone\n            ? 0\n            : getTimezoneDifferenceInHours(this.timezone, current_tz);\n        const start_time = setHours(\n            startOfDay(this._state.getDate()),\n            this.block_start - offset,\n        );\n        const diff = differenceInMinutes(date, start_time);\n\n        return (Math.max(0, diff / 60) / this.block_range) * 100;\n    }\n\n    public endToOffset(duration: number) {\n        return (\n            (Math.min(this.block_range, duration / 60) / this.block_range) * 100\n        );\n    }\n\n    public viewEvent(\n        event: CalendarEvent,\n        space_id: string,\n        scroll_to: boolean = false,\n    ) {\n        if (event.is_system_event) return;\n        const ref = this._dialog.open(EventDetailsModalComponent, {\n            data: event,\n        });\n        ref.componentInstance.hide_edit = !this._settings.get(\n            'app.events.allow_edit',\n        );\n        this.subscription(\n            'remove',\n            ref.componentInstance.remove.subscribe(() =>\n                this.remove(event, space_id),\n            ),\n        );\n        this.subscription(\n            'edit',\n            ref.componentInstance.edit.subscribe(() => this.edit(event)),\n        );\n        this.subscription(\n            'actions',\n            ref.componentInstance.action.subscribe(async (action) => {\n                if (!action.includes('breakdown')) return;\n                const ref = this._dialog.open(SetupBreakdownModalComponent, {\n                    data: event,\n                });\n                const data = await ref.afterClosed().toPromise();\n                if (data) this._state.replace(data);\n            }),\n        );\n    }\n\n    public async remove(item: CalendarEvent, space_id: string) {\n        const time = `${format(item.date, 'dd MMM yyyy ' + this.time_format)}`;\n        const resource_name = item.space?.display_name;\n        const content = `Delete the booking for ${resource_name} at ${time}`;\n        const resp = await openConfirmModal(\n            { title: `Delete booking`, content, icon: { content: 'delete' } },\n            this._dialog,\n        );\n        if (resp.reason !== 'done') return;\n        resp.loading('Requesting booking deletion...');\n        await declineEvent(item.id, {\n            calendar: item.calendar || item.mailbox || item.host,\n            system_id: space_id,\n        })\n            .toPromise()\n            .catch((e) => {\n                notifyError(`Unable to delete booking. ${e}`);\n                resp.close();\n                throw e;\n            });\n        notifySuccess('Successfully deleted booking.');\n        this._dialog.closeAll();\n    }\n}\n","import { Component } from '@angular/core';\nimport { EventsStateService } from './events-state.service';\nimport { OrganisationService } from '@placeos/organisation';\nimport { getModule } from '@placeos/ts-client';\nimport { CalendarEvent } from '@placeos/events';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { getTimezoneOffsetString, SettingsService } from '@placeos/common';\n\n@Component({\n    selector: 'room-bookings-approvals',\n    template: `\n        <div\n            class=\"flex flex-col h-full overflow-hidden border-l border-base-200 w-[20rem]\"\n            [style.width]=\"show ? '' : '0px'\"\n        >\n            <div\n                class=\"flex items-center p-2 justify-center border-b border-base-200 space-x-2 relative\"\n            >\n                <button\n                    btn\n                    icon\n                    matRipple\n                    class=\"absolute top-4 left-2 bg-base-200\"\n                    matTooltip=\"Hide Pending Approvals\"\n                    matTooltipPosition=\"left\"\n                    (click)=\"show = !show\"\n                >\n                    <app-icon>chevron_right</app-icon>\n                </button>\n                <h3 class=\"flex-1 py-4 text-center\">\n                    Pending Approval ({{\n                        (filtered_pending | async)?.length || '0'\n                    }}\n                    of {{ (pending | async)?.length || '0' }})\n                </h3>\n            </div>\n            <div class=\"border-b border-base-200 relative\">\n                <input\n                    type=\"text\"\n                    placeholder=\"Search...\"\n                    class=\"w-full py-3 pr-4 pl-10\"\n                    [ngModel]=\"search | async\"\n                    (ngModelChange)=\"search.next($event)\"\n                />\n                <app-icon\n                    class=\"absolute top-1/2 left-2 -translate-y-1/2 text-2xl pointer-events-none\"\n                >\n                    search\n                </app-icon>\n            </div>\n            <div class=\"flex-1 overflow-auto p-2 space-y-2\">\n                <div\n                    *ngIf=\"!(filtered_pending | async)?.length\"\n                    class=\"w-full h-full flex flex-col items-center justify-center space-y-2\"\n                >\n                    <img src=\"assets/icons/no-pending.svg\" />\n                    <p>No pending requests</p>\n                </div>\n                <div\n                    *ngFor=\"let event of filtered_pending | async\"\n                    class=\"relative border border-base-200 p-2 w-full rounded\"\n                >\n                    <h3>{{ event.title }}</h3>\n                    <p class=\"opacity-30 text-xs mb-2\">\n                        {{ event.date | date: 'mediumDate' : tz }}\n                        {{ event.date | date: time_format : tz }}\n                        <span *ngIf=\"tz\">{{\n                            event.date | date: 'z' : tz\n                        }}</span>\n                    </p>\n                    <div class=\"w-64 h-32 overflow-hidden mb-2 bg-base-200\">\n                        <img\n                            auth\n                            class=\"object-cover min-w-full min-h-full\"\n                            [source]=\"\n                                (event.resources[0]?.email | space | async)\n                                    ?.images[0]\n                            \"\n                            *ngIf=\"event.resources.length\"\n                        />\n                    </div>\n                    <div class=\"flex items-center space-x-2 mb-2\">\n                        <div\n                            class=\"h-8 w-8 bg-base-200 rounded-full flex items-center justify-center\"\n                        >\n                            <app-icon class=\"text-xl\">place</app-icon>\n                        </div>\n                        <div class=\"flex-1 text-xs\">\n                            {{\n                                (\n                                    event.resources.length &&\n                                    (event.resources[0]?.email | space | async)\n                                )?.display_name ||\n                                    (event.resources[0]?.email | space | async)\n                                        ?.name ||\n                                    'No Location'\n                            }}\n                        </div>\n                    </div>\n                    <div class=\"flex items-center space-x-2 mb-2\">\n                        <div\n                            class=\"h-8 w-8 bg-base-200 rounded-full flex items-center justify-center\"\n                        >\n                            <app-icon class=\"text-xl\">person</app-icon>\n                        </div>\n                        <div class=\"flex-1 text-xs\">\n                            {{ event.organiser?.name || event.host }}\n                        </div>\n                    </div>\n                    <div class=\"flex items-center space-x-2\">\n                        <button\n                            btn\n                            matRipple\n                            class=\"border-success bg-success-light text-black flex flex-1 items-center space-x-2\"\n                            [disabled]=\"status[event.id] === 'accept'\"\n                            (click)=\"approve(event)\"\n                        >\n                            <div>\n                                {{\n                                    status[event.id] === 'accept'\n                                        ? 'Approved'\n                                        : 'Approve'\n                                }}\n                            </div>\n                            <app-icon class=\"text-success\">done</app-icon>\n                        </button>\n                        <button\n                            btn\n                            matRipple\n                            class=\"border-error bg-error-light text-black flex flex-1 items-center space-x-2 \"\n                            [disabled]=\"status[event.id] === 'decline'\"\n                            (click)=\"reject(event)\"\n                        >\n                            <div>\n                                {{\n                                    status[event.id] === 'decline'\n                                        ? 'Declined'\n                                        : 'Decline'\n                                }}\n                            </div>\n                            <app-icon class=\"text-error\">close</app-icon>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <div\n                class=\"absolute bottom-0 left-0 right-0 top-14 p-2 flex flex-col items-center justify-center space-y-2\"\n                *ngIf=\"loading\"\n            >\n                <div class=\"absolute inset-0 bg-base-100 opacity-80 z-0\"></div>\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p class=\"relative z-10\">Processing...</p>\n            </div>\n        </div>\n        <button\n            btn\n            icon\n            matRipple\n            class=\"bg-warning absolute top-2 -left-8 shadow text-warning-content\"\n            *ngIf=\"!show\"\n            (click)=\"show = !show\"\n            matTooltip=\"Show Pending Approvals\"\n            matTooltipPosition=\"left\"\n        >\n            <app-icon>chevron_left</app-icon>\n        </button>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n                position: relative;\n                height: 100%;\n            }\n        `,\n    ],\n})\nexport class RoomBookingsApprovalsComponent {\n    private _show = true;\n    public loading = false;\n    public status: Record<string, 'accept' | 'decline' | undefined> = {};\n    public readonly search = new BehaviorSubject('');\n\n    public readonly pending = this._state.pending;\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    private _local_tz = getTimezoneOffsetString(\n        Intl.DateTimeFormat().resolvedOptions().timeZone,\n    );\n\n    public get timezone() {\n        return this._settings.get('app.events.use_building_timezone')\n            ? this._org.building.timezone\n            : '';\n    }\n\n    public get tz() {\n        const tz = this.timezone;\n        if (!tz) return '';\n        const tz_offset = getTimezoneOffsetString(tz);\n        return tz_offset === this._local_tz ? '' : tz_offset;\n    }\n\n    public readonly filtered_pending = combineLatest([\n        this._state.pending,\n        this.search,\n    ]).pipe(\n        map(([list, search]) =>\n            list.filter(\n                (event) =>\n                    event.title.toLowerCase().includes(search.toLowerCase()) ||\n                    event.host.toLowerCase().includes(search.toLowerCase()) ||\n                    event.organiser?.name\n                        .toLowerCase()\n                        .includes(search.toLowerCase()),\n            ),\n        ),\n    );\n\n    public set show(value: boolean) {\n        this._show = value;\n        sessionStorage.setItem(\n            'PlaceOS.Concierge.show_room_approvals',\n            `${value}`,\n        );\n    }\n\n    public get show() {\n        return this._show;\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _org: OrganisationService,\n        private _settings: SettingsService,\n    ) {}\n\n    public ngOnInit() {\n        this._show =\n            sessionStorage.getItem('PlaceOS.Concierge.show_room_approvals') !==\n            'false';\n    }\n\n    public async approve(event: CalendarEvent) {\n        const system_id = this._org.binding('approvals');\n        if (!system_id) return;\n        const mod = getModule(system_id, 'RoomBookingApproval', 1);\n        if (!mod) return;\n        this.loading = true;\n        await mod.execute('accept_event', [event.mailbox, event.id]).catch();\n        this.loading = false;\n        this.status[event.id] = 'accept';\n    }\n\n    public async reject(event: CalendarEvent) {\n        const system_id = this._org.binding('approvals');\n        if (!system_id) return;\n        const mod = getModule(system_id, 'RoomBookingApproval', 1);\n        if (!mod) return;\n        this.loading = true;\n        await mod.execute('decline_event', [event.mailbox, event.id]).catch();\n        this.loading = false;\n        this.status[event.id] = 'decline';\n    }\n}\n","import { startOfWeek } from \"./startOfWeek.mjs\";\n\n/**\n * The {@link isSameWeek} function options.\n */\n\n/**\n * @name isSameWeek\n * @category Week Helpers\n * @summary Are the given dates in the same week (and month and year)?\n *\n * @description\n * Are the given dates in the same week (and month and year)?\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param dateLeft - The first date to check\n * @param dateRight - The second date to check\n * @param options - An object with options\n *\n * @returns The dates are in the same week (and month and year)\n *\n * @example\n * // Are 31 August 2014 and 4 September 2014 in the same week?\n * const result = isSameWeek(new Date(2014, 7, 31), new Date(2014, 8, 4))\n * //=> true\n *\n * @example\n * // If week starts with Monday,\n * // are 31 August 2014 and 4 September 2014 in the same week?\n * const result = isSameWeek(new Date(2014, 7, 31), new Date(2014, 8, 4), {\n *   weekStartsOn: 1\n * })\n * //=> false\n *\n * @example\n * // Are 1 January 2014 and 1 January 2015 in the same week?\n * const result = isSameWeek(new Date(2014, 0, 1), new Date(2015, 0, 1))\n * //=> false\n */\nexport function isSameWeek(dateLeft, dateRight, options) {\n  const dateLeftStartOfWeek = startOfWeek(dateLeft, options);\n  const dateRightStartOfWeek = startOfWeek(dateRight, options);\n\n  return +dateLeftStartOfWeek === +dateRightStartOfWeek;\n}\n\n// Fallback for modularized imports:\nexport default isSameWeek;\n","import { Component } from '@angular/core';\nimport {\n    addDays,\n    isSameDay,\n    isSameWeek,\n    startOfMinute,\n    startOfWeek,\n    format,\n} from 'date-fns';\nimport { EventsStateService } from './events-state.service';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    AsyncHandler,\n    getTimezoneOffsetString,\n    notifyError,\n    notifySuccess,\n    openConfirmModal,\n    SettingsService,\n} from '@placeos/common';\nimport { map, shareReplay } from 'rxjs/operators';\nimport { combineLatest } from 'rxjs';\nimport {\n    CalendarEvent,\n    declineEvent,\n    EventDetailsModalComponent,\n    SetupBreakdownModalComponent,\n} from '@placeos/events';\nimport { OrganisationService } from '@placeos/organisation';\nimport { DatePipe } from '@angular/common';\n\n@Component({\n    selector: 'room-week-bookings-timeline',\n    template: `\n        <div\n            class=\"mx-2 mt-2 p-2 w-[calc(100%-1rem)] bg-info text-info-content rounded-lg text-center text-xs\"\n            *ngIf=\"timezone && tz\"\n        >\n            Timezone of the building is displayed and is different from your\n            local timezone.\n        </div>\n        <div\n            class=\"relative flex items-center justify-center p-2 space-x-2 border-b border-base-200 z-20\"\n        >\n            <date-options\n                [date]=\"date | async\"\n                [step]=\"7\"\n                (dateChange)=\"setDate($event)\"\n                [is_new]=\"true\"\n            ></date-options>\n            <div\n                class=\"absolute top-1/2 -translate-y-1/2 left-4 text-info text-sm\"\n                *ngIf=\"this_week | async\"\n            >\n                This Week\n            </div>\n            <div class=\"absolute top-1/2 -translate-y-1/2 right-8\">\n                <room-booking-search\n                    (selected)=\"viewEvent($event, $event.system?.id, true)\"\n                ></room-booking-search>\n            </div>\n        </div>\n        <div timeline class=\"grid overflow-auto w-full h-1/2 flex-1 z-0\">\n            <div\n                timezone\n                class=\"sticky top-0 left-0 z-30 bg-base-100 flex items-center justify-center\"\n            >\n                <div class=\"text-xs opacity-30\">\n                    {{ date | async | date: 'z' : tz }}\n                </div>\n                <div\n                    class=\"absolute h-2 w-px right-0 bottom-0 bg-base-300\"\n                ></div>\n                <div\n                    class=\"absolute w-2 h-px right-0 bottom-0 bg-base-300\"\n                ></div>\n            </div>\n            <div\n                day-headers\n                class=\"sticky top-0 z-20 border-b border-base-300 flex items-center bg-base-100 min-w-[calc(100%-3rem)]\"\n                [style.width]=\"(days | async)?.length * 12 + 'rem'\"\n            >\n                <div\n                    *ngFor=\"let date of days | async\"\n                    class=\"relative flex-1 h-full min-w-48 flex flex-col items-center justify-center leading-tight\"\n                >\n                    <div class=\"truncate\">\n                        {{ date | date: 'EEE, MMM d' : tz }}\n                    </div>\n                    <div\n                        class=\"text-info text-xs absolute bottom-1 left-1/2 -translate-x-1/2\"\n                        *ngIf=\"isToday(date)\"\n                    >\n                        Today\n                    </div>\n                    <div\n                        class=\"absolute h-2 w-px -left-px bottom-0 bg-base-300\"\n                    ></div>\n                </div>\n            </div>\n            <div\n                empty-block\n                class=\"sticky left-0 z-10 border-r border-base-300 bg-base-100 min-h-full\"\n                [style.height]=\"\n                    (event_max_count | async)\n                        ? (event_max_count | async) * 5.375 + 'rem'\n                        : ''\n                \"\n            ></div>\n            <div\n                date-blocks\n                class=\"relative overflow-hidden min-w-[calc(100%-3rem)] flex\"\n                [style.width]=\"(days | async)?.length * 12 + 'rem'\"\n            >\n                <div\n                    class=\"flex-1 min-w-48 overflow-hidden p-2 border-r border-base-200\"\n                    *ngFor=\"let date of days | async; let i = index\"\n                >\n                    <button\n                        matRipple\n                        *ngFor=\"let event of (events | async)[date] || []\"\n                        class=\"flex p-2 w-full space-x-2 hover:bg-base-200 rounded text-left\"\n                        (click)=\"viewEvent(event)\"\n                    >\n                        <div\n                            class=\"h-2 w-2 rounded-full my-1.5\"\n                            [style.background-color]=\"typeColor(event.type)\"\n                        ></div>\n                        <div class=\"flex-1 w-1/2\">\n                            <div\n                                class=\"text-sm truncate\"\n                                [class.line-through]=\"event.state === 'done'\"\n                            >\n                                {{ event.title }}\n                            </div>\n                            <div class=\"text-xs opacity-60 flex-1\">\n                                {{ event.date | date: time_format : tz }}\n                                &ndash;\n                                {{ event.date_end | date: time_format : tz }}\n                                <span *ngIf=\"tz\">{{\n                                    event.date_end | date: 'z' : tz\n                                }}</span>\n                            </div>\n                            <div class=\"text-xs truncate opacity-30\">\n                                {{ event.system?.display_name }}\n                            </div>\n                            <div class=\"text-xs truncate opacity-30\">\n                                {{ (event.host | user)?.name || event.host }}\n                            </div>\n                        </div>\n                    </button>\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                max-width: 100%;\n            }\n\n            [timeline] {\n                grid-template-columns: 4rem auto;\n                grid-template-rows: 3.5rem auto;\n            }\n        `,\n    ],\n})\nexport class RoomWeekBookingsTimelineComponent extends AsyncHandler {\n    public hours = Array.from({ length: 24 }, (_, i) => i);\n    public readonly ui_options = this._state.options;\n    public readonly date = this._state.date;\n\n    public readonly types: any[] = [\n        { id: 'internal', name: 'Internal', color: '#D81B60' },\n        { id: 'external', name: 'External', color: '#1E88E5' },\n        { id: 'cancelled', name: 'Cancelled', color: '#eeeeee' },\n    ];\n\n    public readonly days = this.date.pipe(\n        map((d) =>\n            new Array(7)\n                .fill(0)\n                .map((_, idx) => addDays(startOfWeek(d), idx).valueOf()),\n        ),\n    );\n    public readonly this_week = this.date.pipe(\n        map((d) => isSameWeek(d, Date.now())),\n    );\n\n    private _data_pipe = new DatePipe('en');\n\n    public readonly events = combineLatest([\n        this.days,\n        this._state.filtered,\n        this._state.zones,\n    ]).pipe(\n        map(([day_list, events, zones]) => {\n            if (zones.length) {\n                events = events.filter((_) =>\n                    _.system?.zones.find((_) => zones.includes(_)),\n                );\n            }\n\n            const map: Record<string, CalendarEvent[]> = {};\n            for (const date of day_list) {\n                const date_value = this._data_pipe.transform(\n                    date,\n                    'yyyy-MM-dd',\n                );\n                map[date] = events.filter((event) => {\n                    const event_date_value = this._data_pipe.transform(\n                        event.date,\n                        'yyyy-MM-dd',\n                        this.tz,\n                    );\n                    return (\n                        date_value === event_date_value &&\n                        !event.is_system_event\n                    );\n                });\n            }\n            return map;\n        }),\n        shareReplay(1),\n    );\n\n    public readonly event_max_count = this.events.pipe(\n        map((e) => {\n            let length = 0;\n            for (const date in e) {\n                if (e[date].length > length) length = e[date].length;\n            }\n            return length;\n        }),\n    );\n\n    private _local_tz = getTimezoneOffsetString(\n        Intl.DateTimeFormat().resolvedOptions().timeZone,\n    );\n\n    public get timezone() {\n        return this._settings.get('app.events.use_building_timezone')\n            ? this._org.building.timezone\n            : '';\n    }\n\n    public get tz() {\n        const tz = this.timezone;\n        if (!tz) return '';\n        const tz_offset = getTimezoneOffsetString(tz);\n        return tz_offset === this._local_tz ? '' : tz_offset;\n    }\n\n    public get now() {\n        return startOfMinute(Date.now()).valueOf();\n    }\n\n    public isToday(date: number) {\n        return isSameDay(date, Date.now());\n    }\n\n    public readonly edit = (e) => this._state.newBooking(e);\n    public readonly setDate = (d) => this._state.setDate(d);\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _dialog: MatDialog,\n        private _settings: SettingsService,\n        private _org: OrganisationService,\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription('poll', this._state.poll());\n    }\n\n    public typeColor(type: string) {\n        return this.types.find((_) => _.id === type)?.color || '#EEE';\n    }\n\n    public viewEvent(\n        event: CalendarEvent,\n        space_id: string,\n        scroll_to: boolean = false,\n    ) {\n        if (event.is_system_event) return;\n        const ref = this._dialog.open(EventDetailsModalComponent, {\n            data: event,\n        });\n        ref.componentInstance.hide_edit = !this._settings.get(\n            'app.events.allow_edit',\n        );\n        this.subscription(\n            'remove',\n            ref.componentInstance.remove.subscribe(() =>\n                this.remove(event, space_id),\n            ),\n        );\n        this.subscription(\n            'edit',\n            ref.componentInstance.edit.subscribe(() => this.edit(event)),\n        );\n        this.subscription(\n            'actions',\n            ref.componentInstance.action.subscribe(async (action) => {\n                if (!action.includes('breakdown')) return;\n                const ref = this._dialog.open(SetupBreakdownModalComponent, {\n                    data: event,\n                });\n                const data = await ref.afterClosed().toPromise();\n                if (data) this._state.replace(data);\n            }),\n        );\n    }\n\n    public async remove(item: CalendarEvent, space_id: string) {\n        const time = `${format(item.date, 'dd MMM yyyy ' + this.time_format)}`;\n        const resource_name = item.space?.display_name;\n        const content = `Delete the booking for ${resource_name} at ${time}`;\n        const resp = await openConfirmModal(\n            { title: `Delete booking`, content, icon: { content: 'delete' } },\n            this._dialog,\n        );\n        if (resp.reason !== 'done') return;\n        resp.loading('Requesting booking deletion...');\n        await declineEvent(item.id, {\n            calendar: item.calendar || item.mailbox || item.host,\n            system_id: space_id,\n        })\n            .toPromise()\n            .catch((e) => {\n                notifyError(`Unable to delete booking. ${e}`);\n                resp.close();\n                throw e;\n            });\n        notifySuccess('Successfully deleted booking.');\n        this._dialog.closeAll();\n    }\n}\n","import { Component } from '@angular/core';\nimport { OrganisationService } from '@placeos/organisation';\nimport { EventsStateService } from './events-state.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport { filter, map, take } from 'rxjs/operators';\nimport { combineLatest } from 'rxjs';\n\nconst EMPTY = [];\n@Component({\n    selector: 'room-bookings',\n    template: `\n        <div class=\"absolute inset-0 flex flex-col overflow-hidden pl-8\">\n            <div class=\"flex items-center w-full py-4 pr-8 space-x-4\">\n                <h2 class=\"text-2xl font-medium\">Room Bookings</h2>\n                <div class=\"flex-1 w-px\"></div>\n                <mat-form-field appearance=\"outline\" class=\"no-subscript w-32\">\n                    <mat-select\n                        [ngModel]=\"period | async\"\n                        (ngModelChange)=\"setPeriod($event)\"\n                    >\n                        <mat-option value=\"day\">Day</mat-option>\n                        <mat-option value=\"week\">Week</mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <button btn matRipple class=\"space-x-2\" (click)=\"newBooking()\">\n                    <div>New Booking</div>\n                    <app-icon>add</app-icon>\n                </button>\n            </div>\n            <div class=\"w-full flex items-center\">\n                <mat-form-field appearance=\"outline\" class=\"no-subscript w-52\">\n                    <mat-select\n                        [ngModel]=\"zones | async\"\n                        (ngModelChange)=\"updateZones($event)\"\n                        placeholder=\"All Levels\"\n                        multiple\n                    >\n                        <mat-option\n                            *ngFor=\"let level of levels | async\"\n                            [value]=\"level.id\"\n                        >\n                            <div class=\"flex flex-col-reverse\">\n                                <div\n                                    class=\"text-xs opacity-30\"\n                                    *ngIf=\"use_region\"\n                                >\n                                    {{\n                                        (level.parent_id | building)\n                                            ?.display_name\n                                    }}\n                                    <span class=\"opacity-0\"> - </span>\n                                </div>\n                                <div>\n                                    {{ level.display_name || level.name }}\n                                </div>\n                            </div>\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <ng-container *ngIf=\"allow_setup_breakdown\">\n                    <div\n                        class=\"border-l h-full ml-8 mr-4\"\n                        *ngIf=\"!use_region\"\n                    ></div>\n                    <mat-slide-toggle\n                        class=\"m-2\"\n                        [ngModel]=\"(ui_options | async)?.show_overflow\"\n                        (ngModelChange)=\"\n                            updateUIOptions({ show_overflow: $event })\n                        \"\n                    >\n                        <div class=\"text-xs\">Setup / Breakdown</div>\n                    </mat-slide-toggle>\n                </ng-container>\n                <div class=\"border-l h-full ml-8 mr-4\"></div>\n                <div\n                    class=\"flex items-center space-x-2 max-w-[calc(100%-16rem)] flex-1\"\n                >\n                    <button\n                        btn\n                        matRipple\n                        class=\"inverse\"\n                        [matMenuTriggerFor]=\"menu\"\n                    >\n                        <app-icon>filter_list</app-icon>\n                        <div class=\"mx-2\">Filters</div>\n                    </button>\n                    <mat-menu #menu=\"matMenu\" class=\"\">\n                        <div\n                            class=\"flex flex-col space-y-2 overflow-hidden w-48\"\n                        >\n                            <mat-checkbox\n                                *ngFor=\"let type of types\"\n                                [ngModel]=\"!type_list.includes(type.id)\"\n                                (ngModelChange)=\"setFilter(type.id, !$event)\"\n                            >\n                                {{ type.name }}\n                            </mat-checkbox>\n                        </div>\n                    </mat-menu>\n                    <div\n                        class=\"flex items-center overflow-x-auto flex-1 w-px space-x-2 px-2\"\n                    >\n                        @for (type of types; track type.id) {\n                            <div\n                                class=\"flex items-center border border-base-200 rounded-3xl\"\n                                *ngIf=\"!type_list.includes(type.id)\"\n                            >\n                                <div\n                                    class=\"h-4 w-4 m-2 rounded-full\"\n                                    [style.background-color]=\"type.color\"\n                                ></div>\n                                <div>{{ type.name }}</div>\n                                <button\n                                    icon\n                                    matRipple\n                                    (click)=\"setFilter(type.id, true)\"\n                                >\n                                    <app-icon>close</app-icon>\n                                </button>\n                            </div>\n                        }\n                    </div>\n                </div>\n            </div>\n            <div class=\"flex w-full flex-1 h-px border-t mt-4 border-base-200\">\n                <room-bookings-timeline\n                    *ngIf=\"(period | async) === 'day'\"\n                    class=\"relative flex-1 w-1/2 z-0\"\n                />\n                <room-week-bookings-timeline\n                    *ngIf=\"(period | async) === 'week'\"\n                    class=\"relative flex-1 w-1/2 z-0\"\n                />\n                <room-bookings-approvals\n                    class=\"relative z-10\"\n                    *ngIf=\"has_approvals\"\n                />\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class RoomBookingsComponent extends AsyncHandler {\n    public readonly zones = this._state.zones;\n    public readonly period = this._state.period;\n    public readonly ui_options = this._state.options;\n    public readonly levels = combineLatest([\n        this._org.active_building,\n        this._org.active_region,\n    ]).pipe(\n        map(([bld, region]) =>\n            this.use_region\n                ? this._org.levelsForRegion(region)\n                : this._org.levelsForBuilding(bld),\n        ),\n    );\n    /** List of levels for the active building */\n    public readonly updateZones = (z) => {\n        this._router.navigate([], {\n            relativeTo: this._route,\n            queryParams: { zone_ids: z.join(',') },\n            queryParamsHandling: 'merge',\n        });\n        this._state.setZones(z);\n    };\n    public readonly updateUIOptions = (o) => this._state.setUIOptions(o);\n    public readonly setPeriod = (p) => {\n        this._router.navigate([], {\n            relativeTo: this._route,\n            queryParams: { period: p },\n            queryParamsHandling: 'merge',\n        });\n        this._state.setPeriod(p);\n    };\n    /**  */\n    public readonly newBooking = (d?) => this._state.newBooking(d);\n\n    public readonly types: any[] = [\n        { id: 'internal', name: 'Internal', color: '#D81B60' },\n        { id: 'external', name: 'External', color: '#1E88E5' },\n        { id: 'cancelled', name: 'Cancelled', color: '#eeeeee' },\n    ];\n\n    public get type_list() {\n        return this._state.filters.hide_type || EMPTY;\n    }\n\n    public get has_approvals() {\n        return this._org.binding('approvals');\n    }\n\n    public get allow_setup_breakdown() {\n        return this._settings.get('app.events.allow_setup_breakdown');\n    }\n\n    public get use_region() {\n        return this._settings.get('app.use_region');\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _state: EventsStateService,\n        private _router: Router,\n        private _route: ActivatedRoute,\n        private _settings: SettingsService,\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('period')) {\n                    this._state.setPeriod(\n                        params.get('period') === 'day' ? 'day' : 'week',\n                    );\n                }\n                if (this.use_region) return;\n                if (params.has('zone_ids')) {\n                    const zones = params.get('zone_ids').split(',');\n                    if (zones.length) {\n                        const level = this._org.levelWithID(zones);\n                        if (!level) return;\n                        this._org.building = this._org.buildings.find(\n                            (bld) => bld.id === level.parent_id,\n                        );\n                    }\n                }\n            }),\n        );\n        this.subscription(\n            'levels',\n            this._org.active_levels.subscribe(async (levels) => {\n                if (this.use_region) return;\n                const zones = (\n                    await this.zones.pipe(take(1)).toPromise()\n                ).filter((zone) => levels.find((lvl) => lvl.id === zone));\n                if (!zones.length && levels.length) {\n                    zones.push(levels[0].id);\n                }\n                this.updateZones(zones);\n            }),\n        );\n        this.subscription(\n            'region',\n            this._org.active_region\n                .pipe(filter((_) => !!_))\n                .subscribe((_) => this.updateZones([_.id])),\n        );\n    }\n\n    public setFilter(id: string, value: boolean) {\n        const filters = this._state.filters;\n        let hide_type = filters.hide_type || [];\n        hide_type = hide_type.filter((i) => i !== id);\n        if (value) hide_type.push(id as any);\n        this._state.setFilters({ hide_type });\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule, DatePipe } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { UIModule } from '../ui/ui.module';\n\nimport { DayViewComponent } from './day-view.component';\nimport { DayviewTopbarComponent } from './dayview-topbar.component';\nimport { DayviewTimelineComponent } from './dayview-timeline.component';\nimport { DayviewSpaceComponent } from './dayview-space.component';\nimport { DayviewEventComponent } from './dayview-event.component';\n\nimport { BookingModalComponent } from './booking-modal.component';\nimport { EventFormComponent } from './event-form.component';\nimport { SharedSpacesModule } from '@placeos/spaces';\nimport { SharedUsersModule } from '@placeos/users';\nimport { SharedCateringModule } from '@placeos/catering';\nimport { RoomBookingsComponent } from './room-bookings.component';\nimport { RoomBookingsTimelineComponent } from './room-timeline.component';\nimport { RoomBookingsApprovalsComponent } from './room-approvals.component';\nimport { NewDayViewComponent } from './new-dayview.component';\nimport { MeetingFormDetailsComponent } from 'apps/workplace/src/app/book/meeting-flow/meeting-form-details.component';\nimport { EventBookModalComponent } from './event-book-modal.component';\nimport { RoomWeekBookingsTimelineComponent } from './room-week-timeline.component';\nimport { RoomBookingSearchComponent } from './room-booking-search.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: DayViewComponent },\n    { path: 'new', component: NewDayViewComponent },\n];\n\n@NgModule({\n    declarations: [\n        DayViewComponent,\n        DayviewTopbarComponent,\n        DayviewTimelineComponent,\n        DayviewSpaceComponent,\n        DayviewEventComponent,\n        NewDayViewComponent,\n\n        BookingModalComponent,\n        EventFormComponent,\n\n        RoomBookingsComponent,\n        RoomBookingsTimelineComponent,\n        RoomBookingsApprovalsComponent,\n        RoomBookingSearchComponent,\n        EventBookModalComponent,\n        MeetingFormDetailsComponent,\n        RoomWeekBookingsTimelineComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        UIModule,\n        SharedSpacesModule,\n        SharedUsersModule,\n        SharedCateringModule,\n        RouterModule.forChild(ROUTES),\n    ],\n})\nexport class DayViewModule {}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: '[app-new-dayview]',\n    template: `\n        <app-topbar></app-topbar>\n        <div class=\"flex flex-1 h-px\">\n            <app-sidebar></app-sidebar>\n            <main class=\"relative flex flex-col flex-1 w-1/2 h-full\">\n                <room-bookings></room-bookings>\n            </main>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n                background-color: var(--b1);\n            }\n\n            @media print {\n                :host {\n                    display: none;\n                }\n            }\n        `,\n    ],\n})\nexport class NewDayViewComponent {}\n","import { HashMap } from '@placeos/common';\nimport { getUnixTime } from 'date-fns';\n\nexport class MapLocation {\n    /** Source that the location was generated */\n    public type: 'desk' | 'wireless' | 'meeting' | 'other';\n    /** Details of the location */\n    public position: string | { x: number, y: number };\n    /** Accuracy of the location data */\n    public variance: number;\n    /** Unix epoch in seconds that the data was last updated */\n    public last_seen: number;\n    /** ID of the level associated with the location */\n    public level: string;\n    /** ID of the building associated with the location */\n    public building: string;\n    /** Whether user is currently at the location if fixed */\n    public at_location: boolean;\n    /**  */\n    public coordinates_from:\n        | 'top-left'\n        | 'top-right'\n        | 'bottom-left'\n        | 'bottom-right';\n\n    constructor(_data: HashMap = {}) {\n        this.type = _data.type || _data.location || 'other';\n        this.position = _data.position ||\n            _data.map_id || _data.asset_id || {\n                x: _data.x / _data.map_width || 0,\n                y: _data.y / _data.map_height || 0,\n            };\n        this.variance = _data.variance || 0;\n        this.last_seen = _data.last_seen || getUnixTime(new Date());\n        this.level = _data.level;\n        this.building = _data.building;\n        this.at_location = !!_data.at_location;\n        this.coordinates_from = _data.coordinates_from || 'top-left';\n    }\n}\n"],"x_google_ignoreList":[8]}