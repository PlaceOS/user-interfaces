{"version":3,"file":"apps_concierge_src_app_day-view_day-view_module_ts.js","mappings":"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","names":["i0","level_r1","id","display_name","name","type_r2","$event","_r3","ctx_r3","updateUIOptions","show_overflow","tmp_1_0","ui_options","DayviewTopbarComponent","AsyncHandler","options","this","_state","setUIOptions","allow_setup_breakdown","_settings","get","constructor","_org","_route","_router","super","zones","types","type_list","map","i","levels","active_levels","setDate","d","newBooking","updateZones","z","navigate","relativeTo","queryParams","zone_ids","join","updateTypes","setFilters","hide_type","reduce","list","item","includes","push","ngOnInit","_this","_asyncToGenerator","initialised","pipe","first","_","toPromise","subscription","queryParamMap","subscribe","params","has","split","length","level","levelWithID","building","buildings","find","bld","parent_id","static","__ngFactoryType__","i1","i2","i3","i4","core","VBU","selectors","features","decls","vars","consts","template","rf","ctx","DayviewTopbarComponent_mat_option_8_Template","DayviewTopbarComponent_mat_option_14_Template","DayviewTopbarComponent_mat_slide_toggle_15_Template","_c0","ctx_r0","type","overflow_top","overflow_height","event","title","time","attendees","_r2","view","DayviewEventComponent_div_2_div_3_Template","DayviewEventComponent_div_2_div_4_Template","DayviewEventComponent_div_2_div_5_Template","top","height","organiser","duration","ext","event_end","time_format","DAY_IN_MINUTES","DayviewEventComponent","date","Date","format","addMinutes","guests","status","e","setEvent","ngOnChanges","changes","start","startOfDay","diff","differenceInMinutes","setup_time","breakdown_time","inputs","DayviewEventComponent_div_0_Template","DayviewEventComponent_div_2_Template","DayviewEventComponent_div_3_Template","tmp_0_0","tmp_2_0","show_cleaning","DayviewSpaceComponent_ng_container_0_dayview_event_1_Template","ctx_r1","events","DayviewSpaceComponent","filtered","bookings","filter","bkn","resources","space","email","DayviewSpaceComponent_ng_container_0_Template","ctx_r2","scroll","y","time_r2","x","space_r4","tmp_4_0","space_list","i_r6","HOUR_BLOCKS","Array","fill","idx","DayviewTimelineComponent","blocks","loading","spaces","active_building","switchMap","querySystems","zone_id","limit","catchError","of","data","Space","shareReplay","combineLatest","startPolling","ngOnDestroy","stopPolling","onScroll","requestAnimationFrame","srcElement","scrollLeft","scrollTop","DayviewTimelineComponent_div_4_Template","DayviewTimelineComponent_div_8_Template","_r1","DayviewTimelineComponent_dayview_space_12_Template","DayviewTimelineComponent_div_14_Template","DayviewTimelineComponent_mat_progress_bar_15_Template","DayviewTimelineComponent_view_event_details_17_Template","DayViewComponent","links","route","attrs","event_r4","$implicit","selected","next","typeColor","state","date_end","system","tmp_11_0","host","RoomBookingSearchComponent_div_7_div_6_Template","RoomBookingSearchComponent_div_7_button_9_Template","RoomBookingSearchComponent","color","EventEmitter","show","search","BehaviorSubject","event_list","toLowerCase","is_system_event","showSearch","_input_element","nativeElement","focus","hideSearch","timeout","viewQuery","RoomBookingSearchComponent_app_icon_6_Template","RoomBookingSearchComponent_div_7_Template","getValue","space_r1","formatHour","hour_r2","RoomBookingsTimelineComponent_div_21_div_2_Template","block_height","i_r4","timeToOffset","now","i_r5","block_width","event_r7","all_day","tz","_r6","space_r8","viewEvent","RoomBookingsTimelineComponent_ng_container_28_ng_container_1_button_1_ng_container_2_Template","RoomBookingsTimelineComponent_ng_container_28_ng_container_1_button_1_ng_container_3_Template","i_r9","endToOffset","eventTooltip","RoomBookingsTimelineComponent_ng_container_28_ng_container_1_button_1_Template","RoomBookingsTimelineComponent_ng_container_28_ng_container_1_Template","RoomBookingsTimelineComponent","startOfMinute","valueOf","timezone","tz_offset","getTimezoneOffsetString","_local_tz","block_start","block_end","block_range","Math","min","max","_dialog","is_today","isSameDay","show_time","today","offset","getTimezoneDifferenceInHours","addHours","setHours","end","debounceTime","startWith","_hour_list","from","hours","edit","Intl","DateTimeFormat","resolvedOptions","timeZone","_date_pipe","DatePipe","hour","transform","h","current_tz","start_time","getDate","space_id","scroll_to","ref","open","EventDetailsModalComponent","componentInstance","hide_edit","remove","action","_ref","SetupBreakdownModalComponent","afterClosed","replace","_x","apply","arguments","_this2","content","resp","openConfirmModal","icon","reason","declineEvent","calendar","mailbox","system_id","catch","notifyError","close","notifySuccess","closeAll","RoomBookingsTimelineComponent_div_0_Template","RoomBookingsTimelineComponent_div_4_Template","RoomBookingsTimelineComponent_div_18_Template","RoomBookingsTimelineComponent_div_21_Template","RoomBookingsTimelineComponent_div_22_Template","RoomBookingsTimelineComponent_div_25_Template","RoomBookingsTimelineComponent_div_26_Template","RoomBookingsTimelineComponent_ng_container_28_Template","RoomBookingsTimelineComponent_div_30_Template","tmp_5_0","event_r2","tmp_3_0","images","RoomBookingsApprovalsComponent_div_17_span_7_Template","RoomBookingsApprovalsComponent_div_17_img_9_Template","approve","reject","tmp_6_0","_r4","RoomBookingsApprovalsComponent","value","_show","sessionStorage","setItem","pending","filtered_pending","getItem","binding","mod","getModule","execute","RoomBookingsApprovalsComponent_div_15_Template","RoomBookingsApprovalsComponent_div_17_Template","RoomBookingsApprovalsComponent_div_19_Template","RoomBookingsApprovalsComponent_button_20_Template","RoomWeekBookingsTimelineComponent_div_18_div_4_Template","date_r1","isToday","RoomWeekBookingsTimelineComponent_div_25_button_1_span_9_Template","RoomWeekBookingsTimelineComponent_div_25_button_1_Template","date_r5","RoomWeekBookingsTimelineComponent","_week_start","timezone_offset","getTimezoneOffsetInMinutes","days","addDays","startOfWeek","weekStartsOn","floor","this_week","isSameWeek","dateLeft","dateRight","dateLeftStartOfWeek","dateRightStartOfWeek","_data_pipe","day_list","date_value","event_date_value","event_max_count","poll","RoomWeekBookingsTimelineComponent_div_0_Template","RoomWeekBookingsTimelineComponent_div_4_Template","RoomWeekBookingsTimelineComponent_div_18_Template","RoomWeekBookingsTimelineComponent_div_25_Template","tmp_9_0","level_r2","RoomBookingsComponent_mat_option_21_div_2_Template","use_region","RoomBookingsComponent_ng_container_23_div_1_Template","type_r6","_r5","setFilter","_r7","type_r8","RoomBookingsComponent_For_37_div_0_Template","EMPTY","RoomBookingsComponent","filters","has_approvals","period","active_region","region","levelsForRegion","levelsForBuilding","console","warn","queryParamsHandling","setZones","o","setPeriod","p","take","zone","lvl","_ref2","_x2","RoomBookingsComponent_mat_option_21_Template","RoomBookingsComponent_ng_container_23_Template","RoomBookingsComponent_mat_checkbox_34_Template","RoomBookingsComponent_For_37_Template","_forTrack0","RoomBookingsComponent_room_bookings_timeline_39_Template","RoomBookingsComponent_room_week_bookings_timeline_41_Template","RoomBookingsComponent_room_bookings_approvals_43_Template","menu_r9","ROUTES","path","component","NewDayViewComponent","DayViewModule","$C","G2t","CommonModule","FormsModule","UIModule","SharedSpacesModule","SharedUsersModule","SharedCateringModule","RouterModule","forChild","MapLocation","_data","location","position","map_id","asset_id","map_width","map_height","variance","last_seen","getUnixTime","at_location","coordinates_from"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./apps/concierge/src/app/day-view/dayview-topbar.component.ts","./apps/concierge/src/app/day-view/dayview-event.component.ts","./apps/concierge/src/app/day-view/dayview-space.component.ts","./apps/concierge/src/app/day-view/dayview-timeline.component.ts","./apps/concierge/src/app/day-view/day-view.component.ts","./apps/concierge/src/app/day-view/room-booking-search.component.ts","./apps/concierge/src/app/day-view/room-timeline.component.ts","./apps/concierge/src/app/day-view/room-approvals.component.ts","./node_modules/date-fns/isSameWeek.mjs","./apps/concierge/src/app/day-view/room-week-timeline.component.ts","./apps/concierge/src/app/day-view/room-bookings.component.ts","./apps/concierge/src/app/day-view/day-view.module.ts","./apps/concierge/src/app/day-view/new-dayview.component.ts","./libs/users/src/lib/location.class.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { debounceTime, first } from 'rxjs/operators';\n\nimport { AsyncHandler, Identity, SettingsService } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { BookingUIOptions, EventsStateService } from './events-state.service';\n\n@Component({\n    selector: 'dayview-topbar',\n    template: `\n        <div\n            class=\"flex items-center px-4 h-20 bg-base-100 border-b border-base-200\"\n        >\n            <button\n                btn\n                matRipple\n                new\n                class=\"w-12 xl:w-auto overflow-hidden\"\n                (click)=\"newBooking()\"\n            >\n                <div class=\"flex items-center\">\n                    <app-icon\n                        class=\"mr-2\"\n                        [icon]=\"{ class: 'material-icons', content: 'add' }\"\n                    ></app-icon>\n                    <div class=\"hidden xl:block\">New Booking</div>\n                </div>\n            </button>\n            <mat-form-field appearance=\"outline\">\n                <mat-select\n                    multiple\n                    [(ngModel)]=\"zones\"\n                    (ngModelChange)=\"updateZones($event)\"\n                    placeholder=\"All Levels\"\n                >\n                    <mat-option\n                        *ngFor=\"let level of levels | async\"\n                        [value]=\"level.id\"\n                    >\n                        {{ level.display_name || level.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-form-field appearance=\"outline\">\n                <mat-select\n                    multiple\n                    [(ngModel)]=\"type_list\"\n                    (ngModelChange)=\"updateTypes($event)\"\n                    placeholder=\"No Events\"\n                >\n                    <mat-select-trigger>Legend</mat-select-trigger>\n                    <mat-option *ngFor=\"let type of types\" [value]=\"type.id\">\n                        {{ type.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-slide-toggle\n                class=\"m-2\"\n                [ngModel]=\"(ui_options | async)?.show_overflow\"\n                (ngModelChange)=\"updateUIOptions({ show_overflow: $event })\"\n                *ngIf=\"allow_setup_breakdown\"\n            >\n                <div class=\"text-xs\">Setup / Breakdown</div>\n            </mat-slide-toggle>\n            <div class=\"flex-1 w-0\"></div>\n            <!-- <searchbar class=\"mr-2\"></searchbar> -->\n            <date-options (dateChange)=\"setDate($event)\"></date-options>\n        </div>\n    `,\n    styles: [\n        `\n            button {\n                min-width: 0;\n                padding: 0 0.85rem;\n            }\n\n            mat-form-field {\n                height: 3.25em;\n                width: 8em;\n                margin-left: 1em;\n            }\n\n            mat-slide-toggle div {\n                width: 5.5em;\n                white-space: initial;\n                line-height: 1.2em;\n            }\n        `,\n    ],\n})\nexport class DayviewTopbarComponent extends AsyncHandler {\n    /** List of selected levels */\n    public zones: string[] = [];\n\n    public readonly types: Identity[] = [\n        { id: 'internal', name: 'Internal' },\n        { id: 'external', name: 'External' },\n        { id: 'cancelled', name: 'Cancelled' },\n    ];\n    /** List of selected types */\n    public type_list: string[] = this.types.map((i) => `${i.id}`);\n    /** List of levels for the active building */\n    public readonly levels = this._org.active_levels;\n    /** List of levels for the active building */\n    public readonly ui_options = this._state.options;\n    /** Set filtered date */\n    public readonly setDate = (d) => this._state.setDate(d);\n    /**  */\n    public readonly newBooking = (d?) => this._state.newBooking(d);\n    /** List of levels for the active building */\n    public readonly updateZones = (z) => {\n        this._router.navigate([], {\n            relativeTo: this._route,\n            queryParams: { zone_ids: z.join(',') },\n        });\n    };\n    /** List of levels for the active building */\n    public readonly updateTypes = (types) =>\n        this._state.setFilters({\n            hide_type: this.types.reduce((list, item) => {\n                !types.includes(item.id) ? list.push(item) : '';\n                return list;\n            }, []),\n        });\n\n    public updateUIOptions(options: BookingUIOptions) {\n        this._state.setUIOptions(options);\n    }\n\n    public get allow_setup_breakdown() {\n        return this._settings.get('app.events.allow_setup_breakdown');\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _router: Router,\n        private _settings: SettingsService,\n    ) {\n        super();\n    }\n\n    public async ngOnInit() {\n        await this._org.initialised.pipe(first((_) => _)).toPromise();\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('zone_ids')) {\n                    const zones = params.get('zone_ids').split(',');\n                    if (zones.length) {\n                        this.zones = zones;\n                        const level = this._org.levelWithID(zones);\n                        if (!level) return;\n                        this._org.building = this._org.buildings.find(\n                            (bld) => bld.id === level.parent_id,\n                        );\n                    }\n                }\n            }),\n        );\n        this.updateTypes(this.type_list);\n    }\n}\n","import { Component, Input, OnChanges, SimpleChanges } from '@angular/core';\nimport { startOfDay, differenceInMinutes, format, addMinutes } from 'date-fns';\n\nimport { CalendarEvent } from '@placeos/events';\nimport { EventsStateService } from './events-state.service';\nimport { SettingsService } from '@placeos/common';\n\nconst DAY_IN_MINUTES = 24 * 60;\n\n@Component({\n    selector: 'dayview-event',\n    template: `\n        <div\n            *ngIf=\"(ui_options | async)?.show_overflow\"\n            [class]=\"\n                'overflow-block absolute rounded overflow-hidden w-full ' + type\n            \"\n            [style.top]=\"overflow_top * 100 + '%'\"\n            [style.height]=\"overflow_height * 100 + '%'\"\n        ></div>\n        <div\n            event\n            matRipple\n            [class]=\"\n                'absolute rounded overflow-hidden text-sm border border-base-200 shadow-sm z-10 hover:z-30 ' +\n                type\n            \"\n            *ngIf=\"event\"\n            [style.top]=\"top * 100 + '%'\"\n            [style.height]=\"height * 100 + '%'\"\n            (click)=\"view(event)\"\n        >\n            <div class=\"px-2 py-1 font-medium\">{{ event.organiser?.name }}</div>\n            <div class=\"py-1 flex items-center\" *ngIf=\"event.duration > 30\">\n                <app-icon class=\"mx-2\">title</app-icon>\n                {{ event.title }}\n            </div>\n            <div class=\"py-1 flex items-center\" *ngIf=\"event.duration > 60\">\n                <app-icon class=\"mx-2\">schedule</app-icon>\n                {{ time }}\n            </div>\n            <div class=\"py-1 flex items-center\" *ngIf=\"event.duration > 90\">\n                <app-icon class=\"mx-2\">people</app-icon>\n                {{ event.attendees.length }} Attendee{{\n                    event.attendees.length === 1 ? '' : 's'\n                }}\n            </div>\n        </div>\n        <div\n            *ngIf=\"event && (ui_options | async)?.show_cleaning\"\n            cleaning\n            class=\"absolute rounded overflow-hidden flex w-full shadow p-2 bg-base-100 z-20 hover:!h-48\"\n            [style.top]=\"top * 100 + '%'\"\n            [style.height]=\"height * 100 + '%'\"\n        >\n            <div\n                [class]=\"\n                    'icon flex items-center justify-center mr-2 text-3xl rounded h-12 w-12 text-pending ' +\n                    event.ext('cleaning_status')\n                \"\n            >\n                <app-icon>{{\n                    event.ext('cleaning_status') === 'done' ? 'done' : 'warning'\n                }}</app-icon>\n            </div>\n            <div class=\"flex-1 w-1/2\">\n                {{\n                    event.ext('cleaning_status') === 'done'\n                        ? 'Finished'\n                        : 'Scheduled to'\n                }}\n                clean at\n                {{\n                    event.ext('cleaning_time') || event.event_end * 1000\n                        | date: time_format\n                }}\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            [event] {\n                background-color: #ccc;\n                width: 12rem;\n                z-index: 100;\n                transition: box-shadow 200ms;\n            }\n\n            [event]:hover {\n                box-shadow: 0 1px 3px 1px rgba(0, 0, 0, 0.2),\n                    0 1px 1px 0 rgba(0, 0, 0, 0.14),\n                    0 2px 1px -1px rgba(0, 0, 0, 0.12) !important;\n                cursor: pointer;\n            }\n\n            .overflow-block {\n                opacity: 0.3;\n                width: 12rem;\n            }\n\n            .internal {\n                background-color: #1565c0;\n                color: #fff;\n            }\n\n            .icon {\n                background-color: #f0f0f0;\n            }\n\n            .icon.done {\n                color: #21a453;\n            }\n\n            .external {\n                background-color: #ad1457;\n                color: #fff;\n            }\n\n            .cancelled {\n                background-color: #ccc;\n            }\n        `,\n    ],\n})\nexport class DayviewEventComponent implements OnChanges {\n    /** Event to display */\n    @Input() public event: CalendarEvent;\n    /** Top position for the event */\n    public top = -999;\n    /** Height of the event on the calendar */\n    public height = 0;\n    /** Top position for the event */\n    public overflow_top = -999;\n    /** Height of the event on the calendar */\n    public overflow_height = 0;\n\n    public readonly ui_options = this._state.options;\n\n    public readonly view = (e) => this._state.setEvent(e);\n\n    public get time() {\n        const date = new Date(this.event.date);\n        return (\n            format(date, this.time_format) +\n            ' - ' +\n            format(addMinutes(date, this.event.duration), this.time_format)\n        );\n    }\n\n    public get type() {\n        return this.event.guests.length\n            ? 'external'\n            : this.event.status === 'declined'\n            ? 'cancelled'\n            : 'internal';\n    }\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _settings: SettingsService\n    ) {}\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.event && this.event) {\n            const start = startOfDay(new Date(this.event.date));\n            const diff = differenceInMinutes(new Date(this.event.date), start);\n            this.top = diff / DAY_IN_MINUTES;\n            this.height = this.event.duration / DAY_IN_MINUTES;\n            this.overflow_top =\n                (diff - (this.event.setup_time || 0)) / DAY_IN_MINUTES;\n            this.overflow_height =\n                (this.event.duration +\n                    (this.event.setup_time || 0) +\n                    (this.event.breakdown_time || 0)) /\n                DAY_IN_MINUTES;\n        }\n    }\n}\n","import { Component, Input, OnInit } from '@angular/core';\nimport { map } from 'rxjs/operators';\n\nimport { CalendarEvent } from '@placeos/events';\nimport { Space } from '@placeos/spaces';\nimport { EventsStateService } from './events-state.service';\nimport { AsyncHandler } from '@placeos/common';\n\n@Component({\n    selector: 'dayview-space',\n    template: `\n        <ng-container *ngIf=\"space\">\n            <dayview-event\n                *ngFor=\"let event of events | async\"\n                [event]=\"event\"\n            ></dayview-event>\n        </ng-container>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n            }\n        `,\n    ],\n})\nexport class DayviewSpaceComponent extends AsyncHandler implements OnInit {\n    /** Space to display events for */\n    @Input() public space: Space;\n\n    public shown_event: CalendarEvent;\n    /** List of events for the selected space */\n    public readonly events = this._state.filtered.pipe(\n        map((bookings) => {\n            return bookings.filter((bkn) =>\n                bkn.resources.find((space) => this.space.email === space.email)\n            );\n        })\n    );\n\n    constructor(private _state: EventsStateService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription('events', this._state.filtered.subscribe());\n    }\n}\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { querySystems } from '@placeos/ts-client';\nimport { combineLatest, of } from 'rxjs';\nimport {\n    catchError,\n    filter,\n    map,\n    shareReplay,\n    switchMap,\n} from 'rxjs/operators';\n\nimport { AsyncHandler } from '@placeos/common';\nimport { OrganisationService } from '@placeos/organisation';\nimport { Space } from '@placeos/spaces';\nimport { EventsStateService } from './events-state.service';\n\nconst HOUR_BLOCKS = new Array(24).fill(0).map((_, idx) => {\n    return (idx % 12 === 0 ? 12 : idx % 12) + (idx >= 12 ? ' PM' : ' AM');\n});\n\n@Component({\n    selector: 'dayview-timeline',\n    template: `\n        <div class=\"absolute inset-0 flex\">\n            <div class=\"time h-full w-24 overflow-hidden bg-base-100 relative\">\n                <div header class=\"relative h-16 z-50\">\n                    <div\n                        class=\"bg-base-100 absolute top-0 left-0 right-0 bottom-8\"\n                    ></div>\n                </div>\n                <div\n                    *ngFor=\"let time of blocks\"\n                    change-transform\n                    class=\"relative h-16 border-r border-base-300 z-10\"\n                    [style.transform]=\"'translateY(-' + scroll.y + 'px)'\"\n                >\n                    <div\n                        class=\"absolute text-center w-full text-xs top-0 transform -translate-y-1/2 opacity-40\"\n                    >\n                        {{ time }}\n                    </div>\n                    <div\n                        class=\"absolute h-px w-2 top-0 right-0 bg-base-300\"\n                    ></div>\n                </div>\n                <div class=\"absolute h-8 w-px top-8 right-0 bg-base-300\"></div>\n            </div>\n            <div class=\"h-full flex-1 flex flex-col w-1/2\">\n                <div\n                    header\n                    class=\"flex relative overflow-hidden border-b border-base-300 border-opacity-50 bg-base-100 h-16 w-full\"\n                >\n                    <div\n                        *ngFor=\"let space of space_list | async\"\n                        change-transform\n                        class=\"relative h-16 w-48 min-w-[12rem]\"\n                        [style.transform]=\"'translateX(-' + scroll.x + 'px)'\"\n                    >\n                        <div\n                            bar\n                            class=\"absolute h-8 w-px bottom-0 -left-px bg-base-300\"\n                        ></div>\n                        <div class=\"name m-2 text-center\">\n                            {{ space.display_name || space.name }}\n                        </div>\n                    </div>\n                </div>\n                <div\n                    #scroll_el\n                    content\n                    class=\"relative flex flex-1 overflow-auto\"\n                    (scroll)=\"onScroll($event)\"\n                >\n                    <dayview-space\n                        *ngFor=\"let space of space_list | async\"\n                        [space]=\"space\"\n                        class=\"w-48 min-w-[12rem] h-[96rem] border-r border-base-300\"\n                    ></dayview-space>\n                    <div\n                        *ngFor=\"let time of blocks; let i = index\"\n                        class=\"absolute bg-base-300 h-px min-w-full left-0\"\n                        [style.width]=\"\n                            (space_list | async)?.length * 12 + 'rem'\n                        \"\n                        [style.top]=\"i * 4 + 'rem'\"\n                    ></div>\n                </div>\n            </div>\n            <mat-progress-bar\n                *ngIf=\"loading | async\"\n                mode=\"indeterminate\"\n                class=\"absolute bottom-0 left-0 right-0\"\n            ></mat-progress-bar>\n            <view-event-details\n                *ngIf=\"event | async\"\n                [event]=\"event | async\"\n            ></view-event-details>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                height: 100%;\n                width: 100%;\n            }\n\n            [change-transform] {\n                will-change: transform;\n            }\n        `,\n    ],\n})\nexport class DayviewTimelineComponent\n    extends AsyncHandler\n    implements OnInit, OnDestroy\n{\n    /** Time blocks to display */\n    public readonly blocks: string[] = HOUR_BLOCKS;\n    /** Current scroll position of the content */\n    public scroll: { x: number; y: number } = { x: 0, y: 0 };\n    /** Whether event data is loading */\n    public readonly loading = this._state.loading;\n    /** Event to show more details about */\n    public readonly event = this._state.event;\n\n    public readonly spaces = this._org.active_building.pipe(\n        filter((_) => !!_),\n        switchMap(({ id }) =>\n            querySystems({ zone_id: id, limit: 1000 }).pipe(\n                catchError(() => of({ data: [] }))\n            )\n        ),\n        map(({ data }) =>\n            data.map(\n                (_) =>\n                    new Space({\n                        ..._,\n                        level: this._org.levelWithID(_.zones),\n                    } as any)\n            )\n        ),\n        shareReplay(1)\n    );\n    /** List of spaces to display */\n    public readonly space_list = combineLatest([\n        this.spaces,\n        this._state.zones,\n    ]).pipe(\n        map(\n            ([spaces, zones]) =>\n                spaces.filter(\n                    (space) =>\n                        !zones?.length ||\n                        space.zones.find((z) => zones.includes(z))\n                ) || []\n        )\n    );\n\n    constructor(\n        private _org: OrganisationService,\n        private _state: EventsStateService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._state.startPolling();\n    }\n\n    public ngOnDestroy() {\n        this._state.stopPolling();\n    }\n\n    public onScroll(e) {\n        requestAnimationFrame(\n            () =>\n                (this.scroll = {\n                    x: e.srcElement.scrollLeft,\n                    y: e.srcElement.scrollTop,\n                })\n        );\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { ApplicationLinkInternal, SettingsService } from '@placeos/common';\n\n@Component({\n    selector: '[app-dayview]',\n    template: `\n        <sidebar class=\"h-full\"></sidebar>\n        <main\n            class=\"relative overflow-hidden flex flex-col flex-1 w-1/2 h-full bg-base-200\"\n        >\n            <dayview-topbar></dayview-topbar>\n            <dayview-timeline></dayview-timeline>\n        </main>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class DayViewComponent implements OnInit {\n    public get links(): ApplicationLinkInternal[] {\n        return this._settings.get('app.general.menu') || [];\n    }\n\n    constructor(private _settings: SettingsService, private _router: Router) {}\n\n    public ngOnInit() {\n        if (!this.links.find((_) => _.route.includes('day-view'))) {\n            this._router.navigate([`/${this.links[0].route}`]);\n        }\n    }\n}\n","import {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Output,\n    ViewChild,\n} from '@angular/core';\nimport { EventsStateService } from './events-state.service';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport { CalendarEvent } from '@placeos/events';\n\n@Component({\n    selector: 'room-booking-search',\n    template: `\n        <div class=\"relative\">\n            <button icon matRipple (click)=\"showSearch()\">\n                <app-icon>search</app-icon>\n            </button>\n            <input\n                #input_el\n                [class.opacity-0]=\"!show\"\n                [class.pointer-events-none]=\"!show\"\n                class=\"absolute top-1/2 -translate-y-1/2 w-[20rem] right-0 rounded-full pl-10 pr-4 py-3 border border-base-300 shadow bg-base-100\"\n                [ngModel]=\"search.getValue()\"\n                (ngModelChange)=\"search.next($event)\"\n                (blur)=\"hideSearch()\"\n                placeholder=\"Search day's events...\"\n            />\n            <app-icon\n                *ngIf=\"show\"\n                class=\"text-2xl absolute top-1/2 -translate-y-1/2 right-[17.5rem]\"\n            >\n                search\n            </app-icon>\n            <div\n                class=\"absolute top-full translate-y-2 w-[18rem] right-4 rounded border border-base-300 bg-base-100 max-h-[65vh] overflow-auto shadow\"\n                *ngIf=\"show\"\n            >\n                <div class=\"sticky top-0 p-4 bg-base-100 rounded z-10\">\n                    <div class=\"opacity-60 text-xs\">\n                        {{ (filtered | async)?.length }} of\n                        {{ (events | async)?.length }} Event(s)\n                    </div>\n                </div>\n                <div\n                    *ngIf=\"!(filtered | async).length\"\n                    class=\"opacity-30 p-4 flex items-center justify-center text-sm text-center\"\n                >\n                    {{\n                        (events | async).length\n                            ? 'No matching events found.'\n                            : 'No events for the currently selected date and zone'\n                    }}\n                </div>\n                <div class=\"px-2 pb-2 -mt-2\">\n                    <button\n                        matRipple\n                        *ngFor=\"let event of filtered | async\"\n                        class=\"relative flex items-center p-2 hover:bg-base-200 rounded w-full text-left space-x-2 z-0\"\n                        (click)=\"selected.next(event)\"\n                    >\n                        <div\n                            class=\"h-10 w-1 rounded-full\"\n                            [style.background-color]=\"typeColor(event)\"\n                        ></div>\n                        <div date class=\"leading-tight\">\n                            <div class=\"text-2xl mx-auto\">\n                                {{ event.date | date: 'dd' }}\n                            </div>\n                            <div\n                                class=\"font-medium text-sm uppercase mx-auto -mt-1\"\n                            >\n                                {{ event.date | date: 'MMM' }}\n                            </div>\n                        </div>\n                        <div class=\"flex-1 w-1/2\">\n                            <div class=\"flex items-center space-x-2 w-full\">\n                                <div\n                                    class=\"text-sm flex-1 truncate\"\n                                    [class.line-through]=\"\n                                        event.state === 'done'\n                                    \"\n                                >\n                                    {{ event.title }}\n                                </div>\n                                <div class=\"opacity-60 text-xs\">\n                                    {{ event.date | date: time_format }}\n                                    &ndash;\n                                    {{ event.date_end | date: time_format }}\n                                </div>\n                            </div>\n                            <div class=\"text-xs opacity-30 truncate\">\n                                {{ event.system?.display_name }}\n                            </div>\n                            <div class=\"text-xs opacity-30 truncate\">\n                                {{ (event.host | user)?.name || event.host }}\n                            </div>\n                        </div>\n                    </button>\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class RoomBookingSearchComponent extends AsyncHandler {\n    @Output() public selected = new EventEmitter<CalendarEvent>();\n    public show = false;\n    public readonly search = new BehaviorSubject('');\n    public readonly events = this._state.filtered;\n\n    public readonly types: any[] = [\n        { id: 'internal', name: 'Internal', color: '#D81B60' },\n        { id: 'external', name: 'External', color: '#1E88E5' },\n        { id: 'cancelled', name: 'Cancelled', color: '#eeeeee' },\n    ];\n\n    public readonly filtered = combineLatest([this.search, this.events]).pipe(\n        map(([search, event_list]) => {\n            search = search.toLowerCase();\n            return event_list.filter((e) => {\n                return (\n                    !e.is_system_event &&\n                    (e.title.toLowerCase().includes(search) ||\n                        e.organiser?.name.toLowerCase().includes(search) ||\n                        e.host.toLowerCase().includes(search) ||\n                        e.system?.display_name.toLowerCase().includes(search) ||\n                        e.system?.name.toLowerCase().includes(search) ||\n                        e.resources[0]?.display_name\n                            .toLowerCase()\n                            ?.includes(search) ||\n                        e.resources[0]?.name.toLowerCase()?.includes(search) ||\n                        e.resources[0]?.email.toLowerCase()?.includes(search))\n                );\n            });\n        }),\n    );\n\n    @ViewChild('input_el', { static: true })\n    private _input_element: ElementRef<HTMLInputElement>;\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    public typeColor(event) {\n        const type = this.types.find((_) => _.id === event.type);\n        return type?.color || '#EEE';\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _settings: SettingsService,\n    ) {\n        super();\n    }\n\n    public showSearch() {\n        this.show = true;\n        this._input_element.nativeElement.focus();\n    }\n\n    public hideSearch() {\n        if (!this.show) return;\n        this.timeout('hide', () => (this.show = false));\n    }\n}\n","import { Component } from '@angular/core';\nimport {\n    addHours,\n    differenceInMinutes,\n    format,\n    isSameDay,\n    setHours,\n    startOfDay,\n    startOfMinute,\n} from 'date-fns';\nimport { EventsStateService } from './events-state.service';\nimport { combineLatest } from 'rxjs';\nimport { debounceTime, map, shareReplay, startWith } from 'rxjs/operators';\nimport {\n    AsyncHandler,\n    SettingsService,\n    getTimezoneDifferenceInHours,\n    getTimezoneOffsetString,\n    notifyError,\n    notifySuccess,\n    openConfirmModal,\n} from '@placeos/common';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    CalendarEvent,\n    EventDetailsModalComponent,\n    SetupBreakdownModalComponent,\n    declineEvent,\n} from '@placeos/events';\nimport { DatePipe } from '@angular/common';\nimport { OrganisationService } from '@placeos/organisation';\n\n@Component({\n    selector: 'room-bookings-timeline',\n    template: `\n        <div\n            class=\"mx-2 mt-2 p-2 w-[calc(100%-1rem)] bg-info text-info-content rounded-lg text-center text-xs\"\n            *ngIf=\"timezone && tz\"\n        >\n            Timezone of the building is displayed and is different from your\n            local timezone.\n        </div>\n        <div\n            class=\"relative flex items-center justify-center p-2 space-x-2 border-b border-base-200 z-20\"\n        >\n            <date-options\n                [date]=\"date | async\"\n                (dateChange)=\"setDate($event)\"\n                [is_new]=\"true\"\n            ></date-options>\n            <div\n                class=\"absolute top-1/2 -translate-y-1/2 left-4 text-info text-sm\"\n                *ngIf=\"is_today | async\"\n            >\n                Today\n            </div>\n            <div class=\"absolute top-1/2 -translate-y-1/2 right-8\">\n                <room-booking-search\n                    (selected)=\"viewEvent($event, $event.system?.id, true)\"\n                ></room-booking-search>\n            </div>\n        </div>\n        <div timeline class=\"grid overflow-auto w-full h-1/2 flex-1 z-0\">\n            <div\n                timezone\n                class=\"sticky top-0 left-0 z-30 bg-base-100 flex items-center justify-center\"\n            >\n                <div class=\"text-xs opacity-30\">\n                    {{ date | async | date: 'z' : tz }}\n                </div>\n                <div\n                    class=\"absolute h-2 w-px right-0 bottom-0 bg-base-300\"\n                ></div>\n                <div\n                    class=\"absolute w-2 h-px right-0 bottom-0 bg-base-300\"\n                ></div>\n            </div>\n            <div\n                space-headers\n                class=\"sticky top-0 z-20 border-b border-base-300 flex items-center bg-base-100\"\n                [style.width]=\"(spaces | async)?.length * block_width + 'rem'\"\n            >\n                <div\n                    *ngFor=\"let space of spaces | async\"\n                    class=\"relative h-full w-56 flex items-center justify-center\"\n                >\n                    <div class=\"truncate\">\n                        {{ space.display_name || space.name }}\n                    </div>\n                    <div\n                        class=\"absolute h-2 w-px -left-px bottom-0 bg-base-300\"\n                    ></div>\n                </div>\n            </div>\n            <div\n                hour-blocks\n                class=\"sticky left-0 z-10 border-r border-base-300 bg-base-100 overflow-visible\"\n                [style.height]=\"block_range * block_height + 'rem'\"\n            >\n                <div\n                    *ngFor=\"let hour of hours; let i = index\"\n                    class=\"relative w-full\"\n                    [style.height]=\"block_height + 'rem'\"\n                >\n                    <div\n                        class=\"absolute -top-px right-0 w-2 h-px bg-base-300\"\n                    ></div>\n                    <div\n                        class=\"absolute -top-px right-3 -translate-y-1/2 text-xs opacity-60\"\n                        *ngIf=\"i !== 0\"\n                    >\n                        {{ formatHour(hour) }}\n                    </div>\n                </div>\n                <div\n                    class=\"absolute bg-secondary right-0 translate-x-1/2 -translate-y-1/2 h-2 w-2 rounded-full\"\n                    *ngIf=\"(show_time | async) && timeToOffset(now) < 100\"\n                    [style.top]=\"'calc(' + timeToOffset(now) + '% + 1px)'\"\n                ></div>\n            </div>\n            <div space-blocks class=\"relative overflow-hidden\">\n                <div\n                    *ngFor=\"let hour of hours; let i = index\"\n                    class=\"relative w-full border-b border-base-200\"\n                    [style.height]=\"block_height + 'rem'\"\n                ></div>\n                <div\n                    *ngFor=\"let space of spaces | async; let i = index\"\n                    class=\"absolute w-px h-full bg-base-200 top-0\"\n                    [style.left]=\"'calc(' + i * block_width + 'rem - 1px)'\"\n                ></div>\n\n                <ng-container\n                    *ngFor=\"let space of spaces | async; let i = index\"\n                >\n                    <ng-container\n                        *ngFor=\"let event of (events | async)[space.id] || []\"\n                    >\n                        <button\n                            event\n                            matRipple\n                            class=\"absolute w-52 hover:opacity-90 text-left\"\n                            [style.left]=\"i * block_width + 0.25 + 'rem'\"\n                            [style.top]=\"timeToOffset(event.date) + '%'\"\n                            [style.height]=\"endToOffset(event.duration) + '%'\"\n                            (click)=\"viewEvent(event, space.id)\"\n                            [matTooltip]=\"eventTooltip(event)\"\n                            *ngIf=\"\n                                !event.is_system_event ||\n                                (ui_options | async).show_overflow\n                            \"\n                        >\n                            <div\n                                class=\"relative w-full h-full shadow bg-base-100 border border-base-200 hover:bg-base-200 rounded-lg overflow-hidden px-3 py-1 text-xs\"\n                                [class.opacity-60]=\"event.state === 'done'\"\n                                [class.!rounded-none]=\"event.is_system_event\"\n                                [class.!border-secondary]=\"\n                                    event.is_system_event\n                                \"\n                            >\n                                <ng-container *ngIf=\"event.is_system_event\">\n                                    <div\n                                        class=\"absolute -inset-px bg-secondary opacity-30\"\n                                    ></div>\n                                </ng-container>\n                                <ng-container *ngIf=\"!event.is_system_event\">\n                                    <div\n                                        class=\"absolute left-0 inset-y-0 w-1 \"\n                                        [class.bg-secondary]=\"\n                                            event.status !== 'cancelled'\n                                        \"\n                                        [class.bg-error]=\"\n                                            event.status === 'cancelled'\n                                        \"\n                                    ></div>\n                                    <p\n                                        class=\"truncate\"\n                                        [class.opacity-60]=\"\n                                            event.status === 'cancelled'\n                                        \"\n                                    >\n                                        {{\n                                            event.all_day\n                                                ? 'All Day'\n                                                : (event.date\n                                                  | date: time_format : tz)\n                                        }}\n                                        &ndash;\n                                        {{ event.title }}\n                                    </p>\n                                    <p\n                                        class=\"truncate\"\n                                        [class.opacity-60]=\"\n                                            event.status === 'cancelled'\n                                        \"\n                                    >\n                                        {{\n                                            event.organiser?.name || event.host\n                                        }}\n                                    </p>\n                                </ng-container>\n                            </div>\n                        </button>\n                    </ng-container>\n                </ng-container>\n                <div\n                    *ngIf=\"show_time | async\"\n                    class=\"absolute inset-x-0 h-[2px] bg-secondary\"\n                    [style.top]=\"timeToOffset(now) + '%'\"\n                ></div>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                max-width: 100%;\n            }\n\n            [timeline] {\n                grid-template-columns: 4rem auto;\n                grid-template-rows: 3.5rem auto;\n            }\n        `,\n    ],\n})\nexport class RoomBookingsTimelineComponent extends AsyncHandler {\n    public block_width = 14;\n    public readonly ui_options = this._state.options;\n    public readonly spaces = this._state.spaces;\n    public readonly date = this._state.date;\n    public readonly is_today = this.date.pipe(\n        map((d) => isSameDay(d, Date.now())),\n    );\n    public readonly show_time = combineLatest([\n        this.date,\n        this._org.active_building,\n    ]).pipe(\n        map(([d]) => {\n            const today = isSameDay(d, Date.now());\n            const offset = this.timezone\n                ? getTimezoneDifferenceInHours(this.timezone)\n                : 0;\n            const start = addHours(\n                setHours(startOfDay(Date.now()), this.block_start),\n                -offset,\n            ).valueOf();\n            const end = addHours(\n                setHours(startOfDay(Date.now()), this.block_end),\n                -offset,\n            ).valueOf();\n            return today && Date.now() >= start && Date.now() <= end;\n        }),\n    );\n    public readonly events = combineLatest([\n        this._state.spaces,\n        this._state.filtered,\n        this.date,\n    ]).pipe(\n        debounceTime(300),\n        map(([spaces, events, date]) => {\n            const map = {};\n            const offset = this.timezone\n                ? getTimezoneDifferenceInHours(this.timezone)\n                : 0;\n            const start = addHours(\n                setHours(startOfDay(date), this.block_start),\n                -offset,\n            ).valueOf();\n            const end = addHours(\n                setHours(startOfDay(date), this.block_end),\n                -offset,\n            ).valueOf();\n            for (const space of spaces) {\n                map[space.id] = events\n                    .filter(\n                        (event) =>\n                            event.resources.find(\n                                (item) =>\n                                    item.id === space.id ||\n                                    item.email === space.email,\n                            ) ||\n                            event.system?.id === space.id ||\n                            event.system?.email === space.email,\n                    )\n                    .filter(\n                        (event) => event.date_end >= start && event.date <= end,\n                    );\n            }\n            return map;\n        }),\n        startWith({}),\n        shareReplay(1),\n    );\n\n    private _hour_list = Array.from({ length: 24 }, (_, i) => i);\n    public hours: number[] = [];\n\n    public get now() {\n        return startOfMinute(Date.now()).valueOf();\n    }\n\n    public readonly edit = (e) => this._state.newBooking(e);\n    public readonly setDate = (d) => this._state.setDate(d);\n\n    private _local_tz = getTimezoneOffsetString(\n        Intl.DateTimeFormat().resolvedOptions().timeZone,\n    );\n\n    public get timezone() {\n        return this._settings.get('app.events.use_building_timezone')\n            ? this._org.building.timezone\n            : '';\n    }\n\n    public get tz() {\n        const tz = this.timezone;\n        if (!tz) return '';\n        const tz_offset = getTimezoneOffsetString(tz);\n        return tz_offset === this._local_tz ? '' : tz_offset;\n    }\n\n    public get block_start() {\n        return +this._settings.get('app.events.block_start') || 0;\n    }\n\n    public get block_end() {\n        return +this._settings.get('app.events.block_end') || 24;\n    }\n\n    public get block_range() {\n        return Math.min(24, Math.max(this.block_end - this.block_start, 1));\n    }\n\n    public get block_height() {\n        return +this._settings.get('app.events.block_height') || 3;\n    }\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _dialog: MatDialog,\n        private _settings: SettingsService,\n        private _org: OrganisationService,\n    ) {\n        super();\n    }\n\n    public formatHour(hour: number) {\n        const date = setHours(Date.now(), hour);\n        return this._settings.get('app.use_24_hour_time')\n            ? format(date, 'HH:00')\n            : format(date, 'h a');\n    }\n\n    private _date_pipe = new DatePipe('en');\n\n    public eventTooltip(event: CalendarEvent) {\n        const tooltip = `Start: ${event.all_day ? 'All Day' : this._date_pipe.transform(event.date, this.time_format)}\nTitle:  ${event.title}\nHost:  ${event.organiser?.name || event.host}`;\n        return tooltip;\n    }\n\n    public ngOnInit() {\n        this.subscription('poll', this._state.startPolling());\n        this.subscription(\n            'hour_list',\n            this._org.active_building.subscribe(() => {\n                this.hours = this._hour_list.filter(\n                    (h) => h >= this.block_start && h < this.block_end,\n                );\n            }),\n        );\n        this.hours = this._hour_list.filter(\n            (h) => h >= this.block_start && h < this.block_end,\n        );\n        const current_tz = Intl.DateTimeFormat().resolvedOptions().timeZone;\n        const offset = !this.timezone\n            ? 0\n            : getTimezoneDifferenceInHours(current_tz, this.timezone);\n    }\n\n    public timeToOffset(date: number) {\n        const current_tz = Intl.DateTimeFormat().resolvedOptions().timeZone;\n        const offset = !this.timezone\n            ? 0\n            : getTimezoneDifferenceInHours(this.timezone, current_tz);\n        const start_time = setHours(\n            startOfDay(this._state.getDate()),\n            this.block_start - offset,\n        );\n        const diff = differenceInMinutes(date, start_time);\n\n        return (Math.max(0, diff / 60) / this.block_range) * 100;\n    }\n\n    public endToOffset(duration: number) {\n        return (\n            (Math.min(this.block_range, duration / 60) / this.block_range) * 100\n        );\n    }\n\n    public viewEvent(\n        event: CalendarEvent,\n        space_id: string,\n        scroll_to: boolean = false,\n    ) {\n        if (event.is_system_event) return;\n        const ref = this._dialog.open(EventDetailsModalComponent, {\n            data: event,\n        });\n        ref.componentInstance.hide_edit = !this._settings.get(\n            'app.events.allow_edit',\n        );\n        this.subscription(\n            'remove',\n            ref.componentInstance.remove.subscribe(() =>\n                this.remove(event, space_id),\n            ),\n        );\n        this.subscription(\n            'edit',\n            ref.componentInstance.edit.subscribe(() => this.edit(event)),\n        );\n        this.subscription(\n            'actions',\n            ref.componentInstance.action.subscribe(async (action) => {\n                if (!action.includes('breakdown')) return;\n                const ref = this._dialog.open(SetupBreakdownModalComponent, {\n                    data: event,\n                });\n                const data = await ref.afterClosed().toPromise();\n                if (data) this._state.replace(data);\n            }),\n        );\n    }\n\n    public async remove(item: CalendarEvent, space_id: string) {\n        const time = `${format(item.date, 'dd MMM yyyy ' + this.time_format)}`;\n        const resource_name = item.space?.display_name;\n        const content = `Delete the booking for ${resource_name} at ${time}`;\n        const resp = await openConfirmModal(\n            { title: `Delete booking`, content, icon: { content: 'delete' } },\n            this._dialog,\n        );\n        if (resp.reason !== 'done') return;\n        resp.loading('Requesting booking deletion...');\n        await declineEvent(item.id, {\n            calendar: item.calendar || item.mailbox || item.host,\n            system_id: space_id,\n        })\n            .toPromise()\n            .catch((e) => {\n                notifyError(`Unable to delete booking. ${e}`);\n                resp.close();\n                throw e;\n            });\n        notifySuccess('Successfully deleted booking.');\n        this._dialog.closeAll();\n    }\n}\n","import { Component } from '@angular/core';\nimport { EventsStateService } from './events-state.service';\nimport { OrganisationService } from '@placeos/organisation';\nimport { getModule } from '@placeos/ts-client';\nimport { CalendarEvent } from '@placeos/events';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { getTimezoneOffsetString, SettingsService } from '@placeos/common';\n\n@Component({\n    selector: 'room-bookings-approvals',\n    template: `\n        <div\n            class=\"flex flex-col h-full overflow-hidden border-l border-base-200 w-[20rem]\"\n            [style.width]=\"show ? '' : '0px'\"\n        >\n            <div\n                class=\"flex items-center p-2 justify-center border-b border-base-200 space-x-2 relative\"\n            >\n                <button\n                    btn\n                    icon\n                    matRipple\n                    class=\"absolute top-4 left-2 bg-base-200\"\n                    matTooltip=\"Hide Pending Approvals\"\n                    matTooltipPosition=\"left\"\n                    (click)=\"show = !show\"\n                >\n                    <app-icon>chevron_right</app-icon>\n                </button>\n                <h3 class=\"flex-1 py-4 text-center\">\n                    Pending Approval ({{\n                        (filtered_pending | async)?.length || '0'\n                    }}\n                    of {{ (pending | async)?.length || '0' }})\n                </h3>\n            </div>\n            <div class=\"border-b border-base-200 relative\">\n                <input\n                    type=\"text\"\n                    placeholder=\"Search...\"\n                    class=\"w-full py-3 pr-4 pl-10\"\n                    [ngModel]=\"search | async\"\n                    (ngModelChange)=\"search.next($event)\"\n                />\n                <app-icon\n                    class=\"absolute top-1/2 left-2 -translate-y-1/2 text-2xl pointer-events-none\"\n                >\n                    search\n                </app-icon>\n            </div>\n            <div class=\"flex-1 overflow-auto p-2 space-y-2\">\n                <div\n                    *ngIf=\"!(filtered_pending | async)?.length\"\n                    class=\"w-full h-full flex flex-col items-center justify-center space-y-2\"\n                >\n                    <img src=\"assets/icons/no-pending.svg\" />\n                    <p>No pending requests</p>\n                </div>\n                <div\n                    *ngFor=\"let event of filtered_pending | async\"\n                    class=\"relative border border-base-200 p-2 w-full rounded\"\n                >\n                    <h3>{{ event.title }}</h3>\n                    <p class=\"opacity-30 text-xs mb-2\">\n                        {{ event.date | date: 'mediumDate' : tz }}\n                        {{ event.date | date: time_format : tz }}\n                        <span *ngIf=\"tz\">{{\n                            event.date | date: 'z' : tz\n                        }}</span>\n                    </p>\n                    <div class=\"w-64 h-32 overflow-hidden mb-2 bg-base-200\">\n                        <img\n                            auth\n                            class=\"object-cover min-w-full min-h-full\"\n                            [source]=\"\n                                (event.resources[0]?.email | space | async)\n                                    ?.images[0]\n                            \"\n                            *ngIf=\"event.resources.length\"\n                        />\n                    </div>\n                    <div class=\"flex items-center space-x-2 mb-2\">\n                        <div\n                            class=\"h-8 w-8 bg-base-200 rounded-full flex items-center justify-center\"\n                        >\n                            <app-icon class=\"text-xl\">place</app-icon>\n                        </div>\n                        <div class=\"flex-1 text-xs\">\n                            {{\n                                (\n                                    event.resources.length &&\n                                    (event.resources[0]?.email | space | async)\n                                )?.display_name ||\n                                    (event.resources[0]?.email | space | async)\n                                        ?.name ||\n                                    'No Location'\n                            }}\n                        </div>\n                    </div>\n                    <div class=\"flex items-center space-x-2 mb-2\">\n                        <div\n                            class=\"h-8 w-8 bg-base-200 rounded-full flex items-center justify-center\"\n                        >\n                            <app-icon class=\"text-xl\">person</app-icon>\n                        </div>\n                        <div class=\"flex-1 text-xs\">\n                            {{ event.organiser?.name || event.host }}\n                        </div>\n                    </div>\n                    <div class=\"flex items-center space-x-2\">\n                        <button\n                            btn\n                            matRipple\n                            class=\"border-success bg-success-light text-black flex flex-1 items-center space-x-2\"\n                            [disabled]=\"status[event.id] === 'accept'\"\n                            (click)=\"approve(event)\"\n                        >\n                            <div>\n                                {{\n                                    status[event.id] === 'accept'\n                                        ? 'Approved'\n                                        : 'Approve'\n                                }}\n                            </div>\n                            <app-icon class=\"text-success\">done</app-icon>\n                        </button>\n                        <button\n                            btn\n                            matRipple\n                            class=\"border-error bg-error-light text-black flex flex-1 items-center space-x-2 \"\n                            [disabled]=\"status[event.id] === 'decline'\"\n                            (click)=\"reject(event)\"\n                        >\n                            <div>\n                                {{\n                                    status[event.id] === 'decline'\n                                        ? 'Declined'\n                                        : 'Decline'\n                                }}\n                            </div>\n                            <app-icon class=\"text-error\">close</app-icon>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <div\n                class=\"absolute bottom-0 left-0 right-0 top-14 p-2 flex flex-col items-center justify-center space-y-2\"\n                *ngIf=\"loading\"\n            >\n                <div class=\"absolute inset-0 bg-base-100 opacity-80 z-0\"></div>\n                <mat-spinner diameter=\"32\"></mat-spinner>\n                <p class=\"relative z-10\">Processing...</p>\n            </div>\n        </div>\n        <button\n            btn\n            icon\n            matRipple\n            class=\"bg-warning absolute top-2 -left-8 shadow text-warning-content\"\n            *ngIf=\"!show\"\n            (click)=\"show = !show\"\n            matTooltip=\"Show Pending Approvals\"\n            matTooltipPosition=\"left\"\n        >\n            <app-icon>chevron_left</app-icon>\n        </button>\n    `,\n    styles: [\n        `\n            :host {\n                display: block;\n                position: relative;\n                height: 100%;\n            }\n        `,\n    ],\n})\nexport class RoomBookingsApprovalsComponent {\n    private _show = true;\n    public loading = false;\n    public status: Record<string, 'accept' | 'decline' | undefined> = {};\n    public readonly search = new BehaviorSubject('');\n\n    public readonly pending = this._state.pending;\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    private _local_tz = getTimezoneOffsetString(\n        Intl.DateTimeFormat().resolvedOptions().timeZone,\n    );\n\n    public get timezone() {\n        return this._settings.get('app.events.use_building_timezone')\n            ? this._org.building.timezone\n            : '';\n    }\n\n    public get tz() {\n        const tz = this.timezone;\n        if (!tz) return '';\n        const tz_offset = getTimezoneOffsetString(tz);\n        return tz_offset === this._local_tz ? '' : tz_offset;\n    }\n\n    public readonly filtered_pending = combineLatest([\n        this._state.pending,\n        this.search,\n    ]).pipe(\n        map(([list, search]) =>\n            list.filter(\n                (event) =>\n                    event.title.toLowerCase().includes(search.toLowerCase()) ||\n                    event.host.toLowerCase().includes(search.toLowerCase()) ||\n                    event.organiser?.name\n                        .toLowerCase()\n                        .includes(search.toLowerCase()),\n            ),\n        ),\n    );\n\n    public set show(value: boolean) {\n        this._show = value;\n        sessionStorage.setItem(\n            'PlaceOS.Concierge.show_room_approvals',\n            `${value}`,\n        );\n    }\n\n    public get show() {\n        return this._show;\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _org: OrganisationService,\n        private _settings: SettingsService,\n    ) {}\n\n    public ngOnInit() {\n        this._show =\n            sessionStorage.getItem('PlaceOS.Concierge.show_room_approvals') !==\n            'false';\n    }\n\n    public async approve(event: CalendarEvent) {\n        const system_id = this._org.binding('approvals');\n        if (!system_id) return;\n        const mod = getModule(system_id, 'RoomBookingApproval', 1);\n        if (!mod) return;\n        this.loading = true;\n        await mod.execute('accept_event', [event.mailbox, event.id]).catch();\n        this.loading = false;\n        this.status[event.id] = 'accept';\n    }\n\n    public async reject(event: CalendarEvent) {\n        const system_id = this._org.binding('approvals');\n        if (!system_id) return;\n        const mod = getModule(system_id, 'RoomBookingApproval', 1);\n        if (!mod) return;\n        this.loading = true;\n        await mod.execute('decline_event', [event.mailbox, event.id]).catch();\n        this.loading = false;\n        this.status[event.id] = 'decline';\n    }\n}\n","import { startOfWeek } from \"./startOfWeek.mjs\";\n\n/**\n * The {@link isSameWeek} function options.\n */\n\n/**\n * @name isSameWeek\n * @category Week Helpers\n * @summary Are the given dates in the same week (and month and year)?\n *\n * @description\n * Are the given dates in the same week (and month and year)?\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param dateLeft - The first date to check\n * @param dateRight - The second date to check\n * @param options - An object with options\n *\n * @returns The dates are in the same week (and month and year)\n *\n * @example\n * // Are 31 August 2014 and 4 September 2014 in the same week?\n * const result = isSameWeek(new Date(2014, 7, 31), new Date(2014, 8, 4))\n * //=> true\n *\n * @example\n * // If week starts with Monday,\n * // are 31 August 2014 and 4 September 2014 in the same week?\n * const result = isSameWeek(new Date(2014, 7, 31), new Date(2014, 8, 4), {\n *   weekStartsOn: 1\n * })\n * //=> false\n *\n * @example\n * // Are 1 January 2014 and 1 January 2015 in the same week?\n * const result = isSameWeek(new Date(2014, 0, 1), new Date(2015, 0, 1))\n * //=> false\n */\nexport function isSameWeek(dateLeft, dateRight, options) {\n  const dateLeftStartOfWeek = startOfWeek(dateLeft, options);\n  const dateRightStartOfWeek = startOfWeek(dateRight, options);\n\n  return +dateLeftStartOfWeek === +dateRightStartOfWeek;\n}\n\n// Fallback for modularized imports:\nexport default isSameWeek;\n","import { Component } from '@angular/core';\nimport {\n    addDays,\n    isSameDay,\n    isSameWeek,\n    startOfMinute,\n    startOfWeek,\n    format,\n    setHours,\n} from 'date-fns';\nimport { EventsStateService } from './events-state.service';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    AsyncHandler,\n    getTimezoneOffsetInMinutes,\n    getTimezoneOffsetString,\n    notifyError,\n    notifySuccess,\n    openConfirmModal,\n    SettingsService,\n} from '@placeos/common';\nimport { map, shareReplay } from 'rxjs/operators';\nimport { combineLatest } from 'rxjs';\nimport {\n    CalendarEvent,\n    declineEvent,\n    EventDetailsModalComponent,\n    SetupBreakdownModalComponent,\n} from '@placeos/events';\nimport { OrganisationService } from '@placeos/organisation';\nimport { DatePipe } from '@angular/common';\n\n@Component({\n    selector: 'room-week-bookings-timeline',\n    template: `\n        <div\n            class=\"mx-2 mt-2 p-2 w-[calc(100%-1rem)] bg-info text-info-content rounded-lg text-center text-xs\"\n            *ngIf=\"timezone && tz\"\n        >\n            Timezone of the building is displayed and is different from your\n            local timezone.\n        </div>\n        <div\n            class=\"relative flex items-center justify-center p-2 space-x-2 border-b border-base-200 z-20\"\n        >\n            <date-options\n                [date]=\"date | async\"\n                [step]=\"7\"\n                (dateChange)=\"setDate($event)\"\n                [is_new]=\"true\"\n            ></date-options>\n            <div\n                class=\"absolute top-1/2 -translate-y-1/2 left-4 text-info text-sm\"\n                *ngIf=\"this_week | async\"\n            >\n                This Week\n            </div>\n            <div class=\"absolute top-1/2 -translate-y-1/2 right-8\">\n                <room-booking-search\n                    (selected)=\"viewEvent($event, $event.system?.id, true)\"\n                ></room-booking-search>\n            </div>\n        </div>\n        <div timeline class=\"grid overflow-auto w-full h-1/2 flex-1 z-0\">\n            <div\n                timezone\n                class=\"sticky top-0 left-0 z-30 bg-base-100 flex items-center justify-center\"\n            >\n                <div class=\"text-xs opacity-30\">\n                    {{ date | async | date: 'z' : tz }}\n                </div>\n                <div\n                    class=\"absolute h-2 w-px right-0 bottom-0 bg-base-300\"\n                ></div>\n                <div\n                    class=\"absolute w-2 h-px right-0 bottom-0 bg-base-300\"\n                ></div>\n            </div>\n            <div\n                day-headers\n                class=\"sticky top-0 z-20 border-b border-base-300 flex items-center bg-base-100 min-w-[calc(100%-3rem)]\"\n                [style.width]=\"(days | async)?.length * 12 + 'rem'\"\n            >\n                <div\n                    *ngFor=\"let date of days | async\"\n                    class=\"relative flex-1 h-full min-w-48 flex flex-col items-center justify-center leading-tight\"\n                >\n                    <div class=\"truncate\">\n                        {{ date | date: 'EEE, MMM d' : tz }}\n                    </div>\n                    <div\n                        class=\"text-info text-xs absolute bottom-1 left-1/2 -translate-x-1/2\"\n                        *ngIf=\"isToday(date)\"\n                    >\n                        Today\n                    </div>\n                    <div\n                        class=\"absolute h-2 w-px -left-px bottom-0 bg-base-300\"\n                    ></div>\n                </div>\n            </div>\n            <div\n                empty-block\n                class=\"sticky left-0 z-10 border-r border-base-300 bg-base-100 min-h-full\"\n                [style.height]=\"\n                    (event_max_count | async)\n                        ? (event_max_count | async) * 5.375 + 'rem'\n                        : ''\n                \"\n            ></div>\n            <div\n                date-blocks\n                class=\"relative overflow-hidden min-w-[calc(100%-3rem)] flex\"\n                [style.width]=\"(days | async)?.length * 12 + 'rem'\"\n            >\n                <div\n                    class=\"flex-1 min-w-48 overflow-hidden p-2 border-r border-base-200\"\n                    *ngFor=\"let date of days | async; let i = index\"\n                >\n                    <button\n                        matRipple\n                        *ngFor=\"let event of (events | async)[date] || []\"\n                        class=\"flex p-2 w-full space-x-2 hover:bg-base-200 rounded text-left\"\n                        (click)=\"viewEvent(event)\"\n                    >\n                        <div\n                            class=\"h-2 w-2 rounded-full my-1.5\"\n                            [style.background-color]=\"typeColor(event.type)\"\n                        ></div>\n                        <div class=\"flex-1 w-1/2\">\n                            <div\n                                class=\"text-sm truncate\"\n                                [class.line-through]=\"event.state === 'done'\"\n                            >\n                                {{ event.title }}\n                            </div>\n                            <div class=\"text-xs opacity-60 flex-1\">\n                                {{ event.date | date: time_format : tz }}\n                                &ndash;\n                                {{ event.date_end | date: time_format : tz }}\n                                <span *ngIf=\"tz\">{{\n                                    event.date_end | date: 'z' : tz\n                                }}</span>\n                            </div>\n                            <div class=\"text-xs truncate opacity-30\">\n                                {{ event.system?.display_name }}\n                            </div>\n                            <div class=\"text-xs truncate opacity-30\">\n                                {{ (event.host | user)?.name || event.host }}\n                            </div>\n                        </div>\n                    </button>\n                </div>\n            </div>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                max-width: 100%;\n            }\n\n            [timeline] {\n                grid-template-columns: 4rem auto;\n                grid-template-rows: 3.5rem auto;\n            }\n        `,\n    ],\n})\nexport class RoomWeekBookingsTimelineComponent extends AsyncHandler {\n    public hours = Array.from({ length: 24 }, (_, i) => i);\n    public readonly ui_options = this._state.options;\n    public readonly date = this._state.date;\n\n    public readonly types: any[] = [\n        { id: 'internal', name: 'Internal', color: '#D81B60' },\n        { id: 'external', name: 'External', color: '#1E88E5' },\n        { id: 'cancelled', name: 'Cancelled', color: '#eeeeee' },\n    ];\n\n    public readonly days = combineLatest([\n        this.date,\n        this._org.active_building,\n    ]).pipe(\n        map(([d]) =>\n            new Array(7)\n                .fill(0)\n                .map((_, idx) =>\n                    addDays(\n                        setHours(\n                            startOfWeek(d, { weekStartsOn: this._week_start }),\n                            12 - Math.floor(this.timezone_offset / 60),\n                        ),\n                        idx,\n                    ).valueOf(),\n                ),\n        ),\n    );\n    public readonly this_week = this.date.pipe(\n        map((d) => isSameWeek(d, Date.now())),\n    );\n\n    private _data_pipe = new DatePipe('en');\n\n    public readonly events = combineLatest([\n        this.days,\n        this._state.filtered,\n        this._state.zones,\n    ]).pipe(\n        map(([day_list, events, zones]) => {\n            if (zones.length) {\n                events = events.filter((_) =>\n                    _.system?.zones.find((_) => zones.includes(_)),\n                );\n            }\n\n            const map: Record<string, CalendarEvent[]> = {};\n            for (const date of day_list) {\n                const date_value = this._data_pipe.transform(\n                    date,\n                    'yyyy-MM-dd',\n                    this.tz,\n                );\n                map[date] = events.filter((event) => {\n                    const event_date_value = this._data_pipe.transform(\n                        event.date,\n                        'yyyy-MM-dd',\n                        this.tz,\n                    );\n                    return (\n                        date_value === event_date_value &&\n                        !event.is_system_event\n                    );\n                });\n            }\n            return map;\n        }),\n        shareReplay(1),\n    );\n\n    public readonly event_max_count = this.events.pipe(\n        map((e) => {\n            let length = 0;\n            for (const date in e) {\n                if (e[date].length > length) length = e[date].length;\n            }\n            return length;\n        }),\n    );\n\n    private get _week_start() {\n        return this._settings.get('app.week_start');\n    }\n\n    private _local_tz = getTimezoneOffsetString(\n        Intl.DateTimeFormat().resolvedOptions().timeZone,\n    );\n\n    public get timezone() {\n        return this._settings.get('app.events.use_building_timezone')\n            ? this._org.building.timezone\n            : '';\n    }\n\n    public get tz() {\n        const tz = this.timezone;\n        if (!tz) return '';\n        const tz_offset = getTimezoneOffsetString(tz);\n        return tz_offset === this._local_tz ? '' : tz_offset;\n    }\n\n    public get timezone_offset() {\n        return getTimezoneOffsetInMinutes(\n            this.timezone || Intl.DateTimeFormat().resolvedOptions().timeZone,\n        );\n    }\n\n    public get now() {\n        return startOfMinute(Date.now()).valueOf();\n    }\n\n    public isToday(date: number) {\n        return isSameDay(date, Date.now());\n    }\n\n    public readonly edit = (e) => this._state.newBooking(e);\n    public readonly setDate = (d) => this._state.setDate(d);\n\n    public get time_format() {\n        return this._settings.time_format;\n    }\n\n    constructor(\n        private _state: EventsStateService,\n        private _dialog: MatDialog,\n        private _settings: SettingsService,\n        private _org: OrganisationService,\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription('poll', this._state.poll());\n    }\n\n    public typeColor(type: string) {\n        return this.types.find((_) => _.id === type)?.color || '#EEE';\n    }\n\n    public viewEvent(\n        event: CalendarEvent,\n        space_id: string,\n        scroll_to: boolean = false,\n    ) {\n        if (event.is_system_event) return;\n        const ref = this._dialog.open(EventDetailsModalComponent, {\n            data: event,\n        });\n        ref.componentInstance.hide_edit = !this._settings.get(\n            'app.events.allow_edit',\n        );\n        this.subscription(\n            'remove',\n            ref.componentInstance.remove.subscribe(() =>\n                this.remove(event, space_id),\n            ),\n        );\n        this.subscription(\n            'edit',\n            ref.componentInstance.edit.subscribe(() => this.edit(event)),\n        );\n        this.subscription(\n            'actions',\n            ref.componentInstance.action.subscribe(async (action) => {\n                if (!action.includes('breakdown')) return;\n                const ref = this._dialog.open(SetupBreakdownModalComponent, {\n                    data: event,\n                });\n                const data = await ref.afterClosed().toPromise();\n                if (data) this._state.replace(data);\n            }),\n        );\n    }\n\n    public async remove(item: CalendarEvent, space_id: string) {\n        const time = `${format(item.date, 'dd MMM yyyy ' + this.time_format)}`;\n        const resource_name = item.space?.display_name;\n        const content = `Delete the booking for ${resource_name} at ${time}`;\n        const resp = await openConfirmModal(\n            { title: `Delete booking`, content, icon: { content: 'delete' } },\n            this._dialog,\n        );\n        if (resp.reason !== 'done') return;\n        resp.loading('Requesting booking deletion...');\n        await declineEvent(item.id, {\n            calendar: item.calendar || item.mailbox || item.host,\n            system_id: space_id,\n        })\n            .toPromise()\n            .catch((e) => {\n                notifyError(`Unable to delete booking. ${e}`);\n                resp.close();\n                throw e;\n            });\n        notifySuccess('Successfully deleted booking.');\n        this._dialog.closeAll();\n    }\n}\n","import { Component } from '@angular/core';\nimport { OrganisationService } from '@placeos/organisation';\nimport { EventsStateService } from './events-state.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { AsyncHandler, SettingsService } from '@placeos/common';\nimport { debounceTime, filter, map, take } from 'rxjs/operators';\nimport { combineLatest } from 'rxjs';\n\nconst EMPTY = [];\n@Component({\n    selector: 'room-bookings',\n    template: `\n        <div class=\"absolute inset-0 flex flex-col overflow-hidden pl-8\">\n            <div class=\"flex items-center w-full py-4 pr-8 space-x-4\">\n                <h2 class=\"text-2xl font-medium\">Room Bookings</h2>\n                <div class=\"flex-1 w-px\"></div>\n                <mat-form-field appearance=\"outline\" class=\"no-subscript w-32\">\n                    <mat-select\n                        [ngModel]=\"period | async\"\n                        (ngModelChange)=\"setPeriod($event)\"\n                    >\n                        <mat-option value=\"day\">Day</mat-option>\n                        <mat-option value=\"week\">Week</mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <button btn matRipple class=\"space-x-2\" (click)=\"newBooking()\">\n                    <div>New Booking</div>\n                    <app-icon>add</app-icon>\n                </button>\n            </div>\n            <div class=\"w-full flex items-center\">\n                <mat-form-field appearance=\"outline\" class=\"no-subscript w-52\">\n                    <mat-select\n                        [ngModel]=\"zones | async\"\n                        (ngModelChange)=\"updateZones($event)\"\n                        placeholder=\"All Levels\"\n                        multiple\n                    >\n                        <mat-option\n                            *ngFor=\"let level of levels | async\"\n                            [value]=\"level.id\"\n                        >\n                            <div class=\"flex flex-col-reverse\">\n                                <div\n                                    class=\"text-xs opacity-30\"\n                                    *ngIf=\"use_region\"\n                                >\n                                    {{\n                                        (level.parent_id | building)\n                                            ?.display_name\n                                    }}\n                                    <span class=\"opacity-0\"> - </span>\n                                </div>\n                                <div>\n                                    {{ level.display_name || level.name }}\n                                </div>\n                            </div>\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <ng-container *ngIf=\"allow_setup_breakdown\">\n                    <div\n                        class=\"border-l h-full ml-8 mr-4\"\n                        *ngIf=\"!use_region\"\n                    ></div>\n                    <mat-slide-toggle\n                        class=\"m-2\"\n                        [ngModel]=\"(ui_options | async)?.show_overflow\"\n                        (ngModelChange)=\"\n                            updateUIOptions({ show_overflow: $event })\n                        \"\n                    >\n                        <div class=\"text-xs\">Setup / Breakdown</div>\n                    </mat-slide-toggle>\n                </ng-container>\n                <div class=\"border-l h-full ml-8 mr-4\"></div>\n                <div\n                    class=\"flex items-center space-x-2 max-w-[calc(100%-16rem)] flex-1\"\n                >\n                    <button\n                        btn\n                        matRipple\n                        class=\"inverse\"\n                        [matMenuTriggerFor]=\"menu\"\n                    >\n                        <app-icon>filter_list</app-icon>\n                        <div class=\"mx-2\">Filters</div>\n                    </button>\n                    <mat-menu #menu=\"matMenu\" class=\"\">\n                        <div\n                            class=\"flex flex-col space-y-2 overflow-hidden w-48\"\n                        >\n                            <mat-checkbox\n                                *ngFor=\"let type of types\"\n                                [ngModel]=\"!type_list.includes(type.id)\"\n                                (ngModelChange)=\"setFilter(type.id, !$event)\"\n                            >\n                                {{ type.name }}\n                            </mat-checkbox>\n                        </div>\n                    </mat-menu>\n                    <div\n                        class=\"flex items-center overflow-x-auto flex-1 w-px space-x-2 px-2\"\n                    >\n                        @for (type of types; track type.id) {\n                            <div\n                                class=\"flex items-center border border-base-200 rounded-3xl\"\n                                *ngIf=\"!type_list.includes(type.id)\"\n                            >\n                                <div\n                                    class=\"h-4 w-4 m-2 rounded-full\"\n                                    [style.background-color]=\"type.color\"\n                                ></div>\n                                <div>{{ type.name }}</div>\n                                <button\n                                    icon\n                                    matRipple\n                                    (click)=\"setFilter(type.id, true)\"\n                                >\n                                    <app-icon>close</app-icon>\n                                </button>\n                            </div>\n                        }\n                    </div>\n                </div>\n            </div>\n            <div class=\"flex w-full flex-1 h-px border-t mt-4 border-base-200\">\n                <room-bookings-timeline\n                    *ngIf=\"(period | async) === 'day'\"\n                    class=\"relative flex-1 w-1/2 z-0\"\n                />\n                <room-week-bookings-timeline\n                    *ngIf=\"(period | async) === 'week'\"\n                    class=\"relative flex-1 w-1/2 z-0\"\n                />\n                <room-bookings-approvals\n                    class=\"relative z-10\"\n                    *ngIf=\"has_approvals\"\n                />\n            </div>\n        </div>\n    `,\n    styles: [``],\n})\nexport class RoomBookingsComponent extends AsyncHandler {\n    public readonly zones = this._state.zones;\n    public readonly period = this._state.period;\n    public readonly ui_options = this._state.options;\n    public readonly levels = combineLatest([\n        this._org.active_building,\n        this._org.active_region,\n    ]).pipe(\n        map(([bld, region]) =>\n            this.use_region\n                ? this._org.levelsForRegion(region)\n                : this._org.levelsForBuilding(bld),\n        ),\n    );\n    /** List of levels for the active building */\n    public readonly updateZones = (z) => {\n        console.warn('Update Zones:', z);\n        this._router.navigate([], {\n            relativeTo: this._route,\n            queryParams: { zone_ids: z.join(',') },\n            queryParamsHandling: 'merge',\n        });\n        this._state.setZones(z);\n    };\n    public readonly updateUIOptions = (o) => this._state.setUIOptions(o);\n    public readonly setPeriod = (p) => {\n        console.warn('Set Period:', p);\n        this._router.navigate([], {\n            relativeTo: this._route,\n            queryParams: { period: p },\n            queryParamsHandling: 'merge',\n        });\n        this._state.setPeriod(p);\n    };\n    /**  */\n    public readonly newBooking = (d?) => this._state.newBooking(d);\n\n    public readonly types: any[] = [\n        { id: 'internal', name: 'Internal', color: '#D81B60' },\n        { id: 'external', name: 'External', color: '#1E88E5' },\n        { id: 'cancelled', name: 'Cancelled', color: '#eeeeee' },\n    ];\n\n    public get type_list() {\n        return this._state.filters.hide_type || EMPTY;\n    }\n\n    public get has_approvals() {\n        return this._org.binding('approvals');\n    }\n\n    public get allow_setup_breakdown() {\n        return this._settings.get('app.events.allow_setup_breakdown');\n    }\n\n    public get use_region() {\n        return this._settings.get('app.use_region');\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _state: EventsStateService,\n        private _router: Router,\n        private _route: ActivatedRoute,\n        private _settings: SettingsService,\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                if (params.has('period')) {\n                    this._state.setPeriod(\n                        params.get('period') === 'day' ? 'day' : 'week',\n                    );\n                }\n                if (this.use_region) return;\n                if (params.has('zone_ids')) {\n                    const zones = params.get('zone_ids').split(',');\n                    if (zones.length) {\n                        const level = this._org.levelWithID(zones);\n                        if (!level) return;\n                        this._org.building = this._org.buildings.find(\n                            (bld) => bld.id === level.parent_id,\n                        );\n                        this.updateZones(zones);\n                    }\n                }\n            }),\n        );\n        this.subscription(\n            'levels',\n            this._org.active_levels\n                .pipe(debounceTime(300))\n                .subscribe(async (levels) => {\n                    if (this.use_region) return;\n                    const zones = (\n                        await this.zones.pipe(take(1)).toPromise()\n                    ).filter((zone) => levels.find((lvl) => lvl.id === zone));\n                    if (!zones.length && levels.length) {\n                        zones.push(levels[0].id);\n                    }\n                    this.updateZones(zones);\n                }),\n        );\n        this.subscription(\n            'region',\n            this._org.active_region\n                .pipe(filter((_) => !!_))\n                .subscribe(async (_) => {\n                    const zones = await this.zones.pipe(take(1)).toPromise();\n                    if (zones.length) return;\n                    this.updateZones([_.id]);\n                }),\n        );\n    }\n\n    public setFilter(id: string, value: boolean) {\n        const filters = this._state.filters;\n        let hide_type = filters.hide_type || [];\n        hide_type = hide_type.filter((i) => i !== id);\n        if (value) hide_type.push(id as any);\n        this._state.setFilters({ hide_type });\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule, DatePipe } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { UIModule } from '../ui/ui.module';\n\nimport { DayViewComponent } from './day-view.component';\nimport { DayviewTopbarComponent } from './dayview-topbar.component';\nimport { DayviewTimelineComponent } from './dayview-timeline.component';\nimport { DayviewSpaceComponent } from './dayview-space.component';\nimport { DayviewEventComponent } from './dayview-event.component';\n\nimport { BookingModalComponent } from './booking-modal.component';\nimport { EventFormComponent } from './event-form.component';\nimport { SharedSpacesModule } from '@placeos/spaces';\nimport { SharedUsersModule } from '@placeos/users';\nimport { SharedCateringModule } from '@placeos/catering';\nimport { RoomBookingsComponent } from './room-bookings.component';\nimport { RoomBookingsTimelineComponent } from './room-timeline.component';\nimport { RoomBookingsApprovalsComponent } from './room-approvals.component';\nimport { NewDayViewComponent } from './new-dayview.component';\nimport { MeetingFormDetailsComponent } from 'apps/workplace/src/app/book/meeting-flow/meeting-form-details.component';\nimport { EventBookModalComponent } from './event-book-modal.component';\nimport { RoomWeekBookingsTimelineComponent } from './room-week-timeline.component';\nimport { RoomBookingSearchComponent } from './room-booking-search.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: DayViewComponent },\n    { path: 'new', component: NewDayViewComponent },\n];\n\n@NgModule({\n    declarations: [\n        DayViewComponent,\n        DayviewTopbarComponent,\n        DayviewTimelineComponent,\n        DayviewSpaceComponent,\n        DayviewEventComponent,\n        NewDayViewComponent,\n\n        BookingModalComponent,\n        EventFormComponent,\n\n        RoomBookingsComponent,\n        RoomBookingsTimelineComponent,\n        RoomBookingsApprovalsComponent,\n        RoomBookingSearchComponent,\n        EventBookModalComponent,\n        MeetingFormDetailsComponent,\n        RoomWeekBookingsTimelineComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        UIModule,\n        SharedSpacesModule,\n        SharedUsersModule,\n        SharedCateringModule,\n        RouterModule.forChild(ROUTES),\n    ],\n})\nexport class DayViewModule {}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: '[app-new-dayview]',\n    template: `\n        <app-topbar></app-topbar>\n        <div class=\"flex flex-1 h-px\">\n            <app-sidebar></app-sidebar>\n            <main class=\"relative flex flex-col flex-1 w-1/2 h-full\">\n                <room-bookings></room-bookings>\n            </main>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                width: 100%;\n                background-color: var(--b1);\n            }\n\n            @media print {\n                :host {\n                    display: none;\n                }\n            }\n        `,\n    ],\n})\nexport class NewDayViewComponent {}\n","import { HashMap } from '@placeos/common';\nimport { getUnixTime } from 'date-fns';\n\nexport class MapLocation {\n    /** Source that the location was generated */\n    public type: 'desk' | 'wireless' | 'meeting' | 'other';\n    /** Details of the location */\n    public position: string | { x: number, y: number };\n    /** Accuracy of the location data */\n    public variance: number;\n    /** Unix epoch in seconds that the data was last updated */\n    public last_seen: number;\n    /** ID of the level associated with the location */\n    public level: string;\n    /** ID of the building associated with the location */\n    public building: string;\n    /** Whether user is currently at the location if fixed */\n    public at_location: boolean;\n    /**  */\n    public coordinates_from:\n        | 'top-left'\n        | 'top-right'\n        | 'bottom-left'\n        | 'bottom-right';\n\n    constructor(_data: HashMap = {}) {\n        this.type = _data.type || _data.location || 'other';\n        this.position = _data.position ||\n            _data.map_id || _data.asset_id || {\n                x: _data.x / _data.map_width || 0,\n                y: _data.y / _data.map_height || 0,\n            };\n        this.variance = _data.variance || 0;\n        this.last_seen = _data.last_seen || getUnixTime(new Date());\n        this.level = _data.level;\n        this.building = _data.building;\n        this.at_location = !!_data.at_location;\n        this.coordinates_from = _data.coordinates_from || 'top-left';\n    }\n}\n"],"x_google_ignoreList":[8]}