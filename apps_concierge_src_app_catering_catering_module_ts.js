(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([["apps_concierge_src_app_catering_catering_module_ts"],{6997:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CateringModule:()=>Qt});var i=n(1511),o=n(6073),r=n(6898),s=n(5109),a=n(33),c=n(787),l=n(8223),d=n(2619),u=n(1490),g=n(4762),m=n(3530),p=n(84),f=n(9236),h=n(4608),Z=n(8055),_=n(1950),v=n(9604);const x=[{id:"after_hour",name:"After Hour"},{id:"before_hour",name:"Before Hour"},{id:"min_length",name:"Min. Meeting Length"},{id:"max_length",name:"Max. Meeting Length"},{id:"is_before",name:"Is Before Time"},{id:"is_after",name:"Is After Time"},{id:"visitor_type",name:"Visitor Type"},{id:"groups",name:"User in Groups"}];var b=n(5980),A=n(1548),w=n(6283),q=n(6756),T=n(4786),y=n(1522);function O(e,t){1&e&&(d.TgZ(0,"button",5),d.TgZ(1,"app-icon"),d._uU(2,"close"),d.qZA(),d.qZA())}function U(e,t){if(1&e&&(d.TgZ(0,"mat-option",18),d._uU(1),d.qZA()),2&e){const e=t.$implicit;d.Q6J("value",e.id),d.xp6(1),d.hij(" ",e.name," ")}}function I(e,t){if(1&e&&(d.TgZ(0,"div",14),d.TgZ(1,"mat-form-field",8),d.TgZ(2,"mat-select",15),d.NdJ("ngModelChange",function(e){return t.$implicit[0]=e}),d.YNc(3,U,2,2,"mat-option",16),d.qZA(),d.qZA(),d.TgZ(4,"mat-form-field",8),d.TgZ(5,"input",17),d.NdJ("ngModelChange",function(e){return t.$implicit[1]=e}),d.qZA(),d.TgZ(6,"mat-error"),d._uU(7,"Rule value is required"),d.qZA(),d.qZA(),d.qZA()),2&e){const e=t.$implicit,n=d.oxw(2);d.xp6(2),d.Q6J("ngModel",e[0]),d.xp6(1),d.Q6J("ngForOf",n.rule_types),d.xp6(2),d.Q6J("ngModel",e[1])}}function C(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",6),d.TgZ(1,"div",7),d.TgZ(2,"mat-form-field",8),d.TgZ(3,"input",9),d.NdJ("ngModelChange",function(e){return t.$implicit.name=e}),d.qZA(),d.TgZ(4,"mat-error"),d._uU(5,"Ruleset name is required"),d.qZA(),d.qZA(),d.TgZ(6,"button",10),d.NdJ("click",function(){const t=d.CHM(e).$implicit,n=d.oxw();return t.rules.push(["",""]),n.show_rules=t.id}),d.TgZ(7,"app-icon"),d._uU(8,"add"),d.qZA(),d.qZA(),d.TgZ(9,"button",11),d.NdJ("click",function(){const t=d.CHM(e).$implicit,n=d.oxw();return n.show_rules=n.show_rules!==t.id?t.id:""}),d.TgZ(10,"app-icon"),d._uU(11),d.qZA(),d.qZA(),d.qZA(),d.TgZ(12,"div",12),d.YNc(13,I,8,3,"div",13),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit,n=d.oxw();d.xp6(3),d.Q6J("ngModel",e.name),d.xp6(6),d.Q6J("disabled",!e.rules.length),d.xp6(2),d.Oqu(n.show_rules===e.id?"expand_less":"expand_more"),d.xp6(1),d.Udp("height",(n.show_rules===e.id?3.5*e.rules.length:0)+"em"),d.xp6(1),d.Q6J("ngForOf",e.rules)}}let J=(()=>{class e{constructor(e){this._data=e,this.event=new d.vpe,this.loading=!1,this.rule_types=x,this.rulesets=(e.config||[]).map(e=>(e.rules=e.rules.map(e=>[e[0],JSON.stringify(e[1])]),e))}get new_id(){return"ruleset-"+Math.floor(99999999*Math.random())}saveChanges(){this.loading=!0;const e=this.rulesets.map(e=>Object.assign(Object.assign({},e),{rules:e.rules.map(e=>{let t=e[1];try{t=JSON.parse(e[1])}catch(n){}return[e[0],t]})}));this.event.emit({reason:"done",metadata:e})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(h.WI))},e.\u0275cmp=d.Xpm({type:e,selectors:[["catering-config-modal"]],outputs:{event:"event"},decls:11,vars:2,consts:[["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[1,"overflow-auto","text-center"],["mat-button","",3,"click"],["class","ruleset",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-icon-button","","mat-dialog-close",""],[1,"ruleset"],[1,"flex"],["appearance","outline",1,"flex-1"],["matInput","","name","name","placeholder","Zone ID, Category or Tag","required","",3,"ngModel","ngModelChange"],["mat-icon-button","",1,"mb-6",3,"click"],["mat-icon-button","",1,"mb-6",3,"disabled","click"],["name","rules",1,"bg-gray-100","rounded","overflow-hidden"],["class","flex px-2 h-14 space-x-2",4,"ngFor","ngForOf"],[1,"flex","px-2","h-14","space-x-2"],["name","booking-type","placeholder","Select Rule",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","value","placeholder","Rule value","required","",3,"ngModel","ngModelChange"],[3,"value"]],template:function(e,t){1&e&&(d.TgZ(0,"header"),d.TgZ(1,"h3"),d._uU(2,"Edit Catering Configuration"),d.qZA(),d.YNc(3,O,3,0,"button",0),d.qZA(),d.TgZ(4,"main",1),d.TgZ(5,"button",2),d.NdJ("click",function(){return t.rulesets.push({id:t.new_id,rules:[]})}),d._uU(6," New Ruleset "),d.qZA(),d.YNc(7,C,14,6,"div",3),d.qZA(),d.TgZ(8,"footer",4),d.TgZ(9,"button",2),d.NdJ("click",function(){return t.saveChanges()}),d._uU(10,"Save Changes"),d.qZA(),d.qZA()),2&e&&(d.xp6(3),d.Q6J("ngIf",!t.loading),d.xp6(4),d.Q6J("ngForOf",t.rulesets))},directives:[i.O5,b.lW,i.sg,h.ZT,A.o,w.KE,q.Nt,o.Fj,o.Q7,o.JJ,o.On,w.TO,T.gD,y.ey],styles:["[name=rules][_ngcontent-%COMP%]{transition:height .2s}main[_ngcontent-%COMP%]{width:32em;padding:.5em 1em 1em}main[_ngcontent-%COMP%]   button.mat-button[_ngcontent-%COMP%]{margin:0 auto .5em;min-width:12em}"]}),e})();var N=n(5842),M=n(3016),k=n(5135),Q=n(7806);function j(e,t){1&e&&(d.TgZ(0,"button",7),d.TgZ(1,"app-icon"),d._uU(2,"close"),d.qZA(),d.qZA())}function F(e,t){if(1&e&&(d.TgZ(0,"div",15),d.TgZ(1,"label",16),d._uU(2," Name"),d.TgZ(3,"span"),d._uU(4,"*"),d.qZA(),d._uU(5,": "),d.qZA(),d.TgZ(6,"mat-form-field",17),d._UZ(7,"input",18),d.TgZ(8,"mat-error"),d._uU(9,"Name is required"),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw(2);d.xp6(1),d.ekj("error",e.form.controls.name.invalid&&e.form.controls.name.touched)}}function Y(e,t){if(1&e&&(d.TgZ(0,"div",15),d.TgZ(1,"label",19),d._uU(2," Category"),d.TgZ(3,"span"),d._uU(4,"*"),d.qZA(),d._uU(5,": "),d.qZA(),d.TgZ(6,"mat-form-field",17),d._UZ(7,"input",20),d.TgZ(8,"mat-error"),d._uU(9,"Category is required"),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw(2),t=d.MAs(9);d.xp6(1),d.ekj("error",e.form.controls.category.invalid&&e.form.controls.category.touched),d.xp6(6),d.Q6J("matAutocomplete",t)}}const P=function(){return{class:"material-icons",content:"close"}};function $(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"mat-chip",27),d.NdJ("removed",function(){const t=d.CHM(e).$implicit;return d.oxw(3).removeTag(t)}),d._uU(1),d._UZ(2,"app-icon",28),d.qZA()}if(2&e){const e=t.$implicit;d.Q6J("selectable",!0)("removable",!0),d.xp6(1),d.hij(" ",e," "),d.xp6(1),d.Q6J("icon",d.DdM(4,P))}}function E(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",15),d.TgZ(1,"label",21),d.SDv(2,22),d.qZA(),d.TgZ(3,"mat-form-field",17),d.TgZ(4,"mat-chip-list",23,24),d.YNc(6,$,3,5,"mat-chip",25),d.TgZ(7,"input",26),d.NdJ("matChipInputTokenEnd",function(t){return d.CHM(e),d.oxw(2).addTag(t)}),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=d.MAs(5),t=d.oxw(2);d.xp6(1),d.ekj("error",t.form.controls.tags.invalid&&t.form.controls.tags.touched),d.xp6(5),d.Q6J("ngForOf",t.tag_list),d.xp6(1),d.Q6J("matChipInputFor",e)("matChipInputSeparatorKeyCodes",t.separators)("matChipInputAddOnBlur",!0)}}function G(e,t){1&e&&(d.TgZ(0,"div",15),d.TgZ(1,"label",29),d._uU(2,"Description:"),d.qZA(),d.TgZ(3,"mat-form-field",17),d._UZ(4,"textarea",30),d.qZA(),d.qZA())}function L(e,t){if(1&e&&(d.TgZ(0,"div",15),d.TgZ(1,"label",16),d._uU(2," Unit Price"),d.TgZ(3,"span"),d._uU(4,"*"),d.qZA(),d._uU(5,": "),d.qZA(),d.TgZ(6,"mat-form-field",17),d._UZ(7,"input",31),d.TgZ(8,"mat-error"),d._uU(9,"Unit Price is required"),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw(2);d.xp6(1),d.ekj("error",e.form.controls.unit_price.invalid&&e.form.controls.unit_price.touched)}}function H(e,t){if(1&e&&(d.TgZ(0,"form",8),d.YNc(1,F,10,2,"div",9),d.YNc(2,Y,10,3,"div",9),d.YNc(3,E,8,6,"div",9),d.YNc(4,G,5,0,"div",9),d.YNc(5,L,10,2,"div",9),d.TgZ(6,"div",10),d.TgZ(7,"label",11),d._uU(8,"Accept Points?"),d.qZA(),d.TgZ(9,"mat-checkbox",12),d._uU(10),d.qZA(),d.qZA(),d.TgZ(11,"div",10),d.TgZ(12,"label",13),d._uU(13,"Discount Cap"),d.qZA(),d._UZ(14,"a-counter",14),d.qZA(),d.qZA()),2&e){const e=d.oxw();let t;d.Q6J("formGroup",e.form),d.xp6(1),d.Q6J("ngIf",e.form.controls.name),d.xp6(1),d.Q6J("ngIf",e.form.controls.category),d.xp6(1),d.Q6J("ngIf",e.form.controls.tags),d.xp6(1),d.Q6J("ngIf",e.form.controls.description),d.xp6(1),d.Q6J("ngIf",e.form.controls.unit_price),d.xp6(5),d.Oqu(null!=(t=e.form.get("accept_points"))&&t.value?"No":"Yes"),d.xp6(4),d.Q6J("min",0)("max",100)("step",5)("render_fn",e.renderPercent)}}function S(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"footer",32),d.TgZ(1,"button",33),d.NdJ("click",function(){return d.CHM(e),d.oxw().saveChanges()}),d._uU(2," Save "),d.qZA(),d.qZA()}if(2&e){const e=d.oxw();d.xp6(1),d.Q6J("disabled",!e.form.dirty)}}function z(e,t){1&e&&(d.TgZ(0,"div",34),d._UZ(1,"mat-spinner",35),d.TgZ(2,"p"),d._uU(3,"Saving catering item..."),d.qZA(),d.qZA())}function D(e,t){if(1&e&&(d.TgZ(0,"mat-option",36),d._uU(1),d.qZA()),2&e){const e=t.$implicit;d.Q6J("value",e),d.xp6(1),d.hij(" ",e," ")}}let B=(()=>{class e{constructor(e){this._data=e,this.event=new d.vpe,this.form=new o.cw({name:new o.NI(this.item.name||"",[o.kI.required]),description:new o.NI(this.item.description||""),category:new o.NI(this.item.category||"",[o.kI.required]),unit_price:new o.NI(this.item.unit_price,[o.kI.required]),tags:new o.NI(this.item.tags||[]),accept_points:new o.NI(this.item.accept_points||!1),discount_cap:new o.NI(this.item.discount_cap||0)}),this.loading=!1,this.separators=[N.K5,N.OC,N.L_],console.log("Form:",this.form)}get item(){return this._data.item||new M.U}get categories(){return this._data.categories||[]}get tag_list(){return this.form.controls.tags.value}renderPercent(e=0){return`${e}%`}addTag(e){if(!this.form||!this.form.controls.tags)return;this.form.controls.tags.markAsDirty();const t=e.input,n=e.value,i=this.tag_list;(n||"").trim()&&(i.push(n),this.form.controls.tags.setValue(i)),t&&(t.value="")}removeTag(e){if(!this.form||!this.form.controls.tags)return;const t=this.tag_list;this.form.controls.tags.markAsDirty();const n=t.indexOf(e);n>=0&&(t.splice(n,1),this.form.controls.tags.setValue(t))}saveChanges(){this.loading=!0,this.event.emit({reason:"done",metadata:{item:new M.U(Object.assign(Object.assign(Object.assign({},this.item),{id:this.item.id||`item-${(0,l.Iy)(99999999)}`}),this.form.value))}})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(h.WI))},e.\u0275cmp=d.Xpm({type:e,selectors:[["catering-item-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:function(){let e,t;return e=$localize`:@@tagsLabel␟800ffadd463cfe152c5af3fa9f13803ab2e77b93␟4746186018558508280: Tags: `,t=$localize`:@@zoneTagsPlaceholder␟8dc7c13b0c6b8ad9c770bce0ad72e14b4aef8456␟3986010900542572161:Zone tags...`,[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"flex","items-center"],[1,"flex-none","w-28","min-w-0"],["formControlName","accept_points"],[1,"flex-1","w-24","min-w-0"],["formControlName","discount_cap",1,"border","border-gray-200","rounded",3,"min","max","step","render_fn"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","category"],["matInput","","name","category","placeholder","Category","formControlName","category",3,"matAutocomplete"],["for","tags"],e,["aria-label","Item Tags"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["name","tags","placeholder",t,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"selectable","removable","removed"],["matChipRemove","",3,"icon"],["for","description"],["matInput","","name","description","placeholder","Item Description","formControlName","description"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],[1,"flex","p-2","items-center","justify-center","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]]},template:function(e,t){if(1&e&&(d.TgZ(0,"header"),d.TgZ(1,"h3",0),d._uU(2),d.qZA(),d.YNc(3,j,3,0,"button",1),d.qZA(),d.YNc(4,H,15,11,"form",2),d.YNc(5,S,3,1,"footer",3),d.YNc(6,z,4,0,"ng-template",null,4,d.W1O),d.TgZ(8,"mat-autocomplete",null,5),d.YNc(10,D,2,2,"mat-option",6),d.qZA()),2&e){const e=d.MAs(7);d.xp6(2),d.hij("",t.item.id?"Edit":"Add"," Item"),d.xp6(1),d.Q6J("ngIf",!t.loading),d.xp6(1),d.Q6J("ngIf",t.form&&!t.loading)("ngIfElse",e),d.xp6(1),d.Q6J("ngIf",!t.loading),d.xp6(5),d.Q6J("ngForOf",t.categories)}},directives:[h.uh,i.O5,p.XC,i.sg,b.lW,h.ZT,A.o,o._Y,o.JL,o.sg,f.oG,o.JJ,o.u,k.R,w.KE,q.Nt,o.Fj,w.TO,p.ZL,a.qn,a.oH,a.HS,a.qH,o.wV,Q.$g,y.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"]}),e})();var X=n(4554),W=n(8512),V=n(7276);function K(e,t){1&e&&(d.TgZ(0,"button",7),d.TgZ(1,"app-icon"),d._uU(2,"close"),d.qZA(),d.qZA())}function R(e,t){if(1&e&&(d.TgZ(0,"div",10),d.TgZ(1,"label",11),d._uU(2," Name"),d.TgZ(3,"span"),d._uU(4,"*"),d.qZA(),d._uU(5,": "),d.qZA(),d.TgZ(6,"mat-form-field",12),d._UZ(7,"input",13),d.TgZ(8,"mat-error"),d._uU(9,"Name is required"),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw(2);d.xp6(1),d.ekj("error",e.form.controls.name.invalid&&e.form.controls.name.touched)}}function ee(e,t){if(1&e&&(d.TgZ(0,"div",10),d.TgZ(1,"label",14),d._uU(2," Type"),d.TgZ(3,"span"),d._uU(4,"*"),d.qZA(),d._uU(5,": "),d.qZA(),d.TgZ(6,"mat-form-field",12),d._UZ(7,"input",15),d.TgZ(8,"mat-error"),d._uU(9,"Type is required"),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw(2),t=d.MAs(9);d.xp6(1),d.ekj("error",e.form.controls.group.invalid&&e.form.controls.group.touched),d.xp6(6),d.Q6J("matAutocomplete",t)}}function te(e,t){1&e&&(d.TgZ(0,"div",10),d.TgZ(1,"label",11),d._uU(2,"Unit Price:"),d.qZA(),d.TgZ(3,"mat-form-field",12),d._UZ(4,"input",16),d.qZA(),d.qZA())}function ne(e,t){1&e&&(d.TgZ(0,"div",10),d.TgZ(1,"mat-checkbox",17),d._uU(2," Can select multiple of type "),d.qZA(),d.qZA())}function ie(e,t){if(1&e&&(d.TgZ(0,"form",8),d.YNc(1,R,10,2,"div",9),d.YNc(2,ee,10,3,"div",9),d.YNc(3,te,5,0,"div",9),d.YNc(4,ne,3,0,"div",9),d.qZA()),2&e){const e=d.oxw();d.Q6J("formGroup",e.form),d.xp6(1),d.Q6J("ngIf",e.form.controls.name),d.xp6(1),d.Q6J("ngIf",e.form.controls.group),d.xp6(1),d.Q6J("ngIf",e.form.controls.unit_price),d.xp6(1),d.Q6J("ngIf",e.form.controls.multiple)}}function oe(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"footer",18),d.TgZ(1,"button",19),d.NdJ("click",function(){return d.CHM(e),d.oxw().saveChanges()}),d._uU(2," Save "),d.qZA(),d.qZA()}if(2&e){const e=d.oxw();d.xp6(1),d.Q6J("disabled",!e.form.dirty)}}function re(e,t){1&e&&(d.TgZ(0,"div",20),d._UZ(1,"mat-spinner",21),d.TgZ(2,"p"),d._uU(3,"Saving catering item option..."),d.qZA(),d.qZA())}function se(e,t){if(1&e&&(d.TgZ(0,"mat-option",22),d._uU(1),d.qZA()),2&e){const e=t.$implicit;d.Q6J("value",e),d.xp6(1),d.hij(" ",e," ")}}let ae=(()=>{class e{constructor(e){this._data=e,this.event=new d.vpe,this.loading=!1}get option(){return this._data.option}get types(){return this._data.types||[]}ngOnInit(){this.form=new o.cw({name:new o.NI(this.option.name||"",[o.kI.required]),group:new o.NI(this.option.group||"",[o.kI.required]),unit_price:new o.NI(this.option.unit_price),multiple:new o.NI(!!this.option.multiple,[])})}saveChanges(){this.loading=!0;const e=Object.assign(Object.assign(Object.assign({},this.option),{id:this.option.id||`option-${(0,V.Iy)(99999999)}`}),this.form.value);this.event.emit({reason:"done",metadata:{item:new M.U(Object.assign(Object.assign({},this._data.parent),{options:this._data.parent.options.filter(t=>t.id!==e.id).concat([e])}))}})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(h.WI))},e.\u0275cmp=d.Xpm({type:e,selectors:[["catering-option-modal"]],outputs:{event:"event"},decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],["class","p-4 overflow-auto",3,"formGroup",4,"ngIf","ngIfElse"],["class","flex p-2 items-center justify-center border-none border-t border-solid border-gray-300",4,"ngIf"],["load_state",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[1,"p-4","overflow-auto",3,"formGroup"],["class","field",4,"ngIf"],[1,"field"],["for","title"],["appearance","outline"],["matInput","","name","name","placeholder","Item name","formControlName","name"],["for","group"],["matInput","","name","group","placeholder","Type of option e.g. Number of sugars","formControlName","group",3,"matAutocomplete"],["matInput","","name","unit-price","type","number","placeholder","Unit Price","formControlName","unit_price"],["name","multiple","formControlName","multiple"],[1,"flex","p-2","items-center","justify-center","border-none","border-t","border-solid","border-gray-300"],["mat-button","",3,"disabled","click"],[1,"flex","flex-col","items-center","p-8","space-y-2","w-64"],["diameter","32"],[3,"value"]],template:function(e,t){if(1&e&&(d.TgZ(0,"header"),d.TgZ(1,"h3",0),d._uU(2),d.qZA(),d.YNc(3,K,3,0,"button",1),d.qZA(),d.YNc(4,ie,5,5,"form",2),d.YNc(5,oe,3,1,"footer",3),d.YNc(6,re,4,0,"ng-template",null,4,d.W1O),d.TgZ(8,"mat-autocomplete",null,5),d.YNc(10,se,2,2,"mat-option",6),d.qZA()),2&e){const e=d.MAs(7);d.xp6(2),d.hij(" ",t.option.id?"Edit":"Add"," Item Option "),d.xp6(1),d.Q6J("ngIf",!t.loading),d.xp6(1),d.Q6J("ngIf",t.form&&!t.loading)("ngIfElse",e),d.xp6(1),d.Q6J("ngIf",!t.loading),d.xp6(5),d.Q6J("ngForOf",t.types)}},directives:[h.uh,i.O5,p.XC,i.sg,b.lW,h.ZT,A.o,o._Y,o.JL,o.sg,w.KE,q.Nt,o.Fj,o.JJ,o.u,w.TO,p.ZL,o.wV,f.oG,Q.$g,y.ey],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"]}),e})();var ce=n(7968),le=n(8774),de=n(847),ue=n(9310),ge=n(9996),me=n(391);function pe(e,t){1&e&&(d.TgZ(0,"div",17),d._uU(1," Options Available "),d.qZA())}const fe=function(){return{class:"material-icons",content:"add"}};function he(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",11),d.TgZ(1,"div",12),d.TgZ(2,"div",12),d._uU(3),d.qZA(),d.YNc(4,pe,2,0,"div",13),d.qZA(),d.TgZ(5,"div",14),d._uU(6),d.ALo(7,"currency"),d.qZA(),d.TgZ(8,"button",15),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw(5).addItem(t)}),d._UZ(9,"app-icon",16),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit;d.xp6(3),d.hij(" ",e.name," "),d.xp6(1),d.Q6J("ngIf",e.options.length),d.xp6(2),d.hij(" ",d.lcZ(7,4,e.unit_price/100)," "),d.xp6(3),d.Q6J("icon",d.DdM(6,fe))}}const Ze=function(){return{}};function _e(e,t){if(1&e&&(d.TgZ(0,"mat-tab",8),d.TgZ(1,"div",9),d.YNc(2,he,10,7,"div",10),d.ALo(3,"async"),d.qZA(),d.qZA()),2&e){const e=d.oxw().$implicit,t=d.oxw(3);d.Q6J("label",e),d.xp6(2),d.Q6J("ngForOf",(d.lcZ(3,2,t.menu_items$)||d.DdM(4,Ze))[e])}}function ve(e,t){if(1&e&&(d.ynx(0),d.YNc(1,_e,4,5,"mat-tab",7),d.ALo(2,"async"),d.BQk()),2&e){const e=t.$implicit,n=d.oxw(3);d.xp6(1),d.Q6J("ngIf",(d.lcZ(2,1,n.menu_items$)||d.DdM(3,Ze))[e].length)}}function xe(e,t){if(1&e&&(d.ynx(0),d.TgZ(1,"mat-tab-group"),d.YNc(2,ve,3,4,"ng-container",6),d.ALo(3,"async"),d.qZA(),d.BQk()),2&e){const e=d.oxw(2);d.xp6(2),d.Q6J("ngForOf",d.lcZ(3,1,e.categories))}}function be(e,t){if(1&e&&(d.TgZ(0,"div",4),d.YNc(1,xe,4,3,"ng-container",5),d.qZA()),2&e){const e=d.oxw(),t=d.MAs(5);d.xp6(1),d.Q6J("ngIf",!e.show_order_details)("ngIfElse",t)}}function Ae(e,t){if(1&e){const e=d.EpF();d.ynx(0),d.TgZ(1,"button",19),d._uU(2," Cancel "),d.qZA(),d.TgZ(3,"button",20),d.NdJ("click",function(){return d.CHM(e),d.oxw(2).show_order_details=!0}),d._uU(4," Confirm "),d.qZA(),d.BQk()}if(2&e){const e=d.oxw(2);d.xp6(3),d.Q6J("disabled",!e.order.item_count)("matBadge",e.order.item_count)("matBadgeHidden",!e.order.item_count)}}function we(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",21),d.NdJ("click",function(){return d.CHM(e),d.oxw(2).show_order_details=!1}),d._uU(1," Back "),d.qZA(),d.TgZ(2,"button",22),d.NdJ("click",function(){return d.CHM(e),d.oxw(2).saveOrder()}),d._uU(3," Save Order "),d.qZA()}}function qe(e,t){if(1&e&&(d.TgZ(0,"footer"),d.YNc(1,Ae,5,3,"ng-container",5),d.YNc(2,we,4,0,"ng-template",null,18,d.W1O),d.qZA()),2&e){const e=d.MAs(3),t=d.oxw();d.xp6(1),d.Q6J("ngIf",!t.show_order_details)("ngIfElse",e)}}function Te(e,t){if(1&e&&(d.TgZ(0,"div",23),d._UZ(1,"mat-spinner",24),d.TgZ(2,"p"),d._uU(3),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(3),d.Oqu(e.loading)}}function ye(e,t){if(1&e&&(d.TgZ(0,"div",30),d._uU(1),d.qZA()),2&e){const e=d.oxw().$implicit,t=d.oxw(2);d.Q6J("matTooltip",t.optionsFor(e)),d.xp6(1),d.AsE(" ",e.options.length," option",1===e.options.length?"":"s"," selected ")}}function Oe(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",11),d.TgZ(1,"div",12),d.TgZ(2,"div",12),d._uU(3),d.qZA(),d.YNc(4,ye,2,3,"div",28),d.qZA(),d.TgZ(5,"div",14),d._uU(6),d.ALo(7,"currency"),d.qZA(),d.TgZ(8,"a-counter",29),d.NdJ("ngModelChange",function(t){const n=d.CHM(e).$implicit;return d.oxw(2).updateItemQuantity(n,t)}),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit;d.xp6(3),d.Oqu(e.name),d.xp6(1),d.Q6J("ngIf",e.options.length),d.xp6(2),d.hij(" ",d.lcZ(7,4,e.total_cost/100)," "),d.xp6(2),d.Q6J("ngModel",e.quantity)}}function Ue(e,t){if(1&e&&(d.TgZ(0,"header",25),d.TgZ(1,"h3"),d._uU(2,"Confirm Order"),d.qZA(),d.qZA(),d.TgZ(3,"div",9),d.YNc(4,Oe,9,6,"div",10),d.qZA(),d.TgZ(5,"div",26),d._UZ(6,"input",27),d.qZA()),2&e){const e=d.oxw();d.xp6(4),d.Q6J("ngForOf",e.order.items),d.xp6(1),d.Q6J("formGroup",e.form),d.xp6(1),d.ekj("error",e.form.controls.charge_code.touched&&e.form.controls.charge_code.invalid)}}function Ie(e,t,n){var i;let o=!0;for(const r of t)if(e.category===r.name||e.tags.includes(r.name)||(null===(i=n.space)||void 0===i?void 0:i.zones.includes(r.name))||"*"===r.name){let e=0;for(const t of r.rules){const i=new Date(n.date);switch(t[0]){case"after_hour":e+=(0,le.Z)(i,(0,de.Z)(i,t[1]))?1:0;break;case"before_hour":e+=(0,ue.Z)(i,(0,de.Z)(i,t[1]))?1:0;break;case"min_length":e+=n.duration>=(0,me.H1)(t[1])?1:0;break;case"max_length":e+=n.duration<=(0,me.H1)(t[1])?1:0;break;case"visitor_type":e+=n.ext("visitor_type")===t[1]?1:0;break;default:e++}}o=e>=r.rules.length}return o}let Ce=(()=>{class e extends l.KG{constructor(e){super(),this._data=e,this.event=new d.vpe,this.loading="",this.loading="Loading menu...",this.menu_items$=this._data.menu.pipe((0,ge.U)(e=>{const t=(0,l.Tw)(e.map(e=>e.category)),n={};for(const i of t)n[i]=e.filter(e=>e.category===i&&Ie(e,this.rules,this.order.event));return n})),this.order=new ce.G(this._data.order),this.form=new o.cw({charge_code:new o.NI(this.order.charge_code,[o.kI.required])}),this.subscription("charge_code",this.form.controls.charge_code.valueChanges.subscribe(e=>this.order=new ce.G(Object.assign(Object.assign({},this.order),{charge_code:e})))),this.subscription("loading",this._data.loading.subscribe(e=>this.loading=e?"Loading menu...":"")),this.loading="Loading menu...",this.timeout("loading",()=>this.loading="",1e3)}get categories(){return this._data.menu.pipe((0,ge.U)(e=>(0,l.Tw)(e.map(e=>e.category))))}ngOnInit(){var e,t,n;return(0,g.mG)(this,void 0,void 0,function*(){this.rules=yield this._data.getCateringConfig(null===(n=null===(t=null===(e=this.order.event)||void 0===e?void 0:e.space)||void 0===t?void 0:t.level)||void 0===n?void 0:n.parent_id)})}addItem(e,t=!0){var n;const i=this.order.items.find(t=>t.id===e.id&&t.options.length===t.options.reduce((t,n)=>t+(e.options.find(e=>n.id===e.id)?1:0),0));t&&(null===(n=e.options)||void 0===n?void 0:n.length)?this._data.selectOptions(e.options).then(t=>{const n=new M.U(Object.assign(Object.assign({},e),{options:t}));this.addItem(n,!1)}):this.order=new ce.G(Object.assign(Object.assign({},this.order),i?{items:this.order.items.filter(e=>e!==i&&e.options.length===i.options.length).concat([new M.U(Object.assign(Object.assign({},e),{quantity:i.quantity+1}))])}:{items:this.order.items.concat([new M.U(Object.assign(Object.assign({},e),{quantity:1}))])}))}updateItemQuantity(e,t){const n=this.order.items.find(t=>t.id===e.id&&e.options.length===e.options.reduce((e,n)=>e+(t.options.find(e=>n.id===e.id)?1:0),0));let i=[...this.order.items];i=n?this.order.items.filter(t=>t.id!==e.id).concat([new M.U(Object.assign(Object.assign({},e),{quantity:t}))]):this.order.items.concat([new M.U(Object.assign(Object.assign({},e),{quantity:t}))]),i.sort((e,t)=>e.name.localeCompare(t.name)),this.order=new ce.G(Object.assign(Object.assign({},this.order),{items:i}))}optionsFor(e){return e.options.map(e=>e.name).join("\n")}saveOrder(){this.form.markAllAsTouched(),this.form.valid&&this.event.emit({reason:"done",metadata:{order:this.order}})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(h.WI))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-catering-order-modal"]],outputs:{event:"event"},features:[d.qOj],decls:6,vars:3,consts:[["class","main min-w-[20rem]",4,"ngIf","ngIfElse"],[4,"ngIf"],["load_state",""],["order_details",""],[1,"main","min-w-[20rem]"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"label"],[1,"list"],["item","","class","flex items-center p-2 border-b border-gray-50",4,"ngFor","ngForOf"],["item","",1,"flex","items-center","p-2","border-b","border-gray-50"],[1,"flex-1","w-1/2"],["class","info no-underline",4,"ngIf"],[1,"bg-primary","text-xs","rounded","px-4","py-2","mx-2","text-white","font-medium"],["mat-icon-button","",3,"click"],[3,"icon"],[1,"info","no-underline"],["order_actions",""],["mat-button","","mat-dialog-close","",1,"inverse"],["confirm","","mat-button","","matBadgeColor","warn",3,"disabled","matBadge","matBadgeHidden","click"],["mat-button","",1,"inverse",3,"click"],["save","","mat-button","",3,"click"],[1,"flex","flex-col","w-64","p-8","items-center","space-y-2"],["diameter","32"],[1,"h-[3.25rem]"],[1,"charge-code",3,"formGroup"],["formControlName","charge_code","placeholder","Charge Code*","required",""],["class","text-xs underline",3,"matTooltip",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"text-xs","underline",3,"matTooltip"]],template:function(e,t){if(1&e&&(d.YNc(0,be,2,2,"div",0),d.YNc(1,qe,4,2,"footer",1),d.YNc(2,Te,4,1,"ng-template",null,2,d.W1O),d.YNc(4,Ue,7,4,"ng-template",null,3,d.W1O)),2&e){const e=d.MAs(3);d.Q6J("ngIf",!t.loading)("ngIfElse",e),d.xp6(1),d.Q6J("ngIf",!t.loading)}},directives:[i.O5,s.SP,i.sg,s.uX,b.lW,A.o,h.ZT,Q.$g,o.JL,o.sg,o.Fj,o.JJ,o.u,o.Q7,k.R,o.On],pipes:[i.Ov,i.H9],styles:[".list[_ngcontent-%COMP%]{height:24em;min-width:24em;max-width:calc(100vw - 1em)}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em}input[_ngcontent-%COMP%]{position:relative;width:100%;padding:1em;border-radius:0!important;border:1px solid #ccc;border-right:none;border-left:none;outline:none;font-size:1em;&:focus{border:none;border-top:2px solid var(--primary);border-bottom:2px solid var(--primary);box-shadow:none}&.error::placeholder{color:rgba(var(--error),.45)}}"]}),e})();function Je(e,t){if(1&e&&(d.TgZ(0,"div",16),d._uU(1),d.ALo(2,"currency"),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(1),d.hij(" +",d.lcZ(2,1,e.unit_price/100)," ")}}function Ne(e,t){if(1&e&&(d.TgZ(0,"mat-radio-button",12),d.TgZ(1,"div",13),d.TgZ(2,"div",14),d._uU(3),d.qZA(),d.YNc(4,Je,3,3,"div",15),d.qZA(),d.qZA()),2&e){const e=t.$implicit;d.Q6J("value",e.id),d.xp6(3),d.hij(" ",e.name," "),d.xp6(1),d.Q6J("ngIf",e.unit_price)}}function Me(e,t){if(1&e){const e=d.EpF();d.ynx(0),d.TgZ(1,"mat-radio-group",9),d.NdJ("ngModelChange",function(t){d.CHM(e);const n=d.oxw().$implicit;return d.oxw().updateGroupOption(n,t)}),d.TgZ(2,"mat-radio-button",10),d._uU(3," None "),d.qZA(),d.YNc(4,Ne,5,3,"mat-radio-button",11),d.qZA(),d.BQk()}if(2&e){const e=d.oxw().$implicit;d.xp6(4),d.Q6J("ngForOf",null==e?null:e.options)}}function ke(e,t){if(1&e&&(d.TgZ(0,"div",16),d._uU(1),d.ALo(2,"currency"),d.qZA()),2&e){const e=d.oxw().$implicit;d.xp6(1),d.hij(" +",d.lcZ(2,1,e.unit_price/100)," ")}}function Qe(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"mat-checkbox",18),d.NdJ("ngModelChange",function(t){const n=d.CHM(e).$implicit;return d.oxw(3).option_state[n.id]=t}),d.TgZ(1,"div",13),d.TgZ(2,"div",14),d._uU(3),d.qZA(),d.YNc(4,ke,3,3,"div",15),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit,n=d.oxw(3);d.Q6J("ngModel",n.option_state[e.id]),d.xp6(3),d.hij(" ",e.name," "),d.xp6(1),d.Q6J("ngIf",e.unit_price)}}function je(e,t){if(1&e&&d.YNc(0,Qe,5,3,"mat-checkbox",17),2&e){const e=d.oxw().$implicit;d.Q6J("ngForOf",null==e?null:e.options)}}function Fe(e,t){if(1&e&&(d.TgZ(0,"div",4),d.TgZ(1,"div",5),d._uU(2),d.qZA(),d.TgZ(3,"div",6),d.YNc(4,Me,5,1,"ng-container",7),d.YNc(5,je,1,1,"ng-template",null,8,d.W1O),d.qZA(),d.qZA()),2&e){const e=t.$implicit,n=d.MAs(6);d.uIk("group",e.name),d.xp6(2),d.Oqu(e.name),d.xp6(2),d.Q6J("ngIf",!e.multiple)("ngIfElse",n)}}let Ye=(()=>{class e{constructor(e){this._data=e,this.event=new d.vpe,this.option_state={};const t=(0,V.Tw)(this._data.options.map(e=>e.group||"Other")),n=[];for(const i of t){const e=this._data.options.filter(e=>e.group===i);n.push({name:i,multiple:!!e.find(e=>e.multiple),options:e})}this.groups=n}updateGroupOption(e,t){for(const n of e.options)this.option_state[n.id]=n.id===t}saveOptions(){const e=this._data.options.filter(e=>this.option_state[e.id]);this.event.emit({reason:"done",metadata:{options:e}})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(h.WI))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-catering-options-modal"]],outputs:{event:"event"},decls:11,vars:1,consts:[["mat-icon-button","","mat-dialog-close",""],[1,"overflow-auto"],["class","pt-1 pb-2 border-b border-gray-200",4,"ngFor","ngForOf"],["mat-button","",3,"click"],[1,"pt-1","pb-2","border-b","border-gray-200"],[1,"font-medium","p-2"],[1,"flex","flex-col","pl-6"],[4,"ngIf","ngIfElse"],["multi_options",""],["aria-label","Select an option","ngModel","",1,"flex","flex-col",3,"ngModelChange"],["value","",1,"my-1","mx-0"],["class","my-1 mx-0",3,"value",4,"ngFor","ngForOf"],[1,"my-1","mx-0",3,"value"],[1,"flex","items-center","justify-center"],[1,"font-medium","p-2","flex-1","w-1/2"],["class","opacity-60 text-xs",4,"ngIf"],[1,"opacity-60","text-xs"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(d.TgZ(0,"header"),d.TgZ(1,"h3"),d._uU(2,"Select options"),d.qZA(),d.TgZ(3,"button",0),d.TgZ(4,"app-icon"),d._uU(5,"close"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(6,"main",1),d.YNc(7,Fe,7,4,"div",2),d.qZA(),d.TgZ(8,"footer"),d.TgZ(9,"button",3),d.NdJ("click",function(){return t.saveOptions()}),d._uU(10,"Save"),d.qZA(),d.qZA()),2&e&&(d.xp6(7),d.Q6J("ngForOf",t.groups))},directives:[b.lW,h.ZT,A.o,i.sg,i.O5,o.JJ,o.On,f.oG],pipes:[i.H9],styles:["main[_ngcontent-%COMP%]{min-height:24em}"]}),e})();var Pe=n(9294);let $e=(()=>{class e extends l.KG{constructor(e,t){super(),this._org=e,this._dialog=t,this._menu=new W.X([]),this._loading=new W.X(!1),this._currency=new W.X("USD"),this.menu=this._menu.asObservable(),this.loading=this._loading.asObservable(),this.currency=this._currency.asObservable(),this.subscription("building",this._org.active_building.subscribe(e=>(0,g.mG)(this,void 0,void 0,function*(){if(e){const t=(yield this.getCateringForZone(e.id)).map(e=>new M.U(e));this._currency.next(e.currency||"USD"),this._menu.next(t)}})))}get categories(){const e=this._menu.getValue();return(0,l.Tw)(e.map(e=>e.category))}manageCateringOrder(e){var t;return(0,g.mG)(this,void 0,void 0,function*(){const n=this._dialog.open(Ce,{data:{order:e,menu:this.menu,loading:this.loading,getCateringConfig:e=>this.getCateringConfig(e),selectOptions:e=>this.selectOptions(e)}}),i=yield Promise.race([n.componentInstance.event.pipe((0,m.P)(e=>"done"===e.reason)).toPromise(),n.afterClosed().toPromise()]);return(null===(t=null==i?void 0:i.metadata)||void 0===t?void 0:t.order)||e})}addItem(e=new M.U){return(0,g.mG)(this,void 0,void 0,function*(){const t=this._dialog.open(B,{data:{item:e,categories:this.categories}}),n=yield Promise.race([t.componentInstance.event.pipe((0,m.P)(e=>"done"===e.reason)).toPromise(),t.afterClosed().toPromise()]);if("done"!==(null==n?void 0:n.reason))return;const i=this._menu.getValue(),o=i.findIndex(t=>t.id===e.id);o>=0?i.splice(o,1,n.metadata.item):i.push(n.metadata.item),this.updateMenu(this._org.building.id,i).then(()=>{this._menu.next([...i]),t.close()},()=>t.componentInstance.loading=!1)})}addOption(e,t={}){return(0,g.mG)(this,void 0,void 0,function*(){const n=(0,l.Tw)(e.options.map(e=>e.group)),i=this._dialog.open(ae,{data:{parent:e,option:t,types:n}}),o=yield Promise.race([i.componentInstance.event.pipe((0,m.P)(e=>"done"===e.reason)).toPromise(),i.afterClosed().toPromise()]);if("done"!==(null==o?void 0:o.reason))return;const r=this._menu.getValue(),s=r.findIndex(t=>t.id===e.id);s>=0?r.splice(s,1,o.metadata.item):r.push(o.metadata.item),this.updateMenu(this._org.building.id,r).then(()=>{this._menu.next([...r]),i.close()},()=>i.componentInstance.loading=!1)})}selectOptions(e){return(0,g.mG)(this,void 0,void 0,function*(){const t=this._dialog.open(Ye,{data:{options:e}}),n=yield Promise.race([t.componentInstance.event.pipe((0,m.P)(e=>"done"===e.reason)).toPromise(),t.afterClosed().toPromise()]);return"done"!==(null==n?void 0:n.reason)?[]:(t.close(),n.metadata.options)})}deleteItem(e){return(0,g.mG)(this,void 0,void 0,function*(){const t=yield(0,l._5)({title:"Delete Catering Item",content:`Are you sure you wish to remove the catering item ${e.name} from the menu?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==t.reason)return;t.loading("Removing catering item...");const n=this._menu.getValue().filter(t=>e.id!==t.id);this.updateMenu(this._org.building.id,n).then(()=>{this._menu.next([...n]),t.close()},()=>t.loading(""))})}deleteOption(e,t){return(0,g.mG)(this,void 0,void 0,function*(){const n=yield(0,l._5)({title:"Delete Catering Item Option",content:`Are you sure you wish to remove the catering option "${t.name}" from "${e.name}"?`,icon:{type:"icon",class:"material-icons",content:"delete"}},this._dialog);if("done"!==n.reason)return;n.loading("Removing catering item option...");const i=this._menu.getValue();i.splice(i.findIndex(t=>t.id===e.id),1,new M.U(Object.assign(Object.assign({},e),{options:e.options.filter(e=>e.id!==t.id)}))),this.updateMenu(this._org.building.id,i).then(()=>{this._menu.next([...i]),n.close()},()=>n.loading(""))})}editConfig(){return(0,g.mG)(this,void 0,void 0,function*(){const e=yield this.getCateringConfig(this._org.building.id),t=this._menu.getValue(),n=(0,l.Tw)((0,l.xH)(t.map(e=>[e.category,...e.tags]))),i=this._dialog.open(J,{data:{config:e,types:n}}),o=yield Promise.race([i.componentInstance.event.pipe((0,m.P)(e=>"done"===e.reason)).toPromise(),i.afterClosed().toPromise()]);"done"===(null==o?void 0:o.reason)&&this.updateConfig(this._org.building.id,o.metadata).then(()=>i.close(),()=>i.componentInstance.loading=!1)})}updateMenu(e,t){return(0,X.Ymr)(e,{id:e,name:"catering",details:t,description:`Catering menu for ${e}`}).toPromise()}getCateringForZone(e){return(0,g.mG)(this,void 0,void 0,function*(){const t=(yield(0,X.rlq)(e,{name:"catering"}).toPromise()).details;return t instanceof Array?t:[]})}getCateringConfig(e=this._org.building.id){return(0,g.mG)(this,void 0,void 0,function*(){const t=(yield(0,X.rlq)(e,{name:"catering_config"}).toPromise()).details;return t instanceof Array?t:[]})}updateConfig(e,t){return(0,X.Ymr)(e,{id:e,name:"catering_config",details:t,description:`Catering menu config for ${e}`}).toPromise()}addItemToOrder(e,t){let n=e.items;const i=n.find(e=>{var n,i;return e.id===t.id&&(null===(n=t.options)||void 0===n?void 0:n.length)===(null===(i=e.options)||void 0===i?void 0:i.reduce((e,n)=>e+(t.options.find(e=>n.id===e.id)?1:0),0))});return i?i.quantity+=1:n=n.concat([new M.U(Object.assign(Object.assign({},t),{quantity:1}))]),new ce.G(Object.assign(Object.assign({},e),{items:n,event:null}))}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(Pe.w7),d.LFG(h.uw))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Ee=["catering-menu-item",""];function Ge(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",5),d.TgZ(1,"div",6),d.TgZ(2,"div",7),d.TgZ(3,"div"),d._uU(4),d.qZA(),d.TgZ(5,"div",8),d._uU(6),d.qZA(),d.qZA(),d.TgZ(7,"div",9),d._uU(8),d.ALo(9,"currency"),d.ALo(10,"async"),d.qZA(),d.qZA(),d.TgZ(11,"button",10),d.TgZ(12,"app-icon"),d._uU(13,"more_vert"),d.qZA(),d.qZA(),d.TgZ(14,"button",11),d.NdJ("click",function(){d.CHM(e);const t=d.oxw();return t.show_options=!t.show_options}),d.TgZ(15,"app-icon"),d._uU(16,"expand_more"),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=d.oxw(),t=d.MAs(3);d.xp6(4),d.Oqu(e.item.name),d.xp6(2),d.hij(" ",e.item.category," "),d.xp6(2),d.hij(" ",d.xi3(9,5,e.item.unit_price/100,d.lcZ(10,8,e.symbol))," "),d.xp6(3),d.Q6J("matMenuTriggerFor",t),d.xp6(3),d.Q6J("disabled",!e.item.options.length)}}function Le(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",14),d.TgZ(1,"div",15),d.TgZ(2,"div",16),d._uU(3),d.qZA(),d.TgZ(4,"div",8),d._uU(5),d.qZA(),d.qZA(),d.TgZ(6,"button",17),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw(2).editOption(t)}),d.TgZ(7,"app-icon"),d._uU(8,"edit"),d.qZA(),d.qZA(),d.TgZ(9,"button",18),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw(2).removeOption(t)}),d.TgZ(10,"app-icon"),d._uU(11,"delete"),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit;d.xp6(3),d.Oqu(e.name),d.xp6(2),d.Oqu(e.group)}}function He(e,t){if(1&e&&(d.TgZ(0,"div",12),d.YNc(1,Le,12,2,"div",13),d.qZA()),2&e){const e=d.oxw();d.Udp("height",e.show_options?3.5*e.item.options.length+"rem":"0"),d.xp6(1),d.Q6J("ngForOf",e.item.options)}}let Se=(()=>{class e{constructor(e){this._catering=e,this.show_options=!1,this.addOption=()=>this._catering.addOption(this.item),this.editOption=e=>this._catering.addOption(this.item,e),this.removeOption=e=>this._catering.deleteOption(this.item,e),this.editItem=()=>this._catering.addItem(this.item),this.removeItem=()=>this._catering.deleteItem(this.item)}get symbol(){return this._catering.currency}}return e.\u0275fac=function(t){return new(t||e)(d.Y36($e))},e.\u0275cmp=d.Xpm({type:e,selectors:[["","catering-menu-item",""]],inputs:{item:"item"},attrs:Ee,decls:19,vars:2,consts:[["item","","class","flex items-center px-2",4,"ngIf"],["options","","class","bg-gray-100 overflow-hidden",3,"height",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"ml-2"],["item","",1,"flex","items-center","px-2"],[1,"flex","items-center","p-2","flex-1"],[1,"flex-1"],[1,"text-xs","text-dark-fade"],[1,"p-2","m-2","text-xs","font-bold","text-white","rounded","bg-primary"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-icon-button","",3,"disabled","click"],["options","",1,"bg-gray-100","overflow-hidden"],["class","flex p-2 items-center border-none border-t border-solid border-gray-300",4,"ngFor","ngForOf"],[1,"flex","p-2","items-center","border-none","border-t","border-solid","border-gray-300"],[1,"flex-1","px-2"],[1,"text"],["edit","","mat-icon-button","",1,"mx-2",3,"click"],["remove","","mat-icon-button","",1,"mx-2",3,"click"]],template:function(e,t){1&e&&(d.YNc(0,Ge,17,10,"div",0),d.YNc(1,He,2,3,"div",1),d.TgZ(2,"mat-menu",null,2),d.TgZ(4,"button",3),d.NdJ("click",function(){return t.addOption()}),d.TgZ(5,"app-icon"),d._uU(6,"add"),d.qZA(),d.TgZ(7,"div",4),d._uU(8,"Add Option"),d.qZA(),d.qZA(),d.TgZ(9,"button",3),d.NdJ("click",function(){return t.editItem()}),d.TgZ(10,"app-icon"),d._uU(11,"edit"),d.qZA(),d.TgZ(12,"div",4),d._uU(13,"Edit Item"),d.qZA(),d.qZA(),d.TgZ(14,"button",3),d.NdJ("click",function(){return t.removeItem()}),d.TgZ(15,"app-icon"),d._uU(16,"delete"),d.qZA(),d.TgZ(17,"div",4),d._uU(18,"Remove Item"),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.Q6J("ngIf",t.item),d.xp6(1),d.Q6J("ngIf",t.item))},directives:[i.O5,Z.VK,Z.OP,A.o,b.lW,Z.p6,i.sg],pipes:[i.H9,i.Ov],styles:["[_nghost-%COMP%]{background-color:#fff;border:1px solid #ccc;border-radius:.25rem;overflow:hidden;width:768px;margin:.5rem auto;max-width:calc(100vw - 1rem)}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}[options][_ngcontent-%COMP%]{transition:height .2s}"]}),e})();function ze(e,t){if(1&e&&(d.ynx(0),d._UZ(1,"div",6),d.BQk()),2&e){const e=t.$implicit;d.xp6(1),d.Q6J("item",e)}}function De(e,t){if(1&e&&(d.ynx(0),d.YNc(1,ze,2,1,"ng-container",5),d.ALo(2,"async"),d.BQk()),2&e){const e=d.oxw();d.xp6(1),d.Q6J("ngForOf",d.lcZ(2,1,e.menu))}}function Be(e,t){if(1&e&&(d.ynx(0),d._UZ(1,"div",6),d.BQk()),2&e){const e=t.$implicit;d.xp6(1),d.Q6J("item",e)}}function Xe(e,t){if(1&e&&(d.TgZ(0,"mat-tab",7),d.YNc(1,Be,2,1,"ng-container",5),d.ALo(2,"async"),d.qZA()),2&e){const e=t.$implicit,n=d.oxw();d.Q6J("label",e),d.xp6(1),d.Q6J("ngForOf",d.lcZ(2,2,n.tab_menu)[e])}}function We(e,t){1&e&&(d.TgZ(0,"div",8),d.TgZ(1,"app-icon"),d._uU(2,"close"),d.qZA(),d.TgZ(3,"p"),d._uU(4,"No items in menu"),d.qZA(),d.qZA())}let Ve=(()=>{class e{constructor(e){this._catering=e,this.menu=this._catering.menu,this.shown_tab=new W.X(""),this.tab_menu=this.menu.pipe((0,ge.U)(e=>{const t={};for(const n of this.categories)t[n]=e.filter(e=>e.category===n);return t}))}get categories(){return this._catering.categories}}return e.\u0275fac=function(t){return new(t||e)(d.Y36($e))},e.\u0275cmp=d.Xpm({type:e,selectors:[["catering-menu"]],decls:7,vars:5,consts:[[1,"h-full",3,"selectedIndexChange"],["label","All Items"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngFor","ngForOf"],["empty_state",""],[4,"ngFor","ngForOf"],["catering-menu-item","",3,"item"],[3,"label"],[1,"flex","flex-col","items-center","p-8","space-y-2"]],template:function(e,t){if(1&e&&(d.TgZ(0,"mat-tab-group",0),d.NdJ("selectedIndexChange",function(e){return t.shown_tab.next(0===e?"":t.categories[e-1])}),d.TgZ(1,"mat-tab",1),d.YNc(2,De,3,3,"ng-container",2),d.ALo(3,"async"),d.qZA(),d.YNc(4,Xe,3,4,"mat-tab",3),d.qZA(),d.YNc(5,We,5,0,"ng-template",null,4,d.W1O)),2&e){const e=d.MAs(6);let n;d.xp6(2),d.Q6J("ngIf",null==(n=d.lcZ(3,3,t.menu))?null:n.length)("ngIfElse",e),d.xp6(2),d.Q6J("ngForOf",t.categories)}},directives:[s.SP,s.uX,i.O5,i.sg,Se,A.o],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:90%;width:100%}"]}),e})();const Ke=["catering-order-item",""];let Re=(()=>{class e{constructor(){this.active=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d.Xpm({type:e,selectors:[["","catering-order-item",""]],inputs:{item:"item"},attrs:Ke,decls:8,vars:8,consts:[[1,"w-20","text-right"],["name","item-bar",1,"bg-gray-300"],[1,"w-12","mr-4"],["mat-icon-button","",1,"border","border-gray-300","border-dashed","text-2xl","text-dark-fade"],[1,"flex-1","border-b","border-gray-300","border-solid","py-4"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d._UZ(1,"div",1),d.qZA(),d.TgZ(2,"div",2),d.TgZ(3,"button",3),d.TgZ(4,"app-icon"),d._uU(5),d.qZA(),d.qZA(),d.qZA(),d.TgZ(6,"div",4),d._uU(7),d.qZA()),2&e&&(d.xp6(3),d.ekj("bg-success",t.active)("text-white",t.active)("border-solid",t.active),d.xp6(2),d.Oqu(t.active?"done":"local_pizza"),d.xp6(2),d.hij(" ",null==t.item?null:t.item.name," "))},directives:[b.lW,A.o],styles:["[_nghost-%COMP%]:last-child > div[_ngcontent-%COMP%]{border:none!important}[name=item-bar][_ngcontent-%COMP%]{height:2px;margin-left:auto;margin-right:1rem;width:calc(50% - .9375rem)}"]}),e})();var et=n(3080),tt=n(7701),nt=n(4689),it=n(4019),ot=n(8303),rt=n(4914),st=n(205),at=n(8125),ct=n(3499),lt=n(9005);let dt=(()=>{class e extends l.KG{constructor(){super(),this._poll=new W.X(0),this._loading=new W.X(!1),this._filters=new W.X({}),this.orders=(0,et.aj)([this._filters,this._poll]).pipe((0,tt.b)(500),(0,nt.w)(([e])=>{this._loading.next(!0);const t=(0,rt.Z)((0,st.Z)(e.date||Date.now())),n=(0,rt.Z)((0,at.Z)(e.date||Date.now()));return(0,ct.u$)({zone_ids:(e.zones||[]).join(","),period_start:t,period_end:n})}),(0,ge.U)(e=>(0,l.xH)(e.map(e=>e.ext("catering")))),(0,it.b)(()=>this._loading.next(!1)),(0,ot.d)(1)),this.loading=this._loading.asObservable(),this.filtered=this.orders.pipe((0,ge.U)(e=>e.filter(e=>function(e,t){const n=(t.search||"").toLowerCase();return!!e.items.find(e=>e.name.toLowerCase().includes(n)||!!e.options.find(e=>e.name.toLowerCase().includes(n)))}(e,this._filters.getValue())))),this.subscription("changes",this.orders.subscribe())}get filters(){return this._filters.getValue()}set filters(e){this._filters.next(e)}startPolling(e=15e3){this.interval("polling",()=>this._poll.next((new Date).valueOf()),e)}stopPolling(){this.clearInterval("polling")}updateStatus(e,t){const n=new ce.G(Object.assign(Object.assign({},e),{status:t})),i=new lt.y(Object.assign(Object.assign({},e.event),{catering:[...e.event.ext("catering").filter(t=>t.id!==e.id),n].map(e=>new ce.G(Object.assign({},e)))}));return(0,ct.ry)(i)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const ut=[{id:"pending",name:"Pending",icon:{class:"custom-pending"},colour:"#ccc"},{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}];function gt(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",4),d.TgZ(1,"div",5),d.TgZ(2,"div",6),d.TgZ(3,"app-icon"),d._uU(4,"room_service"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(5,"div",7),d._uU(6),d.ALo(7,"date"),d.qZA(),d.TgZ(8,"div",8),d._uU(9),d.qZA(),d.TgZ(10,"div",9),d._uU(11),d.qZA(),d.TgZ(12,"div",7),d._uU(13),d.qZA(),d.TgZ(14,"div",10),d._uU(15),d.qZA(),d.TgZ(16,"div",11),d.TgZ(17,"button",12),d.TgZ(18,"div",13),d._uU(19),d.qZA(),d.TgZ(20,"app-icon",14),d._uU(21,"arrow_drop_down"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(22,"div",15),d.TgZ(23,"button",16),d.NdJ("click",function(){d.CHM(e);const t=d.oxw();return t.show_items=!t.show_items}),d.TgZ(24,"app-icon"),d._uU(25),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=d.oxw(),t=d.MAs(3);d.ekj("shown",e.show_items),d.xp6(6),d.Oqu(d.xi3(7,12,e.order.deliver_at,"shortTime")),d.xp6(3),d.hij(" ",(null==e.order.event?null:e.order.event.space.display_name)||(null==e.order.event?null:e.order.event.space.name)||"~ No Location ~"," "),d.xp6(2),d.hij(" ",(null==e.order.event||null==e.order.event.organiser?null:e.order.event.organiser.name)||(null==e.order.event?null:e.order.event.host)||"~ Unknown Host ~"," "),d.xp6(2),d.Oqu(e.order.charge_code||"~ No Code ~"),d.xp6(2),d.hij(" ",e.order.invoice_number||"~ No Invoice ~"," "),d.xp6(2),d.Udp("background",null==e.status?null:e.status.colour),d.Q6J("matMenuTriggerFor",t),d.xp6(2),d.hij(" ",null==e.status?null:e.status.name," "),d.xp6(6),d.Oqu(e.show_items?"keyboard_arrow_down":"keyboard_arrow_right")}}function mt(e,t){1&e&&d._UZ(0,"li",20),2&e&&d.Q6J("item",t.$implicit)}function pt(e,t){if(1&e&&(d.TgZ(0,"ul",17),d._UZ(1,"div",18),d.YNc(2,mt,1,1,"li",19),d.qZA()),2&e){const e=d.oxw();d.ekj("shown",e.show_items),d.Q6J("@show",e.show_items?"show":"hide"),d.xp6(1),d.Udp("height",3.125*e.order.items.length-1+"rem"),d.xp6(1),d.Q6J("ngForOf",e.order.items)}}function ft(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",21),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw().updateStatus(t.id)}),d._UZ(1,"div",22),d.TgZ(2,"span",23),d._uU(3),d.qZA(),d.qZA()}if(2&e){const e=t.$implicit;d.xp6(1),d.Udp("background-color",e.colour),d.xp6(2),d.Oqu(e.name)}}let ht=(()=>{class e{constructor(e){this._orders=e,this.show_items=!1,this.statuses=ut,this.updateStatus=e=>this._orders.updateStatus(this.order,e)}get status(){return this.statuses.find(e=>e.id===this.order.status)}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(dt))},e.\u0275cmp=d.Xpm({type:e,selectors:[["catering-order"]],inputs:{order:"order"},decls:5,vars:3,consts:[["class","w-full flex items-center py-2 bg-gray-100",3,"shown",4,"ngIf"],["class","list-none p-0 m-0 w-full relative",3,"shown",4,"ngIf"],["menu","matMenu"],["mat-menu-item","","class","flex items-center",3,"click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","py-2","bg-gray-100"],[1,"w-20","flex","items-center","justify-center"],[1,"rounded-full","bg-gray-300","p-2","text-2xl","text-dark-fade","flex","items-center","justify-center"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],["name","status","matRipple","",1,"text-base","border-none","h-10","px-4","flex","items-center","text-white","w-36",3,"matMenuTriggerFor"],[1,"flex","text-center","capitalize","mx-2"],[1,"pl-2"],[1,"w-12"],["mat-icon-button","",3,"click"],[1,"list-none","p-0","m-0","w-full","relative"],["name","bar",1,"absolute","top-0","bg-gray-300"],["catering-order-item","","class","flex items-center",3,"item",4,"ngFor","ngForOf"],["catering-order-item","",1,"flex","items-center",3,"item"],["mat-menu-item","",1,"flex","items-center",3,"click"],[1,"rounded-full","h-4","w-4","mr-2"],[1,"mr-2","w-20"]],template:function(e,t){1&e&&(d.YNc(0,gt,26,15,"div",0),d.YNc(1,pt,3,6,"ul",1),d.TgZ(2,"mat-menu",null,2),d.YNc(4,ft,4,3,"button",3),d.qZA()),2&e&&(d.Q6J("ngIf",t.order),d.xp6(1),d.Q6J("ngIf",null==t.order?null:t.order.items.length),d.xp6(3),d.Q6J("ngForOf",t.statuses))},directives:[i.O5,Z.VK,i.sg,A.o,Z.p6,b.lW,Re,Z.OP],pipes:[i.uU],styles:["[name=status][_ngcontent-%COMP%]{border-radius:1.55rem}button[mat-menu-item][_ngcontent-%COMP%]{display:flex}.shown[_ngcontent-%COMP%]{background-color:#eee}[name=bar][_ngcontent-%COMP%]{width:2px;top:-.5rem;left:calc(2.5rem - 1px)}"],data:{animation:[l.X7]}}),e})();function Zt(e,t){if(1&e&&(d.TgZ(0,"li",12),d._UZ(1,"catering-order",13),d.qZA()),2&e){const e=t.$implicit;d.xp6(1),d.Q6J("order",e)}}function _t(e,t){1&e&&(d.TgZ(0,"div",14),d.TgZ(1,"p"),d._uU(2,"No Catering Orders"),d.qZA(),d.qZA())}function vt(e,t){1&e&&d._UZ(0,"mat-progress-bar",15)}let xt=(()=>{class e{constructor(e){this._orders=e,this.order_list=this._orders.filtered,this.loading=this._orders.loading}ngOnInit(){this._orders.startPolling()}ngOnDestroy(){this._orders.stopPolling()}trackByFn(e,t){return t?t.id:void 0}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(dt))},e.\u0275cmp=d.Xpm({type:e,selectors:[["catering-order-list"]],decls:22,vars:10,consts:[[1,"w-full","text-sm","font-medium","flex","items-center","py-4","border-solid","border-b","border-gray-300","bg-white"],[1,"w-20"],[1,"w-24"],[1,"flex-1"],[1,"w-56"],[1,"w-28"],[1,"w-36"],[1,"w-12"],[1,"list-none","p-0","m-0","w-full","flex-1","overflow-auto"],["class","border-solid border-b border-gray-300",4,"ngFor","ngForOf","ngForTrackBy"],["empty","","class","info-block text-dark-fade",4,"ngIf"],["class","w-full","mode","indeterminate",4,"ngIf"],[1,"border-solid","border-b","border-gray-300"],[3,"order"],["empty","",1,"info-block","text-dark-fade"],["mode","indeterminate",1,"w-full"]],template:function(e,t){if(1&e&&(d.TgZ(0,"div",0),d._UZ(1,"div",1),d.TgZ(2,"div",2),d._uU(3,"Time"),d.qZA(),d.TgZ(4,"div",3),d._uU(5,"Location"),d.qZA(),d.TgZ(6,"div",4),d._uU(7,"Host"),d.qZA(),d.TgZ(8,"div",2),d._uU(9,"Charge Code"),d.qZA(),d.TgZ(10,"div",5),d._uU(11,"Invoice No."),d.qZA(),d.TgZ(12,"div",6),d._uU(13,"Status"),d.qZA(),d._UZ(14,"div",7),d.qZA(),d.TgZ(15,"ul",8),d.YNc(16,Zt,2,1,"li",9),d.ALo(17,"async"),d.YNc(18,_t,3,0,"div",10),d.ALo(19,"async"),d.qZA(),d.YNc(20,vt,1,0,"mat-progress-bar",11),d.ALo(21,"async")),2&e){let e;d.xp6(16),d.Q6J("ngForOf",d.lcZ(17,4,t.order_list))("ngForTrackBy",t.trackByFn),d.xp6(2),d.Q6J("ngIf",!(null!=(e=d.lcZ(19,6,t.order_list))&&e.length)),d.xp6(2),d.Q6J("ngIf",d.lcZ(21,8,t.loading))}},directives:[i.sg,i.O5,ht],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}"]}),e})(),bt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({providers:[],imports:[[i.ez,Z.Tx,s.Nh,p.Bb,h.Is,f.p9,o.u5,o.UX,_.Kk,v.W9]]}),e})();var At=n(1521);function wt(e,t){if(1&e&&(d.TgZ(0,"mat-option",6),d._uU(1),d.qZA()),2&e){const e=t.$implicit;d.Q6J("value",e.id),d.xp6(1),d.hij(" ",e.display_name||e.name," ")}}function qt(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",7),d.NdJ("click",function(){return d.CHM(e),d.oxw().addItem()}),d._uU(1," Add Item "),d.qZA()}}function Tt(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",7),d.NdJ("click",function(){return d.CHM(e),d.oxw().editConfig()}),d._uU(1," Edit Config "),d.qZA()}}let yt=(()=>{class e extends l.KG{constructor(e,t,n,i,o){super(),this._orders=e,this._catering=t,this._org=n,this._route=i,this._router=o,this.zones=[],this.levels=this._org.active_levels,this.setDate=e=>this._orders.filters=Object.assign(Object.assign({},this._orders.filters),{date:e}),this.updateZones=e=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:e.join(",")}}),this._orders.filters=Object.assign(Object.assign({},this._orders.filters),{zones:[e]})},this.addItem=()=>this._catering.addItem(),this.editConfig=()=>this._catering.editConfig()}ngOnInit(){return(0,g.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,m.P)(e=>e)).toPromise(),this.subscription("route.query",this._route.queryParamMap.subscribe(e=>{if(e.has("zone_ids")){const t=e.get("zone_ids").split(",");if(!t.length)return;const n=this._org.levelWithID(t);if(this.zones=t,!n)return;this._org.building=this._org.buildings.find(e=>e.id===n.parent_id)}})),this.subscription("route.params",this._route.paramMap.subscribe(e=>this.page=e.has("view")?e.get("view"):"")),this.subscription("levels",this._org.active_levels.subscribe(e=>{this.zones=this.zones.filter(t=>e.find(e=>e.id===t)),!this.zones.length&&e.length&&this.zones.push(e[0].id),this.updateZones(this.zones)}))})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(dt),d.Y36($e),d.Y36(Pe.w7),d.Y36(r.gz),d.Y36(r.F0))},e.\u0275cmp=d.Xpm({type:e,selectors:[["catering-topbar"]],features:[d.qOj],decls:8,vars:6,consts:[["appearance","outline"],["multiple","","placeholder","All Levels",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-button","",3,"click",4,"ngIf"],[1,"flex-1","w-2"],[3,"dateChange"],[3,"value"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(d.TgZ(0,"mat-form-field",0),d.TgZ(1,"mat-select",1),d.NdJ("ngModelChange",function(e){return t.zones=e})("ngModelChange",function(e){return t.updateZones(e)}),d.YNc(2,wt,2,2,"mat-option",2),d.ALo(3,"async"),d.qZA(),d.qZA(),d.YNc(4,qt,2,0,"button",3),d.YNc(5,Tt,2,0,"button",3),d._UZ(6,"div",4),d.TgZ(7,"date-options",5),d.NdJ("dateChange",function(e){return t.setDate(e)}),d.qZA()),2&e&&(d.xp6(1),d.Q6J("ngModel",t.zones),d.xp6(1),d.Q6J("ngForOf",d.lcZ(3,4,t.levels)),d.xp6(2),d.Q6J("ngIf","menu"===t.page),d.xp6(1),d.Q6J("ngIf","menu"===t.page))},directives:[w.KE,T.gD,o.JJ,o.On,i.sg,i.O5,At.E,y.ey,b.lW],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:flex;align-items:center;background-color:#fff;height:5em;padding:0 1em;border-bottom:1px solid #ccc}[_nghost-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-left:.5rem}mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em}"]}),e})();const Ot=["app-catering",""];function Ut(e,t){1&e&&d._UZ(0,"catering-order-list",5)}function It(e,t){1&e&&d._UZ(0,"catering-menu",5)}const Ct=function(){return["/catering","menu"]},Jt=function(){return["/catering","orders"]};function Nt(e,t){1&e&&(d.TgZ(0,"div",6),d.TgZ(1,"a",7),d.TgZ(2,"div",8),d._UZ(3,"div",9),d.TgZ(4,"span",10),d._uU(5,"Menus and Pricing"),d.qZA(),d.qZA(),d.TgZ(6,"div",11),d._uU(7," View and Edit Menus and Pricing "),d.qZA(),d.qZA(),d.TgZ(8,"a",7),d.TgZ(9,"div",8),d._UZ(10,"div",9),d.TgZ(11,"span",10),d._uU(12,"Today's Orders"),d.qZA(),d.qZA(),d.TgZ(13,"div",11),d._uU(14," View Catering Orders and their statuses upon arrival "),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(1),d.Q6J("routerLink",d.DdM(6,Ct)),d.xp6(1),d.Udp("background-image","url(assets/menus.jpg)"),d.xp6(6),d.Q6J("routerLink",d.DdM(7,Jt)),d.xp6(1),d.Udp("background-image","url(assets/orders.jpg)"))}let Mt=(()=>{class e extends l.KG{constructor(e){super(),this._route=e}ngOnInit(){this.subscription("route.params",this._route.paramMap.subscribe(e=>this.page=e.has("view")?e.get("view"):""))}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(r.gz))},e.\u0275cmp=d.Xpm({type:e,selectors:[["","app-catering",""]],features:[d.qOj],attrs:Ot,decls:7,vars:3,consts:[[1,"relative","w-full","flex","flex-col"],[1,"relative","z-10"],[3,"ngSwitch"],["class","flex-1",4,"ngSwitchCase"],["class","flex flex-1 items-center justify-center",4,"ngSwitchDefault"],[1,"flex-1"],[1,"flex","flex-1","items-center","justify-center"],["matRipple","",1,"rounded","flex","flex-col","items-center","bg-white","shadow","text-black",3,"routerLink"],["name","img",1,"relative","w-full","flex","flex-1","items-center","justify-center","text-2xl","text-white","bg-center","bg-cover"],[1,"absolute","inset-0","bg-black","opacity-60","z-0"],[1,"z-10"],[1,"p-2","h-14","w-full","text-sm","text-center","flex","items-center","justify-center"]],template:function(e,t){1&e&&(d._UZ(0,"sidebar"),d.TgZ(1,"main",0),d._UZ(2,"catering-topbar",1),d.ynx(3,2),d.YNc(4,Ut,1,0,"catering-order-list",3),d.YNc(5,It,1,0,"catering-menu",3),d.YNc(6,Nt,15,8,"div",4),d.BQk(),d.qZA()),2&e&&(d.xp6(3),d.Q6J("ngSwitch",t.page),d.xp6(1),d.Q6J("ngSwitchCase","orders"),d.xp6(1),d.Q6J("ngSwitchCase","menu"))},directives:[u.k,yt,i.RF,i.n9,i.ED,xt,Ve,r.yS,y.wG],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%;background:var(--bg)}a[_ngcontent-%COMP%]{width:28rem;height:16rem;margin-left:.5rem;text-decoration:none;transition:background .2s}a[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.00392156862745098)!important}a[_ngcontent-%COMP%]:first-child{margin:0}"]}),e})();const kt=[{path:"",component:Mt},{path:":view",component:Mt}];let Qt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[i.ez,o.u5,c.v,s.Nh,a.Hi,bt,r.Bz.forChild(kt)]]}),e})()}}]);
//# sourceMappingURL=apps_concierge_src_app_catering_catering_module_ts.js.map