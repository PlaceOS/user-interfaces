"use strict";(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([["apps_concierge_src_app_facilities_facilities_module_ts"],{4446:(N,m,n)=>{n.r(m),n.d(m,{FacilitiesModule:()=>D});var r=n(93),p=n(9298),d=n(3259),C=n(2656),e=n(1477),_=n(4945),y=n(3786),T=n(88),u=n(2247),x=n(8539),h=n(5503),M=n(3176),g=n(7820),F=n(9396),b=n(6360);function A(i,o){if(1&i&&(e.TgZ(0,"mat-option",6),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.display_name||t.name," ")}}function O(i,o){if(1&i&&(e.TgZ(0,"mat-option",6),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}let U=(()=>{class i extends u.KG{constructor(t,s,a,l){super(),this._state=t,this._org=s,this._route=a,this._router=l,this.zones=[],this.types=[{id:"internal",name:"Internal"},{id:"external",name:"External"},{id:"cancelled",name:"Cancelled"}],this.type_list=this.types.map(c=>`${c.id}`),this.setDate=c=>this._state.setDate(c),this.levels=this._org.active_levels,this.updateZones=c=>{this._router.navigate([],{relativeTo:this._route,queryParams:{zone_ids:c.join(",")}}),this._state.setZones(c)},this.updateTypes=c=>this._state.setFilters({hide_type:this.types.reduce((v,Z)=>(c.includes(Z.id)||v.push(Z),v),[])})}ngOnInit(){return(0,y.mG)(this,void 0,void 0,function*(){yield this._org.initialised.pipe((0,T.P)(t=>t)).toPromise(),this.subscription("route.query",this._route.queryParamMap.subscribe(t=>{if(t.has("zone_ids")){const s=t.get("zone_ids").split(",");if(s.length){const a=this._org.levelWithID(s);if(!a)return;this._org.building=this._org.buildings.find(l=>l.id===a.parent_id),this.zones=s}}})),this.subscription("levels",this._org.active_levels.subscribe(t=>{this.zones=this.zones.filter(s=>t.find(a=>a.id===s)),!this.zones.length&&t.length&&this.zones.push(t[0].id),this.updateZones(this.zones)})),this.updateTypes(this.type_list)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(h.Y),e.Y36(x.w7),e.Y36(d.gz),e.Y36(d.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["facilities-topbar"]],features:[e.qOj],decls:11,vars:6,consts:[["appearance","outline"],["multiple","","placeholder","All Levels",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["multiple","","placeholder","No Events",3,"ngModel","ngModelChange"],[1,"flex-full"],[1,"mr-2"],[3,"value"]],template:function(t,s){1&t&&(e.TgZ(0,"mat-form-field",0),e.TgZ(1,"mat-select",1),e.NdJ("ngModelChange",function(l){return s.zones=l})("ngModelChange",function(l){return s.updateZones(l)}),e.YNc(2,A,2,2,"mat-option",2),e.ALo(3,"async"),e.qZA(),e.qZA(),e.TgZ(4,"mat-form-field",0),e.TgZ(5,"mat-select",3),e.NdJ("ngModelChange",function(l){return s.type_list=l})("ngModelChange",function(l){return s.updateTypes(l)}),e.TgZ(6,"mat-select-trigger"),e._uU(7,"Legend"),e.qZA(),e.YNc(8,O,2,2,"mat-option",2),e.qZA(),e.qZA(),e._UZ(9,"div",4),e._UZ(10,"searchbar",5)),2&t&&(e.xp6(1),e.Q6J("ngModel",s.zones),e.xp6(1),e.Q6J("ngForOf",e.lcZ(3,4,s.levels)),e.xp6(3),e.Q6J("ngModel",s.type_list),e.xp6(3),e.Q6J("ngForOf",s.types))},directives:[M.KE,g.gD,p.JJ,p.On,r.sg,g.$L,F.U,b.ey],pipes:[r.Ov],styles:["[_nghost-%COMP%]{display:flex;align-items:center;background-color:#fff;height:5em;padding:0 2em}.flex-full[_ngcontent-%COMP%]{flex:1;width:.5em}mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:8em;margin-left:1em}"]}),i})();var f=n(9916),z=n(9136),P=n(8461);let J=(()=>{class i extends u.KG{constructor(t,s){super(),this._explore=t,this._state=s,this.url=this._explore.map_url,this.styles=this._explore.map_styles,this.positions=this._explore.map_positions,this.features=this._explore.map_features,this.actions=this._explore.map_actions}ngOnInit(){this.subscription("active_zone",this._state.zones.subscribe(t=>this._explore.setLevel(t[0])))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.ck),e.Y36(h.Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["facilities-map"]],features:[e.qOj],decls:8,vars:18,consts:[[3,"src","zoom","center","styles","features","actions"],[1,"absolute","bottom-0","right-0"]],template:function(t,s){1&t&&(e._UZ(0,"i-map",0),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e._UZ(7,"explore-zoom-controls",1)),2&t&&e.Q6J("src",e.lcZ(1,6,s.url))("zoom",e.lcZ(2,8,s.positions).zoom)("center",e.lcZ(3,10,s.positions).center)("styles",e.lcZ(4,12,s.styles))("features",e.lcZ(5,14,s.features))("actions",e.lcZ(6,16,s.actions))},directives:[z.p,P.s],pipes:[r.Ov],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}"]}),i})();var L=n(5306);const q=function(){return{class:"material-icons",content:"account_circle"}},Y=function(){return{class:"material-icons",content:"sentiment_very_satisfied"}};let Q=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["facilities-status"]],decls:23,vars:8,consts:[[1,"rounded-lg","flex-1","w-full","shadow-sm","p-6"],[1,"mt-0","mb-4"],[1,"w-full","flex","items-center","border","mb-2","rounded-lg"],["name","status",1,"rounded-full"],[3,"icon"],[1,"flex-1","text-bold","text-xs"],[1,"text-bold","p-4"],[1,"text-right","text-bold","mr-4"],[1,"rounded","w-full","shadow-sm","p-6"],[1,"mt-0","mb-2"],["name","mood",1,"flex","items-center","w-full","border","rounded-lg","overflow-hidden"],[1,"bg-light","text-2xl","px-1",3,"icon"],[1,"px-4","text-sm","text-bold"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h3",1),e._uU(2,"People Count"),e.qZA(),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e._UZ(5,"app-icon",4),e.qZA(),e.TgZ(6,"div",5),e._uU(7),e.qZA(),e.TgZ(8,"div",6),e._uU(9),e.qZA(),e.qZA(),e.TgZ(10,"div",7),e._uU(11),e.qZA(),e.qZA(),e.TgZ(12,"div",8),e.TgZ(13,"h3",9),e._uU(14,"Mood"),e.qZA(),e.TgZ(15,"div",10),e._UZ(16,"app-icon",11),e.TgZ(17,"div",12),e._uU(18,"4/5 Satisfied"),e.qZA(),e.qZA(),e.TgZ(19,"h4"),e._uU(20,"Feedback:"),e.qZA(),e.TgZ(21,"p"),e._uU(22),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Q6J("icon",e.DdM(6,q)),e.xp6(2),e.Oqu("Admin Services"),e.xp6(2),e.Oqu("24"),e.xp6(2),e.hij("Total: ",s.total||0,""),e.xp6(5),e.Q6J("icon",e.DdM(7,Y)),e.xp6(6),e.Oqu(s.feedback))},directives:[L.o],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;background-color:#f8f8f8;width:20em;padding:2em}.border[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.1)}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{background-color:#fff}.bg-light[_ngcontent-%COMP%]{background-color:#0000000d}[name=status][_ngcontent-%COMP%]{margin:.5em;border:4px solid #21a453;border-radius:100%}"]}),i})();const S=["app-facilities",""],j=[{path:"",component:(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["","app-facilities",""]],attrs:S,decls:6,vars:0,consts:[[1,"relative"],[1,"flex","flex-1"],[1,"flex-1","h-full"],[1,"h-full","space-y-4"]],template:function(t,s){1&t&&(e._UZ(0,"sidebar"),e.TgZ(1,"main",0),e._UZ(2,"facilities-topbar"),e.TgZ(3,"div",1),e._UZ(4,"facilities-map",2),e._UZ(5,"facilities-status",3),e.qZA(),e.qZA())},directives:[_.k,U,J,Q],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%;background:var(--bg)}sidebar[_ngcontent-%COMP%]{height:100%}main[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-width:50%;height:100%}facilities-map[_ngcontent-%COMP%]{min-width:50%}"]}),i})()}];let D=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[r.ez,p.u5,C.v,f.P2,d.Bz.forChild(j)]]}),i})()}}]);
//# sourceMappingURL=apps_concierge_src_app_facilities_facilities_module_ts.js.map